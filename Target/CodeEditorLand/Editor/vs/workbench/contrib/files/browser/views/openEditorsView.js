var WK=Object.defineProperty;var HK=Object.getOwnPropertyDescriptor;var R=(r,e,t,i)=>{for(var n=i>1?void 0:i?HK(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(n=(i?s(e,t,n):s(n))||n);return i&&n&&WK(e,t,n),n},y=(r,e)=>(t,i)=>e(t,i,r);function UR(){return globalThis._VSCODE_NLS_MESSAGES}function Xb(){return globalThis._VSCODE_NLS_LANGUAGE}var UK=Xb()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function rS(r,e){let t;return e.length===0?t=r:t=r.replace(/\{(\d+)\}/g,(i,n)=>{let o=n[0],s=e[o],a=i;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),UK&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function h(r,e,...t){return rS(typeof r=="number"?BV(r,e):e,t)}function BV(r,e){let t=UR()?.[r];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${r} !!!`)}return t}function pt(r,e,...t){let i;typeof r=="number"?i=BV(r,e):i=e;let n=rS(i,t);return{value:n,original:e===i?n:rS(e,t)}}var zR=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?dl.isErrorNoTelemetry(e)?new dl(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},VV=new zR;function rm(r){VV.onUnexpectedError(r)}function Ge(r){wc(r)||VV.onUnexpectedError(r)}var sS="Canceled";function wc(r){return r instanceof _o?!0:r instanceof Error&&r.name===sS&&r.message===sS}var _o=class extends Error{constructor(){super(sS),this.name=this.message}};function WV(){let r=new Error(sS);return r.name=r.message,r}function ap(r){return r?new Error(`Illegal argument: ${r}`):new Error("Illegal argument")}function HV(r){return r?new Error(`Illegal state: ${r}`):new Error("Illegal state")}function Qb(r){return r?r.message?r.message:r.stack?r.stack.split(`
`)[0]:String(r):"Error"}var aS=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}};var dl=class r extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof r)return e;let t=new r;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Je=class r extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,r.prototype)}};function ps(r,e){let t=this,i=!1,n;return function(){if(i)return n;if(i=!0,e)try{n=r.apply(t,arguments)}finally{e()}else n=r.apply(t,arguments);return n}}function lp(r,e){let t=KK(r,e);if(t!==-1)return r[t]}function KK(r,e,t=r.length-1){for(let i=t;i>=0;i--){let n=r[i];if(e(n))return i}return-1}function Id(r,e){let t=Cd(r,e);return t===-1?void 0:r[t]}function Cd(r,e,t=0,i=r.length){let n=t,o=i;for(;n<o;){let s=Math.floor((n+o)/2);e(r[s])?n=s+1:o=s}return n-1}function UV(r,e){let t=ev(r,e);return t===r.length?void 0:r[t]}function ev(r,e,t=0,i=r.length){let n=t,o=i;for(;n<o;){let s=Math.floor((n+o)/2);e(r[s])?o=s:n=s+1}return n}var Jb=class r{constructor(e){this._array=e}static assertInvariants=!1;_findLastMonotonousLastIdx=0;_prevFindLastPredicate;findLastMonotonous(e){if(r.assertInvariants){if(this._prevFindLastPredicate){for(let i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let t=Cd(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};function GK(r,e){if(r.length===0)return;let t=r[0];for(let i=1;i<r.length;i++){let n=r[i];e(n,t)>0&&(t=n)}return t}function zV(r,e){if(r.length===0)return;let t=r[0];for(let i=1;i<r.length;i++){let n=r[i];e(n,t)>=0&&(t=n)}return t}function KV(r,e){return GK(r,(t,i)=>-e(t,i))}function GV(r,e){if(r.length===0)return-1;let t=0;for(let i=1;i<r.length;i++){let n=r[i];e(n,r[t])>0&&(t=i)}return t}function Wo(r,e=0){return r[r.length-(1+e)]}function dS(r){if(r.length===0)throw new Error("Invalid tail call");return[r.slice(0,r.length-1),r[r.length-1]]}function li(r,e,t=(i,n)=>i===n){if(r===e)return!0;if(!r||!e||r.length!==e.length)return!1;for(let i=0,n=r.length;i<n;i++)if(!t(r[i],e[i]))return!1;return!0}function jV(r,e){let t=r.length-1;e<t&&(r[e]=r[t]),r.pop()}function qV(r,e,t){return jK(r.length,i=>t(r[i],e))}function jK(r,e){let t=0,i=r-1;for(;t<=i;){let n=(t+i)/2|0,o=e(n);if(o<0)t=n+1;else if(o>0)i=n-1;else return n}return-(t+1)}function*sm(r,e){let t,i;for(let n of r)i!==void 0&&e(i,n)?t.push(n):(t&&(yield t),t=[n]),i=n;t&&(yield t)}function cS(r,e){for(let t=0;t<=r.length;t++)e(t===0?void 0:r[t-1],t===r.length?void 0:r[t])}function $V(r,e){for(let t=0;t<r.length;t++)e(t===0?void 0:r[t-1],r[t],t+1===r.length?void 0:r[t+1])}function ni(r){return r.filter(e=>!!e)}function KR(r){let e=0;for(let t=0;t<r.length;t++)r[t]&&(r[e]=r[t],e+=1);r.length=e}function fa(r,e=t=>t){let t=new Set;return r.filter(i=>{let n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function YV(r,e,t=(i,n)=>i===n){let i=0;for(let n=0,o=Math.min(r.length,e.length);n<o&&t(r[n],e[n]);n++)i++;return i}function _n(r,e){let t=typeof e=="number"?r:0;typeof e=="number"?t=r:(t=0,e=r);let i=[];if(t<=e)for(let n=t;n<e;n++)i.push(n);else for(let n=t;n>e;n--)i.push(n);return i}function am(r,e){return r.push(e),()=>qK(r,e)}function qK(r,e){let t=r.indexOf(e);if(t>-1)return r.splice(t,1),e}function cl(r,e,t){let i=r.slice(0,e),n=r.slice(e);return i.concat(t,n)}function uS(r,e){let t=r.indexOf(e);t>-1&&(r.splice(t,1),r.unshift(e))}function tv(r,e){let t=r.indexOf(e);t>-1&&(r.splice(t,1),r.push(e))}function iv(r,e){for(let t of e)r.push(t)}function $K(r,e,t){let i=ZV(r,e),n=r.length,o=t.length;r.length=n+o;for(let s=n-1;s>=i;s--)r[s+o]=r[s];for(let s=0;s<o;s++)r[s+i]=t[s]}function GR(r,e,t,i){let n=ZV(r,e),o=r.splice(n,t);return o===void 0&&(o=[]),$K(r,n,i),o}function ZV(r,e){return e<0?Math.max(e+r.length,0):Math.min(e,r.length)}var lS;(a=>{function r(l){return l<0}a.isLessThan=r;function e(l){return l<=0}a.isLessThanOrEqual=e;function t(l){return l>0}a.isGreaterThan=t;function i(l){return l===0}a.isNeitherLessOrGreaterThan=i,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(lS||={});function ir(r,e){return(t,i)=>e(r(t),r(i))}function XV(...r){return(e,t)=>{for(let i of r){let n=i(e,t);if(!lS.isNeitherLessOrGreaterThan(n))return n}return lS.neitherLessOrGreaterThan}}var ul=(r,e)=>r-e,QV=(r,e)=>ul(r?1:0,e?1:0);function JV(r){return(e,t)=>-r(e,t)}var Do=class{constructor(e){this.items=e}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},Sd=class r{constructor(e){this.iterate=e}static empty=new r(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new r(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new r(t=>this.iterate(i=>t(e(i))))}some(e){let t=!1;return this.iterate(i=>(t=e(i),!t)),t}findFirst(e){let t;return this.iterate(i=>e(i)?(t=i,!1):!0),t}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||lS.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}};function eW(r,e){let t=new Set;for(let i of e)r.has(i)&&t.add(i);return t}var lm="en",rv=!1,sv=!1,ov=!1,YK=!1,oW=!1,qR=!1,ZK=!1,$R=!1,XK=!1,rW=!1,nv,pS=lm,tW=lm,QK,Ed,wd=globalThis,ms;typeof wd.vscode<"u"&&typeof wd.vscode.process<"u"?ms=wd.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(ms=process);var sW=typeof ms?.versions?.electron=="string",JK=sW&&ms?.type==="renderer";if(typeof ms=="object"){rv=ms.platform==="win32",sv=ms.platform==="darwin",ov=ms.platform==="linux",YK=ov&&!!ms.env.SNAP&&!!ms.env.SNAP_REVISION,ZK=sW,XK=!!ms.env.CI||!!ms.env.BUILD_ARTIFACTSTAGINGDIRECTORY,nv=lm,pS=lm;let r=ms.env.VSCODE_NLS_CONFIG;if(r)try{let e=JSON.parse(r);nv=e.userLocale,tW=e.osLocale,pS=e.resolvedLanguage||lm,QK=e.languagePack?.translationsConfigFile}catch{}oW=!0}else typeof navigator=="object"&&!JK?(Ed=navigator.userAgent,rv=Ed.indexOf("Windows")>=0,sv=Ed.indexOf("Macintosh")>=0,$R=(Ed.indexOf("Macintosh")>=0||Ed.indexOf("iPad")>=0||Ed.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,ov=Ed.indexOf("Linux")>=0,rW=Ed?.indexOf("Mobi")>=0,qR=!0,pS=Xb()||lm,nv=navigator.language.toLowerCase(),tW=nv):console.error("Unable to resolve platform.");var jR=0;sv?jR=1:rv?jR=3:ov&&(jR=2);var dt=rv,ke=sv,_t=ov;var Pr=oW;var on=qR,e6=qR&&typeof wd.importScripts=="function",aW=e6?wd.origin:void 0,zs=$R,hS=rW;var hl=Ed,pl=pS,t6;(i=>{function r(){return pl}i.value=r;function e(){return pl.length===2?pl==="en":pl.length>=3?pl[0]==="e"&&pl[1]==="n"&&pl[2]==="-":!1}i.isDefaultVariant=e;function t(){return pl==="en"}i.isDefault=t})(t6||={});var lW=nv;var i6=typeof wd.postMessage=="function"&&!wd.importScripts,mS=(()=>{if(i6){let r=[];wd.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=r.length;i<n;i++){let o=r[i];if(o.id===t.data.vscodeScheduleAsyncWork){r.splice(i,1),o.callback();return}}});let e=0;return t=>{let i=++e;r.push({id:i,callback:t}),wd.postMessage({vscodeScheduleAsyncWork:i},"*")}}return r=>setTimeout(r)})();var nr=sv||$R?2:rv?1:3,iW=!0,nW=!1;function dW(){if(!nW){nW=!0;let r=new Uint8Array(2);r[0]=1,r[1]=2,iW=new Uint16Array(r.buffer)[0]===513}return iW}var YR=!!(hl&&hl.indexOf("Chrome")>=0),gS=!!(hl&&hl.indexOf("Firefox")>=0),cW=!!(!YR&&hl&&hl.indexOf("Safari")>=0),uW=!!(hl&&hl.indexOf("Edg/")>=0),pW=!!(hl&&hl.indexOf("Android")>=0);var dp,ZR=globalThis.vscode;if(typeof ZR<"u"&&typeof ZR.process<"u"){let r=ZR.process;dp={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?dp={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:dp={get platform(){return dt?"win32":ke?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var av=dp.cwd,Ks=dp.env,XR=dp.platform,n6=dp.arch;var r6=65,s6=97,a6=90,l6=122,_c=46,Lo=47,Nr=92,xc=58,d6=63,fS=class extends Error{code;constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";let o=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${o} ${n} of type ${t}`;s+=`. Received type ${typeof i}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function c6(r,e){if(r===null||typeof r!="object")throw new fS(e,"Object",r)}function In(r,e){if(typeof r!="string")throw new fS(e,"string",r)}var Fr=XR==="win32";function Pt(r){return r===Lo||r===Nr}function QR(r){return r===Lo}function Tc(r){return r>=r6&&r<=a6||r>=s6&&r<=l6}function bS(r,e,t,i){let n="",o=0,s=-1,a=0,l=0;for(let d=0;d<=r.length;++d){if(d<r.length)l=r.charCodeAt(d);else{if(i(l))break;l=Lo}if(i(l)){if(!(s===d-1||a===1))if(a===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==_c||n.charCodeAt(n.length-2)!==_c){if(n.length>2){let c=n.lastIndexOf(t);c===-1?(n="",o=0):(n=n.slice(0,c),o=n.length-1-n.lastIndexOf(t)),s=d,a=0;continue}else if(n.length!==0){n="",o=0,s=d,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",o=2)}else n.length>0?n+=`${t}${r.slice(s+1,d)}`:n=r.slice(s+1,d),o=d-s-1;s=d,a=0}else l===_c&&a!==-1?++a:a=-1}return n}function u6(r){return r?`${r[0]==="."?"":"."}${r}`:""}function hW(r,e){c6(e,"pathObject");let t=e.dir||e.root,i=e.base||`${e.name||""}${u6(e.ext)}`;return t?t===e.root?`${t}${i}`:`${t}${r}${i}`:i}var Fi={resolve(...r){let e="",t="",i=!1;for(let n=r.length-1;n>=-1;n--){let o;if(n>=0){if(o=r[n],In(o,`paths[${n}]`),o.length===0)continue}else e.length===0?o=av():(o=Ks[`=${e}`]||av(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Nr)&&(o=`${e}\\`));let s=o.length,a=0,l="",d=!1,c=o.charCodeAt(0);if(s===1)Pt(c)&&(a=1,d=!0);else if(Pt(c))if(d=!0,Pt(o.charCodeAt(1))){let u=2,p=u;for(;u<s&&!Pt(o.charCodeAt(u));)u++;if(u<s&&u!==p){let m=o.slice(p,u);for(p=u;u<s&&Pt(o.charCodeAt(u));)u++;if(u<s&&u!==p){for(p=u;u<s&&!Pt(o.charCodeAt(u));)u++;(u===s||u!==p)&&(l=`\\\\${m}\\${o.slice(p,u)}`,a=u)}}}else a=1;else Tc(c)&&o.charCodeAt(1)===xc&&(l=o.slice(0,2),a=2,s>2&&Pt(o.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,i=d,d&&e.length>0)break}return t=bS(t,!i,"\\",Pt),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){In(r,"path");let e=r.length;if(e===0)return".";let t=0,i,n=!1,o=r.charCodeAt(0);if(e===1)return QR(o)?"\\":r;if(Pt(o))if(n=!0,Pt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Pt(r.charCodeAt(a));)a++;if(a<e&&a!==l){let d=r.slice(l,a);for(l=a;a<e&&Pt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Pt(r.charCodeAt(a));)a++;if(a===e)return`\\\\${d}\\${r.slice(l)}\\`;a!==l&&(i=`\\\\${d}\\${r.slice(l,a)}`,t=a)}}}else t=1;else Tc(o)&&r.charCodeAt(1)===xc&&(i=r.slice(0,2),t=2,e>2&&Pt(r.charCodeAt(2))&&(n=!0,t=3));let s=t<e?bS(r.slice(t),!n,"\\",Pt):"";return s.length===0&&!n&&(s="."),s.length>0&&Pt(r.charCodeAt(e-1))&&(s+="\\"),i===void 0?n?`\\${s}`:s:n?`${i}\\${s}`:`${i}${s}`},isAbsolute(r){In(r,"path");let e=r.length;if(e===0)return!1;let t=r.charCodeAt(0);return Pt(t)||e>2&&Tc(t)&&r.charCodeAt(1)===xc&&Pt(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let o=0;o<r.length;++o){let s=r[o];In(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&Pt(t.charCodeAt(0))){++n;let o=t.length;o>1&&Pt(t.charCodeAt(1))&&(++n,o>2&&(Pt(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&Pt(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return Fi.normalize(e)},relative(r,e){if(In(r,"from"),In(e,"to"),r===e)return"";let t=Fi.resolve(r),i=Fi.resolve(e);if(t===i||(r=t.toLowerCase(),e=i.toLowerCase(),r===e))return"";let n=0;for(;n<r.length&&r.charCodeAt(n)===Nr;)n++;let o=r.length;for(;o-1>n&&r.charCodeAt(o-1)===Nr;)o--;let s=o-n,a=0;for(;a<e.length&&e.charCodeAt(a)===Nr;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Nr;)l--;let d=l-a,c=s<d?s:d,u=-1,p=0;for(;p<c;p++){let f=r.charCodeAt(n+p);if(f!==e.charCodeAt(a+p))break;f===Nr&&(u=p)}if(p!==c){if(u===-1)return i}else{if(d>c){if(e.charCodeAt(a+p)===Nr)return i.slice(a+p+1);if(p===2)return i.slice(a+p)}s>c&&(r.charCodeAt(n+p)===Nr?u=p:p===2&&(u=3)),u===-1&&(u=0)}let m="";for(p=n+u+1;p<=o;++p)(p===o||r.charCodeAt(p)===Nr)&&(m+=m.length===0?"..":"\\..");return a+=u,m.length>0?`${m}${i.slice(a,l)}`:(i.charCodeAt(a)===Nr&&++a,i.slice(a,l))},toNamespacedPath(r){if(typeof r!="string"||r.length===0)return r;let e=Fi.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Nr){if(e.charCodeAt(1)===Nr){let t=e.charCodeAt(2);if(t!==d6&&t!==_c)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Tc(e.charCodeAt(0))&&e.charCodeAt(1)===xc&&e.charCodeAt(2)===Nr)return`\\\\?\\${e}`;return r},dirname(r){In(r,"path");let e=r.length;if(e===0)return".";let t=-1,i=0,n=r.charCodeAt(0);if(e===1)return Pt(n)?r:".";if(Pt(n)){if(t=i=1,Pt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Pt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Pt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Pt(r.charCodeAt(a));)a++;if(a===e)return r;a!==l&&(t=i=a+1)}}}}else Tc(n)&&r.charCodeAt(1)===xc&&(t=e>2&&Pt(r.charCodeAt(2))?3:2,i=t);let o=-1,s=!0;for(let a=e-1;a>=i;--a)if(Pt(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(t===-1)return".";o=t}return r.slice(0,o)},basename(r,e){e!==void 0&&In(e,"suffix"),In(r,"path");let t=0,i=-1,n=!0,o;if(r.length>=2&&Tc(r.charCodeAt(0))&&r.charCodeAt(1)===xc&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=t;--o){let l=r.charCodeAt(o);if(Pt(l)){if(!n){t=o+1;break}}else a===-1&&(n=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(i=o):(s=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(o=r.length-1;o>=t;--o)if(Pt(r.charCodeAt(o))){if(!n){t=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":r.slice(t,i)},extname(r){In(r,"path");let e=0,t=-1,i=0,n=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===xc&&Tc(r.charCodeAt(0))&&(e=i=2);for(let a=r.length-1;a>=e;--a){let l=r.charCodeAt(a);if(Pt(l)){if(!o){i=a+1;break}continue}n===-1&&(o=!1,n=a+1),l===_c?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||n===-1||s===0||s===1&&t===n-1&&t===i+1?"":r.slice(t,n)},format:hW.bind(null,"\\"),parse(r){In(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.length,i=0,n=r.charCodeAt(0);if(t===1)return Pt(n)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(Pt(n)){if(i=1,Pt(r.charCodeAt(1))){let u=2,p=u;for(;u<t&&!Pt(r.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&Pt(r.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&!Pt(r.charCodeAt(u));)u++;u===t?i=u:u!==p&&(i=u+1)}}}}else if(Tc(n)&&r.charCodeAt(1)===xc){if(t<=2)return e.root=e.dir=r,e;if(i=2,Pt(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;i=3}}i>0&&(e.root=r.slice(0,i));let o=-1,s=i,a=-1,l=!0,d=r.length-1,c=0;for(;d>=i;--d){if(n=r.charCodeAt(d),Pt(n)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),n===_c?o===-1?o=d:c!==1&&(c=1):o!==-1&&(c=-1)}return a!==-1&&(o===-1||c===0||c===1&&o===a-1&&o===s+1?e.base=e.name=r.slice(s,a):(e.name=r.slice(s,o),e.base=r.slice(s,a),e.ext=r.slice(o,a))),s>0&&s!==i?e.dir=r.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},p6=(()=>{if(Fr){let r=/\\/g;return()=>{let e=av().replace(r,"/");return e.slice(e.indexOf("/"))}}return()=>av()})(),ft={resolve(...r){let e="",t=!1;for(let i=r.length-1;i>=-1&&!t;i--){let n=i>=0?r[i]:p6();In(n,`paths[${i}]`),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===Lo)}return e=bS(e,!t,"/",QR),t?`/${e}`:e.length>0?e:"."},normalize(r){if(In(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===Lo,t=r.charCodeAt(r.length-1)===Lo;return r=bS(r,!e,"/",QR),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return In(r,"path"),r.length>0&&r.charCodeAt(0)===Lo},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){let i=r[t];In(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":ft.normalize(e)},relative(r,e){if(In(r,"from"),In(e,"to"),r===e||(r=ft.resolve(r),e=ft.resolve(e),r===e))return"";let t=1,i=r.length,n=i-t,o=1,s=e.length-o,a=n<s?n:s,l=-1,d=0;for(;d<a;d++){let u=r.charCodeAt(t+d);if(u!==e.charCodeAt(o+d))break;u===Lo&&(l=d)}if(d===a)if(s>a){if(e.charCodeAt(o+d)===Lo)return e.slice(o+d+1);if(d===0)return e.slice(o+d)}else n>a&&(r.charCodeAt(t+d)===Lo?l=d:d===0&&(l=0));let c="";for(d=t+l+1;d<=i;++d)(d===i||r.charCodeAt(d)===Lo)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(In(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===Lo,t=-1,i=!0;for(let n=r.length-1;n>=1;--n)if(r.charCodeAt(n)===Lo){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&In(e,"ext"),In(r,"path");let t=0,i=-1,n=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===Lo){if(!n){t=o+1;break}}else a===-1&&(n=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(i=o):(s=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===Lo){if(!n){t=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":r.slice(t,i)},extname(r){In(r,"path");let e=-1,t=0,i=-1,n=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===Lo){if(!n){t=s+1;break}continue}i===-1&&(n=!1,i=s+1),a===_c?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||i===-1||o===0||o===1&&e===i-1&&e===t+1?"":r.slice(e,i)},format:hW.bind(null,"/"),parse(r){In(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.charCodeAt(0)===Lo,i;t?(e.root="/",i=1):i=0;let n=-1,o=0,s=-1,a=!0,l=r.length-1,d=0;for(;l>=i;--l){let c=r.charCodeAt(l);if(c===Lo){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===_c?n===-1?n=l:d!==1&&(d=1):n!==-1&&(d=-1)}if(s!==-1){let c=o===0&&t?1:o;n===-1||d===0||d===1&&n===s-1&&n===o+1?e.base=e.name=r.slice(c,s):(e.name=r.slice(c,n),e.base=r.slice(c,s),e.ext=r.slice(n,s))}return o>0?e.dir=r.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};ft.win32=Fi.win32=Fi;ft.posix=Fi.posix=ft;var ml=Fr?Fi.normalize:ft.normalize,cp=Fr?Fi.isAbsolute:ft.isAbsolute,fr=Fr?Fi.join:ft.join,dm=Fr?Fi.resolve:ft.resolve,vS=Fr?Fi.relative:ft.relative,yS=Fr?Fi.dirname:ft.dirname,ba=Fr?Fi.basename:ft.basename,Dc=Fr?Fi.extname:ft.extname,ite=Fr?Fi.format:ft.format,nte=Fr?Fi.parse:ft.parse,ote=Fr?Fi.toNamespacedPath:ft.toNamespacedPath,jn=Fr?Fi.sep:ft.sep,rte=Fr?Fi.delimiter:ft.delimiter;var m6=/^\w[\w\d+.-]*$/,g6=/^\//,f6=/^\/\//;function b6(r,e){if(!r.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${r.authority}", path: "${r.path}", query: "${r.query}", fragment: "${r.fragment}"}`);if(r.scheme&&!m6.test(r.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(r.path){if(r.authority){if(!g6.test(r.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(f6.test(r.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function v6(r,e){return!r&&!e?"file":r}function y6(r,e){switch(r){case"https":case"http":case"file":e?e[0]!==va&&(e=va+e):e=va;break}return e}var Bi="",va="/",I6=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,X=class r{static isUri(e){return e instanceof r?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,i,n,o,s=!1){typeof e=="object"?(this.scheme=e.scheme||Bi,this.authority=e.authority||Bi,this.path=e.path||Bi,this.query=e.query||Bi,this.fragment=e.fragment||Bi):(this.scheme=v6(e,s),this.authority=t||Bi,this.path=y6(this.scheme,i||Bi),this.query=n||Bi,this.fragment=o||Bi,b6(this,s))}get fsPath(){return lv(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:o,fragment:s}=e;return t===void 0?t=this.scheme:t===null&&(t=Bi),i===void 0?i=this.authority:i===null&&(i=Bi),n===void 0?n=this.path:n===null&&(n=Bi),o===void 0?o=this.query:o===null&&(o=Bi),s===void 0?s=this.fragment:s===null&&(s=Bi),t===this.scheme&&i===this.authority&&n===this.path&&o===this.query&&s===this.fragment?this:new Lc(t,i,n,o,s)}static parse(e,t=!1){let i=I6.exec(e);return i?new Lc(i[2]||Bi,IS(i[4]||Bi),IS(i[5]||Bi),IS(i[7]||Bi),IS(i[9]||Bi),t):new Lc(Bi,Bi,Bi,Bi,Bi)}static file(e){let t=Bi;if(dt&&(e=e.replace(/\\/g,va)),e[0]===va&&e[1]===va){let i=e.indexOf(va,2);i===-1?(t=e.substring(2),e=va):(t=e.substring(2,i),e=e.substring(i)||va)}return new Lc("file",t,e,Bi,Bi)}static from(e,t){return new Lc(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return dt&&e.scheme==="file"?i=r.file(Fi.join(lv(e,!0),...t)).path:i=ft.join(e.path,...t),e.with({path:i})}toString(e=!1){return e0(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof r)return e;{let t=new Lc(e);return t._formatted=e.external??null,t._fsPath=e._sep===fW?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var fW=dt?1:void 0,Lc=class extends X{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=lv(this,!1)),this._fsPath}toString(e=!1){return e?e0(this,!0):(this._formatted||(this._formatted=e0(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=fW),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},bW={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function mW(r,e,t){let i,n=-1;for(let o=0;o<r.length;o++){let s=r.charCodeAt(o);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47||t&&s===91||t&&s===93||t&&s===58)n!==-1&&(i+=encodeURIComponent(r.substring(n,o)),n=-1),i!==void 0&&(i+=r.charAt(o));else{i===void 0&&(i=r.substr(0,o));let a=bW[s];a!==void 0?(n!==-1&&(i+=encodeURIComponent(r.substring(n,o)),n=-1),i+=a):n===-1&&(n=o)}}return n!==-1&&(i+=encodeURIComponent(r.substring(n))),i!==void 0?i:r}function C6(r){let e;for(let t=0;t<r.length;t++){let i=r.charCodeAt(t);i===35||i===63?(e===void 0&&(e=r.substr(0,t)),e+=bW[i]):e!==void 0&&(e+=r[t])}return e!==void 0?e:r}function lv(r,e){let t;return r.authority&&r.path.length>1&&r.scheme==="file"?t=`//${r.authority}${r.path}`:r.path.charCodeAt(0)===47&&(r.path.charCodeAt(1)>=65&&r.path.charCodeAt(1)<=90||r.path.charCodeAt(1)>=97&&r.path.charCodeAt(1)<=122)&&r.path.charCodeAt(2)===58?e?t=r.path.substr(1):t=r.path[1].toLowerCase()+r.path.substr(2):t=r.path,dt&&(t=t.replace(/\//g,"\\")),t}function e0(r,e){let t=e?C6:mW,i="",{scheme:n,authority:o,path:s,query:a,fragment:l}=r;if(n&&(i+=n,i+=":"),(o||n==="file")&&(i+=va,i+=va),o){let d=o.indexOf("@");if(d!==-1){let c=o.substr(0,d);o=o.substr(d+1),d=c.lastIndexOf(":"),d===-1?i+=t(c,!1,!1):(i+=t(c.substr(0,d),!1,!1),i+=":",i+=t(c.substr(d+1),!1,!0)),i+="@"}o=o.toLowerCase(),d=o.lastIndexOf(":"),d===-1?i+=t(o,!1,!0):(i+=t(o.substr(0,d),!1,!0),i+=o.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}i+=t(s,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:mW(l,!1,!1)),i}function vW(r){try{return decodeURIComponent(r)}catch{return r.length>3?r.substr(0,3)+vW(r.substr(3)):r}}var gW=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function IS(r){return r.match(gW)?r.replace(gW,e=>vW(e)):r}function Td(r,e,t){let i=r.get(e);return i===void 0&&(i=t,r.set(e,i)),i}var t0=class{constructor(e,t){this.uri=e;this.value=t}};function S6(r){return Array.isArray(r)}var Cn=class r{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof r)this.map=new Map(e.map),this.toKey=t??r.defaultToKey;else if(S6(e)){this.map=new Map,this.toKey=t??r.defaultToKey;for(let[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??r.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new t0(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}},CS=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(e,t){!e||typeof e=="function"?this._map=new Cn(e):(this._map=new Cn(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,n)=>e.call(t,n,n,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var i0=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let i=this._state,n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){let e=this,t=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:i.key,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}values(){let e=this,t=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:i.value,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}entries(){let e=this,t=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:[i.key,i.value],done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(let[t,i]of e)this.set(t,i)}},n0=class extends i0{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Br=class extends n0{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}};var xd=class{map=new Map;add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){let i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){let i=this.map.get(e);i&&i.forEach(t)}get(e){let t=this.map.get(e);return t||new Set}};var ct;(w=>{function r(E){return E&&typeof E=="object"&&typeof E[Symbol.iterator]=="function"}w.is=r;let e=Object.freeze([]);function t(){return e}w.empty=t;function*i(E){yield E}w.single=i;function n(E){return r(E)?E:i(E)}w.wrap=n;function o(E){return E||e}w.from=o;function*s(E){for(let S=E.length-1;S>=0;S--)yield E[S]}w.reverse=s;function a(E){return!E||E[Symbol.iterator]().next().done===!0}w.isEmpty=a;function l(E){return E[Symbol.iterator]().next().value}w.first=l;function d(E,S){let T=0;for(let D of E)if(S(D,T++))return!0;return!1}w.some=d;function c(E,S){for(let T of E)if(S(T))return T}w.find=c;function*u(E,S){for(let T of E)S(T)&&(yield T)}w.filter=u;function*p(E,S){let T=0;for(let D of E)yield S(D,T++)}w.map=p;function*m(E,S){let T=0;for(let D of E)yield*S(D,T++)}w.flatMap=m;function*f(...E){for(let S of E)yield*S}w.concat=f;function g(E,S,T){let D=T;for(let L of E)D=S(D,L);return D}w.reduce=g;function*b(E,S,T=E.length){for(S<0&&(S+=E.length),T<0?T+=E.length:T>E.length&&(T=E.length);S<T;S++)yield E[S]}w.slice=b;function v(E,S=Number.POSITIVE_INFINITY){let T=[];if(S===0)return[T,E];let D=E[Symbol.iterator]();for(let L=0;L<S;L++){let A=D.next();if(A.done)return[T,w.empty()];T.push(A.value)}return[T,{[Symbol.iterator](){return D}}]}w.consume=v;async function I(E){let S=[];for await(let T of E)S.push(T);return Promise.resolve(S)}w.asyncToArray=I})(ct||={});var E6=!1,up=null;function w6(r){up=r}if(E6){let r="__is_disposable_tracked__";w6(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[r]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==P.None)try{e[r]=!0}catch{}}markAsDisposed(e){if(e&&e!==P.None)try{e[r]=!0}catch{}}markAsSingleton(e){}})}function pp(r){return up?.trackDisposable(r),r}function hp(r){up?.markAsDisposed(r)}function dv(r,e){up?.setParent(r,e)}function x6(r,e){if(up)for(let t of r)up.setParent(t,e)}function gl(r){return up?.markAsSingleton(r),r}function yW(r){return typeof r=="object"&&r!==null&&typeof r.dispose=="function"&&r.dispose.length===0}function ht(r){if(ct.is(r)){let e=[];for(let t of r)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}function un(...r){let e=te(()=>ht(r));return x6(r,e),e}function te(r){let e=pp({dispose:ps(()=>{hp(e),r()})});return e}var Y=class r{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){pp(this)}dispose(){this._isDisposed||(hp(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{ht(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return dv(e,this),this._isDisposed?r.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),dv(e,null))}},P=class{static None=Object.freeze({dispose(){}});_store=new Y;constructor(){pp(this),dv(this._store,this)}dispose(){hp(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},xt=class{_value;_isDisposed=!1;constructor(){pp(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&dv(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,hp(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&dv(e,null),e}};var br=class{_store=new Map;_isDisposed=!1;constructor(){pp(this)}dispose(){hp(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{ht(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,i=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var en=class r{static Undefined=new r(void 0);element;next;prev;constructor(e){this.element=e,this.next=r.Undefined,this.prev=r.Undefined}},ko=class{_first=en.Undefined;_last=en.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===en.Undefined}clear(){let e=this._first;for(;e!==en.Undefined;){let t=e.next;e.prev=en.Undefined,e.next=en.Undefined,e=t}this._first=en.Undefined,this._last=en.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let i=new en(e);if(this._first===en.Undefined)this._first=i,this._last=i;else if(t){let o=this._last;this._last=i,i.prev=o,o.next=i}else{let o=this._first;this._first=i,i.next=o,o.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==en.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==en.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==en.Undefined&&e.next!==en.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===en.Undefined&&e.next===en.Undefined?(this._first=en.Undefined,this._last=en.Undefined):e.next===en.Undefined?(this._last=this._last.prev,this._last.next=en.Undefined):e.prev===en.Undefined&&(this._first=this._first.next,this._first.prev=en.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==en.Undefined;)yield e.element,e=e.next}};var Ro=(r,e)=>r===e;function r0(r=Ro){return(e,t)=>li(e,t,r)}function SS(r,e,t){if(t!==void 0){let i=r;return i==null||e===void 0||e===null?e===i:t(i,e)}else{let i=r;return(n,o)=>n==null||o===void 0||o===null?o===n:i(n,o)}}function CW(r){return JSON.stringify(o0(r))}var T6=0,IW=new WeakMap;function o0(r){if(Array.isArray(r))return r.map(o0);if(r&&typeof r=="object")if(Object.getPrototypeOf(r)===Object.prototype){let e=r,t=Object.create(null);for(let i of Object.keys(e).sort())t[i]=o0(e[i]);return t}else{let e=IW.get(r);return e===void 0&&(e=T6++,IW.set(r,e)),e+"----2b76a038c20c4bcc"}return r}var ji=class{constructor(e,t,i){this.owner=e;this.debugNameSource=t;this.referenceFn=i}getDebugName(e){return xW(e,this)}},SW=new Map,s0=new WeakMap;function xW(r,e){let t=s0.get(r);if(t)return t;let i=_6(r,e);if(i){let n=SW.get(i)??0;n++,SW.set(i,n);let o=n===1?i:`${i}#${n}`;return s0.set(r,o),o}}function _6(r,e){let t=s0.get(r);if(t)return t;let i=e.owner?L6(e.owner)+".":"",n,o=e.debugNameSource;if(o!==void 0)if(typeof o=="function"){if(n=o(),n!==void 0)return i+n}else return i+o;let s=e.referenceFn;if(s!==void 0&&(n=ES(s),n!==void 0))return i+n;if(e.owner!==void 0){let a=D6(e.owner,r);if(a!==void 0)return i+a}}function D6(r,e){for(let t in r)if(r[t]===e)return t}var EW=new Map,wW=new WeakMap;function L6(r){let e=wW.get(r);if(e)return e;let t=k6(r),i=EW.get(t)??0;i++,EW.set(t,i);let n=i===1?t:`${t}#${i}`;return wW.set(r,n),n}function k6(r){let e=r.constructor;return e?e.name:"Object"}function ES(r){let e=r.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(i?i[1]:void 0)?.trim()}function wS(r,e){if(!r)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function cv(r,e="Unreachable"){throw new Error(e)}function a0(r){r||Ge(new Je("Soft Assertion Failed"))}function ya(r){if(!r()){debugger;r(),Ge(new Je("Assertion Failed"))}}function uv(r,e){let t=0;for(;t<r.length-1;){let i=r[t],n=r[t+1];if(!e(i,n))return!1;t++}return!0}function yt(r){return new cm(new ji(void 0,void 0,r),r,void 0,void 0)}function _d(r,e){return new cm(new ji(r.owner,r.debugName,r.debugReferenceFn??e),e,void 0,void 0)}function kc(r,e){return new cm(new ji(r.owner,r.debugName,r.debugReferenceFn??e),e,r.createEmptyChangeSummary,r.handleChange)}function oo(r){let e=new Y,t=_d({owner:void 0,debugName:void 0,debugReferenceFn:r},i=>{e.clear(),r(i,e)});return te(()=>{t.dispose(),e.dispose()})}var cm=class{constructor(e,t,i,n){this._debugNameData=e;this._runFn=t;this.createChangeSummary=i;this._handleChange=n;this.changeSummary=this.createChangeSummary?.(),Vr()?.handleAutorunCreated(this),this._runIfNeeded(),pp(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),hp(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){Vr()?.handleAutorunTriggered(this);let i=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,i)}catch(n){rm(n)}}}finally{t||Vr()?.handleAutorunFinished(this);for(let i of this.dependenciesToBeRemoved)i.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}ya(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:n=>n===e},this.changeSummary):!0)&&(this.state=2)}catch(i){rm(i)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=cm)(yt||={});function We(r,e){return e!==void 0?new Dd(new ji(r,void 0,e),e,void 0,void 0,void 0,Ro):new Dd(new ji(void 0,void 0,r),r,void 0,void 0,void 0,Ro)}function um(r,e,t){return new l0(new ji(r,void 0,e),e,void 0,void 0,void 0,Ro,t)}function fl(r,e){return new Dd(new ji(r.owner,r.debugName,r.debugReferenceFn),e,void 0,void 0,r.onLastObserverRemoved,r.equalsFn??Ro)}TW(fl);function Ld(r,e){let t,i;e===void 0?(t=r,i=void 0):(i=r,t=e);let n=new Y;return new Dd(new ji(i,void 0,t),o=>(n.clear(),t(o,n)),void 0,void 0,()=>n.dispose(),Ro)}function gs(r,e){let t,i;e===void 0?(t=r,i=void 0):(i=r,t=e);let n;return new Dd(new ji(i,void 0,t),o=>{n?n.clear():n=new Y;let s=t(o);return s&&n.add(s),s},void 0,void 0,()=>{n&&(n.dispose(),n=void 0)},Ro)}var Dd=class extends Ia{constructor(t,i,n,o,s=void 0,a){super();this._debugNameData=t;this._computeFn=i;this.createChangeSummary=n;this._handleChange=o;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),Vr()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let i=this.state!==0,n=this.value;this.state=3;let o=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}o=i&&!this._equalityComparator(n,this.value),Vr()?.handleDerivedRecomputed(this,{oldValue:n,newValue:this.value,change:void 0,didChange:o,hadValue:i})}catch(s){rm(s)}if(o)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let i=this.updateCount===1;if(this.state===3&&(this.state=1,!i))for(let n of this.observers)n.handlePossibleChange(this);if(i)for(let n of this.observers)n.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let i=[...this.observers];for(let n of i)n.endUpdate(this)}ya(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let i of this.observers)i.handlePossibleChange(this)}}handleChange(t,i){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let n=!1;try{n=this._handleChange?this._handleChange({changedObservable:t,change:i,didChange:s=>s===t},this.changeSummary):!0}catch(s){rm(s)}let o=this.state===3;if(n&&(this.state===1||o)&&(this.state=2,o))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let i=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),i}addObserver(t){let i=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),i&&t.beginUpdate(this)}removeObserver(t){let i=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),i&&t.endUpdate(this)}},l0=class extends Dd{constructor(t,i,n,o,s=void 0,a,l){super(t,i,n,o,s,a);this.set=l}};function Rc(r){return new d0(r)}var d0=class extends pv{constructor(t){super();this.value=t}get debugName(){return this.toString()}get(){return this.value}addObserver(t){}removeObserver(t){}toString(){return`Const: ${this.value}`}};function zt(...r){let e,t,i;return r.length===3?[e,t,i]=r:[t,i]=r,new bl(new ji(e,void 0,i),t,i,()=>bl.globalTransaction,Ro)}function _W(r,e,t){return new bl(new ji(r.owner,r.debugName,r.debugReferenceFn??t),e,t,()=>bl.globalTransaction,r.equalsFn??Ro)}var bl=class extends Ia{constructor(t,i,n,o,s){super();this._debugNameData=t;this.event=i;this._getValue=n;this._getTransaction=o;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let i=this._getValue(t),n=this.value,o=!this.hasValue||!this._equalityComparator(n,i),s=!1;o&&(this.value=i,this.hasValue&&(s=!0,gp(this._getTransaction(),a=>{Vr()?.handleFromEventObservableTriggered(this,{oldValue:n,newValue:i,change:void 0,didChange:o,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||Vr()?.handleFromEventObservableTriggered(this,{oldValue:n,newValue:i,change:void 0,didChange:o,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=bl;function e(i,n){let o=!1;bl.globalTransaction===void 0&&(bl.globalTransaction=i,o=!0);try{n()}finally{o&&(bl.globalTransaction=void 0)}}t.batchEventsGlobally=e})(zt||={});function ro(r,e){return new c0(r,e)}var c0=class extends Ia{constructor(t,i){super();this.debugName=t;this.event=i}subscription;onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=()=>{mi(t=>{for(let i of this.observers)t.updateObserver(i,this),i.handleChange(this,void 0)},()=>this.debugName)};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}};function mp(r){return typeof r=="string"?new xS(r):new xS(void 0,r)}var xS=class extends Ia{constructor(t,i){super();this._debugName=t;this._owner=i}get debugName(){return new ji(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(t,i){if(!t){mi(n=>{this.trigger(n,i)},()=>`Trigger signal ${this.debugName}`);return}for(let n of this.observers)t.updateObserver(n,this),n.handleChange(this,i)}get(){}};function DW(r){let e=new TS(!1,void 0);return r.addObserver(e),te(()=>{r.removeObserver(e)})}AW(DW);function pm(r,e){let t=new TS(!0,e);return r.addObserver(t),e?e(r.get()):r.reportChanges(),te(()=>{r.removeObserver(t)})}RW(pm);var TS=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};function LW(r,e){let t;return fl({owner:r,debugReferenceFn:e},n=>(t=e(n,t),t))}var _S=class{constructor(e){this.observable=e}get onDidChange(){return z.fromObservableLight(this.observable)}get value(){return this.observable.get()}};function kW(r,e){return LW(r,(t,i)=>i??e(t))}var MW;function OW(r){MW=r}function Vr(){return MW}var DS=class{indentation=0;textToConsoleArgs(e){return M6([hm(N6("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[hm(" "),Ca(mv(e.oldValue,70),{color:"red",strikeThrough:!0}),hm(" "),Ca(mv(e.newValue,60),{color:"green"})]:[hm(" (unchanged)")]:[hm(" "),Ca(mv(e.newValue,60),{color:"green"}),hm(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([hv("observable value changed"),Ca(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return Ca(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(i,n)=>(this.changedObservablesSets.get(e).add(i),t.apply(e,[i,n]))}handleDerivedRecomputed(e,t){let i=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([hv("derived recomputed"),Ca(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(i),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),i.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([hv("observable from event triggered"),Ca(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(i,n)=>(this.changedObservablesSets.get(e).add(i),t.apply(e,[i,n]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([hv("autorun"),Ca(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([hv("transaction"),Ca(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function M6(r){let e=new Array,t=[],i="";function n(s){if("length"in s)for(let a of s)a&&n(a);else"text"in s?(i+=`%c${s.text}`,e.push(s.style),s.data&&t.push(...s.data)):"data"in s&&t.push(...s.data)}n(r);let o=[i,...e];return o.push(...t),o}function hm(r){return Ca(r,{color:"black"})}function hv(r){return Ca(F6(`${r}: `,10),{color:"black",bold:!0})}function Ca(r,e={color:"black"}){function t(n){return Object.entries(n).reduce((o,[s,a])=>`${o}${s}:${a};`,"")}let i={color:e.color};return e.strikeThrough&&(i["text-decoration"]="line-through"),e.bold&&(i["font-weight"]="bold"),{text:r,style:t(i)}}function mv(r,e){switch(typeof r){case"number":return""+r;case"string":return r.length+2<=e?`"${r}"`:`"${r.substr(0,e-7)}"+...`;case"boolean":return r?"true":"false";case"undefined":return"undefined";case"object":return r===null?"null":Array.isArray(r)?O6(r,e):P6(r,e);case"symbol":return r.toString();case"function":return`[[Function${r.name?" "+r.name:""}]]`;default:return""+r}}function O6(r,e){let t="[ ",i=!0;for(let n of r){if(i||(t+=", "),t.length-5>e){t+="...";break}i=!1,t+=`${mv(n,e-t.length)}`}return t+=" ]",t}function P6(r,e){let t="{ ",i=!0;for(let[n,o]of Object.entries(r)){if(i||(t+=", "),t.length-5>e){t+="...";break}i=!1,t+=`${n}: ${mv(o,e-t.length)}`}return t+=" }",t}function N6(r,e){let t="";for(let i=1;i<=e;i++)t+=r;return t}function F6(r,e){for(;r.length<e;)r+=" ";return r}var PW;function RW(r){PW=r}var NW;function AW(r){NW=r}var u0;function TW(r){u0=r}var pv=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let i=t===void 0?void 0:e,n=t===void 0?e:t;return u0({owner:i,debugName:()=>{let o=ES(n);if(o!==void 0)return o;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(n.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:n},o=>n(this.read(o),o))}flatten(){return u0({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(PW(this,t)),this}keepObserved(e){return e.add(NW(this)),this}get debugValue(){return this.get()}},Ia=class extends pv{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function mi(r,e){let t=new Ac(r,e);try{r(t)}finally{t.finish()}}function gp(r,e,t){r?e(r):mi(e,t)}var Ac=class{constructor(e,t){this._fn=e;this._getDebugName=t;Vr()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():ES(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:i,observable:n}=e[t];i.endUpdate(n)}this.updatingObservers=null,Vr()?.handleEndTransaction()}};function Ct(r,e){let t;return typeof r=="string"?t=new ji(void 0,r,void 0):t=new ji(r,void 0,void 0),new mm(t,e,Ro)}var mm=class extends Ia{constructor(t,i,n){super();this._debugNameData=t;this._equalityComparator=n;this._value=i}_value;get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(t,i,n){if(n===void 0&&this._equalityComparator(this._value,t))return;let o;i||(i=o=new Ac(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;this._setValue(t),Vr()?.handleObservableChanged(this,{oldValue:s,newValue:t,change:n,didChange:!0,hadValue:!0});for(let a of this.observers)i.updateObserver(a,this),a.handleChange(this,n)}finally{o&&o.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function h0(r,e){let t;return typeof r=="string"?t=new ji(void 0,r,void 0):t=new ji(r,void 0,void 0),new p0(t,e,Ro)}var p0=class extends mm{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){this._value?.dispose()}};function m0(r,e,t,i){return e||(e=n=>n!=null),new Promise((n,o)=>{let s=!0,a=!1,l=r.map(c=>({isFinished:e(c),error:t?t(c):!1,state:c})),d=yt(c=>{let{isFinished:u,error:p,state:m}=l.read(c);(u||p)&&(s?a=!0:d.dispose(),p?o(p===!0?m:p):n(m))});if(i){let c=i.onCancellationRequested(()=>{d.dispose(),c.dispose(),o(new _o)});if(i.isCancellationRequested){d.dispose(),c.dispose(),o(new _o);return}}s=!1,a&&d.dispose()})}var LS=class extends Ia{constructor(t,i,n){super();this._debugNameData=t;this._equalityComparator=n;this._value=i}_value;_isUpToDate=!0;_deltas=[];get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(let t of this.observers)for(let i of this._deltas)t.handleChange(this,i);this._deltas.length=0}else for(let t of this.observers)t.handleChange(this,void 0)}_updateCounter=0;_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(let t of this.observers)t.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();let t=[...this.observers];for(let i of t)i.endUpdate(this)}}addObserver(t){let i=!this.observers.has(t)&&this._updateCounter>0;super.addObserver(t),i&&t.beginUpdate(this)}removeObserver(t){let i=this.observers.has(t)&&this._updateCounter>0;super.removeObserver(t),i&&t.endUpdate(this)}set(t,i,n){if(n===void 0&&this._equalityComparator(this._value,t))return;let o;i||(i=o=new Ac(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(t),n!==void 0&&this._deltas.push(n),i.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(s,a)=>{},handlePossibleChange:s=>{}},this),this._updateCounter>1)for(let s of this.observers)s.handlePossibleChange(this)}finally{o&&o.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function kS(r,e){return r.lazy?new LS(new ji(r.owner,r.debugName,void 0),e,r.equalsFn??Ro):new mm(new ji(r.owner,r.debugName,void 0),e,r.equalsFn??Ro)}var B6=!1;B6&&OW(new DS);var V6=globalThis.performance&&typeof globalThis.performance.now=="function",Sa=class r{_startTime;_stopTime;_now;static create(e){return new r(e)}constructor(e){this._now=V6&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var RS=Symbol("MicrotaskDelay");var W6=!1,FW=!1,H6=!1,z;(_e=>{_e.None=()=>P.None;function e(re){if(H6){let{onDidAddListener:ne}=re,ge=gv.create(),de=0;re.onDidAddListener=()=>{++de===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),ge.print()),ne?.()}}}function t(re,ne){return m(re,()=>{},0,void 0,!0,void 0,ne)}_e.defer=t;function i(re){return(ne,ge=null,de)=>{let se=!1,De;return De=re(fe=>{if(!se)return De?De.dispose():se=!0,ne.call(ge,fe)},null,de),se&&De.dispose(),De}}_e.once=i;function n(re,ne){return _e.once(_e.filter(re,ne))}_e.onceIf=n;function o(re,ne,ge){return u((de,se=null,De)=>re(fe=>de.call(se,ne(fe)),null,De),ge)}_e.map=o;function s(re,ne,ge){return u((de,se=null,De)=>re(fe=>{ne(fe),de.call(se,fe)},null,De),ge)}_e.forEach=s;function a(re,ne,ge){return u((de,se=null,De)=>re(fe=>ne(fe)&&de.call(se,fe),null,De),ge)}_e.filter=a;function l(re){return re}_e.signal=l;function d(...re){return(ne,ge=null,de)=>{let se=un(...re.map(De=>De(fe=>ne.call(ge,fe))));return p(se,de)}}_e.any=d;function c(re,ne,ge,de){let se=ge;return o(re,De=>(se=ne(se,De),se),de)}_e.reduce=c;function u(re,ne){let ge,de={onWillAddFirstListener(){ge=re(se.fire,se)},onDidRemoveLastListener(){ge?.dispose()}};ne||e(de);let se=new _(de);return ne?.add(se),se.event}function p(re,ne){return ne instanceof Array?ne.push(re):ne&&ne.add(re),re}function m(re,ne,ge=100,de=!1,se=!1,De,fe){let rt,Xe,Pe,Gi=0,Mi,bn={leakWarningThreshold:De,onWillAddFirstListener(){rt=re(ma=>{Gi++,Xe=ne(Xe,ma),de&&!Pe&&(Kn.fire(Xe),Xe=void 0),Mi=()=>{let ii=Xe;Xe=void 0,Pe=void 0,(!de||Gi>1)&&Kn.fire(ii),Gi=0},typeof ge=="number"?(clearTimeout(Pe),Pe=setTimeout(Mi,ge)):Pe===void 0&&(Pe=0,queueMicrotask(Mi))})},onWillRemoveListener(){se&&Gi>0&&Mi?.()},onDidRemoveLastListener(){Mi=void 0,rt.dispose()}};fe||e(bn);let Kn=new _(bn);return fe?.add(Kn),Kn.event}_e.debounce=m;function f(re,ne=0,ge){return _e.debounce(re,(de,se)=>de?(de.push(se),de):[se],ne,void 0,!0,void 0,ge)}_e.accumulate=f;function g(re,ne=(de,se)=>de===se,ge){let de=!0,se;return a(re,De=>{let fe=de||!ne(De,se);return de=!1,se=De,fe},ge)}_e.latch=g;function b(re,ne,ge){return[_e.filter(re,ne,ge),_e.filter(re,de=>!ne(de),ge)]}_e.split=b;function v(re,ne=!1,ge=[],de){let se=ge.slice(),De=re(Xe=>{se?se.push(Xe):rt.fire(Xe)});de&&de.add(De);let fe=()=>{se?.forEach(Xe=>rt.fire(Xe)),se=null},rt=new _({onWillAddFirstListener(){De||(De=re(Xe=>rt.fire(Xe)),de&&de.add(De))},onDidAddFirstListener(){se&&(ne?setTimeout(fe):fe())},onDidRemoveLastListener(){De&&De.dispose(),De=null}});return de&&de.add(rt),rt.event}_e.buffer=v;function I(re,ne){return(de,se,De)=>{let fe=ne(new E);return re(function(rt){let Xe=fe.evaluate(rt);Xe!==w&&de.call(se,Xe)},void 0,De)}}_e.chain=I;let w=Symbol("HaltChainable");class E{steps=[];map(ne){return this.steps.push(ne),this}forEach(ne){return this.steps.push(ge=>(ne(ge),ge)),this}filter(ne){return this.steps.push(ge=>ne(ge)?ge:w),this}reduce(ne,ge){let de=ge;return this.steps.push(se=>(de=ne(de,se),de)),this}latch(ne=(ge,de)=>ge===de){let ge=!0,de;return this.steps.push(se=>{let De=ge||!ne(se,de);return ge=!1,de=se,De?se:w}),this}evaluate(ne){for(let ge of this.steps)if(ne=ge(ne),ne===w)break;return ne}}function S(re,ne,ge=de=>de){let de=(...rt)=>fe.fire(ge(...rt)),se=()=>re.on(ne,de),De=()=>re.removeListener(ne,de),fe=new _({onWillAddFirstListener:se,onDidRemoveLastListener:De});return fe.event}_e.fromNodeEventEmitter=S;function T(re,ne,ge=de=>de){let de=(...rt)=>fe.fire(ge(...rt)),se=()=>re.addEventListener(ne,de),De=()=>re.removeEventListener(ne,de),fe=new _({onWillAddFirstListener:se,onDidRemoveLastListener:De});return fe.event}_e.fromDOMEventEmitter=T;function D(re){return new Promise(ne=>i(re)(ne))}_e.toPromise=D;function L(re){let ne=new _;return re.then(ge=>{ne.fire(ge)},()=>{ne.fire(void 0)}).finally(()=>{ne.dispose()}),ne.event}_e.fromPromise=L;function A(re,ne){return re(ge=>ne.fire(ge))}_e.forward=A;function W(re,ne,ge){return ne(ge),re(de=>ne(de))}_e.runAndSubscribe=W;class j{constructor(ne,ge){this._observable=ne;let de={onWillAddFirstListener:()=>{ne.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{ne.removeObserver(this)}};ge||e(de),this.emitter=new _(de),ge&&ge.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(ne){this._counter++}handlePossibleChange(ne){}handleChange(ne,ge){this._hasChanged=!0}endUpdate(ne){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function G(re,ne){return new j(re,ne).emitter.event}_e.fromObservable=G;function oe(re){return(ne,ge,de)=>{let se=0,De=!1,fe={beginUpdate(){se++},endUpdate(){se--,se===0&&(re.reportChanges(),De&&(De=!1,ne.call(ge)))},handlePossibleChange(){},handleChange(){De=!0}};re.addObserver(fe),re.reportChanges();let rt={dispose(){re.removeObserver(fe)}};return de instanceof Y?de.add(rt):Array.isArray(de)&&de.push(rt),rt}}_e.fromObservableLight=oe})(z||={});var g0=class r{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${r._idPool++}`,r.all.add(this)}start(e){this._stopWatch=new Sa,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},BW=-1;var f0=class r{constructor(e,t,i=(r._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=i}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);let n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let[o,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(o);let l=new b0(a,o);this._errorHandler(l)}return()=>{let o=this._stacks.get(e.value)||0;this._stacks.set(e.value,o-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[i,n]of this._stacks)(!e||t<n)&&(e=[i,n],t=n);return e}},gv=class r{constructor(e){this.value=e}static create(){let e=new Error;return new r(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},b0=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},v0=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},U6=0,gm=class{constructor(e){this.value=e}stack;id=U6++},z6=2,VW=(r,e)=>{if(r instanceof gm)e(r);else for(let t=0;t<r.length;t++){let i=r[t];i&&e(i)}},AS;if(W6){let r=[];setInterval(()=>{r.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(r.join(`
`)),r.length=0)},3e3),AS=new FinalizationRegistry(e=>{typeof e=="string"&&r.push(e)})}var _=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=BW>0||this._options?.leakWarningThreshold?new f0(e?.onListenerError??Ge,this._options?.leakWarningThreshold??BW):void 0,this._perfMon=this._options?._profName?new g0(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(FW){let e=this._listeners;queueMicrotask(()=>{VW(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,i)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new v0(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||Ge)(c),P.None}if(this._disposed)return P.None;t&&(e=e.bind(t));let n=new gm(e),o,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=gv.create(),o=this._leakageMon.check(n.stack,this._size+1)),FW&&(n.stack=s??gv.create()),this._listeners?this._listeners instanceof gm?(this._deliveryQueue??=new MS,this._listeners=[this._listeners,n]):this._listeners.push(n):(this._options?.onWillAddFirstListener?.(this),this._listeners=n,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=te(()=>{AS?.unregister(a),o?.(),this._removeListener(n)});if(i instanceof Y?i.add(a):Array.isArray(i)&&i.push(a),AS){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);AS.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;let n=this._deliveryQueue.current===this;if(this._size*z6<=t.length){let o=0;for(let s=0;s<t.length;s++)t[s]?t[o++]=t[s]:n&&(this._deliveryQueue.end--,o<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=o}}_deliver(e,t){if(!e)return;let i=this._options?.onListenerError||Ge;if(!i){e.value(t);return}try{e.value(t)}catch(n){i(n)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof gm)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},WW=()=>new MS,MS=class{i=-1;end=0;current;value;enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},fm=class extends _{_asyncDeliveryQueue;async fireAsync(e,t,i){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new ko),VW(this._listeners,n=>this._asyncDeliveryQueue.push([n.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[n,o]=this._asyncDeliveryQueue.shift(),s=[],a={...o,token:t,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");i&&(l=i(l,n)),s.push(l)}};try{n(a)}catch(l){Ge(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&Ge(d.reason)})}}},fp=class extends _{_isPaused=0;_eventQueue=new ko;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}},OS=class extends fp{_delay;_handle;constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}},PS=class extends _{_queuedEvents=[];_mergeFn;constructor(e){super(e),this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}},fv=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new _({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){let t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),te(ps(()=>{this.hasListeners&&this.unhook(t);let n=this.events.indexOf(t);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(let e of this.events)e.listener?.dispose();this.events=[]}};var Mc=class{data=[];wrapEvent(e,t,i){return(n,o,s)=>e(a=>{let l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>n.call(o,a)):n.call(o,a);return}let d=l;if(!d){n.call(o,t(i,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=i?d.items.reduce(t,i):d.items.reduce(t),n.call(o,d.reducedResult)})},void 0,s)}bufferEvents(e){let t={buffers:new Array};this.data.push(t);let i=e();return this.data.pop(),t.buffers.forEach(n=>n()),i}},Wr=class{listening=!1;inputEvent=z.None;inputEventListener=P.None;emitter=new _({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}});event=this.emitter.event;set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}};var HW=Object.freeze(function(r,e){let t=setTimeout(r.bind(e),0);return{dispose(){clearTimeout(t)}}}),pn;(i=>{function r(n){return n===i.None||n===i.Cancelled||n instanceof bm?!0:!n||typeof n!="object"?!1:typeof n.isCancellationRequested=="boolean"&&typeof n.onCancellationRequested=="function"}i.isCancellationToken=r,i.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:z.None}),i.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:HW})})(pn||={});var bm=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?HW:(this._emitter||(this._emitter=new _),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Vi=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new bm),this._token}cancel(){this._token?this._token instanceof bm&&this._token.cancel():this._token=pn.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof bm&&this._token.dispose():this._token=pn.None}};function UW(r){return r}var NS=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=UW):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},Oc=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=UW):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let i=this._fn(e);return this._map.set(e,i),this._map2.set(t,i),i}};var Dn=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function bp(r){return r<0?0:r>255?255:r|0}function KW(r){return!r||typeof r!="string"?!0:r.trim().length===0}function GW(r){return r.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function vm(r){return r.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function or(r){return r.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function jW(r,e,t="\u2026"){return r.length<=e?r:`${r.substr(0,e)}${t}`}function qW(r,e,t="\u2026"){if(r.length<=e)return r;let i=Math.ceil(e/2)-t.length/2,n=Math.floor(e/2)-t.length/2;return`${r.substr(0,i)}${t}${r.substr(r.length-n)}`}function $W(r,e=" "){let t=bv(r,e);return vl(t,e)}function bv(r,e){if(!r||!e)return r;let t=e.length;if(t===0||r.length===0)return r;let i=0;for(;r.indexOf(e,i)===i;)i=i+t;return r.substring(i)}function vl(r,e){if(!r||!e)return r;let t=e.length,i=r.length;if(t===0||i===0)return r;let n=i,o=-1;for(;o=r.lastIndexOf(e,n-1),!(o===-1||o+t!==n);){if(o===0)return"";n=o}return r.substring(0,n)}function YW(r){return r.replace(/\*/g,"")}function BS(r,e,t={}){if(!r)throw new Error("Cannot create regex from empty string");e||(r=or(r)),t.wholeWord&&(/\B/.test(r.charAt(0))||(r="\\b"+r),/\B/.test(r.charAt(r.length-1))||(r=r+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(r,i)}function vv(r){return r.split(/\r\n|\r|\n/)}function qi(r){for(let e=0,t=r.length;e<t;e++){let i=r.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function Ln(r,e=0,t=r.length){for(let i=e;i<t;i++){let n=r.charCodeAt(i);if(n!==32&&n!==9)return r.substring(e,i)}return r.substring(e,t)}function fs(r,e=r.length-1){for(let t=e;t>=0;t--){let i=r.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function C0(r,e){return r<e?-1:r>e?1:0}function ZW(r,e,t=0,i=r.length,n=0,o=e.length){for(;t<i&&n<o;t++,n++){let l=r.charCodeAt(t),d=e.charCodeAt(n);if(l<d)return-1;if(l>d)return 1}let s=i-t,a=o-n;return s<a?-1:s>a?1:0}function S0(r,e,t=0,i=r.length,n=0,o=e.length){for(;t<i&&n<o;t++,n++){let l=r.charCodeAt(t),d=e.charCodeAt(n);if(l===d)continue;if(l>=128||d>=128)return ZW(r.toLowerCase(),e.toLowerCase(),t,i,n,o);vp(l)&&(l-=32),vp(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=i-t,a=o-n;return s<a?-1:s>a?1:0}function yv(r){return r>=48&&r<=57}function vp(r){return r>=97&&r<=122}function yl(r){return r>=65&&r<=90}function Ho(r,e){return r.length===e.length&&S0(r,e)===0}function Il(r,e){let t=e.length;return e.length>r.length?!1:S0(r,e,0,t)===0}function Iv(r,e){let t=Math.min(r.length,e.length),i;for(i=0;i<t;i++)if(r.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function Cv(r,e){let t=Math.min(r.length,e.length),i,n=r.length-1,o=e.length-1;for(i=0;i<t;i++)if(r.charCodeAt(n-i)!==e.charCodeAt(o-i))return i;return t}function Di(r){return 55296<=r&&r<=56319}function Pc(r){return 56320<=r&&r<=57343}function VS(r,e){return(r-55296<<10)+(e-56320)+65536}function ym(r,e,t){let i=r.charCodeAt(t);if(Di(i)&&t+1<e){let n=r.charCodeAt(t+1);if(Pc(n))return VS(i,n)}return i}function G6(r,e){let t=r.charCodeAt(e-1);if(Pc(t)&&e>1){let i=r.charCodeAt(e-2);if(Di(i))return VS(i,t)}return t}var yp=class{_str;_len;_offset;get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=G6(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){let e=ym(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},Ip=class{_iterator;get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new yp(e,t)}nextGraphemeLength(){let e=FS.getInstance(),t=this._iterator,i=t.offset,n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let o=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(zW(n,s)){t.setOffset(o);break}n=s}return t.offset-i}prevGraphemeLength(){let e=FS.getInstance(),t=this._iterator,i=t.offset,n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let o=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(zW(s,n)){t.setOffset(o);break}n=s}return i-t.offset}eol(){return this._iterator.eol()}};function Sv(r,e){return new Ip(r,e).nextGraphemeLength()}function E0(r,e){return new Ip(r,e).prevGraphemeLength()}function WS(r,e){e>0&&Pc(r.charCodeAt(e))&&e--;let t=e+Sv(r,e);return[t-E0(r,t),t]}var y0;function j6(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Rd(r){return y0||(y0=j6()),y0.test(r)}var q6=/^[\t\n\r\x20-\x7E]*$/;function Ev(r){return q6.test(r)}var w0=/[\u2028\u2029]/;function HS(r){return w0.test(r)}function bs(r){return r>=11904&&r<=55215||r>=63744&&r<=64255||r>=65281&&r<=65374}function wv(r){return r>=127462&&r<=127487||r===8986||r===8987||r===9200||r===9203||r>=9728&&r<=10175||r===11088||r===11093||r>=127744&&r<=128591||r>=128640&&r<=128764||r>=128992&&r<=129008||r>=129280&&r<=129535||r>=129648&&r<=129782}var XW=String.fromCharCode(65279);function US(r){return!!(r&&r.length>0&&r.charCodeAt(0)===65279)}function zS(r){let e=26;return r=r%(2*e),r<e?String.fromCharCode(97+r):String.fromCharCode(65+r-e)}function zW(r,e){return r===0?e!==5&&e!==7:r===2&&e===3?!1:r===4||r===2||r===3||e===4||e===2||e===3?!0:!(r===8&&(e===8||e===9||e===11||e===12)||(r===11||r===9)&&(e===9||e===10)||(r===12||r===10)&&e===10||e===5||e===13||e===7||r===1||r===13&&e===14||r===6&&e===6)}var FS=class r{static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}_data;constructor(){this._data=$6()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,i=t.length/3,n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}};function $6(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function QW(r,e){if(r===0)return 0;let t=Y6(r,e);if(t!==void 0)return t;let i=new yp(e,r);return i.prevCodePoint(),i.offset}function Y6(r,e){let t=new yp(e,r),i=t.prevCodePoint();for(;Z6(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!wv(i))return;let n=t.offset;return n>0&&t.prevCodePoint()===8205&&(n=t.offset),n}function Z6(r){return 127995<=r&&r<=127999}var I0=class r{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new Dn(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new NS({getCacheKey:JSON.stringify},e=>{function t(c){let u=new Map;for(let p=0;p<c.length;p+=2)u.set(c[p],c[p+1]);return u}function i(c,u){let p=new Map(c);for(let[m,f]of u)p.set(m,f);return p}function n(c,u){if(!c)return u;let p=new Map;for(let[m,f]of c)u.has(m)&&p.set(m,f);return p}let o=this.ambiguousCharacterData.value,s=e.filter(c=>!c.startsWith("_")&&c in o);s.length===0&&(s=["_default"]);let a;for(let c of s){let u=t(o[c]);a=n(a,u)}let l=t(o._common),d=i(l,a);return new r(d)});static getInstance(e){return r.cache.get(Array.from(e))}static _locales=new Dn(()=>Object.keys(r.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return r._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let i=e.codePointAt(t);if(typeof i=="number"&&this.isAmbiguous(i))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};function Wi(r){return typeof r=="string"}function gi(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function so(r){return typeof r=="number"&&!isNaN(r)}function x0(r){return!!r&&typeof r[Symbol.iterator]=="function"}function KS(r){return r===!0||r===!1}function kn(r){return typeof r>"u"}function Ad(r){return!ao(r)}function ao(r){return kn(r)||r===null}function Im(r,e){if(!r)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function at(r){if(ao(r))throw new Error("Assertion Failed: argument is undefined or null");return r}function Cl(...r){let e=[];for(let t=0;t<r.length;t++){let i=r[t];if(ao(i))throw new Error(`Assertion Failed: argument at index ${t} is undefined or null`);e.push(i)}return e}var X6=Object.prototype.hasOwnProperty;function Cp(r){if(!gi(r))return!1;for(let e in r)if(X6.call(r,e))return!1;return!0}function Sp(r){return typeof r=="function"}function JW(r,e){let t=Math.min(r.length,e.length);for(let i=0;i<t;i++)Q6(r[i],e[i])}function Q6(r,e){if(Wi(e)){if(typeof r!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Sp(e)){try{if(r instanceof e)return}catch{}if(!ao(r)&&r.constructor===e||e.length===1&&e.call(void 0,r)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function Nc(r){return r===47||r===92}function xv(r){return r.replace(/[\\/]/g,ft.sep)}function e2(r){return r.indexOf("/")===-1&&(r=xv(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function T0(r,e=ft.sep){if(!r)return"";let t=r.length,i=r.charCodeAt(0);if(Nc(i)){if(Nc(r.charCodeAt(1))&&!Nc(r.charCodeAt(2))){let o=3,s=o;for(;o<t&&!Nc(r.charCodeAt(o));o++);if(s!==o&&!Nc(r.charCodeAt(o+1))){for(o+=1;o<t;o++)if(Nc(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(n2(i)&&r.charCodeAt(1)===58)return Nc(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let n=r.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(Nc(r.charCodeAt(n)))return r.slice(0,n+1)}return""}var J6=/[\\/:\*\?"<>\|]/g,eG=/[/]/g,tG=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function t2(r,e=dt){let t=e?J6:eG;return!(!r||r.length===0||/^\s+$/.test(r)||(t.lastIndex=0,t.test(r))||e&&tG.test(r)||r==="."||r===".."||e&&r[r.length-1]==="."||e&&r.length!==r.trim().length||r.length>255)}function i2(r,e,t){let i=r===e;return!t||i?i:!r||!e?!1:Ho(r,e)}function Tv(r,e,t,i=jn){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!Il(r,e))return!1;if(e.length===r.length)return!0;let o=e.length;return e.charAt(e.length-1)===i&&o--,r.charAt(o)===i}return e.charAt(e.length-1)!==i&&(e+=i),r.indexOf(e)===0}function n2(r){return r>=65&&r<=90||r>=97&&r<=122}function _0(r,e=dt){return e?n2(r.charCodeAt(0))&&r.charCodeAt(1)===58:!1}function o2(r,e=dt){return _0(r,e)?r[0]:void 0}function r2(r,e,t){return e.length>r.length?-1:r===e?0:(t&&(r=r.toLowerCase(),e=e.toLowerCase()),r.indexOf(e))}function s2(r){let e=r.split(":"),t,i,n;for(let o of e){let s=Number(o);so(s)?i===void 0?i=s:n===void 0&&(n=s):t=t?[t,o].join(":"):o}if(!t)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:t,line:i!==void 0?i:void 0,column:n!==void 0?n:i!==void 0?1:void 0}}var ue;(Pe=>(Pe.inMemory="inmemory",Pe.vscode="vscode",Pe.internal="private",Pe.walkThrough="walkThrough",Pe.walkThroughSnippet="walkThroughSnippet",Pe.http="http",Pe.https="https",Pe.file="file",Pe.mailto="mailto",Pe.untitled="untitled",Pe.data="data",Pe.command="command",Pe.vscodeRemote="vscode-remote",Pe.vscodeRemoteResource="vscode-remote-resource",Pe.vscodeManagedRemoteResource="vscode-managed-remote-resource",Pe.vscodeUserData="vscode-userdata",Pe.vscodeCustomEditor="vscode-custom-editor",Pe.vscodeNotebookCell="vscode-notebook-cell",Pe.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Pe.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",Pe.vscodeNotebookCellOutput="vscode-notebook-cell-output",Pe.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",Pe.vscodeNotebookMetadata="vscode-notebook-metadata",Pe.vscodeInteractiveInput="vscode-interactive-input",Pe.vscodeSettings="vscode-settings",Pe.vscodeWorkspaceTrust="vscode-workspace-trust",Pe.vscodeTerminal="vscode-terminal",Pe.vscodeChatCodeBlock="vscode-chat-code-block",Pe.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",Pe.vscodeChatSesssion="vscode-chat-editor",Pe.webviewPanel="webview-panel",Pe.vscodeWebview="vscode-webview",Pe.extension="extension",Pe.vscodeFileResource="vscode-file",Pe.tmp="tmp",Pe.vsls="vsls",Pe.vscodeSourceControl="vscode-scm",Pe.commentsInput="comment",Pe.codeSetting="code-setting",Pe.outputChannel="output"))(ue||={});function Cm(r,e){return X.isUri(r)?Ho(r.scheme,e):Il(r,e+":")}function a2(r,...e){return e.some(t=>Cm(r,t))}var nG="tkn",D0=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=oG(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return ft.join(this._serverRootPath,ue.vscodeRemoteResource)}set(e,t,i){this._hosts[e]=t,this._ports[e]=i}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Ge(a),e}let t=e.authority,i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);let n=this._ports[t],o=this._connectionTokens[t],s=`path=${encodeURIComponent(e.path)}`;return typeof o=="string"&&(s+=`&${nG}=${encodeURIComponent(o)}`),X.from({scheme:on?this._preferredWebSchema:ue.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:s})}},GS=new D0;function oG(r,e){return ft.join(e??"/",`${r.quality??"oss"}-${r.commit??"dev"}`)}var k0="vscode-app",L0=class r{static FALLBACK_AUTHORITY=k0;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===ue.vscodeRemote?GS.rewrite(e):e.scheme===ue.file&&(Pr||aW===`${ue.vscodeFileResource}://${r.FALLBACK_AUTHORITY}`)?e.with({scheme:ue.vscodeFileResource,authority:e.authority||r.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===ue.vscodeFileResource?e.with({scheme:ue.file,authority:e.authority!==r.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(X.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return X.joinPath(X.parse(i,!0),e);let n=fr(i,e);return X.file(n)}return X.parse(t.toUrl(e))}},Hr=new L0,rG;(o=>{let r=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);o.CoopAndCoep=Object.freeze(r.get("3"));let t="vscode-coi";function i(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:X.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(t);if(l)return r.get(l)}o.getHeadersFromQuery=i;function n(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(t,d):s[t]=d}o.addSearchParam=n})(rG||={});function Od(r){return lv(r,!0)}var _v=class{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:C0(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===ue.file)return Tv(Od(e),Od(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(R0(e.authority,t.authority))return Tv(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return X.joinPath(e,...t)}basenameOrAuthority(e){return Hi(e)||e.authority}basename(e){return ft.basename(e.path)}extname(e){return ft.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===ue.file?t=X.file(yS(Od(e))).path:(t=ft.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===ue.file?t=X.file(ml(Od(e))).path:t=ft.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!R0(e.authority,t.authority))return;if(e.scheme===ue.file){let o=vS(Od(e),Od(t));return dt?xv(o):o}let i=e.path||"/",n=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(let s=Math.min(i.length,n.length);o<s&&!(i.charCodeAt(o)!==n.charCodeAt(o)&&i.charAt(o).toLowerCase()!==n.charAt(o).toLowerCase());o++);i=n.substr(0,o)+i.substr(o)}return ft.relative(i,n)}resolvePath(e,t){if(e.scheme===ue.file){let i=X.file(dm(Od(e),t));return e.with({authority:i.authority,path:i.path})}return t=e2(t),e.with({path:ft.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Ho(e,t)}hasTrailingPathSeparator(e,t=jn){if(e.scheme===ue.file){let i=Od(e);return i.length>T0(i).length&&i[i.length-1]===t}else{let i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=jn){return l2(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=jn){let i=!1;if(e.scheme===ue.file){let n=Od(e);i=n!==void 0&&n.length===T0(n).length&&n[n.length-1]===t}else{t="/";let n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!l2(e,t)?e.with({path:e.path+"/"}):e}},Nt=new _v(()=>!1),sG=new _v(r=>r.scheme===ue.file?!_t:!0),Sm=new _v(r=>!0),Li=Nt.isEqual.bind(Nt),A0=Nt.isEqualOrParent.bind(Nt),Roe=Nt.getComparisonKey.bind(Nt),Fc=Nt.basenameOrAuthority.bind(Nt),Hi=Nt.basename.bind(Nt),Ep=Nt.extname.bind(Nt),Gs=Nt.dirname.bind(Nt),It=Nt.joinPath.bind(Nt),Aoe=Nt.normalizePath.bind(Nt),jS=Nt.relativePath.bind(Nt),M0=Nt.resolvePath.bind(Nt),Moe=Nt.isAbsolutePath.bind(Nt),R0=Nt.isEqualAuthority.bind(Nt),l2=Nt.hasTrailingPathSeparator.bind(Nt),Ooe=Nt.removeTrailingPathSeparator.bind(Nt),Poe=Nt.addTrailingPathSeparator.bind(Nt);var Pd;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function n(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[u,p]=c.split(":");u&&p&&a.set(u,p)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(o.META_DATA_MIME,d),a}o.parseMetaData=n})(Pd||={});function ZS(r){return!!r&&typeof r.then=="function"}function xp(r){let e=new Vi,t=r(e.token),i=new Promise((n,o)=>{let s=e.token.onCancellationRequested(()=>{s.dispose(),o(new _o)});Promise.resolve(t).then(a=>{s.dispose(),e.dispose(),n(a)},a=>{s.dispose(),e.dispose(),o(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(n,o){return i.then(n,o)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function Rv(r,e,t){return new Promise((i,n)=>{let o=e.onCancellationRequested(()=>{o.dispose(),i(t)});r.then(i,n).finally(()=>o.dispose())})}function c2(){let r,e;return{promise:new Promise((i,n)=>{r=i,e=n}),resolve:r,reject:e}}var O0=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(n=>{this.activePromise=null,t(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.isDisposed=!0}};var lG=(r,e)=>{let t=!0,i=setTimeout(()=>{t=!1,e()},r);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},dG=r=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,r())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},vs=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,o)=>{this.doResolve=n,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let n=this.task;return this.task=null,n()}}));let i=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===RS?dG(i):lG(t,i),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new _o),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},Dv=class{delayer;throttler;constructor(e){this.delayer=new vs(e),this.throttler=new O0}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},wm=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function hn(r,e){return e?new Promise((t,i)=>{let n=setTimeout(()=>{o.dispose(),t()},r),o=e.onCancellationRequested(()=>{clearTimeout(n),o.dispose(),i(new _o)})}):xp(t=>hn(r,t))}function Av(r,e=0,t){let i=setTimeout(()=>{r(),t&&n.dispose()},e),n=te(()=>{clearTimeout(i),t?.deleteAndLeak(n)});return t?.add(n),n}var Lv=class{_size=0;_isDisposed=!1;runningPromises;maxDegreeOfParalellism;outstandingPromises;_onDrained;constructor(e){this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new _}whenIdle(){return this.size>0?z.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,i)=>{this.outstandingPromises.push({factory:e,c:t,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let e=this.outstandingPromises.shift();this.runningPromises++;let t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}};var Ea=class{_token;_isDisposed=!1;constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new Je("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new Je("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},qS=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new Je("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let n=i.setInterval(()=>{e()},t);this.disposable=te(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},Kt=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var wp=class extends Kt{units=[];constructor(e,t){super(e,t)}work(e){this.units.push(e),this.isScheduled()||this.schedule()}doRun(){let e=this.units;this.units=[],this.runner?.(e)}dispose(){this.units=[],super.dispose()}};var Bc,Em;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Em=(r,e)=>{mS(()=>{if(t)return;let i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Em=(r,e,t)=>{let i=r.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),n=!1;return{dispose(){n||(n=!0,r.cancelIdleCallback(i))}}},Bc=r=>Em(globalThis,r)})();var $S=class{_executor;_handle;_didRun=!1;_value;_error;constructor(e,t){this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=Em(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},kv=class extends $S{constructor(e){super(globalThis,e)}};var YS=class{_running;_queued;isRunning(e){return typeof e=="number"?this._running?.taskId===e:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(e,t,i){return this._running={taskId:e,cancel:()=>i?.(),promise:t},t.then(()=>this.doneRunning(e),()=>this.doneRunning(e)),t}doneRunning(e){this._running&&e===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let e=this._queued;this._queued=void 0,e.run().then(e.promiseResolve,e.promiseReject)}}queue(e){if(this._queued)this._queued.run=e;else{let{promise:t,resolve:i,reject:n}=c2();this._queued={run:e,promise:t,promiseResolve:i,promiseReject:n}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var ys=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new _o)}},Rn;(t=>{async function r(i){let n,o=await Promise.all(i.map(s=>s.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return o}t.settled=r;function e(i){return new Promise(async(n,o)=>{try{await i(n,o)}catch(s){o(s)}})}t.withAsyncBody=e})(Rn||={});var d2=class r{static fromArray(e){return new r(t=>{t.emitMany(e)})}static fromPromise(e){return new r(async t=>{t.emitMany(await e)})}static fromPromises(e){return new r(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new r(async t=>{await Promise.all(e.map(async i=>{for await(let n of i)t.emitOne(n)}))})}static EMPTY=r.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new _,queueMicrotask(async()=>{let i={emitOne:n=>this.emitOne(n),emitMany:n=>this.emitMany(n),reject:n=>this.reject(n)};try{await Promise.resolve(e(i)),this.resolve()}catch(n){this.reject(n)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await z.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new r(async i=>{for await(let n of e)i.emitOne(t(n))})}map(e){return r.map(this,e)}static filter(e,t){return new r(async i=>{for await(let n of e)t(n)&&i.emitOne(n)})}filter(e){return r.filter(this,e)}static coalesce(e){return r.filter(e,t=>!!t)}coalesce(){return r.coalesce(this)}static async toPromise(e){let t=[];for await(let i of e)t.push(i);return t}toPromise(){return r.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var Si=class extends P{_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(e,t="",i="",n=!0,o){super(),this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=o}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}},lo=class extends P{_onWillRun=this._register(new _);onWillRun=this._onWillRun.event;_onDidRun=this._register(new _);onDidRun=this._onDidRun.event;async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{await this.runAction(e,t)}catch(n){i=n}this._onDidRun.fire({action:e,error:i})}async runAction(e,t){await e.run(t)}},sn=class r{static join(...e){let t=[];for(let i of e)i.length&&(t.length?t=[...t,new r,...i]:t=i);return t}static ID="vs.actions.separator";id=r.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}},Nd=class{id;label;class;tooltip="";enabled=!0;checked=void 0;_actions;get actions(){return this._actions}constructor(e,t,i,n){this.id=e,this.label=t,this.class=n,this._actions=i}async run(){}};function co(r){return{id:r.id,label:r.label,tooltip:r.tooltip??r.label,class:r.class,enabled:r.enabled??!0,checked:r.checked,run:async(...e)=>r.run(...e)}}function XS(r,e){let t=r;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}var Re=window;function P0(r){return r===Re?!1:typeof r?.vscodeWindowId=="number"}var Tp=class r{static INSTANCE=new r;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new _;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,t){if(this.getZoomLevel(t)===e)return;let i=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(i,e),this._onDidChangeZoomLevel.fire(i)}mapWindowIdToZoomFactor=new Map;getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}_onDidChangeFullscreen=new _;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(e,t){if(this.isFullscreen(t)===e)return;let i=this.getWindowId(t);this.mapWindowIdToFullScreen.set(i,e),this._onDidChangeFullscreen.fire(i)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};function cG(r,e,t){typeof e=="string"&&(e=r.matchMedia(e)),e.addEventListener("change",t)}function u2(r){return Tp.INSTANCE.getZoomLevel(r)}var are=Tp.INSTANCE.onDidChangeZoomLevel;function p2(r){return Tp.INSTANCE.getZoomFactor(r)}function h2(r,e){Tp.INSTANCE.setFullscreen(r,e)}var lre=Tp.INSTANCE.onDidChangeFullscreen,xm=navigator.userAgent,$i=xm.indexOf("Firefox")>=0,wa=xm.indexOf("AppleWebKit")>=0,Vc=xm.indexOf("Chrome")>=0,Uo=!Vc&&xm.indexOf("Safari")>=0,m2=!Vc&&!Uo&&wa,dre=xm.indexOf("Electron/")>=0,N0=xm.indexOf("Android")>=0,QS=!1;if(typeof Re.matchMedia=="function"){let r=Re.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Re.matchMedia("(display-mode: fullscreen)");QS=r.matches,cG(Re,r,({matches:t})=>{QS&&e.matches||(QS=t)})}function g2(){return QS}var JS={clipboard:{writeText:Pr||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:Pr||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:Pr||g2()?0:navigator.keyboard||Uo?1:2,touch:"ontouchstart"in Re||navigator.maxTouchPoints>0,pointerEvents:Re.PointerEvent&&("ontouchstart"in Re||navigator.maxTouchPoints>0)};var Mv=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},eE=new Mv,F0=new Mv,B0=new Mv,W0=new Array(230),uG={},pG=[],hG=Object.create(null),mG=Object.create(null);var f2=[],V0=[];for(let r=0;r<=193;r++)f2[r]=-1;for(let r=0;r<=132;r++)V0[r]=-1;(function(){let r="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",r,r],[1,1,"Hyper",0,r,0,r,r,r],[1,2,"Super",0,r,0,r,r,r],[1,3,"Fn",0,r,0,r,r,r],[1,4,"FnLock",0,r,0,r,r,r],[1,5,"Suspend",0,r,0,r,r,r],[1,6,"Resume",0,r,0,r,r,r],[1,7,"Turbo",0,r,0,r,r,r],[1,8,"Sleep",0,r,0,"VK_SLEEP",r,r],[1,9,"WakeUp",0,r,0,r,r,r],[0,10,"KeyA",31,"A",65,"VK_A",r,r],[0,11,"KeyB",32,"B",66,"VK_B",r,r],[0,12,"KeyC",33,"C",67,"VK_C",r,r],[0,13,"KeyD",34,"D",68,"VK_D",r,r],[0,14,"KeyE",35,"E",69,"VK_E",r,r],[0,15,"KeyF",36,"F",70,"VK_F",r,r],[0,16,"KeyG",37,"G",71,"VK_G",r,r],[0,17,"KeyH",38,"H",72,"VK_H",r,r],[0,18,"KeyI",39,"I",73,"VK_I",r,r],[0,19,"KeyJ",40,"J",74,"VK_J",r,r],[0,20,"KeyK",41,"K",75,"VK_K",r,r],[0,21,"KeyL",42,"L",76,"VK_L",r,r],[0,22,"KeyM",43,"M",77,"VK_M",r,r],[0,23,"KeyN",44,"N",78,"VK_N",r,r],[0,24,"KeyO",45,"O",79,"VK_O",r,r],[0,25,"KeyP",46,"P",80,"VK_P",r,r],[0,26,"KeyQ",47,"Q",81,"VK_Q",r,r],[0,27,"KeyR",48,"R",82,"VK_R",r,r],[0,28,"KeyS",49,"S",83,"VK_S",r,r],[0,29,"KeyT",50,"T",84,"VK_T",r,r],[0,30,"KeyU",51,"U",85,"VK_U",r,r],[0,31,"KeyV",52,"V",86,"VK_V",r,r],[0,32,"KeyW",53,"W",87,"VK_W",r,r],[0,33,"KeyX",54,"X",88,"VK_X",r,r],[0,34,"KeyY",55,"Y",89,"VK_Y",r,r],[0,35,"KeyZ",56,"Z",90,"VK_Z",r,r],[0,36,"Digit1",22,"1",49,"VK_1",r,r],[0,37,"Digit2",23,"2",50,"VK_2",r,r],[0,38,"Digit3",24,"3",51,"VK_3",r,r],[0,39,"Digit4",25,"4",52,"VK_4",r,r],[0,40,"Digit5",26,"5",53,"VK_5",r,r],[0,41,"Digit6",27,"6",54,"VK_6",r,r],[0,42,"Digit7",28,"7",55,"VK_7",r,r],[0,43,"Digit8",29,"8",56,"VK_8",r,r],[0,44,"Digit9",30,"9",57,"VK_9",r,r],[0,45,"Digit0",21,"0",48,"VK_0",r,r],[1,46,"Enter",3,"Enter",13,"VK_RETURN",r,r],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",r,r],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",r,r],[1,49,"Tab",2,"Tab",9,"VK_TAB",r,r],[1,50,"Space",10,"Space",32,"VK_SPACE",r,r],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,r,0,r,r,r],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",r,r],[1,64,"F1",59,"F1",112,"VK_F1",r,r],[1,65,"F2",60,"F2",113,"VK_F2",r,r],[1,66,"F3",61,"F3",114,"VK_F3",r,r],[1,67,"F4",62,"F4",115,"VK_F4",r,r],[1,68,"F5",63,"F5",116,"VK_F5",r,r],[1,69,"F6",64,"F6",117,"VK_F6",r,r],[1,70,"F7",65,"F7",118,"VK_F7",r,r],[1,71,"F8",66,"F8",119,"VK_F8",r,r],[1,72,"F9",67,"F9",120,"VK_F9",r,r],[1,73,"F10",68,"F10",121,"VK_F10",r,r],[1,74,"F11",69,"F11",122,"VK_F11",r,r],[1,75,"F12",70,"F12",123,"VK_F12",r,r],[1,76,"PrintScreen",0,r,0,r,r,r],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",r,r],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",r,r],[1,79,"Insert",19,"Insert",45,"VK_INSERT",r,r],[1,80,"Home",14,"Home",36,"VK_HOME",r,r],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",r,r],[1,82,"Delete",20,"Delete",46,"VK_DELETE",r,r],[1,83,"End",13,"End",35,"VK_END",r,r],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",r,r],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",r],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",r],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",r],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",r],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",r,r],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",r,r],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",r,r],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",r,r],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",r,r],[1,94,"NumpadEnter",3,r,0,r,r,r],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",r,r],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",r,r],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",r,r],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",r,r],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",r,r],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",r,r],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",r,r],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",r,r],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",r,r],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",r,r],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",r,r],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",r,r],[1,107,"ContextMenu",58,"ContextMenu",93,r,r,r],[1,108,"Power",0,r,0,r,r,r],[1,109,"NumpadEqual",0,r,0,r,r,r],[1,110,"F13",71,"F13",124,"VK_F13",r,r],[1,111,"F14",72,"F14",125,"VK_F14",r,r],[1,112,"F15",73,"F15",126,"VK_F15",r,r],[1,113,"F16",74,"F16",127,"VK_F16",r,r],[1,114,"F17",75,"F17",128,"VK_F17",r,r],[1,115,"F18",76,"F18",129,"VK_F18",r,r],[1,116,"F19",77,"F19",130,"VK_F19",r,r],[1,117,"F20",78,"F20",131,"VK_F20",r,r],[1,118,"F21",79,"F21",132,"VK_F21",r,r],[1,119,"F22",80,"F22",133,"VK_F22",r,r],[1,120,"F23",81,"F23",134,"VK_F23",r,r],[1,121,"F24",82,"F24",135,"VK_F24",r,r],[1,122,"Open",0,r,0,r,r,r],[1,123,"Help",0,r,0,r,r,r],[1,124,"Select",0,r,0,r,r,r],[1,125,"Again",0,r,0,r,r,r],[1,126,"Undo",0,r,0,r,r,r],[1,127,"Cut",0,r,0,r,r,r],[1,128,"Copy",0,r,0,r,r,r],[1,129,"Paste",0,r,0,r,r,r],[1,130,"Find",0,r,0,r,r,r],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",r,r],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",r,r],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",r,r],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",r,r],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",r,r],[1,136,"KanaMode",0,r,0,r,r,r],[0,137,"IntlYen",0,r,0,r,r,r],[1,138,"Convert",0,r,0,r,r,r],[1,139,"NonConvert",0,r,0,r,r,r],[1,140,"Lang1",0,r,0,r,r,r],[1,141,"Lang2",0,r,0,r,r,r],[1,142,"Lang3",0,r,0,r,r,r],[1,143,"Lang4",0,r,0,r,r,r],[1,144,"Lang5",0,r,0,r,r,r],[1,145,"Abort",0,r,0,r,r,r],[1,146,"Props",0,r,0,r,r,r],[1,147,"NumpadParenLeft",0,r,0,r,r,r],[1,148,"NumpadParenRight",0,r,0,r,r,r],[1,149,"NumpadBackspace",0,r,0,r,r,r],[1,150,"NumpadMemoryStore",0,r,0,r,r,r],[1,151,"NumpadMemoryRecall",0,r,0,r,r,r],[1,152,"NumpadMemoryClear",0,r,0,r,r,r],[1,153,"NumpadMemoryAdd",0,r,0,r,r,r],[1,154,"NumpadMemorySubtract",0,r,0,r,r,r],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",r,r],[1,156,"NumpadClearEntry",0,r,0,r,r,r],[1,0,r,5,"Ctrl",17,"VK_CONTROL",r,r],[1,0,r,4,"Shift",16,"VK_SHIFT",r,r],[1,0,r,6,"Alt",18,"VK_MENU",r,r],[1,0,r,57,"Meta",91,"VK_COMMAND",r,r],[1,157,"ControlLeft",5,r,0,"VK_LCONTROL",r,r],[1,158,"ShiftLeft",4,r,0,"VK_LSHIFT",r,r],[1,159,"AltLeft",6,r,0,"VK_LMENU",r,r],[1,160,"MetaLeft",57,r,0,"VK_LWIN",r,r],[1,161,"ControlRight",5,r,0,"VK_RCONTROL",r,r],[1,162,"ShiftRight",4,r,0,"VK_RSHIFT",r,r],[1,163,"AltRight",6,r,0,"VK_RMENU",r,r],[1,164,"MetaRight",57,r,0,"VK_RWIN",r,r],[1,165,"BrightnessUp",0,r,0,r,r,r],[1,166,"BrightnessDown",0,r,0,r,r,r],[1,167,"MediaPlay",0,r,0,r,r,r],[1,168,"MediaRecord",0,r,0,r,r,r],[1,169,"MediaFastForward",0,r,0,r,r,r],[1,170,"MediaRewind",0,r,0,r,r,r],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",r,r],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",r,r],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",r,r],[1,174,"Eject",0,r,0,r,r,r],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",r,r],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",r,r],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",r,r],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",r,r],[1,179,"LaunchApp1",0,r,0,"VK_MEDIA_LAUNCH_APP1",r,r],[1,180,"SelectTask",0,r,0,r,r,r],[1,181,"LaunchScreenSaver",0,r,0,r,r,r],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",r,r],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",r,r],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",r,r],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",r,r],[1,186,"BrowserStop",0,r,0,"VK_BROWSER_STOP",r,r],[1,187,"BrowserRefresh",0,r,0,"VK_BROWSER_REFRESH",r,r],[1,188,"BrowserFavorites",0,r,0,"VK_BROWSER_FAVORITES",r,r],[1,189,"ZoomToggle",0,r,0,r,r,r],[1,190,"MailReply",0,r,0,r,r,r],[1,191,"MailForward",0,r,0,r,r,r],[1,192,"MailSend",0,r,0,r,r,r],[1,0,r,114,"KeyInComposition",229,r,r,r],[1,0,r,116,"ABNT_C2",194,"VK_ABNT_C2",r,r],[1,0,r,96,"OEM_8",223,"VK_OEM_8",r,r],[1,0,r,0,r,0,"VK_KANA",r,r],[1,0,r,0,r,0,"VK_HANGUL",r,r],[1,0,r,0,r,0,"VK_JUNJA",r,r],[1,0,r,0,r,0,"VK_FINAL",r,r],[1,0,r,0,r,0,"VK_HANJA",r,r],[1,0,r,0,r,0,"VK_KANJI",r,r],[1,0,r,0,r,0,"VK_CONVERT",r,r],[1,0,r,0,r,0,"VK_NONCONVERT",r,r],[1,0,r,0,r,0,"VK_ACCEPT",r,r],[1,0,r,0,r,0,"VK_MODECHANGE",r,r],[1,0,r,0,r,0,"VK_SELECT",r,r],[1,0,r,0,r,0,"VK_PRINT",r,r],[1,0,r,0,r,0,"VK_EXECUTE",r,r],[1,0,r,0,r,0,"VK_SNAPSHOT",r,r],[1,0,r,0,r,0,"VK_HELP",r,r],[1,0,r,0,r,0,"VK_APPS",r,r],[1,0,r,0,r,0,"VK_PROCESSKEY",r,r],[1,0,r,0,r,0,"VK_PACKET",r,r],[1,0,r,0,r,0,"VK_DBE_SBCSCHAR",r,r],[1,0,r,0,r,0,"VK_DBE_DBCSCHAR",r,r],[1,0,r,0,r,0,"VK_ATTN",r,r],[1,0,r,0,r,0,"VK_CRSEL",r,r],[1,0,r,0,r,0,"VK_EXSEL",r,r],[1,0,r,0,r,0,"VK_EREOF",r,r],[1,0,r,0,r,0,"VK_PLAY",r,r],[1,0,r,0,r,0,"VK_ZOOM",r,r],[1,0,r,0,r,0,"VK_NONAME",r,r],[1,0,r,0,r,0,"VK_PA1",r,r],[1,0,r,0,r,0,"VK_OEM_CLEAR",r,r]],t=[],i=[];for(let n of e){let[o,s,a,l,d,c,u,p,m]=n;if(i[s]||(i[s]=!0,pG[s]=a,hG[a]=s,mG[a.toLowerCase()]=s,o&&(f2[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(V0[l]=s))),!t[l]){if(t[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);eE.define(l,d),F0.define(l,p||d),B0.define(l,m||p||d)}c&&(W0[c]=l),u&&(uG[u]=l)}V0[3]=46})();var Ov;(s=>{function r(a){return eE.keyCodeToStr(a)}s.toString=r;function e(a){return eE.strToKeyCode(a)}s.fromString=e;function t(a){return F0.keyCodeToStr(a)}s.toUserSettingsUS=t;function i(a){return B0.keyCodeToStr(a)}s.toUserSettingsGeneral=i;function n(a){return F0.strToKeyCode(a)||B0.strToKeyCode(a)}s.fromUserSettings=n;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return eE.keyCodeToStr(a)}s.toElectronAccelerator=o})(Ov||={});function js(r,e){let t=(e&65535)<<16>>>0;return(r|t)>>>0}function H0(r,e){if(typeof r=="number"){if(r===0)return null;let t=(r&65535)>>>0,i=(r&4294901760)>>>16;return i!==0?new Tm([tE(t,e),tE(i,e)]):new Tm([tE(t,e)])}else{let t=[];for(let i=0;i<r.length;i++)t.push(tE(r[i],e));return new Tm(t)}}function tE(r,e){let t=!!(r&2048),i=!!(r&256),n=e===2?i:t,o=!!(r&1024),s=!!(r&512),a=e===2?t:i,l=r&255;return new Pv(n,o,s,a,l)}var Pv=class r{constructor(e,t,i,n,o){this.ctrlKey=e;this.shiftKey=t;this.altKey=i;this.metaKey=n;this.keyCode=o}equals(e){return e instanceof r&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",t=this.shiftKey?"1":"0",i=this.altKey?"1":"0",n=this.metaKey?"1":"0";return`K${e}${t}${i}${n}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new Tm([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var Tm=class{chords;constructor(e){if(e.length===0)throw ap("chords");this.chords=e}getHashCode(){let e="";for(let t=0,i=this.chords.length;t<i;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};function gG(r){if(r.charCode){let t=String.fromCharCode(r.charCode).toUpperCase();return Ov.fromString(t)}let e=r.keyCode;if(e===3)return 7;if($i)switch(e){case 59:return 85;case 60:if(_t)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(ke)return 57;break}else if(wa){if(ke&&e===93)return 57;if(!ke&&e===92)return 57}return W0[e]||0}var fG=ke?256:2048,bG=512,vG=1024,yG=ke?2048:256;var bt=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(e){let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=gG(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=fG),this.altKey&&(t|=bG),this.shiftKey&&(t|=vG),this.metaKey&&(t|=yG),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new Pv(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}};var b2=new WeakMap;function IG(r){if(!r.parent||r.parent===r)return null;try{let e=r.location,t=r.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return r.parent}var iE=class{static getSameOriginWindowChain(e){let t=b2.get(e);if(!t){t=[],b2.set(e,t);let i=e,n;do n=IG(i),n?t.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):t.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,n=0,o=this.getSameOriginWindowChain(e);for(let s of o){let a=s.window.deref();if(i+=a?.scrollY??0,n+=a?.scrollX??0,a===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}};var Ei=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let i=iE.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Cs=class{browserEvent;deltaY;deltaX;target;constructor(e,t=0,i=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t;let n=!1;if(Vc){let o=navigator.userAgent.match(/Chrome\/(\d+)/);n=(o?parseInt(o[1]):123)<=122}if(e){let o=e,s=e,a=e.view?.devicePixelRatio||1;if(typeof o.wheelDeltaY<"u")n?this.deltaY=o.wheelDeltaY/(120*a):this.deltaY=o.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?$i&&!ke?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof o.wheelDeltaX<"u")Uo&&dt?this.deltaX=-(o.wheelDeltaX/120):n?this.deltaX=o.wheelDeltaX/(120*a):this.deltaX=o.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?$i&&!ke?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var{entries:x2,setPrototypeOf:v2,isFrozen:CG,getPrototypeOf:SG,getOwnPropertyDescriptor:EG}=Object,{freeze:vr,seal:Ta,create:wG}=Object,{apply:q0,construct:$0}=typeof Reflect<"u"&&Reflect;q0||(q0=function(e,t,i){return e.apply(t,i)});vr||(vr=function(e){return e});Ta||(Ta=function(e){return e});$0||($0=function(e,t){return new e(...t)});var xG=qs(Array.prototype.forEach),y2=qs(Array.prototype.pop),Nv=qs(Array.prototype.push),rE=qs(String.prototype.toLowerCase),U0=qs(String.prototype.toString),TG=qs(String.prototype.match),xa=qs(String.prototype.replace),_G=qs(String.prototype.indexOf),DG=qs(String.prototype.trim),Ss=qs(RegExp.prototype.test),Fv=LG(TypeError);function qs(r){return function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return q0(r,e,i)}}function LG(r){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return $0(r,t)}}function Vt(r,e,t){var i;t=(i=t)!==null&&i!==void 0?i:rE,v2&&v2(r,null);let n=e.length;for(;n--;){let o=e[n];if(typeof o=="string"){let s=t(o);s!==o&&(CG(e)||(e[n]=s),o=s)}r[o]=!0}return r}function Dm(r){let e=wG(null);for(let[t,i]of x2(r))e[t]=i;return e}function nE(r,e){for(;r!==null;){let i=EG(r,e);if(i){if(i.get)return qs(i.get);if(typeof i.value=="function")return qs(i.value)}r=SG(r)}function t(i){return console.warn("fallback value for",i),null}return t}var I2=vr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),z0=vr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),K0=vr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),kG=vr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),G0=vr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),RG=vr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),C2=vr(["#text"]),S2=vr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),j0=vr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),E2=vr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),oE=vr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),AG=Ta(/\{\{[\w\W]*|[\w\W]*\}\}/gm),MG=Ta(/<%[\w\W]*|[\w\W]*%>/gm),OG=Ta(/\${[\w\W]*}/gm),PG=Ta(/^data-[\-\w.\u00B7-\uFFFF]/),NG=Ta(/^aria-[\-\w]+$/),T2=Ta(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),FG=Ta(/^(?:\w+script|data):/i),BG=Ta(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_2=Ta(/^html$/i),w2=Object.freeze({__proto__:null,MUSTACHE_EXPR:AG,ERB_EXPR:MG,TMPLIT_EXPR:OG,DATA_ATTR:PG,ARIA_ATTR:NG,IS_ALLOWED_URI:T2,IS_SCRIPT_OR_DATA:FG,ATTR_WHITESPACE:BG,DOCTYPE_NAME:_2}),VG=()=>typeof window>"u"?null:window,WG=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null,n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));let o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function D2(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:VG(),e=Ke=>D2(Ke);if(e.version="3.0.5",e.removed=[],!r||!r.document||r.document.nodeType!==9)return e.isSupported=!1,e;let t=r.document,i=t.currentScript,{document:n}=r,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:u,DOMParser:p,trustedTypes:m}=r,f=l.prototype,g=nE(f,"cloneNode"),b=nE(f,"nextSibling"),v=nE(f,"childNodes"),I=nE(f,"parentNode");if(typeof s=="function"){let Ke=n.createElement("template");Ke.content&&Ke.content.ownerDocument&&(n=Ke.content.ownerDocument)}let w,E="",{implementation:S,createNodeIterator:T,createDocumentFragment:D,getElementsByTagName:L}=n,{importNode:A}=t,W={};e.isSupported=typeof x2=="function"&&typeof I=="function"&&S&&S.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:j,ERB_EXPR:G,TMPLIT_EXPR:oe,DATA_ATTR:_e,ARIA_ATTR:re,IS_SCRIPT_OR_DATA:ne,ATTR_WHITESPACE:ge}=w2,{IS_ALLOWED_URI:de}=w2,se=null,De=Vt({},[...I2,...z0,...K0,...G0,...C2]),fe=null,rt=Vt({},[...S2,...j0,...E2,...oE]),Xe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Pe=null,Gi=null,Mi=!0,bn=!0,Kn=!1,ma=!0,ii=!1,wo=!1,rp=!1,yc=!1,xo=!1,Ic=!1,Cc=!1,nm=!0,om=!1,Ye="user-content-",vd=!0,Sc=!1,ol={},Us=null,$b=Vt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),sp=null,Yb=Vt({},["audio","video","img","source","image","track"]),rl=null,Zb=Vt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),sl="http://www.w3.org/1998/Math/MathML",cs="http://www.w3.org/2000/svg",vn="http://www.w3.org/1999/xhtml",us=vn,yd=!1,er=null,Ec=Vt({},[sl,cs,vn],U0),ga,al=["application/xhtml+xml","text/html"],xe="text/html",be,V=null,ce=n.createElement("form"),Ee=function($){return $ instanceof RegExp||$ instanceof Function},ut=function($){if(!(V&&V===$)){if((!$||typeof $!="object")&&($={}),$=Dm($),ga=al.indexOf($.PARSER_MEDIA_TYPE)===-1?ga=xe:ga=$.PARSER_MEDIA_TYPE,be=ga==="application/xhtml+xml"?U0:rE,se="ALLOWED_TAGS"in $?Vt({},$.ALLOWED_TAGS,be):De,fe="ALLOWED_ATTR"in $?Vt({},$.ALLOWED_ATTR,be):rt,er="ALLOWED_NAMESPACES"in $?Vt({},$.ALLOWED_NAMESPACES,U0):Ec,rl="ADD_URI_SAFE_ATTR"in $?Vt(Dm(Zb),$.ADD_URI_SAFE_ATTR,be):Zb,sp="ADD_DATA_URI_TAGS"in $?Vt(Dm(Yb),$.ADD_DATA_URI_TAGS,be):Yb,Us="FORBID_CONTENTS"in $?Vt({},$.FORBID_CONTENTS,be):$b,Pe="FORBID_TAGS"in $?Vt({},$.FORBID_TAGS,be):{},Gi="FORBID_ATTR"in $?Vt({},$.FORBID_ATTR,be):{},ol="USE_PROFILES"in $?$.USE_PROFILES:!1,Mi=$.ALLOW_ARIA_ATTR!==!1,bn=$.ALLOW_DATA_ATTR!==!1,Kn=$.ALLOW_UNKNOWN_PROTOCOLS||!1,ma=$.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ii=$.SAFE_FOR_TEMPLATES||!1,wo=$.WHOLE_DOCUMENT||!1,xo=$.RETURN_DOM||!1,Ic=$.RETURN_DOM_FRAGMENT||!1,Cc=$.RETURN_TRUSTED_TYPE||!1,yc=$.FORCE_BODY||!1,nm=$.SANITIZE_DOM!==!1,om=$.SANITIZE_NAMED_PROPS||!1,vd=$.KEEP_CONTENT!==!1,Sc=$.IN_PLACE||!1,de=$.ALLOWED_URI_REGEXP||T2,us=$.NAMESPACE||vn,Xe=$.CUSTOM_ELEMENT_HANDLING||{},$.CUSTOM_ELEMENT_HANDLING&&Ee($.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Xe.tagNameCheck=$.CUSTOM_ELEMENT_HANDLING.tagNameCheck),$.CUSTOM_ELEMENT_HANDLING&&Ee($.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Xe.attributeNameCheck=$.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),$.CUSTOM_ELEMENT_HANDLING&&typeof $.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Xe.allowCustomizedBuiltInElements=$.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ii&&(bn=!1),Ic&&(xo=!0),ol&&(se=Vt({},[...C2]),fe=[],ol.html===!0&&(Vt(se,I2),Vt(fe,S2)),ol.svg===!0&&(Vt(se,z0),Vt(fe,j0),Vt(fe,oE)),ol.svgFilters===!0&&(Vt(se,K0),Vt(fe,j0),Vt(fe,oE)),ol.mathMl===!0&&(Vt(se,G0),Vt(fe,E2),Vt(fe,oE))),$.ADD_TAGS&&(se===De&&(se=Dm(se)),Vt(se,$.ADD_TAGS,be)),$.ADD_ATTR&&(fe===rt&&(fe=Dm(fe)),Vt(fe,$.ADD_ATTR,be)),$.ADD_URI_SAFE_ATTR&&Vt(rl,$.ADD_URI_SAFE_ATTR,be),$.FORBID_CONTENTS&&(Us===$b&&(Us=Dm(Us)),Vt(Us,$.FORBID_CONTENTS,be)),vd&&(se["#text"]=!0),wo&&Vt(se,["html","head","body"]),se.table&&(Vt(se,["tbody"]),delete Pe.tbody),$.TRUSTED_TYPES_POLICY){if(typeof $.TRUSTED_TYPES_POLICY.createHTML!="function")throw Fv('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof $.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Fv('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=$.TRUSTED_TYPES_POLICY,E=w.createHTML("")}else w===void 0&&(w=WG(m,i)),w!==null&&typeof E=="string"&&(E=w.createHTML(""));vr&&vr($),V=$}},$t=Vt({},["mi","mo","mn","ms","mtext"]),Gn=Vt({},["foreignobject","desc","title","annotation-xml"]),To=Vt({},["title","style","font","a","script"]),Qe=Vt({},z0);Vt(Qe,K0),Vt(Qe,kG);let k=Vt({},G0);Vt(k,RG);let M=function($){let Te=I($);(!Te||!Te.tagName)&&(Te={namespaceURI:us,tagName:"template"});let Ve=rE($.tagName),hi=rE(Te.tagName);return er[$.namespaceURI]?$.namespaceURI===cs?Te.namespaceURI===vn?Ve==="svg":Te.namespaceURI===sl?Ve==="svg"&&(hi==="annotation-xml"||$t[hi]):!!Qe[Ve]:$.namespaceURI===sl?Te.namespaceURI===vn?Ve==="math":Te.namespaceURI===cs?Ve==="math"&&Gn[hi]:!!k[Ve]:$.namespaceURI===vn?Te.namespaceURI===cs&&!Gn[hi]||Te.namespaceURI===sl&&!$t[hi]?!1:!k[Ve]&&(To[Ve]||!Qe[Ve]):!!(ga==="application/xhtml+xml"&&er[$.namespaceURI]):!1},N=function($){Nv(e.removed,{element:$});try{$.parentNode.removeChild($)}catch{$.remove()}},H=function($,Te){try{Nv(e.removed,{attribute:Te.getAttributeNode($),from:Te})}catch{Nv(e.removed,{attribute:null,from:Te})}if(Te.removeAttribute($),$==="is"&&!fe[$])if(xo||Ic)try{N(Te)}catch{}else try{Te.setAttribute($,"")}catch{}},K=function($){let Te,Ve;if(yc)$="<remove></remove>"+$;else{let tr=TG($,/^[\r\n\t ]+/);Ve=tr&&tr[0]}ga==="application/xhtml+xml"&&us===vn&&($='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+$+"</body></html>");let hi=w?w.createHTML($):$;if(us===vn)try{Te=new p().parseFromString(hi,ga)}catch{}if(!Te||!Te.documentElement){Te=S.createDocument(us,"template",null);try{Te.documentElement.innerHTML=yd?E:hi}catch{}}let Tn=Te.body||Te.documentElement;return $&&Ve&&Tn.insertBefore(n.createTextNode(Ve),Tn.childNodes[0]||null),us===vn?L.call(Te,wo?"html":"body")[0]:wo?Te.documentElement:Tn},ee=function($){return T.call($.ownerDocument||$,$,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},le=function($){return $ instanceof u&&(typeof $.nodeName!="string"||typeof $.textContent!="string"||typeof $.removeChild!="function"||!($.attributes instanceof c)||typeof $.removeAttribute!="function"||typeof $.setAttribute!="function"||typeof $.namespaceURI!="string"||typeof $.insertBefore!="function"||typeof $.hasChildNodes!="function")},Le=function($){return typeof a=="object"?$ instanceof a:$&&typeof $=="object"&&typeof $.nodeType=="number"&&typeof $.nodeName=="string"},Ne=function($,Te,Ve){W[$]&&xG(W[$],hi=>{hi.call(e,Te,Ve,V)})},gt=function($){let Te;if(Ne("beforeSanitizeElements",$,null),le($))return N($),!0;let Ve=be($.nodeName);if(Ne("uponSanitizeElement",$,{tagName:Ve,allowedTags:se}),$.hasChildNodes()&&!Le($.firstElementChild)&&(!Le($.content)||!Le($.content.firstElementChild))&&Ss(/<[/\w]/g,$.innerHTML)&&Ss(/<[/\w]/g,$.textContent))return N($),!0;if(!se[Ve]||Pe[Ve]){if(!Pe[Ve]&&_i(Ve)&&(Xe.tagNameCheck instanceof RegExp&&Ss(Xe.tagNameCheck,Ve)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck(Ve)))return!1;if(vd&&!Us[Ve]){let hi=I($)||$.parentNode,Tn=v($)||$.childNodes;if(Tn&&hi){let tr=Tn.length;for(let cn=tr-1;cn>=0;--cn)hi.insertBefore(g(Tn[cn],!0),b($))}}return N($),!0}return $ instanceof l&&!M($)||(Ve==="noscript"||Ve==="noembed"||Ve==="noframes")&&Ss(/<\/no(script|embed|frames)/i,$.innerHTML)?(N($),!0):(ii&&$.nodeType===3&&(Te=$.textContent,Te=xa(Te,j," "),Te=xa(Te,G," "),Te=xa(Te,oe," "),$.textContent!==Te&&(Nv(e.removed,{element:$.cloneNode()}),$.textContent=Te)),Ne("afterSanitizeElements",$,null),!1)},Ht=function($,Te,Ve){if(nm&&(Te==="id"||Te==="name")&&(Ve in n||Ve in ce))return!1;if(!(bn&&!Gi[Te]&&Ss(_e,Te))){if(!(Mi&&Ss(re,Te))){if(!fe[Te]||Gi[Te]){if(!(_i($)&&(Xe.tagNameCheck instanceof RegExp&&Ss(Xe.tagNameCheck,$)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck($))&&(Xe.attributeNameCheck instanceof RegExp&&Ss(Xe.attributeNameCheck,Te)||Xe.attributeNameCheck instanceof Function&&Xe.attributeNameCheck(Te))||Te==="is"&&Xe.allowCustomizedBuiltInElements&&(Xe.tagNameCheck instanceof RegExp&&Ss(Xe.tagNameCheck,Ve)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck(Ve))))return!1}else if(!rl[Te]){if(!Ss(de,xa(Ve,ge,""))){if(!((Te==="src"||Te==="xlink:href"||Te==="href")&&$!=="script"&&_G(Ve,"data:")===0&&sp[$])){if(!(Kn&&!Ss(ne,xa(Ve,ge,"")))){if(Ve)return!1}}}}}}return!0},_i=function($){return $.indexOf("-")>0},yn=function($){let Te,Ve,hi,Tn;Ne("beforeSanitizeAttributes",$,null);let{attributes:tr}=$;if(!tr)return;let cn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:fe};for(Tn=tr.length;Tn--;){Te=tr[Tn];let{name:ll,namespaceURI:HR}=Te;if(Ve=ll==="value"?Te.value:DG(Te.value),hi=be(ll),cn.attrName=hi,cn.attrValue=Ve,cn.keepAttr=!0,cn.forceKeepAttr=void 0,Ne("uponSanitizeAttribute",$,cn),Ve=cn.attrValue,cn.forceKeepAttr||(H(ll,$),!cn.keepAttr))continue;if(!ma&&Ss(/\/>/i,Ve)){H(ll,$);continue}ii&&(Ve=xa(Ve,j," "),Ve=xa(Ve,G," "),Ve=xa(Ve,oe," "));let FV=be($.nodeName);if(Ht(FV,hi,Ve)){if(om&&(hi==="id"||hi==="name")&&(H(ll,$),Ve=Ye+Ve),w&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!HR)switch(m.getAttributeType(FV,hi)){case"TrustedHTML":{Ve=w.createHTML(Ve);break}case"TrustedScriptURL":{Ve=w.createScriptURL(Ve);break}}try{HR?$.setAttributeNS(HR,ll,Ve):$.setAttribute(ll,Ve),y2(e.removed)}catch{}}}Ne("afterSanitizeAttributes",$,null)},Ni=function Ke($){let Te,Ve=ee($);for(Ne("beforeSanitizeShadowDOM",$,null);Te=Ve.nextNode();)Ne("uponSanitizeShadowNode",Te,null),!gt(Te)&&(Te.content instanceof o&&Ke(Te.content),yn(Te));Ne("afterSanitizeShadowDOM",$,null)};return e.sanitize=function(Ke){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Te,Ve,hi,Tn;if(yd=!Ke,yd&&(Ke="<!-->"),typeof Ke!="string"&&!Le(Ke))if(typeof Ke.toString=="function"){if(Ke=Ke.toString(),typeof Ke!="string")throw Fv("dirty is not a string, aborting")}else throw Fv("toString is not a function");if(!e.isSupported)return Ke;if(rp||ut($),e.removed=[],typeof Ke=="string"&&(Sc=!1),Sc){if(Ke.nodeName){let ll=be(Ke.nodeName);if(!se[ll]||Pe[ll])throw Fv("root node is forbidden and cannot be sanitized in-place")}}else if(Ke instanceof a)Te=K("<!---->"),Ve=Te.ownerDocument.importNode(Ke,!0),Ve.nodeType===1&&Ve.nodeName==="BODY"||Ve.nodeName==="HTML"?Te=Ve:Te.appendChild(Ve);else{if(!xo&&!ii&&!wo&&Ke.indexOf("<")===-1)return w&&Cc?w.createHTML(Ke):Ke;if(Te=K(Ke),!Te)return xo?null:Cc?E:""}Te&&yc&&N(Te.firstChild);let tr=ee(Sc?Ke:Te);for(;hi=tr.nextNode();)gt(hi)||(hi.content instanceof o&&Ni(hi.content),yn(hi));if(Sc)return Ke;if(xo){if(Ic)for(Tn=D.call(Te.ownerDocument);Te.firstChild;)Tn.appendChild(Te.firstChild);else Tn=Te;return(fe.shadowroot||fe.shadowrootmode)&&(Tn=A.call(t,Tn,!0)),Tn}let cn=wo?Te.outerHTML:Te.innerHTML;return wo&&se["!doctype"]&&Te.ownerDocument&&Te.ownerDocument.doctype&&Te.ownerDocument.doctype.name&&Ss(_2,Te.ownerDocument.doctype.name)&&(cn="<!DOCTYPE "+Te.ownerDocument.doctype.name+`>
`+cn),ii&&(cn=xa(cn,j," "),cn=xa(cn,G," "),cn=xa(cn,oe," ")),w&&Cc?w.createHTML(cn):cn},e.setConfig=function(Ke){ut(Ke),rp=!0},e.clearConfig=function(){V=null,rp=!1},e.isValidAttribute=function(Ke,$,Te){V||ut({});let Ve=be(Ke),hi=be($);return Ht(Ve,hi,Te)},e.addHook=function(Ke,$){typeof $=="function"&&(W[Ke]=W[Ke]||[],Nv(W[Ke],$))},e.removeHook=function(Ke){if(W[Ke])return y2(W[Ke])},e.removeHooks=function(Ke){W[Ke]&&(W[Ke]=[])},e.removeAllHooks=function(){W={}},e}var Sl=D2();var wre=Sl.version,xre=Sl.isSupported,Bv=Sl.sanitize,Tre=Sl.setConfig,_re=Sl.clearConfig,Dre=Sl.isValidAttribute,sE=Sl.addHook,aE=Sl.removeHook,Lre=Sl.removeHooks,kre=Sl.removeAllHooks;function Ur(r){return Z0(r,0)}function Z0(r,e){switch(typeof r){case"object":return r===null?Fd(349,e):Array.isArray(r)?UG(r,e):zG(r,e);case"string":return lE(r,e);case"boolean":return HG(r,e);case"number":return Fd(r,e);case"undefined":return Fd(937,e);default:return Fd(617,e)}}function Fd(r,e){return(e<<5)-e+r|0}function HG(r,e){return Fd(r?433:863,e)}function lE(r,e){e=Fd(149417,e);for(let t=0,i=r.length;t<i;t++)e=Fd(r.charCodeAt(t),e);return e}function UG(r,e){return e=Fd(104579,e),r.reduce((t,i)=>Z0(i,t),e)}function zG(r,e){return e=Fd(181387,e),Object.keys(r).sort().reduce((t,i)=>(t=lE(i,t),Z0(r[i],t)),e)}function Y0(r,e,t=32){let i=t-e,n=~((1<<i)-1);return(r<<e|(n&r)>>>i)>>>0}function k2(r,e=0,t=r.byteLength,i=0){for(let n=0;n<t;n++)r[e+n]=i}function KG(r,e,t="0"){for(;r.length<e;)r=t+r;return r}function Vv(r,e=32){return r instanceof ArrayBuffer?Array.from(new Uint8Array(r)).map(t=>t.toString(16).padStart(2,"0")).join(""):KG((r>>>0).toString(16),e/4)}var R2=class r{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let i=this._buff,n=this._buffLen,o=this._leftoverHighSurrogate,s,a;for(o!==0?(s=o,a=-1,o=0):(s=e.charCodeAt(0),a=0);;){let l=s;if(Di(s))if(a+1<t){let d=e.charCodeAt(a+1);Pc(d)?(a++,l=VS(s,d)):l=65533}else{o=s;break}else Pc(s)&&(l=65533);if(n=this._push(i,n,l),a++,a<t)s=e.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=o}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Vv(this._h0)+Vv(this._h1)+Vv(this._h2)+Vv(this._h3)+Vv(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,k2(this._buff,this._buffLen),this._buffLen>56&&(this._step(),k2(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=r._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,Y0(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let i=this._h0,n=this._h1,o=this._h2,s=this._h3,a=this._h4,l,d,c;for(let u=0;u<80;u++)u<20?(l=n&o|~n&s,d=1518500249):u<40?(l=n^o^s,d=1859775393):u<60?(l=n&o|n&s|o&s,d=2400959708):(l=n^o^s,d=3395469782),c=Y0(i,5)+l+a+d+e.getUint32(u*4,!1)&4294967295,a=s,s=o,o=Y0(n,30),n=i,i=c;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+o&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};function uo(r,e,t){return Math.min(Math.max(r,e),t)}var{registerWindow:P2,getWindow:pe,getDocument:Xre,getWindows:Hv,getWindowsCount:dE,getWindowId:Hc,getWindowById:Bd,hasWindow:Qre,onDidRegisterWindow:Uv,onWillUnregisterWindow:Jre,onDidUnregisterWindow:N2}=function(){let r=new Map;XS(Re,1);let e={window:Re,disposables:new Y};r.set(Re.vscodeWindowId,e);let t=new _,i=new _,n=new _;function o(s,a){return(typeof s=="number"?r.get(s):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(s){if(r.has(s.vscodeWindowId))return P.None;let a=new Y,l={window:s,disposables:a.add(new Y)};return r.set(s.vscodeWindowId,l),a.add(te(()=>{r.delete(s.vscodeWindowId),i.fire(s)})),a.add(B(s,Q.BEFORE_UNLOAD,()=>{n.fire(s)})),t.fire(l),a},getWindows(){return r.values()},getWindowsCount(){return r.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return r.has(s)},getWindowById:o,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:Re},getDocument(s){return pe(s).document}}}();function Xt(r){for(;r.firstChild;)r.firstChild.remove()}var Q0=class{_handler;_node;_type;_options;constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function B(r,e,t,i){return new Q0(r,e,t,i)}function GG(r,e){return function(t){return e(new Ei(r,t))}}function jG(r){return function(e){return r(new bt(e))}}var si=function(e,t,i,n){let o=i;return t==="click"||t==="mousedown"||t==="contextmenu"?o=GG(pe(e),i):(t==="keydown"||t==="keypress"||t==="keyup")&&(o=jG(i)),B(e,t,o,n)};function zv(r,e,t){return Em(r,e,t)}var e1,Yi;var Lm=class extends qS{defaultTarget;constructor(e){super(),this.defaultTarget=e&&pe(e)}cancelAndSet(e,t,i){return super.cancelAndSet(e,t,i??this.defaultTarget)}},Wv=class{_runner;priority;_canceled;constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Ge(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let r=new Map,e=new Map,t=new Map,i=new Map,n=o=>{t.set(o,!1);let s=r.get(o)??[];for(e.set(o,s),r.set(o,[]),i.set(o,!0);s.length>0;)s.sort(Wv.sort),s.shift().execute();i.set(o,!1)};Yi=(o,s,a=0)=>{let l=Hc(o),d=new Wv(s,a),c=r.get(l);return c||(c=[],r.set(l,c)),c.push(d),t.get(l)||(t.set(l,!0),o.requestAnimationFrame(()=>n(l))),d},e1=(o,s,a)=>{let l=Hc(o);if(i.get(l)){let d=new Wv(s,a),c=e.get(l);return c||(c=[],e.set(l,c)),c.push(d),d}else return Yi(o,s,a)}})();function t1(r,e){return Yi(r,e,1e4)}function F2(r,e){return Yi(r,e,-1e4)}function B2(r){return pe(r).getComputedStyle(r,null)}function Dp(r,e){let t=pe(r),i=t.document;if(r!==i.body)return new At(r.clientWidth,r.clientHeight);if(zs&&t?.visualViewport)return new At(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new At(t.innerWidth,t.innerHeight);if(i.body&&i.body.clientWidth&&i.body.clientHeight)return new At(i.body.clientWidth,i.body.clientHeight);if(i.documentElement&&i.documentElement.clientWidth&&i.documentElement.clientHeight)return new At(i.documentElement.clientWidth,i.documentElement.clientHeight);if(e)return Dp(e);throw new Error("Unable to figure out browser width and height")}var Ao=class r{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,i){let n=B2(e),o=n?n.getPropertyValue(t):"0";return r.convertToPixels(e,o)}static getBorderLeftWidth(e){return r.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return r.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return r.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return r.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return r.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return r.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return r.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return r.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return r.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return r.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return r.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return r.getDimension(e,"margin-bottom","marginBottom")}},At=class r{constructor(e,t){this.width=e;this.height=t}static None=new r(0,0);with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new r(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof r?e:new r(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};function _p(r){let e=r.offsetParent,t=r.offsetTop,i=r.offsetLeft;for(;(r=r.parentNode)!==null&&r!==r.ownerDocument.body&&r!==r.ownerDocument.documentElement;){t-=r.scrollTop;let n=H2(r)?null:B2(r);n&&(i-=n.direction!=="rtl"?r.scrollLeft:-r.scrollLeft),r===e&&(i+=Ao.getBorderLeftWidth(r),t+=Ao.getBorderTopWidth(r),t+=r.offsetTop,i+=r.offsetLeft,e=r.offsetParent)}return{left:i,top:t}}function i1(r,e,t){typeof e=="number"&&(r.style.width=`${e}px`),typeof t=="number"&&(r.style.height=`${t}px`)}function V2(r,e,t,i,n,o="absolute"){typeof e=="number"&&(r.style.top=`${e}px`),typeof t=="number"&&(r.style.right=`${t}px`),typeof i=="number"&&(r.style.bottom=`${i}px`),typeof n=="number"&&(r.style.left=`${n}px`),r.style.position=o}function po(r){let e=r.getBoundingClientRect(),t=pe(r);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function Lp(r){let e=Ao.getMarginLeft(r)+Ao.getMarginRight(r);return r.offsetWidth+e}function Rm(r){let e=Ao.getBorderLeftWidth(r)+Ao.getBorderRightWidth(r),t=Ao.getPaddingLeft(r)+Ao.getPaddingRight(r);return r.offsetWidth-e-t}function qG(r){let e=Ao.getMarginLeft(r)+Ao.getMarginRight(r);return r.scrollWidth+e}function cE(r){let e=Ao.getBorderTopWidth(r)+Ao.getBorderBottomWidth(r),t=Ao.getPaddingTop(r)+Ao.getPaddingBottom(r);return r.offsetHeight-e-t}function uE(r){let e=Ao.getMarginTop(r)+Ao.getMarginBottom(r);return r.offsetHeight+e}function $G(r,e){if(r===null)return 0;let t=_p(r),i=_p(e);return t.left-i.left}function W2(r,e){let t=e.map(n=>Math.max(qG(n),Lp(n))+$G(n,r)||0);return Math.max(...t)}function An(r,e){return!!e?.contains(r)}function Am(r,e,t){for(;r&&r.nodeType===r.ELEMENT_NODE;){if(r.classList.contains(e))return r;if(t){if(typeof t=="string"){if(r.classList.contains(t))return null}else if(r===t)return null}r=r.parentNode}return null}function pE(r,e,t){return!!Am(r,e,t)}function H2(r){return r&&!!r.host&&!!r.mode}function Uc(r){for(;r.parentNode;){if(r===r.ownerDocument?.body)return null;r=r.parentNode}return H2(r)?r:null}function mn(){let r=hE().activeElement;for(;r?.shadowRoot;)r=r.shadowRoot.activeElement;return r}function ho(r){return mn()===r}function U2(r){return An(mn(),r)}function hE(){return dE()<=1?Re.document:Array.from(Hv()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Re.document}function Kr(){return hE().defaultView?.window??Re}var mE=new Map;function z2(r){return mE.has(r)}function rr(r=Re.document.head,e,t){let i=document.createElement("style");if(i.type="text/css",i.media="screen",e?.(i),r.appendChild(i),t&&t.add(te(()=>i.remove())),r===Re.document.head){let n=new Set;mE.set(i,n);for(let{window:o,disposables:s}of Hv()){if(o===Re)continue;let a=s.add(G2(i,n,o));t?.add(a)}}return i}function K2(r){let e=new Y;for(let[t,i]of mE)e.add(G2(t,i,r));return e}function G2(r,e,t){let i=new Y,n=r.cloneNode(!0);t.document.head.appendChild(n),i.add(te(()=>n.remove()));for(let o of ZG(r))n.sheet?.insertRule(o.cssText,n.sheet?.cssRules.length);return i.add(gE.observe(r,i,{childList:!0})(()=>{n.textContent=r.textContent})),e.add(n),i.add(te(()=>e.delete(n))),i}var gE=new class{mutationObservers=new Map;observe(r,e,t){let i=this.mutationObservers.get(r);i||(i=new Map,this.mutationObservers.set(r,i));let n=Ur(t),o=i.get(n);if(o)o.users+=1;else{let s=new _,a=new MutationObserver(d=>s.fire(d));a.observe(r,t);let l=o={users:1,observer:a,onDidMutate:s.event};e.add(te(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),i?.delete(n),i?.size===0&&this.mutationObservers.delete(r))})),i.set(n,o)}return o.onDidMutate}};function j2(r=Re.document.head){return $2("meta",r)}function q2(r=Re.document.head){return $2("link",r)}function $2(r,e=Re.document.head){let t=document.createElement(r);return e.appendChild(t),t}var X0=null;function YG(){return X0||(X0=rr()),X0}function ZG(r){return r?.sheet?.rules?r.sheet.rules:r?.sheet?.cssRules?r.sheet.cssRules:[]}function n1(r,e,t=YG()){if(!(!t||!e)){t.sheet?.insertRule(`${r} {${e}}`,0);for(let i of mE.get(t)??[])n1(r,e,i)}}function ki(r){return r instanceof HTMLElement||r instanceof pe(r).HTMLElement}function Y2(r){return r instanceof SVGElement||r instanceof pe(r).SVGElement}function yr(r){return r instanceof MouseEvent||r instanceof pe(r).MouseEvent}function $s(r){return r instanceof KeyboardEvent||r instanceof pe(r).KeyboardEvent}function Z2(r){return r instanceof DragEvent||r instanceof pe(r).DragEvent}var Q={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:wa?"webkitAnimationStart":"animationstart",ANIMATION_END:wa?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:wa?"webkitAnimationIteration":"animationiteration"};var Oe={stop:(r,e)=>(r.preventDefault(),e&&r.stopPropagation(),r)};function X2(r){let e=[];for(let t=0;r&&r.nodeType===r.ELEMENT_NODE;t++)e[t]=r.scrollTop,r=r.parentNode;return e}function Q2(r,e){for(let t=0;r&&r.nodeType===r.ELEMENT_NODE;t++)r.scrollTop!==e[t]&&(r.scrollTop=e[t]),r=r.parentNode}var J0=class r extends P{_onDidFocus=this._register(new _);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new _);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(e){if(ki(e)){let t=Uc(e),i=t?t.activeElement:e.ownerDocument.activeElement;return An(i,e)}else{let t=e;return An(t.document.activeElement,t.document)}}constructor(e){super();let t=r.hasFocusWithin(e),i=!1,n=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},o=()=>{t&&(i=!0,(ki(e)?pe(e):e).setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{r.hasFocusWithin(e)!==t&&(t?o():n())},this._register(B(e,Q.FOCUS,n,!0)),this._register(B(e,Q.BLUR,o,!0)),ki(e)&&(this._register(B(e,Q.FOCUS_IN,()=>this._refreshStateHandler())),this._register(B(e,Q.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function Mn(r){return new J0(r)}function fE(r,e){return r.after(e),e}function ye(r,...e){if(r.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function o1(r,e){return r.insertBefore(e,r.firstChild),e}function gn(r,...e){r.innerText="",ye(r,...e)}var XG=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function J2(r,e,t,...i){let n=XG.exec(e);if(!n)throw new Error("Bad use of emmet");let o=n[1]||"div",s;return r!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(r,o):s=document.createElement(o),n[3]&&(s.id=n[3]),n[4]&&(s.className=n[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...i),s}function he(r,e,...t){return J2("http://www.w3.org/1999/xhtml",r,e,...t)}he.SVG=function(r,e,...t){return J2("http://www.w3.org/2000/svg",r,e,...t)};function kp(...r){for(let e of r)e.style.display="",e.removeAttribute("aria-hidden")}function Mm(...r){for(let e of r)e.style.display="none",e.setAttribute("aria-hidden","true")}function r1(r,e){let t=r.devicePixelRatio*e;return Math.max(1,Math.floor(t))/r.devicePixelRatio}function s1(r){Re.open(r,"_blank","noopener")}var A2=780,M2=640;function a1(r){let e=Math.floor(Re.screenLeft+Re.innerWidth/2-A2/2),t=Math.floor(Re.screenTop+Re.innerHeight/2-M2/2);Re.open(r,"_blank",`width=${A2},height=${M2},top=${t},left=${e}`)}function eH(r,e=!0){let t=Re.open();return t?(e&&(t.opener=null),t.location.href=r,!0):!1}function tH(r,e){let t=()=>{e(),i=Yi(r,t)},i=Yi(r,t);return te(()=>i.dispose())}GS.setPreferredWebSchema(/^https:/.test(Re.location.href)?"https":"http");function El(r){return r?`url('${Hr.uriToBrowserUri(r).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function Ir(r,e){if(r!==void 0){let t=r.match(/^\s*var\((.+)\)$/);if(t){let i=t[1].split(",",2);return i.length===2&&(e=Ir(i[1].trim(),e)),`var(${i[0]}, ${e})`}return r}return e}function iH(r,e){let t;if(X.isUri(r))t=r.toString(!0);else{let o=new Blob([r]);t=URL.createObjectURL(o),setTimeout(()=>URL.revokeObjectURL(t))}let i=Kr(),n=document.createElement("a");i.document.body.appendChild(n),n.download=e,n.href=t,n.click(),setTimeout(()=>n.remove())}function nH(){return new Promise(r=>{let e=Kr(),t=document.createElement("input");e.document.body.appendChild(t),t.type="file",t.multiple=!0,z.once(z.fromDOMEventEmitter(t,"input"))(()=>{r(t.files??void 0)}),t.click(),setTimeout(()=>t.remove())})}function oH(r,e=!1){let t=document.createElement("a");return sE("afterSanitizeAttributes",i=>{for(let n of["href","src"])if(i.hasAttribute(n)){let o=i.getAttribute(n);if(n==="href"&&o.startsWith("#"))continue;if(t.href=o,!r.includes(t.protocol.replace(/:$/,""))){if(e&&n==="src"&&t.href.startsWith("data:"))continue;i.removeAttribute(n)}}}),te(()=>{aE("afterSanitizeAttributes")})}var ese=[ue.http,ue.https,ue.command],rH=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),tse=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});function QG(r){let e=new Uint16Array(r.length);for(let n=0;n<e.length;n++)e[n]=r.charCodeAt(n);let t="",i=new Uint8Array(e.buffer);for(let n=0;n<i.length;n++)t+=String.fromCharCode(i[n]);return t}function Om(r){return btoa(QG(r))}var km=class r extends _{_subscriptions=new Y;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(z.runAndSubscribe(Uv,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Re,disposables:this._subscriptions}))}registerListeners(e,t){t.add(B(e,"keydown",i=>{if(i.defaultPrevented)return;let n=new bt(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),t.add(B(e,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),t.add(B(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(B(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(B(e.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(B(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return r.instance||(r.instance=new r),r.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var zr=class extends P{constructor(t,i){super();this.element=t;this.callbacks=i;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(B(this.element,Q.DRAG_START,t=>{this.callbacks.onDragStart?.(t)})),this.callbacks.onDrag&&this._register(B(this.element,Q.DRAG,t=>{this.callbacks.onDrag?.(t)})),this._register(B(this.element,Q.DRAG_ENTER,t=>{this.counter++,this.dragStartTime=t.timeStamp,this.callbacks.onDragEnter?.(t)})),this._register(B(this.element,Q.DRAG_OVER,t=>{t.preventDefault(),this.callbacks.onDragOver?.(t,t.timeStamp-this.dragStartTime)})),this._register(B(this.element,Q.DRAG_LEAVE,t=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(t))})),this._register(B(this.element,Q.DRAG_END,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(t)})),this._register(B(this.element,Q.DROP,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(t)}))}},JG=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function Tt(r,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);let n=JG.exec(r);if(!n||!n.groups)throw new Error("Bad use of h");let o=n.groups.tag||"div",s=document.createElement(o);n.groups.id&&(s.id=n.groups.id);let a=[];if(n.groups.class)for(let d of n.groups.class.split("."))d!==""&&a.push(d);if(t.className!==void 0)for(let d of t.className.split("."))d!==""&&a.push(d);a.length>0&&(s.className=a.join(" "));let l={};if(n.groups.name&&(l[n.groups.name]=s),i)for(let d of i)ki(d)?s.appendChild(d):typeof d=="string"?s.append(d):"root"in d&&(Object.assign(l,d),s.appendChild(d.root));for(let[d,c]of Object.entries(t))if(d!=="className")if(d==="style")for(let[u,p]of Object.entries(c))s.style.setProperty(O2(u),typeof p=="number"?p+"px":""+p);else d==="tabIndex"?s.tabIndex=c:s.setAttribute(O2(d),c.toString());return l.root=s,l}function O2(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function bE(r,e,t){for(let{name:i,value:n}of r.attributes)(!t||t.includes(i))&&e.setAttribute(i,n)}function ej(r,e,t){let i=r.getAttribute(t);i?e.setAttribute(t,i):e.removeAttribute(t)}function vE(r,e,t){bE(r,e,t);let i=new Y;return i.add(gE.observe(r,i,{attributes:!0,attributeFilter:t})(n=>{for(let o of n)o.type==="attributes"&&o.attributeName&&ej(r,e,o.attributeName)})),i}function Gr(r){return r.tagName.toLowerCase()==="input"||r.tagName.toLowerCase()==="textarea"||ki(r)&&!!r.editContext}var zo=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});var Mo={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:zo.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};function yE(r,e,t,i,n){let o=document.createElement("div");o.className=t,o.textContent=e,n&&(o.style.color=n),i&&(o.style.background=i),r.dataTransfer&&(pe(r).document.body.appendChild(o),r.dataTransfer.setDragImage(o,-10,-10),setTimeout(()=>o.remove(),0))}function me(r,e,t){let i=null,n=null;if(typeof t.value=="function"?(i="value",n=t.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",n=t.get),!n)throw new Error("not supported");let o=`$memoize$${e}`;t[i]=function(...s){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,s)}),this[o]}}var it;(o=>(o.Tap="-monaco-gesturetap",o.Change="-monaco-gesturechange",o.Start="-monaco-gesturestart",o.End="-monaco-gesturesend",o.Contextmenu="-monaco-gesturecontextmenu"))(it||={});var Oo=class Oo extends P{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new ko;ignoreTargets=new ko;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(z.runAndSubscribe(Uv,({window:e,disposables:t})=>{t.add(B(e.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),t.add(B(e.document,"touchend",i=>this.onTouchEnd(e,i))),t.add(B(e.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:Re,disposables:this._store}))}static addTarget(e){if(!Oo.isTouchDevice())return P.None;Oo.INSTANCE||(Oo.INSTANCE=gl(new Oo));let t=Oo.INSTANCE.targets.push(e);return te(t)}static ignoreTarget(e){if(!Oo.isTouchDevice())return P.None;Oo.INSTANCE||(Oo.INSTANCE=gl(new Oo));let t=Oo.INSTANCE.ignoreTargets.push(e);return te(t)}static isTouchDevice(){return"ontouchstart"in Re||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=e.targetTouches.length;i<n;i++){let o=e.targetTouches.item(i);this.activeTouches[o.identifier]={id:o.identifier,initialTarget:o.target,initialTimeStamp:t,initialPageX:o.pageX,initialPageY:o.pageY,rollingTimestamps:[t],rollingPageX:[o.pageX],rollingPageY:[o.pageY]};let s=this.newGestureEvent(it.Start,o.target);s.pageX=o.pageX,s.pageY=o.pageY,this.dispatchEvent(s)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){let i=Date.now(),n=Object.keys(this.activeTouches).length;for(let o=0,s=t.changedTouches.length;o<s;o++){let a=t.changedTouches.item(o);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<Oo.HOLD_DELAY&&Math.abs(l.initialPageX-Wo(l.rollingPageX))<30&&Math.abs(l.initialPageY-Wo(l.rollingPageY))<30){let c=this.newGestureEvent(it.Tap,l.initialTarget);c.pageX=Wo(l.rollingPageX),c.pageY=Wo(l.rollingPageY),this.dispatchEvent(c)}else if(d>=Oo.HOLD_DELAY&&Math.abs(l.initialPageX-Wo(l.rollingPageX))<30&&Math.abs(l.initialPageY-Wo(l.rollingPageY))<30){let c=this.newGestureEvent(it.Contextmenu,l.initialTarget);c.pageX=Wo(l.rollingPageX),c.pageY=Wo(l.rollingPageY),this.dispatchEvent(c)}else if(n===1){let c=Wo(l.rollingPageX),u=Wo(l.rollingPageY),p=Wo(l.rollingTimestamps)-l.rollingTimestamps[0],m=c-l.rollingPageX[0],f=u-l.rollingPageY[0],g=[...this.targets].filter(b=>l.initialTarget instanceof Node&&b.contains(l.initialTarget));this.inertia(e,g,i,Math.abs(m)/p,m>0?1:-1,c,Math.abs(f)/p,f>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(it.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===it.Tap){let t=new Date().getTime(),i=0;t-this._lastSetTapCountTime>Oo.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===it.Change||e.type===it.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let i of this.ignoreTargets)if(i.contains(e.initialTarget))return;let t=[];for(let i of this.targets)if(i.contains(e.initialTarget)){let n=0,o=e.initialTarget;for(;o&&o!==i;)n++,o=o.parentElement;t.push([n,i])}t.sort((i,n)=>i[0]-n[0]);for(let[i,n]of t)n.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,i,n,o,s,a,l,d){this.handle=Yi(e,()=>{let c=Date.now(),u=c-i,p=0,m=0,f=!0;n+=Oo.SCROLL_FRICTION*u,a+=Oo.SCROLL_FRICTION*u,n>0&&(f=!1,p=o*n*u),a>0&&(f=!1,m=l*a*u);let g=this.newGestureEvent(it.Change);g.translationX=p,g.translationY=m,t.forEach(b=>b.dispatchEvent(g)),f||this.inertia(e,t,c,n,o,s+p,a,l,d+m)})}onTouchMove(e){let t=Date.now();for(let i=0,n=e.changedTouches.length;i<n;i++){let o=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("end of an UNKNOWN touch",o);continue}let s=this.activeTouches[o.identifier],a=this.newGestureEvent(it.Change,s.initialTarget);a.translationX=o.pageX-Wo(s.rollingPageX),a.translationY=o.pageY-Wo(s.rollingPageY),a.pageX=o.pageX,a.pageY=o.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(o.pageX),s.rollingPageY.push(o.pageY),s.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};R([me],Oo,"isTouchDevice",1);var ei=Oo;var Rp=class{constructor(e){this.domNode=e}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(e){let t=jr(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=jr(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=jr(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=jr(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=jr(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=jr(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=jr(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=jr(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=jr(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=jr(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=jr(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=jr(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=jr(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=jr(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function jr(r){return typeof r=="number"?`${r}px`:r}function $e(r){return new Rp(r)}var wl=class{_hooks=new Y;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,n,o){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=o;let s=e;try{e.setPointerCapture(t),this._hooks.add(te(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=pe(e)}this._hooks.add(B(s,Q.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(B(s,Q.POINTER_UP,a=>this.stopMonitoring(!0)))}};var On=class extends P{onclick(e,t){this._register(B(e,Q.CLICK,i=>t(new Ei(pe(e),i))))}onmousedown(e,t){this._register(B(e,Q.MOUSE_DOWN,i=>t(new Ei(pe(e),i))))}onmouseover(e,t){this._register(B(e,Q.MOUSE_OVER,i=>t(new Ei(pe(e),i))))}onmouseleave(e,t){this._register(B(e,Q.MOUSE_LEAVE,i=>t(new Ei(pe(e),i))))}onkeydown(e,t){this._register(B(e,Q.KEY_DOWN,i=>t(new bt(i))))}onkeyup(e,t){this._register(B(e,Q.KEY_UP,i=>t(new bt(i))))}oninput(e,t){this._register(B(e,Q.INPUT,t))}onblur(e,t){this._register(B(e,Q.BLUR,t))}onfocus(e,t){this._register(B(e,Q.FOCUS,t))}onchange(e,t){this._register(B(e,Q.CHANGE,t))}ignoreGesture(e){return ei.ignoreTarget(e)}};var l1=Object.create(null);function C(r,e){if(Wi(e)){let t=l1[e];if(t===void 0)throw new Error(`${r} references an unknown codicon: ${e}`);e=t}return l1[r]=e,{id:r}}function d1(){return l1}var sH={add:C("add",6e4),plus:C("plus",6e4),gistNew:C("gist-new",6e4),repoCreate:C("repo-create",6e4),lightbulb:C("lightbulb",60001),lightBulb:C("light-bulb",60001),repo:C("repo",60002),repoDelete:C("repo-delete",60002),gistFork:C("gist-fork",60003),repoForked:C("repo-forked",60003),gitPullRequest:C("git-pull-request",60004),gitPullRequestAbandoned:C("git-pull-request-abandoned",60004),recordKeys:C("record-keys",60005),keyboard:C("keyboard",60005),tag:C("tag",60006),gitPullRequestLabel:C("git-pull-request-label",60006),tagAdd:C("tag-add",60006),tagRemove:C("tag-remove",60006),person:C("person",60007),personFollow:C("person-follow",60007),personOutline:C("person-outline",60007),personFilled:C("person-filled",60007),gitBranch:C("git-branch",60008),gitBranchCreate:C("git-branch-create",60008),gitBranchDelete:C("git-branch-delete",60008),sourceControl:C("source-control",60008),mirror:C("mirror",60009),mirrorPublic:C("mirror-public",60009),star:C("star",60010),starAdd:C("star-add",60010),starDelete:C("star-delete",60010),starEmpty:C("star-empty",60010),comment:C("comment",60011),commentAdd:C("comment-add",60011),alert:C("alert",60012),warning:C("warning",60012),search:C("search",60013),searchSave:C("search-save",60013),logOut:C("log-out",60014),signOut:C("sign-out",60014),logIn:C("log-in",60015),signIn:C("sign-in",60015),eye:C("eye",60016),eyeUnwatch:C("eye-unwatch",60016),eyeWatch:C("eye-watch",60016),circleFilled:C("circle-filled",60017),primitiveDot:C("primitive-dot",60017),closeDirty:C("close-dirty",60017),debugBreakpoint:C("debug-breakpoint",60017),debugBreakpointDisabled:C("debug-breakpoint-disabled",60017),debugHint:C("debug-hint",60017),terminalDecorationSuccess:C("terminal-decoration-success",60017),primitiveSquare:C("primitive-square",60018),edit:C("edit",60019),pencil:C("pencil",60019),info:C("info",60020),issueOpened:C("issue-opened",60020),gistPrivate:C("gist-private",60021),gitForkPrivate:C("git-fork-private",60021),lock:C("lock",60021),mirrorPrivate:C("mirror-private",60021),close:C("close",60022),removeClose:C("remove-close",60022),x:C("x",60022),repoSync:C("repo-sync",60023),sync:C("sync",60023),clone:C("clone",60024),desktopDownload:C("desktop-download",60024),beaker:C("beaker",60025),microscope:C("microscope",60025),vm:C("vm",60026),deviceDesktop:C("device-desktop",60026),file:C("file",60027),fileText:C("file-text",60027),more:C("more",60028),ellipsis:C("ellipsis",60028),kebabHorizontal:C("kebab-horizontal",60028),mailReply:C("mail-reply",60029),reply:C("reply",60029),organization:C("organization",60030),organizationFilled:C("organization-filled",60030),organizationOutline:C("organization-outline",60030),newFile:C("new-file",60031),fileAdd:C("file-add",60031),newFolder:C("new-folder",60032),fileDirectoryCreate:C("file-directory-create",60032),trash:C("trash",60033),trashcan:C("trashcan",60033),history:C("history",60034),clock:C("clock",60034),folder:C("folder",60035),fileDirectory:C("file-directory",60035),symbolFolder:C("symbol-folder",60035),logoGithub:C("logo-github",60036),markGithub:C("mark-github",60036),github:C("github",60036),terminal:C("terminal",60037),console:C("console",60037),repl:C("repl",60037),zap:C("zap",60038),symbolEvent:C("symbol-event",60038),error:C("error",60039),stop:C("stop",60039),variable:C("variable",60040),symbolVariable:C("symbol-variable",60040),array:C("array",60042),symbolArray:C("symbol-array",60042),symbolModule:C("symbol-module",60043),symbolPackage:C("symbol-package",60043),symbolNamespace:C("symbol-namespace",60043),symbolObject:C("symbol-object",60043),symbolMethod:C("symbol-method",60044),symbolFunction:C("symbol-function",60044),symbolConstructor:C("symbol-constructor",60044),symbolBoolean:C("symbol-boolean",60047),symbolNull:C("symbol-null",60047),symbolNumeric:C("symbol-numeric",60048),symbolNumber:C("symbol-number",60048),symbolStructure:C("symbol-structure",60049),symbolStruct:C("symbol-struct",60049),symbolParameter:C("symbol-parameter",60050),symbolTypeParameter:C("symbol-type-parameter",60050),symbolKey:C("symbol-key",60051),symbolText:C("symbol-text",60051),symbolReference:C("symbol-reference",60052),goToFile:C("go-to-file",60052),symbolEnum:C("symbol-enum",60053),symbolValue:C("symbol-value",60053),symbolRuler:C("symbol-ruler",60054),symbolUnit:C("symbol-unit",60054),activateBreakpoints:C("activate-breakpoints",60055),archive:C("archive",60056),arrowBoth:C("arrow-both",60057),arrowDown:C("arrow-down",60058),arrowLeft:C("arrow-left",60059),arrowRight:C("arrow-right",60060),arrowSmallDown:C("arrow-small-down",60061),arrowSmallLeft:C("arrow-small-left",60062),arrowSmallRight:C("arrow-small-right",60063),arrowSmallUp:C("arrow-small-up",60064),arrowUp:C("arrow-up",60065),bell:C("bell",60066),bold:C("bold",60067),book:C("book",60068),bookmark:C("bookmark",60069),debugBreakpointConditionalUnverified:C("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:C("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:C("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:C("debug-breakpoint-data-unverified",60072),debugBreakpointData:C("debug-breakpoint-data",60073),debugBreakpointDataDisabled:C("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:C("debug-breakpoint-log-unverified",60074),debugBreakpointLog:C("debug-breakpoint-log",60075),debugBreakpointLogDisabled:C("debug-breakpoint-log-disabled",60075),briefcase:C("briefcase",60076),broadcast:C("broadcast",60077),browser:C("browser",60078),bug:C("bug",60079),calendar:C("calendar",60080),caseSensitive:C("case-sensitive",60081),check:C("check",60082),checklist:C("checklist",60083),chevronDown:C("chevron-down",60084),chevronLeft:C("chevron-left",60085),chevronRight:C("chevron-right",60086),chevronUp:C("chevron-up",60087),chromeClose:C("chrome-close",60088),chromeMaximize:C("chrome-maximize",60089),chromeMinimize:C("chrome-minimize",60090),chromeRestore:C("chrome-restore",60091),circleOutline:C("circle-outline",60092),circle:C("circle",60092),debugBreakpointUnverified:C("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:C("terminal-decoration-incomplete",60092),circleSlash:C("circle-slash",60093),circuitBoard:C("circuit-board",60094),clearAll:C("clear-all",60095),clippy:C("clippy",60096),closeAll:C("close-all",60097),cloudDownload:C("cloud-download",60098),cloudUpload:C("cloud-upload",60099),code:C("code",60100),collapseAll:C("collapse-all",60101),colorMode:C("color-mode",60102),commentDiscussion:C("comment-discussion",60103),creditCard:C("credit-card",60105),dash:C("dash",60108),dashboard:C("dashboard",60109),database:C("database",60110),debugContinue:C("debug-continue",60111),debugDisconnect:C("debug-disconnect",60112),debugPause:C("debug-pause",60113),debugRestart:C("debug-restart",60114),debugStart:C("debug-start",60115),debugStepInto:C("debug-step-into",60116),debugStepOut:C("debug-step-out",60117),debugStepOver:C("debug-step-over",60118),debugStop:C("debug-stop",60119),debug:C("debug",60120),deviceCameraVideo:C("device-camera-video",60121),deviceCamera:C("device-camera",60122),deviceMobile:C("device-mobile",60123),diffAdded:C("diff-added",60124),diffIgnored:C("diff-ignored",60125),diffModified:C("diff-modified",60126),diffRemoved:C("diff-removed",60127),diffRenamed:C("diff-renamed",60128),diff:C("diff",60129),diffSidebyside:C("diff-sidebyside",60129),discard:C("discard",60130),editorLayout:C("editor-layout",60131),emptyWindow:C("empty-window",60132),exclude:C("exclude",60133),extensions:C("extensions",60134),eyeClosed:C("eye-closed",60135),fileBinary:C("file-binary",60136),fileCode:C("file-code",60137),fileMedia:C("file-media",60138),filePdf:C("file-pdf",60139),fileSubmodule:C("file-submodule",60140),fileSymlinkDirectory:C("file-symlink-directory",60141),fileSymlinkFile:C("file-symlink-file",60142),fileZip:C("file-zip",60143),files:C("files",60144),filter:C("filter",60145),flame:C("flame",60146),foldDown:C("fold-down",60147),foldUp:C("fold-up",60148),fold:C("fold",60149),folderActive:C("folder-active",60150),folderOpened:C("folder-opened",60151),gear:C("gear",60152),gift:C("gift",60153),gistSecret:C("gist-secret",60154),gist:C("gist",60155),gitCommit:C("git-commit",60156),gitCompare:C("git-compare",60157),compareChanges:C("compare-changes",60157),gitMerge:C("git-merge",60158),githubAction:C("github-action",60159),githubAlt:C("github-alt",60160),globe:C("globe",60161),grabber:C("grabber",60162),graph:C("graph",60163),gripper:C("gripper",60164),heart:C("heart",60165),home:C("home",60166),horizontalRule:C("horizontal-rule",60167),hubot:C("hubot",60168),inbox:C("inbox",60169),issueReopened:C("issue-reopened",60171),issues:C("issues",60172),italic:C("italic",60173),jersey:C("jersey",60174),json:C("json",60175),kebabVertical:C("kebab-vertical",60176),key:C("key",60177),law:C("law",60178),lightbulbAutofix:C("lightbulb-autofix",60179),linkExternal:C("link-external",60180),link:C("link",60181),listOrdered:C("list-ordered",60182),listUnordered:C("list-unordered",60183),liveShare:C("live-share",60184),loading:C("loading",60185),location:C("location",60186),mailRead:C("mail-read",60187),mail:C("mail",60188),markdown:C("markdown",60189),megaphone:C("megaphone",60190),mention:C("mention",60191),milestone:C("milestone",60192),gitPullRequestMilestone:C("git-pull-request-milestone",60192),mortarBoard:C("mortar-board",60193),move:C("move",60194),multipleWindows:C("multiple-windows",60195),mute:C("mute",60196),noNewline:C("no-newline",60197),note:C("note",60198),octoface:C("octoface",60199),openPreview:C("open-preview",60200),package:C("package",60201),paintcan:C("paintcan",60202),pin:C("pin",60203),play:C("play",60204),run:C("run",60204),plug:C("plug",60205),preserveCase:C("preserve-case",60206),preview:C("preview",60207),project:C("project",60208),pulse:C("pulse",60209),question:C("question",60210),quote:C("quote",60211),radioTower:C("radio-tower",60212),reactions:C("reactions",60213),references:C("references",60214),refresh:C("refresh",60215),regex:C("regex",60216),remoteExplorer:C("remote-explorer",60217),remote:C("remote",60218),remove:C("remove",60219),replaceAll:C("replace-all",60220),replace:C("replace",60221),repoClone:C("repo-clone",60222),repoForcePush:C("repo-force-push",60223),repoPull:C("repo-pull",60224),repoPush:C("repo-push",60225),report:C("report",60226),requestChanges:C("request-changes",60227),rocket:C("rocket",60228),rootFolderOpened:C("root-folder-opened",60229),rootFolder:C("root-folder",60230),rss:C("rss",60231),ruby:C("ruby",60232),saveAll:C("save-all",60233),saveAs:C("save-as",60234),save:C("save",60235),screenFull:C("screen-full",60236),screenNormal:C("screen-normal",60237),searchStop:C("search-stop",60238),server:C("server",60240),settingsGear:C("settings-gear",60241),settings:C("settings",60242),shield:C("shield",60243),smiley:C("smiley",60244),sortPrecedence:C("sort-precedence",60245),splitHorizontal:C("split-horizontal",60246),splitVertical:C("split-vertical",60247),squirrel:C("squirrel",60248),starFull:C("star-full",60249),starHalf:C("star-half",60250),symbolClass:C("symbol-class",60251),symbolColor:C("symbol-color",60252),symbolConstant:C("symbol-constant",60253),symbolEnumMember:C("symbol-enum-member",60254),symbolField:C("symbol-field",60255),symbolFile:C("symbol-file",60256),symbolInterface:C("symbol-interface",60257),symbolKeyword:C("symbol-keyword",60258),symbolMisc:C("symbol-misc",60259),symbolOperator:C("symbol-operator",60260),symbolProperty:C("symbol-property",60261),wrench:C("wrench",60261),wrenchSubaction:C("wrench-subaction",60261),symbolSnippet:C("symbol-snippet",60262),tasklist:C("tasklist",60263),telescope:C("telescope",60264),textSize:C("text-size",60265),threeBars:C("three-bars",60266),thumbsdown:C("thumbsdown",60267),thumbsup:C("thumbsup",60268),tools:C("tools",60269),triangleDown:C("triangle-down",60270),triangleLeft:C("triangle-left",60271),triangleRight:C("triangle-right",60272),triangleUp:C("triangle-up",60273),twitter:C("twitter",60274),unfold:C("unfold",60275),unlock:C("unlock",60276),unmute:C("unmute",60277),unverified:C("unverified",60278),verified:C("verified",60279),versions:C("versions",60280),vmActive:C("vm-active",60281),vmOutline:C("vm-outline",60282),vmRunning:C("vm-running",60283),watch:C("watch",60284),whitespace:C("whitespace",60285),wholeWord:C("whole-word",60286),window:C("window",60287),wordWrap:C("word-wrap",60288),zoomIn:C("zoom-in",60289),zoomOut:C("zoom-out",60290),listFilter:C("list-filter",60291),listFlat:C("list-flat",60292),listSelection:C("list-selection",60293),selection:C("selection",60293),listTree:C("list-tree",60294),debugBreakpointFunctionUnverified:C("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:C("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:C("debug-breakpoint-function-disabled",60296),debugStackframeActive:C("debug-stackframe-active",60297),circleSmallFilled:C("circle-small-filled",60298),debugStackframeDot:C("debug-stackframe-dot",60298),terminalDecorationMark:C("terminal-decoration-mark",60298),debugStackframe:C("debug-stackframe",60299),debugStackframeFocused:C("debug-stackframe-focused",60299),debugBreakpointUnsupported:C("debug-breakpoint-unsupported",60300),symbolString:C("symbol-string",60301),debugReverseContinue:C("debug-reverse-continue",60302),debugStepBack:C("debug-step-back",60303),debugRestartFrame:C("debug-restart-frame",60304),debugAlt:C("debug-alt",60305),callIncoming:C("call-incoming",60306),callOutgoing:C("call-outgoing",60307),menu:C("menu",60308),expandAll:C("expand-all",60309),feedback:C("feedback",60310),gitPullRequestReviewer:C("git-pull-request-reviewer",60310),groupByRefType:C("group-by-ref-type",60311),ungroupByRefType:C("ungroup-by-ref-type",60312),account:C("account",60313),gitPullRequestAssignee:C("git-pull-request-assignee",60313),bellDot:C("bell-dot",60314),debugConsole:C("debug-console",60315),library:C("library",60316),output:C("output",60317),runAll:C("run-all",60318),syncIgnored:C("sync-ignored",60319),pinned:C("pinned",60320),githubInverted:C("github-inverted",60321),serverProcess:C("server-process",60322),serverEnvironment:C("server-environment",60323),pass:C("pass",60324),issueClosed:C("issue-closed",60324),stopCircle:C("stop-circle",60325),playCircle:C("play-circle",60326),record:C("record",60327),debugAltSmall:C("debug-alt-small",60328),vmConnect:C("vm-connect",60329),cloud:C("cloud",60330),merge:C("merge",60331),export:C("export",60332),graphLeft:C("graph-left",60333),magnet:C("magnet",60334),notebook:C("notebook",60335),redo:C("redo",60336),checkAll:C("check-all",60337),pinnedDirty:C("pinned-dirty",60338),passFilled:C("pass-filled",60339),circleLargeFilled:C("circle-large-filled",60340),circleLarge:C("circle-large",60341),circleLargeOutline:C("circle-large-outline",60341),combine:C("combine",60342),gather:C("gather",60342),table:C("table",60343),variableGroup:C("variable-group",60344),typeHierarchy:C("type-hierarchy",60345),typeHierarchySub:C("type-hierarchy-sub",60346),typeHierarchySuper:C("type-hierarchy-super",60347),gitPullRequestCreate:C("git-pull-request-create",60348),runAbove:C("run-above",60349),runBelow:C("run-below",60350),notebookTemplate:C("notebook-template",60351),debugRerun:C("debug-rerun",60352),workspaceTrusted:C("workspace-trusted",60353),workspaceUntrusted:C("workspace-untrusted",60354),workspaceUnknown:C("workspace-unknown",60355),terminalCmd:C("terminal-cmd",60356),terminalDebian:C("terminal-debian",60357),terminalLinux:C("terminal-linux",60358),terminalPowershell:C("terminal-powershell",60359),terminalTmux:C("terminal-tmux",60360),terminalUbuntu:C("terminal-ubuntu",60361),terminalBash:C("terminal-bash",60362),arrowSwap:C("arrow-swap",60363),copy:C("copy",60364),personAdd:C("person-add",60365),filterFilled:C("filter-filled",60366),wand:C("wand",60367),debugLineByLine:C("debug-line-by-line",60368),inspect:C("inspect",60369),layers:C("layers",60370),layersDot:C("layers-dot",60371),layersActive:C("layers-active",60372),compass:C("compass",60373),compassDot:C("compass-dot",60374),compassActive:C("compass-active",60375),azure:C("azure",60376),issueDraft:C("issue-draft",60377),gitPullRequestClosed:C("git-pull-request-closed",60378),gitPullRequestDraft:C("git-pull-request-draft",60379),debugAll:C("debug-all",60380),debugCoverage:C("debug-coverage",60381),runErrors:C("run-errors",60382),folderLibrary:C("folder-library",60383),debugContinueSmall:C("debug-continue-small",60384),beakerStop:C("beaker-stop",60385),graphLine:C("graph-line",60386),graphScatter:C("graph-scatter",60387),pieChart:C("pie-chart",60388),bracket:C("bracket",60175),bracketDot:C("bracket-dot",60389),bracketError:C("bracket-error",60390),lockSmall:C("lock-small",60391),azureDevops:C("azure-devops",60392),verifiedFilled:C("verified-filled",60393),newline:C("newline",60394),layout:C("layout",60395),layoutActivitybarLeft:C("layout-activitybar-left",60396),layoutActivitybarRight:C("layout-activitybar-right",60397),layoutPanelLeft:C("layout-panel-left",60398),layoutPanelCenter:C("layout-panel-center",60399),layoutPanelJustify:C("layout-panel-justify",60400),layoutPanelRight:C("layout-panel-right",60401),layoutPanel:C("layout-panel",60402),layoutSidebarLeft:C("layout-sidebar-left",60403),layoutSidebarRight:C("layout-sidebar-right",60404),layoutStatusbar:C("layout-statusbar",60405),layoutMenubar:C("layout-menubar",60406),layoutCentered:C("layout-centered",60407),target:C("target",60408),indent:C("indent",60409),recordSmall:C("record-small",60410),errorSmall:C("error-small",60411),terminalDecorationError:C("terminal-decoration-error",60411),arrowCircleDown:C("arrow-circle-down",60412),arrowCircleLeft:C("arrow-circle-left",60413),arrowCircleRight:C("arrow-circle-right",60414),arrowCircleUp:C("arrow-circle-up",60415),layoutSidebarRightOff:C("layout-sidebar-right-off",60416),layoutPanelOff:C("layout-panel-off",60417),layoutSidebarLeftOff:C("layout-sidebar-left-off",60418),blank:C("blank",60419),heartFilled:C("heart-filled",60420),map:C("map",60421),mapHorizontal:C("map-horizontal",60421),foldHorizontal:C("fold-horizontal",60421),mapFilled:C("map-filled",60422),mapHorizontalFilled:C("map-horizontal-filled",60422),foldHorizontalFilled:C("fold-horizontal-filled",60422),circleSmall:C("circle-small",60423),bellSlash:C("bell-slash",60424),bellSlashDot:C("bell-slash-dot",60425),commentUnresolved:C("comment-unresolved",60426),gitPullRequestGoToChanges:C("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:C("git-pull-request-new-changes",60428),searchFuzzy:C("search-fuzzy",60429),commentDraft:C("comment-draft",60430),send:C("send",60431),sparkle:C("sparkle",60432),insert:C("insert",60433),mic:C("mic",60434),thumbsdownFilled:C("thumbsdown-filled",60435),thumbsupFilled:C("thumbsup-filled",60436),coffee:C("coffee",60437),snake:C("snake",60438),game:C("game",60439),vr:C("vr",60440),chip:C("chip",60441),piano:C("piano",60442),music:C("music",60443),micFilled:C("mic-filled",60444),repoFetch:C("repo-fetch",60445),copilot:C("copilot",60446),lightbulbSparkle:C("lightbulb-sparkle",60447),robot:C("robot",60448),sparkleFilled:C("sparkle-filled",60449),diffSingle:C("diff-single",60450),diffMultiple:C("diff-multiple",60451),surroundWith:C("surround-with",60452),share:C("share",60453),gitStash:C("git-stash",60454),gitStashApply:C("git-stash-apply",60455),gitStashPop:C("git-stash-pop",60456),vscode:C("vscode",60457),vscodeInsiders:C("vscode-insiders",60458),codeOss:C("code-oss",60459),runCoverage:C("run-coverage",60460),runAllCoverage:C("run-all-coverage",60461),coverage:C("coverage",60462),githubProject:C("github-project",60463),mapVertical:C("map-vertical",60464),foldVertical:C("fold-vertical",60464),mapVerticalFilled:C("map-vertical-filled",60465),foldVerticalFilled:C("fold-vertical-filled",60465),goToSearch:C("go-to-search",60466),percentage:C("percentage",60467),sortPercentage:C("sort-percentage",60467),attach:C("attach",60468)};var tj={dialogError:C("dialog-error","error"),dialogWarning:C("dialog-warning","warning"),dialogInfo:C("dialog-info","info"),dialogClose:C("dialog-close","close"),treeItemExpanded:C("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:C("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:C("tree-filter-on-type-off","list-selection"),treeFilterClear:C("tree-filter-clear","close"),treeItemLoading:C("tree-item-loading","loading"),menuSelection:C("menu-selection","check"),menuSubmenu:C("menu-submenu","chevron-right"),menuBarMore:C("menubar-more","more"),scrollbarButtonLeft:C("scrollbar-button-left","triangle-left"),scrollbarButtonRight:C("scrollbar-button-right","triangle-right"),scrollbarButtonUp:C("scrollbar-button-up","triangle-up"),scrollbarButtonDown:C("scrollbar-button-down","triangle-down"),toolBarMore:C("toolbar-more","more"),quickInputBack:C("quick-input-back","arrow-left"),dropDownButton:C("drop-down-button",60084),symbolCustomColor:C("symbol-customcolor",60252),exportIcon:C("export",60332),workspaceUnspecified:C("workspace-unspecified",60355),newLine:C("newline",60394),thumbsDownFilled:C("thumbsdown-filled",60435),thumbsUpFilled:C("thumbsup-filled",60436),gitFetch:C("git-fetch",60445),lightbulbSparkleAutofix:C("lightbulb-sparkle-autofix",60447),debugBreakpointPending:C("debug-breakpoint-pending",60377)},ie={...sH,...tj};var aH;(e=>{function r(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=r})(aH||={});var Ae;(g=>{g.iconNameSegment="[A-Za-z0-9]+",g.iconNameExpression="[A-Za-z0-9-]+",g.iconModifierExpression="~[A-Za-z]+",g.iconNameCharacter="[A-Za-z0-9~-]";let n=new RegExp(`^(${g.iconNameExpression})(${g.iconModifierExpression})?$`);function o(b){let v=n.exec(b.id);if(!v)return o(ie.error);let[,I,w]=v,E=["codicon","codicon-"+I];return w&&E.push("codicon-modifier-"+w.substring(1)),E}g.asClassNameArray=o;function s(b){return o(b).join(" ")}g.asClassName=s;function a(b){return"."+o(b).join(".")}g.asCSSSelector=a;function l(b){return b&&typeof b=="object"&&typeof b.id=="string"&&(typeof b.color>"u"||aH.isThemeColor(b.color))}g.isThemeIcon=l;let d=new RegExp(`^\\$\\((${g.iconNameExpression}(?:${g.iconModifierExpression})?)\\)$`);function c(b){let v=d.exec(b);if(!v)return;let[,I]=v;return{id:I}}g.fromString=c;function u(b){return{id:b}}g.fromId=u;function p(b,v){let I=b.id,w=I.lastIndexOf("~");return w!==-1&&(I=I.substring(0,w)),v&&(I=`${I}~${v}`),{id:I}}g.modify=p;function m(b){let v=b.id.lastIndexOf("~");if(v!==-1)return b.id.substring(v+1)}g.getModifier=m;function f(b,v){return b.id===v.id&&b.color?.id===v.color?.id}g.isEqual=f})(Ae||={});var zc=11,IE=class extends On{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Ae.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=zc+"px",this.domNode.style.height=zc+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new wl),this._register(si(this.bgDomNode,Q.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(si(this.domNode,Q.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new Lm),this._pointerdownScheduleRepeatTimer=this._register(new Ea)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,pe(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}};var Kc=class r{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(e,t,i,n,o,s){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=n,this._scrollSize=o,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new r(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){let t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,n,o){let s=Math.max(0,i-e),a=Math.max(0,s-2*t),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(i*a/n))),c=(a-d)/(n-i),u=o*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){let e=r._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize,i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}};var u1=class r{constructor(e,t,i,n,o,s,a){this._forceIntegerValues=e;this._forceIntegerValues&&(t=t|0,i=i|0,n=n|0,o=o|0,s=s|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,t<0&&(t=0),n+t>i&&(n=i-t),n<0&&(n=0),o<0&&(o=0),a+o>s&&(a=s-o),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=n,this.height=o,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new r(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new r(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){let i=this.width!==e.width,n=this.scrollWidth!==e.scrollWidth,o=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:o,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},_a=class extends P{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new _);onScroll=this._onScroll.event;constructor(e){super(),this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new u1(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;t?n=new SE(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{let i=this._state.withScrollPosition(e);this._smoothScrolling=SE.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}},CE=class{scrollLeft;scrollTop;isDone;constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}};function c1(r,e){let t=e-r;return function(i){return r+t*oj(i)}}function ij(r,e,t){return function(i){return i<t?r(i/t):e((i-t)/(1-t))}}var SE=class r{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let o,s;return e<t?(o=e+.75*i,s=t-.75*i):(o=e-.75*i,s=t+.75*i),ij(c1(e,o),c1(s,t),.33)}return c1(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let t=(e-this.startTime)/this.duration;if(t<1){let i=this.scrollLeft(t),n=this.scrollTop(t);return new CE(i,n,!1)}return new CE(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return r.start(e,t,i)}static start(e,t,i){i=i+10;let n=Date.now()-10;return new r(e,t,n,i)}};function nj(r){return Math.pow(r,3)}function oj(r){return 1-nj(1-r)}var EE=class extends P{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Ea)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}};var rj=140,Pm=class extends On{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new EE(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new wl),this._shouldRender=!0,this.domNode=$e(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(B(this.domNode.domNode,Q.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new IE(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=$e(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(B(this.slider.domNode,Q.POINTER_DOWN,o=>{o.button===0&&(o.preventDefault(),this._sliderPointerDown(o))})),this.onclick(this.slider.domNode,o=>{o.leftButton&&o.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderPointerPosition(e);i<=o&&o<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{let o=po(this.domNode.domNode);t=e.pageX-o.left,i=e.pageY-o.top}let n=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>{let s=this._sliderOrthogonalPointerPosition(o),a=Math.abs(s-i);if(dt&&a>rj){this._setDesiredScrollPositionNow(n.getScrollPosition());return}let d=this._sliderPointerPosition(o)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var wE=class extends Pm{constructor(e,t,i){let n=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new Kc(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,o.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){let s=(t.arrowSize-zc)/2,a=(t.horizontalScrollbarSize-zc)/2;this._createArrow({className:"scra",icon:ie.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Cs(null,1,0))}),this._createArrow({className:"scra",icon:ie.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Cs(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}};var xE=class extends Pm{constructor(e,t,i){let n=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new Kc(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,o.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){let s=(t.arrowSize-zc)/2,a=(t.verticalScrollbarSize-zc)/2;this._createArrow({className:"scra",icon:ie.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Cs(null,0,1))}),this._createArrow({className:"scra",icon:ie.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Cs(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}};var sj=500,lH=50,dH=!0,p1=class{timestamp;deltaX;deltaY;score;constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}},Kv=class r{static INSTANCE=new r;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,n=this._rear;do{let o=n===this._front?e:Math.pow(2,-i);if(e-=o,t+=this._memory[n].score*o,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(Vc){let t=pe(e.browserEvent),i=p2(t);this.accept(Date.now(),e.deltaX*i,e.deltaY*i)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){let n=null,o=new p1(e,t,i);this._front===-1&&this._rear===-1?(this._memory[0]=o,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=o),o.score=this._computeScore(o,n)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(i+=.25),t){let n=Math.abs(e.deltaX),o=Math.abs(e.deltaY),s=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(n,s),1),d=Math.max(Math.min(o,a),1),c=Math.max(n,s),u=Math.max(o,a);c%l===0&&u%d===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}},Gv=class extends On{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new _);onScroll=this._onScroll.event;_onWillScroll=this._register(new _);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(e,t,i){super(),e.style.overflow="hidden",this._options=aj(t),this._scrollable=i,this._register(this._scrollable.onScroll(o=>{this._onWillScroll.fire(o),this._onDidScroll(o),this._onScroll.fire(o)}));let n={onMouseWheel:o=>this._onMouseWheel(o),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new xE(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new wE(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=$e(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=$e(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=$e(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,o=>this._onMouseOver(o)),this.onmouseleave(this._listenOnDomNode,o=>this._onMouseLeave(o)),this._hideTimeout=this._register(new Ea),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=ht(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,ke&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Cs(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=ht(this._mouseWheelToDispose),e)){let i=n=>{this._onMouseWheel(new Cs(n))};this._mouseWheelToDispose.push(B(this._listenOnDomNode,Q.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=Kv.INSTANCE;dH&&t.acceptStandardWheelEvent(e);let i=!1;if(e.deltaY||e.deltaX){let o=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+o===0?s=o=0:Math.abs(o)>=Math.abs(s)?s=0:o=0),this._options.flipAxes&&([o,s]=[s,o]);let a=!ke&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=o,o=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(o){let c=lH*o,u=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,u)}if(s){let c=lH*s,u=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,u)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(dH&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,n=i?" left":"",o=t?" top":"",s=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${o}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${o}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),sj)}},Nm=class extends Gv{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let i=new _a({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>Yi(pe(e),n)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Gc=class extends Gv{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Ys=class extends Gv{_element;constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let i=new _a({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>Yi(pe(e),n)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}};function aj(r){let e={lazyRender:typeof r.lazyRender<"u"?r.lazyRender:!1,className:typeof r.className<"u"?r.className:"",useShadows:typeof r.useShadows<"u"?r.useShadows:!0,handleMouseWheel:typeof r.handleMouseWheel<"u"?r.handleMouseWheel:!0,flipAxes:typeof r.flipAxes<"u"?r.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof r.consumeMouseWheelIfScrollbarIsNeeded<"u"?r.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof r.alwaysConsumeMouseWheel<"u"?r.alwaysConsumeMouseWheel:!1,scrollYToX:typeof r.scrollYToX<"u"?r.scrollYToX:!1,mouseWheelScrollSensitivity:typeof r.mouseWheelScrollSensitivity<"u"?r.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof r.fastScrollSensitivity<"u"?r.fastScrollSensitivity:5,scrollPredominantAxis:typeof r.scrollPredominantAxis<"u"?r.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof r.mouseWheelSmoothScroll<"u"?r.mouseWheelSmoothScroll:!0,arrowSize:typeof r.arrowSize<"u"?r.arrowSize:11,listenOnDomNode:typeof r.listenOnDomNode<"u"?r.listenOnDomNode:null,horizontal:typeof r.horizontal<"u"?r.horizontal:1,horizontalScrollbarSize:typeof r.horizontalScrollbarSize<"u"?r.horizontalScrollbarSize:10,horizontalSliderSize:typeof r.horizontalSliderSize<"u"?r.horizontalSliderSize:0,horizontalHasArrows:typeof r.horizontalHasArrows<"u"?r.horizontalHasArrows:!1,vertical:typeof r.vertical<"u"?r.vertical:1,verticalScrollbarSize:typeof r.verticalScrollbarSize<"u"?r.verticalScrollbarSize:10,verticalHasArrows:typeof r.verticalHasArrows<"u"?r.verticalHasArrows:!1,verticalSliderSize:typeof r.verticalSliderSize<"u"?r.verticalSliderSize:0,scrollByPage:typeof r.scrollByPage<"u"?r.scrollByPage:!1};return e.horizontalSliderSize=typeof r.horizontalSliderSize<"u"?r.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof r.verticalSliderSize<"u"?r.verticalSliderSize:e.verticalScrollbarSize,ke&&(e.className+=" mac"),e}var Fle=new Uint32Array(10);var Ble=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),Vle=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),Wle=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),Hle=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function uH(...r){return function(e,t){for(let i=0,n=r.length;i<n;i++){let o=r[i](e,t);if(o)return o}return null}}var $le=pH.bind(void 0,!1),Ap=pH.bind(void 0,!0);function pH(r,e,t){if(!t||t.length<e.length)return null;let i;return r?i=Il(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function lj(r,e){let t=e.toLowerCase().indexOf(r.toLowerCase());return t===-1?null:[{start:t,end:t+r.length}]}function dj(r,e){return m1(r.toLowerCase(),e.toLowerCase(),0,0)}function m1(r,e,t,i){if(t===r.length)return[];if(i===e.length)return null;if(r[t]===e[i]){let n=null;return(n=m1(r,e,t+1,i+1))?mH({start:i,end:i+1},n):null}return m1(r,e,t,i+1)}function v1(r){return 97<=r&&r<=122}function Fm(r){return 65<=r&&r<=90}function y1(r){return 48<=r&&r<=57}function cj(r){return r===32||r===9||r===10||r===13}var uj=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(r=>uj.add(r.charCodeAt(0)));function hH(r){return v1(r)||Fm(r)||y1(r)}function mH(r,e){return e.length===0?e=[r]:r.end===e[0].start?e[0].start=r.start:e.unshift(r),e}function gH(r,e){for(let t=e;t<r.length;t++){let i=r.charCodeAt(t);if(Fm(i)||y1(i)||t>0&&!hH(r.charCodeAt(t-1)))return t}return r.length}function g1(r,e,t,i){if(t===r.length)return[];if(i===e.length)return null;if(r[t]!==e[i].toLowerCase())return null;{let n=null,o=i+1;for(n=g1(r,e,t+1,i+1);!n&&(o=gH(e,o))<e.length;)n=g1(r,e,t+1,o),o++;return n===null?null:mH({start:i,end:i+1},n)}}function pj(r){let e=0,t=0,i=0,n=0,o=0;for(let c=0;c<r.length;c++)o=r.charCodeAt(c),Fm(o)&&e++,v1(o)&&t++,hH(o)&&i++,y1(o)&&n++;let s=e/r.length,a=t/r.length,l=i/r.length,d=n/r.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function hj(r){let{upperPercent:e,lowerPercent:t}=r;return t===0&&e>.6}function mj(r){let{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:n}=r;return t>.2&&e<.8&&i>.6&&n<.2}function gj(r){let e=0,t=0,i=0,n=0;for(let o=0;o<r.length;o++)i=r.charCodeAt(o),Fm(i)&&e++,v1(i)&&t++,cj(i)&&n++;return(e===0||t===0)&&n===0?r.length<=30:e<=5}function fH(r,e){if(!e||(e=e.trim(),e.length===0)||!gj(r))return null;e.length>60&&(e=e.substring(0,60));let t=pj(e);if(!mj(t)){if(!hj(t))return null;e=e.toLowerCase()}let i=null,n=0;for(r=r.toLowerCase();n<e.length&&(i=g1(r,e,0,n))===null;)n=gH(e,n+1);return i}var Yle=uH(Ap,fH,lj),Zle=uH(Ap,fH,dj),Xle=new Br(1e4);function bH(r,e){let t=LE(r,r.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?DE(t):null}function DE(r){if(typeof r>"u")return[];let e=[],t=r[1];for(let i=r.length-1;i>1;i--){let n=r[i]+t,o=e[e.length-1];o&&o.end===n?o.end=n+1:e.push({start:n,end:n+1})}return e}var qc=128;function I1(){let r=[],e=[];for(let t=0;t<=qc;t++)e[t]=0;for(let t=0;t<=qc;t++)r.push(e.slice(0));return r}function vH(r){let e=[];for(let t=0;t<=r;t++)e[t]=0;return e}var yH=vH(2*qc),f1=vH(2*qc),xl=I1(),jc=I1(),jv=I1(),fj=!1;function h1(r,e,t,i,n){function o(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${i.split("").map(a=>o(a,3)).join("|")}
`;for(let a=0;a<=t;a++)a===0?s+=" |":s+=`${e[a-1]}|`,s+=r[a].slice(0,n+1).map(l=>o(l.toString(),3)).join("|")+`
`;return s}function bj(r,e,t,i){r=r.substr(e),t=t.substr(i),console.log(h1(jc,r,r.length,t,t.length)),console.log(h1(jv,r,r.length,t,t.length)),console.log(h1(xl,r,r.length,t,t.length))}function TE(r,e){if(e<0||e>=r.length)return!1;let t=r.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!wv(t)}}function cH(r,e){if(e<0||e>=r.length)return!1;switch(r.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function _E(r,e,t){return e[r]!==t[r]}function vj(r,e,t,i,n,o,s=!1){for(;e<t&&n<o;)r[e]===i[n]&&(s&&(yH[e]=n),e+=1),n+=1;return e===t}var Mp;(t=>{t.Default=[-100,0];function e(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}t.isDefault=e})(Mp||={});var b1=class{constructor(e,t){this.firstMatchCanBeWeak=e;this.boostFullMatch=t}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function LE(r,e,t,i,n,o,s=b1.default){let a=r.length>qc?qc:r.length,l=i.length>qc?qc:i.length;if(t>=a||o>=l||a-t>l-o||!vj(e,t,a,n,o,l,!0))return;yj(a,l,t,o,e,n);let d=1,c=1,u=t,p=o,m=[!1];for(d=1,u=t;u<a;d++,u++){let I=yH[u],w=f1[u],E=u+1<a?f1[u+1]:l;for(c=I-o+1,p=I;p<E;c++,p++){let S=Number.MIN_SAFE_INTEGER,T=!1;p<=w&&(S=Ij(r,e,u,t,i,n,p,l,o,xl[d-1][c-1]===0,m));let D=0;S!==Number.MAX_SAFE_INTEGER&&(T=!0,D=S+jc[d-1][c-1]);let L=p>I,A=L?jc[d][c-1]+(xl[d][c-1]>0?-5:0):0,W=p>I+1&&xl[d][c-1]>0,j=W?jc[d][c-2]+(xl[d][c-2]>0?-5:0):0;if(W&&(!L||j>=A)&&(!T||j>=D))jc[d][c]=j,jv[d][c]=3,xl[d][c]=0;else if(L&&(!T||A>=D))jc[d][c]=A,jv[d][c]=2,xl[d][c]=0;else if(T)jc[d][c]=D,jv[d][c]=1,xl[d][c]=xl[d-1][c-1]+1;else throw new Error("not possible")}}if(fj&&bj(r,t,i,o),!m[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let f=[jc[d][c],o],g=0,b=0;for(;d>=1;){let I=c;do{let w=jv[d][I];if(w===3)I=I-2;else if(w===2)I=I-1;else break}while(I>=1);g>1&&e[t+d-1]===n[o+c-1]&&!_E(I+o-1,i,n)&&g+1>xl[d][I]&&(I=c),I===c?g++:g=1,b||(b=I),d--,c=I-1,f.push(c)}l-o===a&&s.boostFullMatch&&(f[0]+=2);let v=b-a;return f[0]-=v,f}function yj(r,e,t,i,n,o){let s=r-1,a=e-1;for(;s>=t&&a>=i;)n[s]===o[a]&&(f1[s]=a,s--),a--}function Ij(r,e,t,i,n,o,s,a,l,d,c){if(e[t]!==o[s])return Number.MIN_SAFE_INTEGER;let u=1,p=!1;return s===t-i?u=r[t]===n[s]?7:5:_E(s,n,o)&&(s===0||!_E(s-1,n,o))?(u=r[t]===n[s]?7:5,p=!0):TE(o,s)&&(s===0||!TE(o,s-1))?u=5:(TE(o,s-1)||cH(o,s-1))&&(u=5,p=!0),u>1&&t===i&&(c[0]=!0),p||(p=_E(s,n,o)||TE(o,s-1)||cH(o,s-1)),t===i?s>l&&(u-=p?3:5):d?u+=p?2:0:u+=p?0:1,s+1===a&&(u-=p?3:5),u}var Cj="$(",C1=new RegExp(`\\$\\(${Ae.iconNameExpression}(?:${Ae.iconModifierExpression})?\\)`,"g"),Sj=new RegExp(`(\\\\)?${C1.source}`,"g");function IH(r){return r.replace(Sj,(e,t)=>t?e:`\\${e}`)}var Ej=new RegExp(`\\\\${C1.source}`,"g");function CH(r){return r.replace(Ej,e=>`\\${e}`)}var wj=new RegExp(`(\\s)?(\\\\)?${C1.source}(\\s)?`,"g");function S1(r){return r.indexOf(Cj)===-1?r:r.replace(wj,(e,t,i,n)=>i?e:t||n||"")}var ode=new RegExp(`\\$\\(${Ae.iconNameCharacter}+\\)`,"g");var Op=class{value;isTrusted;supportThemeIcons;supportHtml;baseUri;constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw ap("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=xj(this.supportThemeIcons?IH(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${Tj(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){let i=new RegExp(or(t),"g");return e.replace(i,(n,o)=>e.charAt(o-1)!=="\\"?`\\${n}`:n)}};function kE(r){return r instanceof Op?!0:r&&typeof r=="object"?typeof r.value=="string"&&(typeof r.isTrusted=="boolean"||typeof r.isTrusted=="object"||r.isTrusted===void 0)&&(typeof r.supportThemeIcons=="boolean"||r.supportThemeIcons===void 0):!1}function SH(r,e){return r===e?!0:!r||!e?!1:r.value===e.value&&r.isTrusted===e.isTrusted&&r.supportThemeIcons===e.supportThemeIcons&&r.supportHtml===e.supportHtml&&(r.baseUri===e.baseUri||!!r.baseUri&&!!e.baseUri&&Li(X.from(r.baseUri),X.from(e.baseUri)))}function xj(r){return r.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Tj(r,e){let t=r.match(/^`+/gm)?.reduce((n,o)=>n.length>o.length?n:o).length??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,r,`${"`".repeat(i)}`].join(`
`)}function qv(r){return r.replace(/"/g,"&quot;")}function RE(r){return r&&r.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function EH(r){let e=[],t=r.split("|").map(n=>n.trim());r=t[0];let i=t[1];if(i){let n=/height=(\d+)/.exec(i),o=/width=(\d+)/.exec(i),s=n?n[1]:"",a=o?o[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&e.push(`width="${a}"`),d&&e.push(`height="${s}"`)}return{href:r,dimensions:e}}var _j=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),E1=_j,Dj=new Dn(()=>E1("mouse",!1)),Lj=new Dn(()=>E1("element",!1));function Dt(r){return r==="element"?Lj.value:Dj.value}function Vd(){return E1("element",!0)}var Pn=class extends P{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new Y);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new br);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new _);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new _({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new _);onDidRun=this._onDidRun.event;_onWillRun=this._register(new _);onWillRun=this._onWillRun.event;constructor(e,t={}){super(),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(Vd()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new lo,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(o=>this._onDidRun.fire(o))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(o=>this._onWillRun.fire(o))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(B(this.domNode,Q.KEY_DOWN,o=>{let s=new bt(o),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusPrevious():n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof mo&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(B(this.domNode,Q.KEY_UP,o=>{let s=new bt(o);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Mn(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(mn()===this.domNode||!An(mn(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(e){e?this.actionsList.setAttribute("aria-label",e):this.actionsList.removeAttribute("aria-label")}setFocusable(e){if(this.focusable=e,this.focusable){let t=this.viewItems.find(i=>i instanceof mo&&i.isEnabled());t instanceof mo&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof mo&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){let t=this.actionsList.children[e];if(An(mn(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}hasAction(e){return this.viewItems.findIndex(t=>t.action.id===e.id)!==-1}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(ki(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){let i=Array.isArray(e)?e:[e],n=so(t.index)?t.index:null;i.forEach(o=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(o,l)),a||(a=new $c(this.context,o,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,B(s,Q.CONTEXT_MENU,d=>{Oe.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof mo&&this.viewItems.length===0&&a.setFocusable(!0),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}getHeight(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientHeight}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),ht(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=ht(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),Xt(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){let n=this.viewItems.findIndex(o=>o.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let i=this.focusedItem,n;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===sn.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let t=this.focusedItem,i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===sn.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let o=!0;Sp(n.focus)||(o=!1),this.options.focusOnlyEnabledItems&&Sp(n.isEnabled)&&!n.isEnabled()&&(o=!1),n.action.id===sn.ID&&(o=!1),o?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),o&&n.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;let t=this.viewItems[this.focusedItem];if(t instanceof mo){let i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=ht(this.viewItems),this.getContainer().remove(),super.dispose()}};function Bm(r){if(!r.length)return r;let e=-1;for(let i=0;i<r.length;i++)if(r[i].id!==sn.ID){e=i;break}if(e===-1)return[];r=r.slice(e);for(let i=r.length-1;i>=0&&r[i].id===sn.ID;i--)r.splice(i,1);let t=!1;for(let i=r.length-1;i>=0;i--){let n=r[i].id===sn.ID;n&&!t?r.splice(i,1):n?n&&(t=!1):t=!0}return r}var qn;(n=>{function r(o,s){if(o.start>=s.end||s.start>=o.end)return{start:0,end:0};let a=Math.max(o.start,s.start),l=Math.min(o.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}n.intersect=r;function e(o){return o.end-o.start<=0}n.isEmpty=e;function t(o,s){return!e(r(o,s))}n.intersects=t;function i(o,s){let a=[],l={start:o.start,end:Math.min(s.start,o.end)},d={start:Math.max(s.end,o.start),end:o.end};return e(l)||a.push(l),e(d)||a.push(d),a}n.relativeComplement=i})(qn||={});function wH(r,e={}){let t=AE(e);return t.textContent=r,t}function xH(r,e={}){let t=AE(e);return TH(t,kj(r,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function AE(r){let e=r.inline?"span":"div",t=document.createElement(e);return r.className&&(t.className=r.className),t}var w1=class{source;index;constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){let e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}};function TH(r,e,t,i){let n;if(e.type===2)n=document.createTextNode(e.content||"");else if(e.type===3)n=document.createElement("b");else if(e.type===4)n=document.createElement("i");else if(e.type===7&&i)n=document.createElement("code");else if(e.type===5&&t){let o=document.createElement("a");t.disposables.add(si(o,"click",s=>{t.callback(String(e.index),s)})),n=o}else e.type===8?n=document.createElement("br"):e.type===1&&(n=r);n&&r!==n&&r.appendChild(n),n&&Array.isArray(e.children)&&e.children.forEach(o=>{TH(n,o,t,i)})}function kj(r,e){let t={type:1,children:[]},i=0,n=t,o=[],s=new w1(r);for(;!s.eos();){let a=s.next(),l=a==="\\"&&x1(s.peek(),e)!==0;if(l&&(a=s.next()),!l&&Rj(a,e)&&a===s.peek()){s.advance(),n.type===2&&(n=o.pop());let d=x1(a,e);if(n.type===d||n.type===5&&d===6)n=o.pop();else{let c={type:d,children:[]};d===5&&(c.index=i,i++),n.children.push(c),o.push(n),n=c}}else if(a===`
`)n.type===2&&(n=o.pop()),n.children.push({type:8});else if(n.type!==2){let d={type:2,content:a};n.children.push(d),o.push(n),n=d}else n.content+=a}return n.type===2&&(n=o.pop()),o.length,t}function Rj(r,e){return x1(r,e)!==0}function x1(r,e){switch(r){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}var Me=class{emitter;get event(){return this.emitter.event}constructor(e,t,i){let n=o=>this.emitter.fire(o);this.emitter=new _({onWillAddFirstListener:()=>e.addEventListener(t,n,i),onDidRemoveLastListener:()=>e.removeEventListener(t,n,i)})}dispose(){this.emitter.dispose()}};var _H=2e4,kH,T1,DH,_1,LH;function Yc(r){kH&&(T1.textContent!==r?(Xt(DH),ME(T1,r)):(Xt(T1),ME(DH,r)))}function $v(r){kH&&(_1.textContent!==r?(Xt(LH),ME(_1,r)):(Xt(_1),ME(LH,r)))}function ME(r,e){Xt(r),e.length>_H&&(e=e.substr(0,_H)),r.textContent=e,r.style.visibility="hidden",r.style.visibility="visible"}var OE=class{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(n=>n.splice(e,t,i))}};function Xc(r,e){let t=Math.pow(10,e);return Math.round(r*t)/t}var lt=class{_rgbaBrand=void 0;r;g;b;a;constructor(e,t,i,n=1){this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Xc(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}},Zc=class r{_hslaBrand=void 0;h;s;l;a;constructor(e,t,i,n){this.h=Math.max(Math.min(360,e),0)|0,this.s=Xc(Math.max(Math.min(1,t),0),3),this.l=Xc(Math.max(Math.min(1,i),0),3),this.a=Xc(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){let t=e.r/255,i=e.g/255,n=e.b/255,o=e.a,s=Math.max(t,i,n),a=Math.min(t,i,n),l=0,d=0,c=(a+s)/2,u=s-a;if(u>0){switch(d=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),s){case t:l=(i-n)/u+(i<n?6:0);break;case i:l=(n-t)/u+2;break;case n:l=(t-i)/u+4;break}l*=60,l=Math.round(l)}return new r(l,d,c,o)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){let t=e.h/360,{s:i,l:n,a:o}=e,s,a,l;if(i===0)s=a=l=n;else{let d=n<.5?n*(1+i):n+i-n*i,c=2*n-d;s=r._hue2rgb(c,d,t+1/3),a=r._hue2rgb(c,d,t),l=r._hue2rgb(c,d,t-1/3)}return new lt(Math.round(s*255),Math.round(a*255),Math.round(l*255),o)}},Vm=class r{_hsvaBrand=void 0;h;s;v;a;constructor(e,t,i,n){this.h=Math.max(Math.min(360,e),0)|0,this.s=Xc(Math.max(Math.min(1,t),0),3),this.v=Xc(Math.max(Math.min(1,i),0),3),this.a=Xc(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){let t=e.r/255,i=e.g/255,n=e.b/255,o=Math.max(t,i,n),s=Math.min(t,i,n),a=o-s,l=o===0?0:a/o,d;return a===0?d=0:o===t?d=((i-n)/a%6+6)%6:o===i?d=(n-t)/a+2:d=(t-i)/a+4,new r(Math.round(d*60),l,o,e.a)}static toRGBA(e){let{h:t,s:i,v:n,a:o}=e,s=n*i,a=s*(1-Math.abs(t/60%2-1)),l=n-s,[d,c,u]=[0,0,0];return t<60?(d=s,c=a):t<120?(d=a,c=s):t<180?(c=s,u=a):t<240?(c=a,u=s):t<300?(d=a,u=s):t<=360&&(d=s,u=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),u=Math.round((u+l)*255),new lt(d,c,u,o)}},U=class r{static fromHex(e){return r.Format.CSS.parseHex(e)||r.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:Zc.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:Vm.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof lt)this.rgba=e;else if(e instanceof Zc)this._hsla=e,this.rgba=Zc.toRGBA(e);else if(e instanceof Vm)this._hsva=e,this.rgba=Vm.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&lt.equals(this.rgba,e.rgba)&&Zc.equals(this.hsla,e.hsla)&&Vm.equals(this.hsva,e.hsva)}getRelativeLuminance(){let e=r._relativeLuminanceForComponent(this.rgba.r),t=r._relativeLuminanceForComponent(this.rgba.g),i=r._relativeLuminanceForComponent(this.rgba.b),n=.2126*e+.7152*t+.0722*i;return Xc(n,4)}static _relativeLuminanceForComponent(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){let t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i?(t+.05)/(i+.05):(i+.05)/(t+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){let t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){let t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new r(new Zc(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new r(new Zc(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){let{r:t,g:i,b:n,a:o}=this.rgba;return new r(new lt(t,i,n,o*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new r(new lt(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){let t=e.rgba,i=this.rgba.a,n=t.a,o=i+n*(1-i);if(o<1e-6)return r.transparent;let s=this.rgba.r*i/o+t.r*n*(1-i)/o,a=this.rgba.g*i/o+t.g*n*(1-i)/o,l=this.rgba.b*i/o+t.b*n*(1-i)/o;return new r(new lt(s,a,l,o))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;let{r:t,g:i,b:n,a:o}=this.rgba;return new r(new lt(e.rgba.r-o*(e.rgba.r-t),e.rgba.g-o*(e.rgba.g-i),e.rgba.b-o*(e.rgba.b-n),1))}flatten(...e){let t=e.reduceRight((i,n)=>r._flatten(n,i));return r._flatten(this,t)}static _flatten(e,t){let i=1-e.rgba.a;return new r(new lt(i*t.rgba.r+e.rgba.a*e.rgba.r,i*t.rgba.g+e.rgba.a*e.rgba.g,i*t.rgba.b+e.rgba.a*e.rgba.b))}_toString;toString(){return this._toString||(this._toString=r.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;let n=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(o-n)/o,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;let n=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(n-o)/n,e.darken(i)}static white=new r(new lt(255,255,255,1));static black=new r(new lt(0,0,0,1));static red=new r(new lt(255,0,0,1));static blue=new r(new lt(0,0,255,1));static green=new r(new lt(0,255,0,1));static cyan=new r(new lt(0,255,255,1));static lightgrey=new r(new lt(211,211,211,1));static transparent=new r(new lt(0,0,0,0))};(e=>{let r;(i=>{let t;(f=>{function n(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:e.Format.CSS.formatRGBA(g)}f.formatRGB=n;function o(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}f.formatRGBA=o;function s(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:e.Format.CSS.formatHSLA(g)}f.formatHSL=s;function a(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}f.formatHSLA=a;function l(g){let b=g.toString(16);return b.length!==2?"0"+b:b}function d(g){return`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}`}f.formatHex=d;function c(g,b=!1){return b&&g.rgba.a===1?e.Format.CSS.formatHex(g):`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}${l(Math.round(g.rgba.a*255))}`}f.formatHexA=c;function u(g){return g.isOpaque()?e.Format.CSS.formatHex(g):e.Format.CSS.formatRGBA(g)}f.format=u;function p(g){let b=g.length;if(b===0||g.charCodeAt(0)!==35)return null;if(b===7){let v=16*m(g.charCodeAt(1))+m(g.charCodeAt(2)),I=16*m(g.charCodeAt(3))+m(g.charCodeAt(4)),w=16*m(g.charCodeAt(5))+m(g.charCodeAt(6));return new e(new lt(v,I,w,1))}if(b===9){let v=16*m(g.charCodeAt(1))+m(g.charCodeAt(2)),I=16*m(g.charCodeAt(3))+m(g.charCodeAt(4)),w=16*m(g.charCodeAt(5))+m(g.charCodeAt(6)),E=16*m(g.charCodeAt(7))+m(g.charCodeAt(8));return new e(new lt(v,I,w,E/255))}if(b===4){let v=m(g.charCodeAt(1)),I=m(g.charCodeAt(2)),w=m(g.charCodeAt(3));return new e(new lt(16*v+v,16*I+I,16*w+w))}if(b===5){let v=m(g.charCodeAt(1)),I=m(g.charCodeAt(2)),w=m(g.charCodeAt(3)),E=m(g.charCodeAt(4));return new e(new lt(16*v+v,16*I+I,16*w+w,(16*E+E)/255))}return null}f.parseHex=p;function m(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(t=i.CSS||={})})(r=e.Format||={})})(U||={});function RH(r,e){let t=[];for(let i of e){if(r.start>=i.range.end)continue;if(r.end<i.range.start)break;let n=qn.intersect(r,i.range);qn.isEmpty(n)||t.push({range:n,size:i.size})}return t}function NE({start:r,end:e},t){return{start:r+t,end:e+t}}function Mj(r){let e=[],t=null;for(let i of r){let n=i.range.start,o=i.range.end,s=i.size;if(t&&s===t.size){t.range.end=o;continue}t={range:{start:n,end:o},size:s},e.push(t)}return e}function Oj(...r){return Mj(r.reduce((e,t)=>e.concat(t),[]))}var PE=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){let n=i.length-t,o=RH({start:0,end:e},this.groups),s=RH({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:NE(l.range,n),size:l.size})),a=i.map((l,d)=>({range:{start:e+d,end:e+d+1},size:l.size}));this.groups=Oj(o,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(let n of this.groups){let o=n.range.end-n.range.start,s=i+o*n.size;if(e<s)return t+Math.floor((e-i)/n.size);t+=o,i=s}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(let n of this.groups){let o=n.range.end-n.range.start,s=i+o;if(e<s)return this._paddingTop+t+(e-i)*n.size;t+=o*n.size,i=s}return-1}};var FE=class{constructor(e){this.renderers=e}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{let n=he(".monaco-list-row"),s=this.getRenderer(e).renderTemplate(n);t={domNode:n,templateId:e,templateData:s}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(let t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){let{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(let i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){let t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}};var Pp={CurrentDragAndDropData:void 0};var Tl={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(r){return[r]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},Zs=class{elements;_context;get context(){return this._context}set context(e){this._context=e}constructor(e){this.elements=e}update(){}getData(){return this.elements}},D1=class{elements;constructor(e){this.elements=e}update(){}getData(){return this.elements}},Yv=class{types;files;constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){let i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}};function Pj(r,e){return Array.isArray(r)&&Array.isArray(e)?li(r,e):r===e}var L1=class{getSetSize;getPosInSet;getRole;isChecked;constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,n)=>n,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}},qr=class qr{constructor(e,t,i,n=Tl){this.virtualDelegate=t;if(n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(let s of i)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new FE(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??Tl.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new L1(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??Tl.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(ei.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new _a({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>Yi(pe(this.domNode),s)})),this.scrollableElement=this.disposables.add(new Gc(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??Tl.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??Tl.verticalScrollMode,useShadows:n.useShadows??Tl.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(B(this.rowsContainer,it.Change,s=>this.onTouchChange(s))),this.disposables.add(B(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(B(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(B(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(B(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(B(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=n.setRowLineHeight??Tl.setRowLineHeight,this.setRowHeight=n.setRowHeight??Tl.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??Tl.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(Tl.dnd),this.layout(n.initialSize?.height,n.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++qr.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new vs(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=P.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=P.None;onDragLeaveTimeout=P.None;disposables=new Y;_onDidChangeContentHeight=new _;_onDidChangeContentWidth=new _;onDidChangeContentHeight=z.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=z.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:Rm(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(e){this.scrollableElement.delegateScrollFromMouseWheelEvent(e)}delegateVerticalScrollbarPointerDown(e){this.scrollableElement.delegateVerticalScrollbarPointerDown(e)}updateElementHeight(e,t,i){if(e<0||e>=this.items.length)return;let n=this.items[e].size;if(typeof t>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[e].lastDynamicHeightWidth=void 0,t=n+this.probeDynamicHeight(e)}if(n===t)return;let o=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;e<o.start||i!==null&&i>e&&i<o.end?s=t-n:s=0,this.rangeMap.splice(e,1,[{size:t}]),this.items[e].size=t,this.render(o,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(e){return new PE(e)}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),o={start:e,end:e+t},s=qn.intersect(n,o),a=new Map;for(let S=s.end-1;S>=s.start;S--){let T=this.items[S];if(T.dragStartDisposable.dispose(),T.checkedDisposable.dispose(),T.row){let D=a.get(T.templateId);D||(D=[],a.set(T.templateId,D));let L=this.renderers.get(T.templateId);L&&L.disposeElement&&L.disposeElement(T.element,S,T.row.templateData,T.size),D.unshift(T.row)}T.row=null,T.stale=!0}let l={start:e+t,end:this.items.length},d=qn.intersect(l,n),c=qn.relativeComplement(l,n),u=i.map(S=>({id:String(this.itemId++),element:S,templateId:this.virtualDelegate.getTemplateId(S),size:this.virtualDelegate.getHeight(S),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(S),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:P.None,checkedDisposable:P.None,stale:!1})),p;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),p=this.items,this.items=u):(this.rangeMap.splice(e,t,u),p=this.items.splice(e,t,...u));let m=i.length-t,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),g=NE(d,m),b=qn.intersect(f,g);for(let S=b.start;S<b.end;S++)this.updateItemInDOM(this.items[S],S);let v=qn.relativeComplement(g,f);for(let S of v)for(let T=S.start;T<S.end;T++)this.removeItemFromDOM(T);let I=c.map(S=>NE(S,m)),E=[{start:e,end:e+i.length},...I].map(S=>qn.intersect(f,S)).reverse();for(let S of E)for(let T=S.end-1;T>=S.start;T--){let D=this.items[T],A=a.get(D.templateId)?.pop();this.insertItemInDOM(T,A)}for(let S of a.values())for(let T of S)this.cache.release(T);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),p.map(S=>S.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Yi(pe(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(let t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(e){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let t=this.items[e];this.measureItemWidth(t),typeof t.width<"u"&&t.width>this.scrollWidth&&(this.scrollWidth=t.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let e=this.firstVisibleIndex,t=this.rangeMap.positionAt(e),i=this.rangeMap.positionAt(e+1);return i!==-1&&(i-t)/2+t<this.scrollTop?e+1:e}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){let t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let i={height:typeof e=="number"?e:cE(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:Rm(this.domNode)})}render(e,t,i,n,o,s=!1){let a=this.getRenderRange(t,i),l=qn.relativeComplement(a,e).reverse(),d=qn.relativeComplement(e,a);if(s){let c=qn.intersect(e,a);for(let u=c.start;u<c.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(let c of d)for(let u=c.start;u<c.end;u++)this.removeItemFromDOM(u);for(let c of l)for(let u=c.end-1;u>=c.start;u--)this.insertItemInDOM(u)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&o!==void 0&&(this.rowsContainer.style.width=`${Math.max(o,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t){let i=this.items[e];if(!i.row)if(t)i.row=t,i.stale=!0;else{let l=this.cache.alloc(i.templateId);i.row=l.row,i.stale||=l.isReusingConnectedDomNode}let n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);let o=this.accessibilityProvider.isChecked(i.element);if(typeof o=="boolean")i.row.domNode.setAttribute("aria-checked",String(!!o));else if(o){let l=d=>i.row.domNode.setAttribute("aria-checked",String(!!d));l(o.value),i.checkedDisposable=o.onDidChange(()=>l(o.value))}if(i.stale||!i.row.domNode.parentElement){let l=this.items.at(e+1)?.row?.domNode??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(i.row.domNode,l),i.stale=!1}this.updateItemInDOM(i,e);let s=this.renderers.get(i.templateId);if(!s)throw new Error(`No renderer found for template id ${i.templateId}`);s?.renderElement(i.element,e,i.row.templateData,i.size);let a=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!a,a&&(i.dragStartDisposable=B(i.row.domNode,"dragstart",l=>this.onDragStart(i.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=Rm(e.row.domNode);let t=pe(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){let t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let i=this.renderers.get(t.templateId);i&&i.disposeElement&&i.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:e})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return z.map(this.disposables.add(new Me(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return z.map(this.disposables.add(new Me(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return z.filter(z.map(this.disposables.add(new Me(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseUp(){return z.map(this.disposables.add(new Me(this.domNode,"mouseup")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDown(){return z.map(this.disposables.add(new Me(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return z.map(this.disposables.add(new Me(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMove(){return z.map(this.disposables.add(new Me(this.domNode,"mousemove")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return z.map(this.disposables.add(new Me(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return z.any(z.map(this.disposables.add(new Me(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),z.map(this.disposables.add(new Me(this.domNode,it.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return z.map(this.disposables.add(new Me(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return z.map(this.disposables.add(new Me(this.rowsContainer,it.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toTouchEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toGestureEvent(e){let t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toDragEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element,o=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:n,sector:o}}onScroll(e){try{let t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){if(!i.dataTransfer)return;let n=this.dnd.getDragElements(e);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(Mo.TEXT,t),i.dataTransfer.setDragImage){let o;this.dnd.getDragLabel&&(o=this.dnd.getDragLabel(n,i)),typeof o>"u"&&(o=String(n.length));let s=he(".monaco-drag-image");s.textContent=o,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),i.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new Zs(n),Pp.CurrentDragAndDropData=new D1(n),this.dnd.onDragStart?.(this.currentDragData,i)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),Pp.CurrentDragAndDropData&&Pp.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(Pp.CurrentDragAndDropData)this.currentDragData=Pp.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new Yv}let t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let i;typeof t!="boolean"&&t.feedback?i=t.feedback:typeof e.index>"u"?i=[-1]:i=[e.index],i=fa(i).filter(o=>o>=-1&&o<this.length).sort((o,s)=>o-s),i=i[0]===-1?[-1]:i;let n=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(Pj(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=te(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(let o of i){let s=this.items[o];s.dropTarget=!0,s.row?.domNode.classList.add(n)}this.currentDragFeedbackDisposable=te(()=>{for(let o of i){let s=this.items[o];s.dropTarget=!1,s.row?.domNode.classList.remove(n)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=Av(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;let t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Pp.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Pp.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=P.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){let t=_p(this.domNode).top;this.dragOverAnimationDisposable=tH(pe(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=Av(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;let t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;let i=e.offsetY/this.items[t].size,n=Math.floor(i/.25);return uo(n,0,3)}getItemIndexFromEventTarget(e){let t=this.scrollableElement.getDomNode(),i=e;for(;(ki(i)||Y2(i))&&i!==this.rowsContainer&&t.contains(i);){let n=i.getAttribute("data-index");if(n){let o=Number(n);if(!isNaN(o))return o}i=i.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,i){let n=this.getRenderRange(e,t),o,s;e===this.elementTop(n.start)?(o=n.start,s=0):n.end-n.start>1&&(o=n.start+1,s=this.elementTop(o)-e);let a=0;for(;;){let l=this.getRenderRange(e,t),d=!1;for(let c=l.start;c<l.end;c++){let u=this.probeDynamicHeight(c);u!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=u,d=d||u!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=qn.relativeComplement(n,l);for(let p of c)for(let m=p.start;m<p.end;m++)this.items[m].row&&this.removeItemFromDOM(m);let u=qn.relativeComplement(l,n).reverse();for(let p of u)for(let m=p.end-1;m>=p.start;m--)this.insertItemInDOM(m);for(let p=l.start;p<l.end;p++)this.items[p].row&&this.updateItemInDOM(this.items[p],p);if(typeof o=="number"){let p=this.scrollable.getFutureScrollPosition().scrollTop-e,m=this.elementTop(o)-s+p;this.setScrollTop(m,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){let t=this.items[e];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(t.element);if(s!==null){let a=t.size;return t.size=s,t.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;let i=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!An(t.row.domNode,pe(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-i;let{row:n}=this.cache.alloc(t.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);let o=this.renderers.get(t.templateId);if(!o)throw new Je("Missing renderer for templateId: "+t.templateId);return o.renderElement(t.element,e,n.templateData,void 0),t.size=n.domNode.offsetHeight,o.disposeElement?.(t.element,e,n.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),t.size-i}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(let e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};R([me],qr.prototype,"onMouseClick",1),R([me],qr.prototype,"onMouseDblClick",1),R([me],qr.prototype,"onMouseMiddleClick",1),R([me],qr.prototype,"onMouseUp",1),R([me],qr.prototype,"onMouseDown",1),R([me],qr.prototype,"onMouseOver",1),R([me],qr.prototype,"onMouseMove",1),R([me],qr.prototype,"onMouseOut",1),R([me],qr.prototype,"onContextMenu",1),R([me],qr.prototype,"onTouchStart",1),R([me],qr.prototype,"onTap",1);var BE=qr;var _l=class extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}};var k1=class{constructor(e){this.trait=e}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){let n=this.renderedElements.findIndex(o=>o.templateData===i);if(n>=0){let o=this.renderedElements[n];this.trait.unrender(i),o.index=t}else{let o={index:t,templateData:i};this.renderedElements.push(o)}this.trait.renderIndex(t,i)}splice(e,t,i){let n=[];for(let o of this.renderedElements)o.index<e?n.push(o):o.index>=e+t&&n.push({index:o.index+i-t,templateData:o.templateData});this.renderedElements=n}renderIndexes(e){for(let{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){let t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}},Hm=class{constructor(e){this._trait=e}indexes=[];sortedIndexes=[];_onChange=new _;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new k1(this)}splice(e,t,i){let n=i.length-t,o=e+t,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)s.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&s.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=o;)s.push(this.sortedIndexes[a++]+n);this.renderer.splice(e,t,i.length),this._set(s,s)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(PH),t)}_set(e,t,i){let n=this.indexes,o=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;let s=O1(o,e);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:e,browserEvent:i}),n}get(){return this.indexes}contains(e){return qV(this.sortedIndexes,e,PH)>=0}dispose(){ht(this._onChange)}};R([me],Hm.prototype,"renderer",1);var R1=class extends Hm{constructor(t){super("selected");this.setAriaSelected=t}renderIndex(t,i){super.renderIndex(t,i),this.setAriaSelected&&(this.contains(t)?i.setAttribute("aria-selected","true"):i.setAttribute("aria-selected","false"))}},Zv=class{constructor(e,t,i){this.trait=e;this.view=t;this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));let n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));let o=new Set(n),s=i.map(a=>o.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,s)}};function Qv(r,e){return r.classList.contains(e)?!0:r.classList.contains("monaco-list")||!r.parentElement?!1:Qv(r.parentElement,e)}function Wm(r){return Qv(r,"monaco-editor")}function NH(r){return Qv(r,"monaco-custom-toggle")}function FH(r){return Qv(r,"action-item")}function Um(r){return Qv(r,"monaco-tree-sticky-row")}function zm(r){return r.classList.contains("monaco-tree-sticky-container")}function B1(r){return r.tagName==="A"&&r.classList.contains("monaco-button")||r.tagName==="DIV"&&r.classList.contains("monaco-button-dropdown")?!0:r.classList.contains("monaco-list")||!r.parentElement?!1:B1(r.parentElement)}var VE=class{constructor(e,t,i){this.list=e;this.view=t;this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(ke?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}disposables=new Y;multipleSelectionDisposables=new Y;multipleSelectionSupport;get onKeyDown(){return z.chain(this.disposables.add(new Me(this.view.domNode,"keydown")).event,e=>e.filter(t=>!Gr(t.target)).map(t=>new bt(t)))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(_n(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};R([me],VE.prototype,"onKeyDown",1);var Nj=new class{mightProducePrintableCharacter(r){return r.ctrlKey||r.metaKey||r.altKey?!1:r.keyCode>=31&&r.keyCode<=56||r.keyCode>=21&&r.keyCode<=30||r.keyCode>=98&&r.keyCode<=107||r.keyCode>=85&&r.keyCode<=95}},A1=class{constructor(e,t,i,n,o){this.list=e;this.view=t;this.keyboardNavigationLabelProvider=i;this.keyboardNavigationEventFilter=n;this.delegate=o;this.updateOptions(e.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new Y;disposables=new Y;updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let e=!1,t=z.chain(this.enabledDisposables.add(new Me(this.view.domNode,"keydown")).event,o=>o.filter(s=>!Gr(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new bt(s)).filter(s=>e||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>Oe.stop(s,!0)).map(s=>s.browserEvent.key)),i=z.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);z.reduce(z.any(t,i),(o,s)=>s===null?null:(o||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){let t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?Yc(t):t&&Yc(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=0,this.triggered=!1;return}let t=this.list.getFocus(),i=t.length>0?t[0]:0,n=this.state===0?1:0;this.state=1;for(let o=0;o<this.list.length;o++){let s=(i+o+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(Ap(e,l)){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}let d=bH(e,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||Ap(e,l)){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},M1=class{constructor(e,t){this.list=e;this.view=t;let i=z.chain(this.disposables.add(new Me(t.domNode,"keydown")).event,o=>o.filter(s=>!Gr(s.target)).map(s=>new bt(s)));z.chain(i,o=>o.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new Y;onTab(e){if(e.target!==this.view.domNode)return;let t=this.list.getFocus();if(t.length===0)return;let i=this.view.domElement(t[0]);if(!i)return;let n=i.querySelector("[tabIndex]");if(!n||!ki(n)||n.tabIndex===-1)return;let o=pe(n).getComputedStyle(n);o.visibility==="hidden"||o.display==="none"||(e.preventDefault(),e.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}};function V1(r){return ke?r.browserEvent.metaKey:r.browserEvent.ctrlKey}function W1(r){return r.browserEvent.shiftKey}function Fj(r){return yr(r)&&r.button===2}var OH={isSelectionSingleChangeEvent:V1,isSelectionRangeChangeEvent:W1},Xv=class{constructor(e){this.list=e;e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||OH),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(ei.addTarget(e.getHTMLElement()))),z.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new Y;_onPointer=new _;onPointer=this._onPointer.event;updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||OH))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){Wm(e.browserEvent.target)||mn()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(Gr(e.browserEvent.target)||Wm(e.browserEvent.target))return;let t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||Gr(e.browserEvent.target)||Wm(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),Fj(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(Gr(e.browserEvent.target)||Wm(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){let t=e.index,i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof i>"u"&&(i=this.list.getFocus()[0]??t,this.list.setAnchor(i));let n=Math.min(i,t),o=Math.max(i,t),s=_n(n,o+1),a=this.list.getSelection(),l=Vj(O1(a,[i]),i);if(l.length===0)return;let d=O1(s,Wj(a,l));this.list.setSelection(d,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){let n=this.list.getSelection(),o=n.filter(s=>s!==t);this.list.setFocus([t]),this.list.setAnchor(t),n.length===o.length?this.list.setSelection([...o,t],e.browserEvent):this.list.setSelection(o,e.browserEvent)}}dispose(){this.disposables.dispose()}},WE=class{constructor(e,t){this.styleElement=e;this.selectorSuffix=t}style(e){let t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);let n=Ir(e.listFocusAndSelectionOutline,Ir(e.listSelectionOutline,e.listFocusOutline??""));n&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),e.listFocusOutline&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);let o=Ir(e.listSelectionOutline,e.listInactiveFocusOutline??"");o&&i.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${o}; outline-offset: -1px; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&i.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}},HE={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:U.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:U.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:U.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},Bj={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function Vj(r,e){let t=r.indexOf(e);if(t===-1)return[];let i=[],n=t-1;for(;n>=0&&r[n]===e-(t-n);)i.push(r[n--]);for(i.reverse(),n=t;n<r.length&&r[n]===e+(n-t);)i.push(r[n++]);return i}function O1(r,e){let t=[],i=0,n=0;for(;i<r.length||n<e.length;)if(i>=r.length)t.push(e[n++]);else if(n>=e.length)t.push(r[i++]);else if(r[i]===e[n]){t.push(r[i]),i++,n++;continue}else r[i]<e[n]?t.push(r[i++]):t.push(e[n++]);return t}function Wj(r,e){let t=[],i=0,n=0;for(;i<r.length||n<e.length;)if(i>=r.length)t.push(e[n++]);else if(n>=e.length)t.push(r[i++]);else if(r[i]===e[n]){i++,n++;continue}else r[i]<e[n]?t.push(r[i++]):n++;return t}var PH=(r,e)=>r-e,P1=class{constructor(e,t){this._templateId=e;this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,n){let o=0;for(let s of this.renderers)s.renderElement(e,t,i[o++],n)}disposeElement(e,t,i,n){let o=0;for(let s of this.renderers)s.disposeElement?.(e,t,i[o],n),o+=1}disposeTemplate(e){let t=0;for(let i of this.renderers)i.disposeTemplate(e[t++])}},N1=class{constructor(e){this.accessibilityProvider=e}templateId="a18n";renderTemplate(e){return{container:e,disposables:new Y}}renderElement(e,t,i){let n=this.accessibilityProvider.getAriaLabel(e),o=n&&typeof n!="string"?n:Rc(n);i.disposables.add(yt(a=>{this.setAriaLabel(a.readObservable(o),i.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof s=="number"?i.container.setAttribute("aria-level",`${s}`):i.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,i,n){i.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}},F1=class{constructor(e,t){this.list=e;this.dnd=t}getDragElements(e){let t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,i,n,o){return this.dnd.onDragOver(e,t,i,n,o)}onDragLeave(e,t,i,n){this.dnd.onDragLeave?.(e,t,i,n)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,i,n,o){this.dnd.drop(e,t,i,n,o)}dispose(){this.dnd.dispose()}},Sn=class{constructor(e,t,i,n,o=Bj){this.user=e;this._options=o;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new R1(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=o.accessibilityProvider,this.accessibilityProvider&&(a.push(new N1(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(d=>new P1(d.templateId,[...a,d]));let l={...o,dnd:o.dnd&&new F1(this,o.dnd)};if(this.view=this.createListView(t,i,n,l),this.view.domNode.setAttribute("role",s),o.styleController)this.styleController=o.styleController(this.view.domId);else{let d=rr(this.view.domNode);this.styleController=new WE(d,this.view.domId)}if(this.spliceable=new OE([new Zv(this.focus,this.view,o.identityProvider),new Zv(this.selection,this.view,o.identityProvider),new Zv(this.anchor,this.view,o.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new M1(this,this.view)),(typeof o.keyboardSupport!="boolean"||o.keyboardSupport)&&(this.keyboardController=new VE(this,this.view,o),this.disposables.add(this.keyboardController)),o.keyboardNavigationLabelProvider){let d=o.keyboardNavigationDelegate||Nj;this.typeNavigationController=new A1(this,this.view,o.keyboardNavigationLabelProvider,o.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(o),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new Hm("focused");selection;anchor=new Hm("anchor");eventBufferer=new Mc;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new Y;get onDidChangeFocus(){return z.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return z.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1,t=z.chain(this.disposables.add(new Me(this.view.domNode,"keydown")).event,o=>o.map(s=>new bt(s)).filter(s=>e=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>Oe.stop(s,!0)).filter(()=>!1)),i=z.chain(this.disposables.add(new Me(this.view.domNode,"keyup")).event,o=>o.forEach(()=>e=!1).map(s=>new bt(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>Oe.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),n=z.chain(this.view.onContextMenu,o=>o.filter(s=>!e).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new Ei(pe(this.view.domNode),l),browserEvent:l})));return z.any(t,i,n)}get onKeyDown(){return this.disposables.add(new Me(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new Me(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new Me(this.view.domNode,"keypress")).event}get onDidFocus(){return z.signal(this.disposables.add(new Me(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return z.signal(this.disposables.add(new Me(this.view.domNode,"blur",!0)).event)}_onDidDispose=new _;onDidDispose=this._onDidDispose.event;createListView(e,t,i,n){return new BE(e,t,i,n)}createMouseController(e){return new Xv(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new _l(this.user,`Invalid start index: ${e}`);if(t<0)throw new _l(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}updateWidth(e){this.view.updateWidth(e)}updateElementHeight(e,t){this.view.updateElementHeight(e,t,null)}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(e){this.view.setScrollLeft(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(e,t){for(let i of e)if(i<0||i>=this.length)throw new _l(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new _l(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(let i of e)if(i<0||i>=this.length)throw new _l(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,n){if(this.length===0)return;let o=this.focus.get(),s=this.findNextIndex(o.length>0?o[0]+e:0,t,n);s>-1&&this.setFocus([s],i)}focusPrevious(e=1,t=!1,i,n){if(this.length===0)return;let o=this.focus.get(),s=this.findPreviousIndex(o.length>0?o[0]-e:0,t,n);s>-1&&this.setFocus([s],i)}async focusNextPage(e,t){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;let n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){let o=this.findPreviousIndex(i,!1,t);o>-1&&n!==o?this.setFocus([o],e):this.setFocus([i],e)}else{let o=this.view.getScrollTop(),s=o+this.view.renderHeight;i>n&&(s-=this.view.elementHeight(i)),this.view.setScrollTop(s),this.view.getScrollTop()!==o&&(this.setFocus([]),await hn(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,i=()=>0){let n,o=i(),s=this.view.getScrollTop()+o;s===0?n=this.view.indexAt(s):n=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){let l=this.findNextIndex(n,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([n],e)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-o),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await hn(0),await this.focusPreviousPage(e,t,i))}}focusLast(e,t){if(this.length===0)return;let i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;let n=this.findNextIndex(e,!1,i);n>-1&&this.setFocus([n],t)}findNextIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,i=0){if(e<0||e>=this.length)throw new _l(this.user,`Invalid index ${e}`);let n=this.view.getScrollTop(),o=this.view.elementTop(e),s=this.view.elementHeight(e);if(so(t)){let a=s-this.view.renderHeight+i;this.view.setScrollTop(a*uo(t,0,1)+o-i)}else{let a=o+s,l=n+this.view.renderHeight;o<n+i&&a>=l||(o<n+i||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(o-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new _l(this.user,`Invalid index ${e}`);let i=this.view.getScrollTop(),n=this.view.elementTop(e),o=this.view.elementHeight(e);if(n<i+t||n+o>i+this.view.renderHeight)return null;let s=o-this.view.renderHeight+t;return Math.abs((i+t-n)/s)}isDOMFocused(){return ho(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){let e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};R([me],Sn.prototype,"onDidChangeFocus",1),R([me],Sn.prototype,"onDidChangeSelection",1),R([me],Sn.prototype,"onContextMenu",1),R([me],Sn.prototype,"onKeyDown",1),R([me],Sn.prototype,"onKeyUp",1),R([me],Sn.prototype,"onKeyPress",1),R([me],Sn.prototype,"onDidFocus",1),R([me],Sn.prototype,"onDidBlur",1);var Hj=new RegExp(`(\\\\)?\\$\\((${Ae.iconNameExpression}(?:${Ae.iconModifierExpression})?)\\)`,"g");function Es(r){let e=new Array,t,i=0,n=0;for(;(t=Hj.exec(r))!==null;){n=t.index||0,i<n&&e.push(r.substring(i,n)),i=(t.index||0)+t[0].length;let[,o,s]=t;e.push(o?`$(${s})`:Km({id:s}))}return i<r.length&&e.push(r.substring(i)),e}function Km(r){let e=he("span");return e.classList.add(...Ae.asClassNameArray(r)),e}var H1=class{_prefix;_lastId;constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},U1=new H1("id#");var go={};(function(){function r(e,t){t(go)}r.amd=!0,function(e,t){typeof r=="function"&&r.amd?r(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){"use strict";function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function i(Qe){e.defaults=Qe}let n=/[&<>"']/,o=new RegExp(n.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=Qe=>l[Qe];function c(Qe,k){if(k){if(n.test(Qe))return Qe.replace(o,d)}else if(s.test(Qe))return Qe.replace(a,d);return Qe}let u=/(^|[^\[])\^/g;function p(Qe,k){let M=typeof Qe=="string"?Qe:Qe.source;k=k||"";let N={replace:(H,K)=>{let ee=typeof K=="string"?K:K.source;return ee=ee.replace(u,"$1"),M=M.replace(H,ee),N},getRegex:()=>new RegExp(M,k)};return N}function m(Qe){try{Qe=encodeURI(Qe).replace(/%25/g,"%")}catch{return null}return Qe}let f={exec:()=>null};function g(Qe,k){let M=Qe.replace(/\|/g,(K,ee,le)=>{let Le=!1,Ne=ee;for(;--Ne>=0&&le[Ne]==="\\";)Le=!Le;return Le?"|":" |"}),N=M.split(/ \|/),H=0;if(N[0].trim()||N.shift(),N.length>0&&!N[N.length-1].trim()&&N.pop(),k)if(N.length>k)N.splice(k);else for(;N.length<k;)N.push("");for(;H<N.length;H++)N[H]=N[H].trim().replace(/\\\|/g,"|");return N}function b(Qe,k,M){let N=Qe.length;if(N===0)return"";let H=0;for(;H<N;){let K=Qe.charAt(N-H-1);if(K===k&&!M)H++;else if(K!==k&&M)H++;else break}return Qe.slice(0,N-H)}function v(Qe,k){if(Qe.indexOf(k[1])===-1)return-1;let M=0;for(let N=0;N<Qe.length;N++)if(Qe[N]==="\\")N++;else if(Qe[N]===k[0])M++;else if(Qe[N]===k[1]&&(M--,M<0))return N;return-1}function I(Qe,k,M,N){let H=k.href,K=k.title?c(k.title):null,ee=Qe[1].replace(/\\([\[\]])/g,"$1");if(Qe[0].charAt(0)!=="!"){N.state.inLink=!0;let le={type:"link",raw:M,href:H,title:K,text:ee,tokens:N.inlineTokens(ee)};return N.state.inLink=!1,le}return{type:"image",raw:M,href:H,title:K,text:c(ee)}}function w(Qe,k){let M=Qe.match(/^(\s+)(?:```)/);if(M===null)return k;let N=M[1];return k.split(`
`).map(H=>{let K=H.match(/^\s+/);if(K===null)return H;let[ee]=K;return ee.length>=N.length?H.slice(N.length):H}).join(`
`)}class E{options;rules;lexer;constructor(k){this.options=k||e.defaults}space(k){let M=this.rules.block.newline.exec(k);if(M&&M[0].length>0)return{type:"space",raw:M[0]}}code(k){let M=this.rules.block.code.exec(k);if(M){let N=M[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:M[0],codeBlockStyle:"indented",text:this.options.pedantic?N:b(N,`
`)}}}fences(k){let M=this.rules.block.fences.exec(k);if(M){let N=M[0],H=w(N,M[3]||"");return{type:"code",raw:N,lang:M[2]?M[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):M[2],text:H}}}heading(k){let M=this.rules.block.heading.exec(k);if(M){let N=M[2].trim();if(/#$/.test(N)){let H=b(N,"#");(this.options.pedantic||!H||/ $/.test(H))&&(N=H.trim())}return{type:"heading",raw:M[0],depth:M[1].length,text:N,tokens:this.lexer.inline(N)}}}hr(k){let M=this.rules.block.hr.exec(k);if(M)return{type:"hr",raw:b(M[0],`
`)}}blockquote(k){let M=this.rules.block.blockquote.exec(k);if(M){let N=b(M[0],`
`).split(`
`),H="",K="",ee=[];for(;N.length>0;){let le=!1,Le=[],Ne;for(Ne=0;Ne<N.length;Ne++)if(/^ {0,3}>/.test(N[Ne]))Le.push(N[Ne]),le=!0;else if(!le)Le.push(N[Ne]);else break;N=N.slice(Ne);let gt=Le.join(`
`),Ht=gt.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");H=H?`${H}
${gt}`:gt,K=K?`${K}
${Ht}`:Ht;let _i=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(Ht,ee,!0),this.lexer.state.top=_i,N.length===0)break;let yn=ee[ee.length-1];if(yn?.type==="code")break;if(yn?.type==="blockquote"){let Ni=yn,Ke=Ni.raw+`
`+N.join(`
`),$=this.blockquote(Ke);ee[ee.length-1]=$,H=H.substring(0,H.length-Ni.raw.length)+$.raw,K=K.substring(0,K.length-Ni.text.length)+$.text;break}else if(yn?.type==="list"){let Ni=yn,Ke=Ni.raw+`
`+N.join(`
`),$=this.list(Ke);ee[ee.length-1]=$,H=H.substring(0,H.length-yn.raw.length)+$.raw,K=K.substring(0,K.length-Ni.raw.length)+$.raw,N=Ke.substring(ee[ee.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:H,tokens:ee,text:K}}}list(k){let M=this.rules.block.list.exec(k);if(M){let N=M[1].trim(),H=N.length>1,K={type:"list",raw:"",ordered:H,start:H?+N.slice(0,-1):"",loose:!1,items:[]};N=H?`\\d{1,9}\\${N.slice(-1)}`:`\\${N}`,this.options.pedantic&&(N=H?N:"[*+-]");let ee=new RegExp(`^( {0,3}${N})((?:[	 ][^\\n]*)?(?:\\n|$))`),le=!1;for(;k;){let Le=!1,Ne="",gt="";if(!(M=ee.exec(k))||this.rules.block.hr.test(k))break;Ne=M[0],k=k.substring(Ne.length);let Ht=M[2].split(`
`,1)[0].replace(/^\t+/,Te=>" ".repeat(3*Te.length)),_i=k.split(`
`,1)[0],yn=!Ht.trim(),Ni=0;if(this.options.pedantic?(Ni=2,gt=Ht.trimStart()):yn?Ni=M[1].length+1:(Ni=M[2].search(/[^ ]/),Ni=Ni>4?1:Ni,gt=Ht.slice(Ni),Ni+=M[1].length),yn&&/^ *$/.test(_i)&&(Ne+=_i+`
`,k=k.substring(_i.length+1),Le=!0),!Le){let Te=new RegExp(`^ {0,${Math.min(3,Ni-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Ve=new RegExp(`^ {0,${Math.min(3,Ni-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),hi=new RegExp(`^ {0,${Math.min(3,Ni-1)}}(?:\`\`\`|~~~)`),Tn=new RegExp(`^ {0,${Math.min(3,Ni-1)}}#`);for(;k;){let tr=k.split(`
`,1)[0];if(_i=tr,this.options.pedantic&&(_i=_i.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),hi.test(_i)||Tn.test(_i)||Te.test(_i)||Ve.test(k))break;if(_i.search(/[^ ]/)>=Ni||!_i.trim())gt+=`
`+_i.slice(Ni);else{if(yn||Ht.search(/[^ ]/)>=4||hi.test(Ht)||Tn.test(Ht)||Ve.test(Ht))break;gt+=`
`+_i}!yn&&!_i.trim()&&(yn=!0),Ne+=tr+`
`,k=k.substring(tr.length+1),Ht=_i.slice(Ni)}}K.loose||(le?K.loose=!0:/\n *\n *$/.test(Ne)&&(le=!0));let Ke=null,$;this.options.gfm&&(Ke=/^\[[ xX]\] /.exec(gt),Ke&&($=Ke[0]!=="[ ] ",gt=gt.replace(/^\[[ xX]\] +/,""))),K.items.push({type:"list_item",raw:Ne,task:!!Ke,checked:$,loose:!1,text:gt,tokens:[]}),K.raw+=Ne}K.items[K.items.length-1].raw=K.items[K.items.length-1].raw.trimEnd(),K.items[K.items.length-1].text=K.items[K.items.length-1].text.trimEnd(),K.raw=K.raw.trimEnd();for(let Le=0;Le<K.items.length;Le++)if(this.lexer.state.top=!1,K.items[Le].tokens=this.lexer.blockTokens(K.items[Le].text,[]),!K.loose){let Ne=K.items[Le].tokens.filter(Ht=>Ht.type==="space"),gt=Ne.length>0&&Ne.some(Ht=>/\n.*\n/.test(Ht.raw));K.loose=gt}if(K.loose)for(let Le=0;Le<K.items.length;Le++)K.items[Le].loose=!0;return K}}html(k){let M=this.rules.block.html.exec(k);if(M)return{type:"html",block:!0,raw:M[0],pre:M[1]==="pre"||M[1]==="script"||M[1]==="style",text:M[0]}}def(k){let M=this.rules.block.def.exec(k);if(M){let N=M[1].toLowerCase().replace(/\s+/g," "),H=M[2]?M[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",K=M[3]?M[3].substring(1,M[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):M[3];return{type:"def",tag:N,raw:M[0],href:H,title:K}}}table(k){let M=this.rules.block.table.exec(k);if(!M||!/[:|]/.test(M[2]))return;let N=g(M[1]),H=M[2].replace(/^\||\| *$/g,"").split("|"),K=M[3]&&M[3].trim()?M[3].replace(/\n[ \t]*$/,"").split(`
`):[],ee={type:"table",raw:M[0],header:[],align:[],rows:[]};if(N.length===H.length){for(let le of H)/^ *-+: *$/.test(le)?ee.align.push("right"):/^ *:-+: *$/.test(le)?ee.align.push("center"):/^ *:-+ *$/.test(le)?ee.align.push("left"):ee.align.push(null);for(let le=0;le<N.length;le++)ee.header.push({text:N[le],tokens:this.lexer.inline(N[le]),header:!0,align:ee.align[le]});for(let le of K)ee.rows.push(g(le,ee.header.length).map((Le,Ne)=>({text:Le,tokens:this.lexer.inline(Le),header:!1,align:ee.align[Ne]})));return ee}}lheading(k){let M=this.rules.block.lheading.exec(k);if(M)return{type:"heading",raw:M[0],depth:M[2].charAt(0)==="="?1:2,text:M[1],tokens:this.lexer.inline(M[1])}}paragraph(k){let M=this.rules.block.paragraph.exec(k);if(M){let N=M[1].charAt(M[1].length-1)===`
`?M[1].slice(0,-1):M[1];return{type:"paragraph",raw:M[0],text:N,tokens:this.lexer.inline(N)}}}text(k){let M=this.rules.block.text.exec(k);if(M)return{type:"text",raw:M[0],text:M[0],tokens:this.lexer.inline(M[0])}}escape(k){let M=this.rules.inline.escape.exec(k);if(M)return{type:"escape",raw:M[0],text:c(M[1])}}tag(k){let M=this.rules.inline.tag.exec(k);if(M)return!this.lexer.state.inLink&&/^<a /i.test(M[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(M[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(M[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(M[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:M[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:M[0]}}link(k){let M=this.rules.inline.link.exec(k);if(M){let N=M[2].trim();if(!this.options.pedantic&&/^</.test(N)){if(!/>$/.test(N))return;let ee=b(N.slice(0,-1),"\\");if((N.length-ee.length)%2===0)return}else{let ee=v(M[2],"()");if(ee>-1){let Le=(M[0].indexOf("!")===0?5:4)+M[1].length+ee;M[2]=M[2].substring(0,ee),M[0]=M[0].substring(0,Le).trim(),M[3]=""}}let H=M[2],K="";if(this.options.pedantic){let ee=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(H);ee&&(H=ee[1],K=ee[3])}else K=M[3]?M[3].slice(1,-1):"";return H=H.trim(),/^</.test(H)&&(this.options.pedantic&&!/>$/.test(N)?H=H.slice(1):H=H.slice(1,-1)),I(M,{href:H&&H.replace(this.rules.inline.anyPunctuation,"$1"),title:K&&K.replace(this.rules.inline.anyPunctuation,"$1")},M[0],this.lexer)}}reflink(k,M){let N;if((N=this.rules.inline.reflink.exec(k))||(N=this.rules.inline.nolink.exec(k))){let H=(N[2]||N[1]).replace(/\s+/g," "),K=M[H.toLowerCase()];if(!K){let ee=N[0].charAt(0);return{type:"text",raw:ee,text:ee}}return I(N,K,N[0],this.lexer)}}emStrong(k,M,N=""){let H=this.rules.inline.emStrongLDelim.exec(k);if(!H||H[3]&&N.match(/[\p{L}\p{N}]/u))return;if(!(H[1]||H[2]||"")||!N||this.rules.inline.punctuation.exec(N)){let ee=[...H[0]].length-1,le,Le,Ne=ee,gt=0,Ht=H[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(Ht.lastIndex=0,M=M.slice(-1*k.length+ee);(H=Ht.exec(M))!=null;){if(le=H[1]||H[2]||H[3]||H[4]||H[5]||H[6],!le)continue;if(Le=[...le].length,H[3]||H[4]){Ne+=Le;continue}else if((H[5]||H[6])&&ee%3&&!((ee+Le)%3)){gt+=Le;continue}if(Ne-=Le,Ne>0)continue;Le=Math.min(Le,Le+Ne+gt);let _i=[...H[0]][0].length,yn=k.slice(0,ee+H.index+_i+Le);if(Math.min(ee,Le)%2){let Ke=yn.slice(1,-1);return{type:"em",raw:yn,text:Ke,tokens:this.lexer.inlineTokens(Ke)}}let Ni=yn.slice(2,-2);return{type:"strong",raw:yn,text:Ni,tokens:this.lexer.inlineTokens(Ni)}}}}codespan(k){let M=this.rules.inline.code.exec(k);if(M){let N=M[2].replace(/\n/g," "),H=/[^ ]/.test(N),K=/^ /.test(N)&&/ $/.test(N);return H&&K&&(N=N.substring(1,N.length-1)),N=c(N,!0),{type:"codespan",raw:M[0],text:N}}}br(k){let M=this.rules.inline.br.exec(k);if(M)return{type:"br",raw:M[0]}}del(k){let M=this.rules.inline.del.exec(k);if(M)return{type:"del",raw:M[0],text:M[2],tokens:this.lexer.inlineTokens(M[2])}}autolink(k){let M=this.rules.inline.autolink.exec(k);if(M){let N,H;return M[2]==="@"?(N=c(M[1]),H="mailto:"+N):(N=c(M[1]),H=N),{type:"link",raw:M[0],text:N,href:H,tokens:[{type:"text",raw:N,text:N}]}}}url(k){let M;if(M=this.rules.inline.url.exec(k)){let N,H;if(M[2]==="@")N=c(M[0]),H="mailto:"+N;else{let K;do K=M[0],M[0]=this.rules.inline._backpedal.exec(M[0])?.[0]??"";while(K!==M[0]);N=c(M[0]),M[1]==="www."?H="http://"+M[0]:H=M[0]}return{type:"link",raw:M[0],text:N,href:H,tokens:[{type:"text",raw:N,text:N}]}}}inlineText(k){let M=this.rules.inline.text.exec(k);if(M){let N;return this.lexer.state.inRawBlock?N=M[0]:N=c(M[0]),{type:"text",raw:M[0],text:N}}}}let S=/^(?: *(?:\n|$))+/,T=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,D=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,L=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,A=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,W=/(?:[*+-]|\d{1,9}[.)])/,j=p(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,W).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),G=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,oe=/^[^\n]+/,_e=/(?!\s*\])(?:\\.|[^\[\]\\])+/,re=p(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",_e).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ne=p(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,W).getRegex(),ge="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",de=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,se=p("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",de).replace("tag",ge).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),De=p(G).replace("hr",L).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ge).getRegex(),rt={blockquote:p(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",De).getRegex(),code:T,def:re,fences:D,heading:A,hr:L,html:se,lheading:j,list:ne,newline:S,paragraph:De,table:f,text:oe},Xe=p("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",L).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ge).getRegex(),Pe={...rt,table:Xe,paragraph:p(G).replace("hr",L).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Xe).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ge).getRegex()},Gi={...rt,html:p(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",de).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:f,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:p(G).replace("hr",L).replace("heading",` *#{1,6} *[^
]`).replace("lheading",j).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Mi=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,bn=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Kn=/^( {2,}|\\)\n(?!\s*$)/,ma=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ii="\\p{P}\\p{S}",wo=p(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,ii).getRegex(),rp=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,yc=p(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,ii).getRegex(),xo=p("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,ii).getRegex(),Ic=p("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,ii).getRegex(),Cc=p(/\\([punct])/,"gu").replace(/punct/g,ii).getRegex(),nm=p(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),om=p(de).replace("(?:-->|$)","-->").getRegex(),Ye=p("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",om).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),vd=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Sc=p(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",vd).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ol=p(/^!?\[(label)\]\[(ref)\]/).replace("label",vd).replace("ref",_e).getRegex(),Us=p(/^!?\[(ref)\](?:\[\])?/).replace("ref",_e).getRegex(),$b=p("reflink|nolink(?!\\()","g").replace("reflink",ol).replace("nolink",Us).getRegex(),sp={_backpedal:f,anyPunctuation:Cc,autolink:nm,blockSkip:rp,br:Kn,code:bn,del:f,emStrongLDelim:yc,emStrongRDelimAst:xo,emStrongRDelimUnd:Ic,escape:Mi,link:Sc,nolink:Us,punctuation:wo,reflink:ol,reflinkSearch:$b,tag:Ye,text:ma,url:f},Yb={...sp,link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",vd).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",vd).getRegex()},rl={...sp,escape:p(Mi).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Zb={...rl,br:p(Kn).replace("{2,}","*").getRegex(),text:p(rl.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},sl={normal:rt,gfm:Pe,pedantic:Gi},cs={normal:sp,gfm:rl,breaks:Zb,pedantic:Yb};class vn{tokens;options;state;tokenizer;inlineQueue;constructor(k){this.tokens=[],this.tokens.links=Object.create(null),this.options=k||e.defaults,this.options.tokenizer=this.options.tokenizer||new E,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let M={block:sl.normal,inline:cs.normal};this.options.pedantic?(M.block=sl.pedantic,M.inline=cs.pedantic):this.options.gfm&&(M.block=sl.gfm,this.options.breaks?M.inline=cs.breaks:M.inline=cs.gfm),this.tokenizer.rules=M}static get rules(){return{block:sl,inline:cs}}static lex(k,M){return new vn(M).lex(k)}static lexInline(k,M){return new vn(M).inlineTokens(k)}lex(k){k=k.replace(/\r\n|\r/g,`
`),this.blockTokens(k,this.tokens);for(let M=0;M<this.inlineQueue.length;M++){let N=this.inlineQueue[M];this.inlineTokens(N.src,N.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(k,M=[],N=!1){this.options.pedantic?k=k.replace(/\t/g,"    ").replace(/^ +$/gm,""):k=k.replace(/^( *)(\t+)/gm,(le,Le,Ne)=>Le+"    ".repeat(Ne.length));let H,K,ee;for(;k;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(le=>(H=le.call({lexer:this},k,M))?(k=k.substring(H.raw.length),M.push(H),!0):!1))){if(H=this.tokenizer.space(k)){k=k.substring(H.raw.length),H.raw.length===1&&M.length>0?M[M.length-1].raw+=`
`:M.push(H);continue}if(H=this.tokenizer.code(k)){k=k.substring(H.raw.length),K=M[M.length-1],K&&(K.type==="paragraph"||K.type==="text")?(K.raw+=`
`+H.raw,K.text+=`
`+H.text,this.inlineQueue[this.inlineQueue.length-1].src=K.text):M.push(H);continue}if(H=this.tokenizer.fences(k)){k=k.substring(H.raw.length),M.push(H);continue}if(H=this.tokenizer.heading(k)){k=k.substring(H.raw.length),M.push(H);continue}if(H=this.tokenizer.hr(k)){k=k.substring(H.raw.length),M.push(H);continue}if(H=this.tokenizer.blockquote(k)){k=k.substring(H.raw.length),M.push(H);continue}if(H=this.tokenizer.list(k)){k=k.substring(H.raw.length),M.push(H);continue}if(H=this.tokenizer.html(k)){k=k.substring(H.raw.length),M.push(H);continue}if(H=this.tokenizer.def(k)){k=k.substring(H.raw.length),K=M[M.length-1],K&&(K.type==="paragraph"||K.type==="text")?(K.raw+=`
`+H.raw,K.text+=`
`+H.raw,this.inlineQueue[this.inlineQueue.length-1].src=K.text):this.tokens.links[H.tag]||(this.tokens.links[H.tag]={href:H.href,title:H.title});continue}if(H=this.tokenizer.table(k)){k=k.substring(H.raw.length),M.push(H);continue}if(H=this.tokenizer.lheading(k)){k=k.substring(H.raw.length),M.push(H);continue}if(ee=k,this.options.extensions&&this.options.extensions.startBlock){let le=1/0,Le=k.slice(1),Ne;this.options.extensions.startBlock.forEach(gt=>{Ne=gt.call({lexer:this},Le),typeof Ne=="number"&&Ne>=0&&(le=Math.min(le,Ne))}),le<1/0&&le>=0&&(ee=k.substring(0,le+1))}if(this.state.top&&(H=this.tokenizer.paragraph(ee))){K=M[M.length-1],N&&K?.type==="paragraph"?(K.raw+=`
`+H.raw,K.text+=`
`+H.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=K.text):M.push(H),N=ee.length!==k.length,k=k.substring(H.raw.length);continue}if(H=this.tokenizer.text(k)){k=k.substring(H.raw.length),K=M[M.length-1],K&&K.type==="text"?(K.raw+=`
`+H.raw,K.text+=`
`+H.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=K.text):M.push(H);continue}if(k){let le="Infinite loop on byte: "+k.charCodeAt(0);if(this.options.silent){console.error(le);break}else throw new Error(le)}}return this.state.top=!0,M}inline(k,M=[]){return this.inlineQueue.push({src:k,tokens:M}),M}inlineTokens(k,M=[]){let N,H,K,ee=k,le,Le,Ne;if(this.tokens.links){let gt=Object.keys(this.tokens.links);if(gt.length>0)for(;(le=this.tokenizer.rules.inline.reflinkSearch.exec(ee))!=null;)gt.includes(le[0].slice(le[0].lastIndexOf("[")+1,-1))&&(ee=ee.slice(0,le.index)+"["+"a".repeat(le[0].length-2)+"]"+ee.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(le=this.tokenizer.rules.inline.blockSkip.exec(ee))!=null;)ee=ee.slice(0,le.index)+"["+"a".repeat(le[0].length-2)+"]"+ee.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(le=this.tokenizer.rules.inline.anyPunctuation.exec(ee))!=null;)ee=ee.slice(0,le.index)+"++"+ee.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;k;)if(Le||(Ne=""),Le=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(gt=>(N=gt.call({lexer:this},k,M))?(k=k.substring(N.raw.length),M.push(N),!0):!1))){if(N=this.tokenizer.escape(k)){k=k.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.tag(k)){k=k.substring(N.raw.length),H=M[M.length-1],H&&N.type==="text"&&H.type==="text"?(H.raw+=N.raw,H.text+=N.text):M.push(N);continue}if(N=this.tokenizer.link(k)){k=k.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.reflink(k,this.tokens.links)){k=k.substring(N.raw.length),H=M[M.length-1],H&&N.type==="text"&&H.type==="text"?(H.raw+=N.raw,H.text+=N.text):M.push(N);continue}if(N=this.tokenizer.emStrong(k,ee,Ne)){k=k.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.codespan(k)){k=k.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.br(k)){k=k.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.del(k)){k=k.substring(N.raw.length),M.push(N);continue}if(N=this.tokenizer.autolink(k)){k=k.substring(N.raw.length),M.push(N);continue}if(!this.state.inLink&&(N=this.tokenizer.url(k))){k=k.substring(N.raw.length),M.push(N);continue}if(K=k,this.options.extensions&&this.options.extensions.startInline){let gt=1/0,Ht=k.slice(1),_i;this.options.extensions.startInline.forEach(yn=>{_i=yn.call({lexer:this},Ht),typeof _i=="number"&&_i>=0&&(gt=Math.min(gt,_i))}),gt<1/0&&gt>=0&&(K=k.substring(0,gt+1))}if(N=this.tokenizer.inlineText(K)){k=k.substring(N.raw.length),N.raw.slice(-1)!=="_"&&(Ne=N.raw.slice(-1)),Le=!0,H=M[M.length-1],H&&H.type==="text"?(H.raw+=N.raw,H.text+=N.text):M.push(N);continue}if(k){let gt="Infinite loop on byte: "+k.charCodeAt(0);if(this.options.silent){console.error(gt);break}else throw new Error(gt)}}return M}}class us{options;parser;constructor(k){this.options=k||e.defaults}space(k){return""}code({text:k,lang:M,escaped:N}){let H=(M||"").match(/^\S*/)?.[0],K=k.replace(/\n$/,"")+`
`;return H?'<pre><code class="language-'+c(H)+'">'+(N?K:c(K,!0))+`</code></pre>
`:"<pre><code>"+(N?K:c(K,!0))+`</code></pre>
`}blockquote({tokens:k}){return`<blockquote>
${this.parser.parse(k)}</blockquote>
`}html({text:k}){return k}heading({tokens:k,depth:M}){return`<h${M}>${this.parser.parseInline(k)}</h${M}>
`}hr(k){return`<hr>
`}list(k){let M=k.ordered,N=k.start,H="";for(let le=0;le<k.items.length;le++){let Le=k.items[le];H+=this.listitem(Le)}let K=M?"ol":"ul",ee=M&&N!==1?' start="'+N+'"':"";return"<"+K+ee+`>
`+H+"</"+K+`>
`}listitem(k){let M="";if(k.task){let N=this.checkbox({checked:!!k.checked});k.loose?k.tokens.length>0&&k.tokens[0].type==="paragraph"?(k.tokens[0].text=N+" "+k.tokens[0].text,k.tokens[0].tokens&&k.tokens[0].tokens.length>0&&k.tokens[0].tokens[0].type==="text"&&(k.tokens[0].tokens[0].text=N+" "+k.tokens[0].tokens[0].text)):k.tokens.unshift({type:"text",raw:N+" ",text:N+" "}):M+=N+" "}return M+=this.parser.parse(k.tokens,!!k.loose),`<li>${M}</li>
`}checkbox({checked:k}){return"<input "+(k?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:k}){return`<p>${this.parser.parseInline(k)}</p>
`}table(k){let M="",N="";for(let K=0;K<k.header.length;K++)N+=this.tablecell(k.header[K]);M+=this.tablerow({text:N});let H="";for(let K=0;K<k.rows.length;K++){let ee=k.rows[K];N="";for(let le=0;le<ee.length;le++)N+=this.tablecell(ee[le]);H+=this.tablerow({text:N})}return H&&(H=`<tbody>${H}</tbody>`),`<table>
<thead>
`+M+`</thead>
`+H+`</table>
`}tablerow({text:k}){return`<tr>
${k}</tr>
`}tablecell(k){let M=this.parser.parseInline(k.tokens),N=k.header?"th":"td";return(k.align?`<${N} align="${k.align}">`:`<${N}>`)+M+`</${N}>
`}strong({tokens:k}){return`<strong>${this.parser.parseInline(k)}</strong>`}em({tokens:k}){return`<em>${this.parser.parseInline(k)}</em>`}codespan({text:k}){return`<code>${k}</code>`}br(k){return"<br>"}del({tokens:k}){return`<del>${this.parser.parseInline(k)}</del>`}link({href:k,title:M,tokens:N}){let H=this.parser.parseInline(N),K=m(k);if(K===null)return H;k=K;let ee='<a href="'+k+'"';return M&&(ee+=' title="'+M+'"'),ee+=">"+H+"</a>",ee}image({href:k,title:M,text:N}){let H=m(k);if(H===null)return N;k=H;let K=`<img src="${k}" alt="${N}"`;return M&&(K+=` title="${M}"`),K+=">",K}text(k){return"tokens"in k&&k.tokens?this.parser.parseInline(k.tokens):k.text}}class yd{strong({text:k}){return k}em({text:k}){return k}codespan({text:k}){return k}del({text:k}){return k}html({text:k}){return k}text({text:k}){return k}link({text:k}){return""+k}image({text:k}){return""+k}br(){return""}}class er{options;renderer;textRenderer;constructor(k){this.options=k||e.defaults,this.options.renderer=this.options.renderer||new us,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new yd}static parse(k,M){return new er(M).parse(k)}static parseInline(k,M){return new er(M).parseInline(k)}parse(k,M=!0){let N="";for(let H=0;H<k.length;H++){let K=k[H];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[K.type]){let le=K,Le=this.options.extensions.renderers[le.type].call({parser:this},le);if(Le!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(le.type)){N+=Le||"";continue}}let ee=K;switch(ee.type){case"space":{N+=this.renderer.space(ee);continue}case"hr":{N+=this.renderer.hr(ee);continue}case"heading":{N+=this.renderer.heading(ee);continue}case"code":{N+=this.renderer.code(ee);continue}case"table":{N+=this.renderer.table(ee);continue}case"blockquote":{N+=this.renderer.blockquote(ee);continue}case"list":{N+=this.renderer.list(ee);continue}case"html":{N+=this.renderer.html(ee);continue}case"paragraph":{N+=this.renderer.paragraph(ee);continue}case"text":{let le=ee,Le=this.renderer.text(le);for(;H+1<k.length&&k[H+1].type==="text";)le=k[++H],Le+=`
`+this.renderer.text(le);M?N+=this.renderer.paragraph({type:"paragraph",raw:Le,text:Le,tokens:[{type:"text",raw:Le,text:Le}]}):N+=Le;continue}default:{let le='Token with "'+ee.type+'" type was not found.';if(this.options.silent)return console.error(le),"";throw new Error(le)}}}return N}parseInline(k,M){M=M||this.renderer;let N="";for(let H=0;H<k.length;H++){let K=k[H];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[K.type]){let le=this.options.extensions.renderers[K.type].call({parser:this},K);if(le!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(K.type)){N+=le||"";continue}}let ee=K;switch(ee.type){case"escape":{N+=M.text(ee);break}case"html":{N+=M.html(ee);break}case"link":{N+=M.link(ee);break}case"image":{N+=M.image(ee);break}case"strong":{N+=M.strong(ee);break}case"em":{N+=M.em(ee);break}case"codespan":{N+=M.codespan(ee);break}case"br":{N+=M.br(ee);break}case"del":{N+=M.del(ee);break}case"text":{N+=M.text(ee);break}default:{let le='Token with "'+ee.type+'" type was not found.';if(this.options.silent)return console.error(le),"";throw new Error(le)}}}return N}}class Ec{options;constructor(k){this.options=k||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(k){return k}postprocess(k){return k}processAllTokens(k){return k}}class ga{defaults=t();options=this.setOptions;parse=this.parseMarkdown(vn.lex,er.parse);parseInline=this.parseMarkdown(vn.lexInline,er.parseInline);Parser=er;Renderer=us;TextRenderer=yd;Lexer=vn;Tokenizer=E;Hooks=Ec;constructor(...k){this.use(...k)}walkTokens(k,M){let N=[];for(let H of k)switch(N=N.concat(M.call(this,H)),H.type){case"table":{let K=H;for(let ee of K.header)N=N.concat(this.walkTokens(ee.tokens,M));for(let ee of K.rows)for(let le of ee)N=N.concat(this.walkTokens(le.tokens,M));break}case"list":{let K=H;N=N.concat(this.walkTokens(K.items,M));break}default:{let K=H;this.defaults.extensions?.childTokens?.[K.type]?this.defaults.extensions.childTokens[K.type].forEach(ee=>{let le=K[ee].flat(1/0);N=N.concat(this.walkTokens(le,M))}):K.tokens&&(N=N.concat(this.walkTokens(K.tokens,M)))}}return N}use(...k){let M=this.defaults.extensions||{renderers:{},childTokens:{}};return k.forEach(N=>{let H={...N};if(H.async=this.defaults.async||H.async||!1,N.extensions&&(N.extensions.forEach(K=>{if(!K.name)throw new Error("extension name required");if("renderer"in K){let ee=M.renderers[K.name];ee?M.renderers[K.name]=function(...le){let Le=K.renderer.apply(this,le);return Le===!1&&(Le=ee.apply(this,le)),Le}:M.renderers[K.name]=K.renderer}if("tokenizer"in K){if(!K.level||K.level!=="block"&&K.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let ee=M[K.level];ee?ee.unshift(K.tokenizer):M[K.level]=[K.tokenizer],K.start&&(K.level==="block"?M.startBlock?M.startBlock.push(K.start):M.startBlock=[K.start]:K.level==="inline"&&(M.startInline?M.startInline.push(K.start):M.startInline=[K.start]))}"childTokens"in K&&K.childTokens&&(M.childTokens[K.name]=K.childTokens)}),H.extensions=M),N.renderer){let K=this.defaults.renderer||new us(this.defaults);for(let ee in N.renderer){if(!(ee in K))throw new Error(`renderer '${ee}' does not exist`);if(["options","parser"].includes(ee))continue;let le=ee,Le=N.renderer[le],Ne=K[le];K[le]=(...gt)=>{let Ht=Le.apply(K,gt);return Ht===!1&&(Ht=Ne.apply(K,gt)),Ht||""}}H.renderer=K}if(N.tokenizer){let K=this.defaults.tokenizer||new E(this.defaults);for(let ee in N.tokenizer){if(!(ee in K))throw new Error(`tokenizer '${ee}' does not exist`);if(["options","rules","lexer"].includes(ee))continue;let le=ee,Le=N.tokenizer[le],Ne=K[le];K[le]=(...gt)=>{let Ht=Le.apply(K,gt);return Ht===!1&&(Ht=Ne.apply(K,gt)),Ht}}H.tokenizer=K}if(N.hooks){let K=this.defaults.hooks||new Ec;for(let ee in N.hooks){if(!(ee in K))throw new Error(`hook '${ee}' does not exist`);if(ee==="options")continue;let le=ee,Le=N.hooks[le],Ne=K[le];Ec.passThroughHooks.has(ee)?K[le]=gt=>{if(this.defaults.async)return Promise.resolve(Le.call(K,gt)).then(_i=>Ne.call(K,_i));let Ht=Le.call(K,gt);return Ne.call(K,Ht)}:K[le]=(...gt)=>{let Ht=Le.apply(K,gt);return Ht===!1&&(Ht=Ne.apply(K,gt)),Ht}}H.hooks=K}if(N.walkTokens){let K=this.defaults.walkTokens,ee=N.walkTokens;H.walkTokens=function(le){let Le=[];return Le.push(ee.call(this,le)),K&&(Le=Le.concat(K.call(this,le))),Le}}this.defaults={...this.defaults,...H}}),this}setOptions(k){return this.defaults={...this.defaults,...k},this}lexer(k,M){return vn.lex(k,M??this.defaults)}parser(k,M){return er.parse(k,M??this.defaults)}parseMarkdown(k,M){return(H,K)=>{let ee={...K},le={...this.defaults,...ee},Le=this.onError(!!le.silent,!!le.async);if(this.defaults.async===!0&&ee.async===!1)return Le(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof H>"u"||H===null)return Le(new Error("marked(): input parameter is undefined or null"));if(typeof H!="string")return Le(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(H)+", string expected"));if(le.hooks&&(le.hooks.options=le),le.async)return Promise.resolve(le.hooks?le.hooks.preprocess(H):H).then(Ne=>k(Ne,le)).then(Ne=>le.hooks?le.hooks.processAllTokens(Ne):Ne).then(Ne=>le.walkTokens?Promise.all(this.walkTokens(Ne,le.walkTokens)).then(()=>Ne):Ne).then(Ne=>M(Ne,le)).then(Ne=>le.hooks?le.hooks.postprocess(Ne):Ne).catch(Le);try{le.hooks&&(H=le.hooks.preprocess(H));let Ne=k(H,le);le.hooks&&(Ne=le.hooks.processAllTokens(Ne)),le.walkTokens&&this.walkTokens(Ne,le.walkTokens);let gt=M(Ne,le);return le.hooks&&(gt=le.hooks.postprocess(gt)),gt}catch(Ne){return Le(Ne)}}}onError(k,M){return N=>{if(N.message+=`
Please report this to https://github.com/markedjs/marked.`,k){let H="<p>An error occurred:</p><pre>"+c(N.message+"",!0)+"</pre>";return M?Promise.resolve(H):H}if(M)return Promise.reject(N);throw N}}}let al=new ga;function xe(Qe,k){return al.parse(Qe,k)}xe.options=xe.setOptions=function(Qe){return al.setOptions(Qe),xe.defaults=al.defaults,i(xe.defaults),xe},xe.getDefaults=t,xe.defaults=e.defaults,xe.use=function(...Qe){return al.use(...Qe),xe.defaults=al.defaults,i(xe.defaults),xe},xe.walkTokens=function(Qe,k){return al.walkTokens(Qe,k)},xe.parseInline=al.parseInline,xe.Parser=er,xe.parser=er.parse,xe.Renderer=us,xe.TextRenderer=yd,xe.Lexer=vn,xe.lexer=vn.lex,xe.Tokenizer=E,xe.Hooks=Ec,xe.parse=xe;let be=xe.options,V=xe.setOptions,ce=xe.use,Ee=xe.walkTokens,ut=xe.parseInline,$t=xe,Gn=er.parse,To=vn.lex;e.Hooks=Ec,e.Lexer=vn,e.Marked=ga,e.Parser=er,e.Renderer=us,e.TextRenderer=yd,e.Tokenizer=E,e.getDefaults=t,e.lexer=To,e.marked=xe,e.options=be,e.parse=$t,e.parseInline=ut,e.parser=Gn,e.setOptions=V,e.use=ce,e.walkTokens=Ee})})();var zpe=go.Hooks||exports.Hooks,Kpe=go.Lexer||exports.Lexer,Gpe=go.Marked||exports.Marked,jpe=go.Parser||exports.Parser,z1=go.Renderer||exports.Renderer,qpe=go.TextRenderer||exports.TextRenderer,$pe=go.Tokenizer||exports.Tokenizer,BH=go.defaults||exports.defaults,Ype=go.getDefaults||exports.getDefaults,Jv=go.lexer||exports.lexer,Zpe=go.marked||exports.marked,Xpe=go.options||exports.options,K1=go.parse||exports.parse,Qpe=go.parseInline||exports.parseInline,VH=go.parser||exports.parser,Jpe=go.setOptions||exports.setOptions,ehe=go.use||exports.use,the=go.walkTokens||exports.walkTokens;function Gm(r,e){return new G1(r,e)}var G1=class{constructor(e,t){this.reducer=e;this.options=t}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?Ge(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let i;switch(e){case"data":i=this.listeners.data;break;case"end":i=this.listeners.end;break;case"error":i=this.listeners.error;break}if(i){let n=i.indexOf(t);n>=0&&i.splice(n,1)}}flowData(){if(this.buffer.data.length>0){let e=this.reducer(this.buffer.data);this.emitData(e),this.buffer.data.length=0;let t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(i=>i())}}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function ey(r,e,t){r.on("error",i=>{t?.isCancellationRequested||e.onError(i)}),r.on("end",()=>{t?.isCancellationRequested||e.onEnd()}),r.on("data",i=>{t?.isCancellationRequested||e.onData(i)})}function WH(r,e){let t=Gm(e);return t.end(r),t}function HH(r){let e=!1;return{read:()=>e?null:(e=!0,r)}}var UE=typeof Buffer<"u",Kj=new Dn(()=>new Uint8Array(256)),j1,q1,Qt=class r{static alloc(e){return UE?new r(Buffer.allocUnsafe(e)):new r(new Uint8Array(e))}static wrap(e){return UE&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new r(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&UE?new r(Buffer.from(e)):(j1||(j1=new TextEncoder),new r(j1.encode(e)))}static fromByteArray(e){let t=r.alloc(e.length);for(let i=0,n=e.length;i<n;i++)t.buffer[i]=e[i];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let o=0,s=e.length;o<s;o++)t+=e[o].byteLength}let i=r.alloc(t),n=0;for(let o=0,s=e.length;o<s;o++){let a=e[o];i.set(a,n),n+=a.byteLength}return i}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=r.alloc(this.byteLength);return e.set(this),e}toString(){return UE?this.buffer.toString():(q1||(q1=new TextDecoder),q1.decode(this.buffer))}slice(e,t){return new r(this.buffer.subarray(e,t))}set(e,t){if(e instanceof r)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return $n(this.buffer,e)}writeUInt32BE(e,t){Yn(this.buffer,e,t)}readUInt32LE(e){return jj(this.buffer,e)}writeUInt32LE(e,t){qj(this.buffer,e,t)}readUInt8(e){return zE(this.buffer,e)}writeUInt8(e,t){KE(this.buffer,e,t)}indexOf(e,t=0){return Gj(this.buffer,e instanceof r?e.buffer:e,t)}};function Gj(r,e,t=0){let i=e.byteLength,n=r.byteLength;if(i===0)return 0;if(i===1)return r.indexOf(e[0]);if(i>n-t)return-1;let o=Kj.value;o.fill(e.length);for(let d=0;d<e.length;d++)o[e[d]]=e.length-d-1;let s=t+e.length-1,a=s,l=-1;for(;s<n;)if(r[s]===e[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(e.length-a,o[r[s]]),a=e.length-1;return l}function UH(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0}function zH(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255}function $n(r,e){return r[e]*2**24+r[e+1]*2**16+r[e+2]*2**8+r[e+3]}function Yn(r,e,t){r[t+3]=e,e=e>>>8,r[t+2]=e,e=e>>>8,r[t+1]=e,e=e>>>8,r[t]=e}function jj(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0|r[e+2]<<16>>>0|r[e+3]<<24>>>0}function qj(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255,e=e>>>8,r[t+2]=e&255,e=e>>>8,r[t+3]=e&255}function zE(r,e){return r[e]}function KE(r,e,t){r[t]=e}function KH(r){return HH(r)}function GH(r){return WH(r,e=>Qt.concat(e))}function jH(r){return Gm(e=>Qt.concat(e),r)}function qH(r){let e=0,t=0,i=0,n=new Uint8Array(Math.floor(r.length/4*3)),o=a=>{switch(t){case 3:n[i++]=e|a,t=0;break;case 2:n[i++]=e|a>>>2,e=a<<6,t=3;break;case 1:n[i++]=e|a>>>4,e=a<<4,t=2;break;default:e=a<<2,t=1}};for(let a=0;a<r.length;a++){let l=r.charCodeAt(a);if(l>=65&&l<=90)o(l-65);else if(l>=97&&l<=122)o(l-97+26);else if(l>=48&&l<=57)o(l-48+52);else if(l===43||l===45)o(62);else if(l===47||l===95)o(63);else{if(l===61)break;throw new SyntaxError(`Unexpected base64 character ${r[a]}`)}}let s=i;for(;t>0;)o(0);return Qt.wrap(n).slice(0,s)}function Y1(r){return JSON.stringify(r,$j)}function ty(r){let e=JSON.parse(r);return e=jm(e),e}function $j(r,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function jm(r,e=0){if(!r||e>200)return r;if(typeof r=="object"){switch(r.$mid){case 1:return X.revive(r);case 2:return new RegExp(r.source,r.flags);case 17:return new Date(r.source)}if(r instanceof Qt||r instanceof Uint8Array)return r;if(Array.isArray(r))for(let t=0;t<r.length;++t)r[t]=jm(r[t],e+1);else for(let t in r)Object.hasOwnProperty.call(r,t)&&(r[t]=jm(r[t],e+1))}return r}function Qc(r){if(!r||typeof r!="object"||r instanceof RegExp)return r;let e=Array.isArray(r)?[]:{};return Object.entries(r).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?Qc(i):i}),e}var Yj=Object.prototype.hasOwnProperty;function X1(r,e){return Z1(r,e,new Set)}function Z1(r,e,t){if(ao(r))return r;let i=e(r);if(typeof i<"u")return i;if(Array.isArray(r)){let n=[];for(let o of r)n.push(Z1(o,e,t));return n}if(gi(r)){if(t.has(r))throw new Error("Cannot clone recursive data-structure");t.add(r);let n={};for(let o in r)Yj.call(r,o)&&(n[o]=Z1(r[o],e,t));return t.delete(r),n}return r}function fi(r,e){if(r===e)return!0;if(r==null||e===null||e===void 0||typeof r!=typeof e||typeof r!="object"||Array.isArray(r)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(r)){if(r.length!==e.length)return!1;for(t=0;t<r.length;t++)if(!fi(r[t],e[t]))return!1}else{let n=[];for(i in r)n.push(i);n.sort();let o=[];for(i in e)o.push(i);if(o.sort(),!fi(n,o))return!1;for(t=0;t<n.length;t++)if(!fi(r[n[t]],e[n[t]]))return!1}return!0}function $H(r,e){let t=Object.create(null);return!r||!e||Object.keys(e).forEach(n=>{let o=r[n],s=e[n];fi(o,s)||(t[n]=s)}),t}var J1=Object.freeze({image:({href:r,title:e,text:t})=>{let i=[],n=[];return r&&({href:r,dimensions:i}=EH(r),n.push(`src="${qv(r)}"`)),t&&n.push(`alt="${qv(t)}"`),e&&n.push(`title="${qv(e)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:r}){return`<p>${this.parser.parseInline(r)}</p>`},link({href:r,title:e,tokens:t}){let i=this.parser.parseInline(t);return typeof r!="string"?"":(r===i&&(i=RE(i)),e=typeof e=="string"?qv(RE(e)):"",r=RE(r),r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${r}" title="${e||r}" draggable="false">${i}</a>`)}});function jE(r,e={},t={}){let i=new Y,n=!1,o=AE(e),s=function(g){let b;try{b=ty(decodeURIComponent(g))}catch{}return b?(b=X1(b,v=>{if(r.uris&&r.uris[v])return X.revive(r.uris[v])}),encodeURIComponent(JSON.stringify(b))):g},a=function(g,b){let v=r.uris&&r.uris[g],I=X.revive(v);return b?g.startsWith(ue.data+":")?g:(I||(I=X.parse(g)),Hr.uriToBrowserUri(I).toString(!0)):!I||X.parse(g).toString()===I.toString()?g:(I.query&&(I=I.with({query:s(I.query)})),I.toString())},l=new z1;l.image=J1.image,l.link=J1.link,l.paragraph=J1.paragraph;let d=[],c=[];if(e.codeBlockRendererSync?l.code=({text:g,lang:b})=>{let v=U1.nextId(),I=e.codeBlockRendererSync(YH(b),g);return c.push([v,I]),`<div class="code" data-code="${v}">${vm(g)}</div>`}:e.codeBlockRenderer&&(l.code=({text:g,lang:b})=>{let v=U1.nextId(),I=e.codeBlockRenderer(YH(b),g);return d.push(I.then(w=>[v,w])),`<div class="code" data-code="${v}">${vm(g)}</div>`}),e.actionHandler){let g=function(I){let w=I.target.closest("a[data-href]");if(ki(w))try{let E=w.dataset.href;E&&(r.baseUri&&(E=eA(X.from(r.baseUri),E)),e.actionHandler.callback(E,I))}catch(E){Ge(E)}finally{I.preventDefault()}},b=e.actionHandler.disposables.add(new Me(o,"click")),v=e.actionHandler.disposables.add(new Me(o,"auxclick"));e.actionHandler.disposables.add(z.any(b.event,v.event)(I=>{let w=new Ei(pe(o),I);!w.leftButton&&!w.middleButton||g(w)})),e.actionHandler.disposables.add(B(o,"keydown",I=>{let w=new bt(I);!w.equals(10)&&!w.equals(3)||g(w)}))}r.supportHtml||(l.html=({text:g})=>e.sanitizerOptions?.replaceWithPlaintext?vm(g):(r.isTrusted?g.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?g:""),t.renderer=l;let u=r.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}\u2026`),r.supportThemeIcons&&(u=CH(u));let p;if(e.fillInIncompleteTokens){let g={...BH,...t},b=Jv(u,g),v=aq(b);p=VH(v,g)}else p=K1(u,{...t,async:!1});r.supportThemeIcons&&(p=Es(p).map(b=>typeof b=="string"?b:b.outerHTML).join(""));let f=new DOMParser().parseFromString(tA({isTrusted:r.isTrusted,...e.sanitizerOptions},p),"text/html");if(f.body.querySelectorAll("img, audio, video, source").forEach(g=>{let b=g.getAttribute("src");if(b){let v=b;try{r.baseUri&&(v=eA(X.from(r.baseUri),v))}catch{}if(g.setAttribute("src",a(v,!0)),e.remoteImageIsAllowed){let I=X.parse(v);I.scheme!==ue.file&&I.scheme!==ue.data&&!e.remoteImageIsAllowed(I)&&g.replaceWith(he("",void 0,g.outerHTML))}}}),f.body.querySelectorAll("a").forEach(g=>{let b=g.getAttribute("href");if(g.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!r.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))g.replaceWith(...g.childNodes);else{let v=a(b,!1);r.baseUri&&(v=eA(X.from(r.baseUri),b)),g.dataset.href=v}}),o.innerHTML=tA({isTrusted:r.isTrusted,...e.sanitizerOptions},f.body.innerHTML),d.length>0)Promise.all(d).then(g=>{if(n)return;let b=new Map(g),v=o.querySelectorAll("div[data-code]");for(let I of v){let w=b.get(I.dataset.code??"");w&&gn(I,w)}e.asyncRenderCallback?.()});else if(c.length>0){let g=new Map(c),b=o.querySelectorAll("div[data-code]");for(let v of b){let I=g.get(v.dataset.code??"");I&&gn(v,I)}}if(e.asyncRenderCallback)for(let g of o.getElementsByTagName("img")){let b=i.add(B(g,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}return{element:o,dispose:()=>{n=!0,i.dispose()}}}function YH(r){if(!r)return"";let e=r.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:r}function eA(r,e){return/^\w[\w\d+.-]*:/.test(e)?e:r.path.endsWith("/")?M0(r,e).toString():M0(Gs(r),e).toString()}var Zj=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function tA(r,e){let{config:t,allowedSchemes:i}=Qj(r),n=new Y;n.add(ZH("uponSanitizeAttribute",(o,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(o.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(o.tagName==="INPUT"&&o.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),n.add(ZH("uponSanitizeElement",(o,s)=>{if(s.tagName==="input"&&(o.attributes.getNamedItem("type")?.value==="checkbox"?o.setAttribute("disabled",""):r.replaceWithPlaintext||o.remove()),r.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&o.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${o.textContent}-->`;else{let p=Zj.includes(s.tagName),m=o.attributes.length?" "+Array.from(o.attributes).map(f=>`${f.name}="${f.value}"`).join(" "):"";a=`<${s.tagName}${m}>`,p||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=o.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let u=l?o.parentElement.ownerDocument.createTextNode(l):void 0;for(;o.firstChild;)d.appendChild(o.firstChild);u&&d.appendChild(u),o.parentElement.replaceChild(d,o)}})),n.add(oH(i));try{return Bv(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{n.dispose()}}var Xj=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function Qj(r){let e=[ue.http,ue.https,ue.mailto,ue.data,ue.file,ue.vscodeFileResource,ue.vscodeRemote,ue.vscodeRemoteResource];return r.isTrusted&&e.push(ue.command),{config:{ALLOWED_TAGS:r.allowedTags??[...rH],ALLOWED_ATTR:Xj,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function iA(r){return typeof r=="string"?r:Jj(r)}function Jj(r,e){let t=r.value??"";t.length>1e5&&(t=`${t.substr(0,1e5)}\u2026`);let i=K1(t,{async:!1,renderer:e?iq.value:tq.value}).replace(/&(#\d+|[a-zA-Z]+);/g,n=>eq.get(n)??n);return tA({isTrusted:!1},i).toString()}var eq=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function XH(){let r=new z1;return r.code=({text:e})=>e,r.blockquote=({text:e})=>e+`
`,r.html=e=>"",r.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},r.hr=()=>"",r.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},r.listitem=({text:e})=>e+`
`,r.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},r.table=function({header:e,rows:t}){return e.map(i=>this.tablecell(i)).join(" ")+`
`+t.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},r.tablerow=({text:e})=>e,r.tablecell=function({tokens:e}){return this.parser.parseInline(e)},r.strong=({text:e})=>e,r.em=({text:e})=>e,r.codespan=({text:e})=>e,r.br=e=>`
`,r.del=({text:e})=>e,r.image=e=>"",r.text=({text:e})=>e,r.link=({text:e})=>e,r}var tq=new Dn(r=>XH()),iq=new Dn(()=>{let r=XH();return r.code=({text:e})=>`
\`\`\`
${e}
\`\`\`
`,r});function GE(r){let e="";return r.forEach(t=>{e+=t.raw}),e}function QH(r){if(r.tokens)for(let e=r.tokens.length-1;e>=0;e--){let t=r.tokens[e];if(t.type==="text"){let i=t.raw.split(`
`),n=i[i.length-1];if(n.includes("`"))return dq(r);if(n.includes("**"))return gq(r);if(n.match(/\*\w/))return cq(r);if(n.match(/(^|\s)__\w/))return fq(r);if(n.match(/(^|\s)_\w/))return uq(r);if(nq(n)||oq(n)&&r.tokens.slice(0,e).some(o=>o.type==="text"&&o.raw.match(/\[[^\]]*$/))){let o=r.tokens.slice(e+1);return o[0]?.type==="link"&&o[1]?.type==="text"&&o[1].raw.match(/^ *"[^"]*$/)||n.match(/^[^"]* +"[^"]*$/)?hq(r):pq(r)}else if(n.match(/(^|\s)\[\w*/))return mq(r)}}}function nq(r){return!!r.match(/(^|\s)\[.*\]\(\w*/)}function oq(r){return!!r.match(/^[^\[]*\]\([^\)]*$/)}function rq(r){let e=r.items[r.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,i;if(t?.type==="text"&&!("inRawBlock"in e)&&(i=QH(t)),!i||i.type!=="paragraph")return;let n=GE(r.items.slice(0,-1)),o=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!o)return;let s=o+GE(e.tokens.slice(0,-1))+i.raw,a=Jv(n+s)[0];if(a.type==="list")return a}var sq=3;function aq(r){for(let e=0;e<sq;e++){let t=lq(r);if(t)r=t;else break}return r}function lq(r){let e,t;for(e=0;e<r.length;e++){let i=r[e];if(i.type==="paragraph"&&i.raw.match(/(\n|^)\|/)){t=bq(r.slice(e));break}if(e===r.length-1&&i.type==="list"){let n=rq(i);if(n){t=[n];break}}if(e===r.length-1&&i.type==="paragraph"){let n=QH(i);if(n){t=[n];break}}}if(t){let i=[...r.slice(0,e),...t];return i.links=r.links,i}return null}function dq(r){return Jc(r,"`")}function cq(r){return Jc(r,"*")}function uq(r){return Jc(r,"_")}function pq(r){return Jc(r,")")}function hq(r){return Jc(r,'")')}function mq(r){return Jc(r,"](https://microsoft.com)")}function gq(r){return Jc(r,"**")}function fq(r){return Jc(r,"__")}function Jc(r,e){let t=GE(Array.isArray(r)?r:[r]);return Jv(t+e)[0]}function bq(r){let e=GE(r),t=e.split(`
`),i,n=!1;for(let o=0;o<t.length;o++){let s=t[o].trim();if(typeof i>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(s.match(/^\s*\|/)){if(o!==t.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){let o=n?t.slice(0,-1).join(`
`):e,s=!!o.match(/\|\s*$/),a=o+(s?"":"|")+`
|${" --- |".repeat(i)}`;return Jv(a)}}function ZH(r,e){return sE(r,e),te(()=>aE(r))}var vq={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function tn(){return vq}var Np=he,JH="selectOption.entry.template",nA=class{get templateId(){return JH}renderTemplate(e){let t=Object.create(null);return t.root=e,t.text=ye(e,Np(".option-text")),t.detail=ye(e,Np(".option-detail")),t.decoratorRight=ye(e,Np(".option-decorator-right")),t}renderElement(e,t,i){let n=i,o=e.text,s=e.detail,a=e.decoratorRight,l=e.isDisabled;n.text.textContent=o,n.detail.textContent=s||"",n.decoratorRight.innerText=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(e){}},qE=class r extends P{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(e,t,i,n,o){super(),this._isVisible=!1,this.styles=n,this.selectBoxOptions=o||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=r.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new _,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(tn().setupManagedHover(Dt("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return JH}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=he(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=ye(this.selectDropDownContainer,Np(".select-box-details-pane"));let t=ye(this.selectDropDownContainer,Np(".select-box-dropdown-container-width-control")),i=ye(t,Np(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",ye(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=rr(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(B(this.selectDropDownContainer,Q.DRAG_START,n=>{Oe.stop(n,!0)}))}registerListeners(){this._register(si(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(B(this.selectElement,Q.CLICK,t=>{Oe.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(B(this.selectElement,Q.MOUSE_DOWN,t=>{Oe.stop(t)}));let e;this._register(B(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(B(this.selectElement,"touchend",t=>{Oe.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(B(this.selectElement,Q.KEY_DOWN,t=>{let i=new bt(t),n=!1;ke?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),Oe.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){li(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setEnabled(e){this.selectElement.disabled=!e}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){let e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=i}styleList(){let e=this.styles.selectBackground??"",t=Ir(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;let i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){let n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let t=pe(this.selectElement),i=po(this.selectElement),n=pe(this.selectElement).getComputedStyle(this.selectElement),o=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),s=t.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let p=this._hasDetails?this._cachedMaxDetailsHeight:0,m=u+o+p,f=Math.floor((s-o-p)/this.getHeight()),g=Math.floor((a-o-p)/this.getHeight());if(e)return i.top+i.height>t.innerHeight-22||i.top<r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1?!1:(f<r.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>t.innerHeight-22||i.top<r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;m>s&&(u=f*this.getHeight())}else m>a&&(u=g*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+o+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+o+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,n=0;this.options.forEach((o,s)=>{let a=o.detail?o.detail.length:0,l=o.decoratorRight?o.decoratorRight.length:0,d=o.text.length+a+l;d>n&&(i=s,n=d)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=Lp(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=ye(e,Np(".select-box-dropdown-list-container")),this.listRenderer=new nA,this.selectList=this._register(new Sn("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let o=n.text;return n.detail&&(o+=`. ${n.detail}`),n.decoratorRight&&(o+=`. ${n.decoratorRight}`),n.description&&(o+=`. ${n.description}`),o},getWidgetAriaLabel:()=>h({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>ke?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let t=this._register(new Me(this.selectDropDownListContainer,"keydown")),i=z.chain(t.event,n=>n.filter(()=>this.selectList.length>0).map(o=>new bt(o)));this._register(z.chain(i,n=>n.filter(o=>o.keyCode===3))(this.onEnter,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode===2))(this.onEnter,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode===9))(this.onEscape,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode===16))(this.onUpArrow,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode===18))(this.onDownArrow,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode===12))(this.onPageDown,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode===11))(this.onPageUp,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode===14))(this.onHome,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode===13))(this.onEnd,this)),this._register(z.chain(i,n=>n.filter(o=>o.keyCode>=21&&o.keyCode<=56||o.keyCode>=85&&o.keyCode<=113))(this.onCharacter,this)),this._register(B(this.selectList.getHTMLElement(),Q.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(B(this.selectDropDownContainer,Q.FOCUS_OUT,n=>{!this._isVisible||An(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;Oe.stop(e);let t=e.target;if(!t||t.classList.contains("slider"))return;let i=t.closest(".monaco-list-row");if(!i)return;let n=Number(i.getAttribute("data-index")),o=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!o&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){let i=o=>{for(let s=0;s<o.childNodes.length;s++){let a=o.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=jE({value:e,supportThemeIcons:!0},{actionHandler:t});return n.element.classList.add("select-box-description-markdown"),i(n.element),n.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";let t=this.options[e],i=t?.description??"",n=t?.descriptionIsMarkdown??!1;if(i){if(n){let o=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(i,o))}else this.selectionDetailsPane.innerText=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){Oe.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){Oe.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){Oe.stop(e,!0);let t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(Oe.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){Oe.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){Oe.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){Oe.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){Oe.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){let t=Ov.toString(e.keyCode),i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),Oe.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var $E=class extends P{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(e,t,i,n){super(),this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new _),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(ei.addTarget(this.selectElement)),[it.Tap].forEach(e=>{this._register(B(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(si(this.selectElement,"click",e=>{Oe.stop(e,!0)})),this._register(si(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(si(this.selectElement,"keydown",e=>{let t=!1;ke?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!li(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",e)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(e){this.selectElement.disabled=!e}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(e){this.styles=e,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,i){let n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}};var Qme={...HE,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},YE=class extends On{selectBoxDelegate;constructor(e,t,i,n,o){super(),ke&&!o?.useCustomDrawn?this.selectBoxDelegate=new $E(e,t,n,o):this.selectBoxDelegate=new qE(e,t,i,n,o),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}setAriaLabel(e){this.selectBoxDelegate.setAriaLabel(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}setEnabled(e){this.selectBoxDelegate.setEnabled(e)}render(e){this.selectBoxDelegate.render(e)}};var eU={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};var Da=class extends On{_onChange=this._register(new _);onChange=this._onChange.event;_onKeyDown=this._register(new _);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(e){super(),this._opts=e,this._checked=this._opts.isChecked;let t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Ae.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(tn().setupManagedHover(e.hoverDelegate??Dt("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...Ae.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...Ae.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(e){this._hover.update(e),this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var mo=class extends P{constructor(t,i,n={}){super();this.options=n;this._context=t||this,this._action=i,i instanceof Si&&this._register(i.onDidChange(o=>{this.element&&this.handleActionChangeEvent(o)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(t){t.enabled!==void 0&&this.updateEnabled(),t.checked!==void 0&&this.updateChecked(),t.class!==void 0&&this.updateClass(),t.label!==void 0&&(this.updateLabel(),this.updateTooltip()),t.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new lo)),this._actionRunner}set actionRunner(t){this._actionRunner=t}isEnabled(){return this._action.enabled}setActionContext(t){this._context=t}render(t){let i=this.element=t;this._register(ei.addTarget(t));let n=this.options&&this.options.draggable;n&&(t.draggable=!0,$i&&this._register(B(t,Q.DRAG_START,o=>o.dataTransfer?.setData(Mo.TEXT,this._action.label)))),this._register(B(i,it.Tap,o=>this.onClick(o,!0))),this._register(B(i,Q.MOUSE_DOWN,o=>{n||Oe.stop(o,!0),this._action.enabled&&o.button===0&&i.classList.add("active")})),ke&&this._register(B(i,Q.CONTEXT_MENU,o=>{o.button===0&&o.ctrlKey===!0&&this.onClick(o)})),this._register(B(i,Q.CLICK,o=>{Oe.stop(o,!0),this.options&&this.options.isMenu||this.onClick(o)})),this._register(B(i,Q.DBLCLICK,o=>{Oe.stop(o,!0)})),[Q.MOUSE_UP,Q.MOUSE_OUT].forEach(o=>{this._register(B(i,o,s=>{Oe.stop(s),i.classList.remove("active")}))})}onClick(t,i=!1){Oe.stop(t,!0);let n=ao(this._context)?this.options?.useEventAsContext?t:{preserveFocus:i}:this._context;this.actionRunner.run(this._action,n)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(t){this.element&&(this.element.tabIndex=t?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let t=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=t;else if(!this.customHover&&t!==""){let i=this.options.hoverDelegate??Dt("element");this.customHover=this._store.add(tn().setupManagedHover(i,this.element,t))}else this.customHover&&this.customHover.update(t)}updateAriaLabel(){if(this.element){let t=this.getTooltip()??"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},$c=class extends mo{label;options;cssClass;constructor(e,t,i){super(e,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(e){super.render(e),Im(this.element);let t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){let i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===sn.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=h({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},ZE=class extends mo{selectBox;constructor(e,t,i,n,o,s,a){super(e,t),this.selectBox=new YE(i,n,o,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(e,t){this.selectBox.setOptions(e,t)}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}};function oA(...r){switch(r.length){case 1:return h("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",r[0]);case 2:return h("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",r[0],r[1]);case 3:return h("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",r[0],r[1],r[2]);default:return}}var yq=h("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),Iq=h("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),eu=class r{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw HV(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(oA("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(oA("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(oA("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),i=r._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(yq);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(Iq);return}let o=this._input.charCodeAt(e);if(t)t=!1;else if(o===47&&!i){e++;break}else o===91?i=!0:o===92?t=!0:o===93&&(i=!1);e++}for(;e<this._input.length&&r._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var iy=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}};var ws=class{_entries=new Map;constructor(...e){for(let[t,i]of e)this.set(t,i)}set(e,t){let i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var tu;(n=>{n.serviceIds=new Map,n.DI_TARGET="$di$target",n.DI_DEPENDENCIES="$di$dependencies";function i(o){return o[n.DI_DEPENDENCIES]||[]}n.getServiceDependencies=i})(tu||={});var ve=Z("instantiationService");function Cq(r,e,t){e[tu.DI_TARGET]===e?e[tu.DI_DEPENDENCIES].push({id:r,index:t}):(e[tu.DI_DEPENDENCIES]=[{id:r,index:t}],e[tu.DI_TARGET]=e)}function Z(r){if(tu.serviceIds.has(r))return tu.serviceIds.get(r);let e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");Cq(e,t,n)};return e.toString=()=>r,tu.serviceIds.set(r,e),e}var fo=new Map;fo.set("false",!1);fo.set("true",!0);fo.set("isMac",ke);fo.set("isLinux",_t);fo.set("isWindows",dt);fo.set("isWeb",on);fo.set("isMacNative",ke&&!on);fo.set("isEdge",uW);fo.set("isFirefox",gS);fo.set("isChrome",YR);fo.set("isSafari",cW);var Sq=Object.prototype.hasOwnProperty;var Eq={regexParsingWithErrorRecovery:!0},wq=h("contextkey.parser.error.emptyString","Empty context key expression"),xq=h("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),Tq=h("contextkey.parser.error.noInAfterNot","'in' after 'not'."),tU=h("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),_q=h("contextkey.parser.error.unexpectedToken","Unexpected token"),Dq=h("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),Lq=h("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),kq=h("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),rA=class r{constructor(e=Eq){this._config=e}static _parseError=new Error;_scanner=new eu;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:wq,offset:0,lexeme:"",additionalInfo:xq});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let i=this._peek(),n=i.type===17?Dq:void 0;throw this._parsingErrors.push({message:_q,offset:i.offset,lexeme:eu.getLexeme(i),additionalInfo:n}),r._parseError}return t}catch(t){if(t!==r._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:Ue.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:Ue.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),Ko.INSTANCE;case 12:return this._advance(),sr.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,tU),t?.negate()}case 17:return this._advance(),Bp.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),Ue.true();case 12:return this._advance(),Ue.false();case 0:{this._advance();let t=this._expr();return this._consume(1,tU),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);let o=n.lexeme,s=o.lastIndexOf("/"),a=s===o.length-1?void 0:this._removeFlagsGY(o.substring(s+1)),l;try{l=new RegExp(o.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",n)}return cy.create(t,l)}switch(n.type){case 10:case 19:{let o=[n.lexeme];this._advance();let s=this._peek(),a=0;for(let p=0;p<n.lexeme.length;p++)n.lexeme.charCodeAt(p)===40?a++:n.lexeme.charCodeAt(p)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let p=0;p<s.lexeme.length;p++)s.lexeme.charCodeAt(p)===40?a++:n.lexeme.charCodeAt(p)===41&&a--}if(a<0)break;o.push(eu.getLexeme(s)),this._advance(),s=this._peek()}let l=o.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),u;try{u=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",n)}return Ue.regex(t,u)}case 18:{let o=n.lexeme;this._advance();let s=null;if(!KW(o)){let a=o.indexOf("/"),l=o.lastIndexOf("/");if(a!==l&&a>=0){let d=o.slice(a+1,l),c=o[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(s===null)throw this._errExpectedButGot("REGEX",n);return cy.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,Tq);let n=this._value();return Ue.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();let n=this._value();if(this._previous().type===18)return Ue.equals(t,n);switch(n){case"true":return Ue.has(t);case"false":return Ue.not(t);default:return Ue.equals(t,n)}}case 4:{this._advance();let n=this._value();if(this._previous().type===18)return Ue.notEquals(t,n);switch(n){case"true":return Ue.not(t);case"false":return Ue.has(t);default:return Ue.notEquals(t,n)}}case 5:return this._advance(),ly.create(t,this._value());case 6:return this._advance(),dy.create(t,this._value());case 7:return this._advance(),sy.create(t,this._value());case 8:return this._advance(),ay.create(t,this._value());case 13:return this._advance(),Ue.in(t,this._value());default:return Ue.has(t)}}case 20:throw this._parsingErrors.push({message:Lq,offset:e.offset,lexeme:"",additionalInfo:kq}),r._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){let n=h("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,eu.getLexeme(t)),o=t.offset,s=eu.getLexeme(t);return this._parsingErrors.push({message:n,offset:o,lexeme:s,additionalInfo:i}),r._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},Ue=class{static false(){return Ko.INSTANCE}static true(){return sr.INSTANCE}static has(e){return Fp.create(e)}static equals(e,t){return oy.create(e,t)}static notEquals(e,t){return ry.create(e,t)}static regex(e,t){return cy.create(e,t)}static in(e,t){return XE.create(e,t)}static notIn(e,t){return QE.create(e,t)}static not(e){return Bp.create(e)}static and(...e){return JE.create(e,null,!0)}static or(...e){return uy.create(e,null,!0)}static greater(e,t){return sy.create(e,t)}static greaterEquals(e,t){return ay.create(e,t)}static smaller(e,t){return ly.create(e,t)}static smallerEquals(e,t){return dy.create(e,t)}static _parser=new rA({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function ny(r,e){return r.cmp(e)}var Ko=class r{static INSTANCE=new r;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return sr.INSTANCE}},sr=class r{static INSTANCE=new r;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Ko.INSTANCE}},Fp=class r{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let i=fo.get(e);return typeof i=="boolean"?i?sr.INSTANCE:Ko.INSTANCE:new r(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:oU(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=fo.get(this.key);return typeof e=="boolean"?e?sr.INSTANCE:Ko.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=Bp.create(this.key,this)),this.negated}},oy=class r{constructor(e,t,i){this.key=e;this.value=t;this.negated=i}static create(e,t,i=null){if(typeof t=="boolean")return t?Fp.create(e,i):Bp.create(e,i);let n=fo.get(e);return typeof n=="boolean"?t===(n?"true":"false")?sr.INSTANCE:Ko.INSTANCE:new r(e,t,i)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:Vp(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=fo.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?sr.INSTANCE:Ko.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ry.create(this.key,this.value,this)),this.negated}},XE=class r{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new r(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:Vp(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?Sq.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=QE.create(this.key,this.valueKey)),this.negated}},QE=class r{constructor(e,t){this.key=e;this.valueKey=t;this._negated=XE.create(e,t)}static create(e,t){return new r(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},ry=class r{constructor(e,t,i){this.key=e;this.value=t;this.negated=i}static create(e,t,i=null){if(typeof t=="boolean")return t?Bp.create(e,i):Fp.create(e,i);let n=fo.get(e);return typeof n=="boolean"?t===(n?"true":"false")?Ko.INSTANCE:sr.INSTANCE:new r(e,t,i)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:Vp(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=fo.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?Ko.INSTANCE:sr.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=oy.create(this.key,this.value,this)),this.negated}},Bp=class r{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let i=fo.get(e);return typeof i=="boolean"?i?Ko.INSTANCE:sr.INSTANCE:new r(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:oU(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=fo.get(this.key);return typeof e=="boolean"?e?Ko.INSTANCE:sr.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=Fp.create(this.key,this)),this.negated}};function ew(r,e){if(typeof r=="string"){let t=parseFloat(r);isNaN(t)||(r=t)}return typeof r=="string"||typeof r=="number"?e(r):Ko.INSTANCE}var sy=class r{constructor(e,t,i){this.key=e;this.value=t;this.negated=i}static create(e,t,i=null){return ew(t,n=>new r(e,n,i))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:Vp(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=dy.create(this.key,this.value,this)),this.negated}},ay=class r{constructor(e,t,i){this.key=e;this.value=t;this.negated=i}static create(e,t,i=null){return ew(t,n=>new r(e,n,i))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:Vp(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ly.create(this.key,this.value,this)),this.negated}},ly=class r{constructor(e,t,i){this.key=e;this.value=t;this.negated=i}static create(e,t,i=null){return ew(t,n=>new r(e,n,i))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:Vp(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=ay.create(this.key,this.value,this)),this.negated}},dy=class r{constructor(e,t,i){this.key=e;this.value=t;this.negated=i}static create(e,t,i=null){return ew(t,n=>new r(e,n,i))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:Vp(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=sy.create(this.key,this.value,this)),this.negated}},cy=class r{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new r(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=sA.create(this)),this.negated}},sA=class r{constructor(e){this._actual=e}static create(e){return new r(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new r(this._actual.map(e))}negate(){return this._actual}};function nU(r){let e=null;for(let t=0,i=r.length;t<i;t++){let n=r[t].substituteConstants();if(r[t]!==n&&e===null){e=[];for(let o=0;o<t;o++)e[o]=r[o]}e!==null&&(e[t]=n)}return e===null?r:e}var JE=class r{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,i){return r._normalizeArr(e,t,i)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){let n=ny(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=nU(this.expr);return e===this.expr?this:r.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){let n=[],o=!1;for(let s of e)if(s){if(s.type===1){o=!0;continue}if(s.type===0)return Ko.INSTANCE;if(s.type===6){n.push(...s.expr);continue}n.push(s)}if(n.length===0&&o)return sr.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(ny);for(let s=1;s<n.length;s++)n[s-1].equals(n[s])&&(n.splice(s,1),s--);if(n.length===1)return n[0];for(;n.length>1;){let s=n[n.length-1];if(s.type!==9)break;n.pop();let a=n.pop(),l=n.length===0,d=uy.create(s.expr.map(c=>r.create([c,a],null,i)),null,l);d&&(n.push(d),n.sort(ny))}if(n.length===1)return n[0];if(i){for(let s=0;s<n.length;s++)for(let a=s+1;a<n.length;a++)if(n[s].negate().equals(n[a]))return Ko.INSTANCE;if(n.length===1)return n[0]}return new r(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new r(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=uy.create(e,this,!0)}return this.negated}},uy=class r{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,i){return r._normalizeArr(e,t,i)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){let n=ny(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=nU(this.expr);return e===this.expr?this:r.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],o=!1;if(e){for(let s=0,a=e.length;s<a;s++){let l=e[s];if(l){if(l.type===0){o=!0;continue}if(l.type===1)return sr.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&o)return Ko.INSTANCE;n.sort(ny)}if(n.length!==0){if(n.length===1)return n[0];for(let s=1;s<n.length;s++)n[s-1].equals(n[s])&&(n.splice(s,1),s--);if(n.length===1)return n[0];if(i){for(let s=0;s<n.length;s++)for(let a=s+1;a<n.length;a++)if(n[s].negate().equals(n[a]))return sr.INSTANCE;if(n.length===1)return n[0]}return new r(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new r(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),i=e.shift(),n=[];for(let o of iU(t))for(let s of iU(i))n.push(JE.create([o,s],null,!1));e.unshift(r.create(n,null,!1))}this.negated=r.create(e,this,!0)}return this.negated}},q=class r extends Fp{static _info=[];static all(){return r._info.values()}_defaultValue;constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?r._info.push({...i,key:e}):i!==!0&&r._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return oy.create(this.key,e)}notEqualsTo(e){return ry.create(this.key,e)}},je=Z("contextKeyService");function oU(r,e){return r<e?-1:r>e?1:0}function Vp(r,e,t,i){return r<t?-1:r>t?1:e<i?-1:e>i?1:0}function iU(r){return r.type===9?r.expr:[r]}var ar=Object.freeze({View:pt("view","View"),Help:pt("help","Help"),Test:pt("test","Test"),File:pt("file","File"),Preferences:pt("preferences","Preferences"),Developer:pt({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});function rU(r){let e=!1,t=new Map,i=new Map;if(Rq(r,c=>{if(r===c)return!0;let u=JSON.stringify(c);if(u.length<30)return!0;let p=t.get(u);if(!p){let m={schemas:[c]};return t.set(u,m),i.set(c,m),!0}return p.schemas.push(c),i.set(c,p),e=!0,!1}),t.clear(),!e)return JSON.stringify(r);let o="$defs";for(;r.hasOwnProperty(o);)o+="_";let s=[];function a(c){return JSON.stringify(c,(u,p)=>{if(p!==c){let m=i.get(p);if(m&&m.schemas.length>1)return m.id||(m.id=`_${s.length}`,s.push(m.schemas[0])),{$ref:`#/${o}/${m.id}`}}return p})}let l=a(r),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${o}":{${d.join(",")}}}`:l}function qm(r){return typeof r=="object"&&r!==null}function Rq(r,e){if(!r||typeof r!="object")return;let t=(...l)=>{for(let d of l)qm(d)&&s.push(d)},i=(...l)=>{for(let d of l)if(qm(d))for(let c in d){let u=d[c];qm(u)&&s.push(u)}},n=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)qm(c)&&s.push(c)},o=l=>{if(Array.isArray(l))for(let d of l)qm(d)&&s.push(d);else qm(l)&&s.push(l)},s=[r],a=s.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),i(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),n(a.anyOf,a.allOf,a.oneOf,a.prefixItems),o(a.items)),a=s.pop()}var Ui=Z("commandService"),Nn=new class{_commands=new Map;_onDidRegisterCommand=new _;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(r,e){if(!r)throw new Error("invalid command");if(typeof r=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:r,handler:e})}if(r.metadata&&Array.isArray(r.metadata.args)){let s=[];for(let l of r.metadata.args)s.push(l.constraint);let a=r.handler;r.handler=function(l,...d){return JW(d,s),a(l,...d)}}let{id:t}=r,i=this._commands.get(t);i||(i=new ko,this._commands.set(t,i));let n=i.unshift(r),o=te(()=>{n(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),o}registerCommandAlias(r,e){return Nn.registerCommand(r,(t,...i)=>t.get(Ui).executeCommand(e,...i))}getCommand(r){let e=this._commands.get(r);if(!(!e||e.isEmpty()))return ct.first(e)}getCommands(){let r=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&r.set(e,t)}return r}};Nn.registerCommand("noop",()=>{});function sU(r){return r?r.condition!==void 0:!1}var aA=class{data=new Map;add(e,t){wS(Wi(e)),wS(gi(t)),wS(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},ze=new aA;var lA=class r{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new ko,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(nr===1){if(e&&e.win)return e.win}else if(nr===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){let t=r.bindToCurrentPlatform(e),i=new Y;if(t&&t.primary){let n=H0(t.primary,nr);n&&i.add(this._registerDefaultKeybinding(n,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let n=0,o=t.secondary.length;n<o;n++){let s=t.secondary[n],a=H0(s,nr);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-n-1,e.when))}return i}setExtensionKeybindings(e){let t=[],i=0;for(let n of e)n.keybinding&&(t[i++]={keybinding:n.keybinding,command:n.id,commandArgs:n.args,when:n.when,weight1:n.weight,weight2:0,extensionId:n.extensionId||null,isBuiltinExtension:n.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return un(this.registerKeybindingRule(e),Nn.registerCommand(e))}_registerDefaultKeybinding(e,t,i,n,o,s){let a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:s,weight1:n,weight2:o,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,te(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(Mq)),this._cachedMergedKeybindings.slice(0)}},fn=new lA,Aq={EditorModes:"platform.keybindingsRegistry"};ze.add(Aq.EditorModes,fn);function Mq(r,e){if(r.weight1!==e.weight1)return r.weight1-e.weight1;if(r.command&&e.command){if(r.command<e.command)return-1;if(r.command>e.command)return 1}return r.weight2-e.weight2}function $m(r){return r.command!==void 0}function aU(r){return r.submenu!==void 0}var nt=class r{static _instances=new Map;static CommandPalette=new r("CommandPalette");static DebugBreakpointsContext=new r("DebugBreakpointsContext");static DebugCallStackContext=new r("DebugCallStackContext");static DebugConsoleContext=new r("DebugConsoleContext");static DebugVariablesContext=new r("DebugVariablesContext");static NotebookVariablesContext=new r("NotebookVariablesContext");static DebugHoverContext=new r("DebugHoverContext");static DebugWatchContext=new r("DebugWatchContext");static DebugToolBar=new r("DebugToolBar");static DebugToolBarStop=new r("DebugToolBarStop");static DebugCallStackToolbar=new r("DebugCallStackToolbar");static DebugCreateConfiguration=new r("DebugCreateConfiguration");static EditorContext=new r("EditorContext");static SimpleEditorContext=new r("SimpleEditorContext");static EditorContent=new r("EditorContent");static EditorLineNumberContext=new r("EditorLineNumberContext");static EditorContextCopy=new r("EditorContextCopy");static EditorContextPeek=new r("EditorContextPeek");static EditorContextShare=new r("EditorContextShare");static EditorTitle=new r("EditorTitle");static EditorTitleRun=new r("EditorTitleRun");static EditorTitleContext=new r("EditorTitleContext");static EditorTitleContextShare=new r("EditorTitleContextShare");static EmptyEditorGroup=new r("EmptyEditorGroup");static EmptyEditorGroupContext=new r("EmptyEditorGroupContext");static EditorTabsBarContext=new r("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new r("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new r("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new r("EditorActionsPositionSubmenu");static ExplorerContext=new r("ExplorerContext");static ExplorerContextShare=new r("ExplorerContextShare");static ExtensionContext=new r("ExtensionContext");static ExtensionEditorContextMenu=new r("ExtensionEditorContextMenu");static GlobalActivity=new r("GlobalActivity");static CommandCenter=new r("CommandCenter");static CommandCenterCenter=new r("CommandCenterCenter");static LayoutControlMenuSubmenu=new r("LayoutControlMenuSubmenu");static LayoutControlMenu=new r("LayoutControlMenu");static MenubarMainMenu=new r("MenubarMainMenu");static MenubarAppearanceMenu=new r("MenubarAppearanceMenu");static MenubarDebugMenu=new r("MenubarDebugMenu");static MenubarEditMenu=new r("MenubarEditMenu");static MenubarCopy=new r("MenubarCopy");static MenubarFileMenu=new r("MenubarFileMenu");static MenubarGoMenu=new r("MenubarGoMenu");static MenubarHelpMenu=new r("MenubarHelpMenu");static MenubarLayoutMenu=new r("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new r("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new r("PanelAlignmentMenu");static PanelPositionMenu=new r("PanelPositionMenu");static ActivityBarPositionMenu=new r("ActivityBarPositionMenu");static MenubarPreferencesMenu=new r("MenubarPreferencesMenu");static MenubarRecentMenu=new r("MenubarRecentMenu");static MenubarSelectionMenu=new r("MenubarSelectionMenu");static MenubarShare=new r("MenubarShare");static MenubarSwitchEditorMenu=new r("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new r("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new r("MenubarTerminalMenu");static MenubarViewMenu=new r("MenubarViewMenu");static MenubarHomeMenu=new r("MenubarHomeMenu");static OpenEditorsContext=new r("OpenEditorsContext");static OpenEditorsContextShare=new r("OpenEditorsContextShare");static ProblemsPanelContext=new r("ProblemsPanelContext");static SCMInputBox=new r("SCMInputBox");static SCMChangesContext=new r("SCMChangesContext");static SCMChangeContext=new r("SCMChangeContext");static SCMResourceContext=new r("SCMResourceContext");static SCMResourceContextShare=new r("SCMResourceContextShare");static SCMResourceFolderContext=new r("SCMResourceFolderContext");static SCMResourceGroupContext=new r("SCMResourceGroupContext");static SCMSourceControl=new r("SCMSourceControl");static SCMSourceControlInline=new r("SCMSourceControlInline");static SCMSourceControlTitle=new r("SCMSourceControlTitle");static SCMHistoryTitle=new r("SCMHistoryTitle");static SCMTitle=new r("SCMTitle");static SearchContext=new r("SearchContext");static SearchActionMenu=new r("SearchActionContext");static StatusBarWindowIndicatorMenu=new r("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new r("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new r("StickyScrollContext");static TestItem=new r("TestItem");static TestItemGutter=new r("TestItemGutter");static TestProfilesContext=new r("TestProfilesContext");static TestMessageContext=new r("TestMessageContext");static TestMessageContent=new r("TestMessageContent");static TestPeekElement=new r("TestPeekElement");static TestPeekTitle=new r("TestPeekTitle");static TestCallStack=new r("TestCallStack");static TouchBarContext=new r("TouchBarContext");static TitleBarContext=new r("TitleBarContext");static TitleBarTitleContext=new r("TitleBarTitleContext");static TunnelContext=new r("TunnelContext");static TunnelPrivacy=new r("TunnelPrivacy");static TunnelProtocol=new r("TunnelProtocol");static TunnelPortInline=new r("TunnelInline");static TunnelTitle=new r("TunnelTitle");static TunnelLocalAddressInline=new r("TunnelLocalAddressInline");static TunnelOriginInline=new r("TunnelOriginInline");static ViewItemContext=new r("ViewItemContext");static ViewContainerTitle=new r("ViewContainerTitle");static ViewContainerTitleContext=new r("ViewContainerTitleContext");static ViewTitle=new r("ViewTitle");static ViewTitleContext=new r("ViewTitleContext");static CommentEditorActions=new r("CommentEditorActions");static CommentThreadTitle=new r("CommentThreadTitle");static CommentThreadActions=new r("CommentThreadActions");static CommentThreadAdditionalActions=new r("CommentThreadAdditionalActions");static CommentThreadTitleContext=new r("CommentThreadTitleContext");static CommentThreadCommentContext=new r("CommentThreadCommentContext");static CommentTitle=new r("CommentTitle");static CommentActions=new r("CommentActions");static CommentsViewThreadActions=new r("CommentsViewThreadActions");static InteractiveToolbar=new r("InteractiveToolbar");static InteractiveCellTitle=new r("InteractiveCellTitle");static InteractiveCellDelete=new r("InteractiveCellDelete");static InteractiveCellExecute=new r("InteractiveCellExecute");static InteractiveInputExecute=new r("InteractiveInputExecute");static InteractiveInputConfig=new r("InteractiveInputConfig");static ReplInputExecute=new r("ReplInputExecute");static IssueReporter=new r("IssueReporter");static NotebookToolbar=new r("NotebookToolbar");static NotebookStickyScrollContext=new r("NotebookStickyScrollContext");static NotebookCellTitle=new r("NotebookCellTitle");static NotebookCellDelete=new r("NotebookCellDelete");static NotebookCellInsert=new r("NotebookCellInsert");static NotebookCellBetween=new r("NotebookCellBetween");static NotebookCellListTop=new r("NotebookCellTop");static NotebookCellExecute=new r("NotebookCellExecute");static NotebookCellExecuteGoTo=new r("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new r("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new r("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new r("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new r("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new r("NotebookOutputToolbar");static NotebookOutlineFilter=new r("NotebookOutlineFilter");static NotebookOutlineActionMenu=new r("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new r("NotebookEditorLayoutConfigure");static NotebookKernelSource=new r("NotebookKernelSource");static BulkEditTitle=new r("BulkEditTitle");static BulkEditContext=new r("BulkEditContext");static TimelineItemContext=new r("TimelineItemContext");static TimelineTitle=new r("TimelineTitle");static TimelineTitleContext=new r("TimelineTitleContext");static TimelineFilterSubMenu=new r("TimelineFilterSubMenu");static AccountsContext=new r("AccountsContext");static SidebarTitle=new r("SidebarTitle");static PanelTitle=new r("PanelTitle");static AuxiliaryBarTitle=new r("AuxiliaryBarTitle");static AuxiliaryBarHeader=new r("AuxiliaryBarHeader");static TerminalInstanceContext=new r("TerminalInstanceContext");static TerminalEditorInstanceContext=new r("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new r("TerminalNewDropdownContext");static TerminalTabContext=new r("TerminalTabContext");static TerminalTabEmptyAreaContext=new r("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new r("TerminalStickyScrollContext");static WebviewContext=new r("WebviewContext");static InlineCompletionsActions=new r("InlineCompletionsActions");static InlineEditsActions=new r("InlineEditsActions");static InlineEditActions=new r("InlineEditActions");static NewFile=new r("NewFile");static MergeInput1Toolbar=new r("MergeToolbar1Toolbar");static MergeInput2Toolbar=new r("MergeToolbar2Toolbar");static MergeBaseToolbar=new r("MergeBaseToolbar");static MergeInputResultToolbar=new r("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new r("InlineSuggestionToolbar");static InlineEditToolbar=new r("InlineEditToolbar");static ChatContext=new r("ChatContext");static ChatCodeBlock=new r("ChatCodeblock");static ChatCompareBlock=new r("ChatCompareBlock");static ChatMessageTitle=new r("ChatMessageTitle");static ChatExecute=new r("ChatExecute");static ChatExecuteSecondary=new r("ChatExecuteSecondary");static ChatInputSide=new r("ChatInputSide");static AccessibleView=new r("AccessibleView");static MultiDiffEditorFileToolbar=new r("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new r("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new r("DiffEditorSelectionToolbar");static for(e){return r._instances.get(e)??new r(e)}id;constructor(e){if(r._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);r._instances.set(e,this),this.id=e}},xs=Z("menuService"),Wp=class r{constructor(e){this.id=e;this.has=t=>t===e}static _all=new Map;static for(e){let t=this._all.get(e);return t||(t=new r(e),this._all.set(e,t)),t}static merge(e){let t=new Set;for(let i of e)i instanceof r&&t.add(i.id);return t}has},Go=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new PS({merge:Wp.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(r){return this._commands.set(r.id,r),this._onDidChangeMenu.fire(Wp.for(nt.CommandPalette)),te(()=>{this._commands.delete(r.id)&&this._onDidChangeMenu.fire(Wp.for(nt.CommandPalette))})}getCommand(r){return this._commands.get(r)}getCommands(){let r=new Map;return this._commands.forEach((e,t)=>r.set(t,e)),r}appendMenuItem(r,e){let t=this._menuItems.get(r);t||(t=new ko,this._menuItems.set(r,t));let i=t.push(e);return this._onDidChangeMenu.fire(Wp.for(r)),te(()=>{i(),this._onDidChangeMenu.fire(Wp.for(r))})}appendMenuItems(r){let e=new Y;for(let{id:t,item:i}of r)e.add(this.appendMenuItem(t,i));return e}getMenuItems(r){let e;return this._menuItems.has(r)?e=[...this._menuItems.get(r)]:e=[],r===nt.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(r){let e=new Set;for(let t of r)$m(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||r.push({command:t})})}},Po=class extends Nd{constructor(t,i,n){super(`submenuitem.${t.submenu.id}`,typeof t.title=="string"?t.title:t.title.value,n,"submenu");this.item=t;this.hideActions=i}},jo=class{constructor(e,t,i,n,o,s,a){this.hideActions=n;this.menuKeybinding=o;this._commandService=a;this.id=e.id,this.label=jo.label(e,i),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||s.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){let d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&Ae.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=Ae.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new jo(t,void 0,i,n,void 0,s,a):void 0,this._options=i,this.class=l&&Ae.asClassName(l)}static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};jo=R([y(5,je),y(6,Ui)],jo);var wi=class{constructor(e){this.desc=e}};function lr(r){let e=[],t=new r,{f1:i,menu:n,keybinding:o,...s}=t.desc;if(Nn.getCommand(s.id))throw new Error(`Cannot register two commands with the same id: ${s.id}`);if(e.push(Nn.registerCommand({id:s.id,handler:(a,...l)=>t.run(a,...l),metadata:s.metadata})),Array.isArray(n))for(let a of n)e.push(Go.appendMenuItem(a.id,{command:{...s,precondition:a.precondition===null?void 0:s.precondition},...a}));else n&&e.push(Go.appendMenuItem(n.id,{command:{...s,precondition:n.precondition===null?void 0:s.precondition},...n}));if(i&&(e.push(Go.appendMenuItem(nt.CommandPalette,{command:s,when:s.precondition})),e.push(Go.addCommand(s))),Array.isArray(o))for(let a of o)e.push(fn.registerKeybindingRule({...a,id:s.id,when:s.precondition?Ue.and(s.precondition,a.when):a.when}));else o&&e.push(fn.registerKeybindingRule({...o,id:s.id,when:s.precondition?Ue.and(s.precondition,o.when):o.when}));return{dispose(){ht(e)}}}var iu=Z("contextViewService"),Zi=Z("contextMenuService");var Dl=new class{_zoomLevel=0;_onDidChangeZoomLevel=new _;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(r){r=Math.min(Math.max(-5,r),20),this._zoomLevel!==r&&(this._zoomLevel=r,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var Oq=ke?1.5:1.35,dA=8,py=class r{_bareFontInfoBrand=void 0;static createFromValidatedSettings(e,t,i){let n=e.get(50),o=e.get(54),s=e.get(53),a=e.get(52),l=e.get(55),d=e.get(68),c=e.get(65);return r._create(n,o,s,a,l,d,c,t,i)}static createFromRawSettings(e,t,i=!1){let n=Xs.fontFamily.validate(e.fontFamily),o=Xs.fontWeight.validate(e.fontWeight),s=Xs.fontSize.validate(e.fontSize),a=Xs.fontLigatures2.validate(e.fontLigatures),l=Xs.fontVariations.validate(e.fontVariations),d=Xs.lineHeight.validate(e.lineHeight),c=Xs.letterSpacing.validate(e.letterSpacing);return r._create(n,o,s,a,l,d,c,t,i)}static _create(e,t,i,n,o,s,a,l,d){s===0?s=Oq*i:s<dA&&(s=s*i),s=Math.round(s),s<dA&&(s=dA);let c=1+(d?0:Dl.getZoomLevel()*.1);return i*=c,s*=c,o===Zm.TRANSLATE&&(t==="normal"||t==="bold"?o=Zm.OFF:(o=`'wght' ${parseInt(t,10)}`,t="normal")),new r({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:n,fontVariationSettings:o,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(e){this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let e=Sr.fontFamily,t=r._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}},cA=2,Ym=class extends py{_editorStylingBrand=void 0;version=cA;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}};var Ll={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var uA="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function Pq(r=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of uA)r.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var iw=Pq();function hy(r){let e=iw;if(r&&r instanceof RegExp)if(r.global)e=r;else{let t="g";r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.unicode&&(t+="u"),e=new RegExp(r.source,t)}return e.lastIndex=0,e}var lU=new ko;lU.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function my(r,e,t,i,n){if(e=hy(e),n||(n=ct.first(lU)),t.length>n.maxLen){let d=r-n.maxLen/2;return d<0?d=0:i+=d,t=t.substring(d,r+n.maxLen/2),my(r,e,t,i,n)}let o=Date.now(),s=r-1-i,a=-1,l=null;for(let d=1;!(Date.now()-o>=n.timeBudget);d++){let c=s-n.windowSize*d;e.lastIndex=Math.max(0,c);let u=Nq(e,t,s,a);if(!u&&l||(l=u,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,d}return null}function Nq(r,e,t,i){let n;for(;n=r.exec(e);){let o=n.index||0;if(o<=t&&r.lastIndex>=t)return n;if(i>0&&o>i)return null}return null}var dr=Z("accessibilityService");var Hve=new q("accessibilityModeEnabled",!1);var dU="ACCESSIBLE_VIEW_SHOWN_";var Ts=Z("environmentService"),Jve=Ts;var bi=Z("contextService");function Xm(r){let e=r;return typeof e?.id=="string"&&X.isUri(e.uri)}var Vq={id:"ext-dev"},Wq={id:"empty-window"};function cU(r,e){if(typeof r=="string"||typeof r>"u")return typeof r=="string"?{id:ba(r)}:e?Vq:Wq;let t=r;return t.configuration?{id:t.id,configPath:t.configuration}:t.folders.length===1?{id:t.id,uri:t.folders[0].uri}:{id:t.id}}function ow(r){let e=r;return typeof e?.id=="string"&&X.isUri(e.configPath)}function rw(r){let e=r;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&Array.isArray(e.folders))}function kl(r){let e=r;return!!(e&&typeof e=="object"&&X.isUri(e.uri)&&typeof e.name=="string"&&typeof e.toResource=="function")}var uU="code-workspace",Hq=`.${uU}`,hye=[{name:h("codeWorkspace","Code Workspace"),extensions:[uU]}];function pU(r){let e;return X.isUri(r)?e=r:e=r.configuration,e?.scheme===ue.tmp}function hU(r){return(typeof r=="string"?Dc(r):Ep(r))===Hq}var He=Z("configurationService");function mU(r){return r.replace(/[\[\]]/g,"")}var Wd={JSONContribution:"base.contributions.json"};function Uq(r){return r.length>0&&r.charAt(r.length-1)==="#"?r.substring(0,r.length-1):r}var pA=class{schemasById;_onDidChangeSchema=new _;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(e,t){this.schemasById[Uq(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?rU(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}},zq=new pA;ze.add(Wd.JSONContribution,zq);var Oye=Z("policy");var $r={Configuration:"base.contributions.configuration"};var sw={properties:{},patternProperties:{}},aw={properties:{},patternProperties:{}},lw={properties:{},patternProperties:{}},dw={properties:{},patternProperties:{}},cw={properties:{},patternProperties:{}},gy={properties:{},patternProperties:{}},Hp="vscode://schemas/settings/resourceLanguage";var uw=ze.as(Wd.JSONContribution),hA=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new _;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new _;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},uw.registerSchema(Hp,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){let i=new Set;this.doRegisterConfigurations(e,t,i),uw.registerSchema(Hp,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),uw.registerSchema(Hp,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let i=new Set;this.doDeregisterConfigurations(t,i),this.doRegisterConfigurations(e,!1,i),uw.registerSchema(Hp,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let i=[];for(let{overrides:n,source:o}of e)for(let s in n){t.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=n[s];if(a.configurationDefaultOverrides.push({value:l,source:o}),Qm.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,o,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,o),i.push(...Kq(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,o,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(i)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let i of e){let n=this.registeredConfigurationDefaults.indexOf(i);n!==-1&&this.registeredConfigurationDefaults.splice(n,1)}for(let{overrides:i,source:n}of e)for(let o in i){let s=this.configurationDefaultsOverrides.get(o);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>n?l.source?.id===n.id:l.value===i[o]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(o),Qm.test(o)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(o,d.value,d.source,l);l&&!Cp(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(o,l,n)):(this.configurationDefaultsOverrides.delete(o),delete this.configurationProperties[o],delete this.defaultLanguageConfigurationOverridesNode.properties[o])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(o,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[o];d&&(this.updatePropertyDefaultValue(o,d),this.updateSchema(o,d))}t.add(o)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,i){let n={type:"object",default:t.value,description:h("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",mU(e)),$ref:Hp,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=n,this.defaultLanguageConfigurationOverridesNode.properties[e]=n}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,n){let o=n?.value||{},s=n?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(t)){let l=t[a];if(gi(l)&&(kn(o[a])||gi(o[a]))){if(o[a]={...o[a]??{},...l},i)for(let c in l)s.set(`${a}.${c}`,i)}else o[a]=l,i?s.set(a,i):s.delete(a)}return{value:o,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,n){let o=this.configurationProperties[e],s=n?.value??o?.defaultDefaultValue,a=i;if(gi(t)&&(o!==void 0&&o.type==="object"||o===void 0&&(kn(s)||gi(s)))){if(a=n?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in t)i&&a.set(`${e}.${d}`,i);t={...gi(s)?s:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1,i=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,i),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}doDeregisterConfigurations(e,t){let i=n=>{if(n.properties)for(let o in n.properties){t.add(o);let s=this.configurationProperties[o];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[o],this.removeFromSchema(o,n.properties[o])}n.allOf?.forEach(o=>i(o))};for(let n of e){i(n);let o=this.configurationContributors.indexOf(n);o!==-1&&this.configurationContributors.splice(o,1)}}validateAndRegisterProperties(e,t=!0,i,n,o=3,s){o=ao(e.scope)?o:e.scope;let a=e.properties;if(a)for(let d in a){let c=a[d];if(t&&jq(d,c)){delete a[d];continue}if(c.source=i,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),Qm.test(d)?c.scope=void 0:(c.scope=ao(c.scope)?o:c.scope,c.restricted=ao(c.restricted)?!!n?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=e.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,t,i,n,o,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,i]of this.configurationDefaultsOverrides)i.configurationDefaultOverrideValue&&e.set(t,i.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=i=>{let n=i.properties;if(n)for(let s in n)this.updateSchema(s,n[s]);i.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(sw.properties[e]=t,t.scope){case 1:aw.properties[e]=t;break;case 2:lw.properties[e]=t;break;case 6:dw.properties[e]=t;break;case 3:cw.properties[e]=t;break;case 4:gy.properties[e]=t;break;case 5:gy.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete sw.properties[e],t.scope){case 1:delete aw.properties[e];break;case 2:delete lw.properties[e];break;case 6:delete dw.properties[e];break;case 3:delete cw.properties[e];break;case 4:case 5:delete gy.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,i={type:"object",description:h("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:h("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:Hp};this.updatePropertyDefaultValue(t,i),sw.properties[t]=i,aw.properties[t]=i,lw.properties[t]=i,dw.properties[t]=i,cw.properties[t]=i,gy.properties[t]=i}}registerOverridePropertyPatternKey(){let e={type:"object",description:h("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:h("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:Hp};sw.patternProperties[Up]=e,aw.patternProperties[Up]=e,lw.patternProperties[Up]=e,dw.patternProperties[Up]=e,cw.patternProperties[Up]=e,gy.patternProperties[Up]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let i=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,n,o;i&&(!t.disallowConfigurationDefault||!i.source)&&(n=i.value,o=i.source),kn(n)&&(n=t.defaultDefaultValue,o=void 0),kn(n)&&(n=Gq(t.type)),t.default=n,t.defaultValueSource=o}},fU="\\[([^\\]]+)\\]",gU=new RegExp(fU,"g"),Up=`^(${fU})+$`,Qm=new RegExp(Up);function Kq(r){let e=[];if(Qm.test(r)){let t=gU.exec(r);for(;t?.length;){let i=t[1].trim();i&&e.push(i),t=gU.exec(r)}}return fa(e)}function Gq(r){switch(Array.isArray(r)?r[0]:r){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var pw=new hA;ze.add($r.Configuration,pw);function jq(r,e){return r.trim()?Qm.test(r)?h("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",r):pw.getConfigurationProperties()[r]!==void 0?h("config.property.duplicate","Cannot register '{0}'. This property is already registered.",r):e.policy?.name&&pw.getPolicyConfigurations().get(e.policy?.name)!==void 0?h("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",r,e.policy?.name,pw.getPolicyConfigurations().get(e.policy?.name)):null:h("config.property.empty","Cannot register an empty property")}var Ra=8,hw=class{_values;constructor(e){this._values=e}hasChanged(e){return this._values[e]}},fy=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},Jt=class{id;name;defaultValue;schema;constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return gw(e,t)}compute(e,t,i){return i}},eg=class{constructor(e,t){this.newValue=e;this.didChange=t}};function gw(r,e){if(typeof r!="object"||typeof e!="object"||!r||!e)return new eg(e,r!==e);if(Array.isArray(r)||Array.isArray(e)){let i=Array.isArray(r)&&Array.isArray(e)&&li(r,e);return new eg(e,!i)}let t=!1;for(let i in e)if(e.hasOwnProperty(i)){let n=gw(r[i],e[i]);n.didChange&&(r[i]=n.newValue,t=!0)}return new eg(r,t)}var Kp=class{id;name;defaultValue;schema=void 0;constructor(e){this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return gw(e,t)}validate(e){return this.defaultValue}},nu=class{id;name;defaultValue;schema;constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return gw(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}};function we(r,e){return typeof r>"u"?e:r==="false"?!1:!!r}var mt=class extends nu{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return we(e,this.defaultValue)}};function ou(r,e,t,i){if(typeof r>"u")return e;let n=parseInt(r,10);return isNaN(n)?e:(n=Math.max(t,n),n=Math.min(i,n),n|0)}var Ut=class r extends nu{static clampedInt(e,t,i,n){return ou(e,t,i,n)}minimum;maximum;constructor(e,t,i,n,o,s=void 0){typeof s<"u"&&(s.type="integer",s.default=i,s.minimum=n,s.maximum=o),super(e,t,i,s),this.minimum=n,this.maximum=o}validate(e){return r.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}};function vU(r,e,t,i){if(typeof r>"u")return e;let n=Yr.float(r,e);return Yr.clamp(n,t,i)}var Yr=class r extends nu{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;let i=parseFloat(e);return isNaN(i)?t:i}validationFn;constructor(e,t,i,n,o){typeof o<"u"&&(o.type="number",o.default=i),super(e,t,i,o),this.validationFn=n}validate(e){return this.validationFn(r.float(e,this.defaultValue))}},No=class r extends nu{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return r.string(e,this.defaultValue)}};function vi(r,e,t,i){return typeof r!="string"?e:i&&r in i?i[r]:t.indexOf(r)===-1?e:r}var di=class extends nu{_allowedValues;constructor(e,t,i,n,o=void 0){typeof o<"u"&&(o.type="string",o.enum=n,o.default=i),super(e,t,i,o),this._allowedValues=n}validate(e){return vi(e,this.defaultValue,this._allowedValues)}},Jm=class extends Jt{_allowedValues;_convert;constructor(e,t,i,n,o,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=o,a.default=n),super(e,t,i,a),this._allowedValues=o,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function qq(r){switch(r){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var mA=class extends Jt{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[h("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),h("accessibilitySupport.on","Optimize for usage with a Screen Reader."),h("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}},gA=class extends Jt{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertSpace:we(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:we(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function $q(r){switch(r){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function Yq(r){switch(r){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var fA=class extends Kp{constructor(){super(144)}compute(e,t,i){let n=["monaco-editor"];return t.get(40)&&n.push(t.get(40)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(75)==="default"?n.push("mouse-default"):t.get(75)==="copy"&&n.push("mouse-copy"),t.get(113)&&n.push("showUnused"),t.get(142)&&n.push("showDeprecated"),n.join(" ")}},bA=class extends mt{constructor(){super(38,"emptySelectionClipboard",!0,{description:h("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}},vA=class extends Jt{constructor(){let e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),h("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),h("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:h("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),h("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),h("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:ke},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:h("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{cursorMoveOnType:we(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":vi(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":vi(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:we(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:we(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:we(t.loop,this.defaultValue.loop)}}},ka=class r extends Jt{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",r.OFF,{anyOf:[{type:"boolean",description:h("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?r.OFF:e==="true"?r.ON:e:e?r.ON:r.OFF}},Zm=class r extends Jt{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",r.OFF,{anyOf:[{type:"boolean",description:h("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?r.OFF:e==="true"?r.TRANSLATE:e:e?r.TRANSLATE:r.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}},yA=class extends Kp{constructor(){super(51)}compute(e,t,i){return e.fontInfo}},IA=class extends nu{constructor(){super(53,"fontSize",Sr.fontSize,{type:"number",minimum:6,maximum:100,default:Sr.fontSize,description:h("fontSize","Controls the font size in pixels.")})}validate(e){let t=Yr.float(e,this.defaultValue);return t===0?Sr.fontSize:Yr.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}},CA=class r extends Jt{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",Sr.fontWeight,{anyOf:[{type:"number",minimum:r.MINIMUM_VALUE,maximum:r.MAXIMUM_VALUE,errorMessage:h("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:r.SUGGESTION_VALUES}],default:Sr.fontWeight,description:h("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Ut.clampedInt(e,Sr.fontWeight,r.MINIMUM_VALUE,r.MAXIMUM_VALUE))}},SA=class extends Jt{constructor(){let e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),h("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),h("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:h("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:h("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:h("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:h("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:h("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:h("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:h("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:h("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:h("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{multiple:vi(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??vi(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??vi(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??vi(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??vi(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??vi(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??vi(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:No.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:No.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:No.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:No.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:No.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:No.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},EA=class extends Jt{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:h("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:h("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:h("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),delay:Ut.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:we(t.sticky,this.defaultValue.sticky),hidingDelay:Ut.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:we(t.above,this.defaultValue.above)}}};var by=class r extends Kp{constructor(){super(147)}compute(e,t,i){return r.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight),n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));let o=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/o);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:o,minimapLineCount:s}}static _computeMinimapLayout(e,t){let i=e.outerWidth,n=e.outerHeight,o=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(o*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};let s=t.stableMinimapLayoutInput,a=s&&e.outerHeight===s.outerHeight&&e.lineHeight===s.lineHeight&&e.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&e.pixelRatio===s.pixelRatio&&e.scrollBeyondLastLine===s.scrollBeyondLastLine&&e.paddingTop===s.paddingTop&&e.paddingBottom===s.paddingBottom&&e.minimap.enabled===s.minimap.enabled&&e.minimap.side===s.minimap.side&&e.minimap.size===s.minimap.size&&e.minimap.showSlider===s.minimap.showSlider&&e.minimap.renderCharacters===s.minimap.renderCharacters&&e.minimap.maxColumn===s.minimap.maxColumn&&e.minimap.scale===s.minimap.scale&&e.verticalScrollbarWidth===s.verticalScrollbarWidth&&e.isViewportWrapping===s.isViewportWrapping,l=e.lineHeight,d=e.typicalHalfwidthCharacterWidth,c=e.scrollBeyondLastLine,u=e.minimap.renderCharacters,p=o>=2?Math.round(e.minimap.scale*2):e.minimap.scale,m=e.minimap.maxColumn,f=e.minimap.size,g=e.minimap.side,b=e.verticalScrollbarWidth,v=e.viewLineCount,I=e.remainingWidth,w=e.isViewportWrapping,E=u?2:3,S=Math.floor(o*n),T=S/o,D=!1,L=!1,A=E*p,W=p/o,j=1;if(f==="fill"||f==="fit"){let{typicalViewportLineCount:de,extraLinesBeforeFirstLine:se,extraLinesBeyondLastLine:De,desiredRatio:fe,minimapLineCount:rt}=r.computeContainedMinimapLineCount({viewLineCount:v,scrollBeyondLastLine:c,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:l,pixelRatio:o});if(v/rt>1)D=!0,L=!0,p=1,A=1,W=p/o;else{let Pe=!1,Gi=p+1;if(f==="fit"){let Mi=Math.ceil((se+v+De)*A);w&&a&&I<=t.stableFitRemainingWidth?(Pe=!0,Gi=t.stableFitMaxMinimapScale):Pe=Mi>S}if(f==="fill"||Pe){D=!0;let Mi=p;A=Math.min(l*o,Math.max(1,Math.floor(1/fe))),w&&a&&I<=t.stableFitRemainingWidth&&(Gi=t.stableFitMaxMinimapScale),p=Math.min(Gi,Math.max(1,Math.floor(A/E))),p>Mi&&(j=Math.min(2,p/Mi)),W=p/o/j,S=Math.ceil(Math.max(de,se+v+De)*A),w?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=I,t.stableFitMaxMinimapScale=p):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}let G=Math.floor(m*W),oe=Math.min(G,Math.max(0,Math.floor((I-b-2)*W/(d+W)))+Ra),_e=Math.floor(o*oe),re=_e/o;_e=Math.floor(_e*j);let ne=u?1:2,ge=g==="left"?0:i-oe-b;return{renderMinimap:ne,minimapLeft:ge,minimapWidth:oe,minimapHeightIsEditorHeight:D,minimapIsSampling:L,minimapScale:p,minimapLineHeight:A,minimapCanvasInnerWidth:_e,minimapCanvasInnerHeight:S,minimapCanvasOuterWidth:re,minimapCanvasOuterHeight:T}}static computeLayout(e,t){let i=t.outerWidth|0,n=t.outerHeight|0,o=t.lineHeight|0,s=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,d=t.pixelRatio,c=t.viewLineCount,u=e.get(139),p=u==="inherit"?e.get(138):u,m=p==="inherit"?e.get(134):p,f=e.get(137),g=t.isDominatedByLongLines,b=e.get(58),v=e.get(69).renderType!==0,I=e.get(70),w=e.get(107),E=e.get(85),S=e.get(74),T=e.get(105),D=T.verticalScrollbarSize,L=T.verticalHasArrows,A=T.arrowSize,W=T.horizontalScrollbarSize,j=e.get(44),G=e.get(112)!=="never",oe=e.get(67);j&&G&&(oe+=16);let _e=0;if(v){let Kn=Math.max(s,I);_e=Math.round(Kn*l)}let re=0;b&&(re=o*t.glyphMarginDecorationLaneCount);let ne=0,ge=ne+re,de=ge+_e,se=de+oe,De=i-re-_e-oe,fe=!1,rt=!1,Xe=-1;p==="inherit"&&g?(fe=!0,rt=!0):m==="on"||m==="bounded"?rt=!0:m==="wordWrapColumn"&&(Xe=f);let Pe=r._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:o,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:w,paddingTop:E.top,paddingBottom:E.bottom,minimap:S,verticalScrollbarWidth:D,viewLineCount:c,remainingWidth:De,isViewportWrapping:rt},t.memory||new fy);Pe.renderMinimap!==0&&Pe.minimapLeft===0&&(ne+=Pe.minimapWidth,ge+=Pe.minimapWidth,de+=Pe.minimapWidth,se+=Pe.minimapWidth);let Gi=De-Pe.minimapWidth,Mi=Math.max(1,Math.floor((Gi-D-2)/a)),bn=L?A:0;return rt&&(Xe=Math.max(1,Mi),m==="bounded"&&(Xe=Math.min(Xe,f))),{width:i,height:n,glyphMarginLeft:ne,glyphMarginWidth:re,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:ge,lineNumbersWidth:_e,decorationsLeft:de,decorationsWidth:oe,contentLeft:se,contentWidth:Gi,minimap:Pe,viewportColumn:Mi,isWordWrapMinified:fe,isViewportWrapping:rt,wrappingColumn:Xe,verticalScrollbarWidth:D,horizontalScrollbarHeight:W,overviewRuler:{top:bn,width:D,height:n-2*bn,right:0}}}},wA=class extends Jt{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return vi(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}};var xA=class extends Jt{constructor(){let e={enabled:"onCode"};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:e.enabled,enumDescriptions:[h("editor.lightbulb.enabled.off","Disable the code action menu."),h("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),h("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:vi(e.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},TA=class extends Jt{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),maxLineCount:Ut.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:vi(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:we(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},_A=class extends Jt{constructor(){let e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h("editor.inlayHints.on","Inlay hints are enabled"),h("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",ke?"Ctrl+Option":"Ctrl+Alt"),h("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",ke?"Ctrl+Option":"Ctrl+Alt"),h("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:h("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:vi(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Ut.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:No.string(t.fontFamily,this.defaultValue.fontFamily),padding:we(t.padding,this.defaultValue.padding),maximumLength:Ut.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},DA=class extends Jt{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Ut.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Ut.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}},LA=class extends Yr{constructor(){super(68,"lineHeight",Sr.lineHeight,e=>Yr.clamp(e,0,150),{markdownDescription:h("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}},kA=class extends Jt{constructor(){let e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:h("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),h("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:h("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:h("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),autohide:we(t.autohide,this.defaultValue.autohide),size:vi(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:vi(t.side,this.defaultValue.side,["right","left"]),showSlider:vi(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:we(t.renderCharacters,this.defaultValue.renderCharacters),scale:Ut.clampedInt(t.scale,1,1,3),maxColumn:Ut.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:we(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:we(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:Yr.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:Yr.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function Zq(r){return r==="ctrlCmd"?ke?"metaKey":"ctrlKey":"altKey"}var RA=class extends Jt{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{top:Ut.clampedInt(t.top,0,0,1e3),bottom:Ut.clampedInt(t.bottom,0,0,1e3)}}},AA=class extends Jt{constructor(){let e={enabled:!0,cycle:!0};super(87,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),cycle:we(t.cycle,this.defaultValue.cycle)}}},MA=class extends Kp{constructor(){super(145)}compute(e,t,i){return e.pixelRatio}},OA=class extends Jt{constructor(){super(89,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},PA=class extends Jt{defaultValue;constructor(){let e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h("on","Quick suggestions show inside the suggest widget"),h("inline","Quick suggestions show as ghost text"),h("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:h("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:h("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:h("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:h("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){let d=e?"on":"off";return{comments:d,strings:d,other:d}}if(!e||typeof e!="object")return this.defaultValue;let{other:t,comments:i,strings:n}=e,o=["on","inline","off"],s,a,l;return typeof t=="boolean"?s=t?"on":"off":s=vi(t,this.defaultValue.other,o),typeof i=="boolean"?a=i?"on":"off":a=vi(i,this.defaultValue.comments,o),typeof n=="boolean"?l=n?"on":"off":l=vi(n,this.defaultValue.strings,o),{other:s,comments:a,strings:l}}};var NA=class extends Jt{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h("lineNumbers.off","Line numbers are not rendered."),h("lineNumbers.on","Line numbers are rendered as absolute number."),h("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),h("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:h("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}};function Gp(r){let e=r.get(100);return e==="editable"?r.get(93):e!=="on"}var FA=class extends Jt{constructor(){let e=[],t={type:"number",description:h("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:h("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:h("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let i of e)if(typeof i=="number")t.push({column:Ut.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){let n=i;t.push({column:Ut.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}},BA=class extends Jt{constructor(){super(94,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function bU(r,e){if(typeof r!="string")return e;switch(r){case"hidden":return 2;case"visible":return 3;default:return 1}}var VA=class extends Jt{constructor(){let e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),h("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),h("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:h("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),h("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),h("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:h("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e,i=Ut.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Ut.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Ut.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:bU(t.vertical,this.defaultValue.vertical),horizontal:bU(t.horizontal,this.defaultValue.horizontal),useShadows:we(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:we(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:we(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:we(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:we(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Ut.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Ut.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:we(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:we(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},La="inUntrustedWorkspace",zp={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},WA=class extends Jt{constructor(){let e={nonBasicASCII:La,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:La,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",e,{[zp.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,La],default:e.nonBasicASCII,description:h("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[zp.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:h("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[zp.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:h("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[zp.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,La],default:e.includeComments,description:h("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[zp.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,La],default:e.includeStrings,description:h("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[zp.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:h("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[zp.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(fi(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(fi(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));let n=super.applyUpdate(e,t);return i?new eg(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{nonBasicASCII:tg(t.nonBasicASCII,La,[!0,!1,La]),invisibleCharacters:we(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:we(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:tg(t.includeComments,La,[!0,!1,La]),includeStrings:tg(t.includeStrings,La,[!0,!1,La]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;let i={};for(let[n,o]of Object.entries(e))o===!0&&(i[n]=!0);return i}},HA=class extends Jt{constructor(){let e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),h("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),h("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:h("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:h("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),mode:vi(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:vi(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:we(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:we(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:No.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:we(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},UA=class extends Jt{constructor(){let e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:h("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),h("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),h("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:h("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:h("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),showToolbar:vi(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:No.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:we(t.keepOnBlur,this.defaultValue.keepOnBlur)}}},zA=class extends Jt{constructor(){let e={enabled:Ll.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Ll.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:we(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},KA=class extends Jt{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h("editor.guides.bracketPairs.true","Enables bracket pair guides."),h("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),h("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:h("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),h("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),h("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:h("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[h("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),h("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),h("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:h("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{bracketPairs:tg(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:tg(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:we(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:we(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:tg(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function tg(r,e,t){let i=t.indexOf(r);return i===-1?e:t[i]}var GA=class extends Jt{constructor(){let e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),h("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:h("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),h("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),h("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),h("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:h("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertMode:vi(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:we(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:we(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:we(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:we(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:vi(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:we(t.showIcons,this.defaultValue.showIcons),showStatusBar:we(t.showStatusBar,this.defaultValue.showStatusBar),preview:we(t.preview,this.defaultValue.preview),previewMode:vi(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:we(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:we(t.showMethods,this.defaultValue.showMethods),showFunctions:we(t.showFunctions,this.defaultValue.showFunctions),showConstructors:we(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:we(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:we(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:we(t.showFields,this.defaultValue.showFields),showVariables:we(t.showVariables,this.defaultValue.showVariables),showClasses:we(t.showClasses,this.defaultValue.showClasses),showStructs:we(t.showStructs,this.defaultValue.showStructs),showInterfaces:we(t.showInterfaces,this.defaultValue.showInterfaces),showModules:we(t.showModules,this.defaultValue.showModules),showProperties:we(t.showProperties,this.defaultValue.showProperties),showEvents:we(t.showEvents,this.defaultValue.showEvents),showOperators:we(t.showOperators,this.defaultValue.showOperators),showUnits:we(t.showUnits,this.defaultValue.showUnits),showValues:we(t.showValues,this.defaultValue.showValues),showConstants:we(t.showConstants,this.defaultValue.showConstants),showEnums:we(t.showEnums,this.defaultValue.showEnums),showEnumMembers:we(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:we(t.showKeywords,this.defaultValue.showKeywords),showWords:we(t.showWords,this.defaultValue.showWords),showColors:we(t.showColors,this.defaultValue.showColors),showFiles:we(t.showFiles,this.defaultValue.showFiles),showReferences:we(t.showReferences,this.defaultValue.showReferences),showFolders:we(t.showFolders,this.defaultValue.showFolders),showTypeParameters:we(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:we(t.showSnippets,this.defaultValue.showSnippets),showUsers:we(t.showUsers,this.defaultValue.showUsers),showIssues:we(t.showIssues,this.defaultValue.showIssues)}}},jA=class extends Jt{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:we(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:we(e.selectSubwords,this.defaultValue.selectSubwords)}}},qA=class extends Jt{constructor(){let e=[];super(132,"wordSegmenterLocales",e,{anyOf:[{description:h("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:h("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){let t=[];for(let i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}};var $A=class extends Jt{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),h("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),h("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),h("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:h("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}},YA=class extends Kp{constructor(){super(148)}compute(e,t,i){let n=t.get(147);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}},ZA=class extends Jt{constructor(){let e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),h("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),showDropSelector:vi(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},XA=class extends Jt{constructor(){let e={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),h("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:we(t.enabled,this.defaultValue.enabled),showPasteSelector:vi(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},Xq="Consolas, 'Courier New', monospace",Qq="Menlo, Monaco, 'Courier New', monospace",Jq="'Droid Sans Mono', 'monospace', monospace",Sr={fontFamily:ke?Qq:_t?Jq:Xq,fontWeight:"normal",fontSize:ke?12:14,lineHeight:0,letterSpacing:0},ig=[];function J(r){return ig[r.id]=r,r}var Xs={acceptSuggestionOnCommitCharacter:J(new mt(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:h("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:J(new di(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:J(new mA),accessibilityPageSize:J(new Ut(3,"accessibilityPageSize",10,1,1073741824,{description:h("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:J(new No(4,"ariaLabel",h("editorViewAccessibleLabel","Editor content"))),ariaRequired:J(new mt(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:J(new mt(8,"screenReaderAnnounceInlineSuggestion",!0,{description:h("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:J(new di(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),h("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:J(new di(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),h("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:h("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:J(new di(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:J(new di(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:h("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:J(new di(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),h("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:J(new Jm(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],qq,{enumDescriptions:[h("editor.autoIndent.none","The editor will not insert indentation automatically."),h("editor.autoIndent.keep","The editor will keep the current line's indentation."),h("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),h("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:J(new mt(13,"automaticLayout",!1)),autoSurround:J(new di(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),h("editor.autoSurround.quotes","Surround with quotes but not brackets."),h("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:h("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:J(new zA),bracketPairGuides:J(new KA),stickyTabStops:J(new mt(118,"stickyTabStops",!1,{description:h("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:J(new mt(17,"codeLens",!0,{description:h("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:J(new No(18,"codeLensFontFamily","",{description:h("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:J(new Ut(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:J(new mt(20,"colorDecorators",!0,{description:h("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:J(new di(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),h("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),h("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:h("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:J(new Ut(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:J(new mt(22,"columnSelection",!1,{description:h("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:J(new gA),contextmenu:J(new mt(24,"contextmenu",!0)),copyWithSyntaxHighlighting:J(new mt(25,"copyWithSyntaxHighlighting",!0,{description:h("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:J(new Jm(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],$q,{description:h("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:J(new di(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),h("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:h("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:J(new Jm(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],Yq,{description:h("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:J(new Ut(29,"cursorSurroundingLines",0,0,1073741824,{description:h("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:J(new di(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:h("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:J(new Ut(31,"cursorWidth",0,0,1073741824,{markdownDescription:h("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:J(new mt(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:J(new mt(33,"disableMonospaceOptimizations",!1)),domReadOnly:J(new mt(34,"domReadOnly",!1)),dragAndDrop:J(new mt(35,"dragAndDrop",!0,{description:h("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:J(new bA),dropIntoEditor:J(new ZA),experimentalEditContextEnabled:J(new mt(37,"experimentalEditContextEnabled",!1,{description:h("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:J(new TA),experimentalWhitespaceRendering:J(new di(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),h("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),h("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:h("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:J(new No(40,"extraEditorClassName","")),fastScrollSensitivity:J(new Yr(41,"fastScrollSensitivity",5,r=>r<=0?5:r,{markdownDescription:h("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:J(new vA),fixedOverflowWidgets:J(new mt(43,"fixedOverflowWidgets",!1)),folding:J(new mt(44,"folding",!0,{description:h("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:J(new di(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),h("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:h("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:J(new mt(46,"foldingHighlight",!0,{description:h("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:J(new mt(47,"foldingImportsByDefault",!1,{description:h("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:J(new Ut(48,"foldingMaximumRegions",5e3,10,65e3,{description:h("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:J(new mt(49,"unfoldOnClickAfterEndOfLine",!1,{description:h("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:J(new No(50,"fontFamily",Sr.fontFamily,{description:h("fontFamily","Controls the font family.")})),fontInfo:J(new yA),fontLigatures2:J(new ka),fontSize:J(new IA),fontWeight:J(new CA),fontVariations:J(new Zm),formatOnPaste:J(new mt(56,"formatOnPaste",!1,{description:h("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:J(new mt(57,"formatOnType",!1,{description:h("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:J(new mt(58,"glyphMargin",!0,{description:h("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:J(new SA),hideCursorInOverviewRuler:J(new mt(60,"hideCursorInOverviewRuler",!1,{description:h("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:J(new EA),inDiffEditor:J(new mt(62,"inDiffEditor",!1)),letterSpacing:J(new Yr(65,"letterSpacing",Sr.letterSpacing,r=>Yr.clamp(r,-5,20),{description:h("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:J(new xA),lineDecorationsWidth:J(new DA),lineHeight:J(new LA),lineNumbers:J(new NA),lineNumbersMinChars:J(new Ut(70,"lineNumbersMinChars",5,1,300)),linkedEditing:J(new mt(71,"linkedEditing",!1,{description:h("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:J(new mt(72,"links",!0,{description:h("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:J(new di(73,"matchBrackets","always",["always","near","never"],{description:h("matchBrackets","Highlight matching brackets.")})),minimap:J(new kA),mouseStyle:J(new di(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:J(new Yr(76,"mouseWheelScrollSensitivity",1,r=>r===0?1:r,{markdownDescription:h("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:J(new mt(77,"mouseWheelZoom",!1,{markdownDescription:ke?h("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:J(new mt(78,"multiCursorMergeOverlapping",!0,{description:h("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:J(new Jm(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],Zq,{markdownEnumDescriptions:[h("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),h("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:J(new di(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h("multiCursorPaste.spread","Each cursor pastes a single line of the text."),h("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:h("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:J(new Ut(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:J(new di(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h("occurrencesHighlight.off","Does not highlight occurrences."),h("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),h("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:J(new mt(83,"overviewRulerBorder",!0,{description:h("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:J(new Ut(84,"overviewRulerLanes",3,0,3)),padding:J(new RA),pasteAs:J(new XA),parameterHints:J(new AA),peekWidgetDefaultFocus:J(new di(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),h("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:h("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:J(new OA),definitionLinkOpensInPeek:J(new mt(90,"definitionLinkOpensInPeek",!1,{description:h("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:J(new PA),quickSuggestionsDelay:J(new Ut(92,"quickSuggestionsDelay",10,0,1073741824,{description:h("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:J(new mt(93,"readOnly",!1)),readOnlyMessage:J(new BA),renameOnType:J(new mt(95,"renameOnType",!1,{description:h("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:h("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:J(new mt(96,"renderControlCharacters",!0,{description:h("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:J(new di(97,"renderFinalNewline",_t?"dimmed":"on",["off","on","dimmed"],{description:h("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:J(new di(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:h("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:J(new mt(99,"renderLineHighlightOnlyWhenFocus",!1,{description:h("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:J(new di(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:J(new di(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),h("renderWhitespace.selection","Render whitespace characters only on selected text."),h("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:h("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:J(new Ut(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:J(new mt(103,"roundedSelection",!0,{description:h("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:J(new FA),scrollbar:J(new VA),scrollBeyondLastColumn:J(new Ut(106,"scrollBeyondLastColumn",4,0,1073741824,{description:h("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:J(new mt(107,"scrollBeyondLastLine",!0,{description:h("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:J(new mt(108,"scrollPredominantAxis",!0,{description:h("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:J(new mt(109,"selectionClipboard",!0,{description:h("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:_t})),selectionHighlight:J(new mt(110,"selectionHighlight",!0,{description:h("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:J(new mt(111,"selectOnLineNumbers",!0)),showFoldingControls:J(new di(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h("showFoldingControls.always","Always show the folding controls."),h("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),h("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:h("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:J(new mt(113,"showUnused",!0,{description:h("showUnused","Controls fading out of unused code.")})),showDeprecated:J(new mt(142,"showDeprecated",!0,{description:h("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:J(new _A),snippetSuggestions:J(new di(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),h("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),h("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),h("snippetSuggestions.none","Do not show snippet suggestions.")],description:h("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:J(new jA),smoothScrolling:J(new mt(116,"smoothScrolling",!1,{description:h("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:J(new Ut(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:J(new GA),inlineSuggest:J(new HA),inlineEdit:J(new UA),inlineCompletionsAccessibilityVerbose:J(new mt(151,"inlineCompletionsAccessibilityVerbose",!1,{description:h("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:J(new Ut(121,"suggestFontSize",0,0,1e3,{markdownDescription:h("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:J(new Ut(122,"suggestLineHeight",0,0,1e3,{markdownDescription:h("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:J(new mt(123,"suggestOnTriggerCharacters",!0,{description:h("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:J(new di(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h("suggestSelection.first","Always select the first suggestion."),h("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:J(new di(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),h("tabCompletion.off","Disable tab completions."),h("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h("tabCompletion","Enables tab completions.")})),tabIndex:J(new Ut(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:J(new WA),unusualLineTerminators:J(new di(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),h("unusualLineTerminators.off","Unusual line terminators are ignored."),h("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:h("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:J(new mt(129,"useShadowDOM",!0)),useTabStops:J(new mt(130,"useTabStops",!0,{description:h("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:J(new di(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h("wordBreak.normal","Use the default line break rule."),h("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:J(new qA),wordSeparators:J(new No(133,"wordSeparators",uA,{description:h("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:J(new di(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h("wordWrap.off","Lines will never wrap."),h("wordWrap.on","Lines will wrap at the viewport width."),h({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),h({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:J(new No(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:J(new No(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:J(new Ut(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:h({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:J(new di(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:J(new di(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:J(new fA),defaultColorDecorators:J(new mt(149,"defaultColorDecorators",!1,{markdownDescription:h("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:J(new MA),tabFocusMode:J(new mt(146,"tabFocusMode",!1,{markdownDescription:h("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:J(new by),wrappingInfo:J(new YA),wrappingIndent:J(new $A),wrappingStrategy:J(new wA)};var F=class r{lineNumber;column;constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new r(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return r.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return r.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return r.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){let o=e.column|0,s=t.column|0;return o-s}return i-n}clone(){return new r(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new r(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var O=class r{startLineNumber;startColumn;endLineNumber;endColumn;constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return r.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return r.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return r.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return r.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return r.plusRange(this,e)}static plusRange(e,t){let i,n,o,s;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(o=t.endLineNumber,s=t.endColumn):t.endLineNumber===e.endLineNumber?(o=t.endLineNumber,s=Math.max(t.endColumn,e.endColumn)):(o=e.endLineNumber,s=e.endColumn),new r(i,n,o,s)}intersectRanges(e){return r.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,s=e.endColumn,a=t.startLineNumber,l=t.startColumn,d=t.endLineNumber,c=t.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),o>d?(o=d,s=c):o===d&&(s=Math.min(s,c)),i>o||i===o&&n>s?null:new r(i,n,o,s)}equalsRange(e){return r.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return r.getEndPosition(this)}static getEndPosition(e){return new F(e.endLineNumber,e.endColumn)}getStartPosition(){return r.getStartPosition(this)}static getStartPosition(e){return new F(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new r(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new r(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return r.collapseToStart(this)}static collapseToStart(e){return new r(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return r.collapseToEnd(this)}static collapseToEnd(e){return new r(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new r(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new r(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new r(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let o=e.startLineNumber|0,s=t.startLineNumber|0;if(o===s){let a=e.startColumn|0,l=t.startColumn|0;if(a===l){let d=e.endLineNumber|0,c=t.endLineNumber|0;if(d===c){let u=e.endColumn|0,p=t.endColumn|0;return u-p}return d-c}return a-l}return o-s}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var tt=class r extends O{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return r.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new r(this.startLineNumber,this.startColumn,e,t):new r(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new F(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new F(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new r(e,t,this.endLineNumber,this.endColumn):new r(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new r(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new r(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new r(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new r(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,o){return o===0?new r(e,t,i,n):new r(i,n,e,t)}};var QA;function yU(){return QA||(QA=new TextDecoder("UTF-16LE")),QA}var JA;function e$(){return JA||(JA=new TextDecoder("UTF-16BE")),JA}var eM;function tM(){return eM||(eM=dW()?yU():e$()),eM}function IU(r,e,t){let i=new Uint16Array(r.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?t$(r,e,t):yU().decode(i)}function t$(r,e,t){let i=[],n=0;for(let o=0;o<t;o++){let s=UH(r,e);e+=2,i[n++]=String.fromCharCode(s)}return i.join("")}var Rl=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return tM().decode(e)}_flushBuffer(){let e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){let t=this._capacity-this._bufferLength;t<=1&&(t===0||Di(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){let t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}};function fw(r){return r.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var Zr=class r{constructor(e,t,i,n){this.oldPosition=e;this.oldText=t;this.newPosition=i;this.newText=n}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${fw(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${fw(this.oldText)}")`:`(replace@${this.oldPosition} "${fw(this.oldText)}" with "${fw(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){let n=t.length;Yn(e,n,i),i+=4;for(let o=0;o<n;o++)zH(e,t.charCodeAt(o),i),i+=2;return i}static _readString(e,t){let i=$n(e,t);return t+=4,IU(e,t,i)}writeSize(){return 8+r._writeStringSize(this.oldText)+r._writeStringSize(this.newText)}write(e,t){return Yn(e,this.oldPosition,t),t+=4,Yn(e,this.newPosition,t),t+=4,t=r._writeString(e,this.oldText,t),t=r._writeString(e,this.newText,t),t}static read(e,t,i){let n=$n(e,t);t+=4;let o=$n(e,t);t+=4;let s=r._readString(e,t);t+=r._writeStringSize(s);let a=r._readString(e,t);return t+=r._writeStringSize(a),i.push(new r(n,s,o,a)),t}};function CU(r,e){return r===null||r.length===0?e:new iM(r,e).compress()}var iM=class r{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),n=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++t);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++t);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldPosition<i.newPosition){let[d,c]=r._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(d),n=c;continue}if(i.newPosition<n.oldPosition){let[d,c]=r._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(d),i=c;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++e),n=this._getCurr(++t);else if(n.oldEnd<i.newEnd){let[d,c]=r._splitPrev(i,n.oldLength);a=d,l=n,i=c,n=this._getCurr(++t)}else{let[d,c]=r._splitCurr(n,i.newLength);a=i,l=d,i=this._getPrev(++e),n=c}this._result[this._resultLen++]=new Zr(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let o=r._merge(this._result);return r._removeNoOps(o)}_acceptCurr(e){this._result[this._resultLen++]=r._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=r._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new Zr(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new Zr(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){let i=e.newText.substr(0,t),n=e.newText.substr(t);return[new Zr(e.oldPosition,e.oldText,e.newPosition,i),new Zr(e.oldEnd,"",e.newPosition+t,n)]}static _splitCurr(e,t){let i=e.oldText.substr(0,t),n=e.oldText.substr(t);return[new Zr(e.oldPosition,i,e.newPosition,e.newText),new Zr(e.oldPosition+t,n,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],i=0,n=e[0];for(let o=1;o<e.length;o++){let s=e[o];n.oldEnd===s.oldPosition?n=new Zr(n.oldPosition,n.oldText+s.oldText,n.newPosition,n.newText+s.newText):(t[i++]=n,n=s)}return t[i++]=n,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],i=0;for(let n=0;n<e.length;n++){let o=e[n];o.oldText!==o.newText&&(t[i++]=o)}return t}};var ng=class r{_asciiMap;_map;_defaultValue;constructor(e){let t=bp(e);this._defaultValue=t,this._asciiMap=r._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let i=bp(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var nM=class extends ng{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(e,t){super(0),this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=e.length;i<n;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(let n of this._getIntlSegmenterWordsOnLine(e)){if(n.index>t)break;i=n}return i}findNextIntlWordAtOrAfterOffset(e,t){for(let i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}},SU=new Br(10);function Al(r,e){let t=`${r}/${e.join(",")}`,i=SU.get(t);return i||(i=new nM(r,e),SU.set(t,i)),i}var ru=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let r;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?r=crypto.getRandomValues.bind(crypto):r=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};let e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){r(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let n=0,o="";return o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+="-",o+=t[e[n++]],o+=t[e[n++]],o+="-",o+=t[e[n++]],o+=t[e[n++]],o+="-",o+=t[e[n++]],o+=t[e[n++]],o+="-",o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o}}();var vy=Object.freeze({create:r=>fa(r.map(e=>e.toString())).join(`\r
`),split:r=>r.split(`\r
`),parse:r=>vy.split(r).filter(e=>!e.startsWith("#"))});var EU=class r{constructor(e){this.value=e}static sep=".";static None=new r("@@none@@");static Empty=new r("");equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+r.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new r((this.value?[this.value,...e]:e).join(r.sep))}};var Xr=class{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e),n=this.getFontStyle(e);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){let i=this.getForeground(e),n=this.getFontStyle(e),o=`color: ${t[i]};`;n&1&&(o+="font-style: italic;"),n&2&&(o+="font-weight: bold;");let s="";return n&4&&(s+=" underline"),n&8&&(s+=" line-through"),s&&(o+=`text-decoration:${s};`),o}static getPresentationFromMetadata(e){let t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}};var bw="**",wU="/",vw="[/\\\\]",yw="[^/\\\\]",n$=/\//g;function xU(r,e){switch(r){case 0:return"";case 1:return`${yw}*?`;default:return`(?:${vw}|${yw}+${vw}${e?`|${vw}${yw}+`:""})*?`}}function TU(r,e){if(!r)return[];let t=[],i=!1,n=!1,o="";for(let s of r){switch(s){case e:if(!i&&!n){t.push(o),o="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}o+=s}return o&&t.push(o),t}function RU(r){if(!r)return"";let e="",t=TU(r,wU);if(t.every(i=>i===bw))e=".*";else{let i=!1;t.forEach((n,o)=>{if(n===bw){if(i)return;e+=xU(2,o===t.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of n){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let u;c==="-"?u=c:(c==="^"||c==="!")&&!d?u="^":c===wU?u="":u=or(c),d+=u;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let p=`(?:${TU(a,",").map(m=>RU(m)).join("|")})`;e+=p,s=!1,a="";break}case"]":{e+="["+d+"]",l=!1,d="";break}case"?":e+=yw;continue;case"*":e+=xU(1);continue;default:e+=or(c)}}o<t.length-1&&(t[o+1]!==bw||o+2<t.length)&&(e+=vw)}i=n===bw})}return e}var o$=/^\*\*\/\*\.[\w\.-]+$/,r$=/^\*\*\/([\w\.-]+)\/?$/,s$=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,a$=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,l$=/^\*\*((\/[\w\.-]+)+)\/?$/,d$=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,_U=new Br(1e4),DU=function(){return!1},Ml=function(){return null};function rM(r,e){if(!r)return Ml;let t;typeof r!="string"?t=r.pattern:t=r,t=t.trim();let i=`${t}_${!!e.trimForExclusions}`,n=_U.get(i);if(n)return LU(n,r);let o;return o$.test(t)?n=c$(t.substr(4),t):(o=r$.exec(oM(t,e)))?n=u$(o[1],t):(e.trimForExclusions?a$:s$).test(t)?n=p$(t,e):(o=l$.exec(oM(t,e)))?n=kU(o[1].substr(1),t,!0):(o=d$.exec(oM(t,e)))?n=kU(o[1],t,!1):n=h$(t),_U.set(i,n),LU(n,r)}function LU(r,e){if(typeof e=="string")return r;let t=function(i,n){return Tv(i,e.base,!_t)?r(bv(i.substr(e.base.length),jn),n):null};return t.allBasenames=r.allBasenames,t.allPaths=r.allPaths,t.basenames=r.basenames,t.patterns=r.patterns,t}function oM(r,e){return e.trimForExclusions&&r.endsWith("/**")?r.substr(0,r.length-2):r}function c$(r,e){return function(t,i){return typeof t=="string"&&t.endsWith(r)?e:null}}function u$(r,e){let t=`/${r}`,i=`\\${r}`,n=function(s,a){return typeof s!="string"?null:a?a===r?e:null:s===r||s.endsWith(t)||s.endsWith(i)?e:null},o=[r];return n.basenames=o,n.patterns=[e],n.allBasenames=o,n}function p$(r,e){let t=AU(r.slice(1,-1).split(",").map(a=>rM(a,e)).filter(a=>a!==Ml),r),i=t.length;if(!i)return Ml;if(i===1)return t[0];let n=function(a,l){for(let d=0,c=t.length;d<c;d++)if(t[d](a,l))return r;return null},o=t.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(n.allPaths=s),n}function kU(r,e,t){let i=jn===ft.sep,n=i?r:r.replace(n$,jn),o=jn+n,s=ft.sep+r,a;return t?a=function(l,d){return typeof l=="string"&&(l===n||l.endsWith(o)||!i&&(l===r||l.endsWith(s)))?e:null}:a=function(l,d){return typeof l=="string"&&(l===n||!i&&l===r)?e:null},a.allPaths=[(t?"*/":"./")+r],a}function h$(r){try{let e=new RegExp(`^${RU(r)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?r:null}}catch{return Ml}}function og(r,e={}){if(!r)return DU;if(typeof r=="string"||m$(r)){let t=rM(r,e);if(t===Ml)return DU;let i=function(n,o){return!!t(n,o)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return g$(r,e)}function m$(r){let e=r;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function g$(r,e){let t=AU(Object.getOwnPropertyNames(r).map(a=>f$(a,r[a],e)).filter(a=>a!==Ml)),i=t.length;if(!i)return Ml;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];let a=function(c,u){let p;for(let m=0,f=t.length;m<f;m++){let g=t[m](c,u);if(typeof g=="string")return g;ZS(g)&&(p||(p=[]),p.push(g))}return p?(async()=>{for(let m of p){let f=await m;if(typeof f=="string")return f}return null})():null},l=t.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=t.reduce((c,u)=>u.allPaths?c.concat(u.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let n=function(a,l,d){let c,u;for(let p=0,m=t.length;p<m;p++){let f=t[p];f.requiresSiblings&&d&&(l||(l=ba(a)),c||(c=l.substr(0,l.length-Dc(a).length)));let g=f(a,l,c,d);if(typeof g=="string")return g;ZS(g)&&(u||(u=[]),u.push(g))}return u?(async()=>{for(let p of u){let m=await p;if(typeof m=="string")return m}return null})():null},o=t.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(n.allPaths=s),n}function f$(r,e,t){if(e===!1)return Ml;let i=rM(r,t);if(i===Ml)return Ml;if(typeof e=="boolean")return i;if(e){let n=e.when;if(typeof n=="string"){let o=(s,a,l,d)=>{if(!d||!i(s,a))return null;let c=n.replace("$(basename)",()=>l),u=d(c);return ZS(u)?u.then(p=>p?r:null):u?r:null};return o.requiresSiblings=!0,o}}return i}function AU(r,e){let t=r.filter(a=>!!a.basenames);if(t.length<2)return r;let i=t.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),n;if(e){n=[];for(let a=0,l=i.length;a<l;a++)n.push(e)}else n=t.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let o=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let u=a.charCodeAt(c-1);if(u===47||u===92)break}l=a.substr(c)}let d=i.indexOf(l);return d!==-1?n[d]:null};o.basenames=i,o.patterns=n,o.allBasenames=i;let s=r.filter(a=>!a.basenames);return s.push(o),s}var yy=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new _;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),te(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let i=new sM(this,e,t);return this._factories.set(e,i),te(()=>{let n=this._factories.get(e);!n||n!==i||(this._factories.delete(e),n.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;let i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},sM=class extends P{constructor(t,i,n){super();this._registry=t;this._languageId=i;this._factory=n}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}};function Er(r){let e=0,t=0,i=0,n=0;for(let o=0,s=r.length;o<s;o++){let a=r.charCodeAt(o);a===13?(e===0&&(t=o),e++,o+1<s&&r.charCodeAt(o+1)===10?(n|=2,o++):n|=3,i=o+1):a===10&&(n|=1,e===0&&(t=o),e++,i=o+1)}return e===0&&(t=r.length),[e,t,r.length-i,n]}var Be=class r{constructor(e,t){this.start=e;this.endExclusive=t;if(e>t)throw new Je(`Invalid range: ${this.toString()}`)}static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let n=i;for(;n<t.length&&t[n].start<=e.endExclusive;)n++;if(i===n)t.splice(i,0,e);else{let o=Math.min(e.start,t[i].start),s=Math.max(e.endExclusive,t[n-1].endExclusive);t.splice(i,n-i,new r(o,s))}}static tryCreate(e,t){if(!(e>t))return new r(e,t)}static ofLength(e){return new r(0,e)}static ofStartAndLength(e,t){return new r(e,e+t)}static emptyAt(e){return new r(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new r(this.start+e,this.endExclusive+e)}deltaStart(e){return new r(this.start+e,this.endExclusive)}deltaEnd(e){return new r(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new r(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new r(t,i)}intersectionLength(e){let t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,i-t)}intersects(e){let t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<i}intersectsOrTouches(e){let t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<=i}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Je(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Je(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let i=this.start;i<this.endExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}},Iw=class r{_sortedRanges=[];addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{let n=Math.min(e.start,this._sortedRanges[t].start),o=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new Be(n,o))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){let t=new r;for(let i of this._sortedRanges){let n=i.intersect(e);n&&t.addRange(n)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}};var aM=class r{constructor(e){this._tokenInfo=e}static create(e){return new r(e)}forEach(e){let t=0;for(let i of this._tokenInfo){let n=new Be(t,t+i.length);e(n,i),t+=i.length}}slice(e){let t=[],i=0;for(let n of this._tokenInfo){let o=i,s=o+n.length;if(s>e.start){if(o>=e.endExclusive)break;let a=Math.max(0,e.start-o),l=Math.max(0,s-e.endExclusive);t.push(new Cw(n.length-a-l,n.metadata))}i+=n.length}return r.create(t)}},Cw=class{constructor(e,t){this.length=e;this.metadata=t}},Sw=class{_tokens=[];add(e,t){this._tokens.push(new Cw(e,t))}build(){return aM.create(this._tokens)}};var Xi=class r{static createEmpty(e,t){let i=r.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=i,new r(n,e,t)}static createFromTextAndMetadata(e,t){let i=0,n="",o=new Array;for(let{text:s,metadata:a}of e)o.push(i+s.length,a),i+=s.length,n+=s;return new r(new Uint32Array(o),n,t)}static convertToEndOffset(e,t){let n=(e.length>>>1)-1;for(let o=0;o<n;o++)e[o<<1]=e[o+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,n=(e.length>>>1)-1;for(;i<n;){let o=i+Math.floor((n-i)/2),s=e[o<<1];if(s===t)return o+1;s<t?i=o+1:s>t&&(n=o)}return i}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(e,t,i){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=i}equals(e){return e instanceof r?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let n=t<<1,o=n+(i<<1);for(let s=n;s<o;s++)if(this._tokens[s]!==e._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let t=this._tokens[(e<<1)+1],i=Xr.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){let t=this._tokens[(e<<1)+1];return Xr.getTokenType(t)}getForeground(e){let t=this._tokens[(e<<1)+1];return Xr.getForeground(t)}getClassName(e){let t=this._tokens[(e<<1)+1];return Xr.getClassNameFromMetadata(t)}getInlineStyle(e,t){let i=this._tokens[(e<<1)+1];return Xr.getInlineStyleFromMetadata(i,t)}getPresentation(e){let t=this._tokens[(e<<1)+1];return Xr.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return r.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new lM(this,e,t,i)}withInserted(e){if(e.length===0)return this;let t=0,i=0,n="",o=new Array,s=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(s,a);let d=this._tokens[(t<<1)+1];o.push(n.length,d),t++,s=a}else if(l){if(l.offset>s){n+=this._text.substring(s,l.offset);let d=this._tokens[(t<<1)+1];o.push(n.length,d),s=l.offset}n+=l.text,o.push(n.length,l.tokenMetadata),i++}else break}return new r(new Uint32Array(o),n,this.languageIdCodec)}getTokensInRange(e){let t=new Sw,i=this.findTokenIndexAtOffset(e.start),n=this.findTokenIndexAtOffset(e.endExclusive);for(let o=i;o<=n;o++){let a=new Be(this.getStartOffset(o),this.getEndOffset(o)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(o))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),i=this.getEndOffset(e);return this._text.substring(t,i)}forEach(e){let t=this.getCount();for(let i=0;i<t;i++)e(i)}},lM=class r{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(e,t,i,n){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let o=this._firstTokenIndex,s=e.getCount();o<s&&!(e.getStartOffset(o)>=i);o++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof r?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,i=this._source.getStartOffset(t),n=this._source.getEndOffset(t),o=this._source.getTokenText(t);return i<this._startOffset&&(o=o.substring(this._startOffset-i)),n>this._endOffset&&(o=o.substring(0,o.length-(n-this._endOffset))),o}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}};var Ol=new Uint32Array(0).buffer,Zn=class r{static deleteBeginning(e,t){return e===null||e===Ol?e:r.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===Ol)return e;let i=Pl(e),n=i[i.length-2];return r.delete(e,t,n)}static delete(e,t,i){if(e===null||e===Ol||t===i)return e;let n=Pl(e),o=n.length>>>1;if(t===0&&n[n.length-2]===i)return Ol;let s=Xi.findIndexInTokensArray(n,t),a=s>0?n[s-1<<1]:0,l=n[s<<1];if(i<l){let m=i-t;for(let f=s;f<o;f++)n[f<<1]-=m;return e}let d,c;a!==t?(n[s<<1]=t,d=s+1<<1,c=t):(d=s<<1,c=a);let u=i-t;for(let m=s+1;m<o;m++){let f=n[m<<1]-u;f>c&&(n[d++]=f,n[d++]=n[(m<<1)+1],c=f)}if(d===n.length)return e;let p=new Uint32Array(d);return p.set(n.subarray(0,d),0),p.buffer}static append(e,t){if(t===Ol)return e;if(e===Ol)return t;if(e===null)return e;if(t===null)return null;let i=Pl(e),n=Pl(t),o=n.length>>>1,s=new Uint32Array(i.length+n.length);s.set(i,0);let a=i.length,l=i[i.length-2];for(let d=0;d<o;d++)s[a++]=n[d<<1]+l,s[a++]=n[(d<<1)+1];return s.buffer}static insert(e,t,i){if(e===null||e===Ol)return e;let n=Pl(e),o=n.length>>>1,s=Xi.findIndexInTokensArray(n,t);s>0&&n[s-1<<1]===t&&s--;for(let a=s;a<o;a++)n[a<<1]+=i;return e}};function Pl(r){return r instanceof Uint32Array?r:new Uint32Array(r)}var Fe=class r{static fromRange(e){return new r(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new r(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new r(e.startLineNumber,t.startLineNumber),new r(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new r(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new r(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new _s(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new _s(e[i].slice()));return t.ranges}static join(e){if(e.length===0)throw new Je("lineRanges cannot be empty");let t=e[0].startLineNumber,i=e[0].endLineNumberExclusive;for(let n=1;n<e.length;n++)t=Math.min(t,e[n].startLineNumber),i=Math.max(i,e[n].endLineNumberExclusive);return new r(t,i)}static ofLength(e,t){return new r(e,e+t)}static deserialize(e){return new r(e[0],e[1])}startLineNumber;endLineNumberExclusive;constructor(e,t){if(e>t)throw new Je(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new r(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new r(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new r(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new r(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new O(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new O(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new Be(this.startLineNumber-1,this.endLineNumberExclusive-1)}},_s=class r{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=ev(this._normalizedRanges,n=>n.endLineNumberExclusive>=e.startLineNumber),i=Cd(this._normalizedRanges,n=>n.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){let n=this._normalizedRanges[t];this._normalizedRanges[t]=n.join(e)}else{let n=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,n)}}contains(e){let t=Id(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=Id(this._normalizedRanges,i=>i.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],i=0,n=0,o=null;for(;i<this._normalizedRanges.length||n<e._normalizedRanges.length;){let s=null;if(i<this._normalizedRanges.length&&n<e._normalizedRanges.length){let a=this._normalizedRanges[i],l=e._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(s=a,i++):(s=l,n++)}else i<this._normalizedRanges.length?(s=this._normalizedRanges[i],i++):(s=e._normalizedRanges[n],n++);o===null?o=s:o.endLineNumberExclusive>=s.startLineNumber?o=new Fe(o.startLineNumber,Math.max(o.endLineNumberExclusive,s.endLineNumberExclusive)):(t.push(o),o=s)}return o!==null&&t.push(o),new r(t)}subtractFrom(e){let t=ev(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),i=Cd(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new r([e]);let n=[],o=e.startLineNumber;for(let s=t;s<i;s++){let a=this._normalizedRanges[s];a.startLineNumber>o&&n.push(new Fe(o,a.startLineNumber)),o=a.endLineNumberExclusive}return o<e.endLineNumberExclusive&&n.push(new Fe(o,e.endLineNumberExclusive)),new r(n)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],i=0,n=0;for(;i<this._normalizedRanges.length&&n<e._normalizedRanges.length;){let o=this._normalizedRanges[i],s=e._normalizedRanges[n],a=o.intersect(s);a&&!a.isEmpty&&t.push(a),o.endLineNumberExclusive<s.endLineNumberExclusive?i++:n++}return new r(t)}getWithDelta(e){return new r(this._normalizedRanges.map(t=>t.delta(e)))}};var Iy=class r{static deserialize(e,t,i){let n=new Uint32Array(e.buffer),o=$n(e,t);t+=4;let s=$n(e,t);t+=4;let a=[];for(let l=0;l<s;l++){let d=$n(e,t);t+=4,a.push(n.subarray(t/4,t/4+d/4)),t+=d}return i.push(new r(o,a)),t}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new Fe(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e=0;e+=4,e+=4;for(let t=0;t<this._tokens.length;t++){let i=this._tokens[t];if(!(i instanceof Uint32Array))throw new Error("Not supported!");e+=4,e+=i.byteLength}return e}serialize(e,t){Yn(e,this._startLineNumber,t),t+=4,Yn(e,this._tokens.length,t),t+=4;for(let i=0;i<this._tokens.length;i++){let n=this._tokens[i];if(!(n instanceof Uint32Array))throw new Error("Not supported!");Yn(e,n.byteLength,t),t+=4,e.set(new Uint8Array(n.buffer),t),t+=n.byteLength}return t}applyEdit(e,t){let[i,n]=Er(t);this._acceptDeleteRange(e),this._acceptInsertText(new F(e.startLineNumber,e.startColumn),i,n)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;if(i<0){let n=i-t;this._startLineNumber-=n;return}if(!(t>=this._tokens.length)){if(t<0&&i>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===i){this._tokens[t]=Zn.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=Zn.deleteEnding(this._tokens[t],e.startColumn-1),i<this._tokens.length){let n=Zn.deleteBeginning(this._tokens[i],e.endColumn-1);this._tokens[t]=Zn.append(this._tokens[t],n),this._tokens.splice(t+1,i-t)}else this._tokens[t]=Zn.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else{let n=-t;this._startLineNumber-=n,this._tokens[i]=Zn.deleteBeginning(this._tokens[i],e.endColumn-1),this._tokens=this._tokens.slice(i)}}}_acceptInsertText(e,t,i){if(t===0&&i===0)return;let n=e.lineNumber-this._startLineNumber;if(n<0){this._startLineNumber+=t;return}if(!(n>=this._tokens.length)){if(t===0){this._tokens[n]=Zn.insert(this._tokens[n],e.column-1,i);return}this._tokens[n]=Zn.deleteEnding(this._tokens[n],e.column-1),this._tokens[n]=Zn.insert(this._tokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(t===0)return;let i=[];for(let n=0;n<t;n++)i[n]=null;this._tokens=cl(this._tokens,e,i)}};var Ew=(n=>(n[n.Ignore=0]="Ignore",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n))(Ew||{});(a=>{let r="error",e="warning",t="warn",i="info",n="ignore";function o(l){return l?Ho(r,l)?3:Ho(e,l)||Ho(t,l)?2:Ho(i,l)?1:0:0}a.fromValue=o;function s(l){switch(l){case 3:return r;case 2:return e;case 1:return i;default:return n}}a.toString=s})(Ew||={});var zi=Ew;var PU=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var Ds=class{value;_lower;constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){let i=typeof e=="string"?e:e.value,n=typeof t=="string"?t:t.value;return Ho(i,n)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}},Cy=class{_set=new Set;get size(){return this._set.size}constructor(e){if(e)for(let t of e)this.add(t)}add(e){this._set.add(Ds.toKey(e))}delete(e){return this._set.delete(Ds.toKey(e))}has(e){return this._set.has(Ds.toKey(e))}};var aSe=Z("IBuiltinExtensionsScannerService");var Sy=(n=>(n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error",n))(Sy||{});(o=>{function r(s,a){return a-s}o.compare=r;let e=Object.create(null);e[8]=h("sev.error","Error"),e[4]=h("sev.warning","Warning"),e[2]=h("sev.info","Info");function t(s){return e[s]||""}o.toString=t;function i(s){switch(s){case zi.Error:return 8;case zi.Warning:return 4;case zi.Info:return 2;case zi.Ignore:return 1}}o.fromSeverity=i;function n(s){switch(s){case 8:return zi.Error;case 4:return zi.Warning;case 2:return zi.Info;case 1:return zi.Ignore}}o.toSeverity=n})(Sy||={});var y$;(i=>{let r="";function e(n){return t(n,!0)}i.makeKey=e;function t(n,o){let s=[r];return n.source?s.push(n.source.replace("\xA6","\\\xA6")):s.push(r),n.code?typeof n.code=="string"?s.push(n.code.replace("\xA6","\\\xA6")):s.push(n.code.value.replace("\xA6","\\\xA6")):s.push(r),n.severity!==void 0&&n.severity!==null?s.push(Sy.toString(n.severity)):s.push(r),n.message&&o?s.push(n.message.replace("\xA6","\\\xA6")):s.push(r),n.startLineNumber!==void 0&&n.startLineNumber!==null?s.push(n.startLineNumber.toString()):s.push(r),n.startColumn!==void 0&&n.startColumn!==null?s.push(n.startColumn.toString()):s.push(r),n.endLineNumber!==void 0&&n.endLineNumber!==null?s.push(n.endLineNumber.toString()):s.push(r),n.endColumn!==void 0&&n.endColumn!==null?s.push(n.endColumn.toString()):s.push(r),s.push(r),s.join("\xA6")}i.makeKeyOptionalMessage=t})(y$||={});var NU=Z("markerService");var ww=class{constructor(e,t){this.tokens=e;this.endState=t}_encodedTokenizationResultBrand=void 0};var I$;(n=>{let r=new Map;r.set(0,ie.symbolMethod),r.set(1,ie.symbolFunction),r.set(2,ie.symbolConstructor),r.set(3,ie.symbolField),r.set(4,ie.symbolVariable),r.set(5,ie.symbolClass),r.set(6,ie.symbolStruct),r.set(7,ie.symbolInterface),r.set(8,ie.symbolModule),r.set(9,ie.symbolProperty),r.set(10,ie.symbolEvent),r.set(11,ie.symbolOperator),r.set(12,ie.symbolUnit),r.set(13,ie.symbolValue),r.set(15,ie.symbolEnum),r.set(14,ie.symbolConstant),r.set(15,ie.symbolEnum),r.set(16,ie.symbolEnumMember),r.set(17,ie.symbolKeyword),r.set(27,ie.symbolSnippet),r.set(18,ie.symbolText),r.set(19,ie.symbolColor),r.set(20,ie.symbolFile),r.set(21,ie.symbolReference),r.set(22,ie.symbolCustomColor),r.set(23,ie.symbolFolder),r.set(24,ie.symbolTypeParameter),r.set(25,ie.account),r.set(26,ie.issues);function e(o){let s=r.get(o);return s||(console.info("No codicon found for CompletionItemKind "+o),s=ie.symbolProperty),s}n.toIcon=e;let t=new Map;t.set("method",0),t.set("function",1),t.set("constructor",2),t.set("field",3),t.set("variable",4),t.set("class",5),t.set("struct",6),t.set("interface",7),t.set("module",8),t.set("property",9),t.set("event",10),t.set("operator",11),t.set("unit",12),t.set("value",13),t.set("constant",14),t.set("enum",15),t.set("enum-member",16),t.set("enumMember",16),t.set("keyword",17),t.set("snippet",27),t.set("text",18),t.set("color",19),t.set("file",20),t.set("reference",21),t.set("customcolor",22),t.set("folder",23),t.set("type-parameter",24),t.set("typeParameter",24),t.set("account",25),t.set("issue",26);function i(o,s){let a=t.get(o);return typeof a>"u"&&!s&&(a=9),a}n.fromString=i})(I$||={});var aEe={17:h("Array","array"),16:h("Boolean","boolean"),4:h("Class","class"),13:h("Constant","constant"),8:h("Constructor","constructor"),9:h("Enum","enumeration"),21:h("EnumMember","enumeration member"),23:h("Event","event"),7:h("Field","field"),0:h("File","file"),11:h("Function","function"),10:h("Interface","interface"),19:h("Key","key"),5:h("Method","method"),1:h("Module","module"),2:h("Namespace","namespace"),20:h("Null","null"),15:h("Number","number"),18:h("Object","object"),24:h("Operator","operator"),3:h("Package","package"),6:h("Property","property"),14:h("String","string"),22:h("Struct","struct"),25:h("TypeParameter","type parameter"),12:h("Variable","variable")};var cM;(t=>{let r=new Map;r.set(0,ie.symbolFile),r.set(1,ie.symbolModule),r.set(2,ie.symbolNamespace),r.set(3,ie.symbolPackage),r.set(4,ie.symbolClass),r.set(5,ie.symbolMethod),r.set(6,ie.symbolProperty),r.set(7,ie.symbolField),r.set(8,ie.symbolConstructor),r.set(9,ie.symbolEnum),r.set(10,ie.symbolInterface),r.set(11,ie.symbolFunction),r.set(12,ie.symbolVariable),r.set(13,ie.symbolConstant),r.set(14,ie.symbolString),r.set(15,ie.symbolNumber),r.set(16,ie.symbolBoolean),r.set(17,ie.symbolArray),r.set(18,ie.symbolObject),r.set(19,ie.symbolKey),r.set(20,ie.symbolNull),r.set(21,ie.symbolEnumMember),r.set(22,ie.symbolStruct),r.set(23,ie.symbolEvent),r.set(24,ie.symbolOperator),r.set(25,ie.symbolTypeParameter);function e(i){let n=r.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=ie.symbolProperty),n}t.toIcon=e})(cM||={});var FU=class r{constructor(e){this.value=e}static Comment=new r("comment");static Imports=new r("imports");static Region=new r("region");static fromValue(e){switch(e){case"comment":return r.Comment;case"imports":return r.Imports;case"region":return r.Region}return new r(e)}};var C$;(e=>{function r(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}e.is=r})(C$||={});var Qr=new yy,Ey=new yy;var Ki=Z("languageService");function Nl(r,e){let t=r.getCount(),i=r.findTokenIndexAtOffset(e),n=r.getLanguageId(i),o=i;for(;o+1<t&&r.getLanguageId(o+1)===n;)o++;let s=i;for(;s>0&&r.getLanguageId(s-1)===n;)s--;return new uM(r,n,s,o+1,r.getStartOffset(s),r.getEndOffset(o))}var uM=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(e,t,i,n,o,s){this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=o,this._lastCharOffset=s,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},BU=(e=>(e[e.value=3]="value",e))(BU||{});function Qs(r){return(r&BU.value)!==0}var rg=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(e){if(this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;let i=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){let n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},xw=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let t of e)wy(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),wy(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),wy(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),wy(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&wy(this.autoClosingPairsCloseSingleChar,t.close,t)}};function wy(r,e,t){r.has(e)?r.get(e).push(t):r.set(e,[t])}var pM=class r{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(e,t,i,n,o,s){this.languageId=e,this.index=t,this.open=i,this.close=n,this.forwardRegex=o,this.reversedRegex=s,this._openSet=r._toSet(this.open),this._closeSet=r._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){let t=new Set;for(let i of e)t.add(i);return t}};function S$(r){let e=r.length;r=r.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let t=[];for(let s=0;s<e;s++)t[s]=s;let i=(s,a)=>{let[l,d]=s,[c,u]=a;return l===c||l===u||d===c||d===u},n=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<e;c++)t[c]===d&&(t[c]=l)};for(let s=0;s<e;s++){let a=r[s];for(let l=s+1;l<e;l++){let d=r[l];i(a,d)&&n(t[s],t[l])}}let o=[];for(let s=0;s<e;s++){let a=[],l=[];for(let d=0;d<e;d++)if(t[d]===s){let[c,u]=r[d];a.push(c),l.push(u)}a.length>0&&o.push({open:a,close:l})}return o}var Tw=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(e,t){let i=S$(t);this.brackets=i.map((n,o)=>new pM(e,o,n.open,n.close,E$(n.open,n.close,i,o),w$(n.open,n.close,i,o))),this.forwardRegex=x$(this.brackets),this.reversedRegex=T$(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let n of this.brackets){for(let o of n.open)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,o.length);for(let o of n.close)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,o.length)}}};function VU(r,e,t,i){for(let n=0,o=e.length;n<o;n++){if(n===t)continue;let s=e[n];for(let a of s.open)a.indexOf(r)>=0&&i.push(a);for(let a of s.close)a.indexOf(r)>=0&&i.push(a)}}function WU(r,e){return r.length-e.length}function _w(r){if(r.length<=1)return r;let e=[],t=new Set;for(let i of r)t.has(i)||(e.push(i),t.add(i));return e}function E$(r,e,t,i){let n=[];n=n.concat(r),n=n.concat(e);for(let o=0,s=n.length;o<s;o++)VU(n[o],t,i,n);return n=_w(n),n.sort(WU),n.reverse(),sg(n)}function w$(r,e,t,i){let n=[];n=n.concat(r),n=n.concat(e);for(let o=0,s=n.length;o<s;o++)VU(n[o],t,i,n);return n=_w(n),n.sort(WU),n.reverse(),sg(n.map(hM))}function x$(r){let e=[];for(let t of r){for(let i of t.open)e.push(i);for(let i of t.close)e.push(i)}return e=_w(e),sg(e)}function T$(r){let e=[];for(let t of r){for(let i of t.open)e.push(i);for(let i of t.close)e.push(i)}return e=_w(e),sg(e.map(hM))}function _$(r){let e=/^[\w ]+$/.test(r);return r=or(r),e?`\\b${r}\\b`:r}function sg(r,e){let t=`(${r.map(_$).join(")|(")})`;return BS(t,!0,e)}var hM=function(){function r(i){let n=new Uint16Array(i.length),o=0;for(let s=i.length-1;s>=0;s--)n[o++]=i.charCodeAt(s);return tM().decode(n)}let e=null,t=null;return function(n){return e!==n&&(e=n,t=r(e)),t}}(),cr=class{static _findPrevBracketInText(e,t,i,n){let o=i.match(e);if(!o)return null;let s=i.length-(o.index||0),a=o[0].length,l=n+s;return new O(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,n,o){let a=hM(i).substring(i.length-o,i.length-n);return this._findPrevBracketInText(e,t,a,n)}static findNextBracketInText(e,t,i,n){let o=i.match(e);if(!o)return null;let s=o.index||0,a=o[0].length;if(a===0)return null;let l=n+s;return new O(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,n,o){let s=i.substring(n,o);return this.findNextBracketInText(e,t,s,n)}};var Dw=class{constructor(e,t){this.languageId=e;let i=t.brackets?HU(t.brackets):[],n=new Oc(a=>{let l=new Set;return{info:new mM(this,a,l),closing:l}}),o=new Oc(a=>{let l=new Set,d=new Set;return{info:new gM(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of i){let d=n.get(a),c=o.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=t.colorizedBracketPairs?HU(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=n.get(a),c=o.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...o.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){let t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return sg(t,e)}};function HU(r){return r.filter(([e,t])=>e!==""&&t!=="")}var Lw=class{constructor(e,t){this.config=e;this.bracketText=t}get languageId(){return this.config.languageId}},mM=class extends Lw{constructor(t,i,n){super(t,i);this.openedBrackets=n}isOpeningBracket=!0},gM=class extends Lw{constructor(t,i,n,o){super(t,i);this.openingBrackets=n;this.openingColorizedBrackets=o}isOpeningBracket=!1;closes(t){return t.config!==this.config?!1:this.openingBrackets.has(t)}closesColorized(t){return t.config!==this.config?!1:this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}};var oi=class r{static _nextVisibleColumn(e,t,i){return e===9?r.nextRenderTabStop(t,i):bs(e)||wv(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){let n=Math.min(t-1,e.length),o=e.substring(0,n),s=new Ip(o),a=0;for(;!s.eol();){let l=ym(o,n,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static toStatusbarColumn(e,t,i){let n=e.substring(0,Math.min(t-1,e.length)),o=new yp(n),s=0;for(;!o.eol();)o.nextCodePoint()===9?s=r.nextRenderTabStop(s,i):s=s+1;return s+1}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;let n=e.length,o=new Ip(e),s=0,a=1;for(;!o.eol();){let l=ym(e,n,o.offset);o.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,i),c=o.offset+1;if(d>=t){let u=t-s;return d-t<u?c:a}s=d,a=c}return n+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}};var wr=class r{constructor(e,t){this.lineCount=e;this.columnCount=t}static zero=new r(0,0);static lengthDiffNonNegative(e,t){return t.isLessThan(e)?r.zero:e.lineCount===t.lineCount?new r(0,t.columnCount-e.columnCount):new r(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new r(0,t.column-e.column):new r(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return r.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,i=0;for(let n of e)n===`
`?(t++,i=0):i++;return new r(t,i)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new r(this.lineCount,this.columnCount+e.columnCount):new r(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new O(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new O(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new O(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new F(e.lineNumber,e.column+this.columnCount):new F(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};function UU(r,e,t,i){return r!==t?yi(t-r,i):yi(0,i-e)}var Fn=0;function ag(r){return r===0}var Jr=2**26;function yi(r,e){return r*Jr+e}function qo(r){let e=r,t=Math.floor(e/Jr),i=e-t*Jr;return new wr(t,i)}function zU(r){return Math.floor(r/Jr)}function ci(r,e){let t=r+e;return e>=Jr&&(t=t-r%Jr),t}function KU(r,e){return r.reduce((t,i)=>ci(t,e(i)),Fn)}function fM(r,e){return r===e}function qp(r,e){let t=r,i=e;if(i-t<=0)return Fn;let o=Math.floor(t/Jr),s=Math.floor(i/Jr),a=i-s*Jr;if(o===s){let l=t-o*Jr;return yi(0,a-l)}else return yi(s-o,a)}function Ud(r,e){return r<e}function su(r,e){return r<=e}function lg(r,e){return r>=e}function au(r){return yi(r.lineNumber-1,r.column-1)}function lu(r,e){let t=r,i=Math.floor(t/Jr),n=t-i*Jr,o=e,s=Math.floor(o/Jr),a=o-s*Jr;return new O(i+1,n+1,s+1,a+1)}function GU(r){let e=vv(r);return yi(e.length-1,e[e.length-1].length)}var kw=[],bo=class r{constructor(e,t){this.items=e;this.additionalItems=t}static cache=new Array(129);static create(e,t){if(e<=128&&t.length===0){let i=r.cache[e];return i||(i=new r(e,t),r.cache[e]=i),i}return new r(e,t)}static empty=r.create(0,kw);static getEmpty(){return this.empty}add(e,t){let i=t.getKey(e),n=i>>5;if(n===0){let s=1<<i|this.items;return s===this.items?this:r.create(s,this.additionalItems)}n--;let o=this.additionalItems.slice(0);for(;o.length<n;)o.push(0);return o[n]|=1<<(i&31),r.create(this.items,o)}has(e,t){let i=t.getKey(e),n=i>>5;return n===0?(this.items&1<<i)!==0:(n--,((this.additionalItems[n]||0)&1<<(i&31))!==0)}merge(e){let t=this.items|e.items;if(this.additionalItems===kw&&e.additionalItems===kw)return t===this.items?this:t===e.items?e:r.create(t,kw);let i=[];for(let n=0;n<Math.max(this.additionalItems.length,e.additionalItems.length);n++){let o=this.additionalItems[n]||0,s=e.additionalItems[n]||0;i.push(o|s)}return r.create(t,i)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}equals(e){if(this.items!==e.items||this.additionalItems.length!==e.additionalItems.length)return!1;for(let t=0;t<this.additionalItems.length;t++)if(this.additionalItems[t]!==e.additionalItems[t])return!1;return!0}},bM={getKey(r){return r}},Rw=class{items=new Map;getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}reverseLookup(e){return[...this.items].find(([t,i])=>i===e)?.[0]}reverseLookupSet(e){let t=[];for(let[i]of this.items)e.has(i,this)&&t.push(i);return t}keys(){return this.items.keys()}};var Aw=class r{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new rg(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new rg({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){let t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new rg({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:r.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:r.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var Mw=class{_richEditBrackets;constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(let t of this._richEditBrackets.brackets)for(let i of t.close){let n=i.charAt(i.length-1);e.push(n)}return fa(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let n=t.findTokenIndexAtOffset(i-1);if(Qs(t.getStandardTokenType(n)))return null;let o=this._richEditBrackets.reversedRegex,s=t.getLineContent().substring(0,i-1)+e,a=cr.findPrevBracketInRange(o,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function Ow(r){return r.global&&(r.lastIndex=0),!0}var Pw=class{_indentationRules;constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&Ow(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&Ow(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&Ow(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&Ow(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}};var Nw=class r{_brackets;_regExpRules;constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{let i=r._createOpenBracketRegExp(t[0]),n=r._createCloseBracketRegExp(t[1]);i&&n&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:n})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,n){if(e>=3)for(let o=0,s=this._regExpRules.length;o<s;o++){let a=this._regExpRules[o];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:t}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(e>=2&&i.length>0&&n.length>0)for(let o=0,s=this._brackets.length;o<s;o++){let a=this._brackets[o];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:2}}if(e>=2&&i.length>0){for(let o=0,s=this._brackets.length;o<s;o++)if(this._brackets[o].openRegExp.test(i))return{indentAction:1}}return null}static _createOpenBracketRegExp(e){let t=or(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",r._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=or(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,r._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return Ge(t),null}}};var D$=[];function an(r,e,t){e instanceof iy||(e=new iy(e,[],!!t)),D$.push([r,e])}var L$={ModesRegistry:"editor.modesRegistry"},yM=class{_languages;_onDidChangeLanguages=new _;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}},qU=new yM;ze.add(L$.ModesRegistry,qU);var xr="plaintext",k$=".txt";qU.registerLanguage({id:xr,extensions:[k$],aliases:[h("plainText.alias","Plain Text"),"text"],mimetypes:[zo.text]});ze.as($r.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var Ty=class{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}},zd=Z("languageConfigurationService"),xy=class extends P{constructor(t,i){super();this.configurationService=t;this.languageService=i;let n=new Set(Object.values(IM));this._register(this.configurationService.onDidChangeConfiguration(o=>{let s=o.change.keys.some(l=>n.has(l)),a=o.change.overrides.filter(([l,d])=>d.some(c=>n.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new Ty(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new Ty(l)))})),this._register(this._registry.onDidChange(o=>{this.configurations.delete(o.languageId),this.onDidChangeEmitter.fire(new Ty(o.languageId))}))}_serviceBrand;_registry=this._register(new SM);onDidChangeEmitter=this._register(new _);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(t,i,n){return this._registry.register(t,i,n)}getLanguageConfiguration(t){let i=this.configurations.get(t);return i||(i=R$(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,i)),i}};xy=R([y(0,He),y(1,Ki)],xy);function R$(r,e,t,i){let n=e.getLanguageConfiguration(r);if(!n){if(!i.isRegisteredLanguageId(r))return new dg(r,{});n=new dg(r,{})}let o=A$(n.languageId,t),s=YU([n.underlyingConfig,o]);return new dg(n.languageId,s)}var IM={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function A$(r,e){let t=e.getValue(IM.brackets,{overrideIdentifier:r}),i=e.getValue(IM.colorizedBracketPairs,{overrideIdentifier:r});return{brackets:$U(t),colorizedBracketPairs:$U(i)}}function $U(r){if(Array.isArray(r))return r.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function Vw(r,e,t){let i=r.getLineContent(e),n=Ln(i);return n.length>t-1&&(n=n.substring(0,t-1)),n}var CM=class{constructor(e){this.languageId=e;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(e,t){let i=new Fw(e,t,++this._order);return this._entries.push(i),this._resolved=null,te(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let e=this._resolve();e&&(this._resolved=new dg(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(Fw.cmp),YU(this._entries.map(e=>e.configuration)))}};function YU(r){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let t of r)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}var Fw=class{constructor(e,t,i){this.configuration=e;this.priority=t;this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}},Bw=class{constructor(e){this.languageId=e}},SM=class extends P{_entries=new Map;_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(xr,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let n=this._entries.get(e);n||(n=new CM(e),this._entries.set(e,n));let o=n.register(t,i);return this._onDidChange.fire(new Bw(e)),te(()=>{o.dispose(),this._onDidChange.fire(new Bw(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}},dg=class r{constructor(e,t){this.languageId=e;this.underlyingConfig=t;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Nw(this.underlyingConfig):null,this.comments=r._handleComments(this.underlyingConfig),this.characterPair=new Aw(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||iw,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new Pw(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new Dw(e,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return hy(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new Tw(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new Mw(this.brackets)),this._electricCharacter}onEnter(e,t,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,n):null}getAutoClosingPairs(){return new xw(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){let t=e.comments;if(!t)return null;let i={};if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){let[n,o]=t.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=o}return i}};an(zd,xy,1);var EM=class r{constructor(e){this.map=e}static createFromLanguage(e,t){function i(o){return t.getKey(`${o.languageId}:::${o.bracketText}`)}let n=new Map;for(let o of e.bracketsNew.openingBrackets){let s=yi(0,o.bracketText.length),a=i(o),l=bo.getEmpty().add(a,bM);n.set(o.bracketText,new Ma(s,1,a,l,_y.create(s,o,l)))}for(let o of e.bracketsNew.closingBrackets){let s=yi(0,o.bracketText.length),a=bo.getEmpty(),l=o.getOpeningBrackets();for(let d of l)a=a.add(i(d),bM);n.set(o.bracketText,new Ma(s,2,i(l[0]),a,_y.create(s,o,a)))}return new r(n)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>M$(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(let[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}};function M$(r){let e=or(r);return/^[\w ]+/.test(r)&&(e=`\\b${e}`),/[\w ]+$/.test(r)&&(e=`${e}\\b`),e}var Ww=class{constructor(e,t){this.denseKeyProvider=e;this.getLanguageConfiguration=t}languageIdToBracketTokens=new Map;didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=EM.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}getToken(e,t){return this.getSingleLanguageBracketTokens(t).getToken(e)}};var Ma=class{constructor(e,t,i,n,o){this.length=e;this.kind=t;this.bracketId=i;this.bracketIds=n;this.astNode=o}},Hw=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new wM(this.textModel,this.bracketTokens);_offset=Fn;get offset(){return this._offset}get length(){return yi(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(e){this.didPeek=!1,this._offset=ci(this._offset,e);let t=qo(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}didPeek=!1;peeked=null;read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=ci(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},wM=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let o=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=o.length,o}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let e=this.lineIdx,t=this.lineCharOffset,i=0;for(;;){let o=this.lineTokens,s=o.getCount(),a=null;if(this.lineTokenOffset<s){let l=o.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===o.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=Xr.getTokenType(l)===0,c=Xr.containsBalancedBrackets(l),u=o.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<u){let p=o.getLanguageId(this.lineTokenOffset),m=this.line.substring(this.lineCharOffset,u),f=this.bracketTokens.getSingleLanguageBracketTokens(p),g=f.regExpGlobal;if(g){g.lastIndex=0;let b=g.exec(m);b&&(a=f.getToken(b[0]),a&&(this.lineCharOffset+=b.index))}}if(i+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}let n=UU(e,t,this.lineIdx,this.lineCharOffset);return new Ma(n,0,-1,bo.getEmpty(),new Oa(n))}},Uw=class{constructor(e,t){this.text=e;let i=t.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,o=[],s,a=0,l=0,d=0,c=0,u=[];for(let f=0;f<60;f++)u.push(new Ma(yi(0,f),0,-1,bo.getEmpty(),new Oa(yi(0,f))));let p=[];for(let f=0;f<60;f++)p.push(new Ma(yi(1,f),0,-1,bo.getEmpty(),new Oa(yi(1,f))));if(n)for(n.lastIndex=0;(s=n.exec(e))!==null;){let f=s.index,g=s[0];if(g===`
`)a++,l=f+1;else{if(d!==f){let b;if(c===a){let v=f-d;if(v<u.length)b=u[v];else{let I=yi(0,v);b=new Ma(I,0,-1,bo.getEmpty(),new Oa(I))}}else{let v=a-c,I=f-l;if(v===1&&I<p.length)b=p[I];else{let w=yi(v,I);b=new Ma(w,0,-1,bo.getEmpty(),new Oa(w))}}o.push(b)}o.push(t.getToken(g)),d=f+g.length,c=a}}let m=e.length;if(d!==m){let f=c===a?yi(0,m-d):yi(a-c,m-l);o.push(new Ma(f,0,-1,bo.getEmpty(),new Oa(f)))}this.length=yi(a,m-l),this.tokens=o}_offset=Fn;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new aS}getText(){return this.text}};var Dy=class{_length;get length(){return this._length}constructor(e){this._length=e}},Ly=class r extends Dy{constructor(t,i,n,o,s){super(t);this.openingBracket=i;this.child=n;this.closingBracket=o;this.missingOpeningBracketIds=s}static create(t,i,n){let o=t.length;return i&&(o=ci(o,i.length)),n&&(o=ci(o,n.length)),new r(o,t,i,n,i?i.missingOpeningBracketIds:bo.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}canBeReused(t){return!(this.closingBracket===null||t.intersects(this.missingOpeningBracketIds))}flattenLists(){return r.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new r(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,i){return this.child?this.child.computeMinIndentation(ci(t,this.openingBracket.length),i):Number.MAX_SAFE_INTEGER}},es=class r extends Dy{constructor(t,i,n){super(t);this.listHeight=i;this._missingOpeningBracketIds=n}static create23(t,i,n,o=!1){let s=t.length,a=t.missingOpeningBracketIds;if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");if(s=ci(s,i.length),a=a.merge(i.missingOpeningBracketIds),n){if(t.listHeight!==n.listHeight)throw new Error("Invalid list heights");s=ci(s,n.length),a=a.merge(n.missingOpeningBracketIds)}return o?new xM(s,t.listHeight+1,t,i,n,a):new ky(s,t.listHeight+1,t,i,n,a)}static create(t,i=!1){if(t.length===0)return this.getEmpty();{let n=t[0].length,o=t[0].missingOpeningBracketIds;for(let s=1;s<t.length;s++)n=ci(n,t[s].length),o=o.merge(t[s].missingOpeningBracketIds);return i?new zw(n,t[0].listHeight+1,t,o):new Ry(n,t[0].listHeight+1,t,o)}}static getEmpty(){return new zw(Fn,0,[],bo.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let t=this.childrenLength;if(t===0)return;let i=this.getChild(t-1),n=i.kind===4?i.toMutable():i;return i!==n&&this.setChild(t-1,n),n}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let i=this.getChild(0),n=i.kind===4?i.toMutable():i;return i!==n&&this.setChild(0,n),n}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let i=this;for(;i.kind===4;){let n=i.childrenLength;if(n===0)throw new Je;i=i.getChild(n-1)}return i.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();let t=this.childrenLength,i=this.getChild(0).length,n=this.getChild(0).missingOpeningBracketIds;for(let o=1;o<t;o++){let s=this.getChild(o);i=ci(i,s.length),n=n.merge(s.missingOpeningBracketIds)}this._length=i,this._missingOpeningBracketIds=n,this.cachedMinIndentation=-1}flattenLists(){let t=[];for(let i of this.children){let n=i.flattenLists();n.kind===4?t.push(...n.children):t.push(n)}return r.create(t)}computeMinIndentation(t,i){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let n=Number.MAX_SAFE_INTEGER,o=t;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(n=Math.min(n,a.computeMinIndentation(o,i)),o=ci(o,a.length))}return this.cachedMinIndentation=n,n}},ky=class r extends es{constructor(t,i,n,o,s,a){super(t,i,a);this._item1=n;this._item2=o;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,i){switch(t){case 0:this._item1=i;return;case 1:this._item2=i;return;case 2:this._item3=i;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new r(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}},xM=class extends ky{toMutable(){return new ky(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},Ry=class r extends es{constructor(t,i,n,o){super(t,i,o);this._children=n}get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,i){this._children[t]=i}get children(){return this._children}deepClone(){let t=new Array(this._children.length);for(let i=0;i<this._children.length;i++)t[i]=this._children[i].deepClone();return new r(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}},zw=class extends Ry{toMutable(){return new Ry(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},P$=[],Ay=class extends Dy{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return P$}flattenLists(){return this}deepClone(){return this}},Oa=class extends Ay{get kind(){return 0}get missingOpeningBracketIds(){return bo.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){let i=qo(e),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,o=zU(ci(e,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=n;a<=o;a++){let l=t.getLineFirstNonWhitespaceColumn(a),d=t.getLineContent(a);if(l===0)continue;let c=oi.visibleColumnFromColumn(d,l,t.getOptions().tabSize);s=Math.min(s,c)}return s}},_y=class r extends Ay{constructor(t,i,n){super(t);this.bracketInfo=i;this.bracketIds=n}static create(t,i,n){return new r(t,i,n)}get kind(){return 1}get missingOpeningBracketIds(){return bo.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,i){return Number.MAX_SAFE_INTEGER}},Kw=class extends Ay{get kind(){return 3}missingOpeningBracketIds;constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}};var My=class{constructor(e,t,i,n){this.range=e;this.nestingLevel=t;this.nestingLevelOfEqualBracketType=i;this.isInvalid=n}},TM=class{constructor(e,t,i,n,o,s){this.range=e;this.openingBracketRange=t;this.closingBracketRange=i;this.nestingLevel=n;this.nestingLevelOfEqualBracketType=o;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},Gw=class extends TM{constructor(t,i,n,o,s,a,l){super(t,i,n,o,s,a);this.minVisibleColumnIndentation=l}};var jw=class{changeType=1},Tr=class r{constructor(e,t,i,n,o){this.ownerId=e;this.lineNumber=t;this.column=i;this.options=n;this.order=o}static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",n=0;for(let o of t)i+=e.substring(n,o.column-1),n=o.column-1,i+=o.options.content;return i+=e.substring(n),i}static fromDecorations(e){let t=[];for(let i of e)i.options.before&&i.options.before.content.length>0&&t.push(new r(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new r(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),t}withText(e){return new r(this.ownerId,this.lineNumber,this.column,{...this.options,content:e},this.order)}},Oy=class{changeType=2;lineNumber;detail;injectedText;constructor(e,t,i){this.lineNumber=e,this.detail=t,this.injectedText=i}},qw=class{changeType=3;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},$w=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(e,t,i,n){this.injectedTexts=n,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}},Yw=class{changeType=5},$p=class r{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){let i=[].concat(e.changes).concat(t.changes),n=t.versionId,o=e.isUndoing||t.isUndoing,s=e.isRedoing||t.isRedoing;return new r(i,n,o,s)}},cg=class{changes;constructor(e){this.changes=e}},du=class r{constructor(e,t){this.rawContentChangedEvent=e;this.contentChangedEvent=t}merge(e){let t=$p.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=r._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new r(t,i)}static _mergeChangeEvents(e,t){let i=[].concat(e.changes).concat(t.changes),n=t.eol,o=t.versionId,s=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,d=e.isEolChange&&t.isEolChange;return{changes:i,eol:n,isEolChange:d,versionId:o,isUndoing:s,isRedoing:a,isFlush:l}}};var Js=class{constructor(e,t,i,n,o,s){this.visibleColumn=e;this.column=t;this.className=i;this.horizontalLine=n;this.forWrappedLinesAfterColumn=o;this.forWrappedLinesBeforeOrAtColumn=s;if(e!==-1==(t!==-1))throw new Error}},Kd=class{constructor(e,t){this.top=e;this.endColumn=t}};var Zw=class r{constructor(e){this.edits=e;let t=-1;for(let i of e){if(!(i.replaceRange.start>=t))throw new Je(`Edits must be disjoint and sorted. Found ${i} after ${t}`);t=i.replaceRange.endExclusive}}static empty=new r([]);static fromJson(e){return new r(e.map(Pa.fromJson))}static replace(e,t){return new r([new Pa(e,t)])}static insert(e,t){return r.replace(Be.emptyAt(e),t)}normalize(){let e=[],t;for(let i of this.edits)i.newText.length===0&&i.replaceRange.length===0||(t&&t.replaceRange.endExclusive===i.replaceRange.start?t=new Pa(t.replaceRange.join(i.replaceRange),t.newText+i.newText):(t&&e.push(t),t=i));return t&&e.push(t),new r(e)}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],i=0;for(let n of this.edits)t.push(e.substring(i,n.replaceRange.start)),t.push(n.newText),i=n.replaceRange.endExclusive;return t.push(e.substring(i)),t.join("")}compose(e){return F$(this,e)}inverse(e){let t=[],i=0;for(let n of this.edits)t.push(new Pa(Be.ofStartAndLength(n.replaceRange.start+i,n.newText.length),e.substring(n.replaceRange.start,n.replaceRange.endExclusive))),i+=n.newText.length-n.replaceRange.length;return new r(t)}getNewTextRanges(){let e=[],t=0;for(let i of this.edits)e.push(Be.ofStartAndLength(i.replaceRange.start+t,i.newText.length)),t+=i.newText.length-i.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],i=0,n=0,o=0;for(;n<this.edits.length||i<e.edits.length;){let s=e.edits[i],a=this.edits[n];if(a)s?a.replaceRange.intersects(s.replaceRange)?n++:a.replaceRange.start<s.replaceRange.start?(t.push(new Pa(a.replaceRange.delta(o),a.newText)),n++):(i++,o+=s.newText.length-s.replaceRange.length):(t.push(new Pa(a.replaceRange.delta(o),a.newText)),n++);else break}return new r(t)}applyToOffset(e){let t=0;for(let i of this.edits)if(i.replaceRange.start<=e){if(e<i.replaceRange.endExclusive)return i.replaceRange.start+t;t+=i.newText.length-i.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new Be(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let t=0;for(let i of this.edits){let n=i.newText.length;if(i.replaceRange.start<=e-t){if(e-t<i.replaceRange.start+n)return i.replaceRange.start;t+=n-i.replaceRange.length}else break}return e-t}},Pa=class r{constructor(e,t){this.replaceRange=e;this.newText=t}static fromJson(e){return new r(Be.ofStartAndLength(e.pos,e.len),e.txt)}static insert(e,t){return new r(Be.emptyAt(e),t)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function F$(r,e){if(r=r.normalize(),e=e.normalize(),r.isEmpty)return e;if(e.isEmpty)return r;let t=[...r.edits],i=[],n=0;for(let o of e.edits){for(;;){let d=t[0];if(!d||d.replaceRange.start+n+d.newText.length>=o.replaceRange.start)break;t.shift(),i.push(d),n+=d.newText.length-d.replaceRange.length}let s=n,a,l;for(;;){let d=t[0];if(!d||d.replaceRange.start+n>o.replaceRange.endExclusive)break;a||(a=d),l=d,t.shift(),n+=d.newText.length-d.replaceRange.length}if(!a)i.push(new Pa(o.replaceRange.delta(-n),o.newText));else{let d="",c=o.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let u=l.replaceRange.endExclusive+n-o.replaceRange.endExclusive;if(u>0){let f=new Pa(Be.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-u));t.unshift(f),n-=f.newText.length-f.replaceRange.length}let p=d+o.newText,m=new Be(Math.min(a.replaceRange.start,o.replaceRange.start-s),o.replaceRange.endExclusive-n);i.push(new Pa(m,p))}}for(;;){let o=t.shift();if(!o)break;i.push(o)}return new Zw(i).normalize()}var QU=Z("undoRedoService");var ZU=class r{static _ID=0;id;order;constructor(){this.id=r._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new r},XU=class r{static _ID=0;id;order;constructor(){this.id=r._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new r};var ug=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&fi(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}},cu=class{_findMatchBrand=void 0;range;matches;constructor(e,t){this.range=e,this.matches=t}};function JU(r){return r&&typeof r.read=="function"}var pg=class{constructor(e,t,i,n,o,s){this.identifier=e;this.range=t;this.text=i;this.forceMoveMarkers=n;this.isAutoWhitespaceEdit=o;this._isTracked=s}},Xw=class{regex;wordSeparators;simpleSearch;constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}},Qw=class{constructor(e,t,i){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=i}};var Py={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};function DM(r){let e=r;return typeof e?.resolve=="function"&&typeof e?.isResolved=="function"}var Lt=Z("fileService");function ez(r){return!!(r.capabilities&2048)}var hg=class r extends Error{constructor(t,i){super(t);this.code=i}static create(t,i){let n=new r(t.toString(),i);return V$(n,i),n}};function LM(r,e){return hg.create(r,e)}function V$(r,e){return r.name=e?`${e} (FileSystemError)`:"FileSystemError",r}function W$(r){if(!r)return"Unknown";if(r instanceof hg)return r.code;let e=/^(.+) \(FileSystemError\)$/.exec(r.name);if(!e)return"Unknown";switch(e[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function tz(r){if(r instanceof mg)return r.fileOperationResult;switch(W$(r)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var mg=class extends Error{constructor(t,i,n){super(t);this.fileOperationResult=i;this.options=n}},Jw=class extends mg{constructor(t,i,n,o){super(t,i,o);this.fileOperationResult=i;this.size=n}},ex=class extends mg{constructor(t,i,n){super(t,2,n);this.stat=i}};var Na={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},gg={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"},iz="files.associations";var nz="files.readonlyInclude",oz="files.readonlyExclude";var Yp=(i=>(i[i.FILE=0]="FILE",i[i.FOLDER=1]="FOLDER",i[i.ROOT_FOLDER=2]="ROOT_FOLDER",i))(Yp||{}),Ny="";var Xn=class r{static KB=1024;static MB=r.KB*r.KB;static GB=r.MB*r.KB;static TB=r.GB*r.KB;static formatSize(e){return so(e)||(e=0),e<r.KB?h("sizeB","{0}B",e.toFixed(0)):e<r.MB?h("sizeKB","{0}KB",(e/r.KB).toFixed(2)):e<r.GB?h("sizeMB","{0}MB",(e/r.MB).toFixed(2)):e<r.TB?h("sizeGB","{0}GB",(e/r.GB).toFixed(2)):h("sizeTB","{0}TB",(e/r.TB).toFixed(2))}};var tx=Z("textModelService");var rz="";var uu=class extends P{_onWillDispose=this._register(new _);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var Qn=Z("modelService");var ix=Z("ILanguageDetectionService"),kM="languageDetection";var Fa=class extends uu{constructor(t,i,n,o,s){super();this.modelService=t;this.languageService=i;this.languageDetectionService=n;this.accessibilityService=o;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new xt);autoDetectLanguageThrottler=this._register(new Dv(Fa.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(t){let i=this.modelService.getModel(t);if(!i)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.textEditorModelHandle=t,this.registerModelDisposeListener(i)}registerModelDisposeListener(t){this.modelDisposeListener.value=t.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(t,i){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(t,i)}setLanguageIdInternal(t,i){this.isResolved()&&(!t||t===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(t),i))}installModelListeners(t){let i=this._register(t.onDidChangeLanguage(n=>{n.source!==kM&&(this._hasLanguageSetExplicitly=!0,i.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??xr))return;let t=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),i=this.getLanguageId();if(t&&t!==i&&!this.isDisposed()){this.setLanguageIdInternal(t,kM);let n=this.languageService.getLanguageName(t);this.accessibilityService.alert(h("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",n??t))}}createTextEditorModel(t,i,n){let o=this.getFirstLineText(t),s=this.getOrCreateLanguage(i,this.languageService,n,o);return this.doCreateTextEditorModel(t,s,i)}doCreateTextEditorModel(t,i,n){let o=n&&this.modelService.getModel(n);return o?this.updateTextEditorModel(t,i.languageId):(o=this.modelService.createModel(t,i,n),this.createdEditorModel=!0,this.registerModelDisposeListener(o)),this.textEditorModelHandle=o.uri,o}getFirstLineText(t){let i=t;return typeof i.getFirstLineText=="function"?i.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(t,i,n,o){return!n||n===xr?i.createByFilepathOrFirstLine(t??null,o):i.createById(n)}updateTextEditorModel(t,i){this.isResolved()&&(t&&this.modelService.updateModel(this.textEditorModel,t),i&&i!==xr&&this.textEditorModel.getLanguageId()!==i&&this.textEditorModel.setLanguage(this.languageService.createById(i)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};Fa=R([y(0,Qn),y(1,Ki),y(2,ix),y(3,dr)],Fa);var nx=Z("workingCopyBackupService");var _r=Z("textResourceConfigurationService"),$ke=Z("textResourcePropertiesService");function H$(r,e,t){let i=0;for(let o=0;o<r.length;o++)r.charAt(o)==="	"?i=oi.nextIndentTabStop(i,e):i++;let n="";if(!t){let o=Math.floor(i/e);i=i%e;for(let s=0;s<o;s++)n+="	"}for(let o=0;o<i;o++)n+=" ";return n}function ox(r,e,t){let i=qi(r);return i===-1&&(i=r.length),H$(r.substring(0,i),e,t)+r.substring(i)}var ea=class r{constructor(e,t,i){this.startOffset=e;this.endOffset=t;this.newLength=i}static fromModelContentChanges(e){return e.map(i=>{let n=O.lift(i.range);return new r(au(n.getStartPosition()),au(n.getEndPosition()),GU(i.text))}).reverse()}toString(){return`[${qo(this.startOffset)}...${qo(this.endOffset)}) -> ${qo(this.newLength)}`}},rx=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(e){this.edits=e.map(t=>RM.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);let t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:qp(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?yi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):yi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){let t=qo(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?yi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):yi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){let t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(su(i,e)){this.nextEditIdx++;let n=qo(i),o=qo(this.translateOldToCur(t.endOffsetBeforeObj)),s=n.lineCount-o.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-o.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}},RM=class r{static from(e){return new r(e.startOffset,e.endOffset,e.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(e,t,i){this.endOffsetBeforeObj=qo(t),this.endOffsetAfterObj=qo(ci(e,i)),this.offsetObj=qo(e)}};function lz(r){if(r.length===0)return null;if(r.length===1)return r[0];let e=0;function t(){if(e>=r.length)return null;let s=e,a=r[s].listHeight;for(e++;e<r.length&&r[e].listHeight===a;)e++;return e-s>=2?MM(s===0&&e===r.length?r:r.slice(s,e),!1):r[s]}let i=t(),n=t();if(!n)return i;for(let s=t();s;s=t())sz(i,n)<=sz(n,s)?(i=AM(i,n),n=s):n=AM(n,s);return AM(i,n)}function MM(r,e=!1){if(r.length===0)return null;if(r.length===1)return r[0];let t=r.length;for(;t>3;){let i=t>>1;for(let n=0;n<i;n++){let o=n<<1;r[n]=es.create23(r[o],r[o+1],o+3===t?r[o+2]:null,e)}t=i}return es.create23(r[0],r[1],t>=3?r[2]:null,e)}function sz(r,e){return Math.abs(r.listHeight-e.listHeight)}function AM(r,e){return r.listHeight===e.listHeight?es.create23(r,e,null,!1):r.listHeight>e.listHeight?U$(r,e):z$(e,r)}function U$(r,e){r=r.toMutable();let t=r,i=[],n;for(;;){if(e.listHeight===t.listHeight){n=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let o=i.length-1;o>=0;o--){let s=i[o];n?s.childrenLength>=3?n=es.create23(s.unappendChild(),n,null,!1):(s.appendChildOfSameHeight(n),n=void 0):s.handleChildrenChanged()}return n?es.create23(r,n,null,!1):r}function z$(r,e){r=r.toMutable();let t=r,i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let n=e;for(let o=i.length-1;o>=0;o--){let s=i[o];n?s.childrenLength>=3?n=es.create23(n,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(n),n=void 0):s.handleChildrenChanged()}return n?es.create23(n,r,null,!1):r}var sx=class{nextNodes;offsets;idxs;lastOffset=Fn;constructor(e){this.nextNodes=[e],this.offsets=[Fn],this.idxs=[]}readLongestNodeAt(e,t){if(Ud(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){let i=Fy(this.nextNodes);if(!i)return;let n=Fy(this.offsets);if(Ud(e,n))return;if(Ud(n,e))if(ci(n,i.length)<=e)this.nextNodeAfterCurrent();else{let o=OM(i);o!==-1?(this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{let o=OM(i);if(o===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)}}}}nextNodeAfterCurrent(){for(;;){let e=Fy(this.offsets),t=Fy(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let i=Fy(this.nextNodes),n=OM(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(ci(e,t.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}};function OM(r,e=-1){for(;;){if(e++,e>=r.childrenLength)return-1;if(r.getChild(e))return e}}function Fy(r){return r.length>0?r[r.length-1]:void 0}function NM(r,e,t,i){return new PM(r,e,t,i).parseDocument()}var PM=class{constructor(e,t,i,n){this.tokenizer=e;this.createImmutableLists=n;if(i&&n)throw new Error("Not supported");this.oldNodeReader=i?new sx(i):void 0,this.positionMapper=new rx(t)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(bo.getEmpty(),0);return e||(e=es.getEmpty()),e}parseList(e,t){let i=[];for(;;){let o=this.tryReadChildFromCache(e);if(!o){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(e))break;o=this.parseChild(e,t+1)}o.kind===4&&o.childrenLength===0||i.push(o)}return this.oldNodeReader?lz(i):MM(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){let t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!ag(t)){let i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>t!==null&&!Ud(n.length,t)?!1:n.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;let i=this.tokenizer.read();switch(i.kind){case 2:return new Kw(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new Oa(i.length);let n=e.merge(i.bracketIds),o=this.parseList(n,t+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===i.bracketId||s.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),Ly.create(i.astNode,o,s.astNode)):Ly.create(i.astNode,o,null)}default:throw new Error("unexpected")}}};function fg(r,e){if(r.length===0)return e;if(e.length===0)return r;let t=new Do(dz(r)),i=dz(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=t.dequeue();function o(d){if(d===void 0){let u=t.takeWhile(p=>!0)||[];return n&&u.unshift(n),u}let c=[];for(;n&&!ag(d);){let[u,p]=n.splitAt(d);c.push(u),d=qp(u.lengthAfter,d),n=p??t.dequeue()}return ag(d)||c.push(new By(!1,d,d)),c}let s=[];function a(d,c,u){if(s.length>0&&fM(s[s.length-1].endOffset,d)){let p=s[s.length-1];s[s.length-1]=new ea(p.startOffset,c,ci(p.newLength,u))}else s.push({startOffset:d,endOffset:c,newLength:u})}let l=Fn;for(let d of i){let c=o(d.lengthBefore);if(d.modified){let u=KU(c,m=>m.lengthBefore),p=ci(l,u);a(l,p,d.lengthAfter),l=p}else for(let u of c){let p=l;l=ci(l,u.lengthBefore),u.modified&&a(p,l,u.lengthAfter)}}return s}var By=class r{constructor(e,t,i){this.modified=e;this.lengthBefore=t;this.lengthAfter=i}splitAt(e){let t=qp(e,this.lengthAfter);return fM(t,Fn)?[this,void 0]:this.modified?[new r(this.modified,this.lengthBefore,e),new r(this.modified,Fn,t)]:[new r(this.modified,e,e),new r(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${qo(this.lengthBefore)} -> ${qo(this.lengthAfter)}`}};function dz(r){let e=[],t=Fn;for(let i of r){let n=qp(t,i.startOffset);ag(n)||e.push(new By(!1,n,n));let o=qp(i.startOffset,i.endOffset);e.push(new By(!0,o,i.newLength)),t=i.endOffset}return e}var ax=class extends P{constructor(t,i){super();this.textModel=t;this.getLanguageConfiguration=i;if(t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let n=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),o=new Uw(this.textModel.getValue(),n);this.initialAstWithoutTokens=NM(o,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new _;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new Rw;brackets=new Ww(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(t){return this.brackets.didLanguageChange(t)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){let i=t.map(n=>new ea(yi(n.fromLineNumber-1,0),yi(n.toLineNumber,0),yi(n.toLineNumber-n.fromLineNumber+1,0)));this.handleEdits(i,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){let i=ea.fromModelContentChanges(t.changes);this.handleEdits(i,!1)}handleEdits(t,i){let n=fg(this.queuedTextEdits,t);this.queuedTextEdits=n,this.initialAstWithoutTokens&&!i&&(this.queuedTextEditsForInitialAstWithoutTokens=fg(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,i,n){let s=i,a=new Hw(this.textModel,this.brackets);return NM(a,t,s,n)}getBracketsInRange(t,i){this.flushQueue();let n=yi(t.startLineNumber-1,t.startColumn-1),o=yi(t.endLineNumber-1,t.endColumn-1);return new Sd(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;FM(a,Fn,a.length,n,o,s,0,0,new Map,i)})}getBracketPairsInRange(t,i){this.flushQueue();let n=au(t.getStartPosition()),o=au(t.getEndPosition());return new Sd(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new BM(s,i,this.textModel);VM(a,Fn,a.length,n,o,l,0,new Map)})}getFirstBracketAfter(t){this.flushQueue();let i=this.initialAstWithoutTokens||this.astWithTokens;return uz(i,Fn,i.length,au(t))}getFirstBracketBefore(t){this.flushQueue();let i=this.initialAstWithoutTokens||this.astWithTokens;return cz(i,Fn,i.length,au(t))}};function cz(r,e,t,i){if(r.kind===4||r.kind===2){let n=[];for(let o of r.children)t=ci(e,o.length),n.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let o=n.length-1;o>=0;o--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=n[o];if(Ud(s,i)){let l=cz(r.children[o],s,a,i);if(l)return l}}return null}else{if(r.kind===3)return null;if(r.kind===1){let n=lu(e,t);return{bracketInfo:r.bracketInfo,range:n}}}return null}function uz(r,e,t,i){if(r.kind===4||r.kind===2){for(let n of r.children){if(t=ci(e,n.length),Ud(i,t)){let o=uz(n,e,t,i);if(o)return o}e=t}return null}else{if(r.kind===3)return null;if(r.kind===1){let n=lu(e,t);return{bracketInfo:r.bracketInfo,range:n}}}return null}function FM(r,e,t,i,n,o,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(r.kind){case 4:{let u=r.childrenLength;for(let p=0;p<u;p++){let m=r.getChild(p);if(m){if(t=ci(e,m.length),su(e,n)&&lg(t,i)){if(lg(t,n)){r=m;continue e}if(!FM(m,e,t,i,n,o,s,0,l,d))return!1}e=t}}return!0}case 2:{let u=!d||!r.closingBracket||r.closingBracket.bracketInfo.closesColorized(r.openingBracket.bracketInfo),p=0;if(l){let f=l.get(r.openingBracket.text);f===void 0&&(f=0),p=f,u&&(f++,l.set(r.openingBracket.text,f))}let m=r.childrenLength;for(let f=0;f<m;f++){let g=r.getChild(f);if(g){if(t=ci(e,g.length),su(e,n)&&lg(t,i)){if(lg(t,n)&&g.kind!==1){r=g,u?(s++,a=p+1):a=p;continue e}if((u||g.kind!==1||!r.closingBracket)&&!FM(g,e,t,i,n,o,u?s+1:s,u?p+1:p,l,d,!r.closingBracket))return!1}e=t}}return l?.set(r.openingBracket.text,p),!0}case 3:{let u=lu(e,t);return o(new My(u,s-1,0,!0))}case 1:{let u=lu(e,t);return o(new My(u,s-1,a-1,c))}case 0:return!0}}var BM=class{constructor(e,t,i){this.push=e;this.includeMinIndentation=t;this.textModel=i}};function VM(r,e,t,i,n,o,s,a){if(s>200)return!0;let l=!0;if(r.kind===2){let d=0;if(a){let p=a.get(r.openingBracket.text);p===void 0&&(p=0),d=p,p++,a.set(r.openingBracket.text,p)}let c=ci(e,r.openingBracket.length),u=-1;if(o.includeMinIndentation&&(u=r.computeMinIndentation(e,o.textModel)),l=o.push(new Gw(lu(e,t),lu(e,c),r.closingBracket?lu(ci(c,r.child?.length||Fn),t):void 0,s,d,r,u)),e=c,l&&r.child){let p=r.child;if(t=ci(e,p.length),su(e,n)&&lg(t,i)&&(l=VM(p,e,t,i,n,o,s+1,a),!l))return!1}a?.set(r.openingBracket.text,d)}else{let d=e;for(let c of r.children){let u=d;if(d=ci(d,c.length),su(u,n)&&su(i,d)&&(l=VM(c,u,d,i,n,o,s,a),!l))return!1}}return l}var dx=class extends P{constructor(t,i){super();this.textModel=t;this.languageConfigurationService=i}bracketPairsTree=this._register(new xt);onDidChangeEmitter=new _;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(t){(!t.languageId||this.bracketPairsTree.value?.object.didLanguageChange(t.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){this.bracketPairsTree.value?.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){this.bracketPairsTree.value?.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let t=new Y;this.bracketPairsTree.value=K$(t.add(new ax(this.textModel,i=>this.languageConfigurationService.getLanguageConfiguration(i))),t),t.add(this.bracketPairsTree.value.object.onDidChange(i=>this.onDidChangeEmitter.fire(i))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!1)||Sd.empty}getBracketPairsInRangeWithMinIndentation(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!0)||Sd.empty}getBracketsInRange(t,i=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(t,i)||Sd.empty}findMatchingBracketUp(t,i,n){let o=this.textModel.validatePosition(i),s=this.textModel.getLanguageIdAtPosition(o.lineNumber,o.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(t);if(!a)return null;let l=this.getBracketPairsInRange(O.fromPositions(i,i)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=t.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?lx(this._findMatchingBracketUp(d,o,HM(n))):null}}matchBracket(t,i){if(this.canBuildAST){let n=this.getBracketPairsInRange(O.fromPositions(t,t)).filter(o=>o.closingBracketRange!==void 0&&(o.openingBracketRange.containsPosition(t)||o.closingBracketRange.containsPosition(t))).findLastMaxBy(ir(o=>o.openingBracketRange.containsPosition(t)?o.openingBracketRange:o.closingBracketRange,O.compareRangesUsingStarts));return n?[n.openingBracketRange,n.closingBracketRange]:null}else{let n=HM(i);return this._matchBracket(this.textModel.validatePosition(t),n)}}_establishBracketSearchOffsets(t,i,n,o){let s=i.getCount(),a=i.getLanguageId(o),l=Math.max(0,t.column-1-n.maxBracketLength);for(let c=o-1;c>=0;c--){let u=i.getEndOffset(c);if(u<=l)break;if(Qs(i.getStandardTokenType(c))||i.getLanguageId(c)!==a){l=u;break}}let d=Math.min(i.getLineContent().length,t.column-1+n.maxBracketLength);for(let c=o+1;c<s;c++){let u=i.getStartOffset(c);if(u>=d)break;if(Qs(i.getStandardTokenType(c))||i.getLanguageId(c)!==a){d=u;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(t,i){let n=t.lineNumber,o=this.textModel.tokenization.getLineTokens(n),s=this.textModel.getLineContent(n),a=o.findTokenIndexAtOffset(t.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId(a)).brackets;if(l&&!Qs(o.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(t,o,l,a),u=null;for(;;){let p=cr.findNextBracketInRange(l.forwardRegex,n,s,d,c);if(!p)break;if(p.startColumn<=t.column&&t.column<=p.endColumn){let m=s.substring(p.startColumn-1,p.endColumn-1).toLowerCase(),f=this._matchFoundBracket(p,l.textIsBracket[m],l.textIsOpenBracket[m],i);if(f){if(f instanceof Gd)return null;u=f}}d=p.endColumn-1}if(u)return u}if(a>0&&o.getStartOffset(a)===t.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId(d)).brackets;if(c&&!Qs(o.getStandardTokenType(d))){let{searchStartOffset:u,searchEndOffset:p}=this._establishBracketSearchOffsets(t,o,c,d),m=cr.findPrevBracketInRange(c.reversedRegex,n,s,u,p);if(m&&m.startColumn<=t.column&&t.column<=m.endColumn){let f=s.substring(m.startColumn-1,m.endColumn-1).toLowerCase(),g=this._matchFoundBracket(m,c.textIsBracket[f],c.textIsOpenBracket[f],i);if(g)return g instanceof Gd?null:g}}}return null}_matchFoundBracket(t,i,n,o){if(!i)return null;let s=n?this._findMatchingBracketDown(i,t.getEndPosition(),o):this._findMatchingBracketUp(i,t.getStartPosition(),o);return s?s instanceof Gd?s:[t,s]:null}_findMatchingBracketUp(t,i,n){let o=t.languageId,s=t.reversedRegex,a=-1,l=0,d=(c,u,p,m)=>{for(;;){if(n&&++l%100===0&&!n())return Gd.INSTANCE;let f=cr.findPrevBracketInRange(s,c,u,p,m);if(!f)break;let g=u.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(t.isOpen(g)?a++:t.isClose(g)&&a--,a===0)return f;m=f.startColumn-1}return null};for(let c=i.lineNumber;c>=1;c--){let u=this.textModel.tokenization.getLineTokens(c),p=u.getCount(),m=this.textModel.getLineContent(c),f=p-1,g=m.length,b=m.length;c===i.lineNumber&&(f=u.findTokenIndexAtOffset(i.column-1),g=i.column-1,b=i.column-1);let v=!0;for(;f>=0;f--){let I=u.getLanguageId(f)===o&&!Qs(u.getStandardTokenType(f));if(I)v?g=u.getStartOffset(f):(g=u.getStartOffset(f),b=u.getEndOffset(f));else if(v&&g!==b){let w=d(c,m,g,b);if(w)return w}v=I}if(v&&g!==b){let I=d(c,m,g,b);if(I)return I}}return null}_findMatchingBracketDown(t,i,n){let o=t.languageId,s=t.forwardRegex,a=1,l=0,d=(u,p,m,f)=>{for(;;){if(n&&++l%100===0&&!n())return Gd.INSTANCE;let g=cr.findNextBracketInRange(s,u,p,m,f);if(!g)break;let b=p.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(t.isOpen(b)?a++:t.isClose(b)&&a--,a===0)return g;m=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=i.lineNumber;u<=c;u++){let p=this.textModel.tokenization.getLineTokens(u),m=p.getCount(),f=this.textModel.getLineContent(u),g=0,b=0,v=0;u===i.lineNumber&&(g=p.findTokenIndexAtOffset(i.column-1),b=i.column-1,v=i.column-1);let I=!0;for(;g<m;g++){let w=p.getLanguageId(g)===o&&!Qs(p.getStandardTokenType(g));if(w)I||(b=p.getStartOffset(g)),v=p.getEndOffset(g);else if(I&&b!==v){let E=d(u,f,b,v);if(E)return E}I=w}if(I&&b!==v){let w=d(u,f,b,v);if(w)return w}}return null}findPrevBracket(t){let i=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(i)||null;let n=null,o=null,s=null;for(let a=i.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),u=d-1,p=c.length,m=c.length;if(a===i.lineNumber){u=l.findTokenIndexAtOffset(i.column-1),p=i.column-1,m=i.column-1;let g=l.getLanguageId(u);n!==g&&(n=g,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,s=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let f=!0;for(;u>=0;u--){let g=l.getLanguageId(u);if(n!==g){if(o&&s&&f&&p!==m){let v=cr.findPrevBracketInRange(o.reversedRegex,a,c,p,m);if(v)return this._toFoundBracket(s,v);f=!1}n=g,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,s=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}let b=!!o&&!Qs(l.getStandardTokenType(u));if(b)f?p=l.getStartOffset(u):(p=l.getStartOffset(u),m=l.getEndOffset(u));else if(s&&o&&f&&p!==m){let v=cr.findPrevBracketInRange(o.reversedRegex,a,c,p,m);if(v)return this._toFoundBracket(s,v)}f=b}if(s&&o&&f&&p!==m){let g=cr.findPrevBracketInRange(o.reversedRegex,a,c,p,m);if(g)return this._toFoundBracket(s,g)}}return null}findNextBracket(t){let i=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(i)||null;let n=this.textModel.getLineCount(),o=null,s=null,a=null;for(let l=i.lineNumber;l<=n;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),u=this.textModel.getLineContent(l),p=0,m=0,f=0;if(l===i.lineNumber){p=d.findTokenIndexAtOffset(i.column-1),m=i.column-1,f=i.column-1;let b=d.getLanguageId(p);o!==b&&(o=b,s=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew)}let g=!0;for(;p<c;p++){let b=d.getLanguageId(p);if(o!==b){if(a&&s&&g&&m!==f){let I=cr.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(I)return this._toFoundBracket(a,I);g=!1}o=b,s=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew}let v=!!s&&!Qs(d.getStandardTokenType(p));if(v)g||(m=d.getStartOffset(p)),f=d.getEndOffset(p);else if(a&&s&&g&&m!==f){let I=cr.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(I)return this._toFoundBracket(a,I)}g=v}if(a&&s&&g&&m!==f){let b=cr.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(b)return this._toFoundBracket(a,b)}}return null}findEnclosingBrackets(t,i){let n=this.textModel.validatePosition(t);if(this.canBuildAST){let f=O.fromPositions(n),g=this.getBracketPairsInRange(O.fromPositions(n,n)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}let o=HM(i),s=this.textModel.getLineCount(),a=new Map,l=[],d=(f,g)=>{if(!a.has(f)){let b=[];for(let v=0,I=g?g.brackets.length:0;v<I;v++)b[v]=0;a.set(f,b)}l=a.get(f)},c=0,u=(f,g,b,v,I)=>{for(;;){if(o&&++c%100===0&&!o())return Gd.INSTANCE;let w=cr.findNextBracketInRange(f.forwardRegex,g,b,v,I);if(!w)break;let E=b.substring(w.startColumn-1,w.endColumn-1).toLowerCase(),S=f.textIsBracket[E];if(S&&(S.isOpen(E)?l[S.index]++:S.isClose(E)&&l[S.index]--,l[S.index]===-1))return this._matchFoundBracket(w,S,!1,o);v=w.endColumn-1}return null},p=null,m=null;for(let f=n.lineNumber;f<=s;f++){let g=this.textModel.tokenization.getLineTokens(f),b=g.getCount(),v=this.textModel.getLineContent(f),I=0,w=0,E=0;if(f===n.lineNumber){I=g.findTokenIndexAtOffset(n.column-1),w=n.column-1,E=n.column-1;let T=g.getLanguageId(I);p!==T&&(p=T,m=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,m))}let S=!0;for(;I<b;I++){let T=g.getLanguageId(I);if(p!==T){if(m&&S&&w!==E){let L=u(m,f,v,w,E);if(L)return lx(L);S=!1}p=T,m=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,m)}let D=!!m&&!Qs(g.getStandardTokenType(I));if(D)S||(w=g.getStartOffset(I)),E=g.getEndOffset(I);else if(m&&S&&w!==E){let L=u(m,f,v,w,E);if(L)return lx(L)}S=D}if(m&&S&&w!==E){let T=u(m,f,v,w,E);if(T)return lx(T)}}return null}_toFoundBracket(t,i){if(!i)return null;let n=this.textModel.getValueInRange(i);n=n.toLowerCase();let o=t.getBracketInfo(n);return o?{range:i,bracketInfo:o}:null}};function K$(r,e){return{object:r,dispose:()=>e?.dispose()}}function HM(r){if(typeof r>"u")return()=>!0;{let e=Date.now();return()=>Date.now()-e<=r}}var Gd=class r{static INSTANCE=new r;_searchCanceledBrand=void 0;constructor(){}};function lx(r){return r instanceof Gd?null:r}var G$={IconContribution:"base.contributions.icons"},j$;(e=>{function r(t,i){let n=t.defaults;for(;Ae.isThemeIcon(n);){let o=bg.getIcon(n.id);if(!o)return;n=o.defaults}return n}e.getDefinition=r})(j$||={});var q$;(t=>{function r(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}t.toJSONObject=r;function e(i){let n=o=>Wi(o)?o:void 0;if(i&&Array.isArray(i.src)&&i.src.every(o=>Wi(o.format)&&Wi(o.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(o=>({format:o.format,location:X.parse(o.location)}))}}t.fromJSONObject=e})(q$||={});var UM=class{_onDidChange=new _;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:h("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${Ae.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){let o=this.iconsById[e];if(o){if(i&&!o.description){o.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;let l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return o}let s={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=s;let a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let i=this.iconFontsById[e];return i||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(o,s)=>o.id.localeCompare(s.id),t=o=>{for(;Ae.isThemeIcon(o.defaults);)o=this.iconsById[o.defaults.id];return`codicon codicon-${o?o.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let n=Object.keys(this.iconsById).map(o=>this.iconsById[o]);for(let o of n.filter(s=>!!s.description).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|${Ae.isThemeIcon(o.defaults)?o.defaults.id:o.id}|${o.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(let o of n.filter(s=>!Ae.isThemeIcon(s.defaults)).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|`);return i.join(`
`)}},bg=new UM;ze.add(G$.IconContribution,bg);function $o(r,e,t,i){return bg.registerIcon(r,e,t,i)}function $$(){let r=d1();for(let e in r){let t="\\"+r[e].toString(16);bg.registerIcon(e,{fontCharacter:t})}}$$();var hz="vscode://schemas/icons",mz=ze.as(Wd.JSONContribution);mz.registerSchema(hz,bg.getIconSchema());var pz=new Kt(()=>mz.notifySchemaChanged(hz),200);bg.onDidChange(()=>{pz.isScheduled()||pz.schedule()});var h1e=$o("widget-close",ie.close,h("widgetClose","Icon for the close action in widgets.")),m1e=$o("goto-previous-location",ie.arrowUp,h("previousChangeIcon","Icon for goto previous editor location.")),g1e=$o("goto-next-location",ie.arrowDown,h("nextChangeIcon","Icon for goto next editor location.")),f1e=Ae.modify(ie.sync,"spin"),b1e=Ae.modify(ie.loading,"spin");function Ba(r){return r==="hcDark"||r==="hcLight"}function zM(r){return r==="dark"||r==="hcDark"}var kt=Z("themeService");var N1e=ie.file,F1e=ie.folder;function Vy(r){switch(r){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var Z$={ThemingContribution:"base.contributions.theming"},KM=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new _}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),te(()=>{let t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},gz=new KM;ze.add(Z$.ThemingContribution,gz);function Fo(r){return gz.onColorThemeChange(r)}var ta=class extends P{constructor(t){super();this.themeService=t;this.theme=t.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(i=>this.onThemeChange(i)))}theme;onThemeChange(t){this.theme=t,this.updateStyles()}updateStyles(){}getColor(t,i){let n=this.theme.getColor(t);return n&&i&&(n=i(n,this.theme)),n?n.toString():null}};function bz(r){return`--vscode-${r.replace(/\./g,"-")}`}function ae(r){return`var(${bz(r)})`}function vz(r,e){return`var(${bz(r)}, ${e})`}function X$(r){return r!==null&&typeof r=="object"&&"light"in r&&"dark"in r}var Q$={ColorContribution:"base.contributions.colors"},J$="default",GM=class{_onDidChangeSchema=new _;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(e){for(let t of Object.keys(this.colorsById)){let i=e.getColor(t);i&&(this.colorSchema.properties[t].oneOf[0].defaultSnippets[0].body=`\${1:${i.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(e,t,i,n=!1,o){let s={id:e,description:i,defaults:t,needsTransparency:n,deprecationMessage:o};this.colorsById[e]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return o&&(a.deprecationMessage=o),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=h("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:i,oneOf:[a,{type:"string",const:J$,description:h("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}deregisterColor(e){delete this.colorsById[e],delete this.colorSchema.properties[e];let t=this.colorReferenceSchema.enum.indexOf(e);t!==-1&&(this.colorReferenceSchema.enum.splice(t,1),this.colorReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let i=this.colorsById[e];if(i?.defaults){let n=X$(i.defaults)?i.defaults[t.type]:i.defaults;return Va(n,t)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let e=(t,i)=>{let n=t.indexOf(".")===-1?0:1,o=i.indexOf(".")===-1?0:1;return n!==o?n-o:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}},cx=new GM;ze.add(Q$.ColorContribution,cx);function x(r,e,t,i,n){return cx.registerColor(r,e,t,i,n)}function eY(r,e){switch(r.op){case 0:return Va(r.value,e)?.darken(r.factor);case 1:return Va(r.value,e)?.lighten(r.factor);case 2:return Va(r.value,e)?.transparent(r.factor);case 3:{let t=Va(r.background,e);return t?Va(r.value,e)?.makeOpaque(t):Va(r.value,e)}case 4:for(let t of r.values){let i=Va(t,e);if(i)return i}return;case 6:return Va(e.defines(r.if)?r.then:r.else,e);case 5:{let t=Va(r.value,e);if(!t)return;let i=Va(r.background,e);return i?t.isDarkerThan(i)?U.getLighterColor(t,i,r.factor).transparent(r.transparency):U.getDarkerColor(t,i,r.factor).transparent(r.transparency):t.transparent(r.factor*r.transparency)}default:throw cv(r)}}function Yo(r,e){return{op:0,value:r,factor:e}}function ur(r,e){return{op:1,value:r,factor:e}}function Ce(r,e){return{op:2,value:r,factor:e}}function jM(...r){return{op:4,values:r}}function yz(r,e,t){return{op:6,if:r,then:e,else:t}}function qM(r,e,t,i){return{op:5,value:r,background:e,factor:t,transparency:i}}function Va(r,e){if(r!==null){if(typeof r=="string")return r[0]==="#"?U.fromHex(r):e.getColor(r);if(r instanceof U)return r;if(typeof r=="object")return eY(r,e)}}var Iz="vscode://schemas/workbench-colors",Cz=ze.as(Wd.JSONContribution);Cz.registerSchema(Iz,cx.getColorSchema());var fz=new Kt(()=>Cz.notifySchemaChanged(Iz),200);cx.onDidChangeSchema(()=>{fz.isScheduled()||fz.schedule()});var Rt=x("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},h("foreground","Overall foreground color. This color is only used if not overridden by a component.")),eAe=x("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},h("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),$M=x("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},h("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),tAe=x("descriptionForeground",{light:"#717171",dark:Ce(Rt,.7),hcDark:Ce(Rt,.7),hcLight:Ce(Rt,.7)},h("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),Wy=x("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},h("iconForeground","The default color for icons in the workbench.")),Zo=x("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},h("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Ie=x("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},h("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),Ft=x("contrastActiveBorder",{light:null,dark:null,hcDark:Zo,hcLight:Zo},h("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),iAe=x("selection.background",null,h("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),ux=x("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},h("textLinkForeground","Foreground color for links in text.")),nAe=x("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},h("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),oAe=x("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:U.black,hcLight:"#292929"},h("textSeparatorForeground","Color for text separators.")),rAe=x("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},h("textPreformatForeground","Foreground color for preformatted text segments.")),sAe=x("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},h("textPreformatBackground","Background color for preformatted text segments.")),aAe=x("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},h("textBlockQuoteBackground","Background color for block quotes in text.")),lAe=x("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:U.white,hcLight:"#292929"},h("textBlockQuoteBorder","Border color for block quotes in text.")),dAe=x("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:U.black,hcLight:"#F2F2F2"},h("textCodeBlockBackground","Background color for code blocks in text."));var mAe=x("sash.hoverBorder",Zo,h("sashActiveBorder","Border color of active sashes.")),Fl=x("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:U.black,hcLight:"#0F4A85"},h("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),vg=x("badge.foreground",{dark:U.white,light:"#333",hcDark:U.white,hcLight:U.white},h("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),pu=x("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},h("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),px=x("scrollbarSlider.background",{dark:U.fromHex("#797979").transparent(.4),light:U.fromHex("#646464").transparent(.4),hcDark:Ce(Ie,.6),hcLight:Ce(Ie,.4)},h("scrollbarSliderBackground","Scrollbar slider background color.")),hx=x("scrollbarSlider.hoverBackground",{dark:U.fromHex("#646464").transparent(.7),light:U.fromHex("#646464").transparent(.7),hcDark:Ce(Ie,.8),hcLight:Ce(Ie,.8)},h("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),mx=x("scrollbarSlider.activeBackground",{dark:U.fromHex("#BFBFBF").transparent(.4),light:U.fromHex("#000000").transparent(.6),hcDark:Ie,hcLight:Ie},h("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),Sz=x("progressBar.background",{dark:U.fromHex("#0E70C0"),light:U.fromHex("#0E70C0"),hcDark:Ie,hcLight:Ie},h("progressBarBackground","Background color of the progress bar that can show for long running operations."));var pr=x("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:U.black,hcLight:U.white},h("editorBackground","Editor background color.")),Dr=x("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:U.white,hcLight:Rt},h("editorForeground","Editor default foreground color.")),IAe=x("editorStickyScroll.background",pr,h("editorStickyScrollBackground","Background color of sticky scroll in the editor")),CAe=x("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:U.fromHex("#0F4A85").transparent(.1)},h("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),SAe=x("editorStickyScroll.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("editorStickyScrollBorder","Border color of sticky scroll in the editor")),EAe=x("editorStickyScroll.shadow",pu,h("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),vo=x("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:U.white},h("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),Bl=x("editorWidget.foreground",Rt,h("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),QM=x("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Ie,hcLight:Ie},h("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),wAe=x("editorWidget.resizeBorder",null,h("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),xAe=x("editorError.background",null,h("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Zp=x("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},h("editorError.foreground","Foreground color of error squigglies in the editor.")),TAe=x("editorError.border",{dark:null,light:null,hcDark:U.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},h("errorBorder","If set, color of double underlines for errors in the editor.")),_z=x("editorWarning.background",null,h("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),hr=x("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},h("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),Sg=x("editorWarning.border",{dark:null,light:null,hcDark:U.fromHex("#FFCC00").transparent(.8),hcLight:U.fromHex("#FFCC00").transparent(.8)},h("warningBorder","If set, color of double underlines for warnings in the editor.")),_Ae=x("editorInfo.background",null,h("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),ts=x("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},h("editorInfo.foreground","Foreground color of info squigglies in the editor.")),Eg=x("editorInfo.border",{dark:null,light:null,hcDark:U.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},h("infoBorder","If set, color of double underlines for infos in the editor.")),Dz=x("editorHint.foreground",{dark:U.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},h("editorHint.foreground","Foreground color of hint squigglies in the editor.")),DAe=x("editorHint.border",{dark:null,light:null,hcDark:U.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},h("hintBorder","If set, color of double underlines for hints in the editor.")),LAe=x("editorLink.activeForeground",{dark:"#4E94CE",light:U.blue,hcDark:U.cyan,hcLight:"#292929"},h("activeLinkForeground","Color of active links.")),yg=x("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},h("editorSelectionBackground","Color of the editor selection.")),Lz=x("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:U.white},h("editorSelectionForeground","Color of the selected text for high contrast.")),kAe=x("editor.inactiveSelectionBackground",{light:Ce(yg,.5),dark:Ce(yg,.5),hcDark:Ce(yg,.7),hcLight:Ce(yg,.5)},h("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),RAe=x("editor.selectionHighlightBackground",{light:qM(yg,pr,.3,.6),dark:qM(yg,pr,.3,.6),hcDark:null,hcLight:null},h("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),AAe=x("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Ft,hcLight:Ft},h("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),MAe=x("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},h("editorFindMatch","Color of the current search match.")),OAe=x("editor.findMatchForeground",null,h("editorFindMatchForeground","Text color of the current search match.")),Wa=x("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},h("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),PAe=x("editor.findMatchHighlightForeground",null,h("findMatchHighlightForeground","Foreground color of the other search matches."),!0),NAe=x("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},h("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),FAe=x("editor.findMatchBorder",{light:null,dark:null,hcDark:Ft,hcLight:Ft},h("editorFindMatchBorder","Border color of the current search match.")),hu=x("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Ft,hcLight:Ft},h("findMatchHighlightBorder","Border color of the other search matches.")),BAe=x("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:Ce(Ft,.4),hcLight:Ce(Ft,.4)},h("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),VAe=x("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},h("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),Ez=x("editorHoverWidget.background",vo,h("hoverBackground","Background color of the editor hover.")),WAe=x("editorHoverWidget.foreground",Bl,h("hoverForeground","Foreground color of the editor hover.")),HAe=x("editorHoverWidget.border",QM,h("hoverBorder","Border color of the editor hover.")),UAe=x("editorHoverWidget.statusBarBackground",{dark:ur(Ez,.2),light:Yo(Ez,.05),hcDark:vo,hcLight:vo},h("statusBarBackground","Background color of the editor hover status bar.")),kz=x("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:U.white,hcLight:U.black},h("editorInlayHintForeground","Foreground color of inline hints")),Rz=x("editorInlayHint.background",{dark:Ce(Fl,.1),light:Ce(Fl,.1),hcDark:Ce(U.white,.1),hcLight:Ce(Fl,.1)},h("editorInlayHintBackground","Background color of inline hints")),zAe=x("editorInlayHint.typeForeground",kz,h("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),KAe=x("editorInlayHint.typeBackground",Rz,h("editorInlayHintBackgroundTypes","Background color of inline hints for types")),GAe=x("editorInlayHint.parameterForeground",kz,h("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),jAe=x("editorInlayHint.parameterBackground",Rz,h("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),tY=x("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},h("editorLightBulbForeground","The color used for the lightbulb actions icon.")),qAe=x("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),$Ae=x("editorLightBulbAi.foreground",tY,h("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),YAe=x("editor.snippetTabstopHighlightBackground",{dark:new U(new lt(124,124,124,.3)),light:new U(new lt(10,50,100,.2)),hcDark:new U(new lt(124,124,124,.3)),hcLight:new U(new lt(10,50,100,.2))},h("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),ZAe=x("editor.snippetTabstopHighlightBorder",null,h("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),XAe=x("editor.snippetFinalTabstopHighlightBackground",null,h("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),QAe=x("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new U(new lt(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},h("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),gx=new U(new lt(155,185,85,.2)),fx=new U(new lt(255,0,0,.2)),Az=x("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},h("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Mz=x("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},h("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),JAe=x("diffEditor.insertedLineBackground",{dark:gx,light:gx,hcDark:null,hcLight:null},h("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),eMe=x("diffEditor.removedLineBackground",{dark:fx,light:fx,hcDark:null,hcLight:null},h("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),tMe=x("diffEditorGutter.insertedLineBackground",null,h("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),iMe=x("diffEditorGutter.removedLineBackground",null,h("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),Oz=x("diffEditorOverview.insertedForeground",null,h("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),Pz=x("diffEditorOverview.removedForeground",null,h("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),nMe=x("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},h("diffEditorInsertedOutline","Outline color for the text that got inserted.")),oMe=x("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},h("diffEditorRemovedOutline","Outline color for text that got removed.")),rMe=x("diffEditor.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("diffEditorBorder","Border color between the two text editors.")),sMe=x("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},h("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),aMe=x("diffEditor.unchangedRegionBackground","sideBar.background",h("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),lMe=x("diffEditor.unchangedRegionForeground","foreground",h("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),dMe=x("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},h("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),mu=x("widget.shadow",{dark:Ce(U.black,.36),light:Ce(U.black,.16),hcDark:null,hcLight:null},h("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Xp=x("widget.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("widgetBorder","Border color of widgets such as find/replace inside the editor.")),Hy=x("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},h("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),cMe=x("toolbar.hoverOutline",{dark:null,light:null,hcDark:Ft,hcLight:Ft},h("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),uMe=x("toolbar.activeBackground",{dark:ur(Hy,.1),light:Yo(Hy,.1),hcDark:null,hcLight:null},h("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),Nz=x("breadcrumb.foreground",Ce(Rt,.8),h("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),Fz=x("breadcrumb.background",pr,h("breadcrumbsBackground","Background color of breadcrumb items.")),JM=x("breadcrumb.focusForeground",{light:Yo(Rt,.2),dark:ur(Rt,.1),hcDark:ur(Rt,.1),hcLight:ur(Rt,.1)},h("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),Bz=x("breadcrumb.activeSelectionForeground",{light:Yo(Rt,.2),dark:ur(Rt,.1),hcDark:ur(Rt,.1),hcLight:ur(Rt,.1)},h("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),eO=x("breadcrumbPicker.background",vo,h("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),Vz=.5,wz=U.fromHex("#40C8AE").transparent(Vz),xz=U.fromHex("#40A6FF").transparent(Vz),Tz=U.fromHex("#606060").transparent(.4),tO=.4,Ig=1,YM=x("merge.currentHeaderBackground",{dark:wz,light:wz,hcDark:null,hcLight:null},h("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),pMe=x("merge.currentContentBackground",Ce(YM,tO),h("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),ZM=x("merge.incomingHeaderBackground",{dark:xz,light:xz,hcDark:null,hcLight:null},h("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),hMe=x("merge.incomingContentBackground",Ce(ZM,tO),h("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),XM=x("merge.commonHeaderBackground",{dark:Tz,light:Tz,hcDark:null,hcLight:null},h("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),mMe=x("merge.commonContentBackground",Ce(XM,tO),h("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),Cg=x("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},h("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),gMe=x("editorOverviewRuler.currentContentForeground",{dark:Ce(YM,Ig),light:Ce(YM,Ig),hcDark:Cg,hcLight:Cg},h("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),fMe=x("editorOverviewRuler.incomingContentForeground",{dark:Ce(ZM,Ig),light:Ce(ZM,Ig),hcDark:Cg,hcLight:Cg},h("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),bMe=x("editorOverviewRuler.commonContentForeground",{dark:Ce(XM,Ig),light:Ce(XM,Ig),hcDark:Cg,hcLight:Cg},h("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),vMe=x("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},h("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),yMe=x("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",h("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Wz=x("problemsErrorIcon.foreground",Zp,h("problemsErrorIconForeground","The color used for the problems error icon.")),Hz=x("problemsWarningIcon.foreground",hr,h("problemsWarningIconForeground","The color used for the problems warning icon.")),Uz=x("problemsInfoIcon.foreground",ts,h("problemsInfoIconForeground","The color used for the problems info icon."));var zz=x("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},h("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),xMe=x("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},h("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),iO=x("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},h("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),TMe=x("minimap.infoHighlight",{dark:ts,light:ts,hcDark:Eg,hcLight:Eg},h("minimapInfo","Minimap marker color for infos.")),_Me=x("minimap.warningHighlight",{dark:hr,light:hr,hcDark:Sg,hcLight:Sg},h("overviewRuleWarning","Minimap marker color for warnings.")),DMe=x("minimap.errorHighlight",{dark:new U(new lt(255,18,18,.7)),light:new U(new lt(255,18,18,.7)),hcDark:new U(new lt(255,50,50,1)),hcLight:"#B5200D"},h("minimapError","Minimap marker color for errors.")),Kz=x("minimap.background",null,h("minimapBackground","Minimap background color.")),Gz=x("minimap.foregroundOpacity",U.fromHex("#000f"),h("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),LMe=x("minimapSlider.background",Ce(px,.5),h("minimapSliderBackground","Minimap slider background color.")),kMe=x("minimapSlider.hoverBackground",Ce(hx,.5),h("minimapSliderHoverBackground","Minimap slider background color when hovering.")),RMe=x("minimapSlider.activeBackground",Ce(mx,.5),h("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var FMe=x("charts.foreground",Rt,h("chartsForeground","The foreground color used in charts.")),BMe=x("charts.lines",Ce(Rt,.5),h("chartsLines","The color used for horizontal lines in charts.")),VMe=x("charts.red",Zp,h("chartsRed","The red color used in chart visualizations.")),WMe=x("charts.blue",ts,h("chartsBlue","The blue color used in chart visualizations.")),HMe=x("charts.yellow",hr,h("chartsYellow","The yellow color used in chart visualizations.")),UMe=x("charts.orange",zz,h("chartsOrange","The orange color used in chart visualizations.")),zMe=x("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},h("chartsGreen","The green color used in chart visualizations.")),KMe=x("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("chartsPurple","The purple color used in chart visualizations."));var jz=x("input.background",{dark:"#3C3C3C",light:U.white,hcDark:U.black,hcLight:U.white},h("inputBoxBackground","Input box background.")),qz=x("input.foreground",Rt,h("inputBoxForeground","Input box foreground.")),Tg=x("input.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("inputBoxBorder","Input box border.")),nO=x("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Ie,hcLight:Ie},h("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),iY=x("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},h("inputOption.hoverBackground","Background color of activated options in input fields.")),oO=x("inputOption.activeBackground",{dark:Ce(Zo,.4),light:Ce(Zo,.2),hcDark:U.transparent,hcLight:U.transparent},h("inputOption.activeBackground","Background hover color of options in input fields.")),rO=x("inputOption.activeForeground",{dark:U.white,light:U.black,hcDark:Rt,hcLight:Rt},h("inputOption.activeForeground","Foreground color of activated options in input fields.")),ZMe=x("input.placeholderForeground",{light:Ce(Rt,.5),dark:Ce(Rt,.5),hcDark:Ce(Rt,.7),hcLight:Ce(Rt,.7)},h("inputPlaceholderForeground","Input box foreground color for placeholder text.")),$z=x("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:U.black,hcLight:U.white},h("inputValidationInfoBackground","Input validation background color for information severity.")),Yz=x("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:Rt},h("inputValidationInfoForeground","Input validation foreground color for information severity.")),Zz=x("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Ie,hcLight:Ie},h("inputValidationInfoBorder","Input validation border color for information severity.")),Xz=x("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:U.black,hcLight:U.white},h("inputValidationWarningBackground","Input validation background color for warning severity.")),Qz=x("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:Rt},h("inputValidationWarningForeground","Input validation foreground color for warning severity.")),Jz=x("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Ie,hcLight:Ie},h("inputValidationWarningBorder","Input validation border color for warning severity.")),e5=x("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:U.black,hcLight:U.white},h("inputValidationErrorBackground","Input validation background color for error severity.")),t5=x("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:Rt},h("inputValidationErrorForeground","Input validation foreground color for error severity.")),i5=x("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Ie,hcLight:Ie},h("inputValidationErrorBorder","Input validation border color for error severity.")),_g=x("dropdown.background",{dark:"#3C3C3C",light:U.white,hcDark:U.black,hcLight:U.white},h("dropdownBackground","Dropdown background.")),n5=x("dropdown.listBackground",{dark:null,light:null,hcDark:U.black,hcLight:U.white},h("dropdownListBackground","Dropdown list background.")),Uy=x("dropdown.foreground",{dark:"#F0F0F0",light:Rt,hcDark:U.white,hcLight:Rt},h("dropdownForeground","Dropdown foreground.")),zy=x("dropdown.border",{dark:_g,light:"#CECECE",hcDark:Ie,hcLight:Ie},h("dropdownBorder","Dropdown border.")),sO=x("button.foreground",U.white,h("buttonForeground","Button foreground color.")),o5=x("button.separator",Ce(sO,.4),h("buttonSeparator","Button separator color.")),wg=x("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},h("buttonBackground","Button background color.")),r5=x("button.hoverBackground",{dark:ur(wg,.2),light:Yo(wg,.2),hcDark:wg,hcLight:wg},h("buttonHoverBackground","Button background color when hovering.")),s5=x("button.border",Ie,h("buttonBorder","Button border color.")),a5=x("button.secondaryForeground",{dark:U.white,light:U.white,hcDark:U.white,hcLight:Rt},h("buttonSecondaryForeground","Secondary button foreground color.")),bx=x("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:U.white},h("buttonSecondaryBackground","Secondary button background color.")),l5=x("button.secondaryHoverBackground",{dark:ur(bx,.2),light:Yo(bx,.2),hcDark:null,hcLight:null},h("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),xg=x("radio.activeForeground",rO,h("radioActiveForeground","Foreground color of active radio option.")),d5=x("radio.activeBackground",oO,h("radioBackground","Background color of active radio option.")),c5=x("radio.activeBorder",nO,h("radioActiveBorder","Border color of the active radio option.")),u5=x("radio.inactiveForeground",null,h("radioInactiveForeground","Foreground color of inactive radio option.")),p5=x("radio.inactiveBackground",null,h("radioInactiveBackground","Background color of inactive radio option.")),h5=x("radio.inactiveBorder",{light:Ce(xg,.2),dark:Ce(xg,.2),hcDark:Ce(xg,.4),hcLight:Ce(xg,.2)},h("radioInactiveBorder","Border color of the inactive radio option.")),m5=x("radio.inactiveHoverBackground",iY,h("radioHoverBackground","Background color of inactive active radio option when hovering.")),g5=x("checkbox.background",_g,h("checkbox.background","Background color of checkbox widget.")),XMe=x("checkbox.selectBackground",vo,h("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),f5=x("checkbox.foreground",Uy,h("checkbox.foreground","Foreground color of checkbox widget.")),b5=x("checkbox.border",zy,h("checkbox.border","Border color of checkbox widget.")),QMe=x("checkbox.selectBorder",Wy,h("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),v5=x("keybindingLabel.background",{dark:new U(new lt(128,128,128,.17)),light:new U(new lt(221,221,221,.4)),hcDark:U.transparent,hcLight:U.transparent},h("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),y5=x("keybindingLabel.foreground",{dark:U.fromHex("#CCCCCC"),light:U.fromHex("#555555"),hcDark:U.white,hcLight:Rt},h("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),I5=x("keybindingLabel.border",{dark:new U(new lt(51,51,51,.6)),light:new U(new lt(204,204,204,.4)),hcDark:new U(new lt(111,195,223)),hcLight:Ie},h("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),C5=x("keybindingLabel.bottomBorder",{dark:new U(new lt(68,68,68,.6)),light:new U(new lt(187,187,187,.4)),hcDark:new U(new lt(111,195,223)),hcLight:Rt},h("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var S5=x("list.focusBackground",null,h("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),E5=x("list.focusForeground",null,h("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),w5=x("list.focusOutline",{dark:Zo,light:Zo,hcDark:Ft,hcLight:Ft},h("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),x5=x("list.focusAndSelectionOutline",null,h("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),yo=x("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:U.fromHex("#0F4A85").transparent(.1)},h("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),is=x("list.activeSelectionForeground",{dark:U.white,light:U.white,hcDark:null,hcLight:null},h("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),yx=x("list.activeSelectionIconForeground",null,h("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),T5=x("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:U.fromHex("#0F4A85").transparent(.1)},h("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),_5=x("list.inactiveSelectionForeground",null,h("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),D5=x("list.inactiveSelectionIconForeground",null,h("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),L5=x("list.inactiveFocusBackground",null,h("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),k5=x("list.inactiveFocusOutline",null,h("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),aO=x("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:U.white.transparent(.1),hcLight:U.fromHex("#0F4A85").transparent(.1)},h("listHoverBackground","List/Tree background when hovering over items using the mouse.")),lO=x("list.hoverForeground",null,h("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),R5=x("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},h("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),A5=x("list.dropBetweenBackground",{dark:Wy,light:Wy,hcDark:null,hcLight:null},h("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),vx=x("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Zo,hcLight:Zo},h("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),oOe=x("list.focusHighlightForeground",{dark:vx,light:yz(yo,vx,"#BBE7FF"),hcDark:vx,hcLight:vx},h("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),rOe=x("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},h("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),sOe=x("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},h("listErrorForeground","Foreground color of list items containing errors.")),aOe=x("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},h("listWarningForeground","Foreground color of list items containing warnings.")),M5=x("listFilterWidget.background",{light:Yo(vo,0),dark:ur(vo,0),hcDark:vo,hcLight:vo},h("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),O5=x("listFilterWidget.outline",{dark:U.transparent,light:U.transparent,hcDark:"#f38518",hcLight:"#007ACC"},h("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),P5=x("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Ie,hcLight:Ie},h("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),N5=x("listFilterWidget.shadow",mu,h("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),lOe=x("list.filterMatchBackground",{dark:Wa,light:Wa,hcDark:null,hcLight:null},h("listFilterMatchHighlight","Background color of the filtered match.")),dOe=x("list.filterMatchBorder",{dark:hu,light:hu,hcDark:Ie,hcLight:Ft},h("listFilterMatchHighlightBorder","Border color of the filtered match.")),cOe=x("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},h("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),Dg=x("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},h("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),F5=x("tree.inactiveIndentGuidesStroke",Ce(Dg,.4),h("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),B5=x("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},h("tableColumnsBorder","Table border color between columns.")),V5=x("tree.tableOddRowsBackground",{dark:Ce(Rt,.04),light:Ce(Rt,.04),hcDark:null,hcLight:null},h("tableOddRowsBackgroundColor","Background color for odd table rows.")),uOe=x("editorActionList.background",vo,h("editorActionListBackground","Action List background color.")),pOe=x("editorActionList.foreground",Bl,h("editorActionListForeground","Action List foreground color.")),hOe=x("editorActionList.focusForeground",is,h("editorActionListFocusForeground","Action List foreground color for the focused item.")),mOe=x("editorActionList.focusBackground",yo,h("editorActionListFocusBackground","Action List background color for the focused item."));var W5=x("menu.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("menuBorder","Border color of menus.")),H5=x("menu.foreground",Uy,h("menuForeground","Foreground color of menu items.")),U5=x("menu.background",_g,h("menuBackground","Background color of menu items.")),z5=x("menu.selectionForeground",is,h("menuSelectionForeground","Foreground color of the selected menu item in menus.")),K5=x("menu.selectionBackground",yo,h("menuSelectionBackground","Background color of the selected menu item in menus.")),G5=x("menu.selectionBorder",{dark:null,light:null,hcDark:Ft,hcLight:Ft},h("menuSelectionBorder","Border color of the selected menu item in menus.")),j5=x("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Ie,hcLight:Ie},h("menuSeparatorBackground","Color of a separator menu item in menus."));var xOe=x("quickInput.background",vo,h("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),TOe=x("quickInput.foreground",Bl,h("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),_Oe=x("quickInputTitle.background",{dark:new U(new lt(255,255,255,.105)),light:new U(new lt(0,0,0,.06)),hcDark:"#000000",hcLight:U.white},h("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),$5=x("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:U.white,hcLight:"#0F4A85"},h("pickerGroupForeground","Quick picker color for grouping labels.")),DOe=x("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:U.white,hcLight:"#0F4A85"},h("pickerGroupBorder","Quick picker color for grouping borders.")),q5=x("quickInput.list.focusBackground",null,"",void 0,h("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),Y5=x("quickInputList.focusForeground",is,h("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),Z5=x("quickInputList.focusIconForeground",yx,h("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),X5=x("quickInputList.focusBackground",{dark:jM(q5,yo),light:jM(q5,yo),hcDark:null,hcLight:null},h("quickInput.listFocusBackground","Quick picker background color for the focused item."));var MOe=x("search.resultsInfoForeground",{light:Rt,dark:Ce(Rt,.65),hcDark:Rt,hcLight:Rt},h("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),OOe=x("searchEditor.findMatchBackground",{light:Ce(Wa,.66),dark:Ce(Wa,.66),hcDark:Wa,hcLight:Wa},h("searchEditor.queryMatch","Color of the Search Editor query matches.")),POe=x("searchEditor.findMatchBorder",{light:Ce(hu,.66),dark:Ce(hu,.66),hcDark:hu,hcLight:hu},h("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var dO=x("editor.lineHighlightBackground",null,h("lineHighlight","Background color for the highlight of line at the cursor position.")),cO=x("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Ie},h("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),QOe=x("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},h("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),JOe=x("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Ft,hcLight:Ft},h("rangeHighlightBorder","Background color of the border around highlighted ranges.")),ePe=x("editor.symbolHighlightBackground",{dark:Wa,light:Wa,hcDark:null,hcLight:null},h("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),tPe=x("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Ft,hcLight:Ft},h("symbolHighlightBorder","Background color of the border around highlighted symbols.")),Lg=x("editorCursor.foreground",{dark:"#AEAFAD",light:U.black,hcDark:U.white,hcLight:"#0F4A85"},h("caret","Color of the editor cursor.")),Ix=x("editorCursor.background",null,h("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),Cx=x("editorMultiCursor.primary.foreground",Lg,h("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),Q5=x("editorMultiCursor.primary.background",Ix,h("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),Sx=x("editorMultiCursor.secondary.foreground",Lg,h("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),J5=x("editorMultiCursor.secondary.background",Ix,h("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),Ex=x("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},h("editorWhitespaces","Color of whitespace characters in the editor.")),e4=x("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:U.white,hcLight:"#292929"},h("editorLineNumbers","Color of editor line numbers.")),nY=x("editorIndentGuide.background",Ex,h("editorIndentGuides","Color of the editor indentation guides."),!1,h("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),oY=x("editorIndentGuide.activeBackground",Ex,h("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,h("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),t4=x("editorIndentGuide.background1",nY,h("editorIndentGuides1","Color of the editor indentation guides (1).")),i4=x("editorIndentGuide.background2","#00000000",h("editorIndentGuides2","Color of the editor indentation guides (2).")),n4=x("editorIndentGuide.background3","#00000000",h("editorIndentGuides3","Color of the editor indentation guides (3).")),o4=x("editorIndentGuide.background4","#00000000",h("editorIndentGuides4","Color of the editor indentation guides (4).")),r4=x("editorIndentGuide.background5","#00000000",h("editorIndentGuides5","Color of the editor indentation guides (5).")),s4=x("editorIndentGuide.background6","#00000000",h("editorIndentGuides6","Color of the editor indentation guides (6).")),a4=x("editorIndentGuide.activeBackground1",oY,h("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),l4=x("editorIndentGuide.activeBackground2","#00000000",h("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),d4=x("editorIndentGuide.activeBackground3","#00000000",h("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),c4=x("editorIndentGuide.activeBackground4","#00000000",h("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),u4=x("editorIndentGuide.activeBackground5","#00000000",h("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),p4=x("editorIndentGuide.activeBackground6","#00000000",h("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),rY=x("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Ft,hcLight:Ft},h("editorActiveLineNumber","Color of editor active line number"),!1,h("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),iPe=x("editorLineNumber.activeForeground",rY,h("editorActiveLineNumber","Color of editor active line number")),h4=x("editorLineNumber.dimmedForeground",null,h("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),nPe=x("editorRuler.foreground",{dark:"#5A5A5A",light:U.lightgrey,hcDark:U.white,hcLight:"#292929"},h("editorRuler","Color of the editor rulers.")),oPe=x("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},h("editorCodeLensForeground","Foreground color of editor CodeLens")),rPe=x("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},h("editorBracketMatchBackground","Background color behind matching brackets")),sPe=x("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Ie,hcLight:Ie},h("editorBracketMatchBorder","Color for matching brackets boxes")),m4=x("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},h("editorOverviewRulerBorder","Color of the overview ruler border.")),g4=x("editorOverviewRuler.background",null,h("editorOverviewRulerBackground","Background color of the editor overview ruler.")),aPe=x("editorGutter.background",pr,h("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),lPe=x("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:U.fromHex("#fff").transparent(.8),hcLight:Ie},h("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),f4=x("editorUnnecessaryCode.opacity",{dark:U.fromHex("#000a"),light:U.fromHex("#0007"),hcDark:null,hcLight:null},h("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),dPe=x("editorGhostText.border",{dark:null,light:null,hcDark:U.fromHex("#fff").transparent(.8),hcLight:U.fromHex("#292929").transparent(.8)},h("editorGhostTextBorder","Border color of ghost text in the editor.")),cPe=x("editorGhostText.foreground",{dark:U.fromHex("#ffffff56"),light:U.fromHex("#0007"),hcDark:null,hcLight:null},h("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),uPe=x("editorGhostText.background",null,h("editorGhostTextBackground","Background color of the ghost text in the editor.")),sY=new U(new lt(0,122,204,.6)),pPe=x("editorOverviewRuler.rangeHighlightForeground",sY,h("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),hPe=x("editorOverviewRuler.errorForeground",{dark:new U(new lt(255,18,18,.7)),light:new U(new lt(255,18,18,.7)),hcDark:new U(new lt(255,50,50,1)),hcLight:"#B5200D"},h("overviewRuleError","Overview ruler marker color for errors.")),mPe=x("editorOverviewRuler.warningForeground",{dark:hr,light:hr,hcDark:Sg,hcLight:Sg},h("overviewRuleWarning","Overview ruler marker color for warnings.")),gPe=x("editorOverviewRuler.infoForeground",{dark:ts,light:ts,hcDark:Eg,hcLight:Eg},h("overviewRuleInfo","Overview ruler marker color for infos.")),wx=x("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},h("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),xx=x("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},h("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),Tx=x("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},h("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),_x=x("editorBracketHighlight.foreground4","#00000000",h("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),Dx=x("editorBracketHighlight.foreground5","#00000000",h("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),Lx=x("editorBracketHighlight.foreground6","#00000000",h("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),b4=x("editorBracketHighlight.unexpectedBracket.foreground",{dark:new U(new lt(255,18,18,.8)),light:new U(new lt(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},h("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),v4=x("editorBracketPairGuide.background1","#00000000",h("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),y4=x("editorBracketPairGuide.background2","#00000000",h("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),I4=x("editorBracketPairGuide.background3","#00000000",h("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),C4=x("editorBracketPairGuide.background4","#00000000",h("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),S4=x("editorBracketPairGuide.background5","#00000000",h("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),E4=x("editorBracketPairGuide.background6","#00000000",h("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),w4=x("editorBracketPairGuide.activeBackground1","#00000000",h("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),x4=x("editorBracketPairGuide.activeBackground2","#00000000",h("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),T4=x("editorBracketPairGuide.activeBackground3","#00000000",h("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),_4=x("editorBracketPairGuide.activeBackground4","#00000000",h("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),D4=x("editorBracketPairGuide.activeBackground5","#00000000",h("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),L4=x("editorBracketPairGuide.activeBackground6","#00000000",h("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),fPe=x("editorUnicodeHighlight.border",hr,h("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),bPe=x("editorUnicodeHighlight.background",_z,h("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));Fo((r,e)=>{let t=r.getColor(pr),i=r.getColor(dO),n=i&&!i.isTransparent()?i:t;n&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});var kx=class extends P{constructor(t){super();this.textModel=t;this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange(i=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new Rx;onDidChangeEmitter=new _;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,i,n,o){return o?[]:i===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(t,i){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new O(1,1,this.textModel.getLineCount(),1),t,i):[]}},Rx=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}};Fo((r,e)=>{let t=[wx,xx,Tx,_x,Dx,Lx],i=new Rx;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${r.getColor(b4)}; }`);let n=t.map(o=>r.getColor(o)).filter(o=>!!o).filter(o=>!o.isTransparent());for(let o=0;o<30;o++){let s=n[o%n.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(o)} { color: ${s}; }`)}});function kg(r){return r.toString()}var Lr=class r{constructor(e,t,i,n,o,s,a){this.beforeVersionId=e;this.afterVersionId=t;this.beforeEOL=i;this.afterEOL=n;this.beforeCursorState=o;this.afterCursorState=s;this.changes=a}static create(e,t){let i=e.getAlternativeVersionId(),n=hO(e);return new r(i,i,n,n,t,t,[])}append(e,t,i,n,o){t.length>0&&(this.changes=CU(this.changes,t)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=o}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,i){if(Yn(e,t?t.length:0,i),i+=4,t)for(let n of t)Yn(e,n.selectionStartLineNumber,i),i+=4,Yn(e,n.selectionStartColumn,i),i+=4,Yn(e,n.positionLineNumber,i),i+=4,Yn(e,n.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){let n=$n(e,t);t+=4;for(let o=0;o<n;o++){let s=$n(e,t);t+=4;let a=$n(e,t);t+=4;let l=$n(e,t);t+=4;let d=$n(e,t);t+=4,i.push(new tt(s,a,l,d))}return t}serialize(){let e=10+r._writeSelectionsSize(this.beforeCursorState)+r._writeSelectionsSize(this.afterCursorState)+4;for(let n of this.changes)e+=n.writeSize();let t=new Uint8Array(e),i=0;Yn(t,this.beforeVersionId,i),i+=4,Yn(t,this.afterVersionId,i),i+=4,KE(t,this.beforeEOL,i),i+=1,KE(t,this.afterEOL,i),i+=1,i=r._writeSelections(t,this.beforeCursorState,i),i=r._writeSelections(t,this.afterCursorState,i),Yn(t,this.changes.length,i),i+=4;for(let n of this.changes)i=n.write(t,i);return t.buffer}static deserialize(e){let t=new Uint8Array(e),i=0,n=$n(t,i);i+=4;let o=$n(t,i);i+=4;let s=zE(t,i);i+=1;let a=zE(t,i);i+=1;let l=[];i=r._readSelections(t,i,l);let d=[];i=r._readSelections(t,i,d);let c=$n(t,i);i+=4;let u=[];for(let p=0;p<c;p++)i=Zr.read(t,i,u);return new r(n,o,s,a,l,d,u)}},Ax=class{constructor(e,t,i,n){this.label=e;this.code=t;this.model=i,this._data=Lr.create(i,n)}model;_data;get type(){return 0}get resource(){return X.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof Lr?this._data:Lr.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(X.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof Lr}append(e,t,i,n,o){this._data instanceof Lr&&this._data.append(e,t,i,n,o)}close(){this._data instanceof Lr&&(this._data=this._data.serialize())}open(){this._data instanceof Lr||(this._data=Lr.deserialize(this._data))}undo(){if(X.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Lr&&(this._data=this._data.serialize());let e=Lr.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(X.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Lr&&(this._data=this._data.serialize());let e=Lr.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof Lr&&(this._data=this._data.serialize()),this._data.byteLength+168}},pO=class{constructor(e,t,i){this.label=e;this.code=t;this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(let n of this._editStackElementsArr){let o=kg(n.resource);this._editStackElementsMap.set(o,n)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(e=>e.resource)}setDelegate(e){this._delegate=e}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let e=[];for(let t of this._editStackElementsArr)X.isUri(t.model)&&e.push(t.model);return e}matchesResource(e){let t=kg(e);return this._editStackElementsMap.has(t)}setModel(e){let t=kg(X.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;let t=kg(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,n,o){let s=kg(e.uri);this._editStackElementsMap.get(s).append(e,t,i,n,o)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let e of this._editStackElementsArr)e.undo()}redo(){for(let e of this._editStackElementsArr)e.redo()}heapSize(e){let t=kg(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(let t of this._editStackElementsArr)e.push(`${Hi(t.resource)}: ${t}`);return`{${e.join(", ")}}`}};function hO(r){return r.getEOL()===`
`?0:1}function uO(r){return r?r instanceof Ax||r instanceof pO:!1}var Mx=class r{_model;_undoRedoService;constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);uO(e)&&e.close()}popStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);uO(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){let i=this._undoRedoService.getLastElement(this._model.uri);if(uO(i)&&i.canAppend(this._model))return i;let n=new Ax(h("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(n,t),n}pushEOL(e){let t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],hO(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,n){let o=this._getOrCreateEditStackElement(e,n),s=this._model.applyEdits(t,!0),a=r._computeCursorState(i,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),o.append(this._model,l.map(d=>d.textChange),hO(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return Ge(i),null}}};var Rg=class extends P{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function R4(r,e){let t=0,i=0,n=r.length;for(;i<n;){let o=r.charCodeAt(i);if(o===32)t++;else if(o===9)t=t-t%e+e;else break;i++}return i===n?-1:t}var Ox=class extends Rg{constructor(t,i){super();this.textModel=t;this.languageConfigurationService=i}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return R4(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,i,n){this.assertNotDisposed();let o=this.textModel.getLineCount();if(t<1||t>o)throw new Je("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,u=-1,p=L=>{if(l!==-1&&(l===-2||l>L-1)){l=-1,d=-1;for(let A=L-2;A>=0;A--){let W=this._computeIndentLevel(A);if(W>=0){l=A,d=W;break}}}if(c===-2){c=-1,u=-1;for(let A=L;A<o;A++){let W=this._computeIndentLevel(A);if(W>=0){c=A,u=W;break}}}},m=-2,f=-1,g=-2,b=-1,v=L=>{if(m===-2){m=-1,f=-1;for(let A=L-2;A>=0;A--){let W=this._computeIndentLevel(A);if(W>=0){m=A,f=W;break}}}if(g!==-1&&(g===-2||g<L-1)){g=-1,b=-1;for(let A=L;A<o;A++){let W=this._computeIndentLevel(A);if(W>=0){g=A,b=W;break}}}},I=0,w=!0,E=0,S=!0,T=0,D=0;for(let L=0;w||S;L++){let A=t-L,W=t+L;L>1&&(A<1||A<i)&&(w=!1),L>1&&(W>o||W>n)&&(S=!1),L>5e4&&(w=!1,S=!1);let j=-1;if(w&&A>=1){let oe=this._computeIndentLevel(A-1);oe>=0?(c=A-1,u=oe,j=Math.ceil(oe/this.textModel.getOptions().indentSize)):(p(A),j=this._getIndentLevelForWhitespaceLine(a,d,u))}let G=-1;if(S&&W<=o){let oe=this._computeIndentLevel(W-1);oe>=0?(m=W-1,f=oe,G=Math.ceil(oe/this.textModel.getOptions().indentSize)):(v(W),G=this._getIndentLevelForWhitespaceLine(a,f,b))}if(L===0){D=j;continue}if(L===1){if(W<=o&&G>=0&&D+1===G){w=!1,I=W,E=W,T=G;continue}if(A>=1&&j>=0&&j-1===D){S=!1,I=A,E=A,T=j;continue}if(I=t,E=t,T=D,T===0)return{startLineNumber:I,endLineNumber:E,indent:T}}w&&(j>=T?I=A:w=!1),S&&(G>=T?E=W:S=!1)}return{startLineNumber:I,endLineNumber:E,indent:T}}getLinesBracketGuides(t,i,n,o){let s=[];for(let p=t;p<=i;p++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new O(t,1,i,this.textModel.getLineMaxColumn(i))).toArray(),d;if(n&&l.length>0){let p=(t<=n.lineNumber&&n.lineNumber<=i?l:this.textModel.bracketPairs.getBracketPairsInRange(O.fromPositions(n)).toArray()).filter(m=>O.strictContainsPosition(m.range,n));d=lp(p,m=>a||m.range.startLineNumber!==m.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new Ky;for(let p of l){if(!p.closingBracketRange)continue;let m=d&&p.range.equalsRange(d);if(!m&&!o.includeInactive)continue;let f=u.getInlineClassName(p.nestingLevel,p.nestingLevelOfEqualBracketType,c)+(o.highlightActive&&m?" "+u.activeClassName:""),g=p.openingBracketRange.getStartPosition(),b=p.closingBracketRange.getStartPosition(),v=o.horizontalGuides===2||o.horizontalGuides===1&&m;if(p.range.startLineNumber===p.range.endLineNumber){a&&v&&s[p.range.startLineNumber-t].push(new Js(-1,p.openingBracketRange.getEndPosition().column,f,new Kd(!1,b.column),-1,-1));continue}let I=this.getVisibleColumnFromPosition(b),w=this.getVisibleColumnFromPosition(p.openingBracketRange.getStartPosition()),E=Math.min(w,I,p.minVisibleColumnIndentation+1),S=!1;qi(this.textModel.getLineContent(p.closingBracketRange.startLineNumber))<p.closingBracketRange.startColumn-1&&(S=!0);let L=Math.max(g.lineNumber,t),A=Math.min(b.lineNumber,i),W=S?1:0;for(let j=L;j<A+W;j++)s[j-t].push(new Js(E,-1,f,null,j===g.lineNumber?g.column:-1,j===b.lineNumber?b.column:-1));v&&(g.lineNumber>=t&&w>E&&s[g.lineNumber-t].push(new Js(E,-1,f,new Kd(!1,g.column),-1,-1)),b.lineNumber<=i&&I>E&&s[b.lineNumber-t].push(new Js(E,-1,f,new Kd(!S,b.column),-1,-1)))}for(let p of s)p.sort((m,f)=>m.visibleColumn-f.visibleColumn);return s}getVisibleColumnFromPosition(t){return oi.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,i){this.assertNotDisposed();let n=this.textModel.getLineCount();if(t<1||t>n)throw new Error("Illegal value for startLineNumber");if(i<1||i>n)throw new Error("Illegal value for endLineNumber");let o=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(i-t+1),d=-2,c=-1,u=-2,p=-1;for(let m=t;m<=i;m++){let f=m-t,g=this._computeIndentLevel(m-1);if(g>=0){d=m-1,c=g,l[f]=Math.ceil(g/o.indentSize);continue}if(d===-2){d=-1,c=-1;for(let b=m-2;b>=0;b--){let v=this._computeIndentLevel(b);if(v>=0){d=b,c=v;break}}}if(u!==-1&&(u===-2||u<m-1)){u=-1,p=-1;for(let b=m;b<n;b++){let v=this._computeIndentLevel(b);if(v>=0){u=b,p=v;break}}}l[f]=this._getIndentLevelForWhitespaceLine(a,c,p)}return l}_getIndentLevelForWhitespaceLine(t,i,n){let o=this.textModel.getOptions();return i===-1||n===-1?0:i<n?1+Math.floor(i/o.indentSize):i===n||t?Math.ceil(n/o.indentSize):1+Math.floor(n/o.indentSize)}},Ky=class{activeClassName="indent-active";getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}};var mO=class{spacesDiff=0;looksLikeAlignment=!1};function lY(r,e,t,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let o;for(o=0;o<e&&o<i;o++){let p=r.charCodeAt(o),m=t.charCodeAt(o);if(p!==m)break}let s=0,a=0;for(let p=o;p<e;p++)r.charCodeAt(p)===32?s++:a++;let l=0,d=0;for(let p=o;p<i;p++)t.charCodeAt(p)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),u=Math.abs(s-l);if(c===0){n.spacesDiff=u,u>0&&0<=l-1&&l-1<r.length&&l<t.length&&t.charCodeAt(l)!==32&&r.charCodeAt(l-1)===32&&r.charCodeAt(r.length-1)===44&&(n.looksLikeAlignment=!0);return}if(u%c===0){n.spacesDiff=u/c;return}}function gO(r,e,t){let i=Math.min(r.getLineCount(),1e4),n=0,o=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],u=new mO;for(let f=1;f<=i;f++){let g=r.getLineLength(f),b=r.getLineContent(f),v=g<=65536,I=!1,w=0,E=0,S=0;for(let D=0,L=g;D<L;D++){let A=v?b.charCodeAt(D):r.getLineCharCode(f,D);if(A===9)S++;else if(A===32)E++;else{I=!0,w=D;break}}if(!I||(S>0?n++:E>1&&o++,lY(s,a,b,w,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;let T=u.spacesDiff;T<=d&&c[T]++,s=b,a=w}let p=t;n!==o&&(p=n<o);let m=e;if(p){let f=p?0:.1*i;l.forEach(g=>{let b=c[g];b>f&&(f=b,m=g)}),m===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(m=2)}return{insertSpaces:p,tabSize:m}}function mr(r){return(r.metadata&1)>>>0}function ri(r,e){r.metadata=r.metadata&254|e<<0}function Jn(r){return(r.metadata&2)>>>1===1}function ti(r,e){r.metadata=r.metadata&253|(e?1:0)<<1}function V4(r){return(r.metadata&4)>>>2===1}function A4(r,e){r.metadata=r.metadata&251|(e?1:0)<<2}function W4(r){return(r.metadata&64)>>>6===1}function M4(r,e){r.metadata=r.metadata&191|(e?1:0)<<6}function dY(r){return(r.metadata&24)>>>3}function O4(r,e){r.metadata=r.metadata&231|e<<3}function cY(r){return(r.metadata&32)>>>5===1}function P4(r,e){r.metadata=r.metadata&223|(e?1:0)<<5}var qy=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,ri(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,A4(this,!1),M4(this,!1),O4(this,1),P4(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,ti(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e;let t=this.options.className;A4(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),M4(this,this.options.glyphMarginClassName!==null),O4(this,this.options.stickiness),P4(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}},st=new qy(null,0,0);st.parent=st;st.left=st;st.right=st;ri(st,0);var Mg=class{root;requestNormalizeDelta;constructor(){this.root=st,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,o,s){return this.root===st?[]:bY(this,e,t,i,n,o,s)}search(e,t,i,n){return this.root===st?[]:N4(this,e,t,i,n)}collectNodesFromOwner(e){return gY(this,e)}collectNodesPostOrder(){return fY(this)}insert(e){F4(this,e),this._normalizeDeltaIfNecessary()}delete(e){B4(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){let i=e,n=0;for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent;let o=i.start+n,s=i.end+n;i.setCachedOffsets(o,s,t)}acceptReplace(e,t,i,n){let o=hY(this,e,e+t);for(let s=0,a=o.length;s<a;s++){let l=o[s];B4(this,l)}this._normalizeDeltaIfNecessary(),mY(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let s=0,a=o.length;s<a;s++){let l=o[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,pY(l,e,e+t,i,n),l.maxEnd=l.end,F4(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return N4(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,uY(this))}};function uY(r){let e=r.root,t=0;for(;e!==st;){if(e.left!==st&&!Jn(e.left)){e=e.left;continue}if(e.right!==st&&!Jn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,jd(e),ti(e,!0),ti(e.left,!1),ti(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}ti(r.root,!1)}function Ag(r,e,t,i){return r<t?!0:r>t||i===1?!1:i===2?!0:e}function pY(r,e,t,i,n){let o=dY(r),s=o===0||o===2,a=o===1||o===2,l=t-e,d=i,c=Math.min(l,d),u=r.start,p=!1,m=r.end,f=!1;e<=u&&m<=t&&cY(r)&&(r.start=e,p=!0,r.end=e,f=!0);{let b=n?1:l>0?2:0;!p&&Ag(u,s,e,b)&&(p=!0),!f&&Ag(m,a,e,b)&&(f=!0)}if(c>0&&!n){let b=l>d?2:0;!p&&Ag(u,s,e+c,b)&&(p=!0),!f&&Ag(m,a,e+c,b)&&(f=!0)}{let b=n?1:0;!p&&Ag(u,s,t,b)&&(r.start=e+d,p=!0),!f&&Ag(m,a,t,b)&&(r.end=e+d,f=!0)}let g=d-l;p||(r.start=Math.max(0,u+g)),f||(r.end=Math.max(0,m+g)),r.start>r.end&&(r.end=r.start)}function hY(r,e,t){let i=r.root,n=0,o=0,s=0,a=0,l=[],d=0;for(;i!==st;){if(Jn(i)){ti(i.left,!1),ti(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!Jn(i.left)){if(o=n+i.maxEnd,o<e){ti(i,!0);continue}if(i.left!==st){i=i.left;continue}}if(s=n+i.start,s>t){ti(i,!0);continue}if(a=n+i.end,a>=e&&(i.setCachedOffsets(s,a,0),l[d++]=i),ti(i,!0),i.right!==st&&!Jn(i.right)){n+=i.delta,i=i.right;continue}}return ti(r.root,!1),l}function mY(r,e,t,i){let n=r.root,o=0,s=0,a=0,l=i-(t-e);for(;n!==st;){if(Jn(n)){ti(n.left,!1),ti(n.right,!1),n===n.parent.right&&(o-=n.parent.delta),jd(n),n=n.parent;continue}if(!Jn(n.left)){if(s=o+n.maxEnd,s<e){ti(n,!0);continue}if(n.left!==st){n=n.left;continue}}if(a=o+n.start,a>t){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(r.requestNormalizeDelta=!0),ti(n,!0);continue}if(ti(n,!0),n.right!==st&&!Jn(n.right)){o+=n.delta,n=n.right;continue}}ti(r.root,!1)}function gY(r,e){let t=r.root,i=[],n=0;for(;t!==st;){if(Jn(t)){ti(t.left,!1),ti(t.right,!1),t=t.parent;continue}if(t.left!==st&&!Jn(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[n++]=t),ti(t,!0),t.right!==st&&!Jn(t.right)){t=t.right;continue}}return ti(r.root,!1),i}function fY(r){let e=r.root,t=[],i=0;for(;e!==st;){if(Jn(e)){ti(e.left,!1),ti(e.right,!1),e=e.parent;continue}if(e.left!==st&&!Jn(e.left)){e=e.left;continue}if(e.right!==st&&!Jn(e.right)){e=e.right;continue}t[i++]=e,ti(e,!0)}return ti(r.root,!1),t}function N4(r,e,t,i,n){let o=r.root,s=0,a=0,l=0,d=[],c=0;for(;o!==st;){if(Jn(o)){ti(o.left,!1),ti(o.right,!1),o===o.parent.right&&(s-=o.parent.delta),o=o.parent;continue}if(o.left!==st&&!Jn(o.left)){o=o.left;continue}a=s+o.start,l=s+o.end,o.setCachedOffsets(a,l,i);let u=!0;if(e&&o.ownerId&&o.ownerId!==e&&(u=!1),t&&V4(o)&&(u=!1),n&&!W4(o)&&(u=!1),u&&(d[c++]=o),ti(o,!0),o.right!==st&&!Jn(o.right)){s+=o.delta,o=o.right;continue}}return ti(r.root,!1),d}function bY(r,e,t,i,n,o,s){let a=r.root,l=0,d=0,c=0,u=0,p=[],m=0;for(;a!==st;){if(Jn(a)){ti(a.left,!1),ti(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!Jn(a.left)){if(d=l+a.maxEnd,d<e){ti(a,!0);continue}if(a.left!==st){a=a.left;continue}}if(c=l+a.start,c>t){ti(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(c,u,o);let f=!0;i&&a.ownerId&&a.ownerId!==i&&(f=!1),n&&V4(a)&&(f=!1),s&&!W4(a)&&(f=!1),f&&(p[m++]=a)}if(ti(a,!0),a.right!==st&&!Jn(a.right)){l+=a.delta,a=a.right;continue}}return ti(r.root,!1),p}function F4(r,e){if(r.root===st)return e.parent=st,e.left=st,e.right=st,ri(e,0),r.root=e,r.root;vY(r,e),gu(e.parent);let t=e;for(;t!==r.root&&mr(t.parent)===1;)if(t.parent===t.parent.parent.left){let i=t.parent.parent.right;mr(i)===1?(ri(t.parent,0),ri(i,0),ri(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,Gy(r,t)),ri(t.parent,0),ri(t.parent.parent,1),jy(r,t.parent.parent))}else{let i=t.parent.parent.left;mr(i)===1?(ri(t.parent,0),ri(i,0),ri(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,jy(r,t)),ri(t.parent,0),ri(t.parent.parent,1),Gy(r,t.parent.parent))}return ri(r.root,0),e}function vY(r,e){let t=0,i=r.root,n=e.start,o=e.end;for(;;)if(IY(n,o,i.start+t,i.end+t)<0)if(i.left===st){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===st){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=st,e.right=st,ri(e,1)}function B4(r,e){let t,i;if(e.left===st?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(r.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===st?(t=e.left,i=e):(i=yY(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(r.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(r.requestNormalizeDelta=!0)),i===r.root){r.root=t,ri(t,0),e.detach(),fO(),jd(t),r.root.parent=st;return}let n=mr(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,ri(i,mr(e)),e===r.root?r.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==st&&(i.left.parent=i),i.right!==st&&(i.right.parent=i)),e.detach(),n){gu(t.parent),i!==e&&(gu(i),gu(i.parent)),fO();return}gu(t),gu(t.parent),i!==e&&(gu(i),gu(i.parent));let o;for(;t!==r.root&&mr(t)===0;)t===t.parent.left?(o=t.parent.right,mr(o)===1&&(ri(o,0),ri(t.parent,1),Gy(r,t.parent),o=t.parent.right),mr(o.left)===0&&mr(o.right)===0?(ri(o,1),t=t.parent):(mr(o.right)===0&&(ri(o.left,0),ri(o,1),jy(r,o),o=t.parent.right),ri(o,mr(t.parent)),ri(t.parent,0),ri(o.right,0),Gy(r,t.parent),t=r.root)):(o=t.parent.left,mr(o)===1&&(ri(o,0),ri(t.parent,1),jy(r,t.parent),o=t.parent.left),mr(o.left)===0&&mr(o.right)===0?(ri(o,1),t=t.parent):(mr(o.left)===0&&(ri(o.right,0),ri(o,1),Gy(r,o),o=t.parent.left),ri(o,mr(t.parent)),ri(t.parent,0),ri(o.left,0),jy(r,t.parent),t=r.root));ri(t,0),fO()}function yY(r){for(;r.left!==st;)r=r.left;return r}function fO(){st.parent=st,st.delta=0,st.start=0,st.end=0}function Gy(r,e){let t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(r.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==st&&(t.left.parent=e),t.parent=e.parent,e.parent===st?r.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,jd(e),jd(t)}function jy(r,e){let t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(r.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==st&&(t.right.parent=e),t.parent=e.parent,e.parent===st?r.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,jd(e),jd(t)}function H4(r){let e=r.end;if(r.left!==st){let t=r.left.maxEnd;t>e&&(e=t)}if(r.right!==st){let t=r.right.maxEnd+r.delta;t>e&&(e=t)}return e}function jd(r){r.maxEnd=H4(r)}function gu(r){for(;r!==st;){let e=H4(r);if(r.maxEnd===e)return;r.maxEnd=e,r=r.parent}}function IY(r,e,t,i){return r===t?e-i:r-t}var Og=class{parent;left;right;color;piece;size_left;lf_left;constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==qe)return Nx(this.right);let e=this;for(;e.parent!==qe&&e.parent.left!==e;)e=e.parent;return e.parent===qe?qe:e.parent}prev(){if(this.left!==qe)return vO(this.left);let e=this;for(;e.parent!==qe&&e.parent.right!==e;)e=e.parent;return e.parent===qe?qe:e.parent}detach(){this.parent=null,this.left=null,this.right=null}};var qe=new Og(null,0);qe.parent=qe;qe.left=qe;qe.right=qe;qe.color=0;function Nx(r){for(;r.left!==qe;)r=r.left;return r}function vO(r){for(;r.right!==qe;)r=r.right;return r}function yO(r){return r===qe?0:r.size_left+r.piece.length+yO(r.right)}function IO(r){return r===qe?0:r.lf_left+r.piece.lineFeedCnt+IO(r.right)}function bO(){qe.parent=qe}function Yy(r,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==qe&&(t.left.parent=e),t.parent=e.parent,e.parent===qe?r.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Zy(r,e){let t=e.left;e.left=t.right,t.right!==qe&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===qe?r.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Xy(r,e){let t,i;if(e.left===qe?(i=e,t=i.right):e.right===qe?(i=e,t=i.left):(i=Nx(e.right),t=i.right),i===r.root){r.root=t,t.color=0,e.detach(),bO(),r.root.parent=qe;return}let n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,$y(r,t)):(i.parent===e?t.parent=i:t.parent=i.parent,$y(r,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===r.root?r.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==qe&&(i.left.parent=i),i.right!==qe&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,$y(r,i)),e.detach(),t.parent.left===t){let s=yO(t),a=IO(t);if(s!==t.parent.size_left||a!==t.parent.lf_left){let l=s-t.parent.size_left,d=a-t.parent.lf_left;t.parent.size_left=s,t.parent.lf_left=a,Vl(r,t.parent,l,d)}}if($y(r,t.parent),n){bO();return}let o;for(;t!==r.root&&t.color===0;)t===t.parent.left?(o=t.parent.right,o.color===1&&(o.color=0,t.parent.color=1,Yy(r,t.parent),o=t.parent.right),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.right.color===0&&(o.left.color=0,o.color=1,Zy(r,o),o=t.parent.right),o.color=t.parent.color,t.parent.color=0,o.right.color=0,Yy(r,t.parent),t=r.root)):(o=t.parent.left,o.color===1&&(o.color=0,t.parent.color=1,Zy(r,t.parent),o=t.parent.left),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.left.color===0&&(o.right.color=0,o.color=1,Yy(r,o),o=t.parent.left),o.color=t.parent.color,t.parent.color=0,o.left.color=0,Zy(r,t.parent),t=r.root));t.color=0,bO()}function CO(r,e){for($y(r,e);e!==r.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,Yy(r,e)),e.parent.color=0,e.parent.parent.color=1,Zy(r,e.parent.parent))}else{let t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Zy(r,e)),e.parent.color=0,e.parent.parent.color=1,Yy(r,e.parent.parent))}r.root.color=0}function Vl(r,e,t,i){for(;e!==r.root&&e!==qe;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function $y(r,e){let t=0,i=0;if(e!==r.root){for(;e!==r.root&&e===e.parent.right;)e=e.parent;if(e!==r.root)for(e=e.parent,t=yO(e.left)-e.size_left,i=IO(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==r.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}var CY=999,$d=class{searchString;isRegex;matchCase;wordSeparators;constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=SY(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=BS(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new Xw(t,this.wordSeparators?Al(this.wordSeparators,[]):null,i?this.searchString:null)}};function SY(r){if(!r||r.length===0)return!1;for(let e=0,t=r.length;e<t;e++){let i=r.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;let n=r.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function fu(r,e,t){if(!t)return new cu(r,null);let i=[];for(let n=0,o=e.length;n<o;n++)i[n]=e[n];return new cu(r,i)}var Fx=class{_lineFeedsOffsets;constructor(e){let t=[],i=0;for(let n=0,o=e.length;n<o;n++)e.charCodeAt(n)===10&&(t[i++]=n);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){let t=this._lineFeedsOffsets,i=0,n=t.length-1;if(n===-1||e<=t[0])return 0;for(;i<n;){let o=i+((n-i)/2>>0);t[o]>=e?n=o-1:t[o+1]>=e?(i=o,n=o):i=o+1}return i+1}},Qp=class{static findMatches(e,t,i,n,o){let s=t.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(e,i,new qd(s.wordSeparators,s.regex),n,o):this._doFindMatchesLineByLine(e,i,s,n,o):[]}static _getMultilineMatchRange(e,t,i,n,o,s){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(o),a=t+o+l):a=t+o;let d;if(n){let m=n.findLineFeedCountBeforeOffset(o+s.length)-l;d=a+s.length+m}else d=a+s.length;let c=e.getPositionAt(a),u=e.getPositionAt(d);return new O(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,i,n,o){let s=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new Fx(a):null,d=[],c=0,u;for(i.reset(0);u=i.next(a);)if(d[c++]=fu(this._getMultilineMatchRange(e,s,a,l,u.index,u[0]),u,n),c>=o)return d;return d}static _doFindMatchesLineByLine(e,t,i,n,o){let s=[],a=0;if(t.startLineNumber===t.endLineNumber){let d=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,d,t.startLineNumber,t.startColumn-1,a,s,n,o),s}let l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,s,n,o);for(let d=t.startLineNumber+1;d<t.endLineNumber&&a<o;d++)a=this._findMatchesInLine(i,e.getLineContent(d),d,0,a,s,n,o);if(a<o){let d=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,d,t.endLineNumber,0,a,s,n,o)}return s}static _findMatchesInLine(e,t,i,n,o,s,a,l){let d=e.wordSeparators;if(!a&&e.simpleSearch){let p=e.simpleSearch,m=p.length,f=t.length,g=-m;for(;(g=t.indexOf(p,g+m))!==-1;)if((!d||Bx(d,t,f,g,m))&&(s[o++]=new cu(new O(i,g+1+n,i,g+1+m+n),null),o>=l))return o;return o}let c=new qd(e.wordSeparators,e.regex),u;c.reset(0);do if(u=c.next(t),u&&(s[o++]=fu(new O(i,u.index+1+n,i,u.index+1+u[0].length+n),u,a),o>=l))return o;while(u);return o}static findNextMatch(e,t,i,n){let o=t.parseSearchRequest();if(!o)return null;let s=new qd(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindNextMatchMultiline(e,i,s,n):this._doFindNextMatchLineByLine(e,i,s,n)}static _doFindNextMatchMultiline(e,t,i,n){let o=new F(t.lineNumber,1),s=e.getOffsetAt(o),a=e.getLineCount(),l=e.getValueInRange(new O(o.lineNumber,o.column,a,e.getLineMaxColumn(a)),1),d=e.getEOL()===`\r
`?new Fx(l):null;i.reset(t.column-1);let c=i.next(l);return c?fu(this._getMultilineMatchRange(e,s,l,d,c.index,c[0]),c,n):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new F(1,1),i,n):null}static _doFindNextMatchLineByLine(e,t,i,n){let o=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s),l=this._findFirstMatchInLine(i,a,s,t.column,n);if(l)return l;for(let d=1;d<=o;d++){let c=(s+d-1)%o,u=e.getLineContent(c+1),p=this._findFirstMatchInLine(i,u,c+1,1,n);if(p)return p}return null}static _findFirstMatchInLine(e,t,i,n,o){e.reset(n-1);let s=e.next(t);return s?fu(new O(i,s.index+1,i,s.index+1+s[0].length),s,o):null}static findPreviousMatch(e,t,i,n){let o=t.parseSearchRequest();if(!o)return null;let s=new qd(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindPreviousMatchMultiline(e,i,s,n):this._doFindPreviousMatchLineByLine(e,i,s,n)}static _doFindPreviousMatchMultiline(e,t,i,n){let o=this._doFindMatchesMultiline(e,new O(1,1,t.lineNumber,t.column),i,n,10*CY);if(o.length>0)return o[o.length-1];let s=e.getLineCount();return t.lineNumber!==s||t.column!==e.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(e,new F(s,e.getLineMaxColumn(s)),i,n):null}static _doFindPreviousMatchLineByLine(e,t,i,n){let o=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,s,n);if(l)return l;for(let d=1;d<=o;d++){let c=(o+s-d-1)%o,u=e.getLineContent(c+1),p=this._findLastMatchInLine(i,u,c+1,n);if(p)return p}return null}static _findLastMatchInLine(e,t,i,n){let o=null,s;for(e.reset(0);s=e.next(t);)o=fu(new O(i,s.index+1,i,s.index+1+s[0].length),s,n);return o}};function EY(r,e,t,i,n){if(i===0)return!0;let o=e.charCodeAt(i-1);if(r.get(o)!==0||o===13||o===10)return!0;if(n>0){let s=e.charCodeAt(i);if(r.get(s)!==0)return!0}return!1}function wY(r,e,t,i,n){if(i+n===t)return!0;let o=e.charCodeAt(i+n);if(r.get(o)!==0||o===13||o===10)return!0;if(n>0){let s=e.charCodeAt(i+n-1);if(r.get(s)!==0)return!0}return!1}function Bx(r,e,t,i,n){return EY(r,e,t,i,n)&&wY(r,e,t,i,n)}var qd=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;let n=i.index,o=i[0].length;if(n===this._prevMatchStartIndex&&o===this._prevMatchLength){if(o===0){ym(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=o,!this._wordSeparators||Bx(this._wordSeparators,e,t,n,o))return i}while(i);return null}};var Yd=65535;function U4(r){let e;return r[r.length-1]<65536?e=new Uint16Array(r.length):e=new Uint32Array(r.length),e.set(r,0),e}var EO=class{constructor(e,t,i,n,o){this.lineStarts=e;this.cr=t;this.lf=i;this.crlf=n;this.isBasicASCII=o}};function Wl(r,e=!0){let t=[0],i=1;for(let n=0,o=r.length;n<o;n++){let s=r.charCodeAt(n);s===13?n+1<o&&r.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:s===10&&(t[i++]=n+1)}return e?U4(t):t}function z4(r,e){r.length=0,r[0]=0;let t=1,i=0,n=0,o=0,s=!0;for(let l=0,d=e.length;l<d;l++){let c=e.charCodeAt(l);c===13?l+1<d&&e.charCodeAt(l+1)===10?(o++,r[t++]=l+2,l++):(i++,r[t++]=l+1):c===10?(n++,r[t++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new EO(U4(r),i,n,o,s);return r.length=0,a}var Xo=class{bufferIndex;start;end;length;lineFeedCnt;constructor(e,t,i,n,o){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=o}},Hl=class{buffer;lineStarts;constructor(e,t){this.buffer=e,this.lineStarts=t}},wO=class{_pieces;_index;_tree;_BOM;constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==qe&&e.iterate(e.root,i=>(i!==qe&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},xO=class{_limit;_cache;constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,i=this._cache;for(let n=0;n<i.length;n++){let o=i[n];if(o.node.parent===null||o.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){let n=[];for(let o of i)o!==null&&n.push(o);this._cache=n}}},Vx=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new Hl("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=qe,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let o=0,s=e.length;o<s;o++)if(e[o].buffer.length>0){e[o].lineStarts||(e[o].lineStarts=Wl(e[o].buffer));let a=new Xo(o+1,{line:0,column:0},{line:e[o].lineStarts.length-1,column:e[o].buffer.length-e[o].lineStarts[e[o].lineStarts.length-1]},e[o].lineStarts.length-1,e[o].buffer.length);this._buffers.push(e[o]),n=this.rbInsertRight(n,a)}this._searchCache=new xO(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=Yd,i=t-Math.floor(t/3),n=i*2,o="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=i||s+c<n)return o+=d,s+=c,!0;let u=o.replace(/\r\n|\r|\n/g,e);return a.push(new Hl(u,Wl(u))),o=d,s=c,!0}),s>0){let l=o.replace(/\r\n|\r|\n/g,e);a.push(new Hl(l,Wl(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new wO(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,n=>{if(n===qe)return!0;let o=this.getNodeContent(n),s=o.length,a=e.nodeAt(t),l=e.nodeAt(t+s),d=e.getValueInRange2(a,l);return t+=s,o===d})}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==qe;)if(n.left!==qe&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;let o=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=o+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0,n=e;for(;t!==qe;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let o=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+o.index,o.index===0){let s=this.getOffsetAt(i+1,1),a=n-s;return new F(i+1,a+1)}return new F(i+1,o.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===qe){let o=this.getOffsetAt(i+1,1),s=n-e-o;return new F(i+1,s+1)}else t=t.right;return new F(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),o=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?o.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,t):o}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+e.remainder,d+t.remainder)}let i=e.node,n=this._buffers[i.piece.bufferIndex].buffer,o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start),s=n.substring(o+e.remainder,o+i.piece.length);for(i=i.next();i!==qe;){let a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){s+=a.substring(l,l+t.remainder);break}else s+=a.substr(l,i.piece.length);i=i.next()}return s}getLinesContent(){let e=[],t=0,i="",n=!1;return this.iterate(this.root,o=>{if(o===qe)return!0;let s=o.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line,p=d[c]+s.start.column;if(n&&(l.charCodeAt(p)===10&&(p++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(c===u)return!this._EOLNormalized&&l.charCodeAt(p+a-1)===13?(n=!0,i+=l.substr(p,a-1)):i+=l.substr(p,a),!0;i+=this._EOLNormalized?l.substring(p,Math.max(p,d[c+1]-this._EOLLength)):l.substring(p,d[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let m=c+1;m<u;m++)i=this._EOLNormalized?l.substring(d[m],d[m+1]-this._EOLLength):l.substring(d[m],d[m+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(d[u]+s.end.column-1)===13?(n=!0,s.end.column===0?t--:i=l.substr(d[u],s.end.column-1)):i=l.substr(d[u],s.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{let t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){let i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let i=t.node.next();if(!i||i===qe)return"";let n=this._buffers[i.piece.bufferIndex],o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.buffer.substring(o,o+i.piece.length)}else{let i=this._buffers[t.node.piece.bufferIndex],n=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),o=n+t.remainder,s=n+t.node.piece.length;return i.buffer.substring(o,s)}}findMatchesInNode(e,t,i,n,o,s,a,l,d,c,u){let p=this._buffers[e.piece.bufferIndex],m=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),f=this.offsetInBuffer(e.piece.bufferIndex,o),g=this.offsetInBuffer(e.piece.bufferIndex,s),b,v={line:0,column:0},I,w;t._wordSeparators?(I=p.buffer.substring(f,g),w=E=>E+f,t.reset(0)):(I=p.buffer,w=E=>E,t.reset(f));do if(b=t.next(I),b){if(w(b.index)>=g)return c;this.positionInBuffer(e,w(b.index)-m,v);let E=this.getLineFeedCnt(e.piece.bufferIndex,o,v),S=v.line===o.line?v.column-o.column+n:v.column+1,T=S+b[0].length;if(u[c++]=fu(new O(i+E,S,i+E,T),b,l),w(b.index)+b[0].length>=g||c>=d)return c}while(b);return c}findMatchesLineByLine(e,t,i,n){let o=[],s=0,a=new qd(t.wordSeparators,t.regex),l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let d=this.nodeAt2(e.endLineNumber,e.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,c,u,t,i,n,s,o),o;let p=e.startLineNumber,m=l.node;for(;m!==d.node;){let g=this.getLineFeedCnt(m.piece.bufferIndex,c,m.piece.end);if(g>=1){let v=this._buffers[m.piece.bufferIndex].lineStarts,I=this.offsetInBuffer(m.piece.bufferIndex,m.piece.start),w=v[c.line+g],E=p===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(m,a,p,E,c,this.positionInBuffer(m,w-I),t,i,n,s,o),s>=n)return o;p+=g}let b=p===e.startLineNumber?e.startColumn-1:0;if(p===e.endLineNumber){let v=this.getLineContent(p).substring(b,e.endColumn-1);return s=this._findMatchesInLine(t,a,v,e.endLineNumber,b,s,o,i,n),o}if(s=this._findMatchesInLine(t,a,this.getLineContent(p).substr(b),p,b,s,o,i,n),s>=n)return o;p++,l=this.nodeAt2(p,1),m=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(p===e.endLineNumber){let g=p===e.startLineNumber?e.startColumn-1:0,b=this.getLineContent(p).substring(g,e.endColumn-1);return s=this._findMatchesInLine(t,a,b,e.endLineNumber,g,s,o,i,n),o}let f=p===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(d.node,a,p,f,c,u,t,i,n,s,o),o}_findMatchesInLine(e,t,i,n,o,s,a,l,d){let c=e.wordSeparators;if(!l&&e.simpleSearch){let p=e.simpleSearch,m=p.length,f=i.length,g=-m;for(;(g=i.indexOf(p,g+m))!==-1;)if((!c||Bx(c,i,f,g,m))&&(a[s++]=new cu(new O(n,g+1+o,n,g+1+m+o),null),s>=d))return s;return s}let u;t.reset(0);do if(u=t.next(i),u&&(a[s++]=fu(new O(n,u.index+1+o,n,u.index+1+u[0].length+o),u,l),s>=d))return s;while(u);return s}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==qe){let{node:n,remainder:o,nodeStartOffset:s}=this.nodeAt(e),a=n.piece,l=a.bufferIndex,d=this.positionInBuffer(n,o);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===e&&t.length<Yd){this.appendToNode(n,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(s+n.piece.length>e){let c=[],u=new Xo(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,o)===10){let g={line:u.start.line+1,column:0};u=new Xo(u.bufferIndex,g,u.end,this.getLineFeedCnt(u.bufferIndex,g,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,o-1)===13){let g=this.positionInBuffer(n,o-1);this.deleteNodeTail(n,g),t="\r"+t,n.piece.length===0&&c.push(n)}else this.deleteNodeTail(n,d);else this.deleteNodeTail(n,d);let p=this.createNewPieces(t);u.length>0&&this.rbInsertRight(n,u);let m=n;for(let f=0;f<p.length;f++)m=this.rbInsertRight(m,p[f]);this.deleteNodes(c)}else this.insertContentToNodeRight(t,n)}else{let n=this.createNewPieces(t),o=this.rbInsertLeft(null,n[0]);for(let s=1;s<n.length;s++)o=this.rbInsertRight(o,n[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===qe)return;let i=this.nodeAt(e),n=this.nodeAt(e+t),o=i.node,s=n.node;if(o===s){let p=this.positionInBuffer(o,i.remainder),m=this.positionInBuffer(o,n.remainder);if(i.nodeStartOffset===e){if(t===o.piece.length){let f=o.next();Xy(this,o),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}this.deleteNodeHead(o,m),this._searchCache.validate(e),this.validateCRLFWithPrevNode(o),this.computeBufferMetadata();return}if(i.nodeStartOffset+o.piece.length===e+t){this.deleteNodeTail(o,p),this.validateCRLFWithNextNode(o),this.computeBufferMetadata();return}this.shrinkNode(o,p,m),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(o,i.remainder);this.deleteNodeTail(o,l),this._searchCache.validate(e),o.piece.length===0&&a.push(o);let d=this.positionInBuffer(s,n.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=o.next();for(let p=c;p!==qe&&p!==s;p=p.next())a.push(p);let u=o.piece.length===0?o.prev():o;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let s=t.piece,a={line:s.start.line+1,column:0},l=new Xo(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);t.piece=l,e+=`
`,Vl(this,t,-1,-1),t.piece.length===0&&i.push(t)}let n=this.createNewPieces(e),o=this.rbInsertLeft(t,n[n.length-1]);for(let s=n.length-2;s>=0;s--)o=this.rbInsertLeft(o,n[s]);this.validateCRLFWithPrevNode(o),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]),o=n;for(let s=1;s<i.length;s++)o=this.rbInsertRight(o,i[s]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){let n=e.piece,o=e.piece.bufferIndex,s=this._buffers[o].lineStarts,l=s[n.start.line]+n.start.column+t,d=n.start.line,c=n.end.line,u=0,p=0,m=0;for(;d<=c&&(u=d+(c-d)/2|0,m=s[u],u!==c);)if(p=s[u+1],l<m)c=u-1;else if(l>=p)d=u+1;else break;return i?(i.line=u,i.column=l-m,null):{line:u,column:l-m}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;let n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;let o=n[i.line+1],s=n[i.line]+i.column;if(o>s+1)return i.line-t.line;let a=s-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Xy(this,e[t])}createNewPieces(e){if(e.length>Yd){let c=[];for(;e.length>Yd;){let p=e.charCodeAt(Yd-1),m;p===13||p>=55296&&p<=56319?(m=e.substring(0,Yd-1),e=e.substring(Yd-1)):(m=e.substring(0,Yd),e=e.substring(Yd));let f=Wl(m);c.push(new Xo(this._buffers.length,{line:0,column:0},{line:f.length-1,column:m.length-f[f.length-1]},f.length-1,m.length)),this._buffers.push(new Hl(m,f))}let u=Wl(e);return c.push(new Xo(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new Hl(e,u)),c}let t=this._buffers[0].buffer.length,i=Wl(e,!1),n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let c=0;c<i.length;c++)i[c]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let c=0;c<i.length;c++)i[c]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}let o=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=o-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new Xo(0,n,l,this.getLineFeedCnt(0,n,l),o-t);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let i=this.root,n="",o=this._searchCache.get2(e);if(o){i=o.node;let s=this.getAccumulatedValue(i,e-o.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(o.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(l+s,l+i.piece.length);else{let d=this.getAccumulatedValue(i,e-o.nodeStartLineNumber);return a.substring(l+s,l+d-t)}}else{let s=0,a=e;for(;i!==qe;)if(i.left!==qe&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(i,e-i.lf_left-2),d=this.getAccumulatedValue(i,e-i.lf_left-1),c=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return s+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:s,nodeStartLineNumber:a-(e-1-i.lf_left)}),c.substring(u+l,u+d-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(i,e-i.lf_left-2),d=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=d.substring(c+l,c+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,s+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==qe;){let s=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=s.substring(l,l+a-t),n}else{let a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=s.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==qe;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){let i=e.piece,n=this.positionInBuffer(e,t),o=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){let s=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(s!==o)return{index:s,remainder:0}}return{index:o,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;let i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,o=i.start.line+t+1;return o>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[o]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){let i=e.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.end),s=t,a=this.offsetInBuffer(i.bufferIndex,s),l=this.getLineFeedCnt(i.bufferIndex,i.start,s),d=l-n,c=a-o,u=i.length+c;e.piece=new Xo(i.bufferIndex,i.start,s,l,u),Vl(this,e,c,d)}deleteNodeHead(e,t){let i=e.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.start),s=t,a=this.getLineFeedCnt(i.bufferIndex,s,i.end),l=this.offsetInBuffer(i.bufferIndex,s),d=a-n,c=o-l,u=i.length+c;e.piece=new Xo(i.bufferIndex,s,i.end,a,u),Vl(this,e,c,d)}shrinkNode(e,t,i){let n=e.piece,o=n.start,s=n.end,a=n.length,l=n.lineFeedCnt,d=t,c=this.getLineFeedCnt(n.bufferIndex,n.start,d),u=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,o);e.piece=new Xo(n.bufferIndex,n.start,d,c,u),Vl(this,e,u-a,c-l);let p=new Xo(n.bufferIndex,i,s,this.getLineFeedCnt(n.bufferIndex,i,s),this.offsetInBuffer(n.bufferIndex,s)-this.offsetInBuffer(n.bufferIndex,i)),m=this.rbInsertRight(e,p);this.validateCRLFWithPrevNode(m)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let o=Wl(t,!1);for(let m=0;m<o.length;m++)o[m]+=n;if(i){let m=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-m}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=e.piece.length+t.length,c=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),p=u-c;e.piece=new Xo(e.piece.bufferIndex,e.piece.start,l,u,d),this._lastChangeBufferPos=l,Vl(this,e,t.length,p)}nodeAt(e){let t=this.root,i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==qe;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;let o={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(o),o}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==qe;)if(i.left!==qe&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){let o=this.getAccumulatedValue(i,e-i.lf_left-2),s=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(o+t-1,s),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){let o=this.getAccumulatedValue(i,e-i.lf_left-2);if(o+t-1<=i.piece.length)return{node:i,remainder:o+t-1,nodeStartOffset:n};t-=i.piece.length-o;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==qe;){if(i.piece.lineFeedCnt>0){let o=this.getAccumulatedValue(i,0),s=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,o),nodeStartOffset:s}}else if(i.piece.length>=t-1){let o=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:o}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===qe||e.piece.lineFeedCnt===0)return!1;let t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,o=i[n]+t.start.column;return n===i.length-1||i[n+1]>o+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(o)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===qe||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let i=[],n=this._buffers[e.piece.bufferIndex].lineStarts,o;e.piece.end.column===0?o={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:o={line:e.piece.end.line,column:e.piece.end.column-1};let s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Xo(e.piece.bufferIndex,e.piece.start,o,a,s),Vl(this,e,-1,-1),e.piece.length===0&&i.push(e);let l={line:t.piece.start.line+1,column:0},d=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Xo(t.piece.bufferIndex,l,t.piece.end,c,d),Vl(this,t,-1,-1),t.piece.length===0&&i.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let p=0;p<i.length;p++)Xy(this,i[p])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)Xy(this,i);else{let n=i.piece,o={line:n.start.line+1,column:0},s=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,o,n.end);i.piece=new Xo(n.bufferIndex,o,n.end,a,s),Vl(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===qe)return t(qe);let i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===qe)return"";let t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),o=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,o)}getPieceContent(e){let t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){let i=new Og(t,1);if(i.left=qe,i.right=qe,i.parent=qe,i.size_left=0,i.lf_left=0,this.root===qe)this.root=i,i.color=0;else if(e.right===qe)e.right=i,i.parent=e;else{let o=Nx(e.right);o.left=i,i.parent=o}return CO(this,i),i}rbInsertLeft(e,t){let i=new Og(t,1);if(i.left=qe,i.right=qe,i.parent=qe,i.size_left=0,i.lf_left=0,this.root===qe)this.root=i,i.color=0;else if(e.left===qe)e.left=i,i.parent=e;else{let n=vO(e.left);n.right=i,i.parent=n}return CO(this,i),i}getContentOfSubTree(e){let t="";return this.iterate(e,i=>(t+=this.getNodeContent(i),!0)),t}};var Pg=class r extends P{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new _);onDidChangeContent=this._onDidChangeContent.event;constructor(e,t,i,n,o,s,a){super(),this._BOM=t,this._mightContainNonBasicASCII=!s,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._pieceTree=new Vx(e,i,a)}equals(e){return!(e instanceof r)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let i=e+t,n=this.getPositionAt(e),o=this.getPositionAt(i);return new O(n.lineNumber,n.column,o.lineNumber,o.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";let i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn),o=0,s=this._getEndOfLine(t),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=e.endLineNumber-e.startLineNumber;o=l*d}return n-i+o}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0,n=e.startLineNumber,o=e.endLineNumber;for(let s=n;s<=o;s++){let a=this.getLineContent(s),l=s===n?e.startColumn-1:0,d=s===o?e.endColumn-1:a.length;for(let c=l;c<d;c++)Di(a.charCodeAt(c))?(i=i+1,c=c+1):i=i+1}return i+=this._getEndOfLine(t).length*(o-n),i}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=qi(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=fs(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let g=0;g<e.length;g++){let b=e[g];a&&b._isTracked&&(a=!1);let v=b.range;if(b.text){let T=!0;s||(T=!Ev(b.text),s=T),!n&&T&&(n=Rd(b.text)),!o&&T&&(o=HS(b.text))}let I="",w=0,E=0,S=0;if(b.text){let T;[w,E,S,T]=Er(b.text);let D=this.getEOL(),L=D===`\r
`?2:1;T===0||T===L?I=b.text:I=b.text.replace(/\r\n|\r|\n/g,D)}l[g]={sortIndex:g,identifier:b.identifier||null,range:v,rangeOffset:this.getOffsetAt(v.startLineNumber,v.startColumn),rangeLength:this.getValueLengthInRange(v),text:I,eolCount:w,firstLineLength:E,lastLineLength:S,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(r._sortOpsAscending);let d=!1;for(let g=0,b=l.length-1;g<b;g++){let v=l[g].range.getEndPosition(),I=l[g+1].range.getStartPosition();if(I.isBeforeOrEqual(v)){if(I.isBefore(v))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=i||t?r._getInverseEditRanges(l):[],u=[];if(t)for(let g=0;g<l.length;g++){let b=l[g],v=c[g];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let I=v.startLineNumber;I<=v.endLineNumber;I++){let w="";I===v.startLineNumber&&(w=this.getLineContent(b.range.startLineNumber),qi(w)!==-1)||u.push({lineNumber:I,oldContent:w})}}let p=null;if(i){let g=0;p=[];for(let b=0;b<l.length;b++){let v=l[b],I=c[b],w=this.getValueInRange(v.range),E=v.rangeOffset+g;g+=v.text.length-w.length,p[b]={sortIndex:v.sortIndex,identifier:v.identifier,range:I,text:w,textChange:new Zr(v.rangeOffset,w,E,v.text)}}d||p.sort((b,v)=>b.sortIndex-v.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=s;let m=this._doApplyEdits(l),f=null;if(t&&u.length>0){u.sort((g,b)=>b.lineNumber-g.lineNumber),f=[];for(let g=0,b=u.length;g<b;g++){let v=u[g].lineNumber;if(g>0&&u[g-1].lineNumber===v)continue;let I=u[g].oldContent,w=this.getLineContent(v);w.length===0||w===I||qi(w)!==-1||f.push(v)}}return this._onDidChangeContent.fire(),new Qw(p,m,f)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,i=e[0].range,n=e[e.length-1].range,o=new O(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn),s=i.startLineNumber,a=i.startColumn,l=[];for(let m=0,f=e.length;m<f;m++){let g=e[m],b=g.range;t=t||g.forceMoveMarkers,l.push(this.getValueInRange(new O(s,a,b.startLineNumber,b.startColumn))),g.text.length>0&&l.push(g.text),s=b.endLineNumber,a=b.endColumn}let d=l.join(""),[c,u,p]=Er(d);return{sortIndex:0,identifier:e[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:d,eolCount:c,firstLineLength:u,lastLineLength:p,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(r._sortOpsDescending);let t=[];for(let i=0;i<e.length;i++){let n=e[i],o=n.range.startLineNumber,s=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(o===a&&s===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);let d=new O(o,s,a,l);t.push({range:d,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let i=e.startLineNumber,n=e.startColumn,[o,s,a]=Er(t),l;if(t.length>0){let d=o+1;d===1?l=new O(i,n,i,n+s):l=new O(i,n,i+d-1,a+1)}else l=new O(i,n,i,n);return l}static _getInverseEditRanges(e){let t=[],i=0,n=0,o=null;for(let s=0,a=e.length;s<a;s++){let l=e[s],d,c;o?o.range.endLineNumber===l.range.startLineNumber?(d=i,c=n+(l.range.startColumn-o.range.endColumn)):(d=i+(l.range.startLineNumber-o.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let u;if(l.text.length>0){let p=l.eolCount+1;p===1?u=new O(d,c,d,c+l.firstLineLength):u=new O(d,c,d+p-1,l.lastLineLength+1)}else u=new O(d,c,d,c);i=u.endLineNumber,n=u.endColumn,t.push(u),o=l}return t}static _sortOpsAscending(e,t){let i=O.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){let i=O.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}};var TO=class{constructor(e,t,i,n,o,s,a,l,d){this._chunks=e;this._bom=t;this._cr=i;this._lf=n;this._crlf=o;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(e){let t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let o=0,s=i.length;o<s;o++){let a=i[o].buffer.replace(/\r\n|\r|\n/g,t),l=Wl(a);i[o]=new Hl(a,l)}let n=new Pg(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},Ng=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&US(e)&&(this.BOM=XW,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=z4(this._tmpLineStarts,e);this.chunks.push(new Hl(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Rd(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=HS(e)))}finish(e=!0){return this._finish(),new TO(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=Wl(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}};var K4=new class{clone(){return this}equals(r){return this===r}};function _O(r,e){let t=new Uint32Array(2);return t[0]=0,t[1]=(r<<0|0|0|32768|2<<24)>>>0,new ww(t,e===null?K4:e)}var Wx=class{constructor(e){this._default=e}_store=[];get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}let n=this._store.slice(0,e),o=this._store.slice(e+t),s=TY(i,this._default);this._store=n.concat(s,o)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;let i=[];for(let n=0;n<t;n++)i[n]=this._default;this._store=cl(this._store,e,i)}};function TY(r,e){let t=[];for(let i=0;i<r;i++)t[i]=e;return t}var eh=class{static deserialize(e){let t=0,i=$n(e,t);t+=4;let n=[];for(let o=0;o<i;o++)t=Iy.deserialize(e,t,n);return n}_tokens;constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new Iy(e,[t]))}finalize(){return this._tokens}serialize(){let e=this._serializeSize(),t=new Uint8Array(e);return this._serialize(t),t}_serializeSize(){let e=0;e+=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;Yn(e,this._tokens.length,t),t+=4;for(let i=0;i<this._tokens.length;i++)t=this._tokens[i].serialize(e,t)}};var DO=class{constructor(e,t){this.tokenizationSupport=t;this.store=new Bg(e)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},Hx=class extends DO{constructor(t,i,n,o){super(t,i);this._textModel=n;this._languageIdCodec=o}updateTokensUntilLine(t,i){let n=this._textModel.getLanguageId();for(;;){let o=this.getFirstInvalidLine();if(!o||o.lineNumber>i)break;let s=this._textModel.getLineContent(o.lineNumber),a=Fg(this._languageIdCodec,n,this.tokenizationSupport,s,!0,o.startState);t.add(o.lineNumber,a.tokens),this.store.setEndState(o.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(t,i){let n=this.getStartState(t.lineNumber);if(!n)return 0;let o=this._textModel.getLanguageId(),s=this._textModel.getLineContent(t.lineNumber),a=s.substring(0,t.column-1)+i+s.substring(t.column-1),l=Fg(this._languageIdCodec,o,this.tokenizationSupport,a,!0,n),d=new Xi(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(t.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(t,i){let n=this.getStartState(t);if(!n)return{mainLineTokens:null,additionalLines:null};let o=this._textModel.getLineContent(t),s=i.lineEdit.apply(o),a=this._textModel.getLanguageIdAtPosition(t,0),l=Fg(this._languageIdCodec,a,this.tokenizationSupport,s,!0,n),d=null;if(i.additionalLines){d=[];let u=l.endState;for(let p of i.additionalLines){let m=Fg(this._languageIdCodec,a,this.tokenizationSupport,p,!0,u);d.push(new Xi(m.tokens,p,this._languageIdCodec)),u=m.endState}}return{mainLineTokens:new Xi(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(t){let i=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<i}isCheapToTokenize(t){let i=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<i||t===i&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,i,n){if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,n),{heuristicTokens:!1};let o=this.guessStartState(i),s=this._textModel.getLanguageId();for(let a=i;a<=n;a++){let l=this._textModel.getLineContent(a),d=Fg(this._languageIdCodec,s,this.tokenizationSupport,l,!0,o);t.add(a,d.tokens),o=d.endState}return{heuristicTokens:!0}}guessStartState(t){let i=this._textModel.getLineFirstNonWhitespaceColumn(t),n=[],o=null;for(let l=t-1;i>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<i&&(n.push(this._textModel.getLineContent(l)),i=d,o=this.getStartState(l),o))break}o||(o=this.tokenizationSupport.getInitialState()),n.reverse();let s=this._textModel.getLanguageId(),a=o;for(let l of n)a=Fg(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},Bg=class{constructor(e){this.lineCount=e;this._invalidEndStatesLineNumbers.addRange(new Be(1,e+1))}_tokenizationStateStore=new LO;_invalidEndStatesLineNumbers=new kO;getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new Je("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Be(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new Be(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[i]=Er(t.text);this.acceptChange(new Fe(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new Be(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;let i=this.getStartState(t,e);if(!i)throw new Je("Start state must be defined");return{lineNumber:t,startState:i}}},LO=class{_lineEndStates=new Wx(null);getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}acceptChanges(e){for(let t of e){let[i]=Er(t.text);this.acceptChange(new Fe(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}},kO=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new Be(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){let i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new Be(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new Be(i.start,e):this._ranges.splice(t,1,new Be(i.start,e),new Be(e+1,i.endExclusive))}}addRange(e){Be.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||e.endExclusive<this._ranges[n].start);)n++;let o=t-e.length;for(let s=n;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(o);if(i===n){let s=new Be(e.start,e.start+t);s.isEmpty||this._ranges.splice(i,0,s)}else{let s=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[n-1].endExclusive),l=new Be(s,a+o);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}};function Fg(r,e,t,i,n,o){let s=null;if(t)try{s=t.tokenizeEncoded(i,n,o.clone())}catch(a){Ge(a)}return s||(s=_O(r.encodeLanguageId(e),o)),Xi.convertToEndOffset(s.tokens,i.length),s}var Ux=class{constructor(e,t){this._tokenizerWithStateStore=e;this._backgroundTokenStore=t}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Bc(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?mS(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new eh,i=Sa.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Fe(e,t))}};var zx=class{_onDidChangeVisibleRanges=new _;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let e=new RO(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}},RO=class{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){let i=e.map(n=>new Fe(n.startLineNumber,n.endLineNumber+1));this.handleStateChange({visibleLineRanges:i,stabilized:t})}},Kx=class extends P{constructor(t){super();this._refreshTokens=t}runner=this._register(new Kt(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){li(this._computedLineRanges,this._lineRanges,(t,i)=>t.equals(i))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},Vg=class extends P{constructor(t,i,n){super();this._languageIdCodec=t;this._textModel=i;this.getLanguageId=n}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new _);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new _);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}};var G4=Z("treeSitterParserService");var Qy=class extends Vg{constructor(t,i,n,o){super(i,n,o);this._treeSitterService=t;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let t=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==t)&&(this._lastLanguageId=t,this._tokenizationSupport=Ey.get(t))}getLineTokens(t){let i=this._textModel.getLineContent(t);if(this._tokenizationSupport){let n=this._tokenizationSupport.tokenizeEncoded(t,this._textModel);if(n)return new Xi(n,i,this._languageIdCodec)}return Xi.createEmpty(i,this._languageIdCodec)}resetTokenization(t=!0){t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(t){t.isFlush&&this.resetTokenization(!1)}forceTokenization(t){}hasAccurateTokensForLine(t){return!0}isCheapToTokenize(t){return!0}getTokenTypeIfInsertingCharacter(t,i,n){return 0}tokenizeLineWithEdit(t,i){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var Jy=class r{_lineTokens;_len;_languageIdCodec;constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let n=null;if(t<this._len&&(n=this._lineTokens[t]),n!==null&&n!==Ol)return new Xi(Pl(n),i,this._languageIdCodec);let o=new Uint32Array(2);return o[0]=i.length,o[1]=j4(this._languageIdCodec.encodeLanguageId(e)),new Xi(o,i,this._languageIdCodec)}static _massageTokens(e,t,i){let n=i?Pl(i):null;if(t===0){let o=!1;if(n&&n.length>1&&(o=Xr.getLanguageId(n[1])!==e),!o)return Ol}if(!n||n.length===0){let o=new Uint32Array(2);return o[0]=t,o[1]=j4(e),o.buffer}return n[n.length-2]=t,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let i=[];for(let n=0;n<t;n++)i[n]=null;this._lineTokens=cl(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,n,o){let s=r._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,n);this._ensureLine(t);let a=this._lineTokens[t];return this._lineTokens[t]=s,o?!r._equals(a,s):!1}static _equals(e,t){if(!e||!t)return!e&&!t;let i=Pl(e),n=Pl(t);if(i.length!==n.length)return!1;for(let o=0,s=i.length;o<s;o++)if(i[o]!==n[o])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new F(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){let t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=Zn.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=Zn.deleteEnding(this._lineTokens[t],e.startColumn-1);let i=e.endLineNumber-1,n=null;i<this._len&&(n=Zn.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=Zn.append(this._lineTokens[t],n),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;let n=e.lineNumber-1;if(!(n>=this._len)){if(t===0){this._lineTokens[n]=Zn.insert(this._lineTokens[n],e.column-1,i);return}this._lineTokens[n]=Zn.deleteEnding(this._lineTokens[n],e.column-1),this._lineTokens[n]=Zn.insert(this._lineTokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};let i=[];for(let n=0,o=e.length;n<o;n++){let s=e[n],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}};function j4(r){return(r<<0|0|0|32768|2<<24|1024)>>>0}var Gx=class r{_pieces;_isComplete;_languageIdCodec;constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let i=e;if(t.length>0){let o=t[0].getRange(),s=t[t.length-1].getRange();if(!o||!s)return e;i=e.plusRange(o).plusRange(s)}let n=null;for(let o=0,s=this._pieces.length;o<s;o++){let a=this._pieces[o];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(o,1),o--,s--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};continue}let[l,d]=a.split(i);if(l.isEmpty()){n=n||{index:o};continue}d.isEmpty()||(this._pieces.splice(o,1,l,d),o++,s++,n=n||{index:o})}return n=n||{index:this._pieces.length},t.length>0&&(this._pieces=cl(this._pieces,n.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;let i=this._pieces;if(i.length===0)return t;let n=r._findFirstPieceWithLine(i,e),o=i[n].getLineTokens(e);if(!o)return t;let s=t.getCount(),a=o.getCount(),l=0,d=[],c=0,u=0,p=(m,f)=>{m!==u&&(u=m,d[c++]=m,d[c++]=f)};for(let m=0;m<a;m++){let f=o.getStartCharacter(m),g=o.getEndCharacter(m),b=o.getMetadata(m),v=((b&1?2048:0)|(b&2?4096:0)|(b&4?8192:0)|(b&8?16384:0)|(b&16?16744448:0)|(b&32?4278190080:0))>>>0,I=~v>>>0;for(;l<s&&t.getEndOffset(l)<=f;)p(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<s&&t.getStartOffset(l)<f&&p(f,t.getMetadata(l));l<s&&t.getEndOffset(l)<g;)p(t.getEndOffset(l),t.getMetadata(l)&I|b&v),l++;if(l<s)p(g,t.getMetadata(l)&I|b&v),t.getEndOffset(l)===g&&l++;else{let w=Math.min(Math.max(0,l-1),s-1);p(g,t.getMetadata(w)&I|b&v)}}for(;l<s;)p(t.getEndOffset(l),t.getMetadata(l)),l++;return new Xi(new Uint32Array(d),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,n=e.length-1;for(;i<n;){let o=i+Math.floor((n-i)/2);if(e[o].endLineNumber<t)i=o+1;else if(e[o].startLineNumber>t)n=o-1;else{for(;o>i&&e[o-1].startLineNumber<=t&&t<=e[o-1].endLineNumber;)o--;return o}}return i}acceptEdit(e,t,i,n,o){for(let s of this._pieces)s.acceptEdit(e,t,i,n,o)}};var Zd=class extends Rg{constructor(t,i,n,o,s,a,l){super();this._textModel=t;this._bracketPairsTextModelPart=i;this._languageId=n;this._attachedViews=o;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(z.filter(Ey.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new Gx(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new _);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new _);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new _);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new Y);createGrammarTokens(){return this._register(new jx(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new Qy(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(t){let i=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=t?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(n=>{this._emitModelTokensChangedEvent(n)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(n=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),i&&this._tokens.resetTokenization()}createPreferredTokenProvider(){Ey.get(this._languageId)?this._tokens instanceof Qy||this.createTokens(!0):this._tokens instanceof jx||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(t){t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(let i of t.changes){let[n,o,s]=Er(i.text);this._semanticTokens.acceptEdit(i.range,n,o,s,i.text.length>0?i.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(t)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);let i=this._tokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,i)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new Je("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this._tokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this._tokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this._tokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this._tokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,i,n){return this._tokens.getTokenTypeIfInsertingCharacter(t,i,n)}tokenizeLineWithEdit(t,i){return this._tokens.tokenizeLineWithEdit(t,i)}setSemanticTokens(t,i){this._semanticTokens.set(t,i),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,i){if(this.hasCompleteSemanticTokens())return;let n=this._textModel.validateRange(this._semanticTokens.setPartial(t,i));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:n.startLineNumber,toLineNumber:n.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();let i=this._textModel.validatePosition(t),n=this._textModel.getLineContent(i.lineNumber),o=this.getLineTokens(i.lineNumber),s=o.findTokenIndexAtOffset(i.column-1),[a,l]=Zd._findLanguageBoundaries(o,s),d=my(i.column,this.getLanguageConfiguration(o.getLanguageId(s)).getWordDefinition(),n.substring(a,l),a);if(d&&d.startColumn<=t.column&&t.column<=d.endColumn)return d;if(s>0&&a===i.column-1){let[c,u]=Zd._findLanguageBoundaries(o,s-1),p=my(i.column,this.getLanguageConfiguration(o.getLanguageId(s-1)).getWordDefinition(),n.substring(c,u),c);if(p&&p.startColumn<=t.column&&t.column<=p.endColumn)return p}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,i){let n=t.getLanguageId(i),o=0;for(let a=i;a>=0&&t.getLanguageId(a)===n;a--)o=t.getStartOffset(a);let s=t.getLineContent().length;for(let a=i,l=t.getCount();a<l&&t.getLanguageId(a)===n;a++)s=t.getEndOffset(a);return[o,s]}getWordUntilPosition(t){let i=this.getWordAtPosition(t);return i?{word:i.word.substr(0,t.column-i.startColumn),startColumn:i.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,i){let n=this._textModel.validatePosition(new F(t,i)),o=this.getLineTokens(n.lineNumber);return o.getLanguageId(o.findTokenIndexAtOffset(n.column-1))}setLanguageId(t,i="api"){if(this._languageId===t)return;let n={oldLanguage:this._languageId,newLanguage:t,source:i};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(n),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(n),this._onDidChangeLanguageConfiguration.fire({})}};Zd=R([y(4,Ki),y(5,zd),y(6,G4)],Zd);var jx=class extends Vg{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new xt);_tokens=new Jy(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new xt);_attachedViewStates=this._register(new br);constructor(e,t,i,n){super(e,t,i),this._register(Qr.onDidChange(o=>{let s=this.getLanguageId();o.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:o,state:s})=>{if(s){let a=this._attachedViewStates.get(o);a||(a=new Kx(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(o,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(o)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new Bg(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let o=Qr.get(this.getLanguageId());if(!o)return[null,null];let s;try{s=o.getInitialState()}catch(a){return Ge(a),[null,null]}return[o,s]},[i,n]=t();if(i&&n?this._tokenizer=new Hx(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let o={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,o)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new Ux(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),i?.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new Jy(this._languageIdCodec),this._debugBackgroundStates=new Bg(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(let t of e.changes){let[i,n]=Er(t.text);this._tokens.acceptEdit(t.range,i,n),this._debugBackgroundTokens?.acceptEdit(t.range,i,n)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){let{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){let e=Fe.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(let t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);let i=new eh,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,e,t),o=this.setTokens(i.finalize());if(n)for(let s of o.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){let t=new eh;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){let t=this._textModel.getLineContent(e),i=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){let n=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!i.equals(n)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return i}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;let n=this._textModel.validatePosition(new F(e,t));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLineWithEdit(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLineWithEdit(e,t)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function VO(r){let e=new Ng;return e.acceptChunk(r),e.finish()}function Z4(r){return new Promise((e,t)=>{let i=new Ng,n=!1;ey(r,{onData:o=>{i.acceptChunk(typeof o=="string"?o:o.toString())},onError:o=>{n||(n=!0,t(o))},onEnd:()=>{n||(n=!0,e(i.finish()))}})})}function _Y(r){let e=new Ng,t;for(;typeof(t=r.read())=="string";)e.acceptChunk(t);return e.finish()}function q4(r,e){let t;return typeof r=="string"?t=VO(r):JU(r)?t=_Y(r):t=r,t.create(e)}var qx=0,DY=999,LY=1e4,MO=class{_source;_eos;constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,i=0;do{let n=this._source.read();if(n===null)return this._eos=!0,t===0?null:e.join("");if(n.length>0&&(e[t++]=n,i+=n.length),i>=64*1024)return e.join("")}while(!0)}},eI=()=>{throw new Error("Invalid change accessor")};var zl=class extends P{constructor(t,i,n,o=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;qx++,this.id="$model"+qx,this.isForSimpleWidget=n.isForSimpleWidget,typeof o>"u"||o===null?this._associatedResource=X.parse("inmemory://model/"+qx):this._associatedResource=o,this._attachedEditorCount=0;let{textBuffer:c,disposable:u}=q4(t,n.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=zl.resolveOptions(this._buffer,n);let p=typeof i=="string"?i:i.languageId;typeof i!="string"&&(this._languageSelectionListener.value=i.onDidChange(()=>this._setLanguage(i.languageId))),this._bracketPairs=this._register(new dx(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new Ox(this,this._languageConfigurationService)),this._decorationProvider=this._register(new kx(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(Zd,this,this._bracketPairs,p,this._attachedViews);let m=this._buffer.getLineCount(),f=this._buffer.getValueLengthInRange(new O(1,1,m,this._buffer.getLineLength(m)+1),0);n.largeFileOptimizations?(this._isTooLargeForTokenization=f>zl.LARGE_FILE_SIZE_THRESHOLD||m>zl.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=f>zl.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=f>zl._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=zS(qx),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new Yx,this._commandManager=new Mx(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(g=>{this._bracketPairs.handleLanguageConfigurationServiceChange(g),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(g)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Ll.tabSize,indentSize:Ll.indentSize,insertSpaces:Ll.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Ll.trimAutoWhitespace,largeFileOptimizations:Ll.largeFileOptimizations,bracketPairColorizationOptions:Ll.bracketPairColorizationOptions};static resolveOptions(t,i){if(i.detectIndentation){let n=gO(t,i.tabSize,i.insertSpaces);return new ug({tabSize:n.tabSize,indentSize:"tabSize",insertSpaces:n.insertSpaces,trimAutoWhitespace:i.trimAutoWhitespace,defaultEOL:i.defaultEOL,bracketPairColorizationOptions:i.bracketPairColorizationOptions})}return new ug(i)}_onWillDispose=this._register(new _);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new FO(t=>this.handleBeforeFireDecorationsChangedEvent(t)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new _);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new _);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new _);_eventEmitter=this._register(new BO);onDidChangeContent(t){return this._eventEmitter.slowEvent(i=>t(i.contentChangedEvent))}onDidChangeContentOrInjectedText(t){return un(this._eventEmitter.fastEvent(i=>t(i)),this._onDidChangeInjectedText.event(i=>t(i)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new xt);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new zx;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let t=new Pg([],"",`
`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=P.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new Je("Model is disposed!")}equalsTextBuffer(t){return this._assertNotDisposed(),this._buffer.equals(t)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(t,i){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(i),this._bracketPairs.handleDidChangeContent(i),this._eventEmitter.fire(new du(t,i)))}setValue(t){if(this._assertNotDisposed(),t==null)throw ap();let{textBuffer:i,disposable:n}=q4(t,this._options.defaultEOL);this._setValueFromTextBuffer(i,n)}_createContentChanged2(t,i,n,o,s,a,l,d){return{changes:[{range:t,rangeOffset:i,rangeLength:n,text:o}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(t,i){this._assertNotDisposed();let n=this.getFullModelRange(),o=this.getValueLengthInRange(n),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=i,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new Yx,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new $p([new jw],this._versionId,!1,!1),this._createContentChanged2(new O(1,1,s,a),0,o,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();let i=t===1?`\r
`:`
`;if(this._buffer.getEOL()===i)return;let n=this.getFullModelRange(),o=this.getValueLengthInRange(n),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(i),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new $p([new Yw],this._versionId,!1,!1),this._createContentChanged2(new O(1,1,s,a),0,o,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let t=this.getVersionId(),i=this._decorationsTree.collectNodesPostOrder();for(let n=0,o=i.length;n<o;n++){let s=i[n],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=t,s.start=d-l,s.end=c-l,jd(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,i=0,n=this._buffer.getLineCount();for(let o=1;o<=n;o++){let s=this._buffer.getLineLength(o);s>=LY?i+=s:t+=s}return i>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();let i=typeof t.tabSize<"u"?t.tabSize:this._options.tabSize,n=typeof t.indentSize<"u"?t.indentSize:this._options.originalIndentSize,o=typeof t.insertSpaces<"u"?t.insertSpaces:this._options.insertSpaces,s=typeof t.trimAutoWhitespace<"u"?t.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof t.bracketColorizationOptions<"u"?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new ug({tabSize:i,indentSize:n,insertSpaces:o,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(t,i){this._assertNotDisposed();let n=gO(this._buffer,i,t);this.updateOptions({insertSpaces:n.insertSpaces,tabSize:n.tabSize,indentSize:n.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),ox(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){let i=this.findMatches(w0.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,i.map(n=>({range:n.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();let i=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(i.lineNumber,i.column)}getPositionAt(t){this._assertNotDisposed();let i=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(i)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,i=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Je("Operation would exceed heap memory limits");let n=this.getFullModelRange(),o=this.getValueInRange(n,t);return i?this._buffer.getBOM()+o:o}createSnapshot(t=!1){return new MO(this._buffer.createSnapshot(t))}getValueLength(t,i=!1){this._assertNotDisposed();let n=this.getFullModelRange(),o=this.getValueLengthInRange(n,t);return i?this._buffer.getBOM().length+o:o}getValueInRange(t,i=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),i)}getValueLengthInRange(t,i=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),i)}getCharacterCountInRange(t,i=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),i)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Je("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Je("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Je("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Je("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Je("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Je("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){let i=this._buffer.getLineCount(),n=t.startLineNumber,o=t.startColumn,s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=Math.floor(typeof o=="number"&&!isNaN(o)?o:1);if(s<1)s=1,a=1;else if(s>i)s=i,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let p=this.getLineMaxColumn(s);a>=p&&(a=p)}let l=t.endLineNumber,d=t.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),u=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,u=1;else if(c>i)c=i,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{let p=this.getLineMaxColumn(c);u>=p&&(u=p)}return n===s&&o===a&&l===c&&d===u&&t instanceof O&&!(t instanceof tt)?t:new O(s,a,c,u)}_isValidPosition(t,i,n){if(typeof t!="number"||typeof i!="number"||isNaN(t)||isNaN(i)||t<1||i<1||(t|0)!==t||(i|0)!==i)return!1;let o=this._buffer.getLineCount();if(t>o)return!1;if(i===1)return!0;let s=this.getLineMaxColumn(t);if(i>s)return!1;if(n===1){let a=this._buffer.getLineCharCode(t,i-2);if(Di(a))return!1}return!0}_validatePosition(t,i,n){let o=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=this._buffer.getLineCount();if(o<1)return new F(1,1);if(o>a)return new F(a,this.getLineMaxColumn(a));if(s<=1)return new F(o,1);let l=this.getLineMaxColumn(o);if(s>=l)return new F(o,l);if(n===1){let d=this._buffer.getLineCharCode(o,s-2);if(Di(d))return new F(o,s-1)}return new F(o,s)}validatePosition(t){let i=1;return this._assertNotDisposed(),t instanceof F&&this._isValidPosition(t.lineNumber,t.column,i)?t:this._validatePosition(t.lineNumber,t.column,i)}_isValidRange(t,i){let n=t.startLineNumber,o=t.startColumn,s=t.endLineNumber,a=t.endColumn;if(!this._isValidPosition(n,o,0)||!this._isValidPosition(s,a,0))return!1;if(i===1){let l=o>1?this._buffer.getLineCharCode(n,o-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=Di(l),u=Di(d);return!c&&!u}return!0}validateRange(t){let i=1;if(this._assertNotDisposed(),t instanceof O&&!(t instanceof tt)&&this._isValidRange(t,i))return t;let n=this._validatePosition(t.startLineNumber,t.startColumn,0),o=this._validatePosition(t.endLineNumber,t.endColumn,0),s=n.lineNumber,a=n.column,l=o.lineNumber,d=o.column;if(i===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,u=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,p=Di(c),m=Di(u);return!p&&!m?new O(s,a,l,d):s===l&&a===d?new O(s,a-1,l,d-1):p&&m?new O(s,a-1,l,d+1):p?new O(s,a-1,l,d):new O(s,a,l,d+1)}return new O(s,a,l,d)}modifyPosition(t,i){this._assertNotDisposed();let n=this.getOffsetAt(t)+i;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,n)))}getFullModelRange(){this._assertNotDisposed();let t=this.getLineCount();return new O(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,i,n,o){return this._buffer.findMatchesLineByLine(t,i,n,o)}findMatches(t,i,n,o,s,a,l=DY){this._assertNotDisposed();let d=null;i!==null&&(Array.isArray(i)||(i=[i]),i.every(p=>O.isIRange(p))&&(d=i.map(p=>this.validateRange(p)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((p,m)=>p.startLineNumber-m.startLineNumber||p.startColumn-m.startColumn);let c=[];c.push(d.reduce((p,m)=>O.areIntersecting(p,m)?p.plusRange(m):(c.push(p),m)));let u;if(!n&&t.indexOf(`
`)<0){let m=new $d(t,n,o,s).parseSearchRequest();if(!m)return[];u=f=>this.findMatchesLineByLine(f,m,a,l)}else u=p=>Qp.findMatches(this,new $d(t,n,o,s),p,a,l);return c.map(u).reduce((p,m)=>p.concat(m),[])}findNextMatch(t,i,n,o,s,a){this._assertNotDisposed();let l=this.validatePosition(i);if(!n&&t.indexOf(`
`)<0){let c=new $d(t,n,o,s).parseSearchRequest();if(!c)return null;let u=this.getLineCount(),p=new O(l.lineNumber,l.column,u,this.getLineMaxColumn(u)),m=this.findMatchesLineByLine(p,c,a,1);return Qp.findNextMatch(this,new $d(t,n,o,s),l,a),m.length>0||(p=new O(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),m=this.findMatchesLineByLine(p,c,a,1),m.length>0)?m[0]:null}return Qp.findNextMatch(this,new $d(t,n,o,s),l,a)}findPreviousMatch(t,i,n,o,s,a){this._assertNotDisposed();let l=this.validatePosition(i);return Qp.findPreviousMatch(this,new $d(t,n,o,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`
`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof pg?t:new pg(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){let i=[];for(let n=0,o=t.length;n<o;n++)i[n]=this._validateEditOperation(t[n]);return i}pushEditOperations(t,i,n,o){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(i),n,o)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,i,n,o){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=i.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(t)for(let l=0,d=t.length;l<d;l++){let c=t[l],u=!1;for(let p=0,m=s.length;p<m;p++){let f=s[p].range,g=f.startLineNumber>c.endLineNumber,b=c.startLineNumber>f.endLineNumber;if(!g&&!b){u=!0;break}}if(!u){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],u=this.getLineMaxColumn(c),p=!0;for(let m=0,f=s.length;m<f;m++){let g=s[m].range,b=s[m].text;if(!(c<g.startLineNumber||c>g.endLineNumber)&&!(c===g.startLineNumber&&g.startColumn===u&&g.isEmpty()&&b&&b.length>0&&b.charAt(0)===`
`)&&!(c===g.startLineNumber&&g.startColumn===1&&g.isEmpty()&&b&&b.length>0&&b.charAt(b.length-1)===`
`)){p=!1;break}}if(p){let m=new O(c,1,c,u);i.push(new pg(null,m,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,i,n,o)}_applyUndo(t,i,n,o){let s=t.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new O(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,i,!0,!1,n,o)}_applyRedo(t,i,n,o){let s=t.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new O(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,i,!1,!0,n,o)}_applyUndoRedoEdits(t,i,n,o,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=n,this._isRedoing=o,this.applyEdits(t,!1),this.setEOL(i),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,i=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let n=this._validateEditOperations(t);return this._doApplyEdits(n,i)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,i){let n=this._buffer.getLineCount(),o=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,i),s=this._buffer.getLineCount(),a=o.changes;if(this._trimAutoWhitespaceLines=o.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,u=a.length;c<u;c++){let p=a[c];this._decorationsTree.acceptReplace(p.rangeOffset,p.rangeLength,p.text.length,p.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=n;for(let c=0,u=a.length;c<u;c++){let p=a[c],[m]=Er(p.text);this._onDidChangeDecorations.fire();let f=p.range.startLineNumber,g=p.range.endLineNumber,b=g-f,v=m,I=Math.min(b,v),w=v-b,E=s-d-w+f,S=E,T=E+v,D=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new F(S,1)),this.getOffsetAt(new F(T,this.getLineMaxColumn(T))),0),L=Tr.fromDecorations(D),A=new Do(L);for(let W=I;W>=0;W--){let j=f+W,G=E+W;A.takeFromEndWhile(_e=>_e.lineNumber>G);let oe=A.takeFromEndWhile(_e=>_e.lineNumber===G);l.push(new Oy(j,this.getLineContent(G),oe))}if(I<b){let W=f+I;l.push(new qw(W+1,g))}if(I<v){let W=new Do(L),j=f+I,G=v-I,oe=s-d-G+j+1,_e=[],re=[];for(let ne=0;ne<G;ne++){let ge=oe+ne;re[ne]=this.getLineContent(ge),W.takeWhile(de=>de.lineNumber<ge),_e[ne]=W.takeWhile(de=>de.lineNumber===ge)}l.push(new $w(j+1,f+v,re,_e))}d+=w}this._emitContentChangedEvent(new $p(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return o.reverseEdits===null?void 0:o.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;let n=Array.from(t).map(o=>new Oy(o,this.getLineContent(o),this._getInjectedTextInLine(o)));this._onDidChangeInjectedText.fire(new cg(n))}changeDecorations(t,i=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(i,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,i){let n={addDecoration:(s,a)=>this._deltaDecorationsImpl(t,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,Y4(a))},removeDecoration:s=>{this._deltaDecorationsImpl(t,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(t,s,a)},o=null;try{o=i(n)}catch(s){Ge(s)}return n.addDecoration=eI,n.changeDecoration=eI,n.changeDecorationOptions=eI,n.removeDecoration=eI,n.deltaDecorations=eI,o}deltaDecorations(t,i,n=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&i.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Ge(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(n,t,i)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,i,n){let o=t?this._decorations[t]:null;if(!o)return i?this._deltaDecorationsImpl(0,[],[{range:i,options:$4[n]}],!0)[0]:null;if(!i)return this._decorationsTree.delete(o),delete this._decorations[o.id],null;let s=this._validateRangeRelaxedNoAllocations(i),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(o),o.reset(this.getVersionId(),a,l,s),o.setOptions($4[n]),this._decorationsTree.insert(o),o.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;let i=this._decorationsTree.collectNodesFromOwner(t);for(let n=0,o=i.length;n<o;n++){let s=i[n];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(t){let i=this._decorations[t];return i?i.options:null}getDecorationRange(t){let i=this._decorations[t];return i?this._decorationsTree.getNodeRange(this,i):null}getLineDecorations(t,i=0,n=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,i,n)}getLinesDecorations(t,i,n=0,o=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,t)),d=Math.min(a,Math.max(1,i)),c=this.getLineMaxColumn(d),u=new O(l,1,d,c),p=this._getDecorationsInRange(u,n,o,s);return iv(p,this._decorationProvider.getDecorationsInRange(u,n,o)),p}getDecorationsInRange(t,i=0,n=!1,o=!1,s=!1){let a=this.validateRange(t),l=this._getDecorationsInRange(a,i,n,s);return iv(l,this._decorationProvider.getDecorationsInRange(a,i,n,o)),l}getOverviewRulerDecorations(t=0,i=!1){return this._decorationsTree.getAll(this,t,i,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){let i=this._buffer.getOffsetAt(t,1),n=i+this._buffer.getLineLength(t),o=this._decorationsTree.getInjectedTextInInterval(this,i,n,0);return Tr.fromDecorations(o).filter(s=>s.lineNumber===t)}getAllDecorations(t=0,i=!1){let n=this._decorationsTree.getAll(this,t,i,!1,!1);return n=n.concat(this._decorationProvider.getAllDecorations(t,i)),n}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,i,n,o){let s=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),a=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,i,n,o)}getRangeAt(t,i){return this._buffer.getRangeAt(t,i-t)}_changeDecorationImpl(t,i){let n=this._decorations[t];if(!n)return;if(n.options.after){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(n.options.before){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let o=this._validateRangeRelaxedNoAllocations(i),s=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),s,a,o),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.startLineNumber)}_changeDecorationOptionsImpl(t,i){let n=this._decorations[t];if(!n)return;let o=!!(n.options.overviewRuler&&n.options.overviewRuler.color),s=!!(i.overviewRuler&&i.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(i),n.options.after||i.after){let d=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(n.options.before||i.before){let d=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=o!==s,l=RY(i)!==$x(n);a||l?(this._decorationsTree.delete(n),n.setOptions(i),this._decorationsTree.insert(n)):n.setOptions(i)}_deltaDecorationsImpl(t,i,n,o=!1){let s=this.getVersionId(),a=i.length,l=0,d=n.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let u=new Array(d);for(;l<a||c<d;){let p=null;if(l<a){do p=this._decorations[i[l++]];while(!p&&l<a);if(p){if(p.options.after){let m=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.endLineNumber)}if(p.options.before){let m=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.startLineNumber)}this._decorationsTree.delete(p),o||this._onDidChangeDecorations.checkAffectedAndFire(p.options)}}if(c<d){if(!p){let I=++this._lastDecorationId,w=`${this._instanceId};${I}`;p=new qy(w,0,0),this._decorations[w]=p}let m=n[c],f=this._validateRangeRelaxedNoAllocations(m.range),g=Y4(m.options),b=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),v=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);p.ownerId=t,p.reset(s,b,v,f),p.setOptions(g),p.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),p.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),o||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(p),u[c]=p.id,c++}else p&&delete this._decorations[p.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,i){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,i)):(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId,i)),this._setLanguage(t.languageId,i))}_setLanguage(t,i){this.tokenization.setLanguageId(t,i),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,i){return this.tokenization.getLanguageIdAtPosition(t,i)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,i){return t}getLineIndentColumn(t){return kY(this.getLineContent(t))+1}};zl=R([y(4,QU),y(5,Ki),y(6,zd),y(7,ve)],zl);function kY(r){let e=0;for(let t of r)if(t===" "||t==="	")e++;else break;return e}function AO(r){return!!(r.options.overviewRuler&&r.options.overviewRuler.color)}function RY(r){return!!r.after||!!r.before}function $x(r){return!!r.options.after||!!r.options.before}var Yx=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new Mg,this._decorationsTree1=new Mg,this._injectedTextDecorationsTree=new Mg}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(let i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,n,o,s){let a=e.getVersionId(),l=this._intervalSearch(t,i,n,o,a,s);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,i,n,o,s){let a=this._decorationsTree0.intervalSearch(e,t,i,n,o,s),l=this._decorationsTree1.intervalSearch(e,t,i,n,o,s),d=this._injectedTextDecorationsTree.intervalSearch(e,t,i,n,o,s);return a.concat(l).concat(d)}getInjectedTextInInterval(e,t,i,n){let o=e.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(t,i,n,!1,o,!1);return this._ensureNodesHaveRanges(e,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){let i=e.getVersionId(),n=this._injectedTextDecorationsTree.search(t,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(o=>o.options.showIfCollapsed||!o.range.isEmpty())}getAll(e,t,i,n,o){let s=e.getVersionId(),a=this._search(t,i,n,s,o);return this._ensureNodesHaveRanges(e,a)}_search(e,t,i,n,o){if(i)return this._decorationsTree1.search(e,t,n,o);{let s=this._decorationsTree0.search(e,t,n,o),a=this._decorationsTree1.search(e,t,n,o),l=this._injectedTextDecorationsTree.search(e,t,n,o);return s.concat(a).concat(l)}}collectNodesFromOwner(e){let t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),n=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(n)}collectNodesPostOrder(){let e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){$x(e)?this._injectedTextDecorationsTree.insert(e):AO(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){$x(e)?this._injectedTextDecorationsTree.delete(e):AO(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){let i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){$x(e)?this._injectedTextDecorationsTree.resolveNode(e,t):AO(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n),this._injectedTextDecorationsTree.acceptReplace(e,t,i,n)}};function Ul(r){return r.replace(/[^a-z0-9\-_]/gi," ")}var Zx=class{color;darkColor;constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}},OO=class extends Zx{position;_resolvedColor;constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:2}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let i=e?t.getColor(e.id):null;return i?i.toString():""}},PO=class{position;persistLane;constructor(e){this.position=e?.position??2,this.persistLane=e?.persistLane}},NO=class extends Zx{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?U.fromHex(e):t.getColor(e.id)}},Xx=class r{static from(e){return e instanceof r?e:new r(e)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}},Qi=class r{static EMPTY;static register(e){return new r(e)}static createDynamic(e){return new r(e)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?Ul(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?Ul(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new OO(e.overviewRuler):null,this.minimap=e.minimap?new NO(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new PO(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?Ul(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?Ul(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?Ul(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?GW(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?Ul(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?Ul(e.marginClassName):null,this.inlineClassName=e.inlineClassName?Ul(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?Ul(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?Ul(e.afterContentClassName):null,this.after=e.after?Xx.from(e.after):null,this.before=e.before?Xx.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}};Qi.EMPTY=Qi.register({description:"empty"});var $4=[Qi.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),Qi.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),Qi.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),Qi.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function Y4(r){return r instanceof Qi?r:Qi.createDynamic(r)}var FO=class extends P{constructor(t){super();this.handleBeforeFire=t;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new _);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){this._affectsMinimap||=!!t.minimap?.position,this._affectsOverviewRuler||=!!t.overviewRuler?.color,this._affectsGlyphMargin||=!!t.glyphMarginClassName,this._affectsLineNumber||=!!t.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}},BO=class extends P{_fastEmitter=this._register(new _);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new _);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;let t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}};var ia=Z("workingCopyService"),WO=class extends P{_onDidRegister=this._register(new _);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new _);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new _);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new _);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new _);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new Cn;mapWorkingCopyToListeners=this._register(new br);registerWorkingCopy(e){let t=this.mapResourceToWorkingCopies.get(e.resource);if(t?.has(e.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${e.resource.toString()} and type ${e.typeId}.`);this._workingCopies.add(e),t||(t=new Map,this.mapResourceToWorkingCopies.set(e.resource,t)),t.set(e.typeId,e);let i=new Y;return i.add(e.onDidChangeContent(()=>this._onDidChangeContent.fire(e))),i.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),i.add(e.onDidSave(n=>this._onDidSave.fire({workingCopy:e,...n}))),this.mapWorkingCopyToListeners.set(e,i),this._onDidRegister.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e),te(()=>{this.unregisterWorkingCopy(e),this._onDidUnregister.fire(e)})}unregisterWorkingCopy(e){this._workingCopies.delete(e);let t=this.mapResourceToWorkingCopies.get(e.resource);t?.delete(e.typeId)&&t.size===0&&this.mapResourceToWorkingCopies.delete(e.resource),e.isDirty()&&this._onDidChangeDirty.fire(e),this.mapWorkingCopyToListeners.deleteAndDispose(e)}has(e){return X.isUri(e)?this.mapResourceToWorkingCopies.has(e):this.mapResourceToWorkingCopies.get(e.resource)?.has(e.typeId)??!1}get(e){return this.mapResourceToWorkingCopies.get(e.resource)?.get(e.typeId)}getAll(e){let t=this.mapResourceToWorkingCopies.get(e);if(t)return Array.from(t.values())}get hasDirty(){for(let e of this._workingCopies)if(e.isDirty())return!0;return!1}get dirtyCount(){let e=0;for(let t of this._workingCopies)t.isDirty()&&e++;return e}get dirtyWorkingCopies(){return this.workingCopies.filter(e=>e.isDirty())}get modifiedCount(){let e=0;for(let t of this._workingCopies)t.isModified()&&e++;return e}get modifiedWorkingCopies(){return this.workingCopies.filter(e=>e.isModified())}isDirty(e,t){let i=this.mapResourceToWorkingCopies.get(e);if(i){if(typeof t=="string")return i.get(t)?.isDirty()??!1;for(let[,n]of i)if(n.isDirty())return!0}return!1}};an(ia,WO,1);var na=Z("labelService");var jt=Z("telemetryService"),kHe=Z("customEndpointTelemetryService");function HO(r,e=dt){return _0(r,e)?r.charAt(0).toUpperCase()+r.slice(1):r}var X4="\u2026",tI="\\\\",iI="~";function Jx(r,e=jn){let t=new Array(r.length),i=!1;for(let n=0;n<r.length;n++){let o=r[n];if(o===""){t[n]=`.${e}`;continue}if(!o){t[n]=o;continue}i=!0;let s="",a=o;a.indexOf(tI)===0?(s=a.substr(0,a.indexOf(tI)+tI.length),a=a.substr(a.indexOf(tI)+tI.length)):a.indexOf(e)===0?(s=a.substr(0,a.indexOf(e)+e.length),a=a.substr(a.indexOf(e)+e.length)):a.indexOf(iI)===0&&(s=a.substr(0,a.indexOf(iI)+iI.length),a=a.substr(a.indexOf(iI)+iI.length));let l=a.split(e);for(let d=1;i&&d<=l.length;d++)for(let c=l.length-d;i&&c>=0;c--){i=!1;let u=l.slice(c,c+d).join(e);for(let p=0;!i&&p<r.length;p++)if(p!==n&&r[p]&&r[p].indexOf(u)>-1){let m=c+d===l.length,f=c>0&&r[p].indexOf(e)>-1?e+u:u,g=r[p].endsWith(f);i=!m||g}if(!i){let p="";(l[0].endsWith(":")||s!=="")&&(c===1&&(c=0,d++,u=l[0]+e+u),c>0&&(p=l[0]+e),p=s+p),c>0&&(p=p+X4+e),p=p+u,c+d<l.length&&(p=p+e+X4),t[n]=p}}i&&(t[n]=o)}return t}function eT(r,e){return ke||e?r.replace(/\(&&\w\)|&&/g,""):dt?r.replace(/&&|&/g,t=>t==="&"?"&&":"&"):r.replace(/&&/g,"_")}var Q4=Z("productService"),J4="vscode://schemas/vscode-product";var Io=Z("dialogService");var Wg=Z("fileDialogService");var Xd=class extends oI{_onDidChangeDirty=this._register(new _);_onDidChangeLabel=this._register(new _);_onDidChangeCapabilities=this._register(new _);_onWillDispose=this._register(new _);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(Bn(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:Li(this.resource,Mt.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var xi=class extends Xd{constructor(t,i,n,o,s){super();this.preferredName=t;this.preferredDescription=i;this.secondary=n;this.primary=o;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return xi.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(z.once(z.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let t=this.getPreferredName();return t||(this.hasIdenticalSides?this.primary.getName():h("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(t){let i=this.getPreferredDescription();return i||(this.hasIdenticalSides?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.preferredDescription}getTitle(t){let i;this.hasIdenticalSides?i=this.primary.getTitle(t)??this.getName():i=super.getTitle(t);let n=this.getPreferredTitle();return n&&(i=`${n} (${i})`),i}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,i){let n=await this.primary.save(t,i);return this.saveResultToEditor(n)}async saveAs(t,i){let n=await this.primary.saveAs(t,i);return this.saveResultToEditor(n)}saveResultToEditor(t){if(!t||!this.hasIdenticalSides)return t;if(this.primary.matches(t))return this;if(t instanceof Xd)return new xi(this.preferredName,this.preferredDescription,t,t,this.editorService);if(!Ls(t)&&!Hg(t)&&!Kl(t)&&!Gl(t))return{primary:t,secondary:t,label:this.preferredName,description:this.preferredDescription}}revert(t,i){return this.primary.revert(t,i)}async rename(t,i){if(!this.hasIdenticalSides)return;let n=await this.primary.rename(t,i);if(n){if(Bn(n.editor))return{editor:new xi(this.preferredName,this.preferredDescription,n.editor,n.editor,this.editorService),options:{...n.options,viewState:tT(this,t,this.editorService)}};if(e8(n.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:n.editor,secondary:n.editor,options:{...n.options,viewState:tT(this,t,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){let i=this.primary.toUntyped(t),n=this.secondary.toUntyped(t);if(i&&n&&!Ls(i)&&!Ls(n)&&!Hg(i)&&!Hg(n)&&!Kl(i)&&!Kl(n)&&!Gl(i)&&!Gl(n)){let o={label:this.preferredName,description:this.preferredDescription,primary:i,secondary:n};return typeof t?.preserveViewState=="number"&&(o.options={viewState:tT(this,t.preserveViewState,this.editorService)}),o}}matches(t){return this===t?!0:UO(t)||Ls(t)?!1:t instanceof xi?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):Kl(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};xi=R([y(4,vt)],xi);var zO={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function KO(r){let e=r;return!!(e&&typeof e=="object"&&Array.isArray(e.editors)&&Array.isArray(e.mru))}function t8(r){let e=r;return e.kind===5&&e.editorIndex!==void 0}function i8(r){let e=r;return e.kind===6&&e.editorIndex!==void 0&&e.context!==void 0&&e.sticky!==void 0}var Rs=class extends P{constructor(t,i,n){super();this.instantiationService=i;this.configurationService=n;KO(t)?this._id=this.deserialize(t):this._id=Rs.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new _({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t&&!t.affectsConfiguration("workbench.editor.openPositioning")&&!t.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(t,i){let n=t===0?this.mru.slice(0):this.editors.slice(0);return i?.excludeSticky?t===0?n.filter(o=>!this.isSticky(o)):n.slice(this.sticky+1):n}getEditorByIndex(t){return this.editors[t]}get activeEditor(){return this.active}isActive(t){return this.matches(this.active,t)}get previewEditor(){return this.preview}openEditor(t,i){let n=i?.sticky||typeof i?.index=="number"&&this.isSticky(i.index),o=i?.pinned||i?.sticky,s=!!i?.transient,a=i?.active||!this.activeEditor||!o&&this.preview===this.activeEditor,l=this.findEditor(t,i);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),o&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,i?.inactiveSelection??[]),i&&typeof i.index=="number"&&this.moveEditor(d,i.index),n&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=t,c=this.indexOf(this.active),u;if(i&&typeof i.index=="number"?u=i.index:this.editorOpenPositioning===zO.FIRST?(u=0,!n&&this.isSticky(u)&&(u=this.sticky+1)):this.editorOpenPositioning===zO.LAST?u=this.editors.length:(this.editorOpenPositioning===zO.LEFT?c===0||!this.editors.length?u=0:u=c:u=c+1,!n&&this.isSticky(u)&&(u=this.sticky+1)),n&&(this.sticky++,this.isSticky(u)||(u=this.sticky)),(o||!this.preview)&&this.splice(u,!1,d),s&&this.doSetTransient(d,u,!0),!o){if(this.preview){let m=this.indexOf(this.preview);u>m&&u--,this.replaceEditor(this.preview,d,u,!a)}this.preview=d}this.registerEditorListeners(d);let p={kind:5,editor:d,editorIndex:u};return this._onDidModelChange.fire(p),this.setSelection(a?d:this.activeEditor,i?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(t){let i=new Y;this.editorListeners.add(i),i.add(z.once(t.onWillDispose)(()=>{let n=this.editors.indexOf(t);if(n>=0){let o={kind:15,editor:t,editorIndex:n};this._onDidModelChange.fire(o)}})),i.add(t.onDidChangeDirty(()=>{let n={kind:14,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(n)})),i.add(t.onDidChangeLabel(()=>{let n={kind:9,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(n)})),i.add(t.onDidChangeCapabilities(()=>{let n={kind:10,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(n)})),i.add(this.onDidModelChange(n=>{n.kind===6&&n.editor?.matches(t)&&(ht(i),this.editorListeners.delete(i))}))}replaceEditor(t,i,n,o=!0){let s=this.doCloseEditor(t,1,o);if(this.splice(n,!1,i),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(t,i=0,n=!0){let o=this.doCloseEditor(t,i,n);if(o){let s={kind:6,...o};return this._onDidModelChange.fire(s),o}}doCloseEditor(t,i,n){let o=this.indexOf(t);if(o===-1)return;let s=this.editors[o],a=this.isSticky(o),l=this.active===s;if(n&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:o===this.editors.length-1?d=this.editors[o-1]:d=this.editors[o+1];let c=this.selection.filter(u=>u!==s&&u!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(o,!0),{editor:s,sticky:a,editorIndex:o,context:i}}moveEditor(t,i){i>=this.editors.length?i=this.editors.length-1:i<0&&(i=0);let n=this.indexOf(t);if(n<0||i===n)return;let o=this.editors[n],s=this.sticky;this.isSticky(n)&&i>this.sticky?this.sticky--:!this.isSticky(n)&&i<=this.sticky&&this.sticky++,this.editors.splice(n,1),this.editors.splice(i,0,o);let a={kind:7,editor:o,oldEditorIndex:n,editorIndex:i};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:o,editorIndex:i};this._onDidModelChange.fire(l)}return o}setActive(t){let i;return t?i=this.setEditorActive(t):this.setGroupActive(),i}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(t){let i=this.findEditor(t);if(!i)return;let[n,o]=i;return this.doSetSelection(n,o,[]),n}get selectedEditors(){return this.editors.filter(t=>this.doIsSelected(t))}isSelected(t){let i;return typeof t=="number"?i=this.editors[t]:i=this.findEditor(t)?.[0],!!i&&this.doIsSelected(i)}doIsSelected(t){return this.selection.includes(t)}setSelection(t,i){let n=this.findEditor(t);if(!n)return;let[o,s]=n,a=new Set;for(let l of i){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==o&&a.add(c)}this.doSetSelection(o,s,Array.from(a))}doSetSelection(t,i,n){let o=this.activeEditor,s=this.selection,a;t?a=[t,...n]:a=[],this.selection=a;let l=t&&typeof i=="number"&&o!==t;if(l){let d=this.indexOf(t,this.mru);this.mru.splice(d,1),this.mru.unshift(t);let c={kind:8,editor:t,editorIndex:i};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(t){this._onDidModelChange.fire({kind:1})}setLabel(t){this._onDidModelChange.fire({kind:2})}pin(t){let i=this.findEditor(t);if(!i)return;let[n,o]=i;return this.doPin(n,o),n}doPin(t,i){if(this.isPinned(t))return;this.setTransient(t,!1),this.preview=null;let n={kind:11,editor:t,editorIndex:i};this._onDidModelChange.fire(n)}unpin(t){let i=this.findEditor(t);if(!i)return;let[n,o]=i;return this.doUnpin(n,o),n}doUnpin(t,i){if(!this.isPinned(t))return;let n=this.preview;this.preview=t;let o={kind:11,editor:t,editorIndex:i};this._onDidModelChange.fire(o),n&&this.closeEditor(n,3)}isPinned(t){let i;return typeof t=="number"?i=this.editors[t]:i=t,!this.matches(this.preview,i)}stick(t){let i=this.findEditor(t);if(!i)return;let[n,o]=i;return this.doStick(n,o),n}doStick(t,i){if(this.isSticky(i))return;this.pin(t);let n=this.sticky+1;this.moveEditor(t,n),this.sticky++;let o={kind:13,editor:t,editorIndex:n};this._onDidModelChange.fire(o)}unstick(t){let i=this.findEditor(t);if(!i)return;let[n,o]=i;return this.doUnstick(n,o),n}doUnstick(t,i){if(!this.isSticky(i))return;let n=this.sticky;this.moveEditor(t,n),this.sticky--;let o={kind:13,editor:t,editorIndex:n};this._onDidModelChange.fire(o)}isSticky(t){if(this.sticky<0)return!1;let i;return typeof t=="number"?i=t:i=this.indexOf(t),i<0?!1:i<=this.sticky}setTransient(t,i){if(!i&&this.transient.size===0)return;let n=this.findEditor(t);if(!n)return;let[o,s]=n;return this.doSetTransient(o,s,i),o}doSetTransient(t,i,n){if(n){if(this.transient.has(t))return;this.transient.add(t)}else{if(!this.transient.has(t))return;this.transient.delete(t)}let o={kind:12,editor:t,editorIndex:i};this._onDidModelChange.fire(o)}isTransient(t){if(this.transient.size===0)return!1;let i;return typeof t=="number"?i=this.editors[t]:i=this.findEditor(t)?.[0],!!i&&this.transient.has(i)}splice(t,i,n){let o=this.editors[t];if(i&&this.isSticky(t)&&this.sticky--,n?this.editors.splice(t,i?1:0,n):this.editors.splice(t,i?1:0),!i&&n)this.mru.length===0?this.mru.push(n):this.mru.splice(1,0,n);else{let s=this.indexOf(o,this.mru);i&&!n?this.mru.splice(s,1):i&&n&&this.mru.splice(s,1,n)}}indexOf(t,i=this.editors,n){let o=-1;if(!t)return o;for(let s=0;s<i.length;s++){let a=i[s];if(this.matches(a,t,n))if(n?.supportSideBySide&&a instanceof xi&&!(t instanceof xi))o=s;else{o=s;break}}return o}findEditor(t,i){let n=this.indexOf(t,this.editors,i);if(n!==-1)return[this.editors[n],n]}isFirst(t,i=this.editors){return this.matches(i[0],t)}isLast(t,i=this.editors){return this.matches(i[i.length-1],t)}contains(t,i){return this.indexOf(t,this.editors,i)!==-1}matches(t,i,n){if(!t||!i)return!1;if(n?.supportSideBySide&&t instanceof xi&&!(i instanceof xi))switch(n.supportSideBySide){case 4:if(this.matches(t.primary,i,n)||this.matches(t.secondary,i,n))return!0;break;case 3:if(this.matches(t.primary,i,n)&&this.matches(t.secondary,i,n))return!0;break}let o=t===i;return n?.strictEquals?o:o||t.matches(i)}get isLocked(){return this.locked}lock(t){this.isLocked!==t&&(this.locked=t,this._onDidModelChange.fire({kind:3}))}clone(){let t=this.instantiationService.createInstance(Rs,void 0);t.editors=this.editors.slice(0),t.mru=this.mru.slice(0),t.preview=this.preview,t.selection=this.selection.slice(0),t.sticky=this.sticky;for(let i of t.editors)t.registerEditorListeners(i);return t}serialize(){let t=ze.as(ks.EditorFactory),i=[],n=[],o,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,u=t.getEditorSerializer(d);if(u){let p=u.canSerialize(d)?u.serialize(d):void 0;typeof p=="string"?(c=!0,n.push({id:d.typeId,value:p}),i.push(d),this.preview===d&&(o=i.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,i)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:n,mru:a,preview:o,sticky:s>=0?s:void 0}}deserialize(t){let i=ze.as(ks.EditorFactory);return typeof t.id=="number"?(this._id=t.id,Rs.IDS=Math.max(t.id+1,Rs.IDS)):this._id=Rs.IDS++,t.locked&&(this.locked=!0),this.editors=ni(t.editors.map((n,o)=>{let s,a=i.getEditorSerializer(n.id);if(a){let l=a.deserialize(this.instantiationService,n.value);l instanceof Xd&&(s=l,this.registerEditorListeners(s))}return!s&&typeof t.sticky=="number"&&o<=t.sticky&&t.sticky--,s})),this.mru=ni(t.mru.map(n=>this.editors[n])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof t.preview=="number"&&(this.preview=this.editors[t.preview]),typeof t.sticky=="number"&&(this.sticky=t.sticky),this._id}dispose(){ht(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};Rs=R([y(1,ve),y(2,He)],Rs);var vt=Z("editorService"),jO=-1,yu=-2;var qO=class{constructor(e,t,i){this.id=e;this.dependencies=t;this.callback=i}};var o8=class r{static INSTANCE=new r;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(e,t,i)=>{typeof e!="string"&&(i=t,t=e,e=null),(typeof t!="object"||!Array.isArray(t))&&(i=t,t=null),this._defineCalls.push(new qO(e,t,i))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){if(e.startsWith(window.location.origin)||e.startsWith(`${ue.vscodeFileResource}://${k0}`))return e;throw new Error(`[trusted_script_src] Invalid script url: ${e}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){return e}}))}async load(e){if(this._initialize(),this._state===3)return new Promise(s=>{let a=ru();console.log(`[amdX] Using external define("${a}", ["${e}"])`),globalThis.define(a,[e],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}let i={},n=[],o=[];if(Array.isArray(t.dependencies))for(let s of t.dependencies)s==="exports"?n.push(i):o.push(s);if(o.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${o.join(", ")}`);return typeof t.callback=="function"?t.callback(...n)??i:t.callback}_rendererLoadScript(e){return new Promise((t,i)=>{let n=document.createElement("script");n.setAttribute("async","async"),n.setAttribute("type","text/javascript");let o=()=>{n.removeEventListener("load",s),n.removeEventListener("error",a)},s=l=>{o(),t(this._defineCalls.pop())},a=l=>{o(),i(l)};n.addEventListener("load",s),n.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),n.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(n)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{let t=(await import("fs")).default,i=(await import("vm")).default,n=(await import("module")).default,o=X.parse(e).fsPath,s=t.readFileSync(o).toString(),a=n.wrap(s.replace(/^#!.*/,""));return new i.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};var YO="utf8";var O5e=512*8,P5e=512*128;var $O={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},N5e=(()=>{let r={};for(let e in $O)$O[e].guessableName&&(r[e]=$O[e]);return r})();var Ha=class extends Fa{constructor(t,i,n,o,s,a,l,d,c,u,p,m,f,g,b){super(l,a,g,b);this.resource=t;this.hasAssociatedFilePath=i;this.initialValue=n;this.preferredLanguageId=o;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=u;this.textFileService=p;this.labelService=m;this.editorService=f;this._register(this.workingCopyService.registerWorkingCopy(this)),o&&this.setLanguageId(o),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new _);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new _);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new _);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new _);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new _);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new _);onDidRevert=this._onDidRevert.event;typeId=rz;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(t=>this.onConfigurationChange(t,!0)))}onConfigurationChange(t,i){if(!t||t.affectsConfiguration(this.resource,"files.encoding")){let n=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==n&&typeof n=="string"&&(this.configuredEncoding=n,i&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!t||t.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let n=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==n&&(n==="content"||n==="name")&&(this.configuredLabelFormat=n,i&&this._onDidChangeName.fire())}}setLanguageId(t,i){let n=t===Ha.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:t;this.preferredLanguageId=n,n&&super.setLanguageId(n,i)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(t){let i=this.getEncoding();this.preferredEncoding=t,i!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(t){this.dirty!==t&&(this.dirty=t,this._onDidChangeDirty.fire())}async save(t){let i=await this.textFileService.save(this.resource,t);return i&&this._onDidSave.fire({reason:t?.reason,source:t?.source}),!!i}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(VO(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(t){let i;return this.isResolved()?i=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:YO}):typeof this.initialValue=="string"&&(i=KH(Qt.fromString(this.initialValue))),{content:i}}ignoreDirtyOnModelContentChange=!1;async resolve(){let t=!1,i=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let o,s=await this.workingCopyBackupService.resolve(this);s?(o=s.value,i=!0):o=GH(Qt.fromString(this.initialValue||""));let a=await Z4(await this.textFileService.getDecodedStream(this.resource,o,{encoding:YO}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),t=!0}let n=at(this.textEditorModel);return this.installModelListeners(n),t&&((i||this.initialValue)&&this.updateNameFromFirstLine(n),this.setDirty(this.hasAssociatedFilePath||!!i||!!this.initialValue),(i||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(t){this._register(t.onDidChangeContent(i=>this.onModelContentChanged(t,i))),this._register(t.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(t)}onModelContentChanged(t,i){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&t.getLineCount()===1&&t.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),i.changes.some(n=>(n.range.startLineNumber===1||n.range.endLineNumber===1)&&n.range.startColumn<=Ha.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(t),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(t){if(this.hasAssociatedFilePath)return;let i,n=t.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:Ha.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");n=n.substr(0,WS(n,Ha.FIRST_LINE_NAME_MAX_LENGTH)[0]),n&&hy().exec(n)&&(i=n),i!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=i,this._onDidChangeName.fire())}isReadonly(){return!1}};Ha=R([y(5,Ki),y(6,Qn),y(7,nx),y(8,_r),y(9,ia),y(10,jl),y(11,na),y(12,vt),y(13,ix),y(14,dr)],Ha);var a8=Z("untitledTextEditorService"),th=class extends P{constructor(t,i){super();this.instantiationService=t;this.configurationService=i}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new _);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new _);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new _);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new _);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new _);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new Cn;get(t){return this.mapResourceToModel.get(t)}getValue(t){return this.get(t)?.textEditorModel?.getValue()}async resolve(t){let i=this.doCreateOrGet(t);return await i.resolve(),i}create(t){return this.doCreateOrGet(t)}doCreateOrGet(t=Object.create(null)){let i=this.massageOptions(t);return i.untitledResource&&this.mapResourceToModel.has(i.untitledResource)?this.mapResourceToModel.get(i.untitledResource):this.doCreate(i)}massageOptions(t){let i=Object.create(null);if(t.associatedResource?(i.untitledResource=X.from({scheme:ue.untitled,authority:t.associatedResource.authority,fragment:t.associatedResource.fragment,path:t.associatedResource.path,query:t.associatedResource.query}),i.associatedResource=t.associatedResource):t.untitledResource?.scheme===ue.untitled&&(i.untitledResource=t.untitledResource),t.languageId)i.languageId=t.languageId;else if(!i.associatedResource){let n=this.configurationService.getValue();n.files?.defaultLanguage&&(i.languageId=n.files.defaultLanguage)}return i.encoding=t.encoding,i.initialValue=t.initialValue,i}doCreate(t){let i=t.untitledResource;if(!i){let o=1;do i=X.from({scheme:ue.untitled,path:`Untitled-${o}`}),o++;while(this.mapResourceToModel.has(i))}let n=this._register(this.instantiationService.createInstance(Ha,i,!!t.associatedResource,t.initialValue,t.languageId,t.encoding));return this.registerModel(n),n}registerModel(t){let i=new Y;i.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),i.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire(t))),i.add(t.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(t))),i.add(t.onWillDispose(()=>this._onWillDispose.fire(t))),z.once(t.onWillDispose)(()=>{this.mapResourceToModel.delete(t.resource),i.dispose()}),this.mapResourceToModel.set(t.resource,t),this._onDidCreate.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t)}isUntitledWithAssociatedResource(t){return t.scheme===ue.untitled&&t.path.length>1&&!th.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(t.path)}canDispose(t){return t.isDisposed()?!0:this.doCanDispose(t)}async doCanDispose(t){return t.isDirty()?(await z.toPromise(t.onDidChangeDirty),this.canDispose(t)):!0}};th=R([y(0,ve),y(1,He)],th);an(a8,th,1);var As=zi,Bo=Z("notificationService");var Qd=Z("progressService");var d8=Object.freeze({total(){},worked(){},done(){}}),l8=class{constructor(e){this.callback=e}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(e){this._value=e,this.callback(this._value)}};var iT=class extends P{deferred=new ys;reporter;lastStep;constructor(e,t){super(),t.withProgress(e,i=>(this.reporter=i,this.lastStep&&i.report(this.lastStep),this.deferred.p)),this._register(te(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};iT=R([y(1,Qd)],iT);var nT=class extends P{constructor(t){super();this.progressIndicator=t}currentOperationId=0;currentOperationDisposables=this._register(new Y);currentProgressRunner;currentProgressTimeout;start(t){this.stop();let i=++this.currentOperationId,n=new Vi;return this.currentProgressTimeout=setTimeout(()=>{i===this.currentOperationId&&(this.currentProgressRunner=this.progressIndicator.show(!0))},t),this.currentOperationDisposables.add(te(()=>clearTimeout(this.currentProgressTimeout))),this.currentOperationDisposables.add(te(()=>n.cancel())),this.currentOperationDisposables.add(te(()=>this.currentProgressRunner?this.currentProgressRunner.done():void 0)),{id:i,token:n.token,stop:()=>this.doStop(i),isCurrent:()=>this.currentOperationId===i}}stop(){this.doStop(this.currentOperationId)}doStop(t){this.currentOperationId===t&&this.currentOperationDisposables.clear()}},Ug=Z("editorProgressService");var ql=Z("IUriIdentityService");function ZO(r,e){return e&&(r.stack||r.stacktrace)?h("stackTrace.format","{0}: {1}",u8(r),c8(r.stack)||c8(r.stacktrace)):u8(r)}function c8(r){return Array.isArray(r)?r.join(`
`):r}function u8(r){return r.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${r.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof r.code=="string"&&typeof r.errno=="number"&&typeof r.syscall=="string"?h("nodeExceptionMessage","A system error occurred ({0})",r.message):r.message||h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function os(r=null,e=!1){if(!r)return h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(r)){let t=ni(r),i=os(t[0],e);return t.length>1?h("error.moreErrors","{0} ({1} errors in total)",i,t.length):i}if(Wi(r))return r;if(r.detail){let t=r.detail;if(t.error)return ZO(t.error,e);if(t.exception)return ZO(t.exception,e)}return r.stack?ZO(r,e):r.message?r.message:h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function oT(r){let e=r;return e instanceof Error&&Array.isArray(e.actions)}function p8(r,e){let t;return typeof r=="string"?t=new Error(r):t=r,t.actions=e,t}var Oi=Z("logService"),M8e=Z("loggerService");function rT(r){switch(r){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var O8e=new q("logLevel",rT(3));var zg=class extends P{constructor(t,i){super();this.logService=t;this.configurationService=i}participants=new ko;addFileOperationParticipant(t){let i=this.participants.push(t);return te(()=>i())}async participate(t,i,n,o){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(t,i,n,s,o)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};zg=R([y(0,Oi),y(1,He)],zg);var kr=class extends P{constructor(t,i,n,o){super();this.getExpression=t;this.shouldUpdate=i;this.contextService=n;this.configurationService=o;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new _);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{this.shouldUpdate(t)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(t){let i=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!fi(c.expression,d.expression))&&(i=!0,this.mapFolderToParsedExpression.set(l,og(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(i=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let n=new CS(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==kr.NO_FOLDER&&(n.has(X.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),i=!0));let o=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(kr.NO_FOLDER);o?(!s||!fi(s.expression,o.expression))&&(i=!0,this.mapFolderToParsedExpression.set(kr.NO_FOLDER,og(o.expression)),this.mapFolderToConfiguredExpression.set(kr.NO_FOLDER,o)):s&&(i=!0,this.mapFolderToParsedExpression.delete(kr.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(kr.NO_FOLDER)),t&&i&&this._onExpressionChange.fire()}doGetExpression(t){let i=this.getExpression(t);if(!i)return;let n=Object.keys(i);if(n.length===0)return;let o=!1,s=Object.create(null);for(let a of n){o||(o=cp(a));let l=a,d=o2(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=i[a]}return{expression:s,hasAbsolutePath:o}}matches(t,i){if(this.mapFolderToParsedExpression.size===0)return!1;let n=this.contextService.getWorkspaceFolder(t),o,s;if(n&&this.mapFolderToParsedExpression.has(n.uri.toString())?(o=this.mapFolderToParsedExpression.get(n.uri.toString()),s=this.mapFolderToConfiguredExpression.get(n.uri.toString())):(o=this.mapFolderToParsedExpression.get(kr.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(kr.NO_FOLDER)),!o)return!1;let a;return n?a=jS(n.uri,t):a=this.uriToPath(t),typeof a=="string"&&o(a,void 0,i)?!0:a!==this.uriToPath(t)&&s?.hasAbsolutePath?!!o(this.uriToPath(t),void 0,i):!1}uriToPath(t){return t.scheme===ue.file?t.fsPath:t.path}};kr=R([y(2,bi),y(3,He)],kr);var MY=new q("autoSaveAfterShortDelayContext",!1,!0);var oa=Z("filesConfigurationService"),Rr=class extends P{constructor(t,i,n,o,s,a,l,d){super();this.contextKeyService=t;this.configurationService=i;this.contextService=n;this.environmentService=o;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=i.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||gg.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=on?Na.AFTER_DELAY:Na.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:h("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:h({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:h({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:h({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:h("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new _);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new _);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new _);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new _);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new Br(1e3);autoSaveDisabledOverrides=new Cn;autoSaveAfterShortDelayContext=MY.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new kv(()=>this.createReadonlyMatcher(nz)));readonlyExcludeMatcher=this._register(new kv(()=>this.createReadonlyMatcher(oz)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new Cn(t=>this.uriIdentityService.extUri.getComparisonKey(t));createReadonlyMatcher(t){let i=this._register(new kr(n=>this.configurationService.getValue(t,{resource:n}),n=>n.affectsConfiguration(t),this.contextService,this.configurationService));return this._register(i.onExpressionChange(()=>this._onDidChangeReadonly.fire())),i}isReadonly(t,i){let n=this.fileService.getProvider(t.scheme);if(n&&ez(n))return n.readOnlyMessage??Rr.READONLY_MESSAGES.providerReadonly;let o=this.sessionReadonlyOverrides.get(t);return typeof o=="boolean"?o===!0?Rr.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(t,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(t,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(t)?this.readonlyExcludeMatcher.value.matches(t)?!1:Rr.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&i?.locked?Rr.READONLY_MESSAGES.fileLocked:i?.readonly?Rr.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(t,i){if(i==="toggle"){let n;try{n=await this.fileService.resolve(t,{resolveMetadata:!0})}catch{}i=!this.isReadonly(t,n)}i==="reset"?this.sessionReadonlyOverrides.delete(t):this.sessionReadonlyOverrides.set(t,i),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(t,i){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,t.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),i&&this._onDidChangeAutoSaveConfiguration.fire();let n=t?.files?.associations;fi(this.currentFilesAssociationConfiguration,n)||(this.currentFilesAssociationConfiguration=n,i&&this._onDidChangeFilesAssociation.fire());let o=t?.files?.hotExit;o===gg.OFF||o===gg.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=o:this.currentHotExitConfiguration=gg.ON_EXIT;let s=!!t?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,i&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(t){let i=this.toResource(t);if(i){let n=this.autoSaveConfigurationCache.get(i);return n||(n=this.computeAutoSaveConfiguration(i,this.textResourceConfigurationService.getValue(i,"files")),this.autoSaveConfigurationCache.set(i,n)),n}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(t,i){let n,o,s,a,l,d;switch(i?.autoSave??Rr.DEFAULT_AUTO_SAVE_MODE){case Na.AFTER_DELAY:{n="afterDelay",o=typeof i?.autoSaveDelay=="number"&&i.autoSaveDelay>=0?i.autoSaveDelay:Rr.DEFAULT_AUTO_SAVE_DELAY,d=o<=Rr.DEFAULT_AUTO_SAVE_DELAY;break}case Na.ON_FOCUS_CHANGE:n="onFocusChange";break;case Na.ON_WINDOW_CHANGE:n="onWindowChange";break}return i?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,t&&!this.contextService.isInsideWorkspace(t)&&(l=!0,d=void 0)),i?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:n,autoSaveDelay:o,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(t){return t instanceof Xd?Mt.getOriginalUri(t,{supportSideBySide:1}):t}hasShortAutoSaveDelay(t){let i=this.toResource(t);return this.getAutoSaveConfiguration(i).isShortAutoSaveDelay?!i||!this.autoSaveDisabledOverrides.has(i):!1}getAutoSaveMode(t,i){let n=this.toResource(t);if(n&&this.autoSaveDisabledOverrides.has(n))return{mode:0,reason:4};let o=this.getAutoSaveConfiguration(n);if(typeof o.autoSave>"u")return{mode:0,reason:1};if(typeof i=="number"&&(o.autoSave==="afterDelay"&&i!==2||o.autoSave==="onFocusChange"&&i!==3&&i!==4||o.autoSave==="onWindowChange"&&i!==4))return{mode:0,reason:1};if(n){if(o.autoSaveWorkspaceFilesOnly&&o.isOutOfWorkspace)return{mode:0,reason:2};if(o.autoSaveWhenNoErrors&&this.markerService.read({resource:n,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(o.autoSave){case"afterDelay":return typeof o.autoSaveDelay=="number"&&o.autoSaveDelay<=Rr.DEFAULT_AUTO_SAVE_DELAY?{mode:o.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let t=this.configurationService.getValue("files.autoSave"),i;return[Na.AFTER_DELAY,Na.ON_FOCUS_CHANGE,Na.ON_WINDOW_CHANGE].some(n=>n===t)?i=Na.OFF:i=Na.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",i)}disableAutoSave(t){let i=this.toResource(t);if(!i)return P.None;let n=this.autoSaveDisabledOverrides.get(i)??0;return this.autoSaveDisabledOverrides.set(i,n+1),n===0&&this._onDidChangeAutoSaveDisabled.fire(i),te(()=>{let o=this.autoSaveDisabledOverrides.get(i)??0;o<=1?(this.autoSaveDisabledOverrides.delete(i),this._onDidChangeAutoSaveDisabled.fire(i)):this.autoSaveDisabledOverrides.set(i,o-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==gg.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(t,i){return this.configurationService.getValue("files.saveConflictResolution",{resource:t,overrideIdentifier:i})!=="overwriteFileOnDisk"}};Rr=R([y(0,je),y(1,He),y(2,bi),y(3,Ts),y(4,ql),y(5,Lt),y(6,NU),y(7,_r)],Rr);an(oa,Rr,0);var QO=Z("workingCopyEditorService"),rI=class extends P{constructor(t){super();this.editorService=t}_onDidRegisterHandler=this._register(new _);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(t){return this.handlers.add(t),this._onDidRegisterHandler.fire(t),te(()=>this.handlers.delete(t))}findEditor(t){for(let i of this.editorService.getEditors(0))if(this.isOpen(t,i.editor))return i}isOpen(t,i){for(let n of this.handlers)if(n.isOpen(t,i))return!0;return!1}};rI=R([y(0,vt)],rI);an(QO,rI,1);var h8=Z("elevatedFileService");var Kg=class extends P{constructor(t,i){super();this.resource=t;this.fileService=i;this._register(this.fileService.onDidFilesChange(n=>this.onDidFilesChange(n)))}_onDidChangeOrphaned=this._register(new _);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(t){let i=!1,n;if(this.orphaned?t.contains(this.resource,1)&&(n=!1,i=!0):t.contains(this.resource,2)&&(n=!0,i=!0),i&&this.orphaned!==n){let o=!1;n&&(await hn(100,pn.None),this.isDisposed()?o=!0:o=!await this.fileService.exists(this.resource)),this.orphaned!==o&&!this.isDisposed()&&this.setOrphaned(o)}}setOrphaned(t){this.orphaned!==t&&(this.orphaned=t,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new _);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};Kg=R([y(1,Lt)],Kg);var ih=class extends Kg{constructor(t,i,n,o,s,a,l,d,c,u,p,m,f,g,b,v){super(i,a);this.typeId=t;this.name=n;this.modelFactory=o;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=u;this.notificationService=m;this.workingCopyEditorService=f;this.editorService=g;this.elevatedFileService=b;this.progressService=v;this._register(p.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new _);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new _);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new _);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new _);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new _);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new _);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new _);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(t){if(!this.isResolved())return;let i=this.dirty;this.doSetDirty(t),t!==i&&this._onDidChangeDirty.fire()}doSetDirty(t){let i=this.dirty,n=this.inConflictMode,o=this.inErrorMode,s=this.savedVersionId;return t?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=i,this.inConflictMode=n,this.inErrorMode=o,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(t){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!t?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(t)}async doResolve(t){if(t?.contents)return this.resolveFromBuffer(t.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(t)}async resolveFromBuffer(t){this.trace("resolveFromBuffer()");let i,n,o,s;try{let a=await this.fileService.stat(this.resource);i=a.mtime,n=a.ctime,o=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){i=Date.now(),n=Date.now(),o=0,s=Ny,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:i,ctime:n,size:o,etag:s,value:t,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let t=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):t?(await this.doResolveFromBackup(t),!0):!1}async doResolveFromBackup(t){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:t.meta?t.meta.mtime:Date.now(),ctime:t.meta?t.meta.ctime:Date.now(),size:t.meta?t.meta.size:0,etag:t.meta?t.meta.etag:Ny,value:t.value,readonly:!1,locked:!1},!0),t.meta&&t.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(t){this.trace("resolveFromFile()");let i=t?.forceReadFromFile,n;i?n=Ny:this.lastResolvedFileStat&&(n=this.lastResolvedFileStat.etag);let o=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:n,limits:t?.limits});if(this.setOrphaned(!1),o!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof ex&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!i)return;throw s}}async resolveFromContent(t,i){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:t.name,mtime:t.mtime,ctime:t.ctime,size:t.size,etag:t.etag,readonly:t.readonly,locked:t.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(t.value):await this.doCreateModel(t.value),this.setDirty(!!i),this._onDidResolve.fire()}async doCreateModel(t){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,t,pn.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(t){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(t,pn.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(t){this._register(t.onDidChangeContent(i=>this.onModelContentChanged(t,i.isUndoing||i.isRedoing))),this._register(t.onWillDispose(()=>this.dispose()))}onModelContentChanged(t,i){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),i&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(t.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let n=this.dirty;this.setDirty(!1),n&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(t){let i;this.lastResolvedFileStat&&(i={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let n;return this.isResolved()&&(n=await Rv(this.model.snapshot(2,t),t)),{meta:i,content:n}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new YS;ignoreSaveFromSaveParticipants=!1;async save(t=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(t.reason===2||t.reason===3||t.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(t),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(t){typeof t.reason!="number"&&(t.reason=1);let i=this.versionId;if(this.trace(`doSave(${i}) - enter with versionId ${i}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${i}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(i))return this.trace(`doSave(${i}) - exit - found a running save for versionId ${i}`),this.saveSequentializer.running;if(!t.force&&!this.dirty){this.trace(`doSave(${i}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${i}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(t));this.isResolved()&&this.model.pushStackElement();let n=new Vi;return this.progressService.withProgress({title:h("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},o=>this.doSaveSequential(i,t,o,n),()=>{n.cancel()}).finally(()=>{n.dispose()})}doSaveSequential(t,i,n,o){return this.saveSequentializer.run(t,(async()=>{if(this.isResolved()&&!i.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(i.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<ih.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await hn(ih.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!o.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:i.reason??1,savedFrom:i.from},n,o.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${t}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(o.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;t=this.versionId,this.inErrorMode=!1,n.report({message:h("saveTextFile","Writing into file...")}),this.trace(`doSave(${t}) - before write()`);let s=at(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(t,(async()=>{try{let l={mtime:s.mtime,etag:i.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?Ny:s.etag,unlock:i.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,o.token)}catch(c){if(o.token.isCancellationRequested)return;throw c}else{let c=await Rv(a.model.snapshot(1,o.token),o.token);if(o.token.isCancellationRequested)return;o.dispose(),i?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,at(c),l):d=await this.fileService.writeFile(s.resource,at(c),l)}this.handleSaveSuccess(d,t,i)}catch(l){this.handleSaveError(l,t,i)}})(),()=>o.cancel())})(),()=>o.cancel())}handleSaveSuccess(t,i,n){this.updateLastResolvedFileStat(t),i===this.versionId?(this.trace(`handleSaveSuccess(${i}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${i}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:n.reason,stat:t,source:n.source})}handleSaveError(t,i,n){if((n.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${i}) - exit - resulted in a save error: ${t.toString()}`,this.resource.toString(),this.typeId]),n.ignoreErrorHandler)throw t;this.setDirty(!0),this.inErrorMode=!0,t.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(t,n),this._onDidSaveError.fire()}doHandleSaveError(t,i){let n=t,o=[],s;if(n.fileOperationResult===3)s=h("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),o.push(co({id:"fileWorkingCopy.overwrite",label:h("overwrite","Overwrite"),run:()=>this.save({...i,ignoreModifiedSince:!0,reason:1})})),o.push(co({id:"fileWorkingCopy.revert",label:h("revert","Revert"),run:()=>this.revert()}));else{let d=n.fileOperationResult===5,c=d&&n.options?.unlock,u=n.fileOperationResult===6,p=this.elevatedFileService.isSupported(this.resource);oT(t)&&o.push(...t.actions),p&&(u||c)?o.push(co({id:"fileWorkingCopy.saveElevated",label:c?dt?h("overwriteElevated","Overwrite as Admin..."):h("overwriteElevatedSudo","Overwrite as Sudo..."):dt?h("saveElevated","Retry as Admin..."):h("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...i,writeElevated:!0,writeUnlock:c,reason:1})}})):d?o.push(co({id:"fileWorkingCopy.unlock",label:h("overwrite","Overwrite"),run:()=>this.save({...i,writeUnlock:!0,reason:1})})):o.push(co({id:"fileWorkingCopy.retry",label:h("retry","Retry"),run:()=>this.save({...i,reason:1})})),o.push(co({id:"fileWorkingCopy.saveAs",label:h("saveAs","Save As..."),run:async()=>{let m=this.workingCopyEditorService.findEditor(this);m&&((await this.editorService.save(m,{saveAs:!0,reason:1})).success||this.doHandleSaveError(t,i))}})),o.push(co({id:"fileWorkingCopy.revert",label:h("revert","Revert"),run:()=>this.revert()})),d?c&&p?s=dt?h("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):h("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=h("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):p&&u?s=dt?h("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):h("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=h({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,os(t,!1))}let a=this.notificationService.notify({id:`${Ur(this.resource.toString())}`,severity:As.Error,message:s,actions:{primary:o}}),l=this._register(z.once(z.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(z.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(t){let i=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=t.mtime?this.lastResolvedFileStat=t:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:t.readonly,locked:t.locked}:this.lastResolvedFileStat=t,this.isReadonly()!==i&&this._onDidChangeReadonly.fire()}async revert(t){if(!this.isResolved()||!this.dirty&&!t?.force)return;this.trace("revert()");let i=this.dirty,n=this.doSetDirty(!1);if(!t?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw n(),s}this._onDidRevert.fire(),i&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(t){switch(t){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(t){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(t){this.logService.trace(`[stored file working copy] ${t}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};ih=R([y(5,Lt),y(6,Oi),y(7,aT),y(8,oa),y(9,nx),y(10,ia),y(11,Bo),y(12,QO),y(13,vt),y(14,h8),y(15,Qd)],ih);var Gg=class extends P{constructor(t){super();this.logService=t}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(t){let i=am(this.saveParticipants,t);return te(()=>i())}async participate(t,i,n,o){t.model?.pushStackElement();for(let s of this.saveParticipants){if(o.isCancellationRequested||t.isDisposed())break;try{let a=s.participate(t,i,n,o);await Rv(a,o)}catch(a){this.logService.warn(a)}}t.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};Gg=R([y(0,Oi)],Gg);var aT=Z("workingCopyFileService"),sI=class extends P{constructor(t,i,n,o){super();this.fileService=t;this.workingCopyService=i;this.instantiationService=n;this.uriIdentityService=o;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new fm);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new fm);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new fm);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(t,i,n){return this.doCreateFileOrFolder(t,!0,i,n)}createFolder(t,i,n){return this.doCreateFileOrFolder(t,!1,i,n)}async doCreateFileOrFolder(t,i,n,o){if(t.length===0)return[];if(i){let c=(await Rn.settled(t.map(u=>this.fileService.canCreateFile(u.resource,{overwrite:u.overwrite})))).find(u=>u instanceof Error);if(c instanceof Error)throw c}let s=t.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,o,n);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,pn.None);let l;try{i?l=await Rn.settled(t.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await Rn.settled(t.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,pn.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,pn.None),l}async move(t,i,n){return this.doMoveOrCopy(t,!0,i,n)}async copy(t,i,n){return this.doMoveOrCopy(t,!1,i,n)}async doMoveOrCopy(t,i,n,o){let s=[];for(let{file:{source:d,target:c},overwrite:u}of t){let p=await(i?this.fileService.canMove(d,c,u):this.fileService.canCopy(d,c,u));if(p instanceof Error)throw p}let a=t.map(d=>d.file);await this.runFileOperationParticipants(a,i?2:3,o,n);let l={correlationId:this.correlationIds++,operation:i?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,pn.None);try{for(let{file:{source:d,target:c},overwrite:u}of t){if(!this.uriIdentityService.extUri.isEqual(d,c)){let p=i?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await Rn.settled(p.map(m=>m.revert({soft:!0})))}i?s.push(await this.fileService.move(d,c,u)):s.push(await this.fileService.copy(d,c,u))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,pn.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,pn.None),s}async delete(t,i,n){for(let a of t){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let o=t.map(a=>({target:a.resource}));await this.runFileOperationParticipants(o,1,n,i);let s={correlationId:this.correlationIds++,operation:1,files:o};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,pn.None);for(let a of t){let l=this.getDirty(a.resource);await Rn.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of t)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,pn.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,pn.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(zg));addFileOperationParticipant(t){return this.fileOperationParticipants.addFileOperationParticipant(t)}runFileOperationParticipants(t,i,n,o){return this.fileOperationParticipants.participate(t,i,n,o)}saveParticipants=this._register(this.instantiationService.createInstance(Gg));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(t){return this.saveParticipants.addSaveParticipant(t)}runSaveParticipants(t,i,n,o){return this.saveParticipants.participate(t,i,n,o)}workingCopyProviders=[];registerWorkingCopyProvider(t){let i=am(this.workingCopyProviders,t);return te(i)}getDirty(t){let i=new Set;for(let n of this.workingCopyProviders)for(let o of n(t))o.isDirty()&&i.add(o);return Array.from(i)}};sI=R([y(0,Lt),y(1,ia),y(2,ve),y(3,ql)],sI);an(aT,sI,1);var jl=Z("textFileService");var aI={exports:{}};(function(){function e(o){let s=[];typeof o=="number"&&s.push("code/timeOrigin",o);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(o){performance.mark(o)},getMarks(){let o=performance.timeOrigin;typeof o!="number"&&(o=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(o)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(o+a.startTime)});return s}};if(typeof process=="object"){let o=performance?.timeOrigin;return e(o)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function i(o){return o.MonacoPerformanceMarks||(o.MonacoPerformanceMarks=t()),o.MonacoPerformanceMarks}var n;typeof global=="object"?n=global:typeof self=="object"?n=self:n={},typeof aI=="object"&&typeof aI.exports=="object"?aI.exports=i(n):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),n.perf=i(n))})();var En=aI.exports.mark,H6e=aI.exports.getMarks;function f8(r){let e=r;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&X.isUri(e.location)&&X.isUri(e.globalStorageHome)&&X.isUri(e.settingsResource)&&X.isUri(e.keybindingsResource)&&X.isUri(e.tasksResource)&&X.isUri(e.snippetsHome)&&X.isUri(e.extensionsResource))}var b8=Z("IUserDataProfilesService");function lT(r,e,t,i,n,o){return{id:r,name:e,location:t,isDefault:!1,shortName:n?.shortName,icon:n?.icon,globalStorageHome:o&&n?.useDefaultFlags?.globalState?o.globalStorageHome:It(t,"globalStorage"),settingsResource:o&&n?.useDefaultFlags?.settings?o.settingsResource:It(t,"settings.json"),keybindingsResource:o&&n?.useDefaultFlags?.keybindings?o.keybindingsResource:It(t,"keybindings.json"),tasksResource:o&&n?.useDefaultFlags?.tasks?o.tasksResource:It(t,"tasks.json"),snippetsHome:o&&n?.useDefaultFlags?.snippets?o.snippetsHome:It(t,"snippets"),extensionsResource:o&&n?.useDefaultFlags?.extensions?o.extensionsResource:It(t,"extensions.json"),cacheHome:It(i,r),useDefaultFlags:n?.useDefaultFlags,isTransient:n?.transient}}var dT=class extends P{constructor(t,i,n,o){super();this.environmentService=t;this.fileService=i;this.uriIdentityService=n;this.logService=o;this.profilesHome=It(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=It(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new _);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new _);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new _);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new _);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new Cn,workspaces:new Cn,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(t){this.enabled!==t&&(this._profilesObject=void 0,this.enabled=t)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let t=this.createDefaultProfile(),i=[t];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!Wi(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}i.push(lT(Hi(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.logService.error(s)}let n=new Cn,o=new Map;if(i.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=X.parse(a),c=i.find(u=>u.id===l);c&&n.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=i.find(c=>c.id===l);d&&o.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:i,workspaces:n,emptyWindows:o}}return this._profilesObject}createDefaultProfile(){let t=lT("__default__profile__",h("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){let i="Temp",n=new RegExp(`${or(i)}\\s(\\d+)`),o=0;for(let a of this.profiles){let l=n.exec(a.name),d=l?parseInt(l[1]):0;o=d>o?d:o}let s=`${i} ${o+1}`;return this.createProfile(Ur(ru()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,i,n){return this.createProfile(Ur(ru()).toString(16),t,i,n)}async createProfile(t,i,n,o){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(t,i,n);return o&&await this.setProfileForWorkspace(o,s),s}async doCreateProfile(t,i,n){if(!Wi(i)||!i)throw new Error("Name of the profile is mandatory and must be of type `string`");let o=this.profileCreationPromises.get(i);return o||(o=(async()=>{try{if(this.profiles.find(d=>d.name===i||d.id===t))throw new Error(`Profile with ${i} name already exists`);let a=lT(t,i,It(this.profilesHome,t),this.profilesCacheHome,n,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await Rn.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(i)}})(),this.profileCreationPromises.set(i,o)),o}async updateProfile(t,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let n=this.profiles.find(o=>o.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);return n=lT(n.id,i.name??n.name,n.location,this.profilesCacheHome,{shortName:i.shortName??n.shortName,icon:i.icon===null?void 0:i.icon??n.icon,transient:i.transient??n.isTransient,useDefaultFlags:i.useDefaultFlags??n.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[n]),n}async removeProfile(t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(t.isDefault)throw new Error("Cannot remove default profile");let i=this.profiles.find(o=>o.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);let n=[];this._onWillRemoveProfile.fire({profile:i,join(o){n.push(o)}});try{await Promise.allSettled(n)}catch(o){this.logService.error(o)}for(let o of[...this.profilesObject.emptyWindows.keys()])i.id===this.profilesObject.emptyWindows.get(o)?.id&&this.profilesObject.emptyWindows.delete(o);for(let o of[...this.profilesObject.workspaces.keys()])i.id===this.profilesObject.workspaces.get(o)?.id&&this.profilesObject.workspaces.delete(o);this.updateStoredProfileAssociations(),this.updateProfiles([],[i],[]);try{await this.fileService.del(i.cacheHome,{recursive:!0})}catch(o){tz(o)!==1&&this.logService.error(o)}}async setProfileForWorkspace(t,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let n=this.profiles.find(o=>o.id===i.id);if(!n)throw new Error(`Profile '${i.name}' does not exist`);this.updateWorkspaceAssociation(t,n)}unsetWorkspace(t,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(t,void 0,i)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(i=>i.isDirectory&&this.profiles.every(n=>!this.uriIdentityService.extUri.isEqual(n.location,i.resource))).map(i=>this.fileService.del(i.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let t=this.transientProfilesObject.profiles.filter(i=>!this.isProfileAssociatedToWorkspace(i));await Promise.allSettled(t.map(i=>this.removeProfile(i)))}getProfileForWorkspace(t){let i=this.getWorkspace(t),n=X.isUri(i)?this.profilesObject.workspaces.get(i):this.profilesObject.emptyWindows.get(i);return n||(Xm(t)?this.transientProfilesObject.folders.get(t.uri):ow(t)?this.transientProfilesObject.workspaces.get(t.configPath):this.transientProfilesObject.emptyWindows.get(t.id))}getWorkspace(t){return Xm(t)?t.uri:ow(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!([...this.profilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,t.location))||[...this.profilesObject.workspaces.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,t.location))||[...this.transientProfilesObject.workspaces.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,t.location))||[...this.transientProfilesObject.folders.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,t.location)))}updateProfiles(t,i,n){let o=[...this.profiles,...t],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of o){if(l.isDefault||i.some(c=>l.id===c.id))continue;l=n.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,u]of this.transientProfilesObject.emptyWindows.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,u]of this.transientProfilesObject.workspaces.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,u]of this.transientProfilesObject.folders.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(t,i,n)}triggerProfilesChanges(t,i,n){this._onDidChangeProfiles.fire({added:t,removed:i,updated:n,all:this.profiles})}updateWorkspaceAssociation(t,i,n){if(n=i?.isTransient?!0:n,n)Xm(t)?(this.transientProfilesObject.folders.delete(t.uri),i&&this.transientProfilesObject.folders.set(t.uri,i)):ow(t)?(this.transientProfilesObject.workspaces.delete(t.configPath),i&&this.transientProfilesObject.workspaces.set(t.configPath,i)):(this.transientProfilesObject.emptyWindows.delete(t.id),i&&this.transientProfilesObject.emptyWindows.set(t.id,i));else{this.updateWorkspaceAssociation(t,void 0,!0);let o=this.getWorkspace(t);X.isUri(o)?(this.profilesObject.workspaces.delete(o),i&&this.profilesObject.workspaces.set(o,i)):(this.profilesObject.emptyWindows.delete(o),i&&this.profilesObject.emptyWindows.set(o,i)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let t={};for(let[n,o]of this.profilesObject.workspaces.entries())t[n.toString()]=o.id;let i={};for(let[n,o]of this.profilesObject.emptyWindows.entries())i[n.toString()]=o.id;this.saveStoredProfileAssociations({workspaces:t,emptyWindows:i}),this._profilesObject=void 0}migrateStoredProfileAssociations(t){let i={},n=this.createDefaultProfile();if(t.workspaces)for(let[s,a]of Object.entries(t.workspaces)){let l=X.parse(a);i[s]=this.uriIdentityService.extUri.isEqual(l,n.location)?n.id:this.uriIdentityService.extUri.basename(l)}let o={};if(t.emptyWindows)for(let[s,a]of Object.entries(t.emptyWindows)){let l=X.parse(a);o[s]=this.uriIdentityService.extUri.isEqual(l,n.location)?n.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:i,emptyWindows:o}}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};dT=R([y(0,Ts),y(1,Lt),y(2,ql),y(3,Oi)],dT);var JO={WIDTH:400,WIDTH_WITH_VERTICAL_PANEL:600,HEIGHT:270};var PY;(e=>e.DEFAULT={allowTrailingComma:!0})(PY||={});var qt=Z("keybindingService");var tP=".vscode",FY="settings",Vje=`${tP}/${FY}.json`;var Wje=[1],Hje=[2,3,4,5,6],BY=[3,4,5],Uje=[1,...BY],zje=[2,3,4,5,6],VY=[3,4,5,6],WY=[4,5,6],cT="tasks",v8="launch",y8=Object.create(null);y8[cT]=`${tP}/${cT}.json`;y8[v8]=`${tP}/${v8}.json`;var HY=Object.create(null);HY[cT]=`${cT}.json`;var Kje=He;var iP=class extends uu{_currentResultGroups=new Map;updateResultGroup(e,t){return t?this._currentResultGroups.set(e,t):this._currentResultGroups.delete(e),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let e=new Set;[...this._currentResultGroups.keys()].sort((t,i)=>this._currentResultGroups.get(t).order-this._currentResultGroups.get(i).order).forEach(t=>{let i=this._currentResultGroups.get(t);i.result.filterMatches=i.result.filterMatches.filter(n=>!e.has(n.setting.key)),i.result.filterMatches.forEach(n=>e.add(n.setting.key))})}filterSettings(e,t,i){let n=this.filterGroups,o=[];for(let s of n){let a=t(s);for(let l of s.sections)for(let d of l.settings){let c=i(d,s);(a||c)&&o.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return o}getPreference(e){for(let t of this.settingsGroups)for(let i of t.sections)for(let n of i.settings)if(e===n.key)return n}collectMetadata(e){let t=Object.create(null),i=!1;return e.forEach(n=>{n.result.metadata&&(t[n.id]=n.result.metadata,i=!0)}),i?t:null}get filterGroups(){return this.settingsGroups}};var uT=class extends iP{constructor(t,i){super();this._defaultSettings=t;this._register(i.onDidChangeConfiguration(n=>{n.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(ze.as($r.Configuration).onDidSchemaChange(n=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new _);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let t=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...t,...this.additionalGroups]}setAdditionalGroups(t){this.additionalGroups=t}findValueMatches(t,i){return[]}update(){throw new Error("Not supported")}};uT=R([y(1,He)],uT);function zY(r){return"// "+h("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+r.getDefaultKeybindingsContent()}var pT=class{constructor(e,t){this._uri=e;this.keybindingService=t}_content;get uri(){return this._uri}get content(){return this._content||(this._content=zY(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};pT=R([y(1,qt)],pT);var I8=Z("preferencesService");var ks={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},Iu={id:"default",displayName:h("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:h("builtinProviderDisplayName","Built-in")},C8="workbench.editor.sidebysideEditor",jg="workbench.editors.textDiffEditor",S8="workbench.editors.binaryResourceDiffEditor";function sP(r){let e=r;return!!e&&typeof e.getSelection=="function"&&!!e.onDidChangeSelection}function tT(r,e,t){for(let i of t.visibleEditorPanes)if(i.group.id===e&&r.matches(i.input))return i.getViewState()}function e8(r){if(Bn(r))return!1;let e=r;return X.isUri(e?.resource)}function Ls(r){if(Bn(r))return!1;let e=r;return e?.original!==void 0&&e.modified!==void 0}function Hg(r){if(Bn(r))return!1;let e=r;return!e||e.resources&&!Array.isArray(e.resources)?!1:!!e.resources||!!e.multiDiffSource}function Kl(r){if(Bn(r)||Ls(r))return!1;let e=r;return e?.primary!==void 0&&e.secondary!==void 0}function Gl(r){if(Bn(r))return!1;let e=r;return X.isUri(e?.base?.resource)&&X.isUri(e?.input1?.resource)&&X.isUri(e?.input2?.resource)&&X.isUri(e?.result?.resource)}var nP=class{mapIdToSaveSource=new Map;registerSource(e,t){let i=this.mapIdToSaveSource.get(e);return i||(i={source:e,label:t},this.mapIdToSaveSource.set(e,i)),i.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},PYe=new nP;var oI=class extends P{};function Bn(r){return r instanceof oI}function GY(r){let e=r;return X.isUri(e?.preferredResource)}function jY(r){let e=r;return Bn(e?.primary)&&Bn(e?.secondary)}function UO(r){let e=r;return Bn(e?.modified)&&Bn(e?.original)}function E8(r,e,t,i,n){return qY(i,[co({id:"workbench.action.openLargeFile",label:h("openLargeFile","Open Anyway"),run:()=>{let o={...t,limits:{size:Number.MAX_VALUE}};r.openEditor(e,o)}}),co({id:"workbench.action.configureEditorLargeFileConfirmation",label:h("configureEditorLargeFileConfirmation","Configure Limit"),run:()=>n.openUserSettings({query:"workbench.editorLargeFileConfirmation"})})],{forceMessage:!0,forceSeverity:zi.Warning})}function hT(r){let e=r;return typeof e?.groupId=="number"&&Bn(e.editor)}var oP=class{getOriginalUri(e,t){if(!e)return;if(Gl(e))return Mt.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:n,secondary:o}=this.getSideEditors(e);if(n&&o){if(t?.supportSideBySide===3)return{primary:this.getOriginalUri(n,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(o,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getOriginalUri(n,{filterByScheme:t.filterByScheme})??this.getOriginalUri(o,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?n:o}}if(Ls(e)||Hg(e)||Kl(e)||Gl(e))return;let i=GY(e)?e.preferredResource:e.resource;return!i||!t||!t.filterByScheme?i:this.filterUri(i,t.filterByScheme)}getSideEditors(e){return jY(e)||Kl(e)?{primary:e.primary,secondary:e.secondary}:UO(e)||Ls(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(Gl(e))return Mt.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:n,secondary:o}=this.getSideEditors(e);if(n&&o){if(t?.supportSideBySide===3)return{primary:this.getCanonicalUri(n,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(o,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getCanonicalUri(n,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(o,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?n:o}}if(Ls(e)||Hg(e)||Kl(e)||Gl(e))return;let i=e.resource;return!i||!t||!t.filterByScheme?i:this.filterUri(i,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(i=>e.scheme===i))return e}else if(t===e.scheme)return e}};function qg(r,e,t,i){if(!r.isSticky(e))return!1;switch(i.preventPinnedEditorClose){case"keyboardAndMouse":return t===2||t===1;case"mouse":return t===2;case"keyboard":return t===1}return!1}var Mt=new oP;var rP=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(e){let t=this.instantiationService=e.get(ve);for(let[i,n]of this.editorSerializerConstructors)this.createEditorSerializer(i,n,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,i){let n=i.createInstance(t);this.editorSerializerInstances.set(e,n)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return at(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),te(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};ze.add(ks.EditorFactory,new rP);function lI(r){let e=r;if(!e)return!1;let t=e;if(t.modified)return lI(t.modified);let i=e;return!!(i.contributionsState&&i.viewState&&Array.isArray(i.cursorState))}function nh(r){return oT(r)}function qY(r,e,t){let i=p8(r,e);return i.forceMessage=t?.forceMessage,i.forceSeverity=t?.forceSeverity,i.allowDialog=t?.allowDialog,i}var Ri=Z("editorGroupsService");var kZe=new q("isMac",ke,h("isMac","Whether the operating system is macOS")),RZe=new q("isLinux",_t,h("isLinux","Whether the operating system is Linux")),AZe=new q("isWindows",dt,h("isWindows","Whether the operating system is Windows")),MZe=new q("isWeb",on,h("isWeb","Whether the platform is a web browser")),OZe=new q("isMacNative",ke&&!on,h("isMacNative","Whether the operating system is macOS on a non-browser platform")),PZe=new q("isIOS",zs,h("isIOS","Whether the operating system is iOS")),NZe=new q("isMobile",hS,h("isMobile","Whether the platform is a mobile web browser")),FZe=new q("isDevelopment",!1,!0),BZe=new q("productQualityType","",h("productQualityType","Quality type of VS Code")),$g="inputFocus",VZe=new q($g,!1,h("inputFocus","Whether keyboard focus is inside an input box"));var w8="workbench.view.explorer",oh="workbench.explorer.fileView",yXe=new q("explorerViewletVisible",!0,{type:"boolean",description:h("explorerViewletVisible","True when the EXPLORER viewlet is visible.")}),x8=new q("foldersViewVisible",!0,{type:"boolean",description:h("foldersViewVisible","True when the FOLDERS view (the file tree within the explorer view container) is visible.")}),IXe=new q("explorerResourceIsFolder",!1,{type:"boolean",description:h("explorerResourceIsFolder","True when the focused item in the EXPLORER is a folder.")}),$Y=new q("explorerResourceReadonly",!1,{type:"boolean",description:h("explorerResourceReadonly","True when the focused item in the EXPLORER is read-only.")}),CXe=$Y.toNegated(),SXe=new q("explorerResourceAvailableEditorIds",""),EXe=new q("explorerResourceIsRoot",!1,{type:"boolean",description:h("explorerResourceIsRoot","True when the focused item in the EXPLORER is a root folder.")}),wXe=new q("explorerResourceCut",!1,{type:"boolean",description:h("explorerResourceCut","True when an item in the EXPLORER has been cut for cut and paste.")}),xXe=new q("explorerResourceMoveableToTrash",!1,{type:"boolean",description:h("explorerResourceMoveableToTrash","True when the focused item in the EXPLORER can be moved to trash.")}),YY=new q("filesExplorerFocus",!0,{type:"boolean",description:h("filesExplorerFocus","True when the focus is inside the EXPLORER view.")}),T8=new q("openEditorsFocus",!0,{type:"boolean",description:h("openEditorsFocus","True when the focus is inside the OPEN EDITORS view.")}),aP=new q("explorerViewletFocus",!0,{type:"boolean",description:h("explorerViewletFocus","True when the focus is inside the EXPLORER viewlet.")}),TXe=new q("explorerViewletCompressedFocus",!0,{type:"boolean",description:h("explorerViewletCompressedFocus","True when the focused item in the EXPLORER view is a compact item.")}),_Xe=new q("explorerViewletCompressedFirstFocus",!0,{type:"boolean",description:h("explorerViewletCompressedFirstFocus","True when the focus is inside a compact item's first part in the EXPLORER view.")}),DXe=new q("explorerViewletCompressedLastFocus",!0,{type:"boolean",description:h("explorerViewletCompressedLastFocus","True when the focus is inside a compact item's last part in the EXPLORER view.")}),LXe=new q("viewHasSomeCollapsibleItem",!1,{type:"boolean",description:h("viewHasSomeCollapsibleItem","True when a workspace in the EXPLORER view has some collapsible root child.")}),kXe=Ue.and(x8,YY,Ue.not($g)),RXe=Ue.and(x8,aP,Ue.not($g));var Cu=class extends P{constructor(t,i,n,o){super();this.textFileService=t;this.fileService=i;this.languageService=n;this.modelService=o}fileWatcherDisposable=this._register(new xt);static async open(t,i,n,o,s){await o.openEditor({original:{resource:Cu.resourceToTextFile(i,t)},modified:{resource:t},label:n,options:s})}static resourceToTextFile(t,i){return i.with({scheme:t,query:JSON.stringify({scheme:i.scheme,query:i.query})})}static textFileToResource(t){let{scheme:i,query:n}=JSON.parse(t.query);return t.with({scheme:i,query:n})}async provideTextContent(t){if(!t.query)return null;let i=Cu.textFileToResource(t),n=await this.resolveEditorModel(t);if(!this.fileWatcherDisposable.value){let o=new Y;this.fileWatcherDisposable.value=o,o.add(this.fileService.onDidFilesChange(s=>{s.contains(i,0)&&this.resolveEditorModel(t,!1)})),n&&o.add(z.once(n.onWillDispose)(()=>this.fileWatcherDisposable.clear()))}return n}async resolveEditorModel(t,i=!0){let n=Cu.textFileToResource(t),o=await this.textFileService.readStream(n),s=this.modelService.getModel(t);if(s)this.modelService.updateModel(s,o.value);else if(i){let a=this.modelService.getModel(n),l;a?l=this.languageService.createById(a.getLanguageId()):l=this.languageService.createByFilepathOrFirstLine(n),s=this.modelService.createModel(o.value,l,t)}return s}};Cu=R([y(0,jl),y(1,Lt),y(2,Ki),y(3,Qn)],Cu);var ln=class r{constructor(e,t){this._editor=e;this._group=t;this.id=r.COUNTER++}id;static COUNTER=0;get editor(){return this._editor}get group(){return this._group}get groupId(){return this._group.id}getId(){return`openeditor:${this.groupId}:${this.id}`}isPreview(){return!this._group.isPinned(this.editor)}isSticky(){return this._group.isSticky(this.editor)}getResource(){return Mt.getOriginalUri(this.editor,{supportSideBySide:1})}};var ZY={Quickaccess:"workbench.contributions.quickaccess"},lP=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),te(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return ni([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}clear(){let e=[...this.providers],t=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=e,this.defaultProvider=t}}};ze.add(ZY.Quickaccess,new lP);var _8=new Dn(()=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:r,collatorIsNumeric:r.resolvedOptions().numeric}}),XY=new Dn(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),YXe=new Dn(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));function dP(r,e,t=!1){let i=r||"",n=e||"",o=_8.value.collator.compare(i,n);return _8.value.collatorIsNumeric&&o===0&&i!==n?i<n?-1:1:o}function cP(r,e){let t=XY.value.collator;return r=r||"",e=e||"",QY(t,r,e)}function QY(r,e,t){let i=r.compare(e,t);return i!==0?i:e.length!==t.length?e.length<t.length?-1:1:0}function mT(r,e,t){let i=r.toLowerCase(),n=e.toLowerCase(),o=JY(r,e,t);if(o)return o;let s=i.endsWith(t),a=n.endsWith(t);if(s!==a)return s?-1:1;let l=dP(i,n);return l!==0?l:i.localeCompare(n)}function JY(r,e,t){let i=r.toLowerCase(),n=e.toLowerCase(),o=i.startsWith(t),s=n.startsWith(t);if(o!==s)return o?-1:1;if(o&&s){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}var fT=0,D8=[fT,[]];function L8(r,e,t,i){if(!r||!e)return D8;let n=r.length,o=e.length;if(n<o)return D8;let s=r.toLowerCase();return eZ(e,t,o,r,s,n,i)}function eZ(r,e,t,i,n,o,s){let a=[],l=[];for(let p=0;p<t;p++){let m=p*o,f=m-o,g=p>0,b=r[p],v=e[p];for(let I=0;I<o;I++){let w=I>0,E=m+I,S=E-1,T=f+I-1,D=w?a[S]:0,L=g&&w?a[T]:0,A=g&&w?l[T]:0,W;!L&&g?W=0:W=tZ(b,v,i,n,I,A),W&&L+W>=D&&(s||g||n.startsWith(e,I))?(l[E]=A+1,a[E]=L+W):(l[E]=fT,a[E]=D)}}let d=[],c=t-1,u=o-1;for(;c>=0&&u>=0;){let p=c*o+u;l[p]===fT||(d.push(u),c--),u--}return[a[t*o-1],d.reverse()]}function tZ(r,e,t,i,n,o){let s=0;if(!iZ(e,i[n]))return s;if(s+=1,o>0&&(s+=o*5),r===t[n]&&(s+=1),n===0)s+=8;else{let a=nZ(t.charCodeAt(n-1));a?s+=a:Fm(t.charCodeAt(n))&&o===0&&(s+=2)}return s}function iZ(r,e){return r===e?!0:r==="/"||r==="\\"?e==="/"||e==="\\":!1}function nZ(r){switch(r){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}var bT=Object.freeze({score:0}),gT=1<<18,uP=1<<17,pP=65536;function oZ(r,e,t,i){let n=i.values?i.values:[i];return Ur({[i.normalized]:{values:n.map(s=>({value:s.normalized,expectContiguousMatch:s.expectContiguousMatch})),label:r,description:e,allowNonContiguousMatches:t}})}function vT(r,e,t,i,n){if(!r||!e.normalized)return bT;let o=i.getItemLabel(r);if(!o)return bT;let s=i.getItemDescription(r),a=oZ(o,s,t,e),l=n[a];if(l)return l;let d=rZ(o,s,i.getItemPath(r),e,t);return n[a]=d,d}function rZ(r,e,t,i,n){let o=!t||!i.containsPathSeparator;return t&&(_t?i.pathNormalized===t:Ho(i.pathNormalized,t))?{score:gT,labelMatch:[{start:0,end:r.length}],descriptionMatch:e?[{start:0,end:e.length}]:void 0}:i.values&&i.values.length>1?sZ(r,e,t,i.values,o,n):P8(r,e,t,i,o,n)}function sZ(r,e,t,i,n,o){let s=0,a=[],l=[];for(let d of i){let{score:c,labelMatch:u,descriptionMatch:p}=P8(r,e,t,d,n,o);if(c===fT)return bT;s+=c,u&&a.push(...u),p&&l.push(...p)}return{score:s,labelMatch:R8(a),descriptionMatch:R8(l)}}function P8(r,e,t,i,n,o){if(n||!e){let[s,a]=L8(r,i.normalized,i.normalizedLowercase,o&&!i.expectContiguousMatch);if(s){let l=Ap(i.normalized,r),d;if(l){d=uP;let c=Math.round(i.normalized.length/r.length*100);d+=c}else d=pP;return{score:d+s,labelMatch:l||k8(a)}}}if(e){let s=e;t&&(s=`${e}${jn}`);let a=s.length,l=`${s}${r}`,[d,c]=L8(l,i.normalized,i.normalizedLowercase,o&&!i.expectContiguousMatch);if(d){let u=k8(c),p=[],m=[];return u.forEach(f=>{f.start<a&&f.end>a?(p.push({start:0,end:f.end-a}),m.push({start:f.start,end:a})):f.start>=a?p.push({start:f.start-a,end:f.end-a}):m.push(f)}),{score:d,labelMatch:p,descriptionMatch:m}}}return bT}function k8(r){let e=[];if(!r)return e;let t;for(let i of r)t&&t.end===i?t.end+=1:(t={start:i,end:i+1},e.push(t));return e}function R8(r){let e=r.sort((n,o)=>n.start-o.start),t=[],i;for(let n of e)!i||!aZ(i,n)?(i=n,t.push(n)):(i.start=Math.min(i.start,n.start),i.end=Math.max(i.end,n.end));return t}function aZ(r,e){return!(r.end<e.start||e.end<r.start)}function N8(r,e,t,i,n,o){let s=vT(r,t,i,n,o),a=vT(e,t,i,n,o),l=s.score,d=a.score;if((l===gT||d===gT)&&l!==d)return l===gT?-1:1;if(l>pP||d>pP){if(l!==d)return l>d?-1:1;if(l<uP&&d<uP){let b=lZ(s.labelMatch,a.labelMatch);if(b!==0)return b}let f=n.getItemLabel(r)||"",g=n.getItemLabel(e)||"";if(f.length!==g.length)return f.length-g.length}if(l!==d)return l>d?-1:1;let c=Array.isArray(s.labelMatch)&&s.labelMatch.length>0,u=Array.isArray(a.labelMatch)&&a.labelMatch.length>0;if(c&&!u)return-1;if(u&&!c)return 1;let p=A8(r,s,n),m=A8(e,a,n);return p&&m&&p!==m?m>p?-1:1:dZ(r,e,t,n)}function A8(r,e,t){let i=-1,n=-1;if(e.descriptionMatch&&e.descriptionMatch.length?i=e.descriptionMatch[0].start:e.labelMatch&&e.labelMatch.length&&(i=e.labelMatch[0].start),e.labelMatch&&e.labelMatch.length){if(n=e.labelMatch[e.labelMatch.length-1].end,e.descriptionMatch&&e.descriptionMatch.length){let o=t.getItemDescription(r);o&&(n+=o.length)}}else e.descriptionMatch&&e.descriptionMatch.length&&(n=e.descriptionMatch[e.descriptionMatch.length-1].end);return n-i}function lZ(r,e){if(!r&&!e||(!r||!r.length)&&(!e||!e.length))return 0;if(!e||!e.length)return-1;if(!r||!r.length)return 1;let t=r[0].start,n=r[r.length-1].end-t,o=e[0].start,a=e[e.length-1].end-o;return n===a?0:a<n?1:-1}function dZ(r,e,t,i){let n=i.getItemLabel(r)||"",o=i.getItemLabel(e)||"",s=i.getItemDescription(r),a=i.getItemDescription(e),l=n.length+(s?s.length:0),d=o.length+(a?a.length:0);if(l!==d)return l-d;let c=i.getItemPath(r),u=i.getItemPath(e);return c&&u&&c.length!==u.length?c.length-u.length:n!==o?mT(n,o,t.normalized):s&&a&&s!==a?mT(s,a,t.normalized):c&&u&&c!==u?mT(c,u,t.normalized):0}function M8(r){return r.startsWith('"')&&r.endsWith('"')}var cZ=" ";function F8(r){typeof r!="string"&&(r="");let e=r.toLowerCase(),{pathNormalized:t,normalized:i,normalizedLowercase:n}=O8(r),o=t.indexOf(jn)>=0,s=M8(r),a,l=r.split(cZ);if(l.length>1)for(let d of l){let c=M8(d),{pathNormalized:u,normalized:p,normalizedLowercase:m}=O8(d);p&&(a||(a=[]),a.push({original:d,originalLowercase:d.toLowerCase(),pathNormalized:u,normalized:p,normalizedLowercase:m,expectContiguousMatch:c}))}return{original:r,originalLowercase:e,pathNormalized:t,normalized:i,normalizedLowercase:n,values:a,containsPathSeparator:o,expectContiguousMatch:s}}function O8(r){let e;dt?e=r.replace(/\//g,jn):e=r.replace(/\\/g,jn);let t=YW(e).replace(/\s|"/g,"");return{pathNormalized:e,normalized:t,normalizedLowercase:t.toLowerCase()}}var hP=class{constructor(e){this.options=e}getItemLabel(e){return e.label}getItemDescription(e){if(!this.options?.skipDescription)return e.description}getItemPath(e){if(!this.options?.skipPath)return e.resource?.scheme===ue.file?e.resource.fsPath:e.resource?.path}},mP=new hP,$l=Z("quickInputService");var eo=Z("hostService");var B8="revealInExplorer";var WQe=pt("saveAs","Save As...");var HQe=pt("save","Save");var UQe=pt("saveWithoutFormatting","Save without Formatting"),V8="saveAll",W8=pt("saveAll","Save All"),H8="workbench.files.action.saveAllInGroup";var U8=new q("groupFocusedInOpenEditors",!1),z8=new q("dirtyEditorFocusedInOpenEditors",!1),K8=new q("readonlyEditorFocusedInOpenEditors",!1),G8=new q("openEditorsSelectedFileOrUntitled",!0),zQe=new q("resourceSelectedForCompare",!1);var KQe=h("removeFolderFromWorkspace","Remove Folder from Workspace");var yT="workbench.action.files.newUntitledFile",GQe=pt("newUntitledFile","New Untitled Text File");var Yg=Z("clipboardService");var uZ=!1;var pZ=4,hZ=new _;var mZ=300,gZ=new _;var dI=class{constructor(e){this.el=e}disposables=new Y;get onPointerMove(){return this.disposables.add(new Me(pe(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Me(pe(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};R([me],dI.prototype,"onPointerMove",1),R([me],dI.prototype,"onPointerUp",1);var cI=class{constructor(e){this.el=e}disposables=new Y;get onPointerMove(){return this.disposables.add(new Me(this.el,it.Change)).event}get onPointerUp(){return this.disposables.add(new Me(this.el,it.End)).event}dispose(){this.disposables.dispose()}};R([me],cI.prototype,"onPointerMove",1),R([me],cI.prototype,"onPointerUp",1);var Zg=class{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};R([me],Zg.prototype,"onPointerMove",1),R([me],Zg.prototype,"onPointerUp",1);var j8="pointer-events-disabled",rh=class r extends P{el;layoutProvider;orientation;size;hoverDelay=mZ;hoverDelayer=this._register(new vs(this.hoverDelay));_state=3;onDidEnablementChange=this._register(new _);_onDidStart=this._register(new _);_onDidChange=this._register(new _);_onDidReset=this._register(new _);_onDidEnd=this._register(new _);orthogonalStartSashDisposables=this._register(new Y);_orthogonalStartSash;orthogonalStartDragHandleDisposables=this._register(new Y);_orthogonalStartDragHandle;orthogonalEndSashDisposables=this._register(new Y);_orthogonalEndSash;orthogonalEndDragHandleDisposables=this._register(new Y);_orthogonalEndDragHandle;get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}onDidStart=this._onDidStart.event;onDidChange=this._onDidChange.event;onDidReset=this._onDidReset.event;onDidEnd=this._onDidEnd.event;linkedSash=void 0;set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){let t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=ye(this.el,he(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(te(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new Me(this._orthogonalStartDragHandle,"mouseenter")).event(()=>r.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new Me(this._orthogonalStartDragHandle,"mouseleave")).event(()=>r.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){let t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=ye(this.el,he(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(te(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new Me(this._orthogonalEndDragHandle,"mouseenter")).event(()=>r.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new Me(this._orthogonalEndDragHandle,"mouseleave")).event(()=>r.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.el=ye(e,he(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),ke&&this.el.classList.add("mac");let n=this._register(new Me(this.el,"mousedown")).event;this._register(n(u=>this.onPointerStart(u,new dI(e)),this));let o=this._register(new Me(this.el,"dblclick")).event;this._register(o(this.onPointerDoublePress,this));let s=this._register(new Me(this.el,"mouseenter")).event;this._register(s(()=>r.onMouseEnter(this)));let a=this._register(new Me(this.el,"mouseleave")).event;this._register(a(()=>r.onMouseLeave(this))),this._register(ei.addTarget(this.el));let l=this._register(new Me(this.el,it.Start)).event;this._register(l(u=>this.onPointerStart(u,new cI(this.el)),this));let d=this._register(new Me(this.el,it.Tap)).event,c;this._register(d(u=>{if(c){clearTimeout(c),c=void 0,this.onPointerDoublePress(u);return}clearTimeout(c),c=setTimeout(()=>c=void 0,250)},this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=pZ,this._register(hZ.event(u=>{this.size=u,this.layout()}))),this._register(gZ.event(u=>this.hoverDelay=u)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",uZ),this.layout()}onPointerStart(e,t){Oe.stop(e);let i=!1;if(!e.__orthogonalSashEvent){let f=this.getOrthogonalSash(e);f&&(i=!0,e.__orthogonalSashEvent=!0,f.onPointerStart(e,new Zg(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new Zg(t))),!this.state)return;let n=this.el.ownerDocument.getElementsByTagName("iframe");for(let f of n)f.classList.add(j8);let o=e.pageX,s=e.pageY,a=e.altKey,l={startX:o,currentX:o,startY:s,currentY:s,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);let d=rr(this.el),c=()=>{let f="";i?f="all-scroll":this.orientation===1?this.state===1?f="s-resize":this.state===2?f="n-resize":f=ke?"row-resize":"ns-resize":this.state===1?f="e-resize":this.state===2?f="w-resize":f=ke?"col-resize":"ew-resize",d.textContent=`* { cursor: ${f} !important; }`},u=new Y;c(),i||this.onDidEnablementChange.event(c,null,u);let p=f=>{Oe.stop(f,!1);let g={startX:o,currentX:f.pageX,startY:s,currentY:f.pageY,altKey:a};this._onDidChange.fire(g)},m=f=>{Oe.stop(f,!1),d.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(let g of n)g.classList.remove(j8)};t.onPointerMove(p,null,u),t.onPointerUp(m,null,u),u.add(t)}onPointerDoublePress(e){let t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&r.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&r.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){r.onMouseLeave(this)}layout(){if(this.orientation===0){let e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{let e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){let t=e.initialTarget??e.target;if(!(!t||!ki(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}};var Xg=class extends P{_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(e,t){super(),this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null,t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()},i=!1,n=!1,o=()=>{if(i&&!n)try{i=!1,n=!0,t()}finally{Yi(pe(this._referenceDomElement),()=>{n=!1,o()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?e={width:s[0].contentRect.width,height:s[0].contentRect.height}:e=null,i=!0,o()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0;t?(i=t.width,n=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,e&&this._onDidChange.fire())}};var gP=class extends P{_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(e){super(),this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}},fP=class extends P{_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(e){super(),this._value=this._getPixelRatio(e);let t=this._register(new gP(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){let t=document.createElement("canvas").getContext("2d"),i=e.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n}},bP=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(e){let t=Hc(e),i=this.mapWindowIdToPixelRatioMonitor.get(t);return i||(i=gl(new fP(e)),this.mapWindowIdToPixelRatioMonitor.set(t,i),gl(z.once(N2)(({vscodeWindowId:n})=>{n===t&&(i?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))}))),i}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}},Su=new bP;function Ti(r,e){r instanceof Rp?(r.setFontFamily(e.getMassagedFontFamily()),r.setFontWeight(e.fontWeight),r.setFontSize(e.fontSize),r.setFontFeatureSettings(e.fontFeatureSettings),r.setFontVariationSettings(e.fontVariationSettings),r.setLineHeight(e.lineHeight),r.setLetterSpacing(e.letterSpacing)):(r.style.fontFamily=e.getMassagedFontFamily(),r.style.fontWeight=e.fontWeight,r.style.fontSize=e.fontSize+"px",r.style.fontFeatureSettings=e.fontFeatureSettings,r.style.fontVariationSettings=e.fontVariationSettings,r.style.lineHeight=e.lineHeight+"px",r.style.letterSpacing=e.letterSpacing+"px")}var IT=class{chr;type;width;constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}},vP=class r{_bareFontInfo;_requests;_container;_testElements;constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";let t=document.createElement("div");Ti(t,this._bareFontInfo),e.appendChild(t);let i=document.createElement("div");Ti(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);let n=document.createElement("div");Ti(n,this._bareFontInfo),n.style.fontStyle="italic",e.appendChild(n);let o=[];for(let s of this._requests){let a;s.type===0&&(a=t),s.type===2&&(a=i),s.type===1&&(a=n),a.appendChild(document.createElement("br"));let l=document.createElement("span");r._render(l,s),a.appendChild(l),o.push(l)}this._container=e,this._testElements=o}static _render(e,t){if(t.chr===" "){let i="\xA0";for(let n=0;n<8;n++)i+=i;e.innerText=i}else{let i=t.chr;for(let n=0;n<8;n++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){let i=this._requests[e],n=this._testElements[e];i.fulfill(n.offsetWidth/256)}}};function q8(r,e,t){new vP(e,t).read(r)}var yP=class extends P{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){let t=Hc(e),i=this._cache.get(t);return i||(i=new IP,this._cache.set(t,i)),i}_writeToCache(e,t,i){this._ensureCache(e).put(t,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){let t=this._ensureCache(e),i=t.getValues(),n=!1;for(let o of i)o.isTrusted||(n=!0,t.remove(o));n&&this._onDidChange.fire()}serializeFontInfo(e){return this._ensureCache(e).getValues().filter(i=>i.isTrusted)}restoreFontInfo(e,t){for(let i of t){if(i.version!==cA)continue;let n=new Ym(i,!1);this._writeToCache(e,n,n)}}readFontInfo(e,t){let i=this._ensureCache(e);if(!i.has(t)){let n=this._actualReadFontInfo(e,t);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new Ym({pixelRatio:Su.getInstance(e).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(e,t,n)}return i.get(t)}_createRequest(e,t,i,n){let o=new IT(e,t);return i.push(o),n?.push(o),o}_actualReadFontInfo(e,t){let i=[],n=[],o=this._createRequest("n",0,i,n),s=this._createRequest("\uFF4D",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),d=this._createRequest("1",0,i,n),c=this._createRequest("2",0,i,n),u=this._createRequest("3",0,i,n),p=this._createRequest("4",0,i,n),m=this._createRequest("5",0,i,n),f=this._createRequest("6",0,i,n),g=this._createRequest("7",0,i,n),b=this._createRequest("8",0,i,n),v=this._createRequest("9",0,i,n),I=this._createRequest("\u2192",0,i,n),w=this._createRequest("\uFFEB",0,i,null),E=this._createRequest("\xB7",0,i,n),S=this._createRequest("\u2E31",0,i,null),T="|/-_ilm%";for(let j=0,G=T.length;j<G;j++)this._createRequest(T.charAt(j),0,i,n),this._createRequest(T.charAt(j),1,i,n),this._createRequest(T.charAt(j),2,i,n);q8(e,t,i);let D=Math.max(l.width,d.width,c.width,u.width,p.width,m.width,f.width,g.width,b.width,v.width),L=t.fontFeatureSettings===ka.OFF,A=n[0].width;for(let j=1,G=n.length;L&&j<G;j++){let oe=A-n[j].width;if(oe<-.001||oe>.001){L=!1;break}}let W=!0;return L&&w.width!==A&&(W=!1),w.width>I.width&&(W=!1),new Ym({pixelRatio:Su.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:L,typicalHalfwidthCharacterWidth:o.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:W,spaceWidth:a.width,middotWidth:E.width,wsmiddotWidth:S.width,maxDigitWidth:D},!0)}},IP=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId();return!!this._values[t]}get(e){let t=e.getId();return this._values[t]}put(e,t){let i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){let t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}},CP=new yP;var uI=class r{constructor(e,t){this.key=e;this.migrate=t}static items=[];apply(e){let t=r._read(e,this.key),i=o=>r._read(e,o),n=(o,s)=>r._write(e,o,s);this.migrate(t,i,n)}static _read(e,t){if(typeof e>"u")return;let i=t.indexOf(".");if(i>=0){let n=t.substring(0,i);return this._read(e[n],t.substring(i+1))}return e[t]}static _write(e,t,i){let n=t.indexOf(".");if(n>=0){let o=t.substring(0,n);e[o]=e[o]||{},this._write(e[o],t.substring(n+1),i);return}e[t]=i}};function Ua(r,e){uI.items.push(new uI(r,e))}function Ar(r,e){Ua(r,(t,i,n)=>{if(typeof t<"u"){for(let[o,s]of e)if(t===o){n(r,s);return}}})}function $8(r){uI.items.forEach(e=>e.apply(r))}Ar("wordWrap",[[!0,"on"],[!1,"off"]]);Ar("lineNumbers",[[!0,"on"],[!1,"off"]]);Ar("cursorBlinking",[["visible","solid"]]);Ar("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);Ar("renderLineHighlight",[[!0,"line"],[!1,"none"]]);Ar("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);Ar("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);Ar("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Ar("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Ar("autoIndent",[[!1,"advanced"],[!0,"full"]]);Ar("matchBrackets",[[!0,"always"],[!1,"never"]]);Ar("renderFinalNewline",[[!0,"on"],[!1,"off"]]);Ar("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);Ar("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);Ar("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);Ua("autoClosingBrackets",(r,e,t)=>{r===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});Ua("renderIndentGuides",(r,e,t)=>{typeof r<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!r))});Ua("highlightActiveIndentGuide",(r,e,t)=>{typeof r<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!r))});var fZ={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};Ua("suggest.filteredTypes",(r,e,t)=>{if(r&&typeof r=="object"){for(let i of Object.entries(fZ))r[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});Ua("quickSuggestions",(r,e,t)=>{if(typeof r=="boolean"){let i=r?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});Ua("experimental.stickyScroll.enabled",(r,e,t)=>{typeof r=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",r))});Ua("experimental.stickyScroll.maxLineCount",(r,e,t)=>{typeof r=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",r))});Ua("codeActionsOnSave",(r,e,t)=>{if(r&&typeof r=="object"){let i=!1,n={};for(let o of Object.entries(r))typeof o[1]=="boolean"?(i=!0,n[o[0]]=o[1]?"explicit":"never"):n[o[0]]=o[1];i&&t("codeActionsOnSave",n)}});Ua("codeActionWidget.includeNearbyQuickfixes",(r,e,t)=>{typeof r=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",r))});Ua("lightbulb.enabled",(r,e,t)=>{typeof r=="boolean"&&t("lightbulb.enabled",r?void 0:"off")});var SP=class{_tabFocus=!1;_onDidChangeTabFocus=new _;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}},Qg=new SP;var Jg=class extends P{constructor(t,i,n,o,s){super();this._accessibilityService=s;this.isSimpleWidget=t,this.contextMenuId=i,this._containerObserver=this._register(new Xg(o,n.dimension)),this._targetWindowId=pe(o).vscodeWindowId,this._rawOptions=Y8(n),this._validatedOptions=sh.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Dl.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(Qg.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(CP.onDidChange(()=>this._recomputeOptions())),this._register(Su.getInstance(pe(o)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new _);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new fy;_rawOptions;_validatedOptions;options;_recomputeOptions(){let t=this._computeOptions(),i=sh.checkEquals(this.options,t);i!==null&&(this.options=t,this._onDidChangeFast.fire(i),this._onDidChange.fire(i))}_computeOptions(){let t=this._readEnvConfiguration(),i=py.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),n=this._readFontInfo(i),o={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:n,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:Qg.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return sh.computeOptions(this._validatedOptions,o)}_readEnvConfiguration(){return{extraEditorClassName:vZ(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:wa||$i,pixelRatio:Su.getInstance(Bd(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return CP.readFontInfo(Bd(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){let i=Y8(t);sh.applyUpdate(this._rawOptions,i)&&(this._validatedOptions=sh.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){let i=bZ(t);this._lineNumbersDigitCount!==i&&(this._lineNumbersDigitCount=i,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};Jg=R([y(4,dr)],Jg);function bZ(r){let e=0;for(;r;)r=Math.floor(r/10),e++;return e||1}function vZ(){let r="";return!Uo&&!m2&&(r+="no-user-select "),Uo&&(r+="no-minimap-shadow ",r+="enable-user-select "),ke&&(r+="mac "),r}var EP=class{_values=[];_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}},wP=class{_values=[];_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}},sh=class r{static validateOptions(e){let t=new EP;for(let i of ig){let n=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(n))}return t}static computeOptions(e,t){let i=new wP;for(let n of ig)i._write(n.id,n.compute(t,i,e._read(n.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?li(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let i in e)if(!r._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){let i=[],n=!1;for(let o of ig){let s=!r._deepEquals(e._read(o.id),t._read(o.id));i[o.id]=s,s&&(n=!0)}return n?new hw(i):null}static applyUpdate(e,t){let i=!1;for(let n of ig)if(t.hasOwnProperty(n.name)){let o=n.applyUpdate(e[n.name],t[n.name]);e[n.name]=o.newValue,i=i||o.didChange}return i}};function Y8(r){let e=Qc(r);return $8(e),e}var za=class{originalStart;originalLength;modifiedStart;modifiedLength;constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}};var Eu=class{static Assert(e,t){if(!e)throw new Error(t)}},wu=class{static Copy(e,t,i,n,o){for(let s=0;s<o;s++)i[n+s]=e[t+s]}static Copy2(e,t,i,n,o){for(let s=0;s<o;s++)i[n+s]=e[t+s]}};var CT=class{m_changes;m_originalStart;m_modifiedStart;m_originalCount;m_modifiedCount;constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new za(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},pI=class r{ContinueProcessingPredicate;_originalSequence;_modifiedSequence;_hasStrings;_originalStringElements;_originalElementsOrHash;_modifiedStringElements;_modifiedElementsOrHash;m_forwardHistory;m_reverseHistory;constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;let[n,o,s]=r._getElements(e),[a,l,d]=r._getElements(t);this._hasStrings=s&&d,this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){let t=e.getElements();if(r._isStringArray(t)){let i=new Int32Array(t.length);for(let n=0,o=t.length;n<o;n++)i[n]=lE(t[n],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;let i=r._getStrictElement(this._originalSequence,e),n=r._getStrictElement(this._modifiedSequence,t);return i===n}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,n,o){let s=[!1],a=this.ComputeDiffRecursive(e,t,i,n,s);return o&&(a=this.PrettifyChanges(a)),{quitEarly:s[0],changes:a}}ComputeDiffRecursive(e,t,i,n,o){for(o[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--;if(e>t||i>n){let u;return i<=n?(Eu.Assert(e===t+1,"originalStart should only be one more than originalEnd"),u=[new za(e,0,i,n-i+1)]):e<=t?(Eu.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),u=[new za(e,t-e+1,i,0)]):(Eu.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Eu.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}let s=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,n,s,a,o),d=s[0],c=a[0];if(l!==null)return l;if(!o[0]){let u=this.ComputeDiffRecursive(e,d,i,c,o),p=[];return o[0]?p=[new za(d+1,t-(d+1)+1,c+1,n-(c+1)+1)]:p=this.ComputeDiffRecursive(d+1,t,c+1,n,o),this.ConcatenateChanges(u,p)}return[new za(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,o,s,a,l,d,c,u,p,m,f,g,b,v,I){let w=null,E=null,S=new CT,T=t,D=i,L=m[0]-b[0]-n,A=-1073741824,W=this.m_forwardHistory.length-1;do{let j=L+e;j===T||j<D&&d[j-1]<d[j+1]?(u=d[j+1],f=u-L-n,u<A&&S.MarkNextChange(),A=u,S.AddModifiedElement(u+1,f),L=j+1-e):(u=d[j-1]+1,f=u-L-n,u<A&&S.MarkNextChange(),A=u-1,S.AddOriginalElement(u,f+1),L=j-1-e),W>=0&&(d=this.m_forwardHistory[W],e=d[0],T=1,D=d.length-1)}while(--W>=-1);if(w=S.getReverseChanges(),I[0]){let j=m[0]+1,G=b[0]+1;if(w!==null&&w.length>0){let oe=w[w.length-1];j=Math.max(j,oe.getOriginalEnd()),G=Math.max(G,oe.getModifiedEnd())}E=[new za(j,p-j+1,G,g-G+1)]}else{S=new CT,T=s,D=a,L=m[0]-b[0]-l,A=1073741824,W=v?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let j=L+o;j===T||j<D&&c[j-1]>=c[j+1]?(u=c[j+1]-1,f=u-L-l,u>A&&S.MarkNextChange(),A=u+1,S.AddOriginalElement(u+1,f+1),L=j+1-o):(u=c[j-1],f=u-L-l,u>A&&S.MarkNextChange(),A=u,S.AddModifiedElement(u+1,f+1),L=j-1-o),W>=0&&(c=this.m_reverseHistory[W],o=c[0],T=1,D=c.length-1)}while(--W>=-1);E=S.getChanges()}return this.ConcatenateChanges(w,E)}ComputeRecursionPoint(e,t,i,n,o,s,a){let l=0,d=0,c=0,u=0,p=0,m=0;e--,i--,o[0]=0,s[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let f=t-e+(n-i),g=f+1,b=new Int32Array(g),v=new Int32Array(g),I=n-i,w=t-e,E=e-i,S=t-n,D=(w-I)%2===0;b[I]=e,v[w]=t,a[0]=!1;for(let L=1;L<=f/2+1;L++){let A=0,W=0;c=this.ClipDiagonalBound(I-L,L,I,g),u=this.ClipDiagonalBound(I+L,L,I,g);for(let G=c;G<=u;G+=2){G===c||G<u&&b[G-1]<b[G+1]?l=b[G+1]:l=b[G-1]+1,d=l-(G-I)-E;let oe=l;for(;l<t&&d<n&&this.ElementsAreEqual(l+1,d+1);)l++,d++;if(b[G]=l,l+d>A+W&&(A=l,W=d),!D&&Math.abs(G-w)<=L-1&&l>=v[G])return o[0]=l,s[0]=d,oe<=v[G]&&L<=1448?this.WALKTRACE(I,c,u,E,w,p,m,S,b,v,l,t,o,d,n,s,D,a):null}let j=(A-e+(W-i)-L)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(A,j))return a[0]=!0,o[0]=A,s[0]=W,j>0&&L<=1448?this.WALKTRACE(I,c,u,E,w,p,m,S,b,v,l,t,o,d,n,s,D,a):(e++,i++,[new za(e,t-e+1,i,n-i+1)]);p=this.ClipDiagonalBound(w-L,L,w,g),m=this.ClipDiagonalBound(w+L,L,w,g);for(let G=p;G<=m;G+=2){G===p||G<m&&v[G-1]>=v[G+1]?l=v[G+1]-1:l=v[G-1],d=l-(G-w)-S;let oe=l;for(;l>e&&d>i&&this.ElementsAreEqual(l,d);)l--,d--;if(v[G]=l,D&&Math.abs(G-I)<=L&&l<=b[G])return o[0]=l,s[0]=d,oe>=b[G]&&L<=1448?this.WALKTRACE(I,c,u,E,w,p,m,S,b,v,l,t,o,d,n,s,D,a):null}if(L<=1447){let G=new Int32Array(u-c+2);G[0]=I-c+1,wu.Copy2(b,c,G,1,u-c+1),this.m_forwardHistory.push(G),G=new Int32Array(m-p+2),G[0]=w-p+1,wu.Copy2(v,p,G,1,m-p+1),this.m_reverseHistory.push(G)}}return this.WALKTRACE(I,c,u,E,w,p,m,S,b,v,l,t,o,d,n,s,D,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){let i=e[t],n=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,o=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,s=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<o&&(!s||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){let d=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!d)break;i.originalStart++,i.modifiedStart++}let l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){let i=e[t],n=0,o=0;if(t>0){let u=e[t-1];n=u.originalStart+u.originalLength,o=u.modifiedStart+u.modifiedLength}let s=i.originalLength>0,a=i.modifiedLength>0,l=0,d=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let u=1;;u++){let p=i.originalStart-u,m=i.modifiedStart-u;if(p<n||m<o||s&&!this.OriginalElementsAreEqual(p,p+i.originalLength)||a&&!this.ModifiedElementsAreEqual(m,m+i.modifiedLength))break;let g=(p===n&&m===o?5:0)+this._boundaryScore(p,i.originalLength,m,i.modifiedLength);g>d&&(d=g,l=u)}i.originalStart-=l,i.modifiedStart-=l;let c=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],c)){e[t-1]=c[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){let n=e[t-1],o=e[t],s=o.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=o.originalStart+o.originalLength,d=l-a,c=n.modifiedStart,u=o.modifiedStart+o.modifiedLength,p=u-c;if(s<5&&d<20&&p<20){let m=this._findBetterContiguousSequence(a,d,c,p,s);if(m){let[f,g]=m;(f!==n.originalStart+n.originalLength||g!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=f-n.originalStart,n.modifiedLength=g-n.modifiedStart,o.originalStart=f+s,o.modifiedStart=g+s,o.originalLength=l-o.originalStart,o.modifiedLength=u-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,n,o){if(t<o||n<o)return null;let s=e+t-o+1,a=i+n-o+1,l=0,d=0,c=0;for(let u=e;u<s;u++)for(let p=i;p<a;p++){let m=this._contiguousSequenceScore(u,p,o);m>0&&m>l&&(l=m,d=u,c=p)}return l>0?[d,c]:null}_contiguousSequenceScore(e,t,i){let n=0;for(let o=0;o<i;o++){if(!this.ElementsAreEqual(e+o,t+o))return 0;n+=this._originalStringElements[e+o].length}return n}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){let i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){let i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){let o=this._OriginalRegionIsBoundary(e,t)?1:0,s=this._ModifiedRegionIsBoundary(i,n)?1:0;return o+s}ConcatenateChanges(e,t){let i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){let n=new Array(e.length+t.length-1);return wu.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],wu.Copy(t,1,n,e.length,t.length-1),n}else{let n=new Array(e.length+t.length);return wu.Copy(e,0,n,0,e.length),wu.Copy(t,0,n,e.length,t.length),n}}ChangesOverlap(e,t,i){if(Eu.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Eu.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){let n=e.originalStart,o=e.originalLength,s=e.modifiedStart,a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(o=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new za(n,o,s,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e;let o=i,s=n-i-1,a=t%2===0;if(e<0){let l=o%2===0;return a===l?0:1}else{let l=s%2===0;return a===l?n-1:n-2}}};var ST=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}lineStartOffsetByLineIdx;getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new Be(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let t=Cd(this.lineStartOffsetByLineIdx,o=>o<=e),i=t+1,n=e-this.lineStartOffsetByLineIdx[t]+1;return new F(i,n)}getRange(e){return O.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return wr.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new wr(e,this.text.length-this.lineStartOffsetByLineIdx[e])}};var wT=class r{constructor(e){this.edits=e;ya(()=>uv(e,(t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}static single(e,t){return new r([new ah(e,t)])}normalize(){let e=[];for(let t of this.edits)if(e.length>0&&e[e.length-1].range.getEndPosition().equals(t.range.getStartPosition())){let i=e[e.length-1];e[e.length-1]=new ah(i.range.plusRange(t.range),i.text+t.text)}else t.isEmpty||e.push(t);return new r(e)}mapPosition(e){let t=0,i=0,n=0;for(let o of this.edits){let s=o.range.getStartPosition(),a=o.range.getEndPosition();if(e.isBeforeOrEqual(s))break;let l=wr.ofText(o.text);if(e.isBefore(a)){let d=new F(s.lineNumber+t,s.column+(s.lineNumber+t===i?n:0)),c=l.addToPosition(d);return ET(d,c)}t+=l.lineCount-(o.range.endLineNumber-o.range.startLineNumber),l.lineCount===0?a.lineNumber!==s.lineNumber?n+=l.columnCount-(a.column-1):n+=l.columnCount-(a.column-s.column):n=l.columnCount,i=a.lineNumber+t}return new F(e.lineNumber+t,e.column+(e.lineNumber+t===i?n:0))}mapRange(e){function t(s){return s instanceof F?s:s.getStartPosition()}function i(s){return s instanceof F?s:s.getEndPosition()}let n=t(this.mapPosition(e.getStartPosition())),o=i(this.mapPosition(e.getEndPosition()));return ET(n,o)}inverseMapPosition(e,t){return this.inverse(t).mapPosition(e)}inverseMapRange(e,t){return this.inverse(t).mapRange(e)}apply(e){let t="",i=new F(1,1);for(let o of this.edits){let s=o.range,a=s.getStartPosition(),l=s.getEndPosition(),d=ET(i,a);d.isEmpty()||(t+=e.getValueOfRange(d)),t+=o.text,i=l}let n=ET(i,e.endPositionExclusive);return n.isEmpty()||(t+=e.getValueOfRange(n)),t}applyToString(e){let t=new xP(e);return this.apply(t)}inverse(e){let t=this.getNewRanges();return new r(this.edits.map((i,n)=>new ah(t[n],e.getValueOfRange(i.range))))}getNewRanges(){let e=[],t=0,i=0,n=0;for(let o of this.edits){let s=wr.ofText(o.text),a=F.lift({lineNumber:o.range.startLineNumber+i,column:o.range.startColumn+(o.range.startLineNumber===t?n:0)}),l=s.createRange(a);e.push(l),i=l.endLineNumber-o.range.endLineNumber,n=l.endColumn-o.range.endColumn,t=o.range.endLineNumber}return e}},ah=class{constructor(e,t){this.range=e;this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};function ET(r,e){if(r.lineNumber===e.lineNumber&&r.column===Number.MAX_SAFE_INTEGER)return O.fromPositions(e,e);if(!r.isBeforeOrEqual(e))throw new Je("start must be before end");return new O(r.lineNumber,r.column,e.lineNumber,e.column)}var hI=class{get endPositionExclusive(){return this.length.addToPosition(new F(1,1))}getValue(){return this.getValueOfRange(this.length.toRange())}};var xP=class extends hI{constructor(t){super();this.value=t}_t=new ST(this.value);getValueOfRange(t){return this._t.getOffsetRange(t).substring(this.value)}get length(){return this._t.textLength}};var Vo=class r{static inverse(e,t,i){let n=[],o=1,s=1;for(let l of e){let d=new r(new Fe(o,l.original.startLineNumber),new Fe(s,l.modified.startLineNumber));d.modified.isEmpty||n.push(d),o=l.original.endLineNumberExclusive,s=l.modified.endLineNumberExclusive}let a=new r(new Fe(o,t+1),new Fe(s,i+1));return a.modified.isEmpty||n.push(a),n}static clip(e,t,i){let n=[];for(let o of e){let s=o.original.intersect(t),a=o.modified.intersect(i);s&&!s.isEmpty&&a&&!a.isEmpty&&n.push(new r(s,a))}return n}original;modified;constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new r(this.modified,this.original)}join(e){return new r(this.original.join(e.original),this.modified.join(e.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new Qo(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new Je("not a valid diff");return new Qo(new O(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new O(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new Qo(new O(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new O(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(Z8(this.original.endLineNumberExclusive,e)&&Z8(this.modified.endLineNumberExclusive,t))return new Qo(new O(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new O(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new Qo(O.fromPositions(new F(this.original.startLineNumber,1),ef(new F(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),O.fromPositions(new F(this.modified.startLineNumber,1),ef(new F(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new Qo(O.fromPositions(ef(new F(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),ef(new F(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),O.fromPositions(ef(new F(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),ef(new F(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new Je}};function ef(r,e){if(r.lineNumber<1)return new F(1,1);if(r.lineNumber>e.length)return new F(e.length,e[e.length-1].length+1);let t=e[r.lineNumber-1];return r.column>t.length+1?new F(r.lineNumber,t.length+1):r}function Z8(r,e){return r>=1&&r<=e.length}var rs=class r extends Vo{static fromRangeMappings(e){let t=Fe.join(e.map(n=>Fe.fromRangeInclusive(n.originalRange))),i=Fe.join(e.map(n=>Fe.fromRangeInclusive(n.modifiedRange)));return new r(t,i,e)}innerChanges;constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){return new r(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new r(this.original,this.modified,[this.toRangeMapping()])}},Qo=class r{static assertSorted(e){for(let t=1;t<e.length;t++){let i=e[t-1],n=e[t];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new Je("Range mappings must be sorted")}}originalRange;modifiedRange;constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new r(this.modifiedRange,this.originalRange)}toTextEdit(e){let t=e.getValueOfRange(this.modifiedRange);return new ah(this.originalRange,t)}};var lh=class{constructor(e,t,i){this.changes=e;this.moves=t;this.hitTimeout=i}},xT=class r{lineRangeMapping;changes;constructor(e,t){this.lineRangeMapping=e,this.changes=t}flip(){return new r(this.lineRangeMapping.flip(),this.changes.map(e=>e.flip()))}};var Jd=class{constructor(e,t,i,n,o){this.injectionOffsets=e;this.injectionOptions=t;this.breakOffsets=i;this.breakOffsetsVisibleColumn=n;this.wrappedTextIndentLength=o}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){let t=e>0?this.breakOffsets[e-1]:0,n=this.breakOffsets[e]-t;return e>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let n=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let o=0;o<this.injectionOffsets.length&&n>this.injectionOffsets[o];o++)n<this.injectionOffsets[o]+this.injectionOptions[o].content.length?n=this.injectionOffsets[o]:n-=this.injectionOptions[o].content.length;return n}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(e<this.injectionOffsets[n]||t!==1&&e===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,n=this.breakOffsets.length-1,o=0,s=0;for(;i<=n;){o=i+(n-i)/2|0;let l=this.breakOffsets[o];if(s=o>0?this.breakOffsets[o-1]:0,t===0)if(e<=s)n=o-1;else if(e>l)i=o+1;else break;else if(e<s)n=o-1;else if(e>=l)i=o+1;else break}let a=e-s;return o>0&&(a+=this.wrappedTextIndentLength),new tf(o,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){let n=this.outputPositionToOffsetInInputWithInjections(e,t),o=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(o!==n)return this.offsetInInputWithInjectionsToOutputPosition(o,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new tf(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){let n=this.getOutputLineCount()-1;if(e<n&&t===this.getMaxOutputOffset(e))return new tf(e+1,this.getMinOutputOffset(e+1))}return new tf(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){let i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&X8(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(Q8(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let o=i.injectedTextIndex-1;for(;o>=0&&this.injectionOffsets[o]===this.injectionOffsets[i.injectedTextIndex]&&!(X8(this.injectionOptions[o].cursorStops)||(n-=this.injectionOptions[o].content.length,Q8(this.injectionOptions[o].cursorStops)));)o--;return n}}else if(t===1||t===4){let n=i.offsetInInputWithInjections+i.length,o=i.injectedTextIndex;for(;o+1<this.injectionOffsets.length&&this.injectionOffsets[o+1]===this.injectionOffsets[o];)n+=this.injectionOptions[o+1].content.length,o++;return n}else if(t===0||t===3){let n=i.offsetInInputWithInjections,o=i.injectedTextIndex;for(;o-1>=0&&this.injectionOffsets[o-1]===this.injectionOffsets[o];)n-=this.injectionOptions[o-1].content.length,o--;return n}cv(t)}getInjectedText(e,t){let i=this.outputPositionToOffsetInInputWithInjections(e,t),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(e){let t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let n=0;for(let o=0;o<t.length;o++){let s=i[o].content.length,a=t[o]+n,l=t[o]+n+s;if(a>e)break;if(e<=l)return{injectedTextIndex:o,offsetInInputWithInjections:a,length:s};n+=s}}}};function X8(r){return r==null?!0:r===1||r===0}function Q8(r){return r==null?!0:r===2||r===0}var tf=class{outputLineIndex;outputOffset;constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new F(e+this.outputLineIndex,this.outputOffset+1)}};var yZ=()=>!0,IZ=()=>!1,CZ=r=>r===" "||r==="	",ec=class{constructor(e,t,i,n){this.languageConfigurationService=n;this._languageId=e;let o=i.options,s=o.get(147),a=o.get(51);this.readOnly=o.get(93),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=o.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=o.get(130),this.wordSeparators=o.get(133),this.emptySelectionClipboard=o.get(38),this.copyWithSyntaxHighlighting=o.get(25),this.multiCursorMergeOverlapping=o.get(78),this.multiCursorPaste=o.get(80),this.multiCursorLimit=o.get(81),this.autoClosingBrackets=o.get(6),this.autoClosingComments=o.get(7),this.autoClosingQuotes=o.get(11),this.autoClosingDelete=o.get(9),this.autoClosingOvertype=o.get(10),this.autoSurround=o.get(14),this.autoIndent=o.get(12),this.wordSegmenterLocales=o.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(e){return e.hasChanged(147)||e.hasChanged(133)||e.hasChanged(38)||e.hasChanged(78)||e.hasChanged(80)||e.hasChanged(81)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(130)||e.hasChanged(51)||e.hasChanged(93)||e.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(let t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,i){let n=Nl(t,i-1),o=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return o?o.onElectricCharacter(e,n,i-n.firstCharOffset):null}normalizeIndentation(e){return ox(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return CZ;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return yZ;case"never":return IZ}}_getLanguageDefinedShouldAutoClose(e,t){let i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(e,t){return oi.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){let n=oi.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),o=e.getLineMinColumn(t);if(n<o)return o;let s=e.getLineMaxColumn(t);return n>s?s:n}},ot=class r{_cursorStateBrand=void 0;static fromModelState(e){return new TP(e)}static fromViewState(e){return new _P(e)}static fromModelSelection(e){let t=tt.liftSelection(e),i=new dn(O.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return r.fromModelState(i)}static fromModelSelections(e){let t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i]);return t}modelState;viewState;constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}},TP=class{modelState;viewState;constructor(e){this.modelState=e,this.viewState=null}},_P=class{modelState;viewState;constructor(e){this.modelState=null,this.viewState=e}};var dn=class r{constructor(e,t,i,n,o){this.selectionStart=e;this.selectionStartKind=t;this.selectionStartLeftoverVisibleColumns=i;this.position=n;this.leftoverVisibleColumns=o;this.selection=r._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,n){return e?new r(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new F(t,i),n):new r(new O(t,i,t,i),0,n,new F(t,i),n)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?tt.fromPositions(e.getStartPosition(),t):tt.fromPositions(e.getEndPosition(),t)}},wn=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(e,t,i){this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}};function Ka(r){return r==="'"||r==='"'||r==="`"}var TT=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}};var _T=class{type=0;constructor(){}},DT=class{type=1;constructor(){}},LT=class{type=2;_source;constructor(e){this._source=e}hasChanged(e){return this._source.hasChanged(e)}},kT=class{constructor(e,t,i){this.selections=e;this.modelSelections=t;this.reason=i}type=3},Yl=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(e){e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},ch=class{type=5;constructor(){}},RT=class{type=6;isFocused;constructor(e){this.isFocused=e}},AT=class{type=7},uh=class{type=8;constructor(){}},mI=class{constructor(e,t){this.fromLineNumber=e;this.count=t}type=9},nf=class{type=10;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},of=class{type=11;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}};var tc=class{constructor(e,t,i,n,o,s,a){this.source=e;this.minimalReveal=t;this.range=i;this.selections=n;this.verticalType=o;this.revealHorizontal=s;this.scrollType=a}type=12},MT=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e){this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}},OT=class{constructor(e){this.theme=e}type=14},PT=class{type=15;ranges;constructor(e){this.ranges=e}},NT=class{type=16;constructor(){}},FT=class{type=17;constructor(){}};var ra=class extends P{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,n=e.length;i<n;i++){let o=e[i];switch(o.type){case 0:this.onCompositionStart(o)&&(t=!0);break;case 1:this.onCompositionEnd(o)&&(t=!0);break;case 2:this.onConfigurationChanged(o)&&(t=!0);break;case 3:this.onCursorStateChanged(o)&&(t=!0);break;case 4:this.onDecorationsChanged(o)&&(t=!0);break;case 5:this.onFlushed(o)&&(t=!0);break;case 6:this.onFocusChanged(o)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(o)&&(t=!0);break;case 8:this.onLineMappingChanged(o)&&(t=!0);break;case 9:this.onLinesChanged(o)&&(t=!0);break;case 10:this.onLinesDeleted(o)&&(t=!0);break;case 11:this.onLinesInserted(o)&&(t=!0);break;case 12:this.onRevealRangeRequest(o)&&(t=!0);break;case 13:this.onScrollChanged(o)&&(t=!0);break;case 15:this.onTokensChanged(o)&&(t=!0);break;case 14:this.onThemeChanged(o)&&(t=!0);break;case 16:this.onTokensColorsChanged(o)&&(t=!0);break;case 17:this.onZonesChanged(o)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(o)}}t&&(this._shouldRender=!0)}};var gI=class{_viewportBrand=void 0;top;left;width;height;constructor(e,t,i,n){this.top=e|0,this.left=t|0,this.width=i|0,this.height=n|0}},BT=class{tabSize;data;constructor(e,t){this.tabSize=e,this.data=t}},ph=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(e,t,i,n,o,s,a){this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=o,this.tokens=s,this.inlineDecorations=a}},Zl=class r{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(e,t,i,n,o,s,a,l,d,c){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=r.isBasicASCII(i,s),this.containsRTL=r.containsRTL(i,this.isBasicASCII,o),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(e,t){return t?Ev(e):!0}static containsRTL(e,t,i){return!t&&i?Rd(e):!1}};var ic=class{constructor(e,t,i){this.range=e;this.inlineClassName=t;this.type=i}},VT=class{constructor(e,t,i,n){this.startOffset=e;this.endOffset=t;this.inlineClassName=i;this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(e){return new ic(new O(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},sf=class{_viewModelDecorationBrand=void 0;range;options;constructor(e,t){this.range=e,this.options=t}},hh=class r{constructor(e,t,i){this.color=e;this.zIndex=t;this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&li(e.data,t.data)}static equalsArr(e,t){return li(e,t,r.equals)}};var WT=class{_colorZoneBrand=void 0;from;to;colorId;constructor(e,t,i){this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}},fI=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(e,t,i,n){this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}},HT=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(fI.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),o=i/n,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!e){let E=c.getColorZones();if(E){a.push(E);continue}}let u=this._getVerticalOffsetForLine(c.startLineNumber),p=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+t:u+c.heightInLines*t,m=Math.floor(o*u),f=Math.floor(o*p),g=Math.floor((m+f)/2),b=f-g;b<s&&(b=s),g-b<0&&(g=b),g+b>i&&(g=i-b);let v=c.color,I=this._color2Id[v];I||(I=++this._lastAssignedId,this._color2Id[v]=I,this._id2Color[I]=v);let w=new WT(g-b,g+b,I);c.setColorZone(w),a.push(w)}return this._colorZonesInvalid=!1,a.sort(WT.compare),a}};var Se;(Ye=>(Ye.editorSimpleInput=new q("editorSimpleInput",!1,!0),Ye.editorTextFocus=new q("editorTextFocus",!1,h("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),Ye.focus=new q("editorFocus",!1,h("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),Ye.textInputFocus=new q("textInputFocus",!1,h("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),Ye.readOnly=new q("editorReadonly",!1,h("editorReadonly","Whether the editor is read-only")),Ye.inDiffEditor=new q("inDiffEditor",!1,h("inDiffEditor","Whether the context is a diff editor")),Ye.isEmbeddedDiffEditor=new q("isEmbeddedDiffEditor",!1,h("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),Ye.multiDiffEditorAllCollapsed=new q("multiDiffEditorAllCollapsed",void 0,h("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),Ye.hasChanges=new q("diffEditorHasChanges",!1,h("diffEditorHasChanges","Whether the diff editor has changes")),Ye.comparingMovedCode=new q("comparingMovedCode",!1,h("comparingMovedCode","Whether a moved code block is selected for comparison")),Ye.accessibleDiffViewerVisible=new q("accessibleDiffViewerVisible",!1,h("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),Ye.diffEditorRenderSideBySideInlineBreakpointReached=new q("diffEditorRenderSideBySideInlineBreakpointReached",!1,h("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),Ye.diffEditorInlineMode=new q("diffEditorInlineMode",!1,h("diffEditorInlineMode","Whether inline mode is active")),Ye.diffEditorOriginalWritable=new q("diffEditorOriginalWritable",!1,h("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),Ye.diffEditorModifiedWritable=new q("diffEditorModifiedWritable",!1,h("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),Ye.diffEditorOriginalUri=new q("diffEditorOriginalUri","",h("diffEditorOriginalUri","The uri of the original document")),Ye.diffEditorModifiedUri=new q("diffEditorModifiedUri","",h("diffEditorModifiedUri","The uri of the modified document")),Ye.columnSelection=new q("editorColumnSelection",!1,h("editorColumnSelection","Whether `editor.columnSelection` is enabled")),Ye.writable=Ye.readOnly.toNegated(),Ye.hasNonEmptySelection=new q("editorHasSelection",!1,h("editorHasSelection","Whether the editor has text selected")),Ye.hasOnlyEmptySelection=Ye.hasNonEmptySelection.toNegated(),Ye.hasMultipleSelections=new q("editorHasMultipleSelections",!1,h("editorHasMultipleSelections","Whether the editor has multiple selections")),Ye.hasSingleSelection=Ye.hasMultipleSelections.toNegated(),Ye.tabMovesFocus=new q("editorTabMovesFocus",!1,h("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),Ye.tabDoesNotMoveFocus=Ye.tabMovesFocus.toNegated(),Ye.isInEmbeddedEditor=new q("isInEmbeddedEditor",!1,!0),Ye.canUndo=new q("canUndo",!1,!0),Ye.canRedo=new q("canRedo",!1,!0),Ye.hoverVisible=new q("editorHoverVisible",!1,h("editorHoverVisible","Whether the editor hover is visible")),Ye.hoverFocused=new q("editorHoverFocused",!1,h("editorHoverFocused","Whether the editor hover is focused")),Ye.stickyScrollFocused=new q("stickyScrollFocused",!1,h("stickyScrollFocused","Whether the sticky scroll is focused")),Ye.stickyScrollVisible=new q("stickyScrollVisible",!1,h("stickyScrollVisible","Whether the sticky scroll is visible")),Ye.standaloneColorPickerVisible=new q("standaloneColorPickerVisible",!1,h("standaloneColorPickerVisible","Whether the standalone color picker is visible")),Ye.standaloneColorPickerFocused=new q("standaloneColorPickerFocused",!1,h("standaloneColorPickerFocused","Whether the standalone color picker is focused")),Ye.inCompositeEditor=new q("inCompositeEditor",void 0,h("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),Ye.notInCompositeEditor=Ye.inCompositeEditor.toNegated(),Ye.languageId=new q("editorLangId","",h("editorLangId","The language identifier of the editor")),Ye.hasCompletionItemProvider=new q("editorHasCompletionItemProvider",!1,h("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),Ye.hasCodeActionsProvider=new q("editorHasCodeActionsProvider",!1,h("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),Ye.hasCodeLensProvider=new q("editorHasCodeLensProvider",!1,h("editorHasCodeLensProvider","Whether the editor has a code lens provider")),Ye.hasDefinitionProvider=new q("editorHasDefinitionProvider",!1,h("editorHasDefinitionProvider","Whether the editor has a definition provider")),Ye.hasDeclarationProvider=new q("editorHasDeclarationProvider",!1,h("editorHasDeclarationProvider","Whether the editor has a declaration provider")),Ye.hasImplementationProvider=new q("editorHasImplementationProvider",!1,h("editorHasImplementationProvider","Whether the editor has an implementation provider")),Ye.hasTypeDefinitionProvider=new q("editorHasTypeDefinitionProvider",!1,h("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),Ye.hasHoverProvider=new q("editorHasHoverProvider",!1,h("editorHasHoverProvider","Whether the editor has a hover provider")),Ye.hasDocumentHighlightProvider=new q("editorHasDocumentHighlightProvider",!1,h("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),Ye.hasDocumentSymbolProvider=new q("editorHasDocumentSymbolProvider",!1,h("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),Ye.hasReferenceProvider=new q("editorHasReferenceProvider",!1,h("editorHasReferenceProvider","Whether the editor has a reference provider")),Ye.hasRenameProvider=new q("editorHasRenameProvider",!1,h("editorHasRenameProvider","Whether the editor has a rename provider")),Ye.hasSignatureHelpProvider=new q("editorHasSignatureHelpProvider",!1,h("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),Ye.hasInlayHintsProvider=new q("editorHasInlayHintsProvider",!1,h("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),Ye.hasDocumentFormattingProvider=new q("editorHasDocumentFormattingProvider",!1,h("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),Ye.hasDocumentSelectionFormattingProvider=new q("editorHasDocumentSelectionFormattingProvider",!1,h("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),Ye.hasMultipleDocumentFormattingProvider=new q("editorHasMultipleDocumentFormattingProvider",!1,h("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),Ye.hasMultipleDocumentSelectionFormattingProvider=new q("editorHasMultipleDocumentSelectionFormattingProvider",!1,h("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(Se||={});var DP=class{constructor(e,t){this.renderer=e;this.modelProvider=t}get templateId(){return this.renderer.templateId}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:P.None}}renderElement(e,t,i,n){if(i.disposable?.dispose(),!i.data)return;let o=this.modelProvider();if(o.isResolved(e))return this.renderer.renderElement(o.get(e),e,i.data,n);let s=new Vi,a=o.resolve(e,s.token);i.disposable={dispose:()=>s.cancel()},this.renderer.renderPlaceholder(e,i.data),a.then(l=>this.renderer.renderElement(l,e,i.data,n))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}},LP=class{constructor(e,t){this.modelProvider=e;this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){let t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}};function SZ(r,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new LP(r,e.accessibilityProvider)}}var UT=class{list;_model;constructor(e,t,i,n,o={}){let s=()=>this.model,a=n.map(l=>new DP(l,s));this.list=new Sn(e,t,i,a,SZ(s,o))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}isDOMFocused(){return ho(this.getHTMLElement())}domFocus(){this.list.domFocus()}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseClick(){return z.map(this.list.onMouseClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onMouseDblClick(){return z.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onTap(){return z.map(this.list.onTap,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return z.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeFocus(){return z.map(this.list.onDidChangeFocus,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(n=>this._model.get(n)),indexes:t,browserEvent:i}))}get onDidChangeSelection(){return z.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(n=>this._model.get(n)),indexes:t,browserEvent:i}))}get onContextMenu(){return z.map(this.list.onContextMenu,({element:e,index:t,anchor:i,browserEvent:n})=>typeof e>"u"?{element:e,index:t,anchor:i,browserEvent:n}:{element:this._model.get(e),index:t,anchor:i,browserEvent:n})}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,_n(e.length))}get length(){return this.list.length}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(e){this.list.scrollLeft=e}setAnchor(e){this.list.setAnchor(e)}getAnchor(){return this.list.getAnchor()}setFocus(e){this.list.setFocus(e)}focusNext(e,t){this.list.focusNext(e,t)}focusPrevious(e,t){this.list.focusPrevious(e,t)}focusNextPage(){return this.list.focusNextPage()}focusPreviousPage(){return this.list.focusPreviousPage()}focusLast(){this.list.focusLast()}focusFirst(){this.list.focusFirst()}getFocus(){return this.list.getFocus()}setSelection(e,t){this.list.setSelection(e,t)}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}layout(e,t){this.list.layout(e,t)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}reveal(e,t){this.list.reveal(e,t)}style(e){this.list.style(e)}dispose(){this.list.dispose()}};var wZ={separatorBorder:U.transparent};var zT=class{constructor(e,t,i,n){this.container=e;this.view=t;this.disposable=n;typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}_size;set size(e){this._size=e}get size(){return this._size}_cachedVisibleSize=void 0;get cachedVisibleSize(){return this._cachedVisibleSize}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){if(e!==this.visible){e?(this.size=uo(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{this.view.setVisible?.(e)}catch(i){console.error("Splitview: Failed to set visible view"),console.error(i)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}},kP=class extends zT{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}},RP=class extends zT{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}};var Ql;(n=>{n.Distribute={type:"distribute"};function e(o){return{type:"split",index:o}}n.Split=e;function t(o){return{type:"auto",index:o}}n.Auto=t;function i(o){return{type:"invisible",cachedVisibleSize:o}}n.Invisible=i})(Ql||={});var Xl=class extends P{orientation;el;sashContainer;viewContainer;scrollable;scrollableElement;size=0;layoutContext;_contentSize=0;proportions=void 0;viewItems=[];sashItems=[];sashDragState;state=0;inverseAltBehavior;proportionalLayout;getSashOrthogonalSize;_onDidSashChange=this._register(new _);_onDidSashReset=this._register(new _);_orthogonalStartSash;_orthogonalEndSash;_startSnappingEnabled=!0;_endSnappingEnabled=!0;get contentSize(){return this._contentSize}onDidSashChange=this._onDidSashChange.event;onDidSashReset=this._onDidSashReset.event;onDidScroll;get length(){return this.viewItems.length}get minimumSize(){return this.viewItems.reduce((e,t)=>e+t.minimumSize,0)}get maximumSize(){return this.length===0?Number.POSITIVE_INFINITY:this.viewItems.reduce((e,t)=>e+t.maximumSize,0)}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(let t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(let t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}get sashes(){return this.sashItems.map(e=>e.sash)}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=ye(this.el,he(".sash-container")),this.viewContainer=he(".split-view-container"),this.scrollable=this._register(new _a({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>Yi(pe(this.el),n)})),this.scrollableElement=this._register(new Gc(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));let i=this._register(new Me(this.viewContainer,"scroll")).event;this._register(i(n=>{let o=this.scrollableElement.getScrollPosition(),s=Math.abs(this.viewContainer.scrollLeft-o.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-o.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(s!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:s,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),ye(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||wZ),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((n,o)=>{let s=kn(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,s,o,!0)}),this._contentSize=this.viewItems.reduce((n,o)=>n+o.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,n){this.doAddView(e,t,i,n)}removeView(e,t){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{t?.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index});let i=t?.type==="split"?this.viewItems[t.index]:void 0,n=this.viewItems.splice(e,1)[0];if(i&&(i.size+=n.size),this.viewItems.length>=1){let s=Math.max(e-1,0);this.sashItems.splice(s,1)[0].disposable.dispose()}this.relayout(),t?.type==="distribute"&&this.distributeViewSizes();let o=n.view;return n.dispose(),o}finally{this.state=0}}removeAllViews(){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let e=this.viewItems.splice(0,this.viewItems.length);for(let i of e)i.dispose();let t=this.sashItems.splice(0,this.sashItems.length);for(let i of t)i.disposable.dispose();return this.relayout(),e.map(i=>i.view)}finally{this.state=0}}moveView(e,t){if(this.state!==0)throw new Error("Cant modify splitview");let i=this.getViewCachedVisibleSize(e),n=typeof i>"u"?this.getViewSize(e):Ql.Invisible(i),o=this.removeView(e);this.addView(o,n,t)}swapViews(e,t){if(this.state!==0)throw new Error("Cant modify splitview");if(e>t)return this.swapViews(t,e);let i=this.getViewSize(e),n=this.getViewSize(t),o=this.removeView(t),s=this.removeView(e);this.addView(o,i,e),this.addView(s,n,t)}isViewVisible(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].visible}setViewVisible(e,t){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");this.viewItems[e].setVisible(t),this.distributeEmptySpace(e),this.layoutViews(),this.saveProportions()}getViewCachedVisibleSize(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].cachedVisibleSize}layout(e,t){let i=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let n=0;for(let o=0;o<this.viewItems.length;o++){let s=this.viewItems[o],a=this.proportions[o];typeof a=="number"?n+=a:e-=s.size}for(let o=0;o<this.viewItems.length;o++){let s=this.viewItems[o],a=this.proportions[o];typeof a=="number"&&n>0&&(s.size=uo(Math.round(a*e/n),s.minimumSize,s.maximumSize))}}else{let n=_n(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,o,s)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(let a of this.viewItems)a.enabled=!1;let n=this.sashItems.findIndex(a=>a.sash===e),o=un(B(this.el.ownerDocument.body,"keydown",a=>s(this.sashDragState.current,a.altKey)),B(this.el.ownerDocument.body,"keyup",()=>s(this.sashDragState.current,!1))),s=(a,l)=>{let d=this.viewItems.map(f=>f.size),c=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){let g=this.viewItems[n];c=(g.minimumSize-g.size)/2,u=(g.maximumSize-g.size)/2}else{let g=this.viewItems[n+1];c=(g.size-g.maximumSize)/2,u=(g.size-g.minimumSize)/2}let p,m;if(!l){let f=_n(n,-1),g=_n(n+1,this.viewItems.length),b=f.reduce((L,A)=>L+(this.viewItems[A].minimumSize-d[A]),0),v=f.reduce((L,A)=>L+(this.viewItems[A].viewMaximumSize-d[A]),0),I=g.length===0?Number.POSITIVE_INFINITY:g.reduce((L,A)=>L+(d[A]-this.viewItems[A].minimumSize),0),w=g.length===0?Number.NEGATIVE_INFINITY:g.reduce((L,A)=>L+(d[A]-this.viewItems[A].viewMaximumSize),0),E=Math.max(b,w),S=Math.min(I,v),T=this.findFirstSnapIndex(f),D=this.findFirstSnapIndex(g);if(typeof T=="number"){let L=this.viewItems[T],A=Math.floor(L.viewMinimumSize/2);p={index:T,limitDelta:L.visible?E-A:E+A,size:L.size}}if(typeof D=="number"){let L=this.viewItems[D],A=Math.floor(L.viewMinimumSize/2);m={index:D,limitDelta:L.visible?S+A:S-A,size:L.size}}}this.sashDragState={start:a,current:a,index:n,sizes:d,minDelta:c,maxDelta:u,alt:l,snapBefore:p,snapAfter:m,disposable:o}};s(t,i)}onSashChange({current:e}){let{index:t,start:i,sizes:n,alt:o,minDelta:s,maxDelta:a,snapBefore:l,snapAfter:d}=this.sashDragState;this.sashDragState.current=e;let c=e-i,u=this.resize(t,c,n,void 0,void 0,s,a,l,d);if(o){let p=t===this.sashItems.length-1,m=this.viewItems.map(w=>w.size),f=p?t:t+1,g=this.viewItems[f],b=g.size-g.maximumSize,v=g.size-g.minimumSize,I=p?t-1:t+1;this.resize(I,-u,m,void 0,void 0,b,v)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(let t of this.viewItems)t.enabled=!0}onViewChange(e,t){let i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=uo(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let i=_n(this.viewItems.length).filter(a=>a!==e),n=[...i.filter(a=>this.viewItems[a].priority===1),e],o=i.filter(a=>this.viewItems[a].priority===2),s=this.viewItems[e];t=Math.round(t),t=uo(t,s.minimumSize,Math.min(s.maximumSize,this.size)),s.size=t,this.relayout(n,o)}finally{this.state=0}}}isViewExpanded(e){if(e<0||e>=this.viewItems.length)return!1;for(let t of this.viewItems)if(t!==this.viewItems[e]&&t.size>t.minimumSize)return!1;return!0}distributeViewSizes(){let e=[],t=0;for(let a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);let i=Math.floor(t/e.length);for(let a of e)a.size=uo(i,a.minimumSize,a.maximumSize);let n=_n(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);this.relayout(o,s)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,n){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let o=he(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(o):this.viewContainer.insertBefore(o,this.viewContainer.children.item(i));let s=e.onDidChange(p=>this.onViewChange(c,p)),a=te(()=>o.remove()),l=un(s,a),d;typeof t=="number"?d=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?d=this.getViewSize(t.index)/2:t.type==="invisible"?d={cachedVisibleSize:t.cachedVisibleSize}:d=e.minimumSize);let c=this.orientation===0?new kP(o,e,d,l):new RP(o,e,d,l);if(this.viewItems.splice(i,0,c),this.viewItems.length>1){let p={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},m=this.orientation===0?new rh(this.sashContainer,{getHorizontalSashTop:L=>this.getSashPosition(L),getHorizontalSashWidth:this.getSashOrthogonalSize},{...p,orientation:1}):new rh(this.sashContainer,{getVerticalSashLeft:L=>this.getSashPosition(L),getVerticalSashHeight:this.getSashOrthogonalSize},{...p,orientation:0}),f=this.orientation===0?L=>({sash:m,start:L.startY,current:L.currentY,alt:L.altKey}):L=>({sash:m,start:L.startX,current:L.currentX,alt:L.altKey}),b=z.map(m.onDidStart,f)(this.onSashStart,this),I=z.map(m.onDidChange,f)(this.onSashChange,this),E=z.map(m.onDidEnd,()=>this.sashItems.findIndex(L=>L.sash===m))(this.onSashEnd,this),S=m.onDidReset(()=>{let L=this.sashItems.findIndex(oe=>oe.sash===m),A=_n(L,-1),W=_n(L+1,this.viewItems.length),j=this.findFirstSnapIndex(A),G=this.findFirstSnapIndex(W);typeof j=="number"&&!this.viewItems[j].visible||typeof G=="number"&&!this.viewItems[G].visible||this._onDidSashReset.fire(L)}),T=un(b,I,E,S,m),D={sash:m,disposable:T};this.sashItems.splice(i-1,0,D)}o.appendChild(e.element);let u;typeof t!="number"&&t.type==="split"&&(u=[t.index]),n||this.relayout([i],u),!n&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=0}}relayout(e,t){let i=this.viewItems.reduce((n,o)=>n+o.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(c=>c.size),n,o,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,d){if(e<0||e>=this.viewItems.length)return 0;let c=_n(e,-1),u=_n(e+1,this.viewItems.length);if(o)for(let D of o)uS(c,D),uS(u,D);if(n)for(let D of n)tv(c,D),tv(u,D);let p=c.map(D=>this.viewItems[D]),m=c.map(D=>i[D]),f=u.map(D=>this.viewItems[D]),g=u.map(D=>i[D]),b=c.reduce((D,L)=>D+(this.viewItems[L].minimumSize-i[L]),0),v=c.reduce((D,L)=>D+(this.viewItems[L].maximumSize-i[L]),0),I=u.length===0?Number.POSITIVE_INFINITY:u.reduce((D,L)=>D+(i[L]-this.viewItems[L].minimumSize),0),w=u.length===0?Number.NEGATIVE_INFINITY:u.reduce((D,L)=>D+(i[L]-this.viewItems[L].maximumSize),0),E=Math.max(b,w,s),S=Math.min(I,v,a),T=!1;if(l){let D=this.viewItems[l.index],L=t>=l.limitDelta;T=L!==D.visible,D.setVisible(L,l.size)}if(!T&&d){let D=this.viewItems[d.index],L=t<d.limitDelta;T=L!==D.visible,D.setVisible(L,d.size)}if(T)return this.resize(e,t,i,n,o,s,a);t=uo(t,E,S);for(let D=0,L=t;D<p.length;D++){let A=p[D],W=uo(m[D]+L,A.minimumSize,A.maximumSize),j=W-m[D];L-=j,A.size=W}for(let D=0,L=t;D<f.length;D++){let A=f[D],W=uo(g[D]-L,A.minimumSize,A.maximumSize),j=W-g[D];L+=j,A.size=W}return t}distributeEmptySpace(e){let t=this.viewItems.reduce((a,l)=>a+l.size,0),i=this.size-t,n=_n(this.viewItems.length-1,-1),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);for(let a of s)uS(n,a);for(let a of o)tv(n,a);typeof e=="number"&&tv(n,e);for(let a=0;i!==0&&a<n.length;a++){let l=this.viewItems[n[a]],d=uo(l.size+i,l.minimumSize,l.maximumSize),c=d-l.size;i-=c,l.size=d}}layoutViews(){this._contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(let t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1,t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;let i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),n=[...this.viewItems].reverse();e=!1;let o=n.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;let s=n.map(l=>e=l.maximumSize-l.size>0||e).reverse(),a=0;for(let l=0;l<this.sashItems.length;l++){let{sash:d}=this.sashItems[l],c=this.viewItems[l];a+=c.size;let u=!(t[l]&&s[l+1]),p=!(i[l]&&o[l+1]);if(u&&p){let m=_n(l,-1),f=_n(l+1,this.viewItems.length),g=this.findFirstSnapIndex(m),b=this.findFirstSnapIndex(f),v=typeof g=="number"&&!this.viewItems[g].visible,I=typeof b=="number"&&!this.viewItems[b].visible;v&&o[l]&&(a>0||this.startSnappingEnabled)?d.state=1:I&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?d.state=2:d.state=0}else u&&!p?d.state=1:!u&&p?d.state=2:d.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(let t of e){let i=this.viewItems[t];if(i.visible&&i.snap)return t}for(let t of e){let i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(let i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),ht(this.viewItems),this.viewItems=[],this.sashItems.forEach(e=>e.disposable.dispose()),this.sashItems=[],super.dispose()}};var KT=class r{constructor(e,t,i){this.columns=e;this.getColumnSize=i;let n=new Map(t.map(o=>[o.templateId,o]));this.renderers=[];for(let o of e){let s=n.get(o.templateId);if(!s)throw new Error(`Table cell renderer for template id ${o.templateId} not found.`);this.renderers.push(s)}}static TemplateId="row";templateId=r.TemplateId;renderers;renderedTemplates=new Set;renderTemplate(e){let t=ye(e,he(".monaco-table-tr")),i=[],n=[];for(let s=0;s<this.columns.length;s++){let a=this.renderers[s],l=ye(t,he(".monaco-table-td",{"data-col-index":s}));l.style.width=`${this.getColumnSize(s)}px`,i.push(l),n.push(a.renderTemplate(l))}let o={container:e,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(o),o}renderElement(e,t,i,n){for(let o=0;o<this.columns.length;o++){let a=this.columns[o].project(e);this.renderers[o].renderElement(a,t,i.cellTemplateData[o],n)}}disposeElement(e,t,i,n){for(let o=0;o<this.columns.length;o++){let s=this.renderers[o];if(s.disposeElement){let l=this.columns[o].project(e);s.disposeElement(l,t,i.cellTemplateData[o],n)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);Xt(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(let{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}};function xZ(r){return{getHeight(e){return r.getHeight(e)},getTemplateId(){return KT.TemplateId}}}var AP=class extends P{constructor(t,i){super();this.column=t;this.index=i;this.element=he(".monaco-table-th",{"data-col-index":i},t.label),t.tooltip&&this._register(tn().setupManagedHover(Dt("mouse"),this.element,t.tooltip))}element;get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??z.None}_onDidLayout=new _;onDidLayout=this._onDidLayout.event;layout(t){this._onDidLayout.fire([this.index,t])}},GT=class r{constructor(e,t,i,n,o,s){this.virtualDelegate=i;this.columns=n;this.domNode=ye(t,he(`.monaco-table.${this.domId}`));let a=n.map((c,u)=>this.disposables.add(new AP(c,u))),l={size:a.reduce((c,u)=>c+u.column.weight,0),views:a.map(c=>({size:c.column.weight,view:c}))};this.splitview=this.disposables.add(new Xl(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;let d=new KT(n,o,c=>this.splitview.getViewSize(c));this.list=this.disposables.add(new Sn(e,this.domNode,xZ(i),[d],s)),z.any(...a.map(c=>c.onDidLayout))(([c,u])=>d.layoutColumn(c,u),null,this.disposables),this.splitview.onDidSashReset(c=>{let u=n.reduce((m,f)=>m+f.weight,0),p=n[c].weight/u*this.cachedWidth;this.splitview.resizeView(c,p)},null,this.disposables),this.styleElement=rr(this.domNode),this.style(HE)}static InstanceCount=0;domId=`table_id_${++r.InstanceCount}`;domNode;splitview;list;styleElement;disposables=new Y;cachedWidth=0;cachedHeight=0;get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseClick(){return this.list.onMouseClick}get onMouseDblClick(){return this.list.onMouseDblClick}get onMouseMiddleClick(){return this.list.onMouseMiddleClick}get onPointer(){return this.list.onPointer}get onMouseUp(){return this.list.onMouseUp}get onMouseDown(){return this.list.onMouseDown}get onMouseOver(){return this.list.onMouseOver}get onMouseMove(){return this.list.onMouseMove}get onMouseOut(){return this.list.onMouseOut}get onTouchStart(){return this.list.onTouchStart}get onTap(){return this.list.onTap}get onContextMenu(){return this.list.onContextMenu}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(e){this.list.scrollLeft=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}getColumnLabels(){return this.columns.map(e=>e.label)}resizeColumn(e,t){let i=Math.round(t/100*this.cachedWidth);this.splitview.resizeView(e,i)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}rerender(){this.list.rerender()}row(e){return this.list.element(e)}indexOf(e){return this.list.indexOf(e)}get length(){return this.list.length}getHTMLElement(){return this.domNode}layout(e,t){e=e??cE(this.domNode),t=t??Rm(this.domNode),this.cachedWidth=t,this.cachedHeight=e,this.splitview.layout(t);let i=e-this.virtualDelegate.headerRowHeight;this.list.getHTMLElement().style.height=`${i}px`,this.list.layout(i,t)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}style(e){let t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}domFocus(){this.list.domFocus()}setAnchor(e){this.list.setAnchor(e)}getAnchor(){return this.list.getAnchor()}getSelectedElements(){return this.list.getSelectedElements()}setSelection(e,t){this.list.setSelection(e,t)}getSelection(){return this.list.getSelection()}setFocus(e,t){this.list.setFocus(e,t)}focusNext(e=1,t=!1,i){this.list.focusNext(e,t,i)}focusPrevious(e=1,t=!1,i){this.list.focusPrevious(e,t,i)}focusNextPage(e){return this.list.focusNextPage(e)}focusPreviousPage(e){return this.list.focusPreviousPage(e)}focusFirst(e){this.list.focusFirst(e)}focusLast(e){this.list.focusLast(e)}getFocus(){return this.list.getFocus()}getFocusedElements(){return this.list.getFocusedElements()}getRelativeTop(e){return this.list.getRelativeTop(e)}reveal(e,t){this.list.reveal(e,t)}dispose(){this.disposables.dispose()}};var TZ=h("caseDescription","Match Case"),_Z=h("wordsDescription","Match Whole Word"),DZ=h("regexDescription","Use Regular Expression"),jT=class extends Da{constructor(e){super({icon:ie.caseSensitive,title:TZ+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Dt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},qT=class extends Da{constructor(e){super({icon:ie.wholeWord,title:_Z+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Dt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},$T=class extends Da{constructor(e){super({icon:ie.regex,title:DZ+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Dt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}};var YT=class{constructor(e,t=0,i=e.length,n=t-1){this.items=e;this.start=t;this.end=i;this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}};var ZT=class{_history;_limit;_navigator;constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isFirst(){return this._currentPosition()===0}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}clear(){this._initialize([]),this._onChange()}_onChange(){this._reduceToLimit();let e=this._elements;this._navigator=new YT(e,0,e.length,e.length)}_reduceToLimit(){let e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){let e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(let t of e)this._history.add(t)}get _elements(){let e=[];return this._history.forEach(t=>e.push(t)),e}};var bI=he;var e7={inputBackground:"#3C3C3C",inputForeground:"#CCCCCC",inputValidationInfoBorder:"#55AAFF",inputValidationInfoBackground:"#063B49",inputValidationWarningBorder:"#B89500",inputValidationWarningBackground:"#352A05",inputValidationErrorBorder:"#BE1100",inputValidationErrorBackground:"#5A1D1D",inputBorder:void 0,inputValidationErrorForeground:void 0,inputValidationInfoForeground:void 0,inputValidationWarningForeground:void 0},XT=class extends On{contextViewProvider;element;input;actionbar;options;message;placeholder;tooltip;ariaLabel;validation;state="idle";mirror;cachedHeight;cachedContentHeight;maxHeight=Number.POSITIVE_INFINITY;scrollableElement;hover;_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;_onDidHeightChange=this._register(new _);onDidHeightChange=this._onDidHeightChange.event;constructor(e,t,i){super(),this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=ye(e,bI(".monaco-inputbox.idle"));let n=this.options.flexibleHeight?"textarea":"input",o=ye(this.element,bI(".ibwrapper"));if(this.input=ye(o,bI(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=ye(o,bI("div.mirror")),this.mirror.innerText="\xA0",this.scrollableElement=new Nm(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),ye(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));let s=this._register(new Me(e.ownerDocument,"selectionchange")),a=z.filter(s.event,()=>e.ownerDocument.getSelection()?.anchorNode===o);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new Pn(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(tn().setupManagedHover(Dt("mouse"),this.input,e))}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get mirrorElement(){return this.mirror}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get step(){return this.input.step}set step(e){this.input.step=e}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:uE(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return ho(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){let e=this.input.selectionStart;if(e===null)return null;let t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}setEnabled(e){e?this.enable():this.disable()}get width(){return Lp(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){let i=parseFloat(this.mirror.style.paddingLeft||"")||0,n=parseFloat(this.mirror.style.paddingRight||"")||0;t=i+n}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;let e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&fi(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));let i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Ir(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e?.type}stylesForType(e){let t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t=()=>e.style.width=Lp(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;e=ye(n,bI(".monaco-inputbox-container")),t();let o={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?xH(this.message.content,o):wH(this.message.content,o);s.classList.add(this.classForType(this.message.type));let a=this.stylesForType(this.message.type);return s.style.backgroundColor=a.background??"",s.style.color=a.foreground??"",s.style.border=a.border?`1px solid ${a.border}`:"",ye(e,s),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=h("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=h("alertWarningMessage","Warning: {0}",this.message.content):i=h("alertInfoMessage","Info: {0}",this.message.content),Yc(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;let e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText="\xA0",this.layout()}applyStyles(){let e=this.options.inputBoxStyles,t=e.inputBackground??"",i=e.inputForeground??"",n=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${Ir(n,"transparent")}`}layout(){if(!this.mirror)return;let e=this.cachedContentHeight;this.cachedContentHeight=uE(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){let t=this.inputElement,i=t.selectionStart,n=t.selectionEnd,o=t.value;i!==null&&n!==null&&(this.value=o.substr(0,i)+e+o.substr(n),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}},xu=class extends XT{history;observer;_onDidFocus=this._register(new _);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new _);onDidBlur=this._onDidBlur.event;constructor(e,t,i){let n=h({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," or {0} for history","\u21C5"),o=h({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," ({0} for history)","\u21C5");super(e,t,i),this.history=new ZT(i.history,100);let s=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(o)&&this.history.getHistory().length){let a=this.placeholder.endsWith(")")?n:o,l=this.placeholder+a;i.showPlaceholderOnFocus&&!ho(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(d=>{d.target.textContent||s()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>s()),this.onblur(this.input,()=>{let a=l=>{if(this.placeholder.endsWith(l)){let d=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};a(o)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}prependHistory(e){let t=this.getHistory();this.clearHistory(),e.forEach(i=>{this.history.add(i)}),t.forEach(i=>{this.history.add(i)})}getHistory(){return this.history.getHistory()}isAtFirstInHistory(){return this.history.isFirst()}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",$v(this.value?this.value:h("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,$v(this.value))}clearHistory(){this.history.clear()}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}};var LZ=h("defaultLabel","input"),af=class extends On{static OPTION_CHANGE="optionChange";placeholder;validation;label;showCommonFindToggles;fixFocusOnOptionClickEnabled=!0;imeSessionInProgress=!1;additionalTogglesDisposables=this._register(new xt);controls;regex;wholeWords;caseSensitive;additionalToggles=[];domNode;inputBox;_onDidOptionChange=this._register(new _);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new _);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new _);onMouseDown=this._onMouseDown.event;_onInput=this._register(new _);onInput=this._onInput.event;_onKeyUp=this._register(new _);onKeyUp=this._onKeyUp.event;_onCaseSensitiveKeyDown=this._register(new _);onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event;_onRegexKeyDown=this._register(new _);onRegexKeyDown=this._onRegexKeyDown.event;constructor(e,t,i){super(),this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||LZ,this.showCommonFindToggles=!!i.showCommonFindToggles;let n=i.appendCaseSensitiveLabel||"",o=i.appendWholeWordsLabel||"",s=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,d=!!i.flexibleWidth,c=i.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new xu(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:i.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:i.inputBoxStyles}));let u=this._register(Vd());if(this.showCommonFindToggles){this.regex=this._register(new $T({appendTitle:s,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.regex.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(m=>{this._onRegexKeyDown.fire(m)})),this.wholeWords=this._register(new qT({appendTitle:o,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.wholeWords.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new jT({appendTitle:n,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.caseSensitive.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(m=>{this._onCaseSensitiveKeyDown.fire(m)}));let p=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let f=p.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;m.equals(17)?g=(f+1)%p.length:m.equals(15)&&(f===0?g=p.length-1:g=f-1),m.equals(9)?(p[f].blur(),this.inputBox.focus()):g>=0&&p[g].focus(),Oe.stop(m,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e?.appendChild(this.domNode),this._register(B(this.inputBox.inputElement,"compositionstart",p=>{this.imeSessionInProgress=!0})),this._register(B(this.inputBox.inputElement,"compositionend",p=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,p=>this._onKeyDown.fire(p)),this.onkeyup(this.inputBox.inputElement,p=>this._onKeyUp.fire(p)),this.oninput(this.inputBox.inputElement,p=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,p=>this._onMouseDown.fire(p))}get isImeSessionInProgress(){return this.imeSessionInProgress}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(let e of this.additionalToggles)e.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(let e of this.additionalToggles)e.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(let t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new Y;for(let t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((t,i)=>t+i.width(),0)}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}onSearchSubmit(){this.inputBox.addToHistory()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){return this.regex?.checked??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}focusOnRegex(){this.regex?.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}};var Ai=class extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}},mh=class{constructor(e){this.fn=e}_map=new WeakMap;map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}};function vI(r){return typeof r=="object"&&"visibility"in r&&"data"in r}function gh(r){switch(r){case!0:return 1;case!1:return 0;default:return r}}function MP(r){return typeof r.collapsible=="boolean"}var QT=class{constructor(e,t,i={}){this.user=e;this.collapseByDefault=typeof i.collapseByDefault>"u"?!1:i.collapseByDefault,this.allowNonCollapsibleParents=i.allowNonCollapsibleParents??!1,this.filter=i.filter,this.autoExpandSingleChildren=typeof i.autoExpandSingleChildren>"u"?!1:i.autoExpandSingleChildren,this.root={parent:void 0,element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}rootRef=[];root;eventBufferer=new Mc;_onDidSpliceModel=new _;onDidSpliceModel=this._onDidSpliceModel.event;_onDidSpliceRenderedNodes=new _;onDidSpliceRenderedNodes=this._onDidSpliceRenderedNodes.event;_onDidChangeCollapseState=new _;onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event);_onDidChangeRenderNodeCount=new _;onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event);collapseByDefault;allowNonCollapsibleParents;filter;autoExpandSingleChildren;refilterDelayer=new vs(RS);splice(e,t,i=ct.empty(),n={}){if(e.length===0)throw new Ai(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,e,t,i,n):this.spliceSimple(e,t,i,n)}spliceSmart(e,t,i,n=ct.empty(),o,s=o.diffDepth??0){let{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,i,n,o);let l=[...n],d=t[t.length-1],c=new pI({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,d),...l,...a.children.slice(d+i)].map(g=>e.getId(g.element).toString())}).ComputeDiff(!1);if(c.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,i,l,o);let u=t.slice(0,-1),p=(g,b,v)=>{if(s>0)for(let I=0;I<v;I++)g--,b--,this.spliceSmart(e,[...u,g,0],Number.MAX_SAFE_INTEGER,l[b].children,o,s-1)},m=Math.min(a.children.length,d+i),f=l.length;for(let g of c.changes.sort((b,v)=>v.originalStart-b.originalStart))p(m,f,m-(g.originalStart+g.originalLength)),m=g.originalStart,f=g.modifiedStart-d,this.spliceSimple([...u,m],g.originalLength,ct.slice(l,f,f+g.modifiedLength),o);p(m,f,m)}spliceSimple(e,t,i=ct.empty(),{onDidCreateNode:n,onDidDeleteNode:o,diffIdentityProvider:s}){let{parentNode:a,listIndex:l,revealed:d,visible:c}=this.getParentNodeWithListIndex(e),u=[],p=ct.map(i,S=>this.createTreeNode(S,a,a.visible?1:0,d,u,n)),m=e[e.length-1],f=0;for(let S=m;S>=0&&S<a.children.length;S--){let T=a.children[S];if(T.visible){f=T.visibleChildIndex;break}}let g=[],b=0,v=0;for(let S of p)g.push(S),v+=S.renderNodeCount,S.visible&&(S.visibleChildIndex=f+b++);let I=GR(a.children,m,t,g);s?a.lastDiffIds?GR(a.lastDiffIds,m,t,g.map(S=>s.getId(S.element).toString())):a.lastDiffIds=a.children.map(S=>s.getId(S.element).toString()):a.lastDiffIds=void 0;let w=0;for(let S of I)S.visible&&w++;if(w!==0)for(let S=m+g.length;S<a.children.length;S++){let T=a.children[S];T.visible&&(T.visibleChildIndex-=w)}if(a.visibleChildrenCount+=b-w,d&&c){let S=I.reduce((T,D)=>T+(D.visible?D.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,v-S),this._onDidSpliceRenderedNodes.fire({start:l,deleteCount:S,elements:u})}if(I.length>0&&o){let S=T=>{o(T),T.children.forEach(S)};I.forEach(S)}this._onDidSpliceModel.fire({insertedNodes:g,deletedNodes:I});let E=a;for(;E;){if(E.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}E=E.parent}}rerender(e){if(e.length===0)throw new Ai(this.user,"Invalid tree location");let{node:t,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(e);t.visible&&n&&this._onDidSpliceRenderedNodes.fire({start:i,deleteCount:1,elements:[t]})}has(e){return this.hasTreeNode(e)}getListIndex(e){let{listIndex:t,visible:i,revealed:n}=this.getTreeNodeWithListIndex(e);return i&&n?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){let i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);let n={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,n))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){let n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsed);let o={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,o))}_setCollapseState(e,t){let{node:i,listIndex:n,revealed:o}=this.getTreeNodeWithListIndex(e),s=this._setListNodeCollapseState(i,n,o,t);if(i!==this.root&&this.autoExpandSingleChildren&&s&&!MP(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return s}_setListNodeCollapseState(e,t,i,n){let o=this._setNodeCollapseState(e,n,!1);if(!i||!e.visible||!o)return o;let s=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=s-(t===-1?0:1);return this._onDidSpliceRenderedNodes.fire({start:t+1,deleteCount:l,elements:a.slice(1)}),o}_setNodeCollapseState(e,t,i){let n;if(e===this.root?n=!1:(MP(t)?(n=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(n=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!MP(t)&&t.recursive)for(let o of e.children)n=this._setNodeCollapseState(o,t,!0)||n;return n}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){let e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this._onDidSpliceRenderedNodes.fire({start:0,deleteCount:e,elements:t}),this.refilterDelayer.cancel()}createTreeNode(e,t,i,n,o,s){let a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&o.push(a);let d=e.children||ct.empty(),c=n&&l!==0&&!a.collapsed,u=0,p=1;for(let m of d){let f=this.createTreeNode(m,a,l,c,o,s);a.children.push(f),p+=f.renderNodeCount,f.visible&&(f.visibleChildIndex=u++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=u,a.visible=l===2?u>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=p):(a.renderNodeCount=0,n&&o.pop()),s?.(a),a}updateNodeAfterCollapseChange(e){let t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(let i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){let t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,n=!0){let o;if(e!==this.root){if(o=this._filterNode(e,t),o===0)return e.visible=!1,e.renderNodeCount=0,!1;n&&i.push(e)}let s=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||o!==0){let l=0;for(let d of e.children)a=this._updateNodeAfterFilterChange(d,o,i,n&&!e.collapsed)||a,d.visible&&(d.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=o===2?a:o===1,e.visibility=o),e.visible?e.collapsed||(e.renderNodeCount+=i.length-s):(e.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){let i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):vI(i)?(e.filterData=i.data,gh(i.visibility)):(e.filterData=void 0,gh(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;let[i,...n]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(n,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;let[i,...n]=e;if(i<0||i>t.children.length)throw new Ai(this.user,"Invalid tree location");return this.getTreeNode(n,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};let{parentNode:t,listIndex:i,revealed:n,visible:o}=this.getParentNodeWithListIndex(e),s=e[e.length-1];if(s<0||s>t.children.length)throw new Ai(this.user,"Invalid tree location");let a=t.children[s];return{node:a,listIndex:i,revealed:n,visible:o&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,n=!0,o=!0){let[s,...a]=e;if(s<0||s>t.children.length)throw new Ai(this.user,"Invalid tree location");for(let l=0;l<s;l++)i+=t.children[l].renderNodeCount;return n=n&&!t.collapsed,o=o&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:n,visible:o}:this.getParentNodeWithListIndex(a,t.children[s],i+1,n,o)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){let t=[],i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:dS(e)[0]}getFirstElementChild(e){let t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}getLastElementAncestor(e=[]){let t=this.getTreeNode(e);if(t.children.length!==0)return this._getLastElementAncestor(t)}_getLastElementAncestor(e){return e.children.length===0?e.element:this._getLastElementAncestor(e.children[e.children.length-1])}};var PP=class extends Zs{constructor(t){super(t.elements.map(i=>i.element));this.data=t}set context(t){this.data.context=t}get context(){return this.data.context}};function OP(r){return r instanceof Zs?new PP(r):r}var NP=class{constructor(e,t){this.modelProvider=e;this.dnd=t}autoExpandNode;autoExpandDisposable=P.None;disposables=new Y;getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(OP(e),t)}onDragOver(e,t,i,n,o,s=!0){let a=this.dnd.onDragOver(OP(e),t&&t.element,i,n,o),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=Av(()=>{let m=this.modelProvider(),f=m.getNodeLocation(t);m.isCollapsed(f)&&m.setCollapsed(f,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!s){let m=typeof a=="boolean"?a:a.accept,f=typeof a=="boolean"?void 0:a.effect;return{accept:m,effect:f,feedback:[i]}}return a}if(a.bubble===1){let m=this.modelProvider(),f=m.getNodeLocation(t),g=m.getParentNodeLocation(f),b=m.getNode(g),v=g&&m.getListIndex(g);return this.onDragOver(e,b,v,n,o,!1)}let d=this.modelProvider(),c=d.getNodeLocation(t),u=d.getListIndex(c),p=d.getListRenderCount(c);return{...a,feedback:_n(u,u+p)}}drop(e,t,i,n,o){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(OP(e),t&&t.element,i,n,o)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}};function kZ(r,e){return e&&{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new NP(r,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element})},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})}},accessibilityProvider:e.accessibilityProvider&&{...e.accessibilityProvider,getSetSize(t){let i=r(),n=i.getNodeLocation(t),o=i.getParentNodeLocation(n);return i.getNode(o).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}}}}var df=class{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){this.delegate.setDynamicHeight?.(e.element,t)}},FP=class r{focus;selection;expanded;scrollTop;static lift(e){return e instanceof r?e:new r(e)}static empty(e=0){return new r({focus:[],selection:[],expanded:Object.create(null),scrollTop:e})}constructor(e){if(this.focus=new Set(e.focus),this.selection=new Set(e.selection),e.expanded instanceof Array){this.expanded=Object.create(null);for(let t of e.expanded)this.expanded[t]=1}else this.expanded=e.expanded;this.expanded=e.expanded,this.scrollTop=e.scrollTop}toJSON(){return{focus:Array.from(this.focus),selection:Array.from(this.selection),expanded:this.expanded,scrollTop:this.scrollTop}}};var BP=class{constructor(e,t=[]){this._elements=t;this.onDidChange=z.forEach(e,i=>this._elements=i,this.disposables)}disposables=new Y;onDidChange;get elements(){return this._elements}dispose(){this.disposables.dispose()}},VP=class r{constructor(e,t,i,n,o,s={}){this.renderer=e;this.model=t;this.activeNodes=n;this.renderedIndentGuides=o;this.templateId=e.templateId,this.updateOptions(s),z.map(i,a=>a.node)(this.onDidChangeNodeTwistieState,this,this.disposables),e.onDidChangeTwistieState?.(this.onDidChangeTwistieState,this,this.disposables)}static DefaultIndent=8;templateId;renderedElements=new Map;renderedNodes=new Map;indent=r.DefaultIndent;hideTwistiesOfChildlessElements=!1;shouldRenderIndentGuides=!1;activeIndentNodes=new Set;indentGuidesDisposable=P.None;disposables=new Y;updateOptions(e={}){if(typeof e.indent<"u"){let t=uo(e.indent,0,40);if(t!==this.indent){this.indent=t;for(let[i,n]of this.renderedNodes)this.renderTreeElement(i,n)}}if(typeof e.renderIndentGuides<"u"){let t=e.renderIndentGuides!=="none";if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(let[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),t){let i=new Y;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){let t=ye(e,he(".monaco-tl-row")),i=ye(t,he(".monaco-tl-indent")),n=ye(t,he(".monaco-tl-twistie")),o=ye(t,he(".monaco-tl-contents")),s=this.renderer.renderTemplate(o);return{container:e,indent:i,twistie:n,indentGuidesDisposable:P.None,templateData:s}}renderElement(e,t,i,n){this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,n)}disposeElement(e,t,i,n){i.indentGuidesDisposable.dispose(),this.renderer.disposeElement?.(e,t,i.templateData,n),typeof n=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){let t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){let t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){let i=r.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${i}px`,t.indent.style.width=`${i+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...Ae.asClassNameArray(ie.treeItemExpanded));let n=!1;this.renderer.renderTwistie&&(n=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(n||t.twistie.classList.add(...Ae.asClassNameArray(ie.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(Xt(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;let i=new Y;for(;;){let n=this.model.getNodeLocation(e),o=this.model.getParentNodeLocation(n);if(!o)break;let s=this.model.getNode(o),a=he(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(s)&&a.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(a):t.indent.insertBefore(a,t.indent.firstElementChild),this.renderedIndentGuides.add(s,a),i.add(te(()=>this.renderedIndentGuides.delete(s,a))),e=s}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;let t=new Set;e.forEach(i=>{let n=this.model.getNodeLocation(i);try{let o=this.model.getParentNodeLocation(n);i.collapsible&&i.children.length>0&&!i.collapsed?t.add(i):o&&t.add(this.model.getNode(o))}catch{}}),this.activeIndentNodes.forEach(i=>{t.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.remove("active"))}),t.forEach(i=>{this.activeIndentNodes.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.add("active"))}),this.activeIndentNodes=t}setModel(e){this.model=e}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),ht(this.disposables)}},WP=class{constructor(e,t,i){this.tree=e;this.keyboardNavigationLabelProvider=t;this._filter=i;e.onWillRefilter(this.reset,this,this.disposables)}_totalCount=0;get totalCount(){return this._totalCount}_matchCount=0;get matchCount(){return this._matchCount}_pattern="";_lowercasePattern="";disposables=new Y;set pattern(e){this._pattern=e,this._lowercasePattern=e.toLowerCase()}filter(e,t){let i=1;if(this._filter){let s=this._filter.filter(e,t);if(typeof s=="boolean"?i=s?1:0:vI(s)?i=gh(s.visibility):i=s,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:Mp.Default,visibility:i};let n=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),o=Array.isArray(n)?n:[n];for(let s of o){let a=s&&s.toString();if(typeof a>"u")return{data:Mp.Default,visibility:i};let l;if(this.tree.findMatchType===1){let d=a.toLowerCase().indexOf(this._lowercasePattern);if(d>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let c=this._lowercasePattern.length;c>0;c--)l.push(d+c-1)}}else l=LE(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,o.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this.tree.findMode===1?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:Mp.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){ht(this.disposables)}},HP=class extends Da{constructor(e){super({icon:ie.listFilter,title:h("filter","Filter"),isChecked:e.isChecked??!1,hoverDelegate:e.hoverDelegate??Dt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},UP=class extends Da{constructor(e){super({icon:ie.searchFuzzy,title:h("fuzzySearch","Fuzzy Match"),isChecked:e.isChecked??!1,hoverDelegate:e.hoverDelegate??Dt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},RZ={inputBoxStyles:e7,toggleStyles:eU,listFilterWidgetBackground:void 0,listFilterWidgetNoMatchesOutline:void 0,listFilterWidgetOutline:void 0,listFilterWidgetShadow:void 0};var zP=class extends P{constructor(t,i,n,o,s,a){super();this.tree=i;t.appendChild(this.elements.root),this._register(te(()=>this.elements.root.remove()));let l=a?.styles??RZ;l.listFilterWidgetBackground&&(this.elements.root.style.backgroundColor=l.listFilterWidgetBackground),l.listFilterWidgetShadow&&(this.elements.root.style.boxShadow=`0 0 8px 2px ${l.listFilterWidgetShadow}`);let d=this._register(Vd());this.modeToggle=this._register(new HP({...l.toggleStyles,isChecked:o===1,hoverDelegate:d})),this.matchTypeToggle=this._register(new UP({...l.toggleStyles,isChecked:s===0,hoverDelegate:d})),this.onDidChangeMode=z.map(this.modeToggle.onChange,()=>this.modeToggle.checked?1:0,this._store),this.onDidChangeMatchType=z.map(this.matchTypeToggle.onChange,()=>this.matchTypeToggle.checked?0:1,this._store),this.findInput=this._register(new af(this.elements.findInput,n,{label:h("type to search","Type to search"),additionalToggles:[this.modeToggle,this.matchTypeToggle],showCommonFindToggles:!1,inputBoxStyles:l.inputBoxStyles,toggleStyles:l.toggleStyles,history:a?.history})),this.actionbar=this._register(new Pn(this.elements.actionbar)),this.mode=o;let c=this._register(new Me(this.findInput.inputBox.inputElement,"keydown")),u=z.chain(c.event,g=>g.map(b=>new bt(b)));this._register(u(g=>{if(g.equals(3)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.addToHistory(),this.tree.domFocus();return}if(g.equals(18)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.isAtLastInHistory()||this.findInput.inputBox.isNowhereInHistory()?(this.findInput.inputBox.addToHistory(),this.tree.domFocus()):this.findInput.inputBox.showNextValue();return}if(g.equals(16)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.showPreviousValue();return}}));let p=this._register(new Si("close",h("close","Close"),"codicon codicon-close",!0,()=>this.dispose()));this.actionbar.push(p,{icon:!0,label:!1});let m=this._register(new Me(this.elements.grab,"mousedown"));this._register(m.event(g=>{let b=new Y,v=b.add(new Me(pe(g),"mousemove")),I=b.add(new Me(pe(g),"mouseup")),w=this.right,E=g.pageX,S=this.top,T=g.pageY;this.elements.grab.classList.add("grabbing");let D=this.elements.root.style.transition;this.elements.root.style.transition="unset";let L=A=>{let W=A.pageX-E;this.right=w-W;let j=A.pageY-T;this.top=S+j,this.layout()};b.add(v.event(L)),b.add(I.event(A=>{L(A),this.elements.grab.classList.remove("grabbing"),this.elements.root.style.transition=D,b.dispose()}))}));let f=z.chain(this._register(new Me(this.elements.grab,"keydown")).event,g=>g.map(b=>new bt(b)));this._register(f(g=>{let b,v;if(g.keyCode===15?b=Number.POSITIVE_INFINITY:g.keyCode===17?b=0:g.keyCode===10&&(b=this.right===0?Number.POSITIVE_INFINITY:0),g.keyCode===16?v=0:g.keyCode===18&&(v=Number.POSITIVE_INFINITY),b!==void 0&&(g.preventDefault(),g.stopPropagation(),this.right=b,this.layout()),v!==void 0){g.preventDefault(),g.stopPropagation(),this.top=v;let I=this.elements.root.style.transition;this.elements.root.style.transition="unset",this.layout(),setTimeout(()=>{this.elements.root.style.transition=I},0)}})),this.onDidChangeValue=this.findInput.onDidChange}elements=Tt(".monaco-tree-type-filter",[Tt(".monaco-tree-type-filter-grab.codicon.codicon-debug-gripper@grab",{tabIndex:0}),Tt(".monaco-tree-type-filter-input@findInput"),Tt(".monaco-tree-type-filter-actionbar@actionbar")]);set mode(t){this.modeToggle.checked=t===1,this.findInput.inputBox.setPlaceHolder(t===1?h("type to filter","Type to filter"):h("type to search","Type to search"))}set matchType(t){this.matchTypeToggle.checked=t===0}get value(){return this.findInput.inputBox.value}set value(t){this.findInput.inputBox.value=t}modeToggle;matchTypeToggle;findInput;actionbar;width=0;right=0;top=0;_onDidDisable=new _;onDidDisable=this._onDidDisable.event;onDidChangeValue;onDidChangeMode;onDidChangeMatchType;getHistory(){return this.findInput.inputBox.getHistory()}focus(){this.findInput.focus()}select(){this.findInput.select(),this.findInput.inputBox.addToHistory(!0)}layout(t=this.width){this.width=t,this.right=uo(this.right,0,Math.max(0,t-212)),this.elements.root.style.right=`${this.right}px`,this.top=uo(this.top,0,24),this.elements.root.style.top=`${this.top}px`}showMessage(t){this.findInput.showMessage(t)}clearMessage(){this.findInput.clearMessage()}async dispose(){this._onDidDisable.fire(),this.elements.root.classList.add("disabled"),await hn(300),super.dispose()}},KP=class{constructor(e,t,i,n,o={}){this.tree=e;this.view=t;this.filter=i;this.contextViewProvider=n;this.options=o;this._mode=e.options.defaultFindMode??0,this._matchType=e.options.defaultFindMatchType??0}_history;_pattern="";get pattern(){return this._pattern}previousPattern="";_mode;get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}_matchType;get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}widget;width=0;_onDidChangeMode=new _;onDidChangeMode=this._onDidChangeMode.event;_onDidChangeMatchType=new _;onDidChangeMatchType=this._onDidChangeMatchType.event;_onDidChangePattern=new _;onDidChangePattern=this._onDidChangePattern.event;_onDidChangeOpenState=new _;onDidChangeOpenState=this._onDidChangeOpenState.event;enabledDisposables=new Y;disposables=new Y;updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}isOpened(){return!!this.widget}open(){if(this.widget){this.widget.focus(),this.widget.select();return}this.widget=new zP(this.view.getHTMLElement(),this.tree,this.contextViewProvider,this.mode,this.matchType,{...this.options,history:this._history}),this.enabledDisposables.add(this.widget),this.widget.onDidChangeValue(this.onDidChangeValue,this,this.enabledDisposables),this.widget.onDidChangeMode(e=>this.mode=e,void 0,this.enabledDisposables),this.widget.onDidChangeMatchType(e=>this.matchType=e,void 0,this.enabledDisposables),this.widget.onDidDisable(this.close,this,this.enabledDisposables),this.widget.layout(this.width),this.widget.focus(),this.widget.value=this.previousPattern,this.widget.select(),this._onDidChangeOpenState.fire(!0)}close(){this.widget&&(this._history=this.widget.getHistory(),this.widget=void 0,this.enabledDisposables.clear(),this.previousPattern=this.pattern,this.onDidChangeValue(""),this.tree.domFocus(),this._onDidChangeOpenState.fire(!1))}onDidChangeValue(e){this._pattern=e,this._onDidChangePattern.fire(e),this.filter.pattern=e,this.tree.refilter(),e&&this.tree.focusNext(0,!0,void 0,i=>!Mp.isDefault(i.filterData));let t=this.tree.getFocus();if(t.length>0){let i=t[0];this.tree.getRelativeTop(i)===null&&this.tree.reveal(i,.5)}this.render()}render(){let e=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&e?(Yc(h("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?this.widget?.showMessage({type:2,content:h("not found","No elements found.")}):this.widget?.showMessage({type:2})):(this.widget?.clearMessage(),this.pattern&&Yc(h("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(e){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!Mp.isDefault(e.filterData)}layout(e){this.width=e,this.widget?.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function AZ(r,e){return r.position===e.position&&i7(r,e)}function i7(r,e){return r.node.element===e.node.element&&r.startIndex===e.startIndex&&r.height===e.height&&r.endIndex===e.endIndex}var GP=class{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return li(this.stickyNodes,e.stickyNodes,AZ)}lastNodePartiallyVisible(){if(this.count===0)return!1;let e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;let t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!li(this.stickyNodes,e.stickyNodes,i7)||this.count===0)return!1;let t=this.stickyNodes[this.count-1],i=e.stickyNodes[e.count-1];return t.position!==i.position}},jP=class{constrainStickyScrollNodes(e,t,i){for(let n=0;n<e.length;n++){let o=e[n];if(o.position+o.height>i||n>=t)return e.slice(0,n)}return e}},e_=class extends P{constructor(t,i,n,o,s,a={}){super();this.tree=t;this.model=i;this.view=n;this.treeDelegate=s;let l=this.validateStickySettings(a);this.stickyScrollMaxItemCount=l.stickyScrollMaxItemCount,this.stickyScrollDelegate=a.stickyScrollDelegate??new jP,this._widget=this._register(new qP(n.getScrollableElement(),n,t,o,s,a.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(n.onDidScroll(()=>this.update())),this._register(n.onDidChangeContentHeight(()=>this.update())),this._register(t.onDidChangeCollapseState(()=>this.update())),this.update()}onDidChangeHasFocus;onContextMenu;stickyScrollDelegate;stickyScrollMaxItemCount;maxWidgetViewRatio=.4;_widget;get height(){return this._widget.height}get count(){return this._widget.count}getNode(t){return this._widget.getNode(t)}getNodeAtHeight(t){let i;if(t===0?i=this.view.firstVisibleIndex:i=this.view.indexAt(t+this.view.scrollTop),!(i<0||i>=this.view.length))return this.view.element(i)}update(){let t=this.getNodeAtHeight(0);if(!t||this.tree.scrollTop===0){this._widget.setState(void 0);return}let i=this.findStickyState(t);this._widget.setState(i)}findStickyState(t){let i=[],n=t,o=0,s=this.getNextStickyNode(n,void 0,o);for(;s&&(i.push(s),o+=s.height,!(i.length<=this.stickyScrollMaxItemCount&&(n=this.getNextVisibleNode(s),!n)));)s=this.getNextStickyNode(n,s.node,o);let a=this.constrainStickyNodes(i);return a.length?new GP(a):void 0}getNextVisibleNode(t){return this.getNodeAtHeight(t.position+t.height)}getNextStickyNode(t,i,n){let o=this.getAncestorUnderPrevious(t,i);if(o&&!(o===t&&(!this.nodeIsUncollapsedParent(t)||this.nodeTopAlignsWithStickyNodesBottom(t,n))))return this.createStickyScrollNode(o,n)}nodeTopAlignsWithStickyNodesBottom(t,i){let n=this.getNodeIndex(t),o=this.view.getElementTop(n),s=i;return this.view.scrollTop===o-s}createStickyScrollNode(t,i){let n=this.treeDelegate.getHeight(t),{startIndex:o,endIndex:s}=this.getNodeRange(t),a=this.calculateStickyNodePosition(s,i,n);return{node:t,position:a,height:n,startIndex:o,endIndex:s}}getAncestorUnderPrevious(t,i=void 0){let n=t,o=this.getParentNode(n);for(;o;){if(o===i)return n;n=o,o=this.getParentNode(n)}if(i===void 0)return n}calculateStickyNodePosition(t,i,n){let o=this.view.getRelativeTop(t);if(o===null&&this.view.firstVisibleIndex===t&&t+1<this.view.length){let c=this.treeDelegate.getHeight(this.view.element(t)),u=this.view.getRelativeTop(t+1);o=u?u-c/this.view.renderHeight:null}if(o===null)return i;let s=this.view.element(t),a=this.treeDelegate.getHeight(s),d=o*this.view.renderHeight+a;return i+n>d&&i<=d?d-n:i}constrainStickyNodes(t){if(t.length===0)return[];let i=this.view.renderHeight*this.maxWidgetViewRatio,n=t[t.length-1];if(t.length<=this.stickyScrollMaxItemCount&&n.position+n.height<=i)return t;let o=this.stickyScrollDelegate.constrainStickyScrollNodes(t,this.stickyScrollMaxItemCount,i);if(!o.length)return[];let s=o[o.length-1];if(o.length>this.stickyScrollMaxItemCount||s.position+s.height>i)throw new Error("stickyScrollDelegate violates constraints");return o}getParentNode(t){let i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return n?this.model.getNode(n):void 0}nodeIsUncollapsedParent(t){let i=this.model.getNodeLocation(t);return this.model.getListRenderCount(i)>1}getNodeIndex(t){let i=this.model.getNodeLocation(t);return this.model.getListIndex(i)}getNodeRange(t){let i=this.model.getNodeLocation(t),n=this.model.getListIndex(i);if(n<0)throw new Error("Node not found in tree");let o=this.model.getListRenderCount(i),s=n+o-1;return{startIndex:n,endIndex:s}}nodePositionTopBelowWidget(t){let i=[],n=this.getParentNode(t);for(;n;)i.push(n),n=this.getParentNode(n);let o=0;for(let s=0;s<i.length&&s<this.stickyScrollMaxItemCount;s++)o+=this.treeDelegate.getHeight(i[s]);return o}getFocus(){return this._widget.getFocus()}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(t={}){if(!t.stickyScrollMaxItemCount)return;let i=this.validateStickySettings(t);this.stickyScrollMaxItemCount!==i.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=i.stickyScrollMaxItemCount,this.update())}validateStickySettings(t){let i=7;return typeof t.stickyScrollMaxItemCount=="number"&&(i=Math.max(t.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:i}}setModel(t){this.model=t}},qP=class{constructor(e,t,i,n,o,s){this.view=t;this.tree=i;this.treeRenderers=n;this.treeDelegate=o;this.accessibilityProvider=s;this._rootDomNode=he(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);let a=he(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new $P(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}_rootDomNode;_previousState;_previousElements=[];_previousStateDisposables=new Y;stickyScrollFocus;onDidChangeHasFocus;onContextMenu;get height(){if(!this._previousState)return 0;let e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}get count(){return this._previousState?.count??0}getNode(e){return this._previousState?.stickyNodes.find(t=>t.node===e)}setState(e){let t=!!this._previousState&&this._previousState.count>0,i=!!e&&e.count>0;if(!t&&!i||t&&i&&this._previousState.equal(e))return;if(t!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}let n=e.stickyNodes[e.count-1];if(this._previousState&&e.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${n.position}px`;else{this._previousStateDisposables.clear();let o=Array(e.count);for(let s=e.count-1;s>=0;s--){let a=e.stickyNodes[s],{element:l,disposable:d}=this.createElement(a,s,e.count);o[s]=l,this._rootDomNode.appendChild(l),this._previousStateDisposables.add(d)}this.stickyScrollFocus.updateElements(o,e),this._previousElements=o}this._previousState=e,this._rootDomNode.style.height=`${n.position+n.height}px`}createElement(e,t,i){let n=e.startIndex,o=document.createElement("div");o.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(o.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(o.style.lineHeight=`${e.height}px`),o.classList.add("monaco-tree-sticky-row"),o.classList.add("monaco-list-row"),o.setAttribute("data-index",`${n}`),o.setAttribute("data-parity",n%2===0?"even":"odd"),o.setAttribute("id",this.view.getElementID(n));let s=this.setAccessibilityAttributes(o,e.node.element,t,i),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(p=>p.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let d=e.node;d===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(d=new Proxy(e.node,{}));let c=l.renderTemplate(o);l.renderElement(d,e.startIndex,c,e.height);let u=te(()=>{s.dispose(),l.disposeElement(d,e.startIndex,c,e.height),l.disposeTemplate(c),o.remove()});return{element:o,disposable:u}}setAccessibilityAttributes(e,t,i,n){if(!this.accessibilityProvider)return P.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,i,n))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,i))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");let o=this.accessibilityProvider.getAriaLabel(t),s=o&&typeof o!="string"?o:Rc(o),a=yt(d=>{let c=d.readObservable(s);c?e.setAttribute("aria-label",c):e.removeAttribute("aria-label")});typeof o=="string"||o&&e.setAttribute("aria-label",o.get());let l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}getFocus(){return this.stickyScrollFocus.getFocus()}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}},$P=class extends P{constructor(t,i){super();this.container=t;this.view=i;this._register(B(this.container,"focus",()=>this.onFocus())),this._register(B(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(n=>this.onKeyDown(n))),this._register(this.view.onMouseDown(n=>this.onMouseDown(n))),this._register(this.view.onContextMenu(n=>this.handleContextMenu(n)))}focusedIndex=-1;elements=[];state;_onDidChangeHasFocus=new _;onDidChangeHasFocus=this._onDidChangeHasFocus.event;_onContextMenu=new _;onContextMenu=this._onContextMenu.event;_domHasFocus=!1;get domHasFocus(){return this._domHasFocus}set domHasFocus(t){t!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(t),this._domHasFocus=t)}handleContextMenu(t){let i=t.browserEvent.target;if(!zm(i)&&!Um(i)){this.focusedLast()&&this.view.domFocus();return}if(!$s(t.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");let a=this.state.stickyNodes.findIndex(l=>l.node.element===t.element?.element);if(a===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(a);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");let o=this.state.stickyNodes[this.focusedIndex].node.element,s=this.elements[this.focusedIndex];this._onContextMenu.fire({element:o,anchor:s,browserEvent:t.browserEvent,isStickyScroll:!0})}onKeyDown(t){if(this.domHasFocus&&this.state){if(t.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),t.preventDefault(),t.stopPropagation();else if(t.key==="ArrowDown"||t.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){let i=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([i]),this.scrollNodeUnderWidget(i,this.state)}else this.setFocusedElement(this.focusedIndex+1);t.preventDefault(),t.stopPropagation()}}}onMouseDown(t){let i=t.browserEvent.target;!zm(i)&&!Um(i)||(t.browserEvent.preventDefault(),t.browserEvent.stopPropagation())}updateElements(t,i){if(i&&i.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(i&&i.count!==t.length)throw new Error("Sticky scroll focus received illigel state");let n=this.focusedIndex;if(this.removeFocus(),this.elements=t,this.state=i,i){let o=uo(n,0,i.count-1);this.setFocus(o)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=i?0:-1}setFocusedElement(t){let i=this.state;if(!i)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(t),!(t<i.count-1)&&i.lastNodePartiallyVisible()){let n=i.stickyNodes[t];this.scrollNodeUnderWidget(n.endIndex+1,i)}}scrollNodeUnderWidget(t,i){let n=i.stickyNodes[i.count-1],o=i.count>1?i.stickyNodes[i.count-2]:void 0,s=this.view.getElementTop(t),a=o?o.position+o.height+n.height:n.height;this.view.scrollTop=s-a}getFocus(){if(!(!this.state||this.focusedIndex===-1))return this.state.stickyNodes[this.focusedIndex].node.element}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(t){if(0>t)throw new Error("addFocus() can not remove focus");if(!this.state&&t>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&t>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");let i=this.focusedIndex;i>=0&&this.toggleElementFocus(this.elements[i],!1),t>=0&&this.toggleElementFocus(this.elements[t],!0),this.focusedIndex=t}toggleElementFocus(t,i){this.toggleElementActiveFocus(t,i&&this.domHasFocus),this.toggleElementPassiveFocus(t,i)}toggleCurrentElementActiveFocus(t){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],t)}toggleElementActiveFocus(t,i){t.classList.toggle("focused",i)}toggleElementPassiveFocus(t,i){t.classList.toggle("passive-focused",i)}toggleStickyScrollFocused(t){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",t)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}};function lf(r){let e=0;return pE(r.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=1:pE(r.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=2:pE(r.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=3),{browserEvent:r.browserEvent,element:r.element?r.element.element:null,target:e}}function MZ(r){let e=zm(r.browserEvent.target);return{element:r.element?r.element.element:null,browserEvent:r.browserEvent,anchor:r.anchor,isStickyScroll:e}}function JT(r,e){e(r),r.children.forEach(t=>JT(t,e))}var yI=class{constructor(e,t){this.getFirstViewElementWithTrait=e;this.identityProvider=t}nodes=[];elements;_onDidChange=new _;onDidChange=this._onDidChange.event;_nodeSet;get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(e,t){!t?.__forceEvent&&li(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){let n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){let l=this.createNodeSet(),d=c=>l.delete(c);t.forEach(c=>JT(c,d)),this.set([...l.values()]);return}let i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>JT(l,n));let o=new Map,s=l=>o.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>JT(l,s));let a=[];for(let l of this.nodes){let d=this.identityProvider.getId(l.element).toString();if(!i.has(d))a.push(l);else{let u=o.get(d);u&&u.visible&&a.push(u)}}if(this.nodes.length>0&&a.length===0){let l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){let e=new Set;for(let t of this.nodes)e.add(t);return e}},YP=class extends Xv{constructor(t,i,n){super(t);this.tree=i;this.stickyScrollProvider=n}onViewPointer(t){if(B1(t.browserEvent.target)||Gr(t.browserEvent.target)||Wm(t.browserEvent.target)||t.browserEvent.isHandledByList)return;let i=t.element;if(!i)return super.onViewPointer(t);if(this.isSelectionRangeChangeEvent(t)||this.isSelectionSingleChangeEvent(t))return super.onViewPointer(t);let n=t.browserEvent.target,o=n.classList.contains("monaco-tl-twistie")||n.classList.contains("monaco-icon-label")&&n.classList.contains("folder-icon")&&t.browserEvent.offsetX<16,s=Um(t.browserEvent.target),a=!1;if(s?a=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?a=this.tree.expandOnlyOnTwistieClick(i.element):a=!!this.tree.expandOnlyOnTwistieClick,s)this.handleStickyScrollMouseEvent(t,i);else{if(a&&!o&&t.browserEvent.detail!==2)return super.onViewPointer(t);if(!this.tree.expandOnDoubleClick&&t.browserEvent.detail===2)return super.onViewPointer(t)}if(i.collapsible&&(!s||o)){let l=this.tree.getNodeLocation(i),d=t.browserEvent.altKey;if(this.tree.setFocus([l]),this.tree.toggleCollapsed(l,d),o){t.browserEvent.isHandledByList=!0;return}}s||super.onViewPointer(t)}handleStickyScrollMouseEvent(t,i){if(NH(t.browserEvent.target)||FH(t.browserEvent.target))return;let n=this.stickyScrollProvider();if(!n)throw new Error("Sticky scroll controller not found");let o=this.list.indexOf(i),s=this.list.getElementTop(o),a=n.nodePositionTopBelowWidget(i);this.tree.scrollTop=s-a,this.list.domFocus(),this.list.setFocus([o]),this.list.setSelection([o])}onDoubleClick(t){t.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||t.browserEvent.isHandledByList||super.onDoubleClick(t)}onMouseDown(t){let i=t.browserEvent.target;if(!zm(i)&&!Um(i)){super.onMouseDown(t);return}}onContextMenu(t){let i=t.browserEvent.target;if(!zm(i)&&!Um(i)){super.onContextMenu(t);return}}},ZP=class extends Sn{constructor(t,i,n,o,s,a,l,d){super(t,i,n,o,d);this.focusTrait=s;this.selectionTrait=a;this.anchorTrait=l}createMouseController(t){return new YP(this,t.tree,t.stickyScrollProvider)}splice(t,i,n=[]){if(super.splice(t,i,n),n.length===0)return;let o=[],s=[],a;n.forEach((l,d)=>{this.focusTrait.has(l)&&o.push(t+d),this.selectionTrait.has(l)&&s.push(t+d),this.anchorTrait.has(l)&&(a=t+d)}),o.length>0&&super.setFocus(fa([...super.getFocus(),...o])),s.length>0&&super.setSelection(fa([...super.getSelection(),...s])),typeof a=="number"&&super.setAnchor(a)}setFocus(t,i,n=!1){super.setFocus(t,i),n||this.focusTrait.set(t.map(o=>this.element(o)),i)}setSelection(t,i,n=!1){super.setSelection(t,i),n||this.selectionTrait.set(t.map(o=>this.element(o)),i)}setAnchor(t,i=!1){super.setAnchor(t),i||(typeof t>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(t)]))}};var cf=class{constructor(e,t,i,n,o={}){this._user=e;this._options=o;let s;o.keyboardNavigationLabelProvider&&(s=new WP(this,o.keyboardNavigationLabelProvider,o.filter),o={...o,filter:s},this.disposables.add(s)),this.model=this.createModel(e,o),this.treeDelegate=new df(i);let a=this.disposables.add(new BP(this.onDidChangeActiveNodesRelay.event)),l=new xd;this.renderers=n.map(d=>new VP(d,this.model,this.onDidChangeCollapseStateRelay.event,a,l,o));for(let d of this.renderers)this.disposables.add(d);if(this.focus=new yI(()=>this.view.getFocusedElements()[0],o.identityProvider),this.selection=new yI(()=>this.view.getSelectedElements()[0],o.identityProvider),this.anchor=new yI(()=>this.view.getAnchorElement(),o.identityProvider),this.view=new ZP(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...kZ(()=>this.model,o),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.setupModel(this.model),o.keyboardSupport!==!1){let d=z.chain(this.view.onKeyDown,c=>c.filter(u=>!Gr(u.target)).map(u=>new bt(u)));z.chain(d,c=>c.filter(u=>u.keyCode===15))(this.onLeftArrow,this,this.disposables),z.chain(d,c=>c.filter(u=>u.keyCode===17))(this.onRightArrow,this,this.disposables),z.chain(d,c=>c.filter(u=>u.keyCode===10))(this.onSpace,this,this.disposables)}if((o.findWidgetEnabled??!0)&&o.keyboardNavigationLabelProvider&&o.contextViewProvider){let d=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new KP(this,this.view,s,o.contextViewProvider,d),this.focusNavigationFilter=c=>this.findController.shouldAllowFocus(c),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType,this.disposables.add(this.onDidSpliceModelRelay.event(()=>{!this.findController.isOpened()||this.findController.pattern.length===0||(this.refilter(),this.findController.render())}))}else this.onDidChangeFindMode=z.None,this.onDidChangeFindMatchType=z.None;o.enableStickyScroll&&(this.stickyScrollController=new e_(this,this.model,this.view,this.renderers,this.treeDelegate,o),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=rr(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}view;renderers;model;treeDelegate;focus;selection;anchor;eventBufferer=new Mc;findController;onDidChangeFindOpenState=z.None;onDidChangeStickyScrollFocused=z.None;focusNavigationFilter;stickyScrollController;styleElement;disposables=new Y;get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseClick(){return z.map(this.view.onMouseClick,lf)}get onMouseDblClick(){return z.filter(z.map(this.view.onMouseDblClick,lf),e=>e.target!==3)}get onMouseOver(){return z.map(this.view.onMouseOver,lf)}get onMouseOut(){return z.map(this.view.onMouseOut,lf)}get onContextMenu(){return z.any(z.filter(z.map(this.view.onContextMenu,MZ),e=>!e.isStickyScroll),this.stickyScrollController?.onContextMenu??z.None)}get onTap(){return z.map(this.view.onTap,lf)}get onPointer(){return z.map(this.view.onPointer,lf)}get onKeyDown(){return this.view.onKeyDown}get onKeyUp(){return this.view.onKeyUp}get onKeyPress(){return this.view.onKeyPress}get onDidFocus(){return this.view.onDidFocus}get onDidBlur(){return this.view.onDidBlur}onDidSwapModel=this.disposables.add(new _);onDidChangeModelRelay=this.disposables.add(new Wr);onDidSpliceModelRelay=this.disposables.add(new Wr);onDidChangeCollapseStateRelay=this.disposables.add(new Wr);onDidChangeRenderNodeCountRelay=this.disposables.add(new Wr);onDidChangeActiveNodesRelay=this.disposables.add(new Wr);get onDidChangeModel(){return z.any(this.onDidChangeModelRelay.event,this.onDidSwapModel.event)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}_onWillRefilter=new _;onWillRefilter=this._onWillRefilter.event;get findMode(){return this.findController?.mode??0}set findMode(e){this.findController&&(this.findController.mode=e)}onDidChangeFindMode;get findMatchType(){return this.findController?.matchType??0}set findMatchType(e){this.findController&&(this.findController.matchType=e)}onDidChangeFindMatchType;get onDidChangeFindPattern(){return this.findController?this.findController.onDidChangePattern:z.None}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}_onDidUpdateOptions=new _;onDidUpdateOptions=this._onDidUpdateOptions.event;get onDidDispose(){return this.view.onDidDispose}updateOptions(e={}){this._options={...this._options,...e};for(let t of this.renderers)t.updateOptions(e);this.view.updateOptions(this._options),this.findController?.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}get options(){return this._options}updateStickyScroll(e){!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new e_(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=z.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),this.stickyScrollController?.updateOptions(e)}updateWidth(e){let t=this.model.getListIndex(e);t!==-1&&this.view.updateWidth(t)}getHTMLElement(){return this.view.getHTMLElement()}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollLeft(){return this.view.scrollLeft}set scrollLeft(e){this.view.scrollLeft=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleElement(){let e=this.view.firstVisibleIndex;return this.stickyScrollController&&(e+=this.stickyScrollController.count),e<0||e>=this.view.length?void 0:this.view.element(e).element}get lastVisibleElement(){let e=this.view.lastVisibleIndex;return this.view.element(e).element}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}get selectionSize(){return this.selection.getNodes().length}domFocus(){this.stickyScrollController?.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}isDOMFocused(){return ho(this.getHTMLElement())}layout(e,t){this.view.layout(e,t),so(t)&&this.findController?.layout(t)}style(e){let t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`));let n=e.treeStickyScrollBackground??e.listBackground;n&&(i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),e.treeStickyScrollBorder&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));let o=Ir(e.listFocusAndSelectionOutline,Ir(e.listSelectionOutline,e.listFocusOutline??""));o&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${o}; outline-offset: -1px;}`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){let t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}expandAll(){this.model.setCollapsed(this.model.rootRef,!1,!0)}collapseAll(){this.model.setCollapsed(this.model.rootRef,!0,!0)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}expandTo(e){this.model.expandTo(e)}triggerTypeNavigation(){this.view.triggerTypeNavigation()}openFind(){this.findController?.open()}closeFind(){this.findController?.close()}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setAnchor(e){if(typeof e>"u")return this.view.setAnchor(void 0);this.eventBufferer.bufferEvents(()=>{let t=this.model.getNode(e);this.anchor.set([t]);let i=this.model.getListIndex(e);i>-1&&this.view.setAnchor(i,!0)})}getAnchor(){return this.anchor.get().at(0)}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{let i=e.map(o=>this.model.getNode(o));this.selection.set(i,t);let n=e.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setSelection(n,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{let i=e.map(o=>this.model.getNode(o));this.focus.set(i,t);let n=e.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setFocus(n,t,!0)})}focusNext(e=1,t=!1,i,n=$s(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,i,n)}focusPrevious(e=1,t=!1,i,n=$s(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,i,n)}focusNextPage(e,t=$s(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=$s(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>this.stickyScrollController?.height??0)}focusLast(e,t=$s(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=$s(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}getStickyScrollFocus(){let e=this.stickyScrollController?.getFocus();return e!==void 0?[e]:[]}getFocusedPart(){return this.stickyScrollController?.focusedLast()?1:0}reveal(e,t){this.model.expandTo(e);let i=this.model.getListIndex(e);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,t);else{let n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(i,t,n)}}getRelativeTop(e){let t=this.model.getListIndex(e);if(t===-1)return null;let i=this.stickyScrollController?.getNode(this.getNode(e));return this.view.getRelativeTop(t,i?.position??this.stickyScrollController?.height)}getViewState(e=this.options.identityProvider){if(!e)throw new Ai(this._user,"Can't get tree view state without an identity provider");let t=s=>e.getId(s).toString(),i=FP.empty(this.scrollTop);for(let s of this.getFocus())i.focus.add(t(s));for(let s of this.getSelection())i.selection.add(t(s));let n=this.model.getNode(),o=[n];for(;o.length>0;){let s=o.shift();s!==n&&s.collapsible&&(i.expanded[t(s.element)]=s.collapsed?0:1),o.push(...s.children)}return i}onLeftArrow(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){let s=this.model.getParentNodeLocation(n);if(!s)return;let a=this.model.getListIndex(s);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;let[s]=this.view.getFocus(),a=s+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let i=t[0],n=this.model.getNodeLocation(i),o=e.browserEvent.altKey;this.model.setCollapsed(n,void 0,o)}modelDisposables=new Y;setupModel(e){this.modelDisposables.clear(),this.modelDisposables.add(e.onDidSpliceRenderedNodes(({start:o,deleteCount:s,elements:a})=>this.view.splice(o,s,a)));let t=z.forEach(e.onDidSpliceModel,o=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(o),this.selection.onDidModelSplice(o)})},this.modelDisposables);t(()=>null,null,this.modelDisposables);let i=this.modelDisposables.add(new _),n=this.modelDisposables.add(new vs(0));this.modelDisposables.add(z.any(t,this.focus.onDidChange,this.selection.onDidChange)(()=>{n.trigger(()=>{let o=new Set;for(let s of this.focus.getNodes())o.add(s);for(let s of this.selection.getNodes())o.add(s);i.fire([...o.values()])})})),this.onDidChangeActiveNodesRelay.input=i.event,this.onDidChangeModelRelay.input=z.signal(e.onDidSpliceModel),this.onDidChangeCollapseStateRelay.input=e.onDidChangeCollapseState,this.onDidChangeRenderNodeCountRelay.input=e.onDidChangeRenderNodeCount}setModel(e){let t=this.model;this.model=e,this.setupModel(e),this.renderers.forEach(i=>i.setModel(e)),this.stickyScrollController?.setModel(e),this.focus.set([]),this.selection.set([]),this.anchor.set([]),this.view.splice(0,t.getListRenderCount(t.rootRef)),this.model.refilter(),this.onDidSwapModel.fire()}getModel(){return this.model}navigate(e){return new XP(this.view,this.model,e)}dispose(){ht(this.disposables),this.stickyScrollController?.dispose(),this.view.dispose(),this.modelDisposables.dispose()}},XP=class{constructor(e,t,i){this.view=e;this.model=t;i?this.index=this.model.getListIndex(i):this.index=-1}index;current(){return this.index<0||this.index>=this.view.length?null:this.view.element(this.index).element}previous(){return this.index--,this.current()}next(){return this.index++,this.current()}first(){return this.index=0,this.current()}last(){return this.index=this.view.length-1,this.current()}};var Tu=class{constructor(e,t={}){this.user=e;this.model=new QT(e,null,t),this.onDidSpliceModel=this.model.onDidSpliceModel,this.onDidSpliceRenderedNodes=this.model.onDidSpliceRenderedNodes,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,t.sorter&&(this.sorter={compare(i,n){return t.sorter.compare(i.element,n.element)}}),this.identityProvider=t.identityProvider}rootRef=null;model;nodes=new Map;nodesByIdentity=new Map;identityProvider;sorter;onDidSpliceModel;onDidSpliceRenderedNodes;onDidChangeCollapseState;onDidChangeRenderNodeCount;get size(){return this.nodes.size}setChildren(e,t=ct.empty(),i={}){let n=this.getElementLocation(e);this._setChildren(n,this.preserveCollapseState(t),i)}_setChildren(e,t=ct.empty(),i){let n=new Set,o=new Set,s=l=>{if(l.element===null)return;let d=l;if(n.add(d.element),this.nodes.set(d.element,d),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();o.add(c),this.nodesByIdentity.set(c,d)}i.onDidCreateNode?.(d)},a=l=>{if(l.element===null)return;let d=l;if(n.has(d.element)||this.nodes.delete(d.element),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();o.has(c)||this.nodesByIdentity.delete(c)}i.onDidDeleteNode?.(d)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...i,onDidCreateNode:s,onDidDeleteNode:a})}preserveCollapseState(e=ct.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),ct.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){let s=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(s)}if(!i){let s;return typeof t.collapsed>"u"?s=void 0:t.collapsed===1||t.collapsed===3?s=!0:t.collapsed===0||t.collapsed===2?s=!1:s=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:s}}let n=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible,o;return typeof t.collapsed>"u"||t.collapsed===3||t.collapsed===2?o=i.collapsed:t.collapsed===1?o=!0:t.collapsed===0?o=!1:o=!!t.collapsed,{...t,collapsible:n,collapsed:o,children:this.preserveCollapseState(t.children)}})}rerender(e){let t=this.getElementLocation(e);this.model.rerender(t)}resort(e=null,t=!0){if(!this.sorter)return;let i=this.getElementLocation(e),n=this.model.getNode(i);this._setChildren(i,this.resortChildren(n,t),{})}resortChildren(e,t,i=!0){let n=[...e.children];return(t||i)&&(n=n.sort(this.sorter.compare.bind(this.sorter))),ct.map(n,o=>({element:o.element,collapsible:o.collapsible,collapsed:o.collapsed,children:this.resortChildren(o,t,!1)}))}getFirstElementChild(e=null){let t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}getLastElementAncestor(e=null){let t=this.getElementLocation(e);return this.model.getLastElementAncestor(t)}has(e){return this.nodes.has(e)}getListIndex(e){let t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){let t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){let t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){let i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){let t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){let n=this.getElementLocation(e);return this.model.setCollapsed(n,t,i)}expandTo(e){let t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);let t=this.nodes.get(e);if(!t)throw new Ai(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new Ai(this.user,"Invalid getParentNodeLocation call");let t=this.nodes.get(e);if(!t)throw new Ai(this.user,`Tree element not found: ${e}`);let i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(e){if(e===null)return[];let t=this.nodes.get(e);if(!t)throw new Ai(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}};function t_(r){let e=[r.element],t=r.incompressible||!1;return{element:{elements:e,incompressible:t},children:ct.map(ct.from(r.children),t_),collapsible:r.collapsible,collapsed:r.collapsed}}function i_(r){let e=[r.element],t=r.incompressible||!1,i,n;for(;[n,i]=ct.consume(ct.from(r.children),2),!(n.length!==1||n[0].incompressible);)r=n[0],e.push(r.element);return{element:{elements:e,incompressible:t},children:ct.map(ct.concat(n,i),i_),collapsible:r.collapsible,collapsed:r.collapsed}}function QP(r,e=0){let t;return e<r.element.elements.length-1?t=[QP(r,e+1)]:t=ct.map(ct.from(r.children),i=>QP(i,0)),e===0&&r.element.incompressible?{element:r.element.elements[e],children:t,incompressible:!0,collapsible:r.collapsible,collapsed:r.collapsed}:{element:r.element.elements[e],children:t,collapsible:r.collapsible,collapsed:r.collapsed}}function n7(r){return QP(r,0)}function o7(r,e,t){return r.element===e?{...r,children:t}:{...r,children:ct.map(ct.from(r.children),i=>o7(i,e,t))}}var PZ=r=>({getId(e){return e.elements.map(t=>r.getId(t).toString()).join("\0")}}),JP=class{constructor(e,t={}){this.user=e;this.model=new Tu(e,t),this.enabled=typeof t.compressionEnabled>"u"?!0:t.compressionEnabled,this.identityProvider=t.identityProvider}rootRef=null;get onDidSpliceRenderedNodes(){return this.model.onDidSpliceRenderedNodes}get onDidSpliceModel(){return this.model.onDidSpliceModel}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}model;nodes=new Map;enabled;identityProvider;get size(){return this.nodes.size}setChildren(e,t=ct.empty(),i){let n=i.diffIdentityProvider&&PZ(i.diffIdentityProvider);if(e===null){let f=ct.map(t,this.enabled?i_:t_);this._setChildren(null,f,{diffIdentityProvider:n,diffDepth:1/0});return}let o=this.nodes.get(e);if(!o)throw new Ai(this.user,"Unknown compressed tree node");let s=this.model.getNode(o),a=this.model.getParentNodeLocation(o),l=this.model.getNode(a),d=n7(s),c=o7(d,e,t),u=(this.enabled?i_:t_)(c),p=i.diffIdentityProvider?(f,g)=>i.diffIdentityProvider.getId(f)===i.diffIdentityProvider.getId(g):void 0;if(li(u.element.elements,s.element.elements,p)){this._setChildren(o,u.children||ct.empty(),{diffIdentityProvider:n,diffDepth:1});return}let m=l.children.map(f=>f===s?u:f);this._setChildren(l.element,m,{diffIdentityProvider:n,diffDepth:s.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;let i=this.model.getNode().children,n=ct.map(i,n7),o=ct.map(n,e?i_:t_);this._setChildren(null,o,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){let n=new Set,o=a=>{for(let l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},s=a=>{for(let l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...i,onDidCreateNode:o,onDidDeleteNode:s})}has(e){return this.nodes.has(e)}getListIndex(e){let t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){let t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();let t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){let t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){let t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){let t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}getLastElementAncestor(e){let t=typeof e>"u"?void 0:this.getCompressedNode(e);return this.model.getLastElementAncestor(t)}isCollapsible(e){let t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){let i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){let t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){let n=this.getCompressedNode(e);return this.model.setCollapsed(n,t,i)}expandTo(e){let t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){let t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}resort(e=null,t=!0){let i=this.getCompressedNode(e);this.model.resort(i,t)}getCompressedNode(e){if(e===null)return null;let t=this.nodes.get(e);if(!t)throw new Ai(this.user,`Tree element not found: ${e}`);return t}},NZ=r=>r[r.length-1],eN=class r{constructor(e,t){this.unwrapper=e;this.node=t}get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new r(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}};function FZ(r,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(r(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){return e.filter.filter(r(t),i)}}}}var n_=class{rootRef=null;get onDidSpliceModel(){return z.map(this.model.onDidSpliceModel,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidSpliceRenderedNodes(){return z.map(this.model.onDidSpliceRenderedNodes,({start:e,deleteCount:t,elements:i})=>({start:e,deleteCount:t,elements:i.map(n=>this.nodeMapper.map(n))}))}get onDidChangeCollapseState(){return z.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return z.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}elementMapper;nodeMapper;model;constructor(e,t={}){this.elementMapper=t.elementMapper||NZ;let i=n=>this.elementMapper(n.elements);this.nodeMapper=new mh(n=>new eN(i,n)),this.model=new JP(e,FZ(i,t))}setChildren(e,t=ct.empty(),i={}){this.model.setChildren(e,t,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){let t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}getLastElementAncestor(e){let t=this.model.getLastElementAncestor(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}resort(e=null,t=!0){return this.model.resort(e,t)}getCompressedTreeNode(e=null){return this.model.getNode(e)}};var fh=class extends cf{constructor(t,i,n,o,s={}){super(t,i,n,o,s);this.user=t}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(t,i=ct.empty(),n){this.model.setChildren(t,i,n)}rerender(t){if(t===void 0){this.view.rerender();return}this.model.rerender(t)}updateElementHeight(t,i){let n=this.model.getListIndex(t);if(n===-1)throw new Ai(this.user,"updateElementHeight failed - index not found");this.view.updateElementHeight(n,i)}resort(t,i=!0){this.model.resort(t,i)}hasElement(t){return this.model.has(t)}createModel(t,i){return new Tu(t,i)}},o_=class{constructor(e,t,i){this._compressedTreeNodeProvider=e;this.stickyScrollDelegate=t;this.renderer=i;this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}templateId;onDidChangeTwistieState;get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){let o=this.stickyScrollDelegate.getCompressedNode(e);o||(o=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),o.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,n)):(i.compressedTreeNode=o,this.renderer.renderCompressedElements(o,t,i.data,n))}disposeElement(e,t,i,n){i.compressedTreeNode?this.renderer.disposeCompressedElements?.(i.compressedTreeNode,t,i.data,n):this.renderer.disposeElement?.(e,t,i.data,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}};R([me],o_.prototype,"compressedTreeNodeProvider",1);var tN=class{constructor(e){this.modelProvider=e}compressedStickyNodes=new Map;getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,i){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let n=0;n<e.length;n++){let o=e[n],s=o.position+o.height;if(n+1<e.length&&s+e[n+1].height>i||n>=t-1&&t<e.length){let l=e.slice(0,n),d=e.slice(n),c=this.compressStickyNodes(d);return[...l,c]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");let t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];let i=[];for(let d=0;d<e.length;d++){let c=e[d],u=t.getCompressedTreeNode(c.node.element);if(u.element){if(d!==0&&u.element.incompressible)break;i.push(...u.element.elements)}}if(i.length<2)return e[0];let n=e[e.length-1],o={elements:i,incompressible:!1},s={...n.node,children:[],element:o},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:n.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,s),l}};function BZ(r,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=r().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}var uf=class extends fh{constructor(e,t,i,n,o={}){let s=()=>this,a=new tN(()=>this.model),l=n.map(d=>new o_(s,a,d));super(e,t,i,l,{...BZ(s,o),stickyScrollDelegate:a})}setChildren(e,t=ct.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t){return new n_(e,t)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}};function iN(r){return{...r,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function oN(r,e){return e.parent?e.parent===r?!0:oN(r,e.parent):!1}function VZ(r,e){return r===e||oN(r,e)||oN(e,r)}var rN=class r{constructor(e){this.node=e}get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new r(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},sN=class{constructor(e,t,i){this.renderer=e;this.nodeMapper=t;this.onDidChangeTwistieState=i;this.templateId=e.templateId}templateId;renderedNodes=new Map;renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ae.asClassNameArray(ie.treeItemLoading)),!0):(t.classList.remove(...Ae.asClassNameArray(ie.treeItemLoading)),!1)}disposeElement(e,t,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}};function r7(r){return{browserEvent:r.browserEvent,elements:r.elements.map(e=>e.element)}}function r_(r){return{browserEvent:r.browserEvent,element:r.element&&r.element.element,target:r.target}}function WZ(r){return{browserEvent:r.browserEvent,element:r.element&&r.element.element,anchor:r.anchor,isStickyScroll:r.isStickyScroll}}var aN=class extends Zs{constructor(t){super(t.elements.map(i=>i.element));this.data=t}set context(t){this.data.context=t}get context(){return this.data.context}};function nN(r){return r instanceof Zs?new aN(r):r}var lN=class{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(nN(e),t)}onDragOver(e,t,i,n,o,s=!0){return this.dnd.onDragOver(nN(e),t&&t.element,i,n,o)}drop(e,t,i,n,o){this.dnd.drop(nN(e),t&&t.element,i,n,o)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.dnd.dispose()}};function s7(r){return r&&{...r,collapseByDefault:!0,identityProvider:r.identityProvider&&{getId(e){return r.identityProvider.getId(e.element)}},dnd:r.dnd&&new lN(r.dnd),multipleSelectionController:r.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return r.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return r.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:r.accessibilityProvider&&{...r.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:r.accessibilityProvider.getRole?e=>r.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:r.accessibilityProvider.isChecked?e=>!!r.accessibilityProvider?.isChecked(e.element):void 0,getAriaLabel(e){return r.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return r.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:r.accessibilityProvider.getWidgetRole?()=>r.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:r.accessibilityProvider.getAriaLevel&&(e=>r.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:r.accessibilityProvider.getActiveDescendantId&&(e=>r.accessibilityProvider.getActiveDescendantId(e.element))},filter:r.filter&&{filter(e,t){return r.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:r.keyboardNavigationLabelProvider&&{...r.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return r.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof r.expandOnlyOnTwistieClick>"u"?void 0:typeof r.expandOnlyOnTwistieClick!="function"?r.expandOnlyOnTwistieClick:e=>r.expandOnlyOnTwistieClick(e.element),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof r.defaultFindVisibility=="number"?r.defaultFindVisibility:typeof r.defaultFindVisibility>"u"?2:r.defaultFindVisibility(e.element)}}function dN(r,e){e(r),r.children.forEach(t=>dN(t,e))}var pf=class{constructor(e,t,i,n,o,s={}){this.user=e;this.dataSource=o;this.identityProvider=s.identityProvider,this.autoExpandSingleChildren=typeof s.autoExpandSingleChildren>"u"?!1:s.autoExpandSingleChildren,this.sorter=s.sorter,this.getDefaultCollapseState=a=>s.collapseByDefault?s.collapseByDefault(a)?3:2:void 0,this.tree=this.createTree(e,t,i,n,s),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=iN({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}tree;root;nodes=new Map;sorter;getDefaultCollapseState;subTreeRefreshPromises=new Map;refreshPromises=new Map;identityProvider;autoExpandSingleChildren;_onDidRender=new _;_onDidChangeNodeSlowState=new _;nodeMapper=new mh(e=>new rN(e));disposables=new Y;get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return z.map(this.tree.onDidChangeFocus,r7)}get onDidChangeSelection(){return z.map(this.tree.onDidChangeSelection,r7)}get onKeyDown(){return this.tree.onKeyDown}get onMouseClick(){return z.map(this.tree.onMouseClick,r_)}get onMouseDblClick(){return z.map(this.tree.onMouseDblClick,r_)}get onContextMenu(){return z.map(this.tree.onContextMenu,WZ)}get onTap(){return z.map(this.tree.onTap,r_)}get onPointer(){return z.map(this.tree.onPointer,r_)}get onDidFocus(){return this.tree.onDidFocus}get onDidBlur(){return this.tree.onDidBlur}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidUpdateOptions(){return this.tree.onDidUpdateOptions}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get findMode(){return this.tree.findMode}set findMode(e){this.tree.findMode=e}onDidChangeFindMode;get findMatchType(){return this.tree.findMatchType}set findMatchType(e){this.tree.findMatchType=e}onDidChangeFindMatchType;get expandOnlyOnTwistieClick(){if(typeof this.tree.expandOnlyOnTwistieClick=="boolean")return this.tree.expandOnlyOnTwistieClick;let e=this.tree.expandOnlyOnTwistieClick;return t=>e(this.nodes.get(t===this.root.element?null:t)||null)}get onDidDispose(){return this.tree.onDidDispose}createTree(e,t,i,n,o){let s=new df(i),a=n.map(d=>new sN(d,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=s7(o)||{};return new fh(e,t,s,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}get options(){return this.tree.options}getHTMLElement(){return this.tree.getHTMLElement()}get contentHeight(){return this.tree.contentHeight}get contentWidth(){return this.tree.contentWidth}get onDidChangeContentHeight(){return this.tree.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.tree.onDidChangeContentWidth}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollLeft(){return this.tree.scrollLeft}set scrollLeft(e){this.tree.scrollLeft=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}get lastVisibleElement(){return this.tree.lastVisibleElement.element}get ariaLabel(){return this.tree.ariaLabel}set ariaLabel(e){this.tree.ariaLabel=e}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.refreshPromises.forEach(n=>n.cancel()),this.refreshPromises.clear(),this.root.element=e;let i=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}async updateChildren(e=this.root.element,t=!0,i=!1,n){await this._updateChildren(e,t,i,void 0,n)}async _updateChildren(e=this.root.element,t=!0,i=!1,n,o){if(typeof this.root.element>"u")throw new Ai(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await z.toPromise(this._onDidRender.event));let s=this.getDataNode(e);if(await this.refreshAndRenderNode(s,t,n,o),i)try{this.tree.rerender(s)}catch{}}resort(e=this.root.element,t=!0){this.tree.resort(this.getDataNode(e),t)}hasNode(e){return e===this.root.element||this.nodes.has(e)}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}let t=this.getDataNode(e);this.tree.rerender(t)}updateElementHeight(e,t){let i=this.getDataNode(e);this.tree.updateElementHeight(i,t)}updateWidth(e){let t=this.getDataNode(e);this.tree.updateWidth(t)}getNode(e=this.root.element){let t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){let i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new Ai(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await z.toPromise(this._onDidRender.event));let i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await this.root.refreshPromise,await z.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;let n=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(await this.root.refreshPromise,await z.toPromise(this._onDidRender.event)),n}toggleCollapsed(e,t=!1){return this.tree.toggleCollapsed(this.getDataNode(e),t)}expandAll(){this.tree.expandAll()}async expandTo(e){if(!this.dataSource.getParent)throw new Error("Can't expand to element without getParent method");let t=[];for(;!this.hasNode(e);)e=this.dataSource.getParent(e),e!==this.root.element&&t.push(e);for(let i of ct.reverse(t))await this.expand(i);this.tree.expandTo(this.getDataNode(e))}collapseAll(){this.tree.collapseAll()}isCollapsible(e){return this.tree.isCollapsible(this.getDataNode(e))}isCollapsed(e){return this.tree.isCollapsed(this.getDataNode(e))}triggerTypeNavigation(){this.tree.triggerTypeNavigation()}openFind(){this.tree.openFind()}closeFind(){this.tree.closeFind()}refilter(){this.tree.refilter()}setAnchor(e){this.tree.setAnchor(typeof e>"u"?void 0:this.getDataNode(e))}getAnchor(){return this.tree.getAnchor()?.element}setSelection(e,t){let i=e.map(n=>this.getDataNode(n));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){let i=e.map(n=>this.getDataNode(n));this.tree.setFocus(i,t)}focusNext(e=1,t=!1,i){this.tree.focusNext(e,t,i)}focusPrevious(e=1,t=!1,i){this.tree.focusPrevious(e,t,i)}focusNextPage(e){return this.tree.focusNextPage(e)}focusPreviousPage(e){return this.tree.focusPreviousPage(e)}focusLast(e){this.tree.focusLast(e)}focusFirst(e){this.tree.focusFirst(e)}getFocus(){return this.tree.getFocus().map(t=>t.element)}getStickyScrollFocus(){return this.tree.getStickyScrollFocus().map(t=>t.element)}getFocusedPart(){return this.tree.getFocusedPart()}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getRelativeTop(e){return this.tree.getRelativeTop(this.getDataNode(e))}getParentElement(e){let t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){let t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){let t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new Ai(this.user,`Data tree node not found: ${e}`);return t}async refreshAndRenderNode(e,t,i,n){await this.refreshNode(e,t,i),!this.disposables.isDisposed&&this.render(e,i,n)}async refreshNode(e,t,i){let n;if(this.subTreeRefreshPromises.forEach((o,s)=>{!n&&VZ(s,e)&&(n=o.then(()=>this.refreshNode(e,t,i)))}),n)return n;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,i);return}return this.doRefreshSubTree(e,t,i)}async doRefreshSubTree(e,t,i){let n;e.refreshPromise=new Promise(o=>n=o),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{let o=await this.doRefreshNode(e,t,i);e.stale=!1,await Rn.settled(o.map(s=>this.doRefreshSubTree(s,t,i)))}finally{n()}}async doRefreshNode(e,t,i){e.hasChildren=!!this.dataSource.hasChildren(e.element);let n;if(!e.hasChildren)n=Promise.resolve(ct.empty());else{let o=this.doGetChildren(e);if(x0(o))n=Promise.resolve(o);else{let s=hn(800);s.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),n=o.finally(()=>s.cancel())}}try{let o=await n;return this.setChildren(e,o,t,i)}catch(o){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),wc(o))return[];throw o}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;let i=this.dataSource.getChildren(e.element);return x0(i)?this.processChildren(i):(t=xp(async()=>this.processChildren(await i)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(Ge))}setChildren(e,t,i,n){let o=[...t];if(e.children.length===0&&o.length===0)return[];let s=new Map,a=new Map;for(let c of e.children)s.set(c.element,c),this.identityProvider&&a.set(c.id,{node:c,collapsed:this.tree.hasElement(c)&&this.tree.isCollapsed(c)});let l=[],d=o.map(c=>{let u=!!this.dataSource.hasChildren(c);if(!this.identityProvider){let g=iN({element:c,parent:e,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(c)});return u&&g.defaultCollapseState===2&&l.push(g),g}let p=this.identityProvider.getId(c).toString(),m=a.get(p);if(m){let g=m.node;return s.delete(g.element),this.nodes.delete(g.element),this.nodes.set(c,g),g.element=c,g.hasChildren=u,i?m.collapsed?(g.children.forEach(b=>dN(b,v=>this.nodes.delete(v.element))),g.children.splice(0,g.children.length),g.stale=!0):l.push(g):u&&!m.collapsed&&l.push(g),g}let f=iN({element:c,parent:e,id:p,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(c)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(p)>-1&&n.focus.push(f),n&&n.viewState.selection&&n.viewState.selection.indexOf(p)>-1&&n.selection.push(f),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(p)>-1||u&&f.defaultCollapseState===2)&&l.push(f),f});for(let c of s.values())dN(c,u=>this.nodes.delete(u.element));for(let c of d)this.nodes.set(c.element,c);return e.children.splice(0,e.children.length,...d),e!==this.root&&this.autoExpandSingleChildren&&d.length===1&&l.length===0&&(d[0].forceExpanded=!0,l.push(d[0])),l}render(e,t,i){let n=e.children.map(s=>this.asTreeElement(s,t)),o=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(s){return i.diffIdentityProvider.getId(s.element)}}};this.tree.setChildren(e===this.root?null:e,n,o),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:e.forceExpanded?(i=!1,e.forceExpanded=!1):i=e.defaultCollapseState,{element:e,children:e.hasChildren?ct.map(e.children,n=>this.asTreeElement(n,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}getViewState(){if(!this.identityProvider)throw new Ai(this.user,"Can't get tree view state without an identity provider");let e=a=>this.identityProvider.getId(a).toString(),t=this.getFocus().map(e),i=this.getSelection().map(e),n=[],o=this.tree.getNode(),s=[o];for(;s.length>0;){let a=s.pop();a!==o&&a.collapsible&&!a.collapsed&&n.push(e(a.element.element)),s.push(...a.children)}return{focus:t,selection:i,expanded:n,scrollTop:this.scrollTop}}dispose(){this.disposables.dispose(),this.tree.dispose()}},cN=class r{constructor(e){this.node=e}get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new r(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},uN=class{constructor(e,t,i,n){this.renderer=e;this.nodeMapper=t;this.compressibleNodeMapperProvider=i;this.onDidChangeTwistieState=n;this.templateId=e.templateId}templateId;renderedNodes=new Map;disposables=[];renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderCompressedElements(e,t,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ae.asClassNameArray(ie.treeItemLoading)),!0):(t.classList.remove(...Ae.asClassNameArray(ie.treeItemLoading)),!1)}disposeElement(e,t,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,i.templateData,n)}disposeCompressedElements(e,t,i,n){this.renderer.disposeCompressedElements?.(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=ht(this.disposables)}};function HZ(r){let e=r&&s7(r);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return r.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}}}}var s_=class extends pf{constructor(t,i,n,o,s,a,l={}){super(t,i,n,s,a,l);this.compressionDelegate=o;this.filter=l.filter}compressibleNodeMapper=new mh(t=>new cN(t));filter;createTree(t,i,n,o,s){let a=new df(n),l=o.map(c=>new uN(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),d=HZ(s)||{};return new uf(t,i,a,l,d)}asTreeElement(t,i){return{incompressible:this.compressionDelegate.isIncompressible(t.element),...super.asTreeElement(t,i)}}updateOptions(t={}){this.tree.updateOptions(t)}getViewState(){if(!this.identityProvider)throw new Ai(this.user,"Can't get tree view state without an identity provider");let t=l=>this.identityProvider.getId(l).toString(),i=this.getFocus().map(t),n=this.getSelection().map(t),o=[],s=this.tree.getCompressedTreeNode(),a=[s];for(;a.length>0;){let l=a.pop();if(l!==s&&l.collapsible&&!l.collapsed)for(let d of l.element.elements)o.push(t(d.element));a.push(...l.children)}return{focus:i,selection:n,expanded:o,scrollTop:this.scrollTop}}render(t,i,n){if(!this.identityProvider)return super.render(t,i);let o=f=>this.identityProvider.getId(f).toString(),s=f=>{let g=new Set;for(let b of f){let v=this.tree.getCompressedTreeNode(b===this.root?null:b);if(v.element)for(let I of v.element.elements)g.add(o(I.element))}return g},a=s(this.tree.getSelection()),l=s(this.tree.getFocus());super.render(t,i,n);let d=this.getSelection(),c=!1,u=this.getFocus(),p=!1,m=f=>{let g=f.element;if(g)for(let b=0;b<g.elements.length;b++){let v=o(g.elements[b].element),I=g.elements[g.elements.length-1].element;a.has(v)&&d.indexOf(I)===-1&&(d.push(I),c=!0),l.has(v)&&u.indexOf(I)===-1&&(u.push(I),p=!0)}f.children.forEach(m)};m(this.tree.getCompressedTreeNode(t===this.root?null:t)),c&&this.setSelection(d),p&&this.setFocus(u)}processChildren(t){return this.filter&&(t=ct.filter(t,i=>{let n=this.filter.filter(i,1),o=UZ(n);if(o===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return o===1})),super.processChildren(t)}};function UZ(r){return typeof r=="boolean"?r?1:0:vI(r)?gh(r.visibility):gh(r)}var a_=class extends cf{constructor(t,i,n,o,s,a={}){super(t,i,n,o,a);this.user=t;this.dataSource=s;this.identityProvider=a.identityProvider}input;identityProvider;nodesByIdentity=new Map;getInput(){return this.input}setInput(t,i){if(i&&!this.identityProvider)throw new Ai(this.user,"Can't restore tree view state without an identity provider");if(this.input=t,!t){this.nodesByIdentity.clear(),this.model.setChildren(null,ct.empty());return}if(!i){this._refresh(t);return}let n=[],o=[],s=l=>{let d=this.identityProvider.getId(l).toString();return!i.expanded[d]},a=l=>{let d=this.identityProvider.getId(l.element).toString();i.focus.has(d)&&n.push(l.element),i.selection.has(d)&&o.push(l.element)};this._refresh(t,s,a),this.setFocus(n),this.setSelection(o),i&&typeof i.scrollTop=="number"&&(this.scrollTop=i.scrollTop)}updateChildren(t=this.input){if(typeof this.input>"u")throw new Ai(this.user,"Tree input not set");let i;this.identityProvider&&(i=n=>{let o=this.identityProvider.getId(n).toString(),s=this.nodesByIdentity.get(o);if(s)return s.collapsed}),this._refresh(t,i)}resort(t=this.input,i=!0){this.model.resort(t===this.input?null:t,i)}refresh(t){if(t===void 0){this.view.rerender();return}this.model.rerender(t)}_refresh(t,i,n){let o;if(this.identityProvider){let s=new Set,a=n;n=l=>{let d=this.identityProvider.getId(l.element).toString();s.add(d),this.nodesByIdentity.set(d,l),a?.(l)},o=l=>{let d=this.identityProvider.getId(l.element).toString();s.has(d)||this.nodesByIdentity.delete(d)}}this.model.setChildren(t===this.input?null:t,this.iterate(t,i).elements,{onDidCreateNode:n,onDidDeleteNode:o})}iterate(t,i){let n=[...this.dataSource.getChildren(t)];return{elements:ct.map(n,s=>{let{elements:a,size:l}=this.iterate(s,i),d=this.dataSource.hasChildren?this.dataSource.hasChildren(s):void 0,c=l===0?void 0:i&&i(s);return{element:s,children:a,collapsible:d,collapsed:c}}),size:n.length}}createModel(t,i){return new Tu(t,i)}};var pN=class extends lo{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new _);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(e,t){super(),this._element=ye(e,he(".monaco-dropdown")),this._label=ye(this._element,he(".dropdown-label"));let i=t.labelRenderer;i||(i=o=>(o.textContent=t.label||"",null));for(let o of[Q.CLICK,Q.MOUSE_DOWN,it.Tap])this._register(B(this.element,o,s=>Oe.stop(s,!0)));for(let o of[Q.MOUSE_DOWN,it.Tap])this._register(B(this._label,o,s=>{yr(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(B(this._label,Q.KEY_UP,o=>{let s=new bt(o);(s.equals(3)||s.equals(10))&&(Oe.stop(o,!0),this.visible?this.hide():this.show())}));let n=i(this._label);n&&this._register(n),this._register(ei.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(e){this._label&&(!this.hover&&e!==""?this.hover=this._register(tn().setupManagedHover(Dt("mouse"),this._label,e)):this.hover&&this.hover.update(e))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(e,t){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},d_=class extends pN{constructor(t,i){super(t,i);this._options=i;this.actions=i.actions||[]}_menuOptions;_actions=[];set menuOptions(t){this._menuOptions=t}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(t){this._actions=t}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(t,i)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(t,i):void 0,getKeyBinding:t=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(t):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var Oht={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:U.white.toString(),buttonForeground:U.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0},nc=class extends P{options;_element;_label="";_labelElement;_labelShortElement;_hover;_onDidClick=this._register(new _);get onDidClick(){return this._onDidClick.event}_onDidEscape=this._register(new _);get onDidEscape(){return this._onDidEscape.event}focusTracker;constructor(e,t){super(),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);let i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,n=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this._register(ei.addTarget(this._element)),[Q.CLICK,it.Tap].forEach(o=>{this._register(B(this._element,o,s=>{if(!this.enabled){Oe.stop(s);return}this._onDidClick.fire(s)}))}),this._register(B(this._element,Q.KEY_DOWN,o=>{let s=new bt(o),a=!1;this.enabled&&(s.equals(3)||s.equals(10))?(this._onDidClick.fire(o),a=!0):s.equals(9)&&(this._onDidEscape.fire(o),this._element.blur(),a=!0),a&&Oe.stop(s,!0)})),this._register(B(this._element,Q.MOUSE_OVER,o=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(B(this._element,Q.MOUSE_OUT,o=>{this.updateBackground(!1)})),this.focusTracker=this._register(Mn(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){let t=[];for(let i of Es(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;let n=document.createElement("span");n.textContent=i,t.push(n)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){if(this._label===e||kE(this._label)&&kE(e)&&SH(this._label,e))return;this._element.classList.add("monaco-text-button");let t=this.options.supportShortLabel?this._labelElement:this._element;if(kE(e)){let n=jE(e,{inline:!0});n.dispose();let o=n.element.querySelector("p")?.innerHTML;if(o){let s=Bv(o,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});t.innerHTML=s}else gn(t)}else this.options.supportIcons?gn(t,...this.getContentElements(e)):t.textContent=e;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=iA(e)),this.setTitle(i),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",i),this._label=e}get label(){return this._label}set labelShort(e){!this.options.supportShortLabel||!this._labelShortElement||(this.options.supportIcons?gn(this._labelShortElement,...this.getContentElements(e)):this._labelShortElement.textContent=e)}set icon(e){this._element.classList.add(...Ae.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}set checked(e){e?(this._element.classList.add("checked"),this._element.setAttribute("aria-checked","true")):(this._element.classList.remove("checked"),this._element.setAttribute("aria-checked","false"))}get checked(){return this._element.classList.contains("checked")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(tn().setupManagedHover(this.options.hoverDelegate??Dt("mouse"),this._element,e)):this._hover&&this._hover.update(e)}focus(){this._element.focus()}hasFocus(){return ho(this._element)}},hN=class extends P{button;action;dropdownButton;separatorContainer;separator;element;_onDidClick=this._register(new _);onDidClick=this._onDidClick.event;constructor(e,t){super(),this.element=document.createElement("div"),this.element.classList.add("monaco-button-dropdown"),e.appendChild(this.element),this.button=this._register(new nc(this.element,t)),this._register(this.button.onDidClick(o=>this._onDidClick.fire(o))),this.action=this._register(new Si("primaryAction",iA(this.button.label),void 0,!0,async()=>this._onDidClick.fire(void 0))),this.separatorContainer=document.createElement("div"),this.separatorContainer.classList.add("monaco-button-dropdown-separator"),this.separator=document.createElement("div"),this.separatorContainer.appendChild(this.separator),this.element.appendChild(this.separatorContainer);let i=t.buttonBorder;i&&(this.separatorContainer.style.borderTop="1px solid "+i,this.separatorContainer.style.borderBottom="1px solid "+i);let n=t.secondary?t.buttonSecondaryBackground:t.buttonBackground;this.separatorContainer.style.backgroundColor=n??"",this.separator.style.backgroundColor=t.buttonSeparator??"",this.dropdownButton=this._register(new nc(this.element,{...t,title:!1,supportIcons:!0})),this._register(tn().setupManagedHover(Dt("mouse"),this.dropdownButton.element,h("button dropdown more actions","More Actions..."))),this.dropdownButton.element.setAttribute("aria-haspopup","true"),this.dropdownButton.element.setAttribute("aria-expanded","false"),this.dropdownButton.element.classList.add("monaco-dropdown-button"),this.dropdownButton.icon=ie.dropDownButton,this._register(this.dropdownButton.onDidClick(o=>{let s=Array.isArray(t.actions)?t.actions:t.actions.getActions();t.contextMenuProvider.showContextMenu({getAnchor:()=>this.dropdownButton.element,getActions:()=>t.addPrimaryActionToDropdown===!1?[...s]:[this.action,...s],actionRunner:t.actionRunner,onHide:()=>this.dropdownButton.element.setAttribute("aria-expanded","false")}),this.dropdownButton.element.setAttribute("aria-expanded","true")}))}dispose(){super.dispose(),this.element.remove()}set label(e){this.button.label=e,this.action.label=e}set icon(e){this.button.icon=e}set enabled(e){this.button.enabled=e,this.dropdownButton.enabled=e,this.element.classList.toggle("disabled",!e)}get enabled(){return this.button.enabled}set checked(e){this.button.checked=e}get checked(){return this.button.checked}focus(){this.button.focus()}hasFocus(){return this.button.hasFocus()||this.dropdownButton.hasFocus()}},c_=class{constructor(e,t){this.options=t;this._element=document.createElement("div"),this._element.classList.add("monaco-description-button"),this._button=new nc(this._element,t),this._descriptionElement=document.createElement("div"),this._descriptionElement.classList.add("monaco-button-description"),this._element.appendChild(this._descriptionElement),e.appendChild(this._element)}_button;_element;_descriptionElement;get onDidClick(){return this._button.onDidClick}get element(){return this._element}set label(e){this._button.label=e}set icon(e){this._button.icon=e}get enabled(){return this._button.enabled}set enabled(e){this._button.enabled=e}set checked(e){this._button.checked=e}get checked(){return this._button.checked}focus(){this._button.focus()}hasFocus(){return this._button.hasFocus()}dispose(){this._button.dispose()}set description(e){this.options.supportIcons?gn(this._descriptionElement,...Es(e)):this._descriptionElement.textContent=e}},II=class{constructor(e){this.container=e}_buttons=[];_buttonStore=new Y;dispose(){this._buttonStore.dispose()}get buttons(){return this._buttons}clear(){this._buttonStore.clear(),this._buttons.length=0}addButton(e){let t=this._buttonStore.add(new nc(this.container,e));return this.pushButton(t),t}addButtonWithDescription(e){let t=this._buttonStore.add(new c_(this.container,e));return this.pushButton(t),t}addButtonWithDropdown(e){let t=this._buttonStore.add(new hN(this.container,e));return this.pushButton(t),t}pushButton(e){this._buttons.push(e);let t=this._buttons.length-1;this._buttonStore.add(B(e.element,Q.KEY_DOWN,i=>{let n=new bt(i),o=!0,s;n.equals(15)?s=t>0?t-1:this._buttons.length-1:n.equals(17)?s=t===this._buttons.length-1?0:t+1:o=!1,o&&typeof s=="number"&&(this._buttons[s].focus(),Oe.stop(i,!0))}))}};var hf=class{modifierLabels;constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=i(a);if(l===null)return null;n[o]=KZ(a,l,this.modifierLabels[e])}return n.join(" ")}},u_=new hf({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:h({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:h({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:h({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:h({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),Vht=new hf({ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:h({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),Wht=new hf({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),Hht=new hf({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function KZ(r,e,t){if(e===null)return"";let i=[];return r.ctrlKey&&i.push(t.ctrlKey),r.shiftKey&&i.push(t.shiftKey),r.altKey&&i.push(t.altKey),r.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}var p_=he;var h_=class r extends P{constructor(t,i,n){super();this.os=i;this.options=n||Object.create(null);let o=this.options.keybindingLabelForeground;this.domNode=ye(t,p_(".monaco-keybinding")),o&&(this.domNode.style.color=o),this.hover=this._register(tn().setupManagedHover(Dt("mouse"),this.domNode,"")),this.didEverRender=!1,t.appendChild(this.domNode)}domNode;options;keyElements=new Set;hover;keybinding;matches;didEverRender;get element(){return this.domNode}set(t,i){this.didEverRender&&this.keybinding===t&&r.areSame(this.matches,i)||(this.keybinding=t,this.matches=i,this.render())}render(){if(this.clear(),this.keybinding){let t=this.keybinding.getChords();t[0]&&this.renderChord(this.domNode,t[0],this.matches?this.matches.firstPart:null);for(let n=1;n<t.length;n++)ye(this.domNode,p_("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,t[n],this.matches?this.matches.chordPart:null);let i=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(i),this.domNode.setAttribute("aria-label",i||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){Xt(this.domNode),this.keyElements.clear()}renderChord(t,i,n){let o=u_.modifierLabels[this.os];i.ctrlKey&&this.renderKey(t,o.ctrlKey,!!n?.ctrlKey,o.separator),i.shiftKey&&this.renderKey(t,o.shiftKey,!!n?.shiftKey,o.separator),i.altKey&&this.renderKey(t,o.altKey,!!n?.altKey,o.separator),i.metaKey&&this.renderKey(t,o.metaKey,!!n?.metaKey,o.separator);let s=i.keyLabel;s&&this.renderKey(t,s,!!n?.keyCode,"")}renderKey(t,i,n,o){ye(t,this.createKeyElement(i,n?".highlight":"")),o&&ye(t,p_("span.monaco-keybinding-key-separator",void 0,o))}renderUnbound(t){ye(t,this.createKeyElement(h("unbound","Unbound")))}createKeyElement(t,i=""){let n=p_("span.monaco-keybinding-key"+i,void 0,t);return this.keyElements.add(n),this.options.keybindingLabelBackground&&(n.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(n.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(n.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(n.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),n}static areSame(t,i){return t===i||!t&&!i?!0:!!t&&!!i&&fi(t.firstPart,i.firstPart)&&fi(t.chordPart,i.chordPart)}};var GZ=()=>({msLoopTime:-1,msDelayTime:-1,dispose:()=>{}}),jZ=GZ;function a7(r,e){return jZ(r,e)}var mN="done",gN="active",m_="infinite",g_="infinite-long-running",fN="discrete";var mf=class r extends P{static LONG_RUNNING_INFINITE_THRESHOLD=1e4;static PROGRESS_SIGNAL_DEFAULT_DELAY=3e3;workedVal;element;bit;totalWork;showDelayedScheduler;longRunningScheduler;progressSignal=this._register(new xt);constructor(e,t){super(),this.workedVal=0,this.showDelayedScheduler=this._register(new Kt(()=>kp(this.element),0)),this.longRunningScheduler=this._register(new Kt(()=>this.infiniteLongRunning(),r.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=t?.progressBarBackground||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(gN,m_,g_,fN),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}done(){return this.doDone(!0)}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(mN),this.element.classList.contains(m_)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(fN,mN,g_),this.element.classList.add(gN,m_),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(g_)}total(e){return this.workedVal=0,this.totalWork=e,this.element.setAttribute("aria-valuemax",e.toString()),this}hasTotal(){return so(this.totalWork)}worked(e){return e=Math.max(1,Number(e)),this.doSetWorked(this.workedVal+e)}setWorked(e){return e=Math.max(1,Number(e)),this.doSetWorked(e)}doSetWorked(e){let t=this.totalWork||100;return this.workedVal=e,this.workedVal=Math.min(t,this.workedVal),this.element.classList.remove(m_,g_,mN),this.element.classList.add(gN,fN),this.element.setAttribute("aria-valuenow",e.toString()),this.bit.style.width=100*(this.workedVal/t)+"%",this}getContainer(){return this.element}show(e){this.showDelayedScheduler.cancel(),this.progressSignal.value=a7(r.PROGRESS_SIGNAL_DEFAULT_DELAY),typeof e=="number"?this.showDelayedScheduler.schedule(e):kp(this.element)}hide(){Mm(this.element),this.showDelayedScheduler.cancel(),this.progressSignal.clear()}};var gf=class{},f_=class{_disposables=new Y;_domNode;_scrollable;_onDidSelectItem=new _;_onDidFocusItem=new _;_onDidChangeFocus=new _;onDidSelectItem=this._onDidSelectItem.event;onDidFocusItem=this._onDidFocusItem.event;onDidChangeFocus=this._onDidChangeFocus.event;_items=new Array;_nodes=new Array;_freeNodes=new Array;_separatorIcon;_enabled=!0;_focusedItemIdx=-1;_selectedItemIdx=-1;_pendingDimLayout;_pendingLayout;_dimension;constructor(e,t,i,n){this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new Ys(this._domNode,{vertical:2,horizontal:1,horizontalScrollbarSize:t,useShadows:!1,scrollYToX:!0}),this._separatorIcon=i,this._disposables.add(this._scrollable),this._disposables.add(si(this._domNode,"click",a=>this._onClick(a))),e.appendChild(this._scrollable.getDomNode());let o=rr(this._domNode);this._style(o,n);let s=Mn(this._domNode);this._disposables.add(s),this._disposables.add(s.onDidBlur(a=>this._onDidChangeFocus.fire(!1))),this._disposables.add(s.onDidFocus(a=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(e){this._scrollable.updateOptions({horizontalScrollbarSize:e})}dispose(){this._disposables.dispose(),this._pendingLayout?.dispose(),this._pendingDimLayout?.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(e){e&&At.equals(e,this._dimension)||(e?(this._pendingDimLayout?.dispose(),this._pendingDimLayout=this._updateDimensions(e)):(this._pendingLayout?.dispose(),this._pendingLayout=this._updateScrollbar()))}_updateDimensions(e){let t=new Y;return t.add(F2(pe(this._domNode),()=>{this._dimension=e,this._domNode.style.width=`${e.width}px`,this._domNode.style.height=`${e.height}px`,t.add(this._updateScrollbar())})),t}_updateScrollbar(){return t1(pe(this._domNode),()=>{t1(pe(this._domNode),()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(e,t){let i="";t.breadcrumbsBackground&&(i+=`.monaco-breadcrumbs { background-color: ${t.breadcrumbsBackground}}`),t.breadcrumbsForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item { color: ${t.breadcrumbsForeground}}
`),t.breadcrumbsFocusForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ${t.breadcrumbsFocusForeground}}
`),t.breadcrumbsFocusAndSelectionForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ${t.breadcrumbsFocusAndSelectionForeground}}
`),t.breadcrumbsHoverForeground&&(i+=`.monaco-breadcrumbs:not(.disabled	) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ${t.breadcrumbsHoverForeground}}
`),e.innerText=i}setEnabled(e){this._enabled=e,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){let e=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;e>=0&&e<this._items.length?this._focus(e,void 0):this._domNode.focus()}isDOMFocused(){return U2(this._domNode)}getFocused(){return this._items[this._focusedItemIdx]}setFocused(e,t){this._focus(this._items.indexOf(e),t)}focusPrev(e){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,e)}focusNext(e){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,e)}_focus(e,t){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let n=this._nodes[i];i!==e?n.classList.remove("focused"):(this._focusedItemIdx=i,n.classList.add("focused"),n.focus())}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:t})}reveal(e){let t=this._items.indexOf(e);t>=0&&this._reveal(t,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(e,t){if(e<0||e>=this._nodes.length)return;let i=this._nodes[e];if(!i)return;let{width:n}=this._scrollable.getScrollDimensions(),{scrollLeft:o}=this._scrollable.getScrollPosition();(!t||i.offsetLeft>o+n||i.offsetLeft<o)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(e,t){this._select(this._items.indexOf(e),t)}_select(e,t){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let n=this._nodes[i];i!==e?n.classList.remove("selected"):(this._selectedItemIdx=i,n.classList.add("selected"))}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:t})}getItems(){return this._items}setItems(e){let t,i=[];try{t=YV(this._items,e,(n,o)=>n.equals(o)),i=this._items.splice(t,this._items.length-t,...e.slice(t)),this._render(t),ht(i),this._focus(-1,void 0)}catch(n){let o=new Error(`BreadcrumbsItem#setItems: newItems: ${e.length}, prefix: ${t}, removed: ${i.length}`);throw o.name=n.name,o.stack=n.stack,o}}_render(e){let t=!1;for(;e<this._items.length&&e<this._nodes.length;e++){let i=this._items[e],n=this._nodes[e];this._renderItem(i,n),t=!0}for(;e<this._nodes.length;){let i=this._nodes.pop();i&&(this._freeNodes.push(i),i.remove(),t=!0)}for(;e<this._items.length;e++){let i=this._items[e],n=this._freeNodes.length>0?this._freeNodes.pop():document.createElement("div");n&&(this._renderItem(i,n),this._domNode.appendChild(n),this._nodes.push(n),t=!0)}t&&this.layout(void 0)}_renderItem(e,t){Xt(t),t.className="";try{e.render(t)}catch(n){t.innerText="<<RENDER ERROR>>",console.error(n)}t.tabIndex=-1,t.setAttribute("role","listitem"),t.classList.add("monaco-breadcrumb-item");let i=he(Ae.asCSSSelector(this._separatorIcon));t.appendChild(i)}_onClick(e){if(this._enabled)for(let t=e.target;t;t=t.parentElement){let i=this._nodes.indexOf(t);if(i>=0){this._focus(i,e),this._select(i,e);break}}}};function qZ(r,e){let t={...e};for(let i in r){let n=r[i];t[i]=n!==void 0?ae(n):void 0}return t}var l7={keybindingLabelBackground:ae(v5),keybindingLabelForeground:ae(y5),keybindingLabelBorder:ae(I5),keybindingLabelBottomBorder:ae(C5),keybindingLabelShadow:ae(mu)};var b_={buttonForeground:ae(sO),buttonSeparator:ae(o5),buttonBackground:ae(wg),buttonHoverBackground:ae(r5),buttonSecondaryForeground:ae(a5),buttonSecondaryBackground:ae(bx),buttonSecondaryHoverBackground:ae(l5),buttonBorder:ae(s5)};var v_={progressBarBackground:ae(Sz)};var $Z={inputActiveOptionBorder:ae(nO),inputActiveOptionForeground:ae(rO),inputActiveOptionBackground:ae(oO)},Ygt={activeForeground:ae(xg),activeBackground:ae(d5),activeBorder:ae(c5),inactiveForeground:ae(u5),inactiveBackground:ae(p5),inactiveBorder:ae(h5),inactiveHoverBackground:ae(m5)};var Zgt={checkboxBackground:ae(g5),checkboxBorder:ae(b5),checkboxForeground:ae(f5)};var Xgt={dialogBackground:ae(vo),dialogForeground:ae(Bl),dialogShadow:ae(mu),dialogBorder:ae(Ie),errorIconForeground:ae(Wz),warningIconForeground:ae(Hz),infoIconForeground:ae(Uz),textLinkForeground:ae(ux)};var bN={inputBackground:ae(jz),inputForeground:ae(qz),inputBorder:ae(Tg),inputValidationInfoBorder:ae(Zz),inputValidationInfoBackground:ae($z),inputValidationInfoForeground:ae(Yz),inputValidationWarningBorder:ae(Jz),inputValidationWarningBackground:ae(Xz),inputValidationWarningForeground:ae(Qz),inputValidationErrorBorder:ae(i5),inputValidationErrorBackground:ae(e5),inputValidationErrorForeground:ae(t5)};var d7={listFilterWidgetBackground:ae(M5),listFilterWidgetOutline:ae(O5),listFilterWidgetNoMatchesOutline:ae(P5),listFilterWidgetShadow:ae(N5),inputBoxStyles:bN,toggleStyles:$Z},Qgt={badgeBackground:ae(Fl),badgeForeground:ae(vg),badgeBorder:ae(Ie)};var y_={breadcrumbsBackground:ae(Fz),breadcrumbsForeground:ae(Nz),breadcrumbsHoverForeground:ae(JM),breadcrumbsFocusForeground:ae(JM),breadcrumbsFocusAndSelectionForeground:ae(Bz)};var ff={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:ae(S5),listFocusForeground:ae(E5),listFocusOutline:ae(w5),listActiveSelectionBackground:ae(yo),listActiveSelectionForeground:ae(is),listActiveSelectionIconForeground:ae(yx),listFocusAndSelectionOutline:ae(x5),listFocusAndSelectionBackground:ae(yo),listFocusAndSelectionForeground:ae(is),listInactiveSelectionBackground:ae(T5),listInactiveSelectionIconForeground:ae(D5),listInactiveSelectionForeground:ae(_5),listInactiveFocusBackground:ae(L5),listInactiveFocusOutline:ae(k5),listHoverBackground:ae(aO),listHoverForeground:ae(lO),listDropOverBackground:ae(R5),listDropBetweenBackground:ae(A5),listSelectionOutline:ae(Ft),listHoverOutline:ae(Ft),treeIndentGuidesStroke:ae(Dg),treeInactiveIndentGuidesStroke:ae(F5),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:ae(pu),tableColumnsBorder:ae(B5),tableOddRowsBackgroundColor:ae(V5)};function CI(r){return qZ(r,ff)}var c7={selectBackground:ae(_g),selectListBackground:ae(n5),selectForeground:ae(Uy),decoratorRightForeground:ae($5),selectBorder:ae(zy),focusBorder:ae(Zo),listFocusBackground:ae(X5),listInactiveSelectionIconForeground:ae(Z5),listFocusForeground:ae(Y5),listFocusOutline:vz(Ft,U.transparent.toString()),listHoverBackground:ae(aO),listHoverForeground:ae(lO),listHoverOutline:ae(Ft),selectListBorder:ae(QM),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var Jgt={shadowColor:ae(mu),borderColor:ae(W5),foregroundColor:ae(H5),backgroundColor:ae(U5),selectionForegroundColor:ae(z5),selectionBackgroundColor:ae(K5),selectionBorderColor:ae(G5),separatorColor:ae(j5),scrollbarShadow:ae(pu),scrollbarSliderBackground:ae(px),scrollbarSliderHoverBackground:ae(hx),scrollbarSliderActiveBackground:ae(mx)};var ss=Z("listService");var SI=new q("listScrollAtBoundary","none"),Ibt=Ue.or(SI.isEqualTo("top"),SI.isEqualTo("both")),Cbt=Ue.or(SI.isEqualTo("bottom"),SI.isEqualTo("both")),u7=new q("listFocus",!0),p7=new q("treestickyScrollFocused",!1),A_=new q("listSupportsMultiselect",!0),M_=Ue.and(u7,Ue.not($g),p7.negate()),CN=new q("listHasSelectionOrFocus",!1),SN=new q("listDoubleSelection",!1),EN=new q("listMultiSelection",!1),O_=new q("listSelectionNavigation",!1),YZ=new q("listSupportsFind",!0),ZZ=new q("treeElementCanCollapse",!1),XZ=new q("treeElementHasParent",!1),QZ=new q("treeElementCanExpand",!1),JZ=new q("treeElementHasChild",!1),eX=new q("treeFindOpen",!1),h7="listTypeNavigationMode",m7="listAutomaticKeyboardNavigation";function P_(r,e){let t=r.createScoped(e.getHTMLElement());return u7.bindTo(t),t}function N_(r,e){let t=SI.bindTo(r),i=()=>{let n=e.scrollTop===0,o=e.scrollHeight-e.renderHeight-e.scrollTop<1;n&&o?t.set("both"):n?t.set("top"):o?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}var bh="workbench.list.multiSelectModifier",x_="workbench.list.openMode",Ms="workbench.list.horizontalScrolling",wN="workbench.list.defaultFindMode",xN="workbench.list.typeNavigationMode",T_="workbench.list.keyboardNavigation",Ga="workbench.list.scrollByPage",TN="workbench.list.defaultFindMatchType",EI="workbench.tree.indent",__="workbench.tree.renderIndentGuides",ja="workbench.list.smoothScrolling",Jl="workbench.list.mouseWheelScrollSensitivity",ed="workbench.list.fastScrollSensitivity",D_="workbench.tree.expandMode",L_="workbench.tree.enableStickyScroll",k_="workbench.tree.stickyScrollMaxItemCount";function td(r){return r.getValue(bh)==="alt"}var vN=class extends P{constructor(t){super();this.configurationService=t;this.useAltAsMultipleSelectionModifier=td(t),this.registerListeners()}useAltAsMultipleSelectionModifier;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(bh)&&(this.useAltAsMultipleSelectionModifier=td(this.configurationService))}))}isSelectionSingleChangeEvent(t){return this.useAltAsMultipleSelectionModifier?t.browserEvent.altKey:V1(t)}isSelectionRangeChangeEvent(t){return W1(t)}};function F_(r,e){let t=r.get(He),i=r.get(qt),n=new Y;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(s){return i.mightProducePrintableCharacter(s)}},smoothScrolling:!!t.getValue(ja),mouseWheelScrollSensitivity:t.getValue(Jl),fastScrollSensitivity:t.getValue(ed),multipleSelectionController:e.multipleSelectionController??n.add(new vN(t)),keyboardNavigationEventFilter:tX(i),scrollByPage:!!t.getValue(Ga)},n]}var bf=class extends Sn{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,o,s,a,l,d){let c=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(Ms),[u,p]=d.invokeFunction(F_,o);super(e,t,i,n,{keyboardSupport:!1,...u,horizontalScrolling:c}),this.disposables.add(p),this.contextKeyService=P_(s,this),this.disposables.add(N_(this.contextKeyService,this)),this.listSupportsMultiSelect=A_.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),O_.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=CN.bindTo(this.contextKeyService),this.listDoubleSelection=SN.bindTo(this.contextKeyService),this.listMultiSelection=EN.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=td(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let f=this.getSelection(),g=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(f.length>0||g.length>0),this.listMultiSelection.set(f.length>1),this.listDoubleSelection.set(f.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let f=this.getSelection(),g=this.getFocus();this.listHasSelectionOrFocus.set(f.length>0||g.length>0)})),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(bh)&&(this._useAltAsMultipleSelectionModifier=td(l));let g={};if(f.affectsConfiguration(Ms)&&this.horizontalScrolling===void 0){let b=!!l.getValue(Ms);g={...g,horizontalScrolling:b}}if(f.affectsConfiguration(Ga)){let b=!!l.getValue(Ga);g={...g,scrollByPage:b}}if(f.affectsConfiguration(ja)){let b=!!l.getValue(ja);g={...g,smoothScrolling:b}}if(f.affectsConfiguration(Jl)){let b=l.getValue(Jl);g={...g,mouseWheelScrollSensitivity:b}}if(f.affectsConfiguration(ed)){let b=l.getValue(ed);g={...g,fastScrollSensitivity:b}}Object.keys(g).length>0&&this.updateOptions(g)})),this.navigator=new R_(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?CI(e):ff)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}};bf=R([y(5,je),y(6,ss),y(7,He),y(8,ve)],bf);var I_=class extends UT{contextKeyService;disposables;listSupportsMultiSelect;_useAltAsMultipleSelectionModifier;horizontalScrolling;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,o,s,a,l,d){let c=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(Ms),[u,p]=d.invokeFunction(F_,o);super(e,t,i,n,{keyboardSupport:!1,...u,horizontalScrolling:c}),this.disposables=new Y,this.disposables.add(p),this.contextKeyService=P_(s,this),this.disposables.add(N_(this.contextKeyService,this.widget)),this.horizontalScrolling=o.horizontalScrolling,this.listSupportsMultiSelect=A_.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),O_.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this._useAltAsMultipleSelectionModifier=td(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(bh)&&(this._useAltAsMultipleSelectionModifier=td(l));let g={};if(f.affectsConfiguration(Ms)&&this.horizontalScrolling===void 0){let b=!!l.getValue(Ms);g={...g,horizontalScrolling:b}}if(f.affectsConfiguration(Ga)){let b=!!l.getValue(Ga);g={...g,scrollByPage:b}}if(f.affectsConfiguration(ja)){let b=!!l.getValue(ja);g={...g,smoothScrolling:b}}if(f.affectsConfiguration(Jl)){let b=l.getValue(Jl);g={...g,mouseWheelScrollSensitivity:b}}if(f.affectsConfiguration(ed)){let b=l.getValue(ed);g={...g,fastScrollSensitivity:b}}Object.keys(g).length>0&&this.updateOptions(g)})),this.navigator=new R_(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?CI(e):ff)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};I_=R([y(5,je),y(6,ss),y(7,He),y(8,ve)],I_);var C_=class extends GT{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,o,s,a,l,d,c){let u=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!d.getValue(Ms),[p,m]=c.invokeFunction(F_,s);super(e,t,i,n,o,{keyboardSupport:!1,...p,horizontalScrolling:u}),this.disposables.add(m),this.contextKeyService=P_(a,this),this.disposables.add(N_(this.contextKeyService,this)),this.listSupportsMultiSelect=A_.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),O_.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this.listHasSelectionOrFocus=CN.bindTo(this.contextKeyService),this.listDoubleSelection=SN.bindTo(this.contextKeyService),this.listMultiSelection=EN.bindTo(this.contextKeyService),this.horizontalScrolling=s.horizontalScrolling,this._useAltAsMultipleSelectionModifier=td(d),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(s.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let g=this.getSelection(),b=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(g.length>0||b.length>0),this.listMultiSelection.set(g.length>1),this.listDoubleSelection.set(g.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let g=this.getSelection(),b=this.getFocus();this.listHasSelectionOrFocus.set(g.length>0||b.length>0)})),this.disposables.add(d.onDidChangeConfiguration(g=>{g.affectsConfiguration(bh)&&(this._useAltAsMultipleSelectionModifier=td(d));let b={};if(g.affectsConfiguration(Ms)&&this.horizontalScrolling===void 0){let v=!!d.getValue(Ms);b={...b,horizontalScrolling:v}}if(g.affectsConfiguration(Ga)){let v=!!d.getValue(Ga);b={...b,scrollByPage:v}}if(g.affectsConfiguration(ja)){let v=!!d.getValue(ja);b={...b,smoothScrolling:v}}if(g.affectsConfiguration(Jl)){let v=d.getValue(Jl);b={...b,mouseWheelScrollSensitivity:v}}if(g.affectsConfiguration(ed)){let v=d.getValue(ed);b={...b,fastScrollSensitivity:v}}Object.keys(b).length>0&&this.updateOptions(b)})),this.navigator=new yN(this,{configurationService:d,...s}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?CI(e):ff)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};C_=R([y(6,je),y(7,ss),y(8,He),y(9,ve)],C_);var wI=class extends P{constructor(t,i){super();this.widget=t;this._register(z.filter(this.widget.onDidChangeSelection,n=>$s(n.browserEvent))(n=>this.onSelectionFromKeyboard(n))),this._register(this.widget.onPointer(n=>this.onPointer(n.element,n.browserEvent))),this._register(this.widget.onMouseDblClick(n=>this.onMouseDblClick(n.element,n.browserEvent))),typeof i?.openOnSingleClick!="boolean"&&i?.configurationService?(this.openOnSingleClick=i?.configurationService.getValue(x_)!=="doubleClick",this._register(i?.configurationService.onDidChangeConfiguration(n=>{n.affectsConfiguration(x_)&&(this.openOnSingleClick=i?.configurationService.getValue(x_)!=="doubleClick")}))):this.openOnSingleClick=i?.openOnSingleClick??!0}openOnSingleClick;_onDidOpen=this._register(new _);onDidOpen=this._onDidOpen.event;onSelectionFromKeyboard(t){if(t.elements.length!==1)return;let i=t.browserEvent,n=typeof i.preserveFocus=="boolean"?i.preserveFocus:!0,o=typeof i.pinned=="boolean"?i.pinned:!n;this._open(this.getSelectedElement(),n,o,!1,t.browserEvent)}onPointer(t,i){if(!this.openOnSingleClick||i.detail===2)return;let o=i.button===1,s=!0,a=o,l=i.ctrlKey||i.metaKey||i.altKey;this._open(t,s,a,l,i)}onMouseDblClick(t,i){if(!i)return;let n=i.target;if(n.classList.contains("monaco-tl-twistie")||n.classList.contains("monaco-icon-label")&&n.classList.contains("folder-icon")&&i.offsetX<16)return;let s=!1,a=!0,l=i.ctrlKey||i.metaKey||i.altKey;this._open(t,s,a,l,i)}_open(t,i,n,o,s){t&&this._onDidOpen.fire({editorOptions:{preserveFocus:i,pinned:n,revealIfVisible:!0},sideBySide:o,element:t,browserEvent:s})}},R_=class extends wI{widget;constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}},yN=class extends wI{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}},IN=class extends wI{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}};function tX(r){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;let i=r.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}var S_=class extends fh{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,o,s,a,l,d){let{options:c,getTypeNavigationMode:u,disposable:p}=s.invokeFunction(xI,o);super(e,t,i,n,c),this.disposables.add(p),this.internals=new oc(this,o,u,o.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};S_=R([y(5,ve),y(6,je),y(7,ss),y(8,He)],S_);var E_=class extends uf{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,o,s,a,l,d){let{options:c,getTypeNavigationMode:u,disposable:p}=s.invokeFunction(xI,o);super(e,t,i,n,c),this.disposables.add(p),this.internals=new oc(this,o,u,o.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};E_=R([y(5,ve),y(6,je),y(7,ss),y(8,He)],E_);var _u=class extends a_{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,o,s,a,l,d,c){let{options:u,getTypeNavigationMode:p,disposable:m}=a.invokeFunction(xI,s);super(e,t,i,n,o,u),this.disposables.add(m),this.internals=new oc(this,s,p,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};_u=R([y(6,ve),y(7,je),y(8,ss),y(9,He)],_u);var Du=class extends pf{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,o,s,a,l,d,c){let{options:u,getTypeNavigationMode:p,disposable:m}=a.invokeFunction(xI,s);super(e,t,i,n,o,u),this.disposables.add(m),this.internals=new oc(this,s,p,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};Du=R([y(6,ve),y(7,je),y(8,ss),y(9,He)],Du);var w_=class extends s_{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,o,s,a,l,d,c,u){let{options:p,getTypeNavigationMode:m,disposable:f}=l.invokeFunction(xI,a);super(e,t,i,n,o,s,p),this.disposables.add(f),this.internals=new oc(this,a,m,a.overrideStyles,d,c,u),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};w_=R([y(7,ve),y(8,je),y(9,ss),y(10,He)],w_);function g7(r){let e=r.getValue(wN);if(e==="highlight")return 0;if(e==="filter")return 1;let t=r.getValue(T_);if(t==="simple"||t==="highlight")return 0;if(t==="filter")return 1}function f7(r){let e=r.getValue(TN);if(e==="fuzzy")return 0;if(e==="contiguous")return 1}function xI(r,e){let t=r.get(He),i=r.get(iu),n=r.get(je),o=r.get(ve),s=()=>{let p=n.getContextKeyValue(h7);if(p==="automatic")return 0;if(p==="trigger")return 1;if(n.getContextKeyValue(m7)===!1)return 1;let f=t.getValue(xN);if(f==="automatic")return 0;if(f==="trigger")return 1},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(Ms),[l,d]=o.invokeFunction(F_,e),c=e.paddingBottom,u=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(__);return{getTypeNavigationMode:s,disposable:d,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(EI)=="number"?t.getValue(EI):void 0,renderIndentGuides:u,smoothScrolling:!!t.getValue(ja),defaultFindMode:g7(t),defaultFindMatchType:f7(t),horizontalScrolling:a,scrollByPage:!!t.getValue(Ga),paddingBottom:c,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(D_)==="doubleClick",contextViewProvider:i,findWidgetStyles:d7,enableStickyScroll:!!t.getValue(L_),stickyScrollMaxItemCount:Number(t.getValue(k_))}}}var oc=class{constructor(e,t,i,n,o,s,a){this.tree=e;this.contextKeyService=P_(o,e),this.disposables.push(N_(this.contextKeyService,e)),this.listSupportsMultiSelect=A_.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),O_.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=YZ.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=CN.bindTo(this.contextKeyService),this.hasDoubleSelection=SN.bindTo(this.contextKeyService),this.hasMultiSelection=EN.bindTo(this.contextKeyService),this.treeElementCanCollapse=ZZ.bindTo(this.contextKeyService),this.treeElementHasParent=XZ.bindTo(this.contextKeyService),this.treeElementCanExpand=QZ.bindTo(this.contextKeyService),this.treeElementHasChild=JZ.bindTo(this.contextKeyService),this.treeFindOpen=eX.bindTo(this.contextKeyService),this.treeStickyScrollFocused=p7.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=td(a),this.updateStyleOverrides(n);let d=()=>{let u=e.getFocus()[0];if(!u)return;let p=e.getNode(u);this.treeElementCanCollapse.set(p.collapsible&&!p.collapsed),this.treeElementHasParent.set(!!e.getParentElement(u)),this.treeElementCanExpand.set(p.collapsible&&p.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(u))},c=new Set;c.add(h7),c.add(m7),this.disposables.push(this.contextKeyService,s.register(e),e.onDidChangeSelection(()=>{let u=e.getSelection(),p=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(u.length>0||p.length>0),this.hasMultiSelection.set(u.length>1),this.hasDoubleSelection.set(u.length===2)})}),e.onDidChangeFocus(()=>{let u=e.getSelection(),p=e.getFocus();this.hasSelectionOrFocus.set(u.length>0||p.length>0),d()}),e.onDidChangeCollapseState(d),e.onDidChangeModel(d),e.onDidChangeFindOpenState(u=>this.treeFindOpen.set(u)),e.onDidChangeStickyScrollFocused(u=>this.treeStickyScrollFocused.set(u)),a.onDidChangeConfiguration(u=>{let p={};if(u.affectsConfiguration(bh)&&(this._useAltAsMultipleSelectionModifier=td(a)),u.affectsConfiguration(EI)){let m=a.getValue(EI);p={...p,indent:m}}if(u.affectsConfiguration(__)&&t.renderIndentGuides===void 0){let m=a.getValue(__);p={...p,renderIndentGuides:m}}if(u.affectsConfiguration(ja)){let m=!!a.getValue(ja);p={...p,smoothScrolling:m}}if(u.affectsConfiguration(wN)||u.affectsConfiguration(T_)){let m=g7(a);p={...p,defaultFindMode:m}}if(u.affectsConfiguration(xN)||u.affectsConfiguration(T_)){let m=i();p={...p,typeNavigationMode:m}}if(u.affectsConfiguration(TN)){let m=f7(a);p={...p,defaultFindMatchType:m}}if(u.affectsConfiguration(Ms)&&t.horizontalScrolling===void 0){let m=!!a.getValue(Ms);p={...p,horizontalScrolling:m}}if(u.affectsConfiguration(Ga)){let m=!!a.getValue(Ga);p={...p,scrollByPage:m}}if(u.affectsConfiguration(D_)&&t.expandOnlyOnTwistieClick===void 0&&(p={...p,expandOnlyOnTwistieClick:a.getValue(D_)==="doubleClick"}),u.affectsConfiguration(L_)){let m=a.getValue(L_);p={...p,enableStickyScroll:m}}if(u.affectsConfiguration(k_)){let m=Math.max(1,a.getValue(k_));p={...p,stickyScrollMaxItemCount:m}}if(u.affectsConfiguration(Jl)){let m=a.getValue(Jl);p={...p,mouseWheelScrollSensitivity:m}}if(u.affectsConfiguration(ed)){let m=a.getValue(ed);p={...p,fastScrollSensitivity:m}}Object.keys(p).length>0&&e.updateOptions(p)}),this.contextKeyService.onDidChangeContext(u=>{u.affectsSome(c)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new IN(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}contextKeyService;listSupportsMultiSelect;listSupportFindWidget;hasSelectionOrFocus;hasDoubleSelection;hasMultiSelection;treeElementCanCollapse;treeElementHasParent;treeElementCanExpand;treeElementHasChild;treeFindOpen;treeStickyScrollFocused;_useAltAsMultipleSelectionModifier;disposables=[];navigator;get onDidOpen(){return this.navigator.onDidOpen}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?CI(e):ff)}dispose(){this.disposables=ht(this.disposables)}};oc=R([y(4,je),y(5,ss),y(6,He)],oc);var iX=ze.as($r.Configuration);iX.registerConfiguration({id:"workbench",order:7,title:h("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[bh]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[h("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),h("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:h({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[x_]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:h({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Ms]:{type:"boolean",default:!1,description:h("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Ga]:{type:"boolean",default:!1,description:h("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[EI]:{type:"number",default:8,minimum:4,maximum:40,description:h("tree indent setting","Controls tree indentation in pixels.")},[__]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:h("render tree indent guides","Controls whether the tree should render indent guides.")},[ja]:{type:"boolean",default:!1,description:h("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[Jl]:{type:"number",default:1,markdownDescription:h("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[ed]:{type:"number",default:5,markdownDescription:h("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[wN]:{type:"string",enum:["highlight","filter"],enumDescriptions:[h("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),h("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:h("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[T_]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[h("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),h("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),h("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:h("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:h("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[TN]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[h("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),h("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:h("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[D_]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:h("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[L_]:{type:"boolean",default:!0,description:h("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[k_]:{type:"number",minimum:1,default:7,markdownDescription:h("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[xN]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:h("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});var qa=Z("openerService");function B_(r){let e,t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(r.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},r=r.with({fragment:""})),{selection:e,uri:r}}function _N(r){let e=r;return Array.isArray(e.items)}function b7(r){let e=r;return!!e.picks&&e.additionalPicks instanceof Promise}var V_=class extends P{constructor(t,i){super();this.prefix=t;this.options=i}provide(t,i,n){let o=new Y;t.canAcceptInBackground=!!this.options?.canAcceptInBackground,t.matchOnLabel=t.matchOnDescription=t.matchOnDetail=t.sortByLabel=!1;let s,a=o.add(new xt),l=async()=>{let c=a.value=new Y;s?.dispose(!0),t.busy=!1,s=new Vi(i);let u=s.token,p=t.value.substring(this.prefix.length);this.options?.shouldSkipTrimPickFilter||(p=p.trim());let m=this._getPicks(p,c,u,n),f=(b,v)=>{let I,w;if(_N(b)?(I=b.items,w=b.active):I=b,I.length===0){if(v)return!1;(p.length>0||t.hideInput)&&this.options?.noResultsPick&&(Sp(this.options.noResultsPick)?I=[this.options.noResultsPick(p)]:I=[this.options.noResultsPick])}return t.items=I,w&&(t.activeItems=[w]),!0},g=async b=>{let v=!1,I=!1;await Promise.all([(async()=>{typeof b.mergeDelay=="number"&&(await hn(b.mergeDelay),u.isCancellationRequested)||I||(v=f(b.picks,!0))})(),(async()=>{t.busy=!0;try{let w=await b.additionalPicks;if(u.isCancellationRequested)return;let E,S;_N(b.picks)?(E=b.picks.items,S=b.picks.active):E=b.picks;let T,D;if(_N(w)?(T=w.items,D=w.active):T=w,T.length>0||!v){let L;if(!S&&!D){let A=t.activeItems[0];A&&E.indexOf(A)!==-1&&(L=A)}f({items:[...E,...T],active:S||D||L})}}finally{u.isCancellationRequested||(t.busy=!1),I=!0}})()])};if(m!==null)if(b7(m))await g(m);else if(!(m instanceof Promise))f(m);else{t.busy=!0;try{let b=await m;if(u.isCancellationRequested)return;b7(b)?await g(b):f(b)}finally{u.isCancellationRequested||(t.busy=!1)}}};o.add(t.onDidChangeValue(()=>l())),l(),o.add(t.onDidAccept(c=>{if(n?.handleAccept){c.inBackground||t.hide(),n.handleAccept?.(t.activeItems[0]);return}let[u]=t.selectedItems;typeof u?.accept=="function"&&(c.inBackground||t.hide(),u.accept(t.keyMods,c))}));let d=async(c,u)=>{if(typeof u.trigger!="function")return;let p=u.buttons?.indexOf(c)??-1;if(p>=0){let m=u.trigger(p,t.keyMods),f=typeof m=="number"?m:await m;if(i.isCancellationRequested)return;switch(f){case 0:break;case 1:t.hide();break;case 2:l();break;case 3:{let g=t.items.indexOf(u);if(g!==-1){let b=t.items.slice(),v=b.splice(g,1),I=t.activeItems.filter(E=>E!==v[0]),w=t.keepScrollPosition;t.keepScrollPosition=!0,t.items=b,I&&(t.activeItems=I),t.keepScrollPosition=w}break}}}};return o.add(t.onDidTriggerItemButton(({button:c,item:u})=>d(c,u))),o.add(t.onDidTriggerSeparatorButton(({button:c,separator:u})=>d(c,u))),o}};var nX=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function H_(r,e,t,i,n){if(Ae.isThemeIcon(n))return[`codicon-${n.id}`,"predefined-file-icon"];if(X.isUri(n))return[];let o=i===2?["rootfolder-icon"]:i===1?["folder-icon"]:["file-icon"];if(t){let s;if(t.scheme===ue.data)s=Pd.parseMetaData(t).get(Pd.META_DATA_LABEL);else{let a=t.path.match(nX);a?(s=W_(a[2].toLowerCase()),a[1]&&o.push(`${W_(a[1].toLowerCase())}-name-dir-icon`)):s=W_(t.authority.toLowerCase())}if(i===2)o.push(`${s}-root-name-folder-icon`);else if(i===1)o.push(`${s}-name-folder-icon`);else{if(s){if(o.push(`${s}-name-file-icon`),o.push("name-file-icon"),s.length<=255){let l=s.split(".");for(let d=1;d<l.length;d++)o.push(`${l.slice(d).join(".")}-ext-file-icon`)}o.push("ext-file-icon")}let a=oX(r,e,t);a&&o.push(`${W_(a)}-lang-file-icon`)}}return o}function oX(r,e,t){if(!t)return null;let i=null;if(t.scheme===ue.data){let o=Pd.parseMetaData(t).get(Pd.META_DATA_MIME);o&&(i=e.getLanguageIdByMimeType(o))}else{let n=r.getModel(t);n&&(i=n.getLanguageId())}return i&&i!==xr?i:e.guessLanguageIdByFilepathOrFirstLine(t)}function W_(r){return r.replace(/[\s]/g,"/")}var vh=class extends V_{constructor(t,i,n,o,s){super(t,{canAcceptInBackground:!0,noResultsPick:{label:h("noViewResults","No matching editors"),groupId:-1}});this.editorGroupService=i;this.editorService=n;this.modelService=o;this.languageService=s}pickState=new class{scorerCache=Object.create(null);isQuickNavigating=void 0;reset(t){t||(this.scorerCache=Object.create(null)),this.isQuickNavigating=t}};provide(t,i){return this.pickState.reset(!!t.quickNavigate),super.provide(t,i)}_getPicks(t){let i=F8(t),n=this.doGetEditorPickItems().filter(s=>{if(!i.normalized)return!0;let a=vT(s,i,!0,mP,this.pickState.scorerCache);return a.score?(s.highlights={label:a.labelMatch,description:a.descriptionMatch},!0):!1});if(i.normalized){let s=this.editorGroupService.getGroups(2).map(a=>a.id);n.sort((a,l)=>a.groupId!==l.groupId?s.indexOf(a.groupId)-s.indexOf(l.groupId):N8(a,l,i,!0,mP,this.pickState.scorerCache))}let o=[];if(this.editorGroupService.count>1){let s;for(let a of n){if(typeof s!="number"||s!==a.groupId){let l=this.editorGroupService.getGroup(a.groupId);l&&o.push({type:"separator",label:l.label}),s=a.groupId}o.push(a)}}else o.push(...n);return o}doGetEditorPickItems(){let t=this.doGetEditors(),i=new Map;for(let{groupId:n}of t)if(!i.has(n)){let o=this.editorGroupService.getGroup(n);o&&i.set(n,o.ariaLabel)}return this.doGetEditors().map(({editor:n,groupId:o})=>{let s=Mt.getOriginalUri(n,{supportSideBySide:1}),a=n.isDirty()&&!n.isSaving(),l=n.getDescription(),d=l?`${n.getName()} ${l}`:n.getName();return{groupId:o,resource:s,label:n.getName(),ariaLabel:i.size>1?a?h("entryAriaLabelWithGroupDirty","{0}, unsaved changes, {1}",d,i.get(o)):h("entryAriaLabelWithGroup","{0}, {1}",d,i.get(o)):a?h("entryAriaLabelDirty","{0}, unsaved changes",d):d,description:l,iconClasses:H_(this.modelService,this.languageService,s,void 0,n.getIcon()).concat(n.getLabelExtraClasses()),italic:!this.editorGroupService.getGroup(o)?.isPinned(n),buttons:[{iconClass:a?"dirty-editor "+Ae.asClassName(ie.closeDirty):Ae.asClassName(ie.close),tooltip:h("closeEditor","Close Editor"),alwaysVisible:a}],trigger:async()=>{let c=this.editorGroupService.getGroup(o);return c&&(await c.closeEditor(n,{preserveFocus:!0}),!c.contains(n))?3:0},accept:(c,u)=>this.editorGroupService.getGroup(o)?.openEditor(n,{preserveFocus:u.inBackground})}})}};vh=R([y(1,Ri),y(2,vt),y(3,Qn),y(4,Ki)],vh);var Lu=class extends vh{static PREFIX="edt active ";constructor(e,t,i,n){super(Lu.PREFIX,e,t,i,n)}doGetEditors(){let e=this.editorGroupService.activeGroup;return e.getEditors(0).map(t=>({editor:t,groupId:e.id}))}};Lu=R([y(0,Ri),y(1,vt),y(2,Qn),y(3,Ki)],Lu);var yh=class extends vh{static PREFIX="edt ";constructor(e,t,i,n){super(yh.PREFIX,e,t,i,n)}doGetEditors(){let e=[];for(let t of this.editorGroupService.getGroups(2))for(let i of t.getEditors(1))e.push({editor:i,groupId:t.id});return e}};yh=R([y(0,Ri),y(1,vt),y(2,Qn),y(3,Ki)],yh);var Ih=class extends vh{static PREFIX="edt mru ";constructor(e,t,i,n){super(Ih.PREFIX,e,t,i,n)}doGetEditors(){let e=[];for(let t of this.editorService.getEditors(0))e.push(t);return e}};Ih=R([y(0,Ri),y(1,vt),y(2,Qn),y(3,Ki)],Ih);var rX="__$__isNewStorageMarker",U_="__$__targetStorageMarker",Ii=Z("storageService");function sX(r){let e=r.get(U_);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}var v7=class r extends P{constructor(t={flushInterval:r.DEFAULT_FLUSH_INTERVAL}){super();this.options=t}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new fp);_onDidChangeTarget=this._register(new fp);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new _);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new Kt(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new xt);onDidChangeValue(t,i,n){return z.filter(this._onDidChangeValue.event,o=>o.scope===t&&(i===void 0||o.key===i),n)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Bc(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){ht([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{En("code/willInitStorage");try{await this.doInitialize()}finally{En("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(t,i){let{key:n,external:o}=i;if(n===U_){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:n,target:this.getKeyTargets(t)[n],external:o})}emitWillSaveState(t){this._onWillSaveState.fire({reason:t})}get(t,i,n){return this.getStorage(i)?.get(t,n)}getBoolean(t,i,n){return this.getStorage(i)?.getBoolean(t,n)}getNumber(t,i,n){return this.getStorage(i)?.getNumber(t,n)}getObject(t,i,n){return this.getStorage(i)?.getObject(t,n)}storeAll(t,i){this.withPausedEmitters(()=>{for(let n of t)this.store(n.key,n.value,n.scope,n.target,i)})}store(t,i,n,o,s=!1){if(ao(i)){this.remove(t,n,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(t,n,o),this.getStorage(n)?.set(t,i,s)})}remove(t,i,n=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(t,i,void 0),this.getStorage(i)?.delete(t,n)})}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(t,i){let n=[],o=this.getKeyTargets(t);for(let s of Object.keys(o))o[s]===i&&n.push(s);return n}updateKeyTarget(t,i,n,o=!1){let s=this.getKeyTargets(i);typeof n=="number"?s[t]!==n&&(s[t]=n,this.getStorage(i)?.set(U_,JSON.stringify(s),o)):typeof s[t]=="number"&&(delete s[t],this.getStorage(i)?.set(U_,JSON.stringify(s),o))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){let i=this.getStorage(t);return i?sX(i):Object.create(null)}isNew(t){return this.getBoolean(rX,t)===!0}async flush(t=0){this._onWillSaveState.fire({reason:t});let i=this.getStorage(-1),n=this.getStorage(0),o=this.getStorage(1);switch(t){case 0:await Rn.settled([i?.whenFlushed()??Promise.resolve(),n?.whenFlushed()??Promise.resolve(),o?.whenFlushed()??Promise.resolve()]);break;case 1:await Rn.settled([i?.flush(0)??Promise.resolve(),n?.flush(0)??Promise.resolve(),o?.flush(0)??Promise.resolve()]);break}}async log(){let t=this.getStorage(-1)?.items??new Map,i=this.getStorage(0)?.items??new Map,n=this.getStorage(1)?.items??new Map;return aX(t,i,n,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(t){return await this.flush(),this.getStorage(t)?.optimize()}async switch(t,i){return this.emitWillSaveState(0),f8(t)?this.switchToProfile(t,i):this.switchToWorkspace(t,i)}canSwitchProfile(t,i){return!(t.id===i.id||y7(i)&&y7(t))}switchData(t,i,n){this.withPausedEmitters(()=>{let o=new Set;for(let[s,a]of t)o.add(s),i.get(s)!==a&&this.emitDidChangeValue(n,{key:s,external:!0});for(let[s]of i.items)o.has(s)||this.emitDidChangeValue(n,{key:s,external:!0})})}};function y7(r){return r.isDefault||!!r.useDefaultFlags?.globalState}async function aX(r,e,t,i,n,o){let s=g=>{try{return JSON.parse(g)}catch{return g}},a=new Map,l=new Map;r.forEach((g,b)=>{a.set(b,g),l.set(b,s(g))});let d=new Map,c=new Map;e.forEach((g,b)=>{d.set(b,g),c.set(b,s(g))});let u=new Map,p=new Map;t.forEach((g,b)=>{u.set(b,g),p.set(b,s(g))}),console.group(i!==n?`Storage: Application (path: ${i})`:`Storage: Application & Profile (path: ${i}, default profile)`);let m=[];if(a.forEach((g,b)=>{m.push({key:b,value:g})}),console.table(m),console.groupEnd(),console.log(l),i!==n){console.group(`Storage: Profile (path: ${n}, profile specific)`);let g=[];d.forEach((b,v)=>{g.push({key:v,value:b})}),console.table(g),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${o})`);let f=[];u.forEach((g,b)=>{f.push({key:b,value:g})}),console.table(f),console.groupEnd(),console.log(p)}var z_=class r{constructor(e,t){this.storageService=t;this.id=r.COMMON_PREFIX+e}static applicationMementos=new Map;static profileMementos=new Map;static workspaceMementos=new Map;static COMMON_PREFIX="memento/";id;getMemento(e,t){switch(e){case 1:{let i=r.workspaceMementos.get(this.id);return i||(i=new _I(this.id,e,t,this.storageService),r.workspaceMementos.set(this.id,i)),i.getMemento()}case 0:{let i=r.profileMementos.get(this.id);return i||(i=new _I(this.id,e,t,this.storageService),r.profileMementos.set(this.id,i)),i.getMemento()}case-1:{let i=r.applicationMementos.get(this.id);return i||(i=new _I(this.id,e,t,this.storageService),r.applicationMementos.set(this.id,i)),i.getMemento()}}}onDidChangeValue(e,t){return this.storageService.onDidChangeValue(e,this.id,t)}saveMemento(){r.workspaceMementos.get(this.id)?.save(),r.profileMementos.get(this.id)?.save(),r.applicationMementos.get(this.id)?.save()}reloadMemento(e){let t;switch(e){case-1:t=r.applicationMementos.get(this.id);break;case 0:t=r.profileMementos.get(this.id);break;case 1:t=r.workspaceMementos.get(this.id);break}t?.reload()}static clear(e){switch(e){case 1:r.workspaceMementos.clear();break;case 0:r.profileMementos.clear();break;case-1:r.applicationMementos.clear();break}}},_I=class{constructor(e,t,i,n){this.id=e;this.scope=t;this.target=i;this.storageService=n;this.mementoObj=this.doLoad()}mementoObj;doLoad(){try{return this.storageService.getObject(this.id,this.scope,{})}catch(e){Ge(`[memento]: failed to parse contents: ${e} (id: ${this.id}, scope: ${this.scope}, contents: ${this.storageService.get(this.id,this.scope)})`)}return{}}getMemento(){return this.mementoObj}reload(){for(let e of Object.getOwnPropertyNames(this.mementoObj))delete this.mementoObj[e];Object.assign(this.mementoObj,this.doLoad())}save(){Cp(this.mementoObj)?this.storageService.remove(this.id,this.scope):this.storageService.store(this.id,this.mementoObj,this.scope,this.target)}};var Sh=class extends ta{constructor(t,i,n){super(i);this.id=t;this.memento=new z_(this.id,n),this._register(n.onWillSaveState(()=>{this.saveState(),this.memento.saveMemento()}))}memento;getId(){return this.id}getMemento(t,i){return this.memento.getMemento(t,i)}reloadMemento(t){return this.memento.reloadMemento(t)}onDidChangeMementoValue(t,i){return this.memento.onDidChangeValue(t,i)}saveState(){}};var vf=class extends Sh{constructor(t,i,n,o){super(t,n,o);this.telemetryService=i}_onTitleAreaUpdate=this._register(new _);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidFocus;get onDidFocus(){return this._onDidFocus||(this._onDidFocus=this.registerFocusTrackEvents().onDidFocus),this._onDidFocus.event}_onDidBlur;get onDidBlur(){return this._onDidBlur||(this._onDidBlur=this.registerFocusTrackEvents().onDidBlur),this._onDidBlur.event}_hasFocus=!1;hasFocus(){return this._hasFocus}registerFocusTrackEvents(){let t=at(this.getContainer()),i=this._register(Mn(t)),n=this._onDidFocus=this._register(new _);this._register(i.onDidFocus(()=>{this._hasFocus=!0,n.fire()}));let o=this._onDidBlur=this._register(new _);return this._register(i.onDidBlur(()=>{this._hasFocus=!1,o.fire()})),{onDidFocus:n,onDidBlur:o}}actionRunner;visible=!1;parent;getTitle(){}create(t){this.parent=t}getContainer(){return this.parent}setVisible(t){this.visible!==!!t&&(this.visible=t)}focus(){}getMenuIds(){return[]}getActions(){return[]}getSecondaryActions(){return[]}getContextMenuActions(){return[]}getActionViewItem(t,i){}getActionsContext(){return null}getActionRunner(){return this.actionRunner||(this.actionRunner=this._register(new lo)),this.actionRunner}updateTitleArea(){this._onTitleAreaUpdate.fire()}isVisible(){return this.visible}getControl(){}};var K_=class extends P{_onDidRegister=this._register(new _);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new _);onDidDeregister=this._onDidDeregister.event;composites=[];registerComposite(e){this.compositeById(e.id)||(this.composites.push(e),this._onDidRegister.fire(e))}deregisterComposite(e){let t=this.compositeById(e);t&&(this.composites.splice(this.composites.indexOf(t),1),this._onDidDeregister.fire(t))}getComposite(e){return this.compositeById(e)}getComposites(){return this.composites.slice(0)}compositeById(e){return this.composites.find(t=>t.id===e)}};var FIt={separatorBorder:U.transparent};var dX;(n=>{n.Distribute={type:"distribute"},n.Split={type:"split"},n.Auto={type:"auto"};function i(o){return{type:"invisible",cachedVisibleSize:o}}n.Invisible=i})(dX||={});async function C7(r){let e=navigator.usb;if(!e)return;let t=await e.requestDevice({filters:r?.filters??[]});if(t)return{deviceClass:t.deviceClass,deviceProtocol:t.deviceProtocol,deviceSubclass:t.deviceSubclass,deviceVersionMajor:t.deviceVersionMajor,deviceVersionMinor:t.deviceVersionMinor,deviceVersionSubminor:t.deviceVersionSubminor,manufacturerName:t.manufacturerName,productId:t.productId,productName:t.productName,serialNumber:t.serialNumber,usbVersionMajor:t.usbVersionMajor,usbVersionMinor:t.usbVersionMinor,usbVersionSubminor:t.usbVersionSubminor,vendorId:t.vendorId}}async function S7(r){let e=navigator.serial;if(!e)return;let t=await e.requestPort({filters:r?.filters??[]});if(!t)return;let i=t.getInfo();return{usbVendorId:i.usbVendorId,usbProductId:i.usbProductId}}async function E7(r){let e=navigator.hid;if(!e)return;let t=await e.requestDevice({filters:r?.filters??[]});if(!t.length)return;let i=t[0];return{opened:i.opened,vendorId:i.vendorId,productId:i.productId,productName:i.productName,collections:i.collections}}var Eh=Ts;var cX=60,uX=cX*60,DN=uX*24,fCt=DN*7,bCt=DN*30,vCt=DN*365;function w7(r){return r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")+"."+(r.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var DI=/^([^.]+\..+)[:=](.+)$/,ui=class{constructor(e,t,i){this._args=e;this.paths=t;this.productService=i}get appRoot(){return yS(Hr.asFileUri("").fsPath)}get userHome(){return X.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return X.file(fr(this.userDataPath,"User"))}get tmpDir(){return X.file(this.paths.tmpDir)}get cacheHome(){return X.file(this.userDataPath)}get stateResource(){return It(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:ue.vscodeUserData})}get userDataSyncHome(){return It(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let e=w7(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=fr(this.userDataPath,"logs",e)}return X.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return It(X.file(fr(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return It(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return It(this.appSettingsHome,"History")}get keyboardLayoutResource(){return It(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let e=Ks.VSCODE_PORTABLE;return e?X.file(fr(e,"argv.json")):It(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return X.file(fr(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let e=this.args["builtin-extensions-dir"];return e?dm(e):ml(fr(Hr.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let e=this.args["extensions-download-dir"];return e?X.file(dm(e)):X.file(fr(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let e=this.args["extensions-dir"];if(e)return dm(e);let t=Ks.VSCODE_EXTENSIONS;if(t)return t;let i=Ks.VSCODE_PORTABLE;return i?fr(i,"extensions"):It(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let e=this.args.extensionDevelopmentPath;if(Array.isArray(e))return e.map(t=>/^[^:/?#]+?:\/\//.test(t)?X.parse(t):X.file(ml(t)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(e=>e==="ui"||e==="workspace"||e==="web"?e:"workspace")}get extensionTestsLocationURI(){let e=this.args.extensionTestsPath;if(e)return/^[^:/?#]+?:\/\//.test(e)?X.parse(e):X.file(ml(e))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let e=this.args["disable-extension"];if(e){if(typeof e=="string")return[e];if(Array.isArray(e)&&e.length>0)return e}return!1}get debugExtensionHost(){return pX(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!Ks.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(e=>!DI.test(e))}get extensionLogLevel(){let e=[];for(let t of this.args.log||[]){let i=DI.exec(t);i&&i[1]&&i[2]&&e.push([i[1],i[2]])}return e.length?e:void 0}get serviceMachineIdResource(){return It(X.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let e=Ks.VSCODE_PORTABLE;return e?X.file(fr(e,"policy.json")):It(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(e){this.args.continueOn=e}get args(){return this._args}};R([me],ui.prototype,"appRoot",1),R([me],ui.prototype,"userHome",1),R([me],ui.prototype,"userDataPath",1),R([me],ui.prototype,"appSettingsHome",1),R([me],ui.prototype,"tmpDir",1),R([me],ui.prototype,"cacheHome",1),R([me],ui.prototype,"stateResource",1),R([me],ui.prototype,"userRoamingDataHome",1),R([me],ui.prototype,"userDataSyncHome",1),R([me],ui.prototype,"sync",1),R([me],ui.prototype,"machineSettingsResource",1),R([me],ui.prototype,"workspaceStorageHome",1),R([me],ui.prototype,"localHistoryHome",1),R([me],ui.prototype,"keyboardLayoutResource",1),R([me],ui.prototype,"argvResource",1),R([me],ui.prototype,"isExtensionDevelopment",1),R([me],ui.prototype,"untitledWorkspacesHome",1),R([me],ui.prototype,"builtinExtensionsPath",1),R([me],ui.prototype,"extensionsPath",1),R([me],ui.prototype,"extensionDevelopmentLocationURI",1),R([me],ui.prototype,"extensionDevelopmentKind",1),R([me],ui.prototype,"extensionTestsLocationURI",1),R([me],ui.prototype,"debugExtensionHost",1),R([me],ui.prototype,"logLevel",1),R([me],ui.prototype,"extensionLogLevel",1),R([me],ui.prototype,"serviceMachineIdResource",1),R([me],ui.prototype,"disableTelemetry",1),R([me],ui.prototype,"disableWorkspaceTrust",1),R([me],ui.prototype,"useInMemorySecretStorage",1),R([me],ui.prototype,"policyFile",1);function pX(r,e){return hX(r["inspect-extensions"],r["inspect-brk-extensions"],5870,e,r.debugId,r.extensionEnvironment)}function hX(r,e,t,i,n,o){let a=Number(e||r)||(i?null:t),l=a?!!e:!1,d;if(o)try{d=JSON.parse(o)}catch{}return{port:a,break:l,debugId:n,env:d}}var x7=Ts,Ot=class{constructor(e,t,i,n){this.workspaceId=e;this.logsHome=t;this.options=i;this.productService=n;if(i.workspaceProvider&&Array.isArray(i.workspaceProvider.payload))try{this.payload=new Map(i.workspaceProvider.payload)}catch(o){Ge(o)}}get remoteAuthority(){return this.options.remoteAuthority}get expectsResolverExtension(){return!!this.options.remoteAuthority?.includes("+")&&!this.options.webSocketFactory}get isBuilt(){return!!this.productService.commit}get logLevel(){let e=this.payload?.get("logLevel");return e?e.split(",").find(t=>!DI.test(t)):this.options.developmentOptions?.logLevel!==void 0?rT(this.options.developmentOptions?.logLevel):void 0}get extensionLogLevel(){let e=this.payload?.get("logLevel");if(e){let t=[];for(let i of e.split(",")){let n=DI.exec(i);n&&n[1]&&n[2]&&t.push([n[1],n[2]])}return t.length?t:void 0}return this.options.developmentOptions?.extensionLogLevel!==void 0?this.options.developmentOptions?.extensionLogLevel.map(([t,i])=>[t,rT(i)]):void 0}get profDurationMarkers(){let e=this.payload?.get("profDurationMarkers");if(e){let t=[];for(let i of e.split(","))t.push(i);return t.length===2?t:void 0}}get windowLogsPath(){return this.logsHome}get logFile(){return It(this.windowLogsPath,"window.log")}get userRoamingDataHome(){return X.file("/User").with({scheme:ue.vscodeUserData})}get argvResource(){return It(this.userRoamingDataHome,"argv.json")}get cacheHome(){return It(this.userRoamingDataHome,"caches")}get workspaceStorageHome(){return It(this.userRoamingDataHome,"workspaceStorage")}get localHistoryHome(){return It(this.userRoamingDataHome,"History")}get stateResource(){return It(this.userRoamingDataHome,"State","storage.json")}get userDataSyncHome(){return It(this.userRoamingDataHome,"sync",this.workspaceId)}get sync(){}get keyboardLayoutResource(){return It(this.userRoamingDataHome,"keyboardLayout.json")}get untitledWorkspacesHome(){return It(this.userRoamingDataHome,"Workspaces")}get serviceMachineIdResource(){return It(this.userRoamingDataHome,"machineid")}get extHostLogsPath(){return It(this.logsHome,"exthost")}get extHostTelemetryLogFile(){return It(this.extHostLogsPath,"extensionTelemetry.log")}extensionHostDebugEnvironment=void 0;get debugExtensionHost(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.params}get isExtensionDevelopment(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.isExtensionDevelopment}get extensionDevelopmentLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentLocationURI}get extensionDevelopmentLocationKind(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentKind}get extensionTestsLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionTestsLocationURI}get extensionEnabledProposedApi(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionEnabledProposedApi}get debugRenderer(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.debugRenderer}get enableSmokeTestDriver(){return this.options.developmentOptions?.enableSmokeTestDriver}get disableExtensions(){return this.payload?.get("disableExtensions")==="true"}get enableExtensions(){return this.options.enabledExtensions}get webviewExternalEndpoint(){let e=this.options.webviewEndpoint||this.productService.webviewContentExternalBaseUrlTemplate||"https://{{uuid}}.vscode-cdn.net/{{quality}}/{{commit}}/out/vs/workbench/contrib/webview/browser/pre/",t=this.payload?.get("webviewExternalEndpointCommit");return e.replace("{{commit}}",t??this.productService.commit??"ef65ac1ba57f57f2a3961bfe94aa20481caca4c6").replace("{{quality}}",(t?"insider":this.productService.quality)??"insider")}get extensionTelemetryLogResource(){return It(this.logsHome,"extensionTelemetry.log")}get disableTelemetry(){return!1}get verbose(){return this.payload?.get("verbose")==="true"}get logExtensionHostCommunication(){return this.payload?.get("logExtensionHostCommunication")==="true"}get skipReleaseNotes(){return this.payload?.get("skipReleaseNotes")==="true"}get skipWelcome(){return this.payload?.get("skipWelcome")==="true"}get disableWorkspaceTrust(){return!this.options.enableWorkspaceTrust}get profile(){return this.payload?.get("profile")}editSessionId=this.options.editSessionId;payload;resolveExtensionHostDebugEnvironment(){let e={params:{port:null,break:!1},debugRenderer:!1,isExtensionDevelopment:!1,extensionDevelopmentLocationURI:void 0,extensionDevelopmentKind:void 0};if(this.payload)for(let[i,n]of this.payload)switch(i){case"extensionDevelopmentPath":e.extensionDevelopmentLocationURI||(e.extensionDevelopmentLocationURI=[]),e.extensionDevelopmentLocationURI.push(X.parse(n)),e.isExtensionDevelopment=!0;break;case"extensionDevelopmentKind":e.extensionDevelopmentKind=[n];break;case"extensionTestsPath":e.extensionTestsLocationURI=X.parse(n);break;case"debugRenderer":e.debugRenderer=n==="true";break;case"debugId":e.params.debugId=n;break;case"inspect-brk-extensions":e.params.port=parseInt(n),e.params.break=!0;break;case"inspect-extensions":e.params.port=parseInt(n);break;case"enableProposedApi":e.extensionEnabledProposedApi=[];break}let t=this.options.developmentOptions;return t&&!e.isExtensionDevelopment&&(t.extensions?.length&&(e.extensionDevelopmentLocationURI=t.extensions.map(i=>X.revive(i)),e.isExtensionDevelopment=!0),t.extensionTestsPath&&(e.extensionTestsLocationURI=X.revive(t.extensionTestsPath))),e}get filesToOpenOrCreate(){if(this.payload){let e=this.payload.get("openFile");if(e){let t=X.parse(e);if(this.payload.has("gotoLineMode")){let i=s2(t.path);return[{fileUri:t.with({path:i.path}),options:{selection:kn(i.line)?void 0:{startLineNumber:i.line,startColumn:i.column||1}}}]}return[{fileUri:t}]}}}get filesToDiff(){if(this.payload){let e=this.payload.get("diffFilePrimary"),t=this.payload.get("diffFileSecondary");if(e&&t)return[{fileUri:X.parse(t)},{fileUri:X.parse(e)}]}}get filesToMerge(){if(this.payload){let e=this.payload.get("mergeFile1"),t=this.payload.get("mergeFile2"),i=this.payload.get("mergeFileBase"),n=this.payload.get("mergeFileResult");if(e&&t&&i&&n)return[{fileUri:X.parse(e)},{fileUri:X.parse(t)},{fileUri:X.parse(i)},{fileUri:X.parse(n)}]}}};R([me],Ot.prototype,"remoteAuthority",1),R([me],Ot.prototype,"expectsResolverExtension",1),R([me],Ot.prototype,"isBuilt",1),R([me],Ot.prototype,"logLevel",1),R([me],Ot.prototype,"windowLogsPath",1),R([me],Ot.prototype,"logFile",1),R([me],Ot.prototype,"userRoamingDataHome",1),R([me],Ot.prototype,"argvResource",1),R([me],Ot.prototype,"cacheHome",1),R([me],Ot.prototype,"workspaceStorageHome",1),R([me],Ot.prototype,"localHistoryHome",1),R([me],Ot.prototype,"stateResource",1),R([me],Ot.prototype,"userDataSyncHome",1),R([me],Ot.prototype,"sync",1),R([me],Ot.prototype,"keyboardLayoutResource",1),R([me],Ot.prototype,"untitledWorkspacesHome",1),R([me],Ot.prototype,"serviceMachineIdResource",1),R([me],Ot.prototype,"extHostLogsPath",1),R([me],Ot.prototype,"extHostTelemetryLogFile",1),R([me],Ot.prototype,"debugExtensionHost",1),R([me],Ot.prototype,"isExtensionDevelopment",1),R([me],Ot.prototype,"extensionDevelopmentLocationURI",1),R([me],Ot.prototype,"extensionDevelopmentLocationKind",1),R([me],Ot.prototype,"extensionTestsLocationURI",1),R([me],Ot.prototype,"extensionEnabledProposedApi",1),R([me],Ot.prototype,"debugRenderer",1),R([me],Ot.prototype,"enableSmokeTestDriver",1),R([me],Ot.prototype,"disableExtensions",1),R([me],Ot.prototype,"enableExtensions",1),R([me],Ot.prototype,"webviewExternalEndpoint",1),R([me],Ot.prototype,"extensionTelemetryLogResource",1),R([me],Ot.prototype,"disableTelemetry",1),R([me],Ot.prototype,"verbose",1),R([me],Ot.prototype,"logExtensionHostCommunication",1),R([me],Ot.prototype,"skipReleaseNotes",1),R([me],Ot.prototype,"skipWelcome",1),R([me],Ot.prototype,"disableWorkspaceTrust",1),R([me],Ot.prototype,"profile",1),R([me],Ot.prototype,"filesToOpenOrCreate",1),R([me],Ot.prototype,"filesToDiff",1),R([me],Ot.prototype,"filesToMerge",1);var T7=Z("layoutService");var $a=T7;function _7(r){return r===2||r===3}function G_(r){switch(r){case 0:return"left";case 1:return"right";case 2:return"bottom";case 3:return"top";default:return"bottom"}}var lEt={[G_(0)]:0,[G_(1)]:1,[G_(2)]:2,[G_(3)]:3};function LN(r){switch(r){case 0:return"always";case 1:return"never";case 2:return"preserve";default:return"preserve"}}var dEt={[LN(0)]:0,[LN(1)]:1,[LN(2)]:2};var id=Z("lifecycleService");function D7(r){switch(r){case 1:return"Starting";case 2:return"Ready";case 3:return"Restored";case 4:return"Eventually"}}var nd=class extends P{constructor(t,i){super();this.logService=t;this.storageService=i;this._startupKind=this.resolveStartupKind(),this._register(this.storageService.onWillSaveState(n=>{n.reason===1&&this.storageService.store(nd.LAST_SHUTDOWN_REASON_KEY,this.shutdownReason,1,1)}))}static LAST_SHUTDOWN_REASON_KEY="lifecyle.lastShutdownReason";_onBeforeShutdown=this._register(new _);onBeforeShutdown=this._onBeforeShutdown.event;_onWillShutdown=this._register(new _);onWillShutdown=this._onWillShutdown.event;_onDidShutdown=this._register(new _);onDidShutdown=this._onDidShutdown.event;_onBeforeShutdownError=this._register(new _);onBeforeShutdownError=this._onBeforeShutdownError.event;_onShutdownVeto=this._register(new _);onShutdownVeto=this._onShutdownVeto.event;_startupKind;get startupKind(){return this._startupKind}_phase=1;get phase(){return this._phase}phaseWhen=new Map;shutdownReason;resolveStartupKind(){let t=this.doResolveStartupKind()??1;return this.logService.trace(`[lifecycle] starting up (startup kind: ${t})`),t}doResolveStartupKind(){let t=this.storageService.getNumber(nd.LAST_SHUTDOWN_REASON_KEY,1);this.storageService.remove(nd.LAST_SHUTDOWN_REASON_KEY,1);let i;switch(t){case 3:i=3;break;case 4:i=4;break}return i}set phase(t){if(t<this.phase)throw new Error("Lifecycle cannot go backwards");if(this._phase===t)return;this.logService.trace(`lifecycle: phase changed (value: ${t})`),this._phase=t,En(`code/LifecyclePhase/${D7(t)}`);let i=this.phaseWhen.get(this._phase);i&&(i.open(),this.phaseWhen.delete(this._phase))}async when(t){if(t<=this._phase)return;let i=this.phaseWhen.get(t);i||(i=new wm,this.phaseWhen.set(t,i)),await i.wait()}};nd=R([y(0,Oi),y(1,Ii)],nd);var kI=class extends nd{beforeUnloadListener=void 0;unloadListener=void 0;ignoreBeforeUnload=!1;didUnload=!1;constructor(e,t){super(e,t),this.registerListeners()}registerListeners(){this.beforeUnloadListener=B(Re,Q.BEFORE_UNLOAD,e=>this.onBeforeUnload(e)),this.unloadListener=B(Re,Q.PAGE_HIDE,()=>this.onUnload())}onBeforeUnload(e){this.ignoreBeforeUnload?(this.logService.info("[lifecycle] onBeforeUnload triggered but ignored once"),this.ignoreBeforeUnload=!1):(this.logService.info("[lifecycle] onBeforeUnload triggered and handled with veto support"),this.doShutdown(()=>this.vetoBeforeUnload(e)))}vetoBeforeUnload(e){e.preventDefault(),e.returnValue=h("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}withExpectedShutdown(e,t){if(typeof e=="number")return this.shutdownReason=e,this.storageService.flush(1);this.ignoreBeforeUnload=!0;try{t?.()}finally{this.ignoreBeforeUnload=!1}}async shutdown(){this.logService.info("[lifecycle] shutdown triggered"),this.beforeUnloadListener?.dispose(),this.unloadListener?.dispose(),await this.storageService.flush(1),this.doShutdown()}doShutdown(e){let t=this.logService;this.storageService.flush(1);let i=!1;function n(o,s){typeof e=="function"&&(o instanceof Promise&&(t.error(`[lifecycle] Long running operations before shutdown are unsupported in the web (id: ${s})`),i=!0),o===!0&&(t.info(`[lifecycle]: Unload was prevented (id: ${s})`),i=!0))}return this._onBeforeShutdown.fire({reason:2,veto(o,s){n(o,s)},finalVeto(o,s){n(o(),s)}}),i&&typeof e=="function"?e():this.onUnload()}onUnload(){if(this.didUnload)return;this.didUnload=!0,this._register(B(Re,Q.PAGE_SHOW,t=>this.onLoadAfterUnload(t)));let e=this.logService;this._onWillShutdown.fire({reason:2,joiners:()=>[],token:pn.None,join(t,i){e.error(`[lifecycle] Long running operations during shutdown are unsupported in the web (id: ${i.id})`)},force:()=>{}}),this._onDidShutdown.fire()}onLoadAfterUnload(e){e.persisted&&this.withExpectedShutdown({disableShutdownHandling:!0},()=>Re.location.reload())}doResolveStartupKind(){let e=super.doResolveStartupKind();return typeof e!="number"&&performance.getEntriesByType("navigation").at(0)?.type==="reload"&&(e=3),e}};kI=R([y(0,Oi),y(1,Ii)],kI);an(id,kI,0);var fX=h("open","open"),bX=h("close","close"),vX=h("find","find"),j_={open:fX,close:bX,find:vX};async function R7(r,e){let t=[];return await A7(r,t,e.logsHome,e.logsHome),t}async function A7(r,e,t,i){let n=await r.resolve(t);for(let{resource:o,isDirectory:s}of n.children||[])if(s)await A7(r,e,o,i);else{let a=(await r.readFile(o)).value.toString();if(a){let l=jS(i,o);l&&e.push({relativePath:l,contents:a})}}}var M7=Z("editorPaneService");var q_;(e=>e.Workbench="workbench.contributions.kind")(q_||={});var wh=(n=>(n[n.BlockStartup=1]="BlockStartup",n[n.BlockRestore=2]="BlockRestore",n[n.AfterRestored=3]="AfterRestored",n[n.Eventually=4]="Eventually",n))(wh||{});function O7(r){let e=r;return!!e&&typeof e.editorTypeId=="string"}function yX(r){switch(r){case 3:return wh.AfterRestored;case 4:return wh.Eventually}}function P7(r){switch(r){case wh.BlockStartup:return 1;case wh.BlockRestore:return 2;case wh.AfterRestored:return 3;case wh.Eventually:return 4}}var xh=class r extends P{static INSTANCE=new r;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new Y);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new ys;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(e,t,i){let n={id:e,ctor:t};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof i=="number"&&this.lifecycleService.phase>=i||typeof e=="string"&&O7(i)&&this.editorPaneService.didInstantiateEditorPane(i.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,n,typeof i=="number"?P7(i):this.lifecycleService.phase):(typeof i=="number"&&Td(this.contributionsByPhase,P7(i),[]).push(n),typeof e=="string"&&(this.contributionsById.has(e)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${e}'`):this.contributionsById.set(e,n),O7(i)&&Td(this.contributionsByEditor,i.editorTypeId,[]).push(n)))}registerWorkbenchContribution(e,t){this.registerWorkbenchContribution2(void 0,e,yX(t))}getWorkbenchContribution(e){if(this.instancesById.has(e))return this.instancesById.get(e);let t=this.instantiationService,i=this.lifecycleService,n=this.logService,o=this.environmentService;if(!t||!i||!n||!o)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): cannot be called before registry started`);let s=this.contributionsById.get(e);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution with that identifier is unknown.`);i.phase<3&&n.warn(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(t,n,o,s,i.phase);let a=this.instancesById.get(e);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): failed to create contribution.`);return a}start(e){let t=this.instantiationService=e.get(ve),i=this.lifecycleService=e.get(id),n=this.logService=e.get(Oi),o=this.environmentService=e.get(Ts),s=this.editorPaneService=e.get(M7);this._register(i.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(t,i,n,o,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,t,i,n,o);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,t,i,n,o)))}onEditor(e,t,i,n,o){let s=this.contributionsByEditor.get(e);if(s){this.contributionsByEditor.delete(e);for(let a of s)this.safeCreateContribution(t,n,o,a,i.phase)}}instantiateByPhase(e,t,i,n,o){t.phase>=o?this.doInstantiateByPhase(e,i,n,o):t.when(o).then(()=>this.doInstantiateByPhase(e,i,n,o))}async doInstantiateByPhase(e,t,i,n){let o=this.contributionsByPhase.get(n);if(o)switch(this.contributionsByPhase.delete(n),n){case 1:case 2:{En(`code/willCreateWorkbenchContributions/${n}`);for(let s of o)this.safeCreateContribution(e,t,i,s,n);En(`code/didCreateWorkbenchContributions/${n}`);break}case 3:case 4:{n===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(o,e,t,i,n);break}}}doInstantiateWhenIdle(e,t,i,n,o){En(`code/willCreateWorkbenchContributions/${o}`);let s=0,a=o===4?3e3:500,l=d=>{for(;s<e.length;){let c=e[s++];if(this.safeCreateContribution(t,i,n,c,o),d.timeRemaining()<1){Bc(l,a);break}}s===e.length&&(En(`code/didCreateWorkbenchContributions/${o}`),o===3&&this.pendingRestoredContributions.complete())};Bc(l,a)}safeCreateContribution(e,t,i,n,o){if(typeof n.id=="string"&&this.instancesById.has(n.id))return;let s=Date.now();try{typeof n.id=="string"&&En(`code/willCreateWorkbenchContribution/${o}/${n.id}`);let a=e.createInstance(n.ctor);typeof n.id=="string"&&(this.instancesById.set(n.id,a),this.contributionsById.delete(n.id)),yW(a)&&this.instanceDisposables.add(a)}catch(a){t.error(`Unable to create workbench contribution '${n.id??n.ctor.name}'.`,a)}finally{typeof n.id=="string"&&En(`code/didCreateWorkbenchContribution/${o}/${n.id}`)}if(typeof n.id=="string"||!i.isBuilt){let a=Date.now()-s;if(a>(o<3?r.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:r.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&t.warn(`Creation of workbench contribution '${n.id??n.ctor.name}' took ${a}ms.`),typeof n.id=="string"){let l=this.timingsByPhase.get(o);l||(l=[],this.timingsByPhase.set(o,l)),l.push([n.id,a])}}}},wwt=xh.INSTANCE.registerWorkbenchContribution2.bind(xh.INSTANCE),xwt=xh.INSTANCE.getWorkbenchContribution.bind(xh.INSTANCE);ze.add(q_.Workbench,xh.INSTANCE);var RI=class{constructor(e,t,i,n){this.fileService=e;this.environmentService=t;this.lifecycleService=i;this.logService=n}async getLogs(){return R7(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(3),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await ze.as(q_.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(e,t){let i=Re.document.querySelector(e);if(!i)return Promise.reject(new Error(`Element not found: ${e}`));let n=i;n.value=t;let o=new Event("input",{bubbles:!0,cancelable:!0});n.dispatchEvent(o)}async isActiveElement(e){if(Re.document.querySelector(e)!==Re.document.activeElement){let i=[],n=Re.document.activeElement;for(;n;){let o=n.tagName,s=n.id?`#${n.id}`:"",a=ni(n.className.split(/\s+/g).map(l=>l.trim())).map(l=>`.${l}`).join("");i.unshift(`${o}${s}${a}`),n=n.parentElement}throw new Error(`Active element not found. Current active element is '${i.join(" > ")}'. Looking for ${e}`)}return!0}async getElements(e,t){let i=Re.document.querySelectorAll(e),n=[];for(let o=0;o<i.length;o++){let s=i.item(o);n.push(this.serializeElement(s,t))}return n}serializeElement(e,t){let i=Object.create(null);for(let a=0;a<e.attributes.length;a++){let l=e.attributes.item(a);l&&(i[l.name]=l.value)}let n=[];if(t)for(let a=0;a<e.children.length;a++){let l=e.children.item(a);l&&n.push(this.serializeElement(l,!0))}let{left:o,top:s}=_p(e);return{tagName:e.tagName,className:e.className,textContent:e.textContent||"",attributes:i,children:n,left:o,top:s}}async getElementXY(e,t,i){let n=typeof t=="number"&&typeof i=="number"?{x:t,y:i}:void 0;return this._getElementXY(e,n)}async typeInEditor(e,t){let i=Re.document.querySelector(e);if(!i)throw new Error(`Editor not found: ${e}`);let n=i,o=n.selectionStart,s=o+t.length,a=n.value,l=a.substr(0,o)+t+a.substr(o);n.value=l,n.setSelectionRange(s,s);let d=new Event("input",{bubbles:!0,cancelable:!0});n.dispatchEvent(d)}async getTerminalBuffer(e){let t=Re.document.querySelector(e);if(!t)throw new Error(`Terminal not found: ${e}`);let i=t.xterm;if(!i)throw new Error(`Xterm not found: ${e}`);let n=[];for(let o=0;o<i.buffer.active.length;o++)n.push(i.buffer.active.getLine(o).translateToString(!0));return n}async writeInTerminal(e,t){let i=Re.document.querySelector(e);if(!i)throw new Error(`Element not found: ${e}`);let n=i.xterm;if(!n)throw new Error(`Xterm not found: ${e}`);n.input(t)}getLocaleInfo(){return Promise.resolve({language:pl,locale:lW})}getLocalizedStrings(){return Promise.resolve({open:j_.open,close:j_.close,find:j_.find})}async _getElementXY(e,t){let i=Re.document.querySelector(e);if(!i)return Promise.reject(new Error(`Element not found: ${e}`));let{left:n,top:o}=_p(i),{width:s,height:a}=Dp(i),l,d;return t?(l=n+t.x,d=o+t.y):(l=n+s/2,d=o+a/2),l=Math.round(l),d=Math.round(d),{x:l,y:d}}async exitApplication(){}};RI=R([y(0,Lt),y(1,Ts),y(2,id),y(3,Oi)],RI);function N7(r){Object.assign(Re,{driver:r.createInstance(RI)})}var Os=class extends P{constructor(t,i={getWindowsCount:dE,getWindows:Hv},n,o){super();this.hostService=n;this.environmentService=o;this.enableWindowFocusOnElementFocus(t),this.enableMultiWindowAwareTimeout(t,i),this.registerFullScreenListeners(t.vscodeWindowId)}static TIMEOUT_HANDLES=Number.MIN_SAFE_INTEGER;static TIMEOUT_DISPOSABLES=new Map;enableWindowFocusOnElementFocus(t){let i=t.HTMLElement.prototype.focus,n=this;t.HTMLElement.prototype.focus=function(o){n.onElementFocus(pe(this)),i.apply(this,[o])}}onElementFocus(t){let i=Kr();i!==t&&i.document.hasFocus()&&(t.focus(),!this.environmentService.extensionTestsLocationURI&&!t.document.hasFocus()&&this.hostService.focus(t))}enableMultiWindowAwareTimeout(t,i={getWindowsCount:dE,getWindows:Hv}){let n=t.setTimeout;Object.defineProperty(t,"vscodeOriginalSetTimeout",{get:()=>n});let o=t.clearTimeout;Object.defineProperty(t,"vscodeOriginalClearTimeout",{get:()=>o}),t.setTimeout=function(s,a=0,...l){if(i.getWindowsCount()===1||typeof s=="string"||a===0)return n.apply(this,[s,a,...l]);let d=new Set,c=Os.TIMEOUT_HANDLES++;Os.TIMEOUT_DISPOSABLES.set(c,d);let u=ps(s,()=>{ht(d),Os.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:p,disposables:m}of i.getWindows()){if(P0(p)&&p.document.visibilityState==="hidden")continue;let f=!1,g=p.vscodeOriginalSetTimeout.apply(this,[(...v)=>{f||u(...v)},a,...l]),b=te(()=>{f=!0,p.vscodeOriginalClearTimeout(g),d.delete(b)});m.add(b),d.add(b)}return c},t.clearTimeout=function(s){let a=typeof s=="number"?Os.TIMEOUT_DISPOSABLES.get(s):void 0;a?(ht(a),Os.TIMEOUT_DISPOSABLES.delete(s)):o.apply(this,[s])}}registerFullScreenListeners(t){this._register(this.hostService.onDidChangeFullScreen(({windowId:i,fullscreen:n})=>{if(i===t){let o=Bd(t);o&&h2(n,o.window)}}))}static async confirmOnShutdown(t,i){let n=t.get(Io),o=t.get(He),s=i===2?ke?h("quitMessageMac","Are you sure you want to quit?"):h("quitMessage","Are you sure you want to exit?"):h("closeWindowMessage","Are you sure you want to close the window?"),a=i===2?ke?h({key:"quitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Quit"):h({key:"exitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Exit"):h({key:"closeWindowButtonLabel",comment:["&& denotes a mnemonic"]},"&&Close Window"),l=await n.confirm({message:s,primaryButton:a,checkbox:{label:h("doNotAskAgain","Do not ask me again")}});return l.confirmed&&l.checkboxChecked&&await o.updateValue("window.confirmBeforeClose","never"),l.confirmed}};Os=R([y(2,eo),y(3,Eh)],Os);var $_=class extends Os{constructor(t,i,n,o,s,a,l,d,c){super(Re,void 0,c,a);this.openerService=t;this.lifecycleService=i;this.dialogService=n;this.labelService=o;this.productService=s;this.browserEnvironmentService=a;this.layoutService=l;this.instantiationService=d;this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let t=zs&&Re.visualViewport?Re.visualViewport:Re;this._register(B(t,Q.RESIZE,()=>{this.layoutService.layout(),zs&&Re.scrollTo(0,0)})),this._register(B(this.layoutService.mainContainer,Q.WHEEL,i=>i.preventDefault(),{passive:!1})),this._register(B(this.layoutService.mainContainer,Q.CONTEXT_MENU,i=>Oe.stop(i,!0))),this._register(B(this.layoutService.mainContainer,Q.DROP,i=>Oe.stop(i,!0)))}onWillShutdown(){z.toPromise(z.any(z.once(new Me(Re.document.body,Q.KEY_DOWN,!0).event),z.once(new Me(Re.document.body,Q.MOUSE_DOWN,!0).event))).then(async()=>{await hn(3e3),await this.dialogService.prompt({type:zi.Error,message:h("shutdownError","An unexpected error occurred that requires a reload of this page."),detail:h("shutdownErrorDetail","The workbench was unexpectedly disposed while running."),buttons:[{label:h({key:"reload",comment:["&& denotes a mnemonic"]},"&&Reload"),run:()=>Re.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&N7(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async t=>{let i=!1;if(this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes){for(let n of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(t.startsWith(n)){i=!0;break}}if(Cm(t,ue.http)||Cm(t,ue.https))Uo?eH(t,!i)||await this.dialogService.prompt({type:zi.Warning,message:h("unableToOpenExternal","The browser interrupted the opening of a new tab or window. Press 'Open' to open it anyway."),detail:t,buttons:[{label:h({key:"open",comment:["&& denotes a mnemonic"]},"&&Open"),run:()=>i?a1(t):s1(t)},{label:h({key:"learnMore",comment:["&& denotes a mnemonic"]},"&&Learn More"),run:()=>this.openerService.open(X.parse("https://aka.ms/allow-vscode-popup"))}],cancelButton:!0}):i?a1(t):s1(t);else{let n=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>Re.location.href=t)};n();let o=async()=>{let{downloadUrl:s}=this.productService,a,l=[{label:h({key:"openExternalDialogButtonRetry.v2",comment:["&& denotes a mnemonic"]},"&&Try Again"),run:()=>n()}];s!==void 0?(a=h("openExternalDialogDetail.v2",`We launched {0} on your computer.

If {1} did not launch, try again or install it below.`,this.productService.nameLong,this.productService.nameLong),l.push({label:h({key:"openExternalDialogButtonInstall.v3",comment:["&& denotes a mnemonic"]},"&&Install"),run:async()=>{await this.openerService.open(X.parse(s)),o()}})):a=h("openExternalDialogDetailNoInstall",`We launched {0} on your computer.

If {1} did not launch, try again below.`,this.productService.nameLong,this.productService.nameLong),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:zi.Info,message:h("openExternalDialogTitle","All done. You can close this tab now."),detail:a,buttons:l,cancelButton:!0}))};Cm(t,this.productService.urlProtocol)&&await o()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:ue.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){Nn.registerCommand("workbench.experimental.requestUsbDevice",async(t,i)=>C7(i)),Nn.registerCommand("workbench.experimental.requestSerialPort",async(t,i)=>S7(i)),Nn.registerCommand("workbench.experimental.requestHidDevice",async(t,i)=>E7(i))}};$_=R([y(0,qa),y(1,id),y(2,Io),y(3,na),y(4,Q4),y(5,x7),y(6,$a),y(7,ve),y(8,eo)],$_);var IX=Z("auxiliaryWindowService");var AI=class extends Os{constructor(t,i,n,o,s,a){super(t,void 0,s,a);this.window=t;this.container=i;this.configurationService=o;this.whenStylesHaveLoaded=n.wait().then(()=>{}),this.registerListeners()}_onWillLayout=this._register(new _);onWillLayout=this._onWillLayout.event;_onDidLayout=this._register(new _);onDidLayout=this._onDidLayout.event;_onBeforeUnload=this._register(new _);onBeforeUnload=this._onBeforeUnload.event;_onUnload=this._register(new _);onUnload=this._onUnload.event;_onWillDispose=this._register(new _);onWillDispose=this._onWillDispose.event;whenStylesHaveLoaded;registerListeners(){this._register(B(this.window,Q.BEFORE_UNLOAD,t=>this.handleBeforeUnload(t))),this._register(B(this.window,Q.UNLOAD,()=>this.handleUnload())),this._register(B(this.window,"unhandledrejection",t=>{Ge(t.reason),t.preventDefault()})),this._register(B(this.window,Q.RESIZE,()=>this.layout())),this._register(B(this.container,Q.SCROLL,()=>this.container.scrollTop=0)),on?(this._register(B(this.container,Q.DROP,t=>Oe.stop(t,!0))),this._register(B(this.container,Q.WHEEL,t=>t.preventDefault(),{passive:!1})),this._register(B(this.container,Q.CONTEXT_MENU,t=>Oe.stop(t,!0)))):(this._register(B(this.window.document.body,Q.DRAG_OVER,t=>Oe.stop(t))),this._register(B(this.window.document.body,Q.DROP,t=>Oe.stop(t))))}handleBeforeUnload(t){let i;if(this._onBeforeUnload.fire({veto(s){s&&(i=s)}}),i){this.handleVetoBeforeClose(t,i);return}let n=this.configurationService.getValue("window.confirmBeforeClose");(n==="always"||n==="keyboardOnly"&&km.getInstance().isModifierPressed)&&this.confirmBeforeClose(t)}handleVetoBeforeClose(t,i){this.preventUnload(t)}preventUnload(t){t.preventDefault(),t.returnValue=h("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(t){this.preventUnload(t)}handleUnload(){this._onUnload.fire()}layout(){let t=Dp(this.window.document.body,this.container);this._onWillLayout.fire(t),this._onDidLayout.fire(t)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:u2(this.window)}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};AI=R([y(3,He),y(4,eo),y(5,Eh)],AI);var rc=class extends P{constructor(t,i,n,o,s,a){super();this.layoutService=t;this.dialogService=i;this.configurationService=n;this.telemetryService=o;this.hostService=s;this.environmentService=a}static DEFAULT_SIZE={width:800,height:600};static WINDOW_IDS=Hc(Re)+1;_onDidOpenAuxiliaryWindow=this._register(new _);onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event;windows=new Map;async open(t){En("code/auxiliaryWindow/willOpen");let i=await this.openWindow(t);if(!i)throw new Error(h("unableToOpenWindowError","Unable to open a new window."));let n=await this.resolveWindowId(i);XS(i,n);let o=new Y,{container:s,stylesLoaded:a}=this.createContainer(i,o,t),l=this.createAuxiliaryWindow(i,s,a),d=new Y;this.windows.set(i.vscodeWindowId,l),d.add(te(()=>this.windows.delete(i.vscodeWindowId)));let c=new Y;return z.once(l.onWillDispose)(()=>{i.close(),o.dispose(),d.dispose(),c.dispose()}),d.add(P2(i)),this._onDidOpenAuxiliaryWindow.fire({window:l,disposables:c}),En("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!!t?.bounds}),l}createAuxiliaryWindow(t,i,n){return new AI(t,i,n,this.configurationService,this.hostService,this.environmentService)}async openWindow(t){let i=Kr(),n={x:i.screenX,y:i.screenY,width:i.outerWidth,height:i.outerHeight},o=Math.max(t?.bounds?.width??rc.DEFAULT_SIZE.width,JO.WIDTH),s=Math.max(t?.bounds?.height??rc.DEFAULT_SIZE.height,JO.HEIGHT),a={x:t?.bounds?.x??Math.max(n.x+n.width/2-o/2,0),y:t?.bounds?.y??Math.max(n.y+n.height/2-s/2,0),width:o,height:s};!t?.bounds&&a.x===n.x&&a.y===n.y&&(a={...a,x:a.x+30,y:a.y+30});let l=ni(["popup=yes",`left=${a.x}`,`top=${a.y}`,`width=${a.width}`,`height=${a.height}`,t?.nativeTitlebar?"window-native-titlebar=yes":void 0,t?.disableFullscreen?"window-disable-fullscreen=yes":void 0,t?.mode===0?"window-maximized=yes":void 0,t?.mode===2?"window-fullscreen=yes":void 0]),d=Re.open(gS?"":"about:blank",void 0,l.join(","));return!d&&on?(await this.dialogService.prompt({type:zi.Warning,message:h("unableToOpenWindow","The browser interrupted the opening of a new window. Press 'Retry' to try again."),detail:h("unableToOpenWindowDetail","To avoid this problem in the future, please ensure to allow popups for this website."),buttons:[{label:h({key:"retry",comment:["&& denotes a mnemonic"]},"&&Retry"),run:()=>this.openWindow(t)}],cancelButton:!0})).result:d?.window}async resolveWindowId(t){return rc.WINDOW_IDS++}createContainer(t,i,n){t.document.createElement=function(){throw new Error('Not allowed to create elements in child window JavaScript context. Always use the main window so that "xyz instanceof HTMLElement" continues to work.')},this.applyMeta(t);let{stylesLoaded:o}=this.applyCSS(t,i),s=this.applyHTML(t,i);return{stylesLoaded:o,container:s}}applyMeta(t){for(let n of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let o=Re.document.querySelector(n);if(o){let s=j2(t.document.head);if(bE(o,s),n==='meta[http-equiv="Content-Security-Policy"]'){let a=s.getAttribute("content");a&&s.setAttribute("content",a.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let i=Re.document.querySelector('link[rel="icon"]');if(i){let n=q2(t.document.head);bE(i,n)}}applyCSS(t,i){En("code/auxiliaryWindow/willApplyCSS");let n=new Map,o=new wm;o.wait().then(()=>En("code/auxiliaryWindow/didLoadCSSStyles"));let s=i.add(new Y),a=0;function l(){--a===0&&(s.dispose(),o.open())}function d(c){if(z2(c))return;let u=t.document.head.appendChild(c.cloneNode(!0));c.tagName.toLowerCase()==="link"&&(a++,s.add(B(u,"load",l)),s.add(B(u,"error",l))),n.set(c,u)}a++;try{for(let c of Re.document.head.querySelectorAll('link[rel="stylesheet"], style'))d(c)}finally{l()}return i.add(K2(t)),i.add(gE.observe(Re.document.head,i,{childList:!0,subtree:!0})(c=>{for(let u of c)if(!(u.type!=="childList"||u.target.nodeName.toLowerCase()==="title"||u.target.nodeName.toLowerCase()==="script"||u.target.nodeName.toLowerCase()==="meta")){for(let p of u.addedNodes)if(ki(p)&&(p.tagName.toLowerCase()==="style"||p.tagName.toLowerCase()==="link"))d(p);else if(p.nodeType===Node.TEXT_NODE&&p.parentNode){let m=n.get(p.parentNode);m&&(m.textContent=p.textContent)}for(let p of u.removedNodes){let m=n.get(p);m&&(m.parentNode?.removeChild(m),n.delete(p))}}})),En("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:o}}applyHTML(t,i){En("code/auxiliaryWindow/willApplyHTML");let n=document.createElement("div");return n.setAttribute("role","application"),V2(n,0,0,0,0,"relative"),n.style.display="flex",n.style.height="100%",n.style.flexDirection="column",t.document.body.append(n),i.add(vE(Re.document.documentElement,t.document.documentElement)),i.add(vE(Re.document.body,t.document.body)),i.add(vE(this.layoutService.mainContainer,n,["class"])),En("code/auxiliaryWindow/didApplyHTML"),n}getWindow(t){return this.windows.get(t)}};rc=R([y(0,$a),y(1,Io),y(2,He),y(3,jt),y(4,eo),y(5,Eh)],rc);an(IX,rc,1);var Ya=new At(220,70),yf=new At(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);function kN(r,e,t){return!e||!r.activeEditor||e.matches(r.activeEditor)?{...t,viewState:r.activeEditorPane?.getViewState()}:t||Object.create(null)}var od=class r extends vf{constructor(t,i,n,o,s){super(t,n,o,s);this.group=i}onDidChangeSizeConstraints=z.None;_onDidChangeControl=this._register(new _);onDidChangeControl=this._onDidChangeControl.event;static EDITOR_MEMENTOS=new Map;get minimumWidth(){return Ya.width}get maximumWidth(){return yf.width}get minimumHeight(){return Ya.height}get maximumHeight(){return yf.height}_input;get input(){return this._input}_options;get options(){return this._options}get window(){return Bd(this.group.windowId,!0).window}get scopedContextKeyService(){}create(t){super.create(t),this.createEditor(t)}async setInput(t,i,n,o){this._input=t,this._options=i}clearInput(){this._input=void 0,this._options=void 0}setOptions(t){this._options=t}setVisible(t){super.setVisible(t),this.setEditorVisible(t)}setEditorVisible(t){}setBoundarySashes(t){}getEditorMemento(t,i,n,o=10){let s=`${this.getId()}${n}`,a=r.EDITOR_MEMENTOS.get(s);return a||(a=this._register(new RN(this.getId(),n,this.getMemento(1,1),o,t,i)),r.EDITOR_MEMENTOS.set(s,a)),a}getViewState(){}saveState(){for(let[,t]of r.EDITOR_MEMENTOS)t.id===this.getId()&&t.saveState();super.saveState()}dispose(){this._input=void 0,this._options=void 0,super.dispose()}},RN=class r extends P{constructor(t,i,n,o,s,a){super();this.id=t;this.key=i;this.memento=n;this.limit=o;this.editorGroupService=s;this.configurationService=a;this.updateConfiguration(void 0),this.registerListeners()}static SHARED_EDITOR_STATE=-1;cache;cleanedUp=!1;editorDisposables;shareEditorState=!1;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.updateConfiguration(t)))}updateConfiguration(t){(!t||t.affectsConfiguration(void 0,"workbench.editor.sharedViewState"))&&(this.shareEditorState=this.configurationService.getValue(void 0,"workbench.editor.sharedViewState")===!0)}saveEditorState(t,i,n){let o=this.doGetResource(i);if(!o||!t)return;let s=this.doLoad(),a=s.get(o.toString());a||(a=Object.create(null),s.set(o.toString(),a)),a[t.id]=n,this.shareEditorState&&(a[r.SHARED_EDITOR_STATE]=n),Bn(i)&&this.clearEditorStateOnDispose(o,i)}loadEditorState(t,i){let n=this.doGetResource(i);if(!n||!t)return;let s=this.doLoad().get(n.toString());if(s){let a=s[t.id];if(a)return a;if(this.shareEditorState)return s[r.SHARED_EDITOR_STATE]}}clearEditorState(t,i){Bn(t)&&this.editorDisposables?.delete(t);let n=this.doGetResource(t);if(n){let o=this.doLoad();if(i){let s=o.get(n.toString());s&&(delete s[i.id],Cp(s)&&o.delete(n.toString()))}else o.delete(n.toString())}}clearEditorStateOnDispose(t,i){this.editorDisposables||(this.editorDisposables=new Map),this.editorDisposables.has(i)||this.editorDisposables.set(i,z.once(i.onWillDispose)(()=>{this.clearEditorState(t),this.editorDisposables?.delete(i)}))}moveEditorState(t,i,n){let o=this.doLoad(),s=[...o.keys()];for(let a of s){let l=X.parse(a);if(!n.isEqualOrParent(l,t))continue;let d;if(Li(t,l))d=i;else{let u=r2(l.path,t.path);d=It(i,l.path.substr(u+t.path.length+1))}let c=o.get(a,0);c&&(o.delete(a),o.set(d.toString(),c))}}doGetResource(t){return Bn(t)?t.resource:t}doLoad(){if(!this.cache){this.cache=new Br(this.limit);let t=this.memento[this.key];Array.isArray(t)&&this.cache.fromJSON(t)}return this.cache}saveState(){let t=this.doLoad();this.cleanedUp||(this.cleanUp(),this.cleanedUp=!0),this.memento[this.key]=t.toJSON()}cleanUp(){let t=this.doLoad(),i=[...t.entries()];for(let[n,o]of i)for(let s of Object.keys(o)){let a=Number(s);a===r.SHARED_EDITOR_STATE&&this.shareEditorState||this.editorGroupService.getGroup(a)||(delete o[a],Cp(o)&&t.delete(n))}}};var MI=class r{constructor(e,t,i){this.ctor=e;this.typeId=t;this.name=i}static instantiatedEditorPanes=new Set;static didInstantiateEditorPane(e){return r.instantiatedEditorPanes.has(e)}static _onWillInstantiateEditorPane=new _;static onWillInstantiateEditorPane=r._onWillInstantiateEditorPane.event;static create(e,t,i){return new r(e,t,i)}instantiate(e,t){r._onWillInstantiateEditorPane.fire({typeId:this.typeId});let i=e.createInstance(this.ctor,t);return r.instantiatedEditorPanes.add(this.typeId),i}describes(e){return e.getId()===this.typeId}},AN=class{mapEditorPanesToEditors=new Map;registerEditorPane(e,t){return this.mapEditorPanesToEditors.set(e,t),te(()=>{this.mapEditorPanesToEditors.delete(e)})}getEditorPane(e){let t=this.findEditorPaneDescriptors(e);if(t.length!==0)return t.length===1?t[0]:e.prefersEditorPane(t)}findEditorPaneDescriptors(e,t){let i=[];for(let n of this.mapEditorPanesToEditors.keys()){let o=this.mapEditorPanesToEditors.get(n)||[];for(let s of o){let a=s.ctor;if(!t&&e.constructor===a){i.push(n);break}else if(t&&e instanceof a){i.push(n);break}}}return!t&&i.length===0?this.findEditorPaneDescriptors(e,!0):i}getEditorPaneByType(e){return ct.find(this.mapEditorPanesToEditors.keys(),t=>t.typeId===e)}getEditorPanes(){return Array.from(this.mapEditorPanesToEditors.keys())}getEditors(){let e=[];for(let t of this.mapEditorPanesToEditors.keys()){let i=this.mapEditorPanesToEditors.get(t);i&&e.push(...i.map(n=>n.ctor))}return e}};ze.add(ks.EditorPane,new AN);function If(r,e,t,i){let n=r.getAriaLabel();return t&&!t.isPinned(r)&&(n=h("preview","{0}, preview",n)),t?.isSticky(e??r)&&(n=h("pinned","{0}, pinned",n)),t&&typeof i=="number"&&i>1&&(n=`${n}, ${t.ariaLabel}`),n}function W7(r){switch(r.type){case"light":return U.fromHex("#F3F3F3");case"hcLight":return U.fromHex("#FFFFFF");case"hcDark":return U.fromHex("#000000");default:return U.fromHex("#252526")}}var tD=x("tab.activeBackground",pr,h("tabActiveBackground","Active tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),H7=x("tab.unfocusedActiveBackground",tD,h("tabUnfocusedActiveBackground","Active tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),MN=x("tab.inactiveBackground",{dark:"#2D2D2D",light:"#ECECEC",hcDark:null,hcLight:null},h("tabInactiveBackground","Inactive tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),U7=x("tab.unfocusedInactiveBackground",MN,h("tabUnfocusedInactiveBackground","Inactive tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),sc=x("tab.activeForeground",{dark:U.white,light:"#333333",hcDark:U.white,hcLight:"#292929"},h("tabActiveForeground","Active tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),F7=x("tab.inactiveForeground",{dark:Ce(sc,.5),light:Ce(sc,.7),hcDark:U.white,hcLight:"#292929"},h("tabInactiveForeground","Inactive tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),z7=x("tab.unfocusedActiveForeground",{dark:Ce(sc,.5),light:Ce(sc,.7),hcDark:U.white,hcLight:"#292929"},h("tabUnfocusedActiveForeground","Active tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),kDt=x("tab.unfocusedInactiveForeground",{dark:Ce(F7,.5),light:Ce(F7,.5),hcDark:U.white,hcLight:"#292929"},h("tabUnfocusedInactiveForeground","Inactive tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Z_=x("tab.hoverBackground",null,h("tabHoverBackground","Tab background color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),K7=x("tab.unfocusedHoverBackground",{dark:Ce(Z_,.5),light:Ce(Z_,.7),hcDark:null,hcLight:null},h("tabUnfocusedHoverBackground","Tab background color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),X_=x("tab.hoverForeground",null,h("tabHoverForeground","Tab foreground color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),G7=x("tab.unfocusedHoverForeground",{dark:Ce(X_,.5),light:Ce(X_,.5),hcDark:null,hcLight:null},h("tabUnfocusedHoverForeground","Tab foreground color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),iD=x("tab.border",{dark:"#252526",light:"#F3F3F3",hcDark:Ie,hcLight:Ie},h("tabBorder","Border to separate tabs from each other. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),j7=x("tab.lastPinnedBorder",{dark:Dg,light:Dg,hcDark:Ie,hcLight:Ie},h("lastPinnedTabBorder","Border to separate pinned tabs from other tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Q_=x("tab.activeBorder",null,h("tabActiveBorder","Border on the bottom of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),q7=x("tab.unfocusedActiveBorder",{dark:Ce(Q_,.5),light:Ce(Q_,.7),hcDark:null,hcLight:null},h("tabActiveUnfocusedBorder","Border on the bottom of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),OI=x("tab.activeBorderTop",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},h("tabActiveBorderTop","Border to the top of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),$7=x("tab.unfocusedActiveBorderTop",{dark:Ce(OI,.5),light:Ce(OI,.7),hcDark:null,hcLight:"#B5200D"},h("tabActiveUnfocusedBorderTop","Border to the top of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Y7=x("tab.selectedBorderTop",OI,h("tabSelectedBorderTop","Border to the top of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),RDt=x("tab.selectedBackground",tD,h("tabSelectedBackground","Background of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ADt=x("tab.selectedForeground",sc,h("tabSelectedForeground","Foreground of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),J_=x("tab.hoverBorder",null,h("tabHoverBorder","Border to highlight tabs when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Z7=x("tab.unfocusedHoverBorder",{dark:Ce(J_,.5),light:Ce(J_,.7),hcDark:null,hcLight:Ie},h("tabUnfocusedHoverBorder","Border to highlight tabs in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),MDt=x("tab.dragAndDropBorder",{dark:sc,light:sc,hcDark:Ft,hcLight:Ft},h("tabDragAndDropBorder","Border between tabs to indicate that a tab can be inserted between two tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Cf=x("tab.activeModifiedBorder",{dark:"#3399CC",light:"#33AAEE",hcDark:null,hcLight:Ie},h("tabActiveModifiedBorder","Border on the top of modified active tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),eD=x("tab.inactiveModifiedBorder",{dark:Ce(Cf,.5),light:Ce(Cf,.5),hcDark:U.white,hcLight:Ie},h("tabInactiveModifiedBorder","Border on the top of modified inactive tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),X7=x("tab.unfocusedActiveModifiedBorder",{dark:Ce(Cf,.5),light:Ce(Cf,.7),hcDark:U.white,hcLight:Ie},h("unfocusedActiveModifiedBorder","Border on the top of modified active tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Q7=x("tab.unfocusedInactiveModifiedBorder",{dark:Ce(eD,.5),light:Ce(eD,.5),hcDark:U.white,hcLight:Ie},h("unfocusedINactiveModifiedBorder","Border on the top of modified inactive tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ODt=x("editorPane.background",pr,h("editorPaneBackground","Background color of the editor pane visible on the left and right side of the centered editor layout.")),J7=x("editorGroup.emptyBackground",null,h("editorGroupEmptyBackground","Background color of an empty editor group. Editor groups are the containers of editors.")),PDt=x("editorGroup.focusedEmptyBorder",{dark:null,light:null,hcDark:Zo,hcLight:Zo},h("editorGroupFocusedEmptyBorder","Border color of an empty editor group that is focused. Editor groups are the containers of editors.")),nD=x("editorGroupHeader.tabsBackground",{dark:"#252526",light:"#F3F3F3",hcDark:null,hcLight:null},h("tabsContainerBackground","Background color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),e9=x("editorGroupHeader.tabsBorder",null,h("tabsContainerBorder","Border color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),t9=x("editorGroupHeader.noTabsBackground",pr,h("editorGroupHeaderBackground",'Background color of the editor group title header when (`"workbench.editor.showTabs": "single"`). Editor groups are the containers of editors.')),i9=x("editorGroupHeader.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("editorTitleContainerBorder","Border color of the editor group title header. Editor groups are the containers of editors.")),n9=x("editorGroup.border",{dark:"#444444",light:"#E7E7E7",hcDark:Ie,hcLight:Ie},h("editorGroupBorder","Color to separate multiple editor groups from each other. Editor groups are the containers of editors.")),oD=x("editorGroup.dropBackground",{dark:U.fromHex("#53595D").transparent(.5),light:U.fromHex("#2677CB").transparent(.18),hcDark:null,hcLight:U.fromHex("#0F4A85").transparent(.5)},h("editorDragAndDropBackground","Background color when dragging editors around. The color should have transparency so that the editor contents can still shine through.")),NDt=x("editorGroup.dropIntoPromptForeground",Bl,h("editorDropIntoPromptForeground","Foreground color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),FDt=x("editorGroup.dropIntoPromptBackground",vo,h("editorDropIntoPromptBackground","Background color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),BDt=x("editorGroup.dropIntoPromptBorder",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("editorDropIntoPromptBorder","Border color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),o9=x("sideBySideEditor.horizontalBorder",n9,h("sideBySideEditor.horizontalBorder","Color to separate two editors from each other when shown side by side in an editor group from top to bottom.")),r9=x("sideBySideEditor.verticalBorder",n9,h("sideBySideEditor.verticalBorder","Color to separate two editors from each other when shown side by side in an editor group from left to right.")),ON=x("panel.background",pr,h("panelBackground","Panel background color. Panels are shown below the editor area and contain views like output and integrated terminal.")),CX=x("panel.border",{dark:U.fromHex("#808080").transparent(.35),light:U.fromHex("#808080").transparent(.35),hcDark:Ie,hcLight:Ie},h("panelBorder","Panel border color to separate the panel from the editor. Panels are shown below the editor area and contain views like output and integrated terminal.")),PI=x("panelTitle.activeForeground",{dark:"#E7E7E7",light:"#424242",hcDark:U.white,hcLight:Dr},h("panelActiveTitleForeground","Title color for the active panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),VDt=x("panelTitle.inactiveForeground",{dark:Ce(PI,.6),light:Ce(PI,.75),hcDark:U.white,hcLight:Dr},h("panelInactiveTitleForeground","Title color for the inactive panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),WDt=x("panelTitle.activeBorder",{dark:PI,light:PI,hcDark:Ie,hcLight:"#B5200D"},h("panelActiveTitleBorder","Border color for the active panel title. Panels are shown below the editor area and contain views like output and integrated terminal.")),HDt=x("panelInput.border",{dark:Tg,light:U.fromHex("#ddd"),hcDark:Tg,hcLight:Tg},h("panelInputBorder","Input box border for inputs in the panel.")),UDt=x("panel.dropBorder",PI,h("panelDragAndDropBorder","Drag and drop feedback color for the panel titles. Panels are shown below the editor area and contain views like output and integrated terminal.")),PN=x("panelSection.dropBackground",oD,h("panelSectionDragAndDropBackground","Drag and drop feedback color for the panel sections. The color should have transparency so that the panel sections can still shine through. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),s9=x("panelSectionHeader.background",{dark:U.fromHex("#808080").transparent(.2),light:U.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},h("panelSectionHeaderBackground","Panel section header background color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),a9=x("panelSectionHeader.foreground",null,h("panelSectionHeaderForeground","Panel section header foreground color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),l9=x("panelSectionHeader.border",Ie,h("panelSectionHeaderBorder","Panel section header border color used when multiple views are stacked vertically in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),d9=x("panelSection.border",CX,h("panelSectionBorder","Panel section border color used when multiple views are stacked horizontally in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),c9=x("panelStickyScroll.background",ON,h("panelStickyScrollBackground","Background color of sticky scroll in the panel.")),u9=x("panelStickyScroll.border",null,h("panelStickyScrollBorder","Border color of sticky scroll in the panel.")),p9=x("panelStickyScroll.shadow",pu,h("panelStickyScrollShadow","Shadow color of sticky scroll in the panel.")),SX=x("outputView.background",null,h("outputViewBackground","Output view background color."));x("outputViewStickyScroll.background",SX,h("outputViewStickyScrollBackground","Output view sticky scroll background color."));var zDt=x("banner.background",{dark:yo,light:Yo(yo,.3),hcDark:yo,hcLight:yo},h("banner.background","Banner background color. The banner is shown under the title bar of the window.")),KDt=x("banner.foreground",is,h("banner.foreground","Banner foreground color. The banner is shown under the title bar of the window.")),GDt=x("banner.iconForeground",ts,h("banner.iconForeground","Banner icon color. The banner is shown under the title bar of the window.")),ku=x("statusBar.foreground",{dark:"#FFFFFF",light:"#FFFFFF",hcDark:"#FFFFFF",hcLight:Dr},h("statusBarForeground","Status bar foreground color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),jDt=x("statusBar.noFolderForeground",ku,h("statusBarNoFolderForeground","Status bar foreground color when no folder is opened. The status bar is shown in the bottom of the window.")),qDt=x("statusBar.background",{dark:"#007ACC",light:"#007ACC",hcDark:null,hcLight:null},h("statusBarBackground","Status bar background color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),$Dt=x("statusBar.noFolderBackground",{dark:"#68217A",light:"#68217A",hcDark:null,hcLight:null},h("statusBarNoFolderBackground","Status bar background color when no folder is opened. The status bar is shown in the bottom of the window.")),EX=x("statusBar.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("statusBarBorder","Status bar border color separating to the sidebar and editor. The status bar is shown in the bottom of the window.")),YDt=x("statusBar.focusBorder",{dark:ku,light:ku,hcDark:null,hcLight:ku},h("statusBarFocusBorder","Status bar border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),ZDt=x("statusBar.noFolderBorder",EX,h("statusBarNoFolderBorder","Status bar border color separating to the sidebar and editor when no folder is opened. The status bar is shown in the bottom of the window.")),XDt=x("statusBarItem.activeBackground",{dark:U.white.transparent(.18),light:U.white.transparent(.18),hcDark:U.white.transparent(.18),hcLight:U.black.transparent(.18)},h("statusBarItemActiveBackground","Status bar item background color when clicking. The status bar is shown in the bottom of the window.")),QDt=x("statusBarItem.focusBorder",{dark:ku,light:ku,hcDark:null,hcLight:Ft},h("statusBarItemFocusBorder","Status bar item border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),Ru=x("statusBarItem.hoverBackground",{dark:U.white.transparent(.12),light:U.white.transparent(.12),hcDark:U.white.transparent(.12),hcLight:U.black.transparent(.12)},h("statusBarItemHoverBackground","Status bar item background color when hovering. The status bar is shown in the bottom of the window.")),FI=x("statusBarItem.hoverForeground",ku,h("statusBarItemHoverForeground","Status bar item foreground color when hovering. The status bar is shown in the bottom of the window.")),JDt=x("statusBarItem.compactHoverBackground",{dark:U.white.transparent(.2),light:U.white.transparent(.2),hcDark:U.white.transparent(.2),hcLight:U.black.transparent(.2)},h("statusBarItemCompactHoverBackground","Status bar item background color when hovering an item that contains two hovers. The status bar is shown in the bottom of the window.")),eLt=x("statusBarItem.prominentForeground",ku,h("statusBarProminentItemForeground","Status bar prominent items foreground color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),tLt=x("statusBarItem.prominentBackground",U.black.transparent(.5),h("statusBarProminentItemBackground","Status bar prominent items background color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),iLt=x("statusBarItem.prominentHoverForeground",FI,h("statusBarProminentItemHoverForeground","Status bar prominent items foreground color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),nLt=x("statusBarItem.prominentHoverBackground",{dark:U.black.transparent(.3),light:U.black.transparent(.3),hcDark:U.black.transparent(.3),hcLight:null},h("statusBarProminentItemHoverBackground","Status bar prominent items background color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),oLt=x("statusBarItem.errorBackground",{dark:Yo($M,.4),light:Yo($M,.4),hcDark:null,hcLight:"#B5200D"},h("statusBarErrorItemBackground","Status bar error items background color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),rLt=x("statusBarItem.errorForeground",U.white,h("statusBarErrorItemForeground","Status bar error items foreground color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),sLt=x("statusBarItem.errorHoverForeground",FI,h("statusBarErrorItemHoverForeground","Status bar error items foreground color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),aLt=x("statusBarItem.errorHoverBackground",Ru,h("statusBarErrorItemHoverBackground","Status bar error items background color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),lLt=x("statusBarItem.warningBackground",{dark:Yo(hr,.4),light:Yo(hr,.4),hcDark:null,hcLight:"#895503"},h("statusBarWarningItemBackground","Status bar warning items background color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),dLt=x("statusBarItem.warningForeground",U.white,h("statusBarWarningItemForeground","Status bar warning items foreground color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),cLt=x("statusBarItem.warningHoverForeground",FI,h("statusBarWarningItemHoverForeground","Status bar warning items foreground color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),uLt=x("statusBarItem.warningHoverBackground",Ru,h("statusBarWarningItemHoverBackground","Status bar warning items background color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),pLt=x("activityBar.background",{dark:"#333333",light:"#2C2C2C",hcDark:"#000000",hcLight:"#FFFFFF"},h("activityBarBackground","Activity bar background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),Sf=x("activityBar.foreground",{dark:U.white,light:U.white,hcDark:U.white,hcLight:Dr},h("activityBarForeground","Activity bar item foreground color when it is active. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),hLt=x("activityBar.inactiveForeground",{dark:Ce(Sf,.4),light:Ce(Sf,.4),hcDark:U.white,hcLight:Dr},h("activityBarInActiveForeground","Activity bar item foreground color when it is inactive. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),mLt=x("activityBar.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("activityBarBorder","Activity bar border color separating to the side bar. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),gLt=x("activityBar.activeBorder",{dark:Sf,light:Sf,hcDark:Ie,hcLight:Ie},h("activityBarActiveBorder","Activity bar border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),fLt=x("activityBar.activeFocusBorder",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},h("activityBarActiveFocusBorder","Activity bar focus border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),bLt=x("activityBar.activeBackground",null,h("activityBarActiveBackground","Activity bar background color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),vLt=x("activityBar.dropBorder",{dark:Sf,light:Sf,hcDark:null,hcLight:null},h("activityBarDragAndDropBorder","Drag and drop feedback color for the activity bar items. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),h9=x("activityBarBadge.background",{dark:"#007ACC",light:"#007ACC",hcDark:"#000000",hcLight:"#0F4A85"},h("activityBarBadgeBackground","Activity notification badge background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),m9=x("activityBarBadge.foreground",U.white,h("activityBarBadgeForeground","Activity notification badge foreground color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),NI=x("activityBarTop.foreground",{dark:"#E7E7E7",light:"#424242",hcDark:U.white,hcLight:Dr},h("activityBarTop","Active foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),yLt=x("activityBarTop.activeBorder",{dark:NI,light:NI,hcDark:Ie,hcLight:"#B5200D"},h("activityBarTopActiveFocusBorder","Focus border color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),ILt=x("activityBarTop.activeBackground",null,h("activityBarTopActiveBackground","Background color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),CLt=x("activityBarTop.inactiveForeground",{dark:Ce(NI,.6),light:Ce(NI,.75),hcDark:U.white,hcLight:Dr},h("activityBarTopInActiveForeground","Inactive foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),SLt=x("activityBarTop.dropBorder",NI,h("activityBarTopDragAndDropBorder","Drag and drop feedback color for the items in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),ELt=x("activityBarTop.background",null,h("activityBarTopBackground","Background color of the activity bar when set to top / bottom.")),wLt=x("profileBadge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:U.white,hcLight:U.black},h("profileBadgeBackground","Profile badge background color. The profile badge shows on top of the settings gear icon in the activity bar.")),xLt=x("profileBadge.foreground",{dark:U.white,light:"#333333",hcDark:U.black,hcLight:U.white},h("profileBadgeForeground","Profile badge foreground color. The profile badge shows on top of the settings gear icon in the activity bar.")),TLt=x("statusBarItem.remoteBackground",h9,h("statusBarItemHostBackground","Background color for the remote indicator on the status bar.")),wX=x("statusBarItem.remoteForeground",m9,h("statusBarItemHostForeground","Foreground color for the remote indicator on the status bar.")),_Lt=x("statusBarItem.remoteHoverForeground",FI,h("statusBarRemoteItemHoverForeground","Foreground color for the remote indicator on the status bar when hovering.")),DLt=x("statusBarItem.remoteHoverBackground",{dark:Ru,light:Ru,hcDark:Ru,hcLight:null},h("statusBarRemoteItemHoverBackground","Background color for the remote indicator on the status bar when hovering.")),LLt=x("statusBarItem.offlineBackground","#6c1717",h("statusBarItemOfflineBackground","Status bar item background color when the workbench is offline.")),kLt=x("statusBarItem.offlineForeground",wX,h("statusBarItemOfflineForeground","Status bar item foreground color when the workbench is offline.")),RLt=x("statusBarItem.offlineHoverForeground",FI,h("statusBarOfflineItemHoverForeground","Status bar item foreground hover color when the workbench is offline.")),ALt=x("statusBarItem.offlineHoverBackground",{dark:Ru,light:Ru,hcDark:Ru,hcLight:null},h("statusBarOfflineItemHoverBackground","Status bar item background hover color when the workbench is offline.")),MLt=x("extensionBadge.remoteBackground",h9,h("extensionBadge.remoteBackground","Background color for the remote badge in the extensions view.")),OLt=x("extensionBadge.remoteForeground",m9,h("extensionBadge.remoteForeground","Foreground color for the remote badge in the extensions view.")),rD=x("sideBar.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},h("sideBarBackground","Side bar background color. The side bar is the container for views like explorer and search.")),g9=x("sideBar.foreground",null,h("sideBarForeground","Side bar foreground color. The side bar is the container for views like explorer and search.")),PLt=x("sideBar.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("sideBarBorder","Side bar border color on the side separating to the editor. The side bar is the container for views like explorer and search.")),NLt=x("sideBarTitle.background",rD,h("sideBarTitleBackground","Side bar title background color. The side bar is the container for views like explorer and search.")),FLt=x("sideBarTitle.foreground",g9,h("sideBarTitleForeground","Side bar title foreground color. The side bar is the container for views like explorer and search.")),NN=x("sideBar.dropBackground",oD,h("sideBarDragAndDropBackground","Drag and drop feedback color for the side bar sections. The color should have transparency so that the side bar sections can still shine through. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),f9=x("sideBarSectionHeader.background",{dark:U.fromHex("#808080").transparent(.2),light:U.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},h("sideBarSectionHeaderBackground","Side bar section header background color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),b9=x("sideBarSectionHeader.foreground",g9,h("sideBarSectionHeaderForeground","Side bar section header foreground color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),FN=x("sideBarSectionHeader.border",Ie,h("sideBarSectionHeaderBorder","Side bar section header border color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),BLt=x("sideBarActivityBarTop.border",FN,h("sideBarActivityBarTopBorder","Border color between the activity bar at the top/bottom and the views.")),v9=x("sideBarStickyScroll.background",rD,h("sideBarStickyScrollBackground","Background color of sticky scroll in the side bar.")),y9=x("sideBarStickyScroll.border",null,h("sideBarStickyScrollBorder","Border color of sticky scroll in the side bar.")),I9=x("sideBarStickyScroll.shadow",pu,h("sideBarStickyScrollShadow","Shadow color of sticky scroll in the side bar.")),rd=x("titleBar.activeForeground",{dark:"#CCCCCC",light:"#333333",hcDark:"#FFFFFF",hcLight:"#292929"},h("titleBarActiveForeground","Title bar foreground when the window is active.")),C9=x("titleBar.inactiveForeground",{dark:Ce(rd,.6),light:Ce(rd,.6),hcDark:null,hcLight:"#292929"},h("titleBarInactiveForeground","Title bar foreground when the window is inactive.")),B7=x("titleBar.activeBackground",{dark:"#3C3C3C",light:"#DDDDDD",hcDark:"#000000",hcLight:"#FFFFFF"},h("titleBarActiveBackground","Title bar background when the window is active.")),VLt=x("titleBar.inactiveBackground",{dark:Ce(B7,.6),light:Ce(B7,.6),hcDark:null,hcLight:null},h("titleBarInactiveBackground","Title bar background when the window is inactive.")),WLt=x("titleBar.border",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("titleBarBorder","Title bar border color.")),xX=x("menubar.selectionForeground",rd,h("menubarSelectionForeground","Foreground color of the selected menu item in the menubar.")),V7=x("menubar.selectionBackground",{dark:Hy,light:Hy,hcDark:null,hcLight:null},h("menubarSelectionBackground","Background color of the selected menu item in the menubar.")),HLt=x("menubar.selectionBorder",{dark:null,light:null,hcDark:Ft,hcLight:Ft},h("menubarSelectionBorder","Border color of the selected menu item in the menubar.")),ULt=x("commandCenter.foreground",rd,h("commandCenter-foreground","Foreground color of the command center"),!1),zLt=x("commandCenter.activeForeground",xX,h("commandCenter-activeForeground","Active foreground color of the command center"),!1),KLt=x("commandCenter.inactiveForeground",C9,h("commandCenter-inactiveForeground","Foreground color of the command center when the window is inactive"),!1),GLt=x("commandCenter.background",{dark:U.white.transparent(.05),hcDark:null,light:U.black.transparent(.05),hcLight:null},h("commandCenter-background","Background color of the command center"),!1),jLt=x("commandCenter.activeBackground",{dark:U.white.transparent(.08),hcDark:V7,light:U.black.transparent(.08),hcLight:V7},h("commandCenter-activeBackground","Active background color of the command center"),!1),qLt=x("commandCenter.border",{dark:Ce(rd,.2),hcDark:Ie,light:Ce(rd,.2),hcLight:Ie},h("commandCenter-border","Border color of the command center"),!1),$Lt=x("commandCenter.activeBorder",{dark:Ce(rd,.3),hcDark:rd,light:Ce(rd,.3),hcLight:rd},h("commandCenter-activeBorder","Active border color of the command center"),!1),YLt=x("commandCenter.inactiveBorder",Ce(C9,.25),h("commandCenter-inactiveBorder","Border color of the command center when the window is inactive"),!1),ZLt=x("notificationCenter.border",{dark:Xp,light:Xp,hcDark:Ie,hcLight:Ie},h("notificationCenterBorder","Notifications center border color. Notifications slide in from the bottom right of the window.")),XLt=x("notificationToast.border",{dark:Xp,light:Xp,hcDark:Ie,hcLight:Ie},h("notificationToastBorder","Notification toast border color. Notifications slide in from the bottom right of the window.")),QLt=x("notifications.foreground",Bl,h("notificationsForeground","Notifications foreground color. Notifications slide in from the bottom right of the window.")),Y_=x("notifications.background",vo,h("notificationsBackground","Notifications background color. Notifications slide in from the bottom right of the window.")),JLt=x("notificationLink.foreground",ux,h("notificationsLink","Notification links foreground color. Notifications slide in from the bottom right of the window.")),ekt=x("notificationCenterHeader.foreground",null,h("notificationCenterHeaderForeground","Notifications center header foreground color. Notifications slide in from the bottom right of the window.")),TX=x("notificationCenterHeader.background",{dark:ur(Y_,.3),light:Yo(Y_,.05),hcDark:Y_,hcLight:Y_},h("notificationCenterHeaderBackground","Notifications center header background color. Notifications slide in from the bottom right of the window.")),tkt=x("notifications.border",TX,h("notificationsBorder","Notifications border color separating from other notifications in the notifications center. Notifications slide in from the bottom right of the window.")),ikt=x("notificationsErrorIcon.foreground",Zp,h("notificationsErrorIconForeground","The color used for the icon of error notifications. Notifications slide in from the bottom right of the window.")),nkt=x("notificationsWarningIcon.foreground",hr,h("notificationsWarningIconForeground","The color used for the icon of warning notifications. Notifications slide in from the bottom right of the window.")),okt=x("notificationsInfoIcon.foreground",ts,h("notificationsInfoIconForeground","The color used for the icon of info notifications. Notifications slide in from the bottom right of the window.")),rkt=x("window.activeBorder",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("windowActiveBorder","The color used for the border of the window when it is active. Only supported in the macOS and Linux desktop client when using the custom title bar.")),skt=x("window.inactiveBorder",{dark:null,light:null,hcDark:Ie,hcLight:Ie},h("windowInactiveBorder","The color used for the border of the window when it is inactive. Only supported in the macOS and Linux desktop client when using the custom title bar."));var Au=class extends od{constructor(t,i,n,o,s,a,l,d,c,u){super(t,i,o,d,a);this.instantiationService=s;this.textResourceConfigurationService=l;this.editorService=c;this.editorGroupService=u;this.viewState=this.getEditorMemento(u,l,n,100)}viewState;groupListener=this._register(new xt);editorViewStateDisposables;setEditorVisible(t){this.groupListener.value=this.group.onWillCloseEditor(i=>this.onWillCloseEditor(i)),super.setEditorVisible(t)}onWillCloseEditor(t){let i=t.editor;i===this.input&&this.updateEditorViewState(i)}clearInput(){this.updateEditorViewState(this.input),super.clearInput()}saveState(){this.updateEditorViewState(this.input),super.saveState()}updateEditorViewState(t){if(!t||!this.tracksEditorViewState(t))return;let i=this.toEditorViewStateResource(t);i&&(this.tracksDisposedEditorViewState()||(this.editorViewStateDisposables||(this.editorViewStateDisposables=new Map),this.editorViewStateDisposables.has(t)||this.editorViewStateDisposables.set(t,z.once(t.onWillDispose)(()=>{this.clearEditorViewState(i,this.group),this.editorViewStateDisposables?.delete(t)}))),t.isDisposed()&&!this.tracksDisposedEditorViewState()||!this.shouldRestoreEditorViewState(t)&&!this.group.contains(t)?this.clearEditorViewState(i,this.group):t.isDisposed()||this.saveEditorViewState(i))}shouldRestoreEditorViewState(t,i){return i?.newInGroup?this.textResourceConfigurationService.getValue(Mt.getOriginalUri(t,{supportSideBySide:1}),"workbench.editor.restoreViewState")!==!1:!0}getViewState(){let t=this.input;if(!t||!this.tracksEditorViewState(t))return;let i=this.toEditorViewStateResource(t);if(i)return this.computeEditorViewState(i)}saveEditorViewState(t){let i=this.computeEditorViewState(t);i&&this.viewState.saveEditorState(this.group,t,i)}loadEditorViewState(t,i){if(!t||!this.tracksEditorViewState(t)||!this.shouldRestoreEditorViewState(t,i))return;let n=this.toEditorViewStateResource(t);if(n)return this.viewState.loadEditorState(this.group,n)}moveEditorViewState(t,i,n){return this.viewState.moveEditorState(t,i,n)}clearEditorViewState(t,i){this.viewState.clearEditorState(t,i)}dispose(){if(super.dispose(),this.editorViewStateDisposables){for(let[,t]of this.editorViewStateDisposables)t.dispose();this.editorViewStateDisposables=void 0}}tracksDisposedEditorViewState(){return!1}};Au=R([y(3,jt),y(4,ve),y(5,Ii),y(6,_r),y(7,kt),y(8,vt),y(9,Ri)],Au);function DX(r){let e=r;return typeof e?.primary=="object"&&typeof e.secondary=="object"}var Za=class extends Au{constructor(t,i,n,o,s,a,l,d,c){super(Za.ID,t,Za.VIEW_STATE_PREFERENCE_KEY,i,n,s,l,o,d,c);this.configurationService=a;this.registerListeners()}static ID=C8;static SIDE_BY_SIDE_LAYOUT_SETTING="workbench.editor.splitInGroupLayout";static VIEW_STATE_PREFERENCE_KEY="sideBySideEditorViewState";get minimumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.minimumWidth:0}get maximumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.minimumHeight:0}get maximumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}get minimumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumWidth:0}get maximumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumHeight:0}get maximumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}set minimumWidth(t){}set maximumWidth(t){}set minimumHeight(t){}set maximumHeight(t){}get minimumWidth(){return this.minimumPrimaryWidth+this.minimumSecondaryWidth}get maximumWidth(){return this.maximumPrimaryWidth+this.maximumSecondaryWidth}get minimumHeight(){return this.minimumPrimaryHeight+this.minimumSecondaryHeight}get maximumHeight(){return this.maximumPrimaryHeight+this.maximumSecondaryHeight}_boundarySashes;onDidCreateEditors=this._register(new _);_onDidChangeSizeConstraints=this._register(new Wr);onDidChangeSizeConstraints=z.any(this.onDidCreateEditors.event,this._onDidChangeSizeConstraints.event);_onDidChangeSelection=this._register(new _);onDidChangeSelection=this._onDidChangeSelection.event;primaryEditorPane=void 0;secondaryEditorPane=void 0;primaryEditorContainer;secondaryEditorContainer;splitview;splitviewDisposables=this._register(new Y);editorDisposables=this._register(new Y);orientation=this.configurationService.getValue(Za.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1;dimension=new At(0,0);lastFocusedSide=void 0;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t.affectsConfiguration(Za.SIDE_BY_SIDE_LAYOUT_SETTING)&&(this.orientation=this.configurationService.getValue(Za.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1,this.splitview&&this.recreateSplitview())}recreateSplitview(){let t=at(this.getContainer()),i=this.getSplitViewRatio();this.splitview&&(this.splitview.el.remove(),this.splitviewDisposables.clear()),this.createSplitView(t,i),this.layout(this.dimension)}getSplitViewRatio(){let t;if(this.splitview){let i=this.splitview.getViewSize(0),n=this.splitview.getViewSize(1);if(Math.abs(i-n)>1){let o=this.splitview.orientation===1?this.dimension.width:this.dimension.height;t=i/o}}return t}createEditor(t){t.classList.add("side-by-side-editor"),this.secondaryEditorContainer=he(".side-by-side-editor-container.editor-instance"),this.primaryEditorContainer=he(".side-by-side-editor-container.editor-instance"),this.createSplitView(t)}createSplitView(t,i){this.splitview=this.splitviewDisposables.add(new Xl(t,{orientation:this.orientation})),this.splitviewDisposables.add(this.splitview.onDidSashReset(()=>this.splitview?.distributeViewSizes())),this.orientation===1?this.splitview.orthogonalEndSash=this._boundarySashes?.bottom:(this.splitview.orthogonalStartSash=this._boundarySashes?.left,this.splitview.orthogonalEndSash=this._boundarySashes?.right);let n=Ql.Distribute,o=Ql.Distribute;if(i){let l=this.splitview.orientation===1?this.dimension.width:this.dimension.height;n=Math.round(l*i),o=l-n,this.splitview.layout(this.orientation===1?this.dimension.width:this.dimension.height)}let s=at(this.secondaryEditorContainer);this.splitview.addView({element:s,layout:l=>this.layoutPane(this.secondaryEditorPane,l),minimumSize:this.orientation===1?Ya.width:Ya.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:z.None},n);let a=at(this.primaryEditorContainer);this.splitview.addView({element:a,layout:l=>this.layoutPane(this.primaryEditorPane,l),minimumSize:this.orientation===1?Ya.width:Ya.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:z.None},o),this.updateStyles()}getTitle(){return this.input?this.input.getName():h("sideBySideEditor","Side by Side Editor")}async setInput(t,i,n,o){let s=this.input;await super.setInput(t,i,n,o),(!s||!t.matches(s))&&(s&&this.disposeEditors(),this.createEditors(t));let{primary:a,secondary:l,viewState:d}=this.loadViewState(t,i,n);if(this.lastFocusedSide=d?.focus,typeof d?.ratio=="number"&&this.splitview){let c=this.splitview.orientation===1?this.dimension.width:this.dimension.height;this.splitview.resizeView(0,Math.round(c*d.ratio))}else this.splitview?.distributeViewSizes();await Promise.all([this.secondaryEditorPane?.setInput(t.secondary,l,n,o),this.primaryEditorPane?.setInput(t.primary,a,n,o)]),typeof i?.target=="number"&&(this.lastFocusedSide=i.target)}loadViewState(t,i,n){let o=DX(i?.viewState)?i?.viewState:this.loadEditorViewState(t,n),s=Object.create(null),a;return i?.target===2?a={...i}:s={...i},s.viewState=o?.primary,o?.secondary&&(a?a.viewState=o?.secondary:a={viewState:o.secondary}),{primary:s,secondary:a,viewState:o}}createEditors(t){this.secondaryEditorPane=this.doCreateEditor(t.secondary,at(this.secondaryEditorContainer)),this.primaryEditorPane=this.doCreateEditor(t.primary,at(this.primaryEditorContainer)),this.layout(this.dimension),this._onDidChangeSizeConstraints.input=z.any(z.map(this.secondaryEditorPane.onDidChangeSizeConstraints,()=>{}),z.map(this.primaryEditorPane.onDidChangeSizeConstraints,()=>{})),this.onDidCreateEditors.fire(void 0),this.editorDisposables.add(this.primaryEditorPane.onDidFocus(()=>this.onDidFocusChange(1))),this.editorDisposables.add(this.secondaryEditorPane.onDidFocus(()=>this.onDidFocusChange(2)))}doCreateEditor(t,i){let n=ze.as(ks.EditorPane).getEditorPane(t);if(!n)throw new Error("No editor pane descriptor for editor found");let o=n.instantiate(this.instantiationService,this.group);return o.create(i),o.setVisible(this.isVisible()),sP(o)&&this.editorDisposables.add(o.onDidChangeSelection(s=>this._onDidChangeSelection.fire(s))),this.editorDisposables.add(o),o}onDidFocusChange(t){this.lastFocusedSide=t,this._onDidChangeControl.fire()}getSelection(){let t=this.getLastFocusedEditorPane();if(sP(t)){let i=t.getSelection();if(i)return new BN(i,t===this.primaryEditorPane?1:2)}}setOptions(t){super.setOptions(t),typeof t?.target=="number"&&(this.lastFocusedSide=t.target),this.getLastFocusedEditorPane()?.setOptions(t)}setEditorVisible(t){this.primaryEditorPane?.setVisible(t),this.secondaryEditorPane?.setVisible(t),super.setEditorVisible(t)}clearInput(){super.clearInput(),this.primaryEditorPane?.clearInput(),this.secondaryEditorPane?.clearInput(),this.disposeEditors()}focus(){super.focus(),this.getLastFocusedEditorPane()?.focus()}getLastFocusedEditorPane(){return this.lastFocusedSide===2?this.secondaryEditorPane:this.primaryEditorPane}layout(t){this.dimension=t,at(this.splitview).layout(this.orientation===1?t.width:t.height)}setBoundarySashes(t){this._boundarySashes=t,this.splitview&&(this.splitview.orthogonalEndSash=t.bottom)}layoutPane(t,i){t?.layout(this.orientation===1?new At(i,this.dimension.height):new At(this.dimension.width,i))}getControl(){return this.getLastFocusedEditorPane()?.getControl()}getPrimaryEditorPane(){return this.primaryEditorPane}getSecondaryEditorPane(){return this.secondaryEditorPane}tracksEditorViewState(t){return t instanceof xi}computeEditorViewState(t){if(!this.input||!Li(t,this.toEditorViewStateResource(this.input)))return;let i=this.primaryEditorPane?.getViewState(),n=this.secondaryEditorPane?.getViewState();if(!(!i||!n))return{primary:i,secondary:n,focus:this.lastFocusedSide,ratio:this.getSplitViewRatio()}}toEditorViewStateResource(t){let i,n;if(t instanceof xi&&(i=t.primary.resource,n=t.secondary.resource),!(!n||!i))return X.from({scheme:"sideBySide",path:`${Om(n.toString())}${Om(i.toString())}`})}updateStyles(){super.updateStyles(),this.primaryEditorContainer&&(this.orientation===1?(this.primaryEditorContainer.style.borderLeftWidth="1px",this.primaryEditorContainer.style.borderLeftStyle="solid",this.primaryEditorContainer.style.borderLeftColor=this.getColor(r9)??"",this.primaryEditorContainer.style.borderTopWidth="0"):(this.primaryEditorContainer.style.borderTopWidth="1px",this.primaryEditorContainer.style.borderTopStyle="solid",this.primaryEditorContainer.style.borderTopColor=this.getColor(o9)??"",this.primaryEditorContainer.style.borderLeftWidth="0"))}dispose(){this.disposeEditors(),super.dispose()}disposeEditors(){this.editorDisposables.clear(),this.secondaryEditorPane=void 0,this.primaryEditorPane=void 0,this.lastFocusedSide=void 0,this.secondaryEditorContainer&&Xt(this.secondaryEditorContainer),this.primaryEditorContainer&&Xt(this.primaryEditorContainer)}};Za=R([y(1,jt),y(2,ve),y(3,kt),y(4,Ii),y(5,He),y(6,_r),y(7,vt),y(8,Ri)],Za);var BN=class r{constructor(e,t){this.selection=e;this.side=t}compare(e){return e instanceof r?this.side!==e.side?3:this.selection.compare(e.selection):3}restore(e){let t={...e,target:this.side};return this.selection.restore(t)}};var Mu=class extends Au{constructor(t,i,n,o,s,a,l,d,c,u){super(t,i,Mu.VIEW_STATE_PREFERENCE_KEY,n,o,s,a,l,d,c);this.fileService=u;this._register(this.textResourceConfigurationService.onDidChangeConfiguration(p=>this.handleConfigurationChangeEvent(p))),this._register(z.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{let p=this.computeAriaLabel();this.editorContainer?.setAttribute("aria-label",p),this.updateEditorControlOptions({ariaLabel:p})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(p=>this.onDidChangeFileSystemProvider(p.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(p=>this.onDidChangeFileSystemProvider(p.scheme)))}static VIEW_STATE_PREFERENCE_KEY="textEditorViewState";_onDidChangeSelection=this._register(new _);onDidChangeSelection=this._onDidChangeSelection.event;_onDidChangeScroll=this._register(new _);onDidChangeScroll=this._onDidChangeScroll.event;editorContainer;hasPendingConfigurationChange;lastAppliedEditorOptions;inputListener=this._register(new xt);handleConfigurationChangeEvent(t){let i=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(t,i)&&(this.isVisible()?this.updateEditorConfiguration(i):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(t,i){return t.affectsConfiguration(i,"editor")||t.affectsConfiguration(i,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.updateEditorConfiguration(),this.hasPendingConfigurationChange=!1)}computeConfiguration(t){let i=gi(t.editor)?Qc(t.editor):Object.create(null);return Object.assign(i,this.getConfigurationOverrides(t)),i.ariaLabel=this.computeAriaLabel(),i}computeAriaLabel(){return this.input?If(this.input,void 0,this.group,this.editorGroupService.count):h("editor","Editor")}onDidChangeFileSystemProvider(t){this.input&&this.getActiveResource()?.scheme===t&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(t){this.input===t&&this.updateReadonly(t)}updateReadonly(t){this.updateEditorControlOptions({...this.getReadonlyConfiguration(t.isReadonly())})}getReadonlyConfiguration(t){return{readOnly:!!t,readOnlyMessage:typeof t!="boolean"?t:void 0}}getConfigurationOverrides(t){return{overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0,...this.getReadonlyConfiguration(this.input?.isReadonly()),renderValidationDecorations:t.problems?.visibility!==!1?"on":"off"}}createEditor(t){this.editorContainer=t,this.createEditorControl(t,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let t=this.getMainControl();t&&(this._register(t.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeCursorPosition(i=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(i)}))),this._register(t.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:3}))),this._register(t.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(t){switch(t.source){case"api":return 1;case"code.navigation":return 4;case"code.jump":return 5;default:return 2}}getSelection(){let t=this.getMainControl();if(t){let i=t.getSelection();if(i)return new VN(i)}}async setInput(t,i,n,o){await super.setInput(t,i,n,o),this.inputListener.value=t.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(t)),this.updateEditorConfiguration(),at(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let t=this.getMainControl();if(!t)throw new Error("Control has not yet been initialized");return{scrollTop:t.getScrollTop()-t.getTopForLineNumber(1),scrollLeft:t.getScrollLeft()}}setScrollPosition(t){let i=this.getMainControl();if(!i)throw new Error("Control has not yet been initialized");i.setScrollTop(t.scrollTop),t.scrollLeft&&i.setScrollLeft(t.scrollLeft)}setEditorVisible(t){t&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(t)}toEditorViewStateResource(t){return t.resource}updateEditorConfiguration(t=this.getActiveResource()){let i;if(t&&(i=this.textResourceConfigurationService.getValue(t)),!i)return;let n=this.computeConfiguration(i),o=n;this.lastAppliedEditorOptions&&(o=$H(this.lastAppliedEditorOptions,o)),Object.keys(o).length>0&&(this.lastAppliedEditorOptions=n,this.updateEditorControlOptions(o))}getActiveResource(){let t=this.getMainControl();if(t){let i=t.getModel();if(i)return i.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}};Mu=R([y(2,jt),y(3,ve),y(4,Ii),y(5,_r),y(6,kt),y(7,vt),y(8,Ri),y(9,Lt)],Mu);var VN=class r{constructor(e){this.textSelection=e}static TEXT_EDITOR_SELECTION_THRESHOLD=10;compare(e){if(!(e instanceof r))return 3;let t=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),i=Math.min(e.textSelection.selectionStartLineNumber,e.textSelection.positionLineNumber);return t===i?1:Math.abs(t-i)<r.TEXT_EDITOR_SELECTION_THRESHOLD?2:3}restore(e){return{...e,selection:this.textSelection,selectionRevealType:1}}log(){return`line: ${this.textSelection.startLineNumber}-${this.textSelection.endLineNumber}, col:  ${this.textSelection.startColumn}-${this.textSelection.endColumn}`}};function WN(r,e,t){let i=!1,n=RX(r);if(lI(n)&&(e.restoreViewState(n),i=!0),r.selection){let o={startLineNumber:r.selection.startLineNumber,startColumn:r.selection.startColumn,endLineNumber:r.selection.endLineNumber??r.selection.startLineNumber,endColumn:r.selection.endColumn??r.selection.startColumn};e.setSelection(o,r.selectionSource??"code.navigation"),r.selectionRevealType===2?e.revealRangeNearTop(o,t):r.selectionRevealType===3?e.revealRangeNearTopIfOutsideViewport(o,t):r.selectionRevealType===1?e.revealRangeInCenterIfOutsideViewport(o,t):e.revealRangeInCenter(o,t),i=!0}return i}function RX(r){if(!r.selection||!r.viewState)return r.viewState;let e=r.viewState;if(e.modified)return e.modified.cursorState=[],e;let t=r.viewState;return t.cursorState&&(t.cursorState=[]),t}var Ef=class extends uu{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}constructor(e,t){super(),this._originalModel=e,this._modifiedModel=t}async resolve(){await Promise.all([this._originalModel?.resolve(),this._modifiedModel?.resolve()])}isResolved(){return!!(this._originalModel?.isResolved()&&this._modifiedModel?.isResolved())}dispose(){super.dispose()}};var wf=class extends Ef{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}_textDiffEditorModel=void 0;get textDiffEditorModel(){return this._textDiffEditorModel}constructor(e,t){super(e,t),this._originalModel=e,this._modifiedModel=t,this.updateTextDiffEditorModel()}async resolve(){await super.resolve(),this.updateTextDiffEditorModel()}updateTextDiffEditorModel(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this._textDiffEditorModel?(this._textDiffEditorModel.original=this.originalModel.textEditorModel,this._textDiffEditorModel.modified=this.modifiedModel.textEditorModel):this._textDiffEditorModel={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this._textDiffEditorModel}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this._textDiffEditorModel=void 0,super.dispose()}};var Jo=class extends xi{constructor(t,i,n,o,s,a){super(t,i,n,o,a);this.original=n;this.modified=o;this.forceOpenAsBinary=s}static ID="workbench.editors.diffEditorInput";get typeId(){return Jo.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let t=super.capabilities;return this.labels.forceDescription&&(t|=64),t}cachedModel=void 0;labels=this.computeLabels();computeLabels(){let t,i=!1;if(this.preferredName)t=this.preferredName;else{let u=this.original.getName(),p=this.modified.getName();t=h("sideBySideLabels","{0} \u2194 {1}",u,p),i=u===p}let n,o,s;if(this.preferredDescription)n=this.preferredDescription,o=this.preferredDescription,s=this.preferredDescription;else{n=this.computeLabel(this.original.getDescription(0),this.modified.getDescription(0)),s=this.computeLabel(this.original.getDescription(2),this.modified.getDescription(2));let u=this.original.getDescription(1),p=this.modified.getDescription(1);if(typeof u=="string"&&typeof p=="string"&&(u||p)){let[m,f]=Jx([u,p]);o=this.computeLabel(m,f)}}let a=this.computeLabel(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),l=this.computeLabel(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),d=this.computeLabel(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 "),c=this.getPreferredTitle();return c&&(a=`${c} (${a})`,l=`${c} (${l})`,d=`${c} (${d})`),{name:t,shortDescription:n,mediumDescription:o,longDescription:s,forceDescription:i,shortTitle:a,mediumTitle:l,longTitle:d}}computeLabel(t,i,n=" - "){if(!(!t||!i))return t===i?i:`${t}${n}${i}`}getName(){return this.labels.name}getDescription(t=1){switch(t){case 0:return this.labels.shortDescription;case 2:return this.labels.longDescription;case 1:default:return this.labels.mediumDescription}}getTitle(t){switch(t){case 0:return this.labels.shortTitle;case 2:return this.labels.longTitle;default:case 1:return this.labels.mediumTitle}}async resolve(){let t=await this.createModel();return this.cachedModel?.dispose(),this.cachedModel=t,this.cachedModel}prefersEditorPane(t){return this.forceOpenAsBinary?t.find(i=>i.typeId===S8):t.find(i=>i.typeId===jg)}async createModel(){let[t,i]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return i instanceof Fa&&t instanceof Fa?new wf(t,i):new Ef(DM(t)?t:void 0,DM(i)?i:void 0)}toUntyped(t){let i=super.toUntyped(t);if(i)return{...i,modified:i.primary,original:i.secondary}}matches(t){return this===t?!0:t instanceof Jo?this.modified.matches(t.modified)&&this.original.matches(t.original)&&t.forceOpenAsBinary===this.forceOpenAsBinary:Ls(t)?this.modified.matches(t.modified)&&this.original.matches(t.original):!1}dispose(){this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=void 0),super.dispose()}};Jo=R([y(5,vt)],Jo);var sd=Z("codeEditorService");var Th=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let t of e){let i=t.kbExpr;this.precondition&&(i?i=Ue.and(i,this.precondition):i=this.precondition);let n={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};fn.registerKeybindingRule(n)}}Nn.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){Go.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}},BI=class extends Th{_implementations=[];addImplementation(e,t,i,n){return this._implementations.push({priority:e,name:t,implementation:i,when:n}),this._implementations.sort((o,s)=>s.priority-o.priority),{dispose:()=>{for(let o=0;o<this._implementations.length;o++)if(this._implementations[o].implementation===i){this._implementations.splice(o,1);return}}}}runCommand(e,t){let i=e.get(Oi),n=e.get(je);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let o of this._implementations){if(o.when){let a=n.getContext(mn());if(!o.when.evaluate(a))continue}let s=o.implementation(e,t);if(s)return i.trace(`Command '${this.id}' was handled by '${o.name}'.`),typeof s=="boolean"?void 0:s}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}},sD=class extends Th{constructor(t,i){super(i);this.command=t}runCommand(t,i){return this.command.runCommand(t,i)}},VI=class r extends Th{static bindToContribution(e){return class extends r{_callback;constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,o){let s=e(n);s&&this._callback(s,o)}}}static runEditorCommand(e,t,i,n){let o=e.get(sd),s=o.getFocusedCodeEditor()||o.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(je).contextMatchesRules(i??void 0))return n(a,s,t)})}runCommand(e,t){return r.runEditorCommand(e,t,this.precondition,(i,n,o)=>this.runEditorCommand(i,n,o))}};function et(r){return ad.INSTANCE.registerEditorCommand(r),r}function S9(r,e,t){ad.INSTANCE.registerEditorContribution(r,e,t)}var _h;(o=>{function r(s){return ad.INSTANCE.getEditorCommand(s)}o.getEditorCommand=r;function e(){return ad.INSTANCE.getEditorActions()}o.getEditorActions=e;function t(){return ad.INSTANCE.getEditorContributions()}o.getEditorContributions=t;function i(s){return ad.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}o.getSomeEditorContributions=i;function n(){return ad.INSTANCE.getDiffEditorContributions()}o.getDiffEditorContributions=n})(_h||={});var AX={EditorCommonContributions:"editor.contributions"},ad=class r{static INSTANCE=new r;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(e,t){this.diffEditorContributions.push({id:e,ctor:t})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};ze.add(AX.EditorCommonContributions,ad.INSTANCE);function WI(r){return r.register(),r}var HN=WI(new BI({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:nt.MenubarEditMenu,group:"1_do",title:h({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:nt.CommandPalette,group:"",title:h("undo","Undo"),order:1}]}));WI(new sD(HN,{id:"default:undo",precondition:void 0}));var UN=WI(new BI({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:nt.MenubarEditMenu,group:"1_do",title:h({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:nt.CommandPalette,group:"",title:h("redo","Redo"),order:1}]}));WI(new sD(UN,{id:"default:redo",precondition:void 0}));var E9=WI(new BI({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:nt.MenubarSelectionMenu,group:"1_basic",title:h({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:nt.CommandPalette,group:"",title:h("selectAll","Select All"),order:1}]}));var aD=class r{constructor(e,t,i,n,o){this._initialScrollTop=e;this._initialContentHeight=t;this._visiblePosition=i;this._visiblePositionScrollDelta=n;this._cursorPosition=o}static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new r(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0,n=e.getVisibleRanges();if(n.length>0){t=n[0].getStartPosition();let o=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-o}return new r(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){let t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;let t=e.getPosition();if(!this._cursorPosition||!t)return;let i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i,1)}};var w9=Z("markerDecorationsService");var xf=class{static ID="editor.contrib.markerDecorations";constructor(e,t){}dispose(){}};xf=R([y(1,w9)],xf);S9(xf.ID,xf,0);var lc;(D=>{let r={total:0,min:Number.MAX_VALUE,max:0},e={...r},t={...r},i={...r},n=0,o;(j=>(j[j.Before=0]="Before",j[j.InProgress=1]="InProgress",j[j.Finished=2]="Finished"))(o||={});let s={keydown:0,input:0,render:0};function a(){v(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}D.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,b()}D.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(u)}D.onInput=c;function u(){s.input===1&&(performance.mark("input/end"),s.input=2)}function p(){v()}D.onKeyUp=p;function m(){v()}D.onSelectionChange=m;function f(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(g),b())}D.onRenderStart=f;function g(){s.render===1&&(performance.mark("render/end"),s.render=2)}function b(){setTimeout(v)}function v(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),I("keydown",r),I("input",e),I("render",t),I("inputlatency",i),n++,w())}function I(L,A){let W=performance.getEntriesByName(L)[0].duration;A.total+=W,A.min=Math.min(A.min,W),A.max=Math.max(A.max,W)}function w(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function E(){if(n===0)return;let L={keydown:S(r),input:S(e),render:S(t),total:S(i),sampleCount:n};return T(r),T(e),T(t),T(i),n=0,L}D.getAndClearMeasurements=E;function S(L){return{average:L.total/n,max:L.max,min:L.min}}function T(L){L.total=0,L.min=Number.MAX_VALUE,L.max=0}})(lc||={});var Ou=class{constructor(e,t){this.x=e;this.y=t}_pageCoordinatesBrand=void 0;toClientCoordinates(e){return new HI(this.x-e.scrollX,this.y-e.scrollY)}},HI=class{constructor(e,t){this.clientX=e;this.clientY=t}_clientCoordinatesBrand=void 0;toPageCoordinates(e){return new Ou(this.clientX+e.scrollX,this.clientY+e.scrollY)}},zN=class{constructor(e,t,i,n){this.x=e;this.y=t;this.width=i;this.height=n}_editorPagePositionBrand=void 0},KN=class{constructor(e,t){this.x=e;this.y=t}_positionRelativeToEditorBrand=void 0};function uD(r){let e=po(r);return new zN(e.left,e.top,e.width,e.height)}function pD(r,e,t){let i=e.width/r.offsetWidth,n=e.height/r.offsetHeight,o=(t.x-e.x)/i,s=(t.y-e.y)/n;return new KN(o,s)}var aa=class extends Ei{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(e,t,i){super(pe(i),e),this.isFromPointerCapture=t,this.pos=new Ou(this.posx,this.posy),this.editorPos=uD(i),this.relativePos=pD(i,this.editorPos,this.pos)}},lD=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new aa(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return B(e,"contextmenu",i=>{t(this._create(i))})}onMouseUp(e,t){return B(e,"mouseup",i=>{t(this._create(i))})}onMouseDown(e,t){return B(e,Q.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return B(e,Q.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return B(e,Q.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return B(e,"mousemove",i=>t(this._create(i)))}},dD=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new aa(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return B(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return B(e,Q.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return B(e,Q.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return B(e,"pointermove",i=>t(this._create(i)))}},cD=class extends P{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new wl),this._keydownListener=null}startMonitoring(e,t,i,n,o){this._keydownListener=si(e.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,s=>{n(new aa(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),o(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var hD=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(e,t,i,n){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new O(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var GN=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},mD=class extends GN{_renderingContextBrand=void 0;_viewLines;constructor(e,t,i){super(e,t),this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}},gD=class{constructor(e,t,i,n){this.outsideRenderedLine=e;this.lineNumber=t;this.ranges=i;this.continuesOnNextLine=n}static firstLine(e){if(!e)return null;let t=null;for(let i of e)(!t||i.lineNumber<t.lineNumber)&&(t=i);return t}static lastLine(e){if(!e)return null;let t=null;for(let i of e)(!t||i.lineNumber>t.lineNumber)&&(t=i);return t}},Tf=class r{_horizontalRangeBrand=void 0;left;width;static from(e){let t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){let o=e[i];t[i]=new r(o.left,o.width)}return t}constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}},Xa=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}},fD=class{outsideRenderedLine;left;originalLeft;constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}},UI=class{constructor(e,t){this.outsideRenderedLine=e;this.ranges=t}};var bD=class{configuration;viewModel;viewLayout;theme;constructor(e,t,i){this.configuration=e,this.theme=new TT(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}};var pi=class extends ra{_context;constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var Vn=class{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let i=[],n=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement;let o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=i[n-s-1];return o}};function Pu(r,e){let t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(r,e)}catch(i){Ge(i);return}try{return globalThis.trustedTypes?.createPolicy(r,e)}catch(i){Ge(i);return}}var zI=class{constructor(e){this._lineFactory=e;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Je("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;let i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){let l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>n)return null;let o=0,s=0;for(let l=i;l<=n;l++){let d=l-this._rendLineNumberStart;e<=l&&l<=t&&(s===0?(o=d,s=1):s++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(o,s)}onLinesChanged(e,t){let i=e+t-1;if(this.getCount()===0)return!1;let n=this.getStartLineNumber(),o=this.getEndLineNumber(),s=!1;for(let a=e;a<=i;a++)a>=n&&a<=o&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;let i=t-e+1,n=this.getStartLineNumber(),o=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>o)return null;if(i+e>o)return this._lines.splice(e-this._rendLineNumberStart,o-e+1);let s=[];for(let u=0;u<i;u++)s[u]=this._lineFactory.createLine();let a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-i),c=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(e){if(this.getCount()===0)return!1;let t=this.getStartLineNumber(),i=this.getEndLineNumber(),n=!1;for(let o=0,s=e.length;o<s;o++){let a=e[o];if(a.toLineNumber<t||a.fromLineNumber>i)continue;let l=Math.max(t,a.fromLineNumber),d=Math.min(i,a.toLineNumber);for(let c=l;c<=d;c++){let u=c-this._rendLineNumberStart;this._lines[u].onTokensChanged(),n=!0}}return n}},_f=class{constructor(e){this._lineFactory=e}domNode=this._createDomNode();_linesCollection=new zI(this._lineFactory);_createDomNode(){let e=$e(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(147)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++)t[i].getDomNode()?.remove();return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++)t[i].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),i=new jN(this.domNode.domNode,this._lineFactory,e),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},o=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}},jN=class r{constructor(e,t,i){this._domNode=e;this._lineFactory=t;this._viewportData=i}static _ttPolicy=Pu("editorViewLayer",{createHTML:e=>e});render(e,t,i,n){let o={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(o.rendLineNumberStart+o.linesLength-1<t||i<o.rendLineNumberStart){o.rendLineNumberStart=t,o.linesLength=i-t+1,o.lines=[];for(let s=t;s<=i;s++)o.lines[s-t]=this._lineFactory.createLine();return this._finishRendering(o,!0,n),o}if(this._renderUntouchedLines(o,Math.max(t-o.rendLineNumberStart,0),Math.min(i-o.rendLineNumberStart,o.linesLength-1),n,t),o.rendLineNumberStart>t){let s=t,a=Math.min(i,o.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(o,s,a,n,t),o.linesLength+=a-s+1)}else if(o.rendLineNumberStart<t){let s=Math.min(o.linesLength,t-o.rendLineNumberStart);s>0&&(this._removeLinesBefore(o,s),o.linesLength-=s)}if(o.rendLineNumberStart=t,o.rendLineNumberStart+o.linesLength-1<i){let s=o.rendLineNumberStart+o.linesLength,a=i;s<=a&&(this._insertLinesAfter(o,s,a,n,t),o.linesLength+=a-s+1)}else if(o.rendLineNumberStart+o.linesLength-1>i){let s=Math.max(0,i-o.rendLineNumberStart+1),l=o.linesLength-1-s+1;l>0&&(this._removeLinesAfter(o,l),o.linesLength-=l)}return this._finishRendering(o,!1,n),o}_renderUntouchedLines(e,t,i,n,o){let s=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){let d=s+l;a[l].layoutLine(d,n[d-o],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,i,n,o){let s=[],a=0;for(let l=t;l<=i;l++)s[a++]=this._lineFactory.createLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++)e.lines[i].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,o){let s=[],a=0;for(let l=t;l<=i;l++)s[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){let i=e.linesLength-t;for(let n=0;n<t;n++)e.lines[i+n].getDomNode()?.remove();e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){r._ttPolicy&&(i=r._ttPolicy.createHTML(i));let o=this._domNode.lastChild;t||!o?this._domNode.innerHTML=i:o.insertAdjacentHTML("afterend",i);let s=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){let l=e.lines[a];n[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,i){let n=document.createElement("div");r._ttPolicy&&(t=r._ttPolicy.createHTML(t)),n.innerHTML=t;for(let o=0;o<e.linesLength;o++){let s=e.lines[o];if(i[o]){let a=n.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new Rl(1e5);_finishRendering(e,t,i){let n=r._sb,o=e.linesLength,s=e.lines,a=e.rendLineNumberStart,l=[];{n.reset();let d=!1;for(let c=0;c<o;c++){let u=s[c];l[c]=!1,!(u.getDomNode()||!u.renderLine(c+a,i[c],this._viewportData.lineHeight,this._viewportData,n))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,n.build(),l)}{n.reset();let d=!1,c=[];for(let u=0;u<o;u++){let p=s[u];c[u]=!1,!(l[u]||!p.renderLine(u+a,i[u],this._viewportData.lineHeight,this._viewportData,n))&&(c[u]=!0,d=!0)}d&&this._finishRenderingInvalidLines(e,n.build(),c)}}};var Df=class{constructor(e,t){this._domNode=e;this.endNode=t}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var Dh=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,o){let s=this._createRange();try{return s.setStart(e,t),s.setEnd(i,n),s.getClientRects()}catch{return null}finally{this._detachRange(s,o)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Xa.compare);let t=[],i=0,n=e[0];for(let o=1,s=e.length;o<s;o++){let a=e[o];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(t[i++]=n,n=a)}return t[i++]=n,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o];n[o]=new Xa(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,i,n,o,s){let l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),n=Math.min(l,Math.max(0,n)),t===n&&i===o&&i===0&&!e.children[t].firstChild){let p=e.children[t].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(p,s.clientRectDeltaLeft,s.clientRectScale)}t!==n&&n>0&&o===0&&(n--,o=1073741824);let d=e.children[t].firstChild,c=e.children[n].firstChild;if((!d||!c)&&(!d&&i===0&&t>0&&(d=e.children[t-1].firstChild,i=1073741824),!c&&o===0&&n>0&&(c=e.children[n-1].firstChild,o=1073741824)),!d||!c)return null;i=Math.min(d.textContent.length,Math.max(0,i)),o=Math.min(c.textContent.length,Math.max(0,o));let u=this._readClientRects(d,i,c,o,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,s.clientRectDeltaLeft,s.clientRectScale)}};var nn=class{constructor(e,t,i,n){this.endIndex=e;this.type=t;this.metadata=i;this.containsRTL=n}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var la=class r{constructor(e,t,i,n){this.startColumn=e;this.endColumn=t;this.className=i;this.type=n}_lineDecorationBrand=void 0;static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){let i=e.length,n=t.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!r._equals(e[o],t[o]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;let n=t+1,o=i+1,s=i-t,a=[],l=0;for(let d of e)d.endColumn<=n||d.startColumn>=o||(a[l++]=new r(Math.max(1,d.startColumn-n+1),Math.min(s+1,d.endColumn-n+1),d.className,d.type));return a}static filter(e,t,i,n){if(e.length===0)return[];let o=[],s=0;for(let a=0,l=e.length;a<l;a++){let d=e[a],c=d.range;if(c.endLineNumber<t||c.startLineNumber>t||c.isEmpty()&&(d.type===0||d.type===3))continue;let u=c.startLineNumber===t?c.startColumn:i,p=c.endLineNumber===t?c.endColumn:n;o[s++]=new r(u,p,d.inlineClassName,d.type)}return o}static _typeCompare(e,t){let i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;let i=r._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}},vD=class{startOffset;endOffset;className;metadata;constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=n}},qN=class r{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,n=e.length;i<n;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new vD(t,this.stopOffsets[n],this.classNames.join(" "),r._metadata(this.metadata))),t=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&t<e&&(i.push(new vD(t,e-1,this.classNames.join(" "),r._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=e){this.stopOffsets.splice(n,0,e),this.classNames.splice(n,0,t),this.metadata.splice(n,0,i);break}this.count++}},yD=class{static normalize(e,t){if(t.length===0)return[];let i=[],n=new qN,o=0;for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.startColumn,c=l.endColumn,u=l.className,p=l.type===1?2:l.type===2?4:0;if(d>1){let g=e.charCodeAt(d-2);Di(g)&&d--}if(c>1){let g=e.charCodeAt(c-2);Di(g)&&c--}let m=d-1,f=c-2;o=n.consumeLowerThan(m,o,i),n.count===0&&(o=m),n.insert(f,u,p)}return n.consumeLowerThan(1073741824,o,i),i}};var Lf=class{startOffset;endOffset;constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}},Nu=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(e,t,i,n,o,s,a,l,d,c,u,p,m,f,g,b,v,I,w){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=o,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(la.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=p,this.stopRenderingLineAfter=g,this.renderWhitespace=b==="all"?4:b==="boundary"?1:b==="selection"?2:b==="trailing"?3:0,this.renderControlCharacters=v,this.fontLigatures=I,this.selectionsOnLine=w&&w.sort((T,D)=>T.startOffset<D.startOffset?-1:1);let E=Math.abs(f-p),S=Math.abs(m-p);E<S?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=m,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&la.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}};var KI=class{constructor(e,t){this.partIndex=e;this.charIndex=t}},GI=class r{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}length;_data;_horizontalOffset;constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,n){let o=(t<<16|i<<0)>>>0;this._data[e-1]=o,this._horizontalOffset[e-1]=n}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){let t=this.charOffsetToPartData(e-1),i=r.getPartIndex(t),n=r.getCharIndex(t);return new KI(i,n)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;let n=(e<<16|i<<0)>>>0,o=0,s=this.length-1;for(;o+1<s;){let g=o+s>>>1,b=this._data[g];if(b===n)return g;b>n?s=g:o=g}if(o===s)return o;let a=this._data[o],l=this._data[s];if(a===n)return o;if(l===n)return s;let d=r.getPartIndex(a),c=r.getCharIndex(a),u=r.getPartIndex(l),p;d!==u?p=t:p=r.getCharIndex(l);let m=i-c,f=p-i;return m<=f?o:s}inflate(){let e=[];for(let t=0;t<this.length;t++){let i=this._data[t],n=r.getPartIndex(i),o=r.getCharIndex(i),s=this._horizontalOffset[t];e.push([n,o,s])}return e}};var jI=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(e,t,i){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}};function qI(r,e){if(r.lineContent.length===0){if(r.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,n=0;for(let s of r.lineDecorations)(s.type===1||s.type===2)&&(e.appendString('<span class="'),e.appendString(s.className),e.appendString('"></span>'),s.type===1&&(n|=1,t++),s.type===2&&(n|=2,i++));e.appendString("</span>");let o=new GI(1,t+i);return o.setColumnInfo(1,t,0,0),new jI(o,!1,n)}return e.appendString("<span><span></span></span>"),new jI(new GI(0,0),!1,0)}return HX(PX(r),e)}var $N=class{constructor(e,t,i,n){this.characterMapping=e;this.html=t;this.containsRTL=i;this.containsForeignElements=n}};function x9(r){let e=new Rl(1e4),t=qI(r,e);return new $N(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}var YN=class{constructor(e,t,i,n,o,s,a,l,d,c,u,p,m,f,g,b){this.fontIsMonospace=e;this.canUseHalfwidthRightwardsArrow=t;this.lineContent=i;this.len=n;this.isOverflowing=o;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=u;this.containsRTL=p;this.spaceWidth=m;this.renderSpaceCharCode=f;this.renderWhitespace=g;this.renderControlCharacters=b}};function PX(r){let e=r.lineContent,t,i,n;r.stopRenderingLineAfter!==-1&&r.stopRenderingLineAfter<e.length?(t=!0,i=e.length-r.stopRenderingLineAfter,n=r.stopRenderingLineAfter):(t=!1,i=0,n=e.length);let o=NX(e,r.containsRTL,r.lineTokens,r.fauxIndentLength,n);r.renderControlCharacters&&!r.isBasicASCII&&(o=BX(e,o)),(r.renderWhitespace===4||r.renderWhitespace===1||r.renderWhitespace===2&&r.selectionsOnLine||r.renderWhitespace===3&&!r.continuesWithWrappedLine)&&(o=VX(r,e,n,o));let s=0;if(r.lineDecorations.length>0){for(let a=0,l=r.lineDecorations.length;a<l;a++){let d=r.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}o=WX(e,n,o,r.lineDecorations)}return r.containsRTL||(o=FX(e,o,!r.isBasicASCII||r.fontLigatures)),new YN(r.useMonospaceOptimizations,r.canUseHalfwidthRightwardsArrow,e,n,t,i,o,s,r.fauxIndentLength,r.tabSize,r.startVisibleColumn,r.containsRTL,r.spaceWidth,r.renderSpaceCharCode,r.renderWhitespace,r.renderControlCharacters)}function NX(r,e,t,i,n){let o=[],s=0;i>0&&(o[s++]=new nn(i,"",0,!1));let a=i;for(let l=0,d=t.getCount();l<d;l++){let c=t.getEndOffset(l);if(c<=i)continue;let u=t.getClassName(l);if(c>=n){let m=e?Rd(r.substring(a,n)):!1;o[s++]=new nn(n,u,0,m);break}let p=e?Rd(r.substring(a,c)):!1;o[s++]=new nn(c,u,0,p),a=c}return o}function FX(r,e,t){let i=0,n=[],o=0;if(t)for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex;if(i+50<d){let c=l.type,u=l.metadata,p=l.containsRTL,m=-1,f=i;for(let g=i;g<d;g++)r.charCodeAt(g)===32&&(m=g),m!==-1&&g-f>=50&&(n[o++]=new nn(m+1,c,u,p),f=m+1,m=-1);f!==d&&(n[o++]=new nn(d,c,u,p))}else n[o++]=l;i=d}else for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex,c=d-i;if(c>50){let u=l.type,p=l.metadata,m=l.containsRTL,f=Math.ceil(c/50);for(let g=1;g<f;g++){let b=i+g*50;n[o++]=new nn(b,u,p,m)}n[o++]=new nn(d,u,p,m)}else n[o++]=l;i=d}return n}function T9(r){return r<32?r!==9:r===127||r>=8234&&r<=8238||r>=8294&&r<=8297||r>=8206&&r<=8207||r===1564}function BX(r,e){let t=[],i=new nn(0,"",0,!1),n=0;for(let o of e){let s=o.endIndex;for(;n<s;n++){let a=r.charCodeAt(n);T9(a)&&(n>i.endIndex&&(i=new nn(n,o.type,o.metadata,o.containsRTL),t.push(i)),i=new nn(n+1,"mtkcontrol",o.metadata,!1),t.push(i))}n>i.endIndex&&(i=new nn(s,o.type,o.metadata,o.containsRTL),t.push(i))}return t}function VX(r,e,t,i){let n=r.continuesWithWrappedLine,o=r.fauxIndentLength,s=r.tabSize,a=r.startVisibleColumn,l=r.useMonospaceOptimizations,d=r.selectionsOnLine,c=r.renderWhitespace===1,u=r.renderWhitespace===3,p=r.renderSpaceWidth!==r.spaceWidth,m=[],f=0,g=0,b=i[g].type,v=i[g].containsRTL,I=i[g].endIndex,w=i.length,E=!1,S=qi(e),T;S===-1?(E=!0,S=t,T=t):T=fs(e);let D=!1,L=0,A=d&&d[L],W=a%s;for(let G=o;G<t;G++){let oe=e.charCodeAt(G);A&&G>=A.endOffset&&(L++,A=d&&d[L]);let _e;if(G<S||G>T)_e=!0;else if(oe===9)_e=!0;else if(oe===32)if(c)if(D)_e=!0;else{let re=G+1<t?e.charCodeAt(G+1):0;_e=re===32||re===9}else _e=!0;else _e=!1;if(_e&&d&&(_e=!!A&&A.startOffset<=G&&A.endOffset>G),_e&&u&&(_e=E||G>T),_e&&v&&G>=S&&G<=T&&(_e=!1),D){if(!_e||!l&&W>=s){if(p){let re=f>0?m[f-1].endIndex:o;for(let ne=re+1;ne<=G;ne++)m[f++]=new nn(ne,"mtkw",1,!1)}else m[f++]=new nn(G,"mtkw",1,!1);W=W%s}}else(G===I||_e&&G>o)&&(m[f++]=new nn(G,b,0,v),W=W%s);for(oe===9?W=s:bs(oe)?W+=2:W++,D=_e;G===I&&(g++,g<w);)b=i[g].type,v=i[g].containsRTL,I=i[g].endIndex}let j=!1;if(D)if(n&&c){let G=t>0?e.charCodeAt(t-1):0,oe=t>1?e.charCodeAt(t-2):0;G===32&&oe!==32&&oe!==9||(j=!0)}else j=!0;if(j)if(p){let G=f>0?m[f-1].endIndex:o;for(let oe=G+1;oe<=t;oe++)m[f++]=new nn(oe,"mtkw",1,!1)}else m[f++]=new nn(t,"mtkw",1,!1);else m[f++]=new nn(t,b,0,v);return m}function WX(r,e,t,i){i.sort(la.compare);let n=yD.normalize(r,i),o=n.length,s=0,a=[],l=0,d=0;for(let u=0,p=t.length;u<p;u++){let m=t[u],f=m.endIndex,g=m.type,b=m.metadata,v=m.containsRTL;for(;s<o&&n[s].startOffset<f;){let I=n[s];if(I.startOffset>d&&(d=I.startOffset,a[l++]=new nn(d,g,b,v)),I.endOffset+1<=f)d=I.endOffset+1,a[l++]=new nn(d,g+" "+I.className,b|I.metadata,v),s++;else{d=f,a[l++]=new nn(d,g+" "+I.className,b|I.metadata,v);break}}f>d&&(d=f,a[l++]=new nn(d,g,b,v))}let c=t[t.length-1].endIndex;if(s<o&&n[s].startOffset===c)for(;s<o&&n[s].startOffset===c;){let u=n[s];a[l++]=new nn(d,u.className,u.metadata,!1),s++}return a}function HX(r,e){let t=r.fontIsMonospace,i=r.canUseHalfwidthRightwardsArrow,n=r.containsForeignElements,o=r.lineContent,s=r.len,a=r.isOverflowing,l=r.overflowingCharCount,d=r.parts,c=r.fauxIndentLength,u=r.tabSize,p=r.startVisibleColumn,m=r.containsRTL,f=r.spaceWidth,g=r.renderSpaceCharCode,b=r.renderWhitespace,v=r.renderControlCharacters,I=new GI(s+1,d.length),w=!1,E=0,S=p,T=0,D=0,L=0;m?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let A=0,W=d.length;A<W;A++){let j=d[A],G=j.endIndex,oe=j.type,_e=j.containsRTL,re=b!==0&&j.isWhitespace(),ne=re&&!t&&(oe==="mtkw"||!n),ge=E===G&&j.isPseudoAfter();if(T=0,e.appendString("<span "),_e&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(ne?"mtkz":oe),e.appendASCIICharCode(34),re){let de=0;{let se=E,De=S;for(;se<G;se++){let rt=(o.charCodeAt(se)===9?u-De%u:1)|0;de+=rt,se>=c&&(De+=rt)}}for(ne&&(e.appendString(' style="width:'),e.appendString(String(f*de)),e.appendString('px"')),e.appendASCIICharCode(62);E<G;E++){I.setColumnInfo(E+1,A-L,T,D),L=0;let se=o.charCodeAt(E),De,fe;if(se===9){De=u-S%u|0,fe=De,!i||fe>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let rt=2;rt<=fe;rt++)e.appendCharCode(160)}else De=2,fe=1,e.appendCharCode(g),e.appendCharCode(8204);T+=De,D+=fe,E>=c&&(S+=fe)}}else for(e.appendASCIICharCode(62);E<G;E++){I.setColumnInfo(E+1,A-L,T,D),L=0;let de=o.charCodeAt(E),se=1,De=1;switch(de){case 9:se=u-S%u,De=se;for(let fe=1;fe<=se;fe++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:v?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:bs(de)&&De++,v&&de<32?e.appendCharCode(9216+de):v&&de===127?e.appendCharCode(9249):v&&T9(de)?(e.appendString("[U+"),e.appendString(UX(de)),e.appendString("]"),se=8,De=se):e.appendCharCode(de)}T+=se,D+=De,E>=c&&(S+=De)}ge?L++:L=0,E>=s&&!w&&j.isPseudoAfter()&&(w=!0,I.setColumnInfo(E+1,A,T,D)),e.appendString("</span>")}return w||I.setColumnInfo(s+1,d.length-1,T,D),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(h("showMore","Show more ({0})",zX(l))),e.appendString("</span>")),e.appendString("</span>"),new jI(I,m,n)}function UX(r){return r.toString(16).toUpperCase().padStart(4,"0")}function zX(r){return r<1024?h("overflow.chars","{0} chars",r):r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/1024/1024).toFixed(1)} MB`}var KX=function(){return Pr?!0:!(_t||$i||Uo)}(),Rf=!0,$I=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(e,t){this.themeType=t;let i=e.options,n=i.get(51);i.get(39)==="off"?this.renderWhitespace=i.get(101):this.renderWhitespace="none",this.renderControlCharacters=i.get(96),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(33),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(68),this.stopRenderingLineAfter=i.get(119),this.fontLigatures=i.get(52)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}},Qa=class r{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=$e(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return Ba(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,n,o){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=n.getViewLineRenderingData(e),a=this._options,l=la.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn),d=null;if(Ba(a.themeType)||this._options.renderWhitespace==="selection"){let m=n.selections;for(let f of m){if(f.endLineNumber<e||f.startLineNumber>e)continue;let g=f.startLineNumber===e?f.startColumn:s.minColumn,b=f.endLineNumber===e?f.endColumn:s.maxColumn;g<b&&(Ba(a.themeType)&&l.push(new la(g,b,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new Lf(g-1,b-1))))}}let c=new Nu(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==ka.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;o.appendString('<div style="top:'),o.appendString(String(t)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString('px;" class="'),o.appendString(r.CLASS_NAME),o.appendString('">');let u=qI(c,o);o.appendString("</div>");let p=null;return Rf&&KX&&s.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(p=new kf(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),p||(p=_9(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=p,!0}layoutLine(e,t,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(i))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof kf:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof kf?this._renderedViewLine.monospaceAssumptionsAreValid():Rf}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof kf&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,n){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));let o=this._renderedViewLine.input.stopRenderingLineAfter;if(o!==-1&&t>o+1&&i>o+1)return new UI(!0,[new Xa(this.getWidth(n),0)]);o!==-1&&t>o+1&&(t=o+1),o!==-1&&i>o+1&&(i=o+1);let s=this._renderedViewLine.getVisibleRangesForRange(e,t,i,n);return s&&s.length>0?new UI(!1,s):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};var kf=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(e,t,i){this.domNode=e,this.input=t;let n=Math.floor(t.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let o=0;o<n;o++)this._keyColumnPixelOffsetCache[o]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){let t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return Rf;if(this.input.lineContent.length<300){let e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),Rf=!1)}return Rf}toSlowRenderedLine(){return _9(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,i,n){let o=this._getColumnPixelOffset(e,t,n),s=this._getColumnPixelOffset(e,i,n);return[new Xa(o,s-o)]}_getColumnPixelOffset(e,t,i){if(t<=300){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let n=Math.floor((t-1)/300)-1,o=(n+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[n],s===-1&&(s=this._actualReadPixelOffset(e,o,i),this._keyColumnPixelOffsetCache[n]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(o),l=this._characterMapping.getHorizontalOffset(t);return s+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;let n=this._characterMapping.getDomPosition(t),o=Dh.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!o||o.length===0?-1:o[0].left}getColumnOfNodeOffset(e,t){return D9(this._characterMapping,e,t)}},CD=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(e,t,i,n,o){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=o,this._cachedWidth=-1,this._pixelOffsetCache=null,!n||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let o=this._readPixelOffset(this.domNode,e,t,n);if(o===-1)return null;let s=this._readPixelOffset(this.domNode,e,i,n);return s===-1?null:[new Xa(o,s-o)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,n)}_readVisibleRangesForRange(e,t,i,n,o){if(i===n){let s=this._readPixelOffset(e,t,i,o);return s===-1?null:[new Xa(s,0)]}else return this._readRawVisibleRangesForRange(e,i,n,o)}_readPixelOffset(e,t,i,n){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);let o=this._getReadingTarget(e);return o.firstChild?(n.markDidDomLayout(),o.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let o=this._pixelOffsetCache[i];if(o!==-1)return o;let s=this._actualReadPixelOffset(e,t,i,n);return this._pixelOffsetCache[i]=s,s}return this._actualReadPixelOffset(e,t,i,n)}_actualReadPixelOffset(e,t,i,n){if(this._characterMapping.length===0){let l=Dh.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);let o=this._characterMapping.getDomPosition(i),s=Dh.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,o.partIndex,o.charIndex,n);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(i),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(e,t,i,n){if(t===1&&i===this._characterMapping.length)return[new Xa(0,this.getWidth(n))];let o=this._characterMapping.getDomPosition(t),s=this._characterMapping.getDomPosition(i);return Dh.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,s.partIndex,s.charIndex,n)}getColumnOfNodeOffset(e,t){return D9(this._characterMapping,e,t)}},ZN=class extends CD{_readVisibleRangesForRange(e,t,i,n,o){let s=super._readVisibleRangesForRange(e,t,i,n,o);if(!s||s.length===0||i===n||i===1&&n===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(e,t,n,o);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},_9=function(){return wa?GX:jX}();function GX(r,e,t,i,n){return new ZN(r,e,t,i,n)}function jX(r,e,t,i,n){return new CD(r,e,t,i,n)}function D9(r,e,t){let i=e.textContent.length,n=-1;for(;e;)e=e.previousSibling,n++;return r.getColumn(new KI(n,t),i)}var dc="monaco-mouse-cursor-text";var SD=class{constructor(e,t,i,n,o,s,a){this.top=e;this.left=t;this.paddingLeft=i;this.width=n;this.height=o;this.textContent=s;this.textContentClassName=a}};var YI=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(e,t){this._context=e;let i=this._context.configuration.options,n=i.get(51);this._cursorStyle=i.get(28),this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=$e(document.createElement("div")),this._domNode.setClassName(`cursor ${dc}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),Ti(this._domNode,n),this._domNode.setDisplay("none"),this._position=new F(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){let t=this._context.configuration.options,i=t.get(51);return this._cursorStyle=t.get(28),this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),Ti(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){let{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[n,o]=WS(i,t-1);return[new F(e,n+1),i.substring(n,o)]}_prepareRender(e){let t="",i="",[n,o]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let p=e.visibleRangeForPosition(n);if(!p||p.outsideRenderedLine)return null;let m=pe(this._domNode.domNode),f;this._cursorStyle===1?(f=r1(m,this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=o,i=this._getTokenClassName(n))):f=r1(m,1);let g=p.left,b=0;f>=2&&g>=1&&(b=1,g-=b);let v=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta;return new SD(v,g,b,f,this._lineHeight,t,i)}let s=e.linesVisibleRangesForRange(new O(n.lineNumber,n.column,n.lineNumber,n.column+o.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=o==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(t=o,i=this._getTokenClassName(n));let c=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,u=2),new SD(c,l.left,0,d,u,t,i)}_getTokenClassName(e){let t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${dc} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var Lh=class r{static whitespaceVisibleColumn(e,t,i){let n=e.length,o=0,s=-1,a=-1;for(let l=0;l<n;l++){if(l===t)return[s,a,o];switch(o%i===0&&(s=l,a=o),e.charCodeAt(l)){case 32:o+=1;break;case 9:o=oi.nextRenderTabStop(o,i);break;default:return[-1,-1,-1]}}return t===n?[s,a,o]:[-1,-1,-1]}static atomicPosition(e,t,i,n){let o=e.length,[s,a,l]=r.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let d;switch(n){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%i===0)return t;d=l%i<=i/2;break}if(d){if(s===-1)return-1;let p=a;for(let m=s;m<o;++m){if(p===a+i)return s;switch(e.charCodeAt(m)){case 32:p+=1;break;case 9:p=oi.nextRenderTabStop(p,i);break;default:return-1}}return p===a+i?s:-1}let c=oi.nextRenderTabStop(l,i),u=l;for(let p=t;p<o;p++){if(u===c)return p;switch(e.charCodeAt(p)){case 32:u+=1;break;case 9:u=oi.nextRenderTabStop(u,i);break;default:return-1}}return u===c?o:-1}};var ld=class{constructor(e=null){this.hitTarget=e}type=0},ED=class{constructor(e,t,i){this.position=e;this.spanNode=t;this.injectedText=i}type=1;get hitTarget(){return this.spanNode}},Af;(e=>{function r(t,i,n){let o=t.getPositionFromDOMInfo(i,n);return o?new ED(o,i,null):new ld(i)}e.createFromDOMInfo=r})(Af||={});var wD=class{constructor(e,t){this.lastViewCursorsRenderData=e;this.lastTextareaPosition=t}},Wn=class{static _deduceRage(e,t=null){return!t&&e?new O(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,n,o,s){return{type:e,element:t,mouseColumn:i,position:n,range:o,detail:s}}static createViewZone(e,t,i,n,o){return{type:e,element:t,mouseColumn:i,position:n,range:this._deduceRage(n),detail:o}}static createContentText(e,t,i,n,o){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,n),detail:o}}static createContentEmpty(e,t,i,n){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,n){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:n}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}},Co=class{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}},Mf=class r{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(e,t,i){this.viewModel=e.viewModel;let n=e.configuration.options;this.layoutInfo=n.get(147),this.viewDomNode=t.viewDomNode,this.lineHeight=n.get(68),this.stickyTabStops=n.get(118),this.typicalHalfwidthCharacterWidth=n.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return r.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){let i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){let n=i.verticalOffset+i.height/2,o=e.viewModel.getLineCount(),s=null,a,l=null;return i.afterLineNumber!==o&&(l=new F(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(s=new F(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=s:s===null?a=l:t<n?a=s:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let n=this._context.viewModel.getLineCount(),o=this._context.viewModel.getLineMaxColumn(n);return{range:new O(n,o,n,o),isAfterLines:!0}}let t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new O(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return r._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},QN=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(e,t,i,n){this.editorPos=t,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Of._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}},JN=class extends QN{_ctx;_eventTarget;hitTestResult=new Dn(()=>Of.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Vn.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,i,n,o){super(e,t,i,n),this._ctx=e,this._eventTarget=o;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?oi.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Wn.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Wn.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,n){return Wn.createMargin(e,this.target,this._getMouseColumn(t),t,i,n)}fulfillViewZone(e,t,i){return Wn.createViewZone(e,this.target,this._getMouseColumn(t),t,i)}fulfillContentText(e,t,i){return Wn.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return Wn.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Wn.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Wn.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Wn.createOverlayWidget(this.target,this._getMouseColumn(),e)}},L9={isAfterLines:!0};function XN(r){return{isAfterLines:!1,horizontalDistanceToText:r}}var Of=class r{_context;_viewHelper;constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,i=Vn.collect(t,this._viewHelper.viewDomNode);return!!(Co.isChildOfContentWidgets(i)||Co.isChildOfOverflowingContentWidgets(i)||Co.isChildOfOverlayWidgets(i)||Co.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(e,t,i,n,o){let s=new Mf(this._context,this._viewHelper,e),a=new JN(s,t,i,n,o);try{let l=r._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=r._snapToSoftTabBoundary(l.position,s.viewModel),c=O.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();let i=t,n=null;return!Co.isChildOfOverflowGuard(t.targetPath)&&!Co.isChildOfOverflowingContentWidgets(t.targetPath)&&!Co.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(n=n||t.fulfillUnknown()),n=n||r._hitTestContentWidget(e,i),n=n||r._hitTestOverlayWidget(e,i),n=n||r._hitTestMinimap(e,i),n=n||r._hitTestScrollbarSlider(e,i),n=n||r._hitTestViewZone(e,i),n=n||r._hitTestMargin(e,i),n=n||r._hitTestViewCursor(e,i),n=n||r._hitTestTextArea(e,i),n=n||r._hitTestViewLines(e,i),n=n||r._hitTestScrollbar(e,i),n||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(Co.isChildOfContentWidgets(t.targetPath)||Co.isChildOfOverflowingContentWidgets(t.targetPath)){let i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(Co.isChildOfOverlayWidgets(t.targetPath)||Co.isChildOfOverflowingOverlayWidgets(t.targetPath)){let i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){let i=e.lastRenderData.lastViewCursorsRenderData;for(let n of i)if(t.target===n.domNode)return t.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){let i=e.lastRenderData.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,o=t.mouseVerticalOffset;for(let s of i){if(n<s.contentLeft||n>s.contentLeft+s.width)continue;let a=e.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=o&&o<=a+s.height)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){let i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){let n=t.isInContentArea?8:5;return t.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(e,t){return Co.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){let i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition(),o=Math.abs(t.relativePos.x),s={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:o};if(o-=e.layoutInfo.glyphMarginLeft,o<=e.layoutInfo.glyphMarginWidth){let a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(o/e.lineHeight)],t.fulfillMargin(2,n,i.range,s)}return o-=e.layoutInfo.glyphMarginWidth,o<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,n,i.range,s):(o-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,n,i.range,s))}return null}static _hitTestViewLines(e,t){if(!Co.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new F(1,1),L9);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){let n=e.viewModel.getLineCount(),o=e.viewModel.getLineMaxColumn(n);return t.fulfillContentEmpty(new F(n,o),L9)}if(Co.isStrictChildOfViewLines(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(n)===0){let s=e.getLineWidth(n),a=XN(t.mouseContentHorizontalOffset-s);return t.fulfillContentEmpty(new F(n,1),a)}let o=e.getLineWidth(n);if(t.mouseContentHorizontalOffset>=o){let s=XN(t.mouseContentHorizontalOffset-o),a=new F(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(a,s)}}let i=t.hitTestResult.value;return i.type===1?r.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position,i.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(Co.isChildOfMinimap(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new F(i,n))}return null}static _hitTestScrollbarSlider(e,t){if(Co.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){let i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),o=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new F(n,o))}}return null}static _hitTestScrollbar(e,t){if(Co.isChildOfScrollableElement(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new F(i,n))}return null}getMouseColumn(e){let t=this._context.configuration.options,i=t.get(147),n=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return r._getMouseColumn(n,t.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,n,o){let s=n.lineNumber,a=n.column,l=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>l){let v=XN(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(n,v)}let d=e.visibleRangeForPosition(s,a);if(!d)return t.fulfillUnknown(n);let c=d.left;if(Math.abs(t.mouseContentHorizontalOffset-c)<1)return t.fulfillContentText(n,null,{mightBeForeignElement:!!o,injectedText:o});let u=[];if(u.push({offset:d.left,column:a}),a>1){let v=e.visibleRangeForPosition(s,a-1);v&&u.push({offset:v.left,column:a-1})}let p=e.viewModel.getLineMaxColumn(s);if(a<p){let v=e.visibleRangeForPosition(s,a+1);v&&u.push({offset:v.left,column:a+1})}u.sort((v,I)=>v.offset-I.offset);let m=t.pos.toClientCoordinates(pe(e.viewDomNode)),f=i.getBoundingClientRect(),g=f.left<=m.clientX&&m.clientX<=f.right,b=null;for(let v=1;v<u.length;v++){let I=u[v-1],w=u[v];if(I.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=w.offset){b=new O(s,I.column,s,w.column);let E=Math.abs(I.offset-t.mouseContentHorizontalOffset),S=Math.abs(w.offset-t.mouseContentHorizontalOffset);n=E<S?new F(s,I.column):new F(s,w.column);break}}return t.fulfillContentText(n,b,{mightBeForeignElement:!g||!!o,injectedText:o})}static _doHitTestWithCaretRangeFromPoint(e,t){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i),o=n+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>o)){let a=Math.floor((n+o)/2),l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);let d=new Ou(t.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(e,d.toClientCoordinates(pe(e.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(pe(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let i=Uc(e.viewDomNode),n;if(i?typeof i.caretRangeFromPoint>"u"?n=YX(i,t.clientX,t.clientY):n=i.caretRangeFromPoint(t.clientX,t.clientY):n=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!n||!n.startContainer)return new ld;let o=n.startContainer;if(o.nodeType===o.TEXT_NODE){let s=o.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Qa.CLASS_NAME?Af.createFromDOMInfo(e,s,n.startOffset):new ld(o.parentNode)}else if(o.nodeType===o.ELEMENT_NODE){let s=o.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Qa.CLASS_NAME?Af.createFromDOMInfo(e,o,o.textContent.length):new ld(o)}return new ld}static _doHitTestWithCaretPositionFromPoint(e,t){let i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){let n=i.offsetNode.parentNode,o=n?n.parentNode:null,s=o?o.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===Qa.CLASS_NAME?Af.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new ld(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){let n=i.offsetNode.parentNode,o=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,s=n?n.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(o===Qa.CLASS_NAME){let l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return Af.createFromDOMInfo(e,l,0)}else if(a===Qa.CLASS_NAME)return Af.createFromDOMInfo(e,i.offsetNode,0)}return new ld(i.offsetNode)}static _snapToSoftTabBoundary(e,t){let i=t.getLineContent(e.lineNumber),{tabSize:n}=t.model.getOptions(),o=Lh.atomicPosition(i,e.column-1,n,2);return o!==-1?new F(e.lineNumber,o+1):e}static doHitTest(e,t){let i=new ld;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(pe(e.viewDomNode)))),i.type===1){let n=e.viewModel.getInjectedTextAt(i.position),o=e.viewModel.normalizePosition(i.position,2);(n||!o.equals(i.position))&&(i=new ED(o,i.spanNode,n))}return i}};function YX(r,e,t){let i=document.createRange(),n=r.elementFromPoint(e,t);if(n!==null){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;let o=n.getBoundingClientRect(),s=pe(n),a=s.getComputedStyle(n,null).getPropertyValue("font-style"),l=s.getComputedStyle(n,null).getPropertyValue("font-variant"),d=s.getComputedStyle(n,null).getPropertyValue("font-weight"),c=s.getComputedStyle(n,null).getPropertyValue("font-size"),u=s.getComputedStyle(n,null).getPropertyValue("line-height"),p=s.getComputedStyle(n,null).getPropertyValue("font-family"),m=`${a} ${l} ${d} ${c}/${u} ${p}`,f=n.innerText,g=o.left,b=0,v;if(e>o.left+o.width)b=f.length;else{let I=eF.getInstance();for(let w=0;w<f.length+1;w++){if(v=I.getCharWidth(f.charAt(w),m)/2,g+=v,e<g){b=w;break}g+=v}}i.setStart(n.firstChild,b),i.setEnd(n.firstChild,b)}return i}var eF=class r{static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){let i=e+t;if(this._cache[i])return this._cache[i];let n=this._canvas.getContext("2d");n.font=t;let s=n.measureText(e).width;return this._cache[i]=s,s}};var Fu=class r{static columnSelect(e,t,i,n,o,s){let a=Math.abs(o-i)+1,l=i>o,d=n>s,c=n<s,u=[];for(let p=0;p<a;p++){let m=i+(l?-p:p),f=e.columnFromVisibleColumn(t,m,n),g=e.columnFromVisibleColumn(t,m,s),b=e.visibleColumnFromColumn(t,new F(m,f)),v=e.visibleColumnFromColumn(t,new F(m,g));c&&(b>s||v<n)||d&&(v>n||b<s)||u.push(new dn(new O(m,f,m,f),0,0,new F(m,g),0))}if(u.length===0)for(let p=0;p<a;p++){let m=i+(l?-p:p),f=t.getLineMaxColumn(m);u.push(new dn(new O(m,f,m,f),0,0,new F(m,f),0))}return{viewStates:u,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:o,toVisualColumn:s}}static columnSelectLeft(e,t,i){let n=i.toViewVisualColumn;return n>0&&n--,r.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(e,t,i){let n=0,o=Math.min(i.fromViewLineNumber,i.toViewLineNumber),s=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=o;l<=s;l++){let d=t.getLineMaxColumn(l),c=e.visibleColumnFromColumn(t,new F(l,d));n=Math.max(n,c)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,n){let o=n?e.pageSize:1,s=Math.max(1,i.toViewLineNumber-o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,s,i.toViewVisualColumn)}static columnSelectDown(e,t,i,n){let o=n?e.pageSize:1,s=Math.min(t.getLineCount(),i.toViewLineNumber+o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,s,i.toViewVisualColumn)}};var So=class{_range;_text;insertsAutoWhitespace;constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return tt.fromPositions(n.getEndPosition())}};var Rh=class{_range;_text;insertsAutoWhitespace;constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return tt.fromPositions(n.getStartPosition())}},Ah=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(e,t,i,n,o=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=o}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return tt.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},_D=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};var ZI=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(e,t,i){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}},Pi=class r{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-E0(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){let i=t.lineNumber-1;return new F(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){let n=e.getLineMinColumn(t.lineNumber),o=e.getLineContent(t.lineNumber),s=Lh.atomicPosition(o,t.column-1,i,0);if(s!==-1&&s+1>=n)return new F(t.lineNumber,s+1)}return this.leftPosition(e,t)}static left(e,t,i){let n=e.stickyTabStops?r.leftPositionAtomicSoftTabs(t,i,e.tabSize):r.leftPosition(t,i);return new ZI(n.lineNumber,n.column,0)}static moveLeft(e,t,i,n,o){let s,a;if(i.hasSelection()&&!n)s=i.selection.startLineNumber,a=i.selection.startColumn;else{let l=i.position.delta(void 0,-(o-1)),d=t.normalizePosition(r.clipPositionColumn(l,t),0),c=r.left(e,t,d);s=c.lineNumber,a=c.column}return i.move(n,s,a,0)}static clipPositionColumn(e,t){return new F(e.lineNumber,r.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+Sv(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new F(t,i)}static rightPositionAtomicSoftTabs(e,t,i,n,o){if(i<e.getLineIndentColumn(t)){let s=e.getLineContent(t),a=Lh.atomicPosition(s,i-1,n,1);if(a!==-1)return new F(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){let n=e.stickyTabStops?r.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):r.rightPosition(t,i.lineNumber,i.column);return new ZI(n.lineNumber,n.column,0)}static moveRight(e,t,i,n,o){let s,a;if(i.hasSelection()&&!n)s=i.selection.endLineNumber,a=i.selection.endColumn;else{let l=i.position.delta(void 0,o-1),d=t.normalizePosition(r.clipPositionColumn(l,t),1),c=r.right(e,t,d);s=c.lineNumber,a=c.column}return i.move(n,s,a,0)}static vertical(e,t,i,n,o,s,a,l){let d=oi.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+o,c=t.getLineCount(),u=i===1&&n===1,p=i===c&&n===t.getLineMaxColumn(i),m=s<i?u:p;if(i=s,i<1?(i=1,a?n=t.getLineMinColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):i>c?(i=c,a?n=t.getLineMaxColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):n=e.columnFromVisibleColumn(t,i,d),m?o=0:o=d-oi.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),l!==void 0){let f=new F(i,n),g=t.normalizePosition(f,l);o=o+(n-g.column),i=g.lineNumber,n=g.column}return new ZI(i,n,o)}static down(e,t,i,n,o,s,a){return this.vertical(e,t,i,n,o,i+s,a,4)}static moveDown(e,t,i,n,o){let s,a;i.hasSelection()&&!n?(s=i.selection.endLineNumber,a=i.selection.endColumn):(s=i.position.lineNumber,a=i.position.column);let l=0,d;do if(d=r.down(e,t,s+l,a,i.leftoverVisibleColumns,o,!0),t.normalizePosition(new F(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<t.getLineCount());return i.move(n,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(e,t,i){let n=i.selection,o=r.down(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),s=r.down(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new dn(new O(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new F(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(e,t,i,n,o,s,a){return this.vertical(e,t,i,n,o,i-s,a,3)}static moveUp(e,t,i,n,o){let s,a;i.hasSelection()&&!n?(s=i.selection.startLineNumber,a=i.selection.startColumn):(s=i.position.lineNumber,a=i.position.column);let l=r.up(e,t,s,a,i.leftoverVisibleColumns,o,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){let n=i.selection,o=r.up(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),s=r.up(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new dn(new O(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new F(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,n){let o=i.position.lineNumber;for(;o>1&&this._isBlankLine(t,o);)o--;for(;o>1&&!this._isBlankLine(t,o);)o--;return i.move(n,o,t.getLineMinColumn(o),0)}static moveToNextBlankLine(e,t,i,n){let o=t.getLineCount(),s=i.position.lineNumber;for(;s<o&&this._isBlankLine(t,s);)s++;for(;s<o&&!this._isBlankLine(t,s);)s++;return i.move(n,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,i,n){let o=i.position.lineNumber,s=t.getLineMinColumn(o),a=t.getLineFirstNonWhitespaceColumn(o)||s,l;return i.position.column===a?l=s:l=a,i.move(n,o,l,0)}static moveToEndOfLine(e,t,i,n,o){let s=i.position.lineNumber,a=t.getLineMaxColumn(s);return i.move(n,s,a,o?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){let o=t.getLineCount(),s=t.getLineMaxColumn(o);return i.move(n,o,s,0)}};var cc=class r{static deleteRight(e,t,i,n){let o=[],s=e!==3;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d;if(c.isEmpty()){let u=d.getPosition(),p=Pi.right(t,i,u);c=new O(p.lineNumber,p.column,u.lineNumber,u.column)}if(c.isEmpty()){o[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),o[a]=new So(c,"")}return[s,o]}static isAutoClosingPairDelete(e,t,i,n,o,s,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],u=c.getPosition();if(!c.isEmpty())return!1;let p=o.getLineContent(u.lineNumber);if(u.column<2||u.column>=p.length+1)return!1;let m=p.charAt(u.column-2),f=n.get(m);if(!f)return!1;if(Ka(m)){if(i==="never")return!1}else if(t==="never")return!1;let g=p.charAt(u.column-1),b=!1;for(let v of f)v.open===m&&v.close===g&&(b=!0);if(!b)return!1;if(e==="auto"){let v=!1;for(let I=0,w=a.length;I<w;I++){let E=a[I];if(u.lineNumber===E.startLineNumber&&u.column===E.startColumn){v=!0;break}}if(!v)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].getPosition(),l=new O(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[o]=new So(l,"")}return[!0,n]}static deleteLeft(e,t,i,n,o){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,o))return this._runAutoClosingPairDelete(t,i,n);let s=[],a=e!==2;for(let l=0,d=n.length;l<d;l++){let c=r.getDeleteRange(n[l],i,t);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new So(c,"")}return[a,s]}static getDeleteRange(e,t,i){if(!e.isEmpty())return e;let n=e.getPosition();if(i.useTabStops&&n.column>1){let o=t.getLineContent(n.lineNumber),s=qi(o),a=s===-1?o.length+1:s+1;if(n.column<=a){let l=i.visibleColumnFromColumn(t,n),d=oi.prevIndentTabStop(l,i.indentSize),c=i.columnFromVisibleColumn(t,n.lineNumber,d);return new O(n.lineNumber,c,n.lineNumber,n.column)}}return O.fromPositions(r.getPositionAfterDeleteLeft(n,t),n)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){let i=QW(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){let i=e.lineNumber-1;return new F(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){let n=[],o=null;i.sort((s,a)=>F.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=i.length;s<a;s++){let l=i[s];if(l.isEmpty())if(e.emptySelectionClipboard){let d=l.getPosition(),c,u,p,m;d.lineNumber<t.getLineCount()?(c=d.lineNumber,u=1,p=d.lineNumber+1,m=1):d.lineNumber>1&&o?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,u=t.getLineMaxColumn(d.lineNumber-1),p=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,u=1,p=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber));let f=new O(c,u,p,m);o=f,f.isEmpty()?n[s]=null:n[s]=new So(f,"")}else n[s]=null;else n[s]=new So(l,"")}return new wn(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var Pf=class r{static _createWord(e,t,i,n,o){return{start:n,end:o,wordType:t,nextCharClass:i}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,i){let n=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0,o=t.findPrevIntlWordBeforeOrAtOffset(e,i.column-2);for(let s=i.column-2;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(o&&s===o.index)return this._createIntlWord(o,l);if(l===0){if(n===2)return this._createWord(e,n,l,s+1,this._findEndOfWord(e,t,n,s+1));n=1}else if(l===2){if(n===1)return this._createWord(e,n,l,s+1,this._findEndOfWord(e,t,n,s+1));n=2}else if(l===1&&n!==0)return this._createWord(e,n,l,s+1,this._findEndOfWord(e,t,n,s+1))}return n!==0?this._createWord(e,n,1,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){let o=t.findNextIntlWordAtOrAfterOffset(e,n),s=e.length;for(let a=n;a<s;a++){let l=e.charCodeAt(a),d=t.get(l);if(o&&a===o.index+o.segment.length||d===1||i===1&&d===2||i===2&&d===0)return a}return s}static _findNextWordOnLine(e,t,i){let n=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0,o=e.length,s=t.findNextIntlWordAtOrAfterOffset(e,i.column-1);for(let a=i.column-1;a<o;a++){let l=e.charCodeAt(a),d=t.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(n===2)return this._createWord(e,n,d,this._findStartOfWord(e,t,n,a-1),a);n=1}else if(d===2){if(n===1)return this._createWord(e,n,d,this._findStartOfWord(e,t,n,a-1),a);n=2}else if(d===1&&n!==0)return this._createWord(e,n,d,this._findStartOfWord(e,t,n,a-1),a)}return n!==0?this._createWord(e,n,1,this._findStartOfWord(e,t,n,o-1),o):null}static _findStartOfWord(e,t,i,n){let o=t.findPrevIntlWordBeforeOrAtOffset(e,n);for(let s=n;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(o&&s===o.index)return s;if(l===1||i===1&&l===2||i===2&&l===0)return s+1}return 0}static moveWordLeft(e,t,i,n,o){let s=i.lineNumber,a=i.column;a===1&&s>1&&(s=s-1,a=t.getLineMaxColumn(s));let l=r._findPreviousWordOnLine(e,t,new F(s,a));if(n===0)return new F(s,l?l.start+1:1);if(n===1)return!o&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=r._findPreviousWordOnLine(e,t,new F(s,l.start+1))),new F(s,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=r._findPreviousWordOnLine(e,t,new F(s,l.start+1));return new F(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=r._findPreviousWordOnLine(e,t,new F(s,l.start+1))),new F(s,l?l.end+1:1)}static _moveWordPartLeft(e,t){let i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===1)return i>1?new F(i-1,e.getLineMaxColumn(i-1)):t;let o=e.getLineContent(i);for(let s=t.column-1;s>1;s--){let a=o.charCodeAt(s-2),l=o.charCodeAt(s-1);if(a===95&&l!==95)return new F(i,s);if(a===45&&l!==45)return new F(i,s);if((vp(a)||yv(a))&&yl(l))return new F(i,s);if(yl(a)&&yl(l)&&s+1<n){let d=o.charCodeAt(s);if(vp(d)||yv(d))return new F(i,s)}}return new F(i,1)}static moveWordRight(e,t,i,n){let o=i.lineNumber,s=i.column,a=!1;s===t.getLineMaxColumn(o)&&o<t.getLineCount()&&(a=!0,o=o+1,s=1);let l=r._findNextWordOnLine(e,t,new F(o,s));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=r._findNextWordOnLine(e,t,new F(o,l.end+1))),l?s=l.end+1:s=t.getLineMaxColumn(o);else if(n===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=r._findNextWordOnLine(e,t,new F(o,l.end+1));l?s=l.start+1:s=t.getLineMaxColumn(o)}else l&&!a&&s>=l.start+1&&(l=r._findNextWordOnLine(e,t,new F(o,l.end+1))),l?s=l.start+1:s=t.getLineMaxColumn(o);return new F(o,s)}static _moveWordPartRight(e,t){let i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===n)return i<e.getLineCount()?new F(i+1,1):t;let o=e.getLineContent(i);for(let s=t.column+1;s<n;s++){let a=o.charCodeAt(s-2),l=o.charCodeAt(s-1);if(a!==95&&l===95)return new F(i,s);if(a!==45&&l===45)return new F(i,s);if((vp(a)||yv(a))&&yl(l))return new F(i,s);if(yl(a)&&yl(l)&&s+1<n){let d=o.charCodeAt(s);if(vp(d)||yv(d))return new F(i,s)}}return new F(i,n)}static _deleteWordLeftWhitespace(e,t){let i=e.getLineContent(t.lineNumber),n=t.column-2,o=fs(i,n);return o+1<n?new O(t.lineNumber,o+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){let i=e.wordSeparators,n=e.model,o=e.selection,s=e.whitespaceHeuristics;if(!o.isEmpty())return o;if(cc.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){let u=e.selection.getPosition();return new O(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}let a=new F(o.positionLineNumber,o.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let u=this._deleteWordLeftWhitespace(n,a);if(u)return u}let c=r._findPreviousWordOnLine(i,n,a);return t===0?c?d=c.start+1:d>1?d=1:(l--,d=n.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=r._findPreviousWordOnLine(i,n,new F(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=n.getLineMaxColumn(l))),new O(l,d,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;let n=new F(i.positionLineNumber,i.positionColumn),o=this._deleteInsideWordWhitespace(t,n);return o||this._deleteInsideWordDetermineDeleteRange(e,t,n)}static _charAtIsWhitespace(e,t){let i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){let i=e.getLineContent(t.lineNumber),n=i.length;if(n===0)return null;let o=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,o))return null;let s=Math.min(t.column-1,n-1);if(!this._charAtIsWhitespace(i,s))return null;for(;o>0&&this._charAtIsWhitespace(i,o-1);)o--;for(;s+1<n&&this._charAtIsWhitespace(i,s+1);)s++;return new O(t.lineNumber,o+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){let n=t.getLineContent(i.lineNumber),o=n.length;if(o===0)return i.lineNumber>1?new O(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new O(i.lineNumber,1,i.lineNumber+1,1):new O(i.lineNumber,1,i.lineNumber,1);let s=u=>u.start+1<=i.column&&i.column<=u.end+1,a=(u,p)=>(u=Math.min(u,i.column),p=Math.max(p,i.column),new O(i.lineNumber,u,i.lineNumber,p)),l=u=>{let p=u.start+1,m=u.end+1,f=!1;for(;m-1<o&&this._charAtIsWhitespace(n,m-1);)f=!0,m++;if(!f)for(;p>1&&this._charAtIsWhitespace(n,p-2);)p--;return a(p,m)},d=r._findPreviousWordOnLine(e,t,i);if(d&&s(d))return l(d);let c=r._findNextWordOnLine(e,t,i);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,o+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;let i=t.getPosition(),n=r._moveWordPartLeft(e,i);return new O(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(e,t){let i=e.length;for(let n=t;n<i;n++){let o=e.charAt(n);if(o!==" "&&o!=="	")return n}return i}static _deleteWordRightWhitespace(e,t){let i=e.getLineContent(t.lineNumber),n=t.column-1,o=this._findFirstNonWhitespaceChar(i,n);return n+1<o?new O(t.lineNumber,t.column,t.lineNumber,o+1):null}static deleteWordRight(e,t){let i=e.wordSeparators,n=e.model,o=e.selection,s=e.whitespaceHeuristics;if(!o.isEmpty())return o;let a=new F(o.positionLineNumber,o.positionColumn),l=a.lineNumber,d=a.column,c=n.getLineCount(),u=n.getLineMaxColumn(l);if(l===c&&d===u)return null;if(s){let m=this._deleteWordRightWhitespace(n,a);if(m)return m}let p=r._findNextWordOnLine(i,n,a);return t===2?p?d=p.end+1:d<u||l===c?d=u:(l++,p=r._findNextWordOnLine(i,n,new F(l,1)),p?d=p.start+1:d=n.getLineMaxColumn(l)):(p&&d>=p.start+1&&(p=r._findNextWordOnLine(i,n,new F(l,p.end+1))),p?d=p.start+1:d<u||l===c?d=u:(l++,p=r._findNextWordOnLine(i,n,new F(l,1)),p?d=p.start+1:d=n.getLineMaxColumn(l))),new O(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;let i=t.getPosition(),n=r._moveWordPartRight(e,i);return new O(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(e,t,i){let n=new O(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(e,t,i,n){let o=Al(t,i),s=r._findPreviousWordOnLine(o,e,n);if(s&&s.wordType===1&&s.start<=n.column-1&&n.column-1<=s.end)return r._createWordAtPosition(e,n.lineNumber,s);let a=r._findNextWordOnLine(o,e,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?r._createWordAtPosition(e,n.lineNumber,a):null}static word(e,t,i,n,o){let s=Al(e.wordSeparators,e.wordSegmenterLocales),a=r._findPreviousWordOnLine(s,t,o),l=r._findNextWordOnLine(s,t,o);if(!n){let m,f;return a&&a.wordType===1&&a.start<=o.column-1&&o.column-1<=a.end?(m=a.start+1,f=a.end+1):l&&l.wordType===1&&l.start<=o.column-1&&o.column-1<=l.end?(m=l.start+1,f=l.end+1):(a?m=a.end+1:m=1,l?f=l.start+1:f=t.getLineMaxColumn(o.lineNumber)),new dn(new O(o.lineNumber,m,o.lineNumber,f),1,0,new F(o.lineNumber,f),0)}let d,c;a&&a.wordType===1&&a.start<o.column-1&&o.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<o.column-1&&o.column-1<l.end?(d=l.start+1,c=l.end+1):(d=o.column,c=o.column);let u=o.lineNumber,p;if(i.selectionStart.containsPosition(o))p=i.selectionStart.endColumn;else if(o.isBeforeOrEqual(i.selectionStart.getStartPosition())){p=d;let m=new F(u,p);i.selectionStart.containsPosition(m)&&(p=i.selectionStart.endColumn)}else{p=c;let m=new F(u,p);i.selectionStart.containsPosition(m)&&(p=i.selectionStart.startColumn)}return i.move(!0,u,p,0)}};var Hn=class{static addCursorDown(e,t,i){let n=[],o=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];n[o++]=new ot(l.modelState,l.viewState),i?n[o++]=ot.fromModelState(Pi.translateDown(e.cursorConfig,e.model,l.modelState)):n[o++]=ot.fromViewState(Pi.translateDown(e.cursorConfig,e,l.viewState))}return n}static addCursorUp(e,t,i){let n=[],o=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];n[o++]=new ot(l.modelState,l.viewState),i?n[o++]=ot.fromModelState(Pi.translateUp(e.cursorConfig,e.model,l.modelState)):n[o++]=ot.fromViewState(Pi.translateUp(e.cursorConfig,e,l.viewState))}return n}static moveToBeginningOfLine(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o];n[o]=this._moveToLineStart(e,a,i)}return n}static _moveToLineStart(e,t,i){let n=t.viewState.position.column,o=t.modelState.position.column,s=n===o,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!s&&!(n===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return ot.fromViewState(Pi.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return ot.fromModelState(Pi.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,n){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=this._moveToLineEnd(e,l,i,n)}return o}static _moveToLineEnd(e,t,i,n){let o=t.viewState.position,s=e.getLineMaxColumn(o.lineNumber),a=o.column===s,l=t.modelState.position,d=e.model.getLineMaxColumn(l.lineNumber),c=s-o.column===d-l.column;return a||c?this._moveToLineEndByModel(e,t,i,n):this._moveToLineEndByView(e,t,i,n)}static _moveToLineEndByView(e,t,i,n){return ot.fromViewState(Pi.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,n))}static _moveToLineEndByModel(e,t,i,n){return ot.fromModelState(Pi.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,n))}static expandLineSelection(e,t){let i=[];for(let n=0,o=t.length;n<o;n++){let s=t[n],a=s.modelState.selection.startLineNumber,l=e.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=e.model.getLineMaxColumn(l):(d++,c=1),i[n]=ot.fromModelState(new dn(new O(a,1,a,1),0,0,new F(d,c),0))}return i}static moveToBeginningOfBuffer(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o];n[o]=ot.fromModelState(Pi.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o];n[o]=ot.fromModelState(Pi.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static selectAll(e,t){let i=e.model.getLineCount(),n=e.model.getLineMaxColumn(i);return ot.fromModelState(new dn(new O(1,1,1,1),0,0,new F(i,n),0))}static line(e,t,i,n,o){let s=e.model.validatePosition(n),a=o?e.coordinatesConverter.validateViewPosition(new F(o.lineNumber,o.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);if(!i){let d=e.model.getLineCount(),c=s.lineNumber+1,u=1;return c>d&&(c=d,u=e.model.getLineMaxColumn(c)),ot.fromModelState(new dn(new O(s.lineNumber,1,c,u),2,0,new F(c,u),0))}let l=t.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return ot.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=e.getLineCount(),c=a.lineNumber+1,u=1;return c>d&&(c=d,u=e.getLineMaxColumn(c)),ot.fromViewState(t.viewState.move(!0,c,u,0))}else{let d=t.modelState.selectionStart.getEndPosition();return ot.fromModelState(t.modelState.move(!0,d.lineNumber,d.column,0))}}static word(e,t,i,n){let o=e.model.validatePosition(n);return ot.fromModelState(Pf.word(e.cursorConfig,e.model,t.modelState,i,o))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new ot(t.modelState,t.viewState);let i=t.viewState.position.lineNumber,n=t.viewState.position.column;return ot.fromViewState(new dn(new O(i,n,i,n),0,0,new F(i,n),0))}static moveTo(e,t,i,n,o){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,n);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,n,o)}let s=e.model.validatePosition(n),a=o?e.coordinatesConverter.validateViewPosition(new F(o.lineNumber,o.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);return ot.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,n,o,s){switch(i){case Ze.Direction.Left:return s===Ze.Unit.HalfLine?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,o);case Ze.Direction.Right:return s===Ze.Unit.HalfLine?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,o);case Ze.Direction.Up:return s===Ze.Unit.WrappedLine?this._moveUpByViewLines(e,t,n,o):this._moveUpByModelLines(e,t,n,o);case Ze.Direction.Down:return s===Ze.Unit.WrappedLine?this._moveDownByViewLines(e,t,n,o):this._moveDownByModelLines(e,t,n,o);case Ze.Direction.PrevBlankLine:return s===Ze.Unit.WrappedLine?t.map(a=>ot.fromViewState(Pi.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>ot.fromModelState(Pi.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,n)));case Ze.Direction.NextBlankLine:return s===Ze.Unit.WrappedLine?t.map(a=>ot.fromViewState(Pi.moveToNextBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>ot.fromModelState(Pi.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,n)));case Ze.Direction.WrappedLineStart:return this._moveToViewMinColumn(e,t,n);case Ze.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(e,t,n);case Ze.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(e,t,n);case Ze.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(e,t,n);case Ze.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(e,t,n);default:return null}}static viewportMove(e,t,i,n,o){let s=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(i){case Ze.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(e.model,a,o),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,d)]}case Ze.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(e.model,a,o),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,d)]}case Ze.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,d)]}case Ze.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=t.length;d<c;d++){let u=t[d];l[d]=this.findPositionInViewportIfOutside(e,u,s,n)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,n){let o=t.viewState.position.lineNumber;if(i.startLineNumber<=o&&o<=i.endLineNumber-1)return new ot(t.modelState,t.viewState);{let s;o>i.endLineNumber-1?s=i.endLineNumber-1:o<i.startLineNumber?s=i.startLineNumber:s=o;let a=Pi.vertical(e.cursorConfig,e,o,t.viewState.position.column,t.viewState.leftoverVisibleColumns,s,!1);return ot.fromViewState(t.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){return t.map(o=>ot.fromViewState(Pi.moveLeft(e.cursorConfig,e,o.viewState,i,n)))}static _moveHalfLineLeft(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);n[o]=ot.fromViewState(Pi.moveLeft(e.cursorConfig,e,a.viewState,i,d))}return n}static _moveRight(e,t,i,n){return t.map(o=>ot.fromViewState(Pi.moveRight(e.cursorConfig,e,o.viewState,i,n)))}static _moveHalfLineRight(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);n[o]=ot.fromViewState(Pi.moveRight(e.cursorConfig,e,a.viewState,i,d))}return n}static _moveDownByViewLines(e,t,i,n){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=ot.fromViewState(Pi.moveDown(e.cursorConfig,e,l.viewState,i,n))}return o}static _moveDownByModelLines(e,t,i,n){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=ot.fromModelState(Pi.moveDown(e.cursorConfig,e.model,l.modelState,i,n))}return o}static _moveUpByViewLines(e,t,i,n){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=ot.fromViewState(Pi.moveUp(e.cursorConfig,e,l.viewState,i,n))}return o}static _moveUpByModelLines(e,t,i,n){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=ot.fromModelState(Pi.moveUp(e.cursorConfig,e.model,l.modelState,i,n))}return o}static _moveToViewPosition(e,t,i,n,o){return ot.fromViewState(t.viewState.move(i,n,o,0))}static _moveToModelPosition(e,t,i,n,o){return ot.fromModelState(t.modelState.move(i,n,o,0))}static _moveToViewMinColumn(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=e.getLineMinColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,d)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=e.getLineFirstNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,d)}return n}static _moveToViewCenterColumn(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);n[o]=this._moveToViewPosition(e,a,i,l,d)}return n}static _moveToViewMaxColumn(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=e.getLineMaxColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,d)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=e.getLineLastNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,d)}return n}},Ze;(a=>{let r=function(l){if(!gi(l))return!1;let d=l;return!(!Wi(d.to)||!kn(d.select)&&!KS(d.select)||!kn(d.by)&&!Wi(d.by)||!kn(d.value)&&!so(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:r,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function n(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=n;let o;(D=>(D[D.Left=0]="Left",D[D.Right=1]="Right",D[D.Up=2]="Up",D[D.Down=3]="Down",D[D.PrevBlankLine=4]="PrevBlankLine",D[D.NextBlankLine=5]="NextBlankLine",D[D.WrappedLineStart=6]="WrappedLineStart",D[D.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",D[D.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",D[D.WrappedLineEnd=9]="WrappedLineEnd",D[D.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",D[D.ViewPortTop=11]="ViewPortTop",D[D.ViewPortCenter=12]="ViewPortCenter",D[D.ViewPortBottom=13]="ViewPortBottom",D[D.ViewPortIfOutside=14]="ViewPortIfOutside"))(o=a.Direction||={});let s;(m=>(m[m.None=0]="None",m[m.Line=1]="Line",m[m.WrappedLine=2]="WrappedLine",m[m.Character=3]="Character",m[m.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(Ze||={});function ZX(r,e,t){let i=r.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let n,o=-1;for(n=e-1;n>=1;n--){if(r.tokenization.getLanguageIdAtPosition(n,0)!==i)return o;let s=r.getLineContent(n);if(t.shouldIgnore(n)||/^\s+$/.test(s)||s===""){o=n;continue}return n}}return-1}function XI(r,e,t,i=!0,n){if(r<4)return null;let o=n.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!o)return null;let s=new LD(e,o,n);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=ZX(e,t,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=e.getLineContent(a);return{indentation:Ln(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=e.getLineContent(a);return{indentation:Ln(l),action:null,line:a}}else{if(a===1)return{indentation:Ln(e.getLineContent(a)),action:null,line:a};let l=a-1,d=o.getIndentMetadata(e.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(u)){c=u;break}return{indentation:Ln(e.getLineContent(c+1)),action:null,line:c+1}}if(i)return{indentation:Ln(e.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:Ln(e.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let u=0;for(let p=c-1;p>0;p--)if(!s.shouldIndentNextLine(c)){u=p;break}return{indentation:Ln(e.getLineContent(u+1)),action:null,line:u+1}}else if(s.shouldDecrease(c))return{indentation:Ln(e.getLineContent(c)),action:null,line:c}}return{indentation:Ln(e.getLineContent(1)),action:null,line:1}}}function R9(r,e,t,i,n){if(r<4)return null;let o=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=n.getLanguageConfiguration(o).indentRulesSupport;if(!s)return null;e.tokenization.forceTokenization(t.startLineNumber);let l=new Mh(e,n).getProcessedTokenContextAroundRange(t),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,u=Ln(c.getLineContent()),p=XX(e,t.startLineNumber,c),m=kD(e,t.getStartPosition()),f=e.getLineContent(t.startLineNumber),g=Ln(f),b=XI(r,p,t.startLineNumber+1,void 0,n);if(!b){let I=m?g:u;return{beforeEnter:I,afterEnter:I}}let v=m?g:b.indentation;return b.action===1&&(v=i.shiftIndent(v)),s.shouldDecrease(d.getLineContent())&&(v=i.unshiftIndent(v)),{beforeEnter:m?g:u,afterEnter:v}}function A9(r,e,t,i,n,o){let s=r.autoIndent;if(s<4||kD(e,t.getStartPosition()))return null;let l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),d=o.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let u=new Mh(e,o).getProcessedTokenContextAroundRange(t),p=u.beforeRangeProcessedTokens.getLineContent(),m=u.afterRangeProcessedTokens.getLineContent(),f=p+m,g=p+i+m;if(!d.shouldDecrease(f)&&d.shouldDecrease(g)){let v=XI(s,e,t.startLineNumber,!1,o);if(!v)return null;let I=v.indentation;return v.action!==1&&(I=n.unshiftIndent(I)),I}let b=t.startLineNumber-1;if(b>0){let v=e.getLineContent(b);if(d.shouldIndentNextLine(v)&&d.shouldIncrease(g)){let w=XI(s,e,t.startLineNumber,!1,o)?.indentation;if(w!==void 0){let E=e.getLineContent(t.startLineNumber),S=Ln(E),D=n.shiftIndent(w)===S,L=/^\s*$/.test(f),A=r.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),j=A&&A.length>0&&L;if(D&&j)return w}}}return null}function XX(r,e,t){return{tokenization:{getLineTokens:n=>n===e?t:r.tokenization.getLineTokens(n),getLanguageId:()=>r.getLanguageId(),getLanguageIdAtPosition:(n,o)=>r.getLanguageIdAtPosition(n,o)},getLineContent:n=>n===e?t.getLineContent():r.getLineContent(n)}}var LD=class{_indentRulesSupport;_indentationLineProcessor;constructor(e,t,i){this._indentRulesSupport=t,this._indentationLineProcessor=new RD(e,i)}shouldIncrease(e,t){let i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(e,t){let i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(e,t){let i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(e,t){let i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(i)}},Mh=class{model;indentationLineProcessor;constructor(e,t){this.model=e,this.indentationLineProcessor=new RD(e,t)}getProcessedTokenContextAroundRange(e){let t=this._getProcessedTokensBeforeRange(e),i=this._getProcessedTokensAfterRange(e),n=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);let t=this.model.tokenization.getLineTokens(e.startLineNumber),i=Nl(t,e.startColumn-1),n;if(kD(this.model,e.getStartPosition())){let s=e.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+s;n=t.sliceAndInflate(a,l,0)}else{let s=e.startColumn-1;n=t.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(e){let t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);let i=this.model.tokenization.getLineTokens(t.lineNumber),n=Nl(i,t.column-1),o=t.column-1-n.firstCharOffset,s=n.firstCharOffset+o,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){let t=m=>{this.model.tokenization.forceTokenization(m);let f=this.model.tokenization.getLineTokens(m),g=this.model.getLineMaxColumn(m)-1;return Nl(f,g)};this.model.tokenization.forceTokenization(e.startLineNumber);let i=this.model.tokenization.getLineTokens(e.startLineNumber),n=Nl(i,e.startColumn-1),o=Xi.createEmpty("",n.languageIdCodec),s=e.startLineNumber-1;if(s===0||!(n.firstCharOffset===0))return o;let d=t(s);if(!(n.languageId===d.languageId))return o;let u=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}},RD=class{constructor(e,t){this.model=e;this.languageConfigurationService=t}getProcessedLine(e,t){let i=(s,a)=>{let l=Ln(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(e);let n=this.model.tokenization.getLineTokens(e),o=this.getProcessedTokens(n).getLineContent();return t!==void 0&&(o=i(o,t)),o}getProcessedTokens(e){let t=l=>l===2||l===3||l===1,i=e.getLanguageId(0),o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),s=[];return e.forEach(l=>{let d=e.getStandardTokenType(l),c=e.getTokenText(l);t(d)&&(c=c.replace(o,""));let u=e.getMetadata(l);s.push({text:c,metadata:u})}),Xi.createFromTextAndMetadata(s,e.languageIdCodec)}};function kD(r,e){r.tokenization.forceTokenization(e.lineNumber);let t=r.tokenization.getLineTokens(e.lineNumber),i=Nl(t,e.column-1),n=i.firstCharOffset===0,o=t.getLanguageId(0)===i.languageId;return!n&&!o}function QI(r,e,t,i){e.tokenization.forceTokenization(t.startLineNumber);let n=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),o=i.getLanguageConfiguration(n);if(!o)return null;let a=new Mh(e,i).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),u=o.onEnter(r,l,d,c);if(!u)return null;let p=u.indentAction,m=u.appendText,f=u.removeText||0;m?p===1&&(m="	"+m):p===1||p===2?m="	":m="";let g=Vw(e,t.startLineNumber,t.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:p,appendText:m,removeText:f,indentation:g}}var tF=Object.create(null);function Oh(r,e){if(e<=0)return"";tF[r]||(tF[r]=["",r]);let t=tF[r];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+r;return t[e]}var as=class{constructor(e,t,i){this._languageConfigurationService=i;this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,i,n,o){let s=oi.visibleColumnFromColumn(e,t,i);if(o){let a=Oh(" ",n),d=oi.prevIndentTabStop(s,n)/n;return Oh(a,d)}else{let a="	",d=oi.prevRenderTabStop(s,i)/i;return Oh(a,d)}}static shiftIndent(e,t,i,n,o){let s=oi.visibleColumnFromColumn(e,t,i);if(o){let a=Oh(" ",n),d=oi.nextIndentTabStop(s,n)/n;return Oh(a,d)}else{let a="	",d=oi.nextRenderTabStop(s,i)/i;return Oh(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){let i=this._selection.startLineNumber,n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);let{tabSize:o,indentSize:s,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let u=i;u<=n;u++,d=c){c=0;let p=e.getLineContent(u),m=qi(p);if(this._opts.isUnshift&&(p.length===0||m===0)||!l&&!this._opts.isUnshift&&p.length===0)continue;if(m===-1&&(m=p.length),u>1&&oi.visibleColumnFromColumn(p,m+1,o)%s!==0&&e.tokenization.isCheapToTokenize(u-1)){let b=QI(this._opts.autoIndent,e,new O(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(b){if(c=d,b.appendText)for(let v=0,I=b.appendText.length;v<I&&c<s&&b.appendText.charCodeAt(v)===32;v++)c++;b.removeText&&(c=Math.max(0,c-b.removeText));for(let v=0;v<c&&!(m===0||p.charCodeAt(m-1)!==32);v++)m--}}if(this._opts.isUnshift&&m===0)continue;let f;this._opts.isUnshift?f=as.unshiftIndent(p,m+1,o,s,a):f=as.shiftIndent(p,m+1,o,s,a),this._addEditOperation(t,new O(u,1,u,m+1),f),u===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=m+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?Oh(" ",s):"	";for(let c=i;c<=n;c++){let u=e.getLineContent(c),p=qi(u);if(!(this._opts.isUnshift&&(u.length===0||p===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(p===-1&&(p=u.length),!(this._opts.isUnshift&&p===0)))if(this._opts.isUnshift){p=Math.min(p,s);for(let m=0;m<p;m++)if(u.charCodeAt(m)===9){p=m+1;break}this._addEditOperation(t,new O(c,1,c,p+1),"")}else this._addEditOperation(t,new O(c,1,c,1),d),c===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let n=t.getInverseEditOperations()[0];return new tt(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}let i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new tt(i.startLineNumber,n,i.endLineNumber,i.endColumn):new tt(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};as=R([y(2,zd)],as);var AD=class{_range;_charBeforeSelection;_charAfterSelection;constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new O(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new O(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let i=t.getInverseEditOperations(),n=i[0].range,o=i[1].range;return new tt(n.endLineNumber,n.endColumn,o.endLineNumber,o.endColumn-this._charAfterSelection.length)}},MD=class{constructor(e,t,i){this._position=e;this._text=t;this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new O(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return new tt(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}};var OD=class{static getEdits(e,t,i,n,o){if(!o&&this._isAutoIndentType(e,t,i)){let s=[];for(let l of i){let d=this._findActualIndentationForSelection(e,t,l,n);if(d===null)return;s.push({selection:l,indentation:d})}let a=Nf.getAutoClosingPairClose(e,t,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,s,n,a)}}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let n=0,o=i.length;n<o;n++)if(!t.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,i,n){let o=A9(e,t,i,n,{shiftIndent:a=>JI(e,a),unshiftIndent:a=>Vf(e,a)},e.languageConfigurationService);if(o===null)return null;let s=Vw(t,i.startLineNumber,i.startColumn);return o===e.normalizeIndentation(s)?null:o}static _getIndentationAndAutoClosingPairEdits(e,t,i,n,o){let s=i.map(({selection:l,indentation:d})=>{if(o!==null){let c=this._getEditFromIndentationAndSelection(e,t,d,l,n,!1);return new nF(c,l,n,o)}else{let c=this._getEditFromIndentationAndSelection(e,t,d,l,n,!0);return Ph(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new wn(4,s,a)}static _getEditFromIndentationAndSelection(e,t,i,n,o,s=!0){let a=n.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a),d=e.normalizeIndentation(i);if(l!==0){let u=t.getLineContent(a);d+=u.substring(l-1,n.startColumn-1)}return d+=s?o:"",{range:new O(a,1,n.endLineNumber,n.endColumn),text:d}}},PD=class{static getEdits(e,t,i,n,o,s){if(P9(t,i,n,o,s))return this._runAutoClosingOvertype(e,n,s)}static _runAutoClosingOvertype(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let l=t[o].getPosition(),d=new O(l.lineNumber,l.column,l.lineNumber,l.column+1);n[o]=new So(d,i)}return new wn(4,n,{shouldPushStackElementBefore:KD(e,4),shouldPushStackElementAfter:!1})}},ND=class{static getEdits(e,t,i,n,o){if(P9(e,t,i,n,o)){let s=i.map(a=>new So(new O(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new wn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},Nf=class{static getEdits(e,t,i,n,o,s){if(!s){let a=this.getAutoClosingPairClose(e,t,i,n,o);if(a!==null)return this._runAutoClosingOpenCharType(i,n,o,a)}}static _runAutoClosingOpenCharType(e,t,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=new iF(l,t,!i,n)}return new wn(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,i,n,o){for(let f of i)if(!f.isEmpty())return null;let s=i.map(f=>{let g=f.getPosition();return o?{lineNumber:g.lineNumber,beforeColumn:g.column-n.length,afterColumn:g.column}:{lineNumber:g.lineNumber,beforeColumn:g.column,afterColumn:g.column}}),a=this._findAutoClosingPairOpen(e,t,s.map(f=>new F(f.lineNumber,f.beforeColumn)),n);if(!a)return null;let l,d;if(Ka(n)?(l=e.autoClosingQuotes,d=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,d=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,d=e.shouldAutoCloseBefore.bracket),l==="never")return null;let u=this._findContainedAutoClosingPair(e,a),p=u?u.close:"",m=!0;for(let f of s){let{lineNumber:g,beforeColumn:b,afterColumn:v}=f,I=t.getLineContent(g),w=I.substring(0,b-1),E=I.substring(v-1);if(E.startsWith(p)||(m=!1),E.length>0){let L=E.charAt(0);if(!this._isBeforeClosingBrace(e,E)&&!d(L))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){let L=Al(e.wordSeparators,[]);if(w.length>0){let A=w.charCodeAt(w.length-1);if(L.get(A)===0)return null}}if(!t.tokenization.isCheapToTokenize(g))return null;t.tokenization.forceTokenization(g);let S=t.tokenization.getLineTokens(g),T=Nl(S,b-1);if(!a.shouldAutoClose(T,b-T.firstCharOffset))return null;let D=a.findNeutralCharacter();if(D){let L=t.tokenization.getTokenTypeIfInsertingCharacter(g,b,D);if(!a.isOK(L))return null}}return m?a.close.substring(0,a.close.length-p.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;let i=t.close.charAt(t.close.length-1),n=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[],o=null;for(let s of n)s.open!==t.open&&t.open.includes(s.open)&&t.close.endsWith(s.close)&&(!o||s.open.length>o.open.length)&&(o=s);return o}static _findAutoClosingPairOpen(e,t,i,n){let o=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!o)return null;let s=null;for(let a of o)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of i)if(t.getValueInRange(new O(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+n!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(e,t){let i=t.charAt(0),n=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],o=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],s=n.some(l=>t.startsWith(l.open)),a=o.some(l=>t.startsWith(l.close));return!s&&a}},FD=class{static getEdits(e,t,i,n,o){if(!o&&this._isSurroundSelectionType(e,t,i,n))return this._runSurroundSelectionType(e,i,n)}static _runSurroundSelectionType(e,t,i){let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=e.surroundingPairs[i];n[o]=new AD(a,i,l)}return new wn(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,i,n){if(!rF(e,n)||!e.surroundingPairs.hasOwnProperty(n))return!1;let o=Ka(n);for(let s of i){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=t.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,u=l===s.endLineNumber?s.endColumn-1:d.length,p=d.substring(c,u);if(/[^ \t]/.test(p)){a=!1;break}}if(a)return!1;if(o&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=t.getValueInRange(s);if(Ka(l))return!1}}return!0}},BD=class{static getEdits(e,t,i,n,o,s){if(!s&&this._isTypeInterceptorElectricChar(t,i,n)){let a=this._typeInterceptorElectricChar(e,t,i,n[0],o);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,n,o){if(!t.electricChars.hasOwnProperty(o)||!n.isEmpty())return null;let s=n.getPosition();i.tokenization.forceTokenization(s.lineNumber);let a=i.tokenization.getLineTokens(s.lineNumber),l;try{l=t.onElectricCharacter(o,a,s.column)}catch(d){return Ge(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+o).lastIndexOf(l.matchOpenBracket)+1,c=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let u=i.getLineContent(c.startLineNumber),p=Ln(u),m=t.normalizeIndentation(p),f=i.getLineContent(s.lineNumber),g=i.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,b=f.substring(g-1,s.column-1),v=m+b+o,I=new O(s.lineNumber,1,s.lineNumber,s.column),w=new So(I,v);return new wn(oF(v,e),[w],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},VD=class{static getEdits(e,t,i){let n=[];for(let s=0,a=t.length;s<a;s++)n[s]=new So(t[s],i);let o=oF(i,e);return new wn(o,n,{shouldPushStackElementBefore:KD(e,o),shouldPushStackElementAfter:!1})}},Ff=class{static getEdits(e,t,i,n,o){if(!o&&n===`
`){let s=[];for(let a=0,l=i.length;a<l;a++)s[a]=this._enter(e,t,!1,i[a]);return new wn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,i,n){if(e.autoIndent===0)return Ph(n,`
`,i);if(!t.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(n.startLineNumber),d=Ln(l).substring(0,n.startColumn-1);return Ph(n,`
`+e.normalizeIndentation(d),i)}let o=QI(e.autoIndent,t,n,e.languageConfigurationService);if(o){if(o.indentAction===0)return Ph(n,`
`+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===1)return Ph(n,`
`+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===2){let l=e.normalizeIndentation(o.indentation),d=e.normalizeIndentation(o.indentation+o.appendText),c=`
`+d+`
`+l;return i?new Rh(n,c,!0):new Ah(n,c,-1,d.length-l.length,!0)}else if(o.indentAction===3){let l=Vf(e,o.indentation);return Ph(n,`
`+e.normalizeIndentation(l+o.appendText),i)}}let s=t.getLineContent(n.startLineNumber),a=Ln(s).substring(0,n.startColumn-1);if(e.autoIndent>=4){let l=R9(e.autoIndent,t,n,{unshiftIndent:d=>Vf(e,d),shiftIndent:d=>JI(e,d),normalizeIndentation:d=>e.normalizeIndentation(d)},e.languageConfigurationService);if(l){let d=e.visibleColumnFromColumn(t,n.getEndPosition()),c=n.endColumn,u=t.getLineContent(n.endLineNumber),p=qi(u);if(p>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,p+1)):n=n.setEndPosition(n.endLineNumber,t.getLineMaxColumn(n.endLineNumber)),i)return new Rh(n,`
`+e.normalizeIndentation(l.afterEnter),!0);{let m=0;return c<=p+1&&(e.insertSpaces||(d=Math.ceil(d/e.indentSize)),m=Math.min(d+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new Ah(n,`
`+e.normalizeIndentation(l.afterEnter),0,m,!0)}}}return Ph(n,`
`+e.normalizeIndentation(a),i)}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].positionLineNumber;if(a===1)n[o]=new Rh(new O(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);n[o]=this._enter(e,t,!1,new O(a,l,a,l))}}return n}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].positionLineNumber,l=t.getLineMaxColumn(a);n[o]=this._enter(e,t,!1,new O(a,l,a,l))}return n}static lineBreakInsert(e,t,i){let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=this._enter(e,t,!0,i[o]);return n}},WD=class{static getEdits(e,t,i,n,o,s){let a=this._distributePasteToCursors(e,i,n,o,s);return a?(i=i.sort(O.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,n,o)}static _distributePasteToCursors(e,t,i,n,o){if(n||t.length===1)return null;if(o&&o.length===t.length)return o;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));let s=vv(i);if(s.length===t.length)return s}return null}static _distributedPaste(e,t,i,n){let o=[];for(let s=0,a=i.length;s<a;s++)o[s]=new So(i[s],n[s]);return new wn(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,n,o){let s=[];for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d.getPosition();if(o&&!d.isEmpty()&&(o=!1),o&&n.indexOf(`
`)!==n.length-1&&(o=!1),o){let u=new O(c.lineNumber,1,c.lineNumber,1);s[a]=new _D(u,n,d,!0)}else s[a]=new So(d,n)}return new wn(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},HD=class{static getEdits(e,t,i,n,o,s,a,l){let d=n.map(c=>this._compositionType(i,c,o,s,a,l));return new wn(4,d,{shouldPushStackElementBefore:KD(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,n,o,s){if(!t.isEmpty())return null;let a=t.getPosition(),l=Math.max(1,a.column-n),d=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+o),c=new O(a.lineNumber,l,a.lineNumber,d);return e.getValueInRange(c)===i&&s===0?null:new Ah(c,i,0,s)}},UD=class{static getEdits(e,t,i){let n=[];for(let s=0,a=t.length;s<a;s++)n[s]=new So(t[s],i);let o=oF(i,e);return new wn(o,n,{shouldPushStackElementBefore:KD(e,o),shouldPushStackElementAfter:!1})}},zD=class{static getCommands(e,t,i){let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(e,t,a.startLineNumber);d=d||"	";let c=e.normalizeIndentation(d);if(!l.startsWith(c)){n[o]=new So(new O(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}n[o]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[o]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}n[o]=new as(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return n}static _goodIndentForLine(e,t,i){let n=null,o="",s=XI(e.autoIndent,t,i,!1,e.languageConfigurationService);if(s)n=s.action,o=s.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){let c=t.getLineContent(a);if(fs(c)>=0)break}if(a<1)return null;let l=t.getLineMaxColumn(a),d=QI(e.autoIndent,t,new O(a,l,a,l),e.languageConfigurationService);d&&(o=d.indentation+d.appendText)}return n&&(n===1&&(o=JI(e,o)),n===3&&(o=Vf(e,o)),o=e.normalizeIndentation(o)),o||null}static _replaceJumpToNextIndent(e,t,i,n){let o="",s=i.getStartPosition();if(e.insertSpaces){let a=e.visibleColumnFromColumn(t,s),l=e.indentSize,d=l-a%l;for(let c=0;c<d;c++)o+=" "}else o="	";return new So(i,o,n)}},Bf=class extends Ah{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(e,t,i,n,o,s){super(e,t,i,n),this._openCharacter=o,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,i){return this.closeCharacterRange=new O(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new O(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,i)}},iF=class extends Bf{constructor(e,t,i,n){let o=(i?t:"")+n,s=0,a=-n.length;super(e,o,s,a,t,n)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,n,t)}},nF=class extends Bf{_autoIndentationEdit;_autoClosingEdit;constructor(e,t,i,n){let o=i+n,s=0,a=i.length;super(t,o,s,a,i,n),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:o}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){let i=t.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");let n=i[0].range,o=i[1].range,s=n.plusRange(o);return this._computeCursorStateWithRange(e,s,t)}};function oF(r,e){return r===" "?e===5||e===6?6:5:4}function KD(r,e){return O9(r)&&!O9(e)?!0:r===5?!1:M9(r)!==M9(e)}function M9(r){return r===6||r===5?"space":r}function O9(r){return r===4||r===5||r===6}function P9(r,e,t,i,n){if(r.autoClosingOvertype==="never"||!r.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let o=0,s=t.length;o<s;o++){let a=t[o];if(!a.isEmpty())return!1;let l=a.getPosition(),d=e.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==n)return!1;let u=Ka(n);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&u)return!1;if(r.autoClosingOvertype==="auto"){let m=!1;for(let f=0,g=i.length;f<g;f++){let b=i[f];if(l.lineNumber===b.startLineNumber&&l.column===b.startColumn){m=!0;break}}if(!m)return!1}}return!0}function Ph(r,e,t){return t?new Rh(r,e,!0):new So(r,e,!0)}function JI(r,e,t){return t=t||1,as.shiftIndent(e,e.length+t,r.tabSize,r.indentSize,r.insertSpaces)}function Vf(r,e,t){return t=t||1,as.unshiftIndent(e,e.length+t,r.tabSize,r.indentSize,r.insertSpaces)}function rF(r,e){return Ka(e)?r.autoSurround==="quotes"||r.autoSurround==="languageDefined":r.autoSurround==="brackets"||r.autoSurround==="languageDefined"}var Ja=class{static indent(e,t,i){if(t===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=new as(i[o],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static outdent(e,t,i){let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=new as(i[o],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static shiftIndent(e,t,i){return JI(e,t,i)}static unshiftIndent(e,t,i){return Vf(e,t,i)}static paste(e,t,i,n,o,s){return WD.getEdits(e,t,i,n,o,s)}static tab(e,t,i){return zD.getCommands(e,t,i)}static compositionType(e,t,i,n,o,s,a,l){return HD.getEdits(e,t,i,n,o,s,a,l)}static compositionEndWithInterceptors(e,t,i,n,o,s){if(!n)return null;let a=null;for(let p of n)if(a===null)a=p.insertedText;else if(a!==p.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let p of n)if(p.deletedText.length!==0){d=!0;break}if(d){if(!rF(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;let p=Ka(l);for(let g of n)if(g.deletedSelectionStart!==0||g.deletedSelectionEnd!==g.deletedText.length||/^[ \t]+$/.test(g.deletedText)||p&&Ka(g.deletedText))return null;let m=[];for(let g of o){if(!g.isEmpty())return null;m.push(g.getPosition())}if(m.length!==n.length)return null;let f=[];for(let g=0,b=m.length;g<b;g++)f.push(new MD(m[g],n[g].deletedText,t.surroundingPairs[l]));return new wn(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=ND.getEdits(t,i,o,s,l);if(c!==void 0)return c;let u=Nf.getEdits(t,i,o,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(e,t,i,n,o,s,a){let l=Ff.getEdits(i,n,o,a,e);if(l!==void 0)return l;let d=OD.getEdits(i,n,o,a,e);if(d!==void 0)return d;let c=PD.getEdits(t,i,n,o,s,a);if(c!==void 0)return c;let u=Nf.getEdits(i,n,o,a,!1,e);if(u!==void 0)return u;let p=FD.getEdits(i,n,o,a,e);if(p!==void 0)return p;let m=BD.getEdits(t,i,n,o,a,e);return m!==void 0?m:VD.getEdits(t,o,a)}static typeWithoutInterceptors(e,t,i,n,o){return UD.getEdits(e,n,o)}},GD=class{constructor(e,t,i,n,o,s){this.deletedText=e;this.deletedSelectionStart=t;this.deletedSelectionEnd=i;this.insertedText=n;this.insertedSelectionStart=o;this.insertedSelectionEnd=s}};var Et=0,Ci=class extends VI{runEditorCommand(e,t,i){let n=t._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}},Eo;(a=>{let r=function(l){if(!gi(l))return!1;let d=l;return!(!Wi(d.to)||!kn(d.by)&&!Wi(d.by)||!kn(d.value)&&!so(d.value)||!kn(d.revealCursor)&&!KS(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:r,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function n(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let u=Math.floor(l.value||1),p=!!l.revealCursor;return{direction:d,unit:c,value:u,revealCursor:p,select:!!l.select}}a.parse=n;let o;(p=>(p[p.Up=1]="Up",p[p.Right=2]="Right",p[p.Down=3]="Down",p[p.Left=4]="Left"))(o=a.Direction||={});let s;(f=>(f[f.Line=1]="Line",f[f.WrappedLine=2]="WrappedLine",f[f.Page=3]="Page",f[f.HalfPage=4]="HalfPage",f[f.Editor=5]="Editor",f[f.Column=6]="Column"))(s=a.Unit||={})})(Eo||={});var eC;(i=>{let r=function(n){if(!gi(n))return!1;let o=n;return!(!so(o.lineNumber)&&!Wi(o.lineNumber)||!kn(o.at)&&!Wi(o.at))};i.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:r,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},i.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(eC||={});var tC=class{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{let n=t.get(sd).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(t,n,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{let n=mn();return n&&Gr(n)?(this.runDOMCommand(n),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{let n=t.get(sd).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(t,n,i)):!1})}_runEditorCommand(e,t,i){let n=this.runEditorCommand(e,t,i);return n||!0}};var xn;(xe=>{class r extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){if(!ce.position)return;V.model.pushStackElement(),V.setCursorStates(ce.source,3,[Hn.moveTo(V,V.getPrimaryCursorState(),this._inSelectionMode,ce.position,ce.viewPosition)])&&ce.revealType!==2&&V.revealAllCursors(ce.source,!0,!0)}}xe.MoveTo=et(new r({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),xe.MoveToSelect=et(new r({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class i extends Ci{runCoreEditorCommand(V,ce){V.model.pushStackElement();let Ee=this._getColumnSelectResult(V,V.getPrimaryCursorState(),V.getCursorColumnSelectData(),ce);Ee!==null&&(V.setCursorStates(ce.source,3,Ee.viewStates.map(ut=>ot.fromViewState(ut))),V.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:Ee.fromLineNumber,fromViewVisualColumn:Ee.fromVisualColumn,toViewLineNumber:Ee.toLineNumber,toViewVisualColumn:Ee.toVisualColumn}),Ee.reversed?V.revealTopMostCursor(ce.source):V.revealBottomMostCursor(ce.source))}}xe.ColumnSelect=et(new class extends i{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(be,V,ce,Ee){if(typeof Ee.position>"u"||typeof Ee.viewPosition>"u"||typeof Ee.mouseColumn>"u")return null;let ut=be.model.validatePosition(Ee.position),$t=be.coordinatesConverter.validateViewPosition(new F(Ee.viewPosition.lineNumber,Ee.viewPosition.column),ut),Gn=Ee.doColumnSelect?ce.fromViewLineNumber:$t.lineNumber,To=Ee.doColumnSelect?ce.fromViewVisualColumn:Ee.mouseColumn-1;return Fu.columnSelect(be.cursorConfig,be,Gn,To,$t.lineNumber,Ee.mouseColumn-1)}}),xe.CursorColumnSelectLeft=et(new class extends i{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(be,V,ce,Ee){return Fu.columnSelectLeft(be.cursorConfig,be,ce)}}),xe.CursorColumnSelectRight=et(new class extends i{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(be,V,ce,Ee){return Fu.columnSelectRight(be.cursorConfig,be,ce)}});class a extends i{_isPaged;constructor(V){super(V),this._isPaged=V.isPaged}_getColumnSelectResult(V,ce,Ee,ut){return Fu.columnSelectUp(V.cursorConfig,V,Ee,this._isPaged)}}xe.CursorColumnSelectUp=et(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:3600,linux:{primary:0}}})),xe.CursorColumnSelectPageUp=et(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends i{_isPaged;constructor(V){super(V),this._isPaged=V.isPaged}_getColumnSelectResult(V,ce,Ee,ut){return Fu.columnSelectDown(V.cursorConfig,V,Ee,this._isPaged)}}xe.CursorColumnSelectDown=et(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:3602,linux:{primary:0}}})),xe.CursorColumnSelectPageDown=et(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:3596,linux:{primary:0}}}));class m extends Ci{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Ze.metadata})}runCoreEditorCommand(V,ce){let Ee=Ze.parse(ce);Ee&&this._runCursorMove(V,ce.source,Ee)}_runCursorMove(V,ce,Ee){V.model.pushStackElement(),V.setCursorStates(ce,3,m._move(V,V.getCursorStates(),Ee)),V.revealAllCursors(ce,!0)}static _move(V,ce,Ee){let ut=Ee.select,$t=Ee.value;switch(Ee.direction){case Ze.Direction.Left:case Ze.Direction.Right:case Ze.Direction.Up:case Ze.Direction.Down:case Ze.Direction.PrevBlankLine:case Ze.Direction.NextBlankLine:case Ze.Direction.WrappedLineStart:case Ze.Direction.WrappedLineFirstNonWhitespaceCharacter:case Ze.Direction.WrappedLineColumnCenter:case Ze.Direction.WrappedLineEnd:case Ze.Direction.WrappedLineLastNonWhitespaceCharacter:return Hn.simpleMove(V,ce,Ee.direction,ut,$t,Ee.unit);case Ze.Direction.ViewPortTop:case Ze.Direction.ViewPortBottom:case Ze.Direction.ViewPortCenter:case Ze.Direction.ViewPortIfOutside:return Hn.viewportMove(V,ce,Ee.direction,ut,$t);default:return null}}}xe.CursorMoveImpl=m,xe.CursorMove=et(new m);let g;(V=>V[V.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(g||={});class b extends Ci{_staticArgs;constructor(V){super(V),this._staticArgs=V.args}runCoreEditorCommand(V,ce){let Ee=this._staticArgs;this._staticArgs.value===-1&&(Ee={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:ce.pageSize||V.cursorConfig.pageSize}),V.model.pushStackElement(),V.setCursorStates(ce.source,3,Hn.simpleMove(V,V.getCursorStates(),Ee.direction,Ee.select,Ee.value,Ee.unit)),V.revealAllCursors(ce.source,!0)}}xe.CursorLeft=et(new b({args:{direction:Ze.Direction.Left,unit:Ze.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),xe.CursorLeftSelect=et(new b({args:{direction:Ze.Direction.Left,unit:Ze.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:1039}})),xe.CursorRight=et(new b({args:{direction:Ze.Direction.Right,unit:Ze.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),xe.CursorRightSelect=et(new b({args:{direction:Ze.Direction.Right,unit:Ze.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:1041}})),xe.CursorUp=et(new b({args:{direction:Ze.Direction.Up,unit:Ze.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),xe.CursorUpSelect=et(new b({args:{direction:Ze.Direction.Up,unit:Ze.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),xe.CursorPageUp=et(new b({args:{direction:Ze.Direction.Up,unit:Ze.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:11}})),xe.CursorPageUpSelect=et(new b({args:{direction:Ze.Direction.Up,unit:Ze.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:1035}})),xe.CursorDown=et(new b({args:{direction:Ze.Direction.Down,unit:Ze.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),xe.CursorDownSelect=et(new b({args:{direction:Ze.Direction.Down,unit:Ze.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),xe.CursorPageDown=et(new b({args:{direction:Ze.Direction.Down,unit:Ze.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:12}})),xe.CursorPageDownSelect=et(new b({args:{direction:Ze.Direction.Down,unit:Ze.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:1036}})),xe.CreateCursor=et(new class extends Ci{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(be,V){if(!V.position)return;let ce;V.wholeLine?ce=Hn.line(be,be.getPrimaryCursorState(),!1,V.position,V.viewPosition):ce=Hn.moveTo(be,be.getPrimaryCursorState(),!1,V.position,V.viewPosition);let Ee=be.getCursorStates();if(Ee.length>1){let ut=ce.modelState?ce.modelState.position:null,$t=ce.viewState?ce.viewState.position:null;for(let Gn=0,To=Ee.length;Gn<To;Gn++){let Qe=Ee[Gn];if(!(ut&&!Qe.modelState.selection.containsPosition(ut))&&!($t&&!Qe.viewState.selection.containsPosition($t))){Ee.splice(Gn,1),be.model.pushStackElement(),be.setCursorStates(V.source,3,Ee);return}}}Ee.push(ce),be.model.pushStackElement(),be.setCursorStates(V.source,3,Ee)}}),xe.LastCursorMoveToSelect=et(new class extends Ci{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(be,V){if(!V.position)return;let ce=be.getLastAddedCursorIndex(),Ee=be.getCursorStates(),ut=Ee.slice(0);ut[ce]=Hn.moveTo(be,Ee[ce],!0,V.position,V.viewPosition),be.model.pushStackElement(),be.setCursorStates(V.source,3,ut)}});class re extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){V.model.pushStackElement(),V.setCursorStates(ce.source,3,Hn.moveToBeginningOfLine(V,V.getCursorStates(),this._inSelectionMode)),V.revealAllCursors(ce.source,!0)}}xe.CursorHome=et(new re({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),xe.CursorHomeSelect=et(new re({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class de extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){V.model.pushStackElement(),V.setCursorStates(ce.source,3,this._exec(V.getCursorStates())),V.revealAllCursors(ce.source,!0)}_exec(V){let ce=[];for(let Ee=0,ut=V.length;Ee<ut;Ee++){let $t=V[Ee],Gn=$t.modelState.position.lineNumber;ce[Ee]=ot.fromModelState($t.modelState.move(this._inSelectionMode,Gn,1,0))}return ce}}xe.CursorLineStart=et(new de({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:0,mac:{primary:287}}})),xe.CursorLineStartSelect=et(new de({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:0,mac:{primary:1311}}}));class fe extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){V.model.pushStackElement(),V.setCursorStates(ce.source,3,Hn.moveToEndOfLine(V,V.getCursorStates(),this._inSelectionMode,ce.sticky||!1)),V.revealAllCursors(ce.source,!0)}}xe.CursorEnd=et(new fe({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:Et,kbExpr:Se.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:h("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),xe.CursorEndSelect=et(new fe({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:Et,kbExpr:Se.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:h("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class Pe extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){V.model.pushStackElement(),V.setCursorStates(ce.source,3,this._exec(V,V.getCursorStates())),V.revealAllCursors(ce.source,!0)}_exec(V,ce){let Ee=[];for(let ut=0,$t=ce.length;ut<$t;ut++){let Gn=ce[ut],To=Gn.modelState.position.lineNumber,Qe=V.model.getLineMaxColumn(To);Ee[ut]=ot.fromModelState(Gn.modelState.move(this._inSelectionMode,To,Qe,0))}return Ee}}xe.CursorLineEnd=et(new Pe({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:0,mac:{primary:291}}})),xe.CursorLineEndSelect=et(new Pe({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:0,mac:{primary:1315}}}));class bn extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){V.model.pushStackElement(),V.setCursorStates(ce.source,3,Hn.moveToBeginningOfBuffer(V,V.getCursorStates(),this._inSelectionMode)),V.revealAllCursors(ce.source,!0)}}xe.CursorTop=et(new bn({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:2062,mac:{primary:2064}}})),xe.CursorTopSelect=et(new bn({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:3086,mac:{primary:3088}}}));class ii extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){V.model.pushStackElement(),V.setCursorStates(ce.source,3,Hn.moveToEndOfBuffer(V,V.getCursorStates(),this._inSelectionMode)),V.revealAllCursors(ce.source,!0)}}xe.CursorBottom=et(new ii({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:2061,mac:{primary:2066}}})),xe.CursorBottomSelect=et(new ii({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:3085,mac:{primary:3090}}}));class yc extends Ci{constructor(){super({id:"editorScroll",precondition:void 0,metadata:Eo.metadata})}determineScrollMethod(V){let ce=[6],Ee=[1,2,3,4,5,6],ut=[4,2],$t=[1,3];return ce.includes(V.unit)&&ut.includes(V.direction)?this._runHorizontalEditorScroll.bind(this):Ee.includes(V.unit)&&$t.includes(V.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(V,ce){let Ee=Eo.parse(ce);if(!Ee)return;let ut=this.determineScrollMethod(Ee);ut&&ut(V,ce.source,Ee)}_runVerticalEditorScroll(V,ce,Ee){let ut=this._computeDesiredScrollTop(V,Ee);if(Ee.revealCursor){let $t=V.getCompletelyVisibleViewRangeAtScrollTop(ut);V.setCursorStates(ce,3,[Hn.findPositionInViewportIfOutside(V,V.getPrimaryCursorState(),$t,Ee.select)])}V.viewLayout.setScrollPosition({scrollTop:ut},0)}_computeDesiredScrollTop(V,ce){if(ce.unit===1){let $t=V.viewLayout.getFutureViewport(),Gn=V.getCompletelyVisibleViewRangeAtScrollTop($t.top),To=V.coordinatesConverter.convertViewRangeToModelRange(Gn),Qe;ce.direction===1?Qe=Math.max(1,To.startLineNumber-ce.value):Qe=Math.min(V.model.getLineCount(),To.startLineNumber+ce.value);let k=V.coordinatesConverter.convertModelPositionToViewPosition(new F(Qe,1));return V.viewLayout.getVerticalOffsetForLineNumber(k.lineNumber)}if(ce.unit===5){let $t=0;return ce.direction===3&&($t=V.model.getLineCount()-V.cursorConfig.pageSize),V.viewLayout.getVerticalOffsetForLineNumber($t)}let Ee;ce.unit===3?Ee=V.cursorConfig.pageSize*ce.value:ce.unit===4?Ee=Math.round(V.cursorConfig.pageSize/2)*ce.value:Ee=ce.value;let ut=(ce.direction===1?-1:1)*Ee;return V.viewLayout.getCurrentScrollTop()+ut*V.cursorConfig.lineHeight}_runHorizontalEditorScroll(V,ce,Ee){let ut=this._computeDesiredScrollLeft(V,Ee);V.viewLayout.setScrollPosition({scrollLeft:ut},0)}_computeDesiredScrollLeft(V,ce){let Ee=(ce.direction===4?-1:1)*ce.value;return V.viewLayout.getCurrentScrollLeft()+Ee*V.cursorConfig.typicalHalfwidthCharacterWidth}}xe.EditorScrollImpl=yc,xe.EditorScroll=et(new yc),xe.ScrollLineUp=et(new class extends Ci{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(be,V){xe.EditorScroll.runCoreEditorCommand(be,{to:Eo.RawDirection.Up,by:Eo.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:V.source})}}),xe.ScrollPageUp=et(new class extends Ci{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(be,V){xe.EditorScroll.runCoreEditorCommand(be,{to:Eo.RawDirection.Up,by:Eo.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:V.source})}}),xe.ScrollEditorTop=et(new class extends Ci{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus}})}runCoreEditorCommand(be,V){xe.EditorScroll.runCoreEditorCommand(be,{to:Eo.RawDirection.Up,by:Eo.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:V.source})}}),xe.ScrollLineDown=et(new class extends Ci{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(be,V){xe.EditorScroll.runCoreEditorCommand(be,{to:Eo.RawDirection.Down,by:Eo.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:V.source})}}),xe.ScrollPageDown=et(new class extends Ci{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(be,V){xe.EditorScroll.runCoreEditorCommand(be,{to:Eo.RawDirection.Down,by:Eo.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:V.source})}}),xe.ScrollEditorBottom=et(new class extends Ci{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus}})}runCoreEditorCommand(be,V){xe.EditorScroll.runCoreEditorCommand(be,{to:Eo.RawDirection.Down,by:Eo.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:V.source})}}),xe.ScrollLeft=et(new class extends Ci{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus}})}runCoreEditorCommand(be,V){xe.EditorScroll.runCoreEditorCommand(be,{to:Eo.RawDirection.Left,by:Eo.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:V.source})}}),xe.ScrollRight=et(new class extends Ci{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus}})}runCoreEditorCommand(be,V){xe.EditorScroll.runCoreEditorCommand(be,{to:Eo.RawDirection.Right,by:Eo.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:V.source})}});class Us extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){ce.position&&(V.model.pushStackElement(),V.setCursorStates(ce.source,3,[Hn.word(V,V.getPrimaryCursorState(),this._inSelectionMode,ce.position)]),ce.revealType!==2&&V.revealAllCursors(ce.source,!0,!0))}}xe.WordSelect=et(new Us({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),xe.WordSelectDrag=et(new Us({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),xe.LastCursorWordSelect=et(new class extends Ci{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(be,V){if(!V.position)return;let ce=be.getLastAddedCursorIndex(),Ee=be.getCursorStates(),ut=Ee.slice(0),$t=Ee[ce];ut[ce]=Hn.word(be,$t,$t.modelState.hasSelection(),V.position),be.model.pushStackElement(),be.setCursorStates(V.source,3,ut)}});class rl extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){ce.position&&(V.model.pushStackElement(),V.setCursorStates(ce.source,3,[Hn.line(V,V.getPrimaryCursorState(),this._inSelectionMode,ce.position,ce.viewPosition)]),ce.revealType!==2&&V.revealAllCursors(ce.source,!1,!0))}}xe.LineSelect=et(new rl({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),xe.LineSelectDrag=et(new rl({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class cs extends Ci{_inSelectionMode;constructor(V){super(V),this._inSelectionMode=V.inSelectionMode}runCoreEditorCommand(V,ce){if(!ce.position)return;let Ee=V.getLastAddedCursorIndex(),ut=V.getCursorStates(),$t=ut.slice(0);$t[Ee]=Hn.line(V,ut[Ee],this._inSelectionMode,ce.position,ce.viewPosition),V.model.pushStackElement(),V.setCursorStates(ce.source,3,$t)}}xe.LastCursorLineSelect=et(new cs({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),xe.LastCursorLineSelectDrag=et(new cs({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),xe.CancelSelection=et(new class extends Ci{constructor(){super({id:"cancelSelection",precondition:Se.hasNonEmptySelection,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(be,V){be.model.pushStackElement(),be.setCursorStates(V.source,3,[Hn.cancelSelection(be,be.getPrimaryCursorState())]),be.revealAllCursors(V.source,!0)}}),xe.RemoveSecondaryCursors=et(new class extends Ci{constructor(){super({id:"removeSecondaryCursors",precondition:Se.hasMultipleSelections,kbOpts:{weight:Et+1,kbExpr:Se.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(be,V){be.model.pushStackElement(),be.setCursorStates(V.source,3,[be.getPrimaryCursorState()]),be.revealAllCursors(V.source,!0),$v(h("removedCursor","Removed secondary cursors"))}}),xe.RevealLine=et(new class extends Ci{constructor(){super({id:"revealLine",precondition:void 0,metadata:eC.metadata})}runCoreEditorCommand(be,V){let ce=V,Ee=ce.lineNumber||0,ut=typeof Ee=="number"?Ee+1:parseInt(Ee)+1;ut<1&&(ut=1);let $t=be.model.getLineCount();ut>$t&&(ut=$t);let Gn=new O(ut,1,ut,be.model.getLineMaxColumn(ut)),To=0;if(ce.at)switch(ce.at){case eC.RawAtArgument.Top:To=3;break;case eC.RawAtArgument.Center:To=1;break;case eC.RawAtArgument.Bottom:To=4;break;default:break}let Qe=be.coordinatesConverter.convertModelRangeToViewRange(Gn);be.revealRange(V.source,!1,Qe,To,0)}}),xe.SelectAll=new class extends tC{constructor(){super(E9)}runDOMCommand(be){$i&&(be.focus(),be.select()),be.ownerDocument.execCommand("selectAll")}runEditorCommand(be,V,ce){let Ee=V._getViewModel();Ee&&this.runCoreEditorCommand(Ee,ce)}runCoreEditorCommand(be,V){be.model.pushStackElement(),be.setCursorStates("keyboard",3,[Hn.selectAll(be,be.getPrimaryCursorState())])}},xe.SetSelection=et(new class extends Ci{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(be,V){V.selection&&(be.model.pushStackElement(),be.setCursorStates(V.source,3,[ot.fromModelSelection(V.selection)]))}})})(xn||={});var JX=Ue.and(Se.textInputFocus,Se.columnSelection);function Hf(r,e){fn.registerKeybindingRule({id:r,primary:e,when:JX,weight:Et+1})}Hf(xn.CursorColumnSelectLeft.id,1039);Hf(xn.CursorColumnSelectRight.id,1041);Hf(xn.CursorColumnSelectUp.id,1040);Hf(xn.CursorColumnSelectPageUp.id,1035);Hf(xn.CursorColumnSelectDown.id,1042);Hf(xn.CursorColumnSelectPageDown.id,1036);function N9(r){return r.register(),r}var eQ;(l=>{class r extends VI{runEditorCommand(c,u,p){let m=u._getViewModel();m&&this.runCoreEditingCommand(u,m,p||{})}}l.CoreEditingCommand=r,l.LineBreakInsert=et(new class extends r{constructor(){super({id:"lineBreakInsert",precondition:Se.writable,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Ff.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection)))}}),l.Outdent=et(new class extends r{constructor(){super({id:"outdent",precondition:Se.writable,kbOpts:{weight:Et,kbExpr:Ue.and(Se.editorTextFocus,Se.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Ja.outdent(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.Tab=et(new class extends r{constructor(){super({id:"tab",precondition:Se.writable,kbOpts:{weight:Et,kbExpr:Ue.and(Se.editorTextFocus,Se.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Ja.tab(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=et(new class extends r{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,u){let[p,m]=cc.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection),c.getCursorAutoClosedCharacters());p&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(2)}}),l.DeleteRight=et(new class extends r{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:Et,kbExpr:Se.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,u){let[p,m]=cc.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection));p&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(3)}}),l.Undo=new class extends tC{constructor(){super(HN)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends tC{constructor(){super(UN)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})(eQ||={});var jD=class extends Th{_handlerId;constructor(e,t,i){super({id:e,precondition:void 0,metadata:i}),this._handlerId=t}runCommand(e,t){let i=e.get(sd).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}};function Fh(r,e){N9(new jD("default:"+r,r)),N9(new jD(r,r,e))}Fh("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Fh("replacePreviousChar");Fh("compositionType");Fh("compositionStart");Fh("compositionEnd");Fh("paste");Fh("cut");var Uf=class r{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(e){this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return r.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){let i={...e};return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new F(e.afterLineNumber,1)).lineNumber}}};var qD=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){xn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){let t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new F(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){let t=this.configuration.options,i=_t&&t.get(109),n=t.get(22);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){xn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){xn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),xn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),xn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){xn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){xn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){xn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){xn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){xn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){xn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){xn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){xn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){xn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}};var zf=class extends ra{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(e,t,i){super(),this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new Of(this._context,i),this._mouseDownOperation=this._register(new sF(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let n=new lD(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=B(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new aa(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let o=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{o=a})),this._register(B(this.viewHelper.viewDomNode,Q.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,o))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let e=Kv.INSTANCE,t=0,i=Dl.getZoomLevel(),n=!1,o=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Cs(l);if(e.acceptStandardWheelEvent(d),e.isPhysicalMouseWheel()){if(a(l)){let c=Dl.getZoomLevel(),u=d.deltaY>0?1:-1;Dl.setZoomLevel(c+u),d.preventDefault(),d.stopPropagation()}}else Date.now()-t>50&&(i=Dl.getZoomLevel(),n=a(l),o=0),t=Date.now(),o+=d.deltaY,n&&(Dl.setZoomLevel(i+o/5),d.preventDefault(),d.stopPropagation())};this._register(B(this.viewHelper.viewDomNode,Q.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return ke?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(147)){let t=this._context.configuration.options.get(147).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){let n=new HI(e,t).toPageCoordinates(pe(this.viewHelper.viewDomNode)),o=uD(this.viewHelper.viewDomNode);if(n.y<o.y||n.y>o.y+o.height||n.x<o.x||n.x>o.x+o.width)return null;let s=pD(this.viewHelper.viewDomNode,o,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),o,n,s,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){let n=Uc(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(e.posx,e.posy).find(o=>this.viewHelper.viewDomNode.contains(o)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){let i=this._createMouseTarget(e,!0),n=i.type===6||i.type===7,o=i.type===2||i.type===3||i.type===4,s=i.type===3,a=this._context.configuration.options.get(111),l=i.type===8||i.type===5,d=i.type===9,c=e.leftButton||e.middleButton;ke&&e.leftButton&&e.ctrlKey&&(c=!1);let u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(n||s&&a))u(),this._mouseDownOperation.start(i.type,e,t);else if(o)e.preventDefault();else if(l){let p=i.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(p.viewZoneId)&&(u(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}_onMouseWheel(e){this.viewController.emitMouseWheel(e)}},sF=class extends P{constructor(t,i,n,o,s,a){super();this._context=t;this._viewController=i;this._viewHelper=n;this._mouseTargetFactory=o;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new cD(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new aF(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new dF,this._currentSelection=new tt(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);let i=this._findMousePosition(t,!1);i&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:i}):i.type===13&&(i.outsidePosition==="above"||i.outsidePosition==="below")?this._topBottomDragScrolling.start(i,t):(this._topBottomDragScrolling.stop(),this._dispatchMouse(i,!0,1)))}start(t,i,n){this._lastMouseEvent=i,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(i),this._mouseState.setModifiers(i);let o=this._findMousePosition(i,!0);if(!o||!o.position)return;this._mouseState.trySetCount(i.detail,o.position),i.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&i.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&o.type===6&&o.position&&this._currentSelection.containsPosition(o.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,n,i.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);$s(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(o,i.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,n,i.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){let i=t.editorPos,n=this._context.viewModel,o=this._context.viewLayout,s=this._getMouseColumn(t);if(t.posy<i.y){let l=i.y-t.posy,d=Math.max(o.getCurrentScrollTop()-l,0),c=Mf.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return Wn.createOutsideEditor(s,p,"above",l)}let u=o.getLineNumberAtVerticalOffset(d);return Wn.createOutsideEditor(s,new F(u,1),"above",l)}if(t.posy>i.y+i.height){let l=t.posy-i.y-i.height,d=o.getCurrentScrollTop()+t.relativePos.y,c=Mf.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return Wn.createOutsideEditor(s,p,"below",l)}let u=o.getLineNumberAtVerticalOffset(d);return Wn.createOutsideEditor(s,new F(u,n.getLineMaxColumn(u)),"below",l)}let a=o.getLineNumberAtVerticalOffset(o.getCurrentScrollTop()+t.relativePos.y);if(t.posx<i.x){let l=i.x-t.posx;return Wn.createOutsideEditor(s,new F(a,1),"left",l)}if(t.posx>i.x+i.width){let l=t.posx-i.x-i.width;return Wn.createOutsideEditor(s,new F(a,n.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(t,i){let n=this._getPositionOutsideEditor(t);if(n)return n;let o=this._createMouseTarget(t,i);if(!o.position)return null;if(o.type===8||o.type===5){let a=this._helpPositionJumpOverViewZone(o.detail);if(a)return Wn.createViewZone(o.type,o.element,o.mouseColumn,a,o.detail)}return o}_helpPositionJumpOverViewZone(t){let i=new F(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),n=t.positionBefore,o=t.positionAfter;return n&&o?n.isBefore(i)?n:o:null}_dispatchMouse(t,i,n){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:n,inSelectionMode:i,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}},aF=class extends P{constructor(t,i,n,o){super();this._context=t;this._viewHelper=i;this._mouseTargetFactory=n;this._dispatchMouse=o;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(t,i){this._operation?this._operation.setPosition(t,i):this._operation=new lF(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,i)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},lF=class extends P{constructor(t,i,n,o,s,a){super();this._context=t;this._viewHelper=i;this._mouseTargetFactory=n;this._dispatchMouse=o;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=Yi(pe(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,i){this._position=t,this._mouseEvent=i}_tick(){let t=Date.now(),i=t-this._lastTime;return this._lastTime=t,i}_getScrollSpeed(){let t=this._context.configuration.options.get(68),i=this._context.configuration.options.get(147).height/t,n=this._position.outsideDistance/t;return n<=1.5?Math.max(30,i*(1+n)):n<=3?Math.max(60,i*(2+n)):Math.max(200,i*(7+n))}_execute(){let t=this._context.configuration.options.get(68),i=this._getScrollSpeed(),n=this._tick(),o=i*(n/1e3)*t,s=this._position.outsidePosition==="above"?-o:o;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=uD(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(147).horizontalScrollbarHeight,p=new Ou(this._mouseEvent.pos.x,c.y+c.height-u-.1),m=pD(this._viewHelper.viewDomNode,c,p);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,p,m,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=Wn.createOutsideEditor(this._position.mouseColumn,new F(l,1),"above",this._position.outsideDistance):d=Wn.createOutsideEditor(this._position.mouseColumn,new F(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=Yi(pe(d.element),()=>this._execute())}},dF=class r{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let i=new Date().getTime();i-this._lastSetMouseDownCountTime>r.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};function $D(r,e,t,i){let n=r.getPlainTextToCopy(e,t,dt),o=r.model.getEOL(),s=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(n)?n:null,l=Array.isArray(n)?n.join(o):n,d,c=null;if(iQ.forceCopyWithSyntaxHighlighting||i&&l.length<65536){let p=r.getRichTextToCopy(e,t);p&&(d=p.html,c=p.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var Bh=class r{static INSTANCE=new r;_lastState;constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}},iQ={forceCopyWithSyntaxHighlighting:!1};var Kf=class r{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){let i=e*t,n=i+1,o=i+t;return new O(n,1,o+1,1)}static fromEditorSelection(e,t,i,n){let s=r._getPageOfLine(t.startLineNumber,i),a=r._getRangeForPage(s,i),l=r._getPageOfLine(t.endLineNumber,i),d=r._getRangeForPage(l,i),c=a.intersectRanges(new O(1,1,t.startLineNumber,t.startColumn));if(n&&e.getValueLengthInRange(c,1)>500){let v=e.modifyPosition(c.getEndPosition(),-500);c=O.fromPositions(v,c.getEndPosition())}let u=e.getValueInRange(c,1),p=e.getLineCount(),m=e.getLineMaxColumn(p),f=d.intersectRanges(new O(t.endLineNumber,t.endColumn,p,m));if(n&&e.getValueLengthInRange(f,1)>500){let v=e.modifyPosition(f.getStartPosition(),500);f=O.fromPositions(f.getStartPosition(),v)}let g=e.getValueInRange(f,1),b;if(s===l||s+1===l)b=e.getValueInRange(t,1);else{let v=a.intersectRanges(t),I=d.intersectRanges(t);b=e.getValueInRange(v,1)+"\u2026"+e.getValueInRange(I,1)}return n&&b.length>2*500&&(b=b.substring(0,500)+"\u2026"+b.substring(b.length-500,b.length)),{value:u+b+g,selection:t,selectionStart:u.length,selectionEnd:u.length+b.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function iC(r,e){if(r.get(2)===1){let i=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),n=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),o=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=h("accessibilityModeOff","The editor is not accessible at this time.");return i?h("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,i):n?h("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,n):o?h("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,o):s}return r.get(4)}function nC(r){let e=0,t=-1;do{if(t=r.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var Mr=!1,Un=class r{constructor(e,t,i,n,o){this.value=e;this.selectionStart=t;this.selectionEnd=i;this.selection=n;this.newlineCountBeforeSelection=o}static EMPTY=new r("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){let i=e.getValue(),n=e.getSelectionStart(),o=e.getSelectionEnd(),s;if(t){let a=i.substring(0,n),l=t.value.substring(0,t.selectionStart);a===l&&(s=t.newlineCountBeforeSelection)}return new r(i,n,o,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new r(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,i){Mr&&console.log(`writeToTextArea ${e}: ${this.toString()}`),t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){let n=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,n,-1)}if(e>=this.selectionEnd){let n=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,1)}let t=this.value.substring(this.selectionStart,e);if(t.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);let i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,o=-1;for(;(o=t.indexOf(`
`,o+1))!==-1;)n++;return[e,i*t.length,n]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};Mr&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`));let n=Math.min(Iv(e.value,t.value),e.selectionStart,t.selectionStart),o=Math.min(Cv(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd),s=e.value.substring(n,e.value.length-o),a=t.value.substring(n,t.value.length-o),l=e.selectionStart-n,d=e.selectionEnd-n,c=t.selectionStart-n,u=t.selectionEnd-n;if(Mr&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${u}`)),c===u){let m=e.selectionStart-n;return Mr&&console.log(`REMOVE PREVIOUS: ${m} chars`),{text:a,replacePrevCharCnt:m,replaceNextCharCnt:0,positionDelta:0}}let p=d-l;return{text:a,replacePrevCharCnt:p,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(Mr&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`)),e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};let i=Math.min(Iv(e.value,t.value),e.selectionEnd),n=Math.min(Cv(e.value,t.value),e.value.length-e.selectionEnd),o=e.value.substring(i,e.value.length-n),s=t.value.substring(i,t.value.length-n),a=e.selectionStart-i,l=e.selectionEnd-i,d=t.selectionStart-i,c=t.selectionEnd-i;return Mr&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${o}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:o.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(e){return new r(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};var ZD;(e=>e.Tap="-monaco-textarea-synthetic-tap")(ZD||={});var cF=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";let t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}},Gf=class extends P{constructor(t,i,n,o,s,a){super();this._host=t;this._textArea=i;this._OS=n;this._browser=o;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new Kt(()=>this._onCut.fire(),0)),this._textAreaState=Un.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(z.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new Kt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new bt(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new bt(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{Mr&&console.log("[compositionstart]",d);let c=new cF;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){Mr&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{Mr&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let p=Un.readFromTextArea(this._textArea,this._textAreaState),m=Un.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(m),this._onCompositionUpdate.fire(d);return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=Un.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{Mr&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let p=Un.readFromTextArea(this._textArea,this._textAreaState),m=Un.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(m),this._onCompositionEnd.fire();return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=Un.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(Mr&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=Un.readFromTextArea(this._textArea,this._textAreaState),u=Un.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(Di(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&this._onType.fire(u))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,u]=F9.getTextData(d.clipboardData);c&&(u=u||Bh.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new Kt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new _);onFocus=this._onFocus.event;_onBlur=this._register(new _);onBlur=this._onBlur.event;_onKeyDown=this._register(new _);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new _);onKeyUp=this._onKeyUp.event;_onCut=this._register(new _);onCut=this._onCut.event;_onPaste=this._register(new _);onPaste=this._onPaste.event;_onType=this._register(new _);onType=this._onType.event;_onCompositionStart=this._register(new _);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new _);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new _);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new _);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new xt);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=Un.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let t=0;return B(this._textArea.ownerDocument,"selectionchange",i=>{if(lc.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let n=Date.now(),o=n-t;if(t=n,o<5)return;let s=n-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(c[0],c[1],c[2]),p=this._textAreaState.deduceEditorPosition(d),m=this._host.deduceModelPosition(p[0],p[1],p[2]),f=new tt(u.lineNumber,u.column,m.lineNumber,m.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,i){this._hasFocus||(i=i.collapseSelection()),i.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=i}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){let i=this._host.getDataToCopy(),n={version:1,isFromEmptySelection:i.isFromEmptySelection,multicursorText:i.multicursorText,mode:i.mode};Bh.INSTANCE.set(this._browser.isFirefox?i.text.replace(/\r\n/g,`
`):i.text,n),t.preventDefault(),t.clipboardData&&F9.setTextData(t.clipboardData,i.text,i.html,n)}};Gf=R([y(4,dr),y(5,Oi)],Gf);var F9={getTextData(r){let e=r.getData(zo.text),t=null,i=r.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&r.files.length>0?[Array.prototype.slice.call(r.files,0).map(o=>o.name).join(`
`),null]:[e,t]},setTextData(r,e,t,i){r.setData(zo.text,e),typeof t=="string"&&r.setData("text/html",t),r.setData("vscode-editor-data",JSON.stringify(i))}},YD=class extends P{constructor(t){super();this._actual=t;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>lc.onKeyDown())),this._register(this.onBeforeInput(()=>lc.onBeforeInput())),this._register(this.onInput(()=>lc.onInput())),this._register(this.onKeyUp(()=>lc.onKeyUp())),this._register(B(this._actual,ZD.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new Me(this._actual,"keydown")).event;onKeyPress=this._register(new Me(this._actual,"keypress")).event;onKeyUp=this._register(new Me(this._actual,"keyup")).event;onCompositionStart=this._register(new Me(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new Me(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new Me(this._actual,"compositionend")).event;onBeforeInput=this._register(new Me(this._actual,"beforeinput")).event;onInput=this._register(new Me(this._actual,"input")).event;onCut=this._register(new Me(this._actual,"cut")).event;onCopy=this._register(new Me(this._actual,"copy")).event;onPaste=this._register(new Me(this._actual,"paste")).event;onFocus=this._register(new Me(this._actual,"focus")).event;onBlur=this._register(new Me(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new _);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let t=Uc(this._actual);return t?t.activeElement===this._actual:this._actual.isConnected?mn()===this._actual:!1}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,i){let n=this._actual;n.value!==i&&(this.setIgnoreSelectionChangeTime("setValue"),n.value=i)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,i,n){let o=this._actual,s=null,a=Uc(o);a?s=a.activeElement:s=mn();let l=pe(s),d=s===o,c=o.selectionStart,u=o.selectionEnd;if(d&&c===i&&u===n){$i&&l.parent!==l&&o.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),o.setSelectionRange(i,n),$i&&l.parent!==l&&o.focus();return}try{let p=X2(o);this.setIgnoreSelectionChangeTime("setSelectionRange"),o.focus(),o.setSelectionRange(i,n),Q2(o,p)}catch{}}};var uF=class extends zf{_lastPointerType;constructor(e,t,i){super(e,t,i),this._register(ei.addTarget(this.viewHelper.linesContentDomNode)),this._register(B(this.viewHelper.linesContentDomNode,it.Tap,o=>this.onTap(o))),this._register(B(this.viewHelper.linesContentDomNode,it.Change,o=>this.onChange(o))),this._register(B(this.viewHelper.linesContentDomNode,it.Contextmenu,o=>this._onContextMenu(new aa(o,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(B(this.viewHelper.linesContentDomNode,"pointerdown",o=>{let s=o.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let n=new dD(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,o=>this._onMouseMove(o))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(o,s)=>this._onMouseDown(o,s)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){let i=this._createMouseTarget(new aa(e,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}},pF=class extends zf{constructor(e,t,i){super(e,t,i),this._register(ei.addTarget(this.viewHelper.linesContentDomNode)),this._register(B(this.viewHelper.linesContentDomNode,it.Tap,n=>this.onTap(n))),this._register(B(this.viewHelper.linesContentDomNode,it.Change,n=>this.onChange(n))),this._register(B(this.viewHelper.linesContentDomNode,it.Contextmenu,n=>this._onContextMenu(new aa(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();let t=this._createMouseTarget(new aa(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){let i=document.createEvent("CustomEvent");i.initEvent(ZD.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}},XD=class extends P{handler;constructor(e,t,i){super(),(zs||pW&&hS)&&JS.pointerEvents?this.handler=this._register(new uF(e,t,i)):Re.TouchEvent?this.handler=this._register(new pF(e,t,i)):this.handler=this._register(new zf(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}};var gr=class extends ra{};var QD=class extends pi{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(e){super(e),this._visibleLines=new _f({createLine:()=>new hF(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let i=this._context.configuration.options.get(51);Ti(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);let i=this._context.configuration.options.get(51);return Ti(this.domNode,i),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=t.length;i<n;i++){let o=t[i];o.prepareRender(e),o.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}},hF=class{_dynamicOverlays;_domNode;_renderedContent;constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=$e(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,i,n,o){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(n.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,o.appendString('<div style="top:'),o.appendString(String(t)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString('px;">'),o.appendString(s),o.appendString("</div>"),!0)}layoutLine(e,t,i){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(i))}},JD=class extends QD{_contentWidth;constructor(e){super(e);let i=this._context.configuration.options.get(147);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){let i=this._context.configuration.options.get(147);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}},eL=class extends QD{_contentLeft;constructor(e){super(e);let t=this._context.configuration.options,i=t.get(147);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),Ti(this.domNode,t.get(51))}onConfigurationChanged(e){let t=this._context.configuration.options;Ti(this.domNode,t.get(51));let i=t.get(147);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);let t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}};var tL=class extends pi{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(e){super(e),this.domNode=$e(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1,i=this._context.configuration.options.get(147),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,e=!0);let o=i.contentLeft;return this.contentLeft!==o&&(this.contentLeft=o,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0,i=e.getDecorationsInViewport();for(let n of i){if(!n.options.blockClassName)continue;let o=this.blocks[t];o||(o=this.blocks[t]=$e(document.createElement("div")),this.domNode.appendChild(o));let s,a;n.options.blockIsAfterEnd?(s=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(s=e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));let[l,d,c,u]=n.options.blockPadding??[0,0,0,0];o.setClassName("blockDecorations-block "+n.options.blockClassName),o.setLeft(this.contentLeft-u),o.setWidth(this.contentWidth+u+d),o.setTop(s-e.scrollTop-l),o.setHeight(a-s+l+c),t++}for(let n=t;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=t}};var iL=class extends pi{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=$e(document.createElement("div")),Vn.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=$e(document.createElement("div")),Vn.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){let t=Object.keys(this._widgets);for(let i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){let e=Object.keys(this._widgets);for(let t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){let t=new gF(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,n,o){this._widgets[e.getId()].setPosition(t,i,n,o),this.setShouldRender()}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let i=this._widgets[t];delete this._widgets[t];let n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){let t=Object.keys(this._widgets);for(let i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){let t=Object.keys(this._widgets);for(let i of t)this._widgets[i].prepareRender(e)}render(e){let t=Object.keys(this._widgets);for(let i of t)this._widgets[i].render(e)}},gF=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new Vh(null,null);_secondaryAnchor=new Vh(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(e,t,i){this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=$e(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let n=this._context.configuration.options,o=n.get(147);this._fixedOverflowWidgets=n.get(43),this._contentWidth=o.contentWidth,this._contentLeft=o.contentLeft,this._lineHeight=n.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){let t=this._context.configuration.options;if(this._lineHeight=t.get(68),e.hasChanged(147)){let i=t.get(147);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=n(t,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(o,s,a){if(!o)return new Vh(null,null);let l=s.model.validatePosition(o);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new Vh(o,d)}return new Vh(o,null)}}_getMaxWidth(){let e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,n){this._setPosition(n,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,n){let o=e.top,s=o,a=e.top+e.height,l=n.viewportHeight-a,d=o-i,c=s>=i,u=a,p=l>=i,m=e.left;return m+t>n.scrollLeft+n.viewportWidth&&(m=n.scrollLeft+n.viewportWidth-t),m<n.scrollLeft&&(m=n.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:p,belowTop:u,left:m}}_layoutHorizontalSegmentInPage(e,t,i,n){let a=Math.max(15,t.left-n),l=Math.min(t.left+t.width+n,e.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,u=t.left+i-(c?.scrollX??0);if(u+n>l){let p=u-(l-n);u-=p,i-=p}if(u<a){let p=u-a;u-=p,i-=p}return[i,u]}_layoutBoxInPage(e,t,i,n){let o=e.top-i,s=e.top+e.height,a=po(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+o-(d?.scrollY??0),u=a.top+s-(d?.scrollY??0),p=Dp(l.body),[m,f]=this._layoutHorizontalSegmentInPage(p,a,e.left-n.scrollLeft+this._contentLeft,t),g=22,b=22,v=c>=g,I=u+i<=p.height-b;return this._fixedOverflowWidgets?{fitsAbove:v,aboveTop:Math.max(c,g),fitsBelow:I,belowTop:u,left:f}:{fitsAbove:v,aboveTop:o,fitsBelow:I,belowTop:s,left:m}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new Wh(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){let t=o(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),i=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,n=o(i,this._affinity,this._lineHeight);return{primary:t,secondary:n};function o(s,a,l){if(!s)return null;let d=e.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,u=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.scrollTop;return new nL(u,c,l)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;let n=this._context.configuration.options.get(51),o=t.left;return o<e.left?o=Math.max(o,e.left-i+n.typicalFullwidthCharacterWidth):o=Math.min(o,e.left+i-n.typicalFullwidthCharacterWidth),new nL(e.top,o,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;let{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=mF(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let n=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth),o;this.allowEditorOverflow?o=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):o=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!o)return null;if(s===2||o.fitsAbove)return{kind:"inViewport",coordinate:new Wh(o.aboveTop,o.left),position:1}}else if(a===2){if(!o)return null;if(s===2||o.fitsBelow)return{kind:"inViewport",coordinate:new Wh(o.belowTop,o.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new Wh(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new Wh(n.top,n.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&mF(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&mF(this._actual.afterRender,this._actual,this._renderData.position)}},Vh=class{constructor(e,t){this.modelPosition=e;this.viewPosition=t}},Wh=class{constructor(e,t){this.top=e;this.left=t}_coordinateBrand=void 0},nL=class{constructor(e,t,i){this.top=e;this.left=t;this.height=i}_anchorCoordinateBrand=void 0};function mF(r,e,...t){try{return r.call(e,...t)}catch{return null}}var oL=class extends gr{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(e){super(),this._context=e;let t=this._context.configuration.options,i=t.get(147);this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new tt(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1,t=new Set;for(let o of this._selections)t.add(o.positionLineNumber);let i=Array.from(t);i.sort((o,s)=>o-s),li(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,e=!0);let n=this._selections.every(o=>o.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){let t=this._context.configuration.options,i=t.get(147);return this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=[];for(let s=t;s<=i;s++){let a=s-t;n[a]=""}if(this._wordWrap){let s=this._renderOne(e,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new F(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new F(d,1)).lineNumber,u=l.convertModelPositionToViewPosition(new F(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,p=Math.max(c,t),m=Math.min(u,i);for(let f=p;f<=m;f++){let g=f-t;n[g]=s}}}let o=this._renderOne(e,!0);for(let s of this._cursorLineNumbers){if(s<t||s>i)continue;let a=s-t;n[a]=o}this._renderData=n}render(e,t){if(!this._renderData)return"";let i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},rL=class extends oL{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},sL=class extends oL{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};Fo((r,e)=>{let t=r.getColor(dO);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||r.defines(cO)){let i=r.getColor(cO);i&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),Ba(r.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var aL=class extends gr{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let t=e.getDecorationsInViewport(),i=[],n=0;for(let l=0,d=t.length;l<d;l++){let c=t[l];c.options.className&&(i[n++]=c)}i=i.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,u=d.options.className;return c<u?-1:c>u?1:O.compareRangesUsingStarts(l.range,d.range)});let o=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=[];for(let l=o;l<=s;l++){let d=l-o;a[d]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){let n=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){let l=t[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,n),u=Math.min(l.range.endLineNumber,o);for(let p=c;p<=u;p++){let m=p-n;i[m]+=d}}}_renderNormalDecorations(e,t,i){let n=e.visibleRange.startLineNumber,o=null,s=!1,a=null,l=!1;for(let d=0,c=t.length;d<c;d++){let u=t[d];if(u.options.isWholeLine)continue;let p=u.options.className,m=!!u.options.showIfCollapsed,f=u.range;if(m&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new O(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),o===p&&s===m&&O.areIntersectingOrTouching(a,f)){a=O.plusRange(a,f);continue}o!==null&&this._renderNormalDecoration(e,a,o,l,s,n,i),o=p,s=m,a=f,l=u.options.shouldFillLineOnLineBreak??!1}o!==null&&this._renderNormalDecoration(e,a,o,l,s,n,i)}_renderNormalDecoration(e,t,i,n,o,s,a){let l=e.linesVisibleRangesForRange(t,i==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let u=l[d];if(u.outsideRenderedLine)continue;let p=u.lineNumber-s;if(o&&u.ranges.length===1){let m=u.ranges[0];if(m.width<this._typicalHalfwidthCharacterWidth){let f=Math.round(m.left+m.width/2),g=Math.max(0,Math.round(f-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new Tf(g,this._typicalHalfwidthCharacterWidth)}}for(let m=0,f=u.ranges.length;m<f;m++){let g=n&&u.continuesOnNextLine&&f===1,b=u.ranges[m],v='<div class="cdr '+i+'" style="left:'+String(b.left)+"px;width:"+(g?"100%;":String(b.width)+"px;")+'"></div>';a[p]+=v}}}render(e,t){if(!this._renderResult)return"";let i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};var lL=class extends pi{scrollbar;scrollbarDomNode;constructor(e,t,i,n){super(e);let o=this._context.configuration.options,s=o.get(105),a=o.get(76),l=o.get(41),d=o.get(108),c={listenOnDomNode:i.domNode,className:"editor-scrollable "+Vy(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new Gc(t.domNode,c,this._context.viewLayout.getScrollable())),Vn.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=$e(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let u=(p,m,f)=>{let g={};if(m){let b=p.scrollTop;b&&(g.scrollTop=this._context.viewLayout.getCurrentScrollTop()+b,p.scrollTop=0)}if(f){let b=p.scrollLeft;b&&(g.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+b,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(g,1)};this._register(B(i.domNode,"scroll",p=>u(i.domNode,!0,!0))),this._register(B(t.domNode,"scroll",p=>u(t.domNode,!0,!1))),this._register(B(n.domNode,"scroll",p=>u(n.domNode,!0,!1))),this._register(B(this.scrollbarDomNode.domNode,"scroll",p=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let e=this._context.configuration.options,t=e.get(147);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(74).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(105)||e.hasChanged(76)||e.hasChanged(41)){let t=this._context.configuration.options,i=t.get(105),n=t.get(76),o=t.get(41),s=t.get(108),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:o,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return e.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+Vy(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}};var Hh=class{constructor(e,t,i,n,o){this.startLineNumber=e;this.endLineNumber=t;this.className=i;this.tooltip=n;this.zIndex=o??0}_decorationToRenderBrand=void 0;zIndex},fF=class{constructor(e,t,i){this.className=e;this.zIndex=t;this.tooltip=i}},bF=class{decorations=[];add(e){this.decorations.push(e)}getDecorations(){return this.decorations}},jf=class extends gr{_render(e,t,i){let n=[];for(let a=e;a<=t;a++){let l=a-e;n[l]=new bF}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let o=null,s=0;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d.className,u=d.zIndex,p=Math.max(d.startLineNumber,e)-e,m=Math.min(d.endLineNumber,t)-e;o===c?(p=Math.max(s+1,p),s=Math.max(s,m)):(o=c,s=m);for(let f=p;f<=s;f++)n[f].add(new fF(c,u,d.tooltip))}return n}},dL=class extends pi{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(e){super(e),this._context=e;let t=this._context.configuration.options,i=t.get(147);this.domNode=$e(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){let t=this._context.configuration.options,i=t.get(147);return this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){let t=$e(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&O.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId();if(this._widgets[t]){let n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){let i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,o=e.getDecorationsInViewport();for(let s of o){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,i),d=Math.min(s.range.endLineNumber,n),c=s.options.glyphMargin?.position??2,u=s.options.zIndex??0;for(let p=l;p<=d;p++){let m=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new F(p,0)),f=this._context.viewModel.glyphLanes.getLanesAtLine(m.lineNumber).indexOf(c);t.push(new vF(p,f,u,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){let i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let o of Object.values(this._widgets)){let s=o.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(O.lift(s));if(!a||!l||l<i||a>n)continue;let d=Math.max(a,i),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new F(d,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(o.preference.lane);t.push(new yF(d,u,o.preference.zIndex,o))}}_collectSortedGlyphRenderRequests(e){let t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let n of Object.values(this._widgets))n.renderInfo=null;let t=new Do(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){let n=t.peek();if(!n)break;let o=t.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!o||o.length===0)break;let s=o[0];if(s.type===0){let a=[];for(let l of o){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(let i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{let n=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],o=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(o),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){let n=this._decorationGlyphsToRender[i],o=e.viewportData.relativeVerticalOffset[n.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+n.laneIndex*this._lineHeight,a;i<this._managedDomNodes.length?a=this._managedDomNodes[i]:(a=$e(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+n.combinedClassName),a.setPosition("absolute"),a.setTop(o),a.setLeft(s),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var vF=class{constructor(e,t,i,n){this.lineNumber=e;this.laneIndex=t;this.zIndex=i;this.className=n}type=0;accept(e){return new IF(this.lineNumber,this.laneIndex,e)}},yF=class{constructor(e,t,i,n){this.lineNumber=e;this.laneIndex=t;this.zIndex=i;this.widget=n}type=1},IF=class{constructor(e,t,i){this.lineNumber=e;this.laneIndex=t;this.combinedClassName=i}};var cL=class extends gr{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(e){super(),this._context=e,this._primaryPosition=null;let t=this._context.configuration.options,i=t.get(148),n=t.get(51);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options,i=t.get(148),n=t.get(51);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){let i=e.selections[0].getPosition();return this._primaryPosition?.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.scrollWidth,o=this._primaryPosition,s=this.getGuidesByLine(t,Math.min(i+1,this._context.viewModel.getLineCount()),o),a=[];for(let l=t;l<=i;l++){let d=l-t,c=s[d],u="",p=e.visibleRangeForPosition(new F(l,1))?.left??0;for(let m of c){let f=m.column===-1?p+(m.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new F(l,m.column)).left;if(f>n||this._maxIndentLeft>0&&f>this._maxIndentLeft)break;let g=m.horizontalLine?m.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=m.horizontalLine?(e.visibleRangeForPosition(new F(l,m.horizontalLine.endColumn))?.left??f+this._spaceWidth)-f:this._spaceWidth;u+=`<div class="core-guide ${m.className} ${g}" style="left:${f}px;width:${b}px"></div>`}a[d]=u}this._renderResult=a}getGuidesByLine(e,t,i){let n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,o=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){let u=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);s=u.startLineNumber,a=u.endLineNumber,l=u.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let u=e;u<=t;u++){let p=new Array;c.push(p);let m=n?n[u-e]:[],f=new Do(m),g=o?o[u-e]:0;for(let b=1;b<=g;b++){let v=(b-1)*d+1,I=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||m.length===0)&&s<=u&&u<=a&&b===l;p.push(...f.takeWhile(E=>E.visibleColumn<v)||[]);let w=f.peek();(!w||w.visibleColumn!==v||w.horizontalLine)&&p.push(new Js(v,-1,`core-guide-indent lvl-${(b-1)%30}`+(I?" indent-active":""),null,-1,-1))}p.push(...f.takeWhile(b=>!0)||[])}return c}render(e,t){if(!this._renderResult)return"";let i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};function qf(r){if(!(r&&r.isTransparent()))return r}Fo((r,e)=>{let t=[{bracketColor:wx,guideColor:v4,guideColorActive:w4},{bracketColor:xx,guideColor:y4,guideColorActive:x4},{bracketColor:Tx,guideColor:I4,guideColorActive:T4},{bracketColor:_x,guideColor:C4,guideColorActive:_4},{bracketColor:Dx,guideColor:S4,guideColorActive:D4},{bracketColor:Lx,guideColor:E4,guideColorActive:L4}],i=new Ky,n=[{indentColor:t4,indentColorActive:a4},{indentColor:i4,indentColorActive:l4},{indentColor:n4,indentColorActive:d4},{indentColor:o4,indentColorActive:c4},{indentColor:r4,indentColorActive:u4},{indentColor:s4,indentColorActive:p4}],o=t.map(a=>{let l=r.getColor(a.bracketColor),d=r.getColor(a.guideColor),c=r.getColor(a.guideColorActive),u=qf(qf(d)??l?.transparent(.3)),p=qf(qf(c)??l);if(!(!u||!p))return{guideColor:u,guideColorActive:p}}).filter(Ad),s=n.map(a=>{let l=r.getColor(a.indentColor),d=r.getColor(a.indentColorActive),c=qf(l),u=qf(d);if(!(!c||!u))return{indentColor:c,indentColorActive:u}}).filter(Ad);if(o.length>0){for(let a=0;a<30;a++){let l=o[a%o.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var $f=class r extends gr{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new F(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let e=this._context.configuration.options;this._lineHeight=e.get(68);let t=e.get(69);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(97);let i=e.get(147);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){let t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){let t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new F(e,1));if(t.column!==1)return"";let i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){let n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);let n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}let t=_t?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,o=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(d=>!!d.options.lineNumberClassName);o.sort((d,c)=>O.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=i;d<=n;d++){let c=d-i,u=this._getLineRenderLineNumber(d),p="";for(;s<o.length&&o[s].range.endLineNumber<d;)s++;for(let m=s;m<o.length;m++){let{range:f,options:g}=o[m];f.startLineNumber<=d&&(p+=" "+g.lineNumberClassName)}if(!u&&!p){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeLineNumber&&(p+=" active-line-number"),l[c]=`<div class="${r.CLASS_NAME}${t}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";let i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Fo((r,e)=>{let t=r.getColor(e4),i=r.getColor(h4);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});var CF=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new O(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}},SF=class{constructor(e,t,i,n,o,s,a){this.minimalReveal=e;this.lineNumber=t;this.startColumn=i;this.endColumn=n;this.startScrollTop=o;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=t,this.maxLineNumber=t}type="range";minLineNumber;maxLineNumber},EF=class{constructor(e,t,i,n,o){this.minimalReveal=e;this.selections=t;this.startScrollTop=i;this.stopScrollTop=n;this.scrollType=o;let s=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,d=t.length;l<d;l++){let c=t[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},uL=class r extends pi{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(e,t){super(e);let i=this._context.configuration,n=this._context.configuration.options,o=n.get(51),s=n.get(148);this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=n.get(102),this._cursorSurroundingLines=n.get(29),this._cursorSurroundingLinesStyle=n.get(30),this._canUseLayerHinting=!n.get(32),this._viewLineOptions=new $I(i,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new _f({createLine:()=>new Qa(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Vn.write(this.domNode,8),this.domNode.setClassName(`view-lines ${dc}`),Ti(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Kt(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Kt(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new CF,this._horizontalRevealRequest=null,this._stickyScrollEnabled=n.get(117).enabled,this._maxNumberStickyLines=n.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(148)&&(this._maxLineWidth=0);let t=this._context.configuration.options,i=t.get(51),n=t.get(148);return this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=t.get(102),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(117).enabled,this._maxNumberStickyLines=t.get(117).maxLineCount,Ti(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let e=this._context.configuration,t=new $I(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;let i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber(),n=!1;for(let o=t;o<=i;o++)n=this._visibleLines.getVisibleLine(o).onSelectionChanged()||n;return n}onDecorationsChanged(e){{let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){let t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new SF(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new EF(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;let o=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,o),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){let t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){let i=this._getViewLineDomNode(e);if(i===null)return null;let n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new F(n,1);let o=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(n<o||n>s)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(e,t),l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new F(n,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Qa.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){let o=this._visibleLines.getVisibleLine(n);if(e===o.getDomNode())return n}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;let n=new Df(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;let i=e.endLineNumber,n=O.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;let o=[],s=0,a=new Df(this.domNode.domNode,this._textRangeRestingSpot),l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new F(n.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=n.startLineNumber;u<=n.endLineNumber;u++){if(u<d||u>c)continue;let p=u===n.startLineNumber?n.startColumn:1,m=u!==n.endLineNumber,f=m?this._context.viewModel.getLineMaxColumn(u):n.endColumn,g=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,p,f,a);if(g){if(t&&u<i){let b=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new F(u+1,1)).lineNumber,b!==l&&(g.ranges[g.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}o[s++]=new gD(g.outsideRenderedLine,u,Tf.from(g.ranges),m)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:o}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;let n=new Df(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}visibleRangeForPosition(e){let t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new fD(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber(),n=1,o=!0;for(let s=t;s<=i;s++){let a=this._visibleLines.getVisibleLine(s);if(e&&!a.getWidthIsFast()){o=!1;continue}n=Math.max(n,a.getWidth(null))}return o&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),o}_checkMonospaceFontAssumptions(){let e=-1,t=-1,i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++){let s=this._visibleLines.getVisibleLine(o);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>t&&(t=a,e=o)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let n=this._computeScrollLeftToReveal(i);n&&(this._isViewportWrapping||this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),_t&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)if(this._visibleLines.getVisibleLine(o).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,n,o,s){let a=e.top,l=e.height,d=a+l,c,u,p;if(o&&o.length>0){let v=o[0].startLineNumber,I=o[0].endLineNumber;for(let w=1,E=o.length;w<E;w++){let S=o[w];v=Math.min(v,S.startLineNumber),I=Math.max(I,S.endLineNumber)}c=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(v),p=this._context.viewLayout.getVerticalOffsetForLineNumber(I)+this._lineHeight}else if(n)c=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),p=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;let m=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default",f=0,g=0;if(m)i||(f=this._lineHeight);else{let v=l/this._lineHeight,I=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),w=Math.min(v/2,I);f=w*this._lineHeight,g=Math.max(0,w-1)*this._lineHeight}i||(s===0||s===4)&&(g+=this._lineHeight),u-=f,p+=g;let b;if(p-u>l){if(!c)return-1;b=u}else if(s===5||s===6)if(s===6&&a<=u&&p<=d)b=a;else{let v=Math.max(5*this._lineHeight,l*.2),I=u-v,w=p-l;b=Math.max(w,I)}else if(s===1||s===2)if(s===2&&a<=u&&p<=d)b=a;else{let v=(u+p)/2;b=Math.max(0,v-l/2)}else b=this._computeMinimumScrolling(a,d,u,p,s===3,s===4);return b}_computeScrollLeftToReveal(e){let t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(147),n=t.left,o=n+t.width-i.verticalScrollbarWidth,s=1073741824,a=0;if(e.type==="range"){let d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let u of c.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(s=Math.max(0,s-r.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(n,o,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,i,n,o,s){e=e|0,t=t|0,i=i|0,n=n|0,o=!!o,s=!!s;let a=t-e;if(n-i<a){if(o)return i;if(s)return Math.max(0,n-a);if(i<e)return i;if(n>t)return Math.max(0,n-a)}else return i;return e}};var pL=class extends jf{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(e){super(),this._context=e;let i=this._context.configuration.options.get(147);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let i=this._context.configuration.options.get(147);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),i=[],n=0;for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(i[n++]=new Hh(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(i[n++]=new Hh(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return i}prepareRender(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+o+"px;width:"+s+'px;"></div>',l=[];for(let d=t;d<=i;d++){let c=d-t,u=n[c].getDecorations(),p="";for(let m of u){let f='<div class="cldr '+m.className;m.tooltip!==null&&(f+='" title="'+m.tooltip),f+=a,p+=f}l[c]=p}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Yf=class r extends pi{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(e){super(e);let t=this._context.configuration.options,i=t.get(147);this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=$e(document.createElement("div")),this._domNode.setClassName(r.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=$e(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(r.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){let t=this._context.configuration.options,i=t.get(147);return this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);let i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}};var hL=class extends jf{_context;_renderResult;constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),i=[],n=0;for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.options.marginClassName,d=a.options.zIndex;l&&(i[n++]=new Hh(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return i}prepareRender(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o=[];for(let s=t;s<=i;s++){let a=s-t,l=n[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';o[a]=d}this._renderResult=o}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var el=class r{_rgba8Brand=void 0;static Empty=new r(0,0,0,0);r;g;b;a;constructor(e,t,i,n){this.r=r._clamp(e),this.g=r._clamp(t),this.b=r._clamp(i),this.a=r._clamp(n)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};var B9=(()=>{let r=[];for(let e=32;e<=126;e++)r.push(e);return r.push(65533),r})(),V9=(r,e)=>(r-=32,r<0||r>96?e<=2?(r+96)%96:95:r);var oC=class r{constructor(e,t){this.scale=t;this.charDataNormal=r.soften(e,12/15),this.charDataLight=r.soften(e,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(e,t){let i=new Uint8ClampedArray(e.length);for(let n=0,o=e.length;n<o;n++)i[n]=bp(e[n]*t);return i}renderChar(e,t,i,n,o,s,a,l,d,c,u){let p=1*this.scale,m=2*this.scale,f=u?1:m;if(t+p>e.width||i+f>e.height){console.warn("bad render request outside image data");return}let g=c?this.charDataLight:this.charDataNormal,b=V9(n,d),v=e.width*4,I=a.r,w=a.g,E=a.b,S=o.r-I,T=o.g-w,D=o.b-E,L=Math.max(s,l),A=e.data,W=b*p*m,j=i*v+t*4;for(let G=0;G<f;G++){let oe=j;for(let _e=0;_e<p;_e++){let re=g[W++]/255*(s/255);A[oe++]=I+S*re,A[oe++]=w+T*re,A[oe++]=E+D*re,A[oe++]=L}j+=v}}blockRenderChar(e,t,i,n,o,s,a,l){let d=1*this.scale,c=2*this.scale,u=l?1:c;if(t+d>e.width||i+u>e.height){console.warn("bad render request outside image data");return}let p=e.width*4,m=.5*(o/255),f=s.r,g=s.g,b=s.b,v=n.r-f,I=n.g-g,w=n.b-b,E=f+v*m,S=g+I*m,T=b+w*m,D=Math.max(o,a),L=e.data,A=i*p+t*4;for(let W=0;W<u;W++){let j=A;for(let G=0;G<d;G++)L[j++]=E,L[j++]=S,L[j++]=T,L[j++]=D;A+=p}}};var Zf=class r extends P{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=gl(new r)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new _;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(Qr.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let e=Qr.getColorMap();if(!e){this._colors=[el.Empty],this._backgroundIsLight=!0;return}this._colors=[el.Empty];for(let i=1;i<e.length;i++){let n=e[i].rgba;this._colors[i]=new el(n.r,n.g,n.b,Math.round(n.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};var H9={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},U9=r=>{let e=new Uint8ClampedArray(r.length/2);for(let t=0;t<r.length;t+=2)e[t>>1]=H9[r[t]]<<4|H9[r[t+1]]&15;return e},wF={1:ps(()=>U9("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:ps(()=>U9("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var mL=class r{static lastCreated;static lastFontFamily;static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return wF[e]?i=new oC(wF[e](),e):i=r.createFromSampleData(r.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){let t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let n=0;for(let o of B9)i.fillText(String.fromCharCode(o),n,16/2),n+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){let i=16*10*4*96;if(e.length!==i)throw new Error("Unexpected source in MinimapCharRenderer");let n=r._downsample(e,t);return new oC(n,t)}static _downsampleChar(e,t,i,n,o){let s=1*o,a=2*o,l=n,d=0;for(let c=0;c<a;c++){let u=c/a*16,p=(c+1)/a*16;for(let m=0;m<s;m++){let f=m/s*10,g=(m+1)/s*10,b=0,v=0;for(let w=u;w<p;w++){let E=t+Math.floor(w)*3840,S=1-(w-Math.floor(w));for(let T=f;T<g;T++){let D=1-(T-Math.floor(T)),L=E+Math.floor(T)*4,A=D*S;v+=A,b+=e[L]*e[L+3]/255*A}}let I=b/v;d=Math.max(d,I),i[l++]=bp(I)}}return d}static _downsample(e,t){let i=2*t*1*t,n=i*96,o=new Uint8ClampedArray(n),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(e,a,o,s,t)),s+=i,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<n;c++)o[c]*=d}return o}};var z9=dt?'"Segoe WPC", "Segoe UI", sans-serif':ke?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var oQ=140,rQ=2,gL=class r{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(e,t,i){let n=e.options,o=n.get(145),s=n.get(147),a=s.minimap,l=n.get(51),d=n.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(107),this.paddingTop=n.get(85).top,this.paddingBottom=n.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=o,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=z9,this.sectionHeaderFontSize=d.sectionHeaderFontSize*o,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=r._getSectionHeaderColor(t,i.getColor(1)),this.charRenderer=ps(()=>mL.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=r._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=r._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){let i=e.getColor(Kz);return i?new el(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){let t=e.getColor(Gz);return t?el._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){let i=e.getColor(Dr);return i?new el(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}},xF=class r{constructor(e,t,i,n,o,s,a,l,d){this.scrollTop=e;this.scrollHeight=t;this.sliderNeeded=i;this._computedSliderRatio=n;this.sliderTop=o;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){let t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,n,o,s,a,l,d,c,u){let p=e.pixelRatio,m=e.minimapLineHeight,f=Math.floor(e.canvasInnerHeight/m),g=e.lineHeight;if(e.minimapHeightIsEditorHeight){let T=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(T+=Math.max(0,o-e.lineHeight-e.paddingBottom));let D=Math.max(1,Math.floor(o*o/T)),L=Math.max(0,e.minimapHeight-D),A=L/(c-o),W=d*A,j=L>0,G=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),oe=Math.floor(e.paddingTop/e.lineHeight);return new r(d,c,j,A,W,D,oe,1,Math.min(a,G))}let b;if(s&&i!==a){let T=i-t+1;b=Math.floor(T*m/p)}else{let T=o/g;b=Math.floor(T*m/p)}let v=Math.floor(e.paddingTop/g),I=Math.floor(e.paddingBottom/g);if(e.scrollBeyondLastLine){let T=o/g;I=Math.max(I,T-1)}let w;if(I>0){let T=o/g;w=(v+a+I-T-1)*m/p}else w=Math.max(0,(v+a)*m/p-b);w=Math.min(e.minimapHeight-b,w);let E=w/(c-o),S=d*E;if(f>=v+a+I){let T=w>0;return new r(d,c,T,E,S,b,v,1,a)}else{let T;t>1?T=t+v:T=Math.max(1,d/g);let D,L=Math.max(1,Math.floor(T-S*p/m));L<v?(D=v-L+1,L=1):(D=0,L=Math.max(1,L-v)),u&&u.scrollHeight===c&&(u.scrollTop>d&&(L=Math.min(L,u.startLineNumber),D=Math.max(D,u.topPaddingLineCount)),u.scrollTop<d&&(L=Math.max(L,u.startLineNumber),D=Math.min(D,u.topPaddingLineCount)));let A=Math.min(a,L-D+f-1),W=(d-n)/g,j;return d>=e.paddingTop?j=(t-L+D+W)*m/p:j=d/e.paddingTop*(D+W)*m/p,new r(d,c,!0,E,j,b,D,L,A)}}},fL=class r{static INVALID=new r(-1);dy;constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},bL=class{renderedLayout;_imageData;_renderedLines;constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new zI({createLine:()=>fL.INVALID}),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;let i=this._renderedLines._get().lines;for(let n=0,o=i.length;n<o;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){let e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}},TF=class r{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(e,t,i,n){this._backgroundFillData=r._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){let n=i.r,o=i.g,s=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4),d=0;for(let c=0;c<t;c++)for(let u=0;u<e;u++)l[d]=n,l[d+1]=o,l[d+2]=s,l[d+3]=a,d+=4;return l}},vL=class r{constructor(e,t){this.samplingRatio=e;this.minimapLines=t}static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];let{minimapLineCount:n}=by.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),o=t/n,s=o/2;if(!i||i.minimapLines.length===0){let b=[];if(b[0]=1,n>1){for(let v=0,I=n-1;v<I;v++)b[v]=Math.round(v*o+s);b[n-1]=t}return[new r(o,b),[]]}let a=i.minimapLines,l=a.length,d=[],c=0,u=0,p=1,m=10,f=[],g=null;for(let b=0;b<n;b++){let v=Math.max(p,Math.round(b*o)),I=Math.max(v,Math.round((b+1)*o));for(;c<l&&a[c]<v;){if(f.length<m){let E=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:E,deleteToLineNumber:E},f.push(g)),u--}c++}let w;if(c<l&&a[c]<=I)w=a[c],c++;else if(b===0?w=1:b+1===n?w=t:w=Math.round(b*o+s),f.length<m){let E=c+1+u;g&&g.type==="inserted"&&g._i===b-1?g.insertToLineNumber++:(g={type:"inserted",_i:b,insertFromLineNumber:E,insertToLineNumber:E},f.push(g)),u++}d[b]=w,p=w}if(f.length<m)for(;c<l;){let b=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:b,deleteToLineNumber:b},f.push(g)),u--,c++}else f=[{type:"flush"}];return[new r(o,d),f]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let n=this.modelLineToMinimapLine(t)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=t;)n++;if(i===n){let o=this.minimapLines[i];if(o<e||o>t)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),n=this.modelLineToMinimapLine(t);return e!==t&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(e){let t=e.toLineNumber-e.fromLineNumber+1,i=this.minimapLines.length,n=0;for(let o=this.minimapLines.length-1;o>=0&&!(this.minimapLines[o]<e.fromLineNumber);o--)this.minimapLines[o]<=e.toLineNumber?(this.minimapLines[o]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,o),n=Math.max(n,o)):this.minimapLines[o]-=t;return[i,n]}onLinesInserted(e){let t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}},yL=class extends pi{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new Br(10,1.5);_actual;constructor(e){super(e),this.tokensColorTracker=Zf.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new gL(this._context.configuration,this._context.theme,this.tokensColorTracker);let[t]=vL.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new _F(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let e=new gL(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){let t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){let[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(let i of e.ranges){let n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&t.push({fromLineNumber:n[0],toLineNumber:n[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));let n={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;let e=!!this._samplingState,[t,i]=vL.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(let n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){let n=[];for(let o=0,s=t-e+1;o<s;o++)i[o]?n[o]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+o-1]):n[o]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let e of this._selections){let[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new tt(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let i=this._getMinimapDecorationsInViewport(e,t).filter(n=>!n.options.minimap?.sectionHeaderStyle);if(this._samplingState){let n=[];for(let o of i){if(!o.options.minimap)continue;let s=o.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);n.push(new sf(new O(a,s.startColumn,l,s.endColumn),o.options))}return n}return i}getSectionHeaderDecorationsInViewport(e,t){let i=this.options.minimapLineHeight,o=this.options.sectionHeaderFontSize/i;return e=Math.floor(Math.max(1,e-o)),this._getMinimapDecorationsInViewport(e,t).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){let n=this._samplingState.minimapLines[e-1],o=this._samplingState.minimapLines[t-1];i=new O(n,1,o,this._context.viewModel.getLineMaxColumn(o))}else i=new O(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(i)}getSectionHeaderText(e,t){let i=e.options.minimap?.sectionHeaderText;if(!i)return null;let n=this._sectionHeaderCache.get(i);if(n)return n;let o=t(i);return this._sectionHeaderCache.set(i,o),o}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new O(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}},_F=class r extends P{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(e,t){super(),this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(iO),this._domNode=$e(document.createElement("div")),Vn.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=$e(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=$e(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=$e(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=$e(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=$e(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=si(this._domNode.domNode,Q.POINTER_DOWN,i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.button===0&&this._lastRenderData){let d=po(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(i,c,this._lastRenderData.renderedLayout)}return}let o=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY,l=Math.floor(s/o)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new wl,this._sliderPointerDownListener=si(this._slider.domNode,Q.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=ei.addTarget(this._domNode.domNode),this._sliderTouchStartListener=B(this._domNode.domNode,it.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=B(this._domNode.domNode,it.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=si(this._domNode.domNode,it.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;let n=e.pageX;this._slider.toggleClassName("active",!0);let o=(s,a)=>{let l=po(this._domNode.domNode),d=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(dt&&d>oQ){this._model.setScrollTop(i.scrollTop);return}let c=s-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(c))};e.pageY!==t&&o(e.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>o(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){let t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new TF(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(iO),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let i=xF.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;let t=this._model.getSelections();t.sort(O.compareRangesUsingStarts);let i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((p,m)=>(p.options.zIndex||0)-(m.options.zIndex||0));let{canvasInnerWidth:n,canvasInnerHeight:o}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,n,o);let c=new IL(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(d,t,c,e,s),this._renderDecorationsLineHighlights(d,i,c,e,s);let u=new IL(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(d,t,u,e,s,l,a,n),this._renderDecorationsHighlights(d,i,u,e,s,l,a,n),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,i,n,o){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of t){let d=n.intersectWithViewport(l);if(!d)continue;let[c,u]=d;for(let f=c;f<=u;f++)i.set(f,!0);let p=n.getYForLineNumber(c,o),m=n.getYForLineNumber(u,o);a>=p||(a>s&&e.fillRect(Ra,s,e.canvas.width,a-s),s=p),a=m}a>s&&e.fillRect(Ra,s,e.canvas.width,a-s)}_renderDecorationsLineHighlights(e,t,i,n,o){let s=new Map;for(let a=t.length-1;a>=0;a--){let l=t[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=n.intersectWithViewport(l.range);if(!c)continue;let[u,p]=c,m=d.getColor(this._theme.value);if(!m||m.isTransparent())continue;let f=s.get(m.toString());f||(f=m.transparent(.5).toString(),s.set(m.toString(),f)),e.fillStyle=f;for(let g=u;g<=p;g++){if(i.has(g))continue;i.set(g,!0);let b=n.getYForLineNumber(u,o);e.fillRect(Ra,b,e.canvas.width,o)}}}_renderSelectionsHighlights(e,t,i,n,o,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of t){let c=n.intersectWithViewport(d);if(!c)continue;let[u,p]=c;for(let m=u;m<=p;m++)this.renderDecorationOnLine(e,i,d,this._selectionColor,n,m,o,o,s,a,l)}}_renderDecorationsHighlights(e,t,i,n,o,s,a,l){for(let d of t){let c=d.options.minimap;if(!c)continue;let u=n.intersectWithViewport(d.range);if(!u)continue;let[p,m]=u,f=c.getColor(this._theme.value);if(!(!f||f.isTransparent()))for(let g=p;g<=m;g++)switch(c.position){case 1:this.renderDecorationOnLine(e,i,d.range,f,n,g,o,o,s,a,l);continue;case 2:{let b=n.getYForLineNumber(g,o);this.renderDecoration(e,f,2,b,rQ,o);continue}}}}renderDecorationOnLine(e,t,i,n,o,s,a,l,d,c,u){let p=o.getYForLineNumber(s,l);if(p+a<0||p>this._model.options.canvasInnerHeight)return;let{startLineNumber:m,endLineNumber:f}=i,g=m===s?i.startColumn:1,b=f===s?i.endColumn:this._model.getLineMaxColumn(s),v=this.getXOffsetForPosition(t,s,g,d,c,u),I=this.getXOffsetForPosition(t,s,b,d,c,u);this.renderDecoration(e,n,v,p,I-v,a)}getXOffsetForPosition(e,t,i,n,o,s){if(i===1)return Ra;if((i-1)*o>=s)return s;let l=e.get(t);if(!l){let d=this._model.getLineContent(t);l=[Ra];let c=Ra;for(let u=1;u<d.length+1;u++){let p=d.charCodeAt(u-1),m=p===9?n*o:bs(p)?2*o:o,f=c+m;if(f>=s){l[u]=s;break}l[u]=f,c=f}e.set(t,l)}return i-1<l.length?l[i-1]:s}renderDecoration(e,t,i,n,o,s){e.fillStyle=t&&t.toString()||"",e.fillRect(i,n,o,s)}_renderSectionHeaders(e){let t=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,o=i*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,u=c,p=this._decorationsCanvas.domNode.getContext("2d");p.letterSpacing=n+"px",p.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,p.strokeStyle=u,p.lineWidth=.2;let m=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);m.sort((g,b)=>g.range.startLineNumber-b.range.startLineNumber);let f=r._fitSectionHeader.bind(null,p,s-Ra);for(let g of m){let b=e.getYForLineNumber(g.range.startLineNumber,t)+i,v=b-i,I=v+2,w=this._model.getSectionHeaderText(g,f);r._renderSectionLabel(p,w,g.options.minimap?.sectionHeaderStyle===2,l,c,s,v,o,b,I)}}static _fitSectionHeader(e,t,i){if(!i)return i;let n="\u2026",o=e.measureText(i).width,s=e.measureText(n).width;if(o<=t||o<=s)return i;let a=i.length,l=o/i.length,d=Math.floor((t-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(i[c-1]);)--c;return i.substring(0,c)+n+i.substring(a-(d-c))}static _renderSectionLabel(e,t,i,n,o,s,a,l,d,c){t&&(e.fillStyle=n,e.fillRect(0,a,s,l),e.fillStyle=o,e.fillText(t,Ra,d)),i&&(e.beginPath(),e.moveTo(0,c),e.lineTo(s,c),e.closePath(),e.stroke())}renderLines(e){let t=e.startLineNumber,i=e.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){let re=this._lastRenderData._get();return new bL(e,re.imageData,re.lines)}let o=this._getBuffer();if(!o)return null;let[s,a,l]=r._renderUntouchedLines(o,e.topPaddingLineCount,t,i,n,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(t,i,l),c=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,p=this._model.options.backgroundColor,m=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,g=f.backgroundIsLight(),b=this._model.options.renderMinimap,v=this._model.options.charRenderer(),I=this._model.options.fontScale,w=this._model.options.minimapCharWidth,S=(b===1?2:3)*I,T=n>S?Math.floor((n-S)/2):0,D=p.a/255,L=new el(Math.round((p.r-u.r)*D+u.r),Math.round((p.g-u.g)*D+u.g),Math.round((p.b-u.b)*D+u.b),255),A=e.topPaddingLineCount*n,W=[];for(let re=0,ne=i-t+1;re<ne;re++)l[re]&&r._renderLine(o,L,p.a,g,b,w,f,m,v,A,T,c,d[re],I,n),W[re]=new fL(A),A+=n;let j=s===-1?0:s,oe=(a===-1?o.height:a)-j;return this._canvas.domNode.getContext("2d").putImageData(o,0,0,0,j,o.width,oe),new bL(e,o,W)}static _renderUntouchedLines(e,t,i,n,o,s){let a=[];if(!s){for(let A=0,W=n-i+1;A<W;A++)a[A]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,u=l.lines,p=u.length,m=e.width,f=e.data,g=(n-i+1)*o*m*4,b=-1,v=-1,I=-1,w=-1,E=-1,S=-1,T=t*o;for(let A=i;A<=n;A++){let W=A-i,j=A-c,G=j>=0&&j<p?u[j].dy:-1;if(G===-1){a[W]=!0,T+=o;continue}let oe=G*m*4,_e=(G+o)*m*4,re=T*m*4,ne=(T+o)*m*4;w===oe&&S===re?(w=_e,S=ne):(I!==-1&&(f.set(d.subarray(I,w),E),b===-1&&I===0&&I===E&&(b=w),v===-1&&w===g&&I===E&&(v=I)),I=oe,w=_e,E=re,S=ne),a[W]=!1,T+=o}I!==-1&&(f.set(d.subarray(I,w),E),b===-1&&I===0&&I===E&&(b=w),v===-1&&w===g&&I===E&&(v=I));let D=b===-1?-1:b/(m*4),L=v===-1?-1:v/(m*4);return[D,L,a]}static _renderLine(e,t,i,n,o,s,a,l,d,c,u,p,m,f,g){let b=m.content,v=m.tokens,I=e.width-s,w=g===1,E=Ra,S=0,T=0;for(let D=0,L=v.getCount();D<L;D++){let A=v.getEndOffset(D),W=v.getForeground(D),j=a.getColor(W);for(;S<A;S++){if(E>I)return;let G=b.charCodeAt(S);if(G===9){let oe=p-(S+T)%p;T+=oe-1,E+=oe*s}else if(G===32)E+=s;else{let oe=bs(G)?2:1;for(let _e=0;_e<oe;_e++)if(o===2?d.blockRenderChar(e,E,c+u,j,l,t,i,w):d.renderChar(e,E,c+u,G,j,l,t,i,f,n,w),E+=s,E>I)return}}}}},IL=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let n=0,o=this._endLineNumber-this._startLineNumber+1;n<o;n++)this._values[n]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}};var CL=class extends pi{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(e,t){super(e),this._viewDomNode=t;let n=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=$e(document.createElement("div")),Vn.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=$e(document.createElement("div")),Vn.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){let i=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(e){let t=$e(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){let i=this._widgets[e.getId()],n=t?t.preference:null,o=t?.stackOridinal;return i.preference===n&&i.stack===o?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=o,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0,t=Object.keys(this._widgets);for(let i=0,n=t.length;i<n;i++){let o=t[i],a=this._widgets[o].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){let i=e.domNode;if(e.preference===null){i.setTop("");return}let n=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){let o=i.domNode.clientHeight;i.setTop(this._editorHeight-o-2*this._horizontalScrollbarHeight)}else i.setTop(0);e.stack!==void 0?(i.setTop(t[e.preference]),t[e.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(e.preference===2)i.domNode.style.right="50%",e.stack!==void 0?(i.setTop(t[2]),t[2]+=i.domNode.clientHeight):i.setTop(0);else{let{top:o,left:s}=e.preference;if(this._context.configuration.options.get(43)&&e.widget.allowEditorOverflow){let l=this._viewDomNodeRect;i.setTop(o+l.top),i.setLeft(s+l.left),i.setPosition("fixed")}else i.setTop(o),i.setLeft(s),i.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=po(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);let t=Object.keys(this._widgets),i=Array.from({length:3},()=>0);t.sort((n,o)=>(this._widgets[n].stack||0)-(this._widgets[o].stack||0));for(let n=0,o=t.length;n<o;n++){let s=t[n];this._renderWidget(this._widgets[s],i)}}};var DF=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(e,t){let i=e.options;this.lineHeight=i.get(68),this.pixelRatio=i.get(145),this.overviewRulerLanes=i.get(84),this.renderBorder=i.get(83);let n=t.getColor(m4);this.borderColor=n?n.toString():null,this.hideCursor=i.get(60);let o=t.getColor(Lg);this.cursorColorSingle=o?o.transparent(.7).toString():null;let s=t.getColor(Cx);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=t.getColor(Sx);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;let l=i.get(74),d=l.enabled,c=l.side,u=t.getColor(g4),p=Qr.getDefaultBackground();u?this.backgroundColor=u:d&&c==="right"?this.backgroundColor=p:this.backgroundColor=null;let f=i.get(147).overviewRuler;this.top=f.top,this.right=f.right,this.domWidth=f.width,this.domHeight=f.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[g,b]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=g,this.w=b}_initLanes(e,t,i){let n=t-e;if(i>=3){let o=Math.floor(n/3),s=Math.floor(n/3),a=n-o-s,l=e,d=l+o,c=l+o+a;return[[0,l,d,l,c,l,d,l],[0,o,a,o+a,s,o+a+s,a+s,o+a+s]]}else if(i===2){let o=Math.floor(n/2),s=n-o,a=e,l=a+o;return[[0,a,a,a,l,a,a,a],[0,o,o,o,s,o+s,o+s,o+s]]}else{let o=e,s=n;return[[0,o,o,o,o,o,o,o],[0,s,s,s,s,s,s,s]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&U.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}};var SL=class extends pi{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(e){super(e),this._domNode=$e(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=Qr.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new F(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){let t=new DF(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++){let n=this._settings.cursorColorSingle;i>1&&(n=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:n})}return this._cursorPositions.sort((t,i)=>F.compare(t.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){let e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?U.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}let t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(hh.compareByRenderingProps),this._actualShouldRender===1&&!hh.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!li(this._renderedCursorPositions,this._cursorPositions,(f,g)=>f.position.lineNumber===g.position.lineNumber&&f.color===g.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let i=this._settings.canvasWidth,n=this._settings.canvasHeight,o=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,d=6*this._settings.pixelRatio|0,c=d/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=U.Format.CSS.formatHexA(e),u.fillRect(0,0,i,n)):(u.clearRect(0,0,i,n),u.fillStyle=U.Format.CSS.formatHexA(e),u.fillRect(0,0,i,n)):u.clearRect(0,0,i,n);let p=this._settings.x,m=this._settings.w;for(let f of t){let g=f.color,b=f.data;u.fillStyle=g;let v=0,I=0,w=0;for(let E=0,S=b.length/3;E<S;E++){let T=b[3*E],D=b[3*E+1],L=b[3*E+2],A=s.getVerticalOffsetForLineNumber(D)*l|0,W=(s.getVerticalOffsetForLineNumber(L)+o)*l|0;if(W-A<d){let G=(A+W)/2|0;G<c?G=c:G+c>n&&(G=n-c),A=G-c,W=G+c}A>w+1||T!==v?(E!==0&&u.fillRect(p[v],I,m[v],w-I),v=T,I=A,w=W):W>w&&(w=W)}u.fillRect(p[v],I,m[v],w-I)}if(!this._settings.hideCursor){let f=2*this._settings.pixelRatio|0,g=f/2|0,b=this._settings.x[7],v=this._settings.w[7],I=-100,w=-100,E=null;for(let S=0,T=this._cursorPositions.length;S<T;S++){let D=this._cursorPositions[S].color;if(!D)continue;let L=this._cursorPositions[S].position,A=s.getVerticalOffsetForLineNumber(L.lineNumber)*l|0;A<g?A=g:A+g>n&&(A=n-g);let W=A-g,j=W+f;W>w+1||D!==E?(S!==0&&E&&u.fillRect(b,I,v,w-I),I=W,w=j):j>w&&(w=j),E=D,u.fillStyle=D}E&&u.fillRect(b,I,v,w-I)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,n),u.moveTo(1,0),u.lineTo(i,0),u.stroke())}};var EL=class extends ra{_context;_domNode;_zoneManager;constructor(e,t){super(),this._context=e;let i=this._context.configuration.options;this._domNode=$e(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new HT(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(68)),this._zoneManager.setPixelRatio(i.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return e.hasChanged(68)&&(this._zoneManager.setLineHeight(t.get(68)),this._render()),e.hasChanged(145)&&(this._zoneManager.setPixelRatio(t.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),o=this._domNode.domNode.getContext("2d");return o.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(o,i,n,e),!0}_renderOneLane(e,t,i,n){let o=0,s=0,a=0;for(let l of t){let d=l.colorId,c=l.from,u=l.to;d!==o?(e.fillRect(0,s,n,a-s),o=d,e.fillStyle=i[o],s=c,a=u):a>=c?a=Math.max(a,u):(e.fillRect(0,s,n,a-s),s=c,a=u)}e.fillRect(0,s,n,a-s)}};var wL=class extends pi{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(e){super(e),this.domNode=$e(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let t=this._context.configuration.options;this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){let e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){let{tabSize:n}=this._context.viewModel.model.getOptions(),o=n,s=t-e;for(;s>0;){let a=$e(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(o),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let i=e-t;for(;i>0;){let n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){let n=this._renderedRulers[t],o=this._rulers[t];n.setBoxShadow(o.color?`1px 0 0 0 ${o.color} inset`:""),n.setHeight(Math.min(e.scrollHeight,1e6)),n.setLeft(o.column*this._typicalHalfwidthCharacterWidth)}}};var xL=class extends pi{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let i=this._context.configuration.options.get(105);this._useShadows=i.useShadows,this._domNode=$e(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let t=this._context.configuration.options.get(147);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){let i=this._context.configuration.options.get(105);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var LF=class{left;width;startStyle;endStyle;constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}},kF=class{lineNumber;ranges;constructor(e,t){this.lineNumber=e,this.ranges=t}};function sQ(r){return new LF(r)}function aQ(r){return new kF(r.lineNumber,r.ranges.map(sQ))}var _L=class r extends gr{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){let n=this._typicalHalfwidthCharacterWidth/4,o=null,s=null;if(i&&i.length>0&&t.length>0){let a=t[0].lineNumber;if(a===e.startLineNumber)for(let d=0;!o&&d<i.length;d++)i[d].lineNumber===a&&(o=i[d].ranges[0]);let l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let d=i.length-1;!s&&d>=0;d--)i[d].lineNumber===l&&(s=i[d].ranges[0]);o&&!o.startStyle&&(o=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=t.length;a<l;a++){let d=t[a].ranges[0],c=d.left,u=d.left+d.width,p={top:0,bottom:0},m={top:0,bottom:0};if(a>0){let f=t[a-1].ranges[0].left,g=t[a-1].ranges[0].left+t[a-1].ranges[0].width;TL(c-f)<n?p.top=2:c>f&&(p.top=1),TL(u-g)<n?m.top=2:f<u&&u<g&&(m.top=1)}else o&&(p.top=o.startStyle.top,m.top=o.endStyle.top);if(a+1<l){let f=t[a+1].ranges[0].left,g=t[a+1].ranges[0].left+t[a+1].ranges[0].width;TL(c-f)<n?p.bottom=2:f<c&&c<g&&(p.bottom=1),TL(u-g)<n?m.bottom=2:u<g&&(m.bottom=1)}else s&&(p.bottom=s.startStyle.bottom,m.bottom=s.endStyle.bottom);d.startStyle=p,d.endStyle=m}}_getVisibleRangesWithStyle(e,t,i){let o=(t.linesVisibleRangesForRange(e,!0)||[]).map(aQ);return!this._visibleRangesHaveGaps(o)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,o,i),o}_createSelectionPiece(e,t,i,n,o){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+n.toString()+"px;width:"+o.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){if(n.length===0)return;let o=!!n[0].ranges[0].startStyle,s=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,d=n.length;l<d;l++){let c=n[l],u=c.lineNumber,p=u-t,m=i&&u===s?1:0,f=i&&u!==s&&u===a?1:0,g="",b="";for(let v=0,I=c.ranges.length;v<I;v++){let w=c.ranges[v];if(o){let S=w.startStyle,T=w.endStyle;if(S.top===1||S.bottom===1){g+=this._createSelectionPiece(m,f,r.SELECTION_CLASS_NAME,w.left-r.ROUNDED_PIECE_WIDTH,r.ROUNDED_PIECE_WIDTH);let D=r.EDITOR_BACKGROUND_CLASS_NAME;S.top===1&&(D+=" "+r.SELECTION_TOP_RIGHT),S.bottom===1&&(D+=" "+r.SELECTION_BOTTOM_RIGHT),g+=this._createSelectionPiece(m,f,D,w.left-r.ROUNDED_PIECE_WIDTH,r.ROUNDED_PIECE_WIDTH)}if(T.top===1||T.bottom===1){g+=this._createSelectionPiece(m,f,r.SELECTION_CLASS_NAME,w.left+w.width,r.ROUNDED_PIECE_WIDTH);let D=r.EDITOR_BACKGROUND_CLASS_NAME;T.top===1&&(D+=" "+r.SELECTION_TOP_LEFT),T.bottom===1&&(D+=" "+r.SELECTION_BOTTOM_LEFT),g+=this._createSelectionPiece(m,f,D,w.left+w.width,r.ROUNDED_PIECE_WIDTH)}}let E=r.SELECTION_CLASS_NAME;if(o){let S=w.startStyle,T=w.endStyle;S.top===0&&(E+=" "+r.SELECTION_TOP_LEFT),S.bottom===0&&(E+=" "+r.SELECTION_BOTTOM_LEFT),T.top===0&&(E+=" "+r.SELECTION_TOP_RIGHT),T.bottom===0&&(E+=" "+r.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(m,f,E,w.left,w.width)}e[p][0]+=g,e[p][1]+=b}}_previousFrameVisibleRangesWithStyle=[];prepareRender(e){let t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let s=i;s<=n;s++){let a=s-i;t[a]=["",""]}let o=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){o[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[s]);o[s]=d,this._actualRenderOneSelection(t,i,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=o,this._renderResult=t.map(([s,a])=>s+a)}render(e,t){if(!this._renderResult)return"";let i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Fo((r,e)=>{let t=r.getColor(Lz);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function TL(r){return r<0?-r:r}var DL=class r extends pi{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(e){super(e);let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new YI(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=$e(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Ea,this._cursorFlatBlinkInterval=new Lm,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){let n=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(t.length?1:0),this._primaryCursor.onCursorPositionChanged(e,n),this._updateBlinking(),this._secondaryCursors.length<t.length){let o=t.length-this._secondaryCursors.length;for(let s=0;s<o;s++){let a=new YI(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){let o=this._secondaryCursors.length-t.length;for(let s=0;s<o;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let o=0;o<t.length;o++)this._secondaryCursors[o].onCursorPositionChanged(t[o],n)}onCursorStateChanged(e){let t=[];for(let n=0,o=e.selections.length;n<o;n++)t[n]=e.selections[n].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);let i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=i=>{for(let n=0,o=e.ranges.length;n<o;n++)if(e.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[n].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(let i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},r.BLINK_INTERVAL,pe(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},r.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case 1:e+=" cursor-line-style";break;case 2:e+=" cursor-block-style";break;case 3:e+=" cursor-underline-style";break;case 4:e+=" cursor-line-thin-style";break;case 5:e+=" cursor-block-outline-style";break;case 6:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],i=0,n=this._primaryCursor.render(e);n&&(t[i++]=n);for(let o=0,s=this._secondaryCursors.length;o<s;o++){let a=this._secondaryCursors[o].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};Fo((r,e)=>{let t=[{class:".cursor",foreground:Lg,background:Ix},{class:".cursor-primary",foreground:Cx,background:Q5},{class:".cursor-secondary",foreground:Sx,background:J5}];for(let i of t){let n=r.getColor(i.foreground);if(n){let o=r.getColor(i.background);o||(o=n.opposite()),e.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${o}; }`),Ba(r.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${o}; border-right: 1px solid ${o}; }`)}}});var RF=()=>{throw new Error("Invalid change accessor")},LL=class extends pi{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(e){super(e);let t=this._context.configuration.options,i=t.get(147);this._lineHeight=t.get(68),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=$e(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=$e(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=this._context.viewLayout.getWhitespaces(),t=new Map;for(let n of e)t.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{let o=Object.keys(this._zones);for(let s=0,a=o.length;s<a;s++){let l=o[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let u=t.get(l);u&&(u.afterLineNumber!==c.afterViewLineNumber||u.height!==c.heightInPx)&&(n.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),i=!0)}}),i}onConfigurationChanged(e){let t=this._context.configuration.options,i=t.get(147);return this._lineHeight=t.get(68),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new F(s,this._context.viewModel.model.getLineMaxColumn(s))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});let n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),o=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!o,afterViewLineNumber:n.lineNumber,heightInPx:o?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{let n={addZone:o=>(t=!0,this._addZone(i,o)),removeZone:o=>{o&&(t=this._removeZone(i,o)||t)},layoutZone:o=>{o&&(t=this._layoutZone(i,o)||t)}};lQ(e,n),n.addZone=RF,n.removeZone=RF,n.layoutZone=RF}),t}_addZone(e,t){let i=this._computeWhitespaceProps(t),o={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:$e(t.domNode),marginDomNode:t.marginDomNode?$e(t.marginDomNode):null};return this._safeCallOnComputedHeight(o.delegate,i.heightInPx),o.domNode.setPosition("absolute"),o.domNode.domNode.style.width="100%",o.domNode.setDisplay("none"),o.domNode.setAttribute("monaco-view-zone",o.whitespaceId),this.domNode.appendChild(o.domNode),o.marginDomNode&&(o.marginDomNode.setPosition("absolute"),o.marginDomNode.domNode.style.width="100%",o.marginDomNode.setDisplay("none"),o.marginDomNode.setAttribute("monaco-view-zone",o.whitespaceId),this.marginDomNode.appendChild(o.marginDomNode)),this._zones[o.whitespaceId]=o,this.setShouldRender(),o.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){let i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){let i=this._zones[t],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){Ge(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){Ge(i)}}prepareRender(e){}render(e){let t=e.viewportData.whitespaceViewportData,i={},n=!1;for(let s of t)this._zones[s.id].isInHiddenArea||(i[s.id]=s,n=!0);let o=Object.keys(this._zones);for(let s=0,a=o.length;s<a;s++){let l=o[s],d=this._zones[l],c=0,u=0,p="none";i.hasOwnProperty(l)?(c=i[l].verticalOffset-e.bigNumbersDelta,u=i[l].height,p="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(u),d.domNode.setDisplay(p),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(u),d.marginDomNode.setDisplay(p))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function lQ(r,e){try{return r(e)}catch(t){Ge(t)}}var kL=class extends gr{_context;_options;_selection;_renderResult;constructor(e){super(),this._context=e,this._options=new RL(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=new RL(this._context.configuration);return this._options.equals(t)?e.hasChanged(147):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber-t+1,o=new Array(n);for(let a=0;a<n;a++)o[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,o);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){let l=a-e.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let u=this._selection;for(let p of u){if(p.endLineNumber<a||p.startLineNumber>a)continue;let m=p.startLineNumber===a?p.startColumn:d.minColumn,f=p.endLineNumber===a?p.endColumn:d.maxColumn;m<f&&(c||(c=[]),c.push(new Lf(m-1,f-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,c,d)}}_applyRenderWhitespace(e,t,i,n){if(this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";let o=this._context.theme.getColor(Ex),s=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=n.continuesWithWrappedLine,c=n.minColumn-1,u=this._options.renderWhitespace==="boundary",p=this._options.renderWhitespace==="trailing",m=this._options.lineHeight,f=this._options.middotWidth,g=this._options.wsmiddotWidth,b=this._options.spaceWidth,v=Math.abs(g-b),I=Math.abs(f-b),w=v<I?11825:183,E=this._options.canUseHalfwidthRightwardsArrow,S="",T=!1,D=qi(a),L;D===-1?(T=!0,D=l,L=l):L=fs(a);let A=0,W=i&&i[A],j=0;for(let G=c;G<l;G++){let oe=a.charCodeAt(G);if(W&&G>=W.endOffset&&(A++,W=i&&i[A]),oe!==9&&oe!==32||p&&!T&&G<=L)continue;if(u&&G>=D&&G<=L&&oe===32){let re=G-1>=0?a.charCodeAt(G-1):0,ne=G+1<l?a.charCodeAt(G+1):0;if(re!==32&&ne!==32)continue}if(u&&d&&G===l-1){let re=G-1>=0?a.charCodeAt(G-1):0;if(oe===32&&re!==32&&re!==9)continue}if(i&&(!W||W.startOffset>G||W.endOffset<=G))continue;let _e=e.visibleRangeForPosition(new F(t,G+1));_e&&(s?(j=Math.max(j,_e.left),oe===9?S+=this._renderArrow(m,b,_e.left):S+=`<circle cx="${(_e.left+b/2).toFixed(2)}" cy="${(m/2).toFixed(2)}" r="${(b/7).toFixed(2)}" />`):oe===9?S+=`<div class="mwh" style="left:${_e.left}px;height:${m}px;">${E?"\uFFEB":"\u2192"}</div>`:S+=`<div class="mwh" style="left:${_e.left}px;height:${m}px;">${String.fromCharCode(w)}</div>`)}return s?(j=Math.round(j+b),`<svg style="bottom:0;position:absolute;width:${j}px;height:${m}px" viewBox="0 0 ${j} ${m}" xmlns="http://www.w3.org/2000/svg" fill="${o}">`+S+"</svg>"):S}_renderArrow(e,t,i){let n=t/7,o=t,s=e/2,a=i,l={x:0,y:n/2},d={x:100/125*o,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},u={x:c.x+.1*d.x,y:c.y+.1*d.x},p={x:u.x+.35*d.x,y:u.y-.35*d.x},m={x:p.x,y:-p.y},f={x:u.x,y:-u.y},g={x:c.x,y:-c.y},b={x:d.x,y:-d.y},v={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,u,p,m,f,g,b,v].map(E=>`${(a+E.x).toFixed(2)} ${(s+E.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";let i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}},RL=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(e){let t=e.options,i=t.get(51),n=t.get(39);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=t.get(101),this.renderWithSVG=!0):(this.renderWhitespace=t.get(101),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(68),this.stopRenderingLineAfter=t.get(119)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}};var Xf=class extends pi{};var AF=class{_onDidChange=new _;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},MF=new AF;var PF=class{constructor(e,t,i,n,o){this._context=e;this.modelLineNumber=t;this.distanceToModelLineStart=i;this.widthOfHiddenLineTextBefore=n;this.distanceToModelLineEnd=o}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(e){let t=new F(this.modelLineNumber,this.distanceToModelLineStart+1),i=new F(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},OF=$i,Qf=class extends Xf{constructor(t,i,n,o,s){super(t);this._keybindingService=o;this._instantiationService=s;this._viewController=i,this._visibleRangeProvider=n,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new tt(1,1,1,1)],this._modelSelections=[new tt(1,1,1,1)],this._lastRenderPosition=null,this.textArea=$e(document.createElement("textarea")),Vn.write(this.textArea,7),this.textArea.setClassName(`inputarea ${dc}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",iC(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",h("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=$e(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:m=>this._context.viewModel.getLineMaxColumn(m),getValueInRange:(m,f)=>this._context.viewModel.getValueInRange(m,f),getValueLengthInRange:(m,f)=>this._context.viewModel.getValueLengthInRange(m,f),modifyPosition:(m,f)=>this._context.viewModel.modifyPosition(m,f)},u={getDataToCopy:()=>$D(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let f=this._selections[0];if(ke&&f.isEmpty()){let b=f.getStartPosition(),v=this._getWordBeforePosition(b);if(v.length===0&&(v=this._getCharacterBeforePosition(b)),v.length>0)return new Un(v,v.length,v.length,O.fromPositions(b),0)}if(ke&&!f.isEmpty()&&c.getValueLengthInRange(f,0)<500){let b=c.getValueInRange(f,0);return new Un(b,0,b.length,f,0)}if(Uo&&!f.isEmpty()){let b="vscode-placeholder";return new Un(b,0,b.length,null,void 0)}return Un.EMPTY}if(N0){let f=this._selections[0];if(f.isEmpty()){let g=f.getStartPosition(),[b,v]=this._getAndroidWordAtPosition(g);if(b.length>0)return new Un(b,v,v,O.fromPositions(g),0)}return Un.EMPTY}let m=Kf.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return Un.fromScreenReaderContentState(m)},deduceModelPosition:(m,f,g)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(m,f,g)},p=this._register(new YD(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(Gf,u,p,nr,{isAndroid:N0,isChrome:Vc,isFirefox:$i,isSafari:Uo})),this._register(this._textAreaInput.onKeyDown(m=>{this._viewController.emitKeyDown(m)})),this._register(this._textAreaInput.onKeyUp(m=>{this._viewController.emitKeyUp(m)})),this._register(this._textAreaInput.onPaste(m=>{let f=!1,g=null,b=null;m.metadata&&(f=this._emptySelectionClipboard&&!!m.metadata.isFromEmptySelection,g=typeof m.metadata.multicursorText<"u"?m.metadata.multicursorText:null,b=m.metadata.mode),this._viewController.paste(m.text,f,g,b)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(m=>{m.replacePrevCharCnt||m.replaceNextCharCnt||m.positionDelta?(Mr&&console.log(` => compositionType: <<${m.text}>>, ${m.replacePrevCharCnt}, ${m.replaceNextCharCnt}, ${m.positionDelta}`),this._viewController.compositionType(m.text,m.replacePrevCharCnt,m.replaceNextCharCnt,m.positionDelta)):(Mr&&console.log(` => type: <<${m.text}>>`),this._viewController.type(m.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(m=>{this._viewController.setSelection(m)})),this._register(this._textAreaInput.onCompositionStart(m=>{let f=this.textArea.domNode,g=this._modelSelections[0],{distanceToModelLineStart:b,widthOfHiddenTextBefore:v}=(()=>{let w=f.value.substring(0,Math.min(f.selectionStart,f.selectionEnd)),E=w.lastIndexOf(`
`),S=w.substring(E+1),T=S.lastIndexOf("	"),D=S.length-T-1,L=g.getStartPosition(),A=Math.min(L.column-1,D),W=L.column-1-A,j=S.substring(0,S.length-A),{tabSize:G}=this._context.viewModel.model.getOptions(),oe=dQ(this.textArea.domNode.ownerDocument,j,this._fontInfo,G);return{distanceToModelLineStart:W,widthOfHiddenTextBefore:oe}})(),{distanceToModelLineEnd:I}=(()=>{let w=f.value.substring(Math.max(f.selectionStart,f.selectionEnd)),E=w.indexOf(`
`),S=E===-1?w:w.substring(0,E),T=S.indexOf("	"),D=T===-1?S.length:S.length-T-1,L=g.getEndPosition(),A=Math.min(this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column,D);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column-A}})();this._context.viewModel.revealRange("keyboard",!0,O.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new PF(this._context,g.startLineNumber,b,v,I),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${dc} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(m=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${dc}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(MF.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(t){t.appendChild(this.textArea),t.appendChild(this.textAreaCover)}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(t){let i='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',n=this._context.viewModel.getLineContent(t.lineNumber),o=Al(i,[]),s=!0,a=t.column,l=!0,d=t.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let u=n.charCodeAt(a-2);o.get(u)!==0?s=!1:a--}if(l&&d>n.length&&(l=!1),l){let u=n.charCodeAt(d-1);o.get(u)!==0?l=!1:d++}c++}return[n.substring(a-1,d-1),t.column-a]}_getWordBeforePosition(t){let i=this._context.viewModel.getLineContent(t.lineNumber),n=Al(this._context.configuration.options.get(133),[]),o=t.column,s=0;for(;o>1;){let a=i.charCodeAt(o-2);if(n.get(a)!==0||s>50)return i.substring(o-1,t.column-1);s++,o--}return i.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){let n=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!Di(n.charCodeAt(0)))return n}return""}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);let i=t.get(3);this._accessibilitySupport===2&&i===Xs.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=i;let o=t.get(147).wrappingColumn;if(o!==-1&&this._accessibilitySupport!==1){let s=t.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(o*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=OF?0:1}onConfigurationChanged(t){let i=this._context.configuration.options,n=i.get(147);this._setAccessibilityOptions(i),this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._contentHeight=n.height,this._fontInfo=i.get(51),this._lineHeight=i.get(68),this._emptySelectionClipboard=i.get(38),this._copyWithSyntaxHighlighting=i.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:o}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${o*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",iC(i,this._keybindingService)),this.textArea.setAttribute("aria-required",i.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(i.get(126))),(t.hasChanged(34)||t.hasChanged(93))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){let t=this._context.configuration.options;!MF.enabled||t.get(34)&&t.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new F(1,1);_primaryCursorVisibleRange=null;prepareRender(t){this._primaryCursorPosition=new F(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let n=this._visibleTextArea.visibleTextareaStart,o=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&n&&o&&o.left>=this._scrollLeft&&n.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=nC(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+n.left-this._scrollLeft,p=o.left-n.left+1;if(u<this._contentLeft){let I=this._contentLeft-u;u+=I,c+=I,p-=I}p>this._contentWidth&&(p=this._contentWidth);let m=this._context.viewModel.getViewLineData(s.lineNumber),f=m.tokens.findTokenIndexAtOffset(s.column-1),g=m.tokens.findTokenIndexAtOffset(a.column-1),b=f===g,v=this._visibleTextArea.definePresentation(b?m.tokens.getPresentation(f):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:u,width:p,height:this._lineHeight,useCover:!1,color:(Qr.getColorMap()||[])[v.foreground],italic:v.italic,bold:v.bold,underline:v.underline,strikethrough:v.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let i=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(i<0||i>this._contentHeight){this._renderAtTopLeft();return}if(ke||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let n=this._textAreaInput.textAreaState.newlineCountBeforeSelection??nC(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=n*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:OF?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:OF?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;let i=this.textArea,n=this.textAreaCover;Ti(i,this._fontInfo),i.setTop(t.top),i.setLeft(t.left),i.setWidth(t.width),i.setHeight(t.height),i.setColor(t.color?U.Format.CSS.formatHex(t.color):""),i.setFontStyle(t.italic?"italic":""),t.bold&&i.setFontWeight("bold"),i.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),n.setTop(t.useCover?t.top:0),n.setLeft(t.useCover?t.left:0),n.setWidth(t.useCover?t.width:0),n.setHeight(t.useCover?t.height:0);let o=this._context.configuration.options;o.get(58)?n.setClassName("monaco-editor-background textAreaCover "+Yf.OUTER_CLASS_NAME):o.get(69).renderType!==0?n.setClassName("monaco-editor-background textAreaCover "+$f.CLASS_NAME):n.setClassName("monaco-editor-background textAreaCover")}};Qf=R([y(3,qt),y(4,ve)],Qf);function dQ(r,e,t,i){if(e.length===0)return 0;let n=r.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";let o=r.createElement("span");Ti(o,t),o.style.whiteSpace="pre",o.style.tabSize=`${i*t.spaceWidth}px`,o.append(e),n.appendChild(o),r.body.appendChild(n);let s=o.offsetWidth;return n.remove(),s}var AL=class extends P{constructor(t,i){super();this._domNode=t;this._onFocusChange=i;this._register(B(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(B(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(t){this._isFocused!==t&&(this._isFocused=t,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function Jf(r,e,t,i){return r.addEventListener(e,t,i),{dispose(){r.removeEventListener(e,t)}}}var eb=class{constructor(e,t,i){this._domNode=e;this._context=t;this._keybindingService=i;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new tt(1,1,1,1);_screenReaderContentState;onConfigurationChanged(e){this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let e=this._context.configuration.options,t=e.get(147);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._fontInfo=e.get(51),this._lineHeight=e.get(68),this._accessibilitySupport=e.get(2),this._accessibilityPageSize=e.get(3)}_updateDomAttributes(){let e=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",iC(e,this._keybindingService));let t=this._context.viewModel.model.getOptions().tabSize,i=e.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${t*i}px`}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new tt(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent()}render(e){if(!this._screenReaderContentState)return;Ti(this._domNode,this._fontInfo);let t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),i=this._context.viewLayout.getCurrentScrollTop(),n=t-i;this._domNode.setTop(n),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let o=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=nC(o);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let e=this._accessibilitySupport===1?1:this._accessibilityPageSize,t={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:i=>this._context.viewModel.getLineMaxColumn(i),getValueInRange:(i,n)=>this._context.viewModel.getValueInRange(i,n),getValueLengthInRange:(i,n)=>this._context.viewModel.getValueLengthInRange(i,n),modifyPosition:(i,n)=>this._context.viewModel.modifyPosition(i,n)};return Kf.fromEditorSelection(t,this._primarySelection,e,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(e,t){let n=Kr().document.getSelection();if(!n)return;let o=this._domNode.domNode.firstChild;if(!o)return;let s=Kr().document.activeElement,a=new globalThis.Range;a.setStart(o,e),a.setEnd(o,t),n.removeAllRanges(),n.addRange(a),ki(s)&&s.focus()}};eb=R([y(2,qt)],eb);var tb=class extends Xf{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new tt(1,1,1,1);_textStartPositionWithinEditor=new F(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(e,t,i,n){super(e),this.domNode=new Rp(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new AL(this.domNode.domNode,o=>this._context.viewModel.setHasFocus(o))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=i.createInstance(eb,this.domNode,e),this._register(B(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(n))),this._register(B(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(n),t.cut()})),this._register(B(this.domNode.domNode,"keyup",o=>t.emitKeyUp(new bt(o)))),this._register(B(this.domNode.domNode,"keydown",async o=>{let s=new bt(o);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(t,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),t.emitKeyDown(s)})),this._register(Jf(this._editContext,"textformatupdate",o=>this._handleTextFormatUpdate(o))),this._register(Jf(this._editContext,"characterboundsupdate",o=>this._updateCharacterBounds())),this._register(Jf(this._editContext,"textupdate",o=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=O.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(t,o),this._screenReaderSupport.writeScreenReaderContent()})),this._register(Jf(this._editContext,"compositionstart",o=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=O.fromPositions(s,s);this._compositionRangeWithinEditor=a,t.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(Jf(this._editContext,"compositionend",o=>{this._compositionRangeWithinEditor=void 0,t.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(e){e.appendChild(this.domNode),this._parent=e.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._renderingContext=e,this._screenReaderSupport.prepareRender(e),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new tt(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(126)))}_updateEditContext(){let e=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._textStartPositionWithinEditor=e.textStartPositionWithinEditor}_emitTypeEvent(e,t){if(!this._editContext)return;let i=this._context.viewModel.model,n=i.getOffsetAt(this._textStartPositionWithinEditor),o=i.getOffsetAt(this._primarySelection.getEndPosition()),s=i.getOffsetAt(this._primarySelection.getStartPosition()),a=o-n,l=s-n,d=0,c=0;t.updateRangeEnd>a&&(d=t.updateRangeEnd-a),t.updateRangeStart<l&&(c=l-t.updateRangeStart);let u="";l<t.updateRangeStart&&(u+=this._editContext.text.substring(l,t.updateRangeStart)),u+=t.text,a>t.updateRangeEnd&&(u+=this._editContext.text.substring(t.updateRangeEnd,a));let p={text:u,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(e,p);let m=l-c+u.length;this._updateCursorStatesAfterType(m,t.selectionStart,t.selectionEnd)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_updateCursorStatesAfterType(e,t,i){let n=t-e,o=i-e,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,u=d.column;return new tt(c,u+n,c,u+o)}).map(d=>ot.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let e=this._primarySelection.startColumn-1,t=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?t+=this._primarySelection.endColumn-1:t+=this._context.viewModel.model.getLineMaxColumn(a);let i=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),n=new O(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,i),o=this._context.viewModel.model.getValueInRange(n,0),s=n.getStartPosition();return{text:o,selectionStartOffset:e,selectionEndOffset:t,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(e){if(!this._editContext)return;let t=e.getTextFormats(),i=this._textStartPositionWithinEditor,n=[];t.forEach(o=>{let s=this._context.viewModel.model,a=s.getOffsetAt(i),l=s.getPositionAt(a+o.rangeStart),d=s.getPositionAt(a+o.rangeEnd),c=O.fromPositions(l,d),u=["edit-context-format-decoration",`underline-style-${o.underlineStyle.toLowerCase()}`,`underline-thickness-${o.underlineThickness.toLowerCase()}`];n.push({range:c,options:{description:"textFormatDecoration",inlineClassName:u.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,n)}_updateSelectionAndControlBounds(){if(!this._parent)return;let e=this._context.configuration.options,t=e.get(68),i=e.get(147).contentLeft,n=this._parent.getBoundingClientRect(),o=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=n.top+o-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*t,d=n.left+i,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let m=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];m.length>0&&(d+=Math.min(...m.map(f=>Math.min(...f.ranges.map(g=>g.left)))))}c=e.get(51).typicalHalfwidthCharacterWidth/2}else c=n.width-i;let u=new DOMRect(d,a,c,l),p=u;this._editContext.updateControlBounds(p),this._editContext.updateSelectionBounds(u)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let e=this._context.configuration.options,t=e.get(68),i=e.get(147).contentLeft,n=this._parent.getBoundingClientRect(),o=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(o.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=n.top+s-a,d=[];if(this._renderingContext){let f=this._renderingContext.linesVisibleRangesForRange(o,!0)??[];for(let g of f)for(let b of g.ranges)d.push(new DOMRect(n.left+i+b.left,l,b.width,t))}let c=this._context.viewModel.model,u=c.getOffsetAt(this._textStartPositionWithinEditor),m=c.getOffsetAt(o.getStartPosition())-u;this._editContext.updateCharacterBounds(m,d)}_ensureClipboardGetsEditorSelection(e){let t=this._context.configuration.options,i=t.get(38),n=t.get(25),o=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=$D(this._context.viewModel,o,i,n),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};Bh.INSTANCE.set($i?s.text.replace(/\r\n/g,`
`):s.text,a),e.writeText(s.text)}};tb=R([y(2,ve),y(3,Yg)],tb);var ib=class extends ra{constructor(t,i,n,o,s,a,l){super();this._instantiationService=l;this._selections=[new tt(1,1,1,1)],this._renderAnimationFrame=null;let d=new qD(i,o,s,t);this._context=new bD(i,n,o),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(tb,this._context,d):this._instantiationService.createInstance(Qf,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=$e(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=$e(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=$e(document.createElement("div")),Vn.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new lL(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new uL(this._context,this._linesContent),this._viewZones=new LL(this._context),this._viewParts.push(this._viewZones);let u=new SL(this._context);this._viewParts.push(u);let p=new xL(this._context);this._viewParts.push(p);let m=new JD(this._context);this._viewParts.push(m),m.addDynamicOverlay(new rL(this._context)),m.addDynamicOverlay(new _L(this._context)),m.addDynamicOverlay(new cL(this._context)),m.addDynamicOverlay(new aL(this._context)),m.addDynamicOverlay(new kL(this._context));let f=new eL(this._context);this._viewParts.push(f),f.addDynamicOverlay(new sL(this._context)),f.addDynamicOverlay(new hL(this._context)),f.addDynamicOverlay(new pL(this._context)),f.addDynamicOverlay(new $f(this._context)),this._glyphMarginWidgets=new dL(this._context),this._viewParts.push(this._glyphMarginWidgets);let g=new Yf(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(f.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new iL(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new DL(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new CL(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let b=new wL(this._context);this._viewParts.push(b);let v=new tL(this._context);this._viewParts.push(v);let I=new yL(this._context);if(this._viewParts.push(I),u){let w=this._scrollbar.getOverviewRulerLayoutInfo();w.parent.insertBefore(u.getDomNode(),w.insertBefore)}this._linesContent.appendChild(m.getDomNode()),this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(I.getDomNode()),this._overflowGuardContainer.appendChild(v.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new XD(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let t=this._context.viewModel.model,i=this._context.viewModel.glyphLanes,n=[],o=0;n=n.concat(t.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return o=Math.max(o,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),n=n.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=t.validateRange(s.preference.range);return o=Math.max(o,a.endLineNumber),{range:a,lane:s.preference.lane}})),n.sort((s,a)=>O.compareRangesUsingStarts(s.range,a.range)),i.reset(o);for(let s of n)i.push(s.lane,s.range,s.persist);return i}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._editContext.domNode.domNode.dispatchEvent(t)},getLastRenderData:()=>{let t=this._viewCursors.getLastRenderData()||[],i=this._editContext.getLastRenderData();return new wD(t,i)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,i)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,i)),visibleRangeForPosition:(t,i)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new F(t,i))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){let i=this._context.configuration.options.get(147);this.domNode.setWidth(i.width),this.domNode.setHeight(i.height),this._overflowGuardContainer.setWidth(i.width),this._overflowGuardContainer.setHeight(i.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let t=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+Vy(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new Je;if(this._renderAnimationFrame===null){let t=this._createCoordinatedRendering();this._renderAnimationFrame=NF.INSTANCE.scheduleCoordinatedRendering({window:pe(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new Je;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new Je;return t.renderText()},prepareRender:(i,n)=>{if(this._store.isDisposed)throw new Je;return t.prepareRender(i,n)},render:(i,n)=>{if(this._store.isDisposed)throw new Je;return t.render(i,n)}})}}_flushAccumulatedAndRenderNow(){let t=this._createCoordinatedRendering();Bu(()=>t.prepareRenderText());let i=Bu(()=>t.renderText());if(i){let[n,o]=i;Bu(()=>t.prepareRender(n,o)),Bu(()=>t.render(n,o))}}_getViewPartsToRender(){let t=[],i=0;for(let n of this._viewParts)n.shouldRender()&&(t[i++]=n);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}lc.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;let i=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(i.startLineNumber,i.endLineNumber,i.centeredLineNumber);let n=new hD(this._selections,i,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(n),this._viewLines.shouldRender()&&(this._viewLines.renderText(n),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new mD(this._context.viewLayout,n,this._viewLines)]},prepareRender:(t,i)=>{for(let n of t)n.prepareRender(i)},render:(t,i)=>{for(let n of t)n.render(i),n.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,i){let n=this._context.viewModel.model.validatePosition({lineNumber:t,column:i}),o=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new F(o.lineNumber,o.column));return s?s.left:-1}getTargetAtClientPoint(t,i){let n=this._pointerHandler.getTargetAtClientPoint(t,i);return n?Uf.convertViewToModelMouseTarget(n,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new EL(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,i){if(i){this._viewLines.forceShouldRender();for(let n of this._viewParts)n.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._editContext.writeScreenReaderContent(t)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(t){this._editContext.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){this._contentWidgets.setWidgetPosition(t.widget,t.position?.position??null,t.position?.secondaryPosition??null,t.position?.preference??null,t.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){this._overlayWidgets.setWidgetPosition(t.widget,t.position)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){let i=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,i)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};ib=R([y(6,ve)],ib);function Bu(r){try{return r()}catch(e){return Ge(e),null}}var NF=class r{static INSTANCE=new r;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{let t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(let[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){let t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,e1(e,t,100))}}_onRenderScheduled(){let e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let i of e)Bu(()=>i.prepareRenderText());let t=[];for(let i=0,n=e.length;i<n;i++){let o=e[i];t[i]=Bu(()=>o.renderText())}for(let i=0,n=e.length;i<n;i++){let o=e[i],s=t[i];if(!s)continue;let[a,l]=s;Bu(()=>o.prepareRender(a,l))}for(let i=0,n=e.length;i<n;i++){let o=e[i],s=t[i];if(!s)continue;let[a,l]=s;Bu(()=>o.render(a,l))}}};var uQ=Pu("domLineBreaksComputer",{createHTML:r=>r}),ML=class r{constructor(e){this.targetWindow=e}static create(e){return new r(new WeakRef(e))}createLineBreaksComputer(e,t,i,n,o){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>pQ(at(this.targetWindow.deref()),s,e,t,i,n,o,a)}}};function pQ(r,e,t,i,n,o,s,a){function l(A){let W=a[A];if(W){let j=Tr.applyInjectedText(e[A],W),G=W.map(_e=>_e.options),oe=W.map(_e=>_e.column-1);return new Jd(oe,G,[j.length],[],0)}else return null}if(n===-1){let A=[];for(let W=0,j=e.length;W<j;W++)A[W]=l(W);return A}let d=Math.round(n*t.typicalHalfwidthCharacterWidth),c=o===3?2:o===2?1:0,u=Math.round(i*c),p=Math.ceil(t.spaceWidth*u),m=document.createElement("div");Ti(m,t);let f=new Rl(1e4),g=[],b=[],v=[],I=[],w=[];for(let A=0;A<e.length;A++){let W=Tr.applyInjectedText(e[A],a[A]),j=0,G=0,oe=d;if(o!==0)if(j=qi(W),j===-1)j=0;else{for(let ge=0;ge<j;ge++){let de=W.charCodeAt(ge)===9?i-G%i:1;G+=de}let ne=Math.ceil(t.spaceWidth*G);ne+t.typicalFullwidthCharacterWidth>d?(j=0,G=0):oe=d-ne}let _e=W.substr(j),re=hQ(_e,G,i,oe,f,p);g[A]=j,b[A]=G,v[A]=_e,I[A]=re[0],w[A]=re[1]}let E=f.build(),S=uQ?.createHTML(E)??E;m.innerHTML=S,m.style.position="absolute",m.style.top="10000",s==="keepAll"?(m.style.wordBreak="keep-all",m.style.overflowWrap="anywhere"):(m.style.wordBreak="inherit",m.style.overflowWrap="break-word"),r.document.body.appendChild(m);let T=document.createRange(),D=Array.prototype.slice.call(m.children,0),L=[];for(let A=0;A<e.length;A++){let W=D[A],j=mQ(T,W,v[A],I[A]);if(j===null){L[A]=l(A);continue}let G=g[A],oe=b[A]+u,_e=w[A],re=[];for(let se=0,De=j.length;se<De;se++)re[se]=_e[j[se]];if(G!==0)for(let se=0,De=j.length;se<De;se++)j[se]+=G;let ne,ge,de=a[A];de?(ne=de.map(se=>se.options),ge=de.map(se=>se.column-1)):(ne=null,ge=null),L[A]=new Jd(ge,ne,j,re,oe)}return m.remove(),L}function hQ(r,e,t,i,n,o){if(o!==0){let p=String(o);n.appendString('<div style="text-indent: -'),n.appendString(p),n.appendString("px; padding-left: "),n.appendString(p),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');let s=r.length,a=e,l=0,d=[],c=[],u=0<s?r.charCodeAt(0):0;n.appendString("<span>");for(let p=0;p<s;p++){p!==0&&p%16384===0&&n.appendString("</span><span>"),d[p]=l,c[p]=a;let m=u;u=p+1<s?r.charCodeAt(p+1):0;let f=1,g=1;switch(m){case 9:f=t-a%t,g=f;for(let b=1;b<=f;b++)b<f?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:u===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:bs(m)&&g++,m<32?n.appendCharCode(9216+m):n.appendCharCode(m)}l+=f,a+=g}return n.appendString("</span>"),d[r.length]=l,c[r.length]=a,n.appendString("</div>"),[d,c]}function mQ(r,e,t,i){if(t.length<=1)return null;let n=Array.prototype.slice.call(e.children,0),o=[];try{BF(r,n,i,0,null,t.length-1,null,o)}catch(s){return console.log(s),null}return o.length===0?null:(o.push(t.length),o)}function BF(r,e,t,i,n,o,s,a){if(i===o||(n=n||FF(r,e,t[i],t[i+1]),s=s||FF(r,e,t[o],t[o+1]),Math.abs(n[0].top-s[0].top)<=.1))return;if(i+1===o){a.push(o);return}let l=i+(o-i)/2|0,d=FF(r,e,t[l],t[l+1]);BF(r,e,t,i,n,l,d,a),BF(r,e,t,l,d,o,s,a)}function FF(r,e,t,i){return r.setStart(e[t/16384|0].firstChild,t%16384),r.setEnd(e[i/16384|0].firstChild,i%16384),r.getClientRects()}var OL=class extends P{_editor=null;_instantiationService=null;_instances=this._register(new br);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(let n of t){if(this._pending.has(n.id)){Ge(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register(zv(pe(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(zv(pe(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(zv(pe(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let e={};for(let[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(let[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}set(e,t){this._instances.set(e,t)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return zv(pe(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;let t=this._findPendingContributionsByInstantiation(e);for(let i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){let t=[];for(let[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){let t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){Ge(i)}}}};var PL=class{constructor(e,t,i,n,o,s,a){this.id=e;this.label=t;this.alias=i;this.metadata=n;this._precondition=o;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}};var K9=Z("ILanguageFeaturesService");var NL=class r{static create(e){return new r(e.get(136),e.get(135))}classifier;constructor(e,t){this.classifier=new VF(e,t)}createLineBreaksComputer(e,t,i,n,o){let s=[],a=[],l=[];return{addRequest:(d,c,u)=>{s.push(d),a.push(c),l.push(u)},finalize:()=>{let d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,c=[];for(let u=0,p=s.length;u<p;u++){let m=a[u],f=l[u];f&&!f.injectionOptions&&!m?c[u]=gQ(this.classifier,f,s[u],t,i,d,n,o):c[u]=fQ(this.classifier,s[u],m,t,i,d,n,o)}return WF.length=0,HF.length=0,c}}}};var VF=class extends ng{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}},WF=[],HF=[];function gQ(r,e,t,i,n,o,s,a){if(n===-1)return null;let l=t.length;if(l<=1)return null;let d=a==="keepAll",c=e.breakOffsets,u=e.breakOffsetsVisibleColumn,p=j9(t,i,n,o,s),m=n-p,f=WF,g=HF,b=0,v=0,I=0,w=n,E=c.length,S=0;if(S>=0){let T=Math.abs(u[S]-w);for(;S+1<E;){let D=Math.abs(u[S+1]-w);if(D>=T)break;T=D,S++}}for(;S<E;){let T=S<0?0:c[S],D=S<0?0:u[S];v>T&&(T=v,D=I);let L=0,A=0,W=0,j=0;if(D<=w){let oe=D,_e=T===0?0:t.charCodeAt(T-1),re=T===0?0:r.get(_e),ne=!0;for(let ge=T;ge<l;ge++){let de=ge,se=t.charCodeAt(ge),De,fe;if(Di(se)?(ge++,De=0,fe=2):(De=r.get(se),fe=rC(se,oe,i,o)),de>v&&UF(_e,re,se,De,d)&&(L=de,A=oe),oe+=fe,oe>w){de>v?(W=de,j=oe-fe):(W=ge+1,j=oe),oe-A>m&&(L=0),ne=!1;break}_e=se,re=De}if(ne){b>0&&(f[b]=c[c.length-1],g[b]=u[c.length-1],b++);break}}if(L===0){let oe=D,_e=t.charCodeAt(T),re=r.get(_e),ne=!1;for(let ge=T-1;ge>=v;ge--){let de=ge+1,se=t.charCodeAt(ge);if(se===9){ne=!0;break}let De,fe;if(Pc(se)?(ge--,De=0,fe=2):(De=r.get(se),fe=bs(se)?o:1),oe<=w){if(W===0&&(W=de,j=oe),oe<=w-m)break;if(UF(se,De,_e,re,d)){L=de,A=oe;break}}oe-=fe,_e=se,re=De}if(L!==0){let ge=m-(j-A);if(ge<=i){let de=t.charCodeAt(W),se;Di(de)?se=2:se=rC(de,j,i,o),ge-se<0&&(L=0)}}if(ne){S--;continue}}if(L===0&&(L=W,A=j),L<=v){let oe=t.charCodeAt(v);Di(oe)?(L=v+2,A=I+2):(L=v+1,A=I+rC(oe,I,i,o))}for(v=L,f[b]=L,I=A,g[b]=A,b++,w=A+m;S<0||S<E&&u[S]<A;)S++;let G=Math.abs(u[S]-w);for(;S+1<E;){let oe=Math.abs(u[S+1]-w);if(oe>=G)break;G=oe,S++}}return b===0?null:(f.length=b,g.length=b,WF=e.breakOffsets,HF=e.breakOffsetsVisibleColumn,e.breakOffsets=f,e.breakOffsetsVisibleColumn=g,e.wrappedTextIndentLength=p,e)}function fQ(r,e,t,i,n,o,s,a){let l=Tr.applyInjectedText(e,t),d,c;if(t&&t.length>0?(d=t.map(A=>A.options),c=t.map(A=>A.column-1)):(d=null,c=null),n===-1)return d?new Jd(c,d,[l.length],[],0):null;let u=l.length;if(u<=1)return d?new Jd(c,d,[l.length],[],0):null;let p=a==="keepAll",m=j9(l,i,n,o,s),f=n-m,g=[],b=[],v=0,I=0,w=0,E=n,S=l.charCodeAt(0),T=r.get(S),D=rC(S,0,i,o),L=1;Di(S)&&(D+=1,S=l.charCodeAt(1),T=r.get(S),L++);for(let A=L;A<u;A++){let W=A,j=l.charCodeAt(A),G,oe;Di(j)?(A++,G=0,oe=2):(G=r.get(j),oe=rC(j,D,i,o)),UF(S,T,j,G,p)&&(I=W,w=D),D+=oe,D>E&&((I===0||D-w>f)&&(I=W,w=D-oe),g[v]=I,b[v]=w,v++,E=w+f,I=0),S=j,T=G}return v===0&&(!t||t.length===0)?null:(g[v]=u,b[v]=D,new Jd(c,d,g,b,m))}function rC(r,e,t,i){return r===9?t-e%t:bs(r)||r<32?i:1}function G9(r,e){return e-r%e}function UF(r,e,t,i,n){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!n&&e===3&&i!==2||!n&&i===3&&e!==1)}function j9(r,e,t,i,n){let o=0;if(n!==0){let s=qi(r);if(s!==-1){for(let l=0;l<s;l++){let d=r.charCodeAt(l)===9?G9(o,e):1;o+=d}let a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){let d=G9(o,e);o+=d}o+i>t&&(o=0)}}return o}var sC=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(e,t,i,n){this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=n}};var aC=class r{modelState;viewState;_selTrackedRange;_trackSelection;constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new dn(new O(1,1,1,1),0,0,new F(1,1),0),new dn(new O(1,1,1,1),0,0,new F(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new ot(this.modelState,this.viewState)}readSelectionFromMarkers(e){let t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?tt.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):tt.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,n){return t.equals(i)?n:e.normalizePosition(t,2)}static _validateViewState(e,t){let i=t.position,n=t.selectionStart.getStartPosition(),o=t.selectionStart.getEndPosition(),s=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,n,i,s),l=this._validatePositionWithCache(e,o,n,a);return i.equals(s)&&n.equals(a)&&o.equals(l)?t:new dn(O.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+n.column-a.column,s,t.leftoverVisibleColumns+i.column-s.column)}_setState(e,t,i){if(i&&(i=r._validateViewState(e.viewModel,i)),t){let n=e.model.validateRange(t.selectionStart),o=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,s=e.model.validatePosition(t.position),a=t.position.equals(s)?t.leftoverVisibleColumns:0;t=new dn(n,t.selectionStartKind,o,s,a)}else{if(!i)return;let n=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),o=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new dn(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,o,i.leftoverVisibleColumns)}if(i){let n=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),o=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new dn(n,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,o,t.leftoverVisibleColumns)}else{let n=e.coordinatesConverter.convertModelPositionToViewPosition(new F(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),o=e.coordinatesConverter.convertModelPositionToViewPosition(new F(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),s=new O(n.lineNumber,n.column,o.lineNumber,o.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new dn(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}};var lC=class{context;cursors;lastAddedCursorIndex;constructor(e){this.context=e,this.cursors=[new aC(e)],this.lastAddedCursorIndex=0}dispose(){for(let e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(let e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(let e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(let e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return KV(this.cursors,ir(e=>e.viewState.position,F.compare)).viewState.position}getBottomMostViewPosition(){return zV(this.cursors,ir(e=>e.viewState.position,F.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(ot.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){let t=this.cursors.length-1,i=e.length;if(t<i){let n=i-t;for(let o=0;o<n;o++)this._addSecondaryCursor()}else if(t>i){let n=t-i;for(let o=0;o<n;o++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,e[n].modelState,e[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new aC(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;let e=this.cursors.slice(0),t=[];for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(ir(i=>i.selection,O.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){let n=t[i],o=t[i+1],s=n.selection,a=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=n.index<o.index?i:i+1,c=n.index<o.index?i+1:i,u=t[c].index,p=t[d].index,m=t[c].selection,f=t[d].selection;if(!m.equalsSelection(f)){let g=m.plusRange(f),b=m.selectionStartLineNumber===m.startLineNumber&&m.selectionStartColumn===m.startColumn,v=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,I;u===this.lastAddedCursorIndex?(I=b,this.lastAddedCursorIndex=p):I=v;let w;I?w=new tt(g.startLineNumber,g.startColumn,g.endLineNumber,g.endColumn):w=new tt(g.endLineNumber,g.endColumn,g.startLineNumber,g.startColumn),t[d].selection=w;let E=ot.fromModelSelection(w);e[p].setState(this.context,E.modelState,E.viewState)}for(let g of t)g.index>u&&g.index--;e.splice(u,1),t.splice(c,1),this._removeSecondaryCursor(u-1),i--}}}};var FL=class extends P{_onEvent=this._register(new _);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){let n=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(n){this._outgoingEvents[t]=n;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new zF),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(let i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let e=this._viewEventQueue;this._viewEventQueue=null;let t=this._eventHandlers.slice(0);for(let i of t)i.handleEvents(e)}}},zF=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}};var BL=class r{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(e,t,i,n){this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new r(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}},VL=class r{kind=1;oldHasFocus;hasFocus;constructor(e,t){this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new r(this.oldHasFocus,e.hasFocus)}},WL=class r{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e,t,i,n,o,s,a,l){this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=o,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new r(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}},HL=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},UL=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},zL=class r{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(e,t,i,n,o,s,a){this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=n,this.source=o,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let i=e.length,n=t.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!e[o].equalsSelection(t[o]))return!1;return!0}isNoOp(){return r._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new r(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}},KL=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},GL=class{constructor(e){this.event=e}kind=7;isNoOp(){return!1}attemptToMerge(e){return null}},jL=class{constructor(e){this.event=e}kind=8;isNoOp(){return!1}attemptToMerge(e){return null}},qL=class{constructor(e){this.event=e}kind=9;isNoOp(){return!1}attemptToMerge(e){return null}},$L=class{constructor(e){this.event=e}kind=10;isNoOp(){return!1}attemptToMerge(e){return null}},YL=class{constructor(e){this.event=e}kind=11;isNoOp(){return!1}attemptToMerge(e){return null}},ZL=class{constructor(e){this.event=e}kind=12;isNoOp(){return!1}attemptToMerge(e){return null}};var XL=class extends P{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(e,t,i,n){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new sC(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new lC(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=ht(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new sC(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){let i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,n){let o=!1,s=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>s&&(n=n.slice(0,s),o=!0);let a=dC.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,o)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,i,n,o,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=O.fromPositions(a[0],a[0]),e.emitViewEvent(new tc(t,i,l,d,n,o,s))}revealPrimary(e,t,i,n,o,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new tc(t,i,null,l,n,o,s))}saveState(){let e=[],t=this._cursors.getSelections();for(let i=0,n=t.length;i<n;i++){let o=t[i];e.push({inSelectionMode:!o.isEmpty(),selectionStart:{lineNumber:o.selectionStartLineNumber,column:o.selectionStartColumn},position:{lineNumber:o.positionLineNumber,column:o.positionColumn}})}return e}restoreState(e,t){let i=[];for(let n=0,o=t.length;n<o;n++){let s=t[n],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),i.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,ot.fromModelSelections(i)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof cg){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;let n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new lC(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){let o=ot.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,o)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{let o=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,ot.fromModelSelections(o))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t,i,n){this.setStates(e,t,n,ot.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let i=[],n=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});let o=this._model.deltaDecorations([],i),s=this._model.deltaDecorations([],n);this._autoClosedActions.push(new QL(this._model,o,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();let t=KF.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let i=[],n=[];for(let o=0;o<e.commands.length;o++){let s=e.commands[o];s instanceof Bf&&s.enclosingRange&&s.closeCharacterRange&&(i.push(s.closeCharacterRange),n.push(s.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,n),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,n,o){let s=dC.from(this._model,this);if(s.equals(n))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new kT(l,a,i)),!n||n.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(n.cursorState[c].modelState))){let d=n?n.cursorState.map(u=>u.modelState.selection):null,c=n?n.modelVersionId:0;e.emitOutgoingEvent(new zL(d,a,c,s.modelVersionId,t||"keyboard",i,o))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let i=0,n=e.length;i<n;i++){let o=e[i];if(!o.text||o.text.indexOf(`
`)>=0)return null;let s=o.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=o.text.length-s[2].length-1,u=o.text.lastIndexOf(d,c-1);if(u===-1)return null;t.push([u,c])}return t}executeEdits(e,t,i,n){let o=null;t==="snippet"&&(o=this._findAutoClosingPairs(i)),o&&(i[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),i,d=>{if(o)for(let u=0,p=o.length;u<p;u++){let[m,f]=o[u],g=d[u],b=g.range.startLineNumber,v=g.range.startColumn-1+m,I=g.range.startColumn-1+f;s.push(new O(b,I+1,b,I+2)),a.push(new O(b,v+1,b,I+2))}let c=n(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(e,t,i,n=0){if(this.context.cursorConfig.readOnly)return;let o=dC.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(s){Ge(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,n,o,!1)&&this.revealAll(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return QL.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new jF(this._model,this.getSelections())}endComposition(e,t){let i=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Ja.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,i,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,i){this._executeEdit(()=>{if(i==="keyboard"){let n=t.length,o=0;for(;o<n;){let s=Sv(t,o),a=t.substr(o,s);this._executeEditOperation(Ja.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),o+=s}}else this._executeEditOperation(Ja.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,i)}compositionType(e,t,i,n,o,s){if(t.length===0&&i===0&&n===0){if(o!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new tt(d.lineNumber,d.column+o,d.lineNumber,d.column+o)});this.setSelections(e,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Ja.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,n,o))},e,s)}paste(e,t,i,n,o){this._executeEdit(()=>{this._executeEditOperation(Ja.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,n||[]))},e,o,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(cc.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new wn(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}executeCommands(e,t,i){this._executeEdit(()=>{this._executeEditOperation(new wn(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}},dC=class r{constructor(e,t){this.modelVersionId=e;this.cursorState=t}static from(e,t){return new r(e.getVersionId(),t.getCursorStates())}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}},QL=class{static getAllAutoClosedCharacters(e){let t=[];for(let i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){let i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){let t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){let n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(t.push(n),n.startLineNumber!==n.endLineNumber))return!1}t.sort(O.compareRangesUsingStarts),e.sort(O.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}},KF=class{static executeCommands(e,t,i){let n={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(n,i);for(let s=0,a=n.trackedRanges.length;s<a;s++)n.model._setTrackedRange(n.trackedRanges[s],null,0);return o}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;let i=this._getEditOperations(e,t);if(i.operations.length===0)return null;let n=i.operations,o=this._getLoserCursorMap(n);if(o.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=n.length;d<c;d++)o.hasOwnProperty(n[d].identifier.major.toString())||s.push(n[d]);i.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,s,d=>{let c=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m]=[];for(let m of d)m.identifier&&c[m.identifier.major].push(m);let u=(m,f)=>m.identifier.minor-f.identifier.minor,p=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m].length>0?(c[m].sort(u),p[m]=t[m].computeCursorState(e.model,{getInverseEditOperations:()=>c[m],getTrackedSelection:f=>{let g=parseInt(f,10),b=e.model._getTrackedRange(e.trackedRanges[g]);return e.trackedRangesDirection[g]===0?new tt(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):new tt(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn)}})):p[m]=e.selectionsBefore[m];return p});a||(a=e.selectionsBefore);let l=[];for(let d in o)o.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],n=!1;for(let o=0,s=t.length;o<s;o++){let a=t[o];if(a){let l=this._getEditOperationsFromCommand(e,o,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){let n=[],o=0,s=(u,p,m=!1)=>{O.isEmpty(u)&&p===""||n.push({identifier:{major:t,minor:o++},range:u,text:p,forceMoveMarkers:m,isAutoWhitespaceEdit:i.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(u,p,m)=>{a=!0,s(u,p,m)},trackSelection:(u,p)=>{let m=tt.liftSelection(u),f;if(m.isEmpty())if(typeof p=="boolean")p?f=2:f=3;else{let v=e.model.getLineMaxColumn(m.startLineNumber);m.startColumn===v?f=2:f=3}else f=1;let g=e.trackedRanges.length,b=e.model._setTrackedRange(null,m,f);return e.trackedRanges[g]=b,e.trackedRangesDirection[g]=m.getDirection(),g.toString()}};try{i.getEditOperations(e.model,c)}catch(u){return Ge(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,n)=>-O.compareRangesUsingEnds(i.range,n.range));let t={};for(let i=1;i<e.length;i++){let n=e[i-1],o=e[i];if(O.getStartPosition(n.range).isBefore(O.getEndPosition(o.range))){let s;n.identifier.major>o.identifier.major?s=n.identifier.major:s=o.identifier.major,t[s.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===s&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}},GF=class{constructor(e,t,i){this.text=e;this.startSelection=t;this.endSelection=i}},jF=class r{_original;static _capture(e,t){let i=[];for(let n of t){if(n.startLineNumber!==n.endLineNumber)return null;i.push(new GF(e.getLineContent(n.startLineNumber),n.startColumn-1,n.endColumn-1))}return i}constructor(e,t){this._original=r._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;let i=r._capture(e,t);if(!i||this._original.length!==i.length)return null;let n=[];for(let o=0,s=this._original.length;o<s;o++)n.push(r._deduceOutcome(this._original[o],i[o]));return n}static _deduceOutcome(e,t){let i=Math.min(e.startSelection,t.startSelection,Iv(e.text,t.text)),n=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,Cv(e.text,t.text)),o=e.text.substring(i,e.text.length-n),s=t.text.substring(i,t.text.length-n);return new GD(o,e.startSelection-i,e.endSelection-i,s,t.startSelection-i,t.endSelection-i)}};function q9(r,e,t,i,n,o,s){let a="<div>",l=i,d=0,c=!0;for(let u=0,p=e.getCount();u<p;u++){let m=e.getEndOffset(u);if(m<=i)continue;let f="";for(;l<m&&l<n;l++){let g=r.charCodeAt(l);switch(g){case 9:{let b=o-(l+d)%o;for(d+=b-1;b>0;)s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0),b--;break}case 60:f+="&lt;",c=!1;break;case 62:f+="&gt;",c=!1;break;case 38:f+="&amp;",c=!1;break;case 0:f+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:f+="\uFFFD",c=!1;break;case 13:f+="&#8203",c=!1;break;case 32:s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0);break;default:f+=String.fromCharCode(g),c=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${f}</span>`,m>n||l>=n)break}return a+="</div>",a}var qF=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;let t=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,n)}},$F=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(e,t,i,n,o){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=n,this.minWidth=o,this.prefixSum=0}},JL=class r{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(e,t,i,n){this._instanceId=zS(++r.INSTANCE_COUNT),this._pendingChanges=new qF,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=i,this._paddingBottom=n}static findInsertionIndex(e,t,i){let n=0,o=e.length;for(;n<o;){let s=n+o>>>1;t===e[s].afterLineNumber?i<e[s].ordinal?o=s:n=s+1:t<e[s].afterLineNumber?o=s:n=s+1}return n}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(n,o,s,a)=>{t=!0,n=n|0,o=o|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new $F(l,n,o,s,a)),l},changeOneWhitespace:(n,o,s)=>{t=!0,o=o|0,s=s|0,this._pendingChanges.change({id:n,newAfterLineNumber:o,newHeight:s})},removeWhitespace:n=>{t=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(let l of e)this._insertWhitespace(l);for(let l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of i){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let n=new Set;for(let l of i)n.add(l.id);let o=new Map;for(let l of t)o.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!n.has(c.id)){if(o.has(c.id)){let u=o.get(c.id);c.afterLineNumber=u.newAfterLineNumber,c.height=u.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(e));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){let t=r.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){let t=this._arr;for(let i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){let n=this._findWhitespaceIndex(e);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==t)){let o=this._arr[n];this._removeWhitespace(n),o.afterLineNumber=t,this._insertWhitespace(o)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){let o=this._arr[i].afterLineNumber;e<=o&&o<=t?this._arr[i].afterLineNumber=e-1:o>t&&(this._arr[i].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){let o=this._arr[i].afterLineNumber;e<=o&&(this._arr[i].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;let t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;let t=this._arr,i=0,n=t.length-1;for(;i<=n;){let s=(n-i|0)/2|0,a=i+s|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;let i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let i;e>1?i=this._lineHeight*(e-1):i=0;let n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+n+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let i=this._lineHeight*e,n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+n+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;let t=this._lineCount|0,i=this._lineHeight,n=1,o=t;for(;n<o;){let s=(n+o)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(e>=a+i)n=s+1;else{if(e>=a)return s;o=s}}return n>t?t:n}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let i=this._lineHeight,n=this.getLineNumberAtOrAfterVerticalOffset(e)|0,o=this.getVerticalOffsetForLineNumber(n)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(n)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let u=o,p=u,m=5e5,f=0;o>=m&&(f=Math.floor(o/m)*m,f=Math.floor(f/i)*i,p-=f);let g=[],b=e+(t-e)/2,v=-1;for(let S=n;S<=s;S++){if(v===-1){let T=u,D=u+i;(T<=b&&b<D||T>b)&&(v=S)}for(u+=i,g[S-n]=p,p+=i;c===S;)p+=d,u+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){s=S;break}}v===-1&&(v=s);let I=this.getVerticalOffsetForLineNumber(s)|0,w=n,E=s;return w<E&&o<e&&w++,w<E&&I+i>t&&E--,{bigNumbersDelta:f,startLineNumber:n,endLineNumber:s,relativeVerticalOffset:g,centeredLineNumber:v,completelyVisibleStartLineNumber:w,completelyVisibleEndLineNumber:E,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;let t=this.getAfterLineNumberForWhitespaceIndex(e),i;t>=1?i=this._lineHeight*t:i=0;let n;return e>0?n=this.getWhitespacesAccumulatedHeight(e-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;let n=this.getVerticalOffsetForWhitespaceIndex(i),o=this.getHeightForWhitespaceIndex(i);if(e>=n+o)return-1;for(;t<i;){let s=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(e>=a+l)t=s+1;else{if(e>=a)return s;i=s}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;let i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;let n=this.getHeightForWhitespaceIndex(t),o=this.getIdForWhitespaceIndex(t),s=this.getAfterLineNumberForWhitespaceIndex(t);return{id:o,afterLineNumber:s,verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this.getWhitespacesCount()-1;if(i<0)return[];let o=[];for(let s=i;s<=n;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=t)break;o.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return o}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};var vQ=125,Uh=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(e,t,i,n){e=e|0,t=t|0,i=i|0,n=n|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),n<0&&(n=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}},YF=class extends P{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new _);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(e,t){super(),this._dimensions=new Uh(0,0,0,0),this._scrollable=this._register(new _a({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;let t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);let i=t.contentWidth!==e.contentWidth,n=t.contentHeight!==e.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new BL(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},ek=class extends P{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(e,t,i){super(),this._configuration=e;let n=this._configuration.options,o=n.get(147),s=n.get(85);this._linesLayout=new JL(t,n.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new YF(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new Uh(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?vQ:0)}onConfigurationChanged(e){let t=this._configuration.options;if(e.hasChanged(68)&&this._linesLayout.setLineHeight(t.get(68)),e.hasChanged(85)){let i=t.get(85);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(147)){let i=t.get(147),n=i.contentWidth,o=i.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new Uh(n,s.contentWidth,o,this._getContentHeight(n,o,a)))}else this._updateHeight();e.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){let n=this._configuration.options.get(105);return n.horizontal===2||e>=t?0:n.horizontalScrollbarSize}_getContentHeight(e,t,i){let n=this._configuration.options,o=this._linesLayout.getLinesTotalHeight();return n.get(107)?o+=Math.max(0,t-n.get(68)-n.get(85).bottom):n.get(105).ignoreHorizontalScrollbarInContentHeight||(o+=this._getHorizontalScrollbarHeight(e,i)),o}_updateHeight(){let e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,n=e.contentWidth;this._scrollable.setScrollDimensions(new Uh(t,e.contentWidth,i,this._getContentHeight(t,i,n)))}getCurrentViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new gI(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new gI(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){let e=this._configuration.options,t=this._maxLineWidth,i=e.get(148),n=e.get(51),o=e.get(147);if(i.isViewportWrapping){let s=e.get(74);return t>o.contentWidth+n.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?t+o.verticalScrollbarWidth:t}else{let s=e.get(106)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+s+o.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){let e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new Uh(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){let e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-n,scrollLeft:e.scrollLeft}}changeWhitespace(e){let t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){let t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){let i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}};function nk(r,e){return r===null?e?tk.INSTANCE:ik.INSTANCE:new XF(r,e)}var XF=class{_projectionData;_isVisible;constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();let n=i>0?this._projectionData.breakOffsets[i-1]:0,o=this._projectionData.breakOffsets[i],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new Tr(0,0,d+1,this._projectionData.injectionOptions[c],0));s=Tr.applyInjectedText(e.getLineContent(t),a).substring(n,o)}else s=e.getValueInRange({startLineNumber:t,startColumn:n+1,endLineNumber:t,endColumn:o+1});return i>0&&(s=$9(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){let n=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],n),n[0]}getViewLinesData(e,t,i,n,o,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,u=null;if(d){u=[];let m=0,f=0;for(let g=0;g<l.getOutputLineCount();g++){let b=new Array;u[g]=b;let v=g>0?l.breakOffsets[g-1]:0,I=l.breakOffsets[g];for(;f<d.length;){let w=c[f].content.length,E=d[f]+m,S=E+w;if(E>I)break;if(v<S){let T=c[f];if(T.inlineClassName){let D=g>0?l.wrappedTextIndentLength:0,L=D+Math.max(E-v,0),A=D+Math.min(S-v,I-v);L!==A&&b.push(new VT(L,A,T.inlineClassName,T.inlineClassNameAffectsLetterSpacing))}}if(S<=I)m+=w,f++;else break}}}let p;if(d){let m=[];for(let f=0;f<d.length;f++){let g=d[f],b=c[f].tokens;b?b.forEach((v,I)=>{m.push({offset:g,text:v.substring(c[f].content),tokenMetadata:I.metadata})}):m.push({offset:g,text:c[f].content,tokenMetadata:Xi.defaultTokenMetadata})}p=e.tokenization.getLineTokens(t).withInserted(m)}else p=e.tokenization.getLineTokens(t);for(let m=i;m<i+n;m++){let f=o+m-i;if(!s[f]){a[f]=null;continue}a[f]=this._getViewLineData(p,u?u[m]:null,m)}}_getViewLineData(e,t,i){this._assertVisible();let n=this._projectionData,o=i>0?n.wrappedTextIndentLength:0,s=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=e.sliceAndInflate(s,a,o),d=l.getLineContent();i>0&&(d=$9(n.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(i)+1,u=d.length+1,p=i+1<this.getViewLineCount(),m=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new ph(d,p,c,u,m,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();let i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){let n=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(n)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},tk=class r{static INSTANCE=new r;constructor(){}isVisible(){return!0}setVisible(e){return e?this:ik.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){let n=e.tokenization.getLineTokens(t),o=n.getLineContent();return new ph(o,!1,1,o.length+1,0,n.inflate(),null)}getViewLinesData(e,t,i,n,o,s,a){if(!s[o]){a[o]=null;return}a[o]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new F(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}},ik=class r{static INSTANCE=new r;constructor(){}isVisible(){return!1}setVisible(e){return e?tk.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,o,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}},ZF=[""];function $9(r){if(r>=ZF.length)for(let e=1;e<=r;e++)ZF[e]=yQ(e);return ZF[r]}function yQ(r){return new Array(r+1).join(" ")}var ok=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();let t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new QF(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=cl(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){let i=this._values[e],n=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=n+i;for(let o=0;o<i;o++)this._indexBySum[n+o]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}},QF=class{constructor(e,t){this.index=e;this.remainder=t;this.index=e,this.remainder=t}_prefixSumIndexOfResultBrand=void 0};var rk=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(e,t,i,n,o,s,a,l,d,c){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=o,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new JF(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),o=i.length,s=this.createLineBreaksComputer(),a=new Do(Tr.fromDecorations(n));for(let g=0;g<o;g++){let b=a.takeWhile(v=>v.lineNumber===g+1);s.addRequest(i[g],b,t?t[g]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(g=>this.model.getDecorationRange(g)).sort(O.compareRangesUsingStarts),u=1,p=0,m=-1,f=m+1<c.length?p+1:o+2;for(let g=0;g<o;g++){let b=g+1;b===f&&(m++,u=c[m].startLineNumber,p=c[m].endLineNumber,f=m+1<c.length?p+1:o+2);let v=b>=u&&b<=p,I=nk(l[g],!v);d[g]=I.getViewLineCount(),this.modelLineProjections[g]=I}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new ok(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){let t=e.map(p=>this.model.validateRange(p)),i=IQ(t),n=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(O.compareRangesUsingStarts);if(i.length===n.length){let p=!1;for(let m=0;m<i.length;m++)if(!i[m].equalsRange(n[m])){p=!0;break}if(!p)return!1}let o=i.map(p=>({range:p,options:Qi.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,o);let s=i,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,u=!1;for(let p=0;p<this.modelLineProjections.length;p++){let m=p+1;m===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let f=!1;if(m>=a&&m<=l?this.modelLineProjections[p].isVisible()&&(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!1),f=!0):(u=!0,this.modelLineProjections[p].isVisible()||(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!0),f=!0)),f){let g=this.modelLineProjections[p].getViewLineCount();this.projectedModelLineLineCounts.setValue(p,g)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,n,o){let s=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,d=this.wrappingIndent===n,c=this.wordBreak===o;if(s&&a&&l&&d&&c)return!1;let u=s&&a&&!l&&d&&c;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=o;let p=null;if(u){p=[];for(let m=0,f=this.modelLineProjections.length;m<f;m++)p[m]=this.modelLineProjections[m].getProjectionData()}return this._constructLines(!1,p),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;let n=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,o=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new nf(n,o)}onModelLinesInserted(e,t,i,n){if(!e||e<=this._validModelVersionId)return null;let o=t>2&&!this.modelLineProjections[t-2].isVisible(),s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,a=0,l=[],d=[];for(let c=0,u=n.length;c<u;c++){let p=nk(n[c],!o);l.push(p);let m=p.getViewLineCount();a+=m,d[c]=m}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,d),new of(s,s+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let n=t-1,o=this.modelLineProjections[n].getViewLineCount(),s=this.modelLineProjections[n].isVisible(),a=nk(i,s);this.modelLineProjections[n]=a;let l=this.modelLineProjections[n].getViewLineCount(),d=!1,c=0,u=-1,p=0,m=-1,f=0,g=-1;o>l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1,f=u+1,g=f+(o-l)-1,d=!0):o<l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+o-1,p=u+1,m=p+(l-o)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1),this.projectedModelLineLineCounts.setValue(n,l);let b=c<=u?new mI(c,u-c+1):null,v=p<=m?new of(p,m):null,I=f<=g?new nf(f,g):null;return[d,b,v,I]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;let t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);let n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),o=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,o.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,n=t.remainder;return new sk(i+1,n)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new F(e.modelLineNumber,n)}getModelEndPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new F(e.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(e,t){let i=this.getViewLineInfo(e),n=this.getViewLineInfo(t),o=new Array,s=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,u=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let p=c;p<u;p++)a.push(new sk(l,p))}if(!d.isVisible()&&s){let c=new F(l-1,this.model.getLineMaxColumn(l-1)+1),u=O.fromPositions(s,c);o.push(new ak(u,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new F(l,1))}if(s){let l=O.fromPositions(s,this.getModelEndPositionOfViewLine(n));o.push(new ak(l,a))}return o}getViewLinesBracketGuides(e,t,i,n){let o=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(e,t)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,o,n);for(let c of a.viewLines){let p=d[c.modelLineNumber-l].map(m=>{if(m.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||m.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!m.horizontalLine)return m;let f=-1;if(m.column!==-1){let v=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.column);if(v.lineNumber===c.modelLineWrappedLineIdx)f=v.column;else if(v.lineNumber<c.modelLineWrappedLineIdx)f=this.getMinColumnOfViewLine(c);else if(v.lineNumber>c.modelLineWrappedLineIdx)return}let g=this.convertModelPositionToViewPosition(c.modelLineNumber,m.horizontalLine.endColumn),b=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.horizontalLine.endColumn);return b.lineNumber===c.modelLineWrappedLineIdx?new Js(m.visibleColumn,f,m.className,new Kd(m.horizontalLine.top,g.column),-1,-1):b.lineNumber<c.modelLineWrappedLineIdx||m.visibleColumn!==-1?void 0:new Js(m.visibleColumn,f,m.className,new Kd(m.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(p.filter(m=>!!m))}}return s}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),n=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t)),o=[],s=[],a=[],l=i.lineNumber-1,d=n.lineNumber-1,c=null;for(let f=l;f<=d;f++){let g=this.modelLineProjections[f];if(g.isVisible()){let b=g.getViewLineNumberOfModelPosition(0,f===l?i.column:1),v=g.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),I=v-b+1,w=0;I>1&&g.getViewLineMinColumn(this.model,f+1,v)===1&&(w=b===0?1:2),s.push(I),a.push(w),c===null&&(c=new F(f+1,0))}else c!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,f)),c=null)}c!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,n.lineNumber)),c=null);let u=t-e+1,p=new Array(u),m=0;for(let f=0,g=o.length;f<g;f++){let b=o[f],v=Math.min(u-m,s[f]),I=a[f],w;I===2?w=0:I===1?w=1:w=v;for(let E=0;E<v;E++)E===w&&(b=0),p[m++]=b}return p}getViewLineContent(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let n=this.projectedModelLineLineCounts.getIndexOf(e-1),o=e,s=n.index,a=n.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let u=this.modelLineProjections[d];if(!u.isVisible())continue;let p=d===s?a:0,m=u.getViewLineCount()-p,f=!1;if(o+m>t&&(f=!0,m=t-o+1),u.getViewLinesData(this.model,d+1,p,m,o-e,i,l),o+=m,f)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);let n=this.projectedModelLineLineCounts.getIndexOf(e-1),o=n.index,s=n.remainder,a=this.modelLineProjections[o],l=a.getViewLineMinColumn(this.model,o+1,s),d=a.getViewLineMaxColumn(this.model,o+1,s);t<l&&(t=l),t>d&&(t=d);let c=a.getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new F(o+1,c)).equals(i)?new F(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){let i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),n=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new O(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e,t){let i=this.getViewLineInfo(e),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new F(i.modelLineNumber,n))}convertViewRangeToModelRange(e){let t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new O(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,n=!1,o=!1){let s=this.model.validatePosition(new F(e,t)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(o)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new F(n?0:1,1);let u=1+this.projectedModelLineLineCounts.getPrefixSum(d),p;return c?o?p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,1,i):p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(d+1),i):p=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,i),p}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){let i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return O.fromPositions(i)}else{let i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),n=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new O(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){let o=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(o,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;let n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,n,o){let s=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-s.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new O(s.lineNumber,1,a.lineNumber,a.column),t,i,n,o);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,u=null;for(let g=d;g<=c;g++)if(this.modelLineProjections[g].isVisible())u===null&&(u=new F(g+1,g===d?s.column:1));else if(u!==null){let v=this.model.getLineMaxColumn(g);l=l.concat(this.model.getDecorationsInRange(new O(u.lineNumber,u.column,g,v),t,i,n)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new O(u.lineNumber,u.column,a.lineNumber,a.column),t,i,n)),u=null),l.sort((g,b)=>{let v=O.compareRangesUsingStarts(g.range,b.range);return v===0?g.id<b.id?-1:g.id>b.id?1:0:v});let p=[],m=0,f=null;for(let g of l){let b=g.id;f!==b&&(f=b,p[m++]=g)}return p}getInjectedTextAt(e){let t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){let i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){let t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}};function IQ(r){if(r.length===0)return[];let e=r.slice();e.sort(O.compareRangesUsingStarts);let t=[],i=e[0].startLineNumber,n=e[0].endLineNumber;for(let o=1,s=e.length;o<s;o++){let a=e[o];a.startLineNumber>n+1?(t.push(new O(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return t.push(new O(i,1,n,1)),t}var sk=class{constructor(e,t){this.modelLineNumber=e;this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},ak=class{constructor(e,t){this.modelRange=e;this.viewLines=t}},JF=class{_lines;constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,n){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,n)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}};var lk=class{model;constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new eB(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,n){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,i,n)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new nf(t,i)}onModelLinesInserted(e,t,i,n){return new of(t,i)}onModelLineChanged(e,t,i){return[!1,new mI(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){let i=t-e+1,n=new Array(i);for(let o=0;o<i;o++)n[o]=0;return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new ph(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){let n=this.model.getLineCount();e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n);let o=[];for(let s=e;s<=t;s++){let a=s-e;o[a]=i[a]?this.getViewLineData(s):null}return o}getDecorationsInRange(e,t,i,n,o){return this.model.getDecorationsInRange(e,t,i,n,o)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}},eB=class{_lines;constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){let t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}modelRangeIsVisible(e){let t=this._lines.model.getLineCount();return!(e.startLineNumber<1||e.startLineNumber>t||e.endLineNumber<1||e.endLineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}};var dk=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(e,t,i,n,o){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=o,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){let t=e.id,i=this._decorationsCache[t];if(!i){let n=e.range,o=e.options,s;if(o.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new F(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new F(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);s=new O(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new sf(s,o),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,i=!1){let n=new O(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(n,t,i).inlineDecorations[0]}_getDecorationsInRange(e,t,i){let n=this._linesCollection.getDecorationsInRange(e,this.editorId,Gp(this.configuration.options),t,i),o=e.startLineNumber,s=e.endLineNumber,a=[],l=0,d=[];for(let c=o;c<=s;c++)d[c-o]=[];for(let c=0,u=n.length;c<u;c++){let p=n[c],m=p.options;if(!CQ(this.model,p))continue;let f=this._getOrCreateViewModelDecoration(p),g=f.range;if(a[l++]=f,m.inlineClassName){let b=new ic(g,m.inlineClassName,m.inlineClassNameAffectsLetterSpacing?3:0),v=Math.max(o,g.startLineNumber),I=Math.min(s,g.endLineNumber);for(let w=v;w<=I;w++)d[w-o].push(b)}if(m.beforeContentClassName&&o<=g.startLineNumber&&g.startLineNumber<=s){let b=new ic(new O(g.startLineNumber,g.startColumn,g.startLineNumber,g.startColumn),m.beforeContentClassName,1);d[g.startLineNumber-o].push(b)}if(m.afterContentClassName&&o<=g.endLineNumber&&g.endLineNumber<=s){let b=new ic(new O(g.endLineNumber,g.endColumn,g.endLineNumber,g.endColumn),m.afterContentClassName,2);d[g.endLineNumber-o].push(b)}}return{decorations:a,inlineDecorations:d}}};function CQ(r,e){return!(e.options.hideInCommentTokens&&SQ(r,e)||e.options.hideInStringTokens&&EQ(r,e))}function SQ(r,e){return Y9(r,e.range,t=>t===1)}function EQ(r,e){return Y9(r,e.range,t=>t===2)}function Y9(r,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){let n=r.tokenization.getLineTokens(i),o=i===e.startLineNumber,s=i===e.endLineNumber,a=o?n.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<n.getCount()&&!(s&&n.getStartOffset(a)>e.endColumn-1);){if(!t(n.getStandardTokenType(a)))return!1;a++}}return!0}var zh=3,ck=class{lanes;persist=0;_requiredLanes=1;constructor(e){this.lanes=new Uint8Array(Math.ceil((e+1)*zh/8))}reset(e){let t=Math.ceil((e+1)*zh/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,i){i&&(this.persist|=1<<e-1);for(let n=t.startLineNumber;n<=t.endLineNumber;n++){let o=zh*n+(e-1);this.lanes[o>>>3]|=1<<o%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(e){let t=[],i=zh*e;for(let n=0;n<zh;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&t.push(n+1),i++;return t.length?t:[2]}countAtLine(e){let t=zh*e,i=0;for(let n=0;n<zh;n++)(this.persist&1<<n||this.lanes[t>>>3]&1<<t%8)&&i++,t++;return i}};var wQ=!0,uk=class extends P{constructor(t,i,n,o,s,a,l,d,c,u){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=u;if(this._editorId=t,this._configuration=i,this.model=n,this._eventDispatcher=new FL,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new ec(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Kt(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=tB.create(this.model),this.glyphLanes=new ck(0),wQ&&this.model.isTooLargeForTokenization())this._lines=new lk(this.model);else{let p=this._configuration.options,m=p.get(51),f=p.get(141),g=p.get(148),b=p.get(140),v=p.get(131);this._lines=new rk(this._editorId,this.model,o,s,m,this.model.getOptions().tabSize,f,g.wrappingColumn,b,v)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new XL(n,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new ek(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(p=>{p.scrollTopChanged&&this._handleVisibleLinesChanged(),p.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new MT(p)),this._eventDispatcher.emitOutgoingEvent(new WL(p.oldScrollWidth,p.oldScrollLeft,p.oldScrollHeight,p.oldScrollTop,p.scrollWidth,p.scrollLeft,p.scrollHeight,p.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(p=>{this._eventDispatcher.emitOutgoingEvent(p)})),this._decorations=new dk(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(p=>{try{let m=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(m,p)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(Zf.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new NT)})),this._register(this._themeService.onDidColorThemeChange(p=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new OT(p))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let t=this.viewLayout.getLinesViewportData(),i=new O(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(i)}visibleLinesStabilized(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new RT(t)),this._eventDispatcher.emitOutgoingEvent(new VL(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new _T)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new DT)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let t=new F(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),i=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new pk(i,this._viewportStart.startLineDelta)}return new pk(null,0)}_onConfigurationChanged(t,i){let n=this._captureStableViewport(),o=this._configuration.options,s=o.get(51),a=o.get(141),l=o.get(148),d=o.get(140),c=o.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(t.emitViewEvent(new ch),t.emitViewEvent(new uh),t.emitViewEvent(new Yl(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),i.hasChanged(93)&&(this._decorations.reset(),t.emitViewEvent(new Yl(null))),i.hasChanged(100)&&(this._decorations.reset(),t.emitViewEvent(new Yl(null))),t.emitViewEvent(new LT(i)),this.viewLayout.onConfigurationChanged(i),n.recoverViewportStart(this.coordinatesConverter,this.viewLayout),ec.shouldRecreate(i)&&(this.cursorConfig=new ec(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(t=>{try{let n=this._eventDispatcher.beginEmitViewEvents(),o=!1,s=!1,a=t instanceof du?t.rawContentChangedEvent.changes:t.changes,l=t instanceof du?t.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let p of a)switch(p.changeType){case 4:{for(let m=0;m<p.detail.length;m++){let f=p.detail[m],g=p.injectedTexts[m];g&&(g=g.filter(b=>!b.ownerId||b.ownerId===this._editorId)),d.addRequest(f,g,null)}break}case 2:{let m=null;p.injectedText&&(m=p.injectedText.filter(f=>!f.ownerId||f.ownerId===this._editorId)),d.addRequest(p.detail,m,null);break}}let c=d.finalize(),u=new Do(c);for(let p of a)switch(p.changeType){case 1:{this._lines.onModelFlushed(),n.emitViewEvent(new ch),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),o=!0;break}case 3:{let m=this._lines.onModelLinesDeleted(l,p.fromLineNumber,p.toLineNumber);m!==null&&(n.emitViewEvent(m),this.viewLayout.onLinesDeleted(m.fromLineNumber,m.toLineNumber)),o=!0;break}case 4:{let m=u.takeCount(p.detail.length),f=this._lines.onModelLinesInserted(l,p.fromLineNumber,p.toLineNumber,m);f!==null&&(n.emitViewEvent(f),this.viewLayout.onLinesInserted(f.fromLineNumber,f.toLineNumber)),o=!0;break}case 2:{let m=u.dequeue(),[f,g,b,v]=this._lines.onModelLineChanged(l,p.lineNumber,m);s=f,g&&n.emitViewEvent(g),b&&(n.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),v&&(n.emitViewEvent(v),this.viewLayout.onLinesDeleted(v.fromLineNumber,v.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!o&&s&&(n.emitViewEvent(new uh),n.emitViewEvent(new Yl(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let i=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&i){let n=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(n){let o=this.coordinatesConverter.convertModelPositionToViewPosition(n.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let n=this._eventDispatcher.beginEmitViewEvents();t instanceof du&&n.emitOutgoingEvent(new $L(t.contentChangedEvent)),this._cursor.onModelContentChanged(n,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(t=>{let i=[];for(let n=0,o=t.ranges.length;n<o;n++){let s=t.ranges[n],a=this.coordinatesConverter.convertModelPositionToViewPosition(new F(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new F(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;i[n]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new PT(i)),this._eventDispatcher.emitOutgoingEvent(new ZL(t))})),this._register(this.model.onDidChangeLanguageConfiguration(t=>{this._eventDispatcher.emitSingleViewEvent(new AT),this.cursorConfig=new ec(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new qL(t))})),this._register(this.model.onDidChangeLanguage(t=>{this.cursorConfig=new ec(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new jL(t))})),this._register(this.model.onDidChangeOptions(t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let i=this._eventDispatcher.beginEmitViewEvents();i.emitViewEvent(new ch),i.emitViewEvent(new uh),i.emitViewEvent(new Yl(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new ec(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new YL(t))})),this._register(this.model.onDidChangeDecorations(t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Yl(t)),this._eventDispatcher.emitOutgoingEvent(new GL(t))}))}hiddenAreasModel=new nB;previousHiddenAreas=[];setHiddenAreas(t,i){this.hiddenAreasModel.setHiddenAreas(i,t);let n=this.hiddenAreasModel.getMergedRanges();if(n===this.previousHiddenAreas)return;this.previousHiddenAreas=n;let o=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(n),s&&(a.emitViewEvent(new ch),a.emitViewEvent(new uh),a.emitViewEvent(new Yl(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=o.viewportStartModelPosition?.lineNumber;l&&n.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||o.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new UL)}getVisibleRangesPlusViewportAboveBelow(){let t=this._configuration.options.get(147),i=this._configuration.options.get(68),n=Math.max(20,Math.round(t.height/i)),o=this.viewLayout.getLinesViewportData(),s=Math.max(1,o.completelyVisibleStartLineNumber-n),a=Math.min(this.getLineCount(),o.completelyVisibleEndLineNumber+n);return this._toModelVisibleRanges(new O(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){let i=this.coordinatesConverter.convertViewRangeToModelRange(t),n=this._lines.getHiddenAreas();if(n.length===0)return[i];let o=[],s=0,a=i.startLineNumber,l=i.startColumn,d=i.endLineNumber,c=i.endColumn;for(let u=0,p=n.length;u<p;u++){let m=n[u].startLineNumber,f=n[u].endLineNumber;f<a||m>d||(a<m&&(o[s++]=new O(a,l,m-1,this.model.getLineMaxColumn(m-1))),a=f+1,l=1)}return(a<d||a===d&&l<c)&&(o[s++]=new O(a,l,d,c)),o}getCompletelyVisibleViewRange(){let t=this.viewLayout.getLinesViewportData(),i=t.completelyVisibleStartLineNumber,n=t.completelyVisibleEndLineNumber;return new O(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}getCompletelyVisibleViewRangeAtScrollTop(t){let i=this.viewLayout.getLinesViewportDataAtScrollTop(t),n=i.completelyVisibleStartLineNumber,o=i.completelyVisibleEndLineNumber;return new O(n,this.getLineMinColumn(n),o,this.getLineMaxColumn(o))}saveState(){let t=this.viewLayout.saveState(),i=t.scrollTop,n=this.viewLayout.getLineNumberAtVerticalOffset(i),o=this.coordinatesConverter.convertViewPositionToModelPosition(new F(n,this.getLineMinColumn(n))),s=this.viewLayout.getVerticalOffsetForLineNumber(n)-i;return{scrollLeft:t.scrollLeft,firstPosition:o,firstPositionDeltaTop:s}}reduceRestoreState(t){if(typeof t.firstPosition>"u")return this._reduceRestoreStateCompatibility(t);let i=this.model.validatePosition(t.firstPosition),n=this.coordinatesConverter.convertModelPositionToViewPosition(i),o=this.viewLayout.getVerticalOffsetForLineNumber(n.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:o}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,i,n){this._viewportStart.update(this,t)}getActiveIndentGuide(t,i,n){return this._lines.getActiveIndentGuide(t,i,n)}getLinesIndentGuides(t,i){return this._lines.getViewLinesIndentGuides(t,i)}getBracketGuidesInRangeByLine(t,i,n,o){return this._lines.getViewLinesBracketGuides(t,i,n,o)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){let i=qi(this.getLineContent(t));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(t){let i=fs(this.getLineContent(t));return i===-1?0:i+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,i){let o=this._decorations.getDecorationsViewportData(t).inlineDecorations[i-t.startLineNumber];return this._getViewLineRenderingData(i,o)}getViewLineRenderingData(t){let i=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,i)}_getViewLineRenderingData(t,i){let n=this.model.mightContainRTL(),o=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(t);return a.inlineDecorations&&(i=[...i,...a.inlineDecorations.map(l=>l.toInlineDecoration(t))]),new Zl(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,n,o,a.tokens,i,s,a.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,i,n){let o=this._lines.getViewLinesData(t,i,n);return new BT(this.getTabSize(),o)}getAllOverviewRulerDecorations(t){let i=this.model.getOverviewRulerDecorations(this._editorId,Gp(this._configuration.options)),n=new iB;for(let o of i){let s=o.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(t.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(o.range.startLineNumber,o.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(o.range.endLineNumber,o.range.endColumn);n.accept(d,s.zIndex,c,u,l)}return n.asArray}_invalidateDecorationsColorCache(){let t=this.model.getOverviewRulerDecorations();for(let i of t)i.options.overviewRuler?.invalidateCachedColor(),i.options.minimap?.invalidateCachedColor()}getValueInRange(t,i){let n=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(n,i)}getValueLengthInRange(t,i){let n=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(n,i)}modifyPosition(t,i){let n=this.coordinatesConverter.convertViewPositionToModelPosition(t),o=this.model.modifyPosition(n,i);return this.coordinatesConverter.convertModelPositionToViewPosition(o)}deduceModelPositionRelativeToViewPosition(t,i,n){let o=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(i<0?i-=n:i+=n);let a=this.model.getOffsetAt(o)+i;return this.model.getPositionAt(a)}getPlainTextToCopy(t,i,n){let o=n?`\r
`:this.model.getEOL();t=t.slice(0),t.sort(O.compareRangesUsingStarts);let s=!1,a=!1;for(let d of t)d.isEmpty()?s=!0:a=!0;if(!a){if(!i)return"";let d=t.map(u=>u.startLineNumber),c="";for(let u=0;u<d.length;u++)u>0&&d[u-1]===d[u]||(c+=this.model.getLineContent(d[u])+o);return c}if(s&&i){let d=[],c=0;for(let u of t){let p=u.startLineNumber;u.isEmpty()?p!==c&&d.push(this.model.getLineContent(p)):d.push(this.model.getValueInRange(u,n?2:0)),c=p}return d.length===1?d[0]:d}let l=[];for(let d of t)d.isEmpty()||l.push(this.model.getValueInRange(d,n?2:0));return l.length===1?l[0]:l}getRichTextToCopy(t,i){let n=this.model.getLanguageId();if(n===xr||t.length!==1)return null;let o=t[0];if(o.isEmpty()){if(!i)return null;let u=o.startLineNumber;o=new O(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===Sr.fontFamily,c;return d?c=Sr.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${Sr.fontFamily}`),{mode:n,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(o,a)+"</div>"}}_getHTMLToCopy(t,i){let n=t.startLineNumber,o=t.startColumn,s=t.endLineNumber,a=t.endColumn,l=this.getTabSize(),d="";for(let c=n;c<=s;c++){let u=this.model.tokenization.getLineTokens(c),p=u.getLineContent(),m=c===n?o-1:0,f=c===s?a-1:p.length;p===""?d+="<br>":d+=q9(p,u.inflate(),i,m,f,l,dt)}return d}_getColorMap(){let t=Qr.getColorMap(),i=["#000000"];if(t)for(let n=1,o=t.length;n<o;n++)i[n]=U.Format.CSS.formatHex(t[n]);return i}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,i,n){return this._withViewEventsCollector(o=>this._cursor.setStates(o,t,i,n))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,i,n=0){this._withViewEventsCollector(o=>this._cursor.setSelections(o,t,i,n))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector(i=>this._cursor.restoreState(i,t))}_executeCursorEdit(t){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new KL);return}this._withViewEventsCollector(t)}executeEdits(t,i,n){this._executeCursorEdit(o=>this._cursor.executeEdits(o,t,i,n))}startComposition(){this._executeCursorEdit(t=>this._cursor.startComposition(t))}endComposition(t){this._executeCursorEdit(i=>this._cursor.endComposition(i,t))}type(t,i){this._executeCursorEdit(n=>this._cursor.type(n,t,i))}compositionType(t,i,n,o,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,t,i,n,o,s))}paste(t,i,n,o){this._executeCursorEdit(s=>this._cursor.paste(s,t,i,n,o))}cut(t){this._executeCursorEdit(i=>this._cursor.cut(i,t))}executeCommand(t,i){this._executeCursorEdit(n=>this._cursor.executeCommand(n,t,i))}executeCommands(t,i){this._executeCursorEdit(n=>this._cursor.executeCommands(n,t,i))}revealAllCursors(t,i,n=!1){this._withViewEventsCollector(o=>this._cursor.revealAll(o,t,n,0,i,0))}revealPrimaryCursor(t,i,n=!1){this._withViewEventsCollector(o=>this._cursor.revealPrimary(o,t,n,0,i,0))}revealTopMostCursor(t){let i=this._cursor.getTopMostViewPosition(),n=new O(i.lineNumber,i.column,i.lineNumber,i.column);this._withViewEventsCollector(o=>o.emitViewEvent(new tc(t,!1,n,null,0,!0,0)))}revealBottomMostCursor(t){let i=this._cursor.getBottomMostViewPosition(),n=new O(i.lineNumber,i.column,i.lineNumber,i.column);this._withViewEventsCollector(o=>o.emitViewEvent(new tc(t,!1,n,null,0,!0,0)))}revealRange(t,i,n,o,s){this._withViewEventsCollector(a=>a.emitViewEvent(new tc(t,!1,n,null,o,i,s)))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new FT),this._eventDispatcher.emitOutgoingEvent(new HL))}_withViewEventsCollector(t){return this._transactionalTarget.batchChanges(()=>{try{let i=this._eventDispatcher.beginEmitViewEvents();return t(i)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(t){this._withViewEventsCollector(()=>{t()})}normalizePosition(t,i){return this._lines.normalizePosition(t,i)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}},tB=class r{constructor(e,t,i,n,o){this._model=e;this._viewLineNumber=t;this._isValid=i;this._modelTrackedRange=n;this._startLineDelta=o}static create(e){let t=e._setTrackedRange(null,new O(1,1,1,1),1);return new r(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){let i=e.coordinatesConverter.convertViewPositionToModelPosition(new F(t,e.getLineMinColumn(t))),n=e.model._setTrackedRange(this._modelTrackedRange,new O(i.lineNumber,i.column,i.lineNumber,i.column),1),o=e.viewLayout.getVerticalOffsetForLineNumber(t),s=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=s-o}invalidate(){this._isValid=!1}},iB=class{_asMap=Object.create(null);asArray=[];accept(e,t,i,n,o){let s=this._asMap[e];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===o&&d+1>=i){n>d&&(a[a.length-1]=n);return}a.push(o,i,n)}else{let a=new hh(e,t,[o,i,n]);this._asMap[e]=a,this.asArray.push(a)}}},nB=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(e,t){let i=this.hiddenAreas.get(e);i&&Z9(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>xQ(t,i),[]);return Z9(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}};function xQ(r,e){let t=[],i=0,n=0;for(;i<r.length&&n<e.length;){let o=r[i],s=e[n];if(o.endLineNumber<s.startLineNumber-1)t.push(r[i++]);else if(s.endLineNumber<o.startLineNumber-1)t.push(e[n++]);else{let a=Math.min(o.startLineNumber,s.startLineNumber),l=Math.max(o.endLineNumber,s.endLineNumber);t.push(new O(a,1,l,1)),i++,n++}}for(;i<r.length;)t.push(r[i++]);for(;n<e.length;)t.push(e[n++]);return t}function Z9(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].equalsRange(e[t]))return!1;return!0}var pk=class{constructor(e,t){this.viewportStartModelPosition=e;this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;let i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:n+this.startLineDelta},1)}};var da=class extends P{constructor(t,i,n,o,s,a,l,d,c,u,p,m){super();this.languageConfigurationService=p;s.willCreateCodeEditor();let f={...i};this._domElement=t,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++TQ,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=n.telemetryData,this._configuration=this._register(this._createConfiguration(n.isSimpleWidget||!1,n.contextMenuId??(n.isSimpleWidget?nt.SimpleEditorContext:nt.EditorContext),f,u)),this._register(this._configuration.onDidChange(v=>{this._onDidChangeConfiguration.fire(v);let I=this._configuration.options;if(v.hasChanged(147)){let w=I.get(147);this._onDidLayoutChange.fire(w)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new sB(this,this._contextKeyService)),this._register(new aB(this,this._contextKeyService,m)),this._instantiationService=this._register(o.createChild(new ws([je,this._contextKeyService]))),this._modelData=null,this._focusTracker=new lB(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let g;Array.isArray(n.contributions)?g=n.contributions:g=_h.getEditorContributions(),this._contributions.initialize(this,g,this._instantiationService);for(let v of _h.getEditorActions()){if(this._actions.has(v.id)){Ge(new Error(`Cannot have two actions with the same id ${v.id}`));continue}let I=new PL(v.id,v.label,v.alias,v.metadata,v.precondition??void 0,w=>this._instantiationService.invokeFunction(E=>Promise.resolve(v.runEditorCommand(E,this,w))),this._contextKeyService);this._actions.set(I.id,I)}let b=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new zr(this._domElement,{onDragOver:v=>{if(!b())return;let I=this.getTargetAtClientPoint(v.clientX,v.clientY);I?.position&&this.showDropIndicatorAt(I.position)},onDrop:async v=>{if(!b()||(this.removeDropIndicator(),!v.dataTransfer))return;let I=this.getTargetAtClientPoint(v.clientX,v.clientY);I?.position&&this._onDropIntoEditor.fire({position:I.position,event:v})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=Qi.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=WW();_contributions=this._register(new OL);_onDidDispose=this._register(new _);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new _({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new to(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new hk({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new hk({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new to(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new to(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new to(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new to(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new to(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new to(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new to(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new to(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new to(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new to(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new to(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new to(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new to(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new to(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new to(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new to(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new to(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new _({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new _);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new _);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(t){this._modelData?.view.writeScreenReaderContent(t)}_createConfiguration(t,i,n,o){return new Jg(t,i,n,this._domElement,o)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return Py.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?Pf.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),t):null}getValue(t=null){if(!this._modelData)return"";let i=!!(t&&t.preserveBOM),n=0;return t&&t.lineEnding&&t.lineEnding===`
`?n=1:t&&t.lineEnding&&t.lineEnding===`\r
`&&(n=2),this._modelData.model.getValue(n,i)}setValue(t){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(t)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){try{this._beginUpdate();let i=t;if(this._modelData===null&&i===null||this._modelData&&this._modelData.model===i)return;let n={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:i?.uri||null};this._onWillChangeModel.fire(n);let o=this.hasTextFocus(),s=this._detachModel();this._attachModel(i),o&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let t in this._decorationTypeSubtypes){let i=this._decorationTypeSubtypes[t];for(let n in i)this._removeDecorationType(t+"-"+n)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,i,n,o){let s=t.model.validatePosition({lineNumber:i,column:n}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,o)}getTopForLineNumber(t,i=!1){return this._modelData?da._getVerticalOffsetForPosition(this._modelData,t,1,i):-1}getTopForPosition(t,i){return this._modelData?da._getVerticalOffsetForPosition(this._modelData,t,i,!1):-1}static _getVerticalOffsetForPosition(t,i,n,o=!1){let s=t.model.validatePosition({lineNumber:i,column:n}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,o)}getBottomForLineNumber(t,i=!1){if(!this._modelData)return-1;let n=this._modelData.model.getLineMaxColumn(t);return da._getVerticalOffsetAfterPosition(this._modelData,t,n,i)}setHiddenAreas(t,i){this._modelData?.viewModel.setHiddenAreas(t.map(n=>O.lift(n)),i)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;let i=this._modelData.model.validatePosition(t),n=this._modelData.model.getOptions().tabSize;return oi.visibleColumnFromColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,n)+1}getStatusbarColumn(t){if(!this._modelData)return t.column;let i=this._modelData.model.validatePosition(t),n=this._modelData.model.getOptions().tabSize;return oi.toStatusbarColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,n)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,i="api"){if(this._modelData){if(!F.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,i,n,o){if(!this._modelData)return;if(!O.isIRange(t))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(t),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",n,a,i,o)}revealLine(t,i=0){this._revealLine(t,0,i)}revealLineInCenter(t,i=0){this._revealLine(t,1,i)}revealLineInCenterIfOutsideViewport(t,i=0){this._revealLine(t,2,i)}revealLineNearTop(t,i=0){this._revealLine(t,5,i)}_revealLine(t,i,n){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new O(t,1,t,1),i,!1,n)}revealPosition(t,i=0){this._revealPosition(t,0,!0,i)}revealPositionInCenter(t,i=0){this._revealPosition(t,1,!0,i)}revealPositionInCenterIfOutsideViewport(t,i=0){this._revealPosition(t,2,!0,i)}revealPositionNearTop(t,i=0){this._revealPosition(t,5,!0,i)}_revealPosition(t,i,n,o){if(!F.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new O(t.lineNumber,t.column,t.lineNumber,t.column),i,n,o)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,i="api"){let n=tt.isISelection(t),o=O.isIRange(t);if(!n&&!o)throw new Error("Invalid arguments");if(n)this._setSelectionImpl(t,i);else if(o){let s={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(s,i)}}_setSelectionImpl(t,i){if(!this._modelData)return;let n=new tt(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(i,[n])}revealLines(t,i,n=0){this._revealLines(t,i,0,n)}revealLinesInCenter(t,i,n=0){this._revealLines(t,i,1,n)}revealLinesInCenterIfOutsideViewport(t,i,n=0){this._revealLines(t,i,2,n)}revealLinesNearTop(t,i,n=0){this._revealLines(t,i,5,n)}_revealLines(t,i,n,o){if(typeof t!="number"||typeof i!="number")throw new Error("Invalid arguments");this._sendRevealRange(new O(t,1,i,1),n,!1,o)}revealRange(t,i=0,n=!1,o=!0){this._revealRange(t,n?1:0,o,i)}revealRangeInCenter(t,i=0){this._revealRange(t,1,!0,i)}revealRangeInCenterIfOutsideViewport(t,i=0){this._revealRange(t,2,!0,i)}revealRangeNearTop(t,i=0){this._revealRange(t,5,!0,i)}revealRangeNearTopIfOutsideViewport(t,i=0){this._revealRange(t,6,!0,i)}revealRangeAtTop(t,i=0){this._revealRange(t,3,!0,i)}_revealRange(t,i,n,o){if(!O.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(O.lift(t),i,n,o)}setSelections(t,i="api",n=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let o=0,s=t.length;o<s;o++)if(!tt.isISelection(t[o]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,t,n)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,i=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},i)}}setScrollTop(t,i=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},i)}}setScrollPosition(t,i=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,i)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let t=this._contributions.saveViewState(),i=this._modelData.viewModel.saveCursorState(),n=this._modelData.viewModel.saveState();return{cursorState:i,viewState:n,contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;let i=t;if(i&&i.cursorState&&i.viewState){let n=i.cursorState;Array.isArray(n)?n.length>0&&this._modelData.viewModel.restoreCursorState(n):this._modelData.viewModel.restoreCursorState([n]),this._contributions.restoreViewState(i.contributionsState||{});let o=this._modelData.viewModel.reduceRestoreState(i.viewState);this._modelData.view.restoreState(o)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter(i=>i.isSupported()),t}getAction(t){return this._actions.get(t)||null}trigger(t,i,n){n=n||{};try{switch(this._beginUpdate(),i){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(t);return;case"type":{let s=n;this._type(t,s.text||"");return}case"replacePreviousChar":{let s=n;this._compositionType(t,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=n;this._compositionType(t,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=n;this._paste(t,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(t);return}let o=this.getAction(i);if(o){Promise.resolve(o.run(n)).then(void 0,Ge);return}if(!this._modelData||this._triggerEditorCommand(t,i,n))return;this._triggerCommand(i,n)}finally{this._endUpdate()}}_triggerCommand(t,i){this._commandService.executeCommand(t,i)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,i){!this._modelData||i.length===0||(t==="keyboard"&&this._onWillType.fire(i),this._modelData.viewModel.type(i,t),t==="keyboard"&&this._onDidType.fire(i))}_compositionType(t,i,n,o,s){this._modelData&&this._modelData.viewModel.compositionType(i,n,o,s,t)}_paste(t,i,n,o,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(i,n,o,t);let c=l.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new O(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,i,n){let o=_h.getEditorCommand(i);return o?(n=n||{},n.source=t,this._instantiationService.invokeFunction(s=>{Promise.resolve(o.runEditorCommand(s,this,n)).then(void 0,Ge)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(t,i,n){if(!this._modelData||this._configuration.options.get(93))return!1;let o;return n?Array.isArray(n)?o=()=>n:o=n:o=()=>null,this._modelData.viewModel.executeEdits(t,i,o),!0}executeCommand(t,i){this._modelData&&this._modelData.viewModel.executeCommand(i,t)}executeCommands(t,i){this._modelData&&this._modelData.viewModel.executeCommands(i,t)}createDecorationsCollection(t){return new dB(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,Gp(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,Gp(this._configuration.options)):null}deltaDecorations(t,i){return this._modelData?t.length===0&&i.length===0?t:this._modelData.model.deltaDecorations(t,i,this._id):[]}removeDecorations(t){!this._modelData||t.length===0||this._modelData.model.changeDecorations(i=>{i.deltaDecorations(t,[])})}setDecorationsByType(t,i,n){let o={},s=this._decorationTypeSubtypes[i]||{};this._decorationTypeSubtypes[i]=o;let a=[];for(let d of n){let c=i;if(d.renderOptions){let p=Ur(d.renderOptions).toString(16);c=i+"-"+p,!s[p]&&!o[p]&&this._registerDecorationType(t,c,d.renderOptions,i),o[p]=!0}let u=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(u.hoverMessage=d.hoverMessage),a.push({range:d.range,options:u})}for(let d in s)o[d]||this._removeDecorationType(i+"-"+d);let l=this._decorationTypeKeysToIds[i]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[i]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(t,i){let n=this._decorationTypeSubtypes[t]||{};for(let l in n)this._removeDecorationType(t+"-"+l);this._decorationTypeSubtypes[t]={};let o=Qi.createDynamic(this._resolveDecorationOptions(t,!1)),s=new Array(i.length);for(let l=0,d=i.length;l<d;l++)s[l]={range:i[l],options:o};let a=this._decorationTypeKeysToIds[t]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[t]=l.deltaDecorations(a,s))}removeDecorationsByType(t){let i=this._decorationTypeKeysToIds[t];i&&this.changeDecorations(n=>n.deltaDecorations(i,[])),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(t)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,i=!1){this._configuration.observeContainer(t),i||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){let i={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(i)}layoutContentWidget(t){let i=t.getId();if(this._contentWidgets.hasOwnProperty(i)){let n=this._contentWidgets[i];n.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(n)}}removeContentWidget(t){let i=t.getId();if(this._contentWidgets.hasOwnProperty(i)){let n=this._contentWidgets[i];delete this._contentWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(n)}}addOverlayWidget(t){let i={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(i)}layoutOverlayWidget(t){let i=t.getId();if(this._overlayWidgets.hasOwnProperty(i)){let n=this._overlayWidgets[i];n.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(n)}}removeOverlayWidget(t){let i=t.getId();if(this._overlayWidgets.hasOwnProperty(i)){let n=this._overlayWidgets[i];delete this._overlayWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(n)}}addGlyphMarginWidget(t){let i={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(i)}layoutGlyphMarginWidget(t){let i=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){let n=this._glyphMarginWidgets[i];n.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(n)}}removeGlyphMarginWidget(t){let i=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){let n=this._glyphMarginWidgets[i];delete this._glyphMarginWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(n)}}changeViewZones(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(t)}getTargetAtClientPoint(t,i){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(t,i)}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;let i=this._modelData.model.validatePosition(t),n=this._configuration.options,o=n.get(147),s=da._getVerticalOffsetForPosition(this._modelData,i.lineNumber,i.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(i.lineNumber,i.column)+o.glyphMarginWidth+o.lineNumbersWidth+o.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:n.get(68)}}getOffsetForColumn(t,i){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(t,i)}render(t=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,t)})}setAriaOptions(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(t)}applyFontInfo(t){Ti(t,this._configuration.options.get(51))}setBanner(t,i){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=t,this._configuration.setReservedHeight(t?i:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t){this._modelData=null;return}let i=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());let n=t.onBeforeAttached(),o=new uk(this._id,this._configuration,t,ML.create(pe(this._domElement)),NL.create(this._configuration.options),l=>Yi(pe(this._domElement),l),this.languageConfigurationService,this._themeService,n,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});i.push(t.onWillDispose(()=>this.setModel(null))),i.push(o.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let p=this.getOption(81),m=h("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",p);this._notificationService.prompt(As.Warning,m,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:h("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let p=0,m=l.selections.length;p<m;p++)d[p]=l.selections[p].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let u={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(o);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addContentWidget(this._contentWidgets[u])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addOverlayWidget(this._overlayWidgets[u])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[u])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new rB(t,o,s,a,i,n)}_createView(t){let i;this.isSimpleWidget?i={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:i={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let n=new Uf(t.coordinatesConverter);return n.onKeyDown=s=>this._onKeyDown.fire(s),n.onKeyUp=s=>this._onKeyUp.fire(s),n.onContextMenu=s=>this._onContextMenu.fire(s),n.onMouseMove=s=>this._onMouseMove.fire(s),n.onMouseLeave=s=>this._onMouseLeave.fire(s),n.onMouseDown=s=>this._onMouseDown.fire(s),n.onMouseUp=s=>this._onMouseUp.fire(s),n.onMouseDrag=s=>this._onMouseDrag.fire(s),n.onMouseDrop=s=>this._onMouseDrop.fire(s),n.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),n.onMouseWheel=s=>this._onMouseWheel.fire(s),[new ib(i,this._configuration,this._themeService.getColorTheme(),t,n,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let t=this._modelData.model,i=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),i&&this._domElement.contains(i)&&i.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),t}_registerDecorationType(t,i,n,o){this._codeEditorService.registerDecorationType(t,i,n,o,this)}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}_resolveDecorationOptions(t,i){return this._codeEditorService.resolveDecorationOptions(t,i)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){let i=[{range:new O(t.lineNumber,t.column,t.lineNumber,t.column),options:da.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(i),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,i){this._contextKeyService.createKey(t,i)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};da=R([y(3,ve),y(4,sd),y(5,Ui),y(6,je),y(7,kt),y(8,Bo),y(9,dr),y(10,zd),y(11,K9)],da);var TQ=0,rB=class{constructor(e,t,i,n,o,s){this.model=e;this.viewModel=t;this.view=i;this.hasRealView=n;this.listenersToRemove=o;this.attachedView=s}dispose(){ht(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var hk=class extends P{constructor(t){super();this._emitterOptions=t;this._value=0}_onDidChangeToTrue=this._register(new _(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new _(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(t){let i=t?2:1;this._value!==i&&(this._value=i,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},to=class extends _{constructor(t,i){super({deliveryQueue:i});this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}},sB=class extends P{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=Se.editorSimpleInput.bindTo(t),this._editorFocus=Se.focus.bindTo(t),this._textInputFocus=Se.textInputFocus.bindTo(t),this._editorTextFocus=Se.editorTextFocus.bindTo(t),this._tabMovesFocus=Se.tabMovesFocus.bindTo(t),this._editorReadonly=Se.readOnly.bindTo(t),this._inDiffEditor=Se.inDiffEditor.bindTo(t),this._editorColumnSelection=Se.columnSelection.bindTo(t),this._hasMultipleSelections=Se.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=Se.hasNonEmptySelection.bindTo(t),this._canUndo=Se.canUndo.bindTo(t),this._canRedo=Se.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(Qg.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let e=this._editor.getOptions();this._tabMovesFocus.set(Qg.getTabFocusMode()),this._editorReadonly.set(e.get(93)),this._inDiffEditor.set(e.get(62)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){let e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}},aB=class extends P{constructor(t,i,n){super();this._editor=t;this._contextKeyService=i;this._languageFeaturesService=n;this._langId=Se.languageId.bindTo(i),this._hasCompletionItemProvider=Se.hasCompletionItemProvider.bindTo(i),this._hasCodeActionsProvider=Se.hasCodeActionsProvider.bindTo(i),this._hasCodeLensProvider=Se.hasCodeLensProvider.bindTo(i),this._hasDefinitionProvider=Se.hasDefinitionProvider.bindTo(i),this._hasDeclarationProvider=Se.hasDeclarationProvider.bindTo(i),this._hasImplementationProvider=Se.hasImplementationProvider.bindTo(i),this._hasTypeDefinitionProvider=Se.hasTypeDefinitionProvider.bindTo(i),this._hasHoverProvider=Se.hasHoverProvider.bindTo(i),this._hasDocumentHighlightProvider=Se.hasDocumentHighlightProvider.bindTo(i),this._hasDocumentSymbolProvider=Se.hasDocumentSymbolProvider.bindTo(i),this._hasReferenceProvider=Se.hasReferenceProvider.bindTo(i),this._hasRenameProvider=Se.hasRenameProvider.bindTo(i),this._hasSignatureHelpProvider=Se.hasSignatureHelpProvider.bindTo(i),this._hasInlayHintsProvider=Se.hasInlayHintsProvider.bindTo(i),this._hasDocumentFormattingProvider=Se.hasDocumentFormattingProvider.bindTo(i),this._hasDocumentSelectionFormattingProvider=Se.hasDocumentSelectionFormattingProvider.bindTo(i),this._hasMultipleDocumentFormattingProvider=Se.hasMultipleDocumentFormattingProvider.bindTo(i),this._hasMultipleDocumentSelectionFormattingProvider=Se.hasMultipleDocumentSelectionFormattingProvider.bindTo(i),this._isInEmbeddedEditor=Se.isInEmbeddedEditor.bindTo(i);let o=()=>this._update();this._register(t.onDidChangeModel(o)),this._register(t.onDidChangeModelLanguage(o)),this._register(n.completionProvider.onDidChange(o)),this._register(n.codeActionProvider.onDidChange(o)),this._register(n.codeLensProvider.onDidChange(o)),this._register(n.definitionProvider.onDidChange(o)),this._register(n.declarationProvider.onDidChange(o)),this._register(n.implementationProvider.onDidChange(o)),this._register(n.typeDefinitionProvider.onDidChange(o)),this._register(n.hoverProvider.onDidChange(o)),this._register(n.documentHighlightProvider.onDidChange(o)),this._register(n.documentSymbolProvider.onDidChange(o)),this._register(n.referenceProvider.onDidChange(o)),this._register(n.renameProvider.onDidChange(o)),this._register(n.documentFormattingEditProvider.onDidChange(o)),this._register(n.documentRangeFormattingEditProvider.onDidChange(o)),this._register(n.signatureHelpProvider.onDidChange(o)),this._register(n.inlayHintsProvider.onDidChange(o)),o()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let t=this._editor.getModel();if(!t){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===ue.walkThroughSnippet||t.uri.scheme===ue.vscodeChatCodeBlock)})}},lB=class extends P{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new _);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(e,t){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Mn(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(Mn(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},dB=class{constructor(e,t){this._editor=e;Array.isArray(t)&&t.length>0&&this.set(t)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||e.call(t,n)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];let e=this._editor.getModel(),t=[];for(let i of this._decorationIds){let n=e.getDecorationRange(i);n&&t.push(n)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{t=i.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}},_Q=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),DQ=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function oB(r){return _Q+encodeURIComponent(r.toString())+DQ}var LQ=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),kQ=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function RQ(r){return LQ+encodeURIComponent(r.toString())+kQ}Fo((r,e)=>{let t=r.getColor(Zp);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${oB(t)}") repeat-x bottom left; }`);let i=r.getColor(hr);i&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${oB(i)}") repeat-x bottom left; }`);let n=r.getColor(ts);n&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${oB(n)}") repeat-x bottom left; }`);let o=r.getColor(Dz);o&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${RQ(o)}") no-repeat bottom left; }`);let s=r.getColor(f4);s&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});function X9(r,e,t,i){if(r.length===0)return e;if(e.length===0)return r;let n=[],o=0,s=0;for(;o<r.length&&s<e.length;){let a=r[o],l=e[s],d=t(a),c=t(l);d<c?(n.push(a),o++):d>c?(n.push(l),s++):(n.push(i(a,l)),o++,s++)}for(;o<r.length;)n.push(r[o]),o++;for(;s<e.length;)n.push(e[s]),s++;return n}function nb(r,e){let t=new Y,i=r.createDecorationsCollection();return t.add(_d({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{let o=e.read(n);i.set(o)})),t.add({dispose:()=>{i.clear()}}),t}function jh(r,e){return r.appendChild(e),te(()=>{e.remove()})}function Q9(r,e){return r.prepend(e),te(()=>{e.remove()})}var mk=class extends P{elementSizeObserver;_width;get width(){return this._width}_height;get height(){return this._height}_automaticLayout=!1;get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this.elementSizeObserver=this._register(new Xg(e,t)),this._width=Ct(this,this.elementSizeObserver.getWidth()),this._height=Ct(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>mi(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}};function pB(r,e,t){let i=e.get(),n=i,o=i,s=Ct("animatedValue",i),a=-1,l=300,d;t.add(kc({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(u,p)=>(u.didChange(e)&&(p.animate=p.animate||u.change),!0)},(u,p)=>{d!==void 0&&(r.cancelAnimationFrame(d),d=void 0),n=o,i=e.read(u),a=Date.now()-(p.animate?0:l),c()}));function c(){let u=Date.now()-a;o=Math.floor(AQ(u,n,i-n,l)),u<l?d=r.requestAnimationFrame(c):o=i,s.set(o,void 0)}return s}function AQ(r,e,t,i){return r===i?e+t:t*(-Math.pow(2,-10*r/i)+1)+e}var Kh=class extends P{constructor(e,t,i){super(),this._register(new cB(e,i)),this._register(Ns(i,{height:t.actualHeight,top:t.actualTop}))}},dd=class{constructor(e,t){this._afterLineNumber=e;this.heightInPx=t}domNode=document.createElement("div");_actualTop=Ct(this,void 0);_actualHeight=Ct(this,void 0);actualTop=this._actualTop;actualHeight=this._actualHeight;showInHiddenAreas=!0;get afterLineNumber(){return this._afterLineNumber.get()}onChange=this._afterLineNumber;onDomNodeTop=e=>{this._actualTop.set(e,void 0)};onComputedHeight=e=>{this._actualHeight.set(e,void 0)}},cB=class r{constructor(e,t){this._editor=e;this._domElement=t;this._editor.addOverlayWidget(this._overlayWidget)}static _counter=0;_overlayWidgetId=`managedOverlayWidget-${r._counter++}`;_overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null};dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};function Ns(r,e){return yt(t=>{for(let[i,n]of Object.entries(e))n&&typeof n=="object"&&"read"in n&&(n=n.read(t)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,o=>"-"+o.toLowerCase()),r.style[i]=n})}function ob(r,e,t,i){let n=new Y,o=[];return n.add(oo((s,a)=>{let l=e.read(s),d=new Map,c=new Map;t&&t(!0),r.changeViewZones(u=>{for(let p of o)u.removeZone(p),i?.delete(p);o.length=0;for(let p of l){let m=u.addZone(p);p.setZoneId&&p.setZoneId(m),o.push(m),i?.add(m),d.set(p,m)}}),t&&t(!1),a.add(kc({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(u,p){let m=c.get(u.changedObservable);return m!==void 0&&p.zoneIds.push(m),!0}},(u,p)=>{for(let m of l)m.onChange&&(c.set(m.onChange,d.get(m)),m.onChange.read(u));t&&t(!0),r.changeViewZones(m=>{for(let f of p.zoneIds)m.layoutZone(f)}),t&&t(!1)}))})),n.add({dispose(){t&&t(!0),r.changeViewZones(s=>{for(let a of o)s.removeZone(a)}),i?.clear(),t&&t(!1)}}),n}function hB(r,e){let t=lp(e,n=>n.original.startLineNumber<=r.lineNumber);if(!t)return O.fromPositions(r);if(t.original.endLineNumberExclusive<=r.lineNumber){let n=r.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return O.fromPositions(new F(n,r.column))}if(!t.innerChanges)return O.fromPositions(new F(t.modified.startLineNumber,1));let i=lp(t.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(r));if(!i){let n=r.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return O.fromPositions(new F(n,r.column))}if(i.originalRange.containsPosition(r))return i.modifiedRange;{let n=MQ(i.originalRange.getEndPosition(),r);return O.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function MQ(r,e){return r.lineNumber===e.lineNumber?new wr(0,e.column-r.column):new wr(e.lineNumber-r.lineNumber,e.column-1)}function J9(r,e){let t;return r.filter(i=>{let n=e(i,t);return t=i,n})}var Gh=class{static create(e,t=void 0){return new cC(e,e,t)}static createWithDisposable(e,t,i=void 0){let n=new Y;return n.add(t),n.add(e),new cC(e,n,i)}static createOfNonDisposable(e,t,i=void 0){return new cC(e,t,i)}},cC=class extends Gh{constructor(t,i,n){super();this.object=t;this._disposable=i;this._debugOwner=n;n&&this._addOwner(n)}_refCount=1;_isDisposed=!1;_owners=[];_addOwner(t){t&&this._owners.push(t)}createNewRef(t){return this._refCount++,t&&this._addOwner(t),new uB(this,t)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(t){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),t){let i=this._owners.indexOf(t);i!==-1&&this._owners.splice(i,1)}}},uB=class extends Gh{constructor(t,i){super();this._base=t;this._debugOwner=i}_isDisposed=!1;get object(){return this._base.object}createNewRef(t){return this._base.createNewRef(t)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}};function e3(r,e,t){return _W({debugName:()=>`Configuration Key "${r}"`},i=>t.onDidChangeConfiguration(n=>{n.affectsConfiguration(r)&&i(n)}),()=>t.getValue(r)??e)}function cd(r,e,t){let i=r.bindTo(e);return _d({debugName:()=>`Set Context Key "${r.key}"`},n=>{i.set(t(n))})}var fk=Z("accessibilitySignalService"),Rni=Symbol("AcknowledgeDocCommentsToken"),gk=class extends P{constructor(t,i,n){super();this.configurationService=t;this.accessibilityService=i;this.telemetryService=n}_serviceBrand;sounds=new Map;screenReaderAttached=zt(this,this.accessibilityService.onDidChangeScreenReaderOptimized,()=>this.accessibilityService.isScreenReaderOptimized());sentTelemetry=new Set;getEnabledState(t,i,n){return new _S(this._signalEnabledState.get({signal:t,userGesture:i,modality:n}))}async playSignal(t,i={}){let n=i.modality==="announcement"||i.modality===void 0,o=t.announcementMessage;n&&this.isAnnouncementEnabled(t,i.userGesture)&&o&&this.accessibilityService.status(o),(i.modality==="sound"||i.modality===void 0)&&this.isSoundEnabled(t,i.userGesture)&&(this.sendSignalTelemetry(t,i.source),await this.playSound(t.sound.getSound(),i.allowManyInParallel))}async playSignals(t){for(let s of t)this.sendSignalTelemetry("signal"in s?s.signal:s,"source"in s?s.source:void 0);let i=t.map(s=>"signal"in s?s.signal:s),n=i.filter(s=>this.isAnnouncementEnabled(s)).map(s=>s.announcementMessage);n.length&&this.accessibilityService.status(n.join(", "));let o=new Set(i.filter(s=>this.isSoundEnabled(s)).map(s=>s.sound.getSound()));await Promise.all(Array.from(o).map(s=>this.playSound(s,!0)))}sendSignalTelemetry(t,i){let n=this.accessibilityService.isScreenReaderOptimized(),o=t.name+(i?`::${i}`:"")+(n?"{screenReaderOptimized}":"");this.sentTelemetry.has(o)||this.getVolumeInPercent()===0||(this.sentTelemetry.add(o),this.telemetryService.publicLog2("signal.played",{signal:t.name,source:i??"",isScreenReaderOptimized:n}))}getVolumeInPercent(){let t=this.configurationService.getValue("accessibility.signalOptions.volume");return typeof t!="number"?50:Math.max(Math.min(t,100),0)}playingSounds=new Set;async playSound(t,i=!1){if(!i&&this.playingSounds.has(t))return;this.playingSounds.add(t);let n=Hr.asBrowserUri(`vs/platform/accessibilitySignal/browser/media/${t.fileName}`).toString(!0);try{let o=this.sounds.get(n);if(o)o.volume=this.getVolumeInPercent()/100,o.currentTime=0,await o.play();else{let s=await OQ(n,this.getVolumeInPercent()/100);this.sounds.set(n,s)}}catch(o){o.message.includes("play() can only be initiated by a user gesture")||console.error("Error while playing sound",o)}finally{this.playingSounds.delete(t)}}playSignalLoop(t,i){let n=!0,o=()=>{n&&this.playSignal(t,{allowManyInParallel:!0}).finally(()=>{setTimeout(()=>{n&&o()},i)})};return o(),te(()=>n=!1)}_signalConfigValue=new Oc(t=>e3(t.settingsKey,{sound:"off",announcement:"off"},this.configurationService));_signalEnabledState=new Oc({getCacheKey:CW},t=>We(i=>{let n=this._signalConfigValue.get(t.signal).read(i);return!!((t.modality==="sound"||t.modality===void 0)&&t3(n.sound,()=>this.screenReaderAttached.read(i),t.userGesture)||(t.modality==="announcement"||t.modality===void 0)&&t3(n.announcement,()=>this.screenReaderAttached.read(i),t.userGesture))}).recomputeInitiallyAndOnChange(this._store));isAnnouncementEnabled(t,i){return t.announcementMessage?this._signalEnabledState.get({signal:t,userGesture:!!i,modality:"announcement"}).get():!1}isSoundEnabled(t,i){return this._signalEnabledState.get({signal:t,userGesture:!!i,modality:"sound"}).get()}onSoundEnabledChanged(t){return this.getEnabledState(t,!1).onDidChange}getDelayMs(t,i,n){if(!this.configurationService.getValue("accessibility.signalOptions.debouncePositionChanges"))return 0;let o;return t.name===ls.errorAtPosition.name&&n==="positional"?o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.errorAtPosition"):t.name===ls.warningAtPosition.name&&n==="positional"?o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.warningAtPosition"):o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.general"),i==="sound"?o.sound:o.announcement}};gk=R([y(0,He),y(1,dr),y(2,jt)],gk);function t3(r,e,t){return r==="on"||r==="always"||r==="auto"&&e()||r==="userGesture"&&t}function OQ(r,e){return new Promise((t,i)=>{let n=new Audio(r);n.volume=e,n.addEventListener("ended",()=>{t(n)}),n.addEventListener("error",o=>{i(o.error)}),n.play().catch(o=>{i(o)})})}var ai=class r{constructor(e){this.fileName=e}static register(e){return new r(e.fileName)}static error=r.register({fileName:"error.mp3"});static warning=r.register({fileName:"warning.mp3"});static success=r.register({fileName:"success.mp3"});static foldedArea=r.register({fileName:"foldedAreas.mp3"});static break=r.register({fileName:"break.mp3"});static quickFixes=r.register({fileName:"quickFixes.mp3"});static taskCompleted=r.register({fileName:"taskCompleted.mp3"});static taskFailed=r.register({fileName:"taskFailed.mp3"});static terminalBell=r.register({fileName:"terminalBell.mp3"});static diffLineInserted=r.register({fileName:"diffLineInserted.mp3"});static diffLineDeleted=r.register({fileName:"diffLineDeleted.mp3"});static diffLineModified=r.register({fileName:"diffLineModified.mp3"});static chatRequestSent=r.register({fileName:"chatRequestSent.mp3"});static chatResponseReceived1=r.register({fileName:"chatResponseReceived1.mp3"});static chatResponseReceived2=r.register({fileName:"chatResponseReceived2.mp3"});static chatResponseReceived3=r.register({fileName:"chatResponseReceived3.mp3"});static chatResponseReceived4=r.register({fileName:"chatResponseReceived4.mp3"});static clear=r.register({fileName:"clear.mp3"});static save=r.register({fileName:"save.mp3"});static format=r.register({fileName:"format.mp3"});static voiceRecordingStarted=r.register({fileName:"voiceRecordingStarted.mp3"});static voiceRecordingStopped=r.register({fileName:"voiceRecordingStopped.mp3"});static progress=r.register({fileName:"progress.mp3"})},mB=class{constructor(e){this.randomOneOf=e}getSound(e=!1){if(e||this.randomOneOf.length===1)return this.randomOneOf[0];{let t=Math.floor(Math.random()*this.randomOneOf.length);return this.randomOneOf[t]}}},ls=class r{constructor(e,t,i,n,o,s){this.sound=e;this.name=t;this.legacySoundSettingsKey=i;this.settingsKey=n;this.legacyAnnouncementSettingsKey=o;this.announcementMessage=s}static _signals=new Set;static register(e){let t=new mB("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new r(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage);return r._signals.add(i),i}static get allAccessibilitySignals(){return[...this._signals]}static errorAtPosition=r.register({name:h("accessibilitySignals.positionHasError.name","Error at Position"),sound:ai.error,announcementMessage:h("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"});static warningAtPosition=r.register({name:h("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:ai.warning,announcementMessage:h("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"});static errorOnLine=r.register({name:h("accessibilitySignals.lineHasError.name","Error on Line"),sound:ai.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:h("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"});static warningOnLine=r.register({name:h("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:ai.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:h("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"});static foldedArea=r.register({name:h("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:ai.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:h("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"});static break=r.register({name:h("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:ai.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:h("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"});static inlineSuggestion=r.register({name:h("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:ai.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"});static terminalQuickFix=r.register({name:h("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:ai.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:h("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"});static onDebugBreak=r.register({name:h("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:ai.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:h("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"});static noInlayHints=r.register({name:h("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:ai.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:h("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"});static taskCompleted=r.register({name:h("accessibilitySignals.taskCompleted","Task Completed"),sound:ai.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:h("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"});static taskFailed=r.register({name:h("accessibilitySignals.taskFailed","Task Failed"),sound:ai.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:h("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"});static terminalCommandFailed=r.register({name:h("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:ai.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:h("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"});static terminalCommandSucceeded=r.register({name:h("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:ai.success,announcementMessage:h("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"});static terminalBell=r.register({name:h("accessibilitySignals.terminalBell","Terminal Bell"),sound:ai.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:h("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"});static notebookCellCompleted=r.register({name:h("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:ai.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:h("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"});static notebookCellFailed=r.register({name:h("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:ai.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:h("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"});static diffLineInserted=r.register({name:h("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:ai.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"});static diffLineDeleted=r.register({name:h("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:ai.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"});static diffLineModified=r.register({name:h("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:ai.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"});static chatRequestSent=r.register({name:h("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:ai.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:h("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"});static chatResponseReceived=r.register({name:h("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[ai.chatResponseReceived1,ai.chatResponseReceived2,ai.chatResponseReceived3,ai.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"});static progress=r.register({name:h("accessibilitySignals.progress","Progress"),sound:ai.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:h("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"});static clear=r.register({name:h("accessibilitySignals.clear","Clear"),sound:ai.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:h("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"});static save=r.register({name:h("accessibilitySignals.save","Save"),sound:ai.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:h("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"});static format=r.register({name:h("accessibilitySignals.format","Format"),sound:ai.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:h("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"});static voiceRecordingStarted=r.register({name:h("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:ai.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"});static voiceRecordingStopped=r.register({name:h("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:ai.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"})};function qh(r){return gB.get(r)}var gB=class r extends P{constructor(t){super();this.editor=t;this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(i=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(i=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}}))}static _map=new Map;static get(t){let i=r._map.get(t);if(!i){i=new r(t),r._map.set(t,i);let n=t.onDidDispose(()=>{let o=r._map.get(t);o&&(r._map.delete(t),o.dispose(),n.dispose())})}return i}_updateCounter=0;_currentTransaction=void 0;_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new Ac(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){let t=this._currentTransaction;this._currentTransaction=void 0,t.finish()}}forceUpdate(t){this._beginUpdate();try{return this._forceUpdate(),t?t(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}_model=Ct(this,this.editor.getModel());model=this._model;isReadonly=zt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(93));_versionId=kS({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null);versionId=this._versionId;_selections=kS({owner:this,equalsFn:SS(r0(tt.selectionsEqual)),lazy:!0},this.editor.getSelections()??null);selections=this._selections;positions=fl({owner:this,equalsFn:SS(r0(F.equals))},t=>this.selections.read(t)?.map(i=>i.getStartPosition())??null);isFocused=zt(this,t=>{let i=this.editor.onDidFocusEditorWidget(t),n=this.editor.onDidBlurEditorWidget(t);return{dispose(){i.dispose(),n.dispose()}}},()=>this.editor.hasWidgetFocus());value=um(this,t=>(this.versionId.read(t),this.model.read(t)?.getValue()??""),(t,i)=>{let n=this.model.get();n!==null&&t!==n.getValue()&&n.setValue(t)});valueIsEmpty=We(this,t=>(this.versionId.read(t),this.editor.getModel()?.getValueLength()===0));cursorSelection=fl({owner:this,equalsFn:SS(tt.selectionsEqual)},t=>this.selections.read(t)?.[0]??null);cursorPosition=fl({owner:this,equalsFn:F.equals},t=>this.selections.read(t)?.[0]?.getPosition()??null);onDidType=mp(this);scrollTop=zt(this.editor.onDidScrollChange,()=>this.editor.getScrollTop());scrollLeft=zt(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft());layoutInfo=zt(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo());layoutInfoContentLeft=this.layoutInfo.map(t=>t.contentLeft);layoutInfoDecorationsLeft=this.layoutInfo.map(t=>t.decorationsLeft);contentWidth=zt(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth());getOption(t){return zt(this,i=>this.editor.onDidChangeConfiguration(n=>{n.hasChanged(t)&&i(void 0)}),()=>this.editor.getOption(t))}setDecorations(t){let i=new Y,n=this.editor.createDecorationsCollection();return i.add(_d({owner:this,debugName:()=>`Apply decorations from ${t.debugName}`},o=>{let s=t.read(o);n.set(s)})),i.add({dispose:()=>{n.clear()}}),i}_overlayWidgetCounter=0;createOverlayWidget(t){let i="observableOverlayWidget"+this._overlayWidgetCounter++,n={getDomNode:()=>t.domNode,getPosition:()=>t.position.get(),getId:()=>i,allowEditorOverflow:t.allowEditorOverflow,getMinContentWidthInPx:()=>t.minContentWidthInPx.get()};this.editor.addOverlayWidget(n);let o=yt(s=>{t.position.read(s),t.minContentWidthInPx.read(s),this.editor.layoutOverlayWidget(n)});return te(()=>{o.dispose(),this.editor.removeOverlayWidget(n)})}};var Loi=new RegExp("\\bMARK:\\s*(.*)$","d");var i3=Z("editorWorkerService");var fB=Z("diffProviderFactoryService"),uC=class{constructor(e){this.instantiationService=e}_serviceBrand;createDiffProvider(e){return this.instantiationService.createInstance(tl,e)}};uC=R([y(0,ve)],uC);an(fB,uC,1);var tl=class{constructor(e,t,i){this.editorWorkerService=t;this.telemetryService=i;this.setOptions(e)}onDidChangeEventEmitter=new _;onDidChange=this.onDidChangeEventEmitter.event;diffAlgorithm="advanced";diffAlgorithmOnDidChangeSubscription=void 0;static diffCache=new Map;dispose(){this.diffAlgorithmOnDidChangeSubscription?.dispose()}async computeDiff(e,t,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,n);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new rs(new Fe(1,2),new Fe(1,t.getLineCount()+1),[new Qo(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};let o=JSON.stringify([e.uri.toString(),t.uri.toString()]),s=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=tl.diffCache.get(o);if(a&&a.context===s)return a.result;let l=Sa.create(),d=await this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),c=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:c,timedOut:d?.quitEarly??!0,detectedMoves:i.computeMoves?d?.moves.length??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!d)throw new Error("no diff result available");return tl.diffCache.size>10&&tl.diffCache.delete(tl.diffCache.keys().next().value),tl.diffCache.set(o,{result:d,context:s}),d}setOptions(e){let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription?.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}};tl=R([y(1,i3),y(2,jt)],tl);function vk(){return Ks&&!!Ks.VSCODE_DEV}function bB(r){if(vk()){let e=PQ();return e.add(r),{dispose(){e.delete(r)}}}else return{dispose(){}}}function PQ(){bk||(bk=new Set);let r=globalThis;return r.$hotReload_applyNewExports||(r.$hotReload_applyNewExports=e=>{let t={config:{mode:void 0},...e},i=[];for(let n of bk){let o=n(t);o&&i.push(o)}if(i.length>0)return n=>{let o=!1;for(let s of i)s(n)&&(o=!0);return o}}),bk}var bk;vk()&&bB(({oldExports:r,newSrc:e,config:t})=>{if(t.mode==="patch-prototype")return i=>{for(let n in i){let o=i[n];if(console.log(`[hot-reload] Patching prototype methods of '${n}'`,{exportedItem:o}),typeof o=="function"&&o.prototype){let s=r[n];if(s){for(let a of Object.getOwnPropertyNames(o.prototype)){let l=Object.getOwnPropertyDescriptor(o.prototype,a),d=Object.getOwnPropertyDescriptor(s.prototype,a);l?.value?.toString()!==d?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${n}.${a}'`),Object.defineProperty(s.prototype,a,l)}i[n]=s}}}return!0}});function ca(r,e){return NQ([r],e),r}function NQ(r,e){vk()&&ro("reload",i=>bB(({oldExports:n})=>{if([...Object.values(n)].some(o=>r.includes(o)))return o=>(i(void 0),!0)})).read(e)}var pd=class r{constructor(e,t){this.diffs=e;this.hitTimeout=t}static trivial(e,t){return new r([new Ji(Be.ofLength(e.length),Be.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new r([new Ji(Be.ofLength(e.length),Be.ofLength(t.length))],!0)}},Ji=class r{constructor(e,t){this.seq1Range=e;this.seq2Range=t}static invert(e,t){let i=[];return cS(e,(n,o)=>{i.push(r.fromOffsetPairs(n?n.getEndExclusives():ud.zero,o?o.getStarts():new ud(t,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new r(new Be(e.offset1,t.offset1),new Be(e.offset2,t.offset2))}static assertSorted(e){let t;for(let i of e){if(t&&!(t.seq1Range.endExclusive<=i.seq1Range.start&&t.seq2Range.endExclusive<=i.seq2Range.start))throw new Je("Sequence diffs must be sorted");t=i}}swap(){return new r(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new r(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new r(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new r(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new r(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersectsOrTouches(e){return this.seq1Range.intersectsOrTouches(e.seq1Range)||this.seq2Range.intersectsOrTouches(e.seq2Range)}intersect(e){let t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new r(t,i)}getStarts(){return new ud(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new ud(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}},ud=class r{constructor(e,t){this.offset1=e;this.offset2=t}static zero=new r(0,0);static max=new r(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new r(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}},Vu=class r{static instance=new r;isValid(){return!0}},yk=class{constructor(e){this.timeout=e;if(e<=0)throw new Je("timeout must be positive")}startTime=Date.now();valid=!0;isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}disable(){this.timeout=Number.MAX_SAFE_INTEGER,this.isValid=()=>!0,this.valid=!0}};var rb=class{constructor(e,t){this.width=e;this.height=t;this.array=new Array(e*t)}array=[];get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}};function hC(r){return r===32||r===9}var pC=class r{constructor(e,t,i){this.range=e;this.lines=t;this.source=i;let n=0;for(let o=e.startLineNumber-1;o<e.endLineNumberExclusive-1;o++){let s=t[o];for(let l=0;l<s.length;l++){n++;let d=s[l],c=r.getKey(d);this.histogram[c]=(this.histogram[c]||0)+1}n++;let a=r.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}static chrKeys=new Map;static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}totalCount;histogram=[];computeSimilarity(e){let t=0,i=Math.max(this.histogram.length,e.histogram.length);for(let n=0;n<i;n++)t+=Math.abs((this.histogram[n]??0)-(e.histogram[n]??0));return 1-t/(this.totalCount+e.totalCount)}};var Ik=class{compute(e,t,i=Vu.instance,n){if(e.length===0||t.length===0)return pd.trivial(e,t);let o=new rb(e.length,t.length),s=new rb(e.length,t.length),a=new rb(e.length,t.length);for(let f=0;f<e.length;f++)for(let g=0;g<t.length;g++){if(!i.isValid())return pd.trivialTimedOut(e,t);let b=f===0?0:o.get(f-1,g),v=g===0?0:o.get(f,g-1),I;e.getElement(f)===t.getElement(g)?(f===0||g===0?I=0:I=o.get(f-1,g-1),f>0&&g>0&&s.get(f-1,g-1)===3&&(I+=a.get(f-1,g-1)),I+=n?n(f,g):1):I=-1;let w=Math.max(b,v,I);if(w===I){let E=f>0&&g>0?a.get(f-1,g-1):0;a.set(f,g,E+1),s.set(f,g,3)}else w===b?(a.set(f,g,0),s.set(f,g,1)):w===v&&(a.set(f,g,0),s.set(f,g,2));o.set(f,g,w)}let l=[],d=e.length,c=t.length;function u(f,g){(f+1!==d||g+1!==c)&&l.push(new Ji(new Be(f+1,d),new Be(g+1,c))),d=f,c=g}let p=e.length-1,m=t.length-1;for(;p>=0&&m>=0;)s.get(p,m)===3?(u(p,m),p--,m--):s.get(p,m)===1?p--:m--;return u(-1,-1),l.reverse(),new pd(l,!1)}};var sb=class{compute(e,t,i=Vu.instance){if(e.length===0||t.length===0)return pd.trivial(e,t);let n=e,o=t;function s(g,b){for(;g<n.length&&b<o.length&&n.getElement(g)===o.getElement(b);)g++,b++;return g}let a=0,l=new vB;l.set(0,s(0,0));let d=new yB;d.set(0,l.get(0)===0?null:new Ck(null,0,0,l.get(0)));let c=0;e:for(;;){if(a++,!i.isValid())return pd.trivialTimedOut(n,o);let g=-Math.min(a,o.length+a%2),b=Math.min(a,n.length+a%2);for(c=g;c<=b;c+=2){let v=0,I=c===b?-1:l.get(c+1),w=c===g?-1:l.get(c-1)+1;v++;let E=Math.min(Math.max(I,w),n.length),S=E-c;if(v++,E>n.length||S>o.length)continue;let T=s(E,S);l.set(c,T);let D=E===I?d.get(c+1):d.get(c-1);if(d.set(c,T!==E?new Ck(D,E,S,T-E):D),l.get(c)===n.length&&l.get(c)-c===o.length)break e}}let u=d.get(c),p=[],m=n.length,f=o.length;for(;;){let g=u?u.x+u.length:0,b=u?u.y+u.length:0;if((g!==m||b!==f)&&p.push(new Ji(new Be(g,m),new Be(b,f))),!u)break;m=u.x,f=u.y,u=u.prev}return p.reverse(),new pd(p,!1)}},Ck=class{constructor(e,t,i,n){this.prev=e;this.x=t;this.y=i;this.length=n}},vB=class{positiveArr=new Int32Array(10);negativeArr=new Int32Array(10);get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){let i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){let i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}},yB=class{positiveArr=[];negativeArr=[];get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}};var Wu=class{constructor(e,t,i){this.lines=e;this.range=t;this.considerWhitespaceChanges=i;this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let o=e[n-1],s=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(s=this.range.startColumn-1,o=o.substring(s)),this.lineStartOffsets.push(s);let a=0;if(!i){let d=o.trimStart();a=o.length-d.length,o=d.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);let l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-s-a,o.length):o.length;for(let d=0;d<l;d++)this.elements.push(o.charCodeAt(d));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}elements=[];firstElementOffsetByLineIdx=[];lineStartOffsets=[];trimmedWsLengthsByLineIdx=[];toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new Be(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){let t=o3(e>0?this.elements[e-1]:-1),i=o3(e<this.elements.length?this.elements[e]:-1);if(t===7&&i===8)return 0;if(t===8)return 150;let n=0;return t!==i&&(n+=10,t===0&&i===1&&(n+=1)),n+=n3(t),n+=n3(i),n}translateOffset(e,t="right"){let i=Cd(this.firstElementOffsetByLineIdx,o=>o<=e),n=e-this.firstElementOffsetByLineIdx[i];return new F(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(e){let t=this.translateOffset(e.start,"right"),i=this.translateOffset(e.endExclusive,"left");return i.isBefore(t)?O.fromPositions(i,i):O.fromPositions(t,i)}findWordContaining(e){if(e<0||e>=this.elements.length||!IB(this.elements[e]))return;let t=e;for(;t>0&&IB(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&IB(this.elements[i]);)i++;return new Be(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){let t=Id(this.firstElementOffsetByLineIdx,n=>n<=e.start)??0,i=UV(this.firstElementOffsetByLineIdx,n=>e.endExclusive<=n)??this.elements.length;return new Be(t,i)}};function IB(r){return r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57}var FQ={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function n3(r){return FQ[r]}function o3(r){return r===10?8:r===13?7:hC(r)?6:r>=97&&r<=122?0:r>=65&&r<=90?1:r>=48&&r<=57?2:r===-1?3:r===44||r===59?5:4}function s3(r,e,t,i,n,o){let{moves:s,excludedChanges:a}=VQ(r,e,t,o);if(!o.isValid())return[];let l=r.filter(c=>!a.has(c)),d=WQ(l,i,n,e,t,o);return iv(s,d),s=HQ(s),s=s.filter(c=>{let u=c.original.toOffsetRange().slice(e).map(m=>m.trim());return u.join(`
`).length>=15&&BQ(u,m=>m.length>=2)>=2}),s=UQ(r,s),s}function BQ(r,e){let t=0;for(let i of r)e(i)&&t++;return t}function VQ(r,e,t,i){let n=[],o=r.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new pC(l.original,e,l)),s=new Set(r.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new pC(l.modified,t,l))),a=new Set;for(let l of o){let d=-1,c;for(let u of s){let p=l.computeSimilarity(u);p>d&&(d=p,c=u)}if(d>.9&&c&&(s.delete(c),n.push(new Vo(l.range,c.range)),a.add(l.source),a.add(c.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function WQ(r,e,t,i,n,o){let s=[],a=new xd;for(let p of r)for(let m=p.original.startLineNumber;m<p.original.endLineNumberExclusive-2;m++){let f=`${e[m-1]}:${e[m+1-1]}:${e[m+2-1]}`;a.add(f,{range:new Fe(m,m+3)})}let l=[];r.sort(ir(p=>p.modified.startLineNumber,ul));for(let p of r){let m=[];for(let f=p.modified.startLineNumber;f<p.modified.endLineNumberExclusive-2;f++){let g=`${t[f-1]}:${t[f+1-1]}:${t[f+2-1]}`,b=new Fe(f,f+3),v=[];a.forEach(g,({range:I})=>{for(let E of m)if(E.originalLineRange.endLineNumberExclusive+1===I.endLineNumberExclusive&&E.modifiedLineRange.endLineNumberExclusive+1===b.endLineNumberExclusive){E.originalLineRange=new Fe(E.originalLineRange.startLineNumber,I.endLineNumberExclusive),E.modifiedLineRange=new Fe(E.modifiedLineRange.startLineNumber,b.endLineNumberExclusive),v.push(E);return}let w={modifiedLineRange:b,originalLineRange:I};l.push(w),v.push(w)}),m=v}if(!o.isValid())return[]}l.sort(JV(ir(p=>p.modifiedLineRange.length,ul)));let d=new _s,c=new _s;for(let p of l){let m=p.modifiedLineRange.startLineNumber-p.originalLineRange.startLineNumber,f=d.subtractFrom(p.modifiedLineRange),g=c.subtractFrom(p.originalLineRange).getWithDelta(m),b=f.getIntersection(g);for(let v of b.ranges){if(v.length<3)continue;let I=v,w=v.delta(-m);s.push(new Vo(w,I)),d.addRange(I),c.addRange(w)}}s.sort(ir(p=>p.original.startLineNumber,ul));let u=new Jb(r);for(let p=0;p<s.length;p++){let m=s[p],f=u.findLastMonotonous(T=>T.original.startLineNumber<=m.original.startLineNumber),g=Id(r,T=>T.modified.startLineNumber<=m.modified.startLineNumber),b=Math.max(m.original.startLineNumber-f.original.startLineNumber,m.modified.startLineNumber-g.modified.startLineNumber),v=u.findLastMonotonous(T=>T.original.startLineNumber<m.original.endLineNumberExclusive),I=Id(r,T=>T.modified.startLineNumber<m.modified.endLineNumberExclusive),w=Math.max(v.original.endLineNumberExclusive-m.original.endLineNumberExclusive,I.modified.endLineNumberExclusive-m.modified.endLineNumberExclusive),E;for(E=0;E<b;E++){let T=m.original.startLineNumber-E-1,D=m.modified.startLineNumber-E-1;if(T>i.length||D>n.length||d.contains(D)||c.contains(T)||!r3(i[T-1],n[D-1],o))break}E>0&&(c.addRange(new Fe(m.original.startLineNumber-E,m.original.startLineNumber)),d.addRange(new Fe(m.modified.startLineNumber-E,m.modified.startLineNumber)));let S;for(S=0;S<w;S++){let T=m.original.endLineNumberExclusive+S,D=m.modified.endLineNumberExclusive+S;if(T>i.length||D>n.length||d.contains(D)||c.contains(T)||!r3(i[T-1],n[D-1],o))break}S>0&&(c.addRange(new Fe(m.original.endLineNumberExclusive,m.original.endLineNumberExclusive+S)),d.addRange(new Fe(m.modified.endLineNumberExclusive,m.modified.endLineNumberExclusive+S))),(E>0||S>0)&&(s[p]=new Vo(new Fe(m.original.startLineNumber-E,m.original.endLineNumberExclusive+S),new Fe(m.modified.startLineNumber-E,m.modified.endLineNumberExclusive+S)))}return s}function r3(r,e,t){if(r.trim()===e.trim())return!0;if(r.length>300&&e.length>300)return!1;let n=new sb().compute(new Wu([r],new O(1,1,1,r.length),!1),new Wu([e],new O(1,1,1,e.length),!1),t),o=0,s=Ji.invert(n.diffs,r.length);for(let c of s)c.seq1Range.forEach(u=>{hC(r.charCodeAt(u))||o++});function a(c){let u=0;for(let p=0;p<r.length;p++)hC(c.charCodeAt(p))||u++;return u}let l=a(r.length>e.length?r:e);return o/l>.6&&l>10}function HQ(r){if(r.length===0)return r;r.sort(ir(t=>t.original.startLineNumber,ul));let e=[r[0]];for(let t=1;t<r.length;t++){let i=e[e.length-1],n=r[t],o=n.original.startLineNumber-i.original.endLineNumberExclusive,s=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(o>=0&&s>=0&&o+s<=2){e[e.length-1]=i.join(n);continue}e.push(n)}return e}function UQ(r,e){let t=new Jb(r);return e=e.filter(i=>{let n=t.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new Vo(new Fe(1,1),new Fe(1,1)),o=Id(r,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==o}),e}var mC=class{constructor(e,t){this.trimmedHash=e;this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){let t=e===0?0:a3(this.lines[e-1]),i=e===this.lines.length?0:a3(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}};function a3(r){let e=0;for(;e<r.length&&(r.charCodeAt(e)===32||r.charCodeAt(e)===9);)e++;return e}function gC(r,e,t){let i=t;return i=l3(r,e,i),i=l3(r,e,i),i=zQ(r,e,i),i}function l3(r,e,t){if(t.length===0)return t;let i=[];i.push(t[0]);for(let o=1;o<t.length;o++){let s=i[i.length-1],a=t[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=a.seq1Range.start-s.seq1Range.endExclusive,d;for(d=1;d<=l&&!(r.getElement(a.seq1Range.start-d)!==r.getElement(a.seq1Range.endExclusive-d)||e.getElement(a.seq2Range.start-d)!==e.getElement(a.seq2Range.endExclusive-d));d++);if(d--,d===l){i[i.length-1]=new Ji(new Be(s.seq1Range.start,a.seq1Range.endExclusive-l),new Be(s.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-d)}i.push(a)}let n=[];for(let o=0;o<i.length-1;o++){let s=i[o+1],a=i[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=s.seq1Range.start-a.seq1Range.endExclusive,d;for(d=0;d<l&&!(!r.isStronglyEqual(a.seq1Range.start+d,a.seq1Range.endExclusive+d)||!e.isStronglyEqual(a.seq2Range.start+d,a.seq2Range.endExclusive+d));d++);if(d===l){i[o+1]=new Ji(new Be(a.seq1Range.start+l,s.seq1Range.endExclusive),new Be(a.seq2Range.start+l,s.seq2Range.endExclusive));continue}d>0&&(a=a.delta(d))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function zQ(r,e,t){if(!r.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){let n=i>0?t[i-1]:void 0,o=t[i],s=i+1<t.length?t[i+1]:void 0,a=new Be(n?n.seq1Range.endExclusive+1:0,s?s.seq1Range.start-1:r.length),l=new Be(n?n.seq2Range.endExclusive+1:0,s?s.seq2Range.start-1:e.length);o.seq1Range.isEmpty?t[i]=d3(o,r,e,a,l):o.seq2Range.isEmpty&&(t[i]=d3(o.swap(),e,r,l,a).swap())}return t}function d3(r,e,t,i,n){let s=1;for(;r.seq1Range.start-s>=i.start&&r.seq2Range.start-s>=n.start&&t.isStronglyEqual(r.seq2Range.start-s,r.seq2Range.endExclusive-s)&&s<100;)s++;s--;let a=0;for(;r.seq1Range.start+a<i.endExclusive&&r.seq2Range.endExclusive+a<n.endExclusive&&t.isStronglyEqual(r.seq2Range.start+a,r.seq2Range.endExclusive+a)&&a<100;)a++;if(s===0&&a===0)return r;let l=0,d=-1;for(let c=-s;c<=a;c++){let u=r.seq2Range.start+c,p=r.seq2Range.endExclusive+c,m=r.seq1Range.start+c,f=e.getBoundaryScore(m)+t.getBoundaryScore(u)+t.getBoundaryScore(p);f>d&&(d=f,l=c)}return r.delta(l)}function c3(r,e,t){let i=[];for(let n of t){let o=i[i.length-1];if(!o){i.push(n);continue}n.seq1Range.start-o.seq1Range.endExclusive<=2||n.seq2Range.start-o.seq2Range.endExclusive<=2?i[i.length-1]=new Ji(o.seq1Range.join(n.seq1Range),o.seq2Range.join(n.seq2Range)):i.push(n)}return i}function u3(r,e,t){let i=Ji.invert(t,r.length),n=[],o=new ud(0,0);function s(l,d){if(l.offset1<o.offset1||l.offset2<o.offset2)return;let c=r.findWordContaining(l.offset1),u=e.findWordContaining(l.offset2);if(!c||!u)return;let p=new Ji(c,u),m=p.intersect(d),f=m.seq1Range.length,g=m.seq2Range.length;for(;i.length>0;){let b=i[0];if(!(b.seq1Range.intersects(p.seq1Range)||b.seq2Range.intersects(p.seq2Range)))break;let I=r.findWordContaining(b.seq1Range.start),w=e.findWordContaining(b.seq2Range.start),E=new Ji(I,w),S=E.intersect(b);if(f+=S.seq1Range.length,g+=S.seq2Range.length,p=p.join(E),p.seq1Range.endExclusive>=b.seq1Range.endExclusive)i.shift();else break}f+g<(p.seq1Range.length+p.seq2Range.length)*2/3&&n.push(p),o=p.getEndExclusives()}for(;i.length>0;){let l=i.shift();l.seq1Range.isEmpty||(s(l.getStarts(),l),s(l.getEndExclusives().delta(-1),l))}return KQ(t,n)}function KQ(r,e){let t=[];for(;r.length>0||e.length>0;){let i=r[0],n=e[0],o;i&&(!n||i.seq1Range.start<n.seq1Range.start)?o=r.shift():o=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=o.seq1Range.start?t[t.length-1]=t[t.length-1].join(o):t.push(o)}return t}function p3(r,e,t){let i=t;if(i.length===0)return i;let n=0,o;do{o=!1;let a=[i[0]];for(let l=1;l<i.length;l++){let u=function(m,f){let g=new Be(c.seq1Range.endExclusive,d.seq1Range.start);return r.getText(g).replace(/\s/g,"").length<=4&&(m.seq1Range.length+m.seq2Range.length>5||f.seq1Range.length+f.seq2Range.length>5)};var s=u;let d=i[l],c=a[a.length-1];u(c,d)?(o=!0,a[a.length-1]=a[a.length-1].join(d)):a.push(d)}i=a}while(n++<10&&o);return i}function h3(r,e,t){let i=t;if(i.length===0)return i;let n=0,o;do{o=!1;let l=[i[0]];for(let d=1;d<i.length;d++){let p=function(f,g){let b=new Be(u.seq1Range.endExclusive,c.seq1Range.start);if(r.countLinesIn(b)>5||b.length>500)return!1;let I=r.getText(b).trim();if(I.length>20||I.split(/\r\n|\r|\n/).length>1)return!1;let w=r.countLinesIn(f.seq1Range),E=f.seq1Range.length,S=e.countLinesIn(f.seq2Range),T=f.seq2Range.length,D=r.countLinesIn(g.seq1Range),L=g.seq1Range.length,A=e.countLinesIn(g.seq2Range),W=g.seq2Range.length,j=2*40+50;function G(oe){return Math.min(oe,j)}return Math.pow(Math.pow(G(w*40+E),1.5)+Math.pow(G(S*40+T),1.5),1.5)+Math.pow(Math.pow(G(D*40+L),1.5)+Math.pow(G(A*40+W),1.5),1.5)>(j**1.5)**1.5*1.3};var a=p;let c=i[d],u=l[l.length-1];p(u,c)?(o=!0,l[l.length-1]=l[l.length-1].join(c)):l.push(c)}i=l}while(n++<10&&o);let s=[];return $V(i,(l,d,c)=>{let u=d;function p(I){return I.length>0&&I.trim().length<=3&&d.seq1Range.length+d.seq2Range.length>100}let m=r.extendToFullLines(d.seq1Range),f=r.getText(new Be(m.start,d.seq1Range.start));p(f)&&(u=u.deltaStart(-f.length));let g=r.getText(new Be(d.seq1Range.endExclusive,m.endExclusive));p(g)&&(u=u.deltaEnd(g.length));let b=Ji.fromOffsetPairs(l?l.getEndExclusives():ud.zero,c?c.getStarts():ud.max),v=u.intersect(b);s.length>0&&v.getStarts().equals(s[s.length-1].getEndExclusives())?s[s.length-1]=s[s.length-1].join(v):s.push(v)}),s}var Sk=class{dynamicProgrammingDiffing=new Ik;myersDiffingAlgorithm=new sb;computeDiff(e,t,i){if(e.length<=1&&li(e,t,(S,T)=>S===T))return new lh([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new lh([new rs(new Fe(1,e.length+1),new Fe(1,t.length+1),[new Qo(new O(1,1,e.length,e[e.length-1].length+1),new O(1,1,t.length,t[t.length-1].length+1))])],[],!1);let n=i.maxComputationTimeMs===0?Vu.instance:new yk(i.maxComputationTimeMs),o=!i.ignoreTrimWhitespace,s=new Map;function a(S){let T=s.get(S);return T===void 0&&(T=s.size,s.set(S,T)),T}let l=e.map(S=>a(S.trim())),d=t.map(S=>a(S.trim())),c=new mC(l,e),u=new mC(d,t),p=c.length+u.length<1700?this.dynamicProgrammingDiffing.compute(c,u,n,(S,T)=>e[S]===t[T]?t[T].length===0?.1:1+Math.log(1+t[T].length):.99):this.myersDiffingAlgorithm.compute(c,u,n),m=p.diffs,f=p.hitTimeout;m=gC(c,u,m),m=p3(c,u,m);let g=[],b=S=>{if(o)for(let T=0;T<S;T++){let D=v+T,L=I+T;if(e[D]!==t[L]){let A=this.refineDiff(e,t,new Ji(new Be(D,D+1),new Be(L,L+1)),n,o);for(let W of A.mappings)g.push(W);A.hitTimeout&&(f=!0)}}},v=0,I=0;for(let S of m){ya(()=>S.seq1Range.start-v===S.seq2Range.start-I);let T=S.seq1Range.start-v;b(T),v=S.seq1Range.endExclusive,I=S.seq2Range.endExclusive;let D=this.refineDiff(e,t,S,n,o);D.hitTimeout&&(f=!0);for(let L of D.mappings)g.push(L)}b(e.length-v);let w=m3(g,e,t),E=[];return i.computeMoves&&(E=this.computeMoves(w,e,t,l,d,n,o)),ya(()=>{function S(D,L){if(D.lineNumber<1||D.lineNumber>L.length)return!1;let A=L[D.lineNumber-1];return!(D.column<1||D.column>A.length+1)}function T(D,L){return!(D.startLineNumber<1||D.startLineNumber>L.length+1||D.endLineNumberExclusive<1||D.endLineNumberExclusive>L.length+1)}for(let D of w){if(!D.innerChanges)return!1;for(let L of D.innerChanges)if(!(S(L.modifiedRange.getStartPosition(),t)&&S(L.modifiedRange.getEndPosition(),t)&&S(L.originalRange.getStartPosition(),e)&&S(L.originalRange.getEndPosition(),e)))return!1;if(!T(D.modified,t)||!T(D.original,e))return!1}return!0}),new lh(w,E,f)}computeMoves(e,t,i,n,o,s,a){return s3(e,t,i,n,o,s).map(c=>{let u=this.refineDiff(t,i,new Ji(c.original.toOffsetRange(),c.modified.toOffsetRange()),s,a),p=m3(u.mappings,t,i,!0);return new xT(c,p)})}refineDiff(e,t,i,n,o){let a=jQ(i).toRangeMapping2(e,t),l=new Wu(e,a.originalRange,o),d=new Wu(t,a.modifiedRange,o),c=l.length+d.length<500?this.dynamicProgrammingDiffing.compute(l,d,n):this.myersDiffingAlgorithm.compute(l,d,n),u=!1,p=c.diffs;u&&Ji.assertSorted(p),p=gC(l,d,p),u&&Ji.assertSorted(p),p=u3(l,d,p),u&&Ji.assertSorted(p),p=c3(l,d,p),u&&Ji.assertSorted(p),p=h3(l,d,p),u&&Ji.assertSorted(p);let m=p.map(f=>new Qo(l.translateRange(f.seq1Range),d.translateRange(f.seq2Range)));return u&&Qo.assertSorted(m),{mappings:m,hitTimeout:c.hitTimeout}}};function m3(r,e,t,i=!1){let n=[];for(let o of sm(r.map(s=>GQ(s,e,t)),(s,a)=>s.original.overlapOrTouch(a.original)||s.modified.overlapOrTouch(a.modified))){let s=o[0],a=o[o.length-1];n.push(new rs(s.original.join(a.original),s.modified.join(a.modified),o.map(l=>l.innerChanges[0])))}return ya(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||t.length-n[n.length-1].modified.endLineNumberExclusive!==e.length-n[n.length-1].original.endLineNumberExclusive)?!1:uv(n,(o,s)=>s.original.startLineNumber-o.original.endLineNumberExclusive===s.modified.startLineNumber-o.modified.endLineNumberExclusive&&o.original.endLineNumberExclusive<s.original.startLineNumber&&o.modified.endLineNumberExclusive<s.modified.startLineNumber)),n}function GQ(r,e,t){let i=0,n=0;r.modifiedRange.endColumn===1&&r.originalRange.endColumn===1&&r.originalRange.startLineNumber+i<=r.originalRange.endLineNumber&&r.modifiedRange.startLineNumber+i<=r.modifiedRange.endLineNumber&&(n=-1),r.modifiedRange.startColumn-1>=t[r.modifiedRange.startLineNumber-1].length&&r.originalRange.startColumn-1>=e[r.originalRange.startLineNumber-1].length&&r.originalRange.startLineNumber<=r.originalRange.endLineNumber+n&&r.modifiedRange.startLineNumber<=r.modifiedRange.endLineNumber+n&&(i=1);let o=new Fe(r.originalRange.startLineNumber+i,r.originalRange.endLineNumber+1+n),s=new Fe(r.modifiedRange.startLineNumber+i,r.modifiedRange.endLineNumber+1+n);return new rs(o,s,[r])}function jQ(r){return new Vo(new Fe(r.seq1Range.start+1,r.seq1Range.endExclusive+1),new Fe(r.seq2Range.start+1,r.seq2Range.endExclusive+1))}var rai=x("diffEditor.move.border","#8b8b8b9c",h("diffEditor.move.border","The border color for text that got moved in the diff editor.")),sai=x("diffEditor.moveActive.border","#FFA500",h("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor.")),aai=x("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},h("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets.")),qQ=$o("diff-insert",ie.add,h("diffInsertIcon","Line decoration for inserts in the diff editor.")),CB=$o("diff-remove",ie.remove,h("diffRemoveIcon","Line decoration for removals in the diff editor.")),SB=Qi.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+Ae.asClassName(qQ),marginClassName:"gutter-insert"}),EB=Qi.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+Ae.asClassName(CB),marginClassName:"gutter-delete"}),wB=Qi.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),xB=Qi.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),TB=Qi.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),g3=Qi.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),f3=Qi.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),fC=Qi.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),b3=Qi.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),v3=Qi.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var Ek=class extends P{constructor(t,i,n,o,s,a,l,d,c){super();this._getViewZoneId=t;this._marginDomNode=i;this._modifiedEditor=n;this._diff=o;this._editor=s;this._viewLineCounts=a;this._originalTextModel=l;this._contextMenuService=d;this._clipboardService=c;this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Ae.asClassName(ie.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";let u=this._modifiedEditor.getOption(68);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${u}px`,this._diffActions.style.lineHeight=`${u}px`,this._marginDomNode.appendChild(this._diffActions);let p=0,m=n.getOption(129)&&!zs,f=(g,b)=>{this._contextMenuService.showContextMenu({domForShadowRoot:m?n.getDomNode()??void 0:void 0,getAnchor:()=>({x:g,y:b}),getActions:()=>{let v=[],I=o.modified.isEmpty;return v.push(new Si("diff.clipboard.copyDeletedContent",I?o.original.length>1?h("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):h("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.original.length>1?h("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):h("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{let E=this._originalTextModel.getValueInRange(o.original.toExclusiveRange());await this._clipboardService.writeText(E)})),o.original.length>1&&v.push(new Si("diff.clipboard.copyDeletedLineContent",I?h("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.original.startLineNumber+p):h("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.original.startLineNumber+p),void 0,!0,async()=>{let E=this._originalTextModel.getLineContent(o.original.startLineNumber+p);E===""&&(E=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(E)})),n.getOption(93)||v.push(new Si("diff.inline.revertChange",h("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),v},autoSelectFirstItem:!0})};this._register(si(this._diffActions,"mousedown",g=>{if(!g.leftButton)return;let{top:b,height:v}=po(this._diffActions),I=Math.floor(u/3);g.preventDefault(),f(g.posx,b+v+I)})),this._register(n.onMouseMove(g=>{(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()?(p=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,u),this.visibility=!0):this.visibility=!1})),this._register(n.onMouseDown(g=>{g.event.leftButton&&(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()&&(g.event.preventDefault(),p=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,u),f(g.event.posx,g.event.posy+u))}))}_diffActions;_visibility=!1;get visibility(){return this._visibility}set visibility(t){this._visibility!==t&&(this._visibility=t,this._diffActions.style.visibility=t?"visible":"hidden")}_updateLightBulbPosition(t,i,n){let{top:o}=po(t),s=i-o,a=Math.floor(s/n),l=a*n;if(this._diffActions.style.top=`${l}px`,this._viewLineCounts){let d=0;for(let c=0;c<this._viewLineCounts.length;c++)if(d+=this._viewLineCounts[c],a<d)return c}return a}};var y3=Pu("diffEditorWidget",{createHTML:r=>r});function C3(r,e,t,i){Ti(i,e.fontInfo);let n=t.length>0,o=new Rl(1e4),s=0,a=0,l=[];for(let p=0;p<r.lineTokens.length;p++){let m=p+1,f=r.lineTokens[p],g=r.lineBreakData[p],b=la.filter(t,m,1,Number.MAX_SAFE_INTEGER);if(g){let v=0;for(let I of g.breakOffsets){let w=f.sliceAndInflate(v,I,0);s=Math.max(s,I3(a,w,la.extractWrapped(b,v,I),n,r.mightContainNonBasicASCII,r.mightContainRTL,e,o)),a++,v=I}l.push(g.breakOffsets.length)}else l.push(1),s=Math.max(s,I3(a,f,b,n,r.mightContainNonBasicASCII,r.mightContainRTL,e,o)),a++}s+=e.scrollBeyondLastColumn;let d=o.build(),c=y3?y3.createHTML(d):d;i.innerHTML=c;let u=s*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:u,viewLineCounts:l}}var wk=class{constructor(e,t,i,n){this.lineTokens=e;this.lineBreakData=t;this.mightContainNonBasicASCII=i;this.mightContainRTL=n}},xk=class r{constructor(e,t,i,n,o,s,a,l,d,c,u){this.tabSize=e;this.fontInfo=t;this.disableMonospaceOptimizations=i;this.typicalHalfwidthCharacterWidth=n;this.scrollBeyondLastColumn=o;this.lineHeight=s;this.lineDecorationsWidth=a;this.stopRenderingLineAfter=l;this.renderWhitespace=d;this.renderControlCharacters=c;this.fontLigatures=u}static fromEditor(e){let t=e.getOptions(),i=t.get(51),n=t.get(147);return new r(e.getModel()?.getOptions().tabSize||0,i,t.get(33),i.typicalHalfwidthCharacterWidth,t.get(106),t.get(68),n.decorationsWidth,t.get(119),t.get(101),t.get(96),t.get(52))}};function I3(r,e,t,i,n,o,s,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(r*s.lineHeight)),a.appendString('px;width:1000000px;">');let l=e.getLineContent(),d=Zl.isBasicASCII(l,n),c=Zl.containsRTL(l,d,o),u=qI(new Nu(s.fontInfo.isMonospace&&!s.disableMonospaceOptimizations,s.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,d,c,0,e,t,s.tabSize,0,s.fontInfo.spaceWidth,s.fontInfo.middotWidth,s.fontInfo.wsmiddotWidth,s.stopRenderingLineAfter,s.renderWhitespace,s.renderControlCharacters,s.fontLigatures!==ka.OFF,null),a);return a.appendString("</div>"),u.characterMapping.getHorizontalOffset(u.characterMapping.length)}var ab=class extends P{constructor(t,i,n,o,s,a,l,d,c,u){super();this._targetWindow=t;this._editors=i;this._diffModel=n;this._options=o;this._diffEditorWidget=s;this._canIgnoreViewZoneUpdateEvent=a;this._origViewZonesToIgnore=l;this._modViewZonesToIgnore=d;this._clipboardService=c;this._contextMenuService=u;let p=Ct("invalidateAlignmentsState",0),m=this._register(new Kt(()=>{p.set(p.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(E=>{this._canIgnoreViewZoneUpdateEvent()||m.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(E=>{this._canIgnoreViewZoneUpdateEvent()||m.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(E=>{(E.hasChanged(148)||E.hasChanged(68))&&m.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(E=>{(E.hasChanged(148)||E.hasChanged(68))&&m.schedule()}));let f=this._diffModel.map(E=>E?zt(this,E.model.original.onDidChangeTokens,()=>E.model.original.tokenization.backgroundTokenizationState===2):void 0).map((E,S)=>E?.read(S)),g=We(E=>{let S=this._diffModel.read(E),T=S?.diff.read(E);if(!S||!T)return null;p.read(E);let L=this._options.renderSideBySide.read(E);return S3(this._editors.original,this._editors.modified,T.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,L)}),b=We(E=>{let S=this._diffModel.read(E)?.movedTextToCompare.read(E);if(!S)return null;p.read(E);let T=S.changes.map(D=>new vC(D));return S3(this._editors.original,this._editors.modified,T,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function v(){let E=document.createElement("div");return E.className="diagonal-fill",E}let I=this._register(new Y);this.viewZones=Ld(this,(E,S)=>{I.clear();let T=g.read(E)||[],D=[],L=[],A=this._modifiedTopPadding.read(E);A>0&&L.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:A,showInHiddenAreas:!0,suppressMouseDown:!0});let W=this._originalTopPadding.read(E);W>0&&D.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:W,showInHiddenAreas:!0,suppressMouseDown:!0});let j=this._options.renderSideBySide.read(E),G=j?void 0:this._editors.modified._getViewModel()?.createLineBreaksComputer();if(G){let fe=this._editors.original.getModel();for(let rt of T)if(rt.diff)for(let Xe=rt.originalRange.startLineNumber;Xe<rt.originalRange.endLineNumberExclusive;Xe++){if(Xe>fe.getLineCount())return{orig:D,mod:L};G?.addRequest(fe.getLineContent(Xe),null,null)}}let oe=G?.finalize()??[],_e=0,re=this._editors.modified.getOption(68),ne=this._diffModel.read(E)?.movedTextToCompare.read(E),ge=this._editors.original.getModel()?.mightContainNonBasicASCII()??!1,de=this._editors.original.getModel()?.mightContainRTL()??!1,se=xk.fromEditor(this._editors.modified);for(let fe of T)if(fe.diff&&!j&&(!this._options.useTrueInlineDiffRendering.read(E)||!bC(fe.diff))){if(!fe.originalRange.isEmpty){f.read(E);let Xe=document.createElement("div");Xe.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");let Pe=this._editors.original.getModel();if(fe.originalRange.endLineNumberExclusive-1>Pe.getLineCount())return{orig:D,mod:L};let Gi=new wk(fe.originalRange.mapToLineArray(ii=>Pe.tokenization.getLineTokens(ii)),fe.originalRange.mapToLineArray(ii=>oe[_e++]),ge,de),Mi=[];for(let ii of fe.diff.innerChanges||[])Mi.push(new ic(ii.originalRange.delta(-(fe.diff.original.startLineNumber-1)),fC.className,0));let bn=C3(Gi,se,Mi,Xe),Kn=document.createElement("div");if(Kn.className="inline-deleted-margin-view-zone",Ti(Kn,se.fontInfo),this._options.renderIndicators.read(E))for(let ii=0;ii<bn.heightInLines;ii++){let wo=document.createElement("div");wo.className=`delete-sign ${Ae.asClassName(CB)}`,wo.setAttribute("style",`position:absolute;top:${ii*re}px;width:${se.lineDecorationsWidth}px;height:${re}px;right:0;`),Kn.appendChild(wo)}let ma;I.add(new Ek(()=>at(ma),Kn,this._editors.modified,fe.diff,this._diffEditorWidget,bn.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let ii=0;ii<bn.viewLineCounts.length;ii++){let wo=bn.viewLineCounts[ii];wo>1&&D.push({afterLineNumber:fe.originalRange.startLineNumber+ii,domNode:v(),heightInPx:(wo-1)*re,showInHiddenAreas:!0,suppressMouseDown:!0})}L.push({afterLineNumber:fe.modifiedRange.startLineNumber-1,domNode:Xe,heightInPx:bn.heightInLines*re,minWidthInPx:bn.minWidthInPx,marginDomNode:Kn,setZoneId(ii){ma=ii},showInHiddenAreas:!0,suppressMouseDown:!0})}let rt=document.createElement("div");rt.className="gutter-delete",D.push({afterLineNumber:fe.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:fe.modifiedHeightInPx,marginDomNode:rt,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let rt=fe.modifiedHeightInPx-fe.originalHeightInPx;if(rt>0){if(ne?.lineRangeMapping.original.delta(-1).deltaLength(2).contains(fe.originalRange.endLineNumberExclusive-1))continue;D.push({afterLineNumber:fe.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:rt,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Xe=function(){let Gi=document.createElement("div");return Gi.className="arrow-revert-change "+Ae.asClassName(ie.arrowRight),S.add(B(Gi,"mousedown",Mi=>Mi.stopPropagation())),S.add(B(Gi,"click",Mi=>{Mi.stopPropagation(),s.revert(fe.diff)})),he("div",{},Gi)};var De=Xe;if(ne?.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(fe.modifiedRange.endLineNumberExclusive-1))continue;let Pe;fe.diff&&fe.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(E)&&(Pe=Xe()),L.push({afterLineNumber:fe.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-rt,marginDomNode:Pe,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(let fe of b.read(E)??[]){if(!ne?.lineRangeMapping.original.intersect(fe.originalRange)||!ne?.lineRangeMapping.modified.intersect(fe.modifiedRange))continue;let rt=fe.modifiedHeightInPx-fe.originalHeightInPx;rt>0?D.push({afterLineNumber:fe.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:rt,showInHiddenAreas:!0,suppressMouseDown:!0}):L.push({afterLineNumber:fe.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-rt,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:D,mod:L}});let w=!1;this._register(this._editors.original.onDidScrollChange(E=>{E.scrollLeftChanged&&!w&&(w=!0,this._editors.modified.setScrollLeft(E.scrollLeft),w=!1)})),this._register(this._editors.modified.onDidScrollChange(E=>{E.scrollLeftChanged&&!w&&(w=!0,this._editors.original.setScrollLeft(E.scrollLeft),w=!1)})),this._originalScrollTop=zt(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=zt(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(yt(E=>{let S=this._originalScrollTop.read(E)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(E))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(E));S!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(S,1)})),this._register(yt(E=>{let S=this._modifiedScrollTop.read(E)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(E))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(E));S!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(S,1)})),this._register(yt(E=>{let S=this._diffModel.read(E)?.movedTextToCompare.read(E),T=0;if(S){let D=this._editors.original.getTopForLineNumber(S.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();T=this._editors.modified.getTopForLineNumber(S.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-D}T>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(T,void 0)):T<0?(this._modifiedTopPadding.set(-T,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-T,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+T,void 0,!0)}))}_originalTopPadding=Ct(this,0);_originalScrollTop;_originalScrollOffset=Ct(this,0);_originalScrollOffsetAnimated=pB(this._targetWindow,this._originalScrollOffset,this._store);_modifiedTopPadding=Ct(this,0);_modifiedScrollTop;_modifiedScrollOffset=Ct(this,0);_modifiedScrollOffsetAnimated=pB(this._targetWindow,this._modifiedScrollOffset,this._store);viewZones};ab=R([y(8,Yg),y(9,Zi)],ab);function S3(r,e,t,i,n,o){let s=new Do(E3(r,i)),a=new Do(E3(e,n)),l=r.getOption(68),d=e.getOption(68),c=[],u=0,p=0;function m(g,b){for(;;){let v=s.peek(),I=a.peek();if(v&&v.lineNumber>=g&&(v=void 0),I&&I.lineNumber>=b&&(I=void 0),!v&&!I)break;let w=v?v.lineNumber-u:Number.MAX_VALUE,E=I?I.lineNumber-p:Number.MAX_VALUE;w<E?(s.dequeue(),I={lineNumber:v.lineNumber-u+p,heightInPx:0}):w>E?(a.dequeue(),v={lineNumber:I.lineNumber-p+u,heightInPx:0}):(s.dequeue(),a.dequeue()),c.push({originalRange:Fe.ofLength(v.lineNumber,1),modifiedRange:Fe.ofLength(I.lineNumber,1),originalHeightInPx:l+v.heightInPx,modifiedHeightInPx:d+I.heightInPx,diff:void 0})}}for(let g of t){let E=function(S,T,D=!1){if(S<w||T<I)return;if(v)v=!1;else if(!D&&(S===w||T===I))return;let L=new Fe(w,S),A=new Fe(I,T);if(L.isEmpty&&A.isEmpty)return;let W=s.takeWhile(G=>G.lineNumber<S)?.reduce((G,oe)=>G+oe.heightInPx,0)??0,j=a.takeWhile(G=>G.lineNumber<T)?.reduce((G,oe)=>G+oe.heightInPx,0)??0;c.push({originalRange:L,modifiedRange:A,originalHeightInPx:L.length*l+W,modifiedHeightInPx:A.length*d+j,diff:g.lineRangeMapping}),w=S,I=T};var f=E;let b=g.lineRangeMapping;m(b.original.startLineNumber,b.modified.startLineNumber);let v=!0,I=b.modified.startLineNumber,w=b.original.startLineNumber;if(o)for(let S of b.innerChanges||[]){S.originalRange.startColumn>1&&S.modifiedRange.startColumn>1&&E(S.originalRange.startLineNumber,S.modifiedRange.startLineNumber);let T=r.getModel(),D=S.originalRange.endLineNumber<=T.getLineCount()?T.getLineMaxColumn(S.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;S.originalRange.endColumn<D&&E(S.originalRange.endLineNumber,S.modifiedRange.endLineNumber)}E(b.original.endLineNumberExclusive,b.modified.endLineNumberExclusive,!0),u=b.original.endLineNumberExclusive,p=b.modified.endLineNumberExclusive}return m(Number.MAX_VALUE,Number.MAX_VALUE),c}function E3(r,e){let t=[],i=[],n=r.getOption(148).wrappingColumn!==-1,o=r._getViewModel().coordinatesConverter,s=r.getOption(68);if(n)for(let l=1;l<=r.getModel().getLineCount();l++){let d=o.getModelLineViewLineCount(l);d>1&&i.push({lineNumber:l,heightInPx:s*(d-1)})}for(let l of r.getWhitespaces()){if(e.has(l.id))continue;let d=l.afterLineNumber===0?0:o.convertViewPositionToModelPosition(new F(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:d,heightInPx:l.height})}return X9(t,i,l=>l.lineNumber,(l,d)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+d.heightInPx}))}function bC(r){return r.innerChanges?r.innerChanges.every(e=>w3(e.modifiedRange)&&w3(e.originalRange)||e.originalRange.equalsRange(new O(1,1,1,1))):!1}function w3(r){return r.startLineNumber===r.endLineNumber}var x3={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1};var lb=class{constructor(e,t){this._accessibilityService=t;let i={...e,...T3(e,x3)};this._options=Ct(this,i)}_options;get editorOptions(){return this._options}_diffEditorWidth=Ct(this,0);_screenReaderMode=zt(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized());couldShowInlineViewBecauseOfSize=We(this,e=>this._options.read(e).renderSideBySide&&this._diffEditorWidth.read(e)<=this._options.read(e).renderSideBySideInlineBreakpoint);renderOverviewRuler=We(this,e=>this._options.read(e).renderOverviewRuler);renderSideBySide=We(this,e=>this.compactMode.read(e)&&this.shouldRenderInlineViewInSmartMode.read(e)?!1:this._options.read(e).renderSideBySide&&!(this._options.read(e).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(e)&&!this._screenReaderMode.read(e)));readOnly=We(this,e=>this._options.read(e).readOnly);shouldRenderOldRevertArrows=We(this,e=>!(!this._options.read(e).renderMarginRevertIcon||!this.renderSideBySide.read(e)||this.readOnly.read(e)||this.shouldRenderGutterMenu.read(e)));shouldRenderGutterMenu=We(this,e=>this._options.read(e).renderGutterMenu);renderIndicators=We(this,e=>this._options.read(e).renderIndicators);enableSplitViewResizing=We(this,e=>this._options.read(e).enableSplitViewResizing);splitViewDefaultRatio=We(this,e=>this._options.read(e).splitViewDefaultRatio);ignoreTrimWhitespace=We(this,e=>this._options.read(e).ignoreTrimWhitespace);maxComputationTimeMs=We(this,e=>this._options.read(e).maxComputationTime);showMoves=We(this,e=>this._options.read(e).experimental.showMoves&&this.renderSideBySide.read(e));isInEmbeddedEditor=We(this,e=>this._options.read(e).isInEmbeddedEditor);diffWordWrap=We(this,e=>this._options.read(e).diffWordWrap);originalEditable=We(this,e=>this._options.read(e).originalEditable);diffCodeLens=We(this,e=>this._options.read(e).diffCodeLens);accessibilityVerbose=We(this,e=>this._options.read(e).accessibilityVerbose);diffAlgorithm=We(this,e=>this._options.read(e).diffAlgorithm);showEmptyDecorations=We(this,e=>this._options.read(e).experimental.showEmptyDecorations);onlyShowAccessibleDiffViewer=We(this,e=>this._options.read(e).onlyShowAccessibleDiffViewer);compactMode=We(this,e=>this._options.read(e).compactMode);trueInlineDiffRenderingEnabled=We(this,e=>this._options.read(e).experimental.useTrueInlineView);useTrueInlineDiffRendering=We(this,e=>!this.renderSideBySide.read(e)&&this.trueInlineDiffRenderingEnabled.read(e));hideUnchangedRegions=We(this,e=>this._options.read(e).hideUnchangedRegions.enabled);hideUnchangedRegionsRevealLineCount=We(this,e=>this._options.read(e).hideUnchangedRegions.revealLineCount);hideUnchangedRegionsContextLineCount=We(this,e=>this._options.read(e).hideUnchangedRegions.contextLineCount);hideUnchangedRegionsMinimumLineCount=We(this,e=>this._options.read(e).hideUnchangedRegions.minimumLineCount);updateOptions(e){let t=T3(e,this._options.get()),i={...this._options.get(),...e,...t};this._options.set(i,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}_model=Ct(this,void 0);setModel(e){this._model.set(e,void 0)}shouldRenderInlineViewInSmartMode=this._model.map(this,e=>kW(this,t=>{let i=e?.diff.read(t);return i?$Q(i,this.trueInlineDiffRenderingEnabled.read(t)):void 0})).flatten().map(this,e=>!!e);inlineViewHideOriginalLineNumbers=this.compactMode};lb=R([y(1,dr)],lb);function $Q(r,e){return r.mappings.every(t=>YQ(t.lineRangeMapping)||ZQ(t.lineRangeMapping)||e&&bC(t.lineRangeMapping))}function YQ(r){return r.original.length===0}function ZQ(r){return r.modified.length===0}function T3(r,e){return{enableSplitViewResizing:we(r.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:vU(r.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:we(r.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:we(r.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:ou(r.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:ou(r.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:we(r.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:we(r.renderIndicators,e.renderIndicators),originalEditable:we(r.originalEditable,e.originalEditable),diffCodeLens:we(r.diffCodeLens,e.diffCodeLens),renderOverviewRuler:we(r.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:vi(r.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:vi(r.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:we(r.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:we(r.experimental?.showMoves,e.experimental.showMoves),showEmptyDecorations:we(r.experimental?.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:we(r.experimental?.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:we(r.hideUnchangedRegions?.enabled??r.experimental?.collapseUnchangedRegions,e.hideUnchangedRegions.enabled),contextLineCount:ou(r.hideUnchangedRegions?.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:ou(r.hideUnchangedRegions?.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:ou(r.hideUnchangedRegions?.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:we(r.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:we(r.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:ou(r.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:we(r.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:we(r.renderGutterMenu,e.renderGutterMenu),compactMode:we(r.compactMode,e.compactMode)}}var db=class extends P{constructor(t,i,n){super();this.model=t;this._options=i;this._diffProviderFactoryService=n;this._register(te(()=>this._cancellationTokenSource.cancel()));let o=mp("contentChangedSignal"),s=this._register(new Kt(()=>o.trigger(void 0),200));this._register(yt(l=>{let d=this._unchangedRegions.read(l);if(!d||d.regions.some(g=>g.isDragged.read(l)))return;let c=d.originalDecorationIds.map(g=>t.original.getDecorationRange(g)).map(g=>g?Fe.fromRangeInclusive(g):void 0),u=d.modifiedDecorationIds.map(g=>t.modified.getDecorationRange(g)).map(g=>g?Fe.fromRangeInclusive(g):void 0),p=d.regions.map((g,b)=>!c[b]||!u[b]?void 0:new cb(c[b].startLineNumber,u[b].startLineNumber,c[b].length,g.visibleLineCountTop.read(l),g.visibleLineCountBottom.read(l))).filter(Ad),m=[],f=!1;for(let g of sm(p,(b,v)=>b.getHiddenModifiedRange(l).endLineNumberExclusive===v.getHiddenModifiedRange(l).startLineNumber))if(g.length>1){f=!0;let b=g.reduce((I,w)=>I+w.lineCount,0),v=new cb(g[0].originalLineNumber,g[0].modifiedLineNumber,b,g[0].visibleLineCountTop.get(),g[g.length-1].visibleLineCountBottom.get());m.push(v)}else m.push(g[0]);if(f){let g=t.original.deltaDecorations(d.originalDecorationIds,m.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=t.modified.deltaDecorations(d.modifiedDecorationIds,m.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));mi(v=>{this._unchangedRegions.set({regions:m,originalDecorationIds:g,modifiedDecorationIds:b},v)})}}));let a=(l,d,c)=>{let u=cb.fromDiffs(l.changes,t.original.getLineCount(),t.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c)),p,m=this._unchangedRegions.get();if(m){let v=m.originalDecorationIds.map(S=>t.original.getDecorationRange(S)).map(S=>S?Fe.fromRangeInclusive(S):void 0),I=m.modifiedDecorationIds.map(S=>t.modified.getDecorationRange(S)).map(S=>S?Fe.fromRangeInclusive(S):void 0),E=J9(m.regions.map((S,T)=>{if(!v[T]||!I[T])return;let D=v[T].length;return new cb(v[T].startLineNumber,I[T].startLineNumber,D,Math.min(S.visibleLineCountTop.get(),D),Math.min(S.visibleLineCountBottom.get(),D-S.visibleLineCountTop.get()))}).filter(Ad),(S,T)=>!T||S.modifiedLineNumber>=T.modifiedLineNumber+T.lineCount&&S.originalLineNumber>=T.originalLineNumber+T.lineCount).map(S=>new Vo(S.getHiddenOriginalRange(c),S.getHiddenModifiedRange(c)));E=Vo.clip(E,Fe.ofLength(1,t.original.getLineCount()),Fe.ofLength(1,t.modified.getLineCount())),p=Vo.inverse(E,t.original.getLineCount(),t.modified.getLineCount())}let f=[];if(p)for(let v of u){let I=p.filter(w=>w.original.intersectsStrict(v.originalUnchangedRange)&&w.modified.intersectsStrict(v.modifiedUnchangedRange));f.push(...v.setVisibleRanges(I,d))}else f.push(...u);let g=t.original.deltaDecorations(m?.originalDecorationIds||[],f.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=t.modified.deltaDecorations(m?.modifiedDecorationIds||[],f.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:f,originalDecorationIds:g,modifiedDecorationIds:b},d)};this._register(t.modified.onDidChangeContent(l=>{if(this._diff.get()){let c=ea.fromModelContentChanges(l.changes),u=(this._lastDiff,t.original,t.modified,void 0);u&&(this._lastDiff=u,mi(p=>{this._diff.set(yC.fromDiffResult(this._lastDiff),p),a(u,p);let m=this.movedTextToCompare.get();this.movedTextToCompare.set(m?this._lastDiff.moves.find(f=>f.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,p)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(t.original.onDidChangeContent(l=>{if(this._diff.get()){let c=ea.fromModelContentChanges(l.changes),u=(this._lastDiff,t.original,t.modified,void 0);u&&(this._lastDiff=u,mi(p=>{this._diff.set(yC.fromDiffResult(this._lastDiff),p),a(u,p);let m=this.movedTextToCompare.get();this.movedTextToCompare.set(m?this._lastDiff.moves.find(f=>f.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,p)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(oo(async(l,d)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(l),this._options.hideUnchangedRegionsContextLineCount.read(l),s.cancel(),o.read(l);let c=this._diffProvider.read(l);c.onChangeSignal.read(l),ca(Sk,l),ca(gC,l),this._isDiffUpToDate.set(!1,void 0);let u=[];d.add(t.original.onDidChangeContent(f=>{let g=ea.fromModelContentChanges(f.changes);u=fg(u,g)}));let p=[];d.add(t.modified.onDidChangeContent(f=>{let g=ea.fromModelContentChanges(f.changes);p=fg(p,g)}));let m=await c.diffProvider.computeDiff(t.original,t.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(l),maxComputationTimeMs:this._options.maxComputationTimeMs.read(l),computeMoves:this._options.showMoves.read(l)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||t.original.isDisposed()||t.modified.isDisposed()||(m=XQ(m,t.original,t.modified),m=(t.original,t.modified,void 0)??m,m=(t.original,t.modified,void 0)??m,mi(f=>{a(m,f),this._lastDiff=m;let g=yC.fromDiffResult(m);this._diff.set(g,f),this._isDiffUpToDate.set(!0,f);let b=this.movedTextToCompare.get();this.movedTextToCompare.set(b?this._lastDiff.moves.find(v=>v.lineRangeMapping.modified.intersect(b.lineRangeMapping.modified)):void 0,f)}))}))}_isDiffUpToDate=Ct(this,!1);isDiffUpToDate=this._isDiffUpToDate;_lastDiff;_diff=Ct(this,void 0);diff=this._diff;_unchangedRegions=Ct(this,void 0);unchangedRegions=We(this,t=>this._options.hideUnchangedRegions.read(t)?this._unchangedRegions.read(t)?.regions??[]:(mi(i=>{for(let n of this._unchangedRegions.get()?.regions||[])n.collapseAll(i)}),[]));movedTextToCompare=Ct(this,void 0);_activeMovedText=Ct(this,void 0);_hoveredMovedText=Ct(this,void 0);activeMovedText=We(this,t=>this.movedTextToCompare.read(t)??this._hoveredMovedText.read(t)??this._activeMovedText.read(t));setActiveMovedText(t){this._activeMovedText.set(t,void 0)}setHoveredMovedText(t){this._hoveredMovedText.set(t,void 0)}_cancellationTokenSource=new Vi;_diffProvider=We(this,t=>{let i=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(t)}),n=ro("onDidChange",i.onDidChange);return{diffProvider:i,onChangeSignal:n}});ensureModifiedLineIsVisible(t,i,n){if(this.diff.get()?.mappings.length===0)return;let o=this._unchangedRegions.get()?.regions||[];for(let s of o)if(s.getHiddenModifiedRange(void 0).contains(t)){s.showModifiedLine(t,i,n);return}}ensureOriginalLineIsVisible(t,i,n){if(this.diff.get()?.mappings.length===0)return;let o=this._unchangedRegions.get()?.regions||[];for(let s of o)if(s.getHiddenOriginalRange(void 0).contains(t)){s.showOriginalLine(t,i,n);return}}async waitForDiff(){await m0(this.isDiffUpToDate,t=>t)}serializeState(){return{collapsedRegions:this._unchangedRegions.get()?.regions.map(i=>({range:i.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(t){let i=t.collapsedRegions?.map(o=>Fe.deserialize(o.range)),n=this._unchangedRegions.get();!n||!i||mi(o=>{for(let s of n.regions)for(let a of i)if(s.modifiedUnchangedRange.intersect(a)){s.setHiddenModifiedRange(a,o);break}})}};db=R([y(2,fB)],db);function XQ(r,e,t){return{changes:r.changes.map(i=>new rs(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>QQ(n,e,t)):void 0)),moves:r.moves,identical:r.identical,quitEarly:r.quitEarly}}function QQ(r,e,t){let i=r.originalRange,n=r.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&n.endColumn===t.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<e.getLineCount()&&n.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new Qo(i,n)}var yC=class r{constructor(e,t,i,n){this.mappings=e;this.movedTexts=t;this.identical=i;this.quitEarly=n}static fromDiffResult(e){return new r(e.changes.map(t=>new vC(t)),e.moves||[],e.identical,e.quitEarly)}},vC=class{constructor(e){this.lineRangeMapping=e}},cb=class r{constructor(e,t,i,n,o){this.originalLineNumber=e;this.modifiedLineNumber=t;this.lineCount=i;let s=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(o,this.lineCount-n),0);a0(n===s),a0(o===a),this._visibleLineCountTop.set(s,void 0),this._visibleLineCountBottom.set(a,void 0)}static fromDiffs(e,t,i,n,o){let s=rs.inverse(e,t,i),a=[];for(let l of s){let d=l.original.startLineNumber,c=l.modified.startLineNumber,u=l.original.length,p=d===1&&c===1,m=d+u===t+1&&c+u===i+1;(p||m)&&u>=o+n?(p&&!m&&(u-=o),m&&!p&&(d+=o,c+=o,u-=o),a.push(new r(d,c,u,0,0))):u>=o*2+n&&(d+=o,c+=o,u-=o*2,a.push(new r(d,c,u,0,0)))}return a}get originalUnchangedRange(){return Fe.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return Fe.ofLength(this.modifiedLineNumber,this.lineCount)}_visibleLineCountTop=Ct(this,0);visibleLineCountTop=this._visibleLineCountTop;_visibleLineCountBottom=Ct(this,0);visibleLineCountBottom=this._visibleLineCountBottom;_shouldHideControls=We(this,e=>this.visibleLineCountTop.read(e)+this.visibleLineCountBottom.read(e)===this.lineCount&&!this.isDragged.read(e));isDragged=Ct(this,void 0);setVisibleRanges(e,t){let i=[],n=new _s(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange),o=this.originalLineNumber,s=this.modifiedLineNumber,a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(t),i.push(this);else{let l=0;for(let d of n.ranges){let c=l===n.ranges.length-1;l++;let u=(c?a:d.endLineNumberExclusive)-s,p=new r(o,s,u,0,0);p.setHiddenModifiedRange(d,t),i.push(p),o=p.originalUnchangedRange.endLineNumberExclusive,s=p.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return Fe.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return Fe.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){let i=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,n,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){let i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){let i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,i){let n=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),o=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&n<o||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+o,i)}showOriginalLine(e,t,i){let n=e-this.originalLineNumber,o=this.originalLineNumber+this.lineCount-e;t===0&&n<o||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+o-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-o,this.getMaxVisibleLineCountBottom()),i)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}};var io=class extends P{constructor(t,i,n,o,s,a,l){super();this._editors=t;this._rootElement=i;this._diffModel=n;this._rootWidth=o;this._rootHeight=s;this._modifiedEditorLayoutInfo=a;this._themeService=l;let d=zt(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=We(m=>{let f=d.read(m),g=f.getColor(Oz)||(f.getColor(Az)||gx).transparent(2),b=f.getColor(Pz)||(f.getColor(Mz)||fx).transparent(2);return{insertColor:g,removeColor:b}}),u=$e(document.createElement("div"));u.setClassName("diffViewport"),u.setPosition("absolute");let p=Tt("div.diffOverview",{style:{position:"absolute",top:"0px",width:io.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(jh(p,u.domNode)),this._register(si(p,Q.POINTER_DOWN,m=>{this._editors.modified.delegateVerticalScrollbarPointerDown(m)})),this._register(B(p,Q.MOUSE_WHEEL,m=>{this._editors.modified.delegateScrollFromMouseWheelEvent(m)},{passive:!1})),this._register(jh(this._rootElement,p)),this._register(oo((m,f)=>{let g=this._diffModel.read(m),b=this._editors.original.createOverviewRuler("original diffOverviewRuler");b&&(f.add(b),f.add(jh(p,b.getDomNode())));let v=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(v&&(f.add(v),f.add(jh(p,v.getDomNode()))),!b||!v)return;let I=ro("viewZoneChanged",this._editors.original.onDidChangeViewZones),w=ro("viewZoneChanged",this._editors.modified.onDidChangeViewZones),E=ro("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),S=ro("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);f.add(yt(T=>{I.read(T),w.read(T),E.read(T),S.read(T);let D=c.read(T),L=g?.diff.read(T)?.mappings;function A(G,oe,_e){let re=_e._getViewModel();return re?G.filter(ne=>ne.length>0).map(ne=>{let ge=re.coordinatesConverter.convertModelPositionToViewPosition(new F(ne.startLineNumber,1)),de=re.coordinatesConverter.convertModelPositionToViewPosition(new F(ne.endLineNumberExclusive,1)),se=de.lineNumber-ge.lineNumber;return new fI(ge.lineNumber,de.lineNumber,se,oe.toString())}):[]}let W=A((L||[]).map(G=>G.lineRangeMapping.original),D.removeColor,this._editors.original),j=A((L||[]).map(G=>G.lineRangeMapping.modified),D.insertColor,this._editors.modified);b?.setZones(W),v?.setZones(j)})),f.add(yt(T=>{let D=this._rootHeight.read(T),L=this._rootWidth.read(T),A=this._modifiedEditorLayoutInfo.read(T);if(A){let W=io.ENTIRE_DIFF_OVERVIEW_WIDTH-2*io.ONE_OVERVIEW_WIDTH;b.setLayout({top:0,height:D,right:W+io.ONE_OVERVIEW_WIDTH,width:io.ONE_OVERVIEW_WIDTH}),v.setLayout({top:0,height:D,right:0,width:io.ONE_OVERVIEW_WIDTH});let j=this._editors.modifiedScrollTop.read(T),G=this._editors.modifiedScrollHeight.read(T),oe=this._editors.modified.getOption(105),_e=new Kc(oe.verticalHasArrows?oe.arrowSize:0,oe.verticalScrollbarSize,0,A.height,G,j);u.setTop(_e.getSliderPosition()),u.setHeight(_e.getSliderSize())}else u.setTop(0),u.setHeight(0);p.style.height=D+"px",p.style.left=L-io.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",u.setWidth(io.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}static ONE_OVERVIEW_WIDTH=15;static ENTIRE_DIFF_OVERVIEW_WIDTH=this.ONE_OVERVIEW_WIDTH*2;width=io.ENTIRE_DIFF_OVERVIEW_WIDTH};io=R([y(6,kt)],io);var ub=class extends P{constructor(t,i,n,o,s,a,l){super();this.originalEditorElement=t;this.modifiedEditorElement=i;this._options=n;this._argCodeEditorWidgetOptions=o;this._createInnerEditor=s;this._instantiationService=a;this._keybindingService=l;this._argCodeEditorWidgetOptions=null,this._register(kc({createEmptyChangeSummary:()=>({}),handleChange:(d,c)=>(d.didChange(n.editorOptions)&&Object.assign(c,d.change.changedOptions),!0)},(d,c)=>{n.editorOptions.read(d),this._options.renderSideBySide.read(d),this.modified.updateOptions(this._adjustOptionsForRightHandSide(d,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(d,c))}))}original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{}));modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{}));_onDidContentSizeChange=this._register(new _);get onDidContentSizeChange(){return this._onDidContentSizeChange.event}modifiedScrollTop=zt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop());modifiedScrollHeight=zt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight());modifiedObs=qh(this.modified);originalObs=qh(this.original);modifiedModel=this.modifiedObs.model;modifiedSelections=zt(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]);modifiedCursor=fl({owner:this,equalsFn:F.equals},t=>this.modifiedSelections.read(t)[0]?.getPosition()??new F(1,1));originalCursor=zt(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new F(1,1));isOriginalFocused=qh(this.original).isFocused;isModifiedFocused=qh(this.modified).isFocused;isFocused=We(this,t=>this.isOriginalFocused.read(t)||this.isModifiedFocused.read(t));_createLeftHandSideEditor(t,i){let n=this._adjustOptionsForLeftHandSide(void 0,t),o=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,n,i);return o.setContextValue("isInDiffLeftEditor",!0),o}_createRightHandSideEditor(t,i){let n=this._adjustOptionsForRightHandSide(void 0,t),o=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,n,i);return o.setContextValue("isInDiffRightEditor",!0),o}_constructInnerEditor(t,i,n,o){let s=this._createInnerEditor(t,i,n,o);return this._register(s.onDidContentSizeChange(a=>{let l=this.original.getContentWidth()+this.modified.getContentWidth()+io.ENTIRE_DIFF_OVERVIEW_WIDTH,d=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:d,contentWidth:l,contentHeightChanged:a.contentHeightChanged,contentWidthChanged:a.contentWidthChanged})})),s}_adjustOptionsForLeftHandSide(t,i){let n=this._adjustOptionsForSubEditor(i);return this._options.renderSideBySide.get()?(n.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},n.wordWrapOverride1=this._options.diffWordWrap.get()):(n.wordWrapOverride1="off",n.wordWrapOverride2="off",n.stickyScroll={enabled:!1},n.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),n.glyphMargin=this._options.renderSideBySide.get(),i.originalAriaLabel&&(n.ariaLabel=i.originalAriaLabel),n.ariaLabel=this._updateAriaLabel(n.ariaLabel),n.readOnly=!this._options.originalEditable.get(),n.dropIntoEditor={enabled:!n.readOnly},n.extraEditorClassName="original-in-monaco-diff-editor",n}_adjustOptionsForRightHandSide(t,i){let n=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(n.ariaLabel=i.modifiedAriaLabel),n.ariaLabel=this._updateAriaLabel(n.ariaLabel),n.wordWrapOverride1=this._options.diffWordWrap.get(),n.revealHorizontalRightPadding=Xs.revealHorizontalRightPadding.defaultValue+io.ENTIRE_DIFF_OVERVIEW_WIDTH,n.scrollbar.verticalHasArrows=!1,n.extraEditorClassName="modified-in-monaco-diff-editor",n}_adjustOptionsForSubEditor(t){let i={...t,dimension:{height:0,width:0}};return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar={...i.scrollbar||{}},i.folding=!1,i.codeLens=this._options.diffCodeLens.get(),i.fixedOverflowWidgets=!0,i.minimap={...i.minimap||{}},i.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?i.stickyScroll={enabled:!1}:i.stickyScroll=this._options.editorOptions.get().stickyScroll,i}_updateAriaLabel(t){t||(t="");let i=h("diff-aria-navigation-tip"," use {0} to open the accessibility help.",this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel());return this._options.accessibilityVerbose.get()?t+i:t?t.replaceAll(i,""):""}};ub=R([y(5,ve),y(6,qt)],ub);var JQ=$o("diff-review-insert",ie.add,h("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),eJ=$o("diff-review-remove",ie.remove,h("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),tJ=$o("diff-review-close",ie.close,h("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer.")),hd=class extends P{constructor(t,i,n,o,s,a,l,d,c){super();this._parentNode=t;this._visible=i;this._setVisible=n;this._canClose=o;this._width=s;this._height=a;this._diffs=l;this._models=d;this._instantiationService=c}static _ttPolicy=Pu("diffReview",{createHTML:t=>t});_state=Ld(this,(t,i)=>{let n=this._visible.read(t);if(this._parentNode.style.visibility=n?"visible":"hidden",!n)return null;let o=i.add(this._instantiationService.createInstance(CC,this._diffs,this._models,this._setVisible,this._canClose)),s=i.add(this._instantiationService.createInstance(SC,this._parentNode,o,this._width,this._height,this._models));return{model:o,view:s}}).recomputeInitiallyAndOnChange(this._store);next(){mi(t=>{let i=this._visible.get();this._setVisible(!0,t),i&&this._state.get().model.nextGroup(t)})}prev(){mi(t=>{this._setVisible(!0,t),this._state.get().model.previousGroup(t)})}close(){mi(t=>{this._setVisible(!1,t)})}};hd=R([y(8,ve)],hd);var CC=class extends P{constructor(t,i,n,o,s){super();this._diffs=t;this._models=i;this._setVisible=n;this.canClose=o;this._accessibilitySignalService=s;this._register(yt(a=>{let l=this._diffs.read(a);if(!l){this._groups.set([],void 0);return}let d=iJ(l,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());mi(c=>{let u=this._models.getModifiedPosition();if(u){let p=d.findIndex(m=>u?.lineNumber<m.range.modified.endLineNumberExclusive);p!==-1&&this._currentGroupIdx.set(p,c)}this._groups.set(d,c)})})),this._register(yt(a=>{let l=this.currentElement.read(a);l?.type===2?this._accessibilitySignalService.playSignal(ls.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):l?.type===3&&this._accessibilitySignalService.playSignal(ls.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(yt(a=>{let l=this.currentElement.read(a);if(l&&l.type!==0){let d=l.modifiedLineNumber??l.diff.modified.startLineNumber;this._models.modifiedSetSelection(O.fromPositions(new F(d,1)))}}))}_groups=Ct(this,[]);_currentGroupIdx=Ct(this,0);_currentElementIdx=Ct(this,0);groups=this._groups;currentGroup=this._currentGroupIdx.map((t,i)=>this._groups.read(i)[t]);currentGroupIndex=this._currentGroupIdx;currentElement=this._currentElementIdx.map((t,i)=>this.currentGroup.read(i)?.lines[t]);_goToGroupDelta(t,i){let n=this.groups.get();!n||n.length<=1||gp(i,o=>{this._currentGroupIdx.set(Be.ofLength(n.length).clipCyclic(this._currentGroupIdx.get()+t),o),this._currentElementIdx.set(0,o)})}nextGroup(t){this._goToGroupDelta(1,t)}previousGroup(t){this._goToGroupDelta(-1,t)}_goToLineDelta(t){let i=this.currentGroup.get();!i||i.lines.length<=1||mi(n=>{this._currentElementIdx.set(Be.ofLength(i.lines.length).clip(this._currentElementIdx.get()+t),n)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(t){let i=this.currentGroup.get();if(!i)return;let n=i.lines.indexOf(t);n!==-1&&mi(o=>{this._currentElementIdx.set(n,o)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);let t=this.currentElement.get();t&&(t.type===2?this._models.originalReveal(O.fromPositions(new F(t.originalLineNumber,1))):this._models.modifiedReveal(t.type!==0?O.fromPositions(new F(t.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};CC=R([y(4,fk)],CC);var IC=3;function iJ(r,e,t){let i=[];for(let n of sm(r,(o,s)=>s.modified.startLineNumber-o.modified.endLineNumberExclusive<2*IC)){let o=[];o.push(new DB);let s=new Fe(Math.max(1,n[0].original.startLineNumber-IC),Math.min(n[n.length-1].original.endLineNumberExclusive+IC,e+1)),a=new Fe(Math.max(1,n[0].modified.startLineNumber-IC),Math.min(n[n.length-1].modified.endLineNumberExclusive+IC,t+1));cS(n,(c,u)=>{let p=new Fe(c?c.original.endLineNumberExclusive:s.startLineNumber,u?u.original.startLineNumber:s.endLineNumberExclusive),m=new Fe(c?c.modified.endLineNumberExclusive:a.startLineNumber,u?u.modified.startLineNumber:a.endLineNumberExclusive);p.forEach(f=>{o.push(new RB(f,m.startLineNumber+(f-p.startLineNumber)))}),u&&(u.original.forEach(f=>{o.push(new LB(u,f))}),u.modified.forEach(f=>{o.push(new kB(u,f))}))});let l=n[0].modified.join(n[n.length-1].modified),d=n[0].original.join(n[n.length-1].original);i.push(new _B(new Vo(l,d),o))}return i}var _B=class{constructor(e,t){this.range=e;this.lines=t}},DB=class{type=0},LB=class{constructor(e,t){this.diff=e;this.originalLineNumber=t}type=2;modifiedLineNumber=void 0},kB=class{constructor(e,t){this.diff=e;this.modifiedLineNumber=t}type=3;originalLineNumber=void 0},RB=class{constructor(e,t){this.originalLineNumber=e;this.modifiedLineNumber=t}type=1},SC=class extends P{constructor(t,i,n,o,s,a){super();this._element=t;this._model=i;this._width=n;this._height=o;this._models=s;this._languageService=a;this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";let l=document.createElement("div");l.className="diff-review-actions",this._actionBar=this._register(new Pn(l)),this._register(yt(d=>{this._actionBar.clear(),this._model.canClose.read(d)&&this._actionBar.push(new Si("diffreview.close",h("label.close","Close"),"close-diff-review "+Ae.asClassName(tJ),!0,async()=>i.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new Ys(this._content,{})),gn(this.domNode,this._scrollbar.getDomNode(),l),this._register(yt(d=>{this._height.read(d),this._width.read(d),this._scrollbar.scanDomNode()})),this._register(te(()=>{gn(this.domNode)})),this._register(Ns(this.domNode,{width:this._width,height:this._height})),this._register(Ns(this._content,{width:this._width,height:this._height})),this._register(oo((d,c)=>{this._model.currentGroup.read(d),this._render(c)})),this._register(si(this.domNode,"keydown",d=>{(d.equals(18)||d.equals(2066)||d.equals(530))&&(d.preventDefault(),this._model.goToNextLine()),(d.equals(16)||d.equals(2064)||d.equals(528))&&(d.preventDefault(),this._model.goToPreviousLine()),(d.equals(9)||d.equals(2057)||d.equals(521)||d.equals(1033))&&(d.preventDefault(),this._model.close()),(d.equals(10)||d.equals(3))&&(d.preventDefault(),this._model.revealCurrentElementInEditor())}))}domNode;_content;_scrollbar;_actionBar;_render(t){let i=this._models.getOriginalOptions(),n=this._models.getModifiedOptions(),o=document.createElement("div");o.className="diff-review-table",o.setAttribute("role","list"),o.setAttribute("aria-label",h("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),Ti(o,n.get(51)),gn(this._content,o);let s=this._models.getOriginalModel(),a=this._models.getModifiedModel();if(!s||!a)return;let l=s.getOptions(),d=a.getOptions(),c=n.get(68),u=this._model.currentGroup.get();for(let p of u?.lines||[]){if(!u)break;let m;if(p.type===0){let g=document.createElement("div");g.className="diff-review-row",g.setAttribute("role","listitem");let b=u.range,v=this._model.currentGroupIndex.get(),I=this._model.groups.get().length,w=D=>D===0?h("no_lines_changed","no lines changed"):D===1?h("one_line_changed","1 line changed"):h("more_lines_changed","{0} lines changed",D),E=w(b.original.length),S=w(b.modified.length);g.setAttribute("aria-label",h({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",v+1,I,b.original.startLineNumber,E,b.modified.startLineNumber,S));let T=document.createElement("div");T.className="diff-review-cell diff-review-summary",T.appendChild(document.createTextNode(`${v+1}/${I}: @@ -${b.original.startLineNumber},${b.original.length} +${b.modified.startLineNumber},${b.modified.length} @@`)),g.appendChild(T),m=g}else m=this._createRow(p,c,this._width.get(),i,s,l,n,a,d);o.appendChild(m);let f=We(g=>this._model.currentElement.read(g)===p);t.add(yt(g=>{let b=f.read(g);m.tabIndex=b?0:-1,b&&m.focus()})),t.add(B(m,"focus",()=>{this._model.goToLine(p)}))}this._scrollbar.scanDomNode()}_createRow(t,i,n,o,s,a,l,d,c){let u=o.get(147),p=u.glyphMarginWidth+u.lineNumbersWidth,m=l.get(147),f=10+m.glyphMarginWidth+m.lineNumbersWidth,g="diff-review-row",b="",v="diff-review-spacer",I=null;switch(t.type){case 3:g="diff-review-row line-insert",b=" char-insert",I=JQ;break;case 2:g="diff-review-row line-delete",b=" char-delete",I=eJ;break}let w=document.createElement("div");w.style.minWidth=n+"px",w.className=g,w.setAttribute("role","listitem"),w.ariaLevel="";let E=document.createElement("div");E.className="diff-review-cell",E.style.height=`${i}px`,w.appendChild(E);let S=document.createElement("span");S.style.width=p+"px",S.style.minWidth=p+"px",S.className="diff-review-line-number"+b,t.originalLineNumber!==void 0?S.appendChild(document.createTextNode(String(t.originalLineNumber))):S.innerText="\xA0",E.appendChild(S);let T=document.createElement("span");T.style.width=f+"px",T.style.minWidth=f+"px",T.style.paddingRight="10px",T.className="diff-review-line-number"+b,t.modifiedLineNumber!==void 0?T.appendChild(document.createTextNode(String(t.modifiedLineNumber))):T.innerText="\xA0",E.appendChild(T);let D=document.createElement("span");if(D.className=v,I){let W=document.createElement("span");W.className=Ae.asClassName(I),W.innerText="\xA0\xA0",D.appendChild(W)}else D.innerText="\xA0\xA0";E.appendChild(D);let L;if(t.modifiedLineNumber!==void 0){let W=this._getLineHtml(d,l,c.tabSize,t.modifiedLineNumber,this._languageService.languageIdCodec);hd._ttPolicy&&(W=hd._ttPolicy.createHTML(W)),E.insertAdjacentHTML("beforeend",W),L=d.getLineContent(t.modifiedLineNumber)}else{let W=this._getLineHtml(s,o,a.tabSize,t.originalLineNumber,this._languageService.languageIdCodec);hd._ttPolicy&&(W=hd._ttPolicy.createHTML(W)),E.insertAdjacentHTML("beforeend",W),L=s.getLineContent(t.originalLineNumber)}L.length===0&&(L=h("blankLine","blank"));let A="";switch(t.type){case 1:t.originalLineNumber===t.modifiedLineNumber?A=h({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",L,t.originalLineNumber):A=h("equalLine","{0} original line {1} modified line {2}",L,t.originalLineNumber,t.modifiedLineNumber);break;case 3:A=h("insertLine","+ {0} modified line {1}",L,t.modifiedLineNumber);break;case 2:A=h("deleteLine","- {0} original line {1}",L,t.originalLineNumber);break}return w.setAttribute("aria-label",A),w}_getLineHtml(t,i,n,o,s){let a=t.getLineContent(o),l=i.get(51),d=Xi.createEmpty(a,s),c=Zl.isBasicASCII(a,t.mightContainNonBasicASCII()),u=Zl.containsRTL(a,c,t.mightContainRTL());return x9(new Nu(l.isMonospace&&!i.get(33),l.canUseHalfwidthRightwardsArrow,a,!1,c,u,0,d,[],n,0,l.spaceWidth,l.middotWidth,l.wsmiddotWidth,i.get(119),i.get(101),i.get(96),i.get(52)!==ka.OFF,null)).html}};SC=R([y(5,Ki)],SC);var Tk=class{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}};var Hu=class r extends P{constructor(t,i,n,o,s){super();this._rootElement=t;this._diffModel=i;this._originalEditorLayoutInfo=n;this._modifiedEditorLayoutInfo=o;this._editors=s;this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(te(()=>this._element.remove())),this._register(yt(u=>{let p=this._originalEditorLayoutInfo.read(u),m=this._modifiedEditorLayoutInfo.read(u);!p||!m||(this._element.style.left=`${p.width-p.verticalScrollbarWidth}px`,this._element.style.height=`${p.height}px`,this._element.style.width=`${p.verticalScrollbarWidth+p.contentLeft-r.movedCodeBlockPadding+this.width.read(u)}px`)})),this._register(pm(this._state));let a=We(u=>{let m=this._diffModel.read(u)?.diff.read(u);return m?m.movedTexts.map(f=>({move:f,original:new dd(Rc(f.lineRangeMapping.original.startLineNumber-1),18),modified:new dd(Rc(f.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(ob(this._editors.original,a.map(u=>u.map(p=>p.original)))),this._register(ob(this._editors.modified,a.map(u=>u.map(p=>p.modified)))),this._register(oo((u,p)=>{let m=a.read(u);for(let f of m)p.add(new _k(this._editors.original,f.original,f.move,"original",this._diffModel.get())),p.add(new _k(this._editors.modified,f.modified,f.move,"modified",this._diffModel.get()))}));let l=ro("original.onDidFocusEditorWidget",u=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),d=ro("modified.onDidFocusEditorWidget",u=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),c="modified";this._register(kc({createEmptyChangeSummary:()=>{},handleChange:(u,p)=>(u.didChange(l)&&(c="original"),u.didChange(d)&&(c="modified"),!0)},u=>{l.read(u),d.read(u);let p=this._diffModel.read(u);if(!p)return;let m=p.diff.read(u),f;if(m&&c==="original"){let g=this._editors.originalCursor.read(u);g&&(f=m.movedTexts.find(b=>b.lineRangeMapping.original.contains(g.lineNumber)))}if(m&&c==="modified"){let g=this._editors.modifiedCursor.read(u);g&&(f=m.movedTexts.find(b=>b.lineRangeMapping.modified.contains(g.lineNumber)))}f!==p.movedTextToCompare.get()&&p.movedTextToCompare.set(void 0,void 0),p.setActiveMovedText(f)}))}static movedCodeBlockPadding=4;_element;_originalScrollTop=zt(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop());_modifiedScrollTop=zt(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop());_viewZonesChanged=ro("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);width=Ct(this,0);_modifiedViewZonesChangedSignal=ro("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);_originalViewZonesChangedSignal=ro("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones);_state=Ld(this,(t,i)=>{this._element.replaceChildren();let n=this._diffModel.read(t),o=n?.diff.read(t)?.movedTexts;if(!o||o.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(t);let s=this._originalEditorLayoutInfo.read(t),a=this._modifiedEditorLayoutInfo.read(t);if(!s||!a){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(t),this._originalViewZonesChangedSignal.read(t);let l=o.map(g=>{function b(A,W){let j=W.getTopForLineNumber(A.startLineNumber,!0),G=W.getTopForLineNumber(A.endLineNumberExclusive,!0);return(j+G)/2}let v=b(g.lineRangeMapping.original,this._editors.original),I=this._originalScrollTop.read(t),w=b(g.lineRangeMapping.modified,this._editors.modified),E=this._modifiedScrollTop.read(t),S=v-I,T=w-E,D=Math.min(v,w),L=Math.max(v,w);return{range:new Be(D,L),from:S,to:T,fromWithoutScroll:v,toWithoutScroll:w,move:g}});l.sort(XV(ir(g=>g.fromWithoutScroll>g.toWithoutScroll,QV),ir(g=>g.fromWithoutScroll>g.toWithoutScroll?g.fromWithoutScroll:-g.toWithoutScroll,ul)));let d=AB.compute(l.map(g=>g.range)),c=10,u=s.verticalScrollbarWidth,p=(d.getTrackCount()-1)*10+c*2,m=u+p+(a.contentLeft-r.movedCodeBlockPadding),f=0;for(let g of l){let b=d.getTrack(f),v=u+c+b*10,I=15,w=15,E=m,S=a.glyphMarginWidth+a.lineNumbersWidth,T=18,D=document.createElementNS("http://www.w3.org/2000/svg","rect");D.classList.add("arrow-rectangle"),D.setAttribute("x",`${E-S}`),D.setAttribute("y",`${g.to-T/2}`),D.setAttribute("width",`${S}`),D.setAttribute("height",`${T}`),this._element.appendChild(D);let L=document.createElementNS("http://www.w3.org/2000/svg","g"),A=document.createElementNS("http://www.w3.org/2000/svg","path");A.setAttribute("d",`M 0 ${g.from} L ${v} ${g.from} L ${v} ${g.to} L ${E-w} ${g.to}`),A.setAttribute("fill","none"),L.appendChild(A);let W=document.createElementNS("http://www.w3.org/2000/svg","polygon");W.classList.add("arrow"),i.add(yt(j=>{A.classList.toggle("currentMove",g.move===n.activeMovedText.read(j)),W.classList.toggle("currentMove",g.move===n.activeMovedText.read(j))})),W.setAttribute("points",`${E-w},${g.to-I/2} ${E},${g.to} ${E-w},${g.to+I/2}`),L.appendChild(W),this._element.appendChild(L),f++}this.width.set(p,void 0)})},AB=class r{constructor(e,t){this._trackCount=e;this.trackPerLineIdx=t}static compute(e){let t=[],i=[];for(let n of e){let o=t.findIndex(s=>!s.intersectsStrict(n));o===-1&&(t.length>=6?o=GV(t,ir(a=>a.intersectWithRangeLength(n),ul)):(o=t.length,t.push(new Iw))),t[o].addRange(n),i.push(o)}return new r(t.length,i)}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}},_k=class extends Kh{constructor(t,i,n,o,s){let a=Tt("div.diff-hidden-lines-widget");super(t,i,a.root);this._editor=t;this._move=n;this._kind=o;this._diffModel=s;a.root.appendChild(this._nodes.root);let l=zt(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Ns(this._nodes.root,{paddingRight:l.map(m=>m.verticalScrollbarWidth)}));let d;n.changes.length>0?d=this._kind==="original"?h("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):h("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):d=this._kind==="original"?h("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):h("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);let c=this._register(new Pn(this._nodes.actionBar,{highlightToggledItems:!0})),u=new Si("",d,"",!1);c.push(u,{icon:!1,label:!0});let p=new Si("","Compare",Ae.asClassName(ie.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===n?void 0:this._move,void 0)});this._register(yt(m=>{let f=this._diffModel.movedTextToCompare.read(m)===n;p.checked=f})),c.push(p,{icon:!1,label:!0})}_nodes=Tt("div.diff-moved-code-block",{style:{marginRight:"4px"}},[Tt("div.text-content@textContent"),Tt("div.action-bar@actionBar")])};var Dk=class extends P{constructor(t,i,n,o){super();this._editors=t;this._diffModel=i;this._options=n;this._register(nb(this._editors.original,this._decorations.map(s=>s?.originalDecorations||[]))),this._register(nb(this._editors.modified,this._decorations.map(s=>s?.modifiedDecorations||[])))}_decorations=We(this,t=>{let i=this._diffModel.read(t),n=i?.diff.read(t);if(!n)return null;let o=this._diffModel.read(t).movedTextToCompare.read(t),s=this._options.renderIndicators.read(t),a=this._options.showEmptyDecorations.read(t),l=[],d=[];if(!o)for(let u of n.mappings)if(u.lineRangeMapping.original.isEmpty||l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:s?EB:xB}),u.lineRangeMapping.modified.isEmpty||d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:s?SB:wB}),u.lineRangeMapping.modified.isEmpty||u.lineRangeMapping.original.isEmpty)u.lineRangeMapping.original.isEmpty||l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:b3}),u.lineRangeMapping.modified.isEmpty||d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:g3});else{let p=this._options.useTrueInlineDiffRendering.read(t)&&bC(u.lineRangeMapping);for(let m of u.lineRangeMapping.innerChanges||[])if(u.lineRangeMapping.original.contains(m.originalRange.startLineNumber)&&l.push({range:m.originalRange,options:m.originalRange.isEmpty()&&a?v3:fC}),u.lineRangeMapping.modified.contains(m.modifiedRange.startLineNumber)&&d.push({range:m.modifiedRange,options:m.modifiedRange.isEmpty()&&a&&!p?f3:TB}),p){let f=i.model.original.getValueInRange(m.originalRange);d.push({range:m.modifiedRange,options:{description:"deleted-text",before:{content:f,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(o)for(let u of o.changes){let p=u.original.toInclusiveRange();p&&l.push({range:p,options:s?EB:xB});let m=u.modified.toInclusiveRange();m&&d.push({range:m,options:s?SB:wB});for(let f of u.innerChanges||[])l.push({range:f.originalRange,options:fC}),d.push({range:f.modifiedRange,options:TB})}let c=this._diffModel.read(t).activeMovedText.read(t);for(let u of n.movedTexts)l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(u===c?" currentMove":""),blockPadding:[Hu.movedCodeBlockPadding,0,Hu.movedCodeBlockPadding,Hu.movedCodeBlockPadding]}}),d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(u===c?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:l,modifiedDecorations:d}})};var Lk=class{constructor(e,t){this._options=e;this.dimensions=t}sashLeft=um(this,e=>{let t=this._sashRatio.read(e)??this._options.splitViewDefaultRatio.read(e);return this._computeSashLeft(t,e)},(e,t)=>{let i=this.dimensions.width.get();this._sashRatio.set(e/i,t)});_sashRatio=Ct(this,void 0);resetSash(){this._sashRatio.set(void 0,void 0)}_computeSashLeft(e,t){let i=this.dimensions.width.read(t),n=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),o=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):n,s=100;return i<=s*2?n:o<s?s:o>i-s?i-s:o}},pb=class extends P{constructor(t,i,n,o,s,a){super();this._domNode=t;this._dimensions=i;this._enabled=n;this._boundarySashes=o;this.sashLeft=s;this._resetSash=a;this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(l=>{this.sashLeft.set(this._startSashPosition+(l.currentX-l.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(yt(l=>{let d=this._boundarySashes.read(l);d&&(this._sash.orthogonalEndSash=d.bottom)})),this._register(yt(l=>{let d=this._enabled.read(l);this._sash.state=d?3:0,this.sashLeft.read(l),this._dimensions.height.read(l),this._sash.layout()}))}_sash=this._register(new rh(this._domNode,{getVerticalSashTop:t=>0,getVerticalSashLeft:t=>this.sashLeft.get(),getVerticalSashHeight:t=>this._dimensions.height.get()},{orientation:0}));_startSashPosition=void 0};var kk=class extends P{constructor(t,i,n){super();this._editor=t;this._domNode=i;this.itemProvider=n;this._domNode.className="gutter monaco-editor";let o=this._domNode.appendChild(Tt("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{mi(a=>{this.domNodeSizeChanged.trigger(a)})});s.observe(this._domNode),this._register(te(()=>s.disconnect())),this._register(yt(a=>{o.className=this.isScrollTopZero.read(a)?"":"scroll-decoration"})),this._register(yt(a=>this.render(a)))}scrollTop=zt(this,this._editor.onDidScrollChange,t=>this._editor.getScrollTop());isScrollTopZero=this.scrollTop.map(t=>t===0);modelAttached=zt(this,this._editor.onDidChangeModel,t=>this._editor.hasModel());editorOnDidChangeViewZones=ro("onDidChangeViewZones",this._editor.onDidChangeViewZones);editorOnDidContentSizeChange=ro("onDidContentSizeChange",this._editor.onDidContentSizeChange);domNodeSizeChanged=mp("domNodeSizeChanged");dispose(){super.dispose(),gn(this._domNode)}views=new Map;render(t){if(!this.modelAttached.read(t))return;this.domNodeSizeChanged.read(t),this.editorOnDidChangeViewZones.read(t),this.editorOnDidContentSizeChange.read(t);let i=this.scrollTop.read(t),n=this._editor.getVisibleRanges(),o=new Set(this.views.keys()),s=Be.ofStartAndLength(0,this._domNode.clientHeight);if(!s.isEmpty)for(let a of n){let l=new Fe(a.startLineNumber,a.endLineNumber+1),d=this.itemProvider.getIntersectingGutterItems(l,t);mi(c=>{for(let u of d){if(!u.range.intersect(l))continue;o.delete(u.id);let p=this.views.get(u.id);if(p)p.item.set(u,c);else{let b=document.createElement("div");this._domNode.appendChild(b);let v=Ct("item",u),I=this.itemProvider.createView(v,b);p=new MB(v,I,b),this.views.set(u.id,p)}let m=u.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(u.range.startLineNumber,!0)-i:this._editor.getBottomForLineNumber(u.range.startLineNumber-1,!1)-i,g=(u.range.endLineNumberExclusive===1?Math.max(m,this._editor.getTopForLineNumber(u.range.startLineNumber,!1)-i):Math.max(m,this._editor.getBottomForLineNumber(u.range.endLineNumberExclusive-1,!0)-i))-m;p.domNode.style.top=`${m}px`,p.domNode.style.height=`${g}px`,p.gutterItemView.layout(Be.ofStartAndLength(m,g),s)}})}for(let a of o){let l=this.views.get(a);l.gutterItemView.dispose(),l.domNode.remove(),this.views.delete(a)}}},MB=class{constructor(e,t,i){this.item=e;this.gutterItemView=t;this.domNode=i}};var Rk=class extends lo{constructor(t){super();this._getContext=t}runAction(t,i){let n=this._getContext();return super.runAction(t,n)}};var EC=class extends hI{constructor(t){super();this._textModel=t}getValueOfRange(t){return this._textModel.getValueInRange(t)}get length(){let t=this._textModel.getLineCount(),i=this._textModel.getLineLength(t);return new wr(t-1,i)}};var Uu=class extends mo{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new _);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(e,t,i,n=Object.create(null)){super(null,e,n),this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;let t=o=>{this.element=ye(o,he("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(tn().setupManagedHover(this.options.hoverDelegate??Dt("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new d_(e,n)),this._register(this.dropdownMenu.onDidChangeVisibility(o=>{this.element?.setAttribute("aria-expanded",`${o}`),this._onDidChangeVisibility.fire(o)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let o=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return o.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){let e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}};var Ak=class extends P{options;actionBar;toggleMenuAction;toggleMenuActionViewItem;submenuActionViewItems=[];hasSecondaryActions=!1;element;_onDidChangeDropdownVisibility=this._register(new fv);onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event;disposables=this._register(new Y);constructor(e,t,i={orientation:0}){super(),i.hoverDelegate=i.hoverDelegate??this._register(Vd()),this.options=i,this.toggleMenuAction=this._register(new hb(()=>this.toggleMenuActionViewItem?.show(),i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new Pn(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,o)=>{if(n.id===hb.ID)return this.toggleMenuActionViewItem=new Uu(n,n.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Ae.asClassNameArray(i.moreIcon??ie.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){let s=i.actionViewItemProvider(n,o);if(s)return s}if(n instanceof Nd){let s=new Uu(n,n.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return s.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(s),this.disposables.add(this._onDidChangeDropdownVisibility.add(s.onDidChangeVisibility)),s}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){this.actionBar.context=e,this.toggleMenuActionViewItem?.setActionContext(e);for(let t of this.submenuActionViewItems)t.setActionContext(e)}getElement(){return this.element}focus(){this.actionBar.focus()}getItemsWidth(){let e=0;for(let t=0;t<this.actionBar.length();t++)e+=this.actionBar.getWidth(t);return e}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}getItemsLength(){return this.actionBar.length()}setAriaLabel(e){this.actionBar.setAriaLabel(e)}setActions(e,t){this.clear();let i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})})}isEmpty(){return this.actionBar.isEmpty()}getKeybindingLabel(e){return this.options.getKeyBinding?.(e)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}},hb=class r extends Si{static ID="toolbar.toggle.more";_menuActions;toggleDropdownMenu;constructor(e,t){t=t||h("moreActions","More Actions..."),super(r.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};function zu(r,e,t,i,n,o){let s,a,l,d,c;if(Array.isArray(r))c=r,s=e,a=t,l=i,d=n;else{let p=e;c=r.getActions(p),s=t,a=i,l=n,d=o}nJ(c,s,!1,typeof a=="string"?p=>p===a:a,l,d)}function nJ(r,e,t,i=s=>s==="navigation",n=()=>!1,o=!1){let s,a;Array.isArray(e)?(s=e,a=e):(s=e.primary,a=e.secondary);let l=new Set;for(let[d,c]of r){let u;i(d)?(u=s,u.length>0&&o&&u.push(new sn)):(u=a,u.length>0&&u.push(new sn));for(let p of c){t&&(p=p instanceof jo&&p.alt?p.alt:p);let m=u.push(p);p instanceof Nd&&l.add({group:d,action:p,index:m-1})}}for(let{group:d,action:c,index:u}of l){let p=i(d)?s:a,m=c.actions;n(c,d,p.length)&&p.splice(u,1,...m)}}var $h=class extends $c{constructor(t,i,n,o,s,a,l,d){super(void 0,t,{icon:!!(t.class||t.item.icon),label:!t.class&&!t.item.icon,draggable:i?.draggable,keybinding:i?.keybinding,hoverDelegate:i?.hoverDelegate});this._options=i;this._keybindingService=n;this._notificationService=o;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=km.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new xt);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(t){t.preventDefault(),t.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(i){this._notificationService.error(i)}}render(t){if(super.render(t),t.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let i=!1,n=()=>{let o=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||i)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&i);o!==this._wantsAltCommand&&(this._wantsAltCommand=o,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(n)),this._register(B(t,"mouseleave",o=>{i=!1,n()})),this._register(B(t,"mouseenter",o=>{i=!0,n()})),n()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),i=t&&t.getLabel(),n=this._commandAction.tooltip||this._commandAction.label,o=i?h("titleAndKb","{0} ({1})",n,i):n;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?h("titleAndKb","{0} ({1})",s,l):s;o=h("titleAndKbAndAlt",`{0}
[{1}] {2}`,o,u_.modifierLabels[nr].altKey,d)}return o}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(t){this._itemClassDispose.value=void 0;let{element:i,label:n}=this;if(!i||!n)return;let o=this._commandAction.checked&&sU(t.toggled)&&t.toggled.icon?t.toggled.icon:t.icon;if(o)if(Ae.isThemeIcon(o)){let s=Ae.asClassNameArray(o);n.classList.add(...s),this._itemClassDispose.value=te(()=>{n.classList.remove(...s)})}else n.style.backgroundImage=zM(this._themeService.getColorTheme().type)?El(o.dark):El(o.light),n.classList.add("icon"),this._itemClassDispose.value=un(te(()=>{n.style.backgroundImage="",n.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};$h=R([y(2,qt),y(3,Bo),y(4,je),y(5,kt),y(6,Zi),y(7,dr)],$h);var Yh=class extends Uu{constructor(t,i,n,o,s){let a={...i,menuAsChild:i?.menuAsChild??!1,classNames:i?.classNames??(Ae.isThemeIcon(t.item.icon)?Ae.asClassName(t.item.icon):void 0),keybindingProvider:i?.keybindingProvider??(l=>n.lookupKeybinding(l.id))};super(t,{getActions:()=>t.actions},o,a);this._keybindingService=n;this._contextMenuService=o;this._themeService=s}render(t){super.render(t),Im(this.element),t.classList.add("menu-entry");let i=this._action,{icon:n}=i.item;if(n&&!Ae.isThemeIcon(n)){this.element.classList.add("icon");let o=()=>{this.element&&(this.element.style.backgroundImage=zM(this._themeService.getColorTheme().type)?El(n.dark):El(n.light))};o(),this._register(this._themeService.onDidColorThemeChange(()=>{o()}))}}};Yh=R([y(2,qt),y(3,Zi),y(4,kt)],Yh);var wC=class extends mo{constructor(t,i,n,o,s,a,l,d){super(null,t);this._keybindingService=n;this._notificationService=o;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=i,this._storageKey=`${t.item.submenu.id}_lastActionId`;let c,u=i?.persistLastActionId?d.get(this._storageKey,1):void 0;u&&(c=t.actions.find(m=>u===m.id)),c||(c=t.actions[0]),this._defaultAction=this._instaService.createInstance($h,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let p={keybindingProvider:m=>this._keybindingService.lookupKeybinding(m.id),...i,menuAsChild:i?.menuAsChild??!0,classNames:i?.classNames??["codicon","codicon-chevron-down"],actionRunner:i?.actionRunner??new lo};this._dropdown=new Uu(t,t.actions,this._contextMenuService,p),this._register(this._dropdown.actionRunner.onDidRun(m=>{m.action instanceof jo&&this.update(m.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(t){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,t.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance($h,t,{keybinding:this._getDefaultActionKeybindingLabel(t)}),this._defaultAction.actionRunner=new class extends lo{async runAction(i,n){await i.run(void 0)}},this._container&&this._defaultAction.render(o1(this._container,he(".action-container")))}_getDefaultActionKeybindingLabel(t){let i;if(this._options?.renderKeybindingWithDefaultActionLabel){let n=this._keybindingService.lookupKeybinding(t.id);n&&(i=`(${n.getLabel()})`)}return i}setActionContext(t){super.setActionContext(t),this._defaultAction.setActionContext(t),this._dropdown.setActionContext(t)}render(t){this._container=t,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let i=he(".action-container");this._defaultAction.render(ye(this._container,i)),this._register(B(i,Q.KEY_DOWN,o=>{let s=new bt(o);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let n=he(".dropdown-action-container");this._dropdown.render(ye(this._container,n)),this._register(B(n,Q.KEY_DOWN,o=>{let s=new bt(o);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(t){t?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(t){t?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};wC=R([y(2,qt),y(3,Bo),y(4,Zi),y(5,xs),y(6,ve),y(7,Ii)],wC);var xC=class extends ZE{constructor(e,t){super(null,e,e.actions.map(i=>({text:i.id===sn.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":i.label,isDisabled:!i.enabled})),0,t,c7,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(i=>i.checked)))}render(e){super.render(e),e.style.borderColor=ae(zy)}runAction(e,t){let i=this.action.actions[t];i&&this.actionRunner.run(i)}};xC=R([y(1,iu)],xC);function mb(r,e,t){return e instanceof jo?r.createInstance($h,e,t):e instanceof Po?e.item.isSelection?r.createInstance(xC,e):e.item.rememberDefaultAction?r.createInstance(wC,e,{...t,persistLastActionId:!0}):r.createInstance(Yh,e,t):void 0}var Mk=class{constructor(e,t,i){this._commandService=e;this._keybindingService=t;this._hiddenStates=new md(i)}_hiddenStates;createMenu(e,t,i){return new gb(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t)}getMenuActions(e,t,i){let n=new gb(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t),o=n.getActions(i);return n.dispose(),o}getMenuContexts(e){let t=new Ok(e,!1);return new Set([...t.structureContextKeys,...t.preconditionContextKeys,...t.toggledContextKeys])}resetHiddenStates(e){this._hiddenStates.reset(e)}};Mk=R([y(0,Ui),y(1,qt),y(2,Ii)],Mk);var md=class{constructor(e){this._storageService=e;try{let t=e.get(md._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,md._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{let t=e.get(md._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}static _key="menu.hiddenCommands";_disposables=new Y;_onDidChange=new _;onDidChange=this._onDidChange.event;_ignoreChangeEvent=!1;_data;_hiddenByDefaultCache=new Map;dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){let i=this._isHiddenByDefault(e,t),n=this._data[e.id]?.includes(t)??!1;return i?!n:n}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);let o=this._data[e.id];if(i)o?o.indexOf(t)<0&&o.push(t):this._data[e.id]=[t];else if(o){let s=o.indexOf(t);s>=0&&jV(o,s),o.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(let{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;let e=JSON.stringify(this._data);this._storageService.store(md._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};md=R([y(0,Ii)],md);var Ok=class r{constructor(e,t){this._id=e;this._collectContextKeysForSubmenus=t;this.refresh()}_menuGroups=[];_allMenuIds=new Set;_structureContextKeys=new Set;_preconditionContextKeys=new Set;_toggledContextKeys=new Set;get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();let e=this._sort(Go.getMenuItems(this._id)),t;for(let i of e){let n=i.group||"";(!t||t[0]!==n)&&(t=[n,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(r._fillInKbExprKeys(e.when,this._structureContextKeys),$m(e)){if(e.command.precondition&&r._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){let t=e.command.toggled.condition||e.command.toggled;r._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(Go.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(let i of e.keys())t.add(i)}},uc=class extends Ok{constructor(t,i,n,o,s,a){super(t,n);this._hiddenStates=i;this._commandService=o;this._keybindingService=s;this._contextKeyService=a;this.refresh()}createActionGroups(t){let i=[];for(let n of this._menuGroups){let[o,s]=n,a;for(let l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let d=$m(l);d&&this._hiddenStates.setDefaultState(this._id,l.command.id,!!l.isHiddenByDefault);let c=oJ(this._id,d?l.command:l,this._hiddenStates);if(d){let u=OB(this._commandService,this._keybindingService,l.command.id,l.when);(a??=[]).push(new jo(l.command,l.alt,t,c,u,this._contextKeyService,this._commandService))}else{let u=new uc(l.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(t),p=sn.join(...u.map(m=>m[1]));p.length>0&&(a??=[]).push(new Po(l,c,p))}}a&&a.length>0&&i.push([o,a])}return i}_sort(t){return t.sort(uc._compareMenuItems)}static _compareMenuItems(t,i){let n=t.group,o=i.group;if(n!==o){if(n){if(!o)return-1}else return 1;if(n==="navigation")return-1;if(o==="navigation")return 1;let l=n.localeCompare(o);if(l!==0)return l}let s=t.order||0,a=i.order||0;return s<a?-1:s>a?1:uc._compareTitles($m(t)?t.command.title:t.title,$m(i)?i.command.title:i.title)}static _compareTitles(t,i){let n=typeof t=="string"?t:t.original,o=typeof i=="string"?i:i.original;return n.localeCompare(o)}};uc=R([y(3,Ui),y(4,qt),y(5,je)],uc);var gb=class{_menuInfo;_disposables=new Y;_onDidChange;onDidChange;constructor(e,t,i,n,o,s){this._menuInfo=new uc(e,t,i.emitEventsForSubmenuChanges,n,o,s);let a=new Kt(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(Go.onDidChangeMenu(u=>{for(let p of this._menuInfo.allMenuIds)if(u.has(p)){a.schedule();break}}));let l=this._disposables.add(new Y),d=u=>{let p=!1,m=!1,f=!1;for(let g of u)if(p=p||g.isStructuralChange,m=m||g.isEnablementChange,f=f||g.isToggleChange,p&&m&&f)break;return{menu:this,isStructuralChange:p,isEnablementChange:m,isToggleChange:f}},c=()=>{l.add(s.onDidChangeContext(u=>{let p=u.affectsSome(this._menuInfo.structureContextKeys),m=u.affectsSome(this._menuInfo.preconditionContextKeys),f=u.affectsSome(this._menuInfo.toggledContextKeys);(p||m||f)&&this._onDidChange.fire({menu:this,isStructuralChange:p,isEnablementChange:m,isToggleChange:f})})),l.add(t.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new OS({onWillAddFirstListener:c,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:d}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};gb=R([y(3,Ui),y(4,qt),y(5,je)],gb);function oJ(r,e,t){let i=aU(e)?e.submenu.id:e.id,n=typeof e.title=="string"?e.title:e.title.value,o=co({id:`hide/${r.id}/${i}`,label:h("hide.label","Hide '{0}'",n),run(){t.updateHidden(r,i,!0)}}),s=co({id:`toggle/${r.id}/${i}`,label:n,get checked(){return!t.isHidden(r,i)},run(){t.updateHidden(r,i,!!this.checked)}});return{hide:o,toggle:s,get isHidden(){return!s.checked}}}function OB(r,e,t,i=void 0,n=!0){return co({id:`configureKeybinding/${t}`,label:h("configure keybinding","Configure Keybinding"),enabled:n,run(){let s=!!!e.lookupKeybinding(t)&&i?i.serialize():void 0;r.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(s?` +when:${s}`:""))}})}var pc=class extends Ak{constructor(t,i,n,o,s,a,l,d){super(t,s,{getKeyBinding:u=>a.lookupKeybinding(u.id)??void 0,...i,allowContextMenu:!0,skipTelemetry:typeof i?.telemetrySource=="string"});this._options=i;this._menuService=n;this._contextKeyService=o;this._contextMenuService=s;this._keybindingService=a;this._commandService=l;let c=i?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(u=>d.publicLog2("workbenchActionExecuted",{id:u.action.id,from:c})))}_sessionDisposables=this._store.add(new Y);setActions(t,i=[],n){this._sessionDisposables.clear();let o=t.slice(),s=i.slice(),a=[],l=0,d=[],c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let u=0;u<o.length;u++){let p=o[u];!(p instanceof jo)&&!(p instanceof Po)||p.hideActions&&(a.push(p.hideActions.toggle),p.hideActions.toggle.checked&&l++,p.hideActions.isHidden&&(c=!0,o[u]=void 0,this._options?.hiddenItemStrategy!==0&&(d[u]=p)))}if(this._options?.overflowBehavior!==void 0){let u=eW(new Set(this._options.overflowBehavior.exempted),ct.map(o,f=>f?.id)),p=this._options.overflowBehavior.maxItems-u.size,m=0;for(let f=0;f<o.length;f++){let g=o[f];g&&(m++,!u.has(g.id)&&m>=p&&(o[f]=void 0,d[f]=g))}}KR(o),KR(d),super.setActions(o,sn.join(d,s)),(a.length>0||o.length>0)&&this._sessionDisposables.add(B(this.getElement(),"contextmenu",u=>{let p=new Ei(pe(this.getElement()),u),m=this.getItemAction(p.target);if(!m)return;p.preventDefault(),p.stopPropagation();let f=[];if(m instanceof jo&&m.menuKeybinding)f.push(m.menuKeybinding);else if(!(m instanceof Po||m instanceof hb)){let b=!!this._keybindingService.lookupKeybinding(m.id);f.push(OB(this._commandService,this._keybindingService,m.id,void 0,b))}if(a.length>0){let b=!1;if(l===1&&this._options?.hiddenItemStrategy===0){b=!0;for(let v=0;v<a.length;v++)if(a[v].checked){a[v]=co({id:m.id,label:m.label,checked:!0,enabled:!1,run(){}});break}}if(!b&&(m instanceof jo||m instanceof Po)){if(!m.hideActions)return;f.push(m.hideActions.hide)}else f.push(co({id:"label",label:h("hide","Hide"),enabled:!1,run(){}}))}let g=sn.join(f,a);this._options?.resetMenu&&!n&&(n=[this._options.resetMenu]),c&&n&&(g.push(new sn),g.push(co({id:"resetThisMenu",label:h("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(n)}))),g.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>p,getActions:()=>g,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};pc=R([y(2,xs),y(3,je),y(4,Zi),y(5,qt),y(6,Ui),y(7,jt)],pc);var Ku=class extends pc{_onDidChangeMenuItems=this._store.add(new _);onDidChangeMenuItems=this._onDidChangeMenuItems.event;constructor(e,t,i,n,o,s,a,l,d){super(e,{resetMenu:t,...i},n,o,s,a,l,d);let c=this._store.add(n.createMenu(t,o,{emitEventsForSubmenuChanges:!0})),u=()=>{let p=[],m=[];zu(c,i?.menuOptions,{primary:p,secondary:m},i?.toolbarOptions?.primaryGroup,i?.toolbarOptions?.shouldInlineSubmenu,i?.toolbarOptions?.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",p.length===0&&m.length===0),super.setActions(p,m)};this._store.add(c.onDidChange(()=>{u(),this._onDidChangeMenuItems.fire(this)})),u()}setActions(){throw new Je("This toolbar is populated from a menu.")}};Ku=R([y(3,xs),y(4,je),y(5,Zi),y(6,qt),y(7,Ui),y(8,jt)],Ku);var Gu=Z("hoverService"),fb=class extends P{constructor(t,i,n={},o,s){super();this.placement=t;this.instantHover=i;this.overrideOptions=n;this.configurationService=o;this.hoverService=s;this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}lastHoverHideTime=0;timeLimit=200;_delay;get delay(){return this.isInstantlyHovering()?0:this._delay}hoverDisposables=this._register(new Y);showHover(t,i){let n=typeof this.overrideOptions=="function"?this.overrideOptions(t,i):this.overrideOptions;this.hoverDisposables.clear();let o=ki(t.target)?[t.target]:t.target.targetElements;for(let a of o)this.hoverDisposables.add(si(a,"keydown",l=>{l.equals(9)&&this.hoverService.hideHover()}));let s=ki(t.content)?void 0:t.content.toString();return this.hoverService.showHover({...t,...n,persistence:{hideOnKeyDown:!0,...n.persistence},id:s,appearance:{...t.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...n.appearance}},i)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}setInstantHoverTimeLimit(t){if(!this.instantHover)throw new Error("Instant hover is not enabled");this.timeLimit=t}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};fb=R([y(3,He),y(4,Gu)],fb);var PB=[],Pk=35,bb=class extends P{constructor(t,i,n,o,s,a,l,d,c){super();this._diffModel=i;this._editors=n;this._options=o;this._sashLayout=s;this._boundarySashes=a;this._instantiationService=l;this._contextKeyService=d;this._menuService=c;this._register(Q9(t,this.elements.root)),this._register(B(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(Ns(this.elements.root,{display:this._hasActions.map(p=>p?"block":"none")})),gs(this,p=>this._showSash.read(p)?new pb(t,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,um(this,f=>this._sashLayout.sashLeft.read(f)-Pk,(f,g)=>this._sashLayout.sashLeft.set(f+Pk,g)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store);let u=We(this,p=>{let m=this._diffModel.read(p);if(!m)return[];let f=m.diff.read(p);if(!f)return[];let g=this._selectedDiffs.read(p);if(g.length>0){let v=rs.fromRangeMappings(g.flatMap(I=>I.rangeMappings));return[new Nk(v,!0,nt.DiffEditorSelectionToolbar,void 0,m.model.original.uri,m.model.modified.uri)]}let b=this._currentDiff.read(p);return f.mappings.map(v=>new Nk(v.lineRangeMapping.withInnerChangesFromLineRanges(),v.lineRangeMapping===b?.lineRangeMapping,nt.DiffEditorHunkToolbar,void 0,m.model.original.uri,m.model.modified.uri))});this._register(new kk(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(p,m)=>u.read(m),createView:(p,m)=>this._instantiationService.createInstance(TC,p,m,this)})),this._register(B(this.elements.gutter,Q.MOUSE_WHEEL,p=>{this._editors.modified.getOption(105).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(p)},{passive:!1}))}_menu=this._register(this._menuService.createMenu(nt.DiffEditorHunkToolbar,this._contextKeyService));_actions=zt(this,this._menu.onDidChange,()=>this._menu.getActions());_hasActions=this._actions.map(t=>t.length>0);_showSash=We(this,t=>this._options.renderSideBySide.read(t)&&this._hasActions.read(t));width=We(this,t=>this._hasActions.read(t)?Pk:0);elements=Tt("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:Pk+"px"}},[]);computeStagedValue(t){let i=t.innerChanges??[],n=new EC(this._editors.modifiedModel.get()),o=new EC(this._editors.original.getModel());return new wT(i.map(l=>l.toTextEdit(n))).apply(o)}_currentDiff=We(this,t=>{let i=this._diffModel.read(t);if(!i)return;let n=i.diff.read(t)?.mappings,o=this._editors.modifiedCursor.read(t);if(o)return n?.find(s=>s.lineRangeMapping.modified.contains(o.lineNumber))});_selectedDiffs=We(this,t=>{let n=this._diffModel.read(t)?.diff.read(t);if(!n)return PB;let o=this._editors.modifiedSelections.read(t);if(o.every(d=>d.isEmpty()))return PB;let s=new _s(o.map(d=>Fe.fromRangeInclusive(d))),l=n.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>o.some(u=>O.areIntersecting(c.modifiedRange,u)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?PB:l});layout(t){this.elements.gutter.style.left=t+"px"}};bb=R([y(6,ve),y(7,je),y(8,xs)],bb);var Nk=class{constructor(e,t,i,n,o,s){this.mapping=e;this.showAlways=t;this.menuId=i;this.rangeOverride=n;this.originalUri=o;this.modifiedUri=s}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}},TC=class extends P{constructor(t,i,n,o){super();this._item=t;let s=this._register(o.createInstance(fb,"element",!0,{position:{hoverPosition:1}}));this._register(jh(i,this._elements.root)),this._register(yt(a=>{let l=this._showAlways.read(a);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",l),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(oo((a,l)=>{this._elements.buttons.replaceChildren();let d=l.add(o.createInstance(Ku,this._elements.buttons,this._menuId.read(a),{orientation:1,hoverDelegate:s,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(a)?1:3},hiddenItemStrategy:0,actionRunner:new Rk(()=>{let c=this._item.get(),u=c.mapping;return{mapping:u,originalWithModifiedChanges:n.computeStagedValue(u),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));l.add(d.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}_elements=Tt("div.gutterItem",{style:{height:"20px",width:"34px"}},[Tt("div.background@background",{},[]),Tt("div.buttons@buttons",{},[])]);_showAlways=this._item.map(this,t=>t.showAlways);_menuId=this._item.map(this,t=>t.menuId);_isSmall=Ct(this,!1);_lastItemRange=void 0;_lastViewRange=void 0;layout(t,i){this._lastItemRange=t,this._lastViewRange=i;let n=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&t.length<30,void 0),n=this._elements.buttons.clientHeight;let o=t.length/2-n/2,s=n,a=t.start+o,l=Be.tryCreate(s,i.endExclusive-s-n),d=Be.tryCreate(t.start+s,t.endExclusive-n-s);d&&l&&d.start<d.endExclusive&&(a=l.clip(a),a=d.clip(a)),this._elements.buttons.style.top=`${a-t.start}px`}};TC=R([y(3,ve)],TC);var hc=class extends P{constructor(t,i,n,o){super();this._editors=t;this._diffModel=i;this._options=n;this._instantiationService=o;this._register(this._editors.original.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();mi(u=>{for(let p of this._editors.original.getSelections()||[])c?.ensureOriginalLineIsVisible(p.getStartPosition().lineNumber,0,u),c?.ensureOriginalLineIsVisible(p.getEndPosition().lineNumber,0,u)})})),this._register(this._editors.modified.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();mi(u=>{for(let p of this._editors.modified.getSelections()||[])c?.ensureModifiedLineIsVisible(p.getStartPosition().lineNumber,0,u),c?.ensureModifiedLineIsVisible(p.getEndPosition().lineNumber,0,u)})}));let s=this._diffModel.map((d,c)=>{let u=d?.unchangedRegions.read(c)??[];return u.length===1&&u[0].modifiedLineNumber===1&&u[0].lineCount===this._editors.modifiedModel.read(c)?.getLineCount()?[]:u});this.viewZones=Ld(this,(d,c)=>{let u=this._modifiedOutlineSource.read(d);if(!u)return{origViewZones:[],modViewZones:[]};let p=[],m=[],f=this._options.renderSideBySide.read(d),g=this._options.compactMode.read(d),b=s.read(d);for(let v=0;v<b.length;v++){let I=b[v];if(!I.shouldHideControls(d)&&!(g&&(v===0||v===b.length-1)))if(g){{let w=We(this,S=>I.getHiddenOriginalRange(S).startLineNumber-1),E=new dd(w,12);p.push(E),c.add(new Fk(this._editors.original,E,I,!f))}{let w=We(this,S=>I.getHiddenModifiedRange(S).startLineNumber-1),E=new dd(w,12);m.push(E),c.add(new Fk(this._editors.modified,E,I))}}else{{let w=We(this,S=>I.getHiddenOriginalRange(S).startLineNumber-1),E=new dd(w,24);p.push(E),c.add(new Bk(this._editors.original,E,I,I.originalUnchangedRange,!f,u,S=>this._diffModel.get().ensureModifiedLineIsVisible(S,2,void 0),this._options))}{let w=We(this,S=>I.getHiddenModifiedRange(S).startLineNumber-1),E=new dd(w,24);m.push(E),c.add(new Bk(this._editors.modified,E,I,I.modifiedUnchangedRange,!1,u,S=>this._diffModel.get().ensureModifiedLineIsVisible(S,2,void 0),this._options))}}}return{origViewZones:p,modViewZones:m}});let a={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},l={description:"Fold Unchanged",glyphMarginHoverMessage:new Op(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(h("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+Ae.asClassName(ie.fold),zIndex:10001};this._register(nb(this._editors.original,We(this,d=>{let c=s.read(d),u=c.map(p=>({range:p.originalUnchangedRange.toInclusiveRange(),options:a}));for(let p of c)p.shouldHideControls(d)&&u.push({range:O.fromPositions(new F(p.originalLineNumber,1)),options:l});return u}))),this._register(nb(this._editors.modified,We(this,d=>{let c=s.read(d),u=c.map(p=>({range:p.modifiedUnchangedRange.toInclusiveRange(),options:a}));for(let p of c)p.shouldHideControls(d)&&u.push({range:Fe.ofLength(p.modifiedLineNumber,1).toInclusiveRange(),options:l});return u}))),this._register(yt(d=>{let c=s.read(d);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(u=>u.getHiddenOriginalRange(d).toInclusiveRange()).filter(Ad)),this._editors.modified.setHiddenAreas(c.map(u=>u.getHiddenModifiedRange(d).toInclusiveRange()).filter(Ad))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,u=this._diffModel.get();if(!u)return;let p=u.unchangedRegions.get().find(m=>m.modifiedUnchangedRange.includes(c));if(!p)return;p.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,u=this._diffModel.get();if(!u)return;let p=u.unchangedRegions.get().find(m=>m.originalUnchangedRange.includes(c));if(!p)return;p.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}}))}static _breadcrumbsSourceFactory=Ct(hc,()=>({dispose(){},getBreadcrumbItems(t,i){return[]}}));static setBreadcrumbsSourceFactory(t){this._breadcrumbsSourceFactory.set(t,void 0)}_modifiedOutlineSource=gs(this,t=>{let i=this._editors.modifiedModel.read(t),n=hc._breadcrumbsSourceFactory.read(t);return!i||!n?void 0:n(i,this._instantiationService)});viewZones;_isUpdatingHiddenAreas=!1;get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}};hc=R([y(3,ve)],hc);var Fk=class extends Kh{constructor(t,i,n,o=!1){let s=Tt("div.diff-hidden-lines-widget");super(t,i,s.root);this._unchangedRegion=n;this._hide=o;s.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(yt(a=>{if(!this._hide){let l=this._unchangedRegion.getHiddenModifiedRange(a).length,d=h("hiddenLines","{0} hidden lines",l);this._nodes.text.innerText=d}}))}_nodes=Tt("div.diff-hidden-lines-compact",[Tt("div.line-left",[]),Tt("div.text@text",[]),Tt("div.line-right",[])])},Bk=class extends Kh{constructor(t,i,n,o,s,a,l,d){let c=Tt("div.diff-hidden-lines-widget");super(t,i,c.root);this._editor=t;this._unchangedRegion=n;this._unchangedRegionRange=o;this._hide=s;this._modifiedOutlineSource=a;this._revealModifiedHiddenLine=l;this._options=d;c.root.appendChild(this._nodes.root),this._hide?gn(this._nodes.first):this._register(Ns(this._nodes.first,{width:qh(this._editor).layoutInfoContentLeft})),this._register(yt(p=>{let m=this._unchangedRegion.visibleLineCountTop.read(p)+this._unchangedRegion.visibleLineCountBottom.read(p)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!m),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(p)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(p)>0),this._nodes.top.classList.toggle("canMoveBottom",!m);let f=this._unchangedRegion.isDragged.read(p),g=this._editor.getDomNode();g&&(g.classList.toggle("draggingUnchangedRegion",!!f),f==="top"?(g.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(p)>0),g.classList.toggle("canMoveBottom",!m)):f==="bottom"?(g.classList.toggle("canMoveTop",!m),g.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(p)>0)):(g.classList.toggle("canMoveTop",!1),g.classList.toggle("canMoveBottom",!1)))}));let u=this._editor;this._register(B(this._nodes.top,"mousedown",p=>{if(p.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),p.preventDefault();let m=p.clientY,f=!1,g=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);let b=pe(this._nodes.top),v=B(b,"mousemove",w=>{let S=w.clientY-m;f=f||Math.abs(S)>2;let T=Math.round(S/u.getOption(68)),D=Math.max(0,Math.min(g+T,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(D,void 0)}),I=B(b,"mouseup",w=>{f||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),v.dispose(),I.dispose()})})),this._register(B(this._nodes.bottom,"mousedown",p=>{if(p.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),p.preventDefault();let m=p.clientY,f=!1,g=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);let b=pe(this._nodes.bottom),v=B(b,"mousemove",w=>{let S=w.clientY-m;f=f||Math.abs(S)>2;let T=Math.round(S/u.getOption(68)),D=Math.max(0,Math.min(g-T,this._unchangedRegion.getMaxVisibleLineCountBottom())),L=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(D,void 0);let A=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(A-L))}),I=B(b,"mouseup",w=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!f){let E=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);let S=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(S-E))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),v.dispose(),I.dispose()})})),this._register(yt(p=>{let m=[];if(!this._hide){let f=n.getHiddenModifiedRange(p).length,g=h("hiddenLines","{0} hidden lines",f),b=he("span",{title:h("diff.hiddenLines.expandAll","Double click to unfold")},g);b.addEventListener("dblclick",w=>{w.button===0&&(w.preventDefault(),this._unchangedRegion.showAll(void 0))}),m.push(b);let v=this._unchangedRegion.getHiddenModifiedRange(p),I=this._modifiedOutlineSource.getBreadcrumbItems(v,p);if(I.length>0){m.push(he("span",void 0,"\xA0\xA0|\xA0\xA0"));for(let w=0;w<I.length;w++){let E=I[w],S=cM.toIcon(E.kind),T=Tt("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[Km(S),"\xA0",E.name,...w===I.length-1?[]:[Km(ie.chevronRight)]]).root;m.push(T),T.onclick=()=>{this._revealModifiedHiddenLine(E.startLineNumber)}}}}gn(this._nodes.others,...m)}))}_nodes=Tt("div.diff-hidden-lines",[Tt("div.top@top",{title:h("diff.hiddenLines.top","Click or drag to show more above")}),Tt("div.center@content",{style:{display:"flex"}},[Tt("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[he("a",{title:h("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...Es("$(unfold)"))]),Tt("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),Tt("div.bottom@bottom",{title:h("diff.bottom","Click or drag to show more below"),role:"button"})])};var NB=[],Vk=class extends P{constructor(t,i,n,o){super();this._editors=t;this._diffModel=i;this._options=n;this._widget=o;this._register(oo((s,a)=>{if(!this._options.shouldRenderOldRevertArrows.read(s))return;let l=this._diffModel.read(s),d=l?.diff.read(s);if(!l||!d||l.movedTextToCompare.read(s))return;let c=[],u=this._selectedDiffs.read(s),p=new Set(u.map(m=>m.mapping));if(u.length>0){let m=this._editors.modifiedSelections.read(s),f=a.add(new Wk(m[m.length-1].positionLineNumber,this._widget,u.flatMap(g=>g.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}for(let m of d.mappings)if(!p.has(m)&&!m.lineRangeMapping.modified.isEmpty&&m.lineRangeMapping.innerChanges){let f=a.add(new Wk(m.lineRangeMapping.modified.startLineNumber,this._widget,m.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}a.add(te(()=>{for(let m of c)this._editors.modified.removeGlyphMarginWidget(m)}))}))}_selectedDiffs=We(this,t=>{let n=this._diffModel.read(t)?.diff.read(t);if(!n)return NB;let o=this._editors.modifiedSelections.read(t);if(o.every(d=>d.isEmpty()))return NB;let s=new _s(o.map(d=>Fe.fromRangeInclusive(d))),l=n.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>o.some(u=>O.areIntersecting(c.modifiedRange,u)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?NB:l})},Wk=class r extends P{constructor(t,i,n,o){super();this._lineNumber=t;this._widget=i;this._diffs=n;this._revertSelection=o;this._register(B(this._domNode,Q.MOUSE_DOWN,s=>{s.button!==2&&(s.stopPropagation(),s.preventDefault())})),this._register(B(this._domNode,Q.MOUSE_UP,s=>{s.stopPropagation(),s.preventDefault()})),this._register(B(this._domNode,Q.CLICK,s=>{this._diffs instanceof Vo?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),s.stopPropagation(),s.preventDefault()}))}static counter=0;_id=`revertButton${r.counter++}`;getId(){return this._id}_domNode=Tt("div.revertButton",{title:this._revertSelection?h("revertSelectedChanges","Revert Selected Changes"):h("revertChange","Revert Change")},[Km(ie.arrowRight)]).root;getDomNode(){return this._domNode}getPosition(){return{lane:3,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};var Hk=class r extends P{static idCounter=0;_id=++r.idCounter;_onDidDispose=this._register(new _);onDidDispose=this._onDidDispose.event;getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getStatusbarColumn(e){return this._targetEditor.getStatusbarColumn(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._targetEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};var Zh=class extends Hk{constructor(t,i,n,o,s,a,l,d){super();this._domElement=t;this._parentContextKeyService=o;this._parentInstantiationService=s;this._accessibilitySignalService=l;this._editorProgressService=d;a.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(te(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new mk(this.elements.root,i.dimension)),this._rootSizeObserver.setAutomaticLayout(i.automaticLayout??!1),this._options=this._instantiationService.createInstance(lb,i),this._register(yt(S=>{this._options.setWidth(this._rootSizeObserver.width.read(S))})),this._contextKeyService.createKey(Se.isEmbeddedDiffEditor.key,!1),this._register(cd(Se.isEmbeddedDiffEditor,this._contextKeyService,S=>this._options.isInEmbeddedEditor.read(S))),this._register(cd(Se.comparingMovedCode,this._contextKeyService,S=>!!this._diffModel.read(S)?.movedTextToCompare.read(S))),this._register(cd(Se.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,S=>this._options.couldShowInlineViewBecauseOfSize.read(S))),this._register(cd(Se.diffEditorInlineMode,this._contextKeyService,S=>!this._options.renderSideBySide.read(S))),this._register(cd(Se.hasChanges,this._contextKeyService,S=>(this._diffModel.read(S)?.diff.read(S)?.mappings.length??0)>0)),this._editors=this._register(this._instantiationService.createInstance(ub,this.elements.original,this.elements.modified,this._options,n,(S,T,D,L)=>this._createInnerEditor(S,T,D,L))),this._register(cd(Se.diffEditorOriginalWritable,this._contextKeyService,S=>this._options.originalEditable.read(S))),this._register(cd(Se.diffEditorModifiedWritable,this._contextKeyService,S=>!this._options.readOnly.read(S))),this._register(cd(Se.diffEditorOriginalUri,this._contextKeyService,S=>this._diffModel.read(S)?.model.original.uri.toString()??"")),this._register(cd(Se.diffEditorModifiedUri,this._contextKeyService,S=>this._diffModel.read(S)?.model.modified.uri.toString()??"")),this._overviewRulerPart=gs(this,S=>this._options.renderOverviewRuler.read(S)?this._instantiationService.createInstance(ca(io,S),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(T=>T.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);let c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((S,T)=>S-(this._overviewRulerPart.read(T)?.width??0))};this._sashLayout=new Lk(this._options,c),this._sash=gs(this,S=>{let T=this._options.renderSideBySide.read(S);return this.elements.root.classList.toggle("side-by-side",T),T?new pb(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);let u=gs(this,S=>this._instantiationService.createInstance(ca(hc,S),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);gs(this,S=>this._instantiationService.createInstance(ca(Dk,S),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);let p=new Set,m=new Set,f=!1,g=gs(this,S=>this._instantiationService.createInstance(ca(ab,S),pe(this._domElement),this._editors,this._diffModel,this._options,this,()=>f||u.get().isUpdatingHiddenAreas,p,m)).recomputeInitiallyAndOnChange(this._store),b=We(this,S=>{let T=g.read(S).viewZones.read(S).orig,D=u.read(S).viewZones.read(S).origViewZones;return T.concat(D)}),v=We(this,S=>{let T=g.read(S).viewZones.read(S).mod,D=u.read(S).viewZones.read(S).modViewZones;return T.concat(D)});this._register(ob(this._editors.original,b,S=>{f=S},p));let I;this._register(ob(this._editors.modified,v,S=>{f=S,f?I=aD.capture(this._editors.modified):(I?.restore(this._editors.modified),I=void 0)},m)),this._accessibleDiffViewer=gs(this,S=>this._instantiationService.createInstance(ca(hd,S),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(T,D)=>this._accessibleDiffViewerShouldBeVisible.set(T,D),this._options.onlyShowAccessibleDiffViewer.map(T=>!T),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((T,D)=>T?.diff.read(D)?.mappings.map(L=>L.lineRangeMapping)),new Tk(this._editors))).recomputeInitiallyAndOnChange(this._store);let w=this._accessibleDiffViewerVisible.map(S=>S?"hidden":"visible");this._register(Ns(this.elements.modified,{visibility:w})),this._register(Ns(this.elements.original,{visibility:w})),this._createDiffEditorContributions(),a.addDiffEditor(this),this._gutter=gs(this,S=>this._options.shouldRenderGutterMenu.read(S)?this._instantiationService.createInstance(ca(bb,S),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(pm(this._layoutInfo)),gs(this,S=>new(ca(Hu,S))(this.elements.root,this._diffModel,this._layoutInfo.map(T=>T.originalEditor),this._layoutInfo.map(T=>T.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,S=>{this._movedBlocksLinesPart.set(S,void 0)}),this._register(z.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,S=>this._handleCursorPositionChange(S,!0))),this._register(z.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,S=>this._handleCursorPositionChange(S,!1)));let E=this._diffModel.map(this,(S,T)=>{if(S)return S.diff.read(T)===void 0&&!S.isDiffUpToDate.read(T)});this._register(oo((S,T)=>{if(E.read(S)===!0){let D=this._editorProgressService.show(!0,1e3);T.add(te(()=>D.done()))}})),this._register(oo((S,T)=>{T.add(new(ca(Vk,S))(this._editors,this._diffModel,this._options,this))})),this._register(oo((S,T)=>{let D=this._diffModel.read(S);if(D)for(let L of[D.model.original,D.model.modified])T.add(L.onWillDispose(A=>{Ge(new Je("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(yt(S=>{this._options.setModel(this._diffModel.read(S))}))}static ENTIRE_DIFF_OVERVIEW_WIDTH=io.ENTIRE_DIFF_OVERVIEW_WIDTH;elements=Tt("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[Tt("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),Tt("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),Tt("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]);_diffModelSrc=this._register(h0(this,void 0));_diffModel=We(this,t=>this._diffModelSrc.read(t)?.object);onDidChangeModel=z.fromObservableLight(this._diffModel);get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}_contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement));_instantiationService=this._register(this._parentInstantiationService.createChild(new ws([je,this._contextKeyService])));_rootSizeObserver;_sashLayout;_sash;_boundarySashes=Ct(this,void 0);_accessibleDiffViewerShouldBeVisible=Ct(this,!1);_accessibleDiffViewerVisible=We(this,t=>this._options.onlyShowAccessibleDiffViewer.read(t)?!0:this._accessibleDiffViewerShouldBeVisible.read(t));_accessibleDiffViewer;_options;_editors;_overviewRulerPart;_movedBlocksLinesPart=Ct(this,void 0);_gutter;get collapseUnchangedRegions(){return this._options.hideUnchangedRegions.get()}getViewWidth(){return this._rootSizeObserver.width.get()}getContentHeight(){return this._editors.modified.getContentHeight()}_createInnerEditor(t,i,n,o){return t.createInstance(da,i,n,o)}_layoutInfo=We(this,t=>{let i=this._rootSizeObserver.width.read(t),n=this._rootSizeObserver.height.read(t);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=n+"px";let o=this._sash.read(t),s=this._gutter.read(t),a=s?.width.read(t)??0,l=this._overviewRulerPart.read(t)?.width??0,d,c,u,p,m;if(!!o){let g=o.sashLeft.read(t),b=this._movedBlocksLinesPart.read(t)?.width.read(t)??0;d=0,c=g-a-b,m=g-a,u=g,p=i-u-l}else{m=0;let g=this._options.inlineViewHideOriginalLineNumbers.read(t);d=a,g?c=0:c=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(t)),u=a+c,p=i-u-l}return this.elements.original.style.left=d+"px",this.elements.original.style.width=c+"px",this._editors.original.layout({width:c,height:n},!0),s?.layout(m),this.elements.modified.style.left=u+"px",this.elements.modified.style.width=p+"px",this._editors.modified.layout({width:p,height:n},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}});_createDiffEditorContributions(){let t=_h.getDiffEditorContributions();for(let i of t)try{this._register(this._instantiationService.createInstance(i.ctor,this))}catch(n){Ge(n)}}get _targetEditor(){return this._editors.modified}getEditorType(){return Py.IDiffEditor}onVisible(){this._editors.original.onVisible(),this._editors.modified.onVisible()}onHide(){this._editors.original.onHide(),this._editors.modified.onHide()}layout(t){this._rootSizeObserver.observe(t)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){let t=this._editors.original.saveViewState(),i=this._editors.modified.saveViewState();return{original:t,modified:i,modelState:this._diffModel.get()?.serializeState()}}restoreViewState(t){if(t&&t.original&&t.modified){let i=t;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&this._diffModel.get()?.restoreSerializedState(i.modelState)}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(t){return this._instantiationService.createInstance(db,t,this._options)}getModel(){return this._diffModel.get()?.model??null}setModel(t){let i=t?"model"in t?Gh.create(t).createNewRef(this):Gh.create(this.createViewModel(t),this):null;this.setDiffModel(i)}setDiffModel(t,i){let n=this._diffModel.get();!t&&n&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==t?.object&&gp(i,o=>{let s=t?.object;zt.batchEventsGlobally(o,()=>{this._editors.original.setModel(s?s.model.original:null),this._editors.modified.setModel(s?s.model.modified:null)});let a=this._diffModelSrc.get()?.createNewRef(this);this._diffModelSrc.set(t?.createNewRef(this),o),setTimeout(()=>{a?.dispose()},0)})}updateOptions(t){this._options.updateOptions(t)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}setBoundarySashes(t){this._boundarySashes.set(t,void 0)}_diffValue=this._diffModel.map((t,i)=>t?.diff.read(i));onDidUpdateDiff=z.fromObservableLight(this._diffValue);get ignoreTrimWhitespace(){return this._options.ignoreTrimWhitespace.get()}get maxComputationTime(){return this._options.maxComputationTimeMs.get()}get renderSideBySide(){return this._options.renderSideBySide.get()}getLineChanges(){let t=this._diffModel.get()?.diff.get();return t?sJ(t):null}getDiffComputationResult(){let t=this._diffModel.get()?.diff.get();return t?{changes:this.getLineChanges(),changes2:t.mappings.map(i=>i.lineRangeMapping),identical:t.identical,quitEarly:t.quitEarly}:null}revert(t){let i=this._diffModel.get();!i||!i.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:t.modified.toExclusiveRange(),text:i.model.original.getValueInRange(t.original.toExclusiveRange())}])}revertRangeMappings(t){let i=this._diffModel.get();if(!i||!i.isDiffUpToDate.get())return;let n=t.map(o=>({range:o.modifiedRange,text:i.model.original.getValueInRange(o.originalRange)}));this._editors.modified.executeEdits("diffEditor",n)}_goTo(t){this._editors.modified.setPosition(new F(t.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(t.lineRangeMapping.modified.toExclusiveRange())}goToDiff(t){let i=this._diffModel.get()?.diff.get()?.mappings;if(!i||i.length===0)return;let n=this._editors.modified.getPosition().lineNumber,o;t==="next"?o=i.find(s=>s.lineRangeMapping.modified.startLineNumber>n)??i[0]:o=lp(i,s=>s.lineRangeMapping.modified.startLineNumber<n)??i[i.length-1],this._goTo(o),o.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(ls.diffLineDeleted,{source:"diffEditor.goToDiff"}):o.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(ls.diffLineInserted,{source:"diffEditor.goToDiff"}):o&&this._accessibilitySignalService.playSignal(ls.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){let t=this._diffModel.get();t&&this.waitForDiff().then(()=>{let i=t.diff.get()?.mappings;!i||i.length===0||this._goTo(i[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){let t=this._diffModel.get();t&&await t.waitForDiff()}mapToOtherSide(){let t=this._editors.modified.hasWidgetFocus(),i=t?this._editors.modified:this._editors.original,n=t?this._editors.original:this._editors.modified,o,s=i.getSelection();if(s){let a=this._diffModel.get()?.diff.get()?.mappings.map(l=>t?l.lineRangeMapping.flip():l.lineRangeMapping);if(a){let l=hB(s.getStartPosition(),a),d=hB(s.getEndPosition(),a);o=O.plusRange(l,d)}}return{destination:n,destinationSelection:o}}switchSide(){let{destination:t,destinationSelection:i}=this.mapToOtherSide();t.focus(),i&&t.setSelection(i)}exitCompareMove(){let t=this._diffModel.get();t&&t.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){let t=this._diffModel.get()?.unchangedRegions.get();t&&mi(i=>{for(let n of t)n.collapseAll(i)})}showAllUnchangedRegions(){let t=this._diffModel.get()?.unchangedRegions.get();t&&mi(i=>{for(let n of t)n.showAll(i)})}_handleCursorPositionChange(t,i){if(t?.reason===3){let n=this._diffModel.get()?.diff.get()?.mappings.find(o=>i?o.lineRangeMapping.modified.contains(t.position.lineNumber):o.lineRangeMapping.original.contains(t.position.lineNumber));n?.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(ls.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):n?.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(ls.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):n&&this._accessibilitySignalService.playSignal(ls.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};Zh=R([y(3,je),y(4,ve),y(5,sd),y(6,fk),y(7,Ug)],Zh);function sJ(r){return r.mappings.map(e=>{let t=e.lineRangeMapping,i,n,o,s,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,n=0,a=void 0):(i=t.original.startLineNumber,n=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(o=t.modified.startLineNumber-1,s=0,a=void 0):(o=t.modified.startLineNumber,s=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:o,modifiedEndLineNumber:s,charChanges:a?.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var ju=class extends Mu{constructor(t,i,n,o,s,a,l,d,c,u){super(ju.ID,t,i,n,o,s,l,a,d,c);this.preferencesService=u}static ID=jg;diffEditorControl=void 0;inputLifecycleStopWatch=void 0;get scopedContextKeyService(){if(!this.diffEditorControl)return;let t=this.diffEditorControl.getOriginalEditor(),i=this.diffEditorControl.getModifiedEditor();return(t.hasTextFocus()?t:i).invokeWithinContext(n=>n.get(je))}getTitle(){return this.input?this.input.getName():h("textDiffEditor","Text Diff Editor")}createEditorControl(t,i){this.diffEditorControl=this._register(this.instantiationService.createInstance(Zh,t,i,{}))}updateEditorControlOptions(t){this.diffEditorControl?.updateOptions(t)}getMainControl(){return this.diffEditorControl?.getModifiedEditor()}_previousViewModel=null;async setInput(t,i,n,o){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),this.inputLifecycleStopWatch=void 0,await super.setInput(t,i,n,o);try{let s=await t.resolve();if(o.isCancellationRequested)return;if(!(s instanceof wf)){this.openAsBinary(t,i);return}let a=at(this.diffEditorControl),l=s,d=l.textDiffEditorModel?a.createViewModel(l.textDiffEditorModel):null;this._previousViewModel=d,await d?.waitForDiff(),a.setModel(d);let c=!1;lI(i?.viewState)||(c=this.restoreTextDiffEditorViewState(t,i,n,a));let u=!1;i&&(u=WN(i,a,1)),!u&&!c&&a.revealFirstDiff(),a.updateOptions({...this.getReadonlyConfiguration(l.modifiedModel?.isReadonly()),originalEditable:!l.originalModel?.isReadonly()}),a.handleInitialized(),this.inputLifecycleStopWatch=new Sa(!1)}catch(s){await this.handleSetInputError(s,t,i)}}async handleSetInputError(t,i,n){if(this.isFileBinaryError(t))return this.openAsBinary(i,n);if(t.fileOperationResult===7){let o;throw t instanceof Jw?o=h("fileTooLargeForHeapErrorWithSize","At least one file is not displayed in the text compare editor because it is very large ({0}).",Xn.formatSize(t.size)):o=h("fileTooLargeForHeapErrorWithoutSize","At least one file is not displayed in the text compare editor because it is very large."),E8(this.group,i,n,o,this.preferencesService)}throw t}restoreTextDiffEditorViewState(t,i,n,o){let s=this.loadEditorViewState(t,n);return s?(i?.selection&&s.modified&&(s.modified.cursorState=[]),o.restoreViewState(s),i?.revealIfVisible&&o.revealFirstDiff(),!0):!1}openAsBinary(t,i){let n=t.original,o=t.modified,s=this.instantiationService.createInstance(Jo,t.getName(),t.getDescription(),n,o,!0),a=ze.as(ks.EditorFactory).getFileEditorFactory();a.isFileEditor(n)&&n.setForceOpenAsBinary(),a.isFileEditor(o)&&o.setForceOpenAsBinary(),this.group.replaceEditors([{editor:t,replacement:s,options:{...i,activation:3,pinned:this.group.isPinned(t),sticky:this.group.isSticky(t)}}])}setOptions(t){super.setOptions(t),t&&WN(t,at(this.diffEditorControl),0)}shouldHandleConfigurationChangeEvent(t,i){return super.shouldHandleConfigurationChangeEvent(t,i)?!0:t.affectsConfiguration(i,"diffEditor")||t.affectsConfiguration(i,"accessibility.verbosity.diffEditor")}computeConfiguration(t){let i=super.computeConfiguration(t);if(gi(t.diffEditor)){let o=Qc(t.diffEditor);o.diffCodeLens=o.codeLens,delete o.codeLens,o.diffWordWrap=o.wordWrap,delete o.wordWrap,Object.assign(i,o)}let n=t.accessibility?.verbosity?.diffEditor??!1;return i.accessibilityVerbose=n,i}getConfigurationOverrides(t){return{...super.getConfigurationOverrides(t),...this.getReadonlyConfiguration(this.input?.isReadonly()),originalEditable:this.input instanceof Jo&&!this.input.original.isReadonly(),lineDecorationsWidth:"2ch"}}updateReadonly(t){t instanceof Jo?this.diffEditorControl?.updateOptions({...this.getReadonlyConfiguration(t.isReadonly()),originalEditable:!t.original.isReadonly()}):super.updateReadonly(t)}isFileBinaryError(t){return Array.isArray(t)?t.some(n=>this.isFileBinaryError(n)):t.textFileOperationResult===0}clearInput(){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),super.clearInput();let t=this.inputLifecycleStopWatch?.elapsed();this.inputLifecycleStopWatch=void 0,typeof t=="number"&&this.logInputLifecycleTelemetry(t,this.getControl()?.getModel()?.modified?.getLanguageId()),this.diffEditorControl?.setModel(null)}logInputLifecycleTelemetry(t,i){let n=!1;this.diffEditorControl instanceof Zh&&(n=this.diffEditorControl.collapseUnchangedRegions),this.telemetryService.publicLog2("diffEditor.editorVisibleTime",{editorVisibleTimeMs:t,languageId:i??"",collapseUnchangedRegions:n})}getControl(){return this.diffEditorControl}focus(){super.focus(),this.diffEditorControl?.focus()}hasFocus(){return this.diffEditorControl?.hasTextFocus()||super.hasFocus()}setEditorVisible(t){super.setEditorVisible(t),t?this.diffEditorControl?.onVisible():this.diffEditorControl?.onHide()}layout(t){this.diffEditorControl?.layout(t)}setBoundarySashes(t){this.diffEditorControl?.setBoundarySashes(t)}tracksEditorViewState(t){return t instanceof Jo}computeEditorViewState(t){if(!this.diffEditorControl)return;let i=this.diffEditorControl.getModel();if(!i||!i.modified||!i.original)return;let n=this.toEditorViewStateResource(i);if(n&&Li(n,t))return this.diffEditorControl.saveViewState()??void 0}toEditorViewStateResource(t){let i,n;if(t instanceof Jo?(i=t.original.resource,n=t.modified.resource):Bn(t)||(i=t.original.uri,n=t.modified.uri),!(!i||!n))return X.from({scheme:"diff",path:`${Om(i.toString())}${Om(n.toString())}`})}};ju=R([y(1,jt),y(2,ve),y(3,Ii),y(4,_r),y(5,vt),y(6,kt),y(7,Ri),y(8,Lt),y(9,I8)],ju);function D3(r){switch(r){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function L3(r){switch(r){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function vb(r){let e=0;for(let t=0;;t+=7){let i=r.read(1);if(e|=(i.buffer[0]&127)<<t,!(i.buffer[0]&128))return e}}var aJ=qu(0);function yb(r,e){if(e===0){r.write(aJ);return}let t=0;for(let n=e;n!==0;n=n>>>7)t++;let i=Qt.alloc(t);for(let n=0;e!==0;n++)i.buffer[n]=e&127,e=e>>>7,e>0&&(i.buffer[n]|=128);r.write(i)}var BB=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},VB=class{buffers=[];get buffer(){return Qt.concat(this.buffers)}write(e){this.buffers.push(e)}};function qu(r){let e=Qt.alloc(1);return e.writeUInt8(r,0),e}var Xh={Undefined:qu(0),String:qu(1),Buffer:qu(2),VSBuffer:qu(3),Array:qu(4),Object:qu(5),Uint:qu(6)},lJ=typeof Buffer<"u";function WB(r,e){if(typeof e>"u")r.write(Xh.Undefined);else if(typeof e=="string"){let t=Qt.fromString(e);r.write(Xh.String),yb(r,t.byteLength),r.write(t)}else if(lJ&&Buffer.isBuffer(e)){let t=Qt.wrap(e);r.write(Xh.Buffer),yb(r,t.byteLength),r.write(t)}else if(e instanceof Qt)r.write(Xh.VSBuffer),yb(r,e.byteLength),r.write(e);else if(Array.isArray(e)){r.write(Xh.Array),yb(r,e.length);for(let t of e)WB(r,t)}else if(typeof e=="number"&&(e|0)===e)r.write(Xh.Uint),yb(r,e);else{let t=Qt.fromString(JSON.stringify(e));r.write(Xh.Object),yb(r,t.byteLength),r.write(t)}}function HB(r){switch(r.read(1).readUInt8(0)){case 0:return;case 1:return r.read(vb(r)).toString();case 2:return r.read(vb(r)).buffer;case 3:return r.read(vb(r));case 4:{let t=vb(r),i=[];for(let n=0;n<t;n++)i.push(HB(r));return i}case 5:return JSON.parse(r.read(vb(r)).toString());case 6:return vb(r)}}var FB=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(i=>this.onBuffer(i)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new _;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(i,n,o){return t.isDisposed?Promise.reject(new _o):t.requestPromise(e,i,n,o)},listen(i,n){return t.isDisposed?z.None:t.requestEvent(e,i,n)}}}requestPromise(e,t,i,n=pn.None){let o=this.lastRequestId++,a={id:o,type:100,channelName:e,name:t,arg:i};if(n.isCancellationRequested)return Promise.reject(new _o);let l;return new Promise((c,u)=>{if(n.isCancellationRequested)return u(new _o);let p=()=>{let b=v=>{switch(v.type){case 201:this.handlers.delete(o),c(v.data);break;case 202:{this.handlers.delete(o);let I=new Error(v.data.message);I.stack=Array.isArray(v.data.stack)?v.data.stack.join(`
`):v.data.stack,I.name=v.data.name,u(I);break}case 203:this.handlers.delete(o),u(v.data);break}};this.handlers.set(o,b),this.sendRequest(a)},m=null;this.state===1?p():(m=xp(b=>this.whenInitialized()),m.then(()=>{m=null,p()}));let f=()=>{m?(m.cancel(),m=null):this.sendRequest({id:o,type:101}),u(new _o)},g=n.onCancellationRequested(f);l=un(te(f),g),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(e,t,i){let n=this.lastRequestId++,s={id:n,type:102,channelName:e,name:t,arg:i},a=null,l=new _({onWillAddFirstListener:()=>{a=xp(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:n,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(n,d),l.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${D3(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,D3(e.type));return}}}send(e,t=void 0){let i=new VB;return WB(i,e),WB(i,t),this.sendBuffer(i.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new BB(e),i=HB(t),n=HB(t),o=i[0];switch(o){case 200:return this.logger?.logIncoming(e.byteLength,0,0,L3(o)),this.onResponse({type:i[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,i[1],0,L3(o),n),this.onResponse({type:i[0],id:i[1],data:n})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return z.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),ht(this.activeRequests.values()),this.activeRequests.clear()}};R([me],FB.prototype,"onDidInitializePromise",1);var dJ;(n=>{function r(o,s,a){let l=o,d=a&&a.disableMarshalling,c=new Map;for(let u in l)t(u)&&c.set(u,z.buffer(l[u],!0,void 0,s));return new class{listen(u,p,m){let f=c.get(p);if(f)return f;let g=l[p];if(typeof g=="function"){if(i(p))return g.call(l,m);if(t(p))return c.set(p,z.buffer(l[p],!0,void 0,s)),c.get(p)}throw new dl(`Event not found: ${p}`)}call(u,p,m){let f=l[p];if(typeof f=="function"){if(!d&&Array.isArray(m))for(let b=0;b<m.length;b++)m[b]=jm(m[b]);let g=f.apply(l,m);return g instanceof Promise||(g=Promise.resolve(g)),g}throw new dl(`Method not found: ${p}`)}}}n.fromService=r;function e(o,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):i(d)?function(c){return o.listen(d,c)}:t(d)?o.listen(d):async function(...c){let u;s&&!ao(s.context)?u=[s.context,...c]:u=c;let p=await o.call(d,u);return a?p:jm(p)};throw new dl(`Property not found: ${String(d)}`)}})}n.toService=e;function t(o){return o[0]==="o"&&o[1]==="n"&&yl(o.charCodeAt(2))}function i(o){return/^onDynamic/.test(o)&&yl(o.charCodeAt(9))}})(dJ||={});var cJ="diagnosticsService",bCi=Z(cJ);var uJ;(s=>{s.enableDiagnostics=!1,s.records=[];let t=new WeakMap,i=0;function n(a,l){if(!t.has(a)){let d=String(++i);t.set(a,d)}return t.get(a)}function o(a,l,d,c){}s.traceSocketEvent=o})(uJ||={});var PCi=Z("remoteAuthorityResolverService");var jCi=Z("remoteSocketFactoryService");var pJ="signService",YCi=Z(pJ);var TSi=30*1e3;var Ib=Z("remoteAgentService"),jSi=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(r){let e=1/0;for(let i=0;i<this.maxSampleCount;i++){let n=await r.getRoundTripTime();if(n===void 0)return;e=Math.min(e,n/2),await hn(this.sampleDelay)}this.average.push(e),this.average.length>this.maxAverageCount&&this.average.shift();let t;return this.initial.length<this.maxInitialCount?this.initial.push(e):t=this.initial.reduce((i,n)=>i+n,0)/this.initial.length,this.lastMeasurement={initial:t,current:e,average:this.average.reduce((i,n)=>i+n,0)/this.average.length,high:typeof t>"u"?!1:e>this.highLatencyMaxThreshold||e>this.highLatencyMinThreshold&&e>t*this.highLatencyMultiple},this.lastMeasurement}};var bEi=Object.freeze({id:"application",order:100,title:h("applicationConfigurationTitle","Application"),type:"object"}),R3=Object.freeze({id:"workbench",order:7,title:h("workbenchConfigurationTitle","Workbench"),type:"object"}),hJ=Object.freeze({id:"security",scope:1,title:h("securityConfigurationTitle","Security"),type:"object",order:7}),vEi=Object.freeze({id:"problems",title:h("problemsConfigurationTitle","Problems"),type:"object",order:101}),mJ=Object.freeze({id:"window",order:8,title:h("windowConfigurationTitle","Window"),type:"object"}),gJ={ConfigurationMigration:"base.contributions.configuration.migration"},UB=class{migrations=[];_onDidRegisterConfigurationMigrations=new _;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(e){this.migrations.push(...e)}},Gk=new UB;ze.add(gJ.ConfigurationMigration,Gk);var Uk=class extends P{constructor(t,i){super();this.configurationService=t;this.workspaceService=i;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async n=>{for(let o of n.added)await this.migrateConfigurationsForFolder(o,Gk.migrations)})),this.migrateConfigurations(Gk.migrations),this._register(Gk.onDidRegisterConfigurationMigration(n=>this.migrateConfigurations(n)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(t){await this.migrateConfigurationsForFolder(void 0,t);for(let i of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(i,t)}async migrateConfigurationsForFolder(t,i){await Promise.all([i.map(n=>this.migrateConfigurationsForFolderAndOverride(n,t?.uri))])}async migrateConfigurationsForFolderAndOverride(t,i){let n=this.configurationService.inspect(t.key,{resource:i}),o=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of o){let l=n[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(t,s,l.value,i,void 0);for(let u of c??[])d.push([u,[]])}for(let{identifiers:c,value:u}of l.overrides??[])if(u!==void 0){let p=await this.runMigration(t,s,u,i,c);for(let m of p??[])d.push([m,c])}d.length&&await Promise.allSettled(d.map(async([[c,u],p])=>this.configurationService.updateValue(c,u.value,{resource:i,overrideIdentifiers:p},a)))}}async runMigration(t,i,n,o,s){let a=d=>{let u=this.configurationService.inspect(d,{resource:o})[i];if(u)return s?u.overrides?.find(({identifiers:p})=>fi(p,s))?.value:u.value},l=await t.migrateFn(n,a);return Array.isArray(l)?l:[[t.key,l]]}};Uk=R([y(0,He),y(1,bi)],Uk);var zk=class extends P{constructor(t){super();this.remoteAgentService=t;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new ys;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!dt&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;ze.as($r.Configuration).registerConfiguration({...hJ,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:h("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:h("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:h("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};zk=R([y(0,Ib)],zk);var _C="window.newWindowProfile",Kk=class extends P{constructor(t,i){super();this.userDataProfilesService=t;this.configurationService=i;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(n=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(i.onDidChangeConfiguration(n=>{n.source!==7&&n.affectsConfiguration(_C)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let t=ze.as($r.Configuration),i={...mJ,properties:{[_C]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(n=>n.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(n=>""),h("active window","Active Window")],description:h("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?t.updateConfigurations({add:[i],remove:[this.configurationNode]}):t.registerConfiguration(i),this.configurationNode=i}setNewWindowProfile(){let t=this.configurationService.getValue(_C);this.newWindowProfile=t?this.userDataProfilesService.profiles.find(i=>i.name===t):void 0}checkAndResetNewWindowProfileConfig(){let t=this.configurationService.getValue(_C);if(!t)return;let i=this.newWindowProfile?this.userDataProfilesService.profiles.find(n=>n.id===this.newWindowProfile.id):void 0;t!==i?.name&&this.configurationService.updateValue(_C,i?.name)}};Kk=R([y(0,b8),y(1,He)],Kk);var $u=Z("editorResolverService");var fJ=ze.as($r.Configuration),bJ={...R3,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h("editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};fJ.registerConfiguration(bJ);var vwi=new q("workbenchState",void 0,{type:"string",description:h("workbenchState","The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")}),ywi=new q("workspaceFolderCount",0,h("workspaceFolderCount","The number of root folders in the workspace")),Iwi=new q("openFolderWorkspaceSupport",!0,!0),Cwi=new q("enterMultiRootWorkspaceSupport",!0,!0),A3=new q("emptyWorkspaceSupport",!0,!0),Swi=new q("dirtyWorkingCopies",!1,h("dirtyWorkingCopies","Whether there are any working copies with unsaved changes")),Ewi=new q("remoteName","",h("remoteName","The name of the remote the window is connected to or an empty string if not connected to any remote")),wwi=new q("virtualWorkspace","",h("virtualWorkspace","The scheme of the current workspace is from a virtual file system or an empty string.")),xwi=new q("temporaryWorkspace",!1,h("temporaryWorkspace","The scheme of the current workspace is from a temporary file system.")),Twi=new q("isFullscreen",!1,h("isFullscreen","Whether the main window is in fullscreen mode")),vJ=new q("isAuxiliaryWindowFocusedContext",!1,h("isAuxiliaryWindowFocusedContext","Whether an auxiliary window is focused")),_wi=new q("hasWebFileSystemAccess",!1,!0),Dwi=new q("embedderIdentifier",void 0,h("embedderIdentifier","The identifier of the embedder according to the product service, if one is defined")),M3=new q("activeEditorIsDirty",!1,h("activeEditorIsDirty","Whether the active editor has unsaved changes")),jk=new q("activeEditorIsNotPreview",!1,h("activeEditorIsNotPreview","Whether the active editor is not in preview mode")),qk=new q("activeEditorIsFirstInGroup",!1,h("activeEditorIsFirstInGroup","Whether the active editor is the first one in its group")),$k=new q("activeEditorIsLastInGroup",!1,h("activeEditorIsLastInGroup","Whether the active editor is the last one in its group")),DC=new q("activeEditorIsPinned",!1,h("activeEditorIsPinned","Whether the active editor is pinned")),O3=new q("activeEditorIsReadonly",!1,h("activeEditorIsReadonly","Whether the active editor is read-only")),zB=new q("activeCompareEditorCanSwap",!1,h("activeCompareEditorCanSwap","Whether the active compare editor can swap sides")),Yk=new q("activeEditorCanToggleReadonly",!0,h("activeEditorCanToggleReadonly","Whether the active editor can toggle between being read-only or writeable")),P3=new q("activeEditorCanRevert",!1,h("activeEditorCanRevert","Whether the active editor can revert")),LC=new q("activeEditorCanSplitInGroup",!0),kC=new q("activeEditor",null,{type:"string",description:h("activeEditor","The identifier of the active editor")}),RC=new q("activeEditorAvailableEditorIds","",h("activeEditorAvailableEditorIds","The available editor identifiers that are usable for the active editor")),KB=new q("textCompareEditorVisible",!1,h("textCompareEditorVisible","Whether a text compare editor is visible")),Zk=new q("textCompareEditorActive",!1,h("textCompareEditorActive","Whether a text compare editor is active")),AC=new q("sideBySideEditorActive",!1,h("sideBySideEditorActive","Whether a side by side editor is active")),N3=new q("groupEditorsCount",0,h("groupEditorsCount","The number of opened editor groups")),F3=new q("activeEditorGroupEmpty",!1,h("activeEditorGroupEmpty","Whether the active editor group is empty")),Lwi=new q("activeEditorGroupIndex",0,h("activeEditorGroupIndex","The index of the active editor group")),kwi=new q("activeEditorGroupLast",!1,h("activeEditorGroupLast","Whether the active editor group is the last group")),MC=new q("activeEditorGroupLocked",!1,h("activeEditorGroupLocked","Whether the active editor group is locked")),OC=new q("multipleEditorGroups",!1,h("multipleEditorGroups","Whether there are multiple editor groups opened")),Rwi=OC.toNegated(),B3=new q("multipleEditorsSelectedInGroup",!1,h("multipleEditorsSelectedInGroup","Whether multiple editors have been selected in an editor group")),V3=new q("twoEditorsSelectedInGroup",!1,h("twoEditorsSelectedInGroup","Whether exactly two editors have been selected in an editor group")),W3=new q("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,h("SelectedEditorsInGroupFileOrUntitledResourceContextKey","Whether all selected editors in a group have a file or untitled resource associated")),H3=new q("editorPartMultipleEditorGroups",!1,h("editorPartMultipleEditorGroups","Whether there are multiple editor groups opened in an editor part")),Awi=H3.toNegated(),yJ=new q("editorPartMaximizedEditorGroup",!1,h("editorPartEditorGroupMaximized","Editor Part has a maximized group")),Mwi=new q("isAuxiliaryEditorPart",!1,h("isAuxiliaryEditorPart","Editor Part is in an auxiliary window")),Owi=new q("editorIsOpen",!1,h("editorIsOpen","Whether an editor is open")),Pwi=new q("inZenMode",!1,h("inZenMode","Whether Zen mode is enabled")),Nwi=new q("isCenteredLayout",!1,h("isMainEditorCenteredLayout","Whether centered layout is enabled for the main editor")),Fwi=new q("splitEditorsVertically",!1,h("splitEditorsVertically","Whether editors split vertically")),Bwi=new q("mainEditorAreaVisible",!0,h("mainEditorAreaVisible","Whether the editor area in the main window is visible")),Vwi=new q("editorTabsVisible",!0,h("editorTabsVisible","Whether editor tabs are visible")),IJ=new q("sideBarVisible",!1,h("sideBarVisible","Whether the sidebar is visible")),Wwi=new q("sideBarFocus",!1,h("sideBarFocus","Whether the sidebar has keyboard focus")),Hwi=new q("activeViewlet","",h("activeViewlet","The identifier of the active viewlet")),Uwi=new q("statusBarFocused",!1,h("statusBarFocused","Whether the status bar has keyboard focus")),zwi=new q("titleBarStyle",_t?"native":"custom",h("titleBarStyle","Style of the window title bar")),Kwi=new q("titleBarVisible",!1,h("titleBarVisible","Whether the title bar is visible")),Gwi=new q("bannerFocused",!1,h("bannerFocused","Whether the banner has keyboard focus")),jwi=new q("notificationFocus",!0,h("notificationFocus","Whether a notification has keyboard focus")),qwi=new q("notificationCenterVisible",!1,h("notificationCenterVisible","Whether the notifications center is visible")),$wi=new q("notificationToastsVisible",!1,h("notificationToastsVisible","Whether a notification toast is visible")),Ywi=new q("activeAuxiliary","",h("activeAuxiliary","The identifier of the active auxiliary panel")),Zwi=new q("auxiliaryBarFocus",!1,h("auxiliaryBarFocus","Whether the auxiliary bar has keyboard focus")),CJ=new q("auxiliaryBarVisible",!1,h("auxiliaryBarVisible","Whether the auxiliary bar is visible")),Xwi=new q("activePanel","",h("activePanel","The identifier of the active panel")),Qwi=new q("panelFocus",!1,h("panelFocus","Whether the panel has keyboard focus")),Jwi=new q("panelPosition","bottom",h("panelPosition","The position of the panel, always 'bottom'")),exi=new q("panelAlignment","center",h("panelAlignment","The alignment of the panel, either 'center', 'left', 'right' or 'justify'")),txi=new q("panelVisible",!1,h("panelVisible","Whether the panel is visible")),ixi=new q("panelMaximized",!1,h("panelMaximized","Whether the panel is maximized")),Cb=new q("focusedView","",h("focusedView","The identifier of the view that has keyboard focus"));var no=class{constructor(e,t,i,n){this._contextKeyService=e;this._fileService=t;this._languageService=i;this._modelService=n;this._schemeKey=no.Scheme.bindTo(this._contextKeyService),this._filenameKey=no.Filename.bindTo(this._contextKeyService),this._dirnameKey=no.Dirname.bindTo(this._contextKeyService),this._pathKey=no.Path.bindTo(this._contextKeyService),this._langIdKey=no.LangId.bindTo(this._contextKeyService),this._resourceKey=no.Resource.bindTo(this._contextKeyService),this._extensionKey=no.Extension.bindTo(this._contextKeyService),this._hasResource=no.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=no.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(t.onDidChangeFileSystemProviderRegistrations(()=>{let o=this.get();this._isFileSystemResource.set(!!(o&&t.hasProvider(o)))})),this._disposables.add(n.onModelAdded(o=>{Li(o.uri,this.get())&&this._setLangId()})),this._disposables.add(n.onModelLanguageChanged(o=>{Li(o.model.uri,this.get())&&this._setLangId()}))}static Scheme=new q("resourceScheme",void 0,{type:"string",description:h("resourceScheme","The scheme of the resource")});static Filename=new q("resourceFilename",void 0,{type:"string",description:h("resourceFilename","The file name of the resource")});static Dirname=new q("resourceDirname",void 0,{type:"string",description:h("resourceDirname","The folder name the resource is contained in")});static Path=new q("resourcePath",void 0,{type:"string",description:h("resourcePath","The full path of the resource")});static LangId=new q("resourceLangId",void 0,{type:"string",description:h("resourceLangId","The language identifier of the resource")});static Resource=new q("resource",void 0,{type:"URI",description:h("resource","The full value of the resource including scheme and path")});static Extension=new q("resourceExtname",void 0,{type:"string",description:h("resourceExtname","The extension name of the resource")});static HasResource=new q("resourceSet",void 0,{type:"boolean",description:h("resourceSet","Whether a resource is present or not")});static IsFileSystemResource=new q("isFileSystemResource",void 0,{type:"boolean",description:h("isFileSystemResource","Whether the resource is backed by a file system provider")});_disposables=new Y;_value;_resourceKey;_schemeKey;_filenameKey;_dirnameKey;_pathKey;_langIdKey;_extensionKey;_hasResource;_isFileSystemResource;dispose(){this._disposables.dispose()}_setLangId(){let e=this.get();if(!e){this._langIdKey.set(null);return}let t=this._modelService.getModel(e)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(e);this._langIdKey.set(t)}set(e){e=e??void 0,!Li(this._value,e)&&(this._value=e,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(e?e.toString():null),this._schemeKey.set(e?e.scheme:null),this._filenameKey.set(e?Hi(e):null),this._dirnameKey.set(e?this.uriToPath(Gs(e)):null),this._pathKey.set(e?this.uriToPath(e):null),this._setLangId(),this._extensionKey.set(e?Ep(e):null),this._hasResource.set(!!e),this._isFileSystemResource.set(e?this._fileService.hasProvider(e):!1)}))}uriToPath(e){return e.scheme===ue.file?e.fsPath:e.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}};no=R([y(0,je),y(1,Lt),y(2,Ki),y(3,Qn)],no);function Xk(r,e,t){if(!e){r.set("");return}let i=e.resource;if(i?.scheme===ue.untitled&&e.editorId!==Iu.id)r.set("");else{let n=i?t.getEditors(i).map(o=>o.id):[];r.set(n.join(","))}}function z3(r){return r.scheme!==ue.file&&r.scheme!==ue.vscodeRemote}function SJ(r){if(r.folders.length)return r.folders.every(e=>z3(e.uri))?r.folders[0].uri:void 0;if(r.configuration&&z3(r.configuration))return r.configuration}function K3(r){return SJ(r)?.scheme}var PC=Z("pathService"),Sb=class{constructor(e,t,i,n){this.localUserHome=e;this.remoteAgentService=t;this.environmentService=i;this.contextService=n;this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||nr)(),this.resolveUserHome=(async()=>{let o=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=o?.userHome??e})()}resolveOS;resolveUserHome;maybeUnresolvedUserHome;hasValidBasename(e,t,i){return typeof t=="string"||typeof t>"u"?this.resolveOS.then(n=>this.doHasValidBasename(e,n,t)):this.doHasValidBasename(e,t,i)}doHasValidBasename(e,t,i){return e.scheme===ue.file||e.scheme===ue.vscodeRemote?t2(i??Hi(e),t===1):!0}get defaultUriScheme(){return Sb.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(e,t){if(e.remoteAuthority)return ue.vscodeRemote;let i=K3(t.getWorkspace());if(i)return i;let n=t.getWorkspace().folders[0];if(n)return n.uri.scheme;let o=t.getWorkspace().configuration;return o?o.scheme:ue.file}userHome(e){return e?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(e=>e===1?Fi:ft)}async fileURI(e){let t="";if(await this.resolveOS===1&&(e=e.replace(/\\/g,"/")),e[0]==="/"&&e[1]==="/"){let n=e.indexOf("/",2);n===-1?(t=e.substring(2),e="/"):(t=e.substring(2,n),e=e.substring(n)||"/")}return X.from({scheme:ue.file,authority:t,path:e,query:"",fragment:""})}};Sb=R([y(1,Ib),y(2,Eh),y(3,bi)],Sb);var j3="workbench.action.closeEditorsAndGroup";var NC="workbench.action.closeActiveEditor";var q3="copyActiveEditor";var FC="workbench.action.unlockEditorGroup";var GB="workbench.action.unpinEditor",$3="workbench.action.splitEditor",jB="workbench.action.splitEditorUp",qB="workbench.action.splitEditorDown";var Y3="workbench.action.toggleMaximizeEditorGroup";var Z3=[$3,NC,GB,FC,Y3];var Qk=class{root=new Jk;constructor(e){for(let[t,i]of e)for(let n of i)this.root.add(t,n)}toString(){return this.root.toString()}getAttributes(e,t){let i=e.lastIndexOf(".");return i<1?{dirname:t,basename:e,extname:""}:{dirname:t,basename:e.substring(0,i),extname:e.substring(i+1)}}nest(e,t){let i=new Jk;for(let s of e){let a=this.getAttributes(s,t),l=this.root.get(s,a);for(let d of l)i.add(d,s)}let n=(s,a=new Set)=>{if(a.has(s))return[];a.add(s);let l=this.getAttributes(s,t),d=i.get(s,l);return d.length===0?[s]:d.length===1&&d[0]===s?[s]:d.flatMap(c=>n(c,a))},o=new Map;for(let s of e){let a=n(s);a.length===0&&(a=[s]);for(let l of a){let d=o.get(l);d||o.set(l,d=new Set),s!==l&&d.add(s)}}return o}},Jk=class r{value=new $B;map=new Map;constructor(){}add(e,t){if(e==="")this.value.add(e,t);else if(e[0]==="*")this.value.add(e,t);else{let i=e[0],n=e.slice(1),o=this.map.get(i);o||this.map.set(i,o=new r),o.add(n,t)}}get(e,t){let i=[];i.push(...this.value.get(e,t));let n=e[0],o=e.slice(1),s=this.map.get(n);return s&&i.push(...s.get(o,t)),i}toString(e=""){let t=[];return this.value.hasItems&&t.push(`* => 
`+this.value.toString(e+"  ")),[...this.map.entries()].map(([i,n])=>t.push("^"+i+` => 
`+n.toString(e+"  "))),t.map(i=>e+i).join(`
`)}},$B=class r{star=[];epsilon=[];map=new Map;hasItems=!1;constructor(){}add(e,t){if(this.hasItems=!0,e==="*")this.star.push(new eR(t));else if(e==="")this.epsilon.push(new eR(t));else{let i=e[e.length-1],n=e.slice(0,e.length-1);if(i==="*")throw Error("Unexpected star in SufTrie key: "+e);{let o=this.map.get(i);o||this.map.set(i,o=new r),o.add(n,t)}}}get(e,t){let i=[];e===""&&i.push(...this.epsilon.map(a=>a.substitute(t))),this.star.length&&i.push(...this.star.map(a=>a.substitute(t,e)));let n=e[e.length-1],o=e.slice(0,e.length-1),s=this.map.get(n);return s&&i.push(...s.get(o,t)),i}toString(e=""){let t=[];return this.star.length&&t.push("* => "+this.star.join("; ")),this.epsilon.length&&t.push("\u03B5 => "+this.epsilon.join("; ")),[...this.map.entries()].map(([i,n])=>t.push(i+`$ => 
`+n.toString(e+"  "))),t.map(i=>e+i).join(`
`)}};var X3=/\$[({](capture|basename|dirname|extname)[)}]/g,eR=class{tokens=[];constructor(e){X3.lastIndex=0;let t,i=0;for(;t=X3.exec(e);){let n=e.slice(i,t.index);this.tokens.push(n);let o=t[1];switch(o){case"basename":case"dirname":case"extname":case"capture":this.tokens.push({capture:o});break;default:throw Error("unknown substitution type: "+o)}i=t.index+t[0].length}if(i!==e.length){let n=e.slice(i,e.length);this.tokens.push(n)}}substitute(e,t){return this.tokens.map(i=>{if(typeof i=="string")return i;switch(i.capture){case"basename":return e.basename;case"dirname":return e.dirname;case"extname":return e.extname;case"capture":return t||""}}).join("")}};var Yu=class Yu{constructor(e,t,i,n,o,s,a,l,d,c=Fc(e),u,p=!1){this.resource=e;this.fileService=t;this.configService=i;this.filesConfigService=n;this._parent=o;this._isDirectory=s;this._isSymbolicLink=a;this._readonly=l;this._locked=d;this._name=c;this._mtime=u;this._unknown=p;this._isDirectoryResolved=!1}_isDirectoryResolved;error=void 0;_isExcluded=!1;nestedParent;nestedChildren;get isExcluded(){return this._isExcluded?!0:this._parent?this._parent.isExcluded:!1}set isExcluded(e){this._isExcluded=e}hasChildren(e){return this.hasNests?this.nestedChildren?.some(t=>e(t))??!1:this.isDirectory}get hasNests(){return!!this.nestedChildren?.length}get isDirectoryResolved(){return this._isDirectoryResolved}get isSymbolicLink(){return!!this._isSymbolicLink}get isDirectory(){return!!this._isDirectory}get isReadonly(){return this.filesConfigService.isReadonly(this.resource,{resource:this.resource,name:this.name,readonly:this._readonly,locked:this._locked})}get mtime(){return this._mtime}get name(){return this._name}get isUnknown(){return this._unknown}get parent(){return this._parent}get root(){return this._parent?this._parent.root:this}get children(){return new Map}updateName(e){this._parent?.removeChild(this),this._name=e,this._parent?.addChild(this)}getId(){return this.root.resource.toString()+"::"+this.resource.toString()}toString(){return`ExplorerItem: ${this.name}`}get isRoot(){return this===this.root}static create(e,t,i,n,o,s){let a=new Yu(n.resource,e,t,i,o,n.isDirectory,n.isSymbolicLink,n.readonly,n.locked,n.name,n.mtime,!n.isFile&&!n.isDirectory);if(a.isDirectory&&(a._isDirectoryResolved=!!n.children||!!s&&s.some(l=>A0(l,a.resource)),n.children))for(let l=0,d=n.children.length;l<d;l++){let c=Yu.create(e,t,i,n.children[l],a,s);a.addChild(c)}return a}static mergeLocalWithDisk(e,t){if(e.resource.toString()!==t.resource.toString())return;let i=e.isDirectory||t.isDirectory;if(!(i&&t._isDirectoryResolved&&!e._isDirectoryResolved)&&(t.resource=e.resource,t.isRoot||t.updateName(e.name),t._isDirectory=e.isDirectory,t._mtime=e.mtime,t._isDirectoryResolved=e._isDirectoryResolved,t._isSymbolicLink=e.isSymbolicLink,t.error=e.error,i&&e._isDirectoryResolved)){let n=new Cn;t.children.forEach(o=>{n.set(o.resource,o)}),t.children.clear(),e.children.forEach(o=>{let s=n.get(o.resource);s?(Yu.mergeLocalWithDisk(o,s),t.addChild(s),n.delete(o.resource)):t.addChild(o)}),n.forEach(o=>{o instanceof BC&&t.addChild(o)})}}addChild(e){e._parent=this,e.updateResource(!1),this.children.set(this.getPlatformAwareName(e.name),e)}getChild(e){return this.children.get(this.getPlatformAwareName(e))}fetchChildren(e){let t=this.configService.getValue({resource:this.root.resource}).explorer.fileNesting;return t.enabled&&this.nestedChildren?this.nestedChildren:(async()=>{if(!this._isDirectoryResolved){let n=e==="modified";this.error=void 0;try{let o=await this.fileService.resolve(this.resource,{resolveSingleChildDescendants:!0,resolveMetadata:n}),s=Yu.create(this.fileService,this.configService,this.filesConfigService,o,this);Yu.mergeLocalWithDisk(s,this)}catch(o){throw this.error=o,o}this._isDirectoryResolved=!0}let i=[];if(t.enabled){let n=[],o=[];for(let a of this.children.entries())a[1].nestedParent=void 0,a[1].isDirectory?o.push(a):n.push(a);let s=this.fileNester.nest(n.map(([a])=>a),this.getPlatformAwareName(this.name));for(let[a,l]of n){let d=s.get(a);if(d!==void 0){l.nestedChildren=[];for(let c of d.keys()){let u=at(this.children.get(c));l.nestedChildren.push(u),u.nestedParent=l}i.push(l)}else l.nestedChildren=void 0}for(let[a,l]of o.values())i.push(l)}else this.children.forEach(n=>{i.push(n)});return i})()}_fileNester;get fileNester(){if(!this.root._fileNester){let e=this.configService.getValue({resource:this.root.resource}).explorer.fileNesting,t=Object.entries(e.patterns).filter(i=>typeof i[0]=="string"&&typeof i[1]=="string"&&i[0]&&i[1]).map(([i,n])=>[this.getPlatformAwareName(i.trim()),n.split(",").map(o=>this.getPlatformAwareName(o.trim().replace(/\u200b/g,"").trim())).filter(o=>o!=="")]);this.root._fileNester=new Qk(t)}return this.root._fileNester}removeChild(e){this.nestedChildren=void 0,this.children.delete(this.getPlatformAwareName(e.name))}forgetChildren(){this.children.clear(),this.nestedChildren=void 0,this._isDirectoryResolved=!1,this._fileNester=void 0}getPlatformAwareName(e){return this.fileService.hasCapability(this.resource,1024)?e:e.toLowerCase()}move(e){this.nestedParent?.removeChild(this),this._parent?.removeChild(this),e.removeChild(this),e.addChild(this),this.updateResource(!0)}updateResource(e){this._parent&&(this.resource=It(this._parent.resource,this.name)),e&&this.isDirectory&&this.children.forEach(t=>{t.updateResource(!0)})}rename(e){this.updateName(e.name),this._mtime=e.mtime,this.updateResource(!0)}find(e){let t=!this.fileService.hasCapability(e,1024);return e&&this.resource.scheme===e.scheme&&Ho(this.resource.authority,e.authority)&&(t?Il(e.path,this.resource.path):e.path.startsWith(this.resource.path))?this.findByPath(vl(e.path,ft.sep),this.resource.path.length,t):null}findByPath(e,t,i){if(i2(vl(this.resource.path,ft.sep),e,i))return this;if(this.isDirectory){for(;t<e.length&&e[t]===ft.sep;)t++;let n=e.indexOf(ft.sep,t);n===-1&&(n=e.length);let o=e.substring(t,n),s=this.children.get(this.getPlatformAwareName(o));if(s)return s.findByPath(e,n,i)}return null}};R([me],Yu.prototype,"children",1);var Eb=Yu,BC=class extends Eb{constructor(e,t,i,n,o){super(X.file(""),e,t,i,n,o),this._isDirectoryResolved=!0}};var GDi=h("views log","Views"),Q3=$o("default-view-icon",ie.window,h("defaultViewIcon","Default view icon.")),VC;(t=>(t.ViewContainersRegistry="workbench.registry.view.containers",t.ViewsRegistry="workbench.registry.view"))(VC||={});function wb(r){switch(r){case 0:return"sidebar";case 1:return"panel";case 2:return"auxiliarybar"}}var ZB=class extends P{_onDidRegister=this._register(new _);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new _);onDidDeregister=this._onDidDeregister.event;viewContainers=new Map;defaultViewContainers=[];get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,t,i){let n=this.get(e.id);if(n)return n;let o=e;return o.openCommandActionDescriptor=i?.doNotRegisterOpenCommand?void 0:o.openCommandActionDescriptor??{id:o.id},Td(this.viewContainers,t,[]).push(o),i?.isDefault&&this.defaultViewContainers.push(o),this._onDidRegister.fire({viewContainer:o,viewContainerLocation:t}),o}deregisterViewContainer(e){for(let t of this.viewContainers.keys()){let i=this.viewContainers.get(t),n=i?.indexOf(e);if(n!==-1){i?.splice(n,1),i.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(i=>i?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}};ze.add(VC.ViewContainersRegistry,new ZB);function TJ(r,e){let t=r.group??"9_more",i=e.group??"9_more";return t!==i?t.localeCompare(i):(r.order??5)-(e.order??5)}var XB=class extends P{_onViewsRegistered=this._register(new _);onViewsRegistered=this._onViewsRegistered.event;_onViewsDeregistered=this._register(new _);onViewsDeregistered=this._onViewsDeregistered.event;_onDidChangeContainer=this._register(new _);onDidChangeContainer=this._onDidChangeContainer.event;_onDidChangeViewWelcomeContent=this._register(new _);onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;_viewContainers=[];_views=new Map;_viewWelcomeContents=new xd;registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.addViews(t,i)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){let i=this.removeViews(e,t);i.length&&this._onViewsDeregistered.fire({views:i,viewContainer:t})}moveViews(e,t){for(let i of this._views.keys())if(i!==t){let n=this.removeViews(e,i);n.length&&(this.addViews(n,t),this._onDidChangeContainer.fire({views:n,from:i,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(let t of this._viewContainers){let i=(this._views.get(t)||[]).filter(n=>n.id===e)[0];if(i)return i}return null}getViewContainer(e){for(let t of this._viewContainers)if((this._views.get(t)||[]).filter(n=>n.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),te(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){let i=new Map;for(let[n,o]of t)this._viewWelcomeContents.add(e,o),i.set(n,te(()=>{this._viewWelcomeContents.delete(e,o),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),i}getViewWelcomeContent(e){let t=[];return this._viewWelcomeContents.forEach(e,i=>t.push(i)),t.sort(TJ)}addViews(e,t){let i=this._views.get(t);i||(i=[],this._views.set(t,i),this._viewContainers.push(t));for(let n of e){if(this.getView(n.id)!==null)throw new Error(h("duplicateId","A view with id '{0}' is already registered",n.id));i.push(n)}}removeViews(e,t){let i=this._views.get(t);if(!i)return[];let n=[],o=[];for(let s of i)e.includes(s)?n.push(s):o.push(s);return n.length&&(o.length?this._views.set(t,o):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),n}};ze.add(VC.ViewsRegistry,new XB);var ua=Z("viewDescriptorService");var WC=Z("viewsService");var ALi=Z("IWorkspaceEditService"),tR=class{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(iR.is(t))return iR.lift(t);if(gd.is(t))return gd.lift(t);throw new Error("Unsupported edit")})}},iR=class r extends tR{constructor(t,i,n=void 0,o){super(o);this.resource=t;this.textEdit=i;this.versionId=n}static is(t){return t instanceof r?!0:gi(t)&&X.isUri(t.resource)&&gi(t.textEdit)}static lift(t){return t instanceof r?t:new r(t.resource,t.textEdit,t.versionId,t.metadata)}},gd=class r extends tR{constructor(t,i,n={},o){super(o);this.oldResource=t;this.newResource=i;this.options=n}static is(t){return t instanceof r?!0:gi(t)&&(!!t.newResource||!!t.oldResource)}static lift(t){return t instanceof r?t:new r(t.oldResource,t.newResource,t.options,t.metadata)}};var Zu=Z("explorerService");var Fs;(n=>{function r(o){return typeof o?.showDirectoryPicker=="function"}n.supported=r;function e(o){let s=o;return s?typeof s.kind=="string"&&typeof s.queryPermission=="function"&&typeof s.requestPermission=="function":!1}n.isFileSystemHandle=e;function t(o){return o.kind==="file"}n.isFileSystemFileHandle=t;function i(o){return o.kind==="directory"}n.isFileSystemDirectoryHandle=i})(Fs||={});var nR=class{constructor(e,t,i){this.indexedDB=e;this.store=t;this.logService=i}onDidChangeCapabilities=z.None;onDidChangeFile=z.None;extUri=_t?Nt:Sm;_capabilities;get capabilities(){return this._capabilities||(this._capabilities=18,_t&&(this._capabilities|=1024)),this._capabilities}async stat(e){try{let t=await this.getHandle(e);if(!t)throw this.createFileSystemProviderError(e,"No such file or directory, stat","EntryNotFound");if(Fs.isFileSystemFileHandle(t)){let i=await t.getFile();return{type:1,mtime:i.lastModified,ctime:0,size:i.size}}return{type:2,mtime:0,ctime:0,size:0}}catch(t){throw this.toFileSystemProviderError(t)}}async readdir(e){try{let t=await this.getDirectoryHandle(e);if(!t)throw this.createFileSystemProviderError(e,"No such file or directory, readdir","EntryNotFound");let i=[];for await(let[n,o]of t)i.push([n,Fs.isFileSystemFileHandle(o)?1:2]);return i}catch(t){throw this.toFileSystemProviderError(t)}}readFileStream(e,t,i){let n=Gm(o=>Qt.concat(o.map(s=>Qt.wrap(s))).buffer,{highWaterMark:10});return(async()=>{try{let o=await this.getFileHandle(e);if(!o)throw this.createFileSystemProviderError(e,"No such file or directory, readFile","EntryNotFound");let s=await o.getFile();if(typeof t.length=="number"||typeof t.position=="number"){let a=new Uint8Array(await s.arrayBuffer());typeof t?.position=="number"&&(a=a.slice(t.position)),typeof t?.length=="number"&&(a=a.slice(0,t.length)),n.end(a)}else{let a=s.stream().getReader(),l=await a.read();for(;!l.done&&!(i.isCancellationRequested||(await n.write(l.value),i.isCancellationRequested));)l=await a.read();n.end(void 0)}}catch(o){n.error(this.toFileSystemProviderError(o)),n.end()}})(),n}async readFile(e){try{let t=await this.getFileHandle(e);if(!t)throw this.createFileSystemProviderError(e,"No such file or directory, readFile","EntryNotFound");let i=await t.getFile();return new Uint8Array(await i.arrayBuffer())}catch(t){throw this.toFileSystemProviderError(t)}}async writeFile(e,t,i){try{let n=await this.getFileHandle(e);if(!i.create||!i.overwrite){if(n){if(!i.overwrite)throw this.createFileSystemProviderError(e,"File already exists, writeFile","EntryExists")}else if(!i.create)throw this.createFileSystemProviderError(e,"No such file, writeFile","EntryNotFound")}if(!n){let s=await this.getDirectoryHandle(this.extUri.dirname(e));if(!s)throw this.createFileSystemProviderError(e,"No such parent directory, writeFile","EntryNotFound");if(n=await s.getFileHandle(this.extUri.basename(e),{create:!0}),!n)throw this.createFileSystemProviderError(e,"Unable to create file , writeFile","Unknown")}let o=await n.createWritable();await o.write(t),await o.close()}catch(n){throw this.toFileSystemProviderError(n)}}async mkdir(e){try{let t=await this.getDirectoryHandle(this.extUri.dirname(e));if(!t)throw this.createFileSystemProviderError(e,"No such parent directory, mkdir","EntryNotFound");await t.getDirectoryHandle(this.extUri.basename(e),{create:!0})}catch(t){throw this.toFileSystemProviderError(t)}}async delete(e,t){try{let i=await this.getDirectoryHandle(this.extUri.dirname(e));if(!i)throw this.createFileSystemProviderError(e,"No such parent directory, delete","EntryNotFound");return i.removeEntry(this.extUri.basename(e),{recursive:t.recursive})}catch(i){throw this.toFileSystemProviderError(i)}}async rename(e,t,i){try{if(this.extUri.isEqual(e,t))return;let n=await this.getFileHandle(e);if(n){let o=await n.getFile(),s=new Uint8Array(await o.arrayBuffer());await this.writeFile(t,s,{create:!0,overwrite:i.overwrite,unlock:!1,atomic:!1}),await this.delete(e,{recursive:!1,useTrash:!1,atomic:!1})}else throw this.createFileSystemProviderError(e,h("fileSystemRenameError","Rename is only supported for files."),"Unavailable")}catch(n){throw this.toFileSystemProviderError(n)}}watch(e,t){return P.None}_files=new Map;_directories=new Map;registerFileHandle(e){return this.registerHandle(e,this._files)}registerDirectoryHandle(e){return this.registerHandle(e,this._directories)}get directories(){return this._directories.values()}async registerHandle(e,t){let i=`/${e.name}`;if(t.has(i)&&!await t.get(i)?.isSameEntry(e)){let n=Dc(e.name),o=ba(e.name,n),s=1;do i=`/${o}-${s++}${n}`;while(t.has(i)&&!await t.get(i)?.isSameEntry(e))}t.set(i,e);try{await this.indexedDB?.runInTransaction(this.store,"readwrite",n=>n.put(e,i))}catch(n){this.logService.error(n)}return X.from({scheme:ue.file,path:i})}async getHandle(e){let t=await this.doGetHandle(e);if(!t){let i=await this.getDirectoryHandle(this.extUri.dirname(e));if(i){let n=Nt.basename(e);try{t=await i.getFileHandle(n)}catch{try{t=await i.getDirectoryHandle(n)}catch{}}}}return t}async getFileHandle(e){let t=await this.doGetHandle(e);if(t instanceof FileSystemFileHandle)return t;let i=await this.getDirectoryHandle(this.extUri.dirname(e));try{return await i?.getFileHandle(Nt.basename(e))}catch{return}}async getDirectoryHandle(e){let t=await this.doGetHandle(e);if(t instanceof FileSystemDirectoryHandle)return t;let i=this.extUri.dirname(e);if(this.extUri.isEqual(i,e))return;let n=await this.getDirectoryHandle(i);try{return await n?.getDirectoryHandle(Nt.basename(e))}catch{return}}async doGetHandle(e){if(this.extUri.dirname(e).path!=="/")return;let t=e.path.replace(/\/$/,""),i=this._files.get(t)??this._directories.get(t);if(i)return i;let n=await this.indexedDB?.runInTransaction(this.store,"readonly",o=>o.get(t));if(Fs.isFileSystemHandle(n)){let o=await n.queryPermission()==="granted";try{o||(o=await n.requestPermission()==="granted")}catch(s){this.logService.error(s)}if(o)return Fs.isFileSystemFileHandle(n)?this._files.set(t,n):Fs.isFileSystemDirectoryHandle(n)&&this._directories.set(t,n),n}throw this.createFileSystemProviderError(e,"No file system handle registered","Unavailable")}toFileSystemProviderError(e){if(e instanceof hg)return e;let t="Unknown";return e.name==="NotAllowedError"&&(e=new Error(h("fileSystemNotAllowedError","Insufficient permissions. Please retry and allow the operation.")),t="Unavailable"),LM(e,t)}createFileSystemProviderError(e,t,i){return LM(new Error(`${t} (${ml(e.path)})`),i)}};var xb={EDITORS:"CodeEditors",FILES:"CodeFiles"};function _J(r){let e=[];if(r.dataTransfer&&r.dataTransfer.types.length>0){let n=r.dataTransfer.getData(xb.EDITORS);if(n)try{e.push(...ty(n))}catch{}else try{let a=r.dataTransfer.getData(Mo.RESOURCES);e.push(...JB(a))}catch{}if(r.dataTransfer?.files)for(let a=0;a<r.dataTransfer.files.length;a++){let l=r.dataTransfer.files[a];if(l&&l.path)try{e.push({resource:X.file(l.path),isExternal:!0,allowWorkspaceOpen:!0})}catch{}}let o=r.dataTransfer.getData(xb.FILES);if(o)try{let a=JSON.parse(o);for(let l of a)e.push({resource:X.file(l),isExternal:!0,allowWorkspaceOpen:!0})}catch{}let s=ze.as(rR.DragAndDropContribution).getAll();for(let a of s){let l=r.dataTransfer.getData(a.dataFormatKey);if(l)try{e.push(...a.getEditorInputs(l))}catch{}}}let t=[],i=new Cn;for(let n of e)n.resource?i.has(n.resource)||(t.push(n),i.set(n.resource,!0)):t.push(n);return t}async function oR(r,e){let t=_J(e);if(e.dataTransfer&&on&&eV(e,Mo.FILES)&&e.dataTransfer.items){let o=await r.get(ve).invokeFunction(s=>DJ(s,e));for(let s of o)t.push({resource:s.resource,contents:s.contents?.toString(),isExternal:!0,allowWorkspaceOpen:s.isDirectory})}return t}function JB(r){let e=[];if(r){let t=JSON.parse(r);for(let i of t)if(i.indexOf(":")>0){let{selection:n,uri:o}=B_(X.parse(i));e.push({resource:o,options:{selection:n}})}}return e}async function DJ(r,e){if(Fs.supported(Re)){let i=e.dataTransfer?.items;if(i)return LJ(r,i)}let t=e.dataTransfer?.files;return t?kJ(r,t):[]}async function LJ(r,e){let t=r.get(Lt).getProvider(ue.file);if(!(t instanceof nR))return[];let i=[];for(let n=0;n<e.length;n++){let o=e[n];if(o){let s=new ys;i.push(s),(async()=>{try{let a=await o.getAsFileSystemHandle();if(!a){s.complete(void 0);return}Fs.isFileSystemFileHandle(a)?s.complete({resource:await t.registerFileHandle(a),isDirectory:!1}):Fs.isFileSystemDirectoryHandle(a)?s.complete({resource:await t.registerDirectoryHandle(a),isDirectory:!0}):s.complete(void 0)}catch{s.complete(void 0)}})()}}return ni(await Promise.all(i.map(n=>n.p)))}async function kJ(r,e){let t=r.get(Io),i=[];for(let n=0;n<e.length;n++){let o=e.item(n);if(o){if(o.size>100*Xn.MB){t.warn(h("fileTooLarge","File is too large to open as untitled editor. Please upload it first into the file explorer and then try again."));continue}let s=new ys;i.push(s);let a=new FileReader;a.onerror=()=>s.complete(void 0),a.onabort=()=>s.complete(void 0),a.onload=async l=>{let d=o.name,c=l.target?.result??void 0;if(typeof d!="string"||typeof c>"u"){s.complete(void 0);return}s.complete({resource:X.from({scheme:ue.untitled,path:d}),contents:typeof c=="string"?Qt.fromString(c):Qt.wrap(new Uint8Array(c))})},a.readAsArrayBuffer(o)}}return ni(await Promise.all(i.map(n=>n.p)))}function eV(r,...e){if(!r.dataTransfer)return!1;let t=r.dataTransfer.types,i=[];for(let n=0;n<t.length;n++)i.push(t[n].toLowerCase());for(let n of e)if(i.indexOf(n.toLowerCase())>=0)return!0;return!1}var QB=class{_contributions=new Map;register(e){if(this._contributions.has(e.dataFormatKey))throw new Error(`A drag and drop contributiont with key '${e.dataFormatKey}' was already registered.`);this._contributions.set(e.dataFormatKey,e)}getAll(){return this._contributions.values()}},rR={DragAndDropContribution:"workbench.contributions.dragAndDrop"};ze.add(rR.DragAndDropContribution,new QB);var Xu=class r{static INSTANCE=new r;data;proto;constructor(){}static getInstance(){return r.INSTANCE}hasData(e){return e&&e===this.proto}clearData(e){this.hasData(e)&&(this.proto=void 0,this.data=void 0)}getData(e){if(this.hasData(e))return this.data}setData(e,t){t&&(this.data=e,this.proto=t)}};var tV=Z("workspacesService");var sR=Z("workspaceEditingService");var mc=class{constructor(e,t,i,n,o){this.progressService=e;this.dialogService=t;this.explorerService=i;this.editorService=n;this.fileService=o}static MAX_PARALLEL_UPLOADS=20;upload(e,t){let i=new Vi,n=this.progressService.withProgress({location:10,delay:800,cancellable:!0,title:h("uploadingFiles","Uploading")},async o=>this.doUpload(e,this.toTransfer(t),o,i.token),()=>i.dispose(!0));return this.progressService.withProgress({location:oh,delay:500},()=>n),n}toTransfer(e){if(Z2(e))return e.dataTransfer;let t={items:[]};for(let i of e)t.items.push({webkitGetAsEntry:()=>({name:i.name,isDirectory:!1,isFile:!0,createReader:()=>{throw new Error("Unsupported for files")},file:n=>n(i)})});return t}async doUpload(e,t,i,n){let o=t.items,s=[];for(let u of o)s.push(u.webkitGetAsEntry());let a=[],l={startTime:Date.now(),progressScheduler:new wp(u=>{i.report(u[u.length-1])},1e3),filesTotal:s.length,filesUploaded:0,totalBytesUploaded:0},d=new Lv(mc.MAX_PARALLEL_UPLOADS);await Rn.settled(s.map(u=>d.queue(async()=>{if(n.isCancellationRequested)return;if(e&&u.name&&e.getChild(u.name)){let{confirmed:m}=await this.dialogService.confirm(J3(u.name));if(!m||(await this.explorerService.applyBulkEdit([new gd(It(e.resource,u.name),void 0,{recursive:!0,folder:e.getChild(u.name)?.isDirectory})],{undoLabel:h("overwrite","Overwrite {0}",u.name),progressLabel:h("overwriting","Overwriting {0}",u.name)}),n.isCancellationRequested))return}let p=await this.doUploadEntry(u,e.resource,e,i,l,n);p&&a.push(p)}))),l.progressScheduler.dispose();let c=a[0];!n.isCancellationRequested&&c?.isFile&&await this.editorService.openEditor({resource:c.resource,options:{pinned:!0}})}async doUploadEntry(e,t,i,n,o,s){if(s.isCancellationRequested||!e.name||!e.isFile&&!e.isDirectory)return;let a=0,l=(c,u)=>{a+=u,o.totalBytesUploaded+=u;let p=o.totalBytesUploaded/((Date.now()-o.startTime)/1e3),m;c<Xn.MB?o.filesTotal===1?m=`${e.name}`:m=h("uploadProgressSmallMany","{0} of {1} files ({2}/s)",o.filesUploaded,o.filesTotal,Xn.formatSize(p)):m=h("uploadProgressLarge","{0} ({1} of {2}, {3}/s)",e.name,Xn.formatSize(a),Xn.formatSize(c),Xn.formatSize(p)),o.progressScheduler.work({message:m})};o.filesUploaded++,l(0,0);let d=It(t,e.name);if(e.isFile){let c=await new Promise((u,p)=>e.file(u,p));return s.isCancellationRequested?void 0:(typeof c.stream=="function"&&c.size>Xn.MB?await this.doUploadFileBuffered(d,c,l,s):await this.doUploadFileUnbuffered(d,c,l),{isFile:!0,resource:d})}else{if(await this.fileService.createFolder(d),s.isCancellationRequested)return;let c=e.createReader(),u=[],p=!1;do{let v=await new Promise((I,w)=>c.readEntries(I,w));v.length>0?u.push(...v):p=!0}while(!p&&!s.isCancellationRequested);o.filesTotal+=u.length;let m=i&&i.getChild(e.name)||void 0,f=[],g=[];for(let v of u)v.isFile?f.push(v):v.isDirectory&&g.push(v);let b=new Lv(mc.MAX_PARALLEL_UPLOADS);await Rn.settled(f.map(v=>b.queue(()=>this.doUploadEntry(v,d,m,n,o,s))));for(let v of g)await this.doUploadEntry(v,d,m,n,o,s);return{isFile:!1,resource:d}}}async doUploadFileBuffered(e,t,i,n){let o=jH({highWaterMark:10}),s=this.fileService.writeFile(e,o);try{let a=t.stream().getReader(),l=await a.read();for(;!l.done&&!n.isCancellationRequested;){let d=Qt.wrap(l.value);if(await o.write(d),n.isCancellationRequested)break;i(t.size,d.byteLength),l=await a.read()}o.end(void 0)}catch(a){o.error(a),o.end()}n.isCancellationRequested||await s}doUploadFileUnbuffered(e,t,i){return new Promise((n,o)=>{let s=new FileReader;s.onload=async a=>{try{if(a.target?.result instanceof ArrayBuffer){let l=Qt.wrap(new Uint8Array(a.target.result));await this.fileService.writeFile(e,l),i(t.size,l.byteLength)}else throw new Error("Could not read from dropped file.");n()}catch(l){o(l)}},s.readAsArrayBuffer(t)})}};mc=R([y(0,Qd),y(1,Io),y(2,Zu),y(3,vt),y(4,Lt)],mc);var aR=class{constructor(e,t,i,n,o,s,a,l,d,c,u){this.fileService=e;this.hostService=t;this.contextService=i;this.configurationService=n;this.dialogService=o;this.workspaceEditingService=s;this.explorerService=a;this.editorService=l;this.progressService=d;this.notificationService=c;this.instantiationService=u}async import(e,t,i){let n=new Vi,o=this.progressService.withProgress({location:10,delay:800,cancellable:!0,title:h("copyingFiles","Copying...")},async()=>await this.doImport(e,t,i,n.token),()=>n.dispose(!0));return this.progressService.withProgress({location:oh,delay:500},()=>o),o}async doImport(e,t,i,n){let o=ni((await this.instantiationService.invokeFunction(d=>oR(d,t))).map(d=>d.resource));await Promise.all(o.map(d=>this.fileService.activateProvider(d.scheme)));let s=ni(o.filter(d=>this.fileService.hasProvider(d))),a=await this.fileService.resolveAll(s.map(d=>({resource:d})));if(n.isCancellationRequested)return;this.hostService.focus(i);let l=a.filter(d=>d.success&&d.stat?.isDirectory).map(d=>({uri:d.stat.resource}));if(l.length>0&&e.isRoot){let d;(b=>(b[b.Copy=1]="Copy",b[b.Add=2]="Add"))(d||={});let c=[{label:l.length>1?h("copyFolders","&&Copy Folders"):h("copyFolder","&&Copy Folder"),run:()=>1}],u,p=this.contextService.getWorkspace().folders.map(f=>f.uri.scheme);l.some(f=>p.indexOf(f.uri.scheme)>=0)?(c.unshift({label:l.length>1?h("addFolders","&&Add Folders to Workspace"):h("addFolder","&&Add Folder to Workspace"),run:()=>2}),u=l.length>1?h("dropFolders","Do you want to copy the folders or add the folders to the workspace?"):h("dropFolder","Do you want to copy '{0}' or add '{0}' as a folder to the workspace?",Hi(l[0].uri))):u=l.length>1?h("copyfolders","Are you sure to want to copy folders?"):h("copyfolder","Are you sure to want to copy '{0}'?",Hi(l[0].uri));let{result:m}=await this.dialogService.prompt({type:As.Info,message:u,buttons:c,cancelButton:!0});if(m===2)return this.workspaceEditingService.addFolders(l);if(m===1)return this.importResources(e,s,n)}else if(e instanceof Eb)return this.importResources(e,s,n)}async importResources(e,t,i){if(t&&t.length>0){let n=await this.fileService.resolve(e.resource);if(i.isCancellationRequested)return;let o=new Set,s=this.fileService.hasCapability(e.resource,1024);n.children&&n.children.forEach(p=>{o.add(s?p.name:p.name.toLowerCase())});let a=0,l=ni(await Rn.settled(t.map(async p=>{if(!await this.fileService.exists(p)){a++;return}if(!(o.has(s?Hi(p):Hi(p).toLowerCase())&&!(await this.dialogService.confirm(J3(Hi(p)))).confirmed))return p})));a>0&&this.notificationService.error(a>1?h("filesInaccessible","Some or all of the dropped files could not be accessed for import."):h("fileInaccessible","The dropped file could not be accessed for import."));let d=l.map(p=>{let m=Hi(p),f=It(e.resource,m);return new gd(p,f,{overwrite:!0,copy:!0})}),c=this.configurationService.getValue().explorer.confirmUndo;if(await this.explorerService.applyBulkEdit(d,{undoLabel:l.length===1?h({comment:["substitution will be the name of the file that was imported"],key:"importFile"},"Import {0}",Hi(l[0])):h({comment:["substitution will be the number of files that were imported"],key:"importnFile"},"Import {0} resources",l.length),progressLabel:l.length===1?h({comment:["substitution will be the name of the file that was copied"],key:"copyingFile"},"Copying {0}",Hi(l[0])):h({comment:["substitution will be the number of files that were copied"],key:"copyingnFile"},"Copying {0} resources",l.length),progressLocation:10,confirmBeforeUndo:c==="verbose"||c==="default"}),this.configurationService.getValue().explorer.autoOpenDroppedFile&&d.length===1){let p=this.explorerService.findClosest(d[0].newResource);p&&!p.isDirectory&&this.editorService.openEditor({resource:p.resource,options:{pinned:!0}})}}}};aR=R([y(0,Lt),y(1,eo),y(2,bi),y(3,He),y(4,Io),y(5,sR),y(6,Zu),y(7,vt),y(8,Qd),y(9,Bo),y(10,ve)],aR);var gc=class{constructor(e,t,i,n,o,s){this.fileService=e;this.explorerService=t;this.progressService=i;this.logService=n;this.fileDialogService=o;this.storageService=s}static LAST_USED_DOWNLOAD_PATH_STORAGE_KEY="workbench.explorer.downloadPath";download(e){let t=new Vi,i=this.progressService.withProgress({location:10,delay:800,cancellable:on,title:h("downloadingFiles","Downloading")},async n=>this.doDownload(e,n,t),()=>t.dispose(!0));return this.progressService.withProgress({location:oh,delay:500},()=>i),i}async doDownload(e,t,i){for(let n of e){if(i.token.isCancellationRequested)return;on?await this.doDownloadBrowser(n.resource,t,i):await this.doDownloadNative(n,t,i)}}async doDownloadBrowser(e,t,i){let n=await this.fileService.resolve(e,{resolveMetadata:!0});if(i.token.isCancellationRequested)return;let o=32*Xn.MB,s=n.isDirectory||n.size>o,a=Kr();if(s&&Fs.supported(a))try{let l=await a.showDirectoryPicker(),d={startTime:Date.now(),progressScheduler:new wp(c=>{t.report(c[c.length-1])},1e3),filesTotal:n.isDirectory?0:1,filesDownloaded:0,totalBytesDownloaded:0,fileBytesDownloaded:0};if(n.isDirectory){let c=await l.getDirectoryHandle(n.name,{create:!0});await this.downloadFolderBrowser(n,c,d,i.token)}else await this.downloadFileBrowser(l,n,d,i.token);d.progressScheduler.dispose()}catch(l){this.logService.warn(l),i.cancel()}else if(n.isFile){let l;try{l=(await this.fileService.readFile(n.resource,{limits:{size:o}},i.token)).value.buffer}catch{l=Hr.uriToBrowserUri(n.resource)}i.token.isCancellationRequested||iH(l,n.name)}}async downloadFileBufferedBrowser(e,t,i,n){let o=await this.fileService.readFileStream(e,void 0,n);if(n.isCancellationRequested){t.close();return}return new Promise((s,a)=>{let l=o.value,d=new Y;d.add(te(()=>t.close())),d.add(ps(n.onCancellationRequested)(()=>{d.dispose(),a(WV())})),ey(l,{onData:c=>{t.write(c.buffer),this.reportProgress(o.name,o.size,c.byteLength,i)},onError:c=>{d.dispose(),a(c)},onEnd:()=>{d.dispose(),s()}},n)})}async downloadFileUnbufferedBrowser(e,t,i,n){let o=await this.fileService.readFile(e,void 0,n);n.isCancellationRequested||(t.write(o.value.buffer),this.reportProgress(o.name,o.size,o.value.byteLength,i)),t.close()}async downloadFileBrowser(e,t,i,n){i.filesDownloaded++,i.fileBytesDownloaded=0,this.reportProgress(t.name,0,0,i);let s=await(await e.getFileHandle(t.name,{create:!0})).createWritable();return t.size>Xn.MB?this.downloadFileBufferedBrowser(t.resource,s,i,n):this.downloadFileUnbufferedBrowser(t.resource,s,i,n)}async downloadFolderBrowser(e,t,i,n){if(e.children){i.filesTotal+=e.children.map(o=>o.isFile).length;for(let o of e.children){if(n.isCancellationRequested)return;if(o.isFile)await this.downloadFileBrowser(t,o,i,n);else{let s=await t.getDirectoryHandle(o.name,{create:!0}),a=await this.fileService.resolve(o.resource,{resolveMetadata:!0});await this.downloadFolderBrowser(a,s,i,n)}}}}reportProgress(e,t,i,n){n.fileBytesDownloaded+=i,n.totalBytesDownloaded+=i;let o=n.totalBytesDownloaded/((Date.now()-n.startTime)/1e3),s;t<Xn.MB?n.filesTotal===1?s=e:s=h("downloadProgressSmallMany","{0} of {1} files ({2}/s)",n.filesDownloaded,n.filesTotal,Xn.formatSize(o)):s=h("downloadProgressLarge","{0} ({1} of {2}, {3}/s)",e,Xn.formatSize(n.fileBytesDownloaded),Xn.formatSize(t),Xn.formatSize(o)),n.progressScheduler.work({message:s})}async doDownloadNative(e,t,i){t.report({message:e.name});let n,o=this.storageService.get(gc.LAST_USED_DOWNLOAD_PATH_STORAGE_KEY,-1);o?n=It(X.file(o),e.name):n=It(e.isDirectory?await this.fileDialogService.defaultFolderPath(ue.file):await this.fileDialogService.defaultFilePath(ue.file),e.name);let s=await this.fileDialogService.showSaveDialog({availableFileSystems:[ue.file],saveLabel:eT(h("downloadButton","Download")),title:h("chooseWhereToDownload","Choose Where to Download"),defaultUri:n});s?(this.storageService.store(gc.LAST_USED_DOWNLOAD_PATH_STORAGE_KEY,Gs(s).fsPath,-1,1),await this.explorerService.applyBulkEdit([new gd(e.resource,s,{overwrite:!0,copy:!0})],{undoLabel:h("downloadBulkEdit","Download {0}",e.name),progressLabel:h("downloadingBulkEdit","Downloading {0}",e.name),progressLocation:10})):i.cancel()}};gc=R([y(0,Lt),y(1,Zu),y(2,Qd),y(3,Oi),y(4,Wg),y(5,Ii)],gc);function J3(r){return{message:h("confirmOverwrite","A file or folder with the name '{0}' already exists in the destination folder. Do you want to replace it?",r),detail:h("irreversible","This action is irreversible!"),primaryButton:h({key:"replaceButtonLabel",comment:["&& denotes a mnemonic"]},"&&Replace"),type:"warning"}}var lR=class r extends P{static HEADER_SIZE=22;element;header;body;_expanded;_orientation;expandedSize=void 0;_headerVisible=!0;_collapsible=!0;_bodyRendered=!1;_minimumBodySize;_maximumBodySize;_ariaHeaderLabel;styles={dropBackground:void 0,headerBackground:void 0,headerBorder:void 0,headerForeground:void 0,leftBorder:void 0};animationTimer=void 0;_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;_onDidChangeExpansionState=this._register(new _);onDidChangeExpansionState=this._onDidChangeExpansionState.event;get ariaHeaderLabel(){return this._ariaHeaderLabel}set ariaHeaderLabel(e){this._ariaHeaderLabel=e,this.header.setAttribute("aria-label",this.ariaHeaderLabel)}get draggableElement(){return this.header}get dropTargetElement(){return this.element}get dropBackground(){return this.styles.dropBackground}get minimumBodySize(){return this._minimumBodySize}set minimumBodySize(e){this._minimumBodySize=e,this._onDidChange.fire(void 0)}get maximumBodySize(){return this._maximumBodySize}set maximumBodySize(e){this._maximumBodySize=e,this._onDidChange.fire(void 0)}get headerSize(){return this.headerVisible?r.HEADER_SIZE:0}get minimumSize(){let e=this.headerSize,i=!this.headerVisible||this.isExpanded()?this.minimumBodySize:0;return e+i}get maximumSize(){let e=this.headerSize,i=!this.headerVisible||this.isExpanded()?this.maximumBodySize:0;return e+i}orthogonalSize=0;constructor(e){super(),this._expanded=typeof e.expanded>"u"?!0:!!e.expanded,this._orientation=typeof e.orientation>"u"?0:e.orientation,this._ariaHeaderLabel=h("viewSection","{0} Section",e.title),this._minimumBodySize=typeof e.minimumBodySize=="number"?e.minimumBodySize:this._orientation===1?200:120,this._maximumBodySize=typeof e.maximumBodySize=="number"?e.maximumBodySize:Number.POSITIVE_INFINITY,this.element=he(".pane")}isExpanded(){return this._expanded}setExpanded(e){return!e&&!this.collapsible||this._expanded===!!e?!1:(this.element?.classList.toggle("expanded",e),this._expanded=!!e,this.updateHeader(),e?(this._bodyRendered||(this.renderBody(this.body),this._bodyRendered=!0),typeof this.animationTimer=="number"&&pe(this.element).clearTimeout(this.animationTimer),ye(this.element,this.body)):this.animationTimer=pe(this.element).setTimeout(()=>{this.body.remove()},200),this._onDidChangeExpansionState.fire(e),this._onDidChange.fire(e?this.expandedSize:void 0),!0)}get headerVisible(){return this._headerVisible}set headerVisible(e){this._headerVisible!==!!e&&(this._headerVisible=!!e,this.updateHeader(),this._onDidChange.fire(void 0))}get collapsible(){return this._collapsible}set collapsible(e){this._collapsible!==!!e&&(this._collapsible=!!e,this.updateHeader())}get orientation(){return this._orientation}set orientation(e){this._orientation!==e&&(this._orientation=e,this.element&&(this.element.classList.toggle("horizontal",this.orientation===1),this.element.classList.toggle("vertical",this.orientation===0)),this.header&&this.updateHeader())}render(){this.element.classList.toggle("expanded",this.isExpanded()),this.element.classList.toggle("horizontal",this.orientation===1),this.element.classList.toggle("vertical",this.orientation===0),this.header=he(".pane-header"),ye(this.element,this.header),this.header.setAttribute("tabindex","0"),this.header.setAttribute("role","button"),this.header.setAttribute("aria-label",this.ariaHeaderLabel),this.renderHeader(this.header);let e=Mn(this.header);this._register(e),this._register(e.onDidFocus(()=>this.header.classList.add("focused"),null)),this._register(e.onDidBlur(()=>this.header.classList.remove("focused"),null)),this.updateHeader();let t=this._register(new Y),i=this._register(new Me(this.header,"keydown")),n=z.map(i.event,o=>new bt(o),t);this._register(z.filter(n,o=>o.keyCode===3||o.keyCode===10,t)(()=>this.setExpanded(!this.isExpanded()),null)),this._register(z.filter(n,o=>o.keyCode===15,t)(()=>this.setExpanded(!1),null)),this._register(z.filter(n,o=>o.keyCode===17,t)(()=>this.setExpanded(!0),null)),this._register(ei.addTarget(this.header)),[Q.CLICK,it.Tap].forEach(o=>{this._register(B(this.header,o,s=>{s.defaultPrevented||this.setExpanded(!this.isExpanded())}))}),this.body=ye(this.element,he(".pane-body")),!this._bodyRendered&&this.isExpanded()&&(this.renderBody(this.body),this._bodyRendered=!0),this.isExpanded()||this.body.remove()}layout(e){let t=this.headerVisible?r.HEADER_SIZE:0,i=this._orientation===0?this.orthogonalSize:e,n=this._orientation===0?e-t:this.orthogonalSize-t;this.isExpanded()&&(this.body.classList.toggle("wide",i>=600),this.layoutBody(n,i),this.expandedSize=e)}style(e){this.styles=e,this.header&&this.updateHeader()}updateHeader(){let e=!this.headerVisible||this.isExpanded();this.collapsible?(this.header.setAttribute("tabindex","0"),this.header.setAttribute("role","button")):(this.header.removeAttribute("tabindex"),this.header.removeAttribute("role")),this.header.style.lineHeight=`${this.headerSize}px`,this.header.classList.toggle("hidden",!this.headerVisible),this.header.classList.toggle("expanded",e),this.header.classList.toggle("not-collapsible",!this.collapsible),this.header.setAttribute("aria-expanded",String(e)),this.header.style.color=this.collapsible?this.styles.headerForeground??"":"",this.header.style.backgroundColor=(this.collapsible?this.styles.headerBackground:"transparent")??"",this.header.style.borderTop=this.styles.headerBorder&&this.orientation===0?`1px solid ${this.styles.headerBorder}`:"",this.element.style.borderLeft=this.styles.leftBorder&&this.orientation===1?`1px solid ${this.styles.leftBorder}`:""}},iV=class r extends P{constructor(t,i,n){super();this.pane=t;this.dnd=i;this.context=n;t.draggableElement.draggable=!0,this._register(B(t.draggableElement,"dragstart",o=>this.onDragStart(o))),this._register(B(t.dropTargetElement,"dragenter",o=>this.onDragEnter(o))),this._register(B(t.dropTargetElement,"dragleave",o=>this.onDragLeave(o))),this._register(B(t.dropTargetElement,"dragend",o=>this.onDragEnd(o))),this._register(B(t.dropTargetElement,"drop",o=>this.onDrop(o)))}static DefaultDragOverBackgroundColor=new U(new lt(128,128,128,.5));dragOverCounter=0;_onDidDrop=this._register(new _);onDidDrop=this._onDidDrop.event;onDragStart(t){if(!this.dnd.canDrag(this.pane)||!t.dataTransfer){t.preventDefault(),t.stopPropagation();return}t.dataTransfer.effectAllowed="move",$i&&t.dataTransfer?.setData(Mo.TEXT,this.pane.draggableElement.textContent||"");let i=ye(this.pane.element.ownerDocument.body,he(".monaco-drag-image",{},this.pane.draggableElement.textContent||""));t.dataTransfer.setDragImage(i,-10,-10),setTimeout(()=>i.remove(),0),this.context.draggable=this}onDragEnter(t){!this.context.draggable||this.context.draggable===this||this.dnd.canDrop(this.context.draggable.pane,this.pane)&&(this.dragOverCounter++,this.render())}onDragLeave(t){!this.context.draggable||this.context.draggable===this||this.dnd.canDrop(this.context.draggable.pane,this.pane)&&(this.dragOverCounter--,this.dragOverCounter===0&&this.render())}onDragEnd(t){this.context.draggable&&(this.dragOverCounter=0,this.render(),this.context.draggable=null)}onDrop(t){this.context.draggable&&(Oe.stop(t),this.dragOverCounter=0,this.render(),this.dnd.canDrop(this.context.draggable.pane,this.pane)&&this.context.draggable!==this&&this._onDidDrop.fire({from:this.context.draggable.pane,to:this.pane}),this.context.draggable=null)}render(){let t=null;this.dragOverCounter>0&&(t=this.pane.dropBackground??r.DefaultDragOverBackgroundColor.toString()),this.pane.dropTargetElement.style.backgroundColor=t||""}};var dR=class extends P{dnd;dndContext={draggable:null};element;paneItems=[];orthogonalSize=0;size=0;splitview;animationTimer=void 0;_onDidDrop=this._register(new _);onDidDrop=this._onDidDrop.event;orientation;boundarySashes;onDidSashChange;onDidSashReset;onDidScroll;constructor(e,t={}){super(),this.dnd=t.dnd,this.orientation=t.orientation??0,this.element=ye(e,he(".monaco-pane-view")),this.splitview=this._register(new Xl(this.element,{orientation:this.orientation})),this.onDidSashReset=this.splitview.onDidSashReset,this.onDidSashChange=this.splitview.onDidSashChange,this.onDidScroll=this.splitview.onDidScroll;let i=this._register(new Y),n=this._register(new Me(this.element,"keydown")),o=z.map(z.filter(n.event,s=>ki(s.target)&&s.target.classList.contains("pane-header"),i),s=>new bt(s),i);this._register(z.filter(o,s=>s.keyCode===16,i)(()=>this.focusPrevious())),this._register(z.filter(o,s=>s.keyCode===18,i)(()=>this.focusNext()))}addPane(e,t,i=this.splitview.length){let n=new Y;e.onDidChangeExpansionState(this.setupAnimation,this,n);let o={pane:e,disposable:n};if(this.paneItems.splice(i,0,o),e.orientation=this.orientation,e.orthogonalSize=this.orthogonalSize,this.splitview.addView(e,t,i),this.dnd){let s=new iV(e,this.dnd,this.dndContext);n.add(s),n.add(s.onDidDrop(this._onDidDrop.fire,this._onDidDrop))}}removePane(e){let t=this.paneItems.findIndex(n=>n.pane===e);if(t===-1)return;this.splitview.removeView(t,e.isExpanded()?Ql.Distribute:void 0),this.paneItems.splice(t,1)[0].disposable.dispose()}movePane(e,t){let i=this.paneItems.findIndex(s=>s.pane===e),n=this.paneItems.findIndex(s=>s.pane===t);if(i===-1||n===-1)return;let[o]=this.paneItems.splice(i,1);this.paneItems.splice(n,0,o),this.splitview.moveView(i,n)}resizePane(e,t){let i=this.paneItems.findIndex(n=>n.pane===e);i!==-1&&this.splitview.resizeView(i,t)}getPaneSize(e){let t=this.paneItems.findIndex(i=>i.pane===e);return t===-1?-1:this.splitview.getViewSize(t)}layout(e,t){this.orthogonalSize=this.orientation===0?t:e,this.size=this.orientation===1?t:e;for(let i of this.paneItems)i.pane.orthogonalSize=this.orthogonalSize;this.splitview.layout(this.size)}setBoundarySashes(e){this.boundarySashes=e,this.updateSplitviewOrthogonalSashes(e)}updateSplitviewOrthogonalSashes(e){this.orientation===0?(this.splitview.orthogonalStartSash=e?.left,this.splitview.orthogonalEndSash=e?.right):this.splitview.orthogonalEndSash=e?.bottom}flipOrientation(e,t){this.orientation=this.orientation===0?1:0;let i=this.paneItems.map(s=>this.getPaneSize(s.pane));this.splitview.dispose(),Xt(this.element),this.splitview=this._register(new Xl(this.element,{orientation:this.orientation})),this.updateSplitviewOrthogonalSashes(this.boundarySashes);let n=this.orientation===0?t:e,o=this.orientation===1?t:e;this.paneItems.forEach((s,a)=>{s.pane.orthogonalSize=n,s.pane.orientation=this.orientation;let l=this.size===0?0:o*i[a]/this.size;this.splitview.addView(s.pane,l,a)}),this.size=o,this.orthogonalSize=n,this.splitview.layout(this.size)}setupAnimation(){typeof this.animationTimer=="number"&&pe(this.element).clearTimeout(this.animationTimer),this.element.classList.add("animated"),this.animationTimer=pe(this.element).setTimeout(()=>{this.animationTimer=void 0,this.element.classList.remove("animated")},200)}getPaneHeaderElements(){return[...this.element.querySelectorAll(".pane-header")]}focusPrevious(){let e=this.getPaneHeaderElements(),t=e.indexOf(this.element.ownerDocument.activeElement);t!==-1&&e[Math.max(t-1,0)].focus()}focusNext(){let e=this.getPaneHeaderElements(),t=e.indexOf(this.element.ownerDocument.activeElement);t!==-1&&e[Math.min(t+1,e.length-1)].focus()}dispose(){super.dispose(),this.paneItems.forEach(e=>e.disposable.dispose())}};var nV=class extends P{constructor(t,i,n,o){super();this.options=i;this.menuService=n;this.contextKeyService=o;this.menu=this._register(n.createMenu(t,o)),this._register(this.menu.onDidChange(()=>this.updateActions())),this.updateActions()}menu;_primaryActions=[];get primaryActions(){return this._primaryActions}_secondaryActions=[];get secondaryActions(){return this._secondaryActions}_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;disposables=this._register(new Y);updateActions(){this.disposables.clear(),this._primaryActions=[],this._secondaryActions=[],zu(this.menu,this.options,{primary:this._primaryActions,secondary:this._secondaryActions}),this.disposables.add(this.updateSubmenus([...this._primaryActions,...this._secondaryActions],{})),this._onDidChange.fire()}updateSubmenus(t,i){let n=new Y;for(let o of t)if(o instanceof Po&&!i[o.item.submenu.id]){let s=i[o.item.submenu.id]=n.add(this.menuService.createMenu(o.item.submenu,this.contextKeyService));n.add(s.onDidChange(()=>this.updateActions())),n.add(this.updateSubmenus(o.actions,i))}return n}},Qu=class extends P{constructor(t,i,n,o,s){super();this.menuId=t;this.contextMenuId=i;this.options=n;this.contextKeyService=o;this.menuService=s;this.menuActions=this._register(new nV(t,this.options,s,o)),this._register(this.menuActions.onDidChange(()=>this._onDidChange.fire()))}menuActions;_onDidChange=this._register(new _);onDidChange=this._onDidChange.event;getPrimaryActions(){return this.menuActions.primaryActions}getSecondaryActions(){return this.menuActions.secondaryActions}getContextMenuActions(){let t=[];if(this.contextMenuId){let i=this.menuService.getMenuActions(this.contextMenuId,this.contextKeyService,this.options);zu(i,{primary:[],secondary:t})}return t}};Qu=R([y(3,je),y(4,xs)],Qu);var cR=class extends P{constructor(t){super();this.channelName=t;if("BroadcastChannel"in Re)try{this.broadcastChannel=new BroadcastChannel(t);let i=n=>{this._onDidReceiveData.fire(n.data)};this.broadcastChannel.addEventListener("message",i),this._register(te(()=>{this.broadcastChannel&&(this.broadcastChannel.removeEventListener("message",i),this.broadcastChannel.close())}))}catch(i){console.warn("Error while creating broadcast channel. Falling back to localStorage.",Qb(i))}this.broadcastChannel||(this.channelName=`BroadcastDataChannel.${t}`,this.createBroadcastChannel())}broadcastChannel;_onDidReceiveData=this._register(new _);onDidReceiveData=this._onDidReceiveData.event;createBroadcastChannel(){let t=i=>{i.key===this.channelName&&i.newValue&&this._onDidReceiveData.fire(JSON.parse(i.newValue))};Re.addEventListener("storage",t),this._register(te(()=>Re.removeEventListener("storage",t)))}postData(t){this.broadcastChannel?this.broadcastChannel.postMessage(t):(localStorage.removeItem(this.channelName),localStorage.setItem(this.channelName,JSON.stringify(t)))}};var Bs=class{constructor(e){this.identifier=e}},Vs=class{constructor(e){this.identifier=e}};async function eK(r){let e=[],t=zo.uriList.toLowerCase();if(r.has(t))try{let i=await r.get(t)?.asString(),n=JSON.stringify(vy.parse(i??""));e.push(...JB(n))}catch{}return e}var Ju=class{constructor(e,t,i,n,o,s,a,l){this.options=e;this.fileService=t;this.workspacesService=i;this.editorService=n;this.workspaceEditingService=o;this.hostService=s;this.contextService=a;this.instantiationService=l}async handleDrop(e,t,i,n,o){let s=await this.instantiationService.invokeFunction(d=>oR(d,e));if(!s.length)return;if(await this.hostService.focus(t),this.options.allowWorkspaceOpen){let d=ni(s.filter(c=>c.allowWorkspaceOpen&&c.resource?.scheme===ue.file).map(c=>c.resource));if(d.length>0&&await this.handleWorkspaceDrop(d))return}let a=ni(s.filter(d=>d.isExternal&&d.resource?.scheme===ue.file).map(d=>d.resource));a.length&&this.workspacesService.addRecentlyOpened(a.map(d=>({fileUri:d})));let l=i?.();await this.editorService.openEditors(s.map(d=>({...d,resource:d.resource,options:{...d.options,...o,pinned:!0}})),l,{validateTrust:!0}),n?.(l)}async handleWorkspaceDrop(e){let t=[],i=[];return await Promise.all(e.map(async n=>{if(hU(n)){t.push({workspaceUri:n});return}try{let o=await this.fileService.stat(n);o.isDirectory&&(t.push({folderUri:o.resource}),i.push({uri:o.resource}))}catch{}})),t.length===0?!1:(t.length>i.length||i.length===1?await this.hostService.openWindow(t):pU(this.contextService.getWorkspace())?await this.workspaceEditingService.addFolders(i):await this.workspaceEditingService.createAndEnterWorkspace(i),!0)}};Ju=R([y(1,Lt),y(2,tV),y(3,vt),y(4,sR),y(5,eo),y(6,bi),y(7,ve)],Ju);function HC(r,e,t,i){if(e.length===0||!t.dataTransfer)return;let n=r.get(jl),o=r.get(vt),s=r.get(Lt),a=r.get(na),l=ni(e.map(m=>X.isUri(m)?{resource:m}:hT(m)?X.isUri(m.editor.resource)?{resource:m.editor.resource}:void 0:m)),d=l.filter(({resource:m})=>s.hasProvider(m));if(!i?.disableStandardTransfer){let m=dt?`\r
`:`
`;t.dataTransfer.setData(Mo.TEXT,d.map(({resource:g})=>a.getUriLabel(g,{noPrefix:!0})).join(m));let f=d.find(({isDirectory:g})=>!g);if(f){let g=Hr.uriToFileUri(f.resource);g.scheme===ue.file&&t.dataTransfer.setData(Mo.DOWNLOAD_URL,[zo.binary,Hi(f.resource),g.toString()].join(":"))}}let c=d.filter(({isDirectory:m})=>!m);c.length&&t.dataTransfer.setData(Mo.RESOURCES,JSON.stringify(c.map(({resource:m})=>m.toString())));let u=ze.as(rR.DragAndDropContribution).getAll();for(let m of u)m.setData(l,t);let p=[];for(let m of e){let f;if(hT(m)){let g=m.editor.toUntyped({preserveViewState:m.groupId});g&&(f={...g,resource:Mt.getCanonicalUri(g)})}else if(X.isUri(m)){let{selection:g,uri:b}=B_(m);f={resource:b,options:g?{selection:g}:void 0}}else m.isDirectory||(f={resource:m.resource});if(f){{let g=f.resource;if(g){let b=n.files.get(g);b&&(typeof f.languageId!="string"&&(f.languageId=b.getLanguageId()),typeof f.encoding!="string"&&(f.encoding=b.getEncoding()),typeof f.contents!="string"&&b.isDirty()&&!b.textEditorModel.isTooLargeForHeapOperation()&&(f.contents=b.textEditorModel.getValue())),f.options?.viewState||(f.options={...f.options,viewState:(()=>{for(let v of o.visibleEditorPanes)if(Li(v.input.resource,g)){let I=v.getViewState();if(I)return I}})()})}}p.push(f)}}if(p.length){t.dataTransfer.setData(xb.EDITORS,Y1(p));let m=[];for(let f of p)f.resource?m.push(f.resource):Ls(f)?f.modified.resource&&m.push(f.modified.resource):Kl(f)?f.primary.resource&&m.push(f.primary.resource):Gl(f)&&m.push(f.result.resource);i?.disableStandardTransfer||t.dataTransfer.setData(zo.uriList,vy.create(m.slice(0,1))),t.dataTransfer.setData(Mo.INTERNAL_URI_LIST,vy.create(m))}}var oV=class{constructor(e,t){this.type=e;this.id=t}update(e){}getData(){return{type:this.type,id:this.id}}},Qh=class{constructor(e){this.compositeId=e}get id(){return this.compositeId}},Jh=class{constructor(e){this.viewId=e}get id(){return this.viewId}},Tb=class r extends P{static instance;static get INSTANCE(){return r.instance||(r.instance=new r,gl(r.instance)),r.instance}transferData=Xu.getInstance();onDragStart=this._register(new _);onDragEnd=this._register(new _);constructor(){super(),this._register(this.onDragEnd.event(e=>{let t=e.dragAndDropData.getData().id,i=e.dragAndDropData.getData().type;this.readDragData(i)?.getData().id===t&&this.transferData.clearData(i==="view"?Jh.prototype:Qh.prototype)}))}readDragData(e){if(this.transferData.hasData(e==="view"?Jh.prototype:Qh.prototype)){let t=this.transferData.getData(e==="view"?Jh.prototype:Qh.prototype);if(t&&t[0])return new oV(e,t[0].id)}}writeDragData(e,t){this.transferData.setData([t==="view"?new Jh(e):new Qh(e)],t==="view"?Jh.prototype:Qh.prototype)}registerTarget(e,t){let i=new Y;return i.add(new zr(e,{onDragEnter:n=>{if(n.preventDefault(),t.onDragEnter){let o=this.readDragData("composite")||this.readDragData("view");o&&t.onDragEnter({eventData:n,dragAndDropData:o})}},onDragLeave:n=>{let o=this.readDragData("composite")||this.readDragData("view");t.onDragLeave&&o&&t.onDragLeave({eventData:n,dragAndDropData:o})},onDrop:n=>{if(t.onDrop){let o=this.readDragData("composite")||this.readDragData("view");if(!o)return;t.onDrop({eventData:n,dragAndDropData:o}),this.onDragEnd.fire({eventData:n,dragAndDropData:o})}},onDragOver:n=>{if(n.preventDefault(),t.onDragOver){let o=this.readDragData("composite")||this.readDragData("view");if(!o)return;t.onDragOver({eventData:n,dragAndDropData:o})}}})),t.onDragStart&&this.onDragStart.event(n=>{t.onDragStart(n)},this,i),t.onDragEnd&&this.onDragEnd.event(n=>{t.onDragEnd(n)},this,i),this._register(i)}registerDraggable(e,t,i){e.draggable=!0;let n=new Y;return n.add(new zr(e,{onDragStart:o=>{let{id:s,type:a}=t();this.writeDragData(s,a),o.dataTransfer?.setDragImage(e,0,0),this.onDragStart.fire({eventData:o,dragAndDropData:this.readDragData(a)})},onDragEnd:o=>{let{type:s}=t(),a=this.readDragData(s);a&&this.onDragEnd.fire({eventData:o,dragAndDropData:a})},onDragEnter:o=>{if(i.onDragEnter){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;s&&i.onDragEnter({eventData:o,dragAndDropData:s})}},onDragLeave:o=>{let s=this.readDragData("composite")||this.readDragData("view");s&&i.onDragLeave?.({eventData:o,dragAndDropData:s})},onDrop:o=>{if(i.onDrop){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;i.onDrop({eventData:o,dragAndDropData:s}),this.onDragEnd.fire({eventData:o,dragAndDropData:s})}},onDragOver:o=>{if(i.onDragOver){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;i.onDragOver({eventData:o,dragAndDropData:s})}}})),i.onDragStart&&this.onDragStart.event(o=>{i.onDragStart(o)},this,n),i.onDragEnd&&this.onDragEnd.event(o=>{i.onDragEnd(o)},this,n),this._register(n)}};function sV(r,e,t){r&&(r.dropEffect=t?e:"none")}var uR=class{constructor(e,t){this.toResource=e;this.instantiationService=t}getDragURI(e){let t=this.toResource(e);return t?t.toString():null}getDragLabel(e){let t=ni(e.map(this.toResource));return t.length===1?Hi(t[0]):t.length>1?String(t.length):void 0}onDragStart(e,t){let i=[];for(let n of e.elements){let o=this.toResource(n);o&&i.push(o)}i.length&&this.instantiationService.invokeFunction(n=>HC(n,i,t))}onDragOver(e,t,i,n,o){return!1}drop(e,t,i,n,o){}dispose(){}};uR=R([y(1,ve)],uR);var rV=class r extends P{static CHANNEL_NAME="monaco-workbench-global-dragged-over";broadcaster=this._register(new cR(r.CHANNEL_NAME));constructor(){super(),this.registerListeners()}registerListeners(){this._register(z.runAndSubscribe(Uv,({window:e,disposables:t})=>{t.add(B(e,Q.DRAG_OVER,()=>this.markDraggedOver(!1),!0)),t.add(B(e,Q.DRAG_LEAVE,()=>this.clearDraggedOver(!1),!0))},{window:Re,disposables:this._store})),this._register(this.broadcaster.onDidReceiveData(e=>{e===!0?this.markDraggedOver(!0):this.clearDraggedOver(!0)}))}draggedOver=!1;get isDraggedOver(){return this.draggedOver}markDraggedOver(e){this.draggedOver!==!0&&(this.draggedOver=!0,e||this.broadcaster.postData(!0))}clearDraggedOver(e){this.draggedOver!==!1&&(this.draggedOver=!1,e||this.broadcaster.postData(!1))}},OJ=new rV;function pR(){return OJ.isDraggedOver}var hR=class{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}};R([me],hR.prototype,"toString",1);var PJ=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function tK(r){let e=[],t=0,i;for(;i=PJ.exec(r);){i.index-t>0&&e.push(r.substring(t,i.index));let[,n,o,,s]=i;s?e.push({label:n,href:o,title:s}):e.push({label:n,href:o}),t=i.index+i[0].length}return t<r.length&&e.push(r.substring(t)),new hR(e)}var _b=class extends P{constructor(t,i,n={},o,s){super();this._link=i;this._hoverService=o;this.el=ye(t,he("a.monaco-link",{tabIndex:i.tabIndex??0,href:i.href},i.label)),this.hoverDelegate=n.hoverDelegate??Dt("mouse"),this.setTooltip(i.title),this.el.setAttribute("role","button");let a=this._register(new Me(this.el,"click")),l=this._register(new Me(this.el,"keypress")),d=z.chain(l.event,p=>p.map(m=>new bt(m)).filter(m=>m.keyCode===3)),c=this._register(new Me(this.el,it.Tap)).event;this._register(ei.addTarget(this.el));let u=z.any(a.event,d,c);this._register(u(p=>{this.enabled&&(Oe.stop(p,!0),n?.opener?n.opener(this._link.href):s.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}el;hover;hoverDelegate;_enabled=!0;get enabled(){return this._enabled}set enabled(t){t?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=t}set link(t){typeof t.label=="string"?this.el.textContent=t.label:(Xt(this.el),this.el.appendChild(t.label)),this.el.href=t.href,typeof t.tabIndex<"u"&&(this.el.tabIndex=t.tabIndex),this.setTooltip(t.title),this._link=t}setTooltip(t){this.hoverDelegate.showNativeHover?this.el.title=t??"":!this.hover&&t?this.hover=this._register(this._hoverService.setupManagedHover(this.hoverDelegate,this.el,t)):this.hover&&this.hover.update(t)}};_b=R([y(3,Gu),y(4,qa)],_b);var mR=class extends P{constructor(t,i){super();this.progressBar=t;this.group=i;this.registerListeners()}registerListeners(){this._register(this.group.onDidModelChange(t=>{(t.kind===8||t.kind===6&&this.group.isEmpty)&&this.progressBar.stop().hide()}))}show(t,i){return this.group.isEmpty?d8:t===!0?this.doShow(!0,i):this.doShow(t,i)}doShow(t,i){return typeof t=="boolean"?this.progressBar.infinite().show(i):this.progressBar.total(t).show(i),{total:n=>{this.progressBar.total(n)},worked:n=>{this.progressBar.hasTotal()?this.progressBar.worked(n):this.progressBar.infinite().show()},done:()=>{this.progressBar.stop().hide()}}}async showWhile(t,i){if(this.group.isEmpty)try{await t}catch{}return this.doShowWhile(t,i)}async doShowWhile(t,i){try{this.progressBar.infinite().show(i),await t}catch{}finally{this.progressBar.stop().hide()}}},il;(s=>{let r;(p=>(p[p.None=0]="None",p[p.Done=1]="Done",p[p.Infinite=2]="Infinite",p[p.While=3]="While",p[p.Work=4]="Work"))(r=s.Type||={}),s.None={type:0},s.Done={type:1},s.Infinite={type:2};class n{constructor(l,d,c){this.whilePromise=l;this.whileStart=d;this.whileDelay=c}type=3}s.While=n;class o{constructor(l,d){this.total=l;this.worked=d}type=4}s.Work=o})(il||={});var gR=class extends P{constructor(t,i){super();this.progressBar=t;this.scope=i;this.registerListeners()}progressState=il.None;registerListeners(){this._register(this.scope.onDidChangeActive(()=>{this.scope.isActive?this.onDidScopeActivate():this.onDidScopeDeactivate()}))}onDidScopeActivate(){if(this.progressState.type!==il.Done.type)if(this.progressState.type===3){let t;if(this.progressState.whileDelay>0){let i=this.progressState.whileDelay-(Date.now()-this.progressState.whileStart);i>0&&(t=i)}this.doShowWhile(t)}else this.progressState.type===2?this.progressBar.infinite().show():this.progressState.type===4&&(this.progressState.total&&this.progressBar.total(this.progressState.total).show(),this.progressState.worked&&this.progressBar.worked(this.progressState.worked).show())}onDidScopeDeactivate(){this.progressBar.stop().hide()}show(t,i){return typeof t=="boolean"?this.progressState=il.Infinite:this.progressState=new il.Work(t,void 0),this.scope.isActive&&(this.progressState.type===2?this.progressBar.infinite().show(i):this.progressState.type===4&&typeof this.progressState.total=="number"&&this.progressBar.total(this.progressState.total).show(i)),{total:n=>{this.progressState=new il.Work(n,this.progressState.type===4?this.progressState.worked:void 0),this.scope.isActive&&this.progressBar.total(n)},worked:n=>{!this.scope.isActive||this.progressBar.hasTotal()?(this.progressState=new il.Work(this.progressState.type===4?this.progressState.total:void 0,this.progressState.type===4&&typeof this.progressState.worked=="number"?this.progressState.worked+n:n),this.scope.isActive&&this.progressBar.worked(n)):(this.progressState=il.Infinite,this.progressBar.infinite().show())},done:()=>{this.progressState=il.Done,this.scope.isActive&&this.progressBar.stop().hide()}}}async showWhile(t,i){this.progressState.type===3&&(t=Promise.all([t,this.progressState.whilePromise])),this.progressState=new il.While(t,i||0,Date.now());try{this.doShowWhile(i),await t}catch{}finally{(this.progressState.type!==3||this.progressState.whilePromise===t)&&(this.progressState=il.None,this.scope.isActive&&this.progressBar.stop().hide())}}doShowWhile(t){this.scope.isActive&&this.progressBar.infinite().show(t)}},fR=class extends P{constructor(t,i){super();this.scopeId=t;this._isActive=i}_onDidChangeActive=this._register(new _);onDidChangeActive=this._onDidChangeActive.event;get isActive(){return this._isActive}onScopeOpened(t){t===this.scopeId&&(this._isActive||(this._isActive=!0,this._onDidChangeActive.fire()))}onScopeClosed(t){t===this.scopeId&&this._isActive&&(this._isActive=!1,this._onDidChangeActive.fire())}};var NJ=h("defaultLabel","input"),FJ=h("label.preserveCaseToggle","Preserve Case"),aV=class extends Da{constructor(e){super({icon:ie.preserveCase,title:FJ+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Dt("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},bR=class extends On{constructor(t,i,n,o){super();this._showOptionButtons=n;this.contextViewProvider=i,this.placeholder=o.placeholder||"",this.validation=o.validation,this.label=o.label||NJ;let s=o.appendPreserveCaseLabel||"",a=o.history||[],l=!!o.flexibleHeight,d=!!o.flexibleWidth,c=o.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new xu(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:o.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:o.inputBoxStyles})),this.preserveCase=this._register(new aV({appendTitle:s,isChecked:!1,...o.toggleStyles})),this._register(this.preserveCase.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(m=>{this._onPreserveCaseKeyDown.fire(m)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let u=[this.preserveCase.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let f=u.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;m.equals(17)?g=(f+1)%u.length:m.equals(15)&&(f===0?g=u.length-1:g=f-1),m.equals(9)?(u[f].blur(),this.inputBox.focus()):g>=0&&u[g].focus(),Oe.stop(m,!0)}}});let p=document.createElement("div");p.className="controls",p.style.display=this._showOptionButtons?"block":"none",p.appendChild(this.preserveCase.domNode),this.domNode.appendChild(p),t?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,m=>this._onKeyDown.fire(m)),this.onkeyup(this.inputBox.inputElement,m=>this._onKeyUp.fire(m)),this.oninput(this.inputBox.inputElement,m=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,m=>this._onMouseDown.fire(m))}static OPTION_CHANGE="optionChange";contextViewProvider;placeholder;validation;label;fixFocusOnOptionClickEnabled=!0;preserveCase;cachedOptionsWidth=0;domNode;inputBox;_onDidOptionChange=this._register(new _);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new _);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new _);onMouseDown=this._onMouseDown.event;_onInput=this._register(new _);onInput=this._onInput.event;_onKeyUp=this._register(new _);onKeyUp=this._onKeyUp.event;_onPreserveCaseKeyDown=this._register(new _);onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event;enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setFocusInputOnOptionClick(t){this.fixFocusOnOptionClickEnabled=t}setEnabled(t){t?this.enable():this.disable()}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(t){this.inputBox.value!==t&&(this.inputBox.value=t)}onSearchSubmit(){this.inputBox.addToHistory()}applyStyles(){}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(t){this.preserveCase.checked=t}focusOnPreserve(){this.preserveCase.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox?.validate()}showMessage(t){this.inputBox?.showMessage(t)}clearMessage(){this.inputBox?.hideMessage()}clearValidation(){this.inputBox?.hideMessage()}set width(t){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=t+"px"}dispose(){super.dispose()}};var iK=new q("suggestWidgetVisible",!1,h("suggestWidgetVisible","Whether suggestion are visible")),lV="historyNavigationWidgetFocus",nK="historyNavigationForwardsEnabled",oK="historyNavigationBackwardsEnabled",UC,vR=[];function dV(r,e){if(vR.includes(e))throw new Error("Cannot register the same widget multiple times");vR.push(e);let t=new Y,i=new q(lV,!1).bindTo(r),n=new q(nK,!0).bindTo(r),o=new q(oK,!0).bindTo(r),s=()=>{i.set(!0),UC=e},a=()=>{i.set(!1),UC===e&&(UC=void 0)};return ho(e.element)&&s(),t.add(e.onDidFocus(()=>s())),t.add(e.onDidBlur(()=>a())),t.add(te(()=>{vR.splice(vR.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:o,dispose(){t.dispose()}}}var Db=class extends xu{constructor(e,t,i,n){super(e,t,i);let o=this._register(n.createScoped(this.element));this._register(dV(o,this))}};Db=R([y(3,je)],Db);var yR=class extends af{constructor(e,t,i,n){super(e,t,i);let o=this._register(n.createScoped(this.inputBox.element));this._register(dV(o,this.inputBox))}};yR=R([y(3,je)],yR);var IR=class extends bR{constructor(e,t,i,n,o=!1){super(e,t,o,i);let s=this._register(n.createScoped(this.inputBox.element));this._register(dV(s,this.inputBox))}};IR=R([y(3,je)],IR);fn.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:Ue.and(Ue.has(lV),Ue.equals(oK,!0),Ue.not("isComposing"),iK.isEqualTo(!1)),primary:16,secondary:[528],handler:r=>{UC?.showPreviousValue()}});fn.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:Ue.and(Ue.has(lV),Ue.equals(nK,!0),Ue.not("isComposing"),iK.isEqualTo(!1)),primary:18,secondary:[530],handler:r=>{UC?.showNextValue()}});function rK(r){return r.lookupKeybinding("history.showPrevious")?.getElectronAccelerator()==="Up"&&r.lookupKeybinding("history.showNext")?.getElectronAccelerator()==="Down"}var sK=new nt("menu.view.filter"),aK=new nt("submenu.view.filter");Go.appendMenuItem(sK,{submenu:aK,title:h("more filters","More Filters..."),group:"navigation",icon:ie.filter});var cV=class extends Yh{_checked=!1;set checked(e){this._checked!==e&&(this._checked=e,this.updateChecked())}updateChecked(){this.element&&this.element.classList.toggle("checked",this._checked)}render(e){super.render(e),this.updateChecked()}},Lb=class extends On{constructor(t,i,n,o,s){super();this.options=t;this.instantiationService=i;this.contextViewService=n;this.keybindingService=s;this.delayedFilterUpdate=new vs(400),this._register(te(()=>this.delayedFilterUpdate.cancel())),t.focusContextKey&&(this.focusContextKey=new q(t.focusContextKey,!1).bindTo(o)),this.element=he(".viewpane-filter"),[this.filterInputBox,this.focusTracker]=this.createInput(this.element),this._register(this.filterInputBox),this._register(this.focusTracker);let a=ye(this.element,he(".viewpane-filter-controls"));this.filterBadge=this.createBadge(a),this.toolbar=this._register(this.createToolBar(a)),this.adjustInputBox()}element;delayedFilterUpdate;filterInputBox;filterBadge;toolbar;focusContextKey;_onDidChangeFilterText=this._register(new _);onDidChangeFilterText=this._onDidChangeFilterText.event;moreFiltersActionViewItem;isMoreFiltersChecked=!1;lastWidth;focusTracker;get onDidFocus(){return this.focusTracker.onDidFocus}get onDidBlur(){return this.focusTracker.onDidBlur}hasFocus(){return this.filterInputBox.hasFocus()}focus(){this.filterInputBox.focus()}blur(){this.filterInputBox.blur()}updateBadge(t){this.filterBadge.classList.toggle("hidden",!t),this.filterBadge.textContent=t||"",this.adjustInputBox()}setFilterText(t){this.filterInputBox.value=t}getFilterText(){return this.filterInputBox.value}getHistory(){return this.filterInputBox.getHistory()}layout(t){this.element.parentElement?.classList.toggle("grow",t>700),this.element.classList.toggle("small",t<400),this.adjustInputBox(),this.lastWidth=t}relayout(){this.lastWidth&&this.layout(this.lastWidth)}checkMoreFilters(t){this.isMoreFiltersChecked=t,this.moreFiltersActionViewItem&&(this.moreFiltersActionViewItem.checked=t)}createInput(t){let i=this._register(this.instantiationService.createInstance(Db,t,this.contextViewService,{placeholder:this.options.placeholder,ariaLabel:this.options.ariaLabel,history:this.options.history||[],showHistoryHint:()=>rK(this.keybindingService),inputBoxStyles:bN}));this.options.text&&(i.value=this.options.text),this._register(i.onDidChange(o=>this.delayedFilterUpdate.trigger(()=>this.onDidInputChange(i)))),this._register(si(i.inputElement,Q.KEY_DOWN,o=>this.onInputKeyDown(o,i))),this._register(si(t,Q.KEY_DOWN,this.handleKeyboardEvent)),this._register(si(t,Q.KEY_UP,this.handleKeyboardEvent)),this._register(si(i.inputElement,Q.CLICK,o=>{o.stopPropagation(),o.preventDefault()}));let n=this._register(Mn(i.inputElement));return this.focusContextKey&&(this._register(n.onDidFocus(()=>this.focusContextKey.set(!0))),this._register(n.onDidBlur(()=>this.focusContextKey.set(!1))),this._register(te(()=>this.focusContextKey.reset()))),[i,n]}createBadge(t){let i=ye(t,he(".viewpane-filter-badge.hidden"));return i.style.backgroundColor=ae(Fl),i.style.color=ae(vg),i.style.border=`1px solid ${ae(Ie)}`,i}createToolBar(t){return this.instantiationService.createInstance(Ku,t,sK,{hiddenItemStrategy:-1,actionViewItemProvider:(i,n)=>{if(i instanceof Po&&i.item.submenu.id===aK.id)return this.moreFiltersActionViewItem=this.instantiationService.createInstance(cV,i,n),this.moreFiltersActionViewItem.checked=this.isMoreFiltersChecked,this.moreFiltersActionViewItem}})}onDidInputChange(t){t.addToHistory(),this._onDidChangeFilterText.fire(t.value)}adjustInputBox(){this.filterInputBox.inputElement.style.paddingRight=this.element.classList.contains("small")||this.filterBadge.classList.contains("hidden")?"25px":"150px"}handleKeyboardEvent(t){(t.equals(10)||t.equals(15)||t.equals(17)||t.equals(14)||t.equals(13))&&t.stopPropagation()}onInputKeyDown(t,i){let n=!1;t.equals(2)&&!this.toolbar.isEmpty()&&(this.toolbar.focus(),n=!0),n&&(t.stopPropagation(),t.preventDefault())}};Lb=R([y(1,ve),y(2,iu),y(3,je),y(4,qt)],Lb);var XOi=Z("accessibleViewInformationService"),CR=class extends P{constructor(t){super();this._storageService=t}hasShownAccessibleView(t){return this._storageService.getBoolean(`${dU}${t}`,-1,!1)===!0}};CR=R([y(0,Ii)],CR);var ER=new Si("viewpane.action.filter"),BJ=$o("view-pane-container-expanded",ie.chevronDown,h("viewPaneContainerExpandedIcon","Icon for an expanded view pane container.")),VJ=$o("view-pane-container-collapsed",ie.chevronRight,h("viewPaneContainerCollapsedIcon","Icon for a collapsed view pane container.")),lK=ze.as(VC.ViewsRegistry),zC=class{constructor(e,t,i,n,o,s,a){this.container=e;this.delegate=t;this.instantiationService=i;this.openerService=n;this.telemetryService=o;this.contextKeyService=s;this.disposables.add(z.runAndSubscribe(this.delegate.onDidChangeViewWelcomeState,()=>this.onDidChangeViewWelcomeState())),this.disposables.add(a.onWillShutdown(()=>this.dispose()))}defaultItem;items=[];get enabled(){return this._enabled}_enabled=!1;element;scrollableElement;disposables=new Y;enabledDisposables=this.disposables.add(new Y);renderDisposables=this.disposables.add(new Y);layout(e,t){this._enabled&&(this.element.style.height=`${e}px`,this.element.style.width=`${t}px`,this.element.classList.toggle("wide",t>640),this.scrollableElement.scanDomNode())}focus(){this._enabled&&this.element.focus()}onDidChangeViewWelcomeState(){let e=this.delegate.shouldShowWelcome();if(this._enabled===e)return;if(this._enabled=e,!e){this.enabledDisposables.clear();return}this.container.classList.add("welcome");let t=ye(this.container,he(".welcome-view"));this.element=he(".welcome-view-content",{tabIndex:0}),this.scrollableElement=new Ys(this.element,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3}),ye(t,this.scrollableElement.getDomNode()),this.enabledDisposables.add(te(()=>{this.container.classList.remove("welcome"),this.scrollableElement.dispose(),t.remove(),this.scrollableElement=void 0,this.element=void 0})),this.contextKeyService.onDidChangeContext(this.onDidChangeContext,this,this.enabledDisposables),z.chain(lK.onDidChangeViewWelcomeContent,i=>i.filter(n=>n===this.delegate.id))(this.onDidChangeViewWelcomeContent,this,this.enabledDisposables),this.onDidChangeViewWelcomeContent()}onDidChangeViewWelcomeContent(){let e=lK.getViewWelcomeContent(this.delegate.id);this.items=[];for(let t of e)if(t.when==="default")this.defaultItem={descriptor:t,visible:!0};else{let i=t.when?this.contextKeyService.contextMatchesRules(t.when):!0;this.items.push({descriptor:t,visible:i})}this.render()}onDidChangeContext(){let e=!1;for(let t of this.items){if(!t.descriptor.when||t.descriptor.when==="default")continue;let i=this.contextKeyService.contextMatchesRules(t.descriptor.when);t.visible!==i&&(t.visible=i,e=!0)}e&&this.render()}render(){this.renderDisposables.clear(),this.element.innerText="";let e=this.getContentDescriptors();if(e.length===0){this.container.classList.remove("welcome"),this.scrollableElement.scanDomNode();return}for(let{content:t,precondition:i}of e){let n=t.split(`
`);for(let o of n){if(o=o.trim(),!o)continue;let s=tK(o);if(s.nodes.length===1&&typeof s.nodes[0]!="string"){let a=s.nodes[0],l=ye(this.element,he(".button-container")),d=new nc(l,{title:a.title,supportIcons:!0,...b_});if(d.label=a.label,d.onDidClick(c=>{this.telemetryService.publicLog2("views.welcomeAction",{viewId:this.delegate.id,uri:a.href}),this.openerService.open(a.href,{allowCommands:!0})},null,this.renderDisposables),this.renderDisposables.add(d),i){let c=()=>d.enabled=this.contextKeyService.contextMatchesRules(i);c();let u=new Set(i.keys());z.filter(this.contextKeyService.onDidChangeContext,m=>m.affectsSome(u))(c,null,this.renderDisposables)}}else{let a=ye(this.element,he("p"));for(let l of s.nodes)if(typeof l=="string")ye(a,document.createTextNode(l));else{let d=this.renderDisposables.add(this.instantiationService.createInstance(_b,a,l,{}));if(i&&l.href.startsWith("command:")){let c=()=>d.enabled=this.contextKeyService.contextMatchesRules(i);c();let u=new Set(i.keys());z.filter(this.contextKeyService.onDidChangeContext,m=>m.affectsSome(u))(c,null,this.renderDisposables)}}}}}this.container.classList.add("welcome"),this.scrollableElement.scanDomNode()}getContentDescriptors(){let e=this.items.filter(t=>t.visible);return e.length===0&&this.defaultItem?[this.defaultItem.descriptor]:e.map(t=>t.descriptor)}dispose(){this.disposables.dispose()}};zC=R([y(2,ve),y(3,qa),y(4,jt),y(5,je),y(6,id)],zC);var fc=class extends lR{constructor(t,i,n,o,s,a,l,d,c,u,p,m){super({...t,orientation:a.getViewLocationById(t.id)===1?1:0});this.keybindingService=i;this.contextMenuService=n;this.configurationService=o;this.contextKeyService=s;this.viewDescriptorService=a;this.instantiationService=l;this.openerService=d;this.themeService=c;this.telemetryService=u;this.hoverService=p;this.accessibleViewInformationService=m;this.id=t.id,this._title=t.title,this._titleDescription=t.titleDescription,this._singleViewPaneContainerTitle=t.singleViewPaneContainerTitle,this.showActions=t.showActions??0,this.scopedContextKeyService=this._register(s.createScoped(this.element)),this.scopedContextKeyService.createKey("view",this.id);let f=this.scopedContextKeyService.createKey("viewLocation",wb(a.getViewLocationById(this.id)));this._register(z.filter(a.onDidChangeLocation,b=>b.views.some(v=>v.id===this.id))(()=>f.set(wb(a.getViewLocationById(this.id)))));let g=this._register(this.instantiationService.createChild(new ws([je,this.scopedContextKeyService])));this.menuActions=this._register(g.createInstance(Qu,t.titleMenuId??nt.ViewTitle,nt.ViewTitleContext,{shouldForwardArgs:!t.donotForwardArgs,renderShortTitle:!0})),this._register(this.menuActions.onDidChange(()=>this.updateActions()))}static AlwaysShowActionsConfig="workbench.view.alwaysShowHeaderActions";_onDidFocus=this._register(new _);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new _);onDidBlur=this._onDidBlur.event;_onDidChangeBodyVisibility=this._register(new _);onDidChangeBodyVisibility=this._onDidChangeBodyVisibility.event;_onDidChangeTitleArea=this._register(new _);onDidChangeTitleArea=this._onDidChangeTitleArea.event;_onDidChangeViewWelcomeState=this._register(new _);onDidChangeViewWelcomeState=this._onDidChangeViewWelcomeState.event;_isVisible=!1;id;_title;get title(){return this._title}_titleDescription;get titleDescription(){return this._titleDescription}_singleViewPaneContainerTitle;get singleViewPaneContainerTitle(){return this._singleViewPaneContainerTitle}menuActions;progressBar;progressIndicator;toolbar;showActions;headerContainer;titleContainer;titleContainerHover;titleDescriptionContainer;titleDescriptionContainerHover;iconContainer;iconContainerHover;twistiesContainer;viewWelcomeController;scopedContextKeyService;get headerVisible(){return super.headerVisible}set headerVisible(t){super.headerVisible=t,this.element.classList.toggle("merged-header",!t)}setVisible(t){this._isVisible!==t&&(this._isVisible=t,this.isExpanded()&&this._onDidChangeBodyVisibility.fire(t))}isVisible(){return this._isVisible}isBodyVisible(){return this._isVisible&&this.isExpanded()}setExpanded(t){let i=super.setExpanded(t);return i&&this._onDidChangeBodyVisibility.fire(t),this.updateTwistyIcon(),i}render(){super.render();let t=Mn(this.element);this._register(t),this._register(t.onDidFocus(()=>this._onDidFocus.fire())),this._register(t.onDidBlur(()=>this._onDidBlur.fire()))}renderHeader(t){this.headerContainer=t,this.twistiesContainer=ye(t,he(`.twisty-container${Ae.asCSSSelector(this.getTwistyIcon(this.isExpanded()))}`)),this.renderHeaderTitle(t,this.title);let i=ye(t,he(".actions"));i.classList.toggle("show-always",this.showActions===2),i.classList.toggle("show-expanded",this.showActions===1),this.toolbar=this.instantiationService.createInstance(pc,i,{orientation:0,actionViewItemProvider:(s,a)=>this.getActionViewItem(s,a),ariaLabel:h("viewToolbarAriaLabel","{0} actions",this.title),getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id),renderDropdownAsChildElement:!0,actionRunner:this.getActionRunner(),resetMenu:this.menuActions.menuId}),this._register(this.toolbar),this.setActions(),this._register(B(i,Q.CLICK,s=>s.preventDefault()));let n=this.viewDescriptorService.getViewContainerByViewId(this.id);n?this._register(this.viewDescriptorService.getViewContainerModel(n).onDidChangeContainerInfo(({title:s})=>this.updateTitle(this.title))):console.error(`View container model not found for view ${this.id}`);let o=z.filter(this.configurationService.onDidChangeConfiguration,s=>s.affectsConfiguration(fc.AlwaysShowActionsConfig));this._register(o(this.updateActionsVisibility,this)),this.updateActionsVisibility()}updateHeader(){super.updateHeader(),this.updateTwistyIcon()}updateTwistyIcon(){this.twistiesContainer&&(this.twistiesContainer.classList.remove(...Ae.asClassNameArray(this.getTwistyIcon(!this._expanded))),this.twistiesContainer.classList.add(...Ae.asClassNameArray(this.getTwistyIcon(this._expanded))))}getTwistyIcon(t){return t?BJ:VJ}style(t){super.style(t);let i=this.getIcon();if(this.iconContainer){let n=Ir(t.headerForeground,ae(Rt));X.isUri(i)?(this.iconContainer.style.backgroundColor=n,this.iconContainer.style.color=""):(this.iconContainer.style.color=n,this.iconContainer.style.backgroundColor="")}}getIcon(){return this.viewDescriptorService.getViewDescriptorById(this.id)?.containerIcon||Q3}renderHeaderTitle(t,i){this.iconContainer=ye(t,he(".icon",void 0));let n=this.getIcon(),o;if(X.isUri(n)){o=`view-${this.id.replace(/[\.\:]/g,"-")}`;let a=`.pane-header .icon.${o}`;n1(a,`
				mask: ${El(n)} no-repeat 50% 50%;
				mask-size: 24px;
				-webkit-mask: ${El(n)} no-repeat 50% 50%;
				-webkit-mask-size: 16px;
			`)}else Ae.isThemeIcon(n)&&(o=Ae.asClassName(n));o&&this.iconContainer.classList.add(...o.split(" "));let s=this.calculateTitle(i);this.titleContainer=ye(t,he("h3.title",{},s)),this.titleContainerHover=this._register(this.hoverService.setupManagedHover(Dt("mouse"),this.titleContainer,s)),this._titleDescription&&this.setTitleDescription(this._titleDescription),this.iconContainerHover=this._register(this.hoverService.setupManagedHover(Dt("mouse"),this.iconContainer,s)),this.iconContainer.setAttribute("aria-label",this._getAriaLabel(s))}_getAriaLabel(t){let i=this.viewDescriptorService.getViewDescriptorById(this.id)?.accessibilityHelpContent,n=this.accessibleViewInformationService?.hasShownAccessibleView(this.id);return!i||n?t:h("viewAccessibilityHelp","Use Alt+F1 for accessibility help {0}",t)}updateTitle(t){let i=this.calculateTitle(t);this.titleContainer&&(this.titleContainer.textContent=i,this.titleContainerHover?.update(i)),this.iconContainer&&(this.iconContainerHover?.update(i),this.iconContainer.setAttribute("aria-label",this._getAriaLabel(i))),this._title=t,this._onDidChangeTitleArea.fire()}setTitleDescription(t){this.titleDescriptionContainer?(this.titleDescriptionContainer.textContent=t??"",this.titleDescriptionContainerHover?.update(t??"")):t&&this.titleContainer&&(this.titleDescriptionContainer=fE(this.titleContainer,he("span.description",{},t)),this.titleDescriptionContainerHover=this._register(this.hoverService.setupManagedHover(Dt("mouse"),this.titleDescriptionContainer,t)))}updateTitleDescription(t){this.setTitleDescription(t),this._titleDescription=t,this._onDidChangeTitleArea.fire()}calculateTitle(t){let i=this.viewDescriptorService.getViewContainerByViewId(this.id),n=this.viewDescriptorService.getViewContainerModel(i),o=this.viewDescriptorService.getViewDescriptorById(this.id);return!(this.viewDescriptorService.getDefaultContainerById(this.id)===i)&&o?.containerTitle&&n.title!==o.containerTitle?`${o.containerTitle}: ${t}`:t}renderBody(t){this.viewWelcomeController=this._register(this.instantiationService.createInstance(zC,t,this))}layoutBody(t,i){this.viewWelcomeController.layout(t,i)}onDidScrollRoot(){}getProgressIndicator(){if(this.progressBar===void 0&&(this.progressBar=this._register(new mf(this.element,v_)),this.progressBar.hide()),this.progressIndicator===void 0){let t=this;this.progressIndicator=this._register(new gR(at(this.progressBar),new class extends fR{constructor(){super(t.id,t.isBodyVisible()),this._register(t.onDidChangeBodyVisibility(i=>i?this.onScopeOpened(t.id):this.onScopeClosed(t.id)))}}))}return this.progressIndicator}getProgressLocation(){return this.viewDescriptorService.getViewContainerByViewId(this.id).id}getLocationBasedColors(){return WJ(this.viewDescriptorService.getViewLocationById(this.id))}focus(){this.viewWelcomeController.enabled?this.viewWelcomeController.focus():this.element&&(this.element.focus(),this._onDidFocus.fire())}setActions(){if(this.toolbar){let t=[...this.menuActions.getPrimaryActions()];this.shouldShowFilterInHeader()&&t.unshift(ER),this.toolbar.setActions(Bm(t),Bm(this.menuActions.getSecondaryActions())),this.toolbar.context=this.getActionsContext()}}updateActionsVisibility(){if(!this.headerContainer)return;let t=this.configurationService.getValue("workbench.view.alwaysShowHeaderActions");this.headerContainer.classList.toggle("actions-always-visible",t)}updateActions(){this.setActions(),this._onDidChangeTitleArea.fire()}getActionViewItem(t,i){if(t.id===ER.id){let n=this;return new class extends mo{constructor(){super(null,t)}setFocusable(){}get trapsArrowNavigation(){return!0}render(o){o.classList.add("viewpane-filter-container");let s=n.getFilterWidget();ye(o,s.element),s.relayout()}}}return mb(this.instantiationService,t,{...i,menuAsChild:t instanceof Po})}getActionsContext(){}getActionRunner(){}getOptimalWidth(){return 0}saveState(){}shouldShowWelcome(){return!1}getFilterWidget(){}shouldShowFilterInHeader(){return!1}};fc=R([y(1,qt),y(2,Zi),y(3,He),y(4,je),y(5,ua),y(6,ve),y(7,qa),y(8,kt),y(9,jt),y(10,Gu)],fc);var SR=class extends fc{filterWidget;dimension;filterContainer;constructor(e,t,i,n,o,s,a,l,d,c,u,p){super(e,t,i,n,o,s,a,l,d,c,u,p);let m=this._register(a.createChild(new ws([je,this.scopedContextKeyService])));this.filterWidget=this._register(m.createInstance(Lb,e.filterOptions))}getFilterWidget(){return this.filterWidget}renderBody(e){super.renderBody(e),this.filterContainer=ye(e,he(".viewpane-filter-container"))}layoutBody(e,t){super.layoutBody(e,t),this.dimension=new At(t,e);let i=!this.filterContainer?.hasChildNodes(),n=this.shouldShowFilterInHeader();i!==n&&(n&&gn(this.filterContainer),this.updateActions(),n||ye(this.filterContainer,this.filterWidget.element)),n||(e=e-44),this.filterWidget.layout(t),this.layoutBodyContent(e,t)}shouldShowFilterInHeader(){return!(this.dimension&&this.dimension.width<600&&this.dimension.height>100)}};SR=R([y(1,qt),y(2,Zi),y(3,He),y(4,je),y(5,ua),y(6,ve),y(7,qa),y(8,kt),y(9,jt),y(10,Gu)],SR);function WJ(r){let e,t,i,n;switch(r){case 1:e=ON,t=c9,i=u9,n=p9;break;case 0:case 2:default:e=rD,t=v9,i=y9,n=I9}return{background:e,listOverrideStyles:{listBackground:e,treeStickyScrollBackground:t,treeStickyScrollBorder:i,treeStickyScrollShadow:n}}}var wR="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",RNi=new RegExp(wR);var ANi=Z("extensionGalleryService");var MNi=Z("extensionManagementService");var ONi=Z("IGlobalExtensionEnablementService"),PNi=Z("IExtensionTipsService"),NNi=pt("extensions","Extensions"),FNi=pt("preferences","Preferences");var KC=class{constructor(e){this.value=e}isTrustedTelemetryValue=!0},uV=class{telemetryLevel=0;sessionId="someValue.sessionId";machineId="someValue.machineId";sqmId="someValue.sqmId";devDeviceId="someValue.devDeviceId";firstSessionDate="someValue.firstSessionDate";sendErrorTelemetry=!1;publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},bFi=new uV;var FFi=new Ds("pprice.better-merge");var pV=class{_generators=new Map;_cache=new WeakMap;register(e,t){this._generators.set(e,t)}readActivationEvents(e){return this._cache.has(e)||this._cache.set(e,this._readActivationEvents(e)),this._cache.get(e)}createActivationEventsMap(e){let t=Object.create(null);for(let i of e){let n=this.readActivationEvents(i);n.length>0&&(t[Ds.toKey(i.identifier)]=n)}return t}_readActivationEvents(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];let t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let i=0;i<t.length;i++)t[i]==="onUri"&&(t[i]=`onUri:${Ds.toKey(e.identifier)}`);if(!e.contributes)return t;for(let i in e.contributes){let n=this._generators.get(i);if(!n)continue;let o=e.contributes[i],s=Array.isArray(o)?o:[o];try{n(s,t)}catch(a){Ge(a)}}return t}},hV=new pV;var zJ={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts"},aiTextSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProviderNew.d.ts"},attributableCoverage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.attributableCoverage.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:2},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},chatVariableResolver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatVariableResolver.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribChatParticipantDetection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribChatParticipantDetection.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribIssueReporter:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribIssueReporter.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},createFileSystemWatcher:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.createFileSystemWatcher.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},documentPaste:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileComments:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileComments.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProviderNew.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts"},findFiles2New:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2New.d.ts"},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFilesNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFilesNew.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},lmTools:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.lmTools.d.ts",version:6},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},showLocal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.showLocal.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textSearchCompleteNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchCompleteNew.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProviderNew.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},GC=Object.freeze(zJ);var jFi=Z("IV8InspectProfilingService"),KJ;(t=>{function r(i){return!!(i.samples&&i.timeDeltas)}t.isValidProfile=r;function e(i,n="noAbsolutePaths"){for(let o of i.nodes)o.callFrame&&o.callFrame.url&&(cp(o.callFrame.url)||/^\w[\w\d+.-]*:\/\/\/?/.test(o.callFrame.url))&&(o.callFrame.url=fr(n,ba(o.callFrame.url)));return i}t.rewriteAbsolutePaths=e})(KJ||={});var vV=ze.as(Wd.JSONContribution);var mV=class r{constructor(e,t){this.added=e;this.removed=t}static _toSet(e){let t=new Cy;for(let i=0,n=e.length;i<n;i++)t.add(e[i].description.identifier);return t}static compute(e,t){if(!e||!e.length)return new r(t,[]);if(!t||!t.length)return new r([],e);let i=this._toSet(e),n=this._toSet(t),o=t.filter(a=>!i.has(a.description.identifier)),s=e.filter(a=>!n.has(a.description.identifier));return new r(o,s)}},gV=class{name;defaultExtensionKind;_handler;_users;_delta;constructor(e,t){this.name=e,this.defaultExtensionKind=t,this._handler=null,this._users=null,this._delta=null}setHandler(e){if(this._handler!==null)throw new Error("Handler already set!");return this._handler=e,this._handle(),{dispose:()=>{this._handler=null}}}acceptUsers(e){this._delta=mV.compute(this._users,e),this._users=e,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(e){Ge(e)}}},GJ={type:"string",enum:["ui","workspace"],enumDescriptions:[h("ui","UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),h("workspace","Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]},uK="vscode://schemas/vscode-extensions",fV={properties:{engines:{type:"object",description:h("vscode.extension.engines","Engine compatibility."),properties:{vscode:{type:"string",description:h("vscode.extension.engines.vscode","For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:h("vscode.extension.publisher","The publisher of the VS Code extension."),type:"string"},displayName:{description:h("vscode.extension.displayName","The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:h("vscode.extension.categories","The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:PU},{type:"string",const:"Languages",deprecationMessage:h("vscode.extension.category.languages.deprecated","Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:h("vscode.extension.galleryBanner","Banner used in the VS Code marketplace."),properties:{color:{description:h("vscode.extension.galleryBanner.color","The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:h("vscode.extension.galleryBanner.theme","The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:h("vscode.extension.contributes","All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h("vscode.extension.preview","Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:h("vscode.extension.enableProposedApi.deprecated","Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:h("vscode.extension.enabledApiProposals","Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(GC).map(r=>r),markdownEnumDescriptions:Object.values(GC).map(r=>r.proposal)}},api:{markdownDescription:h("vscode.extension.api","Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[h("vscode.extension.api.none","Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:h("vscode.extension.activationEvents","Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h("vscode.extension.activationEvents.onWebviewPanel","An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h("vscode.extension.activationEvents.onLanguage","An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h("vscode.extension.activationEvents.onCommand","An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h("vscode.extension.activationEvents.onDebug","An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h("vscode.extension.activationEvents.onDebugInitialConfigurations",'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h("vscode.extension.activationEvents.onDebugDynamicConfigurations",'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h("vscode.extension.activationEvents.onDebugResolve","An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h("vscode.extension.activationEvents.onDebugAdapterProtocolTracker","An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h("vscode.extension.activationEvents.workspaceContains","An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h("vscode.extension.activationEvents.onStartupFinished","An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:h("vscode.extension.activationEvents.onTaskType","An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h("vscode.extension.activationEvents.onFileSystem","An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h("vscode.extension.activationEvents.onEditSession","An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h("vscode.extension.activationEvents.onSearch","An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h("vscode.extension.activationEvents.onView","An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:h("vscode.extension.activationEvents.onUri","An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h("vscode.extension.activationEvents.onOpenExternalUri","An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h("vscode.extension.activationEvents.onCustomEditor","An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:h("vscode.extension.activationEvents.onNotebook","An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h("vscode.extension.activationEvents.onAuthenticationRequest","An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:h("vscode.extension.activationEvents.onRenderer","An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h("vscode.extension.activationEvents.onTerminalProfile","An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h("vscode.extension.activationEvents.onTerminalQuickFixRequest","An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h("vscode.extension.activationEvents.onWalkthrough","An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h("vscode.extension.activationEvents.onIssueReporterOpened","An activation event emitted when the issue reporter is opened.")},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:h("vscode.extension.activationEvents.onChatParticipant","An activation event emitted when the specified chat participant is invoked.")},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:h("vscode.extension.activationEvents.onLanguageModelTool","An activation event emitted when the specified language model tool is invoked.")},{label:"*",description:h("vscode.extension.activationEvents.star","An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:h("vscode.extension.badges","Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h("vscode.extension.badges.url","Badge image URL.")},href:{type:"string",description:h("vscode.extension.badges.href","Badge link.")},description:{type:"string",description:h("vscode.extension.badges.description","Badge description.")}}}},markdown:{type:"string",description:h("vscode.extension.markdown","Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h("vscode.extension.qna","Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:h("vscode.extension.extensionDependencies","Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:wR}},extensionPack:{description:h("vscode.extension.contributes.extensionPack","A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:wR}},extensionKind:{description:h("extensionKind","Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:GJ,default:["workspace"],defaultSnippets:[{body:["ui"],description:h("extensionKind.ui","Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:h("extensionKind.workspace","Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:h("extensionKind.ui-workspace","Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:h("extensionKind.workspace-ui","Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:h("extensionKind.empty","Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:h("vscode.extension.capabilities","Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:h("vscode.extension.capabilities.virtualWorkspaces","Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:h("vscode.extension.capabilities.virtualWorkspaces.supported","Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h("vscode.extension.capabilities.virtualWorkspaces.supported.limited","The extension will be enabled in virtual workspaces with some functionality disabled."),h("vscode.extension.capabilities.virtualWorkspaces.supported.true","The extension will be enabled in virtual workspaces with all functionality enabled."),h("vscode.extension.capabilities.virtualWorkspaces.supported.false","The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:h("vscode.extension.capabilities.virtualWorkspaces.description","A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:h("vscode.extension.capabilities.untrustedWorkspaces","Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h("vscode.extension.capabilities.untrustedWorkspaces.supported","Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h("vscode.extension.capabilities.untrustedWorkspaces.supported.limited","The extension will be enabled in untrusted workspaces with some functionality disabled."),h("vscode.extension.capabilities.untrustedWorkspaces.supported.true","The extension will be enabled in untrusted workspaces with all functionality enabled."),h("vscode.extension.capabilities.untrustedWorkspaces.supported.false","The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:h("vscode.extension.capabilities.untrustedWorkspaces.restrictedConfigurations","A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h("vscode.extension.capabilities.untrustedWorkspaces.description","A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:h("vscode.extension.contributes.sponsor","Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:h("vscode.extension.contributes.sponsor.url","URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h("vscode.extension.scripts.prepublish","Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:h("vscode.extension.scripts.uninstall","Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:h("vscode.extension.icon","The path to a 128x128 pixel icon.")},l10n:{type:"string",description:h({key:"vscode.extension.l10n",comment:['{Locked="bundle.l10n._locale_.json"}','{Locked="vscode.l10n API"}']},"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:h("vscode.extension.pricing","The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}},bV=class{_extensionPoints=new Map;registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);let t=new gV(e.extensionPoint,e.defaultExtensionKind);return this._extensionPoints.set(e.extensionPoint,t),e.activationEventsGenerator&&hV.register(e.extensionPoint,e.activationEventsGenerator),fV.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,vV.registerSchema(uK,fV),t}getExtensionPoints(){return Array.from(this._extensionPoints.values())}},pK={ExtensionsRegistry:"ExtensionsRegistry"};ze.add(pK.ExtensionsRegistry,new bV);var NBi=ze.as(pK.ExtensionsRegistry);vV.registerSchema(uK,fV);vV.registerSchema(J4,{properties:{extensionEnabledApiProposals:{description:h("product.extensionEnabledApiProposals","API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(GC),markdownEnumDescriptions:Object.values(GC).map(r=>r.proposal)}}]}}}});var mVi=Object.freeze({identifier:new Ds("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:X.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1});var kb=Z("extensionService");var xR=class extends Rb{constantViewDescriptors=new Map;allViews=new Map;filterValue;constructor(e,t,i,n,o,s,a,l,d,c,u,p){super(e,{mergeViewWithContainerWhenSingleView:!1},a,i,n,d,o,c,l,s,u,p),this._register(t(m=>{this.filterValue=m,this.onFilterChanged(m)})),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>{this.updateAllViews(this.viewContainerModel.activeViewDescriptors)}))}updateAllViews(e){e.forEach(t=>{let i=this.getFilterOn(t);i&&(this.allViews.has(i)||this.allViews.set(i,new Map),this.allViews.get(i).set(t.id,t),this.filterValue&&!this.filterValue.includes(i)&&this.panes.find(n=>n.id===t.id)&&this.viewContainerModel.setVisible(t.id,!1))})}addConstantViewDescriptors(e){e.forEach(t=>this.constantViewDescriptors.set(t.id,t))}onFilterChanged(e){this.allViews.size===0&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),this.getViewsNotForTarget(e).forEach(t=>this.viewContainerModel.setVisible(t.id,!1)),this.getViewsForTarget(e).forEach(t=>this.viewContainerModel.setVisible(t.id,!0))}getViewsForTarget(e){let t=[];for(let i=0;i<e.length;i++)this.allViews.has(e[i])&&t.push(...Array.from(this.allViews.get(e[i]).values()));return t}getViewsNotForTarget(e){let t=this.allViews.keys(),i=t.next(),n=[];for(;!i.done;){let o=!1;e.forEach(s=>{i.value===s&&(o=!0)}),o||(n=n.concat(this.getViewsForTarget([i.value]))),i=t.next()}return n}onDidAddViewDescriptors(e){let t=super.onDidAddViewDescriptors(e);for(let i=0;i<e.length;i++)this.constantViewDescriptors.has(e[i].viewDescriptor.id)&&t[i].setExpanded(!1);return this.allViews.size===0&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),t}openView(e,t){let i=super.openView(e,t);if(i){let n=Array.from(this.allViews.entries()).find(o=>o[1].has(e));n&&!this.filterValue?.includes(n[0])&&this.setFilter(n[1].get(e))}return i}};xR=R([y(2,He),y(3,$a),y(4,jt),y(5,Ii),y(6,ve),y(7,kt),y(8,Zi),y(9,kb),y(10,bi),y(11,ua)],xR);var yV=new nt("Views");Go.appendMenuItem(nt.ViewContainerTitle,{submenu:yV,title:h("views","Views"),order:1});var Ab=class r extends ta{constructor(t,i,n,o,s){super(s);this.paneElement=t;this.orientation=i;this.bounds=n;this.location=o;this.cleanupOverlayScheduler=this._register(new Kt(()=>this.dispose(),300)),this.create()}static OVERLAY_ID="monaco-pane-drop-overlay";container;overlay;_currentDropOperation;_disposed;cleanupOverlayScheduler;get currentDropOperation(){return this._currentDropOperation}get disposed(){return!!this._disposed}create(){this.container=document.createElement("div"),this.container.id=r.OVERLAY_ID,this.container.style.top="0px",this.paneElement.appendChild(this.container),this.paneElement.classList.add("dragged-over"),this._register(te(()=>{this.container.remove(),this.paneElement.classList.remove("dragged-over")})),this.overlay=document.createElement("div"),this.overlay.classList.add("pane-overlay-indicator"),this.container.appendChild(this.overlay),this.registerListeners(),this.updateStyles()}updateStyles(){this.overlay.style.backgroundColor=this.getColor(this.location===1?PN:NN)||"";let t=this.getColor(Ft);this.overlay.style.outlineColor=t||"",this.overlay.style.outlineOffset=t?"-2px":"",this.overlay.style.outlineStyle=t?"dashed":"",this.overlay.style.outlineWidth=t?"2px":"",this.overlay.style.borderColor=t||"",this.overlay.style.borderStyle="solid",this.overlay.style.borderWidth="0px"}registerListeners(){this._register(new zr(this.container,{onDragOver:t=>{this.positionOverlay(t.offsetX,t.offsetY),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:t=>this.dispose(),onDragEnd:t=>this.dispose(),onDrop:t=>{this.dispose()}})),this._register(B(this.container,Q.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}positionOverlay(t,i){let n=this.paneElement.clientWidth,o=this.paneElement.clientHeight,s=n/2,a=o/2,l;switch(this.orientation===0?i<a?l=0:i>=a&&(l=1):this.orientation===1&&(t<s?l=2:t>=s&&(l=3)),l){case 0:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"});break;case 1:this.doPositionOverlay({bottom:"0",left:"0",width:"100%",height:"50%"});break;case 2:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"});break;case 3:this.doPositionOverlay({top:"0",right:"0",width:"50%",height:"100%"});break;default:{let d="0",c="0",u="100%",p="100%";if(this.bounds){let m=this.container.getBoundingClientRect();d=`${this.bounds.top-m.top}px`,c=`${this.bounds.left-m.left}px`,p=`${this.bounds.bottom-this.bounds.top}px`,u=`${this.bounds.right-this.bounds.left}px`}this.doPositionOverlay({top:d,left:c,width:u,height:p})}}this.orientation===0&&o<=25||this.orientation===1&&n<=25?this.doUpdateOverlayBorder(l):this.doUpdateOverlayBorder(void 0),this.overlay.style.opacity="1",setTimeout(()=>this.overlay.classList.add("overlay-move-transition"),0),this._currentDropOperation=l}doUpdateOverlayBorder(t){this.overlay.style.borderTopWidth=t===0?"2px":"0px",this.overlay.style.borderLeftWidth=t===2?"2px":"0px",this.overlay.style.borderBottomWidth=t===1?"2px":"0px",this.overlay.style.borderRightWidth=t===3?"2px":"0px"}doPositionOverlay(t){this.container.style.height="100%",this.overlay.style.top=t.top||"",this.overlay.style.left=t.left||"",this.overlay.style.bottom=t.bottom||"",this.overlay.style.right=t.right||"",this.overlay.style.width=t.width,this.overlay.style.height=t.height}contains(t){return t===this.container||t===this.overlay}dispose(){super.dispose(),this._disposed=!0}},jC=class extends Qu{constructor(e,t,i,n,o){let s=n.createScoped(e);s.createKey("viewContainer",t.id);let a=s.createKey("viewContainerLocation",wb(i.getViewContainerLocation(t)));super(nt.ViewContainerTitle,nt.ViewContainerTitleContext,{shouldForwardArgs:!0,renderShortTitle:!0},s,o),this._register(s),this._register(z.filter(i.onDidChangeContainerLocation,l=>l.viewContainer===t)(()=>a.set(wb(i.getViewContainerLocation(t)))))}};jC=R([y(2,ua),y(3,je),y(4,xs)],jC);var Rb=class extends Sh{constructor(t,i,n,o,s,a,l,d,c,u,p,m){super(t,c,u);this.options=i;this.instantiationService=n;this.configurationService=o;this.layoutService=s;this.contextMenuService=a;this.telemetryService=l;this.extensionService=d;this.storageService=u;this.contextService=p;this.viewDescriptorService=m;let f=this.viewDescriptorService.getViewContainerById(t);if(!f)throw new Error("Could not find container");this.viewContainer=f,this.visibleViewsStorageId=`${t}.numberOfVisibleViews`,this.visibleViewsCountFromCache=this.storageService.getNumber(this.visibleViewsStorageId,1,void 0),this.viewContainerModel=this.viewDescriptorService.getViewContainerModel(f)}viewContainer;lastFocusedPane;lastMergedCollapsedPane;paneItems=[];paneview;visible=!1;areExtensionsReady=!1;didLayout=!1;dimension;_boundarySashes;visibleViewsCountFromCache;visibleViewsStorageId;viewContainerModel;_onTitleAreaUpdate=this._register(new _);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidChangeVisibility=this._register(new _);onDidChangeVisibility=this._onDidChangeVisibility.event;_onDidAddViews=this._register(new _);onDidAddViews=this._onDidAddViews.event;_onDidRemoveViews=this._register(new _);onDidRemoveViews=this._onDidRemoveViews.event;_onDidChangeViewVisibility=this._register(new _);onDidChangeViewVisibility=this._onDidChangeViewVisibility.event;_onDidFocusView=this._register(new _);onDidFocusView=this._onDidFocusView.event;_onDidBlurView=this._register(new _);onDidBlurView=this._onDidBlurView.event;get onDidSashChange(){return at(this.paneview).onDidSashChange}get panes(){return this.paneItems.map(t=>t.pane)}get views(){return this.panes}get length(){return this.paneItems.length}_menuActions;get menuActions(){return this._menuActions}create(t){let i=this.options;i.orientation=this.orientation,this.paneview=this._register(new dR(t,this.options)),this._boundarySashes&&this.paneview.setBoundarySashes(this._boundarySashes),this._register(this.paneview.onDidDrop(({from:d,to:c})=>this.movePane(d,c))),this._register(this.paneview.onDidScroll(d=>this.onDidScrollPane())),this._register(this.paneview.onDidSashReset(d=>this.onDidSashReset(d))),this._register(B(t,Q.CONTEXT_MENU,d=>this.showContextMenu(new Ei(pe(t),d)))),this._register(ei.addTarget(t)),this._register(B(t,it.Contextmenu,d=>this.showContextMenu(new Ei(pe(t),d)))),this._menuActions=this._register(this.instantiationService.createInstance(jC,this.paneview.element,this.viewContainer)),this._register(this._menuActions.onDidChange(()=>this.updateTitleArea()));let n,o=()=>{let d=t.getBoundingClientRect(),c=this.panes[this.panes.length-1].element.getBoundingClientRect(),u=this.orientation===0?c.bottom:d.top,p=this.orientation===1?c.right:d.left;return{top:u,bottom:d.bottom,left:p,right:d.right}},s=(d,c)=>c.x>=d.left&&c.x<=d.right&&c.y>=d.top&&c.y<=d.bottom,a;this._register(Tb.INSTANCE.registerTarget(t,{onDragEnter:d=>{if(a=o(),n&&n.disposed&&(n=void 0),!n&&s(a,d.eventData)){let c=d.dragAndDropData.getData();if(c.type==="view"){let u=this.viewDescriptorService.getViewContainerByViewId(c.id),p=this.viewDescriptorService.getViewDescriptorById(c.id);if(u!==this.viewContainer&&(!p||!p.canMoveView||this.viewContainer.rejectAddedViews))return;n=new Ab(t,void 0,a,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService)}if(c.type==="composite"&&c.id!==this.viewContainer.id){let u=this.viewDescriptorService.getViewContainerById(c.id),p=this.viewDescriptorService.getViewContainerModel(u).allViewDescriptors;!p.some(m=>!m.canMoveView)&&p.length>0&&(n=new Ab(t,void 0,a,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService))}}},onDragOver:d=>{n&&n.disposed&&(n=void 0),n&&!s(a,d.eventData)&&(n.dispose(),n=void 0),s(a,d.eventData)&&sV(d.eventData.dataTransfer,"move",n!==void 0)},onDragLeave:d=>{n?.dispose(),n=void 0},onDrop:d=>{if(n){let c=d.dragAndDropData.getData(),u=[];if(c.type==="composite"&&c.id!==this.viewContainer.id){let m=this.viewDescriptorService.getViewContainerById(c.id),f=this.viewDescriptorService.getViewContainerModel(m).allViewDescriptors;f.some(g=>!g.canMoveView)||u.push(...f)}else if(c.type==="view"){let m=this.viewDescriptorService.getViewContainerByViewId(c.id),f=this.viewDescriptorService.getViewDescriptorById(c.id);m!==this.viewContainer&&f&&f.canMoveView&&this.viewDescriptorService.moveViewsToContainer([f],this.viewContainer,void 0,"dnd")}let p=this.panes.length;if(u.length>0&&this.viewDescriptorService.moveViewsToContainer(u,this.viewContainer,void 0,"dnd"),p>0)for(let m of u){let f=this.panes.find(g=>g.id===m.id);f&&this.movePane(f,this.panes[this.panes.length-1])}}n?.dispose(),n=void 0}})),this._register(this.onDidSashChange(()=>this.saveViewSizes())),this._register(this.viewContainerModel.onDidAddVisibleViewDescriptors(d=>this.onDidAddViewDescriptors(d))),this._register(this.viewContainerModel.onDidRemoveVisibleViewDescriptors(d=>this.onDidRemoveViewDescriptors(d)));let l=this.viewContainerModel.visibleViewDescriptors.map((d,c)=>{let u=this.viewContainerModel.getSize(d.id),p=this.viewContainerModel.isCollapsed(d.id);return{viewDescriptor:d,index:c,size:u,collapsed:p}});l.length&&this.onDidAddViewDescriptors(l),this.extensionService.whenInstalledExtensionsRegistered().then(()=>{this.areExtensionsReady=!0,this.panes.length&&(this.updateTitleArea(),this.updateViewHeaders()),this._register(this.configurationService.onDidChangeConfiguration(d=>{d.affectsConfiguration("workbench.activityBar.location")&&this.updateViewHeaders()}))}),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>this._onTitleAreaUpdate.fire()))}getTitle(){let t=this.viewContainerModel.title;if(this.isViewMergedWithContainer()){let i=this.paneItems[0].pane.singleViewPaneContainerTitle;if(i)return i;let n=this.paneItems[0].pane.title;return t===n?n:n?`${t}: ${n}`:t}return t}showContextMenu(t){for(let i of this.paneItems)if(An(t.target,i.pane.element))return;t.stopPropagation(),t.preventDefault(),this.contextMenuService.showContextMenu({getAnchor:()=>t,getActions:()=>this.menuActions?.getContextMenuActions()??[]})}getActionsContext(){if(this.isViewMergedWithContainer())return this.panes[0].getActionsContext()}getActionViewItem(t,i){return this.isViewMergedWithContainer()?this.paneItems[0].pane.getActionViewItem(t,i):mb(this.instantiationService,t,i)}focus(){let t;if(this.lastFocusedPane)t=this.lastFocusedPane;else if(this.paneItems.length>0){for(let{pane:i}of this.paneItems)if(i.isExpanded()){t=i;break}}t&&t.focus()}get orientation(){switch(this.viewDescriptorService.getViewContainerLocation(this.viewContainer)){case 0:case 2:return 0;case 1:return _7(this.layoutService.getPanelPosition())?1:0}return 0}layout(t){this.paneview&&(this.paneview.orientation!==this.orientation&&this.paneview.flipOrientation(t.height,t.width),this.paneview.layout(t.height,t.width)),this.dimension=t,this.didLayout?this.saveViewSizes():(this.didLayout=!0,this.restoreViewSizes())}setBoundarySashes(t){this._boundarySashes=t,this.paneview?.setBoundarySashes(t)}getOptimalWidth(){return Math.max(...this.panes.map(n=>n.getOptimalWidth()||0))+16}addPanes(t){let i=this.isViewMergedWithContainer();for(let{pane:n,size:o,index:s,disposable:a}of t)this.addPane(n,o,a,s);this.updateViewHeaders(),this.isViewMergedWithContainer()!==i&&this.updateTitleArea(),this._onDidAddViews.fire(t.map(({pane:n})=>n))}setVisible(t){this.visible!==!!t&&(this.visible=t,this._onDidChangeVisibility.fire(t)),this.panes.filter(i=>i.isVisible()!==t).map(i=>i.setVisible(t))}isVisible(){return this.visible}updateTitleArea(){this._onTitleAreaUpdate.fire()}createView(t,i){return this.instantiationService.createInstance(t.ctorDescriptor.ctor,...t.ctorDescriptor.staticArguments||[],i)}getView(t){return this.panes.filter(i=>i.id===t)[0]}saveViewSizes(){this.didLayout&&this.viewContainerModel.setSizes(this.panes.map(t=>({id:t.id,size:this.getPaneSize(t)})))}restoreViewSizes(){if(this.didLayout){let t;for(let i=0;i<this.viewContainerModel.visibleViewDescriptors.length;i++){let n=this.panes[i],o=this.viewContainerModel.visibleViewDescriptors[i],s=this.viewContainerModel.getSize(o.id);typeof s=="number"?this.resizePane(n,s):(t=t||this.computeInitialSizes(),this.resizePane(n,t.get(n.id)||200))}}}computeInitialSizes(){let t=new Map;if(this.dimension){let i=this.viewContainerModel.visibleViewDescriptors.reduce((n,{weight:o})=>n+(o||20),0);for(let n of this.viewContainerModel.visibleViewDescriptors)this.orientation===0?t.set(n.id,this.dimension.height*(n.weight||20)/i):t.set(n.id,this.dimension.width*(n.weight||20)/i)}return t}saveState(){this.panes.forEach(t=>t.saveState()),this.storageService.store(this.visibleViewsStorageId,this.length,1,1)}onContextMenu(t,i){t.stopPropagation(),t.preventDefault();let n=i.menuActions.getContextMenuActions();this.contextMenuService.showContextMenu({getAnchor:()=>t,getActions:()=>n})}openView(t,i){let n=this.getView(t);return n||this.toggleViewVisibility(t),n=this.getView(t),n&&(n.setExpanded(!0),i&&n.focus()),n}onDidAddViewDescriptors(t){let i=[];for(let{viewDescriptor:o,collapsed:s,index:a,size:l}of t){let d=this.createView(o,{id:o.id,title:o.name.value,fromExtensionId:o.extensionId,expanded:!s,singleViewPaneContainerTitle:o.singleViewPaneContainerTitle});d.render();let c=B(d.draggableElement,"contextmenu",p=>{p.stopPropagation(),p.preventDefault(),this.onContextMenu(new Ei(pe(d.draggableElement),p),d)}),u=z.latch(z.map(d.onDidChange,()=>!d.isExpanded()))(p=>{this.viewContainerModel.setCollapsed(o.id,p)});i.push({pane:d,size:l||d.minimumSize,index:a,disposable:un(c,u)})}this.addPanes(i),this.restoreViewSizes();let n=[];for(let{pane:o}of i)o.setVisible(this.isVisible()),n.push(o);return n}onDidRemoveViewDescriptors(t){t=t.sort((n,o)=>o.index-n.index);let i=[];for(let{index:n}of t)this.paneItems[n]&&i.push(this.paneItems[n].pane);if(i.length){this.removePanes(i);for(let n of i)n.setVisible(!1)}}toggleViewVisibility(t){if(this.viewContainerModel.activeViewDescriptors.some(i=>i.id===t)){let i=!this.viewContainerModel.isVisible(t);this.viewContainerModel.setVisible(t,i)}}addPane(t,i,n,o=this.paneItems.length-1){let s=t.onDidFocus(()=>{this._onDidFocusView.fire(t),this.lastFocusedPane=t}),a=t.onDidBlur(()=>this._onDidBlurView.fire(t)),l=t.onDidChangeTitleArea(()=>{this.isViewMergedWithContainer()&&this.updateTitleArea()}),d=t.onDidChangeBodyVisibility(()=>this._onDidChangeViewVisibility.fire(t)),c=t.onDidChange(()=>{t===this.lastFocusedPane&&!t.isExpanded()&&(this.lastFocusedPane=void 0)}),u=this.viewDescriptorService.getViewContainerLocation(this.viewContainer)===1;t.style({headerForeground:ae(u?a9:b9),headerBackground:ae(u?s9:f9),headerBorder:ae(u?l9:FN),dropBackground:ae(u?PN:NN),leftBorder:u?ae(d9):void 0});let p=new Y;p.add(n),p.add(un(t,s,a,l,c,d));let m={pane:t,disposable:p};this.paneItems.splice(o,0,m),at(this.paneview).addPane(t,i,o);let f;p.add(Tb.INSTANCE.registerDraggable(t.draggableElement,()=>({type:"view",id:t.id}),{})),p.add(Tb.INSTANCE.registerTarget(t.dropTargetElement,{onDragEnter:g=>{if(!f){let b=g.dragAndDropData.getData();if(b.type==="view"&&b.id!==t.id){let v=this.viewDescriptorService.getViewContainerByViewId(b.id),I=this.viewDescriptorService.getViewDescriptorById(b.id);if(v!==this.viewContainer&&(!I||!I.canMoveView||this.viewContainer.rejectAddedViews))return;f=new Ab(t.dropTargetElement,this.orientation??0,void 0,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService)}if(b.type==="composite"&&b.id!==this.viewContainer.id&&!this.viewContainer.rejectAddedViews){let v=this.viewDescriptorService.getViewContainerById(b.id),I=this.viewDescriptorService.getViewContainerModel(v).allViewDescriptors;!I.some(w=>!w.canMoveView)&&I.length>0&&(f=new Ab(t.dropTargetElement,this.orientation??0,void 0,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService))}}},onDragOver:g=>{sV(g.eventData.dataTransfer,"move",f!==void 0)},onDragLeave:g=>{f?.dispose(),f=void 0},onDrop:g=>{if(f){let b=g.dragAndDropData.getData(),v=[],I;if(b.type==="composite"&&b.id!==this.viewContainer.id&&!this.viewContainer.rejectAddedViews){let w=this.viewDescriptorService.getViewContainerById(b.id),E=this.viewDescriptorService.getViewContainerModel(w).allViewDescriptors;E.length>0&&!E.some(S=>!S.canMoveView)&&(v.push(...E),I=E[0])}else if(b.type==="view"){let w=this.viewDescriptorService.getViewContainerByViewId(b.id),E=this.viewDescriptorService.getViewDescriptorById(b.id);w!==this.viewContainer&&E&&E.canMoveView&&!this.viewContainer.rejectAddedViews&&v.push(E),E&&(I=E)}if(v&&this.viewDescriptorService.moveViewsToContainer(v,this.viewContainer,void 0,"dnd"),I){if(f.currentDropOperation===1||f.currentDropOperation===3){let w=this.panes.findIndex(S=>S.id===I.id),E=this.panes.findIndex(S=>S.id===t.id);w>=0&&E>=0&&(w>E&&E++,E<this.panes.length&&E!==w&&this.movePane(this.panes[w],this.panes[E]))}if(f.currentDropOperation===0||f.currentDropOperation===2){let w=this.panes.findIndex(S=>S.id===I.id),E=this.panes.findIndex(S=>S.id===t.id);w>=0&&E>=0&&(w<E&&E--,E>=0&&E!==w&&this.movePane(this.panes[w],this.panes[E]))}v.length>1&&v.slice(1).forEach(w=>{let E=this.panes.findIndex(T=>T.id===I.id),S=this.panes.findIndex(T=>T.id===w.id);S>=0&&E>=0&&(S>E&&E++,E<this.panes.length&&E!==S&&(this.movePane(this.panes[S],this.panes[E]),I=w))})}}f?.dispose(),f=void 0}}))}removePanes(t){let i=this.isViewMergedWithContainer();t.forEach(n=>this.removePane(n)),this.updateViewHeaders(),i!==this.isViewMergedWithContainer()&&this.updateTitleArea(),this._onDidRemoveViews.fire(t)}removePane(t){let i=this.paneItems.findIndex(o=>o.pane===t);if(i===-1)return;this.lastFocusedPane===t&&(this.lastFocusedPane=void 0),at(this.paneview).removePane(t);let[n]=this.paneItems.splice(i,1);n.disposable.dispose()}movePane(t,i){let n=this.paneItems.findIndex(d=>d.pane===t),o=this.paneItems.findIndex(d=>d.pane===i),s=this.viewContainerModel.visibleViewDescriptors[n],a=this.viewContainerModel.visibleViewDescriptors[o];if(n<0||n>=this.paneItems.length||o<0||o>=this.paneItems.length)return;let[l]=this.paneItems.splice(n,1);this.paneItems.splice(o,0,l),at(this.paneview).movePane(t,i),this.viewContainerModel.move(s.id,a.id),this.updateTitleArea()}resizePane(t,i){at(this.paneview).resizePane(t,i)}getPaneSize(t){return at(this.paneview).getPaneSize(t)}updateViewHeaders(){this.isViewMergedWithContainer()?(this.paneItems[0].pane.isExpanded()?this.lastMergedCollapsedPane=void 0:(this.lastMergedCollapsedPane=this.paneItems[0].pane,this.paneItems[0].pane.setExpanded(!0)),this.paneItems[0].pane.headerVisible=!1,this.paneItems[0].pane.collapsible=!0):(this.paneItems.length===1?(this.paneItems[0].pane.headerVisible=!0,this.paneItems[0].pane===this.lastMergedCollapsedPane&&this.paneItems[0].pane.setExpanded(!1),this.paneItems[0].pane.collapsible=!1):this.paneItems.forEach(t=>{t.pane.headerVisible=!0,t.pane.collapsible=!0,t.pane===this.lastMergedCollapsedPane&&t.pane.setExpanded(!1)}),this.lastMergedCollapsedPane=void 0)}isViewMergedWithContainer(){return this.options.mergeViewWithContainerWhenSingleView&&this.paneItems.length===1?this.areExtensionsReady?!0:this.visibleViewsCountFromCache===void 0?this.paneItems[0].pane.isExpanded():this.visibleViewsCountFromCache===1:!1}onDidScrollPane(){for(let t of this.panes)t.onDidScrollRoot()}onDidSashReset(t){let i,n;for(let o=t;o>=0;o--)if(this.paneItems[o].pane?.isVisible()&&this.paneItems[o]?.pane.isExpanded()){i=this.paneItems[o].pane;break}for(let o=t+1;o<this.paneItems.length;o++)if(this.paneItems[o].pane?.isVisible()&&this.paneItems[o]?.pane.isExpanded()){n=this.paneItems[o].pane;break}if(i&&n){let o=this.getPaneSize(i),s=this.getPaneSize(n),a=Math.ceil((o+s)/2),l=Math.floor((o+s)/2);o>s?(this.resizePane(i,a),this.resizePane(n,l)):(this.resizePane(n,l),this.resizePane(i,a))}}dispose(){super.dispose(),this.paneItems.forEach(t=>t.disposable.dispose()),this.paneview&&this.paneview.dispose()}};Rb=R([y(2,ve),y(3,He),y(4,$a),y(5,Zi),y(6,jt),y(7,kb),y(8,kt),y(9,Ii),y(10,bi),y(11,ua)],Rb);var Mb=class extends wi{constructor(t,i){super(t);this.offset=i}async run(t){let i=t.get(ua),n=t.get(je),o=Cb.getValue(n);if(o===void 0)return;let s=i.getViewContainerByViewId(o),a=i.getViewContainerModel(s),l=a.visibleViewDescriptors.find(u=>u.id===o),d=a.visibleViewDescriptors.indexOf(l);if(d+this.offset<0||d+this.offset>=a.visibleViewDescriptors.length)return;let c=a.visibleViewDescriptors[d+this.offset];a.move(l.id,c.id)}};lr(class extends Mb{constructor(){super({id:"views.moveViewUp",title:h("viewMoveUp","Move View Up"),keybinding:{primary:js(2089,16),weight:201,when:Cb.notEqualsTo("")}},-1)}});lr(class extends Mb{constructor(){super({id:"views.moveViewLeft",title:h("viewMoveLeft","Move View Left"),keybinding:{primary:js(2089,15),weight:201,when:Cb.notEqualsTo("")}},-1)}});lr(class extends Mb{constructor(){super({id:"views.moveViewDown",title:h("viewMoveDown","Move View Down"),keybinding:{primary:js(2089,18),weight:201,when:Cb.notEqualsTo("")}},1)}});lr(class extends Mb{constructor(){super({id:"views.moveViewRight",title:h("viewMoveRight","Move View Right"),keybinding:{primary:js(2089,17),weight:201,when:Cb.notEqualsTo("")}},1)}});lr(class extends wi{constructor(){super({id:"vscode.moveViews",title:h("viewsMove","Move Views")})}async run(e,t){if(!Array.isArray(t?.viewIds)||typeof t?.destinationId!="string")return Promise.reject("Invalid arguments");let i=e.get(ua),n=i.getViewContainerById(t.destinationId);if(n){for(let o of t.viewIds){let s=i.getViewDescriptorById(o);s?.canMoveView&&i.moveViewsToContainer([s],n,0,this.desc.id)}await e.get(WC).openViewContainer(n.id,!0)}}});var TR=class extends vf{constructor(t,i,n,o,s,a,l,d){super(t,i,s,n);this.storageService=n;this.instantiationService=o;this.contextMenuService=a;this.extensionService=l;this.contextService=d}viewPaneContainer;create(t){super.create(t),this.viewPaneContainer=this._register(this.createViewPaneContainer(t)),this._register(this.viewPaneContainer.onTitleAreaUpdate(()=>this.updateTitleArea())),this.viewPaneContainer.create(t)}setVisible(t){super.setVisible(t),this.viewPaneContainer?.setVisible(t)}layout(t){this.viewPaneContainer?.layout(t)}setBoundarySashes(t){this.viewPaneContainer?.setBoundarySashes(t)}getOptimalWidth(){return this.viewPaneContainer?.getOptimalWidth()??0}openView(t,i){return this.viewPaneContainer?.openView(t,i)}getViewPaneContainer(){return this.viewPaneContainer}getActionsContext(){return this.getViewPaneContainer()?.getActionsContext()}getContextMenuActions(){return this.viewPaneContainer?.menuActions?.getContextMenuActions()??[]}getMenuIds(){let t=[];return this.viewPaneContainer?.menuActions&&(t.push(this.viewPaneContainer.menuActions.menuId),this.viewPaneContainer.isViewMergedWithContainer()&&t.push(this.viewPaneContainer.panes[0].menuActions.menuId)),t}getActions(){let t=[];if(this.viewPaneContainer?.menuActions&&(t.push(...this.viewPaneContainer.menuActions.getPrimaryActions()),this.viewPaneContainer.isViewMergedWithContainer())){let i=this.viewPaneContainer.panes[0];i.shouldShowFilterInHeader()&&t.push(ER),t.push(...i.menuActions.getPrimaryActions())}return t}getSecondaryActions(){if(!this.viewPaneContainer?.menuActions)return[];let t=this.viewPaneContainer.isViewMergedWithContainer()?this.viewPaneContainer.panes[0].menuActions.getSecondaryActions():[],i=this.viewPaneContainer.menuActions.getSecondaryActions(),n=i.findIndex(o=>o instanceof Po&&o.item.submenu===yV);if(n!==-1){let o=i[n];o.actions.some(({enabled:s})=>s)?i.length===1&&t.length===0?i=o.actions.slice():n!==0&&(i=[o,...i.slice(0,n),...i.slice(n+1)]):i.splice(n,1)}return i.length&&t.length?[...i,new sn,...t]:i.length?i:t}getActionViewItem(t,i){return this.viewPaneContainer?.getActionViewItem(t,i)}getTitle(){return this.viewPaneContainer?.getTitle()??""}focus(){super.focus(),this.viewPaneContainer?.focus()}};TR=R([y(1,jt),y(2,Ii),y(3,ve),y(4,kt),y(5,Zi),y(6,kb),y(7,bi)],TR);var IV={Viewlets:"workbench.contributions.viewlets",Panels:"workbench.contributions.panels",Auxiliary:"workbench.contributions.auxiliary"},qC=class extends K_{registerPaneComposite(e){super.registerComposite(e)}deregisterPaneComposite(e){super.deregisterComposite(e)}getPaneComposite(e){return this.getComposite(e)}getPaneComposites(){return this.getComposites()}};ze.add(IV.Viewlets,new qC);ze.add(IV.Panels,new qC);ze.add(IV.Auxiliary,new qC);var hK=Z("paneCompositePartService");var qJ="explorer.newFile",iUi=pt("newFile","New File..."),$J="explorer.newFolder",nUi=pt("newFolder","New Folder..."),oUi=h("rename","Rename..."),rUi=h("delete","Delete"),sUi=h("copyFile","Copy"),aUi=h("pasteFile","Paste"),lUi=new q("fileCopied",!1),YJ="explorer.download",dUi=h("download","Download..."),ZJ="explorer.upload",cUi=h("upload","Upload...");function XJ(r,e){e.message==="string"&&(e=e.message),r.error(os(e,!1))}async function QJ(r,e){r&&(r.indexOf("/")>=0||r.indexOf("\\")>=0)&&await e.refresh()}var mK=class r extends wi{static ID="workbench.files.action.compareFileWith";static LABEL=pt("globalCompareFile","Compare Active File With...");constructor(){super({id:r.ID,title:r.LABEL,f1:!0,category:ar.File,precondition:kC,metadata:{description:pt("compareFileWithMeta","Opens a picker to select a file to diff with the active editor.")}})}async run(e){let t=e.get(vt),i=e.get(tx),n=e.get($l),o=t.activeEditor,s=Mt.getOriginalUri(o);if(s&&i.canHandleResource(s)){let a=await n.quickAccess.pick("",{itemActivation:2});if(a?.length===1){let l=a[0].resource;X.isUri(l)&&i.canHandleResource(l)&&t.openEditor({original:{resource:s},modified:{resource:l},options:{pinned:!0}})}}}};var $C=class extends Si{constructor(t,i,n,o,s){super(t,i);this.commandService=n;this.notificationService=o;this.workingCopyService=s;this.lastDirtyState=this.workingCopyService.hasDirty,this.enabled=this.lastDirtyState,this.registerListeners()}lastDirtyState;registerListeners(){this._register(this.workingCopyService.onDidChangeDirty(t=>this.updateEnablement(t)))}updateEnablement(t){let i=t.isDirty()||this.workingCopyService.hasDirty;this.lastDirtyState!==i&&(this.enabled=i,this.lastDirtyState=this.enabled)}async run(t){try{await this.doRun(t)}catch(i){XJ(this.notificationService,i)}}};$C=R([y(2,Ui),y(3,Bo),y(4,ia)],$C);var Ob=class extends $C{static ID="workbench.files.action.saveAllInGroup";static LABEL=h("saveAllInGroup","Save All in Group");get class(){return"explorer-action "+Ae.asClassName(ie.saveAll)}doRun(e){return this.commandService.executeCommand(H8,{},e)}},ep=class extends Si{constructor(t,i,n){super(t,i,Ae.asClassName(ie.closeAll));this.commandService=n}static ID="workbench.files.action.closeGroup";static LABEL=h("closeGroup","Close Group");run(t){return this.commandService.executeCommand(j3,{},t)}};ep=R([y(2,Ui)],ep);var gK=class r extends wi{static ID="workbench.files.action.focusFilesExplorer";static LABEL=pt("focusFilesExplorer","Focus on Files Explorer");constructor(){super({id:r.ID,title:r.LABEL,f1:!0,category:ar.File,metadata:{description:pt("focusFilesExplorerMetadata","Moves focus to the file explorer view container.")}})}async run(e){await e.get(hK).openPaneComposite(w8,0,!0)}},fK=class r extends wi{static ID="workbench.files.action.showActiveFileInExplorer";static LABEL=pt("showInExplorer","Reveal Active File in Explorer View");constructor(){super({id:r.ID,title:r.LABEL,f1:!0,category:ar.File,metadata:{description:pt("showInExplorerMetadata","Reveals and selects the active file within the explorer view.")}})}async run(e){let t=e.get(Ui),i=e.get(vt),n=Mt.getOriginalUri(i.activeEditor,{supportSideBySide:1});n&&t.executeCommand(B8,n)}},bK=class r extends wi{static ID="workbench.action.files.showOpenedFileInNewWindow";static LABEL=pt("openFileInEmptyWorkspace","Open Active File in New Empty Workspace");constructor(){super({id:r.ID,title:r.LABEL,f1:!0,category:ar.File,precondition:A3,metadata:{description:pt("openFileInEmptyWorkspaceMetadata","Opens the active file in a new window with no folders open.")}})}async run(e){let t=e.get(vt),i=e.get(eo),n=e.get(Io),o=e.get(Lt),s=Mt.getOriginalUri(t.activeEditor,{supportSideBySide:1});s&&(o.hasProvider(s)?i.openWindow([{fileUri:s}],{forceNewWindow:!0}):n.error(h("openFileToShowInNewWindow.unsupportedschema","The active editor must contain an openable resource.")))}};function JJ(r,e,t,i){if(t=tee(t),!t||t.length===0||/^\s+$/.test(t))return{content:h("emptyFileNameError","A file or folder name must be provided."),severity:As.Error};if(t[0]==="/"||t[0]==="\\")return{content:h("fileNameStartsWithSlashError","A file or folder name cannot start with a slash."),severity:As.Error};let n=ni(t.split(/[\\/]/)),o=e.parent;if(t!==e.name){let s=o?.getChild(t);if(s&&s!==e)return{content:h("fileNameExistsError","A file or folder **{0}** already exists at this location. Please choose a different name.",t),severity:As.Error}}if(n.some(s=>!r.hasValidBasename(e.resource,i,s))){let s=t.replace(/\*/g,"\\*");return{content:h("invalidFileNameError","The name **{0}** is not valid as a file or folder name. Please choose a different name.",eee(s)),severity:As.Error}}return n.some(s=>/^\s|\s$/.test(s))?{content:h("fileNameWhitespaceWarning","Leading or trailing whitespace detected in file or folder name."),severity:As.Warning}:null}function eee(r){return r?.length>255?`${r.substr(0,255)}...`:r}function tee(r){return r&&(r=$W(r,"	"),r=vl(r,"/"),r=vl(r,"\\"),r)}var vK=class r extends wi{static ID="workbench.files.action.compareNewUntitledTextFiles";static LABEL=pt("compareNewUntitledTextFiles","Compare New Untitled Text Files");constructor(){super({id:r.ID,title:r.LABEL,f1:!0,category:ar.File,metadata:{description:pt("compareNewUntitledTextFilesMeta","Opens a new diff editor with two untitled files.")}})}async run(e){await e.get(vt).openEditor({original:{resource:void 0},modified:{resource:void 0},options:{pinned:!0}})}},yK=class r extends wi{static ID="workbench.files.action.compareWithClipboard";static LABEL=pt("compareWithClipboard","Compare Active File with Clipboard");registrationDisposal;static SCHEME_COUNTER=0;constructor(){super({id:r.ID,title:r.LABEL,f1:!0,category:ar.File,keybinding:{primary:js(2089,33),weight:200},metadata:{description:pt("compareWithClipboardMeta","Opens a new diff editor to compare the active file with the contents of the clipboard.")}})}async run(e){let t=e.get(vt),i=e.get(ve),n=e.get(tx),o=e.get(Lt),s=Mt.getOriginalUri(t.activeEditor,{supportSideBySide:1}),a=`clipboardCompare${r.SCHEME_COUNTER++}`;if(s&&(o.hasProvider(s)||s.scheme===ue.untitled)){if(!this.registrationDisposal){let c=i.createInstance(YC);this.registrationDisposal=n.registerTextModelContentProvider(a,c)}let l=Hi(s),d=h("clipboardComparisonLabel","Clipboard \u2194 {0}",l);await t.openEditor({original:{resource:s.with({scheme:a})},modified:{resource:s},label:d,options:{pinned:!0}}).finally(()=>{ht(this.registrationDisposal),this.registrationDisposal=void 0})}}dispose(){ht(this.registrationDisposal),this.registrationDisposal=void 0}},YC=class{constructor(e,t,i){this.clipboardService=e;this.languageService=t;this.modelService=i}async provideTextContent(e){let t=await this.clipboardService.readText();return this.modelService.createModel(t,this.languageService.createByFilepathOrFirstLine(e),e)}};YC=R([y(0,Yg),y(1,Ki),y(2,Qn)],YC);function iee(r,e,t){r.prompt(As.Error,os(e,!1),[{label:h("retry","Retry"),run:()=>t()}])}async function wK(r,e){let t=r.get(Zu),i=r.get(Lt),n=r.get(He),o=r.get(oa),s=r.get(vt),a=r.get(WC),l=r.get(Bo),d=r.get(Ib),c=r.get(Ui),u=r.get(PC),p=!a.isViewVisible(oh),m=await a.openView(oh,!0);if(p&&await hn(500),!m){if(e)throw new Error("Open a folder or workspace first.");return c.executeCommand(yT)}let f=t.getContext(!1),g=f.length>0?f[0]:void 0,b;if(g?b=g.isDirectory?g:g.parent||t.roots[0]:b=t.roots[0],b.isReadonly)throw new Error("Parent folder is readonly.");let v=new BC(i,n,o,b,e);b.addChild(v);let I=async E=>{try{let S=It(b.resource,E);E.endsWith("/")&&(e=!0),await t.applyBulkEdit([new gd(void 0,S,{folder:e})],{undoLabel:h("createBulkEdit","Create {0}",E),progressLabel:h("creatingBulkEdit","Creating {0}",E),confirmBeforeUndo:!0}),await QJ(E,t),e?await t.select(S,!0):await s.openEditor({resource:S,options:{pinned:!0}})}catch(S){iee(l,S,()=>I(E))}},w=(await d.getEnvironment())?.os??nr;await t.setEditable(v,{validationMessage:E=>JJ(u,v,E,w),onFinish:async(E,S)=>{b.removeChild(v),await t.setEditable(v,null),S&&I(E)}})}Nn.registerCommand({id:qJ,handler:async r=>{await wK(r,!1)}});Nn.registerCommand({id:$J,handler:async r=>{await wK(r,!0)}});var nee=async r=>{let e=r.get(Zu),t=r.get(Bo),i=r.get(ve),n=e.getContext(!0),o=n.length?n:e.roots,s=i.createInstance(gc);try{await s.download(o)}catch(a){throw t.error(a),a}};Nn.registerCommand({id:YJ,handler:nee});var oee=async r=>{let e=r.get(Zu),t=r.get(Bo),i=r.get(ve),n=e.getContext(!1),o=n.length?n[0]:e.roots[0];try{let s=await nH();s&&await i.createInstance(mc).upload(o,s)}catch(s){throw t.error(s),s}};Nn.registerCommand({id:ZJ,handler:oee});var Pb=class extends wi{constructor(t,i,n){super({id:t,title:i,f1:!0,category:ar.File,precondition:Yk});this.newReadonlyState=n}async run(t){let i=t.get(vt),n=t.get(oa),o=Mt.getOriginalUri(i.activeEditor,{supportSideBySide:1});o&&await n.updateReadonly(o,this.newReadonlyState)}},IK=class r extends Pb{static ID="workbench.action.files.setActiveEditorReadonlyInSession";static LABEL=pt("setActiveEditorReadonlyInSession","Set Active Editor Read-only in Session");constructor(){super(r.ID,r.LABEL,!0)}},CK=class r extends Pb{static ID="workbench.action.files.setActiveEditorWriteableInSession";static LABEL=pt("setActiveEditorWriteableInSession","Set Active Editor Writeable in Session");constructor(){super(r.ID,r.LABEL,!1)}},SK=class r extends Pb{static ID="workbench.action.files.toggleActiveEditorReadonlyInSession";static LABEL=pt("toggleActiveEditorReadonlyInSession","Toggle Active Editor Read-only in Session");constructor(){super(r.ID,r.LABEL,"toggle")}},EK=class r extends Pb{static ID="workbench.action.files.resetActiveEditorReadonlyInSession";static LABEL=pt("resetActiveEditorReadonlyInSession","Reset Active Editor Read-only in Session");constructor(){super(r.ID,r.LABEL,"reset")}};var CV=Z("historyService");var ZC=class extends wi{constructor(t,i,n){super(t);this.commandId=i;this.commandArgs=n}run(t){return t.get(Ui).executeCommand(this.commandId,this.commandArgs)}};var xK=class extends ZC{static LABEL=h("splitEditorGroupUp","Split Editor Up");constructor(){super({id:jB,title:pt("splitEditorGroupUp","Split Editor Up"),f1:!0,keybinding:{weight:200,primary:js(2089,2141)},category:ar.View},jB)}},TK=class extends ZC{static LABEL=h("splitEditorGroupDown","Split Editor Down");constructor(){super({id:qB,title:pt("splitEditorGroupDown","Split Editor Down"),f1:!0,keybinding:{weight:200,primary:js(2089,2141)},category:ar.View},qB)}};var tp=class extends Si{constructor(t,i,n){super(t,i,Ae.asClassName(ie.close));this.commandService=n}static ID="workbench.action.closeActiveEditor";static LABEL=h("closeEditor","Close Editor");run(t){return this.commandService.executeCommand(NC,void 0,t)}};tp=R([y(2,Ui)],tp);var pa=class extends Si{constructor(t,i,n){super(t,i,Ae.asClassName(ie.pinned));this.commandService=n}static ID="workbench.action.unpinActiveEditor";static LABEL=h("unpinEditor","Unpin Editor");run(t){return this.commandService.executeCommand(GB,void 0,t)}};pa=R([y(2,Ui)],pa);var ip=class extends Si{constructor(t,i,n){super(t,i,Ae.asClassName(ie.close));this.editorGroupService=n}static ID="workbench.action.closeActiveEditor";static LABEL=h("closeOneEditor","Close");async run(t){let i=t?this.editorGroupService.getGroup(t.groupId):this.editorGroupService.activeGroup;if(!i)return;let n=t?.editorIndex!==void 0?i.getEditorByIndex(t.editorIndex):i.activeEditor;if(!n)return;let o=[];i.isSelected(n)?o.push(...i.selectedEditors):o.push(n);for(let s of o)await i.closeEditor(s,{preserveFocus:t?.preserveFocus})}};ip=R([y(2,Ri)],ip);var SV=class extends wi{groupsToClose(e){let t=[],i=e.getGroups(2);for(let n=i.length-1;n>=0;n--)t.push(i[n]);return t}async run(e){let t=e.get(vt),i=e.get(Oi),n=e.get(Qd),o=e.get(Ri),s=e.get(oa),a=e.get(Wg),l=new Set,d=new Set,c=new Set,u=new Map;for(let{editor:p,groupId:m}of t.getEditors(1,{excludeSticky:this.excludeSticky})){let f=!1;if(p.closeHandler?f=p.closeHandler.showConfirm():f=p.isDirty()&&!p.isSaving(),!!f)if(typeof p.closeHandler?.confirm=="function"){let g=u.get(p.typeId);g||(g=new Set,u.set(p.typeId,g)),g.add({editor:p,groupId:m})}else!p.hasCapability(4)&&s.getAutoSaveMode(p).mode===3?d.add({editor:p,groupId:m}):Pr&&(dt||_t)&&!p.hasCapability(4)&&s.getAutoSaveMode(p).mode===4?c.add({editor:p,groupId:m}):l.add({editor:p,groupId:m})}if(l.size>0){let p=Array.from(l.values());switch(await this.revealEditorsToConfirm(p,o),await a.showSaveConfirm(p.map(({editor:f})=>f instanceof xi?f.primary.getName():f.getName()))){case 2:return;case 1:await this.revertEditors(t,i,n,p);break;case 0:await t.save(p,{reason:1});break}}for(let[,p]of u){let m=Array.from(p.values());await this.revealEditorsToConfirm(m,o);let f=await m.at(0)?.editor.closeHandler?.confirm?.(m);if(typeof f=="number")switch(f){case 2:return;case 1:await this.revertEditors(t,i,n,m);break;case 0:await t.save(m,{reason:1});break}}if(d.size>0){let p=Array.from(d.values());await t.save(p,{reason:3})}if(c.size>0){let p=Array.from(c.values());await t.save(p,{reason:4})}return this.doCloseAll(o)}revertEditors(e,t,i,n){return i.withProgress({location:10,delay:800,title:h("reverting","Reverting Editors...")},()=>this.doRevertEditors(e,t,n))}async doRevertEditors(e,t,i){try{await e.revert(i)}catch(n){t.error(n),await e.revert(i,{soft:!0})}}async revealEditorsToConfirm(e,t){try{let i=new Set;for(let{editor:n,groupId:o}of e){if(i.has(o))continue;i.add(o),await t.getGroup(o)?.openEditor(n)}}catch{}}async doCloseAll(e){await Promise.all(this.groupsToClose(e).map(t=>t.closeAllEditors({excludeSticky:this.excludeSticky})))}},XC=class r extends SV{static ID="workbench.action.closeAllEditors";static LABEL=pt("closeAllEditors","Close All Editors");constructor(){super({id:r.ID,title:r.LABEL,f1:!0,keybinding:{weight:200,primary:js(2089,2101)},icon:ie.closeAll,category:ar.View})}get excludeSticky(){return!0}};var _K=class r extends wi{static ID="workbench.action.navigateForward";static LABEL=h("navigateForward","Go Forward");constructor(){super({id:r.ID,title:{...pt("navigateForward","Go Forward"),mnemonicTitle:h({key:"miForward",comment:["&& denotes a mnemonic"]},"&&Forward")},f1:!0,icon:ie.arrowRight,precondition:Ue.has("canNavigateForward"),keybinding:{weight:200,win:{primary:529},mac:{primary:1368},linux:{primary:3160}},menu:[{id:nt.MenubarGoMenu,group:"1_history_nav",order:2},{id:nt.CommandCenter,order:2}]})}async run(e){await e.get(CV).goForward(0)}},DK=class r extends wi{static ID="workbench.action.navigateBack";static LABEL=h("navigateBack","Go Back");constructor(){super({id:r.ID,title:{...pt("navigateBack","Go Back"),mnemonicTitle:h({key:"miBack",comment:["&& denotes a mnemonic"]},"&&Back")},f1:!0,precondition:Ue.has("canNavigateBack"),icon:ie.arrowLeft,keybinding:{weight:200,win:{primary:527},mac:{primary:344},linux:{primary:2648}},menu:[{id:nt.MenubarGoMenu,group:"1_history_nav",order:1},{id:nt.CommandCenter,order:1}]})}async run(e){await e.get(CV).goBack(0)}};var LK=class extends ZC{static ID="workbench.action.splitEditorToLeftGroup";static LABEL=h("splitEditorToLeftGroup","Split Editor into Left Group");constructor(){super({id:"workbench.action.splitEditorToLeftGroup",title:pt("splitEditorToLeftGroup","Split Editor into Left Group"),f1:!0,category:ar.View},q3,{to:"left",by:"group"})}};var np=class r extends P{constructor(t,i){super();this.options=i;this.supportIcons=i?.supportIcons??!1,this.domNode=ye(t,he("span.monaco-highlighted-label"))}domNode;text="";title="";highlights=[];supportIcons;didEverRender=!1;customHover;get element(){return this.domNode}set(t,i=[],n="",o){t||(t=""),o&&(t=r.escapeNewLines(t,i)),!(this.didEverRender&&this.text===t&&this.title===n&&fi(this.highlights,i))&&(this.text=t,this.title=n,this.highlights=i,this.render())}render(){let t=[],i=0;for(let n of this.highlights){if(n.end===n.start)continue;if(i<n.start){let a=this.text.substring(i,n.start);this.supportIcons?t.push(...Es(a)):t.push(a),i=n.start}let o=this.text.substring(i,n.end),s=he("span.highlight",void 0,...this.supportIcons?Es(o):[o]);n.extraClasses&&s.classList.add(...n.extraClasses),t.push(s),i=n.end}if(i<this.text.length){let n=this.text.substring(i);this.supportIcons?t.push(...Es(n)):t.push(n)}if(gn(this.domNode,...t),this.options?.hoverDelegate?.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){let n=this.options?.hoverDelegate??Dt("mouse");this.customHover=this._register(tn().setupManagedHover(n,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(t,i){let n=0,o=0;return t.replace(/\r\n|\r|\n/g,(s,a)=>{o=s===`\r
`?-1:0,a+=n;for(let l of i)l.end<=a||(l.start>=a&&(l.start+=o),l.end>=a&&(l.end+=o));return n+=o,"\u23CE"})}};var em=class{constructor(e){this._element=e}disposed;_textContent;_classNames;_empty;get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||fi(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}},_R=class extends P{creationOptions;domNode;nameContainer;nameNode;descriptionNode;suffixNode;labelContainer;hoverDelegate;customHovers=new Map;constructor(e,t){super(),this.creationOptions=t,this.domNode=this._register(new em(ye(e,he(".monaco-icon-label")))),this.labelContainer=ye(this.domNode.element,he(".monaco-icon-label-container")),this.nameContainer=ye(this.labelContainer,he("span.monaco-icon-name-container")),t?.supportHighlights||t?.supportIcons?this.nameNode=this._register(new wV(this.nameContainer,!!t.supportIcons)):this.nameNode=new EV(this.nameContainer),this.hoverDelegate=t?.hoverDelegate??Dt("mouse")}get element(){return this.domNode.element}setLabel(e,t,i){let n=["monaco-icon-label"],o=["monaco-icon-label-container"],s="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&o.push("disabled"),i.title&&(typeof i.title=="string"?s+=i.title:s+=e));let a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i?.iconPath){let l;!a||!ki(a)?(l=he(".monaco-icon-label-iconpath"),this.domNode.element.prepend(l)):l=a,l.style.backgroundImage=El(i?.iconPath)}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",s),this.labelContainer.classList.value="",this.labelContainer.classList.add(...o),this.setupHover(i?.descriptionTitle?this.labelContainer:this.element,i?.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){let l=this.getOrCreateDescriptionNode();l instanceof np?(l.set(t||"",i?i.descriptionMatches:void 0,void 0,i?.labelEscapeNewLines),this.setupHover(l.element,i?.descriptionTitle)):(l.textContent=t&&i?.labelEscapeNewLines?np.escapeNewLines(t,[]):t||"",this.setupHover(l.element,i?.descriptionTitle||""),l.empty=!t)}if(i?.suffix||this.suffixNode){let l=this.getOrCreateSuffixNode();l.textContent=i?.suffix??""}}setupHover(e,t){let i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover){let o=function(s,a){Wi(a)?s.title=S1(a):a?.markdownNotSupportedFallback?s.title=a.markdownNotSupportedFallback:s.removeAttribute("title")};var n=o;o(e,t)}else{let o=tn().setupManagedHover(this.hoverDelegate,e,t);o&&this.customHovers.set(e,o)}}dispose(){super.dispose();for(let e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){let e=this._register(new em(fE(this.nameContainer,he("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new em(ye(e.element,he("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){if(!this.descriptionNode){let e=this._register(new em(ye(this.labelContainer,he("span.monaco-icon-description-container"))));this.creationOptions?.supportDescriptionHighlights?this.descriptionNode=this._register(new np(ye(e.element,he("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new em(ye(e.element,he("span.label-description"))))}return this.descriptionNode}},EV=class{constructor(e){this.container=e}label=void 0;singleLabel=void 0;options;setLabel(e,t){if(!(this.label===e&&fi(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=ye(this.container,he("a.label-name",{id:t?.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){let n=e[i],o=t?.domId&&`${t?.domId}_${i}`;ye(this.container,he("a.label-name",{id:o,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},n)),i<e.length-1&&ye(this.container,he("span.label-separator",void 0,t?.separator||"/"))}}}};function lee(r,e,t){if(!t)return;let i=0;return r.map(n=>{let o={start:i,end:i+n.length},s=t.map(a=>qn.intersect(o,a)).filter(a=>!qn.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=o.end+e.length,s})}var wV=class extends P{constructor(t,i){super();this.container=t;this.supportIcons=i}label=void 0;singleLabel=void 0;options;setLabel(t,i){if(!(this.label===t&&fi(this.options,i)))if(this.label=t,this.options=i,typeof t=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new np(ye(this.container,he("a.label-name",{id:i?.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(t,i?.matches,void 0,i?.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;let n=i?.separator||"/",o=lee(t,n,i?.matches);for(let s=0;s<t.length;s++){let a=t[s],l=o?o[s]:void 0,d=i?.domId&&`${i?.domId}_${s}`,c=he("a.label-name",{id:d,"data-icon-label-count":t.length,"data-icon-label-index":s,role:"treeitem"});this._register(new np(ye(this.container,c),{supportIcons:this.supportIcons})).set(a,l,void 0,i?.labelEscapeNewLines),s<t.length-1&&ye(c,he("span.label-separator",void 0,n))}}}};var DR=Z("IFileDecorationsService");var TV=Z("notebookDocumentService"),dee=["W","X","Y","Z","a","b","c","d","e","f"],cee=new RegExp(`^[${dee.join("")}]+`),uee=7;function pee(r){if(r.scheme!==ue.vscodeNotebookCell)return;let e=r.fragment.indexOf("s");if(e<0)return;let t=parseInt(r.fragment.substring(0,e).replace(cee,""),uee),i=qH(r.fragment.substring(e+1)).toString();if(!isNaN(t))return{handle:t,notebook:r.with({scheme:i,fragment:null})}}var xV=class{_documents=new Cn;getNotebook(e){if(e.scheme===ue.vscodeNotebookCell){let t=pee(e);if(t){let i=this._documents.get(t.notebook);if(i)return i}}return this._documents.get(e)}addNotebookDocument(e){this._documents.set(e.uri,e)}removeNotebookDocument(e){this._documents.delete(e.uri)}};an(TV,xV,1);function fd(r){if(!(!r||!r.resource))return X.isUri(r.resource)?r.resource:r.resource.primary}var tm={onDidChangeVisibility:z.None},Ws=class extends P{constructor(t,i,n,o,s,a,l,d,c,u){super();this.instantiationService=i;this.configurationService=n;this.modelService=o;this.workspaceService=s;this.languageService=a;this.decorationsService=l;this.themeService=d;this.labelService=c;this.textFileService=u;this.registerListeners(t)}_onDidChangeDecorations=this._register(new _);onDidChangeDecorations=this._onDidChangeDecorations.event;widgets=[];labels=[];registerListeners(t){this._register(t.onDidChangeVisibility(i=>{this.widgets.forEach(n=>n.notifyVisibilityChanged(i))})),this._register(this.languageService.onDidChange(()=>this.widgets.forEach(i=>i.notifyExtensionsRegistered()))),this._register(this.modelService.onModelLanguageChanged(i=>{i.model.uri&&this.widgets.forEach(n=>n.notifyModelLanguageChanged(i.model))})),this._register(this.modelService.onModelAdded(i=>{i.uri&&this.widgets.forEach(n=>n.notifyModelAdded(i))})),this._register(this.workspaceService.onDidChangeWorkspaceFolders(()=>{this.widgets.forEach(i=>i.notifyWorkspaceFoldersChange())})),this._register(this.decorationsService.onDidChangeDecorations(i=>{let n=!1;this.widgets.forEach(o=>{o.notifyFileDecorationsChanges(i)&&(n=!0)}),n&&this._onDidChangeDecorations.fire()})),this._register(this.themeService.onDidColorThemeChange(()=>this.widgets.forEach(i=>i.notifyThemeChange()))),this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(iz)&&this.widgets.forEach(n=>n.notifyFileAssociationsChange())})),this._register(this.labelService.onDidChangeFormatters(i=>{this.widgets.forEach(n=>n.notifyFormattersChange(i.scheme))})),this._register(this.textFileService.untitled.onDidChangeLabel(i=>{this.widgets.forEach(n=>n.notifyUntitledLabelChange(i.resource))}))}get(t){return this.labels[t]}create(t,i){let n=this.instantiationService.createInstance(QC,t,i),o={element:n.element,onDidRender:n.onDidRender,setLabel:(s,a,l)=>n.setLabel(s,a,l),setResource:(s,a)=>n.setResource(s,a),setFile:(s,a)=>n.setFile(s,a),clear:()=>n.clear(),dispose:()=>this.disposeWidget(n)};return this.labels.push(o),this.widgets.push(n),o}disposeWidget(t){let i=this.widgets.indexOf(t);i>-1&&(this.widgets.splice(i,1),this.labels.splice(i,1)),ht(t)}clear(){this.widgets=ht(this.widgets),this.labels=[]}dispose(){super.dispose(),this.clear()}};Ws=R([y(1,ve),y(2,He),y(3,Qn),y(4,bi),y(5,Ki),y(6,DR),y(7,kt),y(8,na),y(9,jl)],Ws);var Nb=class extends Ws{label;get element(){return this.label}constructor(e,t,i,n,o,s,a,l,d,c,u){super(tm,i,n,o,s,a,l,d,c,u),this.label=this._register(this.create(e,t))}};Nb=R([y(2,ve),y(3,He),y(4,Qn),y(5,bi),y(6,Ki),y(7,DR),y(8,kt),y(9,na),y(10,jl)],Nb);var QC=class extends _R{constructor(t,i,n,o,s,a,l,d,c){super(t,i);this.languageService=n;this.modelService=o;this.decorationsService=s;this.labelService=a;this.textFileService=l;this.contextService=d;this.notebookDocumentService=c}_onDidRender=this._register(new _);onDidRender=this._onDidRender.event;label=void 0;decoration=this._register(new xt);options=void 0;computedIconClasses=void 0;computedLanguageId=void 0;computedPathLabel=void 0;computedWorkspaceFolderLabel=void 0;needsRedraw=void 0;isHidden=!1;notifyVisibilityChanged(t){t===this.isHidden&&(this.isHidden=!t,t&&this.needsRedraw&&(this.render({updateIcon:this.needsRedraw===2,updateDecoration:this.needsRedraw===2}),this.needsRedraw=void 0))}notifyModelLanguageChanged(t){this.handleModelEvent(t)}notifyModelAdded(t){this.handleModelEvent(t)}handleModelEvent(t){let i=fd(this.label);i&&Li(t.uri,i)&&this.computedLanguageId!==t.getLanguageId()&&(this.computedLanguageId=t.getLanguageId(),this.render({updateIcon:!0,updateDecoration:!1}))}notifyFileDecorationsChanges(t){if(!this.options)return!1;let i=fd(this.label);return i&&this.options.fileDecorations&&t.affectsResource(i)?this.render({updateIcon:!1,updateDecoration:!0}):!1}notifyExtensionsRegistered(){this.render({updateIcon:!0,updateDecoration:!1})}notifyThemeChange(){this.render({updateIcon:!1,updateDecoration:!1})}notifyFileAssociationsChange(){this.render({updateIcon:!0,updateDecoration:!1})}notifyFormattersChange(t){fd(this.label)?.scheme===t&&this.render({updateIcon:!1,updateDecoration:!1})}notifyUntitledLabelChange(t){Li(t,fd(this.label))&&this.render({updateIcon:!1,updateDecoration:!1})}notifyWorkspaceFoldersChange(){if(typeof this.computedWorkspaceFolderLabel=="string"){let t=fd(this.label);X.isUri(t)&&this.label?.name===this.computedWorkspaceFolderLabel&&this.setFile(t,this.options)}}setFile(t,i){let n=i?.hideLabel,o;if(!n){if(i?.fileKind===2){let a=this.contextService.getWorkspaceFolder(t);a&&(o=a.name,this.computedWorkspaceFolderLabel=o)}o||(o=HO(Fc(t)))}let s;if(!i?.hidePath){let a=this.labelService.getUriLabel(Gs(t),{relative:!0});a&&a!=="."&&(s=a)}this.setResource({resource:t,name:o,description:s,range:i?.range},i)}setResource(t,i=Object.create(null)){let n=fd(t),o=t?.resource&&!X.isUri(t.resource);if(!i.forceLabel&&!o&&n?.scheme===ue.untitled){let c=this.textFileService.untitled.get(n);if(c&&!c.hasAssociatedFilePath){if(typeof t.name=="string"&&(t.name=c.name),typeof t.description=="string"){let p=c.resource.path;t.name!==p?t.description=p:t.description=void 0}let u=c.resource.path;c.name!==u?i.title=`${c.name} \u2022 ${u}`:i.title=u}}if(!i.forceLabel&&!o&&n?.scheme===ue.vscodeNotebookCell){let c=this.notebookDocumentService.getNotebook(n),u=c?.getCellIndex(n);c&&u!==void 0&&typeof t.name=="string"&&(i.title=h("notebookCellLabel","{0} \u2022 Cell {1}",t.name,`${u+1}`)),typeof t.name=="string"&&c&&u!==void 0&&typeof t.name=="string"&&(t.name=h("notebookCellLabel","{0} \u2022 Cell {1}",t.name,`${u+1}`))}let s=this.hasResourceChanged(t),a=s||this.hasPathLabelChanged(t),l=this.hasFileKindChanged(i),d=this.hasIconChanged(i);this.label=t,this.options=i,s&&(this.computedLanguageId=void 0),a&&(this.computedPathLabel=void 0),this.render({updateIcon:s||l||d,updateDecoration:s||l})}hasFileKindChanged(t){let i=t?.fileKind,n=this.options?.fileKind;return i!==n}hasResourceChanged(t){let i=fd(t),n=fd(this.label);return i&&n?i.toString()!==n.toString():!(!i&&!n)}hasPathLabelChanged(t){let i=fd(t);return!!i&&this.computedPathLabel!==this.labelService.getUriLabel(i)}hasIconChanged(t){return this.options?.icon!==t?.icon}clear(){this.label=void 0,this.options=void 0,this.computedLanguageId=void 0,this.computedIconClasses=void 0,this.computedPathLabel=void 0,this.setLabel("")}render(t){if(this.isHidden)return this.needsRedraw!==2&&(this.needsRedraw=t.updateIcon||t.updateDecoration?2:1),!1;if(t.updateIcon&&(this.computedIconClasses=void 0),!this.label)return!1;let i={title:"",italic:this.options?.italic,strikethrough:this.options?.strikethrough,matches:this.options?.matches,descriptionMatches:this.options?.descriptionMatches,extraClasses:[],separator:this.options?.separator,domId:this.options?.domId,disabledCommand:this.options?.disabledCommand,labelEscapeNewLines:this.options?.labelEscapeNewLines,descriptionTitle:this.options?.descriptionTitle},n=fd(this.label);if(this.options?.title!==void 0&&(i.title=this.options.title),n&&n.scheme!==ue.data&&(!this.options?.title||typeof this.options.title!="string"&&!this.options.title.markdownNotSupportedFallback)&&(this.computedPathLabel||(this.computedPathLabel=this.labelService.getUriLabel(n)),!i.title||typeof i.title=="string"?i.title=this.computedPathLabel:i.title.markdownNotSupportedFallback||(i.title.markdownNotSupportedFallback=this.computedPathLabel)),this.options&&!this.options.hideIcon&&(this.computedIconClasses||(this.computedIconClasses=H_(this.modelService,this.languageService,n,this.options.fileKind,this.options.icon)),X.isUri(this.options.icon)&&(i.iconPath=this.options.icon),i.extraClasses=this.computedIconClasses.slice(0)),this.options?.extraClasses&&i.extraClasses.push(...this.options.extraClasses),this.options?.fileDecorations&&n){t.updateDecoration&&(this.decoration.value=this.decorationsService.getDecoration(n,this.options.fileKind!==0));let o=this.decoration.value;if(o){if(o.tooltip){if(typeof i.title=="string")i.title=`${i.title} \u2022 ${o.tooltip}`;else if(typeof i.title?.markdown=="string"){let s=`${i.title.markdown} \u2022 ${o.tooltip}`;i.title={markdown:s,markdownNotSupportedFallback:s}}}o.strikethrough&&(i.strikethrough=!0),this.options.fileDecorations.colors&&i.extraClasses.push(o.labelClassName),this.options.fileDecorations.badges&&(i.extraClasses.push(o.badgeClassName),i.extraClasses.push(o.iconClassName))}}return this.label.range&&(i.suffix=this.label.range.startLineNumber!==this.label.range.endLineNumber?`:${this.label.range.startLineNumber}-${this.label.range.endLineNumber}`:`:${this.label.range.startLineNumber}`),this.setLabel(this.label.name??"",this.label.description,i),this._onDidRender.fire(),!0}dispose(){super.dispose(),this.label=void 0,this.options=void 0,this.computedLanguageId=void 0,this.computedIconClasses=void 0,this.computedPathLabel=void 0,this.computedWorkspaceFolderLabel=void 0}};QC=R([y(2,Ki),y(3,Qn),y(4,DR),y(5,na),y(6,jl),y(7,bi),y(8,TV)],QC);var m4i=Z("workspaceTrustEnablementService"),RK=Z("workspaceTrustManagementService");var g4i=Z("workspaceTrustRequestService");var LR=class{constructor(e){this._container=e}hover;set text(e){gn(this._container,...Es(e??""))}set title(e){!this.hover&&e?this.hover=tn().setupManagedHover(Dt("mouse"),this._container,e):this.hover&&this.hover.update(e)}dispose(){this.hover?.dispose()}};var bc=class extends od{static PLACEHOLDER_LABEL_MAX_LENGTH=1024;container;scrollbar;inputDisposable=this._register(new xt);constructor(e,t,i,n,o){super(e,t,i,n,o)}createEditor(e){this.container=document.createElement("div"),this.container.className="monaco-editor-pane-placeholder",this.container.style.outline="none",this.container.tabIndex=0,this.scrollbar=this._register(new Ys(this.container,{horizontal:1,vertical:1})),e.appendChild(this.scrollbar.getDomNode())}async setInput(e,t,i,n){await super.setInput(e,t,i,n),!n.isCancellationRequested&&(this.inputDisposable.value=await this.renderInput(e,t))}async renderInput(e,t){let[i,n]=Cl(this.container,this.scrollbar);Xt(i);let o=new Y,{icon:s,label:a,actions:l}=await this.getContents(e,t,o),d=jW(a,bc.PLACEHOLDER_LABEL_MAX_LENGTH),c=i.appendChild(he(".editor-placeholder-icon-container")),u=o.add(new LR(c));u.text=s;let p=i.appendChild(he(".editor-placeholder-label-container")),m=document.createElement("span");if(m.textContent=d,p.appendChild(m),i.setAttribute("aria-label",`${If(e,void 0,this.group,void 0)}, ${d}`),l.length){let f=i.appendChild(he(".editor-placeholder-buttons-container")),g=o.add(new II(f));for(let b=0;b<l.length;b++){let v=o.add(g.addButton({...b_,secondary:b!==0}));v.label=l[b].label,o.add(v.onDidClick(I=>{I&&Oe.stop(I,!0),l[b].run()}))}}return n.scanDomNode(),o}clearInput(){this.container&&Xt(this.container),this.inputDisposable.clear(),super.clearInput()}layout(e){let[t,i]=Cl(this.container,this.scrollbar);i1(t,e.width,e.height),i.scanDomNode(),t.classList.toggle("max-height-200px",e.height<=200)}focus(){super.focus(),this.container?.focus()}dispose(){this.container?.remove(),super.dispose()}};bc=R([y(2,jt),y(3,kt),y(4,Ii)],bc);var bd=class extends bc{constructor(t,i,n,o,s,a){super(bd.ID,t,i,n,a);this.commandService=o;this.workspaceService=s}static ID="workbench.editors.workspaceTrustRequiredEditor";static LABEL=h("trustRequiredEditor","Workspace Trust Required");static DESCRIPTOR=MI.create(bd,this.ID,this.LABEL);getTitle(){return bd.LABEL}async getContents(){return{icon:"$(workspace-untrusted)",label:Xm(cU(this.workspaceService.getWorkspace()))?h("requiresFolderTrustText","The file is not displayed in the editor because trust has not been granted to the folder."):h("requiresWorkspaceTrustText","The file is not displayed in the editor because trust has not been granted to the workspace."),actions:[{label:h("manageTrust","Manage Workspace Trust"),run:()=>this.commandService.executeCommand("workbench.trust.manage")}]}}};bd=R([y(1,jt),y(2,kt),y(3,Ui),y(4,bi),y(5,Ii)],bd);var vc=class extends bc{constructor(t,i,n,o,s,a){super(vc.ID,t,i,n,o);this.fileService=s;this.dialogService=a}static ID="workbench.editors.errorEditor";static LABEL=h("errorEditor","Error Editor");static DESCRIPTOR=MI.create(vc,this.ID,this.LABEL);async getContents(t,i,n){let o=t.resource,s=i.error,a=s?.fileOperationResult===1,l;a?l=h("unavailableResourceErrorEditorText","The editor could not be opened because the file was not found."):nh(s)&&s.forceMessage?l=s.message:s?l=h("unknownErrorEditorTextWithError","The editor could not be opened due to an unexpected error: {0}",qW(os(s),bc.PLACEHOLDER_LABEL_MAX_LENGTH/2)):l=h("unknownErrorEditorTextWithoutError","The editor could not be opened due to an unexpected error.");let d="$(error)";nh(s)&&(s.forceSeverity===zi.Info?d="$(info)":s.forceSeverity===zi.Warning&&(d="$(warning)"));let c;return nh(s)&&s.actions.length>0?c=s.actions.map(u=>({label:u.label,run:()=>{let p=u.run();p instanceof Promise&&p.catch(m=>this.dialogService.error(os(m)))}})):c=[{label:h("retry","Try Again"),run:()=>this.group.openEditor(t,{...i,source:1})}],a&&o&&this.fileService.hasProvider(o)&&n.add(this.fileService.onDidFilesChange(u=>{u.contains(o,1,0)&&this.group.openEditor(t,i)})),{icon:d,label:l,actions:c??[]}}};vc=R([y(1,jt),y(2,kt),y(3,Ii),y(4,Lt),y(5,Io)],vc);var Fb=class extends P{constructor(t,i,n,o,s,a,l,d,c,u){super();this.editorGroupParent=t;this.editorPanesParent=i;this.groupView=n;this.layoutService=o;this.instantiationService=s;this.editorProgressService=a;this.workspaceTrustService=l;this.logService=d;this.dialogService=c;this.hostService=u;this.registerListeners()}_onDidFocus=this._register(new _);onDidFocus=this._onDidFocus.event;_onDidChangeSizeConstraints=this._register(new _);onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event;get minimumWidth(){return this._activeEditorPane?.minimumWidth??Ya.width}get minimumHeight(){return this._activeEditorPane?.minimumHeight??Ya.height}get maximumWidth(){return this._activeEditorPane?.maximumWidth??yf.width}get maximumHeight(){return this._activeEditorPane?.maximumHeight??yf.height}_activeEditorPane=null;get activeEditorPane(){return this._activeEditorPane}editorPanes=[];mapEditorPaneToPendingSetInput=new Map;activeEditorPaneDisposables=this._register(new Y);pagePosition;boundarySashes;editorOperation=this._register(new nT(this.editorProgressService));editorPanesRegistry=ze.as(ks.EditorPane);registerListeners(){this._register(this.workspaceTrustService.onDidChangeTrust(()=>this.onDidChangeWorkspaceTrust()))}onDidChangeWorkspaceTrust(){let t=this._activeEditorPane?.input,i=this._activeEditorPane?.options;t?.hasCapability(16)&&this.groupView.openEditor(t,i)}async openEditor(t,i,n,o=Object.create(null)){try{return await this.doOpenEditor(this.getEditorPaneDescriptor(t),t,i,n,o)}catch(s){return i?.ignoreError?{error:s}:this.doShowError(s,t,i,n,o)}}async doShowError(t,i,n,o,s){this.logService.error(t);let a=!1;if(n?.source===1&&(!nh(t)||t.allowDialog)&&(a=await this.doShowErrorDialog(t,i)),a)return{error:t};let l={...n};return wc(t)||(l.error=t),{...await this.doOpenEditor(vc.DESCRIPTOR,i,l,o,s),error:t}}async doShowErrorDialog(t,i){let n=zi.Error,o,s=os(t),a;nh(t)&&(a=t.actions,n=t.forceSeverity??zi.Error,t.forceMessage&&(o=t.message,s=void 0)),o||(o=h("editorOpenErrorDialog","Unable to open '{0}'",i.getName()));let l=[];if(a&&a.length>0)for(let p of a)l.push({label:p.label,run:()=>p});else l.push({label:h({key:"ok",comment:["&& denotes a mnemonic"]},"&&OK"),run:()=>{}});let d;l.length===1&&(d={run:()=>{c=!0}});let c=!1,{result:u}=await this.dialogService.prompt({type:n,message:o,detail:s,buttons:l,cancelButton:d});if(u){let p=u.run();p instanceof Promise&&p.catch(m=>this.dialogService.error(os(m))),c=!0}return c}async doOpenEditor(t,i,n,o,s=Object.create(null)){let a=this.doShowEditorPane(t),l=mn(),{changed:d,cancelled:c}=await this.doSetInput(a,i,n,s);return c||((!n||!n.preserveFocus)&&this.shouldRestoreFocus(l)?a.focus():o?.preserveWindowOrder||this.hostService.moveTop(Bd(this.groupView.windowId,!0).window)),{pane:a,changed:d,cancelled:c}}shouldRestoreFocus(t){if(!this.layoutService.isRestored()||!t)return!0;let i=mn();return!!(!i||i===t.ownerDocument.body||t===i||!Gr(i)||An(i,this.editorGroupParent))}getEditorPaneDescriptor(t){return t.hasCapability(16)&&!this.workspaceTrustService.isWorkspaceTrusted()?bd.DESCRIPTOR:at(this.editorPanesRegistry.getEditorPane(t))}doShowEditorPane(t){if(this._activeEditorPane&&t.describes(this._activeEditorPane))return this._activeEditorPane;this.doHideActiveEditorPane();let i=this.doCreateEditorPane(t);this.doSetActiveEditorPane(i);let n=at(i.getContainer());return this.editorPanesParent.appendChild(n),kp(n),i.setVisible(!0),this.pagePosition&&i.layout(new At(this.pagePosition.width,this.pagePosition.height),{top:this.pagePosition.top,left:this.pagePosition.left}),this.boundarySashes&&i.setBoundarySashes(this.boundarySashes),i}doCreateEditorPane(t){let i=this.doInstantiateEditorPane(t);if(!i.getContainer()){let n=document.createElement("div");n.classList.add("editor-instance"),this.editorPanesParent.appendChild(n),i.create(n)}return i}doInstantiateEditorPane(t){let i=this.editorPanes.find(o=>t.describes(o));if(i)return i;let n=this._register(t.instantiate(this.instantiationService,this.groupView));return this.editorPanes.push(n),n}doSetActiveEditorPane(t){this._activeEditorPane=t,this.activeEditorPaneDisposables.clear(),t&&(this.activeEditorPaneDisposables.add(t.onDidChangeSizeConstraints(i=>this._onDidChangeSizeConstraints.fire(i))),this.activeEditorPaneDisposables.add(t.onDidFocus(()=>this._onDidFocus.fire()))),this._onDidChangeSizeConstraints.fire(void 0)}async doSetInput(t,i,n,o){let s=t.input?.matches(i);if(s&&!n?.forceReload)return this.mapEditorPaneToPendingSetInput.has(t)&&await this.mapEditorPaneToPendingSetInput.get(t),s=t.input?.matches(i),s&&t.setOptions(n),{changed:!1,cancelled:!s};let a=this.editorOperation.start(this.layoutService.isRestored()?800:3200),l=!1;try{t.clearInput();let d=t.setInput(i,n,o,a.token);this.mapEditorPaneToPendingSetInput.set(t,d),await d,a.isCurrent()||(l=!0)}catch(d){if(!a.isCurrent())l=!0;else throw d}finally{a.isCurrent()&&this.mapEditorPaneToPendingSetInput.delete(t),a.stop()}return{changed:!s,cancelled:l}}doHideActiveEditorPane(){if(!this._activeEditorPane)return;this.editorOperation.stop(),this.safeRun(()=>this._activeEditorPane?.clearInput()),this.safeRun(()=>this._activeEditorPane?.setVisible(!1)),this.mapEditorPaneToPendingSetInput.delete(this._activeEditorPane);let t=this._activeEditorPane.getContainer();t&&(t.remove(),Mm(t)),this.doSetActiveEditorPane(null)}closeEditor(t){this._activeEditorPane?.input&&t.matches(this._activeEditorPane.input)&&this.doHideActiveEditorPane()}setVisible(t){this.safeRun(()=>this._activeEditorPane?.setVisible(t))}layout(t){this.pagePosition=t,this.safeRun(()=>this._activeEditorPane?.layout(new At(t.width,t.height),t))}setBoundarySashes(t){this.boundarySashes=t,this.safeRun(()=>this._activeEditorPane?.setBoundarySashes(t))}safeRun(t){try{t()}catch(i){this.logService.error(i)}}};Fb=R([y(3,$a),y(4,ve),y(5,Ug),y(6,RK),y(7,Oi),y(8,Io),y(9,eo)],Fb);var AK=[],mee=[],gee=[];function OK(r,e){return fee(r,e).map(t=>t.mime)}function fee(r,e){let t;if(r)switch(r.scheme){case ue.file:t=r.fsPath;break;case ue.data:{t=Pd.parseMetaData(r).get(Pd.META_DATA_LABEL);break}case ue.vscodeNotebookCell:t=void 0;break;default:t=r.path}if(!t)return[{id:"unknown",mime:zo.unknown}];t=t.toLowerCase();let i=ba(t),n=MK(t,i,gee);if(n)return[n,{id:xr,mime:zo.text}];let o=MK(t,i,mee);if(o)return[o,{id:xr,mime:zo.text}];if(e){let s=bee(e);if(s)return[s,{id:xr,mime:zo.text}]}return[{id:"unknown",mime:zo.unknown}]}function MK(r,e,t){let i,n,o;for(let s=t.length-1;s>=0;s--){let a=t[s];if(e===a.filenameLowercase){i=a;break}if(a.filepattern&&(!n||a.filepattern.length>n.filepattern.length)){let l=a.filepatternOnPath?r:e;a.filepatternLowercase?.(l)&&(n=a)}a.extension&&(!o||a.extension.length>o.extension.length)&&e.endsWith(a.extensionLowercase)&&(o=a)}if(i)return i;if(n)return n;if(o)return o}function bee(r){if(US(r)&&(r=r.substr(1)),r.length>0)for(let e=AK.length-1;e>=0;e--){let t=AK[e];if(!t.firstline)continue;let i=r.match(t.firstline);if(i&&i.length>0)return t}}x("editorWatermark.foreground",{dark:Ce(Dr,.6),light:Ce(Dr,.68),hcDark:Dr,hcLight:Dr},h("editorLineHighlight","Foreground color for the labels in the editor watermark."));var FK={text:h("watermark.showCommands","Show All Commands"),id:"workbench.action.showCommands"},vee={text:h("watermark.quickAccess","Go to File"),id:"workbench.action.quickOpen"},yee={text:h("watermark.openFile","Open File"),id:"workbench.action.files.openFile",mac:!1},Iee={text:h("watermark.openFolder","Open Folder"),id:"workbench.action.files.openFolder",mac:!1},Cee={text:h("watermark.openFileFolder","Open File or Folder"),id:"workbench.action.files.openFileFolder",mac:!0},See={text:h("watermark.openRecent","Open Recent"),id:"workbench.action.openRecent"},Eee={text:h("watermark.newUntitledFile","New Untitled Text File"),id:"workbench.action.files.newUntitledFile",mac:!0},wee={text:h("watermark.findInFiles","Find in Files"),id:"workbench.action.findInFiles"},xee={text:h({key:"watermark.toggleTerminal",comment:["toggle is a verb here"]},"Toggle Terminal"),id:"workbench.action.terminal.toggleTerminal",when:Ue.equals("terminalProcessSupported",!0)},Tee={text:h("watermark.startDebugging","Start Debugging"),id:"workbench.action.debug.start",when:Ue.equals("terminalProcessSupported",!0)},_ee={text:h({key:"watermark.toggleFullscreen",comment:["toggle is a verb here"]},"Toggle Full Screen"),id:"workbench.action.toggleFullScreen"},Dee={text:h("watermark.showSettings","Show Settings"),id:"workbench.action.openSettings"},PK=[FK,yee,Iee,Cee,See,Eee],NK=[FK,vee,wee,Tee,xee,_ee,Dee],Bb=class extends P{constructor(t,i,n,o,s){super();this.keybindingService=i;this.contextService=n;this.contextKeyService=o;this.configurationService=s;let a=Tt(".editor-group-watermark",[Tt(".letterpress"),Tt(".shortcuts@shortcuts")]);ye(t,a.root),this.shortcuts=a.shortcuts,this.registerListeners(),this.workbenchState=n.getWorkbenchState(),this.render()}shortcuts;transientDisposables=this._register(new Y);enabled=!1;workbenchState;keybindingLabels=new Set;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(n=>{n.affectsConfiguration("workbench.tips.enabled")&&this.render()})),this._register(this.contextService.onDidChangeWorkbenchState(n=>{this.workbenchState!==n&&(this.workbenchState=n,this.render())}));let t=[...PK,...NK].filter(n=>n.when!==void 0).map(n=>n.when),i=new Set;t.forEach(n=>n.keys().forEach(o=>i.add(o))),this._register(this.contextKeyService.onDidChangeContext(n=>{n.affectsSome(i)&&this.render()}))}render(){let t=this.configurationService.getValue("workbench.tips.enabled");if(t===this.enabled||(this.enabled=t,this.clear(),!t))return;let i=ye(this.shortcuts,he(".watermark-box")),o=(this.workbenchState!==1?NK:PK).filter(a=>!("when"in a)||this.contextKeyService.contextMatchesRules(a.when)).filter(a=>!("mac"in a)||a.mac===(ke&&!on)).filter(a=>!!Nn.getCommand(a.id)).filter(a=>!!this.keybindingService.lookupKeybinding(a.id)),s=()=>{Xt(i),this.keybindingLabels.forEach(a=>a.dispose()),this.keybindingLabels.clear();for(let a of o){let l=this.keybindingService.lookupKeybinding(a.id);if(!l)continue;let d=ye(i,he("dl")),c=ye(d,he("dt"));c.textContent=a.text;let u=ye(d,he("dd")),p=new h_(u,nr,{renderUnboundKeybindings:!0,...l7});p.set(l),this.keybindingLabels.add(p)}};s(),this.transientDisposables.add(this.keybindingService.onDidUpdateKeybindings(s))}clear(){Xt(this.shortcuts),this.transientDisposables.clear()}dispose(){super.dispose(),this.clear(),this.keybindingLabels.forEach(t=>t.dispose())}};Bb=R([y(1,qt),y(2,bi),y(3,je),y(4,He)],Bb);var nl=Z("IEditorBreadcrumbsService"),_V=class{_map=new Map;register(e,t){if(this._map.has(e))throw new Error(`group (${e}) has already a widget`);return this._map.set(e,t),{dispose:()=>this._map.delete(e)}}getWidget(e){return this._map.get(e)}};an(nl,_V,1);var Or=class r{constructor(){}static IsEnabled=r._stub("breadcrumbs.enabled");static UseQuickPick=r._stub("breadcrumbs.useQuickPick");static FilePath=r._stub("breadcrumbs.filePath");static SymbolPath=r._stub("breadcrumbs.symbolPath");static SymbolSortOrder=r._stub("breadcrumbs.symbolSortOrder");static Icons=r._stub("breadcrumbs.icons");static TitleScrollbarSizing=r._stub("workbench.editor.titleScrollbarSizing");static FileExcludes=r._stub("files.exclude");static _stub(e){return{bindTo(t){let i=new _,n=t.onDidChangeConfiguration(o=>{o.affectsConfiguration(e)&&i.fire(void 0)});return new class{name=e;onDidChange=i.event;getValue(o){return o?t.getValue(e,o):t.getValue(e)}updateValue(o,s){return s?t.updateValue(e,o,s):t.updateValue(e,o)}dispose(){n.dispose(),i.dispose()}}}}}};ze.as($r.Configuration).registerConfiguration({id:"breadcrumbs",title:h("title","Breadcrumb Navigation"),order:101,type:"object",properties:{"breadcrumbs.enabled":{description:h("enabled","Enable/disable navigation breadcrumbs."),type:"boolean",default:!0},"breadcrumbs.filePath":{description:h("filepath","Controls whether and how file paths are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[h("filepath.on","Show the file path in the breadcrumbs view."),h("filepath.off","Do not show the file path in the breadcrumbs view."),h("filepath.last","Only show the last element of the file path in the breadcrumbs view.")]},"breadcrumbs.symbolPath":{description:h("symbolpath","Controls whether and how symbols are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[h("symbolpath.on","Show all symbols in the breadcrumbs view."),h("symbolpath.off","Do not show symbols in the breadcrumbs view."),h("symbolpath.last","Only show the current symbol in the breadcrumbs view.")]},"breadcrumbs.symbolSortOrder":{description:h("symbolSortOrder","Controls how symbols are sorted in the breadcrumbs outline view."),type:"string",default:"position",scope:5,enum:["position","name","type"],enumDescriptions:[h("symbolSortOrder.position","Show symbol outline in file position order."),h("symbolSortOrder.name","Show symbol outline in alphabetical order."),h("symbolSortOrder.type","Show symbol outline in symbol type order.")]},"breadcrumbs.icons":{description:h("icons","Render breadcrumb items with icons."),type:"boolean",default:!0},"breadcrumbs.showFiles":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.file","When enabled breadcrumbs show `file`-symbols.")},"breadcrumbs.showModules":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.module","When enabled breadcrumbs show `module`-symbols.")},"breadcrumbs.showNamespaces":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.namespace","When enabled breadcrumbs show `namespace`-symbols.")},"breadcrumbs.showPackages":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.package","When enabled breadcrumbs show `package`-symbols.")},"breadcrumbs.showClasses":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.class","When enabled breadcrumbs show `class`-symbols.")},"breadcrumbs.showMethods":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.method","When enabled breadcrumbs show `method`-symbols.")},"breadcrumbs.showProperties":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.property","When enabled breadcrumbs show `property`-symbols.")},"breadcrumbs.showFields":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.field","When enabled breadcrumbs show `field`-symbols.")},"breadcrumbs.showConstructors":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.constructor","When enabled breadcrumbs show `constructor`-symbols.")},"breadcrumbs.showEnums":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.enum","When enabled breadcrumbs show `enum`-symbols.")},"breadcrumbs.showInterfaces":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.interface","When enabled breadcrumbs show `interface`-symbols.")},"breadcrumbs.showFunctions":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.function","When enabled breadcrumbs show `function`-symbols.")},"breadcrumbs.showVariables":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.variable","When enabled breadcrumbs show `variable`-symbols.")},"breadcrumbs.showConstants":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.constant","When enabled breadcrumbs show `constant`-symbols.")},"breadcrumbs.showStrings":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.string","When enabled breadcrumbs show `string`-symbols.")},"breadcrumbs.showNumbers":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.number","When enabled breadcrumbs show `number`-symbols.")},"breadcrumbs.showBooleans":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.boolean","When enabled breadcrumbs show `boolean`-symbols.")},"breadcrumbs.showArrays":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.array","When enabled breadcrumbs show `array`-symbols.")},"breadcrumbs.showObjects":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.object","When enabled breadcrumbs show `object`-symbols.")},"breadcrumbs.showKeys":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.key","When enabled breadcrumbs show `key`-symbols.")},"breadcrumbs.showNull":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.null","When enabled breadcrumbs show `null`-symbols.")},"breadcrumbs.showEnumMembers":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.enumMember","When enabled breadcrumbs show `enumMember`-symbols.")},"breadcrumbs.showStructs":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.struct","When enabled breadcrumbs show `struct`-symbols.")},"breadcrumbs.showEvents":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.event","When enabled breadcrumbs show `event`-symbols.")},"breadcrumbs.showOperators":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.operator","When enabled breadcrumbs show `operator`-symbols.")},"breadcrumbs.showTypeParameters":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.typeParameter","When enabled breadcrumbs show `typeParameter`-symbols.")}}});var BK=Z("IOutlineService");var im=class{constructor(e,t){this.uri=e;this.kind=t}},Wb=class{constructor(e,t){this.element=e;this.outline=t}},Vb=class{constructor(e,t,i,n,o){this.resource=e;this._workspaceService=n;this._outlineService=o;this._cfgFilePath=Or.FilePath.bindTo(i),this._cfgSymbolPath=Or.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(s=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(s=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(e),t&&(this._bindToEditor(t),this._disposables.add(o.onDidChange(()=>this._bindToEditor(t))),this._disposables.add(t.onDidChangeControl(()=>this._bindToEditor(t)))),this._onDidUpdate.fire(this)}_disposables=new Y;_fileInfo;_cfgFilePath;_cfgSymbolPath;_currentOutline=new xt;_outlineDisposables=new Y;_onDidUpdate=new _;onDidUpdate=this._onDidUpdate.event;dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let e=[];if(this._cfgFilePath.getValue()==="on"?e=e.concat(this._fileInfo.path):this._cfgFilePath.getValue()==="last"&&this._fileInfo.path.length>0&&(e=e.concat(this._fileInfo.path.slice(-1))),this._cfgSymbolPath.getValue()==="off"||!this._currentOutline.value)return e;let t=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i=this._cfgSymbolPath.getValue()==="last"&&t.length>0?t.length-1:0;i<t.length;i++)e.push(new Wb(t[i],this._currentOutline.value));return t.length===0&&!this._currentOutline.value.isEmpty&&e.push(new Wb(this._currentOutline.value,this._currentOutline.value)),e}_initFilePathInfo(e){if(a2(e,ue.untitled,ue.data))return{folder:void 0,path:[]};let t={folder:this._workspaceService.getWorkspaceFolder(e)??void 0,path:[]},i=e;for(;i&&i.path!=="/"&&!(t.folder&&Li(t.folder.uri,i));){t.path.unshift(new im(i,t.path.length===0?0:1));let n=i.path.length;if(i=Gs(i),i.path.length===n)break}return t.folder&&this._workspaceService.getWorkbenchState()===3&&t.path.unshift(new im(t.folder.uri,2)),t}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(e){let t=new Vi;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add(te(()=>t.dispose(!0))),this._outlineService.createOutline(e,2,t.token).then(i=>{t.token.isCancellationRequested&&(i?.dispose(),i=void 0),this._currentOutline.value=i,this._onDidUpdate.fire(this),i&&this._outlineDisposables.add(i.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(i=>{this._onDidUpdate.fire(this),Ge(i)})}};Vb=R([y(2,He),y(3,bi),y(4,BK)],Vb);var Hb=class{constructor(e,t,i,n,o){this.resource=t;this._instantiationService=i;this._themeService=n;this._configurationService=o;this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",e.appendChild(this._domNode)}_disposables=new Y;_domNode;_arrow;_treeContainer;_tree;_fakeEvent=new UIEvent("fakeEvent");_layoutInfo;_onWillPickElement=new _;onWillPickElement=this._onWillPickElement.event;_previewDispoables=new xt;dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}async show(e,t,i,n,o){let a=this._themeService.getColorTheme().getColor(eO);this._arrow=document.createElement("div"),this._arrow.className="arrow",this._arrow.style.borderColor=`transparent transparent ${a?a.toString():""}`,this._domNode.appendChild(this._arrow),this._treeContainer=document.createElement("div"),this._treeContainer.style.background=a?a.toString():"",this._treeContainer.style.paddingTop="2px",this._treeContainer.style.borderRadius="3px",this._treeContainer.style.boxShadow=`0 0 8px 2px ${this._themeService.getColorTheme().getColor(mu)}`,this._treeContainer.style.border=`1px solid ${this._themeService.getColorTheme().getColor(Xp)}`,this._domNode.appendChild(this._treeContainer),this._layoutInfo={maxHeight:t,width:i,arrowSize:n,arrowOffset:o,inputHeight:0},this._tree=this._createTree(this._treeContainer,e),this._disposables.add(this._tree.onDidOpen(async l=>{let{element:d,editorOptions:c,sideBySide:u}=l;await this._revealElement(d,{...c,preserveFocus:!1},u)})),this._disposables.add(this._tree.onDidChangeFocus(l=>{this._previewDispoables.value=this._previewElement(l.elements[0])})),this._disposables.add(this._tree.onDidChangeContentHeight(()=>{this._layout()})),this._domNode.focus();try{await this._setInput(e),this._layout()}catch(l){Ge(l)}}_layout(){let e=2*this._layoutInfo.arrowSize,t=Math.min(this._layoutInfo.maxHeight-e,this._tree.contentHeight),i=t+e;this._domNode.style.height=`${i}px`,this._domNode.style.width=`${this._layoutInfo.width}px`,this._arrow.style.top=`-${2*this._layoutInfo.arrowSize}px`,this._arrow.style.borderWidth=`${this._layoutInfo.arrowSize}px`,this._arrow.style.marginLeft=`${this._layoutInfo.arrowOffset}px`,this._treeContainer.style.height=`${t}px`,this._treeContainer.style.width=`${this._layoutInfo.width}px`,this._tree.layout(t,this._layoutInfo.width)}restoreViewState(){}};Hb=R([y(2,ve),y(3,kt),y(4,He)],Hb);var DV=class{getHeight(e){return 22}getTemplateId(e){return"FileStat"}},LV=class{getId(e){return X.isUri(e)?e.toString():rw(e)?e.id:kl(e)?e.uri.toString():e.resource.toString()}},JC=class{constructor(e){this._fileService=e}hasChildren(e){return X.isUri(e)||rw(e)||kl(e)||e.isDirectory}async getChildren(e){if(rw(e))return e.folders;let t;return kl(e)?t=e.uri:X.isUri(e)?t=e:t=e.resource,(await this._fileService.resolve(t)).children??[]}};JC=R([y(0,Lt)],JC);var eS=class{constructor(e,t){this._labels=e;this._configService=t}templateId="FileStat";renderTemplate(e){return this._labels.create(e,{supportHighlights:!0})}renderElement(e,t,i){let n=this._configService.getValue("explorer.decorations"),{element:o}=e,s,a;kl(o)?(s=o.uri,a=2):(s=o.resource,a=o.isDirectory?1:0),i.setFile(s,{fileKind:a,hidePath:!0,fileDecorations:n,matches:DE(e.filterData),extraClasses:["picker-item"]})}disposeTemplate(e){e.dispose()}};eS=R([y(1,He)],eS);var kV=class{getKeyboardNavigationLabel(e){return e.name}},RV=class{getWidgetAriaLabel(){return h("breadcrumbs","Breadcrumbs")}getAriaLabel(e){return e.name}},tS=class{constructor(e,t){this._workspaceService=e;let i=Or.FileExcludes.bindTo(t),n=()=>{e.getWorkspace().folders.forEach(o=>{let s=i.getValue({resource:o.uri});if(!s)return;let a={};for(let l in s){if(typeof s[l]!="boolean")continue;let d=l.indexOf("**/")!==0?ft.join(o.uri.path,l):l;a[d]=s[l]}this._cachedExpressions.set(o.uri.toString(),og(a))})};n(),this._disposables.add(i),this._disposables.add(i.onDidChange(n)),this._disposables.add(e.onDidChangeWorkspaceFolders(n))}_cachedExpressions=new Map;_disposables=new Y;dispose(){this._disposables.dispose()}filter(e,t){if(kl(e))return!0;let i=this._workspaceService.getWorkspaceFolder(e.resource);return!i||!this._cachedExpressions.has(i.uri.toString())?!0:!this._cachedExpressions.get(i.uri.toString())(vS(i.uri.path,e.resource.path),Hi(e.resource))}};tS=R([y(0,bi),y(1,He)],tS);var AV=class{compare(e,t){return kl(e)&&kl(t)?e.index-t.index:e.isDirectory===t.isDirectory?dP(e.name,t.name):e.isDirectory?-1:1}},Ub=class extends Hb{constructor(t,i,n,o,s,a,l){super(t,i,n,o,s);this._workspaceService=a;this._editorService=l}_createTree(t){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");let i=o=>{this._treeContainer.classList.toggle("align-icons-and-twisties",o.hasFileIcons&&!o.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",o.hidesExplorerArrows===!0)};this._disposables.add(this._themeService.onDidFileIconThemeChange(i)),i(this._themeService.getFileIconTheme());let n=this._instantiationService.createInstance(Ws,tm);return this._disposables.add(n),this._instantiationService.createInstance(Du,"BreadcrumbsFilePicker",t,new DV,[this._instantiationService.createInstance(eS,n)],this._instantiationService.createInstance(JC),{multipleSelectionSupport:!1,sorter:new AV,filter:this._instantiationService.createInstance(tS),identityProvider:new LV,keyboardNavigationLabelProvider:new kV,accessibilityProvider:this._instantiationService.createInstance(RV),showNotFoundMessage:!1,overrideStyles:{listBackground:eO}})}async _setInput(t){let{uri:i,kind:n}=t,o;n===2?o=this._workspaceService.getWorkspace():o=Gs(i);let s=this._tree;await s.setInput(o);let a;for(let{element:l}of s.getNode().children)if(kl(l)&&Li(l.uri,i)){a=l;break}else if(Li(l.resource,i)){a=l;break}a&&(s.reveal(a,.5),s.setFocus([a],this._fakeEvent)),s.domFocus()}_previewElement(t){return P.None}async _revealElement(t,i,n){return!kl(t)&&t.isFile?(this._onWillPickElement.fire(),await this._editorService.openEditor({resource:t.resource,options:i},n?yu:void 0),!0):!1}};Ub=R([y(2,ve),y(3,kt),y(4,He),y(5,bi),y(6,vt)],Ub);var iS=class{constructor(e,t,i){this.comparator=e;this._order=i.getValue(t,"breadcrumbs.symbolSortOrder")}_order;compare(e,t){return this._order==="name"?this.comparator.compareByName(e,t):this._order==="type"?this.comparator.compareByType(e,t):this.comparator.compareByPosition(e,t)}};iS=R([y(2,_r)],iS);var kR=class extends Hb{_createTree(e,t){let{config:i}=t.outline;return this._instantiationService.createInstance(_u,"BreadcrumbsOutlinePicker",e,i.delegate,i.renderers,i.treeDataSource,{...i.options,sorter:this._instantiationService.createInstance(iS,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1})}_setInput(e){let t=e.outline.captureViewState();this.restoreViewState=()=>{t.dispose()};let i=this._tree;return i.setInput(e.outline),e.element!==e.outline&&(i.reveal(e.element,.5),i.setFocus([e.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(e){return this._tree.getInput().preview(e)}async _revealElement(e,t,i){return this._onWillPickElement.fire(),await this._tree.getInput().reveal(e,t,i,!1),!0}};var RR=class r extends gf{constructor(t,i,n){super();this.model=t;this.element=i;this.options=n}_disposables=new Y;dispose(){this._disposables.dispose()}equals(t){return t instanceof r?this.element.element===t.element.element&&this.options.showFileIcons===t.options.showFileIcons&&this.options.showSymbolIcons===t.options.showSymbolIcons:!1}render(t){let{element:i,outline:n}=this.element;if(i===n){let l=he("span",void 0,"\u2026");t.appendChild(l);return}let o=n.config.delegate.getTemplateId(i),s=n.config.renderers.find(l=>l.templateId===o);if(!s){t.innerText="<<NO RENDERER>>";return}let a=s.renderTemplate(t);s.renderElement({element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,a,void 0),this._disposables.add(te(()=>{s.disposeTemplate(a)}))}},AR=class r extends gf{constructor(t,i,n,o,s){super();this.model=t;this.element=i;this.options=n;this._labels=o;this._hoverDelegate=s}_disposables=new Y;dispose(){this._disposables.dispose()}equals(t){return t instanceof r?Nt.isEqual(this.element.uri,t.element.uri)&&this.options.showFileIcons===t.options.showFileIcons&&this.options.showSymbolIcons===t.options.showSymbolIcons:!1}render(t){let i=this._labels.create(t,{hoverDelegate:this._hoverDelegate});i.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===1||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),t.classList.add(Yp[this.element.kind].toLowerCase()),this._disposables.add(i)}},Lee=$o("breadcrumb-separator",ie.chevronRight,h("separatorIcon","Icon for the separator in the breadcrumbs.")),Wt=class{constructor(e,t,i,n,o,s,a,l,d,c,u,p){this._options=t;this._editorGroup=i;this._contextKeyService=n;this._contextViewService=o;this._instantiationService=s;this._quickInputService=a;this._fileService=l;this._editorService=d;this._labelService=c;this.domNode=document.createElement("div"),this.domNode.classList.add("breadcrumbs-control"),ye(e,this.domNode),this._cfUseQuickPick=Or.UseQuickPick.bindTo(u),this._cfShowIcons=Or.Icons.bindTo(u),this._cfTitleScrollbarSizing=Or.TitleScrollbarSizing.bindTo(u),this._labels=this._instantiationService.createInstance(Ws,tm);let m=this._cfTitleScrollbarSizing.getValue()??"default",f=t.widgetStyles??y_;this._widget=new f_(this.domNode,Wt.SCROLLBAR_SIZES[m],Lee,f),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=Wt.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=Wt.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=Wt.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._hoverDelegate=Dt("mouse"),this._disposables.add(p.register(this._editorGroup.id,this._widget)),this.hide()}static HEIGHT=22;static SCROLLBAR_SIZES={default:3,large:8};static Payload_Reveal={};static Payload_RevealAside={};static Payload_Pick={};static CK_BreadcrumbsPossible=new q("breadcrumbsPossible",!1,h("breadcrumbsPossible","Whether the editor can show breadcrumbs"));static CK_BreadcrumbsVisible=new q("breadcrumbsVisible",!1,h("breadcrumbsVisible","Whether breadcrumbs are currently visible"));static CK_BreadcrumbsActive=new q("breadcrumbsActive",!1,h("breadcrumbsActive","Whether breadcrumbs have focus"));_ckBreadcrumbsPossible;_ckBreadcrumbsVisible;_ckBreadcrumbsActive;_cfUseQuickPick;_cfShowIcons;_cfTitleScrollbarSizing;domNode;_widget;_disposables=new Y;_breadcrumbsDisposables=new Y;_labels;_model=new xt;_breadcrumbsPickerShowing=!1;_breadcrumbsPickerIgnoreOnceItem;_hoverDelegate;_onDidVisibilityChange=this._disposables.add(new _);get onDidVisibilityChange(){return this._onDidVisibilityChange.event}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(e){this._widget.layout(e)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){let e=this.isHidden();this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0),e||this._onDidVisibilityChange.fire()}show(){let e=this.isHidden();this._ckBreadcrumbsVisible.set(!0),this.domNode.classList.toggle("hidden",!1),e&&this._onDidVisibilityChange.fire()}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();let e=Mt.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:1}),t=this.isHidden();if(!e||!this._fileService.hasProvider(e))return this._ckBreadcrumbsPossible.set(!1),t?!1:(this.hide(),!0);let i=Mt.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:1});this.show(),this._ckBreadcrumbsPossible.set(!0);let n=this._instantiationService.createInstance(Vb,i??e,this._editorGroup.activeEditorPane);this._model.value=n,this.domNode.classList.toggle("backslash-path",this._labelService.getSeparator(e.scheme,e.authority)==="\\");let o=()=>{this.domNode.classList.toggle("relative-path",n.isRelative());let c=this._cfShowIcons.getValue(),u={...this._options,showFileIcons:this._options.showFileIcons&&c,showSymbolIcons:this._options.showSymbolIcons&&c},p=n.getElements().map(m=>m instanceof im?new AR(n,m,u,this._labels,this._hoverDelegate):new RR(n,m,u));p.length===0?(this._widget.setEnabled(!1),this._widget.setItems([new class extends gf{render(m){m.innerText=h("empty","no elements")}equals(m){return m===this}dispose(){}}])):(this._widget.setEnabled(!0),this._widget.setItems(p),this._widget.reveal(p[p.length-1]))},s=n.onDidUpdate(o),a=this._cfShowIcons.onDidChange(o);o(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(s),this._breadcrumbsDisposables.add(te(()=>this._model.clear())),this._breadcrumbsDisposables.add(a),this._breadcrumbsDisposables.add(te(()=>this._widget.setItems([])));let l=()=>{let c=this._cfTitleScrollbarSizing.getValue()??"default";this._widget.setHorizontalScrollbarSize(Wt.SCROLLBAR_SIZES[c])};l();let d=this._cfTitleScrollbarSizing.onDidChange(l);return this._breadcrumbsDisposables.add(d),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),t!==this.isHidden()}_onFocusEvent(e){e.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(e.item))}_onSelectEvent(e){if(!e.item)return;if(e.item===this._breadcrumbsPickerIgnoreOnceItem){this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),this._widget.setSelection(void 0);return}let{element:t}=e.item;this._editorGroup.focus();let i=this._getEditorGroup(e.payload);if(i!==void 0){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._revealInEditor(e,t,i);return}if(this._cfUseQuickPick.getValue()){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._quickInputService.quickAccess.show(t instanceof Wb?"@":"");return}let n,o;this._contextViewService.showContextView({render:s=>{e.item instanceof AR?n=this._instantiationService.createInstance(Ub,s,e.item.model.resource):e.item instanceof RR&&(n=this._instantiationService.createInstance(kR,s,e.item.model.resource));let a=n.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),l=Su.getInstance(pe(this.domNode)).onDidChange(()=>this._contextViewService.hideContextView({source:this})),d=Mn(s),c=d.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?e.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),un(n,a,l,d,c)},getAnchor:()=>{if(!o){let s=pe(this.domNode),a=s.innerWidth-8,l=Math.min(s.innerHeight*.7,300),d=Math.min(a,Math.max(240,a/4.17)),c=8,u,p=po(e.node.firstChild),m=p.top+p.height+c;m+l>=s.innerHeight&&(l=s.innerHeight-m-30);let f=p.left;if(f+d>=a&&(f=a-d),e.payload instanceof Ei){let g=d-2*c;u=e.payload.posx-f,u>g&&(f=Math.min(a-d,f+u-g),u=g)}else u=p.left+p.width*.3-f;n.show(t,l,d,c,Math.max(0,u)),o={x:f,y:m}}return o},onHide:s=>{s?.didPick||n.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),s?.source===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),n.dispose()}})}_updateCkBreadcrumbsActive(){let e=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(e)}async _revealInEditor(e,t,i,n=!1){if(t instanceof im)if(t.kind===0)await this._editorService.openEditor({resource:t.uri,options:{pinned:n}},i);else{let o=this._widget.getItems(),s=o.indexOf(e.item);this._widget.setFocused(o[s+1]),this._widget.setSelection(o[s+1],Wt.Payload_Pick)}else t.outline.reveal(t,{pinned:n},i===yu,!1)}_getEditorGroup(e){return e===Wt.Payload_RevealAside?yu:e===Wt.Payload_Reveal?jO:void 0}};Wt=R([y(3,je),y(4,iu),y(5,ve),y(6,$l),y(7,Lt),y(8,vt),y(9,na),y(10,He),y(11,nl)],Wt);var op=class{constructor(e,t,i,n,o,s){this._container=e;this._editorGroup=t;this._options=i;this._instantiationService=o;let a=this._disposables.add(Or.IsEnabled.bindTo(n));this._disposables.add(a.onDidChange(()=>{let l=a.getValue();!l&&this._control?(this._controlDisposables.clear(),this._control=void 0,this._onDidEnablementChange.fire()):l&&!this._control&&(this._control=this.createControl(),this._control.update(),this._onDidEnablementChange.fire())})),a.getValue()&&(this._control=this.createControl()),this._disposables.add(s.onDidChangeFileSystemProviderRegistrations(l=>{this._control?.model&&this._control.model.resource.scheme!==l.scheme||this._control?.update()&&this._onDidEnablementChange.fire()}))}_disposables=new Y;_controlDisposables=new Y;_control;get control(){return this._control}_onDidEnablementChange=this._disposables.add(new _);get onDidEnablementChange(){return this._onDidEnablementChange.event}_onDidVisibilityChange=this._disposables.add(new _);get onDidVisibilityChange(){return this._onDidVisibilityChange.event}createControl(){let e=this._controlDisposables.add(this._instantiationService.createInstance(Wt,this._container,this._options,this._editorGroup));return this._controlDisposables.add(e.onDidVisibilityChange(()=>this._onDidVisibilityChange.fire())),e}dispose(){this._disposables.dispose(),this._controlDisposables.dispose()}};op=R([y(3,He),y(4,ve),y(5,Lt)],op);lr(class extends wi{constructor(){super({id:"breadcrumbs.toggle",title:{...pt("cmd.toggle","Toggle Breadcrumbs"),mnemonicTitle:h({key:"miBreadcrumbs",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs")},category:ar.View,toggled:{condition:Ue.equals("config.breadcrumbs.enabled",!0),title:h("cmd.toggle2","Toggle Breadcrumbs"),mnemonicTitle:h({key:"miBreadcrumbs2",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs")},menu:[{id:nt.CommandPalette},{id:nt.MenubarAppearanceMenu,group:"4_editor",order:2},{id:nt.NotebookToolbar,group:"notebookLayout",order:2},{id:nt.StickyScrollContext},{id:nt.NotebookStickyScrollContext,group:"notebookView",order:2}]})}run(e){let t=e.get(He),i=Or.IsEnabled.bindTo(t).getValue();Or.IsEnabled.bindTo(t).updateValue(!i)}});function MV(r,e){let t=r.get(Ri),n=r.get(nl).getWidget(t.activeGroup.id);if(n){let o=Wo(n.getItems());n.setFocused(o),e&&n.setSelection(o,Wt.Payload_Pick)}}lr(class extends wi{constructor(){super({id:"breadcrumbs.focusAndSelect",title:pt("cmd.focusAndSelect","Focus and Select Breadcrumbs"),precondition:Wt.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3161,when:Wt.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){MV(e,!0)}});lr(class extends wi{constructor(){super({id:"breadcrumbs.focus",title:pt("cmd.focus","Focus Breadcrumbs"),precondition:Wt.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3157,when:Wt.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){MV(e,!1)}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:200,primary:3161,when:Ue.not("config.breadcrumbs.enabled"),handler:async r=>{let e=r.get(ve),t=r.get(He),i=Or.IsEnabled.bindTo(t);return i.getValue()||(await i.updateValue(!0),await hn(50)),e.invokeFunction(MV,!0)}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:200,primary:17,secondary:[2065],mac:{primary:17,secondary:[529]},when:Ue.and(Wt.CK_BreadcrumbsVisible,Wt.CK_BreadcrumbsActive),handler(r){let e=r.get(Ri),i=r.get(nl).getWidget(e.activeGroup.id);i&&i.focusNext()}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:200,primary:15,secondary:[2063],mac:{primary:15,secondary:[527]},when:Ue.and(Wt.CK_BreadcrumbsVisible,Wt.CK_BreadcrumbsActive),handler(r){let e=r.get(Ri),i=r.get(nl).getWidget(e.activeGroup.id);i&&i.focusPrev()}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:201,primary:2065,mac:{primary:529},when:Ue.and(Wt.CK_BreadcrumbsVisible,Wt.CK_BreadcrumbsActive,M_),handler(r){let e=r.get(Ri),i=r.get(nl).getWidget(e.activeGroup.id);i&&i.focusNext()}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:201,primary:2063,mac:{primary:527},when:Ue.and(Wt.CK_BreadcrumbsVisible,Wt.CK_BreadcrumbsActive,M_),handler(r){let e=r.get(Ri),i=r.get(nl).getWidget(e.activeGroup.id);i&&i.focusPrev()}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:200,primary:3,secondary:[18],when:Ue.and(Wt.CK_BreadcrumbsVisible,Wt.CK_BreadcrumbsActive),handler(r){let e=r.get(Ri),i=r.get(nl).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),Wt.Payload_Pick)}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:200,primary:10,secondary:[2051],when:Ue.and(Wt.CK_BreadcrumbsVisible,Wt.CK_BreadcrumbsActive),handler(r){let e=r.get(Ri),i=r.get(nl).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),Wt.Payload_Reveal)}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:201,primary:9,when:Ue.and(Wt.CK_BreadcrumbsVisible,Wt.CK_BreadcrumbsActive),handler(r){let e=r.get(Ri),i=r.get(nl).getWidget(e.activeGroup.id);i&&(i.setFocused(void 0),i.setSelection(void 0),e.activeGroup.activeEditorPane?.focus())}});fn.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:200,primary:2051,when:Ue.and(Wt.CK_BreadcrumbsVisible,Wt.CK_BreadcrumbsActive,M_),handler(r){let e=r.get(vt),i=r.get(ss).lastFocusedList;if(!(i instanceof _u)&&!(i instanceof Du))return;let n=i.getFocus()[0];if(X.isUri(n?.resource))return e.openEditor({resource:n.resource,options:{pinned:!0}},yu);let o=i.getInput();if(o&&typeof o.outlineKind=="string")return o.reveal(n,{pinned:!0,preserveFocus:!1},!0,!1)}});var MR=class{_serviceBrand;_dragOperations=new Map;removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){let t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}addDragOperationTransfer(e,t){this._dragOperations.set(e,t)}},zb=class{constructor(e){this.identifier=e}};var nS=class extends lo{constructor(t){super();this.context=t}run(t,i){let n=this.context;return i?.preserveFocus&&(n={...this.context,preserveFocus:!0}),super.run(t,n)}},Hs=class extends ta{constructor(t,i,n,o,s,a,l,d,c,u,p,m,f,g){super(m);this.parent=t;this.editorPartsView=i;this.groupsView=n;this.groupView=o;this.tabsModel=s;this.contextMenuService=a;this.instantiationService=l;this.contextKeyService=d;this.keybindingService=c;this.notificationService=u;this.quickInputService=p;this.editorResolverService=f;this.hostService=g;this.contextMenuContextKeyService=this._register(this.contextKeyService.createScoped(t));let b=this._register(this.instantiationService.createChild(new ws([je,this.contextMenuContextKeyService])));this.resourceContext=this._register(b.createInstance(no)),this.editorPinnedContext=jk.bindTo(this.contextMenuContextKeyService),this.editorIsFirstContext=qk.bindTo(this.contextMenuContextKeyService),this.editorIsLastContext=$k.bindTo(this.contextMenuContextKeyService),this.editorStickyContext=DC.bindTo(this.contextMenuContextKeyService),this.editorAvailableEditorIds=RC.bindTo(this.contextMenuContextKeyService),this.editorCanSplitInGroupContext=LC.bindTo(this.contextMenuContextKeyService),this.sideBySideEditorContext=AC.bindTo(this.contextMenuContextKeyService),this.groupLockedContext=MC.bindTo(this.contextMenuContextKeyService),this.renderDropdownAsChildElement=!1,this.tabsHoverDelegate=Dt("mouse"),this.create(t)}editorTransfer=Xu.getInstance();groupTransfer=Xu.getInstance();treeItemsTransfer=Xu.getInstance();static EDITOR_TAB_HEIGHT={normal:35,compact:22};editorActionsToolbarContainer;editorActionsToolbar;editorActionsToolbarDisposables=this._register(new Y);editorActionsDisposables=this._register(new Y);contextMenuContextKeyService;resourceContext;editorPinnedContext;editorIsFirstContext;editorIsLastContext;editorStickyContext;editorAvailableEditorIds;editorCanSplitInGroupContext;sideBySideEditorContext;groupLockedContext;renderDropdownAsChildElement;tabsHoverDelegate;create(t){this.updateTabHeight()}get editorActionsEnabled(){return this.groupsView.partOptions.editorActionsLocation==="default"&&this.groupsView.partOptions.showTabs!=="none"}createEditorActionsToolBar(t,i){this.editorActionsToolbarContainer=document.createElement("div"),this.editorActionsToolbarContainer.classList.add(...i),t.appendChild(this.editorActionsToolbarContainer),this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer)}handleEditorActionToolBarVisibility(t){let i=this.editorActionsEnabled,n=!!this.editorActionsToolbar;i&&!n?this.doCreateEditorActionsToolBar(t):!i&&n&&(this.editorActionsToolbar?.getElement().remove(),this.editorActionsToolbar=void 0,this.editorActionsToolbarDisposables.clear(),this.editorActionsDisposables.clear()),t.classList.toggle("hidden",!i)}doCreateEditorActionsToolBar(t){let i={groupId:this.groupView.id};this.editorActionsToolbar=this.editorActionsToolbarDisposables.add(this.instantiationService.createInstance(pc,t,{actionViewItemProvider:(n,o)=>this.actionViewItemProvider(n,o),orientation:0,ariaLabel:h("ariaLabelEditorActions","Editor actions"),getKeyBinding:n=>this.getKeybinding(n),actionRunner:this.editorActionsToolbarDisposables.add(new nS(i)),anchorAlignmentProvider:()=>1,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:nt.EditorTitle,overflowBehavior:{maxItems:9,exempted:Z3},highlightToggledItems:!0})),this.editorActionsToolbar.context=i,this.editorActionsToolbarDisposables.add(this.editorActionsToolbar.actionRunner.onDidRun(n=>{n.error&&!wc(n.error)&&this.notificationService.error(n.error)}))}actionViewItemProvider(t,i){let n=this.groupView.activeEditorPane;if(n instanceof od){let o=n.getActionViewItem(t,i);if(o)return o}return mb(this.instantiationService,t,{...i,menuAsChild:this.renderDropdownAsChildElement})}updateEditorActionsToolbar(){if(!this.editorActionsEnabled)return;this.editorActionsDisposables.clear();let t=this.groupView.createEditorActions(this.editorActionsDisposables);this.editorActionsDisposables.add(t.onDidChange(()=>this.updateEditorActionsToolbar()));let i=at(this.editorActionsToolbar),{primary:n,secondary:o}=this.prepareEditorActions(t.actions);i.setActions(Bm(n),Bm(o))}getEditorPaneAwareContextKeyService(){return this.groupView.activeEditorPane?.scopedContextKeyService??this.contextKeyService}clearEditorActionsToolbar(){if(!this.editorActionsEnabled)return;at(this.editorActionsToolbar).setActions([],[])}onGroupDragStart(t,i){if(t.target!==i)return!1;let n=this.isNewWindowOperation(t);this.groupTransfer.setData([new Vs(this.groupView.id)],Vs.prototype),t.dataTransfer&&(t.dataTransfer.effectAllowed="copyMove");let o=!1;if(this.groupsView.partOptions.showTabs==="multiple"?o=this.doFillResourceDataTransfers(this.groupView.getEditors(1),t,n):this.groupView.activeEditor&&(o=this.doFillResourceDataTransfers([this.groupView.activeEditor],t,n)),!o&&$i&&t.dataTransfer?.setData(Mo.TEXT,String(this.groupView.label)),this.groupView.activeEditor){let s=this.groupView.activeEditor.getName();this.groupsView.partOptions.showTabs==="multiple"&&this.groupView.count>1&&(s=h("draggedEditorGroup","{0} (+{1})",s,this.groupView.count-1)),yE(t,s,"monaco-editor-group-drag-image",this.getColor(yo),this.getColor(is))}return n}async onGroupDragEnd(t,i,n,o){if(this.groupTransfer.clearData(Vs.prototype),t.target!==n||!o||pR())return;let s=await this.maybeCreateAuxiliaryEditorPartAt(t,n);if(!s)return;let a=s.activeGroup;this.groupsView.mergeGroup(this.groupView,a.id,{mode:this.isMoveOperation(i??t,a.id)?1:0}),a.focus()}async maybeCreateAuxiliaryEditorPartAt(t,i){let{point:n,display:o}=await this.hostService.getCursorScreenPoint()??{point:{x:t.screenX,y:t.screenY}},s=Kr();if(s.document.visibilityState==="visible"&&s.document.hasFocus()&&n.x>=s.screenX&&n.x<=s.screenX+s.outerWidth&&n.y>=s.screenY&&n.y<=s.screenY+s.outerHeight)return;let a=i.offsetWidth/2,l=30+i.offsetHeight/2,d={x:n.x-a,y:n.y-l};return o&&(d.x<o.x&&(d.x=o.x),d.y<o.y&&(d.y=o.y)),this.editorPartsView.createAuxiliaryEditorPart({bounds:d})}isNewWindowOperation(t){return this.groupsView.partOptions.dragToOpenWindow?!t.altKey:t.altKey}isMoveOperation(t,i,n){return n?.hasCapability(8)?!0:!(t.ctrlKey&&!ke||t.altKey&&ke)||i===this.groupView.id}doFillResourceDataTransfers(t,i,n){return t.length?(this.instantiationService.invokeFunction(HC,t.map(o=>({editor:o,groupId:this.groupView.id})),i,{disableStandardTransfer:n}),!0):!1}onTabContextMenu(t,i,n){this.resourceContext.set(Mt.getOriginalUri(t,{supportSideBySide:1})),this.editorPinnedContext.set(this.tabsModel.isPinned(t)),this.editorIsFirstContext.set(this.tabsModel.isFirst(t)),this.editorIsLastContext.set(this.tabsModel.isLast(t)),this.editorStickyContext.set(this.tabsModel.isSticky(t)),this.groupLockedContext.set(this.tabsModel.isLocked),this.editorCanSplitInGroupContext.set(t.hasCapability(32)),this.sideBySideEditorContext.set(t.typeId===xi.ID),Xk(this.editorAvailableEditorIds,t,this.editorResolverService);let o=n;yr(i)&&(o=new Ei(pe(n),i)),this.contextMenuService.showContextMenu({getAnchor:()=>o,menuId:nt.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextMenuContextKeyService,getActionsContext:()=>({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(t)}),getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id,this.contextMenuContextKeyService),onHide:()=>this.groupsView.activeGroup.focus()})}getKeybinding(t){return this.keybindingService.lookupKeybinding(t.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(t){let i=this.getKeybinding(t);return i?i.getLabel()??void 0:void 0}get tabHeight(){return this.groupsView.partOptions.tabHeight!=="compact"?Hs.EDITOR_TAB_HEIGHT.normal:Hs.EDITOR_TAB_HEIGHT.compact}getHoverTitle(t){let i=t.getTitle(2);return this.tabsModel.isPinned(t)?i:{markdown:new Op("",{supportThemeIcons:!0,isTrusted:!0}).appendText(i).appendMarkdown(' (_preview_ [$(gear)](command:workbench.action.openSettings?%5B%22workbench.editor.enablePreview%22%5D "Configure Preview Mode"))'),markdownNotSupportedFallback:i+" (preview)"}}getHoverDelegate(){return this.tabsHoverDelegate}updateTabHeight(){this.parent.style.setProperty("--editor-group-tab-height",`${this.tabHeight}px`)}updateOptions(t,i){t.tabHeight!==i.tabHeight&&this.updateTabHeight(),(t.editorActionsLocation!==i.editorActionsLocation||t.showTabs!==i.showTabs)&&this.editorActionsToolbarContainer&&(this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer),this.updateEditorActionsToolbar())}};Hs=R([y(5,Zi),y(6,ve),y(7,je),y(8,qt),y(9,Bo),y(10,$l),y(11,kt),y(12,$u),y(13,eo)],Hs);var OV=Z("treeViewsDndService");an(OV,MR,1);var OR=class extends P{constructor(t){super();this.model=t;this._register(this.model.onDidModelChange(i=>{let n=i.editorIndex??i.editor;n!==void 0&&!this.filter(n)||this._onDidModelChange.fire(i)}))}_onDidModelChange=this._register(new _);onDidModelChange=this._onDidModelChange.event;get id(){return this.model.id}get isLocked(){return this.model.isLocked}get stickyCount(){return this.model.stickyCount}get activeEditor(){return this.model.activeEditor&&this.filter(this.model.activeEditor)?this.model.activeEditor:null}get previewEditor(){return this.model.previewEditor&&this.filter(this.model.previewEditor)?this.model.previewEditor:null}get selectedEditors(){return this.model.selectedEditors.filter(t=>this.filter(t))}isPinned(t){return this.model.isPinned(t)}isTransient(t){return this.model.isTransient(t)}isSticky(t){return this.model.isSticky(t)}isActive(t){return this.model.isActive(t)}isSelected(t){return this.model.isSelected(t)}isFirst(t){return this.model.isFirst(t,this.getEditors(1))}isLast(t){return this.model.isLast(t,this.getEditors(1))}getEditors(t,i){return this.model.getEditors(t,i).filter(o=>this.filter(o))}findEditor(t,i){let n=this.model.findEditor(t,i);if(n)return this.filter(n[1])?n:void 0}},Kb=class extends OR{get count(){return this.model.stickyCount}getEditors(e,t){return t?.excludeSticky?[]:e===1?this.model.getEditors(1).slice(0,this.model.stickyCount):super.getEditors(e,t)}isSticky(e){return!0}getEditorByIndex(e){return e<this.count?this.model.getEditorByIndex(e):void 0}indexOf(e,t,i){let n=this.model.indexOf(e,t,i);return n<0||n>=this.model.stickyCount?-1:n}contains(e,t){let i=this.model.indexOf(e,void 0,t);return i>=0&&i<this.model.stickyCount}filter(e){return this.model.isSticky(e)}},Gb=class extends OR{get count(){return this.model.count-this.model.stickyCount}get stickyCount(){return 0}isSticky(e){return!1}getEditors(e,t){return e===1?this.model.getEditors(1).slice(this.model.stickyCount):super.getEditors(e,t)}getEditorByIndex(e){return e>=0?this.model.getEditorByIndex(e+this.model.stickyCount):void 0}indexOf(e,t,i){let n=this.model.indexOf(e,t,i);return n<this.model.stickyCount||n>=this.model.count?-1:n-this.model.stickyCount}contains(e,t){let i=this.model.indexOf(e,void 0,t);return i>=this.model.stickyCount&&i<this.model.count}filter(e){return!this.model.isSticky(e)}};var zn=class extends Hs{constructor(t,i,n,o,s,a,l,d,c,u,p,m,f,g,b,v,I){super(t,i,n,o,s,a,l,d,c,u,p,m,v,I);this.editorService=f;this.pathService=g;this.treeViewsDragAndDropService=b;(async()=>this.path=await this.pathService.path)(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}static SCROLLBAR_SIZES={default:3,large:10};static TAB_WIDTH={compact:38,shrink:80,fit:120};static DRAG_OVER_OPEN_TAB_THRESHOLD=1500;static MOUSE_WHEEL_EVENT_THRESHOLD=150;static MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5;titleContainer;tabsAndActionsContainer;tabsContainer;tabsScrollbar;tabSizingFixedDisposables;closeEditorAction=this._register(this.instantiationService.createInstance(ip,ip.ID,ip.LABEL));unpinEditorAction=this._register(this.instantiationService.createInstance(pa,pa.ID,pa.LABEL));tabResourceLabels=this._register(this.instantiationService.createInstance(Ws,tm));tabLabels=[];activeTabLabel;tabActionBars=[];tabDisposables=[];dimensions={container:At.None,available:At.None};layoutScheduler=this._register(new xt);blockRevealActiveTab;path=dt?Fi:ft;lastMouseWheelEventTime=0;isMouseOverTabs=!1;create(t){super.create(t),this.titleContainer=t,this.tabsAndActionsContainer=document.createElement("div"),this.tabsAndActionsContainer.classList.add("tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=document.createElement("div"),this.tabsContainer.setAttribute("role","tablist"),this.tabsContainer.draggable=!0,this.tabsContainer.classList.add("tabs-container"),this._register(ei.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new Y),this.updateTabSizing(!1),this.tabsScrollbar=this.createTabsScrollbar(this.tabsContainer),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.createEditorActionsToolBar(this.tabsAndActionsContainer,["editor-actions"]),this.updateTabsControlVisibility()}createTabsScrollbar(t){let i=this._register(new Nm(t,{horizontal:1,horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:2,scrollYToX:!0,useShadows:!1}));return this._register(i.onScroll(n=>{n.scrollLeftChanged&&(t.scrollLeft=n.scrollLeft)})),i}updateTabsScrollbarSizing(){this.tabsScrollbar?.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabSizing(t){let[i,n]=Cl(this.tabsContainer,this.tabSizingFixedDisposables);n.clear();let o=this.groupsView.partOptions;o.tabSizing==="fixed"?(i.style.setProperty("--tab-sizing-fixed-min-width",`${o.tabSizingFixedMinWidth}px`),i.style.setProperty("--tab-sizing-fixed-max-width",`${o.tabSizingFixedMaxWidth}px`),n.add(B(i,Q.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),n.add(B(i,Q.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):t&&(i.style.removeProperty("--tab-sizing-fixed-min-width"),i.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(t){this.forEachTab((i,n,o)=>{if(t){let{width:s}=o.getBoundingClientRect();o.style.setProperty("--tab-sizing-current-width",`${s}px`)}else o.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return this.groupsView.partOptions.titleScrollbarSizing!=="large"?zn.SCROLLBAR_SIZES.default:zn.SCROLLBAR_SIZES.large}registerTabsContainerListeners(t,i){this._register(B(t,Q.SCROLL,()=>{t.classList.contains("scroll")&&i.setScrollPosition({scrollLeft:t.scrollLeft})}));for(let a of[it.Tap,Q.DBLCLICK])this._register(B(t,a,l=>{if(a===Q.DBLCLICK){if(l.target!==t)return}else if(l.tapCount!==2||l.initialTarget!==t)return;Oe.stop(l),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.groupView.count,override:Iu.id}},this.groupView.id)}));this._register(B(t,Q.MOUSE_DOWN,a=>{a.button===1&&a.preventDefault()})),_t&&this._register(B(t,Q.MOUSE_UP,a=>{a.button===1&&a.preventDefault()}));let n,o=!1;this._register(new zr(t,{onDragStart:a=>{o=this.onGroupDragStart(a,t)},onDrag:a=>{n=a},onDragEnter:a=>{if(t.classList.add("scroll"),a.target===t){if(!this.isSupportedDropTransfer(a)){a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}this.editorTransfer.hasData(Bs.prototype)||a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),this.updateDropFeedback(t,!0,a)}},onDragLeave:a=>{this.updateDropFeedback(t,!1,a),t.classList.remove("scroll")},onDragEnd:a=>{this.updateDropFeedback(t,!1,a),t.classList.remove("scroll"),this.onGroupDragEnd(a,n,t,o)},onDrop:a=>{if(this.updateDropFeedback(t,!1,a),t.classList.remove("scroll"),a.target===t){let l=this.groupTransfer.hasData(Vs.prototype);this.onDrop(a,l?this.groupView.count:this.tabsModel.count,t)}}})),this._register(B(t,Q.MOUSE_WHEEL,a=>{let l=this.groupView.activeEditor;if(!l||this.groupView.count<2)return;if(this.groupsView.partOptions.scrollToSwitchTabs===!0){if(a.shiftKey)return}else if(!a.shiftKey)return;let d=Date.now();if(d-this.lastMouseWheelEventTime<zn.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(a.deltaX)+Math.abs(a.deltaY)))return;this.lastMouseWheelEventTime=d;let c;if(a.deltaX+a.deltaY<-zn.MOUSE_WHEEL_DISTANCE_THRESHOLD)c=-1;else if(a.deltaX+a.deltaY>zn.MOUSE_WHEEL_DISTANCE_THRESHOLD)c=1;else return;let u=this.groupView.getEditorByIndex(this.groupView.getIndexOfEditor(l)+c);u&&(this.groupView.openEditor(u),Oe.stop(a,!0))}));let s=a=>{Oe.stop(a);let l=t;yr(a)&&(l=new Ei(pe(this.parent),a)),this.contextMenuService.showContextMenu({getAnchor:()=>l,menuId:nt.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.groupView.id}),getKeyBinding:d=>this.getKeybinding(d),onHide:()=>this.groupView.focus()})};this._register(B(t,it.Contextmenu,a=>s(a))),this._register(B(t,Q.CONTEXT_MENU,a=>s(a)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(t,i){let n=this.handleOpenedEditors();return i?.focusTabControl&&this.withTab(t,(o,s,a)=>a.focus()),n}openEditors(t){return this.handleOpenedEditors()}handleOpenedEditors(){this.updateTabsControlVisibility();let[t,i]=Cl(this.tabsContainer,this.tabsScrollbar);for(let l=t.children.length;l<this.tabsModel.count;l++)t.appendChild(this.createTab(l,t,i));let n=this.didActiveEditorChange(),o=this.activeTabLabel,s=this.tabLabels.length;this.computeTabLabels();let a=!1;return n||s!==this.tabLabels.length||!this.equalsEditorInputLabel(o,this.activeTabLabel)?(this.redraw({forceRevealActiveTab:!0}),a=!0):this.layout(this.dimensions,{forceRevealActiveTab:!0}),a}didActiveEditorChange(){return!!(!this.activeTabLabel?.editor&&this.tabsModel.activeEditor||this.activeTabLabel?.editor&&!this.tabsModel.activeEditor||!this.activeTabLabel?.editor||!this.tabsModel.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(t,i){return t===i?!0:!t||!i?!1:t.name===i.name&&t.description===i.description&&t.forceDescription===i.forceDescription&&t.title===i.title&&t.ariaLabel===i.ariaLabel}beforeCloseEditor(t){if(this.isMouseOverTabs&&this.groupsView.partOptions.tabSizing==="fixed"){let i=this.tabsModel.isLast(t);this.updateTabsFixedWidth(!i)}}closeEditor(t){this.handleClosedEditors()}closeEditors(t){this.handleClosedEditors()}handleClosedEditors(){if(this.tabsModel.count){let t=at(this.tabsContainer);for(;t.children.length>this.tabsModel.count;)t.lastChild?.remove(),ht(this.tabDisposables.pop());this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&Xt(this.tabsContainer),this.tabDisposables=ht(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),this.updateTabsControlVisibility()}moveEditor(t,i,n){let o=this.tabLabels[i];this.tabLabels.splice(i,1),this.tabLabels.splice(n,0,o),this.forEachTab((s,a,l,d,c,u)=>{this.redrawTab(s,a,l,d,c,u)},Math.min(i,n),Math.max(i,n)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(t){this.withTab(t,(i,n,o,s,a)=>this.redrawTabLabel(i,n,o,s,a))}stickEditor(t){this.doHandleStickyEditorChange(t)}unstickEditor(t){this.doHandleStickyEditorChange(t)}doHandleStickyEditorChange(t){this.withTab(t,(i,n,o,s,a,l)=>this.redrawTab(i,n,o,s,a,l)),this.forEachTab((i,n,o,s,a)=>{this.redrawTabBorders(n,o)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(t){this.forEachTab((i,n,o,s,a,l)=>{this.redrawTabSelectedActiveAndDirty(t,i,o,l)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorSelections(){this.forEachTab((t,i,n,o,s,a)=>{this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,t,n,a)})}updateEditorLabelScheduler=this._register(new Kt(()=>this.doUpdateEditorLabels(),0));updateEditorLabel(t){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((t,i,n,o,s)=>{this.redrawTabLabel(t,i,n,o,s)}),this.layout(this.dimensions)}updateEditorDirty(t){this.withTab(t,(i,n,o,s,a,l)=>this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,i,o,l))}updateOptions(t,i){super.updateOptions(t,i),t.labelFormat!==i.labelFormat&&this.computeTabLabels(),t.titleScrollbarSizing!==i.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),t.alwaysShowEditorActions!==i.alwaysShowEditorActions&&this.updateEditorActionsToolbar(),(t.tabSizingFixedMinWidth!==i.tabSizingFixedMinWidth||t.tabSizingFixedMaxWidth!==i.tabSizingFixedMaxWidth||t.tabSizing!==i.tabSizing)&&this.updateTabSizing(!0),(t.labelFormat!==i.labelFormat||t.tabActionLocation!==i.tabActionLocation||t.tabActionCloseVisibility!==i.tabActionCloseVisibility||t.tabActionUnpinVisibility!==i.tabActionUnpinVisibility||t.tabSizing!==i.tabSizing||t.pinnedTabSizing!==i.pinnedTabSizing||t.showIcons!==i.showIcons||t.hasIcons!==i.hasIcons||t.highlightModifiedTabs!==i.highlightModifiedTabs||t.wrapTabs!==i.wrapTabs||!fi(t.decorations,i.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(t,i,n){this.tabsModel.getEditors(1).forEach((o,s)=>{typeof i=="number"&&i>s||typeof n=="number"&&n<s||this.doWithTab(s,o,t)})}withTab(t,i){this.doWithTab(this.tabsModel.indexOf(t),t,i)}doWithTab(t,i,n){let s=at(this.tabsContainer).children[t],a=this.tabResourceLabels.get(t),l=this.tabLabels[t],d=this.tabActionBars[t];s&&a&&l&&n(i,t,s,a,l,d)}createTab(t,i,n){let o=document.createElement("div");o.draggable=!0,o.setAttribute("role","tab"),o.classList.add("tab"),this._register(ei.addTarget(o));let s=document.createElement("div");s.classList.add("tab-border-top-container"),o.appendChild(s);let a=this.tabResourceLabels.create(o,{hoverDelegate:this.getHoverDelegate()}),l=document.createElement("div");l.classList.add("tab-actions"),o.appendChild(l);let d=this,c=new nS({groupId:this.groupView.id,get editorIndex(){return d.toEditorIndex(t)}}),u=new Pn(l,{ariaLabel:h("ariaLabelTabActions","Tab actions"),actionRunner:c}),p=u.onWillRun(v=>{v.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()}),m=un(u,p,te(am(this.tabActionBars,u))),f=document.createElement("div");f.classList.add("tab-fade-hider"),o.appendChild(f);let g=document.createElement("div");g.classList.add("tab-border-bottom-container"),o.appendChild(g);let b=this.registerTabListeners(o,t,i,n);return this.tabDisposables.push(un(b,m,c,a)),o}toEditorIndex(t){let i=at(this.tabsModel.getEditorByIndex(t));return this.groupView.getIndexOfEditor(i)}lastSingleSelectSelectedEditor;registerTabListeners(t,i,n,o){let s=new Y,a=async(u,p)=>{if(t.blur(),yr(u)&&(u.button!==0||ke&&u.ctrlKey)){u.button===1&&u.preventDefault();return}if(this.originatesFromTabActionBar(u))return;let m=this.tabsModel.getEditorByIndex(i);if(m)if(u.shiftKey){let f;if(this.lastSingleSelectSelectedEditor&&this.tabsModel.isSelected(this.lastSingleSelectSelectedEditor))f=this.lastSingleSelectSelectedEditor;else{let g=at(this.groupView.activeEditor);this.lastSingleSelectSelectedEditor=g,f=g}await this.selectEditorsBetween(m,f)}else if(u.ctrlKey&&!ke||u.metaKey&&ke)this.tabsModel.isSelected(m)?await this.unselectEditor(m):(await this.selectEditor(m),this.lastSingleSelectSelectedEditor=m);else{let f=this.tabsModel.isSelected(m)?this.groupView.selectedEditors.filter(g=>!g.matches(m)):[];await this.groupView.openEditor(m,{preserveFocus:p,activation:1},{inactiveSelection:f,focusTabControl:!0})}},l=u=>{Oe.stop(u);let p=this.tabsModel.getEditorByIndex(i);p&&this.onTabContextMenu(p,u,t)};s.add(B(t,Q.MOUSE_DOWN,u=>a(u,!1))),s.add(B(t,it.Tap,u=>a(u,!0))),s.add(B(t,it.Change,u=>{o.setScrollPosition({scrollLeft:o.getScrollPosition().scrollLeft-u.translationX})})),s.add(B(t,Q.MOUSE_UP,async u=>{if(Oe.stop(u),t.blur(),yr(u)&&(u.button!==0||ke&&u.ctrlKey)||this.originatesFromTabActionBar(u))return;!(u.ctrlKey&&!ke||u.metaKey&&ke)&&!u.shiftKey&&this.groupView.selectedEditors.length>1&&await this.unselectAllEditors()})),s.add(B(t,Q.AUXCLICK,u=>{if(u.button===1){Oe.stop(u,!0);let p=this.tabsModel.getEditorByIndex(i);if(p){if(qg(this.tabsModel,p,2,this.groupsView.partOptions))return;this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(p)})}}})),s.add(B(t,Q.KEY_DOWN,u=>{let p=new bt(u);p.shiftKey&&p.keyCode===68&&l(u)})),s.add(B(t,it.Contextmenu,u=>{l(u)})),s.add(B(t,Q.KEY_UP,u=>{let p=new bt(u),m=!1;if(p.equals(3)||p.equals(10)){m=!0;let f=this.tabsModel.getEditorByIndex(i);f&&this.groupView.openEditor(f)}else if([15,17,16,18,14,13].some(f=>p.equals(f))){let f=this.toEditorIndex(i);p.equals(15)||p.equals(16)?f=f-1:p.equals(17)||p.equals(18)?f=f+1:p.equals(14)?f=0:f=this.groupView.count-1;let g=this.groupView.getEditorByIndex(f);g&&(m=!0,this.groupView.openEditor(g,{preserveFocus:!0},{focusTabControl:!0}))}m&&Oe.stop(u,!0),o.setScrollPosition({scrollLeft:n.scrollLeft})}));for(let u of[it.Tap,Q.DBLCLICK])s.add(B(t,u,p=>{if(u===Q.DBLCLICK)Oe.stop(p);else if(p.tapCount!==2)return;let m=this.tabsModel.getEditorByIndex(i);if(m&&this.tabsModel.isPinned(m))switch(this.groupsView.partOptions.doubleClickTabToToggleEditorGroupSizes){case"maximize":this.groupsView.toggleMaximizeGroup(this.groupView);break;case"expand":this.groupsView.toggleExpandGroup(this.groupView);break;case"off":break}else this.groupView.pinEditor(m)}));s.add(B(t,Q.CONTEXT_MENU,u=>{Oe.stop(u,!0);let p=this.tabsModel.getEditorByIndex(i);p&&this.onTabContextMenu(p,u,t)},!0));let d,c=!1;return s.add(new zr(t,{onDragStart:u=>{let p=this.tabsModel.getEditorByIndex(i);if(!p)return;c=this.isNewWindowOperation(u);let m=this.groupView.selectedEditors;if(this.editorTransfer.setData(m.map(f=>new Bs({editor:f,groupId:this.groupView.id})),Bs.prototype),u.dataTransfer)if(u.dataTransfer.effectAllowed="copyMove",m.length>1){let f=`${p.getName()} + ${m.length-1}`;yE(u,f,"monaco-editor-group-drag-image",this.getColor(yo),this.getColor(is))}else u.dataTransfer.setDragImage(t,0,0);this.doFillResourceDataTransfers(m,u,c),Yi(pe(this.parent),()=>this.updateDropFeedback(t,!1,u,i))},onDrag:u=>{d=u},onDragEnter:u=>{if(!this.isSupportedDropTransfer(u)){u.dataTransfer&&(u.dataTransfer.dropEffect="none");return}this.editorTransfer.hasData(Bs.prototype)||u.dataTransfer&&(u.dataTransfer.dropEffect="copy"),this.updateDropFeedback(t,!0,u,i)},onDragOver:(u,p)=>{if(p>=zn.DRAG_OVER_OPEN_TAB_THRESHOLD){let m=this.tabsModel.getEditorByIndex(i);m&&this.tabsModel.activeEditor!==m&&this.groupView.openEditor(m,{preserveFocus:!0})}this.updateDropFeedback(t,!0,u,i)},onDragEnd:async u=>{this.updateDropFeedback(t,!1,u,i);let p=this.editorTransfer.getData(Bs.prototype);if(this.editorTransfer.clearData(Bs.prototype),!c||pR()||!p||p.length===0)return;let m=await this.maybeCreateAuxiliaryEditorPartAt(u,t);if(!m)return;let f=m.activeGroup,g=p.map(b=>({editor:b.identifier.editor}));this.isMoveOperation(d??u,f.id,p[0].identifier.editor)?this.groupView.moveEditors(g,f):this.groupView.copyEditors(g,f),f.focus()},onDrop:u=>{this.updateDropFeedback(t,!1,u,i);let p=i;this.getTabDragOverLocation(u,t)==="right"&&p++,this.onDrop(u,p,n)}})),s}isSupportedDropTransfer(t){if(this.groupTransfer.hasData(Vs.prototype)){let i=this.groupTransfer.getData(Vs.prototype);return!(Array.isArray(i)&&i.length>0&&i[0].identifier===this.groupView.id)}return!!(this.editorTransfer.hasData(Bs.prototype)||t.dataTransfer&&t.dataTransfer.types.length>0)}updateDropFeedback(t,i,n,o){let s=typeof o=="number",a;i?s?a=this.computeDropTarget(n,o,t):a={leftElement:t.lastElementChild,rightElement:void 0}:a=void 0,this.updateDropTarget(a)}dropTarget;updateDropTarget(t){let i=this.dropTarget;if(i===t||i&&t&&i.leftElement===t.leftElement&&i.rightElement===t.rightElement)return;let n="drop-target-left",o="drop-target-right";i&&(i.leftElement?.classList.remove(n),i.rightElement?.classList.remove(o)),t&&(t.leftElement?.classList.add(n),t.rightElement?.classList.add(o)),this.dropTarget=t}getTabDragOverLocation(t,i){let n=i.getBoundingClientRect();return t.clientX-n.left<=n.width/2?"left":"right"}computeDropTarget(t,i,n){let o=this.getTabDragOverLocation(t,n)==="left",s=i===this.tabsModel.count-1;if(o&&i===0)return{leftElement:void 0,rightElement:n};if(!o&&s)return{leftElement:n,rightElement:void 0};let l=o?n.previousElementSibling:n,d=o?n:n.nextElementSibling;return{leftElement:l,rightElement:d}}async selectEditor(t){this.groupView.isActive(t)||await this.groupView.setSelection(t,this.groupView.selectedEditors)}async selectEditorsBetween(t,i){let n=this.groupView.getIndexOfEditor(t);if(n===-1)throw new Je;let o=this.groupView.getIndexOfEditor(i);if(o===-1)throw new Je;let s=this.groupView.selectedEditors,a=o;for(;a>=0&&a<=this.groupView.count-1;){a=o<n?a-1:a+1;let p=this.groupView.getEditorByIndex(a);if(!p||!this.groupView.isSelected(p))break;s=s.filter(m=>!m.matches(p))}let l=o<n?o:n,d=o<n?n:o,c=this.groupView.getEditors(1).slice(l,d+1);for(let p of c)this.groupView.isSelected(p)||s.push(p);let u=s.filter(p=>!p.matches(t));await this.groupView.setSelection(t,u)}async unselectEditor(t){let i=this.groupView.isActive(t);if(i&&this.groupView.selectedEditors.length===1)return;let n=at(this.groupView.activeEditor);if(i){let s=this.groupView.getEditors(0);for(let a=1;a<s.length;a++){let l=s[a];if(this.groupView.isSelected(l)){n=l;break}}}let o=this.groupView.selectedEditors.filter(s=>!s.matches(t)&&!s.matches(n));await this.groupView.setSelection(n,o)}async unselectAllEditors(){if(this.groupView.selectedEditors.length>1){let t=at(this.groupView.activeEditor);await this.groupView.setSelection(t,[])}}computeTabLabels(){let{labelFormat:t}=this.groupsView.partOptions,{verbosity:i,shortenDuplicates:n}=this.getLabelConfigFlags(t),o=[],s=-1;this.tabsModel.getEditors(1).forEach((a,l)=>{o.push({editor:a,name:a.getName(),description:a.getDescription(i),forceDescription:a.hasCapability(64),title:a.getTitle(2),ariaLabel:If(a,l,this.groupView,this.editorPartsView.count)}),a===this.tabsModel.activeEditor&&(s=l)}),n&&this.shortenTabLabels(o),this.tabLabels=o,this.activeTabLabel=o[s]}shortenTabLabels(t){let i=new Map;for(let n of t)typeof n.description=="string"?Td(i,n.name,[]).push(n):n.description="";for(let[,n]of i){if(n.length===1&&!n[0].forceDescription){n[0].description="";continue}let o=new Map;for(let d of n)Td(o,d.description,[]).push(d);let s=!1;for(let[,d]of o)if(!s&&d.length>1){let[c,...u]=d.map(({editor:p})=>p.getDescription(2));s=u.some(p=>p!==c)}if(s){o.clear();for(let d of n)d.description=d.editor.getDescription(2),Td(o,d.description,[]).push(d)}let a=[];for(let[d]of o)a.push(d);if(a.length===1){for(let d of o.get(a[0])||[])d.forceDescription||(d.description="");continue}let l=Jx(a,this.path.sep);a.forEach((d,c)=>{for(let u of o.get(d)||[])u.description=l[c]})}}getLabelConfigFlags(t){switch(t){case"short":return{verbosity:0,shortenDuplicates:!1};case"medium":return{verbosity:1,shortenDuplicates:!1};case"long":return{verbosity:2,shortenDuplicates:!1};default:return{verbosity:1,shortenDuplicates:!0}}}redraw(t){if(this.tabsAndActionsContainer){let i=this.getColor(e9);!i&&Ba(this.theme.type)&&(i=this.getColor(iD)||this.getColor(Ie)),i?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",i.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((i,n,o,s,a,l)=>{this.redrawTab(i,n,o,s,a,l)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,t)}redrawTab(t,i,n,o,s,a){let l=this.tabsModel.isSticky(i),d=this.groupsView.partOptions;this.redrawTabLabel(t,i,n,o,s);let c=l&&d.tabActionUnpinVisibility,u=!c&&d.tabActionCloseVisibility,p=c||u,m;p?m=c?this.unpinEditorAction:this.closeEditorAction:m=l?this.unpinEditorAction:this.closeEditorAction,a.hasAction(m)||(a.isEmpty()||a.clear(),a.push(m,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(m)})),n.classList.toggle("pinned-action-off",l&&!c),n.classList.toggle("close-action-off",!c&&!u);for(let g of["left","right"])n.classList.toggle(`tab-actions-${g}`,p&&d.tabActionLocation===g);let f=l&&d.pinnedTabSizing==="shrink"?"shrink":d.tabSizing;for(let g of["fit","shrink","fixed"])n.classList.toggle(`sizing-${g}`,f===g);n.classList.toggle("has-icon",d.showIcons&&d.hasIcons),n.classList.toggle("sticky",l);for(let g of["normal","compact","shrink"])n.classList.toggle(`sticky-${g}`,l&&d.pinnedTabSizing===g);if(!d.wrapTabs&&l&&d.pinnedTabSizing!=="normal"){let g=0;switch(d.pinnedTabSizing){case"compact":g=zn.TAB_WIDTH.compact;break;case"shrink":g=zn.TAB_WIDTH.shrink;break}n.style.left=`${i*g}px`}else n.style.left="auto";this.redrawTabBorders(i,n),this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,t,n,a)}redrawTabLabel(t,i,n,o,s){let a=this.groupsView.partOptions,l,d=!1,c=!!a.decorations?.badges,u=!!a.decorations?.colors,p;a.pinnedTabSizing==="compact"&&this.tabsModel.isSticky(i)?(l=a.showIcons&&a.hasIcons?"":s.name?.charAt(0).toUpperCase(),p="",d=!0,c=!1):(l=s.name,p=s.description||""),s.ariaLabel&&(n.setAttribute("aria-label",s.ariaLabel),n.setAttribute("aria-description","")),o.setResource({name:l,description:p,resource:Mt.getOriginalUri(t,{supportSideBySide:3})},{title:this.getHoverTitle(t),extraClasses:ni(["tab-label",c?"tab-label-has-badge":void 0].concat(t.getLabelExtraClasses())),italic:!this.tabsModel.isPinned(t),forceLabel:d,fileDecorations:{colors:u,badges:c},icon:t.getIcon(),hideIcon:a.showIcons===!1});let m=Mt.getOriginalUri(t,{supportSideBySide:1});m?n.setAttribute("data-resource-name",Fc(m)):n.removeAttribute("data-resource-name")}redrawTabSelectedActiveAndDirty(t,i,n,o){let s=this.tabsModel.isActive(i),a=this.doRedrawTabDirty(t,s,i,n);this.doRedrawTabActive(t,!a,i,n,o)}doRedrawTabActive(t,i,n,o,s){let a=this.tabsModel.isActive(n),l=this.tabsModel.isSelected(n);if(o.classList.toggle("active",a),o.classList.toggle("selected",l),o.setAttribute("aria-selected",a?"true":"false"),o.tabIndex=a?0:-1,s.setFocusable(a),a){let c=this.getColor(t?Q_:q7);o.classList.toggle("tab-border-bottom",!!c),o.style.setProperty("--tab-border-bottom-color",c??"")}let d=null;i&&(a&&(d=this.getColor(t?OI:$7)),d===null&&l&&(d=this.getColor(Y7))),o.classList.toggle("tab-border-top",!!d),o.style.setProperty("--tab-border-top-color",d??"")}doRedrawTabDirty(t,i,n,o){let s=!1;if(n.isDirty()&&!n.isSaving())if(o.classList.add("dirty"),this.groupsView.partOptions.highlightModifiedTabs){let a;t&&i?a=this.getColor(Cf):t&&!i?a=this.getColor(eD):!t&&i?a=this.getColor(X7):a=this.getColor(Q7),a&&(s=!0,o.classList.add("dirty-border-top"),o.style.setProperty("--tab-dirty-border-top-color",a))}else o.classList.remove("dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");else o.classList.remove("dirty","dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");return s}redrawTabBorders(t,i){let o=this.tabsModel.isSticky(t)&&this.tabsModel.stickyCount===t+1,s=this.tabsModel.stickyCount!==this.tabsModel.count,a=(o&&s?this.getColor(j7):void 0)||this.getColor(iD)||this.getColor(Ie);i.style.borderRight=a?`1px solid ${a}`:"",i.style.outlineColor=this.getColor(Ft)||""}prepareEditorActions(t){return this.groupsView.activeGroup===this.groupView?t:{primary:this.groupsView.partOptions.alwaysShowEditorActions?t.primary:t.primary.filter(n=>n.id===FC),secondary:t.secondary}}getHeight(){return this.dimensions.used?this.dimensions.used.height:this.computeHeight()}computeHeight(){let t;return this.visible?this.groupsView.partOptions.wrapTabs&&this.tabsAndActionsContainer?.classList.contains("wrapping")?t=this.tabsAndActionsContainer.offsetHeight:t=this.tabHeight:t=0,t}layout(t,i){if(Object.assign(this.dimensions,t),this.visible){if(!this.layoutScheduler.value){let n=Yi(pe(this.parent),()=>{this.doLayout(this.dimensions,this.layoutScheduler.value?.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:i,dispose:()=>n.dispose()}}i?.forceRevealActiveTab&&(this.layoutScheduler.value.options={...this.layoutScheduler.value.options,forceRevealActiveTab:!0})}return this.dimensions.used||(this.dimensions.used=new At(t.container.width,this.computeHeight())),this.dimensions.used}doLayout(t,i){t.container!==At.None&&t.available!==At.None&&this.doLayoutTabs(t,i);let n=this.dimensions.used,o=this.dimensions.used=new At(t.container.width,this.computeHeight());n&&n.height!==o.height&&this.groupView.relayout()}doLayoutTabs(t,i){this.doLayoutTabsWrapping(t)||this.doLayoutTabsNonWrapping(i)}doLayoutTabsWrapping(t){let[i,n,o,s]=Cl(this.tabsAndActionsContainer,this.tabsContainer,this.editorActionsToolbarContainer,this.tabsScrollbar),a=i.classList.contains("wrapping"),l=a;function d(c){l=c,i.classList.toggle("wrapping",l),n.style.setProperty("--last-tab-margin-right",l?`${o.offsetWidth}px`:"0");for(let u of n.children)u.classList.remove("last-in-row")}if(this.groupsView.partOptions.wrapTabs){let c=n.offsetWidth,u=n.scrollWidth,p=()=>{let m=this.getLastTab();return m?!(m.offsetWidth+o.offsetWidth-t.available.width>1):!0};(l||u>c&&p())&&d(!0),l&&(n.offsetHeight>t.available.height||u===c&&n.offsetHeight===this.tabHeight||!p())&&d(!1)}else a&&d(!1);if(l&&!a){let c=n.offsetWidth;s.setScrollDimensions({width:c,scrollWidth:c})}if(l){let c=new Map,u,p;for(let m of n.children){let f=m,g=f.offsetTop;g!==u&&(u=g,p&&c.set(p,!0)),p=f,c.set(f,!1)}p&&c.set(p,!0);for(let[m,f]of c)m.classList.toggle("last-in-row",f)}return l}doLayoutTabsNonWrapping(t){let[i,n]=Cl(this.tabsContainer,this.tabsScrollbar),o=i.offsetWidth,s=i.scrollWidth,a=0;if(this.tabsModel.stickyCount>0){let S=0;switch(this.groupsView.partOptions.pinnedTabSizing){case"compact":S=zn.TAB_WIDTH.compact;break;case"shrink":S=zn.TAB_WIDTH.shrink;break}a=this.tabsModel.stickyCount*S}let l=this.tabsModel.activeEditor?this.getTabAndIndex(this.tabsModel.activeEditor):void 0,[d,c]=l??[void 0,void 0],u=this.groupsView.partOptions.pinnedTabSizing!=="normal"&&typeof c=="number"&&this.tabsModel.isSticky(c),p=o-a;this.tabsModel.stickyCount>0&&p<zn.TAB_WIDTH.fit?(i.classList.add("disable-sticky-tabs"),p=o,a=0,u=!1):i.classList.remove("disable-sticky-tabs");let m,f;!this.blockRevealActiveTab&&d&&(m=d.offsetLeft,f=d.offsetWidth);let{width:g,scrollWidth:b}=n.getScrollDimensions();n.setScrollDimensions({width:o,scrollWidth:s});let v=g!==o||b!==s;if(this.blockRevealActiveTab||typeof m!="number"||typeof f!="number"||u||!v&&!t?.forceRevealActiveTab){this.blockRevealActiveTab=!1;return}let I=n.getScrollPosition().scrollLeft,w=f<=p,E=m-a;w&&I+p<E+f?n.setScrollPosition({scrollLeft:I+(E+f-(I+p))}):(I>E||!w)&&n.setScrollPosition({scrollLeft:E})}updateTabsControlVisibility(){at(this.tabsAndActionsContainer).classList.toggle("empty",!this.visible),!this.visible&&this.dimensions&&(this.dimensions.used=void 0)}get visible(){return this.tabsModel.count>0}getTabAndIndex(t){let i=this.tabsModel.indexOf(t),n=this.getTabAtIndex(i);if(n)return[n,i]}getTabAtIndex(t){if(t>=0)return at(this.tabsContainer).children[t]}getLastTab(){return this.getTabAtIndex(this.tabsModel.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(t){let i;return yr(t)?i=t.target||t.srcElement:i=t.initialTarget,!!Am(i,"action-item","tab")}async onDrop(t,i,n){Oe.stop(t,!0),this.updateDropFeedback(n,!1,t,i),n.classList.remove("scroll");let o=this.tabsModel instanceof Gb?i+this.groupView.stickyCount:i,s={sticky:this.tabsModel instanceof Kb&&this.tabsModel.stickyCount===o,index:o};if(this.groupTransfer.hasData(Vs.prototype)){let a=this.groupTransfer.getData(Vs.prototype);if(Array.isArray(a)&&a.length>0){let l=this.editorPartsView.getGroup(a[0].identifier);if(l){let d={index:o};this.isMoveOperation(t,l.id)||(d.mode=0),this.groupsView.mergeGroup(l,this.groupView,d)}this.groupView.focus(),this.groupTransfer.clearData(Vs.prototype)}}else if(this.editorTransfer.hasData(Bs.prototype)){let a=this.editorTransfer.getData(Bs.prototype);if(Array.isArray(a)&&a.length>0){let l=this.editorPartsView.getGroup(a[0].identifier.groupId);if(l)for(let d of a){let c=d.identifier.editor;if(l.id!==d.identifier.groupId)continue;let u=l.getIndexOfEditor(c);l===this.groupView&&u<o&&o--,this.isMoveOperation(t,d.identifier.groupId,c)?l.moveEditor(c,this.groupView,{...s,index:o}):l.copyEditor(c,this.groupView,{...s,index:o}),o++}}this.groupView.focus(),this.editorTransfer.clearData(Bs.prototype)}else if(this.treeItemsTransfer.hasData(zb.prototype)){let a=this.treeItemsTransfer.getData(zb.prototype);if(Array.isArray(a)&&a.length>0){let l=[];for(let d of a){let c=await this.treeViewsDragAndDropService.removeDragOperationTransfer(d.identifier);if(c){let u=await eK(c);l.push(...u.map(p=>({...p,options:{...p.options,pinned:!0,index:o}})))}}this.editorService.openEditors(l,this.groupView,{validateTrust:!0})}this.treeItemsTransfer.clearData(zb.prototype)}else this.instantiationService.createInstance(Ju,{allowWorkspaceOpen:!1}).handleDrop(t,pe(this.parent),()=>this.groupView,()=>this.groupView.focus(),s)}dispose(){super.dispose(),this.tabDisposables=ht(this.tabDisposables)}};zn=R([y(5,Zi),y(6,ve),y(7,je),y(8,qt),y(9,Bo),y(10,$l),y(11,kt),y(12,vt),y(13,PC),y(14,OV),y(15,$u),y(16,eo)],zn);Fo((r,e)=>{let t=r.getColor(iD);t&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {
				border-bottom: 1px solid ${t};
			}
		`);let i=r.getColor(Ft);i&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {
				outline: 1px solid;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.selected:not(.active):not(:hover)  {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:focus {
				outline-style: dashed;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				outline: 1px dashed;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {
				opacity: 1 !important;
			}
		`);let n=r.getColor(Ie);n&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {
				outline: 1px solid ${n}
			}
		`);let o=r.getColor(Z_);o&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover {
				background-color: ${o} !important;
			}
		`);let s=r.getColor(K7);s&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {
				background-color: ${s} !important;
			}
		`);let a=r.getColor(X_);a&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover  {
				color: ${a} !important;
			}
		`);let l=r.getColor(G7);l&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {
				color: ${l} !important;
			}
		`);let d=r.getColor(J_);d&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${d};
			}
		`);let c=r.getColor(Z7);if(c&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${c};
			}
		`),!Ba(r.type)&&!Uo&&!i){let u=W7(r),p=r.getColor(pr),m=r.getColor(nD),f=r.getColor(oD),g;m&&p&&(g=m.flatten(p,p,u));let b;m&&p&&f&&p&&(b=m.flatten(p,f,p,u));let v=(D,L,A=!1)=>`
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${A?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${A?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${D}, transparent) !important;
			}

			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${A?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${A?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${L}, transparent) !important;
			}
		`;if(o&&g&&b){let D=o.flatten(g),L=o.flatten(b);e.addRule(v(D,L,!0))}if(s&&g&&b){let D=s.flatten(g),L=s.flatten(b);e.addRule(v(D,L))}if(f&&b){let D=f.flatten(b);e.addRule(`
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${D}, transparent) !important;
				}
		`)}let I=(D,L,A,W)=>`
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${A?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${W?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${A?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${W?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${D}, transparent);
				}

				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${A?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${W?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${A?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${W?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${L}, transparent);
				}
		`,w=r.getColor(tD);if(w&&g&&b){let D=w.flatten(g),L=w.flatten(b);e.addRule(I(D,L,!0,!0))}let E=r.getColor(H7);if(E&&g&&b){let D=E.flatten(g),L=E.flatten(b);e.addRule(I(D,L,!1,!0))}let S=r.getColor(MN);if(S&&g&&b){let D=S.flatten(g),L=S.flatten(b);e.addRule(I(D,L,!0,!1))}let T=r.getColor(U7);if(T&&g&&b){let D=T.flatten(g),L=T.flatten(b);e.addRule(I(D,L,!1,!1))}}});var PR=class extends Hs{titleContainer;editorLabel;activeLabel=Object.create(null);breadcrumbsControlFactory;get breadcrumbsControl(){return this.breadcrumbsControlFactory?.control}create(e){super.create(e);let t=this.titleContainer=e;t.draggable=!0,this.registerContainerListeners(t),this._register(ei.addTarget(t));let i=document.createElement("div");i.classList.add("label-container"),t.appendChild(i),this.editorLabel=this._register(this.instantiationService.createInstance(Nb,i,{hoverDelegate:this.getHoverDelegate()})).element,this._register(B(this.editorLabel.element,Q.CLICK,n=>this.onTitleLabelClick(n))),this.breadcrumbsControlFactory=this._register(this.instantiationService.createInstance(op,i,this.groupView,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:{...y_,breadcrumbsBackground:U.transparent.toString()},showPlaceholder:!1})),this._register(this.breadcrumbsControlFactory.onDidEnablementChange(()=>this.handleBreadcrumbsEnablementChange())),t.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register(te(()=>t.classList.remove("breadcrumbs"))),this.createEditorActionsToolBar(t,["title-actions"])}registerContainerListeners(e){let t,i=!1;this._register(new zr(e,{onDragStart:n=>{i=this.onGroupDragStart(n,e)},onDrag:n=>{t=n},onDragEnd:n=>{this.onGroupDragEnd(n,t,e,i)}})),this._register(B(e,Q.DBLCLICK,n=>this.onTitleDoubleClick(n))),this._register(B(e,Q.AUXCLICK,n=>this.onTitleAuxClick(n))),this._register(B(e,it.Tap,n=>this.onTitleTap(n)));for(let n of[Q.CONTEXT_MENU,it.Contextmenu])this._register(B(e,n,o=>{this.tabsModel.activeEditor&&this.onTabContextMenu(this.tabsModel.activeEditor,o,e)}))}onTitleLabelClick(e){Oe.stop(e,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(e){Oe.stop(e),this.groupView.pinEditor()}onTitleAuxClick(e){e.button===1&&this.tabsModel.activeEditor&&(Oe.stop(e,!0),qg(this.tabsModel,this.tabsModel.activeEditor,2,this.groupsView.partOptions)||this.groupView.closeEditor(this.tabsModel.activeEditor))}onTitleTap(e){let t=e.initialTarget;!ki(t)||!this.editorLabel||!An(t,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(e){return this.doHandleOpenEditor()}openEditors(e){return this.doHandleOpenEditor()}doHandleOpenEditor(){let e=this.ifActiveEditorChanged(()=>this.redraw());return e||this.ifActiveEditorPropertiesChanged(()=>this.redraw()),e}beforeCloseEditor(e){}closeEditor(e){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(e){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(e,t,i){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(e){this.ifEditorIsActive(e,()=>this.redraw())}stickEditor(e){}unstickEditor(e){}setActive(e){this.redraw()}updateEditorSelections(){}updateEditorLabel(e){this.ifEditorIsActive(e,()=>this.redraw())}updateEditorDirty(e){this.ifEditorIsActive(e,()=>{let t=at(this.titleContainer);e.isDirty()&&!e.isSaving()?t.classList.add("dirty"):t.classList.remove("dirty")})}updateOptions(e,t){super.updateOptions(e,t),(e.labelFormat!==t.labelFormat||!fi(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){at(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(e){return!this.activeLabel.editor&&this.tabsModel.activeEditor||this.activeLabel.editor&&!this.tabsModel.activeEditor||!this.activeLabel.editor||!this.tabsModel.isActive(this.activeLabel.editor)?(e(),!0):!1}ifActiveEditorPropertiesChanged(e){!this.activeLabel.editor||!this.tabsModel.activeEditor||this.activeLabel.pinned!==this.tabsModel.isPinned(this.tabsModel.activeEditor)&&e()}ifEditorIsActive(e,t){this.tabsModel.isActive(e)&&t()}redraw(){let e=this.tabsModel.activeEditor??void 0,t=this.groupsView.partOptions,i=e?this.tabsModel.isPinned(e):!1,n=this.groupsView.activeGroup===this.groupView;this.activeLabel={editor:e,pinned:i},this.breadcrumbsControl&&(n?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!i)):this.breadcrumbsControl.hide());let[o,s]=Cl(this.titleContainer,this.editorLabel);if(!e)o.classList.remove("dirty"),s.clear(),this.clearEditorActionsToolbar();else{this.updateEditorDirty(e);let{labelFormat:a}=this.groupsView.partOptions,l;this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||a==="default"&&!n?l="":l=e.getDescription(this.getVerbosity(a))||"",s.setResource({resource:Mt.getOriginalUri(e,{supportSideBySide:3}),name:e.getName(),description:l},{title:this.getHoverTitle(e),italic:!i,extraClasses:["single-tab","title-label"].concat(e.getLabelExtraClasses()),fileDecorations:{colors:!!t.decorations?.colors,badges:!!t.decorations?.badges},icon:e.getIcon(),hideIcon:t.showIcons===!1}),n?o.style.color=this.getColor(sc)||"":o.style.color=this.getColor(z7)||"",this.updateEditorActionsToolbar()}}getVerbosity(e){switch(e){case"short":return 0;case"long":return 2;default:return 1}}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(i=>i.id===NC||i.id===FC),secondary:e.secondary}}getHeight(){return this.tabHeight}layout(e){return this.breadcrumbsControl?.layout(void 0),new At(e.container.width,this.getHeight())}};var jb=class extends P{constructor(t,i,n,o,s,a){super();this.parent=t;this.groupsView=n;this.groupView=o;this.model=s;this.instantiationService=a;let l=this._register(new Kb(this.model)),d=this._register(new Gb(this.model));this.stickyEditorTabsControl=this._register(this.instantiationService.createInstance(zn,this.parent,i,this.groupsView,this.groupView,l)),this.unstickyEditorTabsControl=this._register(this.instantiationService.createInstance(zn,this.parent,i,this.groupsView,this.groupView,d)),this.handleTabBarsStateChange()}stickyEditorTabsControl;unstickyEditorTabsControl;activeControl;handleTabBarsStateChange(){this.activeControl=this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0,this.handleTabBarsLayoutChange()}handleTabBarsLayoutChange(){if(this.groupView.count===0)return;let t=this.parent.classList.contains("two-tab-bars"),i=this.groupView.count!==this.groupView.stickyCount&&this.groupView.stickyCount>0;this.parent.classList.toggle("two-tab-bars",i),t!==i&&this.groupView.relayout()}didActiveControlChange(){return this.activeControl!==(this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0)}getEditorTabsController(t){return this.model.isSticky(t)?this.stickyEditorTabsControl:this.unstickyEditorTabsControl}openEditor(t,i){let n=this.didActiveControlChange(),s=this.getEditorTabsController(t).openEditor(t,i)||n;return s&&this.handleOpenedEditors(),s}openEditors(t){let i=t.filter(d=>this.model.isSticky(d)),n=t.filter(d=>!this.model.isSticky(d)),o=this.didActiveControlChange(),s=this.stickyEditorTabsControl.openEditors(i),a=this.unstickyEditorTabsControl.openEditors(n),l=s||a||o;return l&&this.handleOpenedEditors(),l}handleOpenedEditors(){this.handleTabBarsStateChange()}beforeCloseEditor(t){this.getEditorTabsController(t).beforeCloseEditor(t)}closeEditor(t){this.stickyEditorTabsControl.closeEditor(t),this.unstickyEditorTabsControl.closeEditor(t),this.handleClosedEditors()}closeEditors(t){let i=t.filter(o=>this.model.isSticky(o)),n=t.filter(o=>!this.model.isSticky(o));this.stickyEditorTabsControl.closeEditors(i),this.unstickyEditorTabsControl.closeEditors(n),this.handleClosedEditors()}handleClosedEditors(){this.handleTabBarsStateChange()}moveEditor(t,i,n,o){o?(this.model.isSticky(t)?(this.stickyEditorTabsControl.openEditor(t),this.unstickyEditorTabsControl.closeEditor(t)):(this.stickyEditorTabsControl.closeEditor(t),this.unstickyEditorTabsControl.openEditor(t)),this.handleTabBarsStateChange()):this.model.isSticky(t)?this.stickyEditorTabsControl.moveEditor(t,i,n,o):this.unstickyEditorTabsControl.moveEditor(t,i-this.model.stickyCount,n-this.model.stickyCount,o)}pinEditor(t){this.getEditorTabsController(t).pinEditor(t)}stickEditor(t){this.unstickyEditorTabsControl.closeEditor(t),this.stickyEditorTabsControl.openEditor(t),this.handleTabBarsStateChange()}unstickEditor(t){this.stickyEditorTabsControl.closeEditor(t),this.unstickyEditorTabsControl.openEditor(t),this.handleTabBarsStateChange()}setActive(t){this.stickyEditorTabsControl.setActive(t),this.unstickyEditorTabsControl.setActive(t)}updateEditorSelections(){this.stickyEditorTabsControl.updateEditorSelections(),this.unstickyEditorTabsControl.updateEditorSelections()}updateEditorLabel(t){this.getEditorTabsController(t).updateEditorLabel(t)}updateEditorDirty(t){this.getEditorTabsController(t).updateEditorDirty(t)}updateOptions(t,i){this.stickyEditorTabsControl.updateOptions(t,i),this.unstickyEditorTabsControl.updateOptions(t,i)}layout(t){let i=this.stickyEditorTabsControl.layout(t),n={container:t.container,available:new At(t.available.width,t.available.height-i.height)},o=this.unstickyEditorTabsControl.layout(n);return new At(t.container.width,i.height+o.height)}getHeight(){return this.stickyEditorTabsControl.getHeight()+this.unstickyEditorTabsControl.getHeight()}dispose(){this.parent.classList.toggle("two-tab-bars",!1),super.dispose()}};jb=R([y(5,ve)],jb);var NR=class extends Hs{activeEditor=null;prepareEditorActions(e){return{primary:[],secondary:[]}}openEditor(e){return this.handleOpenedEditors()}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){let e=this.activeEditorChanged();return this.activeEditor=this.tabsModel.activeEditor,e}activeEditorChanged(){return!!(!this.activeEditor&&this.tabsModel.activeEditor||this.activeEditor&&!this.tabsModel.activeEditor||!this.activeEditor||!this.tabsModel.isActive(this.activeEditor))}beforeCloseEditor(e){}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){this.activeEditor=this.tabsModel.activeEditor}moveEditor(e,t,i){}pinEditor(e){}stickEditor(e){}unstickEditor(e){}setActive(e){}updateEditorSelections(){}updateEditorLabel(e){}updateEditorDirty(e){}getHeight(){return 0}layout(e){return new At(e.container.width,this.getHeight())}};var qb=class extends ta{constructor(t,i,n,o,s,a,l){super(l);this.parent=t;this.editorPartsView=i;this.groupsView=n;this.groupView=o;this.model=s;this.instantiationService=a;this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()}editorTabsControl;editorTabsControlDisposable=this._register(new Y);breadcrumbsControlFactory;breadcrumbsControlDisposables=this._register(new Y);get breadcrumbsControl(){return this.breadcrumbsControlFactory?.control}createEditorTabsControl(){let t;switch(this.groupsView.partOptions.showTabs){case"none":t=NR;break;case"single":t=PR;break;case"multiple":default:t=this.groupsView.partOptions.pinnedTabsOnSeparateRow?jb:zn;break}let i=this.instantiationService.createInstance(t,this.parent,this.editorPartsView,this.groupsView,this.groupView,this.model);return this.editorTabsControlDisposable.add(i)}createBreadcrumbsControl(){if(this.groupsView.partOptions.showTabs==="single")return;let t=document.createElement("div");t.classList.add("breadcrumbs-below-tabs"),this.parent.appendChild(t);let i=this.breadcrumbsControlDisposables.add(this.instantiationService.createInstance(op,t,this.groupView,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0}));return this.breadcrumbsControlDisposables.add(i.onDidEnablementChange(()=>this.groupView.relayout())),this.breadcrumbsControlDisposables.add(i.onDidVisibilityChange(()=>this.groupView.relayout())),i}openEditor(t,i){let n=this.editorTabsControl.openEditor(t,i);this.handleOpenedEditors(n)}openEditors(t){let i=this.editorTabsControl.openEditors(t);this.handleOpenedEditors(i)}handleOpenedEditors(t){t?this.breadcrumbsControl?.update():this.breadcrumbsControl?.revealLast()}beforeCloseEditor(t){return this.editorTabsControl.beforeCloseEditor(t)}closeEditor(t){this.editorTabsControl.closeEditor(t),this.handleClosedEditors()}closeEditors(t){this.editorTabsControl.closeEditors(t),this.handleClosedEditors()}handleClosedEditors(){this.groupView.activeEditor||this.breadcrumbsControl?.update()}moveEditor(t,i,n,o){return this.editorTabsControl.moveEditor(t,i,n,o)}pinEditor(t){return this.editorTabsControl.pinEditor(t)}stickEditor(t){return this.editorTabsControl.stickEditor(t)}unstickEditor(t){return this.editorTabsControl.unstickEditor(t)}setActive(t){return this.editorTabsControl.setActive(t)}updateEditorSelections(){this.editorTabsControl.updateEditorSelections()}updateEditorLabel(t){return this.editorTabsControl.updateEditorLabel(t)}updateEditorDirty(t){return this.editorTabsControl.updateEditorDirty(t)}updateOptions(t,i){t.showTabs!==i.showTabs||i.showTabs!=="single"&&t.pinnedTabsOnSeparateRow!==i.pinnedTabsOnSeparateRow?(this.editorTabsControlDisposable.clear(),this.breadcrumbsControlDisposables.clear(),Xt(this.parent),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()):this.editorTabsControl.updateOptions(t,i)}layout(t){let i=this.editorTabsControl.layout(t),n;return this.breadcrumbsControl?.isHidden()===!1&&(n=new At(t.container.width,Wt.HEIGHT),this.breadcrumbsControl.layout(n)),new At(t.container.width,i.height+(n?n.height:0))}getHeight(){let t=this.editorTabsControl.getHeight(),i=this.breadcrumbsControl?.isHidden()===!1?Wt.HEIGHT:0;return{total:t+i,offset:t}}};qb=R([y(5,ve),y(6,kt)],qb);var ds=class extends ta{constructor(t,i,n,o,s,a,l,d,c,u,p,m,f,g,b,v,I,w,E,S,T,D){super(c);this.editorPartsView=i;this.groupsView=n;this.groupsLabel=o;this._index=s;this.instantiationService=l;this.contextKeyService=d;this.telemetryService=u;this.keybindingService=p;this.menuService=m;this.contextMenuService=f;this.fileDialogService=g;this.editorService=b;this.filesConfigurationService=v;this.uriIdentityService=I;this.logService=w;this.editorResolverService=E;this.hostService=S;this.dialogService=T;this.fileService=D;t instanceof ds?this.model=this._register(t.model.clone()):KO(t)?this.model=this._register(l.createInstance(Rs,t)):this.model=this._register(l.createInstance(Rs,void 0)),this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.element)),this.element.classList.add(...ni(["editor-group-container",this.model.isLocked?"locked":void 0])),this.registerContainerListeners(),this.createContainerToolbar(),this.createContainerContextMenu(),this._register(this.instantiationService.createInstance(Bb,this.element)),this.progressBar=this._register(new mf(this.element,v_)),this.progressBar.hide(),this.scopedInstantiationService=this._register(this.instantiationService.createChild(new ws([je,this.scopedContextKeyService],[Ug,this._register(new mR(this.progressBar,this))]))),this.resourceContext=this._register(this.scopedInstantiationService.createInstance(no)),this.handleGroupContextKeys(),this.titleContainer=document.createElement("div"),this.titleContainer.classList.add("title"),this.element.appendChild(this.titleContainer),this.titleControl=this._register(this.scopedInstantiationService.createInstance(qb,this.titleContainer,this.editorPartsView,this.groupsView,this,this.model)),this.editorContainer=document.createElement("div"),this.editorContainer.classList.add("editor-container"),this.element.appendChild(this.editorContainer),this.editorPane=this._register(this.scopedInstantiationService.createInstance(Fb,this.element,this.editorContainer,this)),this._onDidChange.input=this.editorPane.onDidChangeSizeConstraints,this.doTrackFocus(),this.updateTitleContainer(),this.updateContainer(),this.updateStyles(),(this.restoreEditors(t,a)??Promise.resolve()).finally(()=>{this.whenRestoredPromise.complete()}),this.registerListeners()}static createNew(t,i,n,o,s,a){return s.createInstance(ds,null,t,i,n,o,a)}static createFromSerialized(t,i,n,o,s,a,l){return a.createInstance(ds,t,i,n,o,s,l)}static createCopy(t,i,n,o,s,a,l){return a.createInstance(ds,t,i,n,o,s,l)}scopedContextKeyService;_onDidFocus=this._register(new _);onDidFocus=this._onDidFocus.event;_onWillDispose=this._register(new _);onWillDispose=this._onWillDispose.event;_onDidModelChange=this._register(new _);onDidModelChange=this._onDidModelChange.event;_onDidActiveEditorChange=this._register(new _);onDidActiveEditorChange=this._onDidActiveEditorChange.event;_onDidOpenEditorFail=this._register(new _);onDidOpenEditorFail=this._onDidOpenEditorFail.event;_onWillCloseEditor=this._register(new _);onWillCloseEditor=this._onWillCloseEditor.event;_onDidCloseEditor=this._register(new _);onDidCloseEditor=this._onDidCloseEditor.event;_onWillMoveEditor=this._register(new _);onWillMoveEditor=this._onWillMoveEditor.event;_onWillOpenEditor=this._register(new _);onWillOpenEditor=this._onWillOpenEditor.event;model;active;lastLayout;scopedInstantiationService;resourceContext;titleContainer;titleControl;progressBar;editorContainer;editorPane;disposedEditorsWorker=this._register(new wp(t=>this.handleDisposedEditors(t),0));mapEditorToPendingConfirmation=new Map;containerToolBarMenuDisposable=this._register(new xt);whenRestoredPromise=new ys;whenRestored=this.whenRestoredPromise.p;handleGroupContextKeys(){let t=this.editorPartsView.bind(M3,this),i=this.editorPartsView.bind(jk,this),n=this.editorPartsView.bind(qk,this),o=this.editorPartsView.bind($k,this),s=this.editorPartsView.bind(DC,this),a=this.editorPartsView.bind(N3,this),l=this.editorPartsView.bind(MC,this),d=B3.bindTo(this.scopedContextKeyService),c=V3.bindTo(this.scopedContextKeyService),u=W3.bindTo(this.scopedContextKeyService),p=this.editorPartsView.bind(kC,this),m=this.editorPartsView.bind(O3,this),f=this.editorPartsView.bind(P3,this),g=this.editorPartsView.bind(Yk,this),b=this.editorPartsView.bind(zB,this),v=this.editorPartsView.bind(KB,this),I=this.editorPartsView.bind(Zk,this),w=this.editorPartsView.bind(RC,this),E=this.editorPartsView.bind(LC,this),S=this.editorPartsView.bind(AC,this),T=this._register(new xt),D=()=>{T.clear(),this.scopedContextKeyService.bufferChangeEvents(()=>{let A=this.activeEditor,W=this.activeEditorPane;if(this.resourceContext.set(Mt.getOriginalUri(A,{supportSideBySide:1})),Xk(w,A,this.editorResolverService),A?(E.set(A.hasCapability(32)),S.set(A.typeId===xi.ID),t.set(A.isDirty()&&!A.isSaving()),T.value=A.onDidChangeDirty(()=>{t.set(A.isDirty()&&!A.isSaving())})):(E.set(!1),S.set(!1),t.set(!1)),W){p.set(W.getId()),f.set(!W.input.hasCapability(4)),m.set(!!W.input.isReadonly());let j=Mt.getOriginalUri(W.input,{supportSideBySide:1}),G=Mt.getOriginalUri(W.input,{supportSideBySide:2});b.set(W.input instanceof Jo&&!W.input.original.isReadonly()&&!!j&&(this.fileService.hasProvider(j)||j.scheme===ue.untitled)&&!!G&&(this.fileService.hasProvider(G)||G.scheme===ue.untitled)),g.set(!!j&&this.fileService.hasProvider(j)&&!this.fileService.hasCapability(j,2048));let oe=W?.getId()===jg;I.set(oe),v.set(oe)}else p.reset(),f.reset(),m.reset(),b.reset(),g.reset()})},L=A=>{switch(A.kind){case 3:l.set(this.isLocked);break;case 8:n.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor)),i.set(this.model.activeEditor?this.model.isPinned(this.model.activeEditor):!1),s.set(this.model.activeEditor?this.model.isSticky(this.model.activeEditor):!1);break;case 6:i.set(this.model.activeEditor?this.model.isPinned(this.model.activeEditor):!1),s.set(this.model.activeEditor?this.model.isSticky(this.model.activeEditor):!1);case 5:case 7:n.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor));break;case 11:A.editor&&A.editor===this.model.activeEditor&&i.set(this.model.isPinned(this.model.activeEditor));break;case 13:A.editor&&A.editor===this.model.activeEditor&&s.set(this.model.isSticky(this.model.activeEditor));break;case 4:d.set(this.model.selectedEditors.length>1),c.set(this.model.selectedEditors.length===2),u.set(this.model.selectedEditors.every(W=>W.resource&&(this.fileService.hasProvider(W.resource)||W.resource.scheme===ue.untitled)));break}a.set(this.count)};this._register(this.onDidModelChange(A=>L(A))),this._register(this.onDidActiveEditorChange(()=>D())),D(),L({kind:8}),L({kind:3})}registerContainerListeners(){this._register(B(this.element,Q.DBLCLICK,t=>{this.isEmpty&&(Oe.stop(t),this.editorService.openEditor({resource:void 0,options:{pinned:!0,override:Iu.id}},this.id))})),this._register(B(this.element,Q.AUXCLICK,t=>{this.isEmpty&&t.button===1&&(Oe.stop(t,!0),this.groupsView.removeGroup(this))}))}createContainerToolbar(){let t=document.createElement("div");t.classList.add("editor-group-container-toolbar"),this.element.appendChild(t);let i=this._register(new Pn(t,{ariaLabel:h("ariaLabelGroupActions","Empty editor group actions"),highlightToggledItems:!0})),n=this._register(this.menuService.createMenu(nt.EmptyEditorGroup,this.scopedContextKeyService)),o=()=>{let s={primary:[],secondary:[]};this.containerToolBarMenuDisposable.value=te(()=>i.clear()),zu(n,{arg:{groupId:this.id},shouldForwardArgs:!0},s,"navigation");for(let a of[...s.primary,...s.secondary]){let l=this.keybindingService.lookupKeybinding(a.id);i.push(a,{icon:!0,label:!1,keybinding:l?.getLabel()})}};o(),this._register(n.onDidChange(o))}createContainerContextMenu(){this._register(B(this.element,Q.CONTEXT_MENU,t=>this.onShowContainerContextMenu(t))),this._register(B(this.element,it.Contextmenu,()=>this.onShowContainerContextMenu()))}onShowContainerContextMenu(t){if(!this.isEmpty)return;let i=this.element;t&&(i=new Ei(pe(this.element),t)),this.contextMenuService.showContextMenu({menuId:nt.EmptyEditorGroupContext,contextKeyService:this.contextKeyService,getAnchor:()=>i,onHide:()=>{this.focus()}})}doTrackFocus(){let t=this._register(Mn(this.element));this._register(t.onDidFocus(()=>{this.isEmpty&&this._onDidFocus.fire()}));let i=n=>{let o;if(yr(n)){if(n.button!==0||ke&&n.ctrlKey)return;o=n.target}else o=n.initialTarget;Am(o,"monaco-action-bar",this.titleContainer)||Am(o,"monaco-breadcrumb-item",this.titleContainer)||setTimeout(()=>{this.focus()})};this._register(B(this.titleContainer,Q.MOUSE_DOWN,n=>i(n))),this._register(B(this.titleContainer,it.Tap,n=>i(n))),this._register(this.editorPane.onDidFocus(()=>{this._onDidFocus.fire()}))}updateContainer(){this.isEmpty?(this.element.classList.add("empty"),this.element.tabIndex=0,this.element.setAttribute("aria-label",h("emptyEditorGroup","{0} (empty)",this.ariaLabel))):(this.element.classList.remove("empty"),this.element.removeAttribute("tabIndex"),this.element.removeAttribute("aria-label")),this.updateStyles()}updateTitleContainer(){this.titleContainer.classList.toggle("tabs",this.groupsView.partOptions.showTabs==="multiple"),this.titleContainer.classList.toggle("show-file-icons",this.groupsView.partOptions.showIcons)}restoreEditors(t,i){if(this.count===0)return;let n;t instanceof ds?n=kN(t):n=Object.create(null);let o=this.model.activeEditor;if(!o)return;n.pinned=this.model.isPinned(o),n.sticky=this.model.isSticky(o),n.preserveFocus=!0;let s={preserveWindowOrder:!0,skipTitleUpdate:!0},a=mn(),l=this.doShowEditor(o,{active:!0,isNew:!1},n,s).then(()=>{this.groupsView.activeGroup===this&&a&&ho(a)&&!i?.preserveFocus&&this.focus()});return this.titleControl.openEditors(this.editors),l}registerListeners(){this._register(this.model.onDidModelChange(t=>this.onDidGroupModelChange(t))),this._register(this.groupsView.onDidChangeEditorPartOptions(t=>this.onDidChangeEditorPartOptions(t))),this._register(this.groupsView.onDidVisibilityChange(t=>this.onDidVisibilityChange(t))),this._register(this.onDidFocus(()=>this.onDidGainFocus()))}onDidGroupModelChange(t){switch(this._onDidModelChange.fire(t),t.kind){case 3:this.element.classList.toggle("locked",this.isLocked);break;case 4:this.onDidChangeEditorSelection();break}if(t.editor)switch(t.kind){case 5:t8(t)&&this.onDidOpenEditor(t.editor,t.editorIndex);break;case 6:i8(t)&&this.handleOnDidCloseEditor(t.editor,t.editorIndex,t.context,t.sticky);break;case 15:this.onWillDisposeEditor(t.editor);break;case 14:this.onDidChangeEditorDirty(t.editor);break;case 12:this.onDidChangeEditorTransient(t.editor);break;case 9:this.onDidChangeEditorLabel(t.editor);break}}onDidOpenEditor(t,i){this.telemetryService.publicLog("editorOpened",this.toEditorTelemetryDescriptor(t)),this.updateContainer()}handleOnDidCloseEditor(t,i,n,o){this._onWillCloseEditor.fire({groupId:this.id,editor:t,context:n,index:i,sticky:o});let s=[t];t instanceof xi&&s.push(t.primary,t.secondary);for(let a of s)this.canDispose(a)&&a.dispose();this.telemetryService.publicLog("editorClosed",this.toEditorTelemetryDescriptor(t)),this.updateContainer(),this._onDidCloseEditor.fire({groupId:this.id,editor:t,context:n,index:i,sticky:o})}canDispose(t){for(let i of this.editorPartsView.groups)if(i instanceof ds&&i.model.contains(t,{strictEquals:!0,supportSideBySide:4}))return!1;return!0}toResourceTelemetryDescriptor(t){if(!t)return;let i=t?t.scheme===ue.file?t.fsPath:t.path:void 0;if(!i)return;let n=Ep(t),o=n.indexOf("?");return n=o!==-1?n.substr(0,o):n,{mimeType:new KC(OK(t).join(", ")),scheme:t.scheme,ext:n,path:Ur(i)}}toEditorTelemetryDescriptor(t){let i=t.getTelemetryDescriptor(),n=Mt.getOriginalUri(t,{supportSideBySide:3});return X.isUri(n)?(i.resource=this.toResourceTelemetryDescriptor(n),i):(n&&(n.primary&&(i.resource=this.toResourceTelemetryDescriptor(n.primary)),n.secondary&&(i.resourceSecondary=this.toResourceTelemetryDescriptor(n.secondary))),i)}onWillDisposeEditor(t){this.disposedEditorsWorker.work(t)}handleDisposedEditors(t){let i,n=[];for(let o of t){let s=this.model.findEditor(o);if(!s)continue;let a=s[0];a.isDisposed()&&(this.model.isActive(a)?i=a:n.push(a))}for(let o of n)this.doCloseEditor(o,!0);i&&this.doCloseEditor(i,!0)}onDidChangeEditorPartOptions(t){this.updateTitleContainer(),this.titleControl.updateOptions(t.oldPartOptions,t.newPartOptions),(t.oldPartOptions.showTabs!==t.newPartOptions.showTabs||t.oldPartOptions.tabHeight!==t.newPartOptions.tabHeight||t.oldPartOptions.showTabs==="multiple"&&t.oldPartOptions.pinnedTabsOnSeparateRow!==t.newPartOptions.pinnedTabsOnSeparateRow)&&(this.relayout(),this.model.activeEditor&&this.titleControl.openEditors(this.model.getEditors(1))),this.updateStyles(),t.oldPartOptions.enablePreview&&!t.newPartOptions.enablePreview&&this.model.previewEditor&&this.pinEditor(this.model.previewEditor)}onDidChangeEditorDirty(t){this.pinEditor(t),this.titleControl.updateEditorDirty(t)}onDidChangeEditorTransient(t){!this.model.isTransient(t)&&!this.groupsView.partOptions.enablePreview&&this.pinEditor(t)}onDidChangeEditorLabel(t){this.titleControl.updateEditorLabel(t)}onDidChangeEditorSelection(){this.titleControl.updateEditorSelections()}onDidVisibilityChange(t){this.editorPane.setVisible(t)}onDidGainFocus(){this.activeEditor&&this.model.setTransient(this.activeEditor,!1)}get index(){return this._index}get label(){return this.groupsLabel?h("groupLabelLong","{0}: Group {1}",this.groupsLabel,this._index+1):h("groupLabel","Group {0}",this._index+1)}get ariaLabel(){return this.groupsLabel?h("groupAriaLabelLong","{0}: Editor Group {1}",this.groupsLabel,this._index+1):h("groupAriaLabel","Editor Group {0}",this._index+1)}_disposed=!1;get disposed(){return this._disposed}get isEmpty(){return this.count===0}get titleHeight(){return this.titleControl.getHeight()}notifyIndexChanged(t){this._index!==t&&(this._index=t,this.model.setIndex(t))}notifyLabelChanged(t){this.groupsLabel!==t&&(this.groupsLabel=t,this.model.setLabel(t))}setActive(t){this.active=t,!t&&this.activeEditor&&this.selectedEditors.length>1&&this.setSelection(this.activeEditor,[]),this.element.classList.toggle("active",t),this.element.classList.toggle("inactive",!t),this.titleControl.setActive(t),this.updateStyles(),this.model.setActive(void 0)}get id(){return this.model.id}get windowId(){return this.groupsView.windowId}get editors(){return this.model.getEditors(1)}get count(){return this.model.count}get stickyCount(){return this.model.stickyCount}get activeEditorPane(){return this.editorPane?this.editorPane.activeEditorPane??void 0:void 0}get activeEditor(){return this.model.activeEditor}get selectedEditors(){return this.model.selectedEditors}get previewEditor(){return this.model.previewEditor}isPinned(t){return this.model.isPinned(t)}isSticky(t){return this.model.isSticky(t)}isSelected(t){return this.model.isSelected(t)}isTransient(t){return this.model.isTransient(t)}isActive(t){return this.model.isActive(t)}async setSelection(t,i){this.isActive(t)?this.model.setSelection(t,i):await this.openEditor(t,{activation:1},{inactiveSelection:i})}contains(t,i){return this.model.contains(t,i)}getEditors(t,i){return this.model.getEditors(t,i)}findEditors(t,i){let n=this.uriIdentityService.asCanonicalUri(t);return this.getEditors(1).filter(o=>{if(o.resource&&Li(o.resource,n))return!0;if(i?.supportSideBySide===1||i?.supportSideBySide===4){let s=Mt.getCanonicalUri(o,{supportSideBySide:1});if(s&&Li(s,n))return!0}if(i?.supportSideBySide===2||i?.supportSideBySide===4){let s=Mt.getCanonicalUri(o,{supportSideBySide:2});if(s&&Li(s,n))return!0}return!1})}getEditorByIndex(t){return this.model.getEditorByIndex(t)}getIndexOfEditor(t){return this.model.indexOf(t)}isFirst(t){return this.model.isFirst(t)}isLast(t){return this.model.isLast(t)}focus(){this.activeEditorPane?this.activeEditorPane.focus():this.element.focus(),this._onDidFocus.fire()}pinEditor(t=this.activeEditor||void 0){if(t&&!this.model.isPinned(t)){let i=this.model.pin(t);i&&this.titleControl.pinEditor(i)}}stickEditor(t=this.activeEditor||void 0){this.doStickEditor(t,!0)}unstickEditor(t=this.activeEditor||void 0){this.doStickEditor(t,!1)}doStickEditor(t,i){if(t&&this.model.isSticky(t)!==i){let n=this.getIndexOfEditor(t),o=i?this.model.stick(t):this.model.unstick(t);if(!o)return;let s=this.getIndexOfEditor(o);s!==n&&this.titleControl.moveEditor(o,n,s,!0),i?this.titleControl.stickEditor(o):this.titleControl.unstickEditor(o)}}async openEditor(t,i,n){return this.doOpenEditor(t,i,{...n,supportSideBySide:3})}async doOpenEditor(t,i,n){if(!t||t.isDisposed())return;this._onWillOpenEditor.fire({editor:t,groupId:this.id});let o=i?.sticky||!this.groupsView.partOptions.enablePreview&&!i?.transient||t.isDirty()||(i?.pinned??typeof i?.index=="number")||typeof i?.index=="number"&&this.model.isSticky(i.index)||t.hasCapability(512),s={index:i?i.index:void 0,pinned:o,sticky:i?.sticky||typeof i?.index=="number"&&this.model.isSticky(i.index),transient:!!i?.transient,inactiveSelection:n?.inactiveSelection,active:this.count===0||!i||!i.inactive,supportSideBySide:n?.supportSideBySide};!s.active&&!s.pinned&&this.model.activeEditor&&!this.model.isPinned(this.model.activeEditor)&&(s.active=!0);let a=!1,l=!1;if(i?.activation===1?a=!0:i?.activation===2?l=!0:i?.activation===3?(a=!1,l=!1):s.active&&(a=!i||!i.preserveFocus,l=!a),typeof s.index=="number"){let p=this.model.indexOf(t);p!==-1&&p!==s.index&&this.doMoveEditorInsideGroup(t,s)}let{editor:d,isNew:c}=this.model.openEditor(t,s);c&&this.count===1&&this.editorPartsView.groups.length>1&&d.editorId&&this.groupsView.partOptions.autoLockGroups?.has(d.editorId)&&this.lock(!0);let u=this.doShowEditor(d,{active:!!s.active,isNew:c},i,n);return a?this.groupsView.activateGroup(this):l&&this.groupsView.restoreGroup(this),u}doShowEditor(t,i,n,o){let s;return i.active?s=(async()=>{let{pane:a,changed:l,cancelled:d,error:c}=await this.editorPane.openEditor(t,n,o,{newInGroup:i.isNew});if(!d)return l&&this._onDidActiveEditorChange.fire({editor:t}),c&&this._onDidOpenEditorFail.fire(t),!a&&this.activeEditor===t&&this.doCloseEditor(t,n?.preserveFocus,{fromError:!0}),a})():s=Promise.resolve(void 0),o?.skipTitleUpdate||this.titleControl.openEditor(t,o),s}async openEditors(t){let i=ni(t).filter(({editor:l})=>!l.isDisposed()),n=i.at(0);if(!n)return;let o={supportSideBySide:3};await this.doOpenEditor(n.editor,n.options,o);let s=i.slice(1),a=this.getIndexOfEditor(n.editor)+1;return await Rn.settled(s.map(({editor:l,options:d},c)=>this.doOpenEditor(l,{...d,inactive:!0,pinned:!0,index:a+c},{...o,skipTitleUpdate:!0}))),this.titleControl.openEditors(s.map(({editor:l})=>l)),this.editorPane.activeEditorPane??void 0}moveEditors(t,i){let n={skipTitleUpdate:this!==i},o=!1,s=new Set;for(let{editor:a,options:l}of t)this.moveEditor(a,i,l,n)?s.add(a):o=!0;return n.skipTitleUpdate&&(i.titleControl.openEditors(Array.from(s)),this.titleControl.closeEditors(Array.from(s))),!o}moveEditor(t,i,n,o){return this===i?(this.doMoveEditorInsideGroup(t,n),!0):this.doMoveOrCopyEditorAcrossGroups(t,i,n,{...o,keepCopy:!1})}doMoveEditorInsideGroup(t,i){let n=i?i.index:void 0;if(typeof n!="number")return;let o=this.model.indexOf(t),s=this.model.getEditorByIndex(o);if(s){if(o!==n){let a=this.model.stickyCount;this.model.moveEditor(s,n),this.model.pin(s),this.titleControl.moveEditor(s,o,n,a!==this.model.stickyCount),this.titleControl.pinEditor(s)}i?.sticky&&this.stickEditor(s)}}doMoveOrCopyEditorAcrossGroups(t,i,n,o){let s=o?.keepCopy;if(!s||t.hasCapability(8)){let l=t.canMove(this.id,i.id);if(typeof l=="string")return this.dialogService.error(l,h("moveErrorDetails","Try saving or reverting the editor first and then try again.")),!1}let a=kN(this,t,{...n,pinned:!0,sticky:n?.sticky??(!s&&this.model.isSticky(t))});return s||this._onWillMoveEditor.fire({groupId:this.id,editor:t,target:i.id}),i.doOpenEditor(s?t.copy():t,a,o),s||this.doCloseEditor(t,!0,{...o,context:2}),!0}copyEditors(t,i){let n={skipTitleUpdate:this!==i};for(let{editor:o,options:s}of t)this.copyEditor(o,i,s,n);if(n.skipTitleUpdate){let o=t.map(({editor:s})=>s);i.titleControl.openEditors(o)}}copyEditor(t,i,n,o){this===i?this.doMoveEditorInsideGroup(t,n):this.doMoveOrCopyEditorAcrossGroups(t,i,n,{...o,keepCopy:!0})}async closeEditor(t=this.activeEditor||void 0,i){return this.doCloseEditorWithConfirmationHandling(t,i)}async doCloseEditorWithConfirmationHandling(t=this.activeEditor||void 0,i,n){return!t||await this.handleCloseConfirmation([t])?!1:(this.doCloseEditor(t,i?.preserveFocus,n),!0)}doCloseEditor(t,i=this.groupsView.activeGroup!==this,n){n?.skipTitleUpdate||this.titleControl.beforeCloseEditor(t),this.model.isActive(t)?this.doCloseActiveEditor(i,n):this.doCloseInactiveEditor(t,n),n?.skipTitleUpdate||this.titleControl.closeEditor(t)}doCloseActiveEditor(t=this.groupsView.activeGroup!==this,i){let n=this.activeEditor,o=!t&&this.shouldRestoreFocus(this.element),s=this.groupsView.partOptions.closeEmptyGroups;if(s&&this.active&&this.count===1){let d=this.groupsView.getGroups(1)[1];d&&(o?d.focus():this.groupsView.activateGroup(d,!0))}n&&this.model.closeEditor(n,i?.context);let a=this.model.activeEditor;if(a){let l;t&&this.groupsView.activeGroup!==this&&(l=3);let d={preserveFocus:t,activation:l,ignoreError:i?.fromError},c={preserveWindowOrder:!0};this.doOpenEditor(a,d,c)}else n&&this.editorPane.closeEditor(n),o&&!s&&this.focus(),this._onDidActiveEditorChange.fire({editor:void 0}),s&&this.groupsView.removeGroup(this,t)}shouldRestoreFocus(t){let i=mn();return i===t.ownerDocument.body?!0:An(i,t)}doCloseInactiveEditor(t,i){this.model.closeEditor(t,i?.context)}async handleCloseConfirmation(t){if(!t.length)return!1;let i=t.shift(),n=this.mapEditorToPendingConfirmation.get(i);n||(n=this.doHandleCloseConfirmation(i),this.mapEditorToPendingConfirmation.set(i,n));let o;try{o=await n}finally{this.mapEditorToPendingConfirmation.delete(i)}return o||this.handleCloseConfirmation(t)}async doHandleCloseConfirmation(t,i){if(!this.shouldConfirmClose(t)||t instanceof xi&&this.model.contains(t.primary)||this.editorPartsView.groups.some(a=>{if(a===this)return!1;let l=a;return!!(l.contains(t,{supportSideBySide:3})||t instanceof xi&&l.contains(t.primary))}))return!1;let n=2,o=1,s=!1;if(!t.hasCapability(4)&&!i?.skipAutoSave&&!t.closeHandler&&(this.filesConfigurationService.getAutoSaveMode(t).mode===3?(s=!0,n=0,o=3):Pr&&(dt||_t)&&this.filesConfigurationService.getAutoSaveMode(t).mode===4&&(s=!0,n=0,o=4)),!s)if((!this.activeEditor||!this.activeEditor.matches(t))&&await this.doOpenEditor(t),await this.hostService.focus(pe(this.element)),typeof t.closeHandler?.confirm=="function")n=await t.closeHandler.confirm([{editor:t,groupId:this.id}]);else{let a;t instanceof xi?a=t.primary.getName():a=t.getName(),n=await this.fileDialogService.showSaveConfirm([a])}if(!t.closeHandler&&!this.shouldConfirmClose(t))return n===2;switch(n){case 0:return!await t.save(this.id,{reason:o})&&s?this.doHandleCloseConfirmation(t,{skipAutoSave:!0}):t.isDirty();case 1:try{return await t.revert(this.id),t.isDirty()}catch(a){return this.logService.error(a),await t.revert(this.id,{soft:!0}),t.isDirty()}case 2:return!0}}shouldConfirmClose(t){return t.closeHandler?t.closeHandler.showConfirm():t.isDirty()&&!t.isSaving()}async closeEditors(t,i){if(this.isEmpty)return!0;let n=this.doGetEditorsToClose(t);return await this.handleCloseConfirmation(n.slice(0))?!1:(this.doCloseEditors(n,i),!0)}doGetEditorsToClose(t){if(Array.isArray(t))return t;let i=t,n=typeof i.direction=="number",o=this.model.getEditors(n?1:0,i);return i.savedOnly?o=o.filter(s=>!s.isDirty()||s.isSaving()):n&&i.except?o=i.direction===0?o.slice(0,this.model.indexOf(i.except,o)):o.slice(this.model.indexOf(i.except,o)+1):i.except&&(o=o.filter(s=>i.except&&!s.matches(i.except))),o}doCloseEditors(t,i){let n=!1;for(let o of t)this.isActive(o)?n=!0:this.doCloseInactiveEditor(o);n&&this.doCloseActiveEditor(i?.preserveFocus),t.length&&this.titleControl.closeEditors(t)}async closeAllEditors(t){if(this.isEmpty)return this.groupsView.partOptions.closeEmptyGroups&&this.groupsView.removeGroup(this),!0;let i=this.model.getEditors(0,t);return t?.excludeConfirming&&(i=i.filter(o=>!this.shouldConfirmClose(o))),await this.handleCloseConfirmation(i)?!1:(this.doCloseAllEditors(t),!0)}doCloseAllEditors(t){let i=this.model.getEditors(1,t);t?.excludeConfirming&&(i=i.filter(o=>!this.shouldConfirmClose(o)));let n=[];for(let o of i)this.isActive(o)||this.doCloseInactiveEditor(o),n.push(o);this.activeEditor&&n.includes(this.activeEditor)&&this.doCloseActiveEditor(),n.length&&this.titleControl.closeEditors(n)}async replaceEditors(t){let i,n=[];for(let{editor:o,replacement:s,forceReplaceDirty:a,options:l}of t){let d=this.getIndexOfEditor(o);if(d>=0){let c=this.isActive(o);l?l.index=d:l={index:d},l.inactive=!c,l.pinned=l.pinned??!0;let u={editor:o,replacement:s,forceReplaceDirty:a,options:l};c?i=u:n.push(u)}}for(let{editor:o,replacement:s,forceReplaceDirty:a,options:l}of n)if(await this.doOpenEditor(s,l),!o.matches(s)){let d=!1;if(a?(this.doCloseEditor(o,!0,{context:1}),d=!0):d=await this.doCloseEditorWithConfirmationHandling(o,{preserveFocus:!0},{context:1}),!d)return}if(i){let o=this.doOpenEditor(i.replacement,i.options);i.editor.matches(i.replacement)||(i.forceReplaceDirty?this.doCloseEditor(i.editor,!0,{context:1}):await this.doCloseEditorWithConfirmationHandling(i.editor,{preserveFocus:!0},{context:1})),await o}}get isLocked(){return this.model.isLocked}lock(t){this.model.lock(t)}createEditorActions(t){let i=[],n=[],o,s=this.activeEditorPane;if(s instanceof od){let a=s.scopedContextKeyService??this.scopedContextKeyService,l=t.add(this.menuService.createMenu(nt.EditorTitle,a,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:0}));o=l.onDidChange;let d=(c,u)=>u==="navigation"&&c.actions.length<=1;zu(l,{arg:this.resourceContext.get(),shouldForwardArgs:!0},{primary:i,secondary:n},"navigation",d)}else{let a=t.add(new _);o=a.event,t.add(this.onDidActiveEditorChange(()=>a.fire()))}return{actions:{primary:i,secondary:n},onDidChange:o}}updateStyles(){let t=this.isEmpty;t?this.element.style.backgroundColor=this.getColor(J7)||"":this.element.style.backgroundColor="";let i=this.getColor(i9)||this.getColor(Ie);!t&&i?(this.titleContainer.classList.add("title-border-bottom"),this.titleContainer.style.setProperty("--title-border-bottom-color",i)):(this.titleContainer.classList.remove("title-border-bottom"),this.titleContainer.style.removeProperty("--title-border-bottom-color"));let{showTabs:n}=this.groupsView.partOptions;this.titleContainer.style.backgroundColor=this.getColor(n==="multiple"?nD:t9)||"",this.editorContainer.style.backgroundColor=this.getColor(pr)||""}element=document.createElement("div");get minimumWidth(){return this.editorPane.minimumWidth}get minimumHeight(){return this.editorPane.minimumHeight}get maximumWidth(){return this.editorPane.maximumWidth}get maximumHeight(){return this.editorPane.maximumHeight}get proportionalLayout(){return this.lastLayout?!(this.lastLayout.width===this.minimumWidth||this.lastLayout.height===this.minimumHeight):!0}_onDidChange=this._register(new Wr);onDidChange=this._onDidChange.event;layout(t,i,n,o){this.lastLayout={width:t,height:i,top:n,left:o},this.element.classList.toggle("max-height-478px",i<=478);let s=this.titleControl.layout({container:new At(t,i),available:new At(t,i-this.editorPane.minimumHeight)});this.progressBar.getContainer().style.top=`${Math.max(this.titleHeight.offset-2,0)}px`;let a=Math.max(0,i-s.height);this.editorContainer.style.height=`${a}px`,this.editorPane.layout({width:t,height:a,top:n+s.height,left:o})}relayout(){if(this.lastLayout){let{width:t,height:i,top:n,left:o}=this.lastLayout;this.layout(t,i,n,o)}}setBoundarySashes(t){this.editorPane.setBoundarySashes(t)}toJSON(){return this.model.serialize()}dispose(){this._disposed=!0,this._onWillDispose.fire(),super.dispose()}};ds=R([y(6,ve),y(7,je),y(8,kt),y(9,jt),y(10,qt),y(11,xs),y(12,Zi),y(13,Wg),y(14,vt),y(15,oa),y(16,ql),y(17,Oi),y(18,$u),y(19,eo),y(20,Io),y(21,Lt)],ds);var BR=he,ha=class extends fc{constructor(t,i,n,o,s,a,l,d,c,u,p,m,f,g,b){super(t,l,o,a,d,n,i,g,c,u,p);this.editorGroupService=s;this.workingCopyService=m;this.filesConfigurationService=f;this.fileService=b;this.structuralRefreshDelay=0,this.sortOrder=a.getValue("explorer.openEditors.sortOrder"),this.registerUpdateEvents(),this._register(this.configurationService.onDidChangeConfiguration(v=>this.onConfigurationChange(v))),this._register(this.workingCopyService.onDidChangeDirty(v=>this.updateDirtyIndicator(v)))}static DEFAULT_VISIBLE_OPEN_EDITORS=9;static DEFAULT_MIN_VISIBLE_OPEN_EDITORS=0;static ID="workbench.explorer.openEditorsView";static NAME=pt({key:"openEditors",comment:["Open is an adjective"]},"Open Editors");dirtyCountElement;listRefreshScheduler;structuralRefreshDelay;dnd;list;listLabels;needsRefresh=!1;elements=[];sortOrder;blockFocusActiveEditorTracking=!1;registerUpdateEvents(){let t=()=>{if(!this.isBodyVisible()||!this.list){this.needsRefresh=!0;return}this.listRefreshScheduler?.schedule(this.structuralRefreshDelay)},i=this._register(new br),n=o=>{let s=o.onDidModelChange(a=>{if(this.listRefreshScheduler?.isScheduled())return;if(!this.isBodyVisible()||!this.list){this.needsRefresh=!0;return}let l=this.getIndex(o,a.editor);switch(a.kind){case 8:this.focusActiveEditor();break;case 1:case 2:l>=0&&this.list.splice(l,1,[o]);break;case 14:case 13:case 10:case 11:case 9:this.list.splice(l,1,[new ln(a.editor,o)]),this.focusActiveEditor();break;case 5:case 7:case 6:t();break}});i.set(o.id,s)};this.editorGroupService.groups.forEach(o=>n(o)),this._register(this.editorGroupService.onDidAddGroup(o=>{n(o),t()})),this._register(this.editorGroupService.onDidMoveGroup(()=>t())),this._register(this.editorGroupService.onDidChangeActiveGroup(()=>this.focusActiveEditor())),this._register(this.editorGroupService.onDidRemoveGroup(o=>{i.deleteAndDispose(o.id),t()}))}renderHeaderTitle(t){super.renderHeaderTitle(t,this.title);let i=ye(t,BR(".open-editors-dirty-count-container"));this.dirtyCountElement=ye(i,BR(".dirty-count.monaco-count-badge.long")),this.dirtyCountElement.style.backgroundColor=ae(Fl),this.dirtyCountElement.style.color=ae(vg),this.dirtyCountElement.style.border=`1px solid ${ae(Ie)}`,this.updateDirtyIndicator()}renderBody(t){super.renderBody(t),t.classList.add("open-editors"),t.classList.add("show-file-icons");let i=new oS;this.list&&this.list.dispose(),this.listLabels&&this.listLabels.clear(),this.dnd=new FR(this.sortOrder,this.instantiationService,this.editorGroupService),this.listLabels=this.instantiationService.createInstance(Ws,{onDidChangeVisibility:this.onDidChangeBodyVisibility}),this.list=this.instantiationService.createInstance(bf,"OpenEditors",t,i,[new VR(this.keybindingService,this.instantiationService),new WR(this.listLabels,this.instantiationService,this.keybindingService,this.configurationService)],{identityProvider:{getId:s=>s instanceof ln?s.getId():s.id.toString()},dnd:this.dnd,overrideStyles:this.getLocationBasedColors().listOverrideStyles,accessibilityProvider:new NV}),this._register(this.list),this._register(this.listLabels);let n=[];this.listRefreshScheduler=this._register(new Kt(()=>{if(!this.list)return;n=ht(n);let s=this.list.length,a=this.getElements();this.list.splice(0,this.list.length,a),this.focusActiveEditor(),s!==this.list.length&&this.updateSize(),this.needsRefresh=!1,(this.sortOrder==="alphabetical"||this.sortOrder==="fullPath")&&a.forEach(l=>{l instanceof ln&&n.push(l.editor.onDidChangeLabel(()=>this.listRefreshScheduler?.schedule()))})},this.structuralRefreshDelay)),this.updateSize(),this.handleContextKeys(),this._register(this.list.onContextMenu(s=>this.onListContextMenu(s))),this._register(this.list.onMouseMiddleClick(s=>{if(s&&s.element instanceof ln){if(qg(s.element.group,s.element.editor,2,this.editorGroupService.partOptions))return;s.element.group.closeEditor(s.element.editor,{preserveFocus:!0})}})),this._register(this.list.onDidOpen(s=>{let a=s.element;if(a)if(a instanceof ln){if(yr(s.browserEvent)&&s.browserEvent.button===1)return;this.withActiveEditorFocusTrackingDisabled(()=>{this.openEditor(a,{preserveFocus:s.editorOptions.preserveFocus,pinned:s.editorOptions.pinned,sideBySide:s.sideBySide})})}else this.withActiveEditorFocusTrackingDisabled(()=>{this.editorGroupService.activateGroup(a),s.editorOptions.preserveFocus||a.focus()});else return})),this.listRefreshScheduler.schedule(0),this._register(this.onDidChangeBodyVisibility(s=>{s&&this.needsRefresh&&this.listRefreshScheduler?.schedule(0)}));let o=this.viewDescriptorService.getViewContainerModel(this.viewDescriptorService.getViewContainerByViewId(this.id));this._register(o.onDidChangeAllViewDescriptors(()=>{this.updateSize()}))}handleContextKeys(){if(!this.list)return;T8.bindTo(this.list.contextKeyService),aP.bindTo(this.list.contextKeyService);let t=U8.bindTo(this.contextKeyService),i=z8.bindTo(this.contextKeyService),n=K8.bindTo(this.contextKeyService),o=G8.bindTo(this.contextKeyService),s=this.instantiationService.createInstance(no);this._register(s),this._register(this.list.onDidChangeFocus(a=>{s.reset(),t.reset(),i.reset(),n.reset();let l=a.elements.length?a.elements[0]:void 0;if(l instanceof ln){let d=l.getResource();i.set(l.editor.isDirty()&&!l.editor.isSaving()),n.set(!!l.editor.isReadonly()),s.set(d??null)}else l&&t.set(!0)})),this._register(this.list.onDidChangeSelection(a=>{let l=a.elements.every(d=>{if(d instanceof ln){let c=d.getResource();return c&&(c.scheme===ue.untitled||this.fileService.hasProvider(c))}return!1});o.set(l)}))}focus(){super.focus(),this.list?.domFocus()}layoutBody(t,i){super.layoutBody(t,i),this.list?.layout(t,i)}get showGroups(){return this.editorGroupService.groups.length>1}getElements(){return this.elements=[],this.editorGroupService.getGroups(2).forEach(t=>{this.showGroups&&this.elements.push(t);let i=t.editors.map(n=>new ln(n,t));this.sortOrder==="alphabetical"?i=i.sort((n,o)=>cP(n.editor.getName(),o.editor.getName())):this.sortOrder==="fullPath"&&(i=i.sort((n,o)=>{let s=n.editor.resource,a=o.editor.resource;if(s===void 0&&a===void 0)return cP(n.editor.getName(),o.editor.getName());if(s===void 0)return-1;if(a===void 0)return 1;{let l=s.scheme,d=a.scheme;return l!==ue.file&&d!==ue.file?Sm.compare(s,a):l!==ue.file?-1:d!==ue.file?1:Sm.compare(s,a)}})),this.elements.push(...i)}),this.elements}getIndex(t,i){return i?this.elements.findIndex(n=>n instanceof ln&&n.editor===i&&n.group.id===t.id):this.elements.findIndex(n=>!(n instanceof ln)&&n.id===t.id)}openEditor(t,i){t&&(this.telemetryService.publicLog2("workbenchActionExecuted",{id:"workbench.files.openFile",from:"openEditors"}),i.sideBySide&&i.preserveFocus||this.editorGroupService.activateGroup(t.group),(i.sideBySide?this.editorGroupService.sideGroup:t.group).openEditor(t.editor,i))}onListContextMenu(t){if(!t.element)return;let i=t.element;this.contextMenuService.showContextMenu({menuId:nt.OpenEditorsContext,menuActionOptions:{shouldForwardArgs:!0,arg:i instanceof ln?Mt.getOriginalUri(i.editor):{}},contextKeyService:this.list?.contextKeyService,getAnchor:()=>t.anchor,getActionsContext:()=>i instanceof ln?{groupId:i.groupId,editorIndex:i.group.getIndexOfEditor(i.editor)}:{groupId:i.id}})}withActiveEditorFocusTrackingDisabled(t){this.blockFocusActiveEditorTracking=!0;try{t()}finally{this.blockFocusActiveEditorTracking=!1}}focusActiveEditor(){if(!(!this.list||this.blockFocusActiveEditorTracking)){if(this.list.length&&this.editorGroupService.activeGroup){let t=this.getIndex(this.editorGroupService.activeGroup,this.editorGroupService.activeGroup.activeEditor);if(t>=0){try{this.list.setFocus([t]),this.list.setSelection([t]),this.list.reveal(t)}catch{}return}}this.list.setFocus([]),this.list.setSelection([])}}onConfigurationChange(t){t.affectsConfiguration("explorer.openEditors")&&this.updateSize(),(t.affectsConfiguration("explorer.decorations")||t.affectsConfiguration("explorer.openEditors.sortOrder"))&&(this.sortOrder=this.configurationService.getValue("explorer.openEditors.sortOrder"),this.dnd&&(this.dnd.sortOrder=this.sortOrder),this.listRefreshScheduler?.schedule())}updateSize(){this.minimumBodySize=this.orientation===0?this.getMinExpandedBodySize():170,this.maximumBodySize=this.orientation===0?this.getMaxExpandedBodySize():Number.POSITIVE_INFINITY}updateDirtyIndicator(t){if(t&&t.isDirty()&&!(t.capabilities&2)&&this.filesConfigurationService.hasShortAutoSaveDelay(t.resource))return;let i=this.workingCopyService.dirtyCount;i===0?this.dirtyCountElement.classList.add("hidden"):(this.dirtyCountElement.textContent=h("dirtyCounter","{0} unsaved",i),this.dirtyCountElement.classList.remove("hidden"))}get elementCount(){return this.editorGroupService.groups.map(t=>t.count).reduce((t,i)=>t+i,this.showGroups?this.editorGroupService.groups.length:0)}getMaxExpandedBodySize(){let t=this.configurationService.getValue("explorer.openEditors.minVisible");return typeof t!="number"&&(t=ha.DEFAULT_MIN_VISIBLE_OPEN_EDITORS),this.viewDescriptorService.getViewContainerModel(this.viewDescriptorService.getViewContainerByViewId(this.id)).visibleViewDescriptors.length<=1?Number.POSITIVE_INFINITY:Math.max(this.elementCount,t)*oS.ITEM_HEIGHT}getMinExpandedBodySize(){let t=this.configurationService.getValue("explorer.openEditors.visible");return typeof t!="number"&&(t=ha.DEFAULT_VISIBLE_OPEN_EDITORS),this.computeMinExpandedBodySize(t)}computeMinExpandedBodySize(t=ha.DEFAULT_VISIBLE_OPEN_EDITORS){return Math.min(Math.max(t,1),this.elementCount)*oS.ITEM_HEIGHT}setStructuralRefreshDelay(t){this.structuralRefreshDelay=t}getOptimalWidth(){if(!this.list)return super.getOptimalWidth();let t=this.list.getHTMLElement(),i=[].slice.call(t.querySelectorAll(".open-editor > a"));return W2(t,i)}};ha=R([y(1,ve),y(2,ua),y(3,Zi),y(4,Ri),y(5,He),y(6,qt),y(7,je),y(8,kt),y(9,jt),y(10,Gu),y(11,ia),y(12,oa),y(13,qa),y(14,Lt)],ha);var PV=class extends lo{editor;async run(e){if(this.editor)return super.run(e,{groupId:this.editor.groupId,editorIndex:this.editor.group.getIndexOfEditor(this.editor.editor)})}},oS=class r{static ITEM_HEIGHT=22;getHeight(e){return r.ITEM_HEIGHT}getTemplateId(e){return e instanceof ln?WR.ID:VR.ID}},VR=class r{constructor(e,t){this.keybindingService=e;this.instantiationService=t}static ID="editorgroup";get templateId(){return r.ID}renderTemplate(e){let t=Object.create(null);t.root=ye(e,BR(".editor-group")),t.name=ye(t.root,BR("span.name")),t.actionBar=new Pn(e);let i=this.instantiationService.createInstance(Ob,Ob.ID,Ob.LABEL),n=this.keybindingService.lookupKeybinding(i.id);t.actionBar.push(i,{icon:!0,label:!1,keybinding:n?n.getLabel():void 0});let o=this.instantiationService.createInstance(ep,ep.ID,ep.LABEL),s=this.keybindingService.lookupKeybinding(o.id);return t.actionBar.push(o,{icon:!0,label:!1,keybinding:s?s.getLabel():void 0}),t}renderElement(e,t,i){i.editorGroup=e,i.name.textContent=e.label,i.actionBar.context={groupId:e.id}}disposeTemplate(e){e.actionBar.dispose()}},WR=class r{constructor(e,t,i,n){this.labels=e;this.instantiationService=t;this.keybindingService=i;this.configurationService=n}static ID="openeditor";closeEditorAction=this.instantiationService.createInstance(tp,tp.ID,tp.LABEL);unpinEditorAction=this.instantiationService.createInstance(pa,pa.ID,pa.LABEL);get templateId(){return r.ID}renderTemplate(e){let t=Object.create(null);return t.container=e,t.actionRunner=new PV,t.actionBar=new Pn(e,{actionRunner:t.actionRunner}),t.root=this.labels.create(e),t}renderElement(e,t,i){let n=e.editor;i.actionRunner.editor=e,i.container.classList.toggle("dirty",n.isDirty()&&!n.isSaving()),i.container.classList.toggle("sticky",e.isSticky()),i.root.setResource({resource:Mt.getOriginalUri(n,{supportSideBySide:3}),name:n.getName(),description:n.getDescription(1)},{italic:e.isPreview(),extraClasses:["open-editor"].concat(e.editor.getLabelExtraClasses()),fileDecorations:this.configurationService.getValue().explorer.decorations,title:n.getTitle(2),icon:n.getIcon()});let o=e.isSticky()?this.unpinEditorAction:this.closeEditorAction;i.actionBar.hasAction(o)||(i.actionBar.isEmpty()||i.actionBar.clear(),i.actionBar.push(o,{icon:!0,label:!1,keybinding:this.keybindingService.lookupKeybinding(o.id)?.getLabel()}))}disposeTemplate(e){e.actionBar.dispose(),e.root.dispose(),e.actionRunner.dispose()}},FR=class{constructor(e,t,i){this.instantiationService=t;this.editorGroupService=i;this._sortOrder=e}_sortOrder;set sortOrder(e){this._sortOrder=e}get dropHandler(){return this.instantiationService.createInstance(Ju,{allowWorkspaceOpen:!1})}getDragURI(e){if(e instanceof ln){let t=e.getResource();if(t)return t.toString()}return null}getDragLabel(e){if(e.length>1)return String(e.length);let t=e[0];return t instanceof ln?t.editor.getName():t.label}onDragStart(e,t){let i=e.elements,n=[];if(i)for(let o of i)o instanceof ln&&n.push(o);n.length&&this.instantiationService.invokeFunction(HC,n,t)}onDragOver(e,t,i,n,o){if(e instanceof Yv&&!eV(o,Mo.FILES,xb.FILES))return!1;if(this._sortOrder!=="editorOrder")return e instanceof Zs?!1:{accept:!0,effect:{type:1},feedback:[-1]};let s;switch(n){case 0:case 1:s=i===0&&t instanceof ds?"drop-target-after":"drop-target-before";break;case 2:case 3:s="drop-target-after";break}return{accept:!0,effect:{type:1,position:s},feedback:[i]}}drop(e,t,i,n,o){let s=t instanceof ln?t.group:t||this.editorGroupService.groups[this.editorGroupService.count-1],a=t instanceof ln?t.group.getIndexOfEditor(t.editor):0;switch(n){case 0:case 1:t instanceof ds&&s.index!==0&&(s=this.editorGroupService.groups[s.index-1],a=s.count);break;case 3:case 2:t instanceof ln&&a++;break}if(e instanceof Zs){for(let l of e.elements){let d=l.group.getIndexOfEditor(l.editor);l.group===s&&d<a&&a--,l.group.moveEditor(l.editor,s,{index:a,preserveFocus:!0}),a++}this.editorGroupService.activateGroup(s)}else this.dropHandler.handleDrop(o,Re,()=>s,()=>s.focus(),{index:a})}dispose(){}};R([me],FR.prototype,"dropHandler",1);var NV=class{getWidgetAriaLabel(){return h("openEditors","Open Editors")}getAriaLabel(e){return e instanceof ln?`${e.editor.getName()}, ${e.editor.getDescription()}`:e.ariaLabel}},kee="workbench.action.toggleEditorGroupLayout";lr(class extends wi{constructor(){super({id:"workbench.action.toggleEditorGroupLayout",title:pt("flipLayout","Toggle Vertical/Horizontal Editor Layout"),f1:!0,keybinding:{primary:1557,mac:{primary:2581},weight:200},icon:ie.editorLayout,menu:{id:nt.ViewTitle,group:"navigation",when:Ue.and(Ue.equals("view",ha.ID),OC),order:10}})}async run(r){let e=r.get(Ri),t=e.orientation===1?0:1;e.setGroupOrientation(t),e.activeGroup.focus()}});Go.appendMenuItem(nt.MenubarLayoutMenu,{group:"5_flip",command:{id:kee,title:{...pt("miToggleEditorLayoutWithoutMnemonic","Flip Layout"),mnemonicTitle:h({key:"miToggleEditorLayout",comment:["&& denotes a mnemonic"]},"Flip &&Layout")}},order:1});lr(class extends wi{constructor(){super({id:"workbench.action.files.saveAll",title:W8,f1:!0,icon:ie.saveAll,menu:{id:nt.ViewTitle,group:"navigation",when:Ue.equals("view",ha.ID),order:20}})}async run(r){await r.get(Ui).executeCommand(V8)}});lr(class extends wi{constructor(){super({id:"openEditors.closeAll",title:XC.LABEL,f1:!1,icon:ie.closeAll,menu:{id:nt.ViewTitle,group:"navigation",when:Ue.equals("view",ha.ID),order:30}})}async run(r){let e=r.get(ve),t=new XC;await e.invokeFunction(i=>t.run(i))}});lr(class extends wi{constructor(){super({id:"openEditors.newUntitledFile",title:pt("newUntitledFile","New Untitled Text File"),f1:!1,icon:ie.newFile,menu:{id:nt.ViewTitle,group:"navigation",when:Ue.equals("view",ha.ID),order:5}})}async run(r){await r.get(Ui).executeCommand(yT)}});export{ha as OpenEditorsView};
