var cW=Object.defineProperty;var uW=Object.getOwnPropertyDescriptor;var K=(o,e,t,n)=>{for(var i=n>1?void 0:n?uW(e,t):e,r=o.length-1,s;r>=0;r--)(s=o[r])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&cW(e,t,i),i},D=(o,e)=>(t,n)=>e(t,n,o);function DR(o,e){let t=pW(o,e);if(t!==-1)return o[t]}function pW(o,e,t=o.length-1){for(let n=t;n>=0;n--){let i=o[n];if(e(i))return n}return-1}function ow(o,e){let t=bu(o,e);return t===-1?void 0:o[t]}function bu(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?i=s+1:r=s}return i-1}function Sb(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?r=s:i=s+1}return i}function rw(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>0&&(t=i)}return t}function RR(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>=0&&(t=i)}return t}function MR(o,e){return rw(o,(t,n)=>-e(t,n))}function PR(o,e){for(let t of o){let n=e(t);if(n!==void 0)return n}}var sw=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?xa.isErrorNoTelemetry(e)?new xa(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},lw=new sw;function vu(o){lw.onUnexpectedError(o)}function Ue(o){hm(o)||lw.onUnexpectedError(o)}function _a(o){hm(o)||lw.onUnexpectedExternalError(o)}var aw="Canceled";function hm(o){return o instanceof ni?!0:o instanceof Error&&o.name===aw&&o.message===aw}var ni=class extends Error{constructor(){super(aw),this.name=this.message}};function Ad(o){return o?new Error(`Illegal argument: ${o}`):new Error("Illegal argument")}function AR(o){return o?new Error(`Illegal state: ${o}`):new Error("Illegal state")}var xb=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}};var xa=class o extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof o)return e;let t=new o;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Ke=class o extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,o.prototype)}};function wa(o,e){let t=this,n=!1,i;return function(){if(n)return i;if(n=!0,e)try{i=o.apply(t,arguments)}finally{e()}else i=o.apply(t,arguments);return i}}var cn=class o{static Undefined=new o(void 0);element;next;prev;constructor(e){this.element=e,this.next=o.Undefined,this.prev=o.Undefined}},Gn=class{_first=cn.Undefined;_last=cn.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===cn.Undefined}clear(){let e=this._first;for(;e!==cn.Undefined;){let t=e.next;e.prev=cn.Undefined,e.next=cn.Undefined,e=t}this._first=cn.Undefined,this._last=cn.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new cn(e);if(this._first===cn.Undefined)this._first=n,this._last=n;else if(t){let r=this._last;this._last=n,n.prev=r,r.next=n}else{let r=this._first;this._first=n,n.next=r,r.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==cn.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==cn.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==cn.Undefined&&e.next!==cn.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===cn.Undefined&&e.next===cn.Undefined?(this._first=cn.Undefined,this._last=cn.Undefined):e.next===cn.Undefined?(this._last=this._last.prev,this._last.next=cn.Undefined):e.prev===cn.Undefined&&(this._first=this._first.next,this._first.prev=cn.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==cn.Undefined;)yield e.element,e=e.next}};var ii=(o,e)=>o===e;function yu(o=ii){return(e,t)=>Kt(e,t,o)}function OR(){return(o,e)=>o.equals(e)}function Iu(o,e,t){if(t!==void 0){let n=o;return n==null||e===void 0||e===null?e===n:t(n,e)}else{let n=o;return(i,r)=>i==null||r===void 0||r===null?r===i:n(i,r)}}function FR(o){return JSON.stringify(dw(o))}var mW=0,NR=new WeakMap;function dw(o){if(Array.isArray(o))return o.map(dw);if(o&&typeof o=="object")if(Object.getPrototypeOf(o)===Object.prototype){let e=o,t=Object.create(null);for(let n of Object.keys(e).sort())t[n]=dw(e[n]);return t}else{let e=NR.get(o);return e===void 0&&(e=mW++,NR.set(o,e)),e+"----2b76a038c20c4bcc"}return o}var Jt=class{constructor(e,t,n){this.owner=e;this.debugNameSource=t;this.referenceFn=n}getDebugName(e){return HR(e,this)}},BR=new Map,cw=new WeakMap;function HR(o,e){let t=cw.get(o);if(t)return t;let n=gW(o,e);if(n){let i=BR.get(n)??0;i++,BR.set(n,i);let r=i===1?n:`${n}#${i}`;return cw.set(o,r),r}}function gW(o,e){let t=cw.get(o);if(t)return t;let n=e.owner?bW(e.owner)+".":"",i,r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(i=r(),i!==void 0)return n+i}else return n+r;let s=e.referenceFn;if(s!==void 0&&(i=_b(s),i!==void 0))return n+i;if(e.owner!==void 0){let a=fW(e.owner,o);if(a!==void 0)return n+a}}function fW(o,e){for(let t in o)if(o[t]===e)return t}var WR=new Map,VR=new WeakMap;function bW(o){let e=VR.get(o);if(e)return e;let t=vW(o),n=WR.get(t)??0;n++,WR.set(t,n);let i=n===1?t:`${t}#${n}`;return VR.set(o,i),i}function vW(o){let e=o.constructor;return e?e.name:"Object"}function _b(o){let e=o.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}function wb(o,e){if(!o)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function Nd(o,e="Unreachable"){throw new Error(e)}function Od(o){if(!o()){debugger;o(),Ue(new Ke("Assertion Failed"))}}function uw(o,e){let t=0;for(;t<o.length-1;){let n=o[t],i=o[t+1];if(!e(n,i))return!1;t++}return!0}function Ht(o){return new Cu(new Jt(void 0,void 0,o),o,void 0,void 0)}function Fd(o,e){return new Cu(new Jt(o.owner,o.debugName,o.debugReferenceFn??e),e,void 0,void 0)}function UR(o,e){return new Cu(new Jt(o.owner,o.debugName,o.debugReferenceFn??e),e,o.createEmptyChangeSummary,o.handleChange)}function pw(o,e){let t=new te,n=UR({owner:o.owner,debugName:o.debugName,debugReferenceFn:o.debugReferenceFn??e,createEmptyChangeSummary:o.createEmptyChangeSummary,handleChange:o.handleChange},(i,r)=>{t.clear(),e(i,r,t)});return ge(()=>{n.dispose(),t.dispose()})}function hw(o){let e=new te,t=Fd({owner:void 0,debugName:void 0,debugReferenceFn:o},n=>{e.clear(),o(n,e)});return ge(()=>{t.dispose(),e.dispose()})}var Cu=class{constructor(e,t,n,i){this._debugNameData=e;this._runFn=t;this.createChangeSummary=n;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),xo()?.handleAutorunCreated(this),this._runIfNeeded(),Bd(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),Wd(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){xo()?.handleAutorunTriggered(this);let n=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}catch(i){vu(i)}}}finally{t||xo()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}Od(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:i=>i===e},this.changeSummary):!0)&&(this.state=2)}catch(n){vu(n)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=Cu)(Ht||={});function gn(o,e){return e!==void 0?new _s(new Jt(o,void 0,e),e,void 0,void 0,void 0,ii):new _s(new Jt(void 0,void 0,o),o,void 0,void 0,void 0,ii)}function zR(o,e,t){return new mw(new Jt(o,void 0,e),e,void 0,void 0,void 0,ii,t)}function Li(o,e){return new _s(new Jt(o.owner,o.debugName,o.debugReferenceFn),e,void 0,void 0,o.onLastObserverRemoved,o.equalsFn??ii)}KR(Li);function gw(o,e){return new _s(new Jt(o.owner,o.debugName,void 0),e,o.createEmptyChangeSummary,o.handleChange,void 0,o.equalityComparer??ii)}function fw(o,e){let t,n;e===void 0?(t=o,n=void 0):(n=o,t=e);let i=new te;return new _s(new Jt(n,void 0,t),r=>(i.clear(),t(r,i)),void 0,void 0,()=>i.dispose(),ii)}function bw(o,e){let t,n;e===void 0?(t=o,n=void 0):(n=o,t=e);let i;return new _s(new Jt(n,void 0,t),r=>{i?i.clear():i=new te;let s=t(r);return s&&i.add(s),s},void 0,void 0,()=>{i&&(i.dispose(),i=void 0)},ii)}var _s=class extends Pr{constructor(t,n,i,r,s=void 0,a){super();this._debugNameData=t;this._computeFn=n;this.createChangeSummary=i;this._handleChange=r;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),xo()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let n=this.state!==0,i=this.value;this.state=3;let r=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}r=n&&!this._equalityComparator(i,this.value),xo()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:r,hadValue:n})}catch(s){vu(s)}if(r)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let i of this.observers)i.handlePossibleChange(this);if(n)for(let i of this.observers)i.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let i of n)i.endUpdate(this)}Od(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(t,n){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:t,change:n,didChange:s=>s===t},this.changeSummary):!0}catch(s){vu(s)}let r=this.state===3;if(i&&(this.state===1||r)&&(this.state=2,r))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let n=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),n}addObserver(t){let n=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),n&&t.endUpdate(this)}},mw=class extends _s{constructor(t,n,i,r,s=void 0,a,l){super(t,n,i,r,s,a);this.set=l}};function Su(o){return new vw(o)}var vw=class extends fm{constructor(t){super();this.value=t}get debugName(){return this.toString()}get(){return this.value}addObserver(t){}removeObserver(t){}toString(){return`Const: ${this.value}`}};function fn(...o){let e,t,n;return o.length===3?[e,t,n]=o:[t,n]=o,new ws(new Jt(e,void 0,n),t,n,()=>ws.globalTransaction,ii)}function GR(o,e,t){return new ws(new Jt(o.owner,o.debugName,o.debugReferenceFn??t),e,t,()=>ws.globalTransaction,o.equalsFn??ii)}var ws=class extends Pr{constructor(t,n,i,r,s){super();this._debugNameData=t;this.event=n;this._getValue=i;this._getTransaction=r;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let n=this._getValue(t),i=this.value,r=!this.hasValue||!this._equalityComparator(i,n),s=!1;r&&(this.value=n,this.hasValue&&(s=!0,xu(this._getTransaction(),a=>{xo()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||xo()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=ws;function e(n,i){let r=!1;ws.globalTransaction===void 0&&(ws.globalTransaction=n,r=!0);try{i()}finally{r&&(ws.globalTransaction=void 0)}}t.batchEventsGlobally=e})(fn||={});function mm(o,e){return new yw(o,e)}var yw=class extends Pr{constructor(t,n){super();this.debugName=t;this.event=n}subscription;onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=()=>{_o(t=>{for(let n of this.observers)t.updateObserver(n,this),n.handleChange(this,void 0)},()=>this.debugName)};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}};function Vd(o){return typeof o=="string"?new Eb(o):new Eb(void 0,o)}var Eb=class extends Pr{constructor(t,n){super();this._debugName=t;this._owner=n}get debugName(){return new Jt(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(t,n){if(!t){_o(i=>{this.trigger(i,n)},()=>`Trigger signal ${this.debugName}`);return}for(let i of this.observers)t.updateObserver(i,this),i.handleChange(this,n)}get(){}};function $R(o){let e=new Tb(!1,void 0);return o.addObserver(e),ge(()=>{o.removeObserver(e)})}QR($R);function Db(o,e){let t=new Tb(!0,e);return o.addObserver(t),e?e(o.get()):o.reportChanges(),ge(()=>{o.removeObserver(t)})}YR(Db);var Tb=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};function gm(o,e){let t;return Li({owner:o,debugReferenceFn:e},i=>(t=e(i,t),t))}function jR(o,e,t,n){let i=new Lb(t,n);return Li({debugReferenceFn:t,owner:o,onLastObserverRemoved:()=>{i.dispose(),i=new Lb(t)}},s=>(i.setItems(e.read(s)),i.getItems()))}var Lb=class{constructor(e,t){this._map=e;this._keySelector=t}_cache=new Map;_items=[];dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){let t=[],n=new Set(this._cache.keys());for(let i of e){let r=this._keySelector?this._keySelector(i):i,s=this._cache.get(r);if(s)n.delete(r);else{let a=new te;s={out:this._map(i,a),store:a},this._cache.set(r,s)}t.push(s.out)}for(let i of n)this._cache.get(i).store.dispose(),this._cache.delete(i);this._items=t}getItems(){return this._items}},kb=class{constructor(e){this.observable=e}get onDidChange(){return de.fromObservableLight(this.observable)}get value(){return this.observable.get()}};function Rb(o,e){return pw({createEmptyChangeSummary:()=>({deltas:[],didChange:!1}),handleChange:(t,n)=>{if(t.didChange(o)){let i=t.change;i!==void 0&&n.deltas.push(i),n.didChange=!0}return!0}},(t,n)=>{let i=o.read(t);n.didChange&&e(i,n.deltas)})}function qR(o,e){let t=new te,n=Rb(o,(i,r)=>{t.clear(),e(i,r,t)});return{dispose(){n.dispose(),t.dispose()}}}var ZR;function XR(o){ZR=o}function xo(){return ZR}var Mb=class{indentation=0;textToConsoleArgs(e){return IW([_u(xW("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[_u(" "),Ar(vm(e.oldValue,70),{color:"red",strikeThrough:!0}),_u(" "),Ar(vm(e.newValue,60),{color:"green"})]:[_u(" (unchanged)")]:[_u(" "),Ar(vm(e.newValue,60),{color:"green"}),_u(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([bm("observable value changed"),Ar(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return Ar(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleDerivedRecomputed(e,t){let n=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([bm("derived recomputed"),Ar(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([bm("observable from event triggered"),Ar(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([bm("autorun"),Ar(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([bm("transaction"),Ar(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function IW(o){let e=new Array,t=[],n="";function i(s){if("length"in s)for(let a of s)a&&i(a);else"text"in s?(n+=`%c${s.text}`,e.push(s.style),s.data&&t.push(...s.data)):"data"in s&&t.push(...s.data)}i(o);let r=[n,...e];return r.push(...t),r}function _u(o){return Ar(o,{color:"black"})}function bm(o){return Ar(_W(`${o}: `,10),{color:"black",bold:!0})}function Ar(o,e={color:"black"}){function t(i){return Object.entries(i).reduce((r,[s,a])=>`${r}${s}:${a};`,"")}let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:o,style:t(n)}}function vm(o,e){switch(typeof o){case"number":return""+o;case"string":return o.length+2<=e?`"${o}"`:`"${o.substr(0,e-7)}"+...`;case"boolean":return o?"true":"false";case"undefined":return"undefined";case"object":return o===null?"null":Array.isArray(o)?CW(o,e):SW(o,e);case"symbol":return o.toString();case"function":return`[[Function${o.name?" "+o.name:""}]]`;default:return""+o}}function CW(o,e){let t="[ ",n=!0;for(let i of o){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${vm(i,e-t.length)}`}return t+=" ]",t}function SW(o,e){let t="{ ",n=!0;for(let[i,r]of Object.entries(o)){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${i}: ${vm(r,e-t.length)}`}return t+=" }",t}function xW(o,e){let t="";for(let n=1;n<=e;n++)t+=o;return t}function _W(o,e){for(;o.length<e;)o+=" ";return o}var JR;function YR(o){JR=o}var eM;function QR(o){eM=o}var Iw;function KR(o){Iw=o}var fm=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=t===void 0?void 0:e,i=t===void 0?e:t;return Iw({owner:n,debugName:()=>{let r=_b(i);if(r!==void 0)return r;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(a)return`${this.debugName}.${a[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:i},r=>i(this.read(r),r))}flatten(){return Iw({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(JR(this,t)),this}keepObserved(e){return e.add(eM(this)),this}get debugValue(){return this.get()}},Pr=class extends fm{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function _o(o,e){let t=new wl(o,e);try{o(t)}finally{t.finish()}}function xu(o,e,t){o?e(o):_o(e,t)}var wl=class{constructor(e,t){this._fn=e;this._getDebugName=t;xo()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():_b(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:n,observable:i}=e[t];n.endUpdate(i)}this.updatingObservers=null,xo()?.handleEndTransaction()}};function qo(o,e){let t;return typeof o=="string"?t=new Jt(void 0,o,void 0):t=new Jt(o,void 0,void 0),new wu(t,e,ii)}var wu=class extends Pr{constructor(t,n,i){super();this._debugNameData=t;this._equalityComparator=i;this._value=n}_value;get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(t,n,i){if(i===void 0&&this._equalityComparator(this._value,t))return;let r;n||(n=r=new wl(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;this._setValue(t),xo()?.handleObservableChanged(this,{oldValue:s,newValue:t,change:i,didChange:!0,hadValue:!0});for(let a of this.observers)n.updateObserver(a,this),a.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function Pb(o,e){let t;return typeof o=="string"?t=new Jt(void 0,o,void 0):t=new Jt(o,void 0,void 0),new Cw(t,e,ii)}var Cw=class extends wu{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){this._value?.dispose()}};function Sw(o,e,t,n){return e||(e=i=>i!=null),new Promise((i,r)=>{let s=!0,a=!1,l=o.map(c=>({isFinished:e(c),error:t?t(c):!1,state:c})),d=Ht(c=>{let{isFinished:u,error:p,state:m}=l.read(c);(u||p)&&(s?a=!0:d.dispose(),p?r(p===!0?m:p):i(m))});if(n){let c=n.onCancellationRequested(()=>{d.dispose(),c.dispose(),r(new ni)});if(n.isCancellationRequested){d.dispose(),c.dispose(),r(new ni);return}}s=!1,a&&d.dispose()})}var Ab=class extends Pr{constructor(t,n,i){super();this._debugNameData=t;this._equalityComparator=i;this._value=n}_value;_isUpToDate=!0;_deltas=[];get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(let t of this.observers)for(let n of this._deltas)t.handleChange(this,n);this._deltas.length=0}else for(let t of this.observers)t.handleChange(this,void 0)}_updateCounter=0;_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(let t of this.observers)t.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();let t=[...this.observers];for(let n of t)n.endUpdate(this)}}addObserver(t){let n=!this.observers.has(t)&&this._updateCounter>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this._updateCounter>0;super.removeObserver(t),n&&t.endUpdate(this)}set(t,n,i){if(i===void 0&&this._equalityComparator(this._value,t))return;let r;n||(n=r=new wl(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(t),i!==void 0&&this._deltas.push(i),n.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(s,a)=>{},handlePossibleChange:s=>{}},this),this._updateCounter>1)for(let s of this.observers)s.handlePossibleChange(this)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function Nb(o,e){return o.lazy?new Ab(new Jt(o.owner,o.debugName,void 0),e,o.equalsFn??ii):new wu(new Jt(o.owner,o.debugName,void 0),e,o.equalsFn??ii)}var wW=!1;wW&&XR(new Mb);var EW=globalThis.performance&&typeof globalThis.performance.now=="function",to=class o{_startTime;_stopTime;_now;static create(e){return new o(e)}constructor(e){this._now=EW&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var xw=Symbol("MicrotaskDelay");var TW=!1,tM=!1,LW=!1,de;(ve=>{ve.None=()=>W.None;function e(ee){if(LW){let{onDidAddListener:Q}=ee,ae=ym.create(),ne=0;ee.onDidAddListener=()=>{++ne===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),ae.print()),Q?.()}}}function t(ee,Q){return m(ee,()=>{},0,void 0,!0,void 0,Q)}ve.defer=t;function n(ee){return(Q,ae=null,ne)=>{let Z=!1,Ce;return Ce=ee(xe=>{if(!Z)return Ce?Ce.dispose():Z=!0,Q.call(ae,xe)},null,ne),Z&&Ce.dispose(),Ce}}ve.once=n;function i(ee,Q){return ve.once(ve.filter(ee,Q))}ve.onceIf=i;function r(ee,Q,ae){return u((ne,Z=null,Ce)=>ee(xe=>ne.call(Z,Q(xe)),null,Ce),ae)}ve.map=r;function s(ee,Q,ae){return u((ne,Z=null,Ce)=>ee(xe=>{Q(xe),ne.call(Z,xe)},null,Ce),ae)}ve.forEach=s;function a(ee,Q,ae){return u((ne,Z=null,Ce)=>ee(xe=>Q(xe)&&ne.call(Z,xe),null,Ce),ae)}ve.filter=a;function l(ee){return ee}ve.signal=l;function d(...ee){return(Q,ae=null,ne)=>{let Z=Ts(...ee.map(Ce=>Ce(xe=>Q.call(ae,xe))));return p(Z,ne)}}ve.any=d;function c(ee,Q,ae,ne){let Z=ae;return r(ee,Ce=>(Z=Q(Z,Ce),Z),ne)}ve.reduce=c;function u(ee,Q){let ae,ne={onWillAddFirstListener(){ae=ee(Z.fire,Z)},onDidRemoveLastListener(){ae?.dispose()}};Q||e(ne);let Z=new L(ne);return Q?.add(Z),Z.event}function p(ee,Q){return Q instanceof Array?Q.push(ee):Q&&Q.add(ee),ee}function m(ee,Q,ae=100,ne=!1,Z=!1,Ce,xe){let st,Xe,ke,ti=0,Pn,eo={leakWarningThreshold:Ce,onWillAddFirstListener(){st=ee(yl=>{ti++,Xe=Q(Xe,yl),ne&&!ke&&(So.fire(Xe),Xe=void 0),Pn=()=>{let fi=Xe;Xe=void 0,ke=void 0,(!ne||ti>1)&&So.fire(fi),ti=0},typeof ae=="number"?(clearTimeout(ke),ke=setTimeout(Pn,ae)):ke===void 0&&(ke=0,queueMicrotask(Pn))})},onWillRemoveListener(){Z&&ti>0&&Pn?.()},onDidRemoveLastListener(){Pn=void 0,st.dispose()}};xe||e(eo);let So=new L(eo);return xe?.add(So),So.event}ve.debounce=m;function g(ee,Q=0,ae){return ve.debounce(ee,(ne,Z)=>ne?(ne.push(Z),ne):[Z],Q,void 0,!0,void 0,ae)}ve.accumulate=g;function f(ee,Q=(ne,Z)=>ne===Z,ae){let ne=!0,Z;return a(ee,Ce=>{let xe=ne||!Q(Ce,Z);return ne=!1,Z=Ce,xe},ae)}ve.latch=f;function b(ee,Q,ae){return[ve.filter(ee,Q,ae),ve.filter(ee,ne=>!Q(ne),ae)]}ve.split=b;function v(ee,Q=!1,ae=[],ne){let Z=ae.slice(),Ce=ee(Xe=>{Z?Z.push(Xe):st.fire(Xe)});ne&&ne.add(Ce);let xe=()=>{Z?.forEach(Xe=>st.fire(Xe)),Z=null},st=new L({onWillAddFirstListener(){Ce||(Ce=ee(Xe=>st.fire(Xe)),ne&&ne.add(Ce))},onDidAddFirstListener(){Z&&(Q?setTimeout(xe):xe())},onDidRemoveLastListener(){Ce&&Ce.dispose(),Ce=null}});return ne&&ne.add(st),st.event}ve.buffer=v;function I(ee,Q){return(ne,Z,Ce)=>{let xe=Q(new S);return ee(function(st){let Xe=xe.evaluate(st);Xe!==C&&ne.call(Z,Xe)},void 0,Ce)}}ve.chain=I;let C=Symbol("HaltChainable");class S{steps=[];map(Q){return this.steps.push(Q),this}forEach(Q){return this.steps.push(ae=>(Q(ae),ae)),this}filter(Q){return this.steps.push(ae=>Q(ae)?ae:C),this}reduce(Q,ae){let ne=ae;return this.steps.push(Z=>(ne=Q(ne,Z),ne)),this}latch(Q=(ae,ne)=>ae===ne){let ae=!0,ne;return this.steps.push(Z=>{let Ce=ae||!Q(Z,ne);return ae=!1,ne=Z,Ce?Z:C}),this}evaluate(Q){for(let ae of this.steps)if(Q=ae(Q),Q===C)break;return Q}}function E(ee,Q,ae=ne=>ne){let ne=(...st)=>xe.fire(ae(...st)),Z=()=>ee.on(Q,ne),Ce=()=>ee.removeListener(Q,ne),xe=new L({onWillAddFirstListener:Z,onDidRemoveLastListener:Ce});return xe.event}ve.fromNodeEventEmitter=E;function M(ee,Q,ae=ne=>ne){let ne=(...st)=>xe.fire(ae(...st)),Z=()=>ee.addEventListener(Q,ne),Ce=()=>ee.removeEventListener(Q,ne),xe=new L({onWillAddFirstListener:Z,onDidRemoveLastListener:Ce});return xe.event}ve.fromDOMEventEmitter=M;function A(ee){return new Promise(Q=>n(ee)(Q))}ve.toPromise=A;function F(ee){let Q=new L;return ee.then(ae=>{Q.fire(ae)},()=>{Q.fire(void 0)}).finally(()=>{Q.dispose()}),Q.event}ve.fromPromise=F;function O(ee,Q){return ee(ae=>Q.fire(ae))}ve.forward=O;function H(ee,Q,ae){return Q(ae),ee(ne=>Q(ne))}ve.runAndSubscribe=H;class U{constructor(Q,ae){this._observable=Q;let ne={onWillAddFirstListener:()=>{Q.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{Q.removeObserver(this)}};ae||e(ne),this.emitter=new L(ne),ae&&ae.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(Q){this._counter++}handlePossibleChange(Q){}handleChange(Q,ae){this._hasChanged=!0}endUpdate(Q){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function z(ee,Q){return new U(ee,Q).emitter.event}ve.fromObservable=z;function re(ee){return(Q,ae,ne)=>{let Z=0,Ce=!1,xe={beginUpdate(){Z++},endUpdate(){Z--,Z===0&&(ee.reportChanges(),Ce&&(Ce=!1,Q.call(ae)))},handlePossibleChange(){},handleChange(){Ce=!0}};ee.addObserver(xe),ee.reportChanges();let st={dispose(){ee.removeObserver(xe)}};return ne instanceof te?ne.add(st):Array.isArray(ne)&&ne.push(st),st}}ve.fromObservableLight=re})(de||={});var _w=class o{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${o._idPool++}`,o.all.add(this)}start(e){this._stopWatch=new to,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},nM=-1;var ww=class o{constructor(e,t,n=(o._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=n}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let n=this.threshold;if(n<=0||t<n)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[r,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(r);let l=new Ew(a,r);this._errorHandler(l)}return()=>{let r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[n,i]of this._stacks)(!e||t<i)&&(e=[n,i],t=i);return e}},ym=class o{constructor(e){this.value=e}static create(){let e=new Error;return new o(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},Ew=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},Tw=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},kW=0,Eu=class{constructor(e){this.value=e}stack;id=kW++},DW=2,iM=(o,e)=>{if(o instanceof Eu)e(o);else for(let t=0;t<o.length;t++){let n=o[t];n&&e(n)}},Ob;if(TW){let o=[];setInterval(()=>{o.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(o.join(`
`)),o.length=0)},3e3),Ob=new FinalizationRegistry(e=>{typeof e=="string"&&o.push(e)})}var L=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=nM>0||this._options?.leakWarningThreshold?new ww(e?.onListenerError??Ue,this._options?.leakWarningThreshold??nM):void 0,this._perfMon=this._options?._profName?new _w(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(tM){let e=this._listeners;queueMicrotask(()=>{iM(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new Tw(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||Ue)(c),W.None}if(this._disposed)return W.None;t&&(e=e.bind(t));let i=new Eu(e),r,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=ym.create(),r=this._leakageMon.check(i.stack,this._size+1)),tM&&(i.stack=s??ym.create()),this._listeners?this._listeners instanceof Eu?(this._deliveryQueue??=new Fb,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=ge(()=>{Ob?.unregister(a),r?.(),this._removeListener(i)});if(n instanceof te?n.add(a):Array.isArray(n)&&n.push(a),Ob){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);Ob.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*DW<=t.length){let r=0;for(let s=0;s<t.length;s++)t[s]?t[r++]=t[s]:i&&(this._deliveryQueue.end--,r<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=r}}_deliver(e,t){if(!e)return;let n=this._options?.onListenerError||Ue;if(!n){e.value(t);return}try{e.value(t)}catch(i){n(i)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof Eu)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},oM=()=>new Fb,Fb=class{i=-1;end=0;current;value;enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},Tu=class extends L{_asyncDeliveryQueue;async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new Gn),iM(this._listeners,i=>this._asyncDeliveryQueue.push([i.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[i,r]=this._asyncDeliveryQueue.shift(),s=[],a={...r,token:t,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");n&&(l=n(l,i)),s.push(l)}};try{i(a)}catch(l){Ue(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&Ue(d.reason)})}}},Es=class extends L{_isPaused=0;_eventQueue=new Gn;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}},Bb=class extends Es{_delay;_handle;constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}},Wb=class extends L{_queuedEvents=[];_mergeFn;constructor(e){super(e),this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}},Im=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new L({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){let t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),ge(wa(()=>{this.hasListeners&&this.unhook(t);let i=this.events.indexOf(t);this.events.splice(i,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(let e of this.events)e.listener?.dispose();this.events=[]}};var Lu=class{data=[];wrapEvent(e,t,n){return(i,r,s)=>e(a=>{let l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>i.call(r,a)):i.call(r,a);return}let d=l;if(!d){i.call(r,t(n,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=n?d.items.reduce(t,n):d.items.reduce(t),i.call(r,d.reducedResult)})},void 0,s)}bufferEvents(e){let t={buffers:new Array};this.data.push(t);let n=e();return this.data.pop(),t.buffers.forEach(i=>i()),n}};var rM=Object.freeze(function(o,e){let t=setTimeout(o.bind(e),0);return{dispose(){clearTimeout(t)}}}),on;(n=>{function o(i){return i===n.None||i===n.Cancelled||i instanceof ku?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}n.isCancellationToken=o,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:de.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:rM})})(on||={});var ku=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?rM:(this._emitter||(this._emitter=new L),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},$n=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new ku),this._token}cancel(){this._token?this._token instanceof ku&&this._token.cancel():this._token=on.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof ku&&this._token.dispose():this._token=on.None}};function Lw(o){let e=new $n;return o.add({dispose(){e.cancel()}}),e.token}function io(o,e=0){return o[o.length-(1+e)]}function Kt(o,e,t=(n,i)=>n===i){if(o===e)return!0;if(!o||!e||o.length!==e.length)return!1;for(let n=0,i=o.length;n<i;n++)if(!t(o[n],e[n]))return!1;return!0}function sM(o,e){let t=o.length-1;e<t&&(o[e]=o[t]),o.pop()}function Ub(o,e,t){return MW(o.length,n=>t(o[n],e))}function MW(o,e){let t=0,n=o-1;for(;t<=n;){let i=(t+n)/2|0,r=e(i);if(r<0)t=i+1;else if(r>0)n=i-1;else return i}return-(t+1)}function Vb(o,e,t){if(o=o|0,o>=e.length)throw new TypeError("invalid index");let n=e[Math.floor(e.length*Math.random())],i=[],r=[],s=[];for(let a of e){let l=t(a,n);l<0?i.push(a):l>0?r.push(a):s.push(a)}return o<i.length?Vb(o,i,t):o<i.length+s.length?s[0]:Vb(o-(i.length+s.length),r,t)}function kw(o,e){let t=[],n;for(let i of o.slice(0).sort(e))!n||e(n[0],i)!==0?(n=[i],t.push(n)):n.push(i);return t}function Ta(o){return o.filter(e=>!!e)}function Dw(o){let e=0;for(let t=0;t<o.length;t++)o[t]&&(o[e]=o[t],e+=1);o.length=e}function aM(o){return!Array.isArray(o)||o.length===0}function zb(o){return Array.isArray(o)&&o.length>0}function La(o,e=t=>t){let t=new Set;return o.filter(n=>{let i=e(n);return t.has(i)?!1:(t.add(i),!0)})}function Kb(o,e){let t=typeof e=="number"?o:0;typeof e=="number"?t=o:(t=0,e=o);let n=[];if(t<=e)for(let i=t;i<e;i++)n.push(i);else for(let i=t;i>e;i--)n.push(i);return n}function Gb(o,e){return o.push(e),()=>PW(o,e)}function PW(o,e){let t=o.indexOf(e);if(t>-1)return o.splice(t,1),e}function Ls(o,e,t){let n=o.slice(0,e),i=o.slice(e);return n.concat(t,i)}function Rw(o,e){let t;if(typeof e=="number"){let n=e;t=()=>{let i=Math.sin(n++)*179426549;return i-Math.floor(i)}}else t=Math.random;for(let n=o.length-1;n>0;n-=1){let i=Math.floor(t()*(n+1)),r=o[n];o[n]=o[i],o[i]=r}}function Mw(o,e){for(let t of e)o.push(t)}var lM;(a=>{function o(l){return l<0}a.isLessThan=o;function e(l){return l<=0}a.isLessThanOrEqual=e;function t(l){return l>0}a.isGreaterThan=t;function n(l){return l===0}a.isNeitherLessOrGreaterThan=n,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(lM||={});function Nr(o,e){return(t,n)=>e(o(t),o(n))}var Pw=(o,e)=>o-e;var no=class{constructor(e){this.items=e}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let n=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,n}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let n=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,n}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},Ea=class o{constructor(e){this.iterate=e}static empty=new o(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new o(t=>this.iterate(n=>e(n)?t(n):!0))}map(e){return new o(t=>this.iterate(n=>t(e(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(i=>((n||lM.isGreaterThan(e(i,t)))&&(n=!1,t=i),!0)),t}},Hb=class o{constructor(e){this._indexMap=e}static createSortPermutation(e,t){let n=Array.from(e.keys()).sort((i,r)=>t(e[i],e[r]));return new o(n)}apply(e){return e.map((t,n)=>e[this._indexMap[n]])}inverse(){let e=this._indexMap.slice();for(let t=0;t<this._indexMap.length;t++)e[this._indexMap[t]]=t;return new o(e)}};function dM(o,e){let t=new Set;for(let n of e)o.has(n)&&t.add(n);return t}function Aw(){return globalThis._VSCODE_NLS_MESSAGES}function Cm(){return globalThis._VSCODE_NLS_LANGUAGE}var AW=Cm()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function $b(o,e){let t;return e.length===0?t=o:t=o.replace(/\{(\d+)\}/g,(n,i)=>{let r=i[0],s=e[r],a=n;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),AW&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function h(o,e,...t){return $b(typeof o=="number"?cM(o,e):e,t)}function cM(o,e){let t=Aw()?.[o];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${o} !!!`)}return t}function Hd(o,e,...t){let n;typeof o=="number"?n=cM(o,e):n=e;let i=$b(n,t);return{value:i,original:e===n?i:$b(e,t)}}var Du="en",xm=!1,_m=!1,Sm=!1,NW=!1,mM=!1,Ow=!1,OW=!1,Fw=!1,FW=!1,gM=!1,jb,qb=Du,uM=Du,BW,ka,Ra=globalThis,Qo;typeof Ra.vscode<"u"&&typeof Ra.vscode.process<"u"?Qo=Ra.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Qo=process);var fM=typeof Qo?.versions?.electron=="string",WW=fM&&Qo?.type==="renderer";if(typeof Qo=="object"){xm=Qo.platform==="win32",_m=Qo.platform==="darwin",Sm=Qo.platform==="linux",NW=Sm&&!!Qo.env.SNAP&&!!Qo.env.SNAP_REVISION,OW=fM,FW=!!Qo.env.CI||!!Qo.env.BUILD_ARTIFACTSTAGINGDIRECTORY,jb=Du,qb=Du;let o=Qo.env.VSCODE_NLS_CONFIG;if(o)try{let e=JSON.parse(o);jb=e.userLocale,uM=e.osLocale,qb=e.resolvedLanguage||Du,BW=e.languagePack?.translationsConfigFile}catch{}mM=!0}else typeof navigator=="object"&&!WW?(ka=navigator.userAgent,xm=ka.indexOf("Windows")>=0,_m=ka.indexOf("Macintosh")>=0,Fw=(ka.indexOf("Macintosh")>=0||ka.indexOf("iPad")>=0||ka.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Sm=ka.indexOf("Linux")>=0,gM=ka?.indexOf("Mobi")>=0,Ow=!0,qb=Cm()||Du,jb=navigator.language.toLowerCase(),uM=jb):console.error("Unable to resolve platform.");var Nw=0;_m?Nw=1:xm?Nw=3:Sm&&(Nw=2);var dt=xm,Be=_m,Gt=Sm;var Ma=mM;var Ds=Ow,VW=Ow&&typeof Ra.importScripts=="function",bM=VW?Ra.origin:void 0,wm=Fw,vM=gM;var ks=ka,Da=qb,HW;(n=>{function o(){return Da}n.value=o;function e(){return Da.length===2?Da==="en":Da.length>=3?Da[0]==="e"&&Da[1]==="n"&&Da[2]==="-":!1}n.isDefaultVariant=e;function t(){return Da==="en"}n.isDefault=t})(HW||={});var UW=typeof Ra.postMessage=="function"&&!Ra.importScripts,Yb=(()=>{if(UW){let o=[];Ra.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=o.length;n<i;n++){let r=o[n];if(r.id===t.data.vscodeScheduleAsyncWork){o.splice(n,1),r.callback();return}}});let e=0;return t=>{let n=++e;o.push({id:n,callback:t}),Ra.postMessage({vscodeScheduleAsyncWork:n},"*")}}return o=>setTimeout(o)})();var mr=_m||Fw?2:xm?1:3,pM=!0,hM=!1;function yM(){if(!hM){hM=!0;let o=new Uint8Array(2);o[0]=1,o[1]=2,pM=new Uint16Array(o.buffer)[0]===513}return pM}var Bw=!!(ks&&ks.indexOf("Chrome")>=0),IM=!!(ks&&ks.indexOf("Firefox")>=0),CM=!!(!Bw&&ks&&ks.indexOf("Safari")>=0),SM=!!(ks&&ks.indexOf("Edg/")>=0),xM=!!(ks&&ks.indexOf("Android")>=0);var Ud,Ww=globalThis.vscode;if(typeof Ww<"u"&&typeof Ww.process<"u"){let o=Ww.process;Ud={get platform(){return o.platform},get arch(){return o.arch},get env(){return o.env},cwd(){return o.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Ud={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Ud={get platform(){return dt?"win32":Be?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var Em=Ud.cwd,Tm=Ud.env,_M=Ud.platform,Z6=Ud.arch;var KW=65,GW=97,$W=90,jW=122,Ll=46,yi=47,wo=92,El=58,qW=63,Qb=class extends Error{code;constructor(e,t,n){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let r=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${r} ${i} of type ${t}`;s+=`. Received type ${typeof n}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function YW(o,e){if(o===null||typeof o!="object")throw new Qb(e,"Object",o)}function wn(o,e){if(typeof o!="string")throw new Qb(e,"string",o)}var Eo=_M==="win32";function lt(o){return o===yi||o===wo}function Vw(o){return o===yi}function Tl(o){return o>=KW&&o<=$W||o>=GW&&o<=jW}function Zb(o,e,t,n){let i="",r=0,s=-1,a=0,l=0;for(let d=0;d<=o.length;++d){if(d<o.length)l=o.charCodeAt(d);else{if(n(l))break;l=yi}if(n(l)){if(!(s===d-1||a===1))if(a===2){if(i.length<2||r!==2||i.charCodeAt(i.length-1)!==Ll||i.charCodeAt(i.length-2)!==Ll){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",r=0):(i=i.slice(0,c),r=i.length-1-i.lastIndexOf(t)),s=d,a=0;continue}else if(i.length!==0){i="",r=0,s=d,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",r=2)}else i.length>0?i+=`${t}${o.slice(s+1,d)}`:i=o.slice(s+1,d),r=d-s-1;s=d,a=0}else l===Ll&&a!==-1?++a:a=-1}return i}function QW(o){return o?`${o[0]==="."?"":"."}${o}`:""}function wM(o,e){YW(e,"pathObject");let t=e.dir||e.root,n=e.base||`${e.name||""}${QW(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}${o}${n}`:n}var yn={resolve(...o){let e="",t="",n=!1;for(let i=o.length-1;i>=-1;i--){let r;if(i>=0){if(r=o[i],wn(r,`paths[${i}]`),r.length===0)continue}else e.length===0?r=Em():(r=Tm[`=${e}`]||Em(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===wo)&&(r=`${e}\\`));let s=r.length,a=0,l="",d=!1,c=r.charCodeAt(0);if(s===1)lt(c)&&(a=1,d=!0);else if(lt(c))if(d=!0,lt(r.charCodeAt(1))){let u=2,p=u;for(;u<s&&!lt(r.charCodeAt(u));)u++;if(u<s&&u!==p){let m=r.slice(p,u);for(p=u;u<s&&lt(r.charCodeAt(u));)u++;if(u<s&&u!==p){for(p=u;u<s&&!lt(r.charCodeAt(u));)u++;(u===s||u!==p)&&(l=`\\\\${m}\\${r.slice(p,u)}`,a=u)}}}else a=1;else Tl(c)&&r.charCodeAt(1)===El&&(l=r.slice(0,2),a=2,s>2&&lt(r.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,n=d,d&&e.length>0)break}return t=Zb(t,!n,"\\",lt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(o){wn(o,"path");let e=o.length;if(e===0)return".";let t=0,n,i=!1,r=o.charCodeAt(0);if(e===1)return Vw(r)?"\\":o;if(lt(r))if(i=!0,lt(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!lt(o.charCodeAt(a));)a++;if(a<e&&a!==l){let d=o.slice(l,a);for(l=a;a<e&&lt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!lt(o.charCodeAt(a));)a++;if(a===e)return`\\\\${d}\\${o.slice(l)}\\`;a!==l&&(n=`\\\\${d}\\${o.slice(l,a)}`,t=a)}}}else t=1;else Tl(r)&&o.charCodeAt(1)===El&&(n=o.slice(0,2),t=2,e>2&&lt(o.charCodeAt(2))&&(i=!0,t=3));let s=t<e?Zb(o.slice(t),!i,"\\",lt):"";return s.length===0&&!i&&(s="."),s.length>0&&lt(o.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(o){wn(o,"path");let e=o.length;if(e===0)return!1;let t=o.charCodeAt(0);return lt(t)||e>2&&Tl(t)&&o.charCodeAt(1)===El&&lt(o.charCodeAt(2))},join(...o){if(o.length===0)return".";let e,t;for(let r=0;r<o.length;++r){let s=o[r];wn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&lt(t.charCodeAt(0))){++i;let r=t.length;r>1&&lt(t.charCodeAt(1))&&(++i,r>2&&(lt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&lt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return yn.normalize(e)},relative(o,e){if(wn(o,"from"),wn(e,"to"),o===e)return"";let t=yn.resolve(o),n=yn.resolve(e);if(t===n||(o=t.toLowerCase(),e=n.toLowerCase(),o===e))return"";let i=0;for(;i<o.length&&o.charCodeAt(i)===wo;)i++;let r=o.length;for(;r-1>i&&o.charCodeAt(r-1)===wo;)r--;let s=r-i,a=0;for(;a<e.length&&e.charCodeAt(a)===wo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===wo;)l--;let d=l-a,c=s<d?s:d,u=-1,p=0;for(;p<c;p++){let g=o.charCodeAt(i+p);if(g!==e.charCodeAt(a+p))break;g===wo&&(u=p)}if(p!==c){if(u===-1)return n}else{if(d>c){if(e.charCodeAt(a+p)===wo)return n.slice(a+p+1);if(p===2)return n.slice(a+p)}s>c&&(o.charCodeAt(i+p)===wo?u=p:p===2&&(u=3)),u===-1&&(u=0)}let m="";for(p=i+u+1;p<=r;++p)(p===r||o.charCodeAt(p)===wo)&&(m+=m.length===0?"..":"\\..");return a+=u,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===wo&&++a,n.slice(a,l))},toNamespacedPath(o){if(typeof o!="string"||o.length===0)return o;let e=yn.resolve(o);if(e.length<=2)return o;if(e.charCodeAt(0)===wo){if(e.charCodeAt(1)===wo){let t=e.charCodeAt(2);if(t!==qW&&t!==Ll)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Tl(e.charCodeAt(0))&&e.charCodeAt(1)===El&&e.charCodeAt(2)===wo)return`\\\\?\\${e}`;return o},dirname(o){wn(o,"path");let e=o.length;if(e===0)return".";let t=-1,n=0,i=o.charCodeAt(0);if(e===1)return lt(i)?o:".";if(lt(i)){if(t=n=1,lt(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!lt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&lt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!lt(o.charCodeAt(a));)a++;if(a===e)return o;a!==l&&(t=n=a+1)}}}}else Tl(i)&&o.charCodeAt(1)===El&&(t=e>2&&lt(o.charCodeAt(2))?3:2,n=t);let r=-1,s=!0;for(let a=e-1;a>=n;--a)if(lt(o.charCodeAt(a))){if(!s){r=a;break}}else s=!1;if(r===-1){if(t===-1)return".";r=t}return o.slice(0,r)},basename(o,e){e!==void 0&&wn(e,"suffix"),wn(o,"path");let t=0,n=-1,i=!0,r;if(o.length>=2&&Tl(o.charCodeAt(0))&&o.charCodeAt(1)===El&&(t=2),e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=t;--r){let l=o.charCodeAt(r);if(lt(l)){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=t;--r)if(lt(o.charCodeAt(r))){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){wn(o,"path");let e=0,t=-1,n=0,i=-1,r=!0,s=0;o.length>=2&&o.charCodeAt(1)===El&&Tl(o.charCodeAt(0))&&(e=n=2);for(let a=o.length-1;a>=e;--a){let l=o.charCodeAt(a);if(lt(l)){if(!r){n=a+1;break}continue}i===-1&&(r=!1,i=a+1),l===Ll?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":o.slice(t,i)},format:wM.bind(null,"\\"),parse(o){wn(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.length,n=0,i=o.charCodeAt(0);if(t===1)return lt(i)?(e.root=e.dir=o,e):(e.base=e.name=o,e);if(lt(i)){if(n=1,lt(o.charCodeAt(1))){let u=2,p=u;for(;u<t&&!lt(o.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&lt(o.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&!lt(o.charCodeAt(u));)u++;u===t?n=u:u!==p&&(n=u+1)}}}}else if(Tl(i)&&o.charCodeAt(1)===El){if(t<=2)return e.root=e.dir=o,e;if(n=2,lt(o.charCodeAt(2))){if(t===3)return e.root=e.dir=o,e;n=3}}n>0&&(e.root=o.slice(0,n));let r=-1,s=n,a=-1,l=!0,d=o.length-1,c=0;for(;d>=n;--d){if(i=o.charCodeAt(d),lt(i)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),i===Ll?r===-1?r=d:c!==1&&(c=1):r!==-1&&(c=-1)}return a!==-1&&(r===-1||c===0||c===1&&r===a-1&&r===s+1?e.base=e.name=o.slice(s,a):(e.name=o.slice(s,r),e.base=o.slice(s,a),e.ext=o.slice(r,a))),s>0&&s!==n?e.dir=o.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},ZW=(()=>{if(Eo){let o=/\\/g;return()=>{let e=Em().replace(o,"/");return e.slice(e.indexOf("/"))}}return()=>Em()})(),gt={resolve(...o){let e="",t=!1;for(let n=o.length-1;n>=-1&&!t;n--){let i=n>=0?o[n]:ZW();wn(i,`paths[${n}]`),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===yi)}return e=Zb(e,!t,"/",Vw),t?`/${e}`:e.length>0?e:"."},normalize(o){if(wn(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===yi,t=o.charCodeAt(o.length-1)===yi;return o=Zb(o,!e,"/",Vw),o.length===0?e?"/":t?"./":".":(t&&(o+="/"),e?`/${o}`:o)},isAbsolute(o){return wn(o,"path"),o.length>0&&o.charCodeAt(0)===yi},join(...o){if(o.length===0)return".";let e;for(let t=0;t<o.length;++t){let n=o[t];wn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":gt.normalize(e)},relative(o,e){if(wn(o,"from"),wn(e,"to"),o===e||(o=gt.resolve(o),e=gt.resolve(e),o===e))return"";let t=1,n=o.length,i=n-t,r=1,s=e.length-r,a=i<s?i:s,l=-1,d=0;for(;d<a;d++){let u=o.charCodeAt(t+d);if(u!==e.charCodeAt(r+d))break;u===yi&&(l=d)}if(d===a)if(s>a){if(e.charCodeAt(r+d)===yi)return e.slice(r+d+1);if(d===0)return e.slice(r+d)}else i>a&&(o.charCodeAt(t+d)===yi?l=d:d===0&&(l=0));let c="";for(d=t+l+1;d<=n;++d)(d===n||o.charCodeAt(d)===yi)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(r+l)}`},toNamespacedPath(o){return o},dirname(o){if(wn(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===yi,t=-1,n=!0;for(let i=o.length-1;i>=1;--i)if(o.charCodeAt(i)===yi){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":o.slice(0,t)},basename(o,e){e!==void 0&&wn(e,"ext"),wn(o,"path");let t=0,n=-1,i=!0,r;if(e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=0;--r){let l=o.charCodeAt(r);if(l===yi){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=0;--r)if(o.charCodeAt(r)===yi){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){wn(o,"path");let e=-1,t=0,n=-1,i=!0,r=0;for(let s=o.length-1;s>=0;--s){let a=o.charCodeAt(s);if(a===yi){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===Ll?e===-1?e=s:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||n===-1||r===0||r===1&&e===n-1&&e===t+1?"":o.slice(e,n)},format:wM.bind(null,"/"),parse(o){wn(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.charCodeAt(0)===yi,n;t?(e.root="/",n=1):n=0;let i=-1,r=0,s=-1,a=!0,l=o.length-1,d=0;for(;l>=n;--l){let c=o.charCodeAt(l);if(c===yi){if(!a){r=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===Ll?i===-1?i=l:d!==1&&(d=1):i!==-1&&(d=-1)}if(s!==-1){let c=r===0&&t?1:r;i===-1||d===0||d===1&&i===s-1&&i===r+1?e.base=e.name=o.slice(c,s):(e.name=o.slice(c,i),e.base=o.slice(c,s),e.ext=o.slice(i,s))}return r>0?e.dir=o.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};gt.win32=yn.win32=yn;gt.posix=yn.posix=gt;var Xb=Eo?yn.normalize:gt.normalize,Hw=Eo?yn.isAbsolute:gt.isAbsolute,Uw=Eo?yn.join:gt.join,EM=Eo?yn.resolve:gt.resolve,TM=Eo?yn.relative:gt.relative,Jb=Eo?yn.dirname:gt.dirname,Rs=Eo?yn.basename:gt.basename,ev=Eo?yn.extname:gt.extname,X6=Eo?yn.format:gt.format,J6=Eo?yn.parse:gt.parse,eK=Eo?yn.toNamespacedPath:gt.toNamespacedPath,oo=Eo?yn.sep:gt.sep,tK=Eo?yn.delimiter:gt.delimiter;var JW=/^\w[\w\d+.-]*$/,eV=/^\//,tV=/^\/\//;function nV(o,e){if(!o.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${o.authority}", path: "${o.path}", query: "${o.query}", fragment: "${o.fragment}"}`);if(o.scheme&&!JW.test(o.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(o.path){if(o.authority){if(!eV.test(o.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(tV.test(o.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function iV(o,e){return!o&&!e?"file":o}function oV(o,e){switch(o){case"https":case"http":case"file":e?e[0]!==Or&&(e=Or+e):e=Or;break}return e}var en="",Or="/",rV=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,be=class o{static isUri(e){return e instanceof o?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,n,i,r,s=!1){typeof e=="object"?(this.scheme=e.scheme||en,this.authority=e.authority||en,this.path=e.path||en,this.query=e.query||en,this.fragment=e.fragment||en):(this.scheme=iV(e,s),this.authority=t||en,this.path=oV(this.scheme,n||en),this.query=i||en,this.fragment=r||en,nV(this,s))}get fsPath(){return Lm(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:r,fragment:s}=e;return t===void 0?t=this.scheme:t===null&&(t=en),n===void 0?n=this.authority:n===null&&(n=en),i===void 0?i=this.path:i===null&&(i=en),r===void 0?r=this.query:r===null&&(r=en),s===void 0?s=this.fragment:s===null&&(s=en),t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&s===this.fragment?this:new kl(t,n,i,r,s)}static parse(e,t=!1){let n=rV.exec(e);return n?new kl(n[2]||en,nv(n[4]||en),nv(n[5]||en),nv(n[7]||en),nv(n[9]||en),t):new kl(en,en,en,en,en)}static file(e){let t=en;if(dt&&(e=e.replace(/\\/g,Or)),e[0]===Or&&e[1]===Or){let n=e.indexOf(Or,2);n===-1?(t=e.substring(2),e=Or):(t=e.substring(2,n),e=e.substring(n)||Or)}return new kl("file",t,e,en,en)}static from(e,t){return new kl(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return dt&&e.scheme==="file"?n=o.file(yn.join(Lm(e,!0),...t)).path:n=gt.join(e.path,...t),e.with({path:n})}toString(e=!1){return zw(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof o)return e;{let t=new kl(e);return t._formatted=e.external??null,t._fsPath=e._sep===DM?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var DM=dt?1:void 0,kl=class extends be{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=Lm(this,!1)),this._fsPath}toString(e=!1){return e?zw(this,!0):(this._formatted||(this._formatted=zw(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=DM),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},RM={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function LM(o,e,t){let n,i=-1;for(let r=0;r<o.length;r++){let s=o.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47||t&&s===91||t&&s===93||t&&s===58)i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n!==void 0&&(n+=o.charAt(r));else{n===void 0&&(n=o.substr(0,r));let a=RM[s];a!==void 0?(i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n+=a):i===-1&&(i=r)}}return i!==-1&&(n+=encodeURIComponent(o.substring(i))),n!==void 0?n:o}function sV(o){let e;for(let t=0;t<o.length;t++){let n=o.charCodeAt(t);n===35||n===63?(e===void 0&&(e=o.substr(0,t)),e+=RM[n]):e!==void 0&&(e+=o[t])}return e!==void 0?e:o}function Lm(o,e){let t;return o.authority&&o.path.length>1&&o.scheme==="file"?t=`//${o.authority}${o.path}`:o.path.charCodeAt(0)===47&&(o.path.charCodeAt(1)>=65&&o.path.charCodeAt(1)<=90||o.path.charCodeAt(1)>=97&&o.path.charCodeAt(1)<=122)&&o.path.charCodeAt(2)===58?e?t=o.path.substr(1):t=o.path[1].toLowerCase()+o.path.substr(2):t=o.path,dt&&(t=t.replace(/\//g,"\\")),t}function zw(o,e){let t=e?sV:LM,n="",{scheme:i,authority:r,path:s,query:a,fragment:l}=o;if(i&&(n+=i,n+=":"),(r||i==="file")&&(n+=Or,n+=Or),r){let d=r.indexOf("@");if(d!==-1){let c=r.substr(0,d);r=r.substr(d+1),d=c.lastIndexOf(":"),d===-1?n+=t(c,!1,!1):(n+=t(c.substr(0,d),!1,!1),n+=":",n+=t(c.substr(d+1),!1,!0)),n+="@"}r=r.toLowerCase(),d=r.lastIndexOf(":"),d===-1?n+=t(r,!1,!0):(n+=t(r.substr(0,d),!1,!0),n+=r.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}n+=t(s,!0,!1)}return a&&(n+="?",n+=t(a,!1,!1)),l&&(n+="#",n+=e?l:LM(l,!1,!1)),n}function MM(o){try{return decodeURIComponent(o)}catch{return o.length>3?o.substr(0,3)+MM(o.substr(3)):o}}var kM=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function nv(o){return o.match(kM)?o.replace(kM,e=>MM(e)):o}function jw(o,e,t){let n=o.get(e);return n===void 0&&(n=t,o.set(e,n)),n}var Kw=class{constructor(e,t){this.uri=e;this.value=t}};function aV(o){return Array.isArray(o)}var Vi=class o{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof o)this.map=new Map(e.map),this.toKey=t??o.defaultToKey;else if(aV(e)){this.map=new Map,this.toKey=t??o.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e??o.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new Kw(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[n,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}},iv=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(e,t){!e||typeof e=="function"?this._map=new Vi(e):(this._map=new Vi(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var Gw=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.key,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.value,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:[n.key,n.value],done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},$w=class extends Gw{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Hi=class extends $w{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}};var Ru=class{map=new Map;add(e,t){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(t)}delete(e,t){let n=this.map.get(e);n&&(n.delete(t),n.size===0&&this.map.delete(e))}forEach(e,t){let n=this.map.get(e);n&&n.forEach(t)}get(e){let t=this.map.get(e);return t||new Set}};var gr;(C=>{function o(S){return S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}C.is=o;let e=Object.freeze([]);function t(){return e}C.empty=t;function*n(S){yield S}C.single=n;function i(S){return o(S)?S:n(S)}C.wrap=i;function r(S){return S||e}C.from=r;function*s(S){for(let E=S.length-1;E>=0;E--)yield S[E]}C.reverse=s;function a(S){return!S||S[Symbol.iterator]().next().done===!0}C.isEmpty=a;function l(S){return S[Symbol.iterator]().next().value}C.first=l;function d(S,E){let M=0;for(let A of S)if(E(A,M++))return!0;return!1}C.some=d;function c(S,E){for(let M of S)if(E(M))return M}C.find=c;function*u(S,E){for(let M of S)E(M)&&(yield M)}C.filter=u;function*p(S,E){let M=0;for(let A of S)yield E(A,M++)}C.map=p;function*m(S,E){let M=0;for(let A of S)yield*E(A,M++)}C.flatMap=m;function*g(...S){for(let E of S)yield*E}C.concat=g;function f(S,E,M){let A=M;for(let F of S)A=E(A,F);return A}C.reduce=f;function*b(S,E,M=S.length){for(E<0&&(E+=S.length),M<0?M+=S.length:M>S.length&&(M=S.length);E<M;E++)yield S[E]}C.slice=b;function v(S,E=Number.POSITIVE_INFINITY){let M=[];if(E===0)return[M,S];let A=S[Symbol.iterator]();for(let F=0;F<E;F++){let O=A.next();if(O.done)return[M,C.empty()];M.push(O.value)}return[M,{[Symbol.iterator](){return A}}]}C.consume=v;async function I(S){let E=[];for await(let M of S)E.push(M);return Promise.resolve(E)}C.asyncToArray=I})(gr||={});var lV=!1,zd=null;function dV(o){zd=o}if(lV){let o="__is_disposable_tracked__";dV(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[o]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==W.None)try{e[o]=!0}catch{}}markAsDisposed(e){if(e&&e!==W.None)try{e[o]=!0}catch{}}markAsSingleton(e){}})}function Bd(o){return zd?.trackDisposable(o),o}function Wd(o){zd?.markAsDisposed(o)}function km(o,e){zd?.setParent(o,e)}function cV(o,e){if(zd)for(let t of o)zd.setParent(t,e)}function Dl(o){return zd?.markAsSingleton(o),o}function ov(o){return typeof o=="object"&&o!==null&&typeof o.dispose=="function"&&o.dispose.length===0}function xt(o){if(gr.is(o)){let e=[];for(let t of o)if(t)try{t.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(o)?[]:o}else if(o)return o.dispose(),o}function Ts(...o){let e=ge(()=>xt(o));return cV(o,e),e}function ge(o){let e=Bd({dispose:wa(()=>{Wd(e),o()})});return e}var te=class o{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){Bd(this)}dispose(){this._isDisposed||(Wd(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{xt(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return km(e,this),this._isDisposed?o.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),km(e,null))}},W=class{static None=Object.freeze({dispose(){}});_store=new te;constructor(){Bd(this),km(this._store,this)}dispose(){Wd(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Ut=class{_value;_isDisposed=!1;constructor(){Bd(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&km(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Wd(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&km(e,null),e}};var Yo=class{_store=new Map;_isDisposed=!1;constructor(){Bd(this)}dispose(){Wd(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{xt(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};function PM(o){let e=!1,t=new Map,n=new Map;if(uV(o,c=>{if(o===c)return!0;let u=JSON.stringify(c);if(u.length<30)return!0;let p=t.get(u);if(!p){let m={schemas:[c]};return t.set(u,m),n.set(c,m),!0}return p.schemas.push(c),n.set(c,p),e=!0,!1}),t.clear(),!e)return JSON.stringify(o);let r="$defs";for(;o.hasOwnProperty(r);)r+="_";let s=[];function a(c){return JSON.stringify(c,(u,p)=>{if(p!==c){let m=n.get(p);if(m&&m.schemas.length>1)return m.id||(m.id=`_${s.length}`,s.push(m.schemas[0])),{$ref:`#/${r}/${m.id}`}}return p})}let l=a(o),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${r}":{${d.join(",")}}}`:l}function Mu(o){return typeof o=="object"&&o!==null}function uV(o,e){if(!o||typeof o!="object")return;let t=(...l)=>{for(let d of l)Mu(d)&&s.push(d)},n=(...l)=>{for(let d of l)if(Mu(d))for(let c in d){let u=d[c];Mu(u)&&s.push(u)}},i=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)Mu(c)&&s.push(c)},r=l=>{if(Array.isArray(l))for(let d of l)Mu(d)&&s.push(d);else Mu(l)&&s.push(l)},s=[o],a=s.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),i(a.anyOf,a.allOf,a.oneOf,a.prefixItems),r(a.items)),a=s.pop()}function rn(o){return typeof o=="string"}function pn(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&!(o instanceof RegExp)&&!(o instanceof Date)}function ro(o){return typeof o=="number"&&!isNaN(o)}function rv(o){return o===!0||o===!1}function ki(o){return typeof o>"u"}function Pa(o){return!Ii(o)}function Ii(o){return ki(o)||o===null}function Ci(o,e){if(!o)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Ms(o){if(Ii(o))throw new Error("Assertion Failed: argument is undefined or null");return o}var pV=Object.prototype.hasOwnProperty;function AM(o){if(!pn(o))return!1;for(let e in o)if(pV.call(o,e))return!1;return!0}function Pu(o){return typeof o=="function"}function NM(o,e){let t=Math.min(o.length,e.length);for(let n=0;n<t;n++)hV(o[n],e[n])}function hV(o,e){if(rn(e)){if(typeof o!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Pu(e)){try{if(o instanceof e)return}catch{}if(!Ii(o)&&o.constructor===e||e.length===1&&e.call(void 0,o)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var Dm=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}};var sv=class{_entries=new Map;constructor(...e){for(let[t,n]of e)this.set(t,n)}set(e,t){let n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var Ml;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function n(r){return r[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=n})(Ml||={});var ct=Y("instantiationService");function mV(o,e,t){e[Ml.DI_TARGET]===e?e[Ml.DI_DEPENDENCIES].push({id:o,index:t}):(e[Ml.DI_DEPENDENCIES]=[{id:o,index:t}],e[Ml.DI_TARGET]=e)}function Y(o){if(Ml.serviceIds.has(o))return Ml.serviceIds.get(o);let e=function(t,n,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");mV(e,t,i)};return e.toString=()=>o,Ml.serviceIds.set(o,e),e}function OM(o){return o}var av=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=OM):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},Pl=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=OM):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let n=this._fn(e);return this._map.set(e,n),this._map2.set(t,n),n}};var Nn=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function Kd(o){return o<0?0:o>255?255:o|0}function dv(o){return!o||typeof o!="string"?!0:o.trim().length===0}var gV=/{(\d+)}/g;function Qw(o,...e){return e.length===0?o:o.replace(gV,function(t,n){let i=parseInt(n,10);return isNaN(i)||i<0||i>=e.length?t:e[i]})}function BM(o){return o.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function Yd(o){return o.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Ui(o){return o.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function cv(o,e){if(!o||!e)return o;let t=e.length;if(t===0||o.length===0)return o;let n=0;for(;o.indexOf(e,n)===n;)n=n+t;return o.substring(n)}function uv(o,e,t={}){if(!o)throw new Error("Cannot create regex from empty string");e||(o=Ui(o)),t.wholeWord&&(/\B/.test(o.charAt(0))||(o="\\b"+o),/\B/.test(o.charAt(o.length-1))||(o=o+"\\b"));let n="";return t.global&&(n+="g"),t.matchCase||(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),new RegExp(o,n)}function Fr(o){return o.split(/\r\n|\r|\n/)}function WM(o){let e=[],t=o.split(/(\r\n|\r|\n)/);for(let n=0;n<Math.ceil(t.length/2);n++)e.push(t[2*n]+(t[2*n+1]??""));return e}function $t(o){for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function Rt(o,e=0,t=o.length){for(let n=e;n<t;n++){let i=o.charCodeAt(n);if(i!==32&&i!==9)return o.substring(e,n)}return o.substring(e,t)}function Zo(o,e=o.length-1){for(let t=e;t>=0;t--){let n=o.charCodeAt(t);if(n!==32&&n!==9)return t}return-1}function Rm(o,e){return o<e?-1:o>e?1:0}function pv(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l<d)return-1;if(l>d)return 1}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function Mm(o,e){return Au(o,e,0,o.length,0,e.length)}function Au(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l===d)continue;if(l>=128||d>=128)return pv(o.toLowerCase(),e.toLowerCase(),t,n,i,r);Gd(l)&&(l-=32),Gd(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function Pm(o){return o>=48&&o<=57}function Gd(o){return o>=97&&o<=122}function Ps(o){return o>=65&&o<=90}function fr(o,e){return o.length===e.length&&Au(o,e)===0}function Al(o,e){let t=e.length;return e.length>o.length?!1:Au(o,e,0,t)===0}function Br(o,e){let t=Math.min(o.length,e.length),n;for(n=0;n<t;n++)if(o.charCodeAt(n)!==e.charCodeAt(n))return n;return t}function Am(o,e){let t=Math.min(o.length,e.length),n,i=o.length-1,r=e.length-1;for(n=0;n<t;n++)if(o.charCodeAt(i-n)!==e.charCodeAt(r-n))return n;return t}function Ot(o){return 55296<=o&&o<=56319}function As(o){return 56320<=o&&o<=57343}function hv(o,e){return(o-55296<<10)+(e-56320)+65536}function Nu(o,e,t){let n=o.charCodeAt(t);if(Ot(n)&&t+1<e){let i=o.charCodeAt(t+1);if(As(i))return hv(n,i)}return n}function fV(o,e){let t=o.charCodeAt(e-1);if(As(t)&&e>1){let n=o.charCodeAt(e-2);if(Ot(n))return hv(n,t)}return t}var $d=class{_str;_len;_offset;get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=fV(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){let e=Nu(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},jd=class{_iterator;get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new $d(e,t)}nextGraphemeLength(){let e=lv.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let r=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(FM(i,s)){t.setOffset(r);break}i=s}return t.offset-n}prevGraphemeLength(){let e=lv.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let r=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(FM(s,i)){t.setOffset(r);break}i=s}return n-t.offset}eol(){return this._iterator.eol()}};function Nm(o,e){return new jd(o,e).nextGraphemeLength()}function Zw(o,e){return new jd(o,e).prevGraphemeLength()}function mv(o,e){e>0&&As(o.charCodeAt(e))&&e--;let t=e+Nm(o,e);return[t-Zw(o,t),t]}var qw;function bV(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Wr(o){return qw||(qw=bV()),qw.test(o)}var vV=/^[\t\n\r\x20-\x7E]*$/;function Qd(o){return vV.test(o)}var Xw=/[\u2028\u2029]/;function gv(o){return Xw.test(o)}function Xo(o){return o>=11904&&o<=55215||o>=63744&&o<=64255||o>=65281&&o<=65374}function Om(o){return o>=127462&&o<=127487||o===8986||o===8987||o===9200||o===9203||o>=9728&&o<=10175||o===11088||o===11093||o>=127744&&o<=128591||o>=128640&&o<=128764||o>=128992&&o<=129008||o>=129280&&o<=129535||o>=129648&&o<=129782}var VM=String.fromCharCode(65279);function HM(o){return!!(o&&o.length>0&&o.charCodeAt(0)===65279)}function fv(o){let e=26;return o=o%(2*e),o<e?String.fromCharCode(97+o):String.fromCharCode(65+o-e)}function FM(o,e){return o===0?e!==5&&e!==7:o===2&&e===3?!1:o===4||o===2||o===3||e===4||e===2||e===3?!0:!(o===8&&(e===8||e===9||e===11||e===12)||(o===11||o===9)&&(e===9||e===10)||(o===12||o===10)&&e===10||e===5||e===13||e===7||o===1||o===13&&e===14||o===6&&e===6)}var lv=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_data;constructor(){this._data=yV()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,n=t.length/3,i=1;for(;i<=n;)if(e<t[3*i])i=2*i;else if(e>t[3*i+1])i=2*i+1;else return t[3*i+2];return 0}};function yV(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function UM(o,e){if(o===0)return 0;let t=IV(o,e);if(t!==void 0)return t;let n=new $d(e,o);return n.prevCodePoint(),n.offset}function IV(o,e){let t=new $d(e,o),n=t.prevCodePoint();for(;CV(n)||n===65039||n===8419;){if(t.offset===0)return;n=t.prevCodePoint()}if(!Om(n))return;let i=t.offset;return i>0&&t.prevCodePoint()===8205&&(i=t.offset),i}function CV(o){return 127995<=o&&o<=127999}var Yw=class o{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new Nn(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new av({getCacheKey:JSON.stringify},e=>{function t(c){let u=new Map;for(let p=0;p<c.length;p+=2)u.set(c[p],c[p+1]);return u}function n(c,u){let p=new Map(c);for(let[m,g]of u)p.set(m,g);return p}function i(c,u){if(!c)return u;let p=new Map;for(let[m,g]of c)u.has(m)&&p.set(m,g);return p}let r=this.ambiguousCharacterData.value,s=e.filter(c=>!c.startsWith("_")&&c in r);s.length===0&&(s=["_default"]);let a;for(let c of s){let u=t(r[c]);a=i(a,u)}let l=t(r._common),d=n(l,a);return new o(d)});static getInstance(e){return o.cache.get(Array.from(e))}static _locales=new Nn(()=>Object.keys(o.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return o._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let n=e.codePointAt(t);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};var Jw=class{_value="";_pos=0;reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){let t=e.charCodeAt(0),n=this._value.charCodeAt(this._pos);return t-n}value(){return this._value[this._pos]}},eE=class{constructor(e=!0){this._caseSensitive=e}_value;_from;_to;reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?pv(e,this._value,0,e.length,this._from,this._to):Au(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},bv=class{constructor(e=!0,t=!0){this._splitOnBackslash=e;this._caseSensitive=t}_value;_valueLen;_from;_to;reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){let n=this._value.charCodeAt(t);if(!(n===47||this._splitOnBackslash&&n===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){let t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?pv(e,this._value,0,e.length,this._from,this._to):Au(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}};var tE=class{constructor(e,t){this._ignorePathCasing=e;this._ignoreQueryAndFragment=t}_pathIterator;_value;_states=[];_stateIdx=0;reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new bv(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return Mm(e,this._value.scheme);if(this._states[this._stateIdx]===2)return Mm(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return Rm(e,this._value.query);if(this._states[this._stateIdx]===5)return Rm(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}},Ou=class{height=1;segment;value;key;left;mid;right;isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){let e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){let e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}};var Fu=class o{static forUris(e=()=>!1,t=()=>!1){return new o(new tE(e,t))}static forPaths(e=!1){return new o(new bv(void 0,!e))}static forStrings(){return new o(new Jw)}static forConfigKeys(){return new o(new eE)}_iter;_root;constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,t){if(t){let n=t.slice(0);Rw(n);for(let i of n)this.set(i,e)}else{let n=e.slice(0);Rw(n);for(let i of n)this.set(i[0],i[1])}}set(e,t){let n=this._iter.reset(e),i;this._root||(this._root=new Ou,this._root.segment=n.value());let r=[];for(i=this._root;;){let a=n.cmp(i.segment);if(a>0)i.left||(i.left=new Ou,i.left.segment=n.value()),r.push([-1,i]),i=i.left;else if(a<0)i.right||(i.right=new Ou,i.right.segment=n.value()),r.push([1,i]),i=i.right;else if(n.hasNext())n.next(),i.mid||(i.mid=new Ou,i.mid.segment=n.value()),r.push([0,i]),i=i.mid;else break}let s=i.value;i.value=t,i.key=e;for(let a=r.length-1;a>=0;a--){let l=r[a][1];l.updateHeight();let d=l.balanceFactor();if(d<-1||d>1){let c=r[a][0],u=r[a+1][0];if(c===1&&u===1)r[a][1]=l.rotateLeft();else if(c===-1&&u===-1)r[a][1]=l.rotateRight();else if(c===1&&u===-1)l.right=r[a+1][1]=r[a+1][1].rotateRight(),r[a][1]=l.rotateLeft();else if(c===-1&&u===1)l.left=r[a+1][1]=r[a+1][1].rotateLeft(),r[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(r[a-1][0]){case-1:r[a-1][1].left=r[a][1];break;case 1:r[a-1][1].right=r[a][1];break;case 0:r[a-1][1].mid=r[a][1];break}else this._root=r[0][1]}}return s}get(e){return this._getNode(e)?.value}_getNode(e){let t=this._iter.reset(e),n=this._root;for(;n;){let i=t.cmp(n.segment);if(i>0)n=n.left;else if(i<0)n=n.right;else if(t.hasNext())t.next(),n=n.mid;else break}return n}has(e){let t=this._getNode(e);return!(t?.value===void 0&&t?.mid===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){let n=this._iter.reset(e),i=[],r=this._root;for(;r;){let s=n.cmp(r.segment);if(s>0)i.push([-1,r]),r=r.left;else if(s<0)i.push([1,r]),r=r.right;else if(n.hasNext())n.next(),i.push([0,r]),r=r.mid;else break}if(r){if(t?(r.left=void 0,r.mid=void 0,r.right=void 0,r.height=1):(r.key=void 0,r.value=void 0),!r.mid&&!r.value)if(r.left&&r.right){let s=this._min(r.right);if(s.key){let{key:a,value:l,segment:d}=s;this._delete(s.key,!1),r.key=a,r.value=l,r.segment=d}}else{let s=r.left??r.right;if(i.length>0){let[a,l]=i[i.length-1];switch(a){case-1:l.left=s;break;case 0:l.mid=s;break;case 1:l.right=s;break}}else this._root=s}for(let s=i.length-1;s>=0;s--){let a=i[s][1];a.updateHeight();let l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),i[s][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),i[s][1]=a.rotateRight()),s>0)switch(i[s-1][0]){case-1:i[s-1][1].left=i[s][1];break;case 1:i[s-1][1].right=i[s][1];break;case 0:i[s-1][1].mid=i[s][1];break}else this._root=i[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){let t=this._iter.reset(e),n=this._root,i;for(;n;){let r=t.cmp(n.segment);if(r>0)n=n.left;else if(r<0)n=n.right;else if(t.hasNext())t.next(),i=n.value||i,n=n.mid;else break}return n&&n.value||i}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){let n=this._iter.reset(e),i=this._root;for(;i;){let r=n.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(n.hasNext())n.next(),i=i.mid;else return i.mid?this._entries(i.mid):t?i.value:void 0}}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,!0)!==void 0}forEach(e){for(let[t,n]of this)e(n,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){let t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}_isBalanced(){let e=t=>{if(!t)return!0;let n=t.balanceFactor();return n<-1||n>1?!1:e(t.left)&&e(t.right)};return e(this._root)}};function Nl(o){return o===47||o===92}function vv(o){return o.replace(/[\\/]/g,gt.sep)}function KM(o){return o.indexOf("/")===-1&&(o=vv(o)),/^[a-zA-Z]:(\/|$)/.test(o)&&(o="/"+o),o}function nE(o,e=gt.sep){if(!o)return"";let t=o.length,n=o.charCodeAt(0);if(Nl(n)){if(Nl(o.charCodeAt(1))&&!Nl(o.charCodeAt(2))){let r=3,s=r;for(;r<t&&!Nl(o.charCodeAt(r));r++);if(s!==r&&!Nl(o.charCodeAt(r+1))){for(r+=1;r<t;r++)if(Nl(o.charCodeAt(r)))return o.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(GM(n)&&o.charCodeAt(1)===58)return Nl(o.charCodeAt(2))?o.slice(0,2)+e:o.slice(0,2);let i=o.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(Nl(o.charCodeAt(i)))return o.slice(0,i+1)}return""}function Fm(o,e,t,n=oo){if(o===e)return!0;if(!o||!e||e.length>o.length)return!1;if(t){if(!Al(o,e))return!1;if(e.length===o.length)return!0;let r=e.length;return e.charAt(e.length-1)===n&&r--,o.charAt(r)===n}return e.charAt(e.length-1)!==n&&(e+=n),o.indexOf(e)===0}function GM(o){return o>=65&&o<=90||o>=97&&o<=122}function iE(o,e=dt){return e?GM(o.charCodeAt(0))&&o.charCodeAt(1)===58:!1}function $M(o,e=dt){return iE(o,e)?o[0]:void 0}var $e;(ke=>(ke.inMemory="inmemory",ke.vscode="vscode",ke.internal="private",ke.walkThrough="walkThrough",ke.walkThroughSnippet="walkThroughSnippet",ke.http="http",ke.https="https",ke.file="file",ke.mailto="mailto",ke.untitled="untitled",ke.data="data",ke.command="command",ke.vscodeRemote="vscode-remote",ke.vscodeRemoteResource="vscode-remote-resource",ke.vscodeManagedRemoteResource="vscode-managed-remote-resource",ke.vscodeUserData="vscode-userdata",ke.vscodeCustomEditor="vscode-custom-editor",ke.vscodeNotebookCell="vscode-notebook-cell",ke.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",ke.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",ke.vscodeNotebookCellOutput="vscode-notebook-cell-output",ke.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",ke.vscodeNotebookMetadata="vscode-notebook-metadata",ke.vscodeInteractiveInput="vscode-interactive-input",ke.vscodeSettings="vscode-settings",ke.vscodeWorkspaceTrust="vscode-workspace-trust",ke.vscodeTerminal="vscode-terminal",ke.vscodeChatCodeBlock="vscode-chat-code-block",ke.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",ke.vscodeChatSesssion="vscode-chat-editor",ke.webviewPanel="webview-panel",ke.vscodeWebview="vscode-webview",ke.extension="extension",ke.vscodeFileResource="vscode-file",ke.tmp="tmp",ke.vsls="vsls",ke.vscodeSourceControl="vscode-scm",ke.commentsInput="comment",ke.codeSetting="code-setting",ke.outputChannel="output"))($e||={});function jM(o,e){return be.isUri(o)?fr(o.scheme,e):Al(o,e+":")}var xV="tkn",oE=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=_V(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return gt.join(this._serverRootPath,$e.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Ue(a),e}let t=e.authority,n=this._hosts[t];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let i=this._ports[t],r=this._connectionTokens[t],s=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(s+=`&${xV}=${encodeURIComponent(r)}`),be.from({scheme:Ds?this._preferredWebSchema:$e.vscodeRemoteResource,authority:`${n}:${i}`,path:this._remoteResourcesPath,query:s})}},yv=new oE;function _V(o,e){return gt.join(e??"/",`${o.quality??"oss"}-${o.commit??"dev"}`)}var sE="vscode-app",rE=class o{static FALLBACK_AUTHORITY=sE;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===$e.vscodeRemote?yv.rewrite(e):e.scheme===$e.file&&(Ma||bM===`${$e.vscodeFileResource}://${o.FALLBACK_AUTHORITY}`)?e.with({scheme:$e.vscodeFileResource,authority:e.authority||o.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===$e.vscodeFileResource?e.with({scheme:$e.file,authority:e.authority!==o.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(be.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n))return be.joinPath(be.parse(n,!0),e);let i=Uw(n,e);return be.file(i)}return be.parse(t.toUrl(e))}},Zd=new rE,wV;(r=>{let o=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(o.get("3"));let t="vscode-coi";function n(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:be.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(t);if(l)return o.get(l)}r.getHeadersFromQuery=n;function i(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(t,d):s[t]=d}r.addSearchParam=i})(wV||={});function Aa(o){return Lm(o,!0)}var Bm=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:Rm(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===$e.file)return Fm(Aa(e),Aa(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if(qM(e.authority,t.authority))return Fm(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return be.joinPath(e,...t)}basenameOrAuthority(e){return Ol(e)||e.authority}basename(e){return gt.basename(e.path)}extname(e){return gt.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===$e.file?t=be.file(Jb(Aa(e))).path:(t=gt.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===$e.file?t=be.file(Xb(Aa(e))).path:t=gt.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!qM(e.authority,t.authority))return;if(e.scheme===$e.file){let r=TM(Aa(e),Aa(t));return dt?vv(r):r}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(let s=Math.min(n.length,i.length);r<s&&!(n.charCodeAt(r)!==i.charCodeAt(r)&&n.charAt(r).toLowerCase()!==i.charAt(r).toLowerCase());r++);n=i.substr(0,r)+n.substr(r)}return gt.relative(n,i)}resolvePath(e,t){if(e.scheme===$e.file){let n=be.file(EM(Aa(e),t));return e.with({authority:n.authority,path:n.path})}return t=KM(t),e.with({path:gt.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&fr(e,t)}hasTrailingPathSeparator(e,t=oo){if(e.scheme===$e.file){let n=Aa(e);return n.length>nE(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=oo){return YM(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=oo){let n=!1;if(e.scheme===$e.file){let i=Aa(e);n=i!==void 0&&i.length===nE(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!YM(e,t)?e.with({path:e.path+"/"}):e}},wt=new Bm(()=>!1),EV=new Bm(o=>o.scheme===$e.file?!Gt:!0),TV=new Bm(o=>!0),aE=wt.isEqual.bind(wt),aG=wt.isEqualOrParent.bind(wt),lG=wt.getComparisonKey.bind(wt),LV=wt.basenameOrAuthority.bind(wt),Ol=wt.basename.bind(wt),lE=wt.extname.bind(wt),Iv=wt.dirname.bind(wt),Jo=wt.joinPath.bind(wt),dG=wt.normalizePath.bind(wt),QM=wt.relativePath.bind(wt),dE=wt.resolvePath.bind(wt),cG=wt.isAbsolutePath.bind(wt),qM=wt.isEqualAuthority.bind(wt),YM=wt.hasTrailingPathSeparator.bind(wt),uG=wt.removeTrailingPathSeparator.bind(wt),pG=wt.addTrailingPathSeparator.bind(wt);var Bu;(r=>{r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[u,p]=c.split(":");u&&p&&a.set(u,p)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(r.META_DATA_MIME,d),a}r.parseMetaData=i})(Bu||={});var Vr=Y("environmentService"),bG=Vr;var Na=Y("contextService");function Fl(o){let e=o;return typeof e?.id=="string"&&be.isUri(e.uri)}function ZM(o){return typeof o?.id=="string"&&!Fl(o)&&!Wm(o)}var DV={id:"ext-dev"},RV={id:"empty-window"};function XM(o,e){if(typeof o=="string"||typeof o>"u")return typeof o=="string"?{id:Rs(o)}:e?DV:RV;let t=o;return t.configuration?{id:t.id,configPath:t.configuration}:t.folders.length===1?{id:t.id,uri:t.folders[0].uri}:{id:t.id}}function Wm(o){let e=o;return typeof e?.id=="string"&&be.isUri(e.configPath)}var Vm="code-workspace",RG=`.${Vm}`,MG=[{name:h("codeWorkspace","Code Workspace"),extensions:[Vm]}];var tn=Y("configurationService");function JM(o){return o.replace(/[\[\]]/g,"")}var cE=class{data=new Map;add(e,t){wb(rn(e)),wb(pn(t)),wb(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},tt=new cE;var Xd={JSONContribution:"base.contributions.json"};function MV(o){return o.length>0&&o.charAt(o.length-1)==="#"?o.substring(0,o.length-1):o}var uE=class{schemasById;_onDidChangeSchema=new L;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(e,t){this.schemasById[MV(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?PM(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}},PV=new uE;tt.add(Xd.JSONContribution,PV);var JG=Y("policy");var Ns={Configuration:"base.contributions.configuration"};var Sv={properties:{},patternProperties:{}},xv={properties:{},patternProperties:{}},_v={properties:{},patternProperties:{}},wv={properties:{},patternProperties:{}},Ev={properties:{},patternProperties:{}},Hm={properties:{},patternProperties:{}},Jd="vscode://schemas/settings/resourceLanguage";var Tv=tt.as(Xd.JSONContribution),pE=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new L;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new L;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},Tv.registerSchema(Jd,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){let n=new Set;this.doRegisterConfigurations(e,t,n),Tv.registerSchema(Jd,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),Tv.registerSchema(Jd,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),Tv.registerSchema(Jd,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let n=[];for(let{overrides:i,source:r}of e)for(let s in i){t.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=i[s];if(a.configurationDefaultOverrides.push({value:l,source:r}),Wu.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,r),n.push(...AV(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let n of e){let i=this.registeredConfigurationDefaults.indexOf(n);i!==-1&&this.registeredConfigurationDefaults.splice(i,1)}for(let{overrides:n,source:i}of e)for(let r in n){let s=this.configurationDefaultsOverrides.get(r);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>i?l.source?.id===i.id:l.value===n[r]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(r),Wu.test(r)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(r,d.value,d.source,l);l&&!AM(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(r,l,i)):(this.configurationDefaultsOverrides.delete(r),delete this.configurationProperties[r],delete this.defaultLanguageConfigurationOverridesNode.properties[r])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(r,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}t.add(r)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){let i={type:"object",default:t.value,description:h("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",JM(e)),$ref:Jd,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=i,this.defaultLanguageConfigurationOverridesNode.properties[e]=i}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,i){let r=i?.value||{},s=i?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(t)){let l=t[a];if(pn(l)&&(ki(r[a])||pn(r[a]))){if(r[a]={...r[a]??{},...l},n)for(let c in l)s.set(`${a}.${c}`,n)}else r[a]=l,n?s.set(a,n):s.delete(a)}return{value:r,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,i){let r=this.configurationProperties[e],s=i?.value??r?.defaultDefaultValue,a=n;if(pn(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(ki(s)||pn(s)))){if(a=i?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in t)n&&a.set(`${e}.${d}`,n);t={...pn(s)?s:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1,n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(i=>{this.validateAndRegisterProperties(i,t,i.extensionInfo,i.restrictedProperties,void 0,n),this.configurationContributors.push(i),this.registerJSONConfiguration(i)})}doDeregisterConfigurations(e,t){let n=i=>{if(i.properties)for(let r in i.properties){t.add(r);let s=this.configurationProperties[r];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[r],this.removeFromSchema(r,i.properties[r])}i.allOf?.forEach(r=>n(r))};for(let i of e){n(i);let r=this.configurationContributors.indexOf(i);r!==-1&&this.configurationContributors.splice(r,1)}}validateAndRegisterProperties(e,t=!0,n,i,r=3,s){r=Ii(e.scope)?r:e.scope;let a=e.properties;if(a)for(let d in a){let c=a[d];if(t&&OV(d,c)){delete a[d];continue}if(c.source=n,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),Wu.test(d)?c.scope=void 0:(c.scope=Ii(c.scope)?r:c.scope,c.restricted=Ii(c.restricted)?!!i?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=e.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,t,n,i,r,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=n=>{let i=n.properties;if(i)for(let s in i)this.updateSchema(s,i[s]);n.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(Sv.properties[e]=t,t.scope){case 1:xv.properties[e]=t;break;case 2:_v.properties[e]=t;break;case 6:wv.properties[e]=t;break;case 3:Ev.properties[e]=t;break;case 4:Hm.properties[e]=t;break;case 5:Hm.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete Sv.properties[e],t.scope){case 1:delete xv.properties[e];break;case 2:delete _v.properties[e];break;case 6:delete wv.properties[e];break;case 3:delete Ev.properties[e];break;case 4:case 5:delete Hm.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,n={type:"object",description:h("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:h("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:Jd};this.updatePropertyDefaultValue(t,n),Sv.properties[t]=n,xv.properties[t]=n,_v.properties[t]=n,wv.properties[t]=n,Ev.properties[t]=n,Hm.properties[t]=n}}registerOverridePropertyPatternKey(){let e={type:"object",description:h("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:h("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:Jd};Sv.patternProperties[ec]=e,xv.patternProperties[ec]=e,_v.patternProperties[ec]=e,wv.patternProperties[ec]=e,Ev.patternProperties[ec]=e,Hm.patternProperties[ec]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,i,r;n&&(!t.disallowConfigurationDefault||!n.source)&&(i=n.value,r=n.source),ki(i)&&(i=t.defaultDefaultValue,r=void 0),ki(i)&&(i=NV(t.type)),t.default=i,t.defaultValueSource=r}},tP="\\[([^\\]]+)\\]",eP=new RegExp(tP,"g"),ec=`^(${tP})+$`,Wu=new RegExp(ec);function AV(o){let e=[];if(Wu.test(o)){let t=eP.exec(o);for(;t?.length;){let n=t[1].trim();n&&e.push(n),t=eP.exec(o)}}return La(e)}function NV(o){switch(Array.isArray(o)?o[0]:o){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var Lv=new pE;tt.add(Ns.Configuration,Lv);function OV(o,e){return o.trim()?Wu.test(o)?h("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",o):Lv.getConfigurationProperties()[o]!==void 0?h("config.property.duplicate","Cannot register '{0}'. This property is already registered.",o):e.policy?.name&&Lv.getPolicyConfigurations().get(e.policy?.name)!==void 0?h("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",o,e.policy?.name,Lv.getPolicyConfigurations().get(e.policy?.name)):null:h("config.property.empty","Cannot register an empty property")}function hE(...o){switch(o.length){case 1:return h("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",o[0]);case 2:return h("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",o[0],o[1]);case 3:return h("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",o[0],o[1],o[2]);default:return}}var FV=h("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),BV=h("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),Bl=class o{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw AR(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(hE("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(hE("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(hE("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,n=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),n=o._keywords.get(t);n?this._addToken(n):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(FV);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,n=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(BV);return}let r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!n){e++;break}else r===91?n=!0:r===92?t=!0:r===93&&(n=!1);e++}for(;e<this._input.length&&o._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var oi=new Map;oi.set("false",!1);oi.set("true",!0);oi.set("isMac",Be);oi.set("isLinux",Gt);oi.set("isWindows",dt);oi.set("isWeb",Ds);oi.set("isMacNative",Be&&!Ds);oi.set("isEdge",SM);oi.set("isFirefox",IM);oi.set("isChrome",Bw);oi.set("isSafari",CM);var WV=Object.prototype.hasOwnProperty;var VV={regexParsingWithErrorRecovery:!0},HV=h("contextkey.parser.error.emptyString","Empty context key expression"),UV=h("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),zV=h("contextkey.parser.error.noInAfterNot","'in' after 'not'."),nP=h("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),KV=h("contextkey.parser.error.unexpectedToken","Unexpected token"),GV=h("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),$V=h("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),jV=h("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),mE=class o{constructor(e=VV){this._config=e}static _parseError=new Error;_scanner=new Bl;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:HV,offset:0,lexeme:"",additionalInfo:UV});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let n=this._peek(),i=n.type===17?GV:void 0;throw this._parsingErrors.push({message:KV,offset:n.offset,lexeme:Bl.getLexeme(n),additionalInfo:i}),o._parseError}return t}catch(t){if(t!==o._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:pe.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:pe.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),Di.INSTANCE;case 12:return this._advance(),zi.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,nP),t?.negate()}case 17:return this._advance(),nc.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),pe.true();case 12:return this._advance(),pe.false();case 0:{this._advance();let t=this._expr();return this._consume(1,nP),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let r=i.lexeme,s=r.lastIndexOf("/"),a=s===r.length-1?void 0:this._removeFlagsGY(r.substring(s+1)),l;try{l=new RegExp(r.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",i)}return Ym.create(t,l)}switch(i.type){case 10:case 19:{let r=[i.lexeme];this._advance();let s=this._peek(),a=0;for(let p=0;p<i.lexeme.length;p++)i.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let p=0;p<s.lexeme.length;p++)s.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--}if(a<0)break;r.push(Bl.getLexeme(s)),this._advance(),s=this._peek()}let l=r.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),u;try{u=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",i)}return pe.regex(t,u)}case 18:{let r=i.lexeme;this._advance();let s=null;if(!dv(r)){let a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){let d=r.slice(a+1,l),c=r[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return Ym.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,zV);let i=this._value();return pe.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return pe.equals(t,i);switch(i){case"true":return pe.has(t);case"false":return pe.not(t);default:return pe.equals(t,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return pe.notEquals(t,i);switch(i){case"true":return pe.not(t);case"false":return pe.has(t);default:return pe.notEquals(t,i)}}case 5:return this._advance(),jm.create(t,this._value());case 6:return this._advance(),qm.create(t,this._value());case 7:return this._advance(),Gm.create(t,this._value());case 8:return this._advance(),$m.create(t,this._value());case 13:return this._advance(),pe.in(t,this._value());default:return pe.has(t)}}case 20:throw this._parsingErrors.push({message:$V,offset:e.offset,lexeme:"",additionalInfo:jV}),o._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){let i=h("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,Bl.getLexeme(t)),r=t.offset,s=Bl.getLexeme(t);return this._parsingErrors.push({message:i,offset:r,lexeme:s,additionalInfo:n}),o._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},pe=class{static false(){return Di.INSTANCE}static true(){return zi.INSTANCE}static has(e){return tc.create(e)}static equals(e,t){return zm.create(e,t)}static notEquals(e,t){return Km.create(e,t)}static regex(e,t){return Ym.create(e,t)}static in(e,t){return kv.create(e,t)}static notIn(e,t){return Dv.create(e,t)}static not(e){return nc.create(e)}static and(...e){return Rv.create(e,null,!0)}static or(...e){return Qm.create(e,null,!0)}static greater(e,t){return Gm.create(e,t)}static greaterEquals(e,t){return $m.create(e,t)}static smaller(e,t){return jm.create(e,t)}static smallerEquals(e,t){return qm.create(e,t)}static _parser=new mE({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function Um(o,e){return o.cmp(e)}var Di=class o{static INSTANCE=new o;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return zi.INSTANCE}},zi=class o{static INSTANCE=new o;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Di.INSTANCE}},tc=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=oi.get(e);return typeof n=="boolean"?n?zi.INSTANCE:Di.INSTANCE:new o(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:rP(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=oi.get(this.key);return typeof e=="boolean"?e?zi.INSTANCE:Di.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=nc.create(this.key,this)),this.negated}},zm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?tc.create(e,n):nc.create(e,n);let i=oi.get(e);return typeof i=="boolean"?t===(i?"true":"false")?zi.INSTANCE:Di.INSTANCE:new o(e,t,n)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=oi.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?zi.INSTANCE:Di.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Km.create(this.key,this.value,this)),this.negated}},kv=class o{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new o(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n=="string"&&typeof t=="object"&&t!==null?WV.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=Dv.create(this.key,this.valueKey)),this.negated}},Dv=class o{constructor(e,t){this.key=e;this.valueKey=t;this._negated=kv.create(e,t)}static create(e,t){return new o(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},Km=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?nc.create(e,n):tc.create(e,n);let i=oi.get(e);return typeof i=="boolean"?t===(i?"true":"false")?Di.INSTANCE:zi.INSTANCE:new o(e,t,n)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=oi.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?Di.INSTANCE:zi.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=zm.create(this.key,this.value,this)),this.negated}},nc=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=oi.get(e);return typeof n=="boolean"?n?Di.INSTANCE:zi.INSTANCE:new o(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:rP(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=oi.get(this.key);return typeof e=="boolean"?e?Di.INSTANCE:zi.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=tc.create(this.key,this)),this.negated}};function Mv(o,e){if(typeof o=="string"){let t=parseFloat(o);isNaN(t)||(o=t)}return typeof o=="string"||typeof o=="number"?e(o):Di.INSTANCE}var Gm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return Mv(t,i=>new o(e,i,n))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=qm.create(this.key,this.value,this)),this.negated}},$m=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return Mv(t,i=>new o(e,i,n))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=jm.create(this.key,this.value,this)),this.negated}},jm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return Mv(t,i=>new o(e,i,n))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=$m.create(this.key,this.value,this)),this.negated}},qm=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return Mv(t,i=>new o(e,i,n))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Gm.create(this.key,this.value,this)),this.negated}},Ym=class o{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new o(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=gE.create(this)),this.negated}},gE=class o{constructor(e){this._actual=e}static create(e){return new o(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new o(this._actual.map(e))}negate(){return this._actual}};function oP(o){let e=null;for(let t=0,n=o.length;t<n;t++){let i=o[t].substituteConstants();if(o[t]!==i&&e===null){e=[];for(let r=0;r<t;r++)e[r]=o[r]}e!==null&&(e[t]=i)}return e===null?o:e}var Rv=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=Um(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=oP(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,n){let i=[],r=!1;for(let s of e)if(s){if(s.type===1){r=!0;continue}if(s.type===0)return Di.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&r)return zi.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(Um);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){let s=i[i.length-1];if(s.type!==9)break;i.pop();let a=i.pop(),l=i.length===0,d=Qm.create(s.expr.map(c=>o.create([c,a],null,n)),null,l);d&&(i.push(d),i.sort(Um))}if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return Di.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=Qm.create(e,this,!0)}return this.negated}},Qm=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=Um(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=oP(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,n){let i=[],r=!1;if(e){for(let s=0,a=e.length;s<a;s++){let l=e[s];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return zi.INSTANCE;if(l.type===9){i=i.concat(l.expr);continue}i.push(l)}}if(i.length===0&&r)return Di.INSTANCE;i.sort(Um)}if(i.length!==0){if(i.length===1)return i[0];for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return zi.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),n=e.shift(),i=[];for(let r of iP(t))for(let s of iP(n))i.push(Rv.create([r,s],null,!1));e.unshift(o.create(i,null,!1))}this.negated=o.create(e,this,!0)}return this.negated}},ce=class o extends tc{static _info=[];static all(){return o._info.values()}_defaultValue;constructor(e,t,n){super(e,null),this._defaultValue=t,typeof n=="object"?o._info.push({...n,key:e}):n!==!0&&o._info.push({key:e,description:n,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return zm.create(this.key,e)}notEqualsTo(e){return Km.create(this.key,e)}},rt=Y("contextKeyService");function rP(o,e){return o<e?-1:o>e?1:0}function ic(o,e,t,n){return o<t?-1:o>t?1:e<n?-1:e>n?1:0}function iP(o){return o.type===9?o.expr:[o]}var sP=Y("lifecycleService");function Nv(o){return!!o&&typeof o.then=="function"}function oc(o){let e=new $n,t=o(e.token),n=new Promise((i,r)=>{let s=e.token.onCancellationRequested(()=>{s.dispose(),r(new ni)});Promise.resolve(t).then(a=>{s.dispose(),e.dispose(),i(a)},a=>{s.dispose(),e.dispose(),r(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,r){return n.then(i,r)}catch(i){return this.then(void 0,i)}finally(i){return n.finally(i)}}}function eg(o,e,t){return new Promise((n,i)=>{let r=e.onCancellationRequested(()=>{r.dispose(),n(t)});o.then(n,i).finally(()=>r.dispose())})}function lP(){let o,e;return{promise:new Promise((n,i)=>{o=n,e=i}),resolve:o,reject:e}}var fE=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(t,t).then(n)})}return new Promise((t,n)=>{this.queuedPromise.then(t,n)})}return this.activePromise=e(),new Promise((t,n)=>{this.activePromise.then(i=>{this.activePromise=null,t(i)},i=>{this.activePromise=null,n(i)})})}dispose(){this.isDisposed=!0}};var qV=(o,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},o);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},YV=o=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,o())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},Oa=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,r)=>{this.doResolve=i,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===xw?YV(n):qV(t,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new ni),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},Zm=class{delayer;throttler;constructor(e){this.delayer=new Oa(e),this.throttler=new fE}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}};function ao(o,e){return e?new Promise((t,n)=>{let i=setTimeout(()=>{r.dispose(),t()},o),r=e.onCancellationRequested(()=>{clearTimeout(i),r.dispose(),n(new ni)})}):oc(t=>ao(o,t))}function rc(o,e=0,t){let n=setTimeout(()=>{o(),t&&i.dispose()},e),i=ge(()=>{clearTimeout(n),t?.deleteAndLeak(i)});return t?.add(i),i}var so=class{_token;_isDisposed=!1;constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new Ke("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new Ke("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},Pv=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new Ke("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let i=n.setInterval(()=>{e()},t);this.disposable=ge(()=>{n.clearInterval(i),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},zt=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var Wl,Vu;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Vu=(o,e)=>{Yb(()=>{if(t)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Vu=(o,e,t)=>{let n=o.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),i=!1;return{dispose(){i||(i=!0,o.cancelIdleCallback(n))}}},Wl=o=>Vu(globalThis,o)})();var Xm=class{_executor;_handle;_didRun=!1;_value;_error;constructor(e,t){this._executor=()=>{try{this._value=t()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=Vu(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},Jm=class extends Xm{constructor(e){super(globalThis,e)}};var Av=class{_running;_queued;isRunning(e){return typeof e=="number"?this._running?.taskId===e:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(e,t,n){return this._running={taskId:e,cancel:()=>n?.(),promise:t},t.then(()=>this.doneRunning(e),()=>this.doneRunning(e)),t}doneRunning(e){this._running&&e===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let e=this._queued;this._queued=void 0,e.run().then(e.promiseResolve,e.promiseReject)}}queue(e){if(this._queued)this._queued.run=e;else{let{promise:t,resolve:n,reject:i}=lP();this._queued={run:e,promise:t,promiseResolve:n,promiseReject:i}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var Os=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new ni)}},br;(t=>{async function o(n){let i,r=await Promise.all(n.map(s=>s.then(a=>a,a=>{i||(i=a)})));if(typeof i<"u")throw i;return r}t.settled=o;function e(n){return new Promise(async(i,r)=>{try{await n(i,r)}catch(s){r(s)}})}t.withAsyncBody=e})(br||={});var aP=class o{static fromArray(e){return new o(t=>{t.emitMany(e)})}static fromPromise(e){return new o(async t=>{t.emitMany(await e)})}static fromPromises(e){return new o(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new o(async t=>{await Promise.all(e.map(async n=>{for await(let i of n)t.emitOne(i)}))})}static EMPTY=o.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new L,queueMicrotask(async()=>{let n={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(n)),this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await de.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new o(async n=>{for await(let i of e)n.emitOne(t(i))})}map(e){return o.map(this,e)}static filter(e,t){return new o(async n=>{for await(let i of e)t(i)&&n.emitOne(i)})}filter(e){return o.filter(this,e)}static coalesce(e){return o.filter(e,t=>!!t)}coalesce(){return o.coalesce(this)}static async toPromise(e){let t=[];for await(let n of e)t.push(n);return t}toPromise(){return o.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var tg={exports:{}};(function(){function e(r){let s=[];typeof r=="number"&&s.push("code/timeOrigin",r);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(r){performance.mark(r)},getMarks(){let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(r+a.startTime)});return s}};if(typeof process=="object"){let r=performance?.timeOrigin;return e(r)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function n(r){return r.MonacoPerformanceMarks||(r.MonacoPerformanceMarks=t()),r.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof tg=="object"&&typeof tg.exports=="object"?tg.exports=n(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=n(i))})();var Hr=tg.exports.mark,nj=tg.exports.getMarks;var er=class extends W{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(e,t="",n="",i=!0,r){super(),this._id=e,this._label=t,this._cssClass=n,this._enabled=i,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}},Ur=class extends W{_onWillRun=this._register(new L);onWillRun=this._onWillRun.event;_onDidRun=this._register(new L);onDidRun=this._onDidRun.event;async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let n;try{await this.runAction(e,t)}catch(i){n=i}this._onDidRun.fire({action:e,error:n})}async runAction(e,t){await e.run(t)}},On=class o{static join(...e){let t=[];for(let n of e)n.length&&(t.length?t=[...t,new o,...n]:t=n);return t}static ID="vs.actions.separator";id=o.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}},Fa=class{id;label;class;tooltip="";enabled=!0;checked=void 0;_actions;get actions(){return this._actions}constructor(e,t,n,i){this.id=e,this.label=t,this.class=i,this._actions=n}async run(){}};function Ri(o){return{id:o.id,label:o.label,tooltip:o.tooltip??o.label,class:o.class,enabled:o.enabled??!0,checked:o.checked,run:async(...e)=>o.run(...e)}}function bE(o,e){return e&&(o.stack||o.stacktrace)?h("stackTrace.format","{0}: {1}",cP(o),dP(o.stack)||dP(o.stacktrace)):cP(o)}function dP(o){return Array.isArray(o)?o.join(`
`):o}function cP(o){return o.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${o.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof o.code=="string"&&typeof o.errno=="number"&&typeof o.syscall=="string"?h("nodeExceptionMessage","A system error occurred ({0})",o.message):o.message||h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function Ov(o=null,e=!1){if(!o)return h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(o)){let t=Ta(o),n=Ov(t[0],e);return t.length>1?h("error.moreErrors","{0} ({1} errors in total)",n,t.length):n}if(rn(o))return o;if(o.detail){let t=o.detail;if(t.error)return bE(t.error,e);if(t.exception)return bE(t.exception,e)}return o.stack?bE(o,e):o.message?o.message:h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function vE(o){let e=o;return e instanceof Error&&Array.isArray(e.actions)}function tr(o){return ig(o,0)}function ig(o,e){switch(typeof o){case"object":return o===null?Ba(349,e):Array.isArray(o)?XV(o,e):JV(o,e);case"string":return Fv(o,e);case"boolean":return ZV(o,e);case"number":return Ba(o,e);case"undefined":return Ba(937,e);default:return Ba(617,e)}}function Ba(o,e){return(e<<5)-e+o|0}function ZV(o,e){return Ba(o?433:863,e)}function Fv(o,e){e=Ba(149417,e);for(let t=0,n=o.length;t<n;t++)e=Ba(o.charCodeAt(t),e);return e}function XV(o,e){return e=Ba(104579,e),o.reduce((t,n)=>ig(n,t),e)}function JV(o,e){return e=Ba(181387,e),Object.keys(o).sort().reduce((t,n)=>(t=Fv(n,t),ig(o[n],t)),e)}function yE(o,e,t=32){let n=t-e,i=~((1<<n)-1);return(o<<e|(i&o)>>>n)>>>0}function uP(o,e=0,t=o.byteLength,n=0){for(let i=0;i<t;i++)o[e+i]=n}function eH(o,e,t="0"){for(;o.length<e;)o=t+o;return o}function ng(o,e=32){return o instanceof ArrayBuffer?Array.from(new Uint8Array(o)).map(t=>t.toString(16).padStart(2,"0")).join(""):eH((o>>>0).toString(16),e/4)}var pP=class o{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let n=this._buff,i=this._buffLen,r=this._leftoverHighSurrogate,s,a;for(r!==0?(s=r,a=-1,r=0):(s=e.charCodeAt(0),a=0);;){let l=s;if(Ot(s))if(a+1<t){let d=e.charCodeAt(a+1);As(d)?(a++,l=hv(s,d)):l=65533}else{r=s;break}else As(s)&&(l=65533);if(i=this._push(n,i,l),a++,a<t)s=e.charCodeAt(a);else break}this._buffLen=i,this._leftoverHighSurrogate=r}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(n&1984)>>>6,e[t++]=128|(n&63)>>>0):n<65536?(e[t++]=224|(n&61440)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0):(e[t++]=240|(n&1835008)>>>18,e[t++]=128|(n&258048)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),ng(this._h0)+ng(this._h1)+ng(this._h2)+ng(this._h3)+ng(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,uP(this._buff,this._buffLen),this._buffLen>56&&(this._step(),uP(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=o._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,yE(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let n=this._h0,i=this._h1,r=this._h2,s=this._h3,a=this._h4,l,d,c;for(let u=0;u<80;u++)u<20?(l=i&r|~i&s,d=1518500249):u<40?(l=i^r^s,d=1859775393):u<60?(l=i&r|i&s|r&s,d=2400959708):(l=i^r^s,d=3395469782),c=yE(n,5)+l+a+d+e.getUint32(u*4,!1)&4294967295,a=s,s=r,r=yE(i,30),i=n,n=c;this._h0=this._h0+n&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};var IE=Object.create(null);function y(o,e){if(rn(e)){let t=IE[e];if(t===void 0)throw new Error(`${o} references an unknown codicon: ${e}`);e=t}return IE[o]=e,{id:o}}function CE(){return IE}var hP={add:y("add",6e4),plus:y("plus",6e4),gistNew:y("gist-new",6e4),repoCreate:y("repo-create",6e4),lightbulb:y("lightbulb",60001),lightBulb:y("light-bulb",60001),repo:y("repo",60002),repoDelete:y("repo-delete",60002),gistFork:y("gist-fork",60003),repoForked:y("repo-forked",60003),gitPullRequest:y("git-pull-request",60004),gitPullRequestAbandoned:y("git-pull-request-abandoned",60004),recordKeys:y("record-keys",60005),keyboard:y("keyboard",60005),tag:y("tag",60006),gitPullRequestLabel:y("git-pull-request-label",60006),tagAdd:y("tag-add",60006),tagRemove:y("tag-remove",60006),person:y("person",60007),personFollow:y("person-follow",60007),personOutline:y("person-outline",60007),personFilled:y("person-filled",60007),gitBranch:y("git-branch",60008),gitBranchCreate:y("git-branch-create",60008),gitBranchDelete:y("git-branch-delete",60008),sourceControl:y("source-control",60008),mirror:y("mirror",60009),mirrorPublic:y("mirror-public",60009),star:y("star",60010),starAdd:y("star-add",60010),starDelete:y("star-delete",60010),starEmpty:y("star-empty",60010),comment:y("comment",60011),commentAdd:y("comment-add",60011),alert:y("alert",60012),warning:y("warning",60012),search:y("search",60013),searchSave:y("search-save",60013),logOut:y("log-out",60014),signOut:y("sign-out",60014),logIn:y("log-in",60015),signIn:y("sign-in",60015),eye:y("eye",60016),eyeUnwatch:y("eye-unwatch",60016),eyeWatch:y("eye-watch",60016),circleFilled:y("circle-filled",60017),primitiveDot:y("primitive-dot",60017),closeDirty:y("close-dirty",60017),debugBreakpoint:y("debug-breakpoint",60017),debugBreakpointDisabled:y("debug-breakpoint-disabled",60017),debugHint:y("debug-hint",60017),terminalDecorationSuccess:y("terminal-decoration-success",60017),primitiveSquare:y("primitive-square",60018),edit:y("edit",60019),pencil:y("pencil",60019),info:y("info",60020),issueOpened:y("issue-opened",60020),gistPrivate:y("gist-private",60021),gitForkPrivate:y("git-fork-private",60021),lock:y("lock",60021),mirrorPrivate:y("mirror-private",60021),close:y("close",60022),removeClose:y("remove-close",60022),x:y("x",60022),repoSync:y("repo-sync",60023),sync:y("sync",60023),clone:y("clone",60024),desktopDownload:y("desktop-download",60024),beaker:y("beaker",60025),microscope:y("microscope",60025),vm:y("vm",60026),deviceDesktop:y("device-desktop",60026),file:y("file",60027),fileText:y("file-text",60027),more:y("more",60028),ellipsis:y("ellipsis",60028),kebabHorizontal:y("kebab-horizontal",60028),mailReply:y("mail-reply",60029),reply:y("reply",60029),organization:y("organization",60030),organizationFilled:y("organization-filled",60030),organizationOutline:y("organization-outline",60030),newFile:y("new-file",60031),fileAdd:y("file-add",60031),newFolder:y("new-folder",60032),fileDirectoryCreate:y("file-directory-create",60032),trash:y("trash",60033),trashcan:y("trashcan",60033),history:y("history",60034),clock:y("clock",60034),folder:y("folder",60035),fileDirectory:y("file-directory",60035),symbolFolder:y("symbol-folder",60035),logoGithub:y("logo-github",60036),markGithub:y("mark-github",60036),github:y("github",60036),terminal:y("terminal",60037),console:y("console",60037),repl:y("repl",60037),zap:y("zap",60038),symbolEvent:y("symbol-event",60038),error:y("error",60039),stop:y("stop",60039),variable:y("variable",60040),symbolVariable:y("symbol-variable",60040),array:y("array",60042),symbolArray:y("symbol-array",60042),symbolModule:y("symbol-module",60043),symbolPackage:y("symbol-package",60043),symbolNamespace:y("symbol-namespace",60043),symbolObject:y("symbol-object",60043),symbolMethod:y("symbol-method",60044),symbolFunction:y("symbol-function",60044),symbolConstructor:y("symbol-constructor",60044),symbolBoolean:y("symbol-boolean",60047),symbolNull:y("symbol-null",60047),symbolNumeric:y("symbol-numeric",60048),symbolNumber:y("symbol-number",60048),symbolStructure:y("symbol-structure",60049),symbolStruct:y("symbol-struct",60049),symbolParameter:y("symbol-parameter",60050),symbolTypeParameter:y("symbol-type-parameter",60050),symbolKey:y("symbol-key",60051),symbolText:y("symbol-text",60051),symbolReference:y("symbol-reference",60052),goToFile:y("go-to-file",60052),symbolEnum:y("symbol-enum",60053),symbolValue:y("symbol-value",60053),symbolRuler:y("symbol-ruler",60054),symbolUnit:y("symbol-unit",60054),activateBreakpoints:y("activate-breakpoints",60055),archive:y("archive",60056),arrowBoth:y("arrow-both",60057),arrowDown:y("arrow-down",60058),arrowLeft:y("arrow-left",60059),arrowRight:y("arrow-right",60060),arrowSmallDown:y("arrow-small-down",60061),arrowSmallLeft:y("arrow-small-left",60062),arrowSmallRight:y("arrow-small-right",60063),arrowSmallUp:y("arrow-small-up",60064),arrowUp:y("arrow-up",60065),bell:y("bell",60066),bold:y("bold",60067),book:y("book",60068),bookmark:y("bookmark",60069),debugBreakpointConditionalUnverified:y("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:y("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:y("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:y("debug-breakpoint-data-unverified",60072),debugBreakpointData:y("debug-breakpoint-data",60073),debugBreakpointDataDisabled:y("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:y("debug-breakpoint-log-unverified",60074),debugBreakpointLog:y("debug-breakpoint-log",60075),debugBreakpointLogDisabled:y("debug-breakpoint-log-disabled",60075),briefcase:y("briefcase",60076),broadcast:y("broadcast",60077),browser:y("browser",60078),bug:y("bug",60079),calendar:y("calendar",60080),caseSensitive:y("case-sensitive",60081),check:y("check",60082),checklist:y("checklist",60083),chevronDown:y("chevron-down",60084),chevronLeft:y("chevron-left",60085),chevronRight:y("chevron-right",60086),chevronUp:y("chevron-up",60087),chromeClose:y("chrome-close",60088),chromeMaximize:y("chrome-maximize",60089),chromeMinimize:y("chrome-minimize",60090),chromeRestore:y("chrome-restore",60091),circleOutline:y("circle-outline",60092),circle:y("circle",60092),debugBreakpointUnverified:y("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:y("terminal-decoration-incomplete",60092),circleSlash:y("circle-slash",60093),circuitBoard:y("circuit-board",60094),clearAll:y("clear-all",60095),clippy:y("clippy",60096),closeAll:y("close-all",60097),cloudDownload:y("cloud-download",60098),cloudUpload:y("cloud-upload",60099),code:y("code",60100),collapseAll:y("collapse-all",60101),colorMode:y("color-mode",60102),commentDiscussion:y("comment-discussion",60103),creditCard:y("credit-card",60105),dash:y("dash",60108),dashboard:y("dashboard",60109),database:y("database",60110),debugContinue:y("debug-continue",60111),debugDisconnect:y("debug-disconnect",60112),debugPause:y("debug-pause",60113),debugRestart:y("debug-restart",60114),debugStart:y("debug-start",60115),debugStepInto:y("debug-step-into",60116),debugStepOut:y("debug-step-out",60117),debugStepOver:y("debug-step-over",60118),debugStop:y("debug-stop",60119),debug:y("debug",60120),deviceCameraVideo:y("device-camera-video",60121),deviceCamera:y("device-camera",60122),deviceMobile:y("device-mobile",60123),diffAdded:y("diff-added",60124),diffIgnored:y("diff-ignored",60125),diffModified:y("diff-modified",60126),diffRemoved:y("diff-removed",60127),diffRenamed:y("diff-renamed",60128),diff:y("diff",60129),diffSidebyside:y("diff-sidebyside",60129),discard:y("discard",60130),editorLayout:y("editor-layout",60131),emptyWindow:y("empty-window",60132),exclude:y("exclude",60133),extensions:y("extensions",60134),eyeClosed:y("eye-closed",60135),fileBinary:y("file-binary",60136),fileCode:y("file-code",60137),fileMedia:y("file-media",60138),filePdf:y("file-pdf",60139),fileSubmodule:y("file-submodule",60140),fileSymlinkDirectory:y("file-symlink-directory",60141),fileSymlinkFile:y("file-symlink-file",60142),fileZip:y("file-zip",60143),files:y("files",60144),filter:y("filter",60145),flame:y("flame",60146),foldDown:y("fold-down",60147),foldUp:y("fold-up",60148),fold:y("fold",60149),folderActive:y("folder-active",60150),folderOpened:y("folder-opened",60151),gear:y("gear",60152),gift:y("gift",60153),gistSecret:y("gist-secret",60154),gist:y("gist",60155),gitCommit:y("git-commit",60156),gitCompare:y("git-compare",60157),compareChanges:y("compare-changes",60157),gitMerge:y("git-merge",60158),githubAction:y("github-action",60159),githubAlt:y("github-alt",60160),globe:y("globe",60161),grabber:y("grabber",60162),graph:y("graph",60163),gripper:y("gripper",60164),heart:y("heart",60165),home:y("home",60166),horizontalRule:y("horizontal-rule",60167),hubot:y("hubot",60168),inbox:y("inbox",60169),issueReopened:y("issue-reopened",60171),issues:y("issues",60172),italic:y("italic",60173),jersey:y("jersey",60174),json:y("json",60175),kebabVertical:y("kebab-vertical",60176),key:y("key",60177),law:y("law",60178),lightbulbAutofix:y("lightbulb-autofix",60179),linkExternal:y("link-external",60180),link:y("link",60181),listOrdered:y("list-ordered",60182),listUnordered:y("list-unordered",60183),liveShare:y("live-share",60184),loading:y("loading",60185),location:y("location",60186),mailRead:y("mail-read",60187),mail:y("mail",60188),markdown:y("markdown",60189),megaphone:y("megaphone",60190),mention:y("mention",60191),milestone:y("milestone",60192),gitPullRequestMilestone:y("git-pull-request-milestone",60192),mortarBoard:y("mortar-board",60193),move:y("move",60194),multipleWindows:y("multiple-windows",60195),mute:y("mute",60196),noNewline:y("no-newline",60197),note:y("note",60198),octoface:y("octoface",60199),openPreview:y("open-preview",60200),package:y("package",60201),paintcan:y("paintcan",60202),pin:y("pin",60203),play:y("play",60204),run:y("run",60204),plug:y("plug",60205),preserveCase:y("preserve-case",60206),preview:y("preview",60207),project:y("project",60208),pulse:y("pulse",60209),question:y("question",60210),quote:y("quote",60211),radioTower:y("radio-tower",60212),reactions:y("reactions",60213),references:y("references",60214),refresh:y("refresh",60215),regex:y("regex",60216),remoteExplorer:y("remote-explorer",60217),remote:y("remote",60218),remove:y("remove",60219),replaceAll:y("replace-all",60220),replace:y("replace",60221),repoClone:y("repo-clone",60222),repoForcePush:y("repo-force-push",60223),repoPull:y("repo-pull",60224),repoPush:y("repo-push",60225),report:y("report",60226),requestChanges:y("request-changes",60227),rocket:y("rocket",60228),rootFolderOpened:y("root-folder-opened",60229),rootFolder:y("root-folder",60230),rss:y("rss",60231),ruby:y("ruby",60232),saveAll:y("save-all",60233),saveAs:y("save-as",60234),save:y("save",60235),screenFull:y("screen-full",60236),screenNormal:y("screen-normal",60237),searchStop:y("search-stop",60238),server:y("server",60240),settingsGear:y("settings-gear",60241),settings:y("settings",60242),shield:y("shield",60243),smiley:y("smiley",60244),sortPrecedence:y("sort-precedence",60245),splitHorizontal:y("split-horizontal",60246),splitVertical:y("split-vertical",60247),squirrel:y("squirrel",60248),starFull:y("star-full",60249),starHalf:y("star-half",60250),symbolClass:y("symbol-class",60251),symbolColor:y("symbol-color",60252),symbolConstant:y("symbol-constant",60253),symbolEnumMember:y("symbol-enum-member",60254),symbolField:y("symbol-field",60255),symbolFile:y("symbol-file",60256),symbolInterface:y("symbol-interface",60257),symbolKeyword:y("symbol-keyword",60258),symbolMisc:y("symbol-misc",60259),symbolOperator:y("symbol-operator",60260),symbolProperty:y("symbol-property",60261),wrench:y("wrench",60261),wrenchSubaction:y("wrench-subaction",60261),symbolSnippet:y("symbol-snippet",60262),tasklist:y("tasklist",60263),telescope:y("telescope",60264),textSize:y("text-size",60265),threeBars:y("three-bars",60266),thumbsdown:y("thumbsdown",60267),thumbsup:y("thumbsup",60268),tools:y("tools",60269),triangleDown:y("triangle-down",60270),triangleLeft:y("triangle-left",60271),triangleRight:y("triangle-right",60272),triangleUp:y("triangle-up",60273),twitter:y("twitter",60274),unfold:y("unfold",60275),unlock:y("unlock",60276),unmute:y("unmute",60277),unverified:y("unverified",60278),verified:y("verified",60279),versions:y("versions",60280),vmActive:y("vm-active",60281),vmOutline:y("vm-outline",60282),vmRunning:y("vm-running",60283),watch:y("watch",60284),whitespace:y("whitespace",60285),wholeWord:y("whole-word",60286),window:y("window",60287),wordWrap:y("word-wrap",60288),zoomIn:y("zoom-in",60289),zoomOut:y("zoom-out",60290),listFilter:y("list-filter",60291),listFlat:y("list-flat",60292),listSelection:y("list-selection",60293),selection:y("selection",60293),listTree:y("list-tree",60294),debugBreakpointFunctionUnverified:y("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:y("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:y("debug-breakpoint-function-disabled",60296),debugStackframeActive:y("debug-stackframe-active",60297),circleSmallFilled:y("circle-small-filled",60298),debugStackframeDot:y("debug-stackframe-dot",60298),terminalDecorationMark:y("terminal-decoration-mark",60298),debugStackframe:y("debug-stackframe",60299),debugStackframeFocused:y("debug-stackframe-focused",60299),debugBreakpointUnsupported:y("debug-breakpoint-unsupported",60300),symbolString:y("symbol-string",60301),debugReverseContinue:y("debug-reverse-continue",60302),debugStepBack:y("debug-step-back",60303),debugRestartFrame:y("debug-restart-frame",60304),debugAlt:y("debug-alt",60305),callIncoming:y("call-incoming",60306),callOutgoing:y("call-outgoing",60307),menu:y("menu",60308),expandAll:y("expand-all",60309),feedback:y("feedback",60310),gitPullRequestReviewer:y("git-pull-request-reviewer",60310),groupByRefType:y("group-by-ref-type",60311),ungroupByRefType:y("ungroup-by-ref-type",60312),account:y("account",60313),gitPullRequestAssignee:y("git-pull-request-assignee",60313),bellDot:y("bell-dot",60314),debugConsole:y("debug-console",60315),library:y("library",60316),output:y("output",60317),runAll:y("run-all",60318),syncIgnored:y("sync-ignored",60319),pinned:y("pinned",60320),githubInverted:y("github-inverted",60321),serverProcess:y("server-process",60322),serverEnvironment:y("server-environment",60323),pass:y("pass",60324),issueClosed:y("issue-closed",60324),stopCircle:y("stop-circle",60325),playCircle:y("play-circle",60326),record:y("record",60327),debugAltSmall:y("debug-alt-small",60328),vmConnect:y("vm-connect",60329),cloud:y("cloud",60330),merge:y("merge",60331),export:y("export",60332),graphLeft:y("graph-left",60333),magnet:y("magnet",60334),notebook:y("notebook",60335),redo:y("redo",60336),checkAll:y("check-all",60337),pinnedDirty:y("pinned-dirty",60338),passFilled:y("pass-filled",60339),circleLargeFilled:y("circle-large-filled",60340),circleLarge:y("circle-large",60341),circleLargeOutline:y("circle-large-outline",60341),combine:y("combine",60342),gather:y("gather",60342),table:y("table",60343),variableGroup:y("variable-group",60344),typeHierarchy:y("type-hierarchy",60345),typeHierarchySub:y("type-hierarchy-sub",60346),typeHierarchySuper:y("type-hierarchy-super",60347),gitPullRequestCreate:y("git-pull-request-create",60348),runAbove:y("run-above",60349),runBelow:y("run-below",60350),notebookTemplate:y("notebook-template",60351),debugRerun:y("debug-rerun",60352),workspaceTrusted:y("workspace-trusted",60353),workspaceUntrusted:y("workspace-untrusted",60354),workspaceUnknown:y("workspace-unknown",60355),terminalCmd:y("terminal-cmd",60356),terminalDebian:y("terminal-debian",60357),terminalLinux:y("terminal-linux",60358),terminalPowershell:y("terminal-powershell",60359),terminalTmux:y("terminal-tmux",60360),terminalUbuntu:y("terminal-ubuntu",60361),terminalBash:y("terminal-bash",60362),arrowSwap:y("arrow-swap",60363),copy:y("copy",60364),personAdd:y("person-add",60365),filterFilled:y("filter-filled",60366),wand:y("wand",60367),debugLineByLine:y("debug-line-by-line",60368),inspect:y("inspect",60369),layers:y("layers",60370),layersDot:y("layers-dot",60371),layersActive:y("layers-active",60372),compass:y("compass",60373),compassDot:y("compass-dot",60374),compassActive:y("compass-active",60375),azure:y("azure",60376),issueDraft:y("issue-draft",60377),gitPullRequestClosed:y("git-pull-request-closed",60378),gitPullRequestDraft:y("git-pull-request-draft",60379),debugAll:y("debug-all",60380),debugCoverage:y("debug-coverage",60381),runErrors:y("run-errors",60382),folderLibrary:y("folder-library",60383),debugContinueSmall:y("debug-continue-small",60384),beakerStop:y("beaker-stop",60385),graphLine:y("graph-line",60386),graphScatter:y("graph-scatter",60387),pieChart:y("pie-chart",60388),bracket:y("bracket",60175),bracketDot:y("bracket-dot",60389),bracketError:y("bracket-error",60390),lockSmall:y("lock-small",60391),azureDevops:y("azure-devops",60392),verifiedFilled:y("verified-filled",60393),newline:y("newline",60394),layout:y("layout",60395),layoutActivitybarLeft:y("layout-activitybar-left",60396),layoutActivitybarRight:y("layout-activitybar-right",60397),layoutPanelLeft:y("layout-panel-left",60398),layoutPanelCenter:y("layout-panel-center",60399),layoutPanelJustify:y("layout-panel-justify",60400),layoutPanelRight:y("layout-panel-right",60401),layoutPanel:y("layout-panel",60402),layoutSidebarLeft:y("layout-sidebar-left",60403),layoutSidebarRight:y("layout-sidebar-right",60404),layoutStatusbar:y("layout-statusbar",60405),layoutMenubar:y("layout-menubar",60406),layoutCentered:y("layout-centered",60407),target:y("target",60408),indent:y("indent",60409),recordSmall:y("record-small",60410),errorSmall:y("error-small",60411),terminalDecorationError:y("terminal-decoration-error",60411),arrowCircleDown:y("arrow-circle-down",60412),arrowCircleLeft:y("arrow-circle-left",60413),arrowCircleRight:y("arrow-circle-right",60414),arrowCircleUp:y("arrow-circle-up",60415),layoutSidebarRightOff:y("layout-sidebar-right-off",60416),layoutPanelOff:y("layout-panel-off",60417),layoutSidebarLeftOff:y("layout-sidebar-left-off",60418),blank:y("blank",60419),heartFilled:y("heart-filled",60420),map:y("map",60421),mapHorizontal:y("map-horizontal",60421),foldHorizontal:y("fold-horizontal",60421),mapFilled:y("map-filled",60422),mapHorizontalFilled:y("map-horizontal-filled",60422),foldHorizontalFilled:y("fold-horizontal-filled",60422),circleSmall:y("circle-small",60423),bellSlash:y("bell-slash",60424),bellSlashDot:y("bell-slash-dot",60425),commentUnresolved:y("comment-unresolved",60426),gitPullRequestGoToChanges:y("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:y("git-pull-request-new-changes",60428),searchFuzzy:y("search-fuzzy",60429),commentDraft:y("comment-draft",60430),send:y("send",60431),sparkle:y("sparkle",60432),insert:y("insert",60433),mic:y("mic",60434),thumbsdownFilled:y("thumbsdown-filled",60435),thumbsupFilled:y("thumbsup-filled",60436),coffee:y("coffee",60437),snake:y("snake",60438),game:y("game",60439),vr:y("vr",60440),chip:y("chip",60441),piano:y("piano",60442),music:y("music",60443),micFilled:y("mic-filled",60444),repoFetch:y("repo-fetch",60445),copilot:y("copilot",60446),lightbulbSparkle:y("lightbulb-sparkle",60447),robot:y("robot",60448),sparkleFilled:y("sparkle-filled",60449),diffSingle:y("diff-single",60450),diffMultiple:y("diff-multiple",60451),surroundWith:y("surround-with",60452),share:y("share",60453),gitStash:y("git-stash",60454),gitStashApply:y("git-stash-apply",60455),gitStashPop:y("git-stash-pop",60456),vscode:y("vscode",60457),vscodeInsiders:y("vscode-insiders",60458),codeOss:y("code-oss",60459),runCoverage:y("run-coverage",60460),runAllCoverage:y("run-all-coverage",60461),coverage:y("coverage",60462),githubProject:y("github-project",60463),mapVertical:y("map-vertical",60464),foldVertical:y("fold-vertical",60464),mapVerticalFilled:y("map-vertical-filled",60465),foldVerticalFilled:y("fold-vertical-filled",60465),goToSearch:y("go-to-search",60466),percentage:y("percentage",60467),sortPercentage:y("sort-percentage",60467),attach:y("attach",60468)};var tH={dialogError:y("dialog-error","error"),dialogWarning:y("dialog-warning","warning"),dialogInfo:y("dialog-info","info"),dialogClose:y("dialog-close","close"),treeItemExpanded:y("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:y("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:y("tree-filter-on-type-off","list-selection"),treeFilterClear:y("tree-filter-clear","close"),treeItemLoading:y("tree-item-loading","loading"),menuSelection:y("menu-selection","check"),menuSubmenu:y("menu-submenu","chevron-right"),menuBarMore:y("menubar-more","more"),scrollbarButtonLeft:y("scrollbar-button-left","triangle-left"),scrollbarButtonRight:y("scrollbar-button-right","triangle-right"),scrollbarButtonUp:y("scrollbar-button-up","triangle-up"),scrollbarButtonDown:y("scrollbar-button-down","triangle-down"),toolBarMore:y("toolbar-more","more"),quickInputBack:y("quick-input-back","arrow-left"),dropDownButton:y("drop-down-button",60084),symbolCustomColor:y("symbol-customcolor",60252),exportIcon:y("export",60332),workspaceUnspecified:y("workspace-unspecified",60355),newLine:y("newline",60394),thumbsDownFilled:y("thumbsdown-filled",60435),thumbsUpFilled:y("thumbsup-filled",60436),gitFetch:y("git-fetch",60445),lightbulbSparkleAutofix:y("lightbulb-sparkle-autofix",60447),debugBreakpointPending:y("debug-breakpoint-pending",60377)},le={...hP,...tH};var mP;(e=>{function o(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=o})(mP||={});var Je;(f=>{f.iconNameSegment="[A-Za-z0-9]+",f.iconNameExpression="[A-Za-z0-9-]+",f.iconModifierExpression="~[A-Za-z]+",f.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${f.iconNameExpression})(${f.iconModifierExpression})?$`);function r(b){let v=i.exec(b.id);if(!v)return r(le.error);let[,I,C]=v,S=["codicon","codicon-"+I];return C&&S.push("codicon-modifier-"+C.substring(1)),S}f.asClassNameArray=r;function s(b){return r(b).join(" ")}f.asClassName=s;function a(b){return"."+r(b).join(".")}f.asCSSSelector=a;function l(b){return b&&typeof b=="object"&&typeof b.id=="string"&&(typeof b.color>"u"||mP.isThemeColor(b.color))}f.isThemeIcon=l;let d=new RegExp(`^\\$\\((${f.iconNameExpression}(?:${f.iconModifierExpression})?)\\)$`);function c(b){let v=d.exec(b);if(!v)return;let[,I]=v;return{id:I}}f.fromString=c;function u(b){return{id:b}}f.fromId=u;function p(b,v){let I=b.id,C=I.lastIndexOf("~");return C!==-1&&(I=I.substring(0,C)),v&&(I=`${I}~${v}`),{id:I}}f.modify=p;function m(b){let v=b.id.lastIndexOf("~");if(v!==-1)return b.id.substring(v+1)}f.getModifier=m;function g(b,v){return b.id===v.id&&b.color?.id===v.color?.id}f.isEqual=g})(Je||={});var Ej=Object.freeze({View:Hd("view","View"),Help:Hd("help","Help"),Test:Hd("test","Test"),File:Hd("file","File"),Preferences:Hd("preferences","Preferences"),Developer:Hd({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});var In=Y("commandService"),nr=new class{_commands=new Map;_onDidRegisterCommand=new L;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(o,e){if(!o)throw new Error("invalid command");if(typeof o=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:o,handler:e})}if(o.metadata&&Array.isArray(o.metadata.args)){let s=[];for(let l of o.metadata.args)s.push(l.constraint);let a=o.handler;o.handler=function(l,...d){return NM(d,s),a(l,...d)}}let{id:t}=o,n=this._commands.get(t);n||(n=new Gn,this._commands.set(t,n));let i=n.unshift(o),r=ge(()=>{i(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(o,e){return nr.registerCommand(o,(t,...n)=>t.get(In).executeCommand(e,...n))}getCommand(o){let e=this._commands.get(o);if(!(!e||e.isEmpty()))return gr.first(e)}getCommands(){let o=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&o.set(e,t)}return o}};nr.registerCommand("noop",()=>{});function gP(o){return o?o.condition!==void 0:!1}var En=Y("logService"),Iq=Y("loggerService");function nH(o){switch(o){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var Cq=new ce("logLevel",nH(3));var xq=new Uint32Array(10);var _q=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),wq=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),Eq=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),Tq=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function bP(...o){return function(e,t){for(let n=0,i=o.length;n<i;n++){let r=o[n](e,t);if(r)return r}return null}}var Aq=vP.bind(void 0,!1),Hu=vP.bind(void 0,!0);function vP(o,e,t){if(!t||t.length<e.length)return null;let n;return o?n=Al(t,e):n=t.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}function iH(o,e){let t=e.toLowerCase().indexOf(o.toLowerCase());return t===-1?null:[{start:t,end:t+o.length}]}function EE(o,e){return xE(o.toLowerCase(),e.toLowerCase(),0,0)}function xE(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]===e[n]){let i=null;return(i=xE(o,e,t+1,n+1))?IP({start:n,end:n+1},i):null}return xE(o,e,t,n+1)}function TE(o){return 97<=o&&o<=122}function rg(o){return 65<=o&&o<=90}function LE(o){return 48<=o&&o<=57}function oH(o){return o===32||o===9||o===10||o===13}var rH=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(o=>rH.add(o.charCodeAt(0)));function yP(o){return TE(o)||rg(o)||LE(o)}function IP(o,e){return e.length===0?e=[o]:o.end===e[0].start?e[0].start=o.start:e.unshift(o),e}function CP(o,e){for(let t=e;t<o.length;t++){let n=o.charCodeAt(t);if(rg(n)||LE(n)||t>0&&!yP(o.charCodeAt(t-1)))return t}return o.length}function _E(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]!==e[n].toLowerCase())return null;{let i=null,r=n+1;for(i=_E(o,e,t+1,n+1);!i&&(r=CP(e,r))<e.length;)i=_E(o,e,t+1,r),r++;return i===null?null:IP({start:n,end:n+1},i)}}function sH(o){let e=0,t=0,n=0,i=0,r=0;for(let c=0;c<o.length;c++)r=o.charCodeAt(c),rg(r)&&e++,TE(r)&&t++,yP(r)&&n++,LE(r)&&i++;let s=e/o.length,a=t/o.length,l=n/o.length,d=i/o.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function aH(o){let{upperPercent:e,lowerPercent:t}=o;return t===0&&e>.6}function lH(o){let{upperPercent:e,lowerPercent:t,alphaPercent:n,numericPercent:i}=o;return t>.2&&e<.8&&n>.6&&i<.2}function dH(o){let e=0,t=0,n=0,i=0;for(let r=0;r<o.length;r++)n=o.charCodeAt(r),rg(n)&&e++,TE(n)&&t++,oH(n)&&i++;return(e===0||t===0)&&i===0?o.length<=30:e<=5}function SP(o,e){if(!e||(e=e.trim(),e.length===0)||!dH(o))return null;e.length>60&&(e=e.substring(0,60));let t=sH(e);if(!lH(t)){if(!aH(t))return null;e=e.toLowerCase()}let n=null,i=0;for(o=o.toLowerCase();i<e.length&&(n=_E(o,e,0,i))===null;)i=CP(e,i+1);return n}var Nq=bP(Hu,SP,iH),Oq=bP(Hu,SP,EE),Fq=new Hi(1e4);function xP(o,e){let t=Ul(o,o.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?Vv(t):null}function _P(o,e,t,n,i,r){let s=Math.min(13,o.length);for(;t<s;t++){let a=Ul(o,e,t,n,i,r,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(a)return a}return[0,r]}function Vv(o){if(typeof o>"u")return[];let e=[],t=o[1];for(let n=o.length-1;n>1;n--){let i=o[n]+t,r=e[e.length-1];r&&r.end===i?r.end=i+1:e.push({start:i,end:i+1})}return e}var Hl=128;function kE(){let o=[],e=[];for(let t=0;t<=Hl;t++)e[t]=0;for(let t=0;t<=Hl;t++)o.push(e.slice(0));return o}function wP(o){let e=[];for(let t=0;t<=o;t++)e[t]=0;return e}var EP=wP(2*Hl),wE=wP(2*Hl),Fs=kE(),Vl=kE(),og=kE(),cH=!1;function SE(o,e,t,n,i){function r(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${n.split("").map(a=>r(a,3)).join("|")}
`;for(let a=0;a<=t;a++)a===0?s+=" |":s+=`${e[a-1]}|`,s+=o[a].slice(0,i+1).map(l=>r(l.toString(),3)).join("|")+`
`;return s}function uH(o,e,t,n){o=o.substr(e),t=t.substr(n),console.log(SE(Vl,o,o.length,t,t.length)),console.log(SE(og,o,o.length,t,t.length)),console.log(SE(Fs,o,o.length,t,t.length))}function Bv(o,e){if(e<0||e>=o.length)return!1;let t=o.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!Om(t)}}function fP(o,e){if(e<0||e>=o.length)return!1;switch(o.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function Wv(o,e,t){return e[o]!==t[o]}function pH(o,e,t,n,i,r,s=!1){for(;e<t&&i<r;)o[e]===n[i]&&(s&&(EP[e]=i),e+=1),i+=1;return e===t}var ac;(t=>{t.Default=[-100,0];function e(n){return!n||n.length===2&&n[0]===-100&&n[1]===0}t.isDefault=e})(ac||={});var sc=class{constructor(e,t){this.firstMatchCanBeWeak=e;this.boostFullMatch=t}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function Ul(o,e,t,n,i,r,s=sc.default){let a=o.length>Hl?Hl:o.length,l=n.length>Hl?Hl:n.length;if(t>=a||r>=l||a-t>l-r||!pH(e,t,a,i,r,l,!0))return;hH(a,l,t,r,e,i);let d=1,c=1,u=t,p=r,m=[!1];for(d=1,u=t;u<a;d++,u++){let I=EP[u],C=wE[u],S=u+1<a?wE[u+1]:l;for(c=I-r+1,p=I;p<S;c++,p++){let E=Number.MIN_SAFE_INTEGER,M=!1;p<=C&&(E=mH(o,e,u,t,n,i,p,l,r,Fs[d-1][c-1]===0,m));let A=0;E!==Number.MAX_SAFE_INTEGER&&(M=!0,A=E+Vl[d-1][c-1]);let F=p>I,O=F?Vl[d][c-1]+(Fs[d][c-1]>0?-5:0):0,H=p>I+1&&Fs[d][c-1]>0,U=H?Vl[d][c-2]+(Fs[d][c-2]>0?-5:0):0;if(H&&(!F||U>=O)&&(!M||U>=A))Vl[d][c]=U,og[d][c]=3,Fs[d][c]=0;else if(F&&(!M||O>=A))Vl[d][c]=O,og[d][c]=2,Fs[d][c]=0;else if(M)Vl[d][c]=A,og[d][c]=1,Fs[d][c]=Fs[d-1][c-1]+1;else throw new Error("not possible")}}if(cH&&uH(o,t,n,r),!m[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let g=[Vl[d][c],r],f=0,b=0;for(;d>=1;){let I=c;do{let C=og[d][I];if(C===3)I=I-2;else if(C===2)I=I-1;else break}while(I>=1);f>1&&e[t+d-1]===i[r+c-1]&&!Wv(I+r-1,n,i)&&f+1>Fs[d][I]&&(I=c),I===c?f++:f=1,b||(b=I),d--,c=I-1,g.push(c)}l-r===a&&s.boostFullMatch&&(g[0]+=2);let v=b-a;return g[0]-=v,g}function hH(o,e,t,n,i,r){let s=o-1,a=e-1;for(;s>=t&&a>=n;)i[s]===r[a]&&(wE[s]=a,s--),a--}function mH(o,e,t,n,i,r,s,a,l,d,c){if(e[t]!==r[s])return Number.MIN_SAFE_INTEGER;let u=1,p=!1;return s===t-n?u=o[t]===i[s]?7:5:Wv(s,i,r)&&(s===0||!Wv(s-1,i,r))?(u=o[t]===i[s]?7:5,p=!0):Bv(r,s)&&(s===0||!Bv(r,s-1))?u=5:(Bv(r,s-1)||fP(r,s-1))&&(u=5,p=!0),u>1&&t===n&&(c[0]=!0),p||(p=Wv(s,i,r)||Bv(r,s-1)||fP(r,s-1)),t===n?s>l&&(u-=p?3:5):d?u+=p?2:0:u+=p?0:1,s+1===a&&(u-=p?3:5),u}function TP(o,e,t,n,i,r,s){return gH(o,e,t,n,i,r,!0,s)}function gH(o,e,t,n,i,r,s,a){let l=Ul(o,e,t,n,i,r,a);if(l&&!s)return l;if(o.length>=3){let d=Math.min(7,o.length-1);for(let c=t+1;c<d;c++){let u=fH(o,c);if(u){let p=Ul(u,u.toLowerCase(),t,n,i,r,a);p&&(p[0]-=3,(!l||p[0]>l[0])&&(l=p))}}}return l}function fH(o,e){if(e+1>=o.length)return;let t=o[e],n=o[e+1];if(t!==n)return o.slice(0,e)+n+t+o.slice(e+2)}var bH="$(",DE=new RegExp(`\\$\\(${Je.iconNameExpression}(?:${Je.iconModifierExpression})?\\)`,"g"),vH=new RegExp(`(\\\\)?${DE.source}`,"g");function LP(o){return o.replace(vH,(e,t)=>t?e:`\\${e}`)}var yH=new RegExp(`\\\\${DE.source}`,"g");function kP(o){return o.replace(yH,e=>`\\${e}`)}var IH=new RegExp(`(\\s)?(\\\\)?${DE.source}(\\s)?`,"g");function RE(o){return o.indexOf(bH)===-1?o:o.replace(IH,(e,t,n,i)=>n?e:t||i||"")}var Kq=new RegExp(`\\$\\(${Je.iconNameCharacter}+\\)`,"g");var Hv=class{value;isTrusted;supportThemeIcons;supportHtml;baseUri;constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw Ad("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=CH(this.supportThemeIcons?LP(e):e).replace(/([ \t]+)/g,(n,i)=>"&nbsp;".repeat(i.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${SH(t,e)}
`,this}appendLink(e,t,n){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),n&&(this.value+=` "${this._escape(this._escape(n,'"'),")")}"`),this.value+=")",this}_escape(e,t){let n=new RegExp(Ui(t),"g");return e.replace(n,(i,r)=>e.charAt(r-1)!=="\\"?`\\${i}`:i)}};function CH(o){return o.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function SH(o,e){let t=o.match(/^`+/gm)?.reduce((i,r)=>i.length>r.length?i:r).length??0,n=t>=3?t+1:3;return[`${"`".repeat(n)}${e}`,o,`${"`".repeat(n)}`].join(`
`)}function sg(o){return o.replace(/"/g,"&quot;")}function Uv(o){return o&&o.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function DP(o){let e=[],t=o.split("|").map(i=>i.trim());o=t[0];let n=t[1];if(n){let i=/height=(\d+)/.exec(n),r=/width=(\d+)/.exec(n),s=i?i[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&e.push(`width="${a}"`),d&&e.push(`height="${s}"`)}return{href:o,dimensions:e}}function zv(o){if(!o||typeof o!="object"||o instanceof RegExp)return o;let e=Array.isArray(o)?[]:{};return Object.entries(o).forEach(([t,n])=>{e[t]=n&&typeof n=="object"?zv(n):n}),e}var xH=Object.prototype.hasOwnProperty;function RP(o,e){return ME(o,e,new Set)}function ME(o,e,t){if(Ii(o))return o;let n=e(o);if(typeof n<"u")return n;if(Array.isArray(o)){let i=[];for(let r of o)i.push(ME(r,e,t));return i}if(pn(o)){if(t.has(o))throw new Error("Cannot clone recursive data-structure");t.add(o);let i={};for(let r in o)xH.call(o,r)&&(i[r]=ME(o[r],e,t));return t.delete(o),i}return o}function PE(o,e,t=!0){return pn(o)?(pn(e)&&Object.keys(e).forEach(n=>{n in o?t&&(pn(o[n])&&pn(e[n])?PE(o[n],e[n],t):o[n]=e[n]):o[n]=e[n]}),o):e}function sn(o,e){if(o===e)return!0;if(o==null||e===null||e===void 0||typeof o!=typeof e||typeof o!="object"||Array.isArray(o)!==Array.isArray(e))return!1;let t,n;if(Array.isArray(o)){if(o.length!==e.length)return!1;for(t=0;t<o.length;t++)if(!sn(o[t],e[t]))return!1}else{let i=[];for(n in o)i.push(n);i.sort();let r=[];for(n in e)r.push(n);if(r.sort(),!sn(i,r))return!1;for(t=0;t<i.length;t++)if(!sn(o[i[t]],e[i[t]]))return!1}return!0}var NE=class o{constructor(e,t,n,i,r,s,a){this._forceIntegerValues=e;this._forceIntegerValues&&(t=t|0,n=n|0,i=i|0,r=r|0,s=s|0,a=a|0),this.rawScrollLeft=i,this.rawScrollTop=a,t<0&&(t=0),i+t>n&&(i=n-t),i<0&&(i=0),r<0&&(r=0),a+r>s&&(a=s-r),a<0&&(a=0),this.width=t,this.scrollWidth=n,this.scrollLeft=i,this.height=r,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new o(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new o(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){let n=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:i,scrollLeftChanged:r,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},Wa=class extends W{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new L);onScroll=this._onScroll.event;constructor(e){super(),this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new NE(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let n=this._state.withScrollDimensions(e,t);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let n=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;t?i=new $v(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):i=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{let n=this._state.withScrollPosition(e);this._smoothScrolling=$v.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let n=this._state;n.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(n,t)))}},Gv=class{scrollLeft;scrollTop;isDone;constructor(e,t,n){this.scrollLeft=e,this.scrollTop=t,this.isDone=n}};function AE(o,e){let t=e-o;return function(n){return o+t*EH(n)}}function _H(o,e,t){return function(n){return n<t?o(n/t):e((n-t)/(1-t))}}var $v=class o{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(e,t,n,i){this.from=e,this.to=t,this.duration=i,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,n){if(Math.abs(e-t)>2.5*n){let r,s;return e<t?(r=e+.75*n,s=t-.75*n):(r=e-.75*n,s=t+.75*n),_H(AE(e,r),AE(s,t),.33)}return AE(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let t=(e-this.startTime)/this.duration;if(t<1){let n=this.scrollLeft(t),i=this.scrollTop(t);return new Gv(n,i,!1)}return new Gv(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,n){return o.start(e,t,n)}static start(e,t,n){n=n+10;let i=Date.now()-10;return new o(e,t,i,n)}};function wH(o){return Math.pow(o,3)}function EH(o){return 1-wH(1-o)}var Bs=new class{_zoomLevel=0;_onDidChangeZoomLevel=new L;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(o){o=Math.min(Math.max(-5,o),20),this._zoomLevel!==o&&(this._zoomLevel=o,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var TH=Be?1.5:1.35,OE=8,ag=class o{_bareFontInfoBrand=void 0;static createFromValidatedSettings(e,t,n){let i=e.get(50),r=e.get(54),s=e.get(53),a=e.get(52),l=e.get(55),d=e.get(68),c=e.get(65);return o._create(i,r,s,a,l,d,c,t,n)}static createFromRawSettings(e,t,n=!1){let i=Ws.fontFamily.validate(e.fontFamily),r=Ws.fontWeight.validate(e.fontWeight),s=Ws.fontSize.validate(e.fontSize),a=Ws.fontLigatures2.validate(e.fontLigatures),l=Ws.fontVariations.validate(e.fontVariations),d=Ws.lineHeight.validate(e.lineHeight),c=Ws.letterSpacing.validate(e.letterSpacing);return o._create(i,r,s,a,l,d,c,t,n)}static _create(e,t,n,i,r,s,a,l,d){s===0?s=TH*n:s<OE&&(s=s*n),s=Math.round(s),s<OE&&(s=OE);let c=1+(d?0:Bs.getZoomLevel()*.1);return n*=c,s*=c,r===zu.TRANSLATE&&(t==="normal"||t==="bold"?r=zu.OFF:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new o({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:n,fontFeatureSettings:i,fontVariationSettings:r,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(e){this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let e=lo.fontFamily,t=o._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}},FE=2,Uu=class extends ag{_editorStylingBrand=void 0;version=FE;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}};var Vs={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var BE="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function LH(o=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of BE)o.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var jv=LH();function lg(o){let e=jv;if(o&&o instanceof RegExp)if(o.global)e=o;else{let t="g";o.ignoreCase&&(t+="i"),o.multiline&&(t+="m"),o.unicode&&(t+="u"),e=new RegExp(o.source,t)}return e.lastIndex=0,e}var MP=new Gn;MP.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function dg(o,e,t,n,i){if(e=lg(e),i||(i=gr.first(MP)),t.length>i.maxLen){let d=o-i.maxLen/2;return d<0?d=0:n+=d,t=t.substring(d,o+i.maxLen/2),dg(o,e,t,n,i)}let r=Date.now(),s=o-1-n,a=-1,l=null;for(let d=1;!(Date.now()-r>=i.timeBudget);d++){let c=s-i.windowSize*d;e.lastIndex=Math.max(0,c);let u=kH(e,t,s,a);if(!u&&l||(l=u,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return e.lastIndex=0,d}return null}function kH(o,e,t,n){let i;for(;i=o.exec(e);){let r=i.index||0;if(r<=t&&o.lastIndex>=t)return i;if(n>0&&r>n)return null}return null}var Si=Y("accessibilityService");var xY=new ce("accessibilityModeEnabled",!1);var Kr=8,qv=class{_values;constructor(e){this._values=e}hasChanged(e){return this._values[e]}},cg=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},Ct=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return Qv(e,t)}compute(e,t,n){return n}},Gu=class{constructor(e,t){this.newValue=e;this.didChange=t}};function Qv(o,e){if(typeof o!="object"||typeof e!="object"||!o||!e)return new Gu(e,o!==e);if(Array.isArray(o)||Array.isArray(e)){let n=Array.isArray(o)&&Array.isArray(e)&&Kt(o,e);return new Gu(e,!n)}let t=!1;for(let n in e)if(e.hasOwnProperty(n)){let i=Qv(o[n],e[n]);i.didChange&&(o[n]=i.newValue,t=!0)}return new Gu(o,t)}var dc=class{id;name;defaultValue;schema=void 0;constructor(e){this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return Qv(e,t)}validate(e){return this.defaultValue}},zl=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return Qv(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,n){return n}};function _e(o,e){return typeof o>"u"?e:o==="false"?!1:!!o}var Qe=class extends zl{constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="boolean",i.default=n),super(e,t,n,i)}validate(e){return _e(e,this.defaultValue)}};function DH(o,e,t,n){if(typeof o>"u")return e;let i=parseInt(o,10);return isNaN(i)?e:(i=Math.max(t,i),i=Math.min(n,i),i|0)}var ft=class o extends zl{static clampedInt(e,t,n,i){return DH(e,t,n,i)}minimum;maximum;constructor(e,t,n,i,r,s=void 0){typeof s<"u"&&(s.type="integer",s.default=n,s.minimum=i,s.maximum=r),super(e,t,n,s),this.minimum=i,this.maximum=r}validate(e){return o.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}};var vr=class o extends zl{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;let n=parseFloat(e);return isNaN(n)?t:n}validationFn;constructor(e,t,n,i,r){typeof r<"u"&&(r.type="number",r.default=n),super(e,t,n,r),this.validationFn=i}validate(e){return this.validationFn(o.float(e,this.defaultValue))}},xi=class o extends zl{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="string",i.default=n),super(e,t,n,i)}validate(e){return o.string(e,this.defaultValue)}};function jt(o,e,t,n){return typeof o!="string"?e:n&&o in n?n[o]:t.indexOf(o)===-1?e:o}var Mt=class extends zl{_allowedValues;constructor(e,t,n,i,r=void 0){typeof r<"u"&&(r.type="string",r.enum=i,r.default=n),super(e,t,n,r),this._allowedValues=i}validate(e){return jt(e,this.defaultValue,this._allowedValues)}},Ku=class extends Ct{_allowedValues;_convert;constructor(e,t,n,i,r,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=i),super(e,t,n,a),this._allowedValues=r,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function RH(o){switch(o){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var WE=class extends Ct{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[h("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),h("accessibilitySupport.on","Optimize for usage with a Screen Reader."),h("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,n){return n===0?e.accessibilitySupport:n}},VE=class extends Ct{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertSpace:_e(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:_e(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function MH(o){switch(o){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function PH(o){switch(o){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var HE=class extends dc{constructor(){super(144)}compute(e,t,n){let i=["monaco-editor"];return t.get(40)&&i.push(t.get(40)),e.extraEditorClassName&&i.push(e.extraEditorClassName),t.get(75)==="default"?i.push("mouse-default"):t.get(75)==="copy"&&i.push("mouse-copy"),t.get(113)&&i.push("showUnused"),t.get(142)&&i.push("showDeprecated"),i.join(" ")}},UE=class extends Qe{constructor(){super(38,"emptySelectionClipboard",!0,{description:h("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}},zE=class extends Ct{constructor(){let e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),h("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),h("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:h("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),h("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),h("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Be},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:h("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{cursorMoveOnType:_e(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":jt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":jt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:_e(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:_e(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:_e(t.loop,this.defaultValue.loop)}}},Va=class o extends Ct{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",o.OFF,{anyOf:[{type:"boolean",description:h("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?o.OFF:e==="true"?o.ON:e:e?o.ON:o.OFF}},zu=class o extends Ct{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",o.OFF,{anyOf:[{type:"boolean",description:h("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?o.OFF:e==="true"?o.TRANSLATE:e:e?o.TRANSLATE:o.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}},KE=class extends dc{constructor(){super(51)}compute(e,t,n){return e.fontInfo}},GE=class extends zl{constructor(){super(53,"fontSize",lo.fontSize,{type:"number",minimum:6,maximum:100,default:lo.fontSize,description:h("fontSize","Controls the font size in pixels.")})}validate(e){let t=vr.float(e,this.defaultValue);return t===0?lo.fontSize:vr.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}},$E=class o extends Ct{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",lo.fontWeight,{anyOf:[{type:"number",minimum:o.MINIMUM_VALUE,maximum:o.MAXIMUM_VALUE,errorMessage:h("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:o.SUGGESTION_VALUES}],default:lo.fontWeight,description:h("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(ft.clampedInt(e,lo.fontWeight,o.MINIMUM_VALUE,o.MAXIMUM_VALUE))}},jE=class extends Ct{constructor(){let e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),h("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),h("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:h("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:h("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:h("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:h("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:h("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:h("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:h("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:h("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:h("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{multiple:jt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??jt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??jt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??jt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??jt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??jt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??jt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:xi.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:xi.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:xi.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:xi.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:xi.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:xi.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},qE=class extends Ct{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:h("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:h("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:h("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),delay:ft.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:_e(t.sticky,this.defaultValue.sticky),hidingDelay:ft.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:_e(t.above,this.defaultValue.above)}}};var ug=class o extends dc{constructor(){super(147)}compute(e,t,n){return o.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight),i=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(i=Math.max(i,t-1));let r=(n+e.viewLineCount+i)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:i,desiredRatio:r,minimapLineCount:s}}static _computeMinimapLayout(e,t){let n=e.outerWidth,i=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};let s=t.stableMinimapLayoutInput,a=s&&e.outerHeight===s.outerHeight&&e.lineHeight===s.lineHeight&&e.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&e.pixelRatio===s.pixelRatio&&e.scrollBeyondLastLine===s.scrollBeyondLastLine&&e.paddingTop===s.paddingTop&&e.paddingBottom===s.paddingBottom&&e.minimap.enabled===s.minimap.enabled&&e.minimap.side===s.minimap.side&&e.minimap.size===s.minimap.size&&e.minimap.showSlider===s.minimap.showSlider&&e.minimap.renderCharacters===s.minimap.renderCharacters&&e.minimap.maxColumn===s.minimap.maxColumn&&e.minimap.scale===s.minimap.scale&&e.verticalScrollbarWidth===s.verticalScrollbarWidth&&e.isViewportWrapping===s.isViewportWrapping,l=e.lineHeight,d=e.typicalHalfwidthCharacterWidth,c=e.scrollBeyondLastLine,u=e.minimap.renderCharacters,p=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale,m=e.minimap.maxColumn,g=e.minimap.size,f=e.minimap.side,b=e.verticalScrollbarWidth,v=e.viewLineCount,I=e.remainingWidth,C=e.isViewportWrapping,S=u?2:3,E=Math.floor(r*i),M=E/r,A=!1,F=!1,O=S*p,H=p/r,U=1;if(g==="fill"||g==="fit"){let{typicalViewportLineCount:ne,extraLinesBeforeFirstLine:Z,extraLinesBeyondLastLine:Ce,desiredRatio:xe,minimapLineCount:st}=o.computeContainedMinimapLineCount({viewLineCount:v,scrollBeyondLastLine:c,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:i,lineHeight:l,pixelRatio:r});if(v/st>1)A=!0,F=!0,p=1,O=1,H=p/r;else{let ke=!1,ti=p+1;if(g==="fit"){let Pn=Math.ceil((Z+v+Ce)*O);C&&a&&I<=t.stableFitRemainingWidth?(ke=!0,ti=t.stableFitMaxMinimapScale):ke=Pn>E}if(g==="fill"||ke){A=!0;let Pn=p;O=Math.min(l*r,Math.max(1,Math.floor(1/xe))),C&&a&&I<=t.stableFitRemainingWidth&&(ti=t.stableFitMaxMinimapScale),p=Math.min(ti,Math.max(1,Math.floor(O/S))),p>Pn&&(U=Math.min(2,p/Pn)),H=p/r/U,E=Math.ceil(Math.max(ne,Z+v+Ce)*O),C?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=I,t.stableFitMaxMinimapScale=p):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}let z=Math.floor(m*H),re=Math.min(z,Math.max(0,Math.floor((I-b-2)*H/(d+H)))+Kr),ve=Math.floor(r*re),ee=ve/r;ve=Math.floor(ve*U);let Q=u?1:2,ae=f==="left"?0:n-re-b;return{renderMinimap:Q,minimapLeft:ae,minimapWidth:re,minimapHeightIsEditorHeight:A,minimapIsSampling:F,minimapScale:p,minimapLineHeight:O,minimapCanvasInnerWidth:ve,minimapCanvasInnerHeight:E,minimapCanvasOuterWidth:ee,minimapCanvasOuterHeight:M}}static computeLayout(e,t){let n=t.outerWidth|0,i=t.outerHeight|0,r=t.lineHeight|0,s=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,d=t.pixelRatio,c=t.viewLineCount,u=e.get(139),p=u==="inherit"?e.get(138):u,m=p==="inherit"?e.get(134):p,g=e.get(137),f=t.isDominatedByLongLines,b=e.get(58),v=e.get(69).renderType!==0,I=e.get(70),C=e.get(107),S=e.get(85),E=e.get(74),M=e.get(105),A=M.verticalScrollbarSize,F=M.verticalHasArrows,O=M.arrowSize,H=M.horizontalScrollbarSize,U=e.get(44),z=e.get(112)!=="never",re=e.get(67);U&&z&&(re+=16);let ve=0;if(v){let So=Math.max(s,I);ve=Math.round(So*l)}let ee=0;b&&(ee=r*t.glyphMarginDecorationLaneCount);let Q=0,ae=Q+ee,ne=ae+ve,Z=ne+re,Ce=n-ee-ve-re,xe=!1,st=!1,Xe=-1;p==="inherit"&&f?(xe=!0,st=!0):m==="on"||m==="bounded"?st=!0:m==="wordWrapColumn"&&(Xe=g);let ke=o._computeMinimapLayout({outerWidth:n,outerHeight:i,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:C,paddingTop:S.top,paddingBottom:S.bottom,minimap:E,verticalScrollbarWidth:A,viewLineCount:c,remainingWidth:Ce,isViewportWrapping:st},t.memory||new cg);ke.renderMinimap!==0&&ke.minimapLeft===0&&(Q+=ke.minimapWidth,ae+=ke.minimapWidth,ne+=ke.minimapWidth,Z+=ke.minimapWidth);let ti=Ce-ke.minimapWidth,Pn=Math.max(1,Math.floor((ti-A-2)/a)),eo=F?O:0;return st&&(Xe=Math.max(1,Pn),m==="bounded"&&(Xe=Math.min(Xe,g))),{width:n,height:i,glyphMarginLeft:Q,glyphMarginWidth:ee,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:ae,lineNumbersWidth:ve,decorationsLeft:ne,decorationsWidth:re,contentLeft:Z,contentWidth:ti,minimap:ke,viewportColumn:Pn,isWordWrapMinified:xe,isViewportWrapping:st,wrappingColumn:Xe,verticalScrollbarWidth:A,horizontalScrollbarHeight:H,overviewRuler:{top:eo,width:A,height:i-2*eo,right:0}}}},YE=class extends Ct{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return jt(e,"simple",["simple","advanced"])}compute(e,t,n){return t.get(2)===2?"advanced":n}};var QE=class extends Ct{constructor(){let e={enabled:"onCode"};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:e.enabled,enumDescriptions:[h("editor.lightbulb.enabled.off","Disable the code action menu."),h("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),h("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:jt(e.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},ZE=class extends Ct{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),maxLineCount:ft.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:jt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:_e(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},XE=class extends Ct{constructor(){let e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h("editor.inlayHints.on","Inlay hints are enabled"),h("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Be?"Ctrl+Option":"Ctrl+Alt"),h("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Be?"Ctrl+Option":"Ctrl+Alt"),h("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:h("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:jt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:ft.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:xi.string(t.fontFamily,this.defaultValue.fontFamily),padding:_e(t.padding,this.defaultValue.padding),maximumLength:ft.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},JE=class extends Ct{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):ft.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?ft.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}},eT=class extends vr{constructor(){super(68,"lineHeight",lo.lineHeight,e=>vr.clamp(e,0,150),{markdownDescription:h("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,n){return e.fontInfo.lineHeight}},tT=class extends Ct{constructor(){let e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:h("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),h("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:h("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:h("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),autohide:_e(t.autohide,this.defaultValue.autohide),size:jt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:jt(t.side,this.defaultValue.side,["right","left"]),showSlider:jt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:_e(t.renderCharacters,this.defaultValue.renderCharacters),scale:ft.clampedInt(t.scale,1,1,3),maxColumn:ft.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:_e(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:_e(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:vr.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:vr.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function AH(o){return o==="ctrlCmd"?Be?"metaKey":"ctrlKey":"altKey"}var nT=class extends Ct{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{top:ft.clampedInt(t.top,0,0,1e3),bottom:ft.clampedInt(t.bottom,0,0,1e3)}}},iT=class extends Ct{constructor(){let e={enabled:!0,cycle:!0};super(87,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),cycle:_e(t.cycle,this.defaultValue.cycle)}}},oT=class extends dc{constructor(){super(145)}compute(e,t,n){return e.pixelRatio}},rT=class extends Ct{constructor(){super(89,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},sT=class extends Ct{defaultValue;constructor(){let e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h("on","Quick suggestions show inside the suggest widget"),h("inline","Quick suggestions show as ghost text"),h("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:h("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:h("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:h("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:h("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){let d=e?"on":"off";return{comments:d,strings:d,other:d}}if(!e||typeof e!="object")return this.defaultValue;let{other:t,comments:n,strings:i}=e,r=["on","inline","off"],s,a,l;return typeof t=="boolean"?s=t?"on":"off":s=jt(t,this.defaultValue.other,r),typeof n=="boolean"?a=n?"on":"off":a=jt(n,this.defaultValue.comments,r),typeof i=="boolean"?l=i?"on":"off":l=jt(i,this.defaultValue.strings,r),{other:s,comments:a,strings:l}}};var aT=class extends Ct{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h("lineNumbers.off","Line numbers are not rendered."),h("lineNumbers.on","Line numbers are rendered as absolute number."),h("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),h("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:h("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,n=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:n}}};function cc(o){let e=o.get(100);return e==="editable"?o.get(93):e!=="on"}var lT=class extends Ct{constructor(){let e=[],t={type:"number",description:h("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:h("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:h("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="number")t.push({column:ft.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n=="object"){let i=n;t.push({column:ft.clampedInt(i.column,0,0,1e4),color:i.color})}return t.sort((n,i)=>n.column-i.column),t}return this.defaultValue}},dT=class extends Ct{constructor(){super(94,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function PP(o,e){if(typeof o!="string")return e;switch(o){case"hidden":return 2;case"visible":return 3;default:return 1}}var cT=class extends Ct{constructor(){let e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),h("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),h("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:h("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),h("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),h("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:h("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e,n=ft.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),i=ft.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:ft.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:PP(t.vertical,this.defaultValue.vertical),horizontal:PP(t.horizontal,this.defaultValue.horizontal),useShadows:_e(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:_e(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:_e(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:_e(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:_e(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:ft.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:i,verticalSliderSize:ft.clampedInt(t.verticalSliderSize,i,0,1e3),scrollByPage:_e(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:_e(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},zr="inUntrustedWorkspace",lc={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},uT=class extends Ct{constructor(){let e={nonBasicASCII:zr,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:zr,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",e,{[lc.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,zr],default:e.nonBasicASCII,description:h("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[lc.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:h("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[lc.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:h("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[lc.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,zr],default:e.includeComments,description:h("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[lc.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,zr],default:e.includeStrings,description:h("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[lc.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:h("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[lc.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&(sn(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&(sn(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));let i=super.applyUpdate(e,t);return n?new Gu(i.newValue,!0):i}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{nonBasicASCII:$u(t.nonBasicASCII,zr,[!0,!1,zr]),invisibleCharacters:_e(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:_e(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:$u(t.includeComments,zr,[!0,!1,zr]),includeStrings:$u(t.includeStrings,zr,[!0,!1,zr]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;let n={};for(let[i,r]of Object.entries(e))r===!0&&(n[i]=!0);return n}},pT=class extends Ct{constructor(){let e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),h("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),h("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:h("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:h("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),mode:jt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:jt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:_e(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:_e(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:xi.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:_e(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},hT=class extends Ct{constructor(){let e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:h("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),h("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),h("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:h("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:h("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),showToolbar:jt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:xi.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:_e(t.keepOnBlur,this.defaultValue.keepOnBlur)}}},mT=class extends Ct{constructor(){let e={enabled:Vs.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Vs.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:_e(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},gT=class extends Ct{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h("editor.guides.bracketPairs.true","Enables bracket pair guides."),h("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),h("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:h("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),h("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),h("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:h("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[h("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),h("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),h("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:h("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{bracketPairs:$u(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:$u(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:_e(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:_e(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:$u(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function $u(o,e,t){let n=t.indexOf(o);return n===-1?e:t[n]}var fT=class extends Ct{constructor(){let e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),h("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:h("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),h("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),h("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),h("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:h("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertMode:jt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:_e(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:_e(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:_e(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:_e(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:jt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:_e(t.showIcons,this.defaultValue.showIcons),showStatusBar:_e(t.showStatusBar,this.defaultValue.showStatusBar),preview:_e(t.preview,this.defaultValue.preview),previewMode:jt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:_e(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:_e(t.showMethods,this.defaultValue.showMethods),showFunctions:_e(t.showFunctions,this.defaultValue.showFunctions),showConstructors:_e(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:_e(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:_e(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:_e(t.showFields,this.defaultValue.showFields),showVariables:_e(t.showVariables,this.defaultValue.showVariables),showClasses:_e(t.showClasses,this.defaultValue.showClasses),showStructs:_e(t.showStructs,this.defaultValue.showStructs),showInterfaces:_e(t.showInterfaces,this.defaultValue.showInterfaces),showModules:_e(t.showModules,this.defaultValue.showModules),showProperties:_e(t.showProperties,this.defaultValue.showProperties),showEvents:_e(t.showEvents,this.defaultValue.showEvents),showOperators:_e(t.showOperators,this.defaultValue.showOperators),showUnits:_e(t.showUnits,this.defaultValue.showUnits),showValues:_e(t.showValues,this.defaultValue.showValues),showConstants:_e(t.showConstants,this.defaultValue.showConstants),showEnums:_e(t.showEnums,this.defaultValue.showEnums),showEnumMembers:_e(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:_e(t.showKeywords,this.defaultValue.showKeywords),showWords:_e(t.showWords,this.defaultValue.showWords),showColors:_e(t.showColors,this.defaultValue.showColors),showFiles:_e(t.showFiles,this.defaultValue.showFiles),showReferences:_e(t.showReferences,this.defaultValue.showReferences),showFolders:_e(t.showFolders,this.defaultValue.showFolders),showTypeParameters:_e(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:_e(t.showSnippets,this.defaultValue.showSnippets),showUsers:_e(t.showUsers,this.defaultValue.showUsers),showIssues:_e(t.showIssues,this.defaultValue.showIssues)}}},bT=class extends Ct{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:_e(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:_e(e.selectSubwords,this.defaultValue.selectSubwords)}}},vT=class extends Ct{constructor(){let e=[];super(132,"wordSegmenterLocales",e,{anyOf:[{description:h("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:h("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="string")try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}};var yT=class extends Ct{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),h("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),h("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),h("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:h("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,n){return t.get(2)===2?0:n}},IT=class extends dc{constructor(){super(148)}compute(e,t,n){let i=t.get(147);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:i.isWordWrapMinified,isViewportWrapping:i.isViewportWrapping,wrappingColumn:i.wrappingColumn}}},CT=class extends Ct{constructor(){let e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),h("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),showDropSelector:jt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},ST=class extends Ct{constructor(){let e={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),h("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),showPasteSelector:jt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},NH="Consolas, 'Courier New', monospace",OH="Menlo, Monaco, 'Courier New', monospace",FH="'Droid Sans Mono', 'monospace', monospace",lo={fontFamily:Be?OH:Gt?FH:NH,fontWeight:"normal",fontSize:Be?12:14,lineHeight:0,letterSpacing:0},ju=[];function $(o){return ju[o.id]=o,o}var Ws={acceptSuggestionOnCommitCharacter:$(new Qe(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:h("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:$(new Mt(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:$(new WE),accessibilityPageSize:$(new ft(3,"accessibilityPageSize",10,1,1073741824,{description:h("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:$(new xi(4,"ariaLabel",h("editorViewAccessibleLabel","Editor content"))),ariaRequired:$(new Qe(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:$(new Qe(8,"screenReaderAnnounceInlineSuggestion",!0,{description:h("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:$(new Mt(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),h("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:$(new Mt(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),h("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:h("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:$(new Mt(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:$(new Mt(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:h("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:$(new Mt(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),h("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:$(new Ku(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],RH,{enumDescriptions:[h("editor.autoIndent.none","The editor will not insert indentation automatically."),h("editor.autoIndent.keep","The editor will keep the current line's indentation."),h("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),h("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:$(new Qe(13,"automaticLayout",!1)),autoSurround:$(new Mt(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),h("editor.autoSurround.quotes","Surround with quotes but not brackets."),h("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:h("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:$(new mT),bracketPairGuides:$(new gT),stickyTabStops:$(new Qe(118,"stickyTabStops",!1,{description:h("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:$(new Qe(17,"codeLens",!0,{description:h("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:$(new xi(18,"codeLensFontFamily","",{description:h("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:$(new ft(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:$(new Qe(20,"colorDecorators",!0,{description:h("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:$(new Mt(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),h("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),h("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:h("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:$(new ft(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:$(new Qe(22,"columnSelection",!1,{description:h("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:$(new VE),contextmenu:$(new Qe(24,"contextmenu",!0)),copyWithSyntaxHighlighting:$(new Qe(25,"copyWithSyntaxHighlighting",!0,{description:h("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:$(new Ku(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],MH,{description:h("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:$(new Mt(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),h("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:h("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:$(new Ku(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],PH,{description:h("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:$(new ft(29,"cursorSurroundingLines",0,0,1073741824,{description:h("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:$(new Mt(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:h("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:$(new ft(31,"cursorWidth",0,0,1073741824,{markdownDescription:h("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:$(new Qe(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:$(new Qe(33,"disableMonospaceOptimizations",!1)),domReadOnly:$(new Qe(34,"domReadOnly",!1)),dragAndDrop:$(new Qe(35,"dragAndDrop",!0,{description:h("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:$(new UE),dropIntoEditor:$(new CT),experimentalEditContextEnabled:$(new Qe(37,"experimentalEditContextEnabled",!1,{description:h("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:$(new ZE),experimentalWhitespaceRendering:$(new Mt(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),h("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),h("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:h("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:$(new xi(40,"extraEditorClassName","")),fastScrollSensitivity:$(new vr(41,"fastScrollSensitivity",5,o=>o<=0?5:o,{markdownDescription:h("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:$(new zE),fixedOverflowWidgets:$(new Qe(43,"fixedOverflowWidgets",!1)),folding:$(new Qe(44,"folding",!0,{description:h("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:$(new Mt(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),h("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:h("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:$(new Qe(46,"foldingHighlight",!0,{description:h("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:$(new Qe(47,"foldingImportsByDefault",!1,{description:h("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:$(new ft(48,"foldingMaximumRegions",5e3,10,65e3,{description:h("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:$(new Qe(49,"unfoldOnClickAfterEndOfLine",!1,{description:h("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:$(new xi(50,"fontFamily",lo.fontFamily,{description:h("fontFamily","Controls the font family.")})),fontInfo:$(new KE),fontLigatures2:$(new Va),fontSize:$(new GE),fontWeight:$(new $E),fontVariations:$(new zu),formatOnPaste:$(new Qe(56,"formatOnPaste",!1,{description:h("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:$(new Qe(57,"formatOnType",!1,{description:h("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:$(new Qe(58,"glyphMargin",!0,{description:h("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:$(new jE),hideCursorInOverviewRuler:$(new Qe(60,"hideCursorInOverviewRuler",!1,{description:h("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:$(new qE),inDiffEditor:$(new Qe(62,"inDiffEditor",!1)),letterSpacing:$(new vr(65,"letterSpacing",lo.letterSpacing,o=>vr.clamp(o,-5,20),{description:h("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:$(new QE),lineDecorationsWidth:$(new JE),lineHeight:$(new eT),lineNumbers:$(new aT),lineNumbersMinChars:$(new ft(70,"lineNumbersMinChars",5,1,300)),linkedEditing:$(new Qe(71,"linkedEditing",!1,{description:h("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:$(new Qe(72,"links",!0,{description:h("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:$(new Mt(73,"matchBrackets","always",["always","near","never"],{description:h("matchBrackets","Highlight matching brackets.")})),minimap:$(new tT),mouseStyle:$(new Mt(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:$(new vr(76,"mouseWheelScrollSensitivity",1,o=>o===0?1:o,{markdownDescription:h("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:$(new Qe(77,"mouseWheelZoom",!1,{markdownDescription:Be?h("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:$(new Qe(78,"multiCursorMergeOverlapping",!0,{description:h("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:$(new Ku(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],AH,{markdownEnumDescriptions:[h("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),h("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:$(new Mt(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h("multiCursorPaste.spread","Each cursor pastes a single line of the text."),h("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:h("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:$(new ft(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:$(new Mt(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h("occurrencesHighlight.off","Does not highlight occurrences."),h("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),h("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:$(new Qe(83,"overviewRulerBorder",!0,{description:h("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:$(new ft(84,"overviewRulerLanes",3,0,3)),padding:$(new nT),pasteAs:$(new ST),parameterHints:$(new iT),peekWidgetDefaultFocus:$(new Mt(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),h("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:h("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:$(new rT),definitionLinkOpensInPeek:$(new Qe(90,"definitionLinkOpensInPeek",!1,{description:h("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:$(new sT),quickSuggestionsDelay:$(new ft(92,"quickSuggestionsDelay",10,0,1073741824,{description:h("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:$(new Qe(93,"readOnly",!1)),readOnlyMessage:$(new dT),renameOnType:$(new Qe(95,"renameOnType",!1,{description:h("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:h("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:$(new Qe(96,"renderControlCharacters",!0,{description:h("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:$(new Mt(97,"renderFinalNewline",Gt?"dimmed":"on",["off","on","dimmed"],{description:h("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:$(new Mt(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:h("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:$(new Qe(99,"renderLineHighlightOnlyWhenFocus",!1,{description:h("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:$(new Mt(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:$(new Mt(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),h("renderWhitespace.selection","Render whitespace characters only on selected text."),h("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:h("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:$(new ft(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:$(new Qe(103,"roundedSelection",!0,{description:h("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:$(new lT),scrollbar:$(new cT),scrollBeyondLastColumn:$(new ft(106,"scrollBeyondLastColumn",4,0,1073741824,{description:h("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:$(new Qe(107,"scrollBeyondLastLine",!0,{description:h("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:$(new Qe(108,"scrollPredominantAxis",!0,{description:h("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:$(new Qe(109,"selectionClipboard",!0,{description:h("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:Gt})),selectionHighlight:$(new Qe(110,"selectionHighlight",!0,{description:h("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:$(new Qe(111,"selectOnLineNumbers",!0)),showFoldingControls:$(new Mt(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h("showFoldingControls.always","Always show the folding controls."),h("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),h("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:h("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:$(new Qe(113,"showUnused",!0,{description:h("showUnused","Controls fading out of unused code.")})),showDeprecated:$(new Qe(142,"showDeprecated",!0,{description:h("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:$(new XE),snippetSuggestions:$(new Mt(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),h("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),h("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),h("snippetSuggestions.none","Do not show snippet suggestions.")],description:h("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:$(new bT),smoothScrolling:$(new Qe(116,"smoothScrolling",!1,{description:h("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:$(new ft(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:$(new fT),inlineSuggest:$(new pT),inlineEdit:$(new hT),inlineCompletionsAccessibilityVerbose:$(new Qe(151,"inlineCompletionsAccessibilityVerbose",!1,{description:h("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:$(new ft(121,"suggestFontSize",0,0,1e3,{markdownDescription:h("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:$(new ft(122,"suggestLineHeight",0,0,1e3,{markdownDescription:h("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:$(new Qe(123,"suggestOnTriggerCharacters",!0,{description:h("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:$(new Mt(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h("suggestSelection.first","Always select the first suggestion."),h("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:$(new Mt(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),h("tabCompletion.off","Disable tab completions."),h("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h("tabCompletion","Enables tab completions.")})),tabIndex:$(new ft(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:$(new uT),unusualLineTerminators:$(new Mt(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),h("unusualLineTerminators.off","Unusual line terminators are ignored."),h("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:h("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:$(new Qe(129,"useShadowDOM",!0)),useTabStops:$(new Qe(130,"useTabStops",!0,{description:h("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:$(new Mt(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h("wordBreak.normal","Use the default line break rule."),h("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:$(new vT),wordSeparators:$(new xi(133,"wordSeparators",BE,{description:h("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:$(new Mt(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h("wordWrap.off","Lines will never wrap."),h("wordWrap.on","Lines will wrap at the viewport width."),h({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),h({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:$(new xi(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:$(new xi(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:$(new ft(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:h({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:$(new Mt(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:$(new Mt(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:$(new HE),defaultColorDecorators:$(new Qe(149,"defaultColorDecorators",!1,{markdownDescription:h("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:$(new oT),tabFocusMode:$(new Qe(146,"tabFocusMode",!1,{markdownDescription:h("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:$(new ug),wrappingInfo:$(new IT),wrappingIndent:$(new yT),wrappingStrategy:$(new YE)};var R=class o{lineNumber;column;constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new o(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return o.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return o.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return o.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let n=e.lineNumber|0,i=t.lineNumber|0;if(n===i){let r=e.column|0,s=t.column|0;return r-s}return n-i}clone(){return new o(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new o(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var w=class o{startLineNumber;startColumn;endLineNumber;endColumn;constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return o.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return o.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return o.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return o.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return o.plusRange(this,e)}static plusRange(e,t){let n,i,r,s;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,s=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,s=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,s=e.endColumn),new o(n,i,r,s)}intersectRanges(e){return o.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,s=e.endColumn,a=t.startLineNumber,l=t.startColumn,d=t.endLineNumber,c=t.endColumn;return n<a?(n=a,i=l):n===a&&(i=Math.max(i,l)),r>d?(r=d,s=c):r===d&&(s=Math.min(s,c)),n>r||n===r&&i>s?null:new o(n,i,r,s)}equalsRange(e){return o.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return o.getEndPosition(this)}static getEndPosition(e){return new R(e.endLineNumber,e.endColumn)}getStartPosition(){return o.getStartPosition(this)}static getStartPosition(e){return new R(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new o(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new o(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return o.collapseToStart(this)}static collapseToStart(e){return new o(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return o.collapseToEnd(this)}static collapseToEnd(e){return new o(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new o(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let r=e.startLineNumber|0,s=t.startLineNumber|0;if(r===s){let a=e.startColumn|0,l=t.startColumn|0;if(a===l){let d=e.endLineNumber|0,c=t.endLineNumber|0;if(d===c){let u=e.endColumn|0,p=t.endColumn|0;return u-p}return d-c}return a-l}return r-s}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var De=class o extends w{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return o.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new o(this.startLineNumber,this.startColumn,e,t):new o(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new R(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new R(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new o(e,t,this.endLineNumber,this.endColumn):new o(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new o(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new o(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,n,i,r){return r===0?new o(e,t,n,i):new o(n,i,e,t)}};var To=class{static insert(e,t){return{range:new w(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}};function _T(o,e){return new xT(o,e)}var xT=class{constructor(e,t){this.reducer=e;this.options=t}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?Ue(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let n;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){let i=n.indexOf(t);i>=0&&n.splice(i,1)}}flowData(){if(this.buffer.data.length>0){let e=this.reducer(this.buffer.data);this.emitData(e),this.buffer.data.length=0;let t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(n=>n())}}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function wT(o,e,t){o.on("error",n=>{t?.isCancellationRequested||e.onError(n)}),o.on("end",()=>{t?.isCancellationRequested||e.onEnd()}),o.on("data",n=>{t?.isCancellationRequested||e.onData(n)})}function AP(o,e){let t=_T(e);return t.end(o),t}function NP(o){let e=!1;return{read:()=>e?null:(e=!0,o)}}var Zv=typeof Buffer<"u",WH=new Nn(()=>new Uint8Array(256)),ET,TT,Tn=class o{static alloc(e){return Zv?new o(Buffer.allocUnsafe(e)):new o(new Uint8Array(e))}static wrap(e){return Zv&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new o(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&Zv?new o(Buffer.from(e)):(ET||(ET=new TextEncoder),new o(ET.encode(e)))}static fromByteArray(e){let t=o.alloc(e.length);for(let n=0,i=e.length;n<i;n++)t.buffer[n]=e[n];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].byteLength}let n=o.alloc(t),i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];n.set(a,i),i+=a.byteLength}return n}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=o.alloc(this.byteLength);return e.set(this),e}toString(){return Zv?this.buffer.toString():(TT||(TT=new TextDecoder),TT.decode(this.buffer))}slice(e,t){return new o(this.buffer.subarray(e,t))}set(e,t){if(e instanceof o)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return jn(this.buffer,e)}writeUInt32BE(e,t){qn(this.buffer,e,t)}readUInt32LE(e){return HH(this.buffer,e)}writeUInt32LE(e,t){UH(this.buffer,e,t)}readUInt8(e){return Xv(this.buffer,e)}writeUInt8(e,t){Jv(this.buffer,e,t)}indexOf(e,t=0){return VH(this.buffer,e instanceof o?e.buffer:e,t)}};function VH(o,e,t=0){let n=e.byteLength,i=o.byteLength;if(n===0)return 0;if(n===1)return o.indexOf(e[0]);if(n>i-t)return-1;let r=WH.value;r.fill(e.length);for(let d=0;d<e.length;d++)r[e[d]]=e.length-d-1;let s=t+e.length-1,a=s,l=-1;for(;s<i;)if(o[s]===e[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(e.length-a,r[o[s]]),a=e.length-1;return l}function OP(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0}function FP(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255}function jn(o,e){return o[e]*2**24+o[e+1]*2**16+o[e+2]*2**8+o[e+3]}function qn(o,e,t){o[t+3]=e,e=e>>>8,o[t+2]=e,e=e>>>8,o[t+1]=e,e=e>>>8,o[t]=e}function HH(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0|o[e+2]<<16>>>0|o[e+3]<<24>>>0}function UH(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255,e=e>>>8,o[t+2]=e&255,e=e>>>8,o[t+3]=e&255}function Xv(o,e){return o[e]}function Jv(o,e,t){o[t]=e}function BP(o){return NP(o)}function WP(o){return AP(o,e=>Tn.concat(e))}var kT;function VP(){return kT||(kT=new TextDecoder("UTF-16LE")),kT}var DT;function zH(){return DT||(DT=new TextDecoder("UTF-16BE")),DT}var RT;function MT(){return RT||(RT=yM()?VP():zH()),RT}function HP(o,e,t){let n=new Uint16Array(o.buffer,e,t);return t>0&&(n[0]===65279||n[0]===65534)?KH(o,e,t):VP().decode(n)}function KH(o,e,t){let n=[],i=0;for(let r=0;r<t;r++){let s=OP(o,e);e+=2,n[i++]=String.fromCharCode(s)}return n.join("")}var Ha=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return MT().decode(e)}_flushBuffer(){let e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){let t=this._capacity-this._bufferLength;t<=1&&(t===0||Ot(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){let t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}};function ey(o){return o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var Lo=class o{constructor(e,t,n,i){this.oldPosition=e;this.oldText=t;this.newPosition=n;this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${ey(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${ey(this.oldText)}")`:`(replace@${this.oldPosition} "${ey(this.oldText)}" with "${ey(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){let i=t.length;qn(e,i,n),n+=4;for(let r=0;r<i;r++)FP(e,t.charCodeAt(r),n),n+=2;return n}static _readString(e,t){let n=jn(e,t);return t+=4,HP(e,t,n)}writeSize(){return 8+o._writeStringSize(this.oldText)+o._writeStringSize(this.newText)}write(e,t){return qn(e,this.oldPosition,t),t+=4,qn(e,this.newPosition,t),t+=4,t=o._writeString(e,this.oldText,t),t=o._writeString(e,this.newText,t),t}static read(e,t,n){let i=jn(e,t);t+=4;let r=jn(e,t);t+=4;let s=o._readString(e,t);t+=o._writeStringSize(s);let a=o._readString(e,t);return t+=o._writeStringSize(a),n.push(new o(i,s,r,a)),t}};function UP(o,e){return o===null||o.length===0?e:new PT(o,e).compress()}var PT=class o{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(n===null){this._acceptCurr(i),i=this._getCurr(++t);continue}if(i===null){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){let[d,c]=o._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(d),i=c;continue}if(n.newPosition<i.oldPosition){let[d,c]=o._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(d),n=c;continue}let a,l;if(i.oldEnd===n.newEnd)a=n,l=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){let[d,c]=o._splitPrev(n,i.oldLength);a=d,l=i,n=c,i=this._getCurr(++t)}else{let[d,c]=o._splitCurr(i,n.newLength);a=n,l=d,n=this._getPrev(++e),i=c}this._result[this._resultLen++]=new Lo(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let r=o._merge(this._result);return o._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=o._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=o._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new Lo(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new Lo(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){let n=e.newText.substr(0,t),i=e.newText.substr(t);return[new Lo(e.oldPosition,e.oldText,e.newPosition,n),new Lo(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){let n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new Lo(e.oldPosition,n,e.newPosition,e.newText),new Lo(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],n=0,i=e[0];for(let r=1;r<e.length;r++){let s=e[r];i.oldEnd===s.oldPosition?i=new Lo(i.oldPosition,i.oldText+s.oldText,i.newPosition,i.newText+s.newText):(t[n++]=i,i=s)}return t[n++]=i,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],n=0;for(let i=0;i<e.length;i++){let r=e[i];r.oldText!==r.newText&&(t[n++]=r)}return t}};var uc=class o{_asciiMap;_map;_defaultValue;constructor(e){let t=Kd(e);this._defaultValue=t,this._asciiMap=o._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let n=Kd(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var ty=class{_actual;constructor(){this._actual=new uc(0)}add(e){this._actual.set(e,1)}has(e){return this._actual.get(e)===1}clear(){return this._actual.clear()}};var AT=class extends uc{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(e,t){super(0),this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let n=0,i=e.length;n<i;n++)this.set(e.charCodeAt(n),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(let i of this._getIntlSegmenterWordsOnLine(e)){if(i.index>t)break;n=i}return n}findNextIntlWordAtOrAfterOffset(e,t){for(let n of this._getIntlSegmenterWordsOnLine(e))if(!(n.index<t))return n;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}},zP=new Hi(10);function Us(o,e){let t=`${o}/${e.join(",")}`,n=zP.get(t);return n||(n=new AT(o,e),zP.set(t,n)),n}function Gl(o,e){let t=Math.pow(10,e);return Math.round(o*t)/t}var qe=class{_rgbaBrand=void 0;r;g;b;a;constructor(e,t,n,i=1){this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,n))|0,this.a=Gl(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}},Kl=class o{_hslaBrand=void 0;h;s;l;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=Gl(Math.max(Math.min(1,t),0),3),this.l=Gl(Math.max(Math.min(1,n),0),3),this.a=Gl(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=e.a,s=Math.max(t,n,i),a=Math.min(t,n,i),l=0,d=0,c=(a+s)/2,u=s-a;if(u>0){switch(d=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),s){case t:l=(n-i)/u+(n<i?6:0);break;case n:l=(i-t)/u+2;break;case i:l=(t-n)/u+4;break}l*=60,l=Math.round(l)}return new o(l,d,c,r)}static _hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}static toRGBA(e){let t=e.h/360,{s:n,l:i,a:r}=e,s,a,l;if(n===0)s=a=l=i;else{let d=i<.5?i*(1+n):i+n-i*n,c=2*i-d;s=o._hue2rgb(c,d,t+1/3),a=o._hue2rgb(c,d,t),l=o._hue2rgb(c,d,t-1/3)}return new qe(Math.round(s*255),Math.round(a*255),Math.round(l*255),r)}},qu=class o{_hsvaBrand=void 0;h;s;v;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=Gl(Math.max(Math.min(1,t),0),3),this.v=Gl(Math.max(Math.min(1,n),0),3),this.a=Gl(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),a=r-s,l=r===0?0:a/r,d;return a===0?d=0:r===t?d=((n-i)/a%6+6)%6:r===n?d=(i-t)/a+2:d=(t-n)/a+4,new o(Math.round(d*60),l,r,e.a)}static toRGBA(e){let{h:t,s:n,v:i,a:r}=e,s=i*n,a=s*(1-Math.abs(t/60%2-1)),l=i-s,[d,c,u]=[0,0,0];return t<60?(d=s,c=a):t<120?(d=a,c=s):t<180?(c=s,u=a):t<240?(c=a,u=s):t<300?(d=a,u=s):t<=360&&(d=s,u=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),u=Math.round((u+l)*255),new qe(d,c,u,r)}},G=class o{static fromHex(e){return o.Format.CSS.parseHex(e)||o.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:Kl.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:qu.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof qe)this.rgba=e;else if(e instanceof Kl)this._hsla=e,this.rgba=Kl.toRGBA(e);else if(e instanceof qu)this._hsva=e,this.rgba=qu.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&qe.equals(this.rgba,e.rgba)&&Kl.equals(this.hsla,e.hsla)&&qu.equals(this.hsva,e.hsva)}getRelativeLuminance(){let e=o._relativeLuminanceForComponent(this.rgba.r),t=o._relativeLuminanceForComponent(this.rgba.g),n=o._relativeLuminanceForComponent(this.rgba.b),i=.2126*e+.7152*t+.0722*n;return Gl(i,4)}static _relativeLuminanceForComponent(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n}isDarkerThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t<n}lighten(e){return new o(new Kl(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new o(new Kl(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new qe(t,n,i,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new o(new qe(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){let t=e.rgba,n=this.rgba.a,i=t.a,r=n+i*(1-n);if(r<1e-6)return o.transparent;let s=this.rgba.r*n/r+t.r*i*(1-n)/r,a=this.rgba.g*n/r+t.g*i*(1-n)/r,l=this.rgba.b*n/r+t.b*i*(1-n)/r;return new o(new qe(s,a,l,r))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new qe(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-n),e.rgba.b-r*(e.rgba.b-i),1))}flatten(...e){let t=e.reduceRight((n,i)=>o._flatten(i,n));return o._flatten(this,t)}static _flatten(e,t){let n=1-e.rgba.a;return new o(new qe(n*t.rgba.r+e.rgba.a*e.rgba.r,n*t.rgba.g+e.rgba.a*e.rgba.g,n*t.rgba.b+e.rgba.a*e.rgba.b))}_toString;toString(){return this._toString||(this._toString=o.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,n){if(e.isLighterThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(r-i)/r,e.lighten(n)}static getDarkerColor(e,t,n){if(e.isDarkerThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(i-r)/i,e.darken(n)}static white=new o(new qe(255,255,255,1));static black=new o(new qe(0,0,0,1));static red=new o(new qe(255,0,0,1));static blue=new o(new qe(0,0,255,1));static green=new o(new qe(0,255,0,1));static cyan=new o(new qe(0,255,255,1));static lightgrey=new o(new qe(211,211,211,1));static transparent=new o(new qe(0,0,0,0))};(e=>{let o;(n=>{let t;(g=>{function i(f){return f.rgba.a===1?`rgb(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b})`:e.Format.CSS.formatRGBA(f)}g.formatRGB=i;function r(f){return`rgba(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b}, ${+f.rgba.a.toFixed(2)})`}g.formatRGBA=r;function s(f){return f.hsla.a===1?`hsl(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%)`:e.Format.CSS.formatHSLA(f)}g.formatHSL=s;function a(f){return`hsla(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%, ${f.hsla.a.toFixed(2)})`}g.formatHSLA=a;function l(f){let b=f.toString(16);return b.length!==2?"0"+b:b}function d(f){return`#${l(f.rgba.r)}${l(f.rgba.g)}${l(f.rgba.b)}`}g.formatHex=d;function c(f,b=!1){return b&&f.rgba.a===1?e.Format.CSS.formatHex(f):`#${l(f.rgba.r)}${l(f.rgba.g)}${l(f.rgba.b)}${l(Math.round(f.rgba.a*255))}`}g.formatHexA=c;function u(f){return f.isOpaque()?e.Format.CSS.formatHex(f):e.Format.CSS.formatRGBA(f)}g.format=u;function p(f){let b=f.length;if(b===0||f.charCodeAt(0)!==35)return null;if(b===7){let v=16*m(f.charCodeAt(1))+m(f.charCodeAt(2)),I=16*m(f.charCodeAt(3))+m(f.charCodeAt(4)),C=16*m(f.charCodeAt(5))+m(f.charCodeAt(6));return new e(new qe(v,I,C,1))}if(b===9){let v=16*m(f.charCodeAt(1))+m(f.charCodeAt(2)),I=16*m(f.charCodeAt(3))+m(f.charCodeAt(4)),C=16*m(f.charCodeAt(5))+m(f.charCodeAt(6)),S=16*m(f.charCodeAt(7))+m(f.charCodeAt(8));return new e(new qe(v,I,C,S/255))}if(b===4){let v=m(f.charCodeAt(1)),I=m(f.charCodeAt(2)),C=m(f.charCodeAt(3));return new e(new qe(16*v+v,16*I+I,16*C+C))}if(b===5){let v=m(f.charCodeAt(1)),I=m(f.charCodeAt(2)),C=m(f.charCodeAt(3)),S=m(f.charCodeAt(4));return new e(new qe(16*v+v,16*I+I,16*C+C,(16*S+S)/255))}return null}g.parseHex=p;function m(f){switch(f){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(t=n.CSS||={})})(o=e.Format||={})})(G||={});var Ua=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let o;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?o=crypto.getRandomValues.bind(crypto):o=function(n){for(let i=0;i<n.length;i++)n[i]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),t=[];for(let n=0;n<256;n++)t.push(n.toString(16).padStart(2,"0"));return function(){o(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=0,r="";return r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r}}();var $H=Object.freeze({create:o=>La(o.map(e=>e.toString())).join(`\r
`),split:o=>o.split(`\r
`),parse:o=>$H.split(o).filter(e=>!e.startsWith("#"))});var KP=class o{constructor(e){this.value=e}static sep=".";static None=new o("@@none@@");static Empty=new o("");equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+o.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new o((this.value?[this.value,...e]:e).join(o.sep))}};var ko=class{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let n="mtk"+this.getForeground(e),i=this.getFontStyle(e);return i&1&&(n+=" mtki"),i&2&&(n+=" mtkb"),i&4&&(n+=" mtku"),i&8&&(n+=" mtks"),n}static getInlineStyleFromMetadata(e,t){let n=this.getForeground(e),i=this.getFontStyle(e),r=`color: ${t[n]};`;i&1&&(r+="font-style: italic;"),i&2&&(r+="font-weight: bold;");let s="";return i&4&&(s+=" underline"),i&8&&(s+=" line-through"),s&&(r+=`text-decoration:${s};`),r}static getPresentationFromMetadata(e){let t=this.getForeground(e),n=this.getFontStyle(e);return{foreground:t,italic:!!(n&1),bold:!!(n&2),underline:!!(n&4),strikethrough:!!(n&8)}}};var ny="**",GP="/",iy="[/\\\\]",oy="[^/\\\\]",jH=/\//g;function $P(o,e){switch(o){case 0:return"";case 1:return`${oy}*?`;default:return`(?:${iy}|${oy}+${iy}${e?`|${iy}${oy}+`:""})*?`}}function jP(o,e){if(!o)return[];let t=[],n=!1,i=!1,r="";for(let s of o){switch(s){case e:if(!n&&!i){t.push(r),r="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":i=!0;break;case"]":i=!1;break}r+=s}return r&&t.push(r),t}function XP(o){if(!o)return"";let e="",t=jP(o,GP);if(t.every(n=>n===ny))e=".*";else{let n=!1;t.forEach((i,r)=>{if(i===ny){if(n)return;e+=$P(2,r===t.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of i){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let u;c==="-"?u=c:(c==="^"||c==="!")&&!d?u="^":c===GP?u="":u=Ui(c),d+=u;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let p=`(?:${jP(a,",").map(m=>XP(m)).join("|")})`;e+=p,s=!1,a="";break}case"]":{e+="["+d+"]",l=!1,d="";break}case"?":e+=oy;continue;case"*":e+=$P(1);continue;default:e+=Ui(c)}}r<t.length-1&&(t[r+1]!==ny||r+2<t.length)&&(e+=iy)}n=i===ny})}return e}var qH=/^\*\*\/\*\.[\w\.-]+$/,YH=/^\*\*\/([\w\.-]+)\/?$/,QH=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,ZH=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,XH=/^\*\*((\/[\w\.-]+)+)\/?$/,JH=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,qP=new Hi(1e4),YP=function(){return!1},zs=function(){return null};function OT(o,e){if(!o)return zs;let t;typeof o!="string"?t=o.pattern:t=o,t=t.trim();let n=`${t}_${!!e.trimForExclusions}`,i=qP.get(n);if(i)return QP(i,o);let r;return qH.test(t)?i=e4(t.substr(4),t):(r=YH.exec(NT(t,e)))?i=t4(r[1],t):(e.trimForExclusions?ZH:QH).test(t)?i=n4(t,e):(r=XH.exec(NT(t,e)))?i=ZP(r[1].substr(1),t,!0):(r=JH.exec(NT(t,e)))?i=ZP(r[1],t,!1):i=i4(t),qP.set(n,i),QP(i,o)}function QP(o,e){if(typeof e=="string")return o;let t=function(n,i){return Fm(n,e.base,!Gt)?o(cv(n.substr(e.base.length),oo),i):null};return t.allBasenames=o.allBasenames,t.allPaths=o.allPaths,t.basenames=o.basenames,t.patterns=o.patterns,t}function NT(o,e){return e.trimForExclusions&&o.endsWith("/**")?o.substr(0,o.length-2):o}function e4(o,e){return function(t,n){return typeof t=="string"&&t.endsWith(o)?e:null}}function t4(o,e){let t=`/${o}`,n=`\\${o}`,i=function(s,a){return typeof s!="string"?null:a?a===o?e:null:s===o||s.endsWith(t)||s.endsWith(n)?e:null},r=[o];return i.basenames=r,i.patterns=[e],i.allBasenames=r,i}function n4(o,e){let t=JP(o.slice(1,-1).split(",").map(a=>OT(a,e)).filter(a=>a!==zs),o),n=t.length;if(!n)return zs;if(n===1)return t[0];let i=function(a,l){for(let d=0,c=t.length;d<c;d++)if(t[d](a,l))return o;return null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function ZP(o,e,t){let n=oo===gt.sep,i=n?o:o.replace(jH,oo),r=oo+i,s=gt.sep+o,a;return t?a=function(l,d){return typeof l=="string"&&(l===i||l.endsWith(r)||!n&&(l===o||l.endsWith(s)))?e:null}:a=function(l,d){return typeof l=="string"&&(l===i||!n&&l===o)?e:null},a.allPaths=[(t?"*/":"./")+o],a}function i4(o){try{let e=new RegExp(`^${XP(o)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?o:null}}catch{return zs}}function FT(o,e={}){if(!o)return YP;if(typeof o=="string"||o4(o)){let t=OT(o,e);if(t===zs)return YP;let n=function(i,r){return!!t(i,r)};return t.allBasenames&&(n.allBasenames=t.allBasenames),t.allPaths&&(n.allPaths=t.allPaths),n}return r4(o,e)}function o4(o){let e=o;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function r4(o,e){let t=JP(Object.getOwnPropertyNames(o).map(a=>s4(a,o[a],e)).filter(a=>a!==zs)),n=t.length;if(!n)return zs;if(!t.some(a=>!!a.requiresSiblings)){if(n===1)return t[0];let a=function(c,u){let p;for(let m=0,g=t.length;m<g;m++){let f=t[m](c,u);if(typeof f=="string")return f;Nv(f)&&(p||(p=[]),p.push(f))}return p?(async()=>{for(let m of p){let g=await m;if(typeof g=="string")return g}return null})():null},l=t.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=t.reduce((c,u)=>u.allPaths?c.concat(u.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let i=function(a,l,d){let c,u;for(let p=0,m=t.length;p<m;p++){let g=t[p];g.requiresSiblings&&d&&(l||(l=Rs(a)),c||(c=l.substr(0,l.length-ev(a).length)));let f=g(a,l,c,d);if(typeof f=="string")return f;Nv(f)&&(u||(u=[]),u.push(f))}return u?(async()=>{for(let p of u){let m=await p;if(typeof m=="string")return m}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function s4(o,e,t){if(e===!1)return zs;let n=OT(o,t);if(n===zs)return zs;if(typeof e=="boolean")return n;if(e){let i=e.when;if(typeof i=="string"){let r=(s,a,l,d)=>{if(!d||!n(s,a))return null;let c=i.replace("$(basename)",()=>l),u=d(c);return Nv(u)?u.then(p=>p?o:null):u?o:null};return r.requiresSiblings=!0,r}}return n}function JP(o,e){let t=o.filter(a=>!!a.basenames);if(t.length<2)return o;let n=t.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),i;if(e){i=[];for(let a=0,l=n.length;a<l;a++)i.push(e)}else i=t.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let r=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let u=a.charCodeAt(c-1);if(u===47||u===92)break}l=a.substr(c)}let d=n.indexOf(l);return d!==-1?i[d]:null};r.basenames=n,r.patterns=i,r.allBasenames=n;let s=o.filter(a=>!a.basenames);return s.push(r),s}var pg=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new L;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),ge(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let n=new BT(this,e,t);return this._factories.set(e,n),ge(()=>{let i=this._factories.get(e);!i||i!==n||(this._factories.delete(e),i.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;let n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},BT=class extends W{constructor(t,n,i){super();this._registry=t;this._languageId=n;this._factory=i}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}};function co(o){let e=0,t=0,n=0,i=0;for(let r=0,s=o.length;r<s;r++){let a=o.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<s&&o.charCodeAt(r+1)===10?(i|=2,r++):i|=3,n=r+1):a===10&&(i|=1,e===0&&(t=r),e++,n=r+1)}return e===0&&(t=o.length),[e,t,o.length-n,i]}var Et=class o{constructor(e,t){this.start=e;this.endExclusive=t;if(e>t)throw new Ke(`Invalid range: ${this.toString()}`)}static addRange(e,t){let n=0;for(;n<t.length&&t[n].endExclusive<e.start;)n++;let i=n;for(;i<t.length&&t[i].start<=e.endExclusive;)i++;if(n===i)t.splice(n,0,e);else{let r=Math.min(e.start,t[n].start),s=Math.max(e.endExclusive,t[i-1].endExclusive);t.splice(n,i-n,new o(r,s))}}static tryCreate(e,t){if(!(e>t))return new o(e,t)}static ofLength(e){return new o(0,e)}static ofStartAndLength(e,t){return new o(e,e+t)}static emptyAt(e){return new o(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new o(this.start+e,this.endExclusive+e)}deltaStart(e){return new o(this.start+e,this.endExclusive)}deltaEnd(e){return new o(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new o(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(t<=n)return new o(t,n)}intersectionLength(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-t)}intersects(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<n}intersectsOrTouches(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Ke(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Ke(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let n=this.start;n<this.endExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}};var WT=class o{constructor(e){this._tokenInfo=e}static create(e){return new o(e)}forEach(e){let t=0;for(let n of this._tokenInfo){let i=new Et(t,t+n.length);e(i,n),t+=n.length}}slice(e){let t=[],n=0;for(let i of this._tokenInfo){let r=n,s=r+i.length;if(s>e.start){if(r>=e.endExclusive)break;let a=Math.max(0,e.start-r),l=Math.max(0,s-e.endExclusive);t.push(new ry(i.length-a-l,i.metadata))}n+=i.length}return o.create(t)}},ry=class{constructor(e,t){this.length=e;this.metadata=t}},sy=class{_tokens=[];add(e,t){this._tokens.push(new ry(e,t))}build(){return WT.create(this._tokens)}};var qt=class o{static createEmpty(e,t){let n=o.defaultTokenMetadata,i=new Uint32Array(2);return i[0]=e.length,i[1]=n,new o(i,e,t)}static createFromTextAndMetadata(e,t){let n=0,i="",r=new Array;for(let{text:s,metadata:a}of e)r.push(n+s.length,a),n+=s.length,i+=s;return new o(new Uint32Array(r),i,t)}static convertToEndOffset(e,t){let i=(e.length>>>1)-1;for(let r=0;r<i;r++)e[r<<1]=e[r+1<<1];e[i<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){let r=n+Math.floor((i-n)/2),s=e[r<<1];if(s===t)return r+1;s<t?n=r+1:s>t&&(i=r)}return n}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(e,t,n){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=n}equals(e){return e instanceof o?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,n){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let i=t<<1,r=i+(n<<1);for(let s=i;s<r;s++)if(this._tokens[s]!==e._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let t=this._tokens[(e<<1)+1],n=ko.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(n)}getStandardTokenType(e){let t=this._tokens[(e<<1)+1];return ko.getTokenType(t)}getForeground(e){let t=this._tokens[(e<<1)+1];return ko.getForeground(t)}getClassName(e){let t=this._tokens[(e<<1)+1];return ko.getClassNameFromMetadata(t)}getInlineStyle(e,t){let n=this._tokens[(e<<1)+1];return ko.getInlineStyleFromMetadata(n,t)}getPresentation(e){let t=this._tokens[(e<<1)+1];return ko.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return o.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new VT(this,e,t,n)}withInserted(e){if(e.length===0)return this;let t=0,n=0,i="",r=new Array,s=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=n<e.length?e[n]:null;if(a!==-1&&(l===null||a<=l.offset)){i+=this._text.substring(s,a);let d=this._tokens[(t<<1)+1];r.push(i.length,d),t++,s=a}else if(l){if(l.offset>s){i+=this._text.substring(s,l.offset);let d=this._tokens[(t<<1)+1];r.push(i.length,d),s=l.offset}i+=l.text,r.push(i.length,l.tokenMetadata),n++}else break}return new o(new Uint32Array(r),i,this.languageIdCodec)}getTokensInRange(e){let t=new sy,n=this.findTokenIndexAtOffset(e.start),i=this.findTokenIndexAtOffset(e.endExclusive);for(let r=n;r<=i;r++){let a=new Et(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(r))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),n=this.getEndOffset(e);return this._text.substring(t,n)}forEach(e){let t=this.getCount();for(let n=0;n<t;n++)e(n)}},VT=class o{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,s=e.getCount();r<s&&!(e.getStartOffset(r)>=n);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof o?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,n=this._source.getStartOffset(t),i=this._source.getEndOffset(t),r=this._source.getTokenText(t);return n<this._startOffset&&(r=r.substring(this._startOffset-n)),i>this._endOffset&&(r=r.substring(0,r.length-(i-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}};var Ks=new Uint32Array(0).buffer,Yn=class o{static deleteBeginning(e,t){return e===null||e===Ks?e:o.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===Ks)return e;let n=Gs(e),i=n[n.length-2];return o.delete(e,t,i)}static delete(e,t,n){if(e===null||e===Ks||t===n)return e;let i=Gs(e),r=i.length>>>1;if(t===0&&i[i.length-2]===n)return Ks;let s=qt.findIndexInTokensArray(i,t),a=s>0?i[s-1<<1]:0,l=i[s<<1];if(n<l){let m=n-t;for(let g=s;g<r;g++)i[g<<1]-=m;return e}let d,c;a!==t?(i[s<<1]=t,d=s+1<<1,c=t):(d=s<<1,c=a);let u=n-t;for(let m=s+1;m<r;m++){let g=i[m<<1]-u;g>c&&(i[d++]=g,i[d++]=i[(m<<1)+1],c=g)}if(d===i.length)return e;let p=new Uint32Array(d);return p.set(i.subarray(0,d),0),p.buffer}static append(e,t){if(t===Ks)return e;if(e===Ks)return t;if(e===null)return e;if(t===null)return null;let n=Gs(e),i=Gs(t),r=i.length>>>1,s=new Uint32Array(n.length+i.length);s.set(n,0);let a=n.length,l=n[n.length-2];for(let d=0;d<r;d++)s[a++]=i[d<<1]+l,s[a++]=i[(d<<1)+1];return s.buffer}static insert(e,t,n){if(e===null||e===Ks)return e;let i=Gs(e),r=i.length>>>1,s=qt.findIndexInTokensArray(i,t);s>0&&i[s-1<<1]===t&&s--;for(let a=s;a<r;a++)i[a<<1]+=n;return e}};function Gs(o){return o instanceof Uint32Array?o:new Uint32Array(o)}var Mi=class o{static fromRange(e){return new o(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new o(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(e.startLineNumber,t.startLineNumber),new o(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new o(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new ay(e[0].slice());for(let n=1;n<e.length;n++)t=t.getUnion(new ay(e[n].slice()));return t.ranges}static join(e){if(e.length===0)throw new Ke("lineRanges cannot be empty");let t=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let i=1;i<e.length;i++)t=Math.min(t,e[i].startLineNumber),n=Math.max(n,e[i].endLineNumberExclusive);return new o(t,n)}static ofLength(e,t){return new o(e,e+t)}static deserialize(e){return new o(e[0],e[1])}startLineNumber;endLineNumberExclusive;constructor(e,t){if(e>t)throw new Ke(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new o(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new o(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new o(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=n)return new o(t,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new w(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new w(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new Et(this.startLineNumber-1,this.endLineNumberExclusive-1)}},ay=class o{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=Sb(this._normalizedRanges,i=>i.endLineNumberExclusive>=e.startLineNumber),n=bu(this._normalizedRanges,i=>i.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)this._normalizedRanges.splice(t,0,e);else if(t===n-1){let i=this._normalizedRanges[t];this._normalizedRanges[t]=i.join(e)}else{let i=this._normalizedRanges[t].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(t,n-t,i)}}contains(e){let t=ow(this._normalizedRanges,n=>n.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=ow(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],n=0,i=0,r=null;for(;n<this._normalizedRanges.length||i<e._normalizedRanges.length;){let s=null;if(n<this._normalizedRanges.length&&i<e._normalizedRanges.length){let a=this._normalizedRanges[n],l=e._normalizedRanges[i];a.startLineNumber<l.startLineNumber?(s=a,n++):(s=l,i++)}else n<this._normalizedRanges.length?(s=this._normalizedRanges[n],n++):(s=e._normalizedRanges[i],i++);r===null?r=s:r.endLineNumberExclusive>=s.startLineNumber?r=new Mi(r.startLineNumber,Math.max(r.endLineNumberExclusive,s.endLineNumberExclusive)):(t.push(r),r=s)}return r!==null&&t.push(r),new o(t)}subtractFrom(e){let t=Sb(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),n=bu(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)return new o([e]);let i=[],r=e.startLineNumber;for(let s=t;s<n;s++){let a=this._normalizedRanges[s];a.startLineNumber>r&&i.push(new Mi(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&i.push(new Mi(r,e.endLineNumberExclusive)),new o(i)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],n=0,i=0;for(;n<this._normalizedRanges.length&&i<e._normalizedRanges.length;){let r=this._normalizedRanges[n],s=e._normalizedRanges[i],a=r.intersect(s);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<s.endLineNumberExclusive?n++:i++}return new o(t)}getWithDelta(e){return new o(this._normalizedRanges.map(t=>t.delta(e)))}};var hg=class o{static deserialize(e,t,n){let i=new Uint32Array(e.buffer),r=jn(e,t);t+=4;let s=jn(e,t);t+=4;let a=[];for(let l=0;l<s;l++){let d=jn(e,t);t+=4,a.push(i.subarray(t/4,t/4+d/4)),t+=d}return n.push(new o(r,a)),t}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new Mi(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e=0;e+=4,e+=4;for(let t=0;t<this._tokens.length;t++){let n=this._tokens[t];if(!(n instanceof Uint32Array))throw new Error("Not supported!");e+=4,e+=n.byteLength}return e}serialize(e,t){qn(e,this._startLineNumber,t),t+=4,qn(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++){let i=this._tokens[n];if(!(i instanceof Uint32Array))throw new Error("Not supported!");qn(e,i.byteLength,t),t+=4,e.set(new Uint8Array(i.buffer),t),t+=i.byteLength}return t}applyEdit(e,t){let[n,i]=co(t);this._acceptDeleteRange(e),this._acceptInsertText(new R(e.startLineNumber,e.startColumn),n,i)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let i=n-t;this._startLineNumber-=i;return}if(!(t>=this._tokens.length)){if(t<0&&n>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===n){this._tokens[t]=Yn.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=Yn.deleteEnding(this._tokens[t],e.startColumn-1),n<this._tokens.length){let i=Yn.deleteBeginning(this._tokens[n],e.endColumn-1);this._tokens[t]=Yn.append(this._tokens[t],i),this._tokens.splice(t+1,n-t)}else this._tokens[t]=Yn.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else{let i=-t;this._startLineNumber-=i,this._tokens[n]=Yn.deleteBeginning(this._tokens[n],e.endColumn-1),this._tokens=this._tokens.slice(n)}}}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-this._startLineNumber;if(i<0){this._startLineNumber+=t;return}if(!(i>=this._tokens.length)){if(t===0){this._tokens[i]=Yn.insert(this._tokens[i],e.column-1,n);return}this._tokens[i]=Yn.deleteEnding(this._tokens[i],e.column-1),this._tokens[i]=Yn.insert(this._tokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._tokens=Ls(this._tokens,e,n)}};var ly=(i=>(i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i))(ly||{});(a=>{let o="error",e="warning",t="warn",n="info",i="ignore";function r(l){return l?fr(o,l)?3:fr(e,l)||fr(t,l)?2:fr(n,l)?1:0:0}a.fromValue=r;function s(l){switch(l){case 3:return o;case 2:return e;case 1:return n;default:return i}}a.toString=s})(ly||={});var ir=ly;var ZZ=Y("IBuiltinExtensionsScannerService");var mg=(i=>(i[i.Hint=1]="Hint",i[i.Info=2]="Info",i[i.Warning=4]="Warning",i[i.Error=8]="Error",i))(mg||{});(r=>{function o(s,a){return a-s}r.compare=o;let e=Object.create(null);e[8]=h("sev.error","Error"),e[4]=h("sev.warning","Warning"),e[2]=h("sev.info","Info");function t(s){return e[s]||""}r.toString=t;function n(s){switch(s){case ir.Error:return 8;case ir.Warning:return 4;case ir.Info:return 2;case ir.Ignore:return 1}}r.fromSeverity=n;function i(s){switch(s){case 8:return ir.Error;case 4:return ir.Warning;case 2:return ir.Info;case 1:return ir.Ignore}}r.toSeverity=i})(mg||={});var a4;(n=>{let o="";function e(i){return t(i,!0)}n.makeKey=e;function t(i,r){let s=[o];return i.source?s.push(i.source.replace("\xA6","\\\xA6")):s.push(o),i.code?typeof i.code=="string"?s.push(i.code.replace("\xA6","\\\xA6")):s.push(i.code.value.replace("\xA6","\\\xA6")):s.push(o),i.severity!==void 0&&i.severity!==null?s.push(mg.toString(i.severity)):s.push(o),i.message&&r?s.push(i.message.replace("\xA6","\\\xA6")):s.push(o),i.startLineNumber!==void 0&&i.startLineNumber!==null?s.push(i.startLineNumber.toString()):s.push(o),i.startColumn!==void 0&&i.startColumn!==null?s.push(i.startColumn.toString()):s.push(o),i.endLineNumber!==void 0&&i.endLineNumber!==null?s.push(i.endLineNumber.toString()):s.push(o),i.endColumn!==void 0&&i.endColumn!==null?s.push(i.endColumn.toString()):s.push(o),s.push(o),s.join("\xA6")}n.makeKeyOptionalMessage=t})(a4||={});var tA=Y("markerService");var dy=class{constructor(e,t){this.tokens=e;this.endState=t}_encodedTokenizationResultBrand=void 0};var Yu;(i=>{let o=new Map;o.set(0,le.symbolMethod),o.set(1,le.symbolFunction),o.set(2,le.symbolConstructor),o.set(3,le.symbolField),o.set(4,le.symbolVariable),o.set(5,le.symbolClass),o.set(6,le.symbolStruct),o.set(7,le.symbolInterface),o.set(8,le.symbolModule),o.set(9,le.symbolProperty),o.set(10,le.symbolEvent),o.set(11,le.symbolOperator),o.set(12,le.symbolUnit),o.set(13,le.symbolValue),o.set(15,le.symbolEnum),o.set(14,le.symbolConstant),o.set(15,le.symbolEnum),o.set(16,le.symbolEnumMember),o.set(17,le.symbolKeyword),o.set(27,le.symbolSnippet),o.set(18,le.symbolText),o.set(19,le.symbolColor),o.set(20,le.symbolFile),o.set(21,le.symbolReference),o.set(22,le.symbolCustomColor),o.set(23,le.symbolFolder),o.set(24,le.symbolTypeParameter),o.set(25,le.account),o.set(26,le.issues);function e(r){let s=o.get(r);return s||(console.info("No codicon found for CompletionItemKind "+r),s=le.symbolProperty),s}i.toIcon=e;let t=new Map;t.set("method",0),t.set("function",1),t.set("constructor",2),t.set("field",3),t.set("variable",4),t.set("class",5),t.set("struct",6),t.set("interface",7),t.set("module",8),t.set("property",9),t.set("event",10),t.set("operator",11),t.set("unit",12),t.set("value",13),t.set("constant",14),t.set("enum",15),t.set("enum-member",16),t.set("enumMember",16),t.set("keyword",17),t.set("snippet",27),t.set("text",18),t.set("color",19),t.set("file",20),t.set("reference",21),t.set("customcolor",22),t.set("folder",23),t.set("type-parameter",24),t.set("typeParameter",24),t.set("account",25),t.set("issue",26);function n(r,s){let a=t.get(r);return typeof a>"u"&&!s&&(a=9),a}i.fromString=n})(Yu||={});var cy=class{constructor(e,t,n,i){this.range=e;this.text=t;this.completionKind=n;this.isSnippetText=i}equals(e){return w.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}};var QX={17:h("Array","array"),16:h("Boolean","boolean"),4:h("Class","class"),13:h("Constant","constant"),8:h("Constructor","constructor"),9:h("Enum","enumeration"),21:h("EnumMember","enumeration member"),23:h("Event","event"),7:h("Field","field"),0:h("File","file"),11:h("Function","function"),10:h("Interface","interface"),19:h("Key","key"),5:h("Method","method"),1:h("Module","module"),2:h("Namespace","namespace"),20:h("Null","null"),15:h("Number","number"),18:h("Object","object"),24:h("Operator","operator"),3:h("Package","package"),6:h("Property","property"),14:h("String","string"),22:h("Struct","struct"),25:h("TypeParameter","type parameter"),12:h("Variable","variable")};var l4;(t=>{let o=new Map;o.set(0,le.symbolFile),o.set(1,le.symbolModule),o.set(2,le.symbolNamespace),o.set(3,le.symbolPackage),o.set(4,le.symbolClass),o.set(5,le.symbolMethod),o.set(6,le.symbolProperty),o.set(7,le.symbolField),o.set(8,le.symbolConstructor),o.set(9,le.symbolEnum),o.set(10,le.symbolInterface),o.set(11,le.symbolFunction),o.set(12,le.symbolVariable),o.set(13,le.symbolConstant),o.set(14,le.symbolString),o.set(15,le.symbolNumber),o.set(16,le.symbolBoolean),o.set(17,le.symbolArray),o.set(18,le.symbolObject),o.set(19,le.symbolKey),o.set(20,le.symbolNull),o.set(21,le.symbolEnumMember),o.set(22,le.symbolStruct),o.set(23,le.symbolEvent),o.set(24,le.symbolOperator),o.set(25,le.symbolTypeParameter);function e(n){let i=o.get(n);return i||(console.info("No codicon found for SymbolKind "+n),i=le.symbolProperty),i}t.toIcon=e})(l4||={});var nA=class o{constructor(e){this.value=e}static Comment=new o("comment");static Imports=new o("imports");static Region=new o("region");static fromValue(e){switch(e){case"comment":return o.Comment;case"imports":return o.Imports;case"region":return o.Region}return new o(e)}};var d4;(e=>{function o(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}e.is=o})(d4||={});var uo=new pg,gg=new pg;var Ki=Y("languageService");function js(o,e){let t=o.getCount(),n=o.findTokenIndexAtOffset(e),i=o.getLanguageId(n),r=n;for(;r+1<t&&o.getLanguageId(r+1)===i;)r++;let s=n;for(;s>0&&o.getLanguageId(s-1)===i;)s--;return new UT(o,i,s,r+1,o.getStartOffset(s),o.getEndOffset(r))}var UT=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(e,t,n,i,r,s){this._actual=e,this.languageId=t,this._firstTokenIndex=n,this._lastTokenIndex=i,this.firstCharOffset=r,this._lastCharOffset=s,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},iA=(e=>(e[e.value=3]="value",e))(iA||{});function yr(o){return(o&iA.value)!==0}var Qu=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(e){if(this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,n=e.notIn.length;t<n;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;let n=e.findTokenIndexAtOffset(t-2),i=e.getStandardTokenType(n);return this.isOK(i)}_findNeutralCharacterInRange(e,t){for(let n=e;n<=t;n++){let i=String.fromCharCode(n);if(!this.open.includes(i)&&!this.close.includes(i))return i}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},uy=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let t of e)fg(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),fg(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),fg(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),fg(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&fg(this.autoClosingPairsCloseSingleChar,t.close,t)}};function fg(o,e,t){o.has(e)?o.get(e).push(t):o.set(e,[t])}var zT=class o{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(e,t,n,i,r,s){this.languageId=e,this.index=t,this.open=n,this.close=i,this.forwardRegex=r,this.reversedRegex=s,this._openSet=o._toSet(this.open),this._closeSet=o._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){let t=new Set;for(let n of e)t.add(n);return t}};function u4(o){let e=o.length;o=o.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let t=[];for(let s=0;s<e;s++)t[s]=s;let n=(s,a)=>{let[l,d]=s,[c,u]=a;return l===c||l===u||d===c||d===u},i=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<e;c++)t[c]===d&&(t[c]=l)};for(let s=0;s<e;s++){let a=o[s];for(let l=s+1;l<e;l++){let d=o[l];n(a,d)&&i(t[s],t[l])}}let r=[];for(let s=0;s<e;s++){let a=[],l=[];for(let d=0;d<e;d++)if(t[d]===s){let[c,u]=o[d];a.push(c),l.push(u)}a.length>0&&r.push({open:a,close:l})}return r}var py=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(e,t){let n=u4(t);this.brackets=n.map((i,r)=>new zT(e,r,i.open,i.close,p4(i.open,i.close,n,r),h4(i.open,i.close,n,r))),this.forwardRegex=m4(this.brackets),this.reversedRegex=g4(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let i of this.brackets){for(let r of i.open)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(let r of i.close)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}};function oA(o,e,t,n){for(let i=0,r=e.length;i<r;i++){if(i===t)continue;let s=e[i];for(let a of s.open)a.indexOf(o)>=0&&n.push(a);for(let a of s.close)a.indexOf(o)>=0&&n.push(a)}}function rA(o,e){return o.length-e.length}function hy(o){if(o.length<=1)return o;let e=[],t=new Set;for(let n of o)t.has(n)||(e.push(n),t.add(n));return e}function p4(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)oA(i[r],t,n,i);return i=hy(i),i.sort(rA),i.reverse(),Zu(i)}function h4(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)oA(i[r],t,n,i);return i=hy(i),i.sort(rA),i.reverse(),Zu(i.map(KT))}function m4(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=hy(e),Zu(e)}function g4(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=hy(e),Zu(e.map(KT))}function f4(o){let e=/^[\w ]+$/.test(o);return o=Ui(o),e?`\\b${o}\\b`:o}function Zu(o,e){let t=`(${o.map(f4).join(")|(")})`;return uv(t,!0,e)}var KT=function(){function o(n){let i=new Uint16Array(n.length),r=0;for(let s=n.length-1;s>=0;s--)i[r++]=n.charCodeAt(s);return MT().decode(i)}let e=null,t=null;return function(i){return e!==i&&(e=i,t=o(e)),t}}(),Gi=class{static _findPrevBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=n.length-(r.index||0),a=r[0].length,l=i+s;return new w(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,n,i,r){let a=KT(n).substring(n.length-r,n.length-i);return this._findPrevBracketInText(e,t,a,i)}static findNextBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=r.index||0,a=r[0].length;if(a===0)return null;let l=i+s;return new w(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,n,i,r){let s=n.substring(i,r);return this.findNextBracketInText(e,t,s,i)}};var my=class{constructor(e,t){this.languageId=e;let n=t.brackets?sA(t.brackets):[],i=new Pl(a=>{let l=new Set;return{info:new GT(this,a,l),closing:l}}),r=new Pl(a=>{let l=new Set,d=new Set;return{info:new $T(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of n){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=t.colorizedBracketPairs?sA(t.colorizedBracketPairs):n.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...i.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){let t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return Zu(t,e)}};function sA(o){return o.filter(([e,t])=>e!==""&&t!=="")}var gy=class{constructor(e,t){this.config=e;this.bracketText=t}get languageId(){return this.config.languageId}},GT=class extends gy{constructor(t,n,i){super(t,n);this.openedBrackets=i}isOpeningBracket=!0},$T=class extends gy{constructor(t,n,i,r){super(t,n);this.openingBrackets=i;this.openingColorizedBrackets=r}isOpeningBracket=!1;closes(t){return t.config!==this.config?!1:this.openingBrackets.has(t)}closesColorized(t){return t.config!==this.config?!1:this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}};var St=class o{static _nextVisibleColumn(e,t,n){return e===9?o.nextRenderTabStop(t,n):Xo(e)||Om(e)?t+2:t+1}static visibleColumnFromColumn(e,t,n){let i=Math.min(t-1,e.length),r=e.substring(0,i),s=new jd(r),a=0;for(;!s.eol();){let l=Nu(r,i,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,n)}return a}static toStatusbarColumn(e,t,n){let i=e.substring(0,Math.min(t-1,e.length)),r=new $d(i),s=0;for(;!r.eol();)r.nextCodePoint()===9?s=o.nextRenderTabStop(s,n):s=s+1;return s+1}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;let i=e.length,r=new jd(e),s=0,a=1;for(;!r.eol();){let l=Nu(e,i,r.offset);r.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,n),c=r.offset+1;if(d>=t){let u=t-s;return d-t<u?c:a}s=d,a=c}return i+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}};var Pi=class o{constructor(e,t){this.lineCount=e;this.columnCount=t}static zero=new o(0,0);static lengthDiffNonNegative(e,t){return t.isLessThan(e)?o.zero:e.lineCount===t.lineCount?new o(0,t.columnCount-e.columnCount):new o(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new o(0,t.column-e.column):new o(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return o.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,n=0;for(let i of e)i===`
`?(t++,n=0):n++;return new o(t,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new o(this.lineCount,this.columnCount+e.columnCount):new o(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new w(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new w(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new w(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new R(e.lineNumber,e.column+this.columnCount):new R(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};function aA(o,e,t,n){return o!==t?Ft(t-o,n):Ft(0,n-e)}var Cn=0;function Xu(o){return o===0}var Do=2**26;function Ft(o,e){return o*Do+e}function Ai(o){let e=o,t=Math.floor(e/Do),n=e-t*Do;return new Pi(t,n)}function lA(o){return Math.floor(o/Do)}function bt(o,e){let t=o+e;return e>=Do&&(t=t-o%Do),t}function dA(o,e){return o.reduce((t,n)=>bt(t,e(n)),Cn)}function jT(o,e){return o===e}function hc(o,e){let t=o,n=e;if(n-t<=0)return Cn;let r=Math.floor(t/Do),s=Math.floor(n/Do),a=n-s*Do;if(r===s){let l=t-r*Do;return Ft(0,a-l)}else return Ft(s-r,a)}function za(o,e){return o<e}function $l(o,e){return o<=e}function Ju(o,e){return o>=e}function jl(o){return Ft(o.lineNumber-1,o.column-1)}function ql(o,e){let t=o,n=Math.floor(t/Do),i=t-n*Do,r=e,s=Math.floor(r/Do),a=r-s*Do;return new w(n+1,i+1,s+1,a+1)}function cA(o){let e=Fr(o);return Ft(e.length-1,e[e.length-1].length)}var fy=[],ri=class o{constructor(e,t){this.items=e;this.additionalItems=t}static cache=new Array(129);static create(e,t){if(e<=128&&t.length===0){let n=o.cache[e];return n||(n=new o(e,t),o.cache[e]=n),n}return new o(e,t)}static empty=o.create(0,fy);static getEmpty(){return this.empty}add(e,t){let n=t.getKey(e),i=n>>5;if(i===0){let s=1<<n|this.items;return s===this.items?this:o.create(s,this.additionalItems)}i--;let r=this.additionalItems.slice(0);for(;r.length<i;)r.push(0);return r[i]|=1<<(n&31),o.create(this.items,r)}has(e,t){let n=t.getKey(e),i=n>>5;return i===0?(this.items&1<<n)!==0:(i--,((this.additionalItems[i]||0)&1<<(n&31))!==0)}merge(e){let t=this.items|e.items;if(this.additionalItems===fy&&e.additionalItems===fy)return t===this.items?this:t===e.items?e:o.create(t,fy);let n=[];for(let i=0;i<Math.max(this.additionalItems.length,e.additionalItems.length);i++){let r=this.additionalItems[i]||0,s=e.additionalItems[i]||0;n.push(r|s)}return o.create(t,n)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}equals(e){if(this.items!==e.items||this.additionalItems.length!==e.additionalItems.length)return!1;for(let t=0;t<this.additionalItems.length;t++)if(this.additionalItems[t]!==e.additionalItems[t])return!1;return!0}},qT={getKey(o){return o}},ep=class{items=new Map;getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}reverseLookup(e){return[...this.items].find(([t,n])=>n===e)?.[0]}reverseLookupSet(e){let t=[];for(let[n]of this.items)e.has(n,this)&&t.push(n);return t}keys(){return this.items.keys()}};var by=class o{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new Qu(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new Qu({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){let t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new Qu({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var vy=class{_richEditBrackets;constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(let t of this._richEditBrackets.brackets)for(let n of t.close){let i=n.charAt(n.length-1);e.push(i)}return La(e)}onElectricCharacter(e,t,n){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let i=t.findTokenIndexAtOffset(n-1);if(yr(t.getStandardTokenType(i)))return null;let r=this._richEditBrackets.reversedRegex,s=t.getLineContent().substring(0,n-1)+e,a=Gi.findPrevBracketInRange(r,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function yy(o){return o.global&&(o.lastIndex=0),!0}var Iy=class{_indentationRules;constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&yy(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&yy(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&yy(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&yy(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}};var Cy=class o{_brackets;_regExpRules;constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{let n=o._createOpenBracketRegExp(t[0]),i=o._createCloseBracketRegExp(t[1]);n&&i&&this._brackets.push({open:t[0],openRegExp:n,close:t[1],closeRegExp:i})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,n,i){if(e>=3)for(let r=0,s=this._regExpRules.length;r<s;r++){let a=this._regExpRules[r];if([{reg:a.beforeText,text:n},{reg:a.afterText,text:i},{reg:a.previousLineText,text:t}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(e>=2&&n.length>0&&i.length>0)for(let r=0,s=this._brackets.length;r<s;r++){let a=this._brackets[r];if(a.openRegExp.test(n)&&a.closeRegExp.test(i))return{indentAction:2}}if(e>=2&&n.length>0){for(let r=0,s=this._brackets.length;r<s;r++)if(this._brackets[r].openRegExp.test(n))return{indentAction:1}}return null}static _createOpenBracketRegExp(e){let t=Ui(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",o._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Ui(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,o._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return Ue(t),null}}};var b4=[];function $i(o,e,t){e instanceof Dm||(e=new Dm(e,[],!!t)),b4.push([o,e])}var mc=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});var v4={ModesRegistry:"editor.modesRegistry"},QT=class{_languages;_onDidChangeLanguages=new L;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}},pA=new QT;tt.add(v4.ModesRegistry,pA);var or="plaintext",y4=".txt";pA.registerLanguage({id:or,extensions:[y4],aliases:[h("plainText.alias","Plain Text"),"text"],mimetypes:[mc.text]});tt.as(Ns.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var vg=class{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}},Fn=Y("languageConfigurationService"),bg=class extends W{constructor(t,n){super();this.configurationService=t;this.languageService=n;let i=new Set(Object.values(ZT));this._register(this.configurationService.onDidChangeConfiguration(r=>{let s=r.change.keys.some(l=>i.has(l)),a=r.change.overrides.filter(([l,d])=>d.some(c=>i.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new vg(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new vg(l)))})),this._register(this._registry.onDidChange(r=>{this.configurations.delete(r.languageId),this.onDidChangeEmitter.fire(new vg(r.languageId))}))}_serviceBrand;_registry=this._register(new JT);onDidChangeEmitter=this._register(new L);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(t,n,i){return this._registry.register(t,n,i)}getLanguageConfiguration(t){let n=this.configurations.get(t);return n||(n=I4(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,n)),n}};bg=K([D(0,tn),D(1,Ki)],bg);function I4(o,e,t,n){let i=e.getLanguageConfiguration(o);if(!i){if(!n.isRegisteredLanguageId(o))return new tp(o,{});i=new tp(o,{})}let r=C4(i.languageId,t),s=mA([i.underlyingConfig,r]);return new tp(i.languageId,s)}var ZT={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function C4(o,e){let t=e.getValue(ZT.brackets,{overrideIdentifier:o}),n=e.getValue(ZT.colorizedBracketPairs,{overrideIdentifier:o});return{brackets:hA(t),colorizedBracketPairs:hA(n)}}function hA(o){if(Array.isArray(o))return o.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function _y(o,e,t){let n=o.getLineContent(e),i=Rt(n);return i.length>t-1&&(i=i.substring(0,t-1)),i}var XT=class{constructor(e){this.languageId=e;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(e,t){let n=new Sy(e,t,++this._order);return this._entries.push(n),this._resolved=null,ge(()=>{for(let i=0;i<this._entries.length;i++)if(this._entries[i]===n){this._entries.splice(i,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let e=this._resolve();e&&(this._resolved=new tp(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(Sy.cmp),mA(this._entries.map(e=>e.configuration)))}};function mA(o){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let t of o)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}var Sy=class{constructor(e,t,n){this.configuration=e;this.priority=t;this.order=n}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}},xy=class{constructor(e){this.languageId=e}},JT=class extends W{_entries=new Map;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(or,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,n=0){let i=this._entries.get(e);i||(i=new XT(e),this._entries.set(e,i));let r=i.register(t,n);return this._onDidChange.fire(new xy(e)),ge(()=>{r.dispose(),this._onDidChange.fire(new xy(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}},tp=class o{constructor(e,t){this.languageId=e;this.underlyingConfig=t;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Cy(this.underlyingConfig):null,this.comments=o._handleComments(this.underlyingConfig),this.characterPair=new by(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||jv,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new Iy(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new my(e,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return lg(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new py(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new vy(this.brackets)),this._electricCharacter}onEnter(e,t,n,i){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,n,i):null}getAutoClosingPairs(){return new uy(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){let t=e.comments;if(!t)return null;let n={};if(t.lineComment&&(n.lineCommentToken=t.lineComment),t.blockComment){let[i,r]=t.blockComment;n.blockCommentStartToken=i,n.blockCommentEndToken=r}return n}};$i(Fn,bg,1);var eL=class o{constructor(e){this.map=e}static createFromLanguage(e,t){function n(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}let i=new Map;for(let r of e.bracketsNew.openingBrackets){let s=Ft(0,r.bracketText.length),a=n(r),l=ri.getEmpty().add(a,qT);i.set(r.bracketText,new Gr(s,1,a,l,yg.create(s,r,l)))}for(let r of e.bracketsNew.closingBrackets){let s=Ft(0,r.bracketText.length),a=ri.getEmpty(),l=r.getOpeningBrackets();for(let d of l)a=a.add(n(d),qT);i.set(r.bracketText,new Gr(s,2,n(l[0]),a,yg.create(s,r,a)))}return new o(i)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>S4(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(let[t,n]of this.map)if(n.kind===2&&n.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}};function S4(o){let e=Ui(o);return/^[\w ]+/.test(o)&&(e=`\\b${e}`),/[\w ]+$/.test(o)&&(e=`${e}\\b`),e}var np=class{constructor(e,t){this.denseKeyProvider=e;this.getLanguageConfiguration=t}languageIdToBracketTokens=new Map;didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=eL.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}getToken(e,t){return this.getSingleLanguageBracketTokens(t).getToken(e)}};var Gr=class{constructor(e,t,n,i,r){this.length=e;this.kind=t;this.bracketId=n;this.bracketIds=i;this.astNode=r}},ip=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new tL(this.textModel,this.bracketTokens);_offset=Cn;get offset(){return this._offset}get length(){return Ft(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(e){this.didPeek=!1,this._offset=bt(this._offset,e);let t=Ai(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}didPeek=!1;peeked=null;read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=bt(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},tL=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let e=this.lineIdx,t=this.lineCharOffset,n=0;for(;;){let r=this.lineTokens,s=r.getCount(),a=null;if(this.lineTokenOffset<s){let l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=ko.getTokenType(l)===0,c=ko.containsBalancedBrackets(l),u=r.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<u){let p=r.getLanguageId(this.lineTokenOffset),m=this.line.substring(this.lineCharOffset,u),g=this.bracketTokens.getSingleLanguageBracketTokens(p),f=g.regExpGlobal;if(f){f.lastIndex=0;let b=f.exec(m);b&&(a=g.getToken(b[0]),a&&(this.lineCharOffset+=b.index))}}if(n+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n+=33,n>1e3))break;if(n>1500)break}let i=aA(e,t,this.lineIdx,this.lineCharOffset);return new Gr(i,0,-1,ri.getEmpty(),new $r(i))}},wy=class{constructor(e,t){this.text=e;let n=t.getRegExpStr(),i=n?new RegExp(n+`|
`,"gi"):null,r=[],s,a=0,l=0,d=0,c=0,u=[];for(let g=0;g<60;g++)u.push(new Gr(Ft(0,g),0,-1,ri.getEmpty(),new $r(Ft(0,g))));let p=[];for(let g=0;g<60;g++)p.push(new Gr(Ft(1,g),0,-1,ri.getEmpty(),new $r(Ft(1,g))));if(i)for(i.lastIndex=0;(s=i.exec(e))!==null;){let g=s.index,f=s[0];if(f===`
`)a++,l=g+1;else{if(d!==g){let b;if(c===a){let v=g-d;if(v<u.length)b=u[v];else{let I=Ft(0,v);b=new Gr(I,0,-1,ri.getEmpty(),new $r(I))}}else{let v=a-c,I=g-l;if(v===1&&I<p.length)b=p[I];else{let C=Ft(v,I);b=new Gr(C,0,-1,ri.getEmpty(),new $r(C))}}r.push(b)}r.push(t.getToken(f)),d=g+f.length,c=a}}let m=e.length;if(d!==m){let g=c===a?Ft(0,m-d):Ft(a-c,m-l);r.push(new Gr(g,0,-1,ri.getEmpty(),new $r(g)))}this.length=Ft(a,m-l),this.tokens=r}_offset=Cn;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new xb}getText(){return this.text}};var Ig=class{_length;get length(){return this._length}constructor(e){this._length=e}},Cg=class o extends Ig{constructor(t,n,i,r,s){super(t);this.openingBracket=n;this.child=i;this.closingBracket=r;this.missingOpeningBracketIds=s}static create(t,n,i){let r=t.length;return n&&(r=bt(r,n.length)),i&&(r=bt(r,i.length)),new o(r,t,n,i,n?n.missingOpeningBracketIds:ri.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}canBeReused(t){return!(this.closingBracket===null||t.intersects(this.missingOpeningBracketIds))}flattenLists(){return o.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new o(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,n){return this.child?this.child.computeMinIndentation(bt(t,this.openingBracket.length),n):Number.MAX_SAFE_INTEGER}},Ro=class o extends Ig{constructor(t,n,i){super(t);this.listHeight=n;this._missingOpeningBracketIds=i}static create23(t,n,i,r=!1){let s=t.length,a=t.missingOpeningBracketIds;if(t.listHeight!==n.listHeight)throw new Error("Invalid list heights");if(s=bt(s,n.length),a=a.merge(n.missingOpeningBracketIds),i){if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=bt(s,i.length),a=a.merge(i.missingOpeningBracketIds)}return r?new nL(s,t.listHeight+1,t,n,i,a):new Sg(s,t.listHeight+1,t,n,i,a)}static create(t,n=!1){if(t.length===0)return this.getEmpty();{let i=t[0].length,r=t[0].missingOpeningBracketIds;for(let s=1;s<t.length;s++)i=bt(i,t[s].length),r=r.merge(t[s].missingOpeningBracketIds);return n?new Ey(i,t[0].listHeight+1,t,r):new xg(i,t[0].listHeight+1,t,r)}}static getEmpty(){return new Ey(Cn,0,[],ri.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let t=this.childrenLength;if(t===0)return;let n=this.getChild(t-1),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(t-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let n=this.getChild(0),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(0,i),i}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let n=this;for(;n.kind===4;){let i=n.childrenLength;if(i===0)throw new Ke;n=n.getChild(i-1)}return n.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();let t=this.childrenLength,n=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let r=1;r<t;r++){let s=this.getChild(r);n=bt(n,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=n,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}flattenLists(){let t=[];for(let n of this.children){let i=n.flattenLists();i.kind===4?t.push(...i.children):t.push(i)}return o.create(t)}computeMinIndentation(t,n){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,r=t;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(i=Math.min(i,a.computeMinIndentation(r,n)),r=bt(r,a.length))}return this.cachedMinIndentation=i,i}},Sg=class o extends Ro{constructor(t,n,i,r,s,a){super(t,n,a);this._item1=i;this._item2=r;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,n){switch(t){case 0:this._item1=n;return;case 1:this._item2=n;return;case 2:this._item3=n;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new o(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}},nL=class extends Sg{toMutable(){return new Sg(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},xg=class o extends Ro{constructor(t,n,i,r){super(t,n,r);this._children=i}get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,n){this._children[t]=n}get children(){return this._children}deepClone(){let t=new Array(this._children.length);for(let n=0;n<this._children.length;n++)t[n]=this._children[n].deepClone();return new o(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}},Ey=class extends xg{toMutable(){return new xg(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},w4=[],_g=class extends Ig{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return w4}flattenLists(){return this}deepClone(){return this}},$r=class extends _g{get kind(){return 0}get missingOpeningBracketIds(){return ri.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){let n=Ai(e),i=(n.columnCount===0?n.lineCount:n.lineCount+1)+1,r=lA(bt(e,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=i;a<=r;a++){let l=t.getLineFirstNonWhitespaceColumn(a),d=t.getLineContent(a);if(l===0)continue;let c=St.visibleColumnFromColumn(d,l,t.getOptions().tabSize);s=Math.min(s,c)}return s}},yg=class o extends _g{constructor(t,n,i){super(t);this.bracketInfo=n;this.bracketIds=i}static create(t,n,i){return new o(t,n,i)}get kind(){return 1}get missingOpeningBracketIds(){return ri.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,n){return Number.MAX_SAFE_INTEGER}},Ty=class extends _g{get kind(){return 3}missingOpeningBracketIds;constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}};var wg=class{constructor(e,t,n,i){this.range=e;this.nestingLevel=t;this.nestingLevelOfEqualBracketType=n;this.isInvalid=i}},iL=class{constructor(e,t,n,i,r,s){this.range=e;this.openingBracketRange=t;this.closingBracketRange=n;this.nestingLevel=i;this.nestingLevelOfEqualBracketType=r;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},Ly=class extends iL{constructor(t,n,i,r,s,a,l){super(t,n,i,r,s,a);this.minVisibleColumnIndentation=l}};var ky=class{changeType=1},po=class o{constructor(e,t,n,i,r){this.ownerId=e;this.lineNumber=t;this.column=n;this.options=i;this.order=r}static applyInjectedText(e,t){if(!t||t.length===0)return e;let n="",i=0;for(let r of t)n+=e.substring(i,r.column-1),i=r.column-1,n+=r.options.content;return n+=e.substring(i),n}static fromDecorations(e){let t=[];for(let n of e)n.options.before&&n.options.before.content.length>0&&t.push(new o(n.ownerId,n.range.startLineNumber,n.range.startColumn,n.options.before,0)),n.options.after&&n.options.after.content.length>0&&t.push(new o(n.ownerId,n.range.endLineNumber,n.range.endColumn,n.options.after,1));return t.sort((n,i)=>n.lineNumber===i.lineNumber?n.column===i.column?n.order-i.order:n.column-i.column:n.lineNumber-i.lineNumber),t}withText(e){return new o(this.ownerId,this.lineNumber,this.column,{...this.options,content:e},this.order)}},Eg=class{changeType=2;lineNumber;detail;injectedText;constructor(e,t,n){this.lineNumber=e,this.detail=t,this.injectedText=n}},Dy=class{changeType=3;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},Ry=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(e,t,n,i){this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}},My=class{changeType=5},fc=class o{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.versionId,r=e.isUndoing||t.isUndoing,s=e.isRedoing||t.isRedoing;return new o(n,i,r,s)}},op=class{changes;constructor(e){this.changes=e}},Yl=class o{constructor(e,t){this.rawContentChangedEvent=e;this.contentChangedEvent=t}merge(e){let t=fc.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=o._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new o(t,n)}static _mergeChangeEvents(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.eol,r=t.versionId,s=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,d=e.isEolChange&&t.isEolChange;return{changes:n,eol:i,isEolChange:d,versionId:r,isUndoing:s,isRedoing:a,isFlush:l}}};var Ir=class{constructor(e,t,n,i,r,s){this.visibleColumn=e;this.column=t;this.className=n;this.horizontalLine=i;this.forWrappedLinesAfterColumn=r;this.forWrappedLinesBeforeOrAtColumn=s;if(e!==-1==(t!==-1))throw new Error}},Ka=class{constructor(e,t){this.top=e;this.endColumn=t}};var bc=class o{constructor(e){this.edits=e;let t=-1;for(let n of e){if(!(n.replaceRange.start>=t))throw new Ke(`Edits must be disjoint and sorted. Found ${n} after ${t}`);t=n.replaceRange.endExclusive}}static empty=new o([]);static fromJson(e){return new o(e.map(rr.fromJson))}static replace(e,t){return new o([new rr(e,t)])}static insert(e,t){return o.replace(Et.emptyAt(e),t)}normalize(){let e=[],t;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(t&&t.replaceRange.endExclusive===n.replaceRange.start?t=new rr(t.replaceRange.join(n.replaceRange),t.newText+n.newText):(t&&e.push(t),t=n));return t&&e.push(t),new o(e)}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],n=0;for(let i of this.edits)t.push(e.substring(n,i.replaceRange.start)),t.push(i.newText),n=i.replaceRange.endExclusive;return t.push(e.substring(n)),t.join("")}compose(e){return T4(this,e)}inverse(e){let t=[],n=0;for(let i of this.edits)t.push(new rr(Et.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e.substring(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new o(t)}getNewTextRanges(){let e=[],t=0;for(let n of this.edits)e.push(Et.ofStartAndLength(n.replaceRange.start+t,n.newText.length)),t+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],n=0,i=0,r=0;for(;i<this.edits.length||n<e.edits.length;){let s=e.edits[n],a=this.edits[i];if(a)s?a.replaceRange.intersects(s.replaceRange)?i++:a.replaceRange.start<s.replaceRange.start?(t.push(new rr(a.replaceRange.delta(r),a.newText)),i++):(n++,r+=s.newText.length-s.replaceRange.length):(t.push(new rr(a.replaceRange.delta(r),a.newText)),i++);else break}return new o(t)}applyToOffset(e){let t=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+t;t+=n.newText.length-n.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new Et(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let t=0;for(let n of this.edits){let i=n.newText.length;if(n.replaceRange.start<=e-t){if(e-t<n.replaceRange.start+i)return n.replaceRange.start;t+=i-n.replaceRange.length}else break}return e-t}},rr=class o{constructor(e,t){this.replaceRange=e;this.newText=t}static fromJson(e){return new o(Et.ofStartAndLength(e.pos,e.len),e.txt)}static insert(e,t){return new o(Et.emptyAt(e),t)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function T4(o,e){if(o=o.normalize(),e=e.normalize(),o.isEmpty)return e;if(e.isEmpty)return o;let t=[...o.edits],n=[],i=0;for(let r of e.edits){for(;;){let d=t[0];if(!d||d.replaceRange.start+i+d.newText.length>=r.replaceRange.start)break;t.shift(),n.push(d),i+=d.newText.length-d.replaceRange.length}let s=i,a,l;for(;;){let d=t[0];if(!d||d.replaceRange.start+i>r.replaceRange.endExclusive)break;a||(a=d),l=d,t.shift(),i+=d.newText.length-d.replaceRange.length}if(!a)n.push(new rr(r.replaceRange.delta(-i),r.newText));else{let d="",c=r.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let u=l.replaceRange.endExclusive+i-r.replaceRange.endExclusive;if(u>0){let g=new rr(Et.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-u));t.unshift(g),i-=g.newText.length-g.replaceRange.length}let p=d+r.newText,m=new Et(Math.min(a.replaceRange.start,r.replaceRange.start-s),r.replaceRange.endExclusive-i);n.push(new rr(m,p))}}for(;;){let r=t.shift();if(!r)break;n.push(r)}return new bc(n).normalize()}var rp=class o{constructor(e,t){this.lineEdit=e;this.additionalLines=t}static replace(e,t){return new o(bc.replace(e,t),null)}};var bA=Y("undoRedoService");var gA=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o},fA=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o};var sp=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&sn(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}},Ql=class{_findMatchBrand=void 0;range;matches;constructor(e,t){this.range=e,this.matches=t}};function vA(o){return o&&typeof o.read=="function"}var ap=class{constructor(e,t,n,i,r,s){this.identifier=e;this.range=t;this.text=n;this.forceMoveMarkers=i;this.isAutoWhitespaceEdit=r;this._isTracked=s}},Py=class{regex;wordSeparators;simpleSearch;constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}},Ay=class{constructor(e,t,n){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=n}};var oL={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var qs=Y("fileService");function IA(o){return!!(o.capabilities&2048)}var sL=class o extends Error{constructor(t,n){super(t);this.code=n}static create(t,n){let i=new o(t.toString(),n);return k4(i,n),i}};function k4(o,e){return o.name=e?`${e} (FileSystemError)`:"FileSystemError",o}function D4(o){if(!o)return"Unknown";if(o instanceof sL)return o.code;let e=/^(.+) \(FileSystemError\)$/.exec(o.name);if(!e)return"Unknown";switch(e[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function CA(o){if(o instanceof Tg)return o.fileOperationResult;switch(D4(o)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var Tg=class extends Error{constructor(t,n,i){super(t);this.fileOperationResult=n;this.options=i}};var Ny=class extends Tg{constructor(t,n,i){super(t,2,i);this.stat=n}};var jr={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},lp={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"};var SA="files.readonlyInclude",xA="files.readonlyExclude";var Lg="";var yA=class o{static KB=1024;static MB=o.KB*o.KB;static GB=o.MB*o.KB;static TB=o.GB*o.KB;static formatSize(e){return ro(e)||(e=0),e<o.KB?h("sizeB","{0}B",e.toFixed(0)):e<o.MB?h("sizeKB","{0}KB",(e/o.KB).toFixed(2)):e<o.GB?h("sizeMB","{0}MB",(e/o.MB).toFixed(2)):e<o.TB?h("sizeGB","{0}GB",(e/o.GB).toFixed(2)):h("sizeTB","{0}TB",(e/o.TB).toFixed(2))}};var aL=Y("textModelService");var _A="";var dp=class extends W{_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var vc=Y("modelService");var Oy=Y("ILanguageDetectionService"),lL="languageDetection";var Zl=class extends dp{constructor(t,n,i,r,s){super();this.modelService=t;this.languageService=n;this.languageDetectionService=i;this.accessibilityService=r;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new Ut);autoDetectLanguageThrottler=this._register(new Zm(Zl.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(t){let n=this.modelService.getModel(t);if(!n)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.textEditorModelHandle=t,this.registerModelDisposeListener(n)}registerModelDisposeListener(t){this.modelDisposeListener.value=t.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(t,n){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(t,n)}setLanguageIdInternal(t,n){this.isResolved()&&(!t||t===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(t),n))}installModelListeners(t){let n=this._register(t.onDidChangeLanguage(i=>{i.source!==lL&&(this._hasLanguageSetExplicitly=!0,n.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??or))return;let t=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),n=this.getLanguageId();if(t&&t!==n&&!this.isDisposed()){this.setLanguageIdInternal(t,lL);let i=this.languageService.getLanguageName(t);this.accessibilityService.alert(h("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",i??t))}}createTextEditorModel(t,n,i){let r=this.getFirstLineText(t),s=this.getOrCreateLanguage(n,this.languageService,i,r);return this.doCreateTextEditorModel(t,s,n)}doCreateTextEditorModel(t,n,i){let r=i&&this.modelService.getModel(i);return r?this.updateTextEditorModel(t,n.languageId):(r=this.modelService.createModel(t,n,i),this.createdEditorModel=!0,this.registerModelDisposeListener(r)),this.textEditorModelHandle=r.uri,r}getFirstLineText(t){let n=t;return typeof n.getFirstLineText=="function"?n.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(t,n,i,r){return!i||i===or?n.createByFilepathOrFirstLine(t??null,r):n.createById(i)}updateTextEditorModel(t,n){this.isResolved()&&(t&&this.modelService.updateModel(this.textEditorModel,t),n&&n!==or&&this.textEditorModel.getLanguageId()!==n&&this.textEditorModel.setLanguage(this.languageService.createById(n)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};Zl=K([D(0,vc),D(1,Ki),D(2,Oy),D(3,Si)],Zl);var Fy=Y("workingCopyBackupService");var By=Y("textResourceConfigurationService"),Fse=Y("textResourcePropertiesService");function R4(o,e,t){let n=0;for(let r=0;r<o.length;r++)o.charAt(r)==="	"?n=St.nextIndentTabStop(n,e):n++;let i="";if(!t){let r=Math.floor(n/e);n=n%e;for(let s=0;s<r;s++)i+="	"}for(let r=0;r<n;r++)i+=" ";return i}function Wy(o,e,t){let n=$t(o);return n===-1&&(n=o.length),R4(o.substring(0,n),e,t)+o.substring(n)}var yc=class o{constructor(e,t,n){this.startOffset=e;this.endOffset=t;this.newLength=n}static fromModelContentChanges(e){return e.map(n=>{let i=w.lift(n.range);return new o(jl(i.getStartPosition()),jl(i.getEndPosition()),cA(n.text))}).reverse()}toString(){return`[${Ai(this.startOffset)}...${Ai(this.endOffset)}) -> ${Ai(this.newLength)}`}},Vy=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(e){this.edits=e.map(t=>dL.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);let t=this.edits[this.nextEditIdx],n=t?this.translateOldToCur(t.offsetObj):null;return n===null?null:hc(e,n)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Ft(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Ft(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){let t=Ai(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Ft(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Ft(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){let t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if($l(n,e)){this.nextEditIdx++;let i=Ai(n),r=Ai(this.translateOldToCur(t.endOffsetBeforeObj)),s=i.lineCount-r.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=i.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}},dL=class o{static from(e){return new o(e.startOffset,e.endOffset,e.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(e,t,n){this.endOffsetBeforeObj=Ai(t),this.endOffsetAfterObj=Ai(bt(e,n)),this.offsetObj=Ai(e)}};function EA(o){if(o.length===0)return null;if(o.length===1)return o[0];let e=0;function t(){if(e>=o.length)return null;let s=e,a=o[s].listHeight;for(e++;e<o.length&&o[e].listHeight===a;)e++;return e-s>=2?pL(s===0&&e===o.length?o:o.slice(s,e),!1):o[s]}let n=t(),i=t();if(!i)return n;for(let s=t();s;s=t())wA(n,i)<=wA(i,s)?(n=cL(n,i),i=s):i=cL(i,s);return cL(n,i)}function pL(o,e=!1){if(o.length===0)return null;if(o.length===1)return o[0];let t=o.length;for(;t>3;){let n=t>>1;for(let i=0;i<n;i++){let r=i<<1;o[i]=Ro.create23(o[r],o[r+1],r+3===t?o[r+2]:null,e)}t=n}return Ro.create23(o[0],o[1],t>=3?o[2]:null,e)}function wA(o,e){return Math.abs(o.listHeight-e.listHeight)}function cL(o,e){return o.listHeight===e.listHeight?Ro.create23(o,e,null,!1):o.listHeight>e.listHeight?M4(o,e):P4(e,o)}function M4(o,e){o=o.toMutable();let t=o,n=[],i;for(;;){if(e.listHeight===t.listHeight){i=e;break}if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeLastElementMutable()}for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=Ro.create23(s.unappendChild(),i,null,!1):(s.appendChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?Ro.create23(o,i,null,!1):o}function P4(o,e){o=o.toMutable();let t=o,n=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeFirstElementMutable()}let i=e;for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=Ro.create23(i,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?Ro.create23(i,o,null,!1):o}var Hy=class{nextNodes;offsets;idxs;lastOffset=Cn;constructor(e){this.nextNodes=[e],this.offsets=[Cn],this.idxs=[]}readLongestNodeAt(e,t){if(za(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){let n=kg(this.nextNodes);if(!n)return;let i=kg(this.offsets);if(za(e,i))return;if(za(i,e))if(bt(i,n.length)<=e)this.nextNodeAfterCurrent();else{let r=hL(n);r!==-1?(this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(n))return this.nextNodeAfterCurrent(),n;{let r=hL(n);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){let e=kg(this.offsets),t=kg(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let n=kg(this.nextNodes),i=hL(n,this.idxs[this.idxs.length-1]);if(i!==-1){this.nextNodes.push(n.getChild(i)),this.offsets.push(bt(e,t.length)),this.idxs[this.idxs.length-1]=i;break}else this.idxs.pop()}}};function hL(o,e=-1){for(;;){if(e++,e>=o.childrenLength)return-1;if(o.getChild(e))return e}}function kg(o){return o.length>0?o[o.length-1]:void 0}function Dg(o,e,t,n){return new mL(o,e,t,n).parseDocument()}var mL=class{constructor(e,t,n,i){this.tokenizer=e;this.createImmutableLists=i;if(n&&i)throw new Error("Not supported");this.oldNodeReader=n?new Hy(n):void 0,this.positionMapper=new Vy(t)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(ri.getEmpty(),0);return e||(e=Ro.getEmpty()),e}parseList(e,t){let n=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||n.push(r)}return this.oldNodeReader?EA(n):pL(n,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){let t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!Xu(t)){let n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),i=>t!==null&&!za(i.length,t)?!1:i.canBeReused(e));if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}}parseChild(e,t){this._itemsConstructed++;let n=this.tokenizer.read();switch(n.kind){case 2:return new Ty(n.bracketIds,n.length);case 0:return n.astNode;case 1:{if(t>300)return new $r(n.length);let i=e.merge(n.bracketIds),r=this.parseList(i,t+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===n.bracketId||s.bracketIds.intersects(n.bracketIds))?(this.tokenizer.read(),Cg.create(n.astNode,r,s.astNode)):Cg.create(n.astNode,r,null)}default:throw new Error("unexpected")}}};function gL(o,e){if(o.length===0)return e;if(e.length===0)return o;let t=new no(TA(o)),n=TA(e);n.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let i=t.dequeue();function r(d){if(d===void 0){let u=t.takeWhile(p=>!0)||[];return i&&u.unshift(i),u}let c=[];for(;i&&!Xu(d);){let[u,p]=i.splitAt(d);c.push(u),d=hc(u.lengthAfter,d),i=p??t.dequeue()}return Xu(d)||c.push(new Rg(!1,d,d)),c}let s=[];function a(d,c,u){if(s.length>0&&jT(s[s.length-1].endOffset,d)){let p=s[s.length-1];s[s.length-1]=new yc(p.startOffset,c,bt(p.newLength,u))}else s.push({startOffset:d,endOffset:c,newLength:u})}let l=Cn;for(let d of n){let c=r(d.lengthBefore);if(d.modified){let u=dA(c,m=>m.lengthBefore),p=bt(l,u);a(l,p,d.lengthAfter),l=p}else for(let u of c){let p=l;l=bt(l,u.lengthBefore),u.modified&&a(p,l,u.lengthAfter)}}return s}var Rg=class o{constructor(e,t,n){this.modified=e;this.lengthBefore=t;this.lengthAfter=n}splitAt(e){let t=hc(e,this.lengthAfter);return jT(t,Cn)?[this,void 0]:this.modified?[new o(this.modified,this.lengthBefore,e),new o(this.modified,Cn,t)]:[new o(this.modified,e,e),new o(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${Ai(this.lengthBefore)} -> ${Ai(this.lengthAfter)}`}};function TA(o){let e=[],t=Cn;for(let n of o){let i=hc(t,n.startOffset);Xu(i)||e.push(new Rg(!1,i,i));let r=hc(n.startOffset,n.endOffset);e.push(new Rg(!0,r,n.newLength)),t=n.endOffset}return e}var Uy=class extends W{constructor(t,n){super();this.textModel=t;this.getLanguageConfiguration=n;if(t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),r=new wy(this.textModel.getValue(),i);this.initialAstWithoutTokens=Dg(r,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new L;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new ep;brackets=new np(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(t){return this.brackets.didLanguageChange(t)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){let n=t.map(i=>new yc(Ft(i.fromLineNumber-1,0),Ft(i.toLineNumber,0),Ft(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(n,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){let n=yc.fromModelContentChanges(t.changes);this.handleEdits(n,!1)}handleEdits(t,n){let i=gL(this.queuedTextEdits,t);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!n&&(this.queuedTextEditsForInitialAstWithoutTokens=gL(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,n,i){let s=n,a=new ip(this.textModel,this.brackets);return Dg(a,t,s,i)}getBracketsInRange(t,n){this.flushQueue();let i=Ft(t.startLineNumber-1,t.startColumn-1),r=Ft(t.endLineNumber-1,t.endColumn-1);return new Ea(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;fL(a,Cn,a.length,i,r,s,0,0,new Map,n)})}getBracketPairsInRange(t,n){this.flushQueue();let i=jl(t.getStartPosition()),r=jl(t.getEndPosition());return new Ea(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new bL(s,n,this.textModel);vL(a,Cn,a.length,i,r,l,0,new Map)})}getFirstBracketAfter(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return DA(n,Cn,n.length,jl(t))}getFirstBracketBefore(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return kA(n,Cn,n.length,jl(t))}};function kA(o,e,t,n){if(o.kind===4||o.kind===2){let i=[];for(let r of o.children)t=bt(e,r.length),i.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=i.length-1;r>=0;r--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=i[r];if(za(s,n)){let l=kA(o.children[r],s,a,n);if(l)return l}}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=ql(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function DA(o,e,t,n){if(o.kind===4||o.kind===2){for(let i of o.children){if(t=bt(e,i.length),za(n,t)){let r=DA(i,e,t,n);if(r)return r}e=t}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=ql(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function fL(o,e,t,n,i,r,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(o.kind){case 4:{let u=o.childrenLength;for(let p=0;p<u;p++){let m=o.getChild(p);if(m){if(t=bt(e,m.length),$l(e,i)&&Ju(t,n)){if(Ju(t,i)){o=m;continue e}if(!fL(m,e,t,n,i,r,s,0,l,d))return!1}e=t}}return!0}case 2:{let u=!d||!o.closingBracket||o.closingBracket.bracketInfo.closesColorized(o.openingBracket.bracketInfo),p=0;if(l){let g=l.get(o.openingBracket.text);g===void 0&&(g=0),p=g,u&&(g++,l.set(o.openingBracket.text,g))}let m=o.childrenLength;for(let g=0;g<m;g++){let f=o.getChild(g);if(f){if(t=bt(e,f.length),$l(e,i)&&Ju(t,n)){if(Ju(t,i)&&f.kind!==1){o=f,u?(s++,a=p+1):a=p;continue e}if((u||f.kind!==1||!o.closingBracket)&&!fL(f,e,t,n,i,r,u?s+1:s,u?p+1:p,l,d,!o.closingBracket))return!1}e=t}}return l?.set(o.openingBracket.text,p),!0}case 3:{let u=ql(e,t);return r(new wg(u,s-1,0,!0))}case 1:{let u=ql(e,t);return r(new wg(u,s-1,a-1,c))}case 0:return!0}}var bL=class{constructor(e,t,n){this.push=e;this.includeMinIndentation=t;this.textModel=n}};function vL(o,e,t,n,i,r,s,a){if(s>200)return!0;let l=!0;if(o.kind===2){let d=0;if(a){let p=a.get(o.openingBracket.text);p===void 0&&(p=0),d=p,p++,a.set(o.openingBracket.text,p)}let c=bt(e,o.openingBracket.length),u=-1;if(r.includeMinIndentation&&(u=o.computeMinIndentation(e,r.textModel)),l=r.push(new Ly(ql(e,t),ql(e,c),o.closingBracket?ql(bt(c,o.child?.length||Cn),t):void 0,s,d,o,u)),e=c,l&&o.child){let p=o.child;if(t=bt(e,p.length),$l(e,i)&&Ju(t,n)&&(l=vL(p,e,t,n,i,r,s+1,a),!l))return!1}a?.set(o.openingBracket.text,d)}else{let d=e;for(let c of o.children){let u=d;if(d=bt(d,c.length),$l(u,i)&&$l(n,d)&&(l=vL(c,u,d,n,i,r,s,a),!l))return!1}}return l}var Ky=class extends W{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}bracketPairsTree=this._register(new Ut);onDidChangeEmitter=new L;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(t){(!t.languageId||this.bracketPairsTree.value?.object.didLanguageChange(t.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){this.bracketPairsTree.value?.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){this.bracketPairsTree.value?.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let t=new te;this.bracketPairsTree.value=A4(t.add(new Uy(this.textModel,n=>this.languageConfigurationService.getLanguageConfiguration(n))),t),t.add(this.bracketPairsTree.value.object.onDidChange(n=>this.onDidChangeEmitter.fire(n))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!1)||Ea.empty}getBracketPairsInRangeWithMinIndentation(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!0)||Ea.empty}getBracketsInRange(t,n=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(t,n)||Ea.empty}findMatchingBracketUp(t,n,i){let r=this.textModel.validatePosition(n),s=this.textModel.getLanguageIdAtPosition(r.lineNumber,r.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(t);if(!a)return null;let l=this.getBracketPairsInRange(w.fromPositions(n,n)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=t.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?zy(this._findMatchingBracketUp(d,r,yL(i))):null}}matchBracket(t,n){if(this.canBuildAST){let i=this.getBracketPairsInRange(w.fromPositions(t,t)).filter(r=>r.closingBracketRange!==void 0&&(r.openingBracketRange.containsPosition(t)||r.closingBracketRange.containsPosition(t))).findLastMaxBy(Nr(r=>r.openingBracketRange.containsPosition(t)?r.openingBracketRange:r.closingBracketRange,w.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{let i=yL(n);return this._matchBracket(this.textModel.validatePosition(t),i)}}_establishBracketSearchOffsets(t,n,i,r){let s=n.getCount(),a=n.getLanguageId(r),l=Math.max(0,t.column-1-i.maxBracketLength);for(let c=r-1;c>=0;c--){let u=n.getEndOffset(c);if(u<=l)break;if(yr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){l=u;break}}let d=Math.min(n.getLineContent().length,t.column-1+i.maxBracketLength);for(let c=r+1;c<s;c++){let u=n.getStartOffset(c);if(u>=d)break;if(yr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){d=u;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(t,n){let i=t.lineNumber,r=this.textModel.tokenization.getLineTokens(i),s=this.textModel.getLineContent(i),a=r.findTokenIndexAtOffset(t.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(a)).brackets;if(l&&!yr(r.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(t,r,l,a),u=null;for(;;){let p=Gi.findNextBracketInRange(l.forwardRegex,i,s,d,c);if(!p)break;if(p.startColumn<=t.column&&t.column<=p.endColumn){let m=s.substring(p.startColumn-1,p.endColumn-1).toLowerCase(),g=this._matchFoundBracket(p,l.textIsBracket[m],l.textIsOpenBracket[m],n);if(g){if(g instanceof Ga)return null;u=g}}d=p.endColumn-1}if(u)return u}if(a>0&&r.getStartOffset(a)===t.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(d)).brackets;if(c&&!yr(r.getStandardTokenType(d))){let{searchStartOffset:u,searchEndOffset:p}=this._establishBracketSearchOffsets(t,r,c,d),m=Gi.findPrevBracketInRange(c.reversedRegex,i,s,u,p);if(m&&m.startColumn<=t.column&&t.column<=m.endColumn){let g=s.substring(m.startColumn-1,m.endColumn-1).toLowerCase(),f=this._matchFoundBracket(m,c.textIsBracket[g],c.textIsOpenBracket[g],n);if(f)return f instanceof Ga?null:f}}}return null}_matchFoundBracket(t,n,i,r){if(!n)return null;let s=i?this._findMatchingBracketDown(n,t.getEndPosition(),r):this._findMatchingBracketUp(n,t.getStartPosition(),r);return s?s instanceof Ga?s:[t,s]:null}_findMatchingBracketUp(t,n,i){let r=t.languageId,s=t.reversedRegex,a=-1,l=0,d=(c,u,p,m)=>{for(;;){if(i&&++l%100===0&&!i())return Ga.INSTANCE;let g=Gi.findPrevBracketInRange(s,c,u,p,m);if(!g)break;let f=u.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(t.isOpen(f)?a++:t.isClose(f)&&a--,a===0)return g;m=g.startColumn-1}return null};for(let c=n.lineNumber;c>=1;c--){let u=this.textModel.tokenization.getLineTokens(c),p=u.getCount(),m=this.textModel.getLineContent(c),g=p-1,f=m.length,b=m.length;c===n.lineNumber&&(g=u.findTokenIndexAtOffset(n.column-1),f=n.column-1,b=n.column-1);let v=!0;for(;g>=0;g--){let I=u.getLanguageId(g)===r&&!yr(u.getStandardTokenType(g));if(I)v?f=u.getStartOffset(g):(f=u.getStartOffset(g),b=u.getEndOffset(g));else if(v&&f!==b){let C=d(c,m,f,b);if(C)return C}v=I}if(v&&f!==b){let I=d(c,m,f,b);if(I)return I}}return null}_findMatchingBracketDown(t,n,i){let r=t.languageId,s=t.forwardRegex,a=1,l=0,d=(u,p,m,g)=>{for(;;){if(i&&++l%100===0&&!i())return Ga.INSTANCE;let f=Gi.findNextBracketInRange(s,u,p,m,g);if(!f)break;let b=p.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(t.isOpen(b)?a++:t.isClose(b)&&a--,a===0)return f;m=f.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=n.lineNumber;u<=c;u++){let p=this.textModel.tokenization.getLineTokens(u),m=p.getCount(),g=this.textModel.getLineContent(u),f=0,b=0,v=0;u===n.lineNumber&&(f=p.findTokenIndexAtOffset(n.column-1),b=n.column-1,v=n.column-1);let I=!0;for(;f<m;f++){let C=p.getLanguageId(f)===r&&!yr(p.getStandardTokenType(f));if(C)I||(b=p.getStartOffset(f)),v=p.getEndOffset(f);else if(I&&b!==v){let S=d(u,g,b,v);if(S)return S}I=C}if(I&&b!==v){let C=d(u,g,b,v);if(C)return C}}return null}findPrevBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(n)||null;let i=null,r=null,s=null;for(let a=n.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),u=d-1,p=c.length,m=c.length;if(a===n.lineNumber){u=l.findTokenIndexAtOffset(n.column-1),p=n.column-1,m=n.column-1;let f=l.getLanguageId(u);i!==f&&(i=f,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let g=!0;for(;u>=0;u--){let f=l.getLanguageId(u);if(i!==f){if(r&&s&&g&&p!==m){let v=Gi.findPrevBracketInRange(r.reversedRegex,a,c,p,m);if(v)return this._toFoundBracket(s,v);g=!1}i=f,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}let b=!!r&&!yr(l.getStandardTokenType(u));if(b)g?p=l.getStartOffset(u):(p=l.getStartOffset(u),m=l.getEndOffset(u));else if(s&&r&&g&&p!==m){let v=Gi.findPrevBracketInRange(r.reversedRegex,a,c,p,m);if(v)return this._toFoundBracket(s,v)}g=b}if(s&&r&&g&&p!==m){let f=Gi.findPrevBracketInRange(r.reversedRegex,a,c,p,m);if(f)return this._toFoundBracket(s,f)}}return null}findNextBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(n)||null;let i=this.textModel.getLineCount(),r=null,s=null,a=null;for(let l=n.lineNumber;l<=i;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),u=this.textModel.getLineContent(l),p=0,m=0,g=0;if(l===n.lineNumber){p=d.findTokenIndexAtOffset(n.column-1),m=n.column-1,g=n.column-1;let b=d.getLanguageId(p);r!==b&&(r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew)}let f=!0;for(;p<c;p++){let b=d.getLanguageId(p);if(r!==b){if(a&&s&&f&&m!==g){let I=Gi.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(I)return this._toFoundBracket(a,I);f=!1}r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew}let v=!!s&&!yr(d.getStandardTokenType(p));if(v)f||(m=d.getStartOffset(p)),g=d.getEndOffset(p);else if(a&&s&&f&&m!==g){let I=Gi.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(I)return this._toFoundBracket(a,I)}f=v}if(a&&s&&f&&m!==g){let b=Gi.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(b)return this._toFoundBracket(a,b)}}return null}findEnclosingBrackets(t,n){let i=this.textModel.validatePosition(t);if(this.canBuildAST){let g=w.fromPositions(i),f=this.getBracketPairsInRange(w.fromPositions(i,i)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(g));return f?[f.openingBracketRange,f.closingBracketRange]:null}let r=yL(n),s=this.textModel.getLineCount(),a=new Map,l=[],d=(g,f)=>{if(!a.has(g)){let b=[];for(let v=0,I=f?f.brackets.length:0;v<I;v++)b[v]=0;a.set(g,b)}l=a.get(g)},c=0,u=(g,f,b,v,I)=>{for(;;){if(r&&++c%100===0&&!r())return Ga.INSTANCE;let C=Gi.findNextBracketInRange(g.forwardRegex,f,b,v,I);if(!C)break;let S=b.substring(C.startColumn-1,C.endColumn-1).toLowerCase(),E=g.textIsBracket[S];if(E&&(E.isOpen(S)?l[E.index]++:E.isClose(S)&&l[E.index]--,l[E.index]===-1))return this._matchFoundBracket(C,E,!1,r);v=C.endColumn-1}return null},p=null,m=null;for(let g=i.lineNumber;g<=s;g++){let f=this.textModel.tokenization.getLineTokens(g),b=f.getCount(),v=this.textModel.getLineContent(g),I=0,C=0,S=0;if(g===i.lineNumber){I=f.findTokenIndexAtOffset(i.column-1),C=i.column-1,S=i.column-1;let M=f.getLanguageId(I);p!==M&&(p=M,m=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,m))}let E=!0;for(;I<b;I++){let M=f.getLanguageId(I);if(p!==M){if(m&&E&&C!==S){let F=u(m,g,v,C,S);if(F)return zy(F);E=!1}p=M,m=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,m)}let A=!!m&&!yr(f.getStandardTokenType(I));if(A)E||(C=f.getStartOffset(I)),S=f.getEndOffset(I);else if(m&&E&&C!==S){let F=u(m,g,v,C,S);if(F)return zy(F)}E=A}if(m&&E&&C!==S){let M=u(m,g,v,C,S);if(M)return zy(M)}}return null}_toFoundBracket(t,n){if(!n)return null;let i=this.textModel.getValueInRange(n);i=i.toLowerCase();let r=t.getBracketInfo(i);return r?{range:n,bracketInfo:r}:null}};function A4(o,e){return{object:o,dispose:()=>e?.dispose()}}function yL(o){if(typeof o>"u")return()=>!0;{let e=Date.now();return()=>Date.now()-e<=o}}var Ga=class o{static INSTANCE=new o;_searchCanceledBrand=void 0;constructor(){}};function zy(o){return o instanceof Ga?null:o}var N4={IconContribution:"base.contributions.icons"},O4;(e=>{function o(t,n){let i=t.defaults;for(;Je.isThemeIcon(i);){let r=cp.getIcon(i.id);if(!r)return;i=r.defaults}return i}e.getDefinition=o})(O4||={});var F4;(t=>{function o(n){return{weight:n.weight,style:n.style,src:n.src.map(i=>({format:i.format,location:i.location.toString()}))}}t.toJSONObject=o;function e(n){let i=r=>rn(r)?r:void 0;if(n&&Array.isArray(n.src)&&n.src.every(r=>rn(r.format)&&rn(r.location)))return{weight:i(n.weight),style:i(n.style),src:n.src.map(r=>({format:r.format,location:be.parse(r.location)}))}}t.fromJSONObject=e})(F4||={});var IL=class{_onDidChange=new L;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:h("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${Je.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,i){let r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;let l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=n),this._onDidChange.fire()}return r}let s={id:e,description:n,defaults:t,deprecationMessage:i};this.iconsById[e]=s;let a={$ref:"#/definitions/icons"};return i&&(a.deprecationMessage=i),n&&(a.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(r,s)=>r.id.localeCompare(s.id),t=r=>{for(;Je.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let i=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(let r of i.filter(s=>!!s.description).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|${Je.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(let r of i.filter(s=>!Je.isThemeIcon(s.defaults)).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|`);return n.join(`
`)}},cp=new IL;tt.add(N4.IconContribution,cp);function Xl(o,e,t,n){return cp.registerIcon(o,e,t,n)}function B4(){let o=CE();for(let e in o){let t="\\"+o[e].toString(16);cp.registerIcon(e,{fontCharacter:t})}}B4();var MA="vscode://schemas/icons",PA=tt.as(Xd.JSONContribution);PA.registerSchema(MA,cp.getIconSchema());var RA=new zt(()=>PA.notifySchemaChanged(MA),200);cp.onDidChange(()=>{RA.isScheduled()||RA.schedule()});var nde=Xl("widget-close",le.close,h("widgetClose","Icon for the close action in widgets.")),ide=Xl("goto-previous-location",le.arrowUp,h("previousChangeIcon","Icon for goto previous editor location.")),ode=Xl("goto-next-location",le.arrowDown,h("nextChangeIcon","Icon for goto next editor location.")),rde=Je.modify(le.sync,"spin"),sde=Je.modify(le.loading,"spin");function Ys(o){return o==="hcDark"||o==="hcLight"}function CL(o){return o==="dark"||o==="hcDark"}var qr=Y("themeService");var Ede=le.file,Tde=le.folder;function Mg(o){switch(o){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var W4={ThemingContribution:"base.contributions.theming"},SL=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new L}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),ge(()=>{let t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},AA=new SL;tt.add(W4.ThemingContribution,AA);function ji(o){return AA.onColorThemeChange(o)}function OA(o){return`--vscode-${o.replace(/\./g,"-")}`}function ie(o){return`var(${OA(o)})`}function FA(o,e){return`var(${OA(o)}, ${e})`}function V4(o){return o!==null&&typeof o=="object"&&"light"in o&&"dark"in o}var H4={ColorContribution:"base.contributions.colors"},U4="default",xL=class{_onDidChangeSchema=new L;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(e){for(let t of Object.keys(this.colorsById)){let n=e.getColor(t);n&&(this.colorSchema.properties[t].oneOf[0].defaultSnippets[0].body=`\${1:${n.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(e,t,n,i=!1,r){let s={id:e,description:n,defaults:t,needsTransparency:i,deprecationMessage:r};this.colorsById[e]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),i&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=h("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:n,oneOf:[a,{type:"string",const:U4,description:h("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(n),this._onDidChangeSchema.fire(),e}deregisterColor(e){delete this.colorsById[e],delete this.colorSchema.properties[e];let t=this.colorReferenceSchema.enum.indexOf(e);t!==-1&&(this.colorReferenceSchema.enum.splice(t,1),this.colorReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let n=this.colorsById[e];if(n?.defaults){let i=V4(n.defaults)?n.defaults[t.type]:n.defaults;return Yr(i,t)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let e=(t,n)=>{let i=t.indexOf(".")===-1?0:1,r=n.indexOf(".")===-1?0:1;return i!==r?i-r:t.localeCompare(n)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}},Gy=new xL;tt.add(H4.ColorContribution,Gy);function x(o,e,t,n,i){return Gy.registerColor(o,e,t,n,i)}function z4(o,e){switch(o.op){case 0:return Yr(o.value,e)?.darken(o.factor);case 1:return Yr(o.value,e)?.lighten(o.factor);case 2:return Yr(o.value,e)?.transparent(o.factor);case 3:{let t=Yr(o.background,e);return t?Yr(o.value,e)?.makeOpaque(t):Yr(o.value,e)}case 4:for(let t of o.values){let n=Yr(t,e);if(n)return n}return;case 6:return Yr(e.defines(o.if)?o.then:o.else,e);case 5:{let t=Yr(o.value,e);if(!t)return;let n=Yr(o.background,e);return n?t.isDarkerThan(n)?G.getLighterColor(t,n,o.factor).transparent(o.transparency):G.getDarkerColor(t,n,o.factor).transparent(o.transparency):t.transparent(o.factor*o.transparency)}default:throw Nd(o)}}function Qs(o,e){return{op:0,value:o,factor:e}}function Mo(o,e){return{op:1,value:o,factor:e}}function He(o,e){return{op:2,value:o,factor:e}}function _L(...o){return{op:4,values:o}}function BA(o,e,t){return{op:6,if:o,then:e,else:t}}function wL(o,e,t,n){return{op:5,value:o,background:e,factor:t,transparency:n}}function Yr(o,e){if(o!==null){if(typeof o=="string")return o[0]==="#"?G.fromHex(o):e.getColor(o);if(o instanceof G)return o;if(typeof o=="object")return z4(o,e)}}var WA="vscode://schemas/workbench-colors",VA=tt.as(Xd.JSONContribution);VA.registerSchema(WA,Gy.getColorSchema());var NA=new zt(()=>VA.notifySchemaChanged(WA),200);Gy.onDidChangeSchema(()=>{NA.isScheduled()||NA.schedule()});var Pe=x("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},h("foreground","Overall foreground color. This color is only used if not overridden by a component.")),Kde=x("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},h("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),Gde=x("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},h("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),$de=x("descriptionForeground",{light:"#717171",dark:He(Pe,.7),hcDark:He(Pe,.7),hcLight:He(Pe,.7)},h("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),Pg=x("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},h("iconForeground","The default color for icons in the workbench.")),Po=x("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},h("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),et=x("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},h("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),Pt=x("contrastActiveBorder",{light:null,dark:null,hcDark:Po,hcLight:Po},h("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),jde=x("selection.background",null,h("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),HA=x("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},h("textLinkForeground","Foreground color for links in text.")),qde=x("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},h("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),Yde=x("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:G.black,hcLight:"#292929"},h("textSeparatorForeground","Color for text separators.")),Qde=x("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},h("textPreformatForeground","Foreground color for preformatted text segments.")),Zde=x("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},h("textPreformatBackground","Background color for preformatted text segments.")),Xde=x("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},h("textBlockQuoteBackground","Background color for block quotes in text.")),Jde=x("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:G.white,hcLight:"#292929"},h("textBlockQuoteBorder","Border color for block quotes in text.")),ece=x("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:G.black,hcLight:"#F2F2F2"},h("textCodeBlockBackground","Background color for code blocks in text."));var rce=x("sash.hoverBorder",Po,h("sashActiveBorder","Border color of active sashes.")),up=x("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:G.black,hcLight:"#0F4A85"},h("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),UA=x("badge.foreground",{dark:G.white,light:"#333",hcDark:G.white,hcLight:G.white},h("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),Ag=x("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},h("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),$y=x("scrollbarSlider.background",{dark:G.fromHex("#797979").transparent(.4),light:G.fromHex("#646464").transparent(.4),hcDark:He(et,.6),hcLight:He(et,.4)},h("scrollbarSliderBackground","Scrollbar slider background color.")),jy=x("scrollbarSlider.hoverBackground",{dark:G.fromHex("#646464").transparent(.7),light:G.fromHex("#646464").transparent(.7),hcDark:He(et,.8),hcLight:He(et,.8)},h("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),qy=x("scrollbarSlider.activeBackground",{dark:G.fromHex("#BFBFBF").transparent(.4),light:G.fromHex("#000000").transparent(.6),hcDark:et,hcLight:et},h("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),zA=x("progressBar.background",{dark:G.fromHex("#0E70C0"),light:G.fromHex("#0E70C0"),hcDark:et,hcLight:et},h("progressBarBackground","Background color of the progress bar that can show for long running operations."));var Ic=x("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:G.black,hcLight:G.white},h("editorBackground","Editor background color.")),Yy=x("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:G.white,hcLight:Pe},h("editorForeground","Editor default foreground color.")),uce=x("editorStickyScroll.background",Ic,h("editorStickyScrollBackground","Background color of sticky scroll in the editor")),pce=x("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},h("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),hce=x("editorStickyScroll.border",{dark:null,light:null,hcDark:et,hcLight:et},h("editorStickyScrollBorder","Border color of sticky scroll in the editor")),mce=x("editorStickyScroll.shadow",Ag,h("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),_i=x("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:G.white},h("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),Cc=x("editorWidget.foreground",Pe,h("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),Ng=x("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:et,hcLight:et},h("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),gce=x("editorWidget.resizeBorder",null,h("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),fce=x("editorError.background",null,h("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Og=x("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},h("editorError.foreground","Foreground color of error squigglies in the editor.")),bce=x("editorError.border",{dark:null,light:null,hcDark:G.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},h("errorBorder","If set, color of double underlines for errors in the editor.")),ZA=x("editorWarning.background",null,h("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Cr=x("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},h("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),gp=x("editorWarning.border",{dark:null,light:null,hcDark:G.fromHex("#FFCC00").transparent(.8),hcLight:G.fromHex("#FFCC00").transparent(.8)},h("warningBorder","If set, color of double underlines for warnings in the editor.")),vce=x("editorInfo.background",null,h("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Qr=x("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},h("editorInfo.foreground","Foreground color of info squigglies in the editor.")),fp=x("editorInfo.border",{dark:null,light:null,hcDark:G.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},h("infoBorder","If set, color of double underlines for infos in the editor.")),XA=x("editorHint.foreground",{dark:G.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},h("editorHint.foreground","Foreground color of hint squigglies in the editor.")),yce=x("editorHint.border",{dark:null,light:null,hcDark:G.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},h("hintBorder","If set, color of double underlines for hints in the editor.")),Ice=x("editorLink.activeForeground",{dark:"#4E94CE",light:G.blue,hcDark:G.cyan,hcLight:"#292929"},h("activeLinkForeground","Color of active links.")),pp=x("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},h("editorSelectionBackground","Color of the editor selection.")),JA=x("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:G.white},h("editorSelectionForeground","Color of the selected text for high contrast.")),Cce=x("editor.inactiveSelectionBackground",{light:He(pp,.5),dark:He(pp,.5),hcDark:He(pp,.7),hcLight:He(pp,.5)},h("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),Sce=x("editor.selectionHighlightBackground",{light:wL(pp,Ic,.3,.6),dark:wL(pp,Ic,.3,.6),hcDark:null,hcLight:null},h("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),xce=x("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},h("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),_ce=x("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},h("editorFindMatch","Color of the current search match.")),wce=x("editor.findMatchForeground",null,h("editorFindMatchForeground","Text color of the current search match.")),Zr=x("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},h("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),Ece=x("editor.findMatchHighlightForeground",null,h("findMatchHighlightForeground","Foreground color of the other search matches."),!0),Tce=x("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},h("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Lce=x("editor.findMatchBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},h("editorFindMatchBorder","Border color of the current search match.")),Jl=x("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},h("findMatchHighlightBorder","Border color of the other search matches.")),kce=x("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:He(Pt,.4),hcLight:He(Pt,.4)},h("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Dce=x("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},h("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),KA=x("editorHoverWidget.background",_i,h("hoverBackground","Background color of the editor hover.")),Rce=x("editorHoverWidget.foreground",Cc,h("hoverForeground","Foreground color of the editor hover.")),Mce=x("editorHoverWidget.border",Ng,h("hoverBorder","Border color of the editor hover.")),Pce=x("editorHoverWidget.statusBarBackground",{dark:Mo(KA,.2),light:Qs(KA,.05),hcDark:_i,hcLight:_i},h("statusBarBackground","Background color of the editor hover status bar.")),eN=x("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:G.white,hcLight:G.black},h("editorInlayHintForeground","Foreground color of inline hints")),tN=x("editorInlayHint.background",{dark:He(up,.1),light:He(up,.1),hcDark:He(G.white,.1),hcLight:He(up,.1)},h("editorInlayHintBackground","Background color of inline hints")),Ace=x("editorInlayHint.typeForeground",eN,h("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),Nce=x("editorInlayHint.typeBackground",tN,h("editorInlayHintBackgroundTypes","Background color of inline hints for types")),Oce=x("editorInlayHint.parameterForeground",eN,h("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),Fce=x("editorInlayHint.parameterBackground",tN,h("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),K4=x("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},h("editorLightBulbForeground","The color used for the lightbulb actions icon.")),Bce=x("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),Wce=x("editorLightBulbAi.foreground",K4,h("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),Vce=x("editor.snippetTabstopHighlightBackground",{dark:new G(new qe(124,124,124,.3)),light:new G(new qe(10,50,100,.2)),hcDark:new G(new qe(124,124,124,.3)),hcLight:new G(new qe(10,50,100,.2))},h("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),Hce=x("editor.snippetTabstopHighlightBorder",null,h("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),Uce=x("editor.snippetFinalTabstopHighlightBackground",null,h("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),zce=x("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new G(new qe(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},h("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),GA=new G(new qe(155,185,85,.2)),$A=new G(new qe(255,0,0,.2)),Kce=x("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},h("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Gce=x("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},h("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),$ce=x("diffEditor.insertedLineBackground",{dark:GA,light:GA,hcDark:null,hcLight:null},h("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),jce=x("diffEditor.removedLineBackground",{dark:$A,light:$A,hcDark:null,hcLight:null},h("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),qce=x("diffEditorGutter.insertedLineBackground",null,h("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),Yce=x("diffEditorGutter.removedLineBackground",null,h("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),Qce=x("diffEditorOverview.insertedForeground",null,h("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),Zce=x("diffEditorOverview.removedForeground",null,h("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),Xce=x("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},h("diffEditorInsertedOutline","Outline color for the text that got inserted.")),Jce=x("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},h("diffEditorRemovedOutline","Outline color for text that got removed.")),eue=x("diffEditor.border",{dark:null,light:null,hcDark:et,hcLight:et},h("diffEditorBorder","Border color between the two text editors.")),tue=x("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},h("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),nue=x("diffEditor.unchangedRegionBackground","sideBar.background",h("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),iue=x("diffEditor.unchangedRegionForeground","foreground",h("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),oue=x("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},h("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),bp=x("widget.shadow",{dark:He(G.black,.36),light:He(G.black,.16),hcDark:null,hcLight:null},h("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),rue=x("widget.border",{dark:null,light:null,hcDark:et,hcLight:et},h("widgetBorder","Border color of widgets such as find/replace inside the editor.")),jA=x("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},h("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),sue=x("toolbar.hoverOutline",{dark:null,light:null,hcDark:Pt,hcLight:Pt},h("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),aue=x("toolbar.activeBackground",{dark:Mo(jA,.1),light:Qs(jA,.1),hcDark:null,hcLight:null},h("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),nN=x("breadcrumb.foreground",He(Pe,.8),h("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),iN=x("breadcrumb.background",Ic,h("breadcrumbsBackground","Background color of breadcrumb items.")),kL=x("breadcrumb.focusForeground",{light:Qs(Pe,.2),dark:Mo(Pe,.1),hcDark:Mo(Pe,.1),hcLight:Mo(Pe,.1)},h("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),oN=x("breadcrumb.activeSelectionForeground",{light:Qs(Pe,.2),dark:Mo(Pe,.1),hcDark:Mo(Pe,.1),hcLight:Mo(Pe,.1)},h("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),lue=x("breadcrumbPicker.background",_i,h("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),rN=.5,qA=G.fromHex("#40C8AE").transparent(rN),YA=G.fromHex("#40A6FF").transparent(rN),QA=G.fromHex("#606060").transparent(.4),DL=.4,hp=1,EL=x("merge.currentHeaderBackground",{dark:qA,light:qA,hcDark:null,hcLight:null},h("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),due=x("merge.currentContentBackground",He(EL,DL),h("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),TL=x("merge.incomingHeaderBackground",{dark:YA,light:YA,hcDark:null,hcLight:null},h("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),cue=x("merge.incomingContentBackground",He(TL,DL),h("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),LL=x("merge.commonHeaderBackground",{dark:QA,light:QA,hcDark:null,hcLight:null},h("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),uue=x("merge.commonContentBackground",He(LL,DL),h("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),mp=x("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},h("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),pue=x("editorOverviewRuler.currentContentForeground",{dark:He(EL,hp),light:He(EL,hp),hcDark:mp,hcLight:mp},h("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),hue=x("editorOverviewRuler.incomingContentForeground",{dark:He(TL,hp),light:He(TL,hp),hcDark:mp,hcLight:mp},h("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),mue=x("editorOverviewRuler.commonContentForeground",{dark:He(LL,hp),light:He(LL,hp),hcDark:mp,hcLight:mp},h("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),gue=x("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},h("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),fue=x("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",h("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),sN=x("problemsErrorIcon.foreground",Og,h("problemsErrorIconForeground","The color used for the problems error icon.")),aN=x("problemsWarningIcon.foreground",Cr,h("problemsWarningIconForeground","The color used for the problems warning icon.")),lN=x("problemsInfoIcon.foreground",Qr,h("problemsInfoIconForeground","The color used for the problems info icon."));var dN=x("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},h("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),Sue=x("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},h("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),RL=x("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},h("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),xue=x("minimap.infoHighlight",{dark:Qr,light:Qr,hcDark:fp,hcLight:fp},h("minimapInfo","Minimap marker color for infos.")),_ue=x("minimap.warningHighlight",{dark:Cr,light:Cr,hcDark:gp,hcLight:gp},h("overviewRuleWarning","Minimap marker color for warnings.")),wue=x("minimap.errorHighlight",{dark:new G(new qe(255,18,18,.7)),light:new G(new qe(255,18,18,.7)),hcDark:new G(new qe(255,50,50,1)),hcLight:"#B5200D"},h("minimapError","Minimap marker color for errors.")),cN=x("minimap.background",null,h("minimapBackground","Minimap background color.")),uN=x("minimap.foregroundOpacity",G.fromHex("#000f"),h("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),Eue=x("minimapSlider.background",He($y,.5),h("minimapSliderBackground","Minimap slider background color.")),Tue=x("minimapSlider.hoverBackground",He(jy,.5),h("minimapSliderHoverBackground","Minimap slider background color when hovering.")),Lue=x("minimapSlider.activeBackground",He(qy,.5),h("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var Aue=x("charts.foreground",Pe,h("chartsForeground","The foreground color used in charts.")),Nue=x("charts.lines",He(Pe,.5),h("chartsLines","The color used for horizontal lines in charts.")),Oue=x("charts.red",Og,h("chartsRed","The red color used in chart visualizations.")),Fue=x("charts.blue",Qr,h("chartsBlue","The blue color used in chart visualizations.")),Bue=x("charts.yellow",Cr,h("chartsYellow","The yellow color used in chart visualizations.")),Wue=x("charts.orange",dN,h("chartsOrange","The orange color used in chart visualizations.")),Vue=x("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},h("chartsGreen","The green color used in chart visualizations.")),Hue=x("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("chartsPurple","The purple color used in chart visualizations."));var pN=x("input.background",{dark:"#3C3C3C",light:G.white,hcDark:G.black,hcLight:G.white},h("inputBoxBackground","Input box background.")),hN=x("input.foreground",Pe,h("inputBoxForeground","Input box foreground.")),mN=x("input.border",{dark:null,light:null,hcDark:et,hcLight:et},h("inputBoxBorder","Input box border.")),ML=x("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:et,hcLight:et},h("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),G4=x("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},h("inputOption.hoverBackground","Background color of activated options in input fields.")),PL=x("inputOption.activeBackground",{dark:He(Po,.4),light:He(Po,.2),hcDark:G.transparent,hcLight:G.transparent},h("inputOption.activeBackground","Background hover color of options in input fields.")),AL=x("inputOption.activeForeground",{dark:G.white,light:G.black,hcDark:Pe,hcLight:Pe},h("inputOption.activeForeground","Foreground color of activated options in input fields.")),jue=x("input.placeholderForeground",{light:He(Pe,.5),dark:He(Pe,.5),hcDark:He(Pe,.7),hcLight:He(Pe,.7)},h("inputPlaceholderForeground","Input box foreground color for placeholder text.")),gN=x("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:G.black,hcLight:G.white},h("inputValidationInfoBackground","Input validation background color for information severity.")),fN=x("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:Pe},h("inputValidationInfoForeground","Input validation foreground color for information severity.")),bN=x("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:et,hcLight:et},h("inputValidationInfoBorder","Input validation border color for information severity.")),vN=x("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:G.black,hcLight:G.white},h("inputValidationWarningBackground","Input validation background color for warning severity.")),yN=x("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:Pe},h("inputValidationWarningForeground","Input validation foreground color for warning severity.")),IN=x("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:et,hcLight:et},h("inputValidationWarningBorder","Input validation border color for warning severity.")),CN=x("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:G.black,hcLight:G.white},h("inputValidationErrorBackground","Input validation background color for error severity.")),SN=x("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:Pe},h("inputValidationErrorForeground","Input validation foreground color for error severity.")),xN=x("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:et,hcLight:et},h("inputValidationErrorBorder","Input validation border color for error severity.")),Ip=x("dropdown.background",{dark:"#3C3C3C",light:G.white,hcDark:G.black,hcLight:G.white},h("dropdownBackground","Dropdown background.")),_N=x("dropdown.listBackground",{dark:null,light:null,hcDark:G.black,hcLight:G.white},h("dropdownListBackground","Dropdown list background.")),Fg=x("dropdown.foreground",{dark:"#F0F0F0",light:Pe,hcDark:G.white,hcLight:Pe},h("dropdownForeground","Dropdown foreground.")),Bg=x("dropdown.border",{dark:Ip,light:"#CECECE",hcDark:et,hcLight:et},h("dropdownBorder","Dropdown border.")),NL=x("button.foreground",G.white,h("buttonForeground","Button foreground color.")),wN=x("button.separator",He(NL,.4),h("buttonSeparator","Button separator color.")),vp=x("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},h("buttonBackground","Button background color.")),EN=x("button.hoverBackground",{dark:Mo(vp,.2),light:Qs(vp,.2),hcDark:vp,hcLight:vp},h("buttonHoverBackground","Button background color when hovering.")),TN=x("button.border",et,h("buttonBorder","Button border color.")),LN=x("button.secondaryForeground",{dark:G.white,light:G.white,hcDark:G.white,hcLight:Pe},h("buttonSecondaryForeground","Secondary button foreground color.")),Qy=x("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:G.white},h("buttonSecondaryBackground","Secondary button background color.")),kN=x("button.secondaryHoverBackground",{dark:Mo(Qy,.2),light:Qs(Qy,.2),hcDark:null,hcLight:null},h("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),yp=x("radio.activeForeground",AL,h("radioActiveForeground","Foreground color of active radio option.")),DN=x("radio.activeBackground",PL,h("radioBackground","Background color of active radio option.")),RN=x("radio.activeBorder",ML,h("radioActiveBorder","Border color of the active radio option.")),MN=x("radio.inactiveForeground",null,h("radioInactiveForeground","Foreground color of inactive radio option.")),PN=x("radio.inactiveBackground",null,h("radioInactiveBackground","Background color of inactive radio option.")),AN=x("radio.inactiveBorder",{light:He(yp,.2),dark:He(yp,.2),hcDark:He(yp,.4),hcLight:He(yp,.2)},h("radioInactiveBorder","Border color of the inactive radio option.")),NN=x("radio.inactiveHoverBackground",G4,h("radioHoverBackground","Background color of inactive active radio option when hovering.")),ON=x("checkbox.background",Ip,h("checkbox.background","Background color of checkbox widget.")),que=x("checkbox.selectBackground",_i,h("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),FN=x("checkbox.foreground",Fg,h("checkbox.foreground","Foreground color of checkbox widget.")),BN=x("checkbox.border",Bg,h("checkbox.border","Border color of checkbox widget.")),Yue=x("checkbox.selectBorder",Pg,h("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),WN=x("keybindingLabel.background",{dark:new G(new qe(128,128,128,.17)),light:new G(new qe(221,221,221,.4)),hcDark:G.transparent,hcLight:G.transparent},h("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),VN=x("keybindingLabel.foreground",{dark:G.fromHex("#CCCCCC"),light:G.fromHex("#555555"),hcDark:G.white,hcLight:Pe},h("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),HN=x("keybindingLabel.border",{dark:new G(new qe(51,51,51,.6)),light:new G(new qe(204,204,204,.4)),hcDark:new G(new qe(111,195,223)),hcLight:et},h("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),UN=x("keybindingLabel.bottomBorder",{dark:new G(new qe(68,68,68,.6)),light:new G(new qe(187,187,187,.4)),hcDark:new G(new qe(111,195,223)),hcLight:Pe},h("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var zN=x("list.focusBackground",null,h("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),KN=x("list.focusForeground",null,h("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),GN=x("list.focusOutline",{dark:Po,light:Po,hcDark:Pt,hcLight:Pt},h("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),$N=x("list.focusAndSelectionOutline",null,h("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),Zs=x("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},h("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),ed=x("list.activeSelectionForeground",{dark:G.white,light:G.white,hcDark:null,hcLight:null},h("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Zy=x("list.activeSelectionIconForeground",null,h("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),jN=x("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},h("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),qN=x("list.inactiveSelectionForeground",null,h("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),YN=x("list.inactiveSelectionIconForeground",null,h("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),QN=x("list.inactiveFocusBackground",null,h("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),ZN=x("list.inactiveFocusOutline",null,h("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),OL=x("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:G.white.transparent(.1),hcLight:G.fromHex("#0F4A85").transparent(.1)},h("listHoverBackground","List/Tree background when hovering over items using the mouse.")),FL=x("list.hoverForeground",null,h("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),XN=x("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},h("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),JN=x("list.dropBetweenBackground",{dark:Pg,light:Pg,hcDark:null,hcLight:null},h("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),Cp=x("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Po,hcLight:Po},h("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),eO=x("list.focusHighlightForeground",{dark:Cp,light:BA(Zs,Cp,"#BBE7FF"),hcDark:Cp,hcLight:Cp},h("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),tpe=x("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},h("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),npe=x("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},h("listErrorForeground","Foreground color of list items containing errors.")),ipe=x("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},h("listWarningForeground","Foreground color of list items containing warnings.")),tO=x("listFilterWidget.background",{light:Qs(_i,0),dark:Mo(_i,0),hcDark:_i,hcLight:_i},h("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),nO=x("listFilterWidget.outline",{dark:G.transparent,light:G.transparent,hcDark:"#f38518",hcLight:"#007ACC"},h("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),iO=x("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:et,hcLight:et},h("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),oO=x("listFilterWidget.shadow",bp,h("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),ope=x("list.filterMatchBackground",{dark:Zr,light:Zr,hcDark:null,hcLight:null},h("listFilterMatchHighlight","Background color of the filtered match.")),rpe=x("list.filterMatchBorder",{dark:Jl,light:Jl,hcDark:et,hcLight:Pt},h("listFilterMatchHighlightBorder","Border color of the filtered match.")),spe=x("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},h("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),BL=x("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},h("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),rO=x("tree.inactiveIndentGuidesStroke",He(BL,.4),h("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),sO=x("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},h("tableColumnsBorder","Table border color between columns.")),aO=x("tree.tableOddRowsBackground",{dark:He(Pe,.04),light:He(Pe,.04),hcDark:null,hcLight:null},h("tableOddRowsBackgroundColor","Background color for odd table rows.")),ape=x("editorActionList.background",_i,h("editorActionListBackground","Action List background color.")),lpe=x("editorActionList.foreground",Cc,h("editorActionListForeground","Action List foreground color.")),dpe=x("editorActionList.focusForeground",ed,h("editorActionListFocusForeground","Action List foreground color for the focused item.")),cpe=x("editorActionList.focusBackground",Zs,h("editorActionListFocusBackground","Action List background color for the focused item."));var lO=x("menu.border",{dark:null,light:null,hcDark:et,hcLight:et},h("menuBorder","Border color of menus.")),dO=x("menu.foreground",Fg,h("menuForeground","Foreground color of menu items.")),cO=x("menu.background",Ip,h("menuBackground","Background color of menu items.")),uO=x("menu.selectionForeground",ed,h("menuSelectionForeground","Foreground color of the selected menu item in menus.")),pO=x("menu.selectionBackground",Zs,h("menuSelectionBackground","Background color of the selected menu item in menus.")),hO=x("menu.selectionBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},h("menuSelectionBorder","Border color of the selected menu item in menus.")),mO=x("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:et,hcLight:et},h("menuSeparatorBackground","Color of a separator menu item in menus."));var Cpe=x("quickInput.background",_i,h("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),Spe=x("quickInput.foreground",Cc,h("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),xpe=x("quickInputTitle.background",{dark:new G(new qe(255,255,255,.105)),light:new G(new qe(0,0,0,.06)),hcDark:"#000000",hcLight:G.white},h("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),fO=x("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:G.white,hcLight:"#0F4A85"},h("pickerGroupForeground","Quick picker color for grouping labels.")),_pe=x("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:G.white,hcLight:"#0F4A85"},h("pickerGroupBorder","Quick picker color for grouping borders.")),gO=x("quickInput.list.focusBackground",null,"",void 0,h("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),Xy=x("quickInputList.focusForeground",ed,h("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),Jy=x("quickInputList.focusIconForeground",Zy,h("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),eI=x("quickInputList.focusBackground",{dark:_L(gO,Zs),light:_L(gO,Zs),hcDark:null,hcLight:null},h("quickInput.listFocusBackground","Quick picker background color for the focused item."));var kpe=x("search.resultsInfoForeground",{light:Pe,dark:He(Pe,.65),hcDark:Pe,hcLight:Pe},h("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),Dpe=x("searchEditor.findMatchBackground",{light:He(Zr,.66),dark:He(Zr,.66),hcDark:Zr,hcLight:Zr},h("searchEditor.queryMatch","Color of the Search Editor query matches.")),Rpe=x("searchEditor.findMatchBorder",{light:He(Jl,.66),dark:He(Jl,.66),hcDark:Jl,hcLight:Jl},h("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var WL=x("editor.lineHighlightBackground",null,h("lineHighlight","Background color for the highlight of line at the cursor position.")),VL=x("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:et},h("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),qpe=x("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},h("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),Ype=x("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},h("rangeHighlightBorder","Background color of the border around highlighted ranges.")),Qpe=x("editor.symbolHighlightBackground",{dark:Zr,light:Zr,hcDark:null,hcLight:null},h("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),Zpe=x("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},h("symbolHighlightBorder","Background color of the border around highlighted symbols.")),Sp=x("editorCursor.foreground",{dark:"#AEAFAD",light:G.black,hcDark:G.white,hcLight:"#0F4A85"},h("caret","Color of the editor cursor.")),tI=x("editorCursor.background",null,h("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),nI=x("editorMultiCursor.primary.foreground",Sp,h("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),bO=x("editorMultiCursor.primary.background",tI,h("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),iI=x("editorMultiCursor.secondary.foreground",Sp,h("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),vO=x("editorMultiCursor.secondary.background",tI,h("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),oI=x("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},h("editorWhitespaces","Color of whitespace characters in the editor.")),yO=x("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:G.white,hcLight:"#292929"},h("editorLineNumbers","Color of editor line numbers.")),$4=x("editorIndentGuide.background",oI,h("editorIndentGuides","Color of the editor indentation guides."),!1,h("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),j4=x("editorIndentGuide.activeBackground",oI,h("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,h("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),IO=x("editorIndentGuide.background1",$4,h("editorIndentGuides1","Color of the editor indentation guides (1).")),CO=x("editorIndentGuide.background2","#00000000",h("editorIndentGuides2","Color of the editor indentation guides (2).")),SO=x("editorIndentGuide.background3","#00000000",h("editorIndentGuides3","Color of the editor indentation guides (3).")),xO=x("editorIndentGuide.background4","#00000000",h("editorIndentGuides4","Color of the editor indentation guides (4).")),_O=x("editorIndentGuide.background5","#00000000",h("editorIndentGuides5","Color of the editor indentation guides (5).")),wO=x("editorIndentGuide.background6","#00000000",h("editorIndentGuides6","Color of the editor indentation guides (6).")),EO=x("editorIndentGuide.activeBackground1",j4,h("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),TO=x("editorIndentGuide.activeBackground2","#00000000",h("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),LO=x("editorIndentGuide.activeBackground3","#00000000",h("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),kO=x("editorIndentGuide.activeBackground4","#00000000",h("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),DO=x("editorIndentGuide.activeBackground5","#00000000",h("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),RO=x("editorIndentGuide.activeBackground6","#00000000",h("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),q4=x("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Pt,hcLight:Pt},h("editorActiveLineNumber","Color of editor active line number"),!1,h("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),Xpe=x("editorLineNumber.activeForeground",q4,h("editorActiveLineNumber","Color of editor active line number")),MO=x("editorLineNumber.dimmedForeground",null,h("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),Jpe=x("editorRuler.foreground",{dark:"#5A5A5A",light:G.lightgrey,hcDark:G.white,hcLight:"#292929"},h("editorRuler","Color of the editor rulers.")),ehe=x("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},h("editorCodeLensForeground","Foreground color of editor CodeLens")),the=x("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},h("editorBracketMatchBackground","Background color behind matching brackets")),nhe=x("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:et,hcLight:et},h("editorBracketMatchBorder","Color for matching brackets boxes")),PO=x("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},h("editorOverviewRulerBorder","Color of the overview ruler border.")),AO=x("editorOverviewRuler.background",null,h("editorOverviewRulerBackground","Background color of the editor overview ruler.")),ihe=x("editorGutter.background",Ic,h("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),ohe=x("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:G.fromHex("#fff").transparent(.8),hcLight:et},h("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),NO=x("editorUnnecessaryCode.opacity",{dark:G.fromHex("#000a"),light:G.fromHex("#0007"),hcDark:null,hcLight:null},h("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),rhe=x("editorGhostText.border",{dark:null,light:null,hcDark:G.fromHex("#fff").transparent(.8),hcLight:G.fromHex("#292929").transparent(.8)},h("editorGhostTextBorder","Border color of ghost text in the editor.")),she=x("editorGhostText.foreground",{dark:G.fromHex("#ffffff56"),light:G.fromHex("#0007"),hcDark:null,hcLight:null},h("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),ahe=x("editorGhostText.background",null,h("editorGhostTextBackground","Background color of the ghost text in the editor.")),Y4=new G(new qe(0,122,204,.6)),lhe=x("editorOverviewRuler.rangeHighlightForeground",Y4,h("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),dhe=x("editorOverviewRuler.errorForeground",{dark:new G(new qe(255,18,18,.7)),light:new G(new qe(255,18,18,.7)),hcDark:new G(new qe(255,50,50,1)),hcLight:"#B5200D"},h("overviewRuleError","Overview ruler marker color for errors.")),che=x("editorOverviewRuler.warningForeground",{dark:Cr,light:Cr,hcDark:gp,hcLight:gp},h("overviewRuleWarning","Overview ruler marker color for warnings.")),uhe=x("editorOverviewRuler.infoForeground",{dark:Qr,light:Qr,hcDark:fp,hcLight:fp},h("overviewRuleInfo","Overview ruler marker color for infos.")),rI=x("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},h("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),sI=x("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},h("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),aI=x("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},h("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),lI=x("editorBracketHighlight.foreground4","#00000000",h("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),dI=x("editorBracketHighlight.foreground5","#00000000",h("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),cI=x("editorBracketHighlight.foreground6","#00000000",h("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),OO=x("editorBracketHighlight.unexpectedBracket.foreground",{dark:new G(new qe(255,18,18,.8)),light:new G(new qe(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},h("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),FO=x("editorBracketPairGuide.background1","#00000000",h("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),BO=x("editorBracketPairGuide.background2","#00000000",h("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),WO=x("editorBracketPairGuide.background3","#00000000",h("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),VO=x("editorBracketPairGuide.background4","#00000000",h("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),HO=x("editorBracketPairGuide.background5","#00000000",h("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),UO=x("editorBracketPairGuide.background6","#00000000",h("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),zO=x("editorBracketPairGuide.activeBackground1","#00000000",h("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),KO=x("editorBracketPairGuide.activeBackground2","#00000000",h("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),GO=x("editorBracketPairGuide.activeBackground3","#00000000",h("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),$O=x("editorBracketPairGuide.activeBackground4","#00000000",h("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),jO=x("editorBracketPairGuide.activeBackground5","#00000000",h("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),qO=x("editorBracketPairGuide.activeBackground6","#00000000",h("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),phe=x("editorUnicodeHighlight.border",Cr,h("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),hhe=x("editorUnicodeHighlight.background",ZA,h("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));ji((o,e)=>{let t=o.getColor(Ic),n=o.getColor(WL),i=n&&!n.isTransparent()?n:t;i&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${i}; }`)});var uI=class extends W{constructor(t){super();this.textModel=t;this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange(n=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new pI;onDidChangeEmitter=new L;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,n,i,r){return r?[]:n===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(t,n){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new w(1,1,this.textModel.getLineCount(),1),t,n):[]}},pI=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}};ji((o,e)=>{let t=[rI,sI,aI,lI,dI,cI],n=new pI;e.addRule(`.monaco-editor .${n.unexpectedClosingBracketClassName} { color: ${o.getColor(OO)}; }`);let i=t.map(r=>o.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){let s=i[r%i.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(r)} { color: ${s}; }`)}});function xp(o){return o.toString()}var ho=class o{constructor(e,t,n,i,r,s,a){this.beforeVersionId=e;this.afterVersionId=t;this.beforeEOL=n;this.afterEOL=i;this.beforeCursorState=r;this.afterCursorState=s;this.changes=a}static create(e,t){let n=e.getAlternativeVersionId(),i=zL(e);return new o(n,n,i,i,t,t,[])}append(e,t,n,i,r){t.length>0&&(this.changes=UP(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,n){if(qn(e,t?t.length:0,n),n+=4,t)for(let i of t)qn(e,i.selectionStartLineNumber,n),n+=4,qn(e,i.selectionStartColumn,n),n+=4,qn(e,i.positionLineNumber,n),n+=4,qn(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){let i=jn(e,t);t+=4;for(let r=0;r<i;r++){let s=jn(e,t);t+=4;let a=jn(e,t);t+=4;let l=jn(e,t);t+=4;let d=jn(e,t);t+=4,n.push(new De(s,a,l,d))}return t}serialize(){let e=10+o._writeSelectionsSize(this.beforeCursorState)+o._writeSelectionsSize(this.afterCursorState)+4;for(let i of this.changes)e+=i.writeSize();let t=new Uint8Array(e),n=0;qn(t,this.beforeVersionId,n),n+=4,qn(t,this.afterVersionId,n),n+=4,Jv(t,this.beforeEOL,n),n+=1,Jv(t,this.afterEOL,n),n+=1,n=o._writeSelections(t,this.beforeCursorState,n),n=o._writeSelections(t,this.afterCursorState,n),qn(t,this.changes.length,n),n+=4;for(let i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){let t=new Uint8Array(e),n=0,i=jn(t,n);n+=4;let r=jn(t,n);n+=4;let s=Xv(t,n);n+=1;let a=Xv(t,n);n+=1;let l=[];n=o._readSelections(t,n,l);let d=[];n=o._readSelections(t,n,d);let c=jn(t,n);n+=4;let u=[];for(let p=0;p<c;p++)n=Lo.read(t,n,u);return new o(i,r,s,a,l,d,u)}},hI=class{constructor(e,t,n,i){this.label=e;this.code=t;this.model=n,this._data=ho.create(n,i)}model;_data;get type(){return 0}get resource(){return be.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof ho?this._data:ho.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(be.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof ho}append(e,t,n,i,r){this._data instanceof ho&&this._data.append(e,t,n,i,r)}close(){this._data instanceof ho&&(this._data=this._data.serialize())}open(){this._data instanceof ho||(this._data=ho.deserialize(this._data))}undo(){if(be.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof ho&&(this._data=this._data.serialize());let e=ho.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(be.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof ho&&(this._data=this._data.serialize());let e=ho.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof ho&&(this._data=this._data.serialize()),this._data.byteLength+168}},UL=class{constructor(e,t,n){this.label=e;this.code=t;this._isOpen=!0,this._editStackElementsArr=n.slice(0),this._editStackElementsMap=new Map;for(let i of this._editStackElementsArr){let r=xp(i.resource);this._editStackElementsMap.set(r,i)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(e=>e.resource)}setDelegate(e){this._delegate=e}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let e=[];for(let t of this._editStackElementsArr)be.isUri(t.model)&&e.push(t.model);return e}matchesResource(e){let t=xp(e);return this._editStackElementsMap.has(t)}setModel(e){let t=xp(be.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;let t=xp(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,n,i,r){let s=xp(e.uri);this._editStackElementsMap.get(s).append(e,t,n,i,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let e of this._editStackElementsArr)e.undo()}redo(){for(let e of this._editStackElementsArr)e.redo()}heapSize(e){let t=xp(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(let t of this._editStackElementsArr)e.push(`${Ol(t.resource)}: ${t}`);return`{${e.join(", ")}}`}};function zL(o){return o.getEOL()===`
`?0:1}function HL(o){return o?o instanceof hI||o instanceof UL:!1}var mI=class o{_model;_undoRedoService;constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);HL(e)&&e.close()}popStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);HL(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){let n=this._undoRedoService.getLastElement(this._model.uri);if(HL(n)&&n.canAppend(this._model))return n;let i=new hI(h("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(i,t),i}pushEOL(e){let t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],zL(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n,i){let r=this._getOrCreateEditStackElement(e,i),s=this._model.applyEdits(t,!0),a=o._computeCursorState(n,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),r.append(this._model,l.map(d=>d.textChange),zL(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(n){return Ue(n),null}}};var _p=class extends W{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function YO(o,e){let t=0,n=0,i=o.length;for(;n<i;){let r=o.charCodeAt(n);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;n++}return n===i?-1:t}var gI=class extends _p{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return YO(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,n,i){this.assertNotDisposed();let r=this.textModel.getLineCount();if(t<1||t>r)throw new Ke("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,u=-1,p=F=>{if(l!==-1&&(l===-2||l>F-1)){l=-1,d=-1;for(let O=F-2;O>=0;O--){let H=this._computeIndentLevel(O);if(H>=0){l=O,d=H;break}}}if(c===-2){c=-1,u=-1;for(let O=F;O<r;O++){let H=this._computeIndentLevel(O);if(H>=0){c=O,u=H;break}}}},m=-2,g=-1,f=-2,b=-1,v=F=>{if(m===-2){m=-1,g=-1;for(let O=F-2;O>=0;O--){let H=this._computeIndentLevel(O);if(H>=0){m=O,g=H;break}}}if(f!==-1&&(f===-2||f<F-1)){f=-1,b=-1;for(let O=F;O<r;O++){let H=this._computeIndentLevel(O);if(H>=0){f=O,b=H;break}}}},I=0,C=!0,S=0,E=!0,M=0,A=0;for(let F=0;C||E;F++){let O=t-F,H=t+F;F>1&&(O<1||O<n)&&(C=!1),F>1&&(H>r||H>i)&&(E=!1),F>5e4&&(C=!1,E=!1);let U=-1;if(C&&O>=1){let re=this._computeIndentLevel(O-1);re>=0?(c=O-1,u=re,U=Math.ceil(re/this.textModel.getOptions().indentSize)):(p(O),U=this._getIndentLevelForWhitespaceLine(a,d,u))}let z=-1;if(E&&H<=r){let re=this._computeIndentLevel(H-1);re>=0?(m=H-1,g=re,z=Math.ceil(re/this.textModel.getOptions().indentSize)):(v(H),z=this._getIndentLevelForWhitespaceLine(a,g,b))}if(F===0){A=U;continue}if(F===1){if(H<=r&&z>=0&&A+1===z){C=!1,I=H,S=H,M=z;continue}if(O>=1&&U>=0&&U-1===A){E=!1,I=O,S=O,M=U;continue}if(I=t,S=t,M=A,M===0)return{startLineNumber:I,endLineNumber:S,indent:M}}C&&(U>=M?I=O:C=!1),E&&(z>=M?S=H:E=!1)}return{startLineNumber:I,endLineNumber:S,indent:M}}getLinesBracketGuides(t,n,i,r){let s=[];for(let p=t;p<=n;p++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new w(t,1,n,this.textModel.getLineMaxColumn(n))).toArray(),d;if(i&&l.length>0){let p=(t<=i.lineNumber&&i.lineNumber<=n?l:this.textModel.bracketPairs.getBracketPairsInRange(w.fromPositions(i)).toArray()).filter(m=>w.strictContainsPosition(m.range,i));d=DR(p,m=>a||m.range.startLineNumber!==m.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new Wg;for(let p of l){if(!p.closingBracketRange)continue;let m=d&&p.range.equalsRange(d);if(!m&&!r.includeInactive)continue;let g=u.getInlineClassName(p.nestingLevel,p.nestingLevelOfEqualBracketType,c)+(r.highlightActive&&m?" "+u.activeClassName:""),f=p.openingBracketRange.getStartPosition(),b=p.closingBracketRange.getStartPosition(),v=r.horizontalGuides===2||r.horizontalGuides===1&&m;if(p.range.startLineNumber===p.range.endLineNumber){a&&v&&s[p.range.startLineNumber-t].push(new Ir(-1,p.openingBracketRange.getEndPosition().column,g,new Ka(!1,b.column),-1,-1));continue}let I=this.getVisibleColumnFromPosition(b),C=this.getVisibleColumnFromPosition(p.openingBracketRange.getStartPosition()),S=Math.min(C,I,p.minVisibleColumnIndentation+1),E=!1;$t(this.textModel.getLineContent(p.closingBracketRange.startLineNumber))<p.closingBracketRange.startColumn-1&&(E=!0);let F=Math.max(f.lineNumber,t),O=Math.min(b.lineNumber,n),H=E?1:0;for(let U=F;U<O+H;U++)s[U-t].push(new Ir(S,-1,g,null,U===f.lineNumber?f.column:-1,U===b.lineNumber?b.column:-1));v&&(f.lineNumber>=t&&C>S&&s[f.lineNumber-t].push(new Ir(S,-1,g,new Ka(!1,f.column),-1,-1)),b.lineNumber<=n&&I>S&&s[b.lineNumber-t].push(new Ir(S,-1,g,new Ka(!E,b.column),-1,-1)))}for(let p of s)p.sort((m,g)=>m.visibleColumn-g.visibleColumn);return s}getVisibleColumnFromPosition(t){return St.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,n){this.assertNotDisposed();let i=this.textModel.getLineCount();if(t<1||t>i)throw new Error("Illegal value for startLineNumber");if(n<1||n>i)throw new Error("Illegal value for endLineNumber");let r=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(n-t+1),d=-2,c=-1,u=-2,p=-1;for(let m=t;m<=n;m++){let g=m-t,f=this._computeIndentLevel(m-1);if(f>=0){d=m-1,c=f,l[g]=Math.ceil(f/r.indentSize);continue}if(d===-2){d=-1,c=-1;for(let b=m-2;b>=0;b--){let v=this._computeIndentLevel(b);if(v>=0){d=b,c=v;break}}}if(u!==-1&&(u===-2||u<m-1)){u=-1,p=-1;for(let b=m;b<i;b++){let v=this._computeIndentLevel(b);if(v>=0){u=b,p=v;break}}}l[g]=this._getIndentLevelForWhitespaceLine(a,c,p)}return l}_getIndentLevelForWhitespaceLine(t,n,i){let r=this.textModel.getOptions();return n===-1||i===-1?0:n<i?1+Math.floor(n/r.indentSize):n===i||t?Math.ceil(i/r.indentSize):1+Math.floor(i/r.indentSize)}},Wg=class{activeClassName="indent-active";getInlineClassName(e,t,n){return this.getInlineClassNameOfLevel(n?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}};var KL=class{spacesDiff=0;looksLikeAlignment=!1};function X4(o,e,t,n,i){i.spacesDiff=0,i.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<n;r++){let p=o.charCodeAt(r),m=t.charCodeAt(r);if(p!==m)break}let s=0,a=0;for(let p=r;p<e;p++)o.charCodeAt(p)===32?s++:a++;let l=0,d=0;for(let p=r;p<n;p++)t.charCodeAt(p)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),u=Math.abs(s-l);if(c===0){i.spacesDiff=u,u>0&&0<=l-1&&l-1<o.length&&l<t.length&&t.charCodeAt(l)!==32&&o.charCodeAt(l-1)===32&&o.charCodeAt(o.length-1)===44&&(i.looksLikeAlignment=!0);return}if(u%c===0){i.spacesDiff=u/c;return}}function GL(o,e,t){let n=Math.min(o.getLineCount(),1e4),i=0,r=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],u=new KL;for(let g=1;g<=n;g++){let f=o.getLineLength(g),b=o.getLineContent(g),v=f<=65536,I=!1,C=0,S=0,E=0;for(let A=0,F=f;A<F;A++){let O=v?b.charCodeAt(A):o.getLineCharCode(g,A);if(O===9)E++;else if(O===32)S++;else{I=!0,C=A;break}}if(!I||(E>0?i++:S>1&&r++,X4(s,a,b,C,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;let M=u.spacesDiff;M<=d&&c[M]++,s=b,a=C}let p=t;i!==r&&(p=i<r);let m=e;if(p){let g=p?0:.1*n;l.forEach(f=>{let b=c[f];b>g&&(g=b,m=f)}),m===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(m=2)}return{insertSpaces:p,tabSize:m}}function qi(o){return(o.metadata&1)>>>0}function Tt(o,e){o.metadata=o.metadata&254|e<<0}function Qn(o){return(o.metadata&2)>>>1===1}function _t(o,e){o.metadata=o.metadata&253|(e?1:0)<<1}function iF(o){return(o.metadata&4)>>>2===1}function QO(o,e){o.metadata=o.metadata&251|(e?1:0)<<2}function oF(o){return(o.metadata&64)>>>6===1}function ZO(o,e){o.metadata=o.metadata&191|(e?1:0)<<6}function J4(o){return(o.metadata&24)>>>3}function XO(o,e){o.metadata=o.metadata&231|e<<3}function e5(o){return(o.metadata&32)>>>5===1}function JO(o,e){o.metadata=o.metadata&223|(e?1:0)<<5}var Ug=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,Tt(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,QO(this,!1),ZO(this,!1),XO(this,1),JO(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,_t(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;QO(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),ZO(this,this.options.glyphMarginClassName!==null),XO(this,this.options.stickiness),JO(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}},Ge=new Ug(null,0,0);Ge.parent=Ge;Ge.left=Ge;Ge.right=Ge;Tt(Ge,0);var Ep=class{root;requestNormalizeDelta;constructor(){this.root=Ge,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,r,s){return this.root===Ge?[]:a5(this,e,t,n,i,r,s)}search(e,t,n,i){return this.root===Ge?[]:eF(this,e,t,n,i)}collectNodesFromOwner(e){return r5(this,e)}collectNodesPostOrder(){return s5(this)}insert(e){tF(this,e),this._normalizeDeltaIfNecessary()}delete(e){nF(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){let n=e,i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;let r=n.start+i,s=n.end+i;n.setCachedOffsets(r,s,t)}acceptReplace(e,t,n,i){let r=i5(this,e,e+t);for(let s=0,a=r.length;s<a;s++){let l=r[s];nF(this,l)}this._normalizeDeltaIfNecessary(),o5(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let s=0,a=r.length;s<a;s++){let l=r[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,n5(l,e,e+t,n,i),l.maxEnd=l.end,tF(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return eF(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,t5(this))}};function t5(o){let e=o.root,t=0;for(;e!==Ge;){if(e.left!==Ge&&!Qn(e.left)){e=e.left;continue}if(e.right!==Ge&&!Qn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,$a(e),_t(e,!0),_t(e.left,!1),_t(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}_t(o.root,!1)}function wp(o,e,t,n){return o<t?!0:o>t||n===1?!1:n===2?!0:e}function n5(o,e,t,n,i){let r=J4(o),s=r===0||r===2,a=r===1||r===2,l=t-e,d=n,c=Math.min(l,d),u=o.start,p=!1,m=o.end,g=!1;e<=u&&m<=t&&e5(o)&&(o.start=e,p=!0,o.end=e,g=!0);{let b=i?1:l>0?2:0;!p&&wp(u,s,e,b)&&(p=!0),!g&&wp(m,a,e,b)&&(g=!0)}if(c>0&&!i){let b=l>d?2:0;!p&&wp(u,s,e+c,b)&&(p=!0),!g&&wp(m,a,e+c,b)&&(g=!0)}{let b=i?1:0;!p&&wp(u,s,t,b)&&(o.start=e+d,p=!0),!g&&wp(m,a,t,b)&&(o.end=e+d,g=!0)}let f=d-l;p||(o.start=Math.max(0,u+f)),g||(o.end=Math.max(0,m+f)),o.start>o.end&&(o.end=o.start)}function i5(o,e,t){let n=o.root,i=0,r=0,s=0,a=0,l=[],d=0;for(;n!==Ge;){if(Qn(n)){_t(n.left,!1),_t(n.right,!1),n===n.parent.right&&(i-=n.parent.delta),n=n.parent;continue}if(!Qn(n.left)){if(r=i+n.maxEnd,r<e){_t(n,!0);continue}if(n.left!==Ge){n=n.left;continue}}if(s=i+n.start,s>t){_t(n,!0);continue}if(a=i+n.end,a>=e&&(n.setCachedOffsets(s,a,0),l[d++]=n),_t(n,!0),n.right!==Ge&&!Qn(n.right)){i+=n.delta,n=n.right;continue}}return _t(o.root,!1),l}function o5(o,e,t,n){let i=o.root,r=0,s=0,a=0,l=n-(t-e);for(;i!==Ge;){if(Qn(i)){_t(i.left,!1),_t(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),$a(i),i=i.parent;continue}if(!Qn(i.left)){if(s=r+i.maxEnd,s<e){_t(i,!0);continue}if(i.left!==Ge){i=i.left;continue}}if(a=r+i.start,a>t){i.start+=l,i.end+=l,i.delta+=l,(i.delta<-1073741824||i.delta>1073741824)&&(o.requestNormalizeDelta=!0),_t(i,!0);continue}if(_t(i,!0),i.right!==Ge&&!Qn(i.right)){r+=i.delta,i=i.right;continue}}_t(o.root,!1)}function r5(o,e){let t=o.root,n=[],i=0;for(;t!==Ge;){if(Qn(t)){_t(t.left,!1),_t(t.right,!1),t=t.parent;continue}if(t.left!==Ge&&!Qn(t.left)){t=t.left;continue}if(t.ownerId===e&&(n[i++]=t),_t(t,!0),t.right!==Ge&&!Qn(t.right)){t=t.right;continue}}return _t(o.root,!1),n}function s5(o){let e=o.root,t=[],n=0;for(;e!==Ge;){if(Qn(e)){_t(e.left,!1),_t(e.right,!1),e=e.parent;continue}if(e.left!==Ge&&!Qn(e.left)){e=e.left;continue}if(e.right!==Ge&&!Qn(e.right)){e=e.right;continue}t[n++]=e,_t(e,!0)}return _t(o.root,!1),t}function eF(o,e,t,n,i){let r=o.root,s=0,a=0,l=0,d=[],c=0;for(;r!==Ge;){if(Qn(r)){_t(r.left,!1),_t(r.right,!1),r===r.parent.right&&(s-=r.parent.delta),r=r.parent;continue}if(r.left!==Ge&&!Qn(r.left)){r=r.left;continue}a=s+r.start,l=s+r.end,r.setCachedOffsets(a,l,n);let u=!0;if(e&&r.ownerId&&r.ownerId!==e&&(u=!1),t&&iF(r)&&(u=!1),i&&!oF(r)&&(u=!1),u&&(d[c++]=r),_t(r,!0),r.right!==Ge&&!Qn(r.right)){s+=r.delta,r=r.right;continue}}return _t(o.root,!1),d}function a5(o,e,t,n,i,r,s){let a=o.root,l=0,d=0,c=0,u=0,p=[],m=0;for(;a!==Ge;){if(Qn(a)){_t(a.left,!1),_t(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!Qn(a.left)){if(d=l+a.maxEnd,d<e){_t(a,!0);continue}if(a.left!==Ge){a=a.left;continue}}if(c=l+a.start,c>t){_t(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(c,u,r);let g=!0;n&&a.ownerId&&a.ownerId!==n&&(g=!1),i&&iF(a)&&(g=!1),s&&!oF(a)&&(g=!1),g&&(p[m++]=a)}if(_t(a,!0),a.right!==Ge&&!Qn(a.right)){l+=a.delta,a=a.right;continue}}return _t(o.root,!1),p}function tF(o,e){if(o.root===Ge)return e.parent=Ge,e.left=Ge,e.right=Ge,Tt(e,0),o.root=e,o.root;l5(o,e),td(e.parent);let t=e;for(;t!==o.root&&qi(t.parent)===1;)if(t.parent===t.parent.parent.left){let n=t.parent.parent.right;qi(n)===1?(Tt(t.parent,0),Tt(n,0),Tt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,Vg(o,t)),Tt(t.parent,0),Tt(t.parent.parent,1),Hg(o,t.parent.parent))}else{let n=t.parent.parent.left;qi(n)===1?(Tt(t.parent,0),Tt(n,0),Tt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,Hg(o,t)),Tt(t.parent,0),Tt(t.parent.parent,1),Vg(o,t.parent.parent))}return Tt(o.root,0),e}function l5(o,e){let t=0,n=o.root,i=e.start,r=e.end;for(;;)if(c5(i,r,n.start+t,n.end+t)<0)if(n.left===Ge){e.start-=t,e.end-=t,e.maxEnd-=t,n.left=e;break}else n=n.left;else if(n.right===Ge){e.start-=t+n.delta,e.end-=t+n.delta,e.maxEnd-=t+n.delta,n.right=e;break}else t+=n.delta,n=n.right;e.parent=n,e.left=Ge,e.right=Ge,Tt(e,1)}function nF(o,e){let t,n;if(e.left===Ge?(t=e.right,n=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Ge?(t=e.left,n=e):(n=d5(e.right),t=n.right,t.start+=n.delta,t.end+=n.delta,t.delta+=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),n.start+=e.delta,n.end+=e.delta,n.delta=e.delta,(n.delta<-1073741824||n.delta>1073741824)&&(o.requestNormalizeDelta=!0)),n===o.root){o.root=t,Tt(t,0),e.detach(),$L(),$a(t),o.root.parent=Ge;return}let i=qi(n)===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?t.parent=n.parent:(n.parent===e?t.parent=n:t.parent=n.parent,n.left=e.left,n.right=e.right,n.parent=e.parent,Tt(n,qi(e)),e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Ge&&(n.left.parent=n),n.right!==Ge&&(n.right.parent=n)),e.detach(),i){td(t.parent),n!==e&&(td(n),td(n.parent)),$L();return}td(t),td(t.parent),n!==e&&(td(n),td(n.parent));let r;for(;t!==o.root&&qi(t)===0;)t===t.parent.left?(r=t.parent.right,qi(r)===1&&(Tt(r,0),Tt(t.parent,1),Vg(o,t.parent),r=t.parent.right),qi(r.left)===0&&qi(r.right)===0?(Tt(r,1),t=t.parent):(qi(r.right)===0&&(Tt(r.left,0),Tt(r,1),Hg(o,r),r=t.parent.right),Tt(r,qi(t.parent)),Tt(t.parent,0),Tt(r.right,0),Vg(o,t.parent),t=o.root)):(r=t.parent.left,qi(r)===1&&(Tt(r,0),Tt(t.parent,1),Hg(o,t.parent),r=t.parent.left),qi(r.left)===0&&qi(r.right)===0?(Tt(r,1),t=t.parent):(qi(r.left)===0&&(Tt(r.right,0),Tt(r,1),Vg(o,r),r=t.parent.left),Tt(r,qi(t.parent)),Tt(t.parent,0),Tt(r.left,0),Hg(o,t.parent),t=o.root));Tt(t,0),$L()}function d5(o){for(;o.left!==Ge;)o=o.left;return o}function $L(){Ge.parent=Ge,Ge.delta=0,Ge.start=0,Ge.end=0}function Vg(o,e){let t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Ge&&(t.left.parent=e),t.parent=e.parent,e.parent===Ge?o.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,$a(e),$a(t)}function Hg(o,e){let t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(o.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Ge&&(t.right.parent=e),t.parent=e.parent,e.parent===Ge?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,$a(e),$a(t)}function rF(o){let e=o.end;if(o.left!==Ge){let t=o.left.maxEnd;t>e&&(e=t)}if(o.right!==Ge){let t=o.right.maxEnd+o.delta;t>e&&(e=t)}return e}function $a(o){o.maxEnd=rF(o)}function td(o){for(;o!==Ge;){let e=rF(o);if(o.maxEnd===e)return;o.maxEnd=e,o=o.parent}}function c5(o,e,t,n){return o===t?e-n:o-t}var Lp=class{parent;left;right;color;piece;size_left;lf_left;constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Me)return fI(this.right);let e=this;for(;e.parent!==Me&&e.parent.left!==e;)e=e.parent;return e.parent===Me?Me:e.parent}prev(){if(this.left!==Me)return qL(this.left);let e=this;for(;e.parent!==Me&&e.parent.right!==e;)e=e.parent;return e.parent===Me?Me:e.parent}detach(){this.parent=null,this.left=null,this.right=null}};var Me=new Lp(null,0);Me.parent=Me;Me.left=Me;Me.right=Me;Me.color=0;function fI(o){for(;o.left!==Me;)o=o.left;return o}function qL(o){for(;o.right!==Me;)o=o.right;return o}function YL(o){return o===Me?0:o.size_left+o.piece.length+YL(o.right)}function QL(o){return o===Me?0:o.lf_left+o.piece.lineFeedCnt+QL(o.right)}function jL(){Me.parent=Me}function Kg(o,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Me&&(t.left.parent=e),t.parent=e.parent,e.parent===Me?o.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Gg(o,e){let t=e.left;e.left=t.right,t.right!==Me&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Me?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function $g(o,e){let t,n;if(e.left===Me?(n=e,t=n.right):e.right===Me?(n=e,t=n.left):(n=fI(e.right),t=n.right),n===o.root){o.root=t,t.color=0,e.detach(),jL(),o.root.parent=Me;return}let i=n.color===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?(t.parent=n.parent,zg(o,t)):(n.parent===e?t.parent=n:t.parent=n.parent,zg(o,t),n.left=e.left,n.right=e.right,n.parent=e.parent,n.color=e.color,e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Me&&(n.left.parent=n),n.right!==Me&&(n.right.parent=n),n.size_left=e.size_left,n.lf_left=e.lf_left,zg(o,n)),e.detach(),t.parent.left===t){let s=YL(t),a=QL(t);if(s!==t.parent.size_left||a!==t.parent.lf_left){let l=s-t.parent.size_left,d=a-t.parent.lf_left;t.parent.size_left=s,t.parent.lf_left=a,Xs(o,t.parent,l,d)}}if(zg(o,t.parent),i){jL();return}let r;for(;t!==o.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,Kg(o,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,Gg(o,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,Kg(o,t.parent),t=o.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,Gg(o,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,Kg(o,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,Gg(o,t.parent),t=o.root));t.color=0,jL()}function ZL(o,e){for(zg(o,e);e!==o.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,Kg(o,e)),e.parent.color=0,e.parent.parent.color=1,Gg(o,e.parent.parent))}else{let t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Gg(o,e)),e.parent.color=0,e.parent.parent.color=1,Kg(o,e.parent.parent))}o.root.color=0}function Xs(o,e,t,n){for(;e!==o.root&&e!==Me;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}function zg(o,e){let t=0,n=0;if(e!==o.root){for(;e!==o.root&&e===e.parent.right;)e=e.parent;if(e!==o.root)for(e=e.parent,t=YL(e.left)-e.size_left,n=QL(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=n;e!==o.root&&(t!==0||n!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}}var u5=999,qa=class{searchString;isRegex;matchCase;wordSeparators;constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=p5(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=uv(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new Py(t,this.wordSeparators?Us(this.wordSeparators,[]):null,n?this.searchString:null)}};function p5(o){if(!o||o.length===0)return!1;for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n===10)return!0;if(n===92){if(e++,e>=t)break;let i=o.charCodeAt(e);if(i===110||i===114||i===87)return!0}}return!1}function nd(o,e,t){if(!t)return new Ql(o,null);let n=[];for(let i=0,r=e.length;i<r;i++)n[i]=e[i];return new Ql(o,n)}var bI=class{_lineFeedsOffsets;constructor(e){let t=[],n=0;for(let i=0,r=e.length;i<r;i++)e.charCodeAt(i)===10&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){let t=this._lineFeedsOffsets,n=0,i=t.length-1;if(i===-1||e<=t[0])return 0;for(;n<i;){let r=n+((i-n)/2>>0);t[r]>=e?i=r-1:t[r+1]>=e?(n=r,i=r):n=r+1}return n+1}},Sc=class{static findMatches(e,t,n,i,r){let s=t.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(e,n,new ja(s.wordSeparators,s.regex),i,r):this._doFindMatchesLineByLine(e,n,s,i,r):[]}static _getMultilineMatchRange(e,t,n,i,r,s){let a,l=0;i?(l=i.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let d;if(i){let m=i.findLineFeedCountBeforeOffset(r+s.length)-l;d=a+s.length+m}else d=a+s.length;let c=e.getPositionAt(a),u=e.getPositionAt(d);return new w(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,n,i,r){let s=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new bI(a):null,d=[],c=0,u;for(n.reset(0);u=n.next(a);)if(d[c++]=nd(this._getMultilineMatchRange(e,s,a,l,u.index,u[0]),u,i),c>=r)return d;return d}static _doFindMatchesLineByLine(e,t,n,i,r){let s=[],a=0;if(t.startLineNumber===t.endLineNumber){let d=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(n,d,t.startLineNumber,t.startColumn-1,a,s,i,r),s}let l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(n,l,t.startLineNumber,t.startColumn-1,a,s,i,r);for(let d=t.startLineNumber+1;d<t.endLineNumber&&a<r;d++)a=this._findMatchesInLine(n,e.getLineContent(d),d,0,a,s,i,r);if(a<r){let d=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(n,d,t.endLineNumber,0,a,s,i,r)}return s}static _findMatchesInLine(e,t,n,i,r,s,a,l){let d=e.wordSeparators;if(!a&&e.simpleSearch){let p=e.simpleSearch,m=p.length,g=t.length,f=-m;for(;(f=t.indexOf(p,f+m))!==-1;)if((!d||vI(d,t,g,f,m))&&(s[r++]=new Ql(new w(n,f+1+i,n,f+1+m+i),null),r>=l))return r;return r}let c=new ja(e.wordSeparators,e.regex),u;c.reset(0);do if(u=c.next(t),u&&(s[r++]=nd(new w(n,u.index+1+i,n,u.index+1+u[0].length+i),u,a),r>=l))return r;while(u);return r}static findNextMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new ja(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,n,s,i):this._doFindNextMatchLineByLine(e,n,s,i)}static _doFindNextMatchMultiline(e,t,n,i){let r=new R(t.lineNumber,1),s=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new w(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),d=e.getEOL()===`\r
`?new bI(l):null;n.reset(t.column-1);let c=n.next(l);return c?nd(this._getMultilineMatchRange(e,s,l,d,c.index,c[0]),c,i):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new R(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s),l=this._findFirstMatchInLine(n,a,s,t.column,i);if(l)return l;for(let d=1;d<=r;d++){let c=(s+d-1)%r,u=e.getLineContent(c+1),p=this._findFirstMatchInLine(n,u,c+1,1,i);if(p)return p}return null}static _findFirstMatchInLine(e,t,n,i,r){e.reset(i-1);let s=e.next(t);return s?nd(new w(n,s.index+1,n,s.index+1+s[0].length),s,r):null}static findPreviousMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new ja(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,n,s,i):this._doFindPreviousMatchLineByLine(e,n,s,i)}static _doFindPreviousMatchMultiline(e,t,n,i){let r=this._doFindMatchesMultiline(e,new w(1,1,t.lineNumber,t.column),n,i,10*u5);if(r.length>0)return r[r.length-1];let s=e.getLineCount();return t.lineNumber!==s||t.column!==e.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(e,new R(s,e.getLineMaxColumn(s)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s).substring(0,t.column-1),l=this._findLastMatchInLine(n,a,s,i);if(l)return l;for(let d=1;d<=r;d++){let c=(r+s-d-1)%r,u=e.getLineContent(c+1),p=this._findLastMatchInLine(n,u,c+1,i);if(p)return p}return null}static _findLastMatchInLine(e,t,n,i){let r=null,s;for(e.reset(0);s=e.next(t);)r=nd(new w(n,s.index+1,n,s.index+1+s[0].length),s,i);return r}};function h5(o,e,t,n,i){if(n===0)return!0;let r=e.charCodeAt(n-1);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n);if(o.get(s)!==0)return!0}return!1}function m5(o,e,t,n,i){if(n+i===t)return!0;let r=e.charCodeAt(n+i);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n+i-1);if(o.get(s)!==0)return!0}return!1}function vI(o,e,t,n,i){return h5(o,e,t,n,i)&&m5(o,e,t,n,i)}var ja=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;let i=n.index,r=n[0].length;if(i===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){Nu(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=i,this._prevMatchLength=r,!this._wordSeparators||vI(this._wordSeparators,e,t,i,r))return n}while(n);return null}};var Ya=65535;function sF(o){let e;return o[o.length-1]<65536?e=new Uint16Array(o.length):e=new Uint32Array(o.length),e.set(o,0),e}var JL=class{constructor(e,t,n,i,r){this.lineStarts=e;this.cr=t;this.lf=n;this.crlf=i;this.isBasicASCII=r}};function ea(o,e=!0){let t=[0],n=1;for(let i=0,r=o.length;i<r;i++){let s=o.charCodeAt(i);s===13?i+1<r&&o.charCodeAt(i+1)===10?(t[n++]=i+2,i++):t[n++]=i+1:s===10&&(t[n++]=i+1)}return e?sF(t):t}function aF(o,e){o.length=0,o[0]=0;let t=1,n=0,i=0,r=0,s=!0;for(let l=0,d=e.length;l<d;l++){let c=e.charCodeAt(l);c===13?l+1<d&&e.charCodeAt(l+1)===10?(r++,o[t++]=l+2,l++):(n++,o[t++]=l+1):c===10?(i++,o[t++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new JL(sF(o),n,i,r,s);return o.length=0,a}var Ni=class{bufferIndex;start;end;length;lineFeedCnt;constructor(e,t,n,i,r){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=r}},ta=class{buffer;lineStarts;constructor(e,t){this.buffer=e,this.lineStarts=t}},e1=class{_pieces;_index;_tree;_BOM;constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Me&&e.iterate(e.root,n=>(n!==Me&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},t1=class{_limit;_cache;constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let r=n[i];if(r.node.parent===null||r.nodeStartOffset>=e){n[i]=null,t=!0;continue}}if(t){let i=[];for(let r of n)r!==null&&i.push(r);this._cache=i}}},yI=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new ta("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Me,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let r=0,s=e.length;r<s;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=ea(e[r].buffer));let a=new Ni(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),i=this.rbInsertRight(i,a)}this._searchCache=new t1(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=Ya,n=t-Math.floor(t/3),i=n*2,r="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=n||s+c<i)return r+=d,s+=c,!0;let u=r.replace(/\r\n|\r|\n/g,e);return a.push(new ta(u,ea(u))),r=d,s=c,!0}),s>0){let l=r.replace(/\r\n|\r|\n/g,e);a.push(new ta(l,ea(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new e1(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,i=>{if(i===Me)return!0;let r=this.getNodeContent(i),s=r.length,a=e.nodeAt(t),l=e.nodeAt(t+s),d=e.getValueInRange2(a,l);return t+=s,r===d})}getOffsetAt(e,t){let n=0,i=this.root;for(;i!==Me;)if(i.left!==Me&&i.lf_left+1>=e)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;let r=this.getAccumulatedValue(i,e-i.lf_left-2);return n+=r+t-1}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;for(;t!==Me;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let r=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+r.index,r.index===0){let s=this.getOffsetAt(n+1,1),a=i-s;return new R(n+1,a+1)}return new R(n+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===Me){let r=this.getOffsetAt(n+1,1),s=i-e-r;return new R(n+1,s+1)}else t=t.right;return new R(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(n,i);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+e.remainder,d+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),s=i.substring(r+e.remainder,r+n.piece.length);for(n=n.next();n!==Me;){let a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){s+=a.substring(l,l+t.remainder);break}else s+=a.substr(l,n.piece.length);n=n.next()}return s}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,r=>{if(r===Me)return!0;let s=r.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line,p=d[c]+s.start.column;if(i&&(l.charCodeAt(p)===10&&(p++,a--),e[t++]=n,n="",i=!1,a===0))return!0;if(c===u)return!this._EOLNormalized&&l.charCodeAt(p+a-1)===13?(i=!0,n+=l.substr(p,a-1)):n+=l.substr(p,a),!0;n+=this._EOLNormalized?l.substring(p,Math.max(p,d[c+1]-this._EOLLength)):l.substring(p,d[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let m=c+1;m<u;m++)n=this._EOLNormalized?l.substring(d[m],d[m+1]-this._EOLLength):l.substring(d[m],d[m+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return!this._EOLNormalized&&l.charCodeAt(d[u]+s.end.column-1)===13?(i=!0,s.end.column===0?t--:n=l.substr(d[u],s.end.column-1)):n=l.substr(d[u],s.end.column),!0}),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}else{let t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let n=t.node.next();if(!n||n===Me)return"";let i=this._buffers[n.piece.bufferIndex],r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.buffer.substring(r,r+n.piece.length)}else{let n=this._buffers[t.node.piece.bufferIndex],i=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=i+t.remainder,s=i+t.node.piece.length;return n.buffer.substring(r,s)}}findMatchesInNode(e,t,n,i,r,s,a,l,d,c,u){let p=this._buffers[e.piece.bufferIndex],m=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),g=this.offsetInBuffer(e.piece.bufferIndex,r),f=this.offsetInBuffer(e.piece.bufferIndex,s),b,v={line:0,column:0},I,C;t._wordSeparators?(I=p.buffer.substring(g,f),C=S=>S+g,t.reset(0)):(I=p.buffer,C=S=>S,t.reset(g));do if(b=t.next(I),b){if(C(b.index)>=f)return c;this.positionInBuffer(e,C(b.index)-m,v);let S=this.getLineFeedCnt(e.piece.bufferIndex,r,v),E=v.line===r.line?v.column-r.column+i:v.column+1,M=E+b[0].length;if(u[c++]=nd(new w(n+S,E,n+S,M),b,l),C(b.index)+b[0].length>=f||c>=d)return c}while(b);return c}findMatchesLineByLine(e,t,n,i){let r=[],s=0,a=new ja(t.wordSeparators,t.regex),l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let d=this.nodeAt2(e.endLineNumber,e.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,c,u,t,n,i,s,r),r;let p=e.startLineNumber,m=l.node;for(;m!==d.node;){let f=this.getLineFeedCnt(m.piece.bufferIndex,c,m.piece.end);if(f>=1){let v=this._buffers[m.piece.bufferIndex].lineStarts,I=this.offsetInBuffer(m.piece.bufferIndex,m.piece.start),C=v[c.line+f],S=p===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(m,a,p,S,c,this.positionInBuffer(m,C-I),t,n,i,s,r),s>=i)return r;p+=f}let b=p===e.startLineNumber?e.startColumn-1:0;if(p===e.endLineNumber){let v=this.getLineContent(p).substring(b,e.endColumn-1);return s=this._findMatchesInLine(t,a,v,e.endLineNumber,b,s,r,n,i),r}if(s=this._findMatchesInLine(t,a,this.getLineContent(p).substr(b),p,b,s,r,n,i),s>=i)return r;p++,l=this.nodeAt2(p,1),m=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(p===e.endLineNumber){let f=p===e.startLineNumber?e.startColumn-1:0,b=this.getLineContent(p).substring(f,e.endColumn-1);return s=this._findMatchesInLine(t,a,b,e.endLineNumber,f,s,r,n,i),r}let g=p===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(d.node,a,p,g,c,u,t,n,i,s,r),r}_findMatchesInLine(e,t,n,i,r,s,a,l,d){let c=e.wordSeparators;if(!l&&e.simpleSearch){let p=e.simpleSearch,m=p.length,g=n.length,f=-m;for(;(f=n.indexOf(p,f+m))!==-1;)if((!c||vI(c,n,g,f,m))&&(a[s++]=new Ql(new w(i,f+1+r,i,f+1+m+r),null),s>=d))return s;return s}let u;t.reset(0);do if(u=t.next(n),u&&(a[s++]=nd(new w(i,u.index+1+r,i,u.index+1+u[0].length+r),u,l),s>=d))return s;while(u);return s}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Me){let{node:i,remainder:r,nodeStartOffset:s}=this.nodeAt(e),a=i.piece,l=a.bufferIndex,d=this.positionInBuffer(i,r);if(i.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===e&&t.length<Ya){this.appendToNode(i,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(s+i.piece.length>e){let c=[],u=new Ni(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(i,r)===10){let f={line:u.start.line+1,column:0};u=new Ni(u.bufferIndex,f,u.end,this.getLineFeedCnt(u.bufferIndex,f,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(i,r-1)===13){let f=this.positionInBuffer(i,r-1);this.deleteNodeTail(i,f),t="\r"+t,i.piece.length===0&&c.push(i)}else this.deleteNodeTail(i,d);else this.deleteNodeTail(i,d);let p=this.createNewPieces(t);u.length>0&&this.rbInsertRight(i,u);let m=i;for(let g=0;g<p.length;g++)m=this.rbInsertRight(m,p[g]);this.deleteNodes(c)}else this.insertContentToNodeRight(t,i)}else{let i=this.createNewPieces(t),r=this.rbInsertLeft(null,i[0]);for(let s=1;s<i.length;s++)r=this.rbInsertRight(r,i[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Me)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),r=n.node,s=i.node;if(r===s){let p=this.positionInBuffer(r,n.remainder),m=this.positionInBuffer(r,i.remainder);if(n.nodeStartOffset===e){if(t===r.piece.length){let g=r.next();$g(this,r),this.validateCRLFWithPrevNode(g),this.computeBufferMetadata();return}this.deleteNodeHead(r,m),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,p),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,p,m),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);let d=this.positionInBuffer(s,i.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=r.next();for(let p=c;p!==Me&&p!==s;p=p.next())a.push(p);let u=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let s=t.piece,a={line:s.start.line+1,column:0},l=new Ni(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);t.piece=l,e+=`
`,Xs(this,t,-1,-1),t.piece.length===0&&n.push(t)}let i=this.createNewPieces(e),r=this.rbInsertLeft(t,i[i.length-1]);for(let s=i.length-2;s>=0;s--)r=this.rbInsertLeft(r,i[s]);this.validateCRLFWithPrevNode(r),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),r=i;for(let s=1;s<n.length;s++)r=this.rbInsertRight(r,n[s]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,r=e.piece.bufferIndex,s=this._buffers[r].lineStarts,l=s[i.start.line]+i.start.column+t,d=i.start.line,c=i.end.line,u=0,p=0,m=0;for(;d<=c&&(u=d+(c-d)/2|0,m=s[u],u!==c);)if(p=s[u+1],l<m)c=u-1;else if(l>=p)d=u+1;else break;return n?(n.line=u,n.column=l-m,null):{line:u,column:l-m}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let r=i[n.line+1],s=i[n.line]+n.column;if(r>s+1)return n.line-t.line;let a=s-1;return this._buffers[e].buffer.charCodeAt(a)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)$g(this,e[t])}createNewPieces(e){if(e.length>Ya){let c=[];for(;e.length>Ya;){let p=e.charCodeAt(Ya-1),m;p===13||p>=55296&&p<=56319?(m=e.substring(0,Ya-1),e=e.substring(Ya-1)):(m=e.substring(0,Ya),e=e.substring(Ya));let g=ea(m);c.push(new Ni(this._buffers.length,{line:0,column:0},{line:g.length-1,column:m.length-g[g.length-1]},g.length-1,m.length)),this._buffers.push(new ta(m,g))}let u=ea(e);return c.push(new Ni(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new ta(e,u)),c}let t=this._buffers[0].buffer.length,n=ea(e,!1),i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let c=0;c<n.length;c++)n[c]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let c=0;c<n.length;c++)n[c]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}let r=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new Ni(0,i,l,this.getLineFeedCnt(0,i,l),r-t);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,i="",r=this._searchCache.get2(e);if(r){n=r.node;let s=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e)i=a.substring(l+s,l+n.piece.length);else{let d=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return a.substring(l+s,l+d-t)}}else{let s=0,a=e;for(;n!==Me;)if(n.left!==Me&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this.getAccumulatedValue(n,e-n.lf_left-1),c=this._buffers[n.piece.bufferIndex].buffer,u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:s,nodeStartLineNumber:a-(e-1-n.lf_left)}),c.substring(u+l,u+d-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this._buffers[n.piece.bufferIndex].buffer,c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=d.substring(c+l,c+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==Me;){let s=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(n,0),l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=s.substring(l,l+a-t),i}else{let a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=s.substr(a,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==Me;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),r=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let s=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(s!==r)return{index:s,remainder:0}}return{index:r,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,r=n.start.line+t+1;return r>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[r]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.end),s=t,a=this.offsetInBuffer(n.bufferIndex,s),l=this.getLineFeedCnt(n.bufferIndex,n.start,s),d=l-i,c=a-r,u=n.length+c;e.piece=new Ni(n.bufferIndex,n.start,s,l,u),Xs(this,e,c,d)}deleteNodeHead(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.start),s=t,a=this.getLineFeedCnt(n.bufferIndex,s,n.end),l=this.offsetInBuffer(n.bufferIndex,s),d=a-i,c=r-l,u=n.length+c;e.piece=new Ni(n.bufferIndex,s,n.end,a,u),Xs(this,e,c,d)}shrinkNode(e,t,n){let i=e.piece,r=i.start,s=i.end,a=i.length,l=i.lineFeedCnt,d=t,c=this.getLineFeedCnt(i.bufferIndex,i.start,d),u=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,r);e.piece=new Ni(i.bufferIndex,i.start,d,c,u),Xs(this,e,u-a,c-l);let p=new Ni(i.bufferIndex,n,s,this.getLineFeedCnt(i.bufferIndex,n,s),this.offsetInBuffer(i.bufferIndex,s)-this.offsetInBuffer(i.bufferIndex,n)),m=this.rbInsertRight(e,p);this.validateCRLFWithPrevNode(m)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let r=ea(t,!1);for(let m=0;m<r.length;m++)r[m]+=i;if(n){let m=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-m}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=e.piece.length+t.length,c=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),p=u-c;e.piece=new Ni(e.piece.bufferIndex,e.piece.start,l,u,d),this._lastChangeBufferPos=l,Xs(this,e,t.length,p)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;for(;t!==Me;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){i+=t.size_left;let r={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,i=0;for(;n!==Me;)if(n.left!==Me&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2),s=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(r+t-1,s),nodeStartOffset:i}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+t-1<=n.piece.length)return{node:n,remainder:r+t-1,nodeStartOffset:i};t-=n.piece.length-r;break}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==Me;){if(n.piece.lineFeedCnt>0){let r=this.getAccumulatedValue(n,0),s=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,r),nodeStartOffset:s}}else if(n.piece.length>=t-1){let r=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:r}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Me||e.piece.lineFeedCnt===0)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,r=n[i]+t.start.column;return i===n.length-1||n[i+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Me||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n=[],i=this._buffers[e.piece.bufferIndex].lineStarts,r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:i[e.piece.end.line]-i[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};let s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Ni(e.piece.bufferIndex,e.piece.start,r,a,s),Xs(this,e,-1,-1),e.piece.length===0&&n.push(e);let l={line:t.piece.start.line+1,column:0},d=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Ni(t.piece.bufferIndex,l,t.piece.end,c,d),Xs(this,t,-1,-1),t.piece.length===0&&n.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let p=0;p<n.length;p++)$g(this,n[p])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)$g(this,n);else{let i=n.piece,r={line:i.start.line+1,column:0},s=i.length-1,a=this.getLineFeedCnt(i.bufferIndex,r,i.end);n.piece=new Ni(i.bufferIndex,r,i.end,a,s),Xs(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Me)return t(Me);let n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Me)return"";let t=this._buffers[e.piece.bufferIndex],n=e.piece,i=this.offsetInBuffer(n.bufferIndex,n.start),r=this.offsetInBuffer(n.bufferIndex,n.end);return t.buffer.substring(i,r)}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,i)}rbInsertRight(e,t){let n=new Lp(t,1);if(n.left=Me,n.right=Me,n.parent=Me,n.size_left=0,n.lf_left=0,this.root===Me)this.root=n,n.color=0;else if(e.right===Me)e.right=n,n.parent=e;else{let r=fI(e.right);r.left=n,n.parent=r}return ZL(this,n),n}rbInsertLeft(e,t){let n=new Lp(t,1);if(n.left=Me,n.right=Me,n.parent=Me,n.size_left=0,n.lf_left=0,this.root===Me)this.root=n,n.color=0;else if(e.left===Me)e.left=n,n.parent=e;else{let i=qL(e.left);i.right=n,n.parent=i}return ZL(this,n),n}getContentOfSubTree(e){let t="";return this.iterate(e,n=>(t+=this.getNodeContent(n),!0)),t}};var kp=class o extends W{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;constructor(e,t,n,i,r,s,a){super(),this._BOM=t,this._mightContainNonBasicASCII=!s,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._pieceTree=new yI(e,n,a)}equals(e){return!(e instanceof o)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t,i=this.getPositionAt(e),r=this.getPositionAt(n);return new w(i.lineNumber,i.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";let n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),i=this.getOffsetAt(e.endLineNumber,e.endColumn),r=0,s=this._getEndOfLine(t),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=e.endLineNumber-e.startLineNumber;r=l*d}return i-n+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0,i=e.startLineNumber,r=e.endLineNumber;for(let s=i;s<=r;s++){let a=this.getLineContent(s),l=s===i?e.startColumn-1:0,d=s===r?e.endColumn-1:a.length;for(let c=l;c<d;c++)Ot(a.charCodeAt(c))?(n=n+1,c=c+1):n=n+1}return n+=this._getEndOfLine(t).length*(r-i),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=$t(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=Zo(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let f=0;f<e.length;f++){let b=e[f];a&&b._isTracked&&(a=!1);let v=b.range;if(b.text){let M=!0;s||(M=!Qd(b.text),s=M),!i&&M&&(i=Wr(b.text)),!r&&M&&(r=gv(b.text))}let I="",C=0,S=0,E=0;if(b.text){let M;[C,S,E,M]=co(b.text);let A=this.getEOL(),F=A===`\r
`?2:1;M===0||M===F?I=b.text:I=b.text.replace(/\r\n|\r|\n/g,A)}l[f]={sortIndex:f,identifier:b.identifier||null,range:v,rangeOffset:this.getOffsetAt(v.startLineNumber,v.startColumn),rangeLength:this.getValueLengthInRange(v),text:I,eolCount:C,firstLineLength:S,lastLineLength:E,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(o._sortOpsAscending);let d=!1;for(let f=0,b=l.length-1;f<b;f++){let v=l[f].range.getEndPosition(),I=l[f+1].range.getStartPosition();if(I.isBeforeOrEqual(v)){if(I.isBefore(v))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=n||t?o._getInverseEditRanges(l):[],u=[];if(t)for(let f=0;f<l.length;f++){let b=l[f],v=c[f];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let I=v.startLineNumber;I<=v.endLineNumber;I++){let C="";I===v.startLineNumber&&(C=this.getLineContent(b.range.startLineNumber),$t(C)!==-1)||u.push({lineNumber:I,oldContent:C})}}let p=null;if(n){let f=0;p=[];for(let b=0;b<l.length;b++){let v=l[b],I=c[b],C=this.getValueInRange(v.range),S=v.rangeOffset+f;f+=v.text.length-C.length,p[b]={sortIndex:v.sortIndex,identifier:v.identifier,range:I,text:C,textChange:new Lo(v.rangeOffset,C,S,v.text)}}d||p.sort((b,v)=>b.sortIndex-v.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=s;let m=this._doApplyEdits(l),g=null;if(t&&u.length>0){u.sort((f,b)=>b.lineNumber-f.lineNumber),g=[];for(let f=0,b=u.length;f<b;f++){let v=u[f].lineNumber;if(f>0&&u[f-1].lineNumber===v)continue;let I=u[f].oldContent,C=this.getLineContent(v);C.length===0||C===I||$t(C)!==-1||g.push(v)}}return this._onDidChangeContent.fire(),new Ay(p,m,g)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,n=e[0].range,i=e[e.length-1].range,r=new w(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn),s=n.startLineNumber,a=n.startColumn,l=[];for(let m=0,g=e.length;m<g;m++){let f=e[m],b=f.range;t=t||f.forceMoveMarkers,l.push(this.getValueInRange(new w(s,a,b.startLineNumber,b.startColumn))),f.text.length>0&&l.push(f.text),s=b.endLineNumber,a=b.endColumn}let d=l.join(""),[c,u,p]=co(d);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:d,eolCount:c,firstLineLength:u,lastLineLength:p,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(o._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n],r=i.range.startLineNumber,s=i.range.startColumn,a=i.range.endLineNumber,l=i.range.endColumn;if(r===a&&s===l&&i.text.length===0)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);let d=new w(r,s,a,l);t.push({range:d,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let n=e.startLineNumber,i=e.startColumn,[r,s,a]=co(t),l;if(t.length>0){let d=r+1;d===1?l=new w(n,i,n,i+s):l=new w(n,i,n+d-1,a+1)}else l=new w(n,i,n,i);return l}static _getInverseEditRanges(e){let t=[],n=0,i=0,r=null;for(let s=0,a=e.length;s<a;s++){let l=e[s],d,c;r?r.range.endLineNumber===l.range.startLineNumber?(d=n,c=i+(l.range.startColumn-r.range.endColumn)):(d=n+(l.range.startLineNumber-r.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let u;if(l.text.length>0){let p=l.eolCount+1;p===1?u=new w(d,c,d,c+l.firstLineLength):u=new w(d,c,d+p-1,l.lastLineLength+1)}else u=new w(d,c,d,c);n=u.endLineNumber,i=u.endColumn,t.push(u),r=l}return t}static _sortOpsAscending(e,t){let n=w.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=w.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}};var n1=class{constructor(e,t,n,i,r,s,a,l,d){this._chunks=e;this._bom=t;this._cr=n;this._lf=i;this._crlf=r;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(e){let t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,s=n.length;r<s;r++){let a=n[r].buffer.replace(/\r\n|\r|\n/g,t),l=ea(a);n[r]=new ta(a,l)}let i=new kp(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},Dp=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&HM(e)&&(this.BOM=VM,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=aF(this._tmpLineStarts,e);this.chunks.push(new ta(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Wr(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=gv(e)))}finish(e=!0){return this._finish(),new n1(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=ea(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}};var i1=new class{clone(){return this}equals(o){return this===o}};function II(o,e){let t=new Uint32Array(2);return t[0]=0,t[1]=(o<<0|0|0|32768|2<<24)>>>0,new dy(t,e===null?i1:e)}var CI=class{constructor(e){this._default=e}_store=[];get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,n){if(e>=this._store.length)return;if(t===0){this.insert(e,n);return}else if(n===0){this.delete(e,t);return}let i=this._store.slice(0,e),r=this._store.slice(e+t),s=f5(n,this._default);this._store=i.concat(s,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;let n=[];for(let i=0;i<t;i++)n[i]=this._default;this._store=Ls(this._store,e,n)}};function f5(o,e){let t=[];for(let n=0;n<o;n++)t[n]=e;return t}var xc=class{static deserialize(e){let t=0,n=jn(e,t);t+=4;let i=[];for(let r=0;r<n;r++)t=hg.deserialize(e,t,i);return i}_tokens;constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let n=this._tokens[this._tokens.length-1];if(n.endLineNumber+1===e){n.appendLineTokens(t);return}}this._tokens.push(new hg(e,[t]))}finalize(){return this._tokens}serialize(){let e=this._serializeSize(),t=new Uint8Array(e);return this._serialize(t),t}_serializeSize(){let e=0;e+=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;qn(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++)t=this._tokens[n].serialize(e,t)}};var o1=class{constructor(e,t){this.tokenizationSupport=t;this.store=new Mp(e)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},SI=class extends o1{constructor(t,n,i,r){super(t,n);this._textModel=i;this._languageIdCodec=r}updateTokensUntilLine(t,n){let i=this._textModel.getLanguageId();for(;;){let r=this.getFirstInvalidLine();if(!r||r.lineNumber>n)break;let s=this._textModel.getLineContent(r.lineNumber),a=Rp(this._languageIdCodec,i,this.tokenizationSupport,s,!0,r.startState);t.add(r.lineNumber,a.tokens),this.store.setEndState(r.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(t,n){let i=this.getStartState(t.lineNumber);if(!i)return 0;let r=this._textModel.getLanguageId(),s=this._textModel.getLineContent(t.lineNumber),a=s.substring(0,t.column-1)+n+s.substring(t.column-1),l=Rp(this._languageIdCodec,r,this.tokenizationSupport,a,!0,i),d=new qt(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(t.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(t,n){let i=this.getStartState(t);if(!i)return{mainLineTokens:null,additionalLines:null};let r=this._textModel.getLineContent(t),s=n.lineEdit.apply(r),a=this._textModel.getLanguageIdAtPosition(t,0),l=Rp(this._languageIdCodec,a,this.tokenizationSupport,s,!0,i),d=null;if(n.additionalLines){d=[];let u=l.endState;for(let p of n.additionalLines){let m=Rp(this._languageIdCodec,a,this.tokenizationSupport,p,!0,u);d.push(new qt(m.tokens,p,this._languageIdCodec)),u=m.endState}}return{mainLineTokens:new qt(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n}isCheapToTokenize(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n||t===n&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,n,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,i),{heuristicTokens:!1};let r=this.guessStartState(n),s=this._textModel.getLanguageId();for(let a=n;a<=i;a++){let l=this._textModel.getLineContent(a),d=Rp(this._languageIdCodec,s,this.tokenizationSupport,l,!0,r);t.add(a,d.tokens),r=d.endState}return{heuristicTokens:!0}}guessStartState(t){let n=this._textModel.getLineFirstNonWhitespaceColumn(t),i=[],r=null;for(let l=t-1;n>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<n&&(i.push(this._textModel.getLineContent(l)),n=d,r=this.getStartState(l),r))break}r||(r=this.tokenizationSupport.getInitialState()),i.reverse();let s=this._textModel.getLanguageId(),a=r;for(let l of i)a=Rp(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},Mp=class{constructor(e){this.lineCount=e;this._invalidEndStatesLineNumbers.addRange(new Et(1,e+1))}_tokenizationStateStore=new r1;_invalidEndStatesLineNumbers=new s1;getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new Ke("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let n=this._tokenizationStateStore.setEndState(e,t);return n&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Et(e+1,e+2)),n}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new Et(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[n]=co(t.text);this.acceptChange(new Mi(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new Et(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;let n=this.getStartState(t,e);if(!n)throw new Ke("Start state must be defined");return{lineNumber:t,startState:n}}},r1=class{_lineEndStates=new CI(null);getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let n=this._lineEndStates.get(e);return n&&n.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let n=e.length;t>0&&n>0&&(n--,t--),this._lineEndStates.replace(e.startLineNumber,n,t)}acceptChanges(e){for(let t of e){let[n]=co(t.text);this.acceptChange(new Mi(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}},s1=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new Et(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(n=>n.contains(e));if(t!==-1){let n=this._ranges[t];n.start===e?n.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new Et(e+1,n.endExclusive):n.endExclusive===e+1?this._ranges[t]=new Et(n.start,e):this._ranges.splice(t,1,new Et(n.start,e),new Et(e+1,n.endExclusive))}}addRange(e){Et.addRange(e,this._ranges)}addRangeAndResize(e,t){let n=0;for(;!(n>=this._ranges.length||e.start<=this._ranges[n].endExclusive);)n++;let i=n;for(;!(i>=this._ranges.length||e.endExclusive<this._ranges[i].start);)i++;let r=t-e.length;for(let s=i;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(r);if(n===i){let s=new Et(e.start,e.start+t);s.isEmpty||this._ranges.splice(n,0,s)}else{let s=Math.min(e.start,this._ranges[n].start),a=Math.max(e.endExclusive,this._ranges[i-1].endExclusive),l=new Et(s,a+r);l.isEmpty?this._ranges.splice(n,i-n):this._ranges.splice(n,i-n,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}};function Rp(o,e,t,n,i,r){let s=null;if(t)try{s=t.tokenizeEncoded(n,i,r.clone())}catch(a){Ue(a)}return s||(s=II(o.encodeLanguageId(e),r)),qt.convertToEndOffset(s.tokens,n.length),s}var xI=class{constructor(e,t){this._tokenizerWithStateStore=e;this._backgroundTokenStore=t}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Wl(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),n=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?Yb(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new xc,n=to.create(!1);do if(n.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Mi(e,t))}};var _I=class{_onDidChangeVisibleRanges=new L;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let e=new a1(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}},a1=class{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){let n=e.map(i=>new Mi(i.startLineNumber,i.endLineNumber+1));this.handleStateChange({visibleLineRanges:n,stabilized:t})}},wI=class extends W{constructor(t){super();this._refreshTokens=t}runner=this._register(new zt(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){Kt(this._computedLineRanges,this._lineRanges,(t,n)=>t.equals(n))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},Pp=class extends W{constructor(t,n,i){super();this._languageIdCodec=t;this._textModel=n;this.getLanguageId=i}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new L);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new L);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}};var lF=Y("treeSitterParserService");var jg=class extends Pp{constructor(t,n,i,r){super(n,i,r);this._treeSitterService=t;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let t=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==t)&&(this._lastLanguageId=t,this._tokenizationSupport=gg.get(t))}getLineTokens(t){let n=this._textModel.getLineContent(t);if(this._tokenizationSupport){let i=this._tokenizationSupport.tokenizeEncoded(t,this._textModel);if(i)return new qt(i,n,this._languageIdCodec)}return qt.createEmpty(n,this._languageIdCodec)}resetTokenization(t=!0){t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(t){t.isFlush&&this.resetTokenization(!1)}forceTokenization(t){}hasAccurateTokensForLine(t){return!0}isCheapToTokenize(t){return!0}getTokenTypeIfInsertingCharacter(t,n,i){return 0}tokenizeLineWithEdit(t,n){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var qg=class o{_lineTokens;_len;_languageIdCodec;constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),i!==null&&i!==Ks)return new qt(Gs(i),n,this._languageIdCodec);let r=new Uint32Array(2);return r[0]=n.length,r[1]=dF(this._languageIdCodec.encodeLanguageId(e)),new qt(r,n,this._languageIdCodec)}static _massageTokens(e,t,n){let i=n?Gs(n):null;if(t===0){let r=!1;if(i&&i.length>1&&(r=ko.getLanguageId(i[1])!==e),!r)return Ks}if(!i||i.length===0){let r=new Uint32Array(2);return r[0]=t,r[1]=dF(e),r.buffer}return i[i.length-2]=t,i.byteOffset===0&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=Ls(this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,r){let s=o._massageTokens(this._languageIdCodec.encodeLanguageId(e),n,i);this._ensureLine(t);let a=this._lineTokens[t];return this._lineTokens[t]=s,r?!o._equals(a,s):!1}static _equals(e,t){if(!e||!t)return!e&&!t;let n=Gs(e),i=Gs(t);if(n.length!==i.length)return!1;for(let r=0,s=n.length;r<s;r++)if(n[r]!==i[r])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new R(e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){let t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=Yn.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=Yn.deleteEnding(this._lineTokens[t],e.startColumn-1);let n=e.endLineNumber-1,i=null;n<this._len&&(i=Yn.deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=Yn.append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-1;if(!(i>=this._len)){if(t===0){this._lineTokens[i]=Yn.insert(this._lineTokens[i],e.column-1,n);return}this._lineTokens[i]=Yn.deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=Yn.insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&n.push({fromLineNumber:a,toLineNumber:l})}return{changes:n}}};function dF(o){return(o<<0|0|0|32768|2<<24|1024)>>>0}var EI=class o{_pieces;_isComplete;_languageIdCodec;constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){let r=t[0].getRange(),s=t[t.length-1].getRange();if(!r||!s)return e;n=e.plusRange(r).plusRange(s)}let i=null;for(let r=0,s=this._pieces.length;r<s;r++){let a=this._pieces[r];if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};break}if(a.removeTokens(n),a.isEmpty()){this._pieces.splice(r,1),r--,s--;continue}if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};continue}let[l,d]=a.split(n);if(l.isEmpty()){i=i||{index:r};continue}d.isEmpty()||(this._pieces.splice(r,1,l,d),r++,s++,i=i||{index:r})}return i=i||{index:this._pieces.length},t.length>0&&(this._pieces=Ls(this._pieces,i.index,t)),n}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;let n=this._pieces;if(n.length===0)return t;let i=o._findFirstPieceWithLine(n,e),r=n[i].getLineTokens(e);if(!r)return t;let s=t.getCount(),a=r.getCount(),l=0,d=[],c=0,u=0,p=(m,g)=>{m!==u&&(u=m,d[c++]=m,d[c++]=g)};for(let m=0;m<a;m++){let g=r.getStartCharacter(m),f=r.getEndCharacter(m),b=r.getMetadata(m),v=((b&1?2048:0)|(b&2?4096:0)|(b&4?8192:0)|(b&8?16384:0)|(b&16?16744448:0)|(b&32?4278190080:0))>>>0,I=~v>>>0;for(;l<s&&t.getEndOffset(l)<=g;)p(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<s&&t.getStartOffset(l)<g&&p(g,t.getMetadata(l));l<s&&t.getEndOffset(l)<f;)p(t.getEndOffset(l),t.getMetadata(l)&I|b&v),l++;if(l<s)p(f,t.getMetadata(l)&I|b&v),t.getEndOffset(l)===f&&l++;else{let C=Math.min(Math.max(0,l-1),s-1);p(f,t.getMetadata(C)&I|b&v)}}for(;l<s;)p(t.getEndOffset(l),t.getMetadata(l)),l++;return new qt(new Uint32Array(d),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;for(;n<i;){let r=n+Math.floor((i-n)/2);if(e[r].endLineNumber<t)n=r+1;else if(e[r].startLineNumber>t)i=r-1;else{for(;r>n&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return n}acceptEdit(e,t,n,i,r){for(let s of this._pieces)s.acceptEdit(e,t,n,i,r)}};var Qa=class extends _p{constructor(t,n,i,r,s,a,l){super();this._textModel=t;this._bracketPairsTextModelPart=n;this._languageId=i;this._attachedViews=r;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(de.filter(gg.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new EI(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new L);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new L);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new L);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new te);createGrammarTokens(){return this._register(new TI(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new jg(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(t){let n=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=t?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),n&&this._tokens.resetTokenization()}createPreferredTokenProvider(){gg.get(this._languageId)?this._tokens instanceof jg||this.createTokens(!0):this._tokens instanceof TI||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(t){t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(let n of t.changes){let[i,r,s]=co(n.text);this._semanticTokens.acceptEdit(n.range,i,r,s,n.text.length>0?n.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(t)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);let n=this._tokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,n)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new Ke("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this._tokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this._tokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this._tokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this._tokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,n,i){return this._tokens.getTokenTypeIfInsertingCharacter(t,n,i)}tokenizeLineWithEdit(t,n){return this._tokens.tokenizeLineWithEdit(t,n)}setSemanticTokens(t,n){this._semanticTokens.set(t,n),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,n){if(this.hasCompleteSemanticTokens())return;let i=this._textModel.validateRange(this._semanticTokens.setPartial(t,n));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();let n=this._textModel.validatePosition(t),i=this._textModel.getLineContent(n.lineNumber),r=this.getLineTokens(n.lineNumber),s=r.findTokenIndexAtOffset(n.column-1),[a,l]=Qa._findLanguageBoundaries(r,s),d=dg(n.column,this.getLanguageConfiguration(r.getLanguageId(s)).getWordDefinition(),i.substring(a,l),a);if(d&&d.startColumn<=t.column&&t.column<=d.endColumn)return d;if(s>0&&a===n.column-1){let[c,u]=Qa._findLanguageBoundaries(r,s-1),p=dg(n.column,this.getLanguageConfiguration(r.getLanguageId(s-1)).getWordDefinition(),i.substring(c,u),c);if(p&&p.startColumn<=t.column&&t.column<=p.endColumn)return p}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,n){let i=t.getLanguageId(n),r=0;for(let a=n;a>=0&&t.getLanguageId(a)===i;a--)r=t.getStartOffset(a);let s=t.getLineContent().length;for(let a=n,l=t.getCount();a<l&&t.getLanguageId(a)===i;a++)s=t.getEndOffset(a);return[r,s]}getWordUntilPosition(t){let n=this.getWordAtPosition(t);return n?{word:n.word.substr(0,t.column-n.startColumn),startColumn:n.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,n){let i=this._textModel.validatePosition(new R(t,n)),r=this.getLineTokens(i.lineNumber);return r.getLanguageId(r.findTokenIndexAtOffset(i.column-1))}setLanguageId(t,n="api"){if(this._languageId===t)return;let i={oldLanguage:this._languageId,newLanguage:t,source:n};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};Qa=K([D(4,Ki),D(5,Fn),D(6,lF)],Qa);var TI=class extends Pp{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new Ut);_tokens=new qg(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new Ut);_attachedViewStates=this._register(new Yo);constructor(e,t,n,i){super(e,t,n),this._register(uo.onDidChange(r=>{let s=this.getLanguageId();r.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(i.onDidChangeVisibleRanges(({view:r,state:s})=>{if(s){let a=this._attachedViewStates.get(r);a||(a=new wI(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(r)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new Mp(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let r=uo.get(this.getLanguageId());if(!r)return[null,null];let s;try{s=r.getInitialState()}catch(a){return Ue(a),[null,null]}return[r,s]},[n,i]=t();if(n&&i?this._tokenizer=new SI(this._textModel.getLineCount(),n,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let r={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};n&&n.createBackgroundTokenizer&&!n.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,r)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new xI(this._tokenizer,r),this._defaultBackgroundTokenizer.handleChanges()),n?.backgroundTokenizerShouldOnlyVerifyTokens&&n.createBackgroundTokenizer?(this._debugBackgroundTokens=new qg(this._languageIdCodec),this._debugBackgroundStates=new Mp(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(let t of e.changes){let[n,i]=co(t.text);this._tokens.acceptEdit(t.range,n,i),this._debugBackgroundTokens?.acceptEdit(t.range,n,i)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){let{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){let e=Mi.joinMany([...this._attachedViewStates].map(([t,n])=>n.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(let t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);let n=new xc,{heuristicTokens:i}=this._tokenizer.tokenizeHeuristically(n,e,t),r=this.setTokens(n.finalize());if(i)for(let s of r.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){let t=new xc;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){let t=this._textModel.getLineContent(e),n=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){let i=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!n.equals(i)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return n}getTokenTypeIfInsertingCharacter(e,t,n){if(!this._tokenizer)return 0;let i=this._textModel.validatePosition(new R(e,t));return this.forceTokenization(i.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLineWithEdit(e,t)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function f1(o){let e=new Dp;return e.acceptChunk(o),e.finish()}function hF(o){return new Promise((e,t)=>{let n=new Dp,i=!1;wT(o,{onData:r=>{n.acceptChunk(typeof r=="string"?r:r.toString())},onError:r=>{i||(i=!0,t(r))},onEnd:()=>{i||(i=!0,e(n.finish()))}})})}function b5(o){let e=new Dp,t;for(;typeof(t=o.read())=="string";)e.acceptChunk(t);return e.finish()}function cF(o,e){let t;return typeof o=="string"?t=f1(o):vA(o)?t=b5(o):t=o,t.create(e)}var LI=0,v5=999,y5=1e4,d1=class{_source;_eos;constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;do{let i=this._source.read();if(i===null)return this._eos=!0,t===0?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=64*1024)return e.join("")}while(!0)}},Yg=()=>{throw new Error("Invalid change accessor")};var ia=class extends W{constructor(t,n,i,r=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;LI++,this.id="$model"+LI,this.isForSimpleWidget=i.isForSimpleWidget,typeof r>"u"||r===null?this._associatedResource=be.parse("inmemory://model/"+LI):this._associatedResource=r,this._attachedEditorCount=0;let{textBuffer:c,disposable:u}=cF(t,i.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=ia.resolveOptions(this._buffer,i);let p=typeof n=="string"?n:n.languageId;typeof n!="string"&&(this._languageSelectionListener.value=n.onDidChange(()=>this._setLanguage(n.languageId))),this._bracketPairs=this._register(new Ky(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new gI(this,this._languageConfigurationService)),this._decorationProvider=this._register(new uI(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(Qa,this,this._bracketPairs,p,this._attachedViews);let m=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new w(1,1,m,this._buffer.getLineLength(m)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=g>ia.LARGE_FILE_SIZE_THRESHOLD||m>ia.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>ia.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=g>ia._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=fv(LI),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new DI,this._commandManager=new mI(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(f=>{this._bracketPairs.handleLanguageConfigurationServiceChange(f),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(f)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Vs.tabSize,indentSize:Vs.indentSize,insertSpaces:Vs.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Vs.trimAutoWhitespace,largeFileOptimizations:Vs.largeFileOptimizations,bracketPairColorizationOptions:Vs.bracketPairColorizationOptions};static resolveOptions(t,n){if(n.detectIndentation){let i=GL(t,n.tabSize,n.insertSpaces);return new sp({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:n.trimAutoWhitespace,defaultEOL:n.defaultEOL,bracketPairColorizationOptions:n.bracketPairColorizationOptions})}return new sp(n)}_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new h1(t=>this.handleBeforeFireDecorationsChangedEvent(t)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new L);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new L);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new L);_eventEmitter=this._register(new m1);onDidChangeContent(t){return this._eventEmitter.slowEvent(n=>t(n.contentChangedEvent))}onDidChangeContentOrInjectedText(t){return Ts(this._eventEmitter.fastEvent(n=>t(n)),this._onDidChangeInjectedText.event(n=>t(n)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new Ut);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new _I;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let t=new kp([],"",`
`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=W.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new Ke("Model is disposed!")}equalsTextBuffer(t){return this._assertNotDisposed(),this._buffer.equals(t)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(t,n){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(n),this._bracketPairs.handleDidChangeContent(n),this._eventEmitter.fire(new Yl(t,n)))}setValue(t){if(this._assertNotDisposed(),t==null)throw Ad();let{textBuffer:n,disposable:i}=cF(t,this._options.defaultEOL);this._setValueFromTextBuffer(n,i)}_createContentChanged2(t,n,i,r,s,a,l,d){return{changes:[{range:t,rangeOffset:n,rangeLength:i,text:r}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(t,n){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=n,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new DI,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new fc([new ky],this._versionId,!1,!1),this._createContentChanged2(new w(1,1,s,a),0,r,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();let n=t===1?`\r
`:`
`;if(this._buffer.getEOL()===n)return;let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(n),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new fc([new My],this._versionId,!1,!1),this._createContentChanged2(new w(1,1,s,a),0,r,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let t=this.getVersionId(),n=this._decorationsTree.collectNodesPostOrder();for(let i=0,r=n.length;i<r;i++){let s=n[i],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=t,s.start=d-l,s.end=c-l,$a(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,n=0,i=this._buffer.getLineCount();for(let r=1;r<=i;r++){let s=this._buffer.getLineLength(r);s>=y5?n+=s:t+=s}return n>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();let n=typeof t.tabSize<"u"?t.tabSize:this._options.tabSize,i=typeof t.indentSize<"u"?t.indentSize:this._options.originalIndentSize,r=typeof t.insertSpaces<"u"?t.insertSpaces:this._options.insertSpaces,s=typeof t.trimAutoWhitespace<"u"?t.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof t.bracketColorizationOptions<"u"?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new sp({tabSize:n,indentSize:i,insertSpaces:r,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(t,n){this._assertNotDisposed();let i=GL(this._buffer,n,t);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),Wy(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){let n=this.findMatches(Xw.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,n.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();let n=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(n.lineNumber,n.column)}getPositionAt(t){this._assertNotDisposed();let n=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(n)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,n=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Ke("Operation would exceed heap memory limits");let i=this.getFullModelRange(),r=this.getValueInRange(i,t);return n?this._buffer.getBOM()+r:r}createSnapshot(t=!1){return new d1(this._buffer.createSnapshot(t))}getValueLength(t,n=!1){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i,t);return n?this._buffer.getBOM().length+r:r}getValueInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),n)}getValueLengthInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),n)}getCharacterCountInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),n)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ke("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ke("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Ke("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ke("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ke("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Ke("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){let n=this._buffer.getLineCount(),i=t.startLineNumber,r=t.startColumn,s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=Math.floor(typeof r=="number"&&!isNaN(r)?r:1);if(s<1)s=1,a=1;else if(s>n)s=n,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let p=this.getLineMaxColumn(s);a>=p&&(a=p)}let l=t.endLineNumber,d=t.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),u=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,u=1;else if(c>n)c=n,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{let p=this.getLineMaxColumn(c);u>=p&&(u=p)}return i===s&&r===a&&l===c&&d===u&&t instanceof w&&!(t instanceof De)?t:new w(s,a,c,u)}_isValidPosition(t,n,i){if(typeof t!="number"||typeof n!="number"||isNaN(t)||isNaN(n)||t<1||n<1||(t|0)!==t||(n|0)!==n)return!1;let r=this._buffer.getLineCount();if(t>r)return!1;if(n===1)return!0;let s=this.getLineMaxColumn(t);if(n>s)return!1;if(i===1){let a=this._buffer.getLineCharCode(t,n-2);if(Ot(a))return!1}return!0}_validatePosition(t,n,i){let r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=this._buffer.getLineCount();if(r<1)return new R(1,1);if(r>a)return new R(a,this.getLineMaxColumn(a));if(s<=1)return new R(r,1);let l=this.getLineMaxColumn(r);if(s>=l)return new R(r,l);if(i===1){let d=this._buffer.getLineCharCode(r,s-2);if(Ot(d))return new R(r,s-1)}return new R(r,s)}validatePosition(t){let n=1;return this._assertNotDisposed(),t instanceof R&&this._isValidPosition(t.lineNumber,t.column,n)?t:this._validatePosition(t.lineNumber,t.column,n)}_isValidRange(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn;if(!this._isValidPosition(i,r,0)||!this._isValidPosition(s,a,0))return!1;if(n===1){let l=r>1?this._buffer.getLineCharCode(i,r-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=Ot(l),u=Ot(d);return!c&&!u}return!0}validateRange(t){let n=1;if(this._assertNotDisposed(),t instanceof w&&!(t instanceof De)&&this._isValidRange(t,n))return t;let i=this._validatePosition(t.startLineNumber,t.startColumn,0),r=this._validatePosition(t.endLineNumber,t.endColumn,0),s=i.lineNumber,a=i.column,l=r.lineNumber,d=r.column;if(n===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,u=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,p=Ot(c),m=Ot(u);return!p&&!m?new w(s,a,l,d):s===l&&a===d?new w(s,a-1,l,d-1):p&&m?new w(s,a-1,l,d+1):p?new w(s,a-1,l,d):new w(s,a,l,d+1)}return new w(s,a,l,d)}modifyPosition(t,n){this._assertNotDisposed();let i=this.getOffsetAt(t)+n;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();let t=this.getLineCount();return new w(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,n,i,r){return this._buffer.findMatchesLineByLine(t,n,i,r)}findMatches(t,n,i,r,s,a,l=v5){this._assertNotDisposed();let d=null;n!==null&&(Array.isArray(n)||(n=[n]),n.every(p=>w.isIRange(p))&&(d=n.map(p=>this.validateRange(p)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((p,m)=>p.startLineNumber-m.startLineNumber||p.startColumn-m.startColumn);let c=[];c.push(d.reduce((p,m)=>w.areIntersecting(p,m)?p.plusRange(m):(c.push(p),m)));let u;if(!i&&t.indexOf(`
`)<0){let m=new qa(t,i,r,s).parseSearchRequest();if(!m)return[];u=g=>this.findMatchesLineByLine(g,m,a,l)}else u=p=>Sc.findMatches(this,new qa(t,i,r,s),p,a,l);return c.map(u).reduce((p,m)=>p.concat(m),[])}findNextMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);if(!i&&t.indexOf(`
`)<0){let c=new qa(t,i,r,s).parseSearchRequest();if(!c)return null;let u=this.getLineCount(),p=new w(l.lineNumber,l.column,u,this.getLineMaxColumn(u)),m=this.findMatchesLineByLine(p,c,a,1);return Sc.findNextMatch(this,new qa(t,i,r,s),l,a),m.length>0||(p=new w(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),m=this.findMatchesLineByLine(p,c,a,1),m.length>0)?m[0]:null}return Sc.findNextMatch(this,new qa(t,i,r,s),l,a)}findPreviousMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);return Sc.findPreviousMatch(this,new qa(t,i,r,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`
`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof ap?t:new ap(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){let n=[];for(let i=0,r=t.length;i<r;i++)n[i]=this._validateEditOperation(t[i]);return n}pushEditOperations(t,n,i,r){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(n),i,r)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,n,i,r){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=n.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(t)for(let l=0,d=t.length;l<d;l++){let c=t[l],u=!1;for(let p=0,m=s.length;p<m;p++){let g=s[p].range,f=g.startLineNumber>c.endLineNumber,b=c.startLineNumber>g.endLineNumber;if(!f&&!b){u=!0;break}}if(!u){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],u=this.getLineMaxColumn(c),p=!0;for(let m=0,g=s.length;m<g;m++){let f=s[m].range,b=s[m].text;if(!(c<f.startLineNumber||c>f.endLineNumber)&&!(c===f.startLineNumber&&f.startColumn===u&&f.isEmpty()&&b&&b.length>0&&b.charAt(0)===`
`)&&!(c===f.startLineNumber&&f.startColumn===1&&f.isEmpty()&&b&&b.length>0&&b.charAt(b.length-1)===`
`)){p=!1;break}}if(p){let m=new w(c,1,c,u);n.push(new ap(null,m,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,n,i,r)}_applyUndo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new w(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,n,!0,!1,i,r)}_applyRedo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new w(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,n,!1,!0,i,r)}_applyUndoRedoEdits(t,n,i,r,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=r,this.applyEdits(t,!1),this.setEOL(n),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,n=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let i=this._validateEditOperations(t);return this._doApplyEdits(i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,n){let i=this._buffer.getLineCount(),r=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,n),s=this._buffer.getLineCount(),a=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,u=a.length;c<u;c++){let p=a[c];this._decorationsTree.acceptReplace(p.rangeOffset,p.rangeLength,p.text.length,p.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=i;for(let c=0,u=a.length;c<u;c++){let p=a[c],[m]=co(p.text);this._onDidChangeDecorations.fire();let g=p.range.startLineNumber,f=p.range.endLineNumber,b=f-g,v=m,I=Math.min(b,v),C=v-b,S=s-d-C+g,E=S,M=S+v,A=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new R(E,1)),this.getOffsetAt(new R(M,this.getLineMaxColumn(M))),0),F=po.fromDecorations(A),O=new no(F);for(let H=I;H>=0;H--){let U=g+H,z=S+H;O.takeFromEndWhile(ve=>ve.lineNumber>z);let re=O.takeFromEndWhile(ve=>ve.lineNumber===z);l.push(new Eg(U,this.getLineContent(z),re))}if(I<b){let H=g+I;l.push(new Dy(H+1,f))}if(I<v){let H=new no(F),U=g+I,z=v-I,re=s-d-z+U+1,ve=[],ee=[];for(let Q=0;Q<z;Q++){let ae=re+Q;ee[Q]=this.getLineContent(ae),H.takeWhile(ne=>ne.lineNumber<ae),ve[Q]=H.takeWhile(ne=>ne.lineNumber===ae)}l.push(new Ry(U+1,g+v,ee,ve))}d+=C}this._emitContentChangedEvent(new fc(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;let i=Array.from(t).map(r=>new Eg(r,this.getLineContent(r),this._getInjectedTextInLine(r)));this._onDidChangeInjectedText.fire(new op(i))}changeDecorations(t,n=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(n,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,n){let i={addDecoration:(s,a)=>this._deltaDecorationsImpl(t,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,pF(a))},removeDecoration:s=>{this._deltaDecorationsImpl(t,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(t,s,a)},r=null;try{r=n(i)}catch(s){Ue(s)}return i.addDecoration=Yg,i.changeDecoration=Yg,i.changeDecorationOptions=Yg,i.removeDecoration=Yg,i.deltaDecorations=Yg,r}deltaDecorations(t,n,i=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&n.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Ue(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,t,n)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,n,i){let r=t?this._decorations[t]:null;if(!r)return n?this._deltaDecorationsImpl(0,[],[{range:n,options:uF[i]}],!0)[0]:null;if(!n)return this._decorationsTree.delete(r),delete this._decorations[r.id],null;let s=this._validateRangeRelaxedNoAllocations(n),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(r),r.reset(this.getVersionId(),a,l,s),r.setOptions(uF[i]),this._decorationsTree.insert(r),r.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;let n=this._decorationsTree.collectNodesFromOwner(t);for(let i=0,r=n.length;i<r;i++){let s=n[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(t){let n=this._decorations[t];return n?n.options:null}getDecorationRange(t){let n=this._decorations[t];return n?this._decorationsTree.getNodeRange(this,n):null}getLineDecorations(t,n=0,i=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,n,i)}getLinesDecorations(t,n,i=0,r=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,t)),d=Math.min(a,Math.max(1,n)),c=this.getLineMaxColumn(d),u=new w(l,1,d,c),p=this._getDecorationsInRange(u,i,r,s);return Mw(p,this._decorationProvider.getDecorationsInRange(u,i,r)),p}getDecorationsInRange(t,n=0,i=!1,r=!1,s=!1){let a=this.validateRange(t),l=this._getDecorationsInRange(a,n,i,s);return Mw(l,this._decorationProvider.getDecorationsInRange(a,n,i,r)),l}getOverviewRulerDecorations(t=0,n=!1){return this._decorationsTree.getAll(this,t,n,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){let n=this._buffer.getOffsetAt(t,1),i=n+this._buffer.getLineLength(t),r=this._decorationsTree.getInjectedTextInInterval(this,n,i,0);return po.fromDecorations(r).filter(s=>s.lineNumber===t)}getAllDecorations(t=0,n=!1){let i=this._decorationsTree.getAll(this,t,n,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(t,n)),i}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,n,i,r){let s=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),a=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,n,i,r)}getRangeAt(t,n){return this._buffer.getRangeAt(t,n-t)}_changeDecorationImpl(t,n){let i=this._decorations[t];if(!i)return;if(i.options.after){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let r=this._validateRangeRelaxedNoAllocations(n),s=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,a,r),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber)}_changeDecorationOptionsImpl(t,n){let i=this._decorations[t];if(!i)return;let r=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(n.overviewRuler&&n.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(n),i.options.after||n.after){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(i.options.before||n.before){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=r!==s,l=C5(n)!==kI(i);a||l?(this._decorationsTree.delete(i),i.setOptions(n),this._decorationsTree.insert(i)):i.setOptions(n)}_deltaDecorationsImpl(t,n,i,r=!1){let s=this.getVersionId(),a=n.length,l=0,d=i.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let u=new Array(d);for(;l<a||c<d;){let p=null;if(l<a){do p=this._decorations[n[l++]];while(!p&&l<a);if(p){if(p.options.after){let m=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.endLineNumber)}if(p.options.before){let m=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.startLineNumber)}this._decorationsTree.delete(p),r||this._onDidChangeDecorations.checkAffectedAndFire(p.options)}}if(c<d){if(!p){let I=++this._lastDecorationId,C=`${this._instanceId};${I}`;p=new Ug(C,0,0),this._decorations[C]=p}let m=i[c],g=this._validateRangeRelaxedNoAllocations(m.range),f=pF(m.options),b=this._buffer.getOffsetAt(g.startLineNumber,g.startColumn),v=this._buffer.getOffsetAt(g.endLineNumber,g.endColumn);p.ownerId=t,p.reset(s,b,v,g),p.setOptions(f),p.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.endLineNumber),p.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.startLineNumber),r||this._onDidChangeDecorations.checkAffectedAndFire(f),this._decorationsTree.insert(p),u[c]=p.id,c++}else p&&delete this._decorations[p.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,n){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,n)):(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId,n)),this._setLanguage(t.languageId,n))}_setLanguage(t,n){this.tokenization.setLanguageId(t,n),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,n){return this.tokenization.getLanguageIdAtPosition(t,n)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,n){return t}getLineIndentColumn(t){return I5(this.getLineContent(t))+1}};ia=K([D(4,bA),D(5,Ki),D(6,Fn),D(7,ct)],ia);function I5(o){let e=0;for(let t of o)if(t===" "||t==="	")e++;else break;return e}function l1(o){return!!(o.options.overviewRuler&&o.options.overviewRuler.color)}function C5(o){return!!o.after||!!o.before}function kI(o){return!!o.options.after||!!o.options.before}var DI=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new Ep,this._decorationsTree1=new Ep,this._injectedTextDecorationsTree=new Ep}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(let n of t)n.range===null&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,r,s){let a=e.getVersionId(),l=this._intervalSearch(t,n,i,r,a,s);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,n,i,r,s){let a=this._decorationsTree0.intervalSearch(e,t,n,i,r,s),l=this._decorationsTree1.intervalSearch(e,t,n,i,r,s),d=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,r,s);return a.concat(l).concat(d)}getInjectedTextInInterval(e,t,n,i){let r=e.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,r,!1);return this._ensureNodesHaveRanges(e,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){let n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n,!1);return this._ensureNodesHaveRanges(e,i).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAll(e,t,n,i,r){let s=e.getVersionId(),a=this._search(t,n,i,s,r);return this._ensureNodesHaveRanges(e,a)}_search(e,t,n,i,r){if(n)return this._decorationsTree1.search(e,t,i,r);{let s=this._decorationsTree0.search(e,t,i,r),a=this._decorationsTree1.search(e,t,i,r),l=this._injectedTextDecorationsTree.search(e,t,i,r);return s.concat(a).concat(l)}}collectNodesFromOwner(e){let t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){let e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){kI(e)?this._injectedTextDecorationsTree.insert(e):l1(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){kI(e)?this._injectedTextDecorationsTree.delete(e):l1(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){let n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){kI(e)?this._injectedTextDecorationsTree.resolveNode(e,t):l1(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}};function na(o){return o.replace(/[^a-z0-9\-_]/gi," ")}var RI=class{color;darkColor;constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}},c1=class extends RI{position;_resolvedColor;constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:2}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}},u1=class{position;persistLane;constructor(e){this.position=e?.position??2,this.persistLane=e?.persistLane}},p1=class extends RI{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?G.fromHex(e):t.getColor(e.id)}},MI=class o{static from(e){return e instanceof o?e:new o(e)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}},Ln=class o{static EMPTY;static register(e){return new o(e)}static createDynamic(e){return new o(e)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?na(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?na(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new c1(e.overviewRuler):null,this.minimap=e.minimap?new p1(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new u1(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?na(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?na(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?na(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?BM(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?na(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?na(e.marginClassName):null,this.inlineClassName=e.inlineClassName?na(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?na(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?na(e.afterContentClassName):null,this.after=e.after?MI.from(e.after):null,this.before=e.before?MI.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}};Ln.EMPTY=Ln.register({description:"empty"});var uF=[Ln.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),Ln.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),Ln.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),Ln.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function pF(o){return o instanceof Ln?o:Ln.createDynamic(o)}var h1=class extends W{constructor(t){super();this.handleBeforeFire=t;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new L);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){this._affectsMinimap||=!!t.minimap?.position,this._affectsOverviewRuler||=!!t.overviewRuler?.color,this._affectsGlyphMargin||=!!t.glyphMarginClassName,this._affectsLineNumber||=!!t.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}},m1=class extends W{_fastEmitter=this._register(new L);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new L);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;let t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}};var _c=Y("workingCopyService"),b1=class extends W{_onDidRegister=this._register(new L);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new L);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new Vi;mapWorkingCopyToListeners=this._register(new Yo);registerWorkingCopy(e){let t=this.mapResourceToWorkingCopies.get(e.resource);if(t?.has(e.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${e.resource.toString()} and type ${e.typeId}.`);this._workingCopies.add(e),t||(t=new Map,this.mapResourceToWorkingCopies.set(e.resource,t)),t.set(e.typeId,e);let n=new te;return n.add(e.onDidChangeContent(()=>this._onDidChangeContent.fire(e))),n.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),n.add(e.onDidSave(i=>this._onDidSave.fire({workingCopy:e,...i}))),this.mapWorkingCopyToListeners.set(e,n),this._onDidRegister.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e),ge(()=>{this.unregisterWorkingCopy(e),this._onDidUnregister.fire(e)})}unregisterWorkingCopy(e){this._workingCopies.delete(e);let t=this.mapResourceToWorkingCopies.get(e.resource);t?.delete(e.typeId)&&t.size===0&&this.mapResourceToWorkingCopies.delete(e.resource),e.isDirty()&&this._onDidChangeDirty.fire(e),this.mapWorkingCopyToListeners.deleteAndDispose(e)}has(e){return be.isUri(e)?this.mapResourceToWorkingCopies.has(e):this.mapResourceToWorkingCopies.get(e.resource)?.has(e.typeId)??!1}get(e){return this.mapResourceToWorkingCopies.get(e.resource)?.get(e.typeId)}getAll(e){let t=this.mapResourceToWorkingCopies.get(e);if(t)return Array.from(t.values())}get hasDirty(){for(let e of this._workingCopies)if(e.isDirty())return!0;return!1}get dirtyCount(){let e=0;for(let t of this._workingCopies)t.isDirty()&&e++;return e}get dirtyWorkingCopies(){return this.workingCopies.filter(e=>e.isDirty())}get modifiedCount(){let e=0;for(let t of this._workingCopies)t.isModified()&&e++;return e}get modifiedWorkingCopies(){return this.workingCopies.filter(e=>e.isModified())}isDirty(e,t){let n=this.mapResourceToWorkingCopies.get(e);if(n){if(typeof t=="string")return n.get(t)?.isDirty()??!1;for(let[,i]of n)if(i.isDirty())return!0}return!1}};$i(_c,b1,1);var Qg=Y("labelService");var sr=Y("telemetryService"),EIe=Y("customEndpointTelemetryService");function v1(o,e=dt){return iE(o,e)?o.charAt(0).toUpperCase()+o.slice(1):o}var mF=Y("productService");var dCe=Y("dialogService");var cCe=Y("fileDialogService");var Za=class extends Xg{_onDidChangeDirty=this._register(new L);_onDidChangeLabel=this._register(new L);_onDidChangeCapabilities=this._register(new L);_onWillDispose=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(Ao(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:aE(this.resource,Ap.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var No=class extends Za{constructor(t,n,i,r,s){super();this.preferredName=t;this.preferredDescription=n;this.secondary=i;this.primary=r;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return No.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(de.once(de.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let t=this.getPreferredName();return t||(this.hasIdenticalSides?this.primary.getName():h("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(t){let n=this.getPreferredDescription();return n||(this.hasIdenticalSides?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.preferredDescription}getTitle(t){let n;this.hasIdenticalSides?n=this.primary.getTitle(t)??this.getName():n=super.getTitle(t);let i=this.getPreferredTitle();return i&&(n=`${i} (${n})`),n}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,n){let i=await this.primary.save(t,n);return this.saveResultToEditor(i)}async saveAs(t,n){let i=await this.primary.saveAs(t,n);return this.saveResultToEditor(i)}saveResultToEditor(t){if(!t||!this.hasIdenticalSides)return t;if(this.primary.matches(t))return this;if(t instanceof Za)return new No(this.preferredName,this.preferredDescription,t,t,this.editorService);if(!Xa(t)&&!Np(t)&&!id(t)&&!od(t))return{primary:t,secondary:t,label:this.preferredName,description:this.preferredDescription}}revert(t,n){return this.primary.revert(t,n)}async rename(t,n){if(!this.hasIdenticalSides)return;let i=await this.primary.rename(t,n);if(i){if(Ao(i.editor))return{editor:new No(this.preferredName,this.preferredDescription,i.editor,i.editor,this.editorService),options:{...i.options,viewState:PI(this,t,this.editorService)}};if(gF(i.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:i.editor,secondary:i.editor,options:{...i.options,viewState:PI(this,t,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){let n=this.primary.toUntyped(t),i=this.secondary.toUntyped(t);if(n&&i&&!Xa(n)&&!Xa(i)&&!Np(n)&&!Np(i)&&!id(n)&&!id(i)&&!od(n)&&!od(i)){let r={label:this.preferredName,description:this.preferredDescription,primary:n,secondary:i};return typeof t?.preserveViewState=="number"&&(r.options={viewState:PI(this,t.preserveViewState,this.editorService)}),r}}matches(t){return this===t?!0:y1(t)||Xa(t)?!1:t instanceof No?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):id(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};No=K([D(4,rd)],No);var I1={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function _5(o){let e=o;return!!(e&&typeof e=="object"&&Array.isArray(e.editors)&&Array.isArray(e.mru))}var oa=class extends W{constructor(t,n,i){super();this.instantiationService=n;this.configurationService=i;_5(t)?this._id=this.deserialize(t):this._id=oa.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new L({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t&&!t.affectsConfiguration("workbench.editor.openPositioning")&&!t.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(t,n){let i=t===0?this.mru.slice(0):this.editors.slice(0);return n?.excludeSticky?t===0?i.filter(r=>!this.isSticky(r)):i.slice(this.sticky+1):i}getEditorByIndex(t){return this.editors[t]}get activeEditor(){return this.active}isActive(t){return this.matches(this.active,t)}get previewEditor(){return this.preview}openEditor(t,n){let i=n?.sticky||typeof n?.index=="number"&&this.isSticky(n.index),r=n?.pinned||n?.sticky,s=!!n?.transient,a=n?.active||!this.activeEditor||!r&&this.preview===this.activeEditor,l=this.findEditor(t,n);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),r&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),n&&typeof n.index=="number"&&this.moveEditor(d,n.index),i&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=t,c=this.indexOf(this.active),u;if(n&&typeof n.index=="number"?u=n.index:this.editorOpenPositioning===I1.FIRST?(u=0,!i&&this.isSticky(u)&&(u=this.sticky+1)):this.editorOpenPositioning===I1.LAST?u=this.editors.length:(this.editorOpenPositioning===I1.LEFT?c===0||!this.editors.length?u=0:u=c:u=c+1,!i&&this.isSticky(u)&&(u=this.sticky+1)),i&&(this.sticky++,this.isSticky(u)||(u=this.sticky)),(r||!this.preview)&&this.splice(u,!1,d),s&&this.doSetTransient(d,u,!0),!r){if(this.preview){let m=this.indexOf(this.preview);u>m&&u--,this.replaceEditor(this.preview,d,u,!a)}this.preview=d}this.registerEditorListeners(d);let p={kind:5,editor:d,editorIndex:u};return this._onDidModelChange.fire(p),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(t){let n=new te;this.editorListeners.add(n),n.add(de.once(t.onWillDispose)(()=>{let i=this.editors.indexOf(t);if(i>=0){let r={kind:15,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}})),n.add(t.onDidChangeDirty(()=>{let i={kind:14,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeLabel(()=>{let i={kind:9,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeCapabilities(()=>{let i={kind:10,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(this.onDidModelChange(i=>{i.kind===6&&i.editor?.matches(t)&&(xt(n),this.editorListeners.delete(n))}))}replaceEditor(t,n,i,r=!0){let s=this.doCloseEditor(t,1,r);if(this.splice(i,!1,n),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(t,n=0,i=!0){let r=this.doCloseEditor(t,n,i);if(r){let s={kind:6,...r};return this._onDidModelChange.fire(s),r}}doCloseEditor(t,n,i){let r=this.indexOf(t);if(r===-1)return;let s=this.editors[r],a=this.isSticky(r),l=this.active===s;if(i&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:r===this.editors.length-1?d=this.editors[r-1]:d=this.editors[r+1];let c=this.selection.filter(u=>u!==s&&u!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(r,!0),{editor:s,sticky:a,editorIndex:r,context:n}}moveEditor(t,n){n>=this.editors.length?n=this.editors.length-1:n<0&&(n=0);let i=this.indexOf(t);if(i<0||n===i)return;let r=this.editors[i],s=this.sticky;this.isSticky(i)&&n>this.sticky?this.sticky--:!this.isSticky(i)&&n<=this.sticky&&this.sticky++,this.editors.splice(i,1),this.editors.splice(n,0,r);let a={kind:7,editor:r,oldEditorIndex:i,editorIndex:n};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:r,editorIndex:n};this._onDidModelChange.fire(l)}return r}setActive(t){let n;return t?n=this.setEditorActive(t):this.setGroupActive(),n}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doSetSelection(i,r,[]),i}get selectedEditors(){return this.editors.filter(t=>this.doIsSelected(t))}isSelected(t){let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.doIsSelected(n)}doIsSelected(t){return this.selection.includes(t)}setSelection(t,n){let i=this.findEditor(t);if(!i)return;let[r,s]=i,a=new Set;for(let l of n){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==r&&a.add(c)}this.doSetSelection(r,s,Array.from(a))}doSetSelection(t,n,i){let r=this.activeEditor,s=this.selection,a;t?a=[t,...i]:a=[],this.selection=a;let l=t&&typeof n=="number"&&r!==t;if(l){let d=this.indexOf(t,this.mru);this.mru.splice(d,1),this.mru.unshift(t);let c={kind:8,editor:t,editorIndex:n};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(t){this._onDidModelChange.fire({kind:1})}setLabel(t){this._onDidModelChange.fire({kind:2})}pin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doPin(i,r),i}doPin(t,n){if(this.isPinned(t))return;this.setTransient(t,!1),this.preview=null;let i={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(i)}unpin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnpin(i,r),i}doUnpin(t,n){if(!this.isPinned(t))return;let i=this.preview;this.preview=t;let r={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(r),i&&this.closeEditor(i,3)}isPinned(t){let n;return typeof t=="number"?n=this.editors[t]:n=t,!this.matches(this.preview,n)}stick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doStick(i,r),i}doStick(t,n){if(this.isSticky(n))return;this.pin(t);let i=this.sticky+1;this.moveEditor(t,i),this.sticky++;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}unstick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnstick(i,r),i}doUnstick(t,n){if(!this.isSticky(n))return;let i=this.sticky;this.moveEditor(t,i),this.sticky--;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}isSticky(t){if(this.sticky<0)return!1;let n;return typeof t=="number"?n=t:n=this.indexOf(t),n<0?!1:n<=this.sticky}setTransient(t,n){if(!n&&this.transient.size===0)return;let i=this.findEditor(t);if(!i)return;let[r,s]=i;return this.doSetTransient(r,s,n),r}doSetTransient(t,n,i){if(i){if(this.transient.has(t))return;this.transient.add(t)}else{if(!this.transient.has(t))return;this.transient.delete(t)}let r={kind:12,editor:t,editorIndex:n};this._onDidModelChange.fire(r)}isTransient(t){if(this.transient.size===0)return!1;let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.transient.has(n)}splice(t,n,i){let r=this.editors[t];if(n&&this.isSticky(t)&&this.sticky--,i?this.editors.splice(t,n?1:0,i):this.editors.splice(t,n?1:0),!n&&i)this.mru.length===0?this.mru.push(i):this.mru.splice(1,0,i);else{let s=this.indexOf(r,this.mru);n&&!i?this.mru.splice(s,1):n&&i&&this.mru.splice(s,1,i)}}indexOf(t,n=this.editors,i){let r=-1;if(!t)return r;for(let s=0;s<n.length;s++){let a=n[s];if(this.matches(a,t,i))if(i?.supportSideBySide&&a instanceof No&&!(t instanceof No))r=s;else{r=s;break}}return r}findEditor(t,n){let i=this.indexOf(t,this.editors,n);if(i!==-1)return[this.editors[i],i]}isFirst(t,n=this.editors){return this.matches(n[0],t)}isLast(t,n=this.editors){return this.matches(n[n.length-1],t)}contains(t,n){return this.indexOf(t,this.editors,n)!==-1}matches(t,n,i){if(!t||!n)return!1;if(i?.supportSideBySide&&t instanceof No&&!(n instanceof No))switch(i.supportSideBySide){case 4:if(this.matches(t.primary,n,i)||this.matches(t.secondary,n,i))return!0;break;case 3:if(this.matches(t.primary,n,i)&&this.matches(t.secondary,n,i))return!0;break}let r=t===n;return i?.strictEquals?r:r||t.matches(n)}get isLocked(){return this.locked}lock(t){this.isLocked!==t&&(this.locked=t,this._onDidModelChange.fire({kind:3}))}clone(){let t=this.instantiationService.createInstance(oa,void 0);t.editors=this.editors.slice(0),t.mru=this.mru.slice(0),t.preview=this.preview,t.selection=this.selection.slice(0),t.sticky=this.sticky;for(let n of t.editors)t.registerEditorListeners(n);return t}serialize(){let t=tt.as(Jg.EditorFactory),n=[],i=[],r,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,u=t.getEditorSerializer(d);if(u){let p=u.canSerialize(d)?u.serialize(d):void 0;typeof p=="string"?(c=!0,i.push({id:d.typeId,value:p}),n.push(d),this.preview===d&&(r=n.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,n)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:i,mru:a,preview:r,sticky:s>=0?s:void 0}}deserialize(t){let n=tt.as(Jg.EditorFactory);return typeof t.id=="number"?(this._id=t.id,oa.IDS=Math.max(t.id+1,oa.IDS)):this._id=oa.IDS++,t.locked&&(this.locked=!0),this.editors=Ta(t.editors.map((i,r)=>{let s,a=n.getEditorSerializer(i.id);if(a){let l=a.deserialize(this.instantiationService,i.value);l instanceof Za&&(s=l,this.registerEditorListeners(s))}return!s&&typeof t.sticky=="number"&&r<=t.sticky&&t.sticky--,s})),this.mru=Ta(t.mru.map(i=>this.editors[i])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof t.preview=="number"&&(this.preview=this.editors[t.preview]),typeof t.sticky=="number"&&(this.sticky=t.sticky),this._id}dispose(){xt(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};oa=K([D(1,ct),D(2,tn)],oa);var Op=Y("IUriIdentityService");function bF(o){let e=o;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&be.isUri(e.location)&&be.isUri(e.globalStorageHome)&&be.isUri(e.settingsResource)&&be.isUri(e.keybindingsResource)&&be.isUri(e.tasksResource)&&be.isUri(e.snippetsHome)&&be.isUri(e.extensionsResource))}var vF=Y("IUserDataProfilesService");function AI(o,e,t,n,i,r){return{id:o,name:e,location:t,isDefault:!1,shortName:i?.shortName,icon:i?.icon,globalStorageHome:r&&i?.useDefaultFlags?.globalState?r.globalStorageHome:Jo(t,"globalStorage"),settingsResource:r&&i?.useDefaultFlags?.settings?r.settingsResource:Jo(t,"settings.json"),keybindingsResource:r&&i?.useDefaultFlags?.keybindings?r.keybindingsResource:Jo(t,"keybindings.json"),tasksResource:r&&i?.useDefaultFlags?.tasks?r.tasksResource:Jo(t,"tasks.json"),snippetsHome:r&&i?.useDefaultFlags?.snippets?r.snippetsHome:Jo(t,"snippets"),extensionsResource:r&&i?.useDefaultFlags?.extensions?r.extensionsResource:Jo(t,"extensions.json"),cacheHome:Jo(n,o),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient}}var NI=class extends W{constructor(t,n,i,r){super();this.environmentService=t;this.fileService=n;this.uriIdentityService=i;this.logService=r;this.profilesHome=Jo(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=Jo(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new L);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new L);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new L);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new L);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new Vi,workspaces:new Vi,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(t){this.enabled!==t&&(this._profilesObject=void 0,this.enabled=t)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let t=this.createDefaultProfile(),n=[t];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!rn(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}n.push(AI(Ol(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.logService.error(s)}let i=new Vi,r=new Map;if(n.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=be.parse(a),c=n.find(u=>u.id===l);c&&i.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=n.find(c=>c.id===l);d&&r.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:n,workspaces:i,emptyWindows:r}}return this._profilesObject}createDefaultProfile(){let t=AI("__default__profile__",h("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){let n="Temp",i=new RegExp(`${Ui(n)}\\s(\\d+)`),r=0;for(let a of this.profiles){let l=i.exec(a.name),d=l?parseInt(l[1]):0;r=d>r?d:r}let s=`${n} ${r+1}`;return this.createProfile(tr(Ua()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,n,i){return this.createProfile(tr(Ua()).toString(16),t,n,i)}async createProfile(t,n,i,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(t,n,i);return r&&await this.setProfileForWorkspace(r,s),s}async doCreateProfile(t,n,i){if(!rn(n)||!n)throw new Error("Name of the profile is mandatory and must be of type `string`");let r=this.profileCreationPromises.get(n);return r||(r=(async()=>{try{if(this.profiles.find(d=>d.name===n||d.id===t))throw new Error(`Profile with ${n} name already exists`);let a=AI(t,n,Jo(this.profilesHome,t),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await br.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(n)}})(),this.profileCreationPromises.set(n,r)),r}async updateProfile(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);return i=AI(i.id,n.name??i.name,i.location,this.profilesCacheHome,{shortName:n.shortName??i.shortName,icon:n.icon===null?void 0:n.icon??i.icon,transient:n.transient??i.isTransient,useDefaultFlags:n.useDefaultFlags??i.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[i]),i}async removeProfile(t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(t.isDefault)throw new Error("Cannot remove default profile");let n=this.profiles.find(r=>r.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);let i=[];this._onWillRemoveProfile.fire({profile:n,join(r){i.push(r)}});try{await Promise.allSettled(i)}catch(r){this.logService.error(r)}for(let r of[...this.profilesObject.emptyWindows.keys()])n.id===this.profilesObject.emptyWindows.get(r)?.id&&this.profilesObject.emptyWindows.delete(r);for(let r of[...this.profilesObject.workspaces.keys()])n.id===this.profilesObject.workspaces.get(r)?.id&&this.profilesObject.workspaces.delete(r);this.updateStoredProfileAssociations(),this.updateProfiles([],[n],[]);try{await this.fileService.del(n.cacheHome,{recursive:!0})}catch(r){CA(r)!==1&&this.logService.error(r)}}async setProfileForWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===n.id);if(!i)throw new Error(`Profile '${n.name}' does not exist`);this.updateWorkspaceAssociation(t,i)}unsetWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(t,void 0,n)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(n=>n.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,n.resource))).map(n=>this.fileService.del(n.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let t=this.transientProfilesObject.profiles.filter(n=>!this.isProfileAssociatedToWorkspace(n));await Promise.allSettled(t.map(n=>this.removeProfile(n)))}getProfileForWorkspace(t){let n=this.getWorkspace(t),i=be.isUri(n)?this.profilesObject.workspaces.get(n):this.profilesObject.emptyWindows.get(n);return i||(Fl(t)?this.transientProfilesObject.folders.get(t.uri):Wm(t)?this.transientProfilesObject.workspaces.get(t.configPath):this.transientProfilesObject.emptyWindows.get(t.id))}getWorkspace(t){return Fl(t)?t.uri:Wm(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!([...this.profilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.profilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.folders.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location)))}updateProfiles(t,n,i){let r=[...this.profiles,...t],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of r){if(l.isDefault||n.some(c=>l.id===c.id))continue;l=i.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,u]of this.transientProfilesObject.emptyWindows.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,u]of this.transientProfilesObject.workspaces.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,u]of this.transientProfilesObject.folders.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(t,n,i)}triggerProfilesChanges(t,n,i){this._onDidChangeProfiles.fire({added:t,removed:n,updated:i,all:this.profiles})}updateWorkspaceAssociation(t,n,i){if(i=n?.isTransient?!0:i,i)Fl(t)?(this.transientProfilesObject.folders.delete(t.uri),n&&this.transientProfilesObject.folders.set(t.uri,n)):Wm(t)?(this.transientProfilesObject.workspaces.delete(t.configPath),n&&this.transientProfilesObject.workspaces.set(t.configPath,n)):(this.transientProfilesObject.emptyWindows.delete(t.id),n&&this.transientProfilesObject.emptyWindows.set(t.id,n));else{this.updateWorkspaceAssociation(t,void 0,!0);let r=this.getWorkspace(t);be.isUri(r)?(this.profilesObject.workspaces.delete(r),n&&this.profilesObject.workspaces.set(r,n)):(this.profilesObject.emptyWindows.delete(r),n&&this.profilesObject.emptyWindows.set(r,n)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let t={};for(let[i,r]of this.profilesObject.workspaces.entries())t[i.toString()]=r.id;let n={};for(let[i,r]of this.profilesObject.emptyWindows.entries())n[i.toString()]=r.id;this.saveStoredProfileAssociations({workspaces:t,emptyWindows:n}),this._profilesObject=void 0}migrateStoredProfileAssociations(t){let n={},i=this.createDefaultProfile();if(t.workspaces)for(let[s,a]of Object.entries(t.workspaces)){let l=be.parse(a);n[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}let r={};if(t.emptyWindows)for(let[s,a]of Object.entries(t.emptyWindows)){let l=be.parse(a);r[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:n,emptyWindows:r}}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};NI=K([D(0,Vr),D(1,qs),D(2,Op),D(3,En)],NI);var ef=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},OI=new ef,C1=new ef,S1=new ef,_1=new Array(230),T5={},L5=[],k5=Object.create(null),D5=Object.create(null);var yF=[],x1=[];for(let o=0;o<=193;o++)yF[o]=-1;for(let o=0;o<=132;o++)x1[o]=-1;(function(){let o="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",o,o],[1,1,"Hyper",0,o,0,o,o,o],[1,2,"Super",0,o,0,o,o,o],[1,3,"Fn",0,o,0,o,o,o],[1,4,"FnLock",0,o,0,o,o,o],[1,5,"Suspend",0,o,0,o,o,o],[1,6,"Resume",0,o,0,o,o,o],[1,7,"Turbo",0,o,0,o,o,o],[1,8,"Sleep",0,o,0,"VK_SLEEP",o,o],[1,9,"WakeUp",0,o,0,o,o,o],[0,10,"KeyA",31,"A",65,"VK_A",o,o],[0,11,"KeyB",32,"B",66,"VK_B",o,o],[0,12,"KeyC",33,"C",67,"VK_C",o,o],[0,13,"KeyD",34,"D",68,"VK_D",o,o],[0,14,"KeyE",35,"E",69,"VK_E",o,o],[0,15,"KeyF",36,"F",70,"VK_F",o,o],[0,16,"KeyG",37,"G",71,"VK_G",o,o],[0,17,"KeyH",38,"H",72,"VK_H",o,o],[0,18,"KeyI",39,"I",73,"VK_I",o,o],[0,19,"KeyJ",40,"J",74,"VK_J",o,o],[0,20,"KeyK",41,"K",75,"VK_K",o,o],[0,21,"KeyL",42,"L",76,"VK_L",o,o],[0,22,"KeyM",43,"M",77,"VK_M",o,o],[0,23,"KeyN",44,"N",78,"VK_N",o,o],[0,24,"KeyO",45,"O",79,"VK_O",o,o],[0,25,"KeyP",46,"P",80,"VK_P",o,o],[0,26,"KeyQ",47,"Q",81,"VK_Q",o,o],[0,27,"KeyR",48,"R",82,"VK_R",o,o],[0,28,"KeyS",49,"S",83,"VK_S",o,o],[0,29,"KeyT",50,"T",84,"VK_T",o,o],[0,30,"KeyU",51,"U",85,"VK_U",o,o],[0,31,"KeyV",52,"V",86,"VK_V",o,o],[0,32,"KeyW",53,"W",87,"VK_W",o,o],[0,33,"KeyX",54,"X",88,"VK_X",o,o],[0,34,"KeyY",55,"Y",89,"VK_Y",o,o],[0,35,"KeyZ",56,"Z",90,"VK_Z",o,o],[0,36,"Digit1",22,"1",49,"VK_1",o,o],[0,37,"Digit2",23,"2",50,"VK_2",o,o],[0,38,"Digit3",24,"3",51,"VK_3",o,o],[0,39,"Digit4",25,"4",52,"VK_4",o,o],[0,40,"Digit5",26,"5",53,"VK_5",o,o],[0,41,"Digit6",27,"6",54,"VK_6",o,o],[0,42,"Digit7",28,"7",55,"VK_7",o,o],[0,43,"Digit8",29,"8",56,"VK_8",o,o],[0,44,"Digit9",30,"9",57,"VK_9",o,o],[0,45,"Digit0",21,"0",48,"VK_0",o,o],[1,46,"Enter",3,"Enter",13,"VK_RETURN",o,o],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",o,o],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",o,o],[1,49,"Tab",2,"Tab",9,"VK_TAB",o,o],[1,50,"Space",10,"Space",32,"VK_SPACE",o,o],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,o,0,o,o,o],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",o,o],[1,64,"F1",59,"F1",112,"VK_F1",o,o],[1,65,"F2",60,"F2",113,"VK_F2",o,o],[1,66,"F3",61,"F3",114,"VK_F3",o,o],[1,67,"F4",62,"F4",115,"VK_F4",o,o],[1,68,"F5",63,"F5",116,"VK_F5",o,o],[1,69,"F6",64,"F6",117,"VK_F6",o,o],[1,70,"F7",65,"F7",118,"VK_F7",o,o],[1,71,"F8",66,"F8",119,"VK_F8",o,o],[1,72,"F9",67,"F9",120,"VK_F9",o,o],[1,73,"F10",68,"F10",121,"VK_F10",o,o],[1,74,"F11",69,"F11",122,"VK_F11",o,o],[1,75,"F12",70,"F12",123,"VK_F12",o,o],[1,76,"PrintScreen",0,o,0,o,o,o],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",o,o],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",o,o],[1,79,"Insert",19,"Insert",45,"VK_INSERT",o,o],[1,80,"Home",14,"Home",36,"VK_HOME",o,o],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",o,o],[1,82,"Delete",20,"Delete",46,"VK_DELETE",o,o],[1,83,"End",13,"End",35,"VK_END",o,o],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",o,o],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",o],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",o],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",o],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",o],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",o,o],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",o,o],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",o,o],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",o,o],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",o,o],[1,94,"NumpadEnter",3,o,0,o,o,o],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",o,o],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",o,o],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",o,o],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",o,o],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",o,o],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",o,o],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",o,o],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",o,o],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",o,o],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",o,o],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",o,o],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",o,o],[1,107,"ContextMenu",58,"ContextMenu",93,o,o,o],[1,108,"Power",0,o,0,o,o,o],[1,109,"NumpadEqual",0,o,0,o,o,o],[1,110,"F13",71,"F13",124,"VK_F13",o,o],[1,111,"F14",72,"F14",125,"VK_F14",o,o],[1,112,"F15",73,"F15",126,"VK_F15",o,o],[1,113,"F16",74,"F16",127,"VK_F16",o,o],[1,114,"F17",75,"F17",128,"VK_F17",o,o],[1,115,"F18",76,"F18",129,"VK_F18",o,o],[1,116,"F19",77,"F19",130,"VK_F19",o,o],[1,117,"F20",78,"F20",131,"VK_F20",o,o],[1,118,"F21",79,"F21",132,"VK_F21",o,o],[1,119,"F22",80,"F22",133,"VK_F22",o,o],[1,120,"F23",81,"F23",134,"VK_F23",o,o],[1,121,"F24",82,"F24",135,"VK_F24",o,o],[1,122,"Open",0,o,0,o,o,o],[1,123,"Help",0,o,0,o,o,o],[1,124,"Select",0,o,0,o,o,o],[1,125,"Again",0,o,0,o,o,o],[1,126,"Undo",0,o,0,o,o,o],[1,127,"Cut",0,o,0,o,o,o],[1,128,"Copy",0,o,0,o,o,o],[1,129,"Paste",0,o,0,o,o,o],[1,130,"Find",0,o,0,o,o,o],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",o,o],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",o,o],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",o,o],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",o,o],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",o,o],[1,136,"KanaMode",0,o,0,o,o,o],[0,137,"IntlYen",0,o,0,o,o,o],[1,138,"Convert",0,o,0,o,o,o],[1,139,"NonConvert",0,o,0,o,o,o],[1,140,"Lang1",0,o,0,o,o,o],[1,141,"Lang2",0,o,0,o,o,o],[1,142,"Lang3",0,o,0,o,o,o],[1,143,"Lang4",0,o,0,o,o,o],[1,144,"Lang5",0,o,0,o,o,o],[1,145,"Abort",0,o,0,o,o,o],[1,146,"Props",0,o,0,o,o,o],[1,147,"NumpadParenLeft",0,o,0,o,o,o],[1,148,"NumpadParenRight",0,o,0,o,o,o],[1,149,"NumpadBackspace",0,o,0,o,o,o],[1,150,"NumpadMemoryStore",0,o,0,o,o,o],[1,151,"NumpadMemoryRecall",0,o,0,o,o,o],[1,152,"NumpadMemoryClear",0,o,0,o,o,o],[1,153,"NumpadMemoryAdd",0,o,0,o,o,o],[1,154,"NumpadMemorySubtract",0,o,0,o,o,o],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",o,o],[1,156,"NumpadClearEntry",0,o,0,o,o,o],[1,0,o,5,"Ctrl",17,"VK_CONTROL",o,o],[1,0,o,4,"Shift",16,"VK_SHIFT",o,o],[1,0,o,6,"Alt",18,"VK_MENU",o,o],[1,0,o,57,"Meta",91,"VK_COMMAND",o,o],[1,157,"ControlLeft",5,o,0,"VK_LCONTROL",o,o],[1,158,"ShiftLeft",4,o,0,"VK_LSHIFT",o,o],[1,159,"AltLeft",6,o,0,"VK_LMENU",o,o],[1,160,"MetaLeft",57,o,0,"VK_LWIN",o,o],[1,161,"ControlRight",5,o,0,"VK_RCONTROL",o,o],[1,162,"ShiftRight",4,o,0,"VK_RSHIFT",o,o],[1,163,"AltRight",6,o,0,"VK_RMENU",o,o],[1,164,"MetaRight",57,o,0,"VK_RWIN",o,o],[1,165,"BrightnessUp",0,o,0,o,o,o],[1,166,"BrightnessDown",0,o,0,o,o,o],[1,167,"MediaPlay",0,o,0,o,o,o],[1,168,"MediaRecord",0,o,0,o,o,o],[1,169,"MediaFastForward",0,o,0,o,o,o],[1,170,"MediaRewind",0,o,0,o,o,o],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",o,o],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",o,o],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",o,o],[1,174,"Eject",0,o,0,o,o,o],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",o,o],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",o,o],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",o,o],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",o,o],[1,179,"LaunchApp1",0,o,0,"VK_MEDIA_LAUNCH_APP1",o,o],[1,180,"SelectTask",0,o,0,o,o,o],[1,181,"LaunchScreenSaver",0,o,0,o,o,o],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",o,o],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",o,o],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",o,o],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",o,o],[1,186,"BrowserStop",0,o,0,"VK_BROWSER_STOP",o,o],[1,187,"BrowserRefresh",0,o,0,"VK_BROWSER_REFRESH",o,o],[1,188,"BrowserFavorites",0,o,0,"VK_BROWSER_FAVORITES",o,o],[1,189,"ZoomToggle",0,o,0,o,o,o],[1,190,"MailReply",0,o,0,o,o,o],[1,191,"MailForward",0,o,0,o,o,o],[1,192,"MailSend",0,o,0,o,o,o],[1,0,o,114,"KeyInComposition",229,o,o,o],[1,0,o,116,"ABNT_C2",194,"VK_ABNT_C2",o,o],[1,0,o,96,"OEM_8",223,"VK_OEM_8",o,o],[1,0,o,0,o,0,"VK_KANA",o,o],[1,0,o,0,o,0,"VK_HANGUL",o,o],[1,0,o,0,o,0,"VK_JUNJA",o,o],[1,0,o,0,o,0,"VK_FINAL",o,o],[1,0,o,0,o,0,"VK_HANJA",o,o],[1,0,o,0,o,0,"VK_KANJI",o,o],[1,0,o,0,o,0,"VK_CONVERT",o,o],[1,0,o,0,o,0,"VK_NONCONVERT",o,o],[1,0,o,0,o,0,"VK_ACCEPT",o,o],[1,0,o,0,o,0,"VK_MODECHANGE",o,o],[1,0,o,0,o,0,"VK_SELECT",o,o],[1,0,o,0,o,0,"VK_PRINT",o,o],[1,0,o,0,o,0,"VK_EXECUTE",o,o],[1,0,o,0,o,0,"VK_SNAPSHOT",o,o],[1,0,o,0,o,0,"VK_HELP",o,o],[1,0,o,0,o,0,"VK_APPS",o,o],[1,0,o,0,o,0,"VK_PROCESSKEY",o,o],[1,0,o,0,o,0,"VK_PACKET",o,o],[1,0,o,0,o,0,"VK_DBE_SBCSCHAR",o,o],[1,0,o,0,o,0,"VK_DBE_DBCSCHAR",o,o],[1,0,o,0,o,0,"VK_ATTN",o,o],[1,0,o,0,o,0,"VK_CRSEL",o,o],[1,0,o,0,o,0,"VK_EXSEL",o,o],[1,0,o,0,o,0,"VK_EREOF",o,o],[1,0,o,0,o,0,"VK_PLAY",o,o],[1,0,o,0,o,0,"VK_ZOOM",o,o],[1,0,o,0,o,0,"VK_NONAME",o,o],[1,0,o,0,o,0,"VK_PA1",o,o],[1,0,o,0,o,0,"VK_OEM_CLEAR",o,o]],t=[],n=[];for(let i of e){let[r,s,a,l,d,c,u,p,m]=i;if(n[s]||(n[s]=!0,L5[s]=a,k5[a]=s,D5[a.toLowerCase()]=s,r&&(yF[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(x1[l]=s))),!t[l]){if(t[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);OI.define(l,d),C1.define(l,p||d),S1.define(l,m||p||d)}c&&(_1[c]=l),u&&(T5[u]=l)}x1[3]=46})();var tf;(s=>{function o(a){return OI.keyCodeToStr(a)}s.toString=o;function e(a){return OI.strToKeyCode(a)}s.fromString=e;function t(a){return C1.keyCodeToStr(a)}s.toUserSettingsUS=t;function n(a){return S1.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function i(a){return C1.strToKeyCode(a)||S1.strToKeyCode(a)}s.fromUserSettings=i;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return OI.keyCodeToStr(a)}s.toElectronAccelerator=r})(tf||={});function w1(o,e){if(typeof o=="number"){if(o===0)return null;let t=(o&65535)>>>0,n=(o&4294901760)>>>16;return n!==0?new Fp([FI(t,e),FI(n,e)]):new Fp([FI(t,e)])}else{let t=[];for(let n=0;n<o.length;n++)t.push(FI(o[n],e));return new Fp(t)}}function FI(o,e){let t=!!(o&2048),n=!!(o&256),i=e===2?n:t,r=!!(o&1024),s=!!(o&512),a=e===2?t:n,l=o&255;return new sd(i,r,s,a,l)}var sd=class o{constructor(e,t,n,i,r){this.ctrlKey=e;this.shiftKey=t;this.altKey=n;this.metaKey=i;this.keyCode=r}equals(e){return e instanceof o&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",t=this.shiftKey?"1":"0",n=this.altKey?"1":"0",i=this.metaKey?"1":"0";return`K${e}${t}${n}${i}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new Fp([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var Fp=class{chords;constructor(e){if(e.length===0)throw Ad("chords");this.chords=e}getHashCode(){let e="";for(let t=0,n=this.chords.length;t<n;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};var E1=class o{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new Gn,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(mr===1){if(e&&e.win)return e.win}else if(mr===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){let t=o.bindToCurrentPlatform(e),n=new te;if(t&&t.primary){let i=w1(t.primary,mr);i&&n.add(this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let i=0,r=t.secondary.length;i<r;i++){let s=t.secondary[i],a=w1(s,mr);a&&n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-i-1,e.when))}return n}setExtensionKeybindings(e){let t=[],n=0;for(let i of e)i.keybinding&&(t[n++]={keybinding:i.keybinding,command:i.id,commandArgs:i.args,when:i.when,weight1:i.weight,weight2:0,extensionId:i.extensionId||null,isBuiltinExtension:i.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return Ts(this.registerKeybindingRule(e),nr.registerCommand(e))}_registerDefaultKeybinding(e,t,n,i,r,s){let a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:s,weight1:i,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,ge(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(M5)),this._cachedMergedKeybindings.slice(0)}},Xr=new E1,R5={EditorModes:"platform.keybindingsRegistry"};tt.add(R5.EditorModes,Xr);function M5(o,e){if(o.weight1!==e.weight1)return o.weight1-e.weight1;if(o.command&&e.command){if(o.command<e.command)return-1;if(o.command>e.command)return 1}return o.weight2-e.weight2}function Bp(o){return o.command!==void 0}function IF(o){return o.submenu!==void 0}var Bt=class o{static _instances=new Map;static CommandPalette=new o("CommandPalette");static DebugBreakpointsContext=new o("DebugBreakpointsContext");static DebugCallStackContext=new o("DebugCallStackContext");static DebugConsoleContext=new o("DebugConsoleContext");static DebugVariablesContext=new o("DebugVariablesContext");static NotebookVariablesContext=new o("NotebookVariablesContext");static DebugHoverContext=new o("DebugHoverContext");static DebugWatchContext=new o("DebugWatchContext");static DebugToolBar=new o("DebugToolBar");static DebugToolBarStop=new o("DebugToolBarStop");static DebugCallStackToolbar=new o("DebugCallStackToolbar");static DebugCreateConfiguration=new o("DebugCreateConfiguration");static EditorContext=new o("EditorContext");static SimpleEditorContext=new o("SimpleEditorContext");static EditorContent=new o("EditorContent");static EditorLineNumberContext=new o("EditorLineNumberContext");static EditorContextCopy=new o("EditorContextCopy");static EditorContextPeek=new o("EditorContextPeek");static EditorContextShare=new o("EditorContextShare");static EditorTitle=new o("EditorTitle");static EditorTitleRun=new o("EditorTitleRun");static EditorTitleContext=new o("EditorTitleContext");static EditorTitleContextShare=new o("EditorTitleContextShare");static EmptyEditorGroup=new o("EmptyEditorGroup");static EmptyEditorGroupContext=new o("EmptyEditorGroupContext");static EditorTabsBarContext=new o("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new o("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new o("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new o("EditorActionsPositionSubmenu");static ExplorerContext=new o("ExplorerContext");static ExplorerContextShare=new o("ExplorerContextShare");static ExtensionContext=new o("ExtensionContext");static ExtensionEditorContextMenu=new o("ExtensionEditorContextMenu");static GlobalActivity=new o("GlobalActivity");static CommandCenter=new o("CommandCenter");static CommandCenterCenter=new o("CommandCenterCenter");static LayoutControlMenuSubmenu=new o("LayoutControlMenuSubmenu");static LayoutControlMenu=new o("LayoutControlMenu");static MenubarMainMenu=new o("MenubarMainMenu");static MenubarAppearanceMenu=new o("MenubarAppearanceMenu");static MenubarDebugMenu=new o("MenubarDebugMenu");static MenubarEditMenu=new o("MenubarEditMenu");static MenubarCopy=new o("MenubarCopy");static MenubarFileMenu=new o("MenubarFileMenu");static MenubarGoMenu=new o("MenubarGoMenu");static MenubarHelpMenu=new o("MenubarHelpMenu");static MenubarLayoutMenu=new o("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new o("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new o("PanelAlignmentMenu");static PanelPositionMenu=new o("PanelPositionMenu");static ActivityBarPositionMenu=new o("ActivityBarPositionMenu");static MenubarPreferencesMenu=new o("MenubarPreferencesMenu");static MenubarRecentMenu=new o("MenubarRecentMenu");static MenubarSelectionMenu=new o("MenubarSelectionMenu");static MenubarShare=new o("MenubarShare");static MenubarSwitchEditorMenu=new o("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new o("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new o("MenubarTerminalMenu");static MenubarViewMenu=new o("MenubarViewMenu");static MenubarHomeMenu=new o("MenubarHomeMenu");static OpenEditorsContext=new o("OpenEditorsContext");static OpenEditorsContextShare=new o("OpenEditorsContextShare");static ProblemsPanelContext=new o("ProblemsPanelContext");static SCMInputBox=new o("SCMInputBox");static SCMChangesContext=new o("SCMChangesContext");static SCMChangeContext=new o("SCMChangeContext");static SCMResourceContext=new o("SCMResourceContext");static SCMResourceContextShare=new o("SCMResourceContextShare");static SCMResourceFolderContext=new o("SCMResourceFolderContext");static SCMResourceGroupContext=new o("SCMResourceGroupContext");static SCMSourceControl=new o("SCMSourceControl");static SCMSourceControlInline=new o("SCMSourceControlInline");static SCMSourceControlTitle=new o("SCMSourceControlTitle");static SCMHistoryTitle=new o("SCMHistoryTitle");static SCMTitle=new o("SCMTitle");static SearchContext=new o("SearchContext");static SearchActionMenu=new o("SearchActionContext");static StatusBarWindowIndicatorMenu=new o("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new o("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new o("StickyScrollContext");static TestItem=new o("TestItem");static TestItemGutter=new o("TestItemGutter");static TestProfilesContext=new o("TestProfilesContext");static TestMessageContext=new o("TestMessageContext");static TestMessageContent=new o("TestMessageContent");static TestPeekElement=new o("TestPeekElement");static TestPeekTitle=new o("TestPeekTitle");static TestCallStack=new o("TestCallStack");static TouchBarContext=new o("TouchBarContext");static TitleBarContext=new o("TitleBarContext");static TitleBarTitleContext=new o("TitleBarTitleContext");static TunnelContext=new o("TunnelContext");static TunnelPrivacy=new o("TunnelPrivacy");static TunnelProtocol=new o("TunnelProtocol");static TunnelPortInline=new o("TunnelInline");static TunnelTitle=new o("TunnelTitle");static TunnelLocalAddressInline=new o("TunnelLocalAddressInline");static TunnelOriginInline=new o("TunnelOriginInline");static ViewItemContext=new o("ViewItemContext");static ViewContainerTitle=new o("ViewContainerTitle");static ViewContainerTitleContext=new o("ViewContainerTitleContext");static ViewTitle=new o("ViewTitle");static ViewTitleContext=new o("ViewTitleContext");static CommentEditorActions=new o("CommentEditorActions");static CommentThreadTitle=new o("CommentThreadTitle");static CommentThreadActions=new o("CommentThreadActions");static CommentThreadAdditionalActions=new o("CommentThreadAdditionalActions");static CommentThreadTitleContext=new o("CommentThreadTitleContext");static CommentThreadCommentContext=new o("CommentThreadCommentContext");static CommentTitle=new o("CommentTitle");static CommentActions=new o("CommentActions");static CommentsViewThreadActions=new o("CommentsViewThreadActions");static InteractiveToolbar=new o("InteractiveToolbar");static InteractiveCellTitle=new o("InteractiveCellTitle");static InteractiveCellDelete=new o("InteractiveCellDelete");static InteractiveCellExecute=new o("InteractiveCellExecute");static InteractiveInputExecute=new o("InteractiveInputExecute");static InteractiveInputConfig=new o("InteractiveInputConfig");static ReplInputExecute=new o("ReplInputExecute");static IssueReporter=new o("IssueReporter");static NotebookToolbar=new o("NotebookToolbar");static NotebookStickyScrollContext=new o("NotebookStickyScrollContext");static NotebookCellTitle=new o("NotebookCellTitle");static NotebookCellDelete=new o("NotebookCellDelete");static NotebookCellInsert=new o("NotebookCellInsert");static NotebookCellBetween=new o("NotebookCellBetween");static NotebookCellListTop=new o("NotebookCellTop");static NotebookCellExecute=new o("NotebookCellExecute");static NotebookCellExecuteGoTo=new o("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new o("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new o("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new o("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new o("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new o("NotebookOutputToolbar");static NotebookOutlineFilter=new o("NotebookOutlineFilter");static NotebookOutlineActionMenu=new o("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new o("NotebookEditorLayoutConfigure");static NotebookKernelSource=new o("NotebookKernelSource");static BulkEditTitle=new o("BulkEditTitle");static BulkEditContext=new o("BulkEditContext");static TimelineItemContext=new o("TimelineItemContext");static TimelineTitle=new o("TimelineTitle");static TimelineTitleContext=new o("TimelineTitleContext");static TimelineFilterSubMenu=new o("TimelineFilterSubMenu");static AccountsContext=new o("AccountsContext");static SidebarTitle=new o("SidebarTitle");static PanelTitle=new o("PanelTitle");static AuxiliaryBarTitle=new o("AuxiliaryBarTitle");static AuxiliaryBarHeader=new o("AuxiliaryBarHeader");static TerminalInstanceContext=new o("TerminalInstanceContext");static TerminalEditorInstanceContext=new o("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new o("TerminalNewDropdownContext");static TerminalTabContext=new o("TerminalTabContext");static TerminalTabEmptyAreaContext=new o("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new o("TerminalStickyScrollContext");static WebviewContext=new o("WebviewContext");static InlineCompletionsActions=new o("InlineCompletionsActions");static InlineEditsActions=new o("InlineEditsActions");static InlineEditActions=new o("InlineEditActions");static NewFile=new o("NewFile");static MergeInput1Toolbar=new o("MergeToolbar1Toolbar");static MergeInput2Toolbar=new o("MergeToolbar2Toolbar");static MergeBaseToolbar=new o("MergeBaseToolbar");static MergeInputResultToolbar=new o("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new o("InlineSuggestionToolbar");static InlineEditToolbar=new o("InlineEditToolbar");static ChatContext=new o("ChatContext");static ChatCodeBlock=new o("ChatCodeblock");static ChatCompareBlock=new o("ChatCompareBlock");static ChatMessageTitle=new o("ChatMessageTitle");static ChatExecute=new o("ChatExecute");static ChatExecuteSecondary=new o("ChatExecuteSecondary");static ChatInputSide=new o("ChatInputSide");static AccessibleView=new o("AccessibleView");static MultiDiffEditorFileToolbar=new o("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new o("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new o("DiffEditorSelectionToolbar");static for(e){return o._instances.get(e)??new o(e)}id;constructor(e){if(o._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);o._instances.set(e,this),this.id=e}},sa=Y("menuService"),wc=class o{constructor(e){this.id=e;this.has=t=>t===e}static _all=new Map;static for(e){let t=this._all.get(e);return t||(t=new o(e),this._all.set(e,t)),t}static merge(e){let t=new Set;for(let n of e)n instanceof o&&t.add(n.id);return t}has},ra=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new Wb({merge:wc.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(o){return this._commands.set(o.id,o),this._onDidChangeMenu.fire(wc.for(Bt.CommandPalette)),ge(()=>{this._commands.delete(o.id)&&this._onDidChangeMenu.fire(wc.for(Bt.CommandPalette))})}getCommand(o){return this._commands.get(o)}getCommands(){let o=new Map;return this._commands.forEach((e,t)=>o.set(t,e)),o}appendMenuItem(o,e){let t=this._menuItems.get(o);t||(t=new Gn,this._menuItems.set(o,t));let n=t.push(e);return this._onDidChangeMenu.fire(wc.for(o)),ge(()=>{n(),this._onDidChangeMenu.fire(wc.for(o))})}appendMenuItems(o){let e=new te;for(let{id:t,item:n}of o)e.add(this.appendMenuItem(t,n));return e}getMenuItems(o){let e;return this._menuItems.has(o)?e=[...this._menuItems.get(o)]:e=[],o===Bt.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(o){let e=new Set;for(let t of o)Bp(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,n)=>{e.has(n)||o.push({command:t})})}},Ja=class extends Fa{constructor(t,n,i){super(`submenuitem.${t.submenu.id}`,typeof t.title=="string"?t.title:t.title.value,i,"submenu");this.item=t;this.hideActions=n}},Bn=class{constructor(e,t,n,i,r,s,a){this.hideActions=i;this.menuKeybinding=r;this._commandService=a;this.id=e.id,this.label=Bn.label(e,n),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||s.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){let d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&Je.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=Je.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new Bn(t,void 0,n,i,void 0,s,a):void 0,this._options=n,this.class=l&&Je.asClassName(l)}static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};Bn=K([D(5,rt),D(6,In)],Bn);var Oo=class{constructor(e){this.desc=e}};function Jr(o){let e=[],t=new o,{f1:n,menu:i,keybinding:r,...s}=t.desc;if(nr.getCommand(s.id))throw new Error(`Cannot register two commands with the same id: ${s.id}`);if(e.push(nr.registerCommand({id:s.id,handler:(a,...l)=>t.run(a,...l),metadata:s.metadata})),Array.isArray(i))for(let a of i)e.push(ra.appendMenuItem(a.id,{command:{...s,precondition:a.precondition===null?void 0:s.precondition},...a}));else i&&e.push(ra.appendMenuItem(i.id,{command:{...s,precondition:i.precondition===null?void 0:s.precondition},...i}));if(n&&(e.push(ra.appendMenuItem(Bt.CommandPalette,{command:s,when:s.precondition})),e.push(ra.addCommand(s))),Array.isArray(r))for(let a of r)e.push(Xr.registerKeybindingRule({...a,id:s.id,when:s.precondition?pe.and(s.precondition,a.when):a.when}));else r&&e.push(Xr.registerKeybindingRule({...r,id:s.id,when:s.precondition?pe.and(s.precondition,r.when):r.when}));return{dispose(){xt(e)}}}var gwe=Y("editorGroupsService");var rd=Y("editorService");var T1=class{constructor(e,t,n){this.id=e;this.dependencies=t;this.callback=n}};var CF=class o{static INSTANCE=new o;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(e,t,n)=>{typeof e!="string"&&(n=t,t=e,e=null),(typeof t!="object"||!Array.isArray(t))&&(n=t,t=null),this._defineCalls.push(new T1(e,t,n))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){if(e.startsWith(window.location.origin)||e.startsWith(`${$e.vscodeFileResource}://${sE}`))return e;throw new Error(`[trusted_script_src] Invalid script url: ${e}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){return e}}))}async load(e){if(this._initialize(),this._state===3)return new Promise(s=>{let a=Ua();console.log(`[amdX] Using external define("${a}", ["${e}"])`),globalThis.define(a,[e],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}let n={},i=[],r=[];if(Array.isArray(t.dependencies))for(let s of t.dependencies)s==="exports"?i.push(n):r.push(s);if(r.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${r.join(", ")}`);return typeof t.callback=="function"?t.callback(...i)??n:t.callback}_rendererLoadScript(e){return new Promise((t,n)=>{let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("type","text/javascript");let r=()=>{i.removeEventListener("load",s),i.removeEventListener("error",a)},s=l=>{r(),t(this._defineCalls.pop())},a=l=>{r(),n(l)};i.addEventListener("load",s),i.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),i.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(i)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{let t=(await import("fs")).default,n=(await import("vm")).default,i=(await import("module")).default,r=be.parse(e).fsPath,s=t.readFileSync(r).toString(),a=i.wrap(s.replace(/^#!.*/,""));return new n.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};var k1="utf8";var kEe=512*8,DEe=512*128;var L1={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},REe=(()=>{let o={};for(let e in L1)L1[e].guessableName&&(o[e]=L1[e]);return o})();var es=class extends Zl{constructor(t,n,i,r,s,a,l,d,c,u,p,m,g,f,b){super(l,a,f,b);this.resource=t;this.hasAssociatedFilePath=n;this.initialValue=i;this.preferredLanguageId=r;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=u;this.textFileService=p;this.labelService=m;this.editorService=g;this._register(this.workingCopyService.registerWorkingCopy(this)),r&&this.setLanguageId(r),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new L);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new L);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new L);onDidRevert=this._onDidRevert.event;typeId=_A;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(t=>this.onConfigurationChange(t,!0)))}onConfigurationChange(t,n){if(!t||t.affectsConfiguration(this.resource,"files.encoding")){let i=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==i&&typeof i=="string"&&(this.configuredEncoding=i,n&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!t||t.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let i=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==i&&(i==="content"||i==="name")&&(this.configuredLabelFormat=i,n&&this._onDidChangeName.fire())}}setLanguageId(t,n){let i=t===es.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:t;this.preferredLanguageId=i,i&&super.setLanguageId(i,n)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(t){let n=this.getEncoding();this.preferredEncoding=t,n!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(t){this.dirty!==t&&(this.dirty=t,this._onDidChangeDirty.fire())}async save(t){let n=await this.textFileService.save(this.resource,t);return n&&this._onDidSave.fire({reason:t?.reason,source:t?.source}),!!n}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(f1(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(t){let n;return this.isResolved()?n=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:k1}):typeof this.initialValue=="string"&&(n=BP(Tn.fromString(this.initialValue))),{content:n}}ignoreDirtyOnModelContentChange=!1;async resolve(){let t=!1,n=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let r,s=await this.workingCopyBackupService.resolve(this);s?(r=s.value,n=!0):r=WP(Tn.fromString(this.initialValue||""));let a=await hF(await this.textFileService.getDecodedStream(this.resource,r,{encoding:k1}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),t=!0}let i=Ms(this.textEditorModel);return this.installModelListeners(i),t&&((n||this.initialValue)&&this.updateNameFromFirstLine(i),this.setDirty(this.hasAssociatedFilePath||!!n||!!this.initialValue),(n||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n))),this._register(t.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(t)}onModelContentChanged(t,n){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&t.getLineCount()===1&&t.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),n.changes.some(i=>(i.range.startLineNumber===1||i.range.endLineNumber===1)&&i.range.startColumn<=es.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(t),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(t){if(this.hasAssociatedFilePath)return;let n,i=t.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:es.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");i=i.substr(0,mv(i,es.FIRST_LINE_NAME_MAX_LENGTH)[0]),i&&lg().exec(i)&&(n=i),n!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=n,this._onDidChangeName.fire())}isReadonly(){return!1}};es=K([D(5,Ki),D(6,vc),D(7,Fy),D(8,By),D(9,_c),D(10,xF),D(11,Qg),D(12,rd),D(13,Oy),D(14,Si)],es);var A5=Y("untitledTextEditorService"),Ec=class extends W{constructor(t,n){super();this.instantiationService=t;this.configurationService=n}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new L);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new L);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new L);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new Vi;get(t){return this.mapResourceToModel.get(t)}getValue(t){return this.get(t)?.textEditorModel?.getValue()}async resolve(t){let n=this.doCreateOrGet(t);return await n.resolve(),n}create(t){return this.doCreateOrGet(t)}doCreateOrGet(t=Object.create(null)){let n=this.massageOptions(t);return n.untitledResource&&this.mapResourceToModel.has(n.untitledResource)?this.mapResourceToModel.get(n.untitledResource):this.doCreate(n)}massageOptions(t){let n=Object.create(null);if(t.associatedResource?(n.untitledResource=be.from({scheme:$e.untitled,authority:t.associatedResource.authority,fragment:t.associatedResource.fragment,path:t.associatedResource.path,query:t.associatedResource.query}),n.associatedResource=t.associatedResource):t.untitledResource?.scheme===$e.untitled&&(n.untitledResource=t.untitledResource),t.languageId)n.languageId=t.languageId;else if(!n.associatedResource){let i=this.configurationService.getValue();i.files?.defaultLanguage&&(n.languageId=i.files.defaultLanguage)}return n.encoding=t.encoding,n.initialValue=t.initialValue,n}doCreate(t){let n=t.untitledResource;if(!n){let r=1;do n=be.from({scheme:$e.untitled,path:`Untitled-${r}`}),r++;while(this.mapResourceToModel.has(n))}let i=this._register(this.instantiationService.createInstance(es,n,!!t.associatedResource,t.initialValue,t.languageId,t.encoding));return this.registerModel(i),i}registerModel(t){let n=new te;n.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),n.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire(t))),n.add(t.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(t))),n.add(t.onWillDispose(()=>this._onWillDispose.fire(t))),de.once(t.onWillDispose)(()=>{this.mapResourceToModel.delete(t.resource),n.dispose()}),this.mapResourceToModel.set(t.resource,t),this._onDidCreate.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t)}isUntitledWithAssociatedResource(t){return t.scheme===$e.untitled&&t.path.length>1&&!Ec.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(t.path)}canDispose(t){return t.isDisposed()?!0:this.doCanDispose(t)}async doCanDispose(t){return t.isDirty()?(await de.toPromise(t.onDidChangeDirty),this.canDispose(t)):!0}};Ec=K([D(0,ct),D(1,tn)],Ec);$i(A5,Ec,1);var BI=ir,el=Y("notificationService");var D1=Y("progressService");var JTe=Object.freeze({total(){},worked(){},done(){}}),_F=class{constructor(e){this.callback=e}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(e){this._value=e,this.callback(this._value)}};var WI=class extends W{deferred=new Os;reporter;lastStep;constructor(e,t){super(),t.withProgress(e,n=>(this.reporter=n,this.lastStep&&n.report(this.lastStep),this.deferred.p)),this._register(ge(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};WI=K([D(1,D1)],WI);var eLe=Y("editorProgressService");var Wp=class extends W{constructor(t,n){super();this.logService=t;this.configurationService=n}participants=new Gn;addFileOperationParticipant(t){let n=this.participants.push(t);return ge(()=>n())}async participate(t,n,i,r){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(t,n,i,s,r)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};Wp=K([D(0,En),D(1,tn)],Wp);var mo=class extends W{constructor(t,n,i,r){super();this.getExpression=t;this.shouldUpdate=n;this.contextService=i;this.configurationService=r;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new L);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{this.shouldUpdate(t)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(t){let n=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!sn(c.expression,d.expression))&&(n=!0,this.mapFolderToParsedExpression.set(l,FT(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(n=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let i=new iv(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==mo.NO_FOLDER&&(i.has(be.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),n=!0));let r=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(mo.NO_FOLDER);r?(!s||!sn(s.expression,r.expression))&&(n=!0,this.mapFolderToParsedExpression.set(mo.NO_FOLDER,FT(r.expression)),this.mapFolderToConfiguredExpression.set(mo.NO_FOLDER,r)):s&&(n=!0,this.mapFolderToParsedExpression.delete(mo.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(mo.NO_FOLDER)),t&&n&&this._onExpressionChange.fire()}doGetExpression(t){let n=this.getExpression(t);if(!n)return;let i=Object.keys(n);if(i.length===0)return;let r=!1,s=Object.create(null);for(let a of i){r||(r=Hw(a));let l=a,d=$M(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=n[a]}return{expression:s,hasAbsolutePath:r}}matches(t,n){if(this.mapFolderToParsedExpression.size===0)return!1;let i=this.contextService.getWorkspaceFolder(t),r,s;if(i&&this.mapFolderToParsedExpression.has(i.uri.toString())?(r=this.mapFolderToParsedExpression.get(i.uri.toString()),s=this.mapFolderToConfiguredExpression.get(i.uri.toString())):(r=this.mapFolderToParsedExpression.get(mo.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(mo.NO_FOLDER)),!r)return!1;let a;return i?a=QM(i.uri,t):a=this.uriToPath(t),typeof a=="string"&&r(a,void 0,n)?!0:a!==this.uriToPath(t)&&s?.hasAbsolutePath?!!r(this.uriToPath(t),void 0,n):!1}uriToPath(t){return t.scheme===$e.file?t.fsPath:t.path}};mo=K([D(2,Na),D(3,tn)],mo);var N5=new ce("autoSaveAfterShortDelayContext",!1,!0);var R1=Y("filesConfigurationService"),go=class extends W{constructor(t,n,i,r,s,a,l,d){super();this.contextKeyService=t;this.configurationService=n;this.contextService=i;this.environmentService=r;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=n.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||lp.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=Ds?jr.AFTER_DELAY:jr.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:h("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:h({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:h({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:h({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:h("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new L);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new L);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new L);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new L);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new Hi(1e3);autoSaveDisabledOverrides=new Vi;autoSaveAfterShortDelayContext=N5.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new Jm(()=>this.createReadonlyMatcher(SA)));readonlyExcludeMatcher=this._register(new Jm(()=>this.createReadonlyMatcher(xA)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new Vi(t=>this.uriIdentityService.extUri.getComparisonKey(t));createReadonlyMatcher(t){let n=this._register(new mo(i=>this.configurationService.getValue(t,{resource:i}),i=>i.affectsConfiguration(t),this.contextService,this.configurationService));return this._register(n.onExpressionChange(()=>this._onDidChangeReadonly.fire())),n}isReadonly(t,n){let i=this.fileService.getProvider(t.scheme);if(i&&IA(i))return i.readOnlyMessage??go.READONLY_MESSAGES.providerReadonly;let r=this.sessionReadonlyOverrides.get(t);return typeof r=="boolean"?r===!0?go.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(t,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(t,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(t)?this.readonlyExcludeMatcher.value.matches(t)?!1:go.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&n?.locked?go.READONLY_MESSAGES.fileLocked:n?.readonly?go.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(t,n){if(n==="toggle"){let i;try{i=await this.fileService.resolve(t,{resolveMetadata:!0})}catch{}n=!this.isReadonly(t,i)}n==="reset"?this.sessionReadonlyOverrides.delete(t):this.sessionReadonlyOverrides.set(t,n),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(t,n){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,t.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),n&&this._onDidChangeAutoSaveConfiguration.fire();let i=t?.files?.associations;sn(this.currentFilesAssociationConfiguration,i)||(this.currentFilesAssociationConfiguration=i,n&&this._onDidChangeFilesAssociation.fire());let r=t?.files?.hotExit;r===lp.OFF||r===lp.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=r:this.currentHotExitConfiguration=lp.ON_EXIT;let s=!!t?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,n&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(t){let n=this.toResource(t);if(n){let i=this.autoSaveConfigurationCache.get(n);return i||(i=this.computeAutoSaveConfiguration(n,this.textResourceConfigurationService.getValue(n,"files")),this.autoSaveConfigurationCache.set(n,i)),i}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(t,n){let i,r,s,a,l,d;switch(n?.autoSave??go.DEFAULT_AUTO_SAVE_MODE){case jr.AFTER_DELAY:{i="afterDelay",r=typeof n?.autoSaveDelay=="number"&&n.autoSaveDelay>=0?n.autoSaveDelay:go.DEFAULT_AUTO_SAVE_DELAY,d=r<=go.DEFAULT_AUTO_SAVE_DELAY;break}case jr.ON_FOCUS_CHANGE:i="onFocusChange";break;case jr.ON_WINDOW_CHANGE:i="onWindowChange";break}return n?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,t&&!this.contextService.isInsideWorkspace(t)&&(l=!0,d=void 0)),n?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:i,autoSaveDelay:r,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(t){return t instanceof Za?Ap.getOriginalUri(t,{supportSideBySide:1}):t}hasShortAutoSaveDelay(t){let n=this.toResource(t);return this.getAutoSaveConfiguration(n).isShortAutoSaveDelay?!n||!this.autoSaveDisabledOverrides.has(n):!1}getAutoSaveMode(t,n){let i=this.toResource(t);if(i&&this.autoSaveDisabledOverrides.has(i))return{mode:0,reason:4};let r=this.getAutoSaveConfiguration(i);if(typeof r.autoSave>"u")return{mode:0,reason:1};if(typeof n=="number"&&(r.autoSave==="afterDelay"&&n!==2||r.autoSave==="onFocusChange"&&n!==3&&n!==4||r.autoSave==="onWindowChange"&&n!==4))return{mode:0,reason:1};if(i){if(r.autoSaveWorkspaceFilesOnly&&r.isOutOfWorkspace)return{mode:0,reason:2};if(r.autoSaveWhenNoErrors&&this.markerService.read({resource:i,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(r.autoSave){case"afterDelay":return typeof r.autoSaveDelay=="number"&&r.autoSaveDelay<=go.DEFAULT_AUTO_SAVE_DELAY?{mode:r.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let t=this.configurationService.getValue("files.autoSave"),n;return[jr.AFTER_DELAY,jr.ON_FOCUS_CHANGE,jr.ON_WINDOW_CHANGE].some(i=>i===t)?n=jr.OFF:n=jr.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",n)}disableAutoSave(t){let n=this.toResource(t);if(!n)return W.None;let i=this.autoSaveDisabledOverrides.get(n)??0;return this.autoSaveDisabledOverrides.set(n,i+1),i===0&&this._onDidChangeAutoSaveDisabled.fire(n),ge(()=>{let r=this.autoSaveDisabledOverrides.get(n)??0;r<=1?(this.autoSaveDisabledOverrides.delete(n),this._onDidChangeAutoSaveDisabled.fire(n)):this.autoSaveDisabledOverrides.set(n,r-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==lp.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(t,n){return this.configurationService.getValue("files.saveConflictResolution",{resource:t,overrideIdentifier:n})!=="overwriteFileOnDisk"}};go=K([D(0,rt),D(1,tn),D(2,Na),D(3,Vr),D(4,Op),D(5,qs),D(6,tA),D(7,By)],go);$i(R1,go,0);var M1=Y("workingCopyEditorService"),nf=class extends W{constructor(t){super();this.editorService=t}_onDidRegisterHandler=this._register(new L);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(t){return this.handlers.add(t),this._onDidRegisterHandler.fire(t),ge(()=>this.handlers.delete(t))}findEditor(t){for(let n of this.editorService.getEditors(0))if(this.isOpen(t,n.editor))return n}isOpen(t,n){for(let i of this.handlers)if(i.isOpen(t,n))return!0;return!1}};nf=K([D(0,rd)],nf);$i(M1,nf,1);var wF=Y("elevatedFileService");var Vp=class extends W{constructor(t,n){super();this.resource=t;this.fileService=n;this._register(this.fileService.onDidFilesChange(i=>this.onDidFilesChange(i)))}_onDidChangeOrphaned=this._register(new L);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(t){let n=!1,i;if(this.orphaned?t.contains(this.resource,1)&&(i=!1,n=!0):t.contains(this.resource,2)&&(i=!0,n=!0),n&&this.orphaned!==i){let r=!1;i&&(await ao(100,on.None),this.isDisposed()?r=!0:r=!await this.fileService.exists(this.resource)),this.orphaned!==r&&!this.isDisposed()&&this.setOrphaned(r)}}setOrphaned(t){this.orphaned!==t&&(this.orphaned=t,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};Vp=K([D(1,qs)],Vp);var Tc=class extends Vp{constructor(t,n,i,r,s,a,l,d,c,u,p,m,g,f,b,v){super(n,a);this.typeId=t;this.name=i;this.modelFactory=r;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=u;this.notificationService=m;this.workingCopyEditorService=g;this.editorService=f;this.elevatedFileService=b;this.progressService=v;this._register(p.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new L);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new L);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new L);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new L);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(t){if(!this.isResolved())return;let n=this.dirty;this.doSetDirty(t),t!==n&&this._onDidChangeDirty.fire()}doSetDirty(t){let n=this.dirty,i=this.inConflictMode,r=this.inErrorMode,s=this.savedVersionId;return t?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=n,this.inConflictMode=i,this.inErrorMode=r,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(t){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!t?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(t)}async doResolve(t){if(t?.contents)return this.resolveFromBuffer(t.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(t)}async resolveFromBuffer(t){this.trace("resolveFromBuffer()");let n,i,r,s;try{let a=await this.fileService.stat(this.resource);n=a.mtime,i=a.ctime,r=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){n=Date.now(),i=Date.now(),r=0,s=Lg,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:n,ctime:i,size:r,etag:s,value:t,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let t=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):t?(await this.doResolveFromBackup(t),!0):!1}async doResolveFromBackup(t){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:t.meta?t.meta.mtime:Date.now(),ctime:t.meta?t.meta.ctime:Date.now(),size:t.meta?t.meta.size:0,etag:t.meta?t.meta.etag:Lg,value:t.value,readonly:!1,locked:!1},!0),t.meta&&t.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(t){this.trace("resolveFromFile()");let n=t?.forceReadFromFile,i;n?i=Lg:this.lastResolvedFileStat&&(i=this.lastResolvedFileStat.etag);let r=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:i,limits:t?.limits});if(this.setOrphaned(!1),r!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof Ny&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!n)return;throw s}}async resolveFromContent(t,n){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:t.name,mtime:t.mtime,ctime:t.ctime,size:t.size,etag:t.etag,readonly:t.readonly,locked:t.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(t.value):await this.doCreateModel(t.value),this.setDirty(!!n),this._onDidResolve.fire()}async doCreateModel(t){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,t,on.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(t){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(t,on.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n.isUndoing||n.isRedoing))),this._register(t.onWillDispose(()=>this.dispose()))}onModelContentChanged(t,n){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),n&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(t.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let i=this.dirty;this.setDirty(!1),i&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(t){let n;this.lastResolvedFileStat&&(n={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let i;return this.isResolved()&&(i=await eg(this.model.snapshot(2,t),t)),{meta:n,content:i}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new Av;ignoreSaveFromSaveParticipants=!1;async save(t=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(t.reason===2||t.reason===3||t.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(t),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(t){typeof t.reason!="number"&&(t.reason=1);let n=this.versionId;if(this.trace(`doSave(${n}) - enter with versionId ${n}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${n}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(n))return this.trace(`doSave(${n}) - exit - found a running save for versionId ${n}`),this.saveSequentializer.running;if(!t.force&&!this.dirty){this.trace(`doSave(${n}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${n}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(t));this.isResolved()&&this.model.pushStackElement();let i=new $n;return this.progressService.withProgress({title:h("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},r=>this.doSaveSequential(n,t,r,i),()=>{i.cancel()}).finally(()=>{i.dispose()})}doSaveSequential(t,n,i,r){return this.saveSequentializer.run(t,(async()=>{if(this.isResolved()&&!n.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(n.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<Tc.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await ao(Tc.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!r.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:n.reason??1,savedFrom:n.from},i,r.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${t}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(r.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;t=this.versionId,this.inErrorMode=!1,i.report({message:h("saveTextFile","Writing into file...")}),this.trace(`doSave(${t}) - before write()`);let s=Ms(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(t,(async()=>{try{let l={mtime:s.mtime,etag:n.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?Lg:s.etag,unlock:n.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,r.token)}catch(c){if(r.token.isCancellationRequested)return;throw c}else{let c=await eg(a.model.snapshot(1,r.token),r.token);if(r.token.isCancellationRequested)return;r.dispose(),n?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,Ms(c),l):d=await this.fileService.writeFile(s.resource,Ms(c),l)}this.handleSaveSuccess(d,t,n)}catch(l){this.handleSaveError(l,t,n)}})(),()=>r.cancel())})(),()=>r.cancel())}handleSaveSuccess(t,n,i){this.updateLastResolvedFileStat(t),n===this.versionId?(this.trace(`handleSaveSuccess(${n}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${n}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:i.reason,stat:t,source:i.source})}handleSaveError(t,n,i){if((i.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${n}) - exit - resulted in a save error: ${t.toString()}`,this.resource.toString(),this.typeId]),i.ignoreErrorHandler)throw t;this.setDirty(!0),this.inErrorMode=!0,t.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(t,i),this._onDidSaveError.fire()}doHandleSaveError(t,n){let i=t,r=[],s;if(i.fileOperationResult===3)s=h("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),r.push(Ri({id:"fileWorkingCopy.overwrite",label:h("overwrite","Overwrite"),run:()=>this.save({...n,ignoreModifiedSince:!0,reason:1})})),r.push(Ri({id:"fileWorkingCopy.revert",label:h("revert","Revert"),run:()=>this.revert()}));else{let d=i.fileOperationResult===5,c=d&&i.options?.unlock,u=i.fileOperationResult===6,p=this.elevatedFileService.isSupported(this.resource);vE(t)&&r.push(...t.actions),p&&(u||c)?r.push(Ri({id:"fileWorkingCopy.saveElevated",label:c?dt?h("overwriteElevated","Overwrite as Admin..."):h("overwriteElevatedSudo","Overwrite as Sudo..."):dt?h("saveElevated","Retry as Admin..."):h("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...n,writeElevated:!0,writeUnlock:c,reason:1})}})):d?r.push(Ri({id:"fileWorkingCopy.unlock",label:h("overwrite","Overwrite"),run:()=>this.save({...n,writeUnlock:!0,reason:1})})):r.push(Ri({id:"fileWorkingCopy.retry",label:h("retry","Retry"),run:()=>this.save({...n,reason:1})})),r.push(Ri({id:"fileWorkingCopy.saveAs",label:h("saveAs","Save As..."),run:async()=>{let m=this.workingCopyEditorService.findEditor(this);m&&((await this.editorService.save(m,{saveAs:!0,reason:1})).success||this.doHandleSaveError(t,n))}})),r.push(Ri({id:"fileWorkingCopy.revert",label:h("revert","Revert"),run:()=>this.revert()})),d?c&&p?s=dt?h("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):h("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=h("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):p&&u?s=dt?h("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):h("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=h({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,Ov(t,!1))}let a=this.notificationService.notify({id:`${tr(this.resource.toString())}`,severity:BI.Error,message:s,actions:{primary:r}}),l=this._register(de.once(de.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(de.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(t){let n=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=t.mtime?this.lastResolvedFileStat=t:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:t.readonly,locked:t.locked}:this.lastResolvedFileStat=t,this.isReadonly()!==n&&this._onDidChangeReadonly.fire()}async revert(t){if(!this.isResolved()||!this.dirty&&!t?.force)return;this.trace("revert()");let n=this.dirty,i=this.doSetDirty(!1);if(!t?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw i(),s}this._onDidRevert.fire(),n&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(t){switch(t){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(t){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(t){this.logService.trace(`[stored file working copy] ${t}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};Tc=K([D(5,qs),D(6,En),D(7,P1),D(8,R1),D(9,Fy),D(10,_c),D(11,el),D(12,M1),D(13,rd),D(14,wF),D(15,D1)],Tc);var Hp=class extends W{constructor(t){super();this.logService=t}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(t){let n=Gb(this.saveParticipants,t);return ge(()=>n())}async participate(t,n,i,r){t.model?.pushStackElement();for(let s of this.saveParticipants){if(r.isCancellationRequested||t.isDisposed())break;try{let a=s.participate(t,n,i,r);await eg(a,r)}catch(a){this.logService.warn(a)}}t.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};Hp=K([D(0,En)],Hp);var P1=Y("workingCopyFileService"),of=class extends W{constructor(t,n,i,r){super();this.fileService=t;this.workingCopyService=n;this.instantiationService=i;this.uriIdentityService=r;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new Tu);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new Tu);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new Tu);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(t,n,i){return this.doCreateFileOrFolder(t,!0,n,i)}createFolder(t,n,i){return this.doCreateFileOrFolder(t,!1,n,i)}async doCreateFileOrFolder(t,n,i,r){if(t.length===0)return[];if(n){let c=(await br.settled(t.map(u=>this.fileService.canCreateFile(u.resource,{overwrite:u.overwrite})))).find(u=>u instanceof Error);if(c instanceof Error)throw c}let s=t.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,r,i);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,on.None);let l;try{n?l=await br.settled(t.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await br.settled(t.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,on.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,on.None),l}async move(t,n,i){return this.doMoveOrCopy(t,!0,n,i)}async copy(t,n,i){return this.doMoveOrCopy(t,!1,n,i)}async doMoveOrCopy(t,n,i,r){let s=[];for(let{file:{source:d,target:c},overwrite:u}of t){let p=await(n?this.fileService.canMove(d,c,u):this.fileService.canCopy(d,c,u));if(p instanceof Error)throw p}let a=t.map(d=>d.file);await this.runFileOperationParticipants(a,n?2:3,r,i);let l={correlationId:this.correlationIds++,operation:n?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,on.None);try{for(let{file:{source:d,target:c},overwrite:u}of t){if(!this.uriIdentityService.extUri.isEqual(d,c)){let p=n?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await br.settled(p.map(m=>m.revert({soft:!0})))}n?s.push(await this.fileService.move(d,c,u)):s.push(await this.fileService.copy(d,c,u))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,on.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,on.None),s}async delete(t,n,i){for(let a of t){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let r=t.map(a=>({target:a.resource}));await this.runFileOperationParticipants(r,1,i,n);let s={correlationId:this.correlationIds++,operation:1,files:r};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,on.None);for(let a of t){let l=this.getDirty(a.resource);await br.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of t)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,on.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,on.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(Wp));addFileOperationParticipant(t){return this.fileOperationParticipants.addFileOperationParticipant(t)}runFileOperationParticipants(t,n,i,r){return this.fileOperationParticipants.participate(t,n,i,r)}saveParticipants=this._register(this.instantiationService.createInstance(Hp));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(t){return this.saveParticipants.addSaveParticipant(t)}runSaveParticipants(t,n,i,r){return this.saveParticipants.participate(t,n,i,r)}workingCopyProviders=[];registerWorkingCopyProvider(t){let n=Gb(this.workingCopyProviders,t);return ge(n)}getDirty(t){let n=new Set;for(let i of this.workingCopyProviders)for(let r of i(t))r.isDirty()&&n.add(r);return Array.from(n)}};of=K([D(0,qs),D(1,_c),D(2,ct),D(3,Op)],of);$i(P1,of,1);var xF=Y("textFileService");var F5;(e=>e.DEFAULT={allowTrailingComma:!0})(F5||={});var kn=Y("keybindingService");var N1=".vscode",B5="settings",nMe=`${N1}/${B5}.json`;var iMe=[1],oMe=[2,3,4,5,6],W5=[3,4,5],rMe=[1,...W5],sMe=[2,3,4,5,6],V5=[3,4,5,6],H5=[4,5,6],VI="tasks",EF="launch",TF=Object.create(null);TF[VI]=`${N1}/${VI}.json`;TF[EF]=`${N1}/${EF}.json`;var U5=Object.create(null);U5[VI]=`${VI}.json`;var aMe=tn;var O1=class extends dp{_currentResultGroups=new Map;updateResultGroup(e,t){return t?this._currentResultGroups.set(e,t):this._currentResultGroups.delete(e),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let e=new Set;[...this._currentResultGroups.keys()].sort((t,n)=>this._currentResultGroups.get(t).order-this._currentResultGroups.get(n).order).forEach(t=>{let n=this._currentResultGroups.get(t);n.result.filterMatches=n.result.filterMatches.filter(i=>!e.has(i.setting.key)),n.result.filterMatches.forEach(i=>e.add(i.setting.key))})}filterSettings(e,t,n){let i=this.filterGroups,r=[];for(let s of i){let a=t(s);for(let l of s.sections)for(let d of l.settings){let c=n(d,s);(a||c)&&r.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return r}getPreference(e){for(let t of this.settingsGroups)for(let n of t.sections)for(let i of n.settings)if(e===i.key)return i}collectMetadata(e){let t=Object.create(null),n=!1;return e.forEach(i=>{i.result.metadata&&(t[i.id]=i.result.metadata,n=!0)}),n?t:null}get filterGroups(){return this.settingsGroups}};var HI=class extends O1{constructor(t,n){super();this._defaultSettings=t;this._register(n.onDidChangeConfiguration(i=>{i.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(tt.as(Ns.Configuration).onDidSchemaChange(i=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new L);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let t=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...t,...this.additionalGroups]}setAdditionalGroups(t){this.additionalGroups=t}findValueMatches(t,n){return[]}update(){throw new Error("Not supported")}};HI=K([D(1,tn)],HI);function K5(o){return"// "+h("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+o.getDefaultKeybindingsContent()}var UI=class{constructor(e,t){this._uri=e;this.keybindingService=t}_content;get uri(){return this._uri}get content(){return this._content||(this._content=K5(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};UI=K([D(1,kn)],UI);var qPe=Y("preferencesService");var Jg={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},G5={id:"default",displayName:h("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:h("builtinProviderDisplayName","Built-in")};function PI(o,e,t){for(let n of t.visibleEditorPanes)if(n.group.id===e&&o.matches(n.input))return n.getViewState()}function gF(o){if(Ao(o))return!1;let e=o;return be.isUri(e?.resource)}function Xa(o){if(Ao(o))return!1;let e=o;return e?.original!==void 0&&e.modified!==void 0}function Np(o){if(Ao(o))return!1;let e=o;return!e||e.resources&&!Array.isArray(e.resources)?!1:!!e.resources||!!e.multiDiffSource}function id(o){if(Ao(o)||Xa(o))return!1;let e=o;return e?.primary!==void 0&&e.secondary!==void 0}function od(o){if(Ao(o))return!1;let e=o;return be.isUri(e?.base?.resource)&&be.isUri(e?.input1?.resource)&&be.isUri(e?.input2?.resource)&&be.isUri(e?.result?.resource)}var F1=class{mapIdToSaveSource=new Map;registerSource(e,t){let n=this.mapIdToSaveSource.get(e);return n||(n={source:e,label:t},this.mapIdToSaveSource.set(e,n)),n.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},tNe=new F1;var Xg=class extends W{};function Ao(o){return o instanceof Xg}function $5(o){let e=o;return be.isUri(e?.preferredResource)}function j5(o){let e=o;return Ao(e?.primary)&&Ao(e?.secondary)}function y1(o){let e=o;return Ao(e?.modified)&&Ao(e?.original)}var B1=class{getOriginalUri(e,t){if(!e)return;if(od(e))return Ap.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getOriginalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getOriginalUri(i,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(Xa(e)||Np(e)||id(e)||od(e))return;let n=$5(e)?e.preferredResource:e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}getSideEditors(e){return j5(e)||id(e)?{primary:e.primary,secondary:e.secondary}:y1(e)||Xa(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(od(e))return Ap.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getCanonicalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getCanonicalUri(i,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(Xa(e)||Np(e)||id(e)||od(e))return;let n=e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(n=>e.scheme===n))return e}else if(t===e.scheme)return e}};var Ap=new B1;var W1=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(e){let t=this.instantiationService=e.get(ct);for(let[n,i]of this.editorSerializerConstructors)this.createEditorSerializer(n,i,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){let i=n.createInstance(t);this.editorSerializerInstances.set(e,i)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return Ms(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),ge(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};tt.add(Jg.EditorFactory,new W1);var LF=Y("editorPaneService");var RF;(e=>e.Workbench="workbench.contributions.kind")(RF||={});var Lc=(i=>(i[i.BlockStartup=1]="BlockStartup",i[i.BlockRestore=2]="BlockRestore",i[i.AfterRestored=3]="AfterRestored",i[i.Eventually=4]="Eventually",i))(Lc||{});function kF(o){let e=o;return!!e&&typeof e.editorTypeId=="string"}function q5(o){switch(o){case 3:return Lc.AfterRestored;case 4:return Lc.Eventually}}function DF(o){switch(o){case Lc.BlockStartup:return 1;case Lc.BlockRestore:return 2;case Lc.AfterRestored:return 3;case Lc.Eventually:return 4}}var kc=class o extends W{static INSTANCE=new o;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new te);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new Os;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(e,t,n){let i={id:e,ctor:t};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof n=="number"&&this.lifecycleService.phase>=n||typeof e=="string"&&kF(n)&&this.editorPaneService.didInstantiateEditorPane(n.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,i,typeof n=="number"?DF(n):this.lifecycleService.phase):(typeof n=="number"&&jw(this.contributionsByPhase,DF(n),[]).push(i),typeof e=="string"&&(this.contributionsById.has(e)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${e}'`):this.contributionsById.set(e,i),kF(n)&&jw(this.contributionsByEditor,n.editorTypeId,[]).push(i)))}registerWorkbenchContribution(e,t){this.registerWorkbenchContribution2(void 0,e,q5(t))}getWorkbenchContribution(e){if(this.instancesById.has(e))return this.instancesById.get(e);let t=this.instantiationService,n=this.lifecycleService,i=this.logService,r=this.environmentService;if(!t||!n||!i||!r)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): cannot be called before registry started`);let s=this.contributionsById.get(e);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution with that identifier is unknown.`);n.phase<3&&i.warn(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(t,i,r,s,n.phase);let a=this.instancesById.get(e);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): failed to create contribution.`);return a}start(e){let t=this.instantiationService=e.get(ct),n=this.lifecycleService=e.get(sP),i=this.logService=e.get(En),r=this.environmentService=e.get(Vr),s=this.editorPaneService=e.get(LF);this._register(n.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(t,n,i,r,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,t,n,i,r);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,t,n,i,r)))}onEditor(e,t,n,i,r){let s=this.contributionsByEditor.get(e);if(s){this.contributionsByEditor.delete(e);for(let a of s)this.safeCreateContribution(t,i,r,a,n.phase)}}instantiateByPhase(e,t,n,i,r){t.phase>=r?this.doInstantiateByPhase(e,n,i,r):t.when(r).then(()=>this.doInstantiateByPhase(e,n,i,r))}async doInstantiateByPhase(e,t,n,i){let r=this.contributionsByPhase.get(i);if(r)switch(this.contributionsByPhase.delete(i),i){case 1:case 2:{Hr(`code/willCreateWorkbenchContributions/${i}`);for(let s of r)this.safeCreateContribution(e,t,n,s,i);Hr(`code/didCreateWorkbenchContributions/${i}`);break}case 3:case 4:{i===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(r,e,t,n,i);break}}}doInstantiateWhenIdle(e,t,n,i,r){Hr(`code/willCreateWorkbenchContributions/${r}`);let s=0,a=r===4?3e3:500,l=d=>{for(;s<e.length;){let c=e[s++];if(this.safeCreateContribution(t,n,i,c,r),d.timeRemaining()<1){Wl(l,a);break}}s===e.length&&(Hr(`code/didCreateWorkbenchContributions/${r}`),r===3&&this.pendingRestoredContributions.complete())};Wl(l,a)}safeCreateContribution(e,t,n,i,r){if(typeof i.id=="string"&&this.instancesById.has(i.id))return;let s=Date.now();try{typeof i.id=="string"&&Hr(`code/willCreateWorkbenchContribution/${r}/${i.id}`);let a=e.createInstance(i.ctor);typeof i.id=="string"&&(this.instancesById.set(i.id,a),this.contributionsById.delete(i.id)),ov(a)&&this.instanceDisposables.add(a)}catch(a){t.error(`Unable to create workbench contribution '${i.id??i.ctor.name}'.`,a)}finally{typeof i.id=="string"&&Hr(`code/didCreateWorkbenchContribution/${r}/${i.id}`)}if(typeof i.id=="string"||!n.isBuilt){let a=Date.now()-s;if(a>(r<3?o.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:o.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&t.warn(`Creation of workbench contribution '${i.id??i.ctor.name}' took ${a}ms.`),typeof i.id=="string"){let l=this.timingsByPhase.get(r);l||(l=[],this.timingsByPhase.set(r,l)),l.push([i.id,a])}}}},_Ne=kc.INSTANCE.registerWorkbenchContribution2.bind(kc.INSTANCE),wNe=kc.INSTANCE.getWorkbenchContribution.bind(kc.INSTANCE);tt.add(RF.Workbench,kc.INSTANCE);function Lt(o,e,t){let n=null,i=null;if(typeof t.value=="function"?(n="value",i=t.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(n="get",i=t.get),!i)throw new Error("not supported");let r=`$memoize$${e}`;t[n]=function(...s){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,s)}),this[r]}}function V1(o){let e=JSON.parse(o);return e=Up(e),e}function Up(o,e=0){if(!o||e>200)return o;if(typeof o=="object"){switch(o.$mid){case 1:return be.revive(o);case 2:return new RegExp(o.source,o.flags);case 17:return new Date(o.source)}if(o instanceof Tn||o instanceof Uint8Array)return o;if(Array.isArray(o))for(let t=0;t<o.length;++t)o[t]=Up(o[t],e+1);else for(let t in o)Object.hasOwnProperty.call(o,t)&&(o[t]=Up(o[t],e+1))}return o}function MF(o){switch(o){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function PF(o){switch(o){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function zp(o){let e=0;for(let t=0;;t+=7){let n=o.read(1);if(e|=(n.buffer[0]&127)<<t,!(n.buffer[0]&128))return e}}var Q5=ad(0);function Kp(o,e){if(e===0){o.write(Q5);return}let t=0;for(let i=e;i!==0;i=i>>>7)t++;let n=Tn.alloc(t);for(let i=0;e!==0;i++)n.buffer[i]=e&127,e=e>>>7,e>0&&(n.buffer[i]|=128);o.write(n)}var U1=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},z1=class{buffers=[];get buffer(){return Tn.concat(this.buffers)}write(e){this.buffers.push(e)}};function ad(o){let e=Tn.alloc(1);return e.writeUInt8(o,0),e}var Dc={Undefined:ad(0),String:ad(1),Buffer:ad(2),VSBuffer:ad(3),Array:ad(4),Object:ad(5),Uint:ad(6)},Z5=typeof Buffer<"u";function K1(o,e){if(typeof e>"u")o.write(Dc.Undefined);else if(typeof e=="string"){let t=Tn.fromString(e);o.write(Dc.String),Kp(o,t.byteLength),o.write(t)}else if(Z5&&Buffer.isBuffer(e)){let t=Tn.wrap(e);o.write(Dc.Buffer),Kp(o,t.byteLength),o.write(t)}else if(e instanceof Tn)o.write(Dc.VSBuffer),Kp(o,e.byteLength),o.write(e);else if(Array.isArray(e)){o.write(Dc.Array),Kp(o,e.length);for(let t of e)K1(o,t)}else if(typeof e=="number"&&(e|0)===e)o.write(Dc.Uint),Kp(o,e);else{let t=Tn.fromString(JSON.stringify(e));o.write(Dc.Object),Kp(o,t.byteLength),o.write(t)}}function G1(o){switch(o.read(1).readUInt8(0)){case 0:return;case 1:return o.read(zp(o)).toString();case 2:return o.read(zp(o)).buffer;case 3:return o.read(zp(o));case 4:{let t=zp(o),n=[];for(let i=0;i<t;i++)n.push(G1(o));return n}case 5:return JSON.parse(o.read(zp(o)).toString());case 6:return zp(o)}}var H1=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(n=>this.onBuffer(n)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new L;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(n,i,r){return t.isDisposed?Promise.reject(new ni):t.requestPromise(e,n,i,r)},listen(n,i){return t.isDisposed?de.None:t.requestEvent(e,n,i)}}}requestPromise(e,t,n,i=on.None){let r=this.lastRequestId++,a={id:r,type:100,channelName:e,name:t,arg:n};if(i.isCancellationRequested)return Promise.reject(new ni);let l;return new Promise((c,u)=>{if(i.isCancellationRequested)return u(new ni);let p=()=>{let b=v=>{switch(v.type){case 201:this.handlers.delete(r),c(v.data);break;case 202:{this.handlers.delete(r);let I=new Error(v.data.message);I.stack=Array.isArray(v.data.stack)?v.data.stack.join(`
`):v.data.stack,I.name=v.data.name,u(I);break}case 203:this.handlers.delete(r),u(v.data);break}};this.handlers.set(r,b),this.sendRequest(a)},m=null;this.state===1?p():(m=oc(b=>this.whenInitialized()),m.then(()=>{m=null,p()}));let g=()=>{m?(m.cancel(),m=null):this.sendRequest({id:r,type:101}),u(new ni)},f=i.onCancellationRequested(g);l=Ts(ge(g),f),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(e,t,n){let i=this.lastRequestId++,s={id:i,type:102,channelName:e,name:t,arg:n},a=null,l=new L({onWillAddFirstListener:()=>{a=oc(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:i,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(i,d),l.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${MF(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,MF(e.type));return}}}send(e,t=void 0){let n=new z1;return K1(n,e),K1(n,t),this.sendBuffer(n.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new U1(e),n=G1(t),i=G1(t),r=n[0];switch(r){case 200:return this.logger?.logIncoming(e.byteLength,0,0,PF(r)),this.onResponse({type:n[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,n[1],0,PF(r),i),this.onResponse({type:n[0],id:n[1],data:i})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return de.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),xt(this.activeRequests.values()),this.activeRequests.clear()}};K([Lt],H1.prototype,"onDidInitializePromise",1);var X5;(i=>{function o(r,s,a){let l=r,d=a&&a.disableMarshalling,c=new Map;for(let u in l)t(u)&&c.set(u,de.buffer(l[u],!0,void 0,s));return new class{listen(u,p,m){let g=c.get(p);if(g)return g;let f=l[p];if(typeof f=="function"){if(n(p))return f.call(l,m);if(t(p))return c.set(p,de.buffer(l[p],!0,void 0,s)),c.get(p)}throw new xa(`Event not found: ${p}`)}call(u,p,m){let g=l[p];if(typeof g=="function"){if(!d&&Array.isArray(m))for(let b=0;b<m.length;b++)m[b]=Up(m[b]);let f=g.apply(l,m);return f instanceof Promise||(f=Promise.resolve(f)),f}throw new xa(`Method not found: ${p}`)}}}i.fromService=o;function e(r,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):n(d)?function(c){return r.listen(d,c)}:t(d)?r.listen(d):async function(...c){let u;s&&!Ii(s.context)?u=[s.context,...c]:u=c;let p=await r.call(d,u);return a?p:Up(p)};throw new xa(`Property not found: ${String(d)}`)}})}i.toService=e;function t(r){return r[0]==="o"&&r[1]==="n"&&Ps(r.charCodeAt(2))}function n(r){return/^onDynamic/.test(r)&&Ps(r.charCodeAt(9))}})(X5||={});var J5="diagnosticsService",mOe=Y(J5);var eU;(s=>{s.enableDiagnostics=!1,s.records=[];let t=new WeakMap,n=0;function i(a,l){if(!t.has(a)){let d=String(++n);t.set(a,d)}return t.get(a)}function r(a,l,d,c){}s.traceSocketEvent=r})(eU||={});var MOe=Y("remoteAuthorityResolverService");var zOe=Y("remoteSocketFactoryService");var tU="signService",$Oe=Y(tU);var xFe=30*1e3;var AF=Y("remoteAgentService"),zFe=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(o){let e=1/0;for(let n=0;n<this.maxSampleCount;n++){let i=await o.getRoundTripTime();if(i===void 0)return;e=Math.min(e,i/2),await ao(this.sampleDelay)}this.average.push(e),this.average.length>this.maxAverageCount&&this.average.shift();let t;return this.initial.length<this.maxInitialCount?this.initial.push(e):t=this.initial.reduce((n,i)=>n+i,0)/this.initial.length,this.lastMeasurement={initial:t,current:e,average:this.average.reduce((n,i)=>n+i,0)/this.average.length,high:typeof t>"u"?!1:e>this.highLatencyMaxThreshold||e>this.highLatencyMinThreshold&&e>t*this.highLatencyMultiple},this.lastMeasurement}};var g2e=Object.freeze({id:"application",order:100,title:h("applicationConfigurationTitle","Application"),type:"object"}),nU=Object.freeze({id:"workbench",order:7,title:h("workbenchConfigurationTitle","Workbench"),type:"object"}),iU=Object.freeze({id:"security",scope:1,title:h("securityConfigurationTitle","Security"),type:"object",order:7}),f2e=Object.freeze({id:"problems",title:h("problemsConfigurationTitle","Problems"),type:"object",order:101}),oU=Object.freeze({id:"window",order:8,title:h("windowConfigurationTitle","Window"),type:"object"}),ts={ConfigurationMigration:"base.contributions.configuration.migration"},$1=class{migrations=[];_onDidRegisterConfigurationMigrations=new L;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(e){this.migrations.push(...e)}},$I=new $1;tt.add(ts.ConfigurationMigration,$I);var zI=class extends W{constructor(t,n){super();this.configurationService=t;this.workspaceService=n;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(let r of i.added)await this.migrateConfigurationsForFolder(r,$I.migrations)})),this.migrateConfigurations($I.migrations),this._register($I.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(t){await this.migrateConfigurationsForFolder(void 0,t);for(let n of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(n,t)}async migrateConfigurationsForFolder(t,n){await Promise.all([n.map(i=>this.migrateConfigurationsForFolderAndOverride(i,t?.uri))])}async migrateConfigurationsForFolderAndOverride(t,n){let i=this.configurationService.inspect(t.key,{resource:n}),r=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of r){let l=i[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(t,s,l.value,n,void 0);for(let u of c??[])d.push([u,[]])}for(let{identifiers:c,value:u}of l.overrides??[])if(u!==void 0){let p=await this.runMigration(t,s,u,n,c);for(let m of p??[])d.push([m,c])}d.length&&await Promise.allSettled(d.map(async([[c,u],p])=>this.configurationService.updateValue(c,u.value,{resource:n,overrideIdentifiers:p},a)))}}async runMigration(t,n,i,r,s){let a=d=>{let u=this.configurationService.inspect(d,{resource:r})[n];if(u)return s?u.overrides?.find(({identifiers:p})=>sn(p,s))?.value:u.value},l=await t.migrateFn(i,a);return Array.isArray(l)?l:[[t.key,l]]}};zI=K([D(0,tn),D(1,Na)],zI);var KI=class extends W{constructor(t){super();this.remoteAgentService=t;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new Os;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!dt&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;tt.as(Ns.Configuration).registerConfiguration({...iU,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:h("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:h("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:h("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};KI=K([D(0,AF)],KI);var rf="window.newWindowProfile",GI=class extends W{constructor(t,n){super();this.userDataProfilesService=t;this.configurationService=n;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(i=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(n.onDidChangeConfiguration(i=>{i.source!==7&&i.affectsConfiguration(rf)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let t=tt.as(Ns.Configuration),n={...oU,properties:{[rf]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(i=>i.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(i=>""),h("active window","Active Window")],description:h("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?t.updateConfigurations({add:[n],remove:[this.configurationNode]}):t.registerConfiguration(n),this.configurationNode=n}setNewWindowProfile(){let t=this.configurationService.getValue(rf);this.newWindowProfile=t?this.userDataProfilesService.profiles.find(n=>n.name===t):void 0}checkAndResetNewWindowProfileConfig(){let t=this.configurationService.getValue(rf);if(!t)return;let n=this.newWindowProfile?this.userDataProfilesService.profiles.find(i=>i.id===this.newWindowProfile.id):void 0;t!==n?.name&&this.configurationService.updateValue(rf,n?.name)}};GI=K([D(0,vF),D(1,tn)],GI);function NF(o,e,t){return GR({debugName:()=>`Configuration Key "${o}"`},n=>t.onDidChangeConfiguration(i=>{i.affectsConfiguration(o)&&n(i)}),()=>t.getValue(o)??e)}var FF=Y("accessibilitySignalService"),q2e=Symbol("AcknowledgeDocCommentsToken"),jI=class extends W{constructor(t,n,i){super();this.configurationService=t;this.accessibilityService=n;this.telemetryService=i}_serviceBrand;sounds=new Map;screenReaderAttached=fn(this,this.accessibilityService.onDidChangeScreenReaderOptimized,()=>this.accessibilityService.isScreenReaderOptimized());sentTelemetry=new Set;getEnabledState(t,n,i){return new kb(this._signalEnabledState.get({signal:t,userGesture:n,modality:i}))}async playSignal(t,n={}){let i=n.modality==="announcement"||n.modality===void 0,r=t.announcementMessage;i&&this.isAnnouncementEnabled(t,n.userGesture)&&r&&this.accessibilityService.status(r),(n.modality==="sound"||n.modality===void 0)&&this.isSoundEnabled(t,n.userGesture)&&(this.sendSignalTelemetry(t,n.source),await this.playSound(t.sound.getSound(),n.allowManyInParallel))}async playSignals(t){for(let s of t)this.sendSignalTelemetry("signal"in s?s.signal:s,"source"in s?s.source:void 0);let n=t.map(s=>"signal"in s?s.signal:s),i=n.filter(s=>this.isAnnouncementEnabled(s)).map(s=>s.announcementMessage);i.length&&this.accessibilityService.status(i.join(", "));let r=new Set(n.filter(s=>this.isSoundEnabled(s)).map(s=>s.sound.getSound()));await Promise.all(Array.from(r).map(s=>this.playSound(s,!0)))}sendSignalTelemetry(t,n){let i=this.accessibilityService.isScreenReaderOptimized(),r=t.name+(n?`::${n}`:"")+(i?"{screenReaderOptimized}":"");this.sentTelemetry.has(r)||this.getVolumeInPercent()===0||(this.sentTelemetry.add(r),this.telemetryService.publicLog2("signal.played",{signal:t.name,source:n??"",isScreenReaderOptimized:i}))}getVolumeInPercent(){let t=this.configurationService.getValue("accessibility.signalOptions.volume");return typeof t!="number"?50:Math.max(Math.min(t,100),0)}playingSounds=new Set;async playSound(t,n=!1){if(!n&&this.playingSounds.has(t))return;this.playingSounds.add(t);let i=Zd.asBrowserUri(`vs/platform/accessibilitySignal/browser/media/${t.fileName}`).toString(!0);try{let r=this.sounds.get(i);if(r)r.volume=this.getVolumeInPercent()/100,r.currentTime=0,await r.play();else{let s=await rU(i,this.getVolumeInPercent()/100);this.sounds.set(i,s)}}catch(r){r.message.includes("play() can only be initiated by a user gesture")||console.error("Error while playing sound",r)}finally{this.playingSounds.delete(t)}}playSignalLoop(t,n){let i=!0,r=()=>{i&&this.playSignal(t,{allowManyInParallel:!0}).finally(()=>{setTimeout(()=>{i&&r()},n)})};return r(),ge(()=>i=!1)}_signalConfigValue=new Pl(t=>NF(t.settingsKey,{sound:"off",announcement:"off"},this.configurationService));_signalEnabledState=new Pl({getCacheKey:FR},t=>gn(n=>{let i=this._signalConfigValue.get(t.signal).read(n);return!!((t.modality==="sound"||t.modality===void 0)&&OF(i.sound,()=>this.screenReaderAttached.read(n),t.userGesture)||(t.modality==="announcement"||t.modality===void 0)&&OF(i.announcement,()=>this.screenReaderAttached.read(n),t.userGesture))}).recomputeInitiallyAndOnChange(this._store));isAnnouncementEnabled(t,n){return t.announcementMessage?this._signalEnabledState.get({signal:t,userGesture:!!n,modality:"announcement"}).get():!1}isSoundEnabled(t,n){return this._signalEnabledState.get({signal:t,userGesture:!!n,modality:"sound"}).get()}onSoundEnabledChanged(t){return this.getEnabledState(t,!1).onDidChange}getDelayMs(t,n,i){if(!this.configurationService.getValue("accessibility.signalOptions.debouncePositionChanges"))return 0;let r;return t.name===tl.errorAtPosition.name&&i==="positional"?r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.errorAtPosition"):t.name===tl.warningAtPosition.name&&i==="positional"?r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.warningAtPosition"):r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.general"),n==="sound"?r.sound:r.announcement}};jI=K([D(0,tn),D(1,Si),D(2,sr)],jI);function OF(o,e,t){return o==="on"||o==="always"||o==="auto"&&e()||o==="userGesture"&&t}function rU(o,e){return new Promise((t,n)=>{let i=new Audio(o);i.volume=e,i.addEventListener("ended",()=>{t(i)}),i.addEventListener("error",r=>{n(r.error)}),i.play().catch(r=>{n(r)})})}var kt=class o{constructor(e){this.fileName=e}static register(e){return new o(e.fileName)}static error=o.register({fileName:"error.mp3"});static warning=o.register({fileName:"warning.mp3"});static success=o.register({fileName:"success.mp3"});static foldedArea=o.register({fileName:"foldedAreas.mp3"});static break=o.register({fileName:"break.mp3"});static quickFixes=o.register({fileName:"quickFixes.mp3"});static taskCompleted=o.register({fileName:"taskCompleted.mp3"});static taskFailed=o.register({fileName:"taskFailed.mp3"});static terminalBell=o.register({fileName:"terminalBell.mp3"});static diffLineInserted=o.register({fileName:"diffLineInserted.mp3"});static diffLineDeleted=o.register({fileName:"diffLineDeleted.mp3"});static diffLineModified=o.register({fileName:"diffLineModified.mp3"});static chatRequestSent=o.register({fileName:"chatRequestSent.mp3"});static chatResponseReceived1=o.register({fileName:"chatResponseReceived1.mp3"});static chatResponseReceived2=o.register({fileName:"chatResponseReceived2.mp3"});static chatResponseReceived3=o.register({fileName:"chatResponseReceived3.mp3"});static chatResponseReceived4=o.register({fileName:"chatResponseReceived4.mp3"});static clear=o.register({fileName:"clear.mp3"});static save=o.register({fileName:"save.mp3"});static format=o.register({fileName:"format.mp3"});static voiceRecordingStarted=o.register({fileName:"voiceRecordingStarted.mp3"});static voiceRecordingStopped=o.register({fileName:"voiceRecordingStopped.mp3"});static progress=o.register({fileName:"progress.mp3"})},j1=class{constructor(e){this.randomOneOf=e}getSound(e=!1){if(e||this.randomOneOf.length===1)return this.randomOneOf[0];{let t=Math.floor(Math.random()*this.randomOneOf.length);return this.randomOneOf[t]}}},tl=class o{constructor(e,t,n,i,r,s){this.sound=e;this.name=t;this.legacySoundSettingsKey=n;this.settingsKey=i;this.legacyAnnouncementSettingsKey=r;this.announcementMessage=s}static _signals=new Set;static register(e){let t=new j1("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),n=new o(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage);return o._signals.add(n),n}static get allAccessibilitySignals(){return[...this._signals]}static errorAtPosition=o.register({name:h("accessibilitySignals.positionHasError.name","Error at Position"),sound:kt.error,announcementMessage:h("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"});static warningAtPosition=o.register({name:h("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:kt.warning,announcementMessage:h("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"});static errorOnLine=o.register({name:h("accessibilitySignals.lineHasError.name","Error on Line"),sound:kt.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:h("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"});static warningOnLine=o.register({name:h("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:kt.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:h("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"});static foldedArea=o.register({name:h("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:kt.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:h("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"});static break=o.register({name:h("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:kt.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:h("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"});static inlineSuggestion=o.register({name:h("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:kt.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"});static terminalQuickFix=o.register({name:h("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:kt.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:h("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"});static onDebugBreak=o.register({name:h("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:kt.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:h("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"});static noInlayHints=o.register({name:h("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:kt.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:h("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"});static taskCompleted=o.register({name:h("accessibilitySignals.taskCompleted","Task Completed"),sound:kt.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:h("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"});static taskFailed=o.register({name:h("accessibilitySignals.taskFailed","Task Failed"),sound:kt.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:h("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"});static terminalCommandFailed=o.register({name:h("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:kt.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:h("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"});static terminalCommandSucceeded=o.register({name:h("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:kt.success,announcementMessage:h("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"});static terminalBell=o.register({name:h("accessibilitySignals.terminalBell","Terminal Bell"),sound:kt.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:h("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"});static notebookCellCompleted=o.register({name:h("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:kt.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:h("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"});static notebookCellFailed=o.register({name:h("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:kt.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:h("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"});static diffLineInserted=o.register({name:h("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:kt.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"});static diffLineDeleted=o.register({name:h("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:kt.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"});static diffLineModified=o.register({name:h("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:kt.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"});static chatRequestSent=o.register({name:h("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:kt.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:h("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"});static chatResponseReceived=o.register({name:h("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[kt.chatResponseReceived1,kt.chatResponseReceived2,kt.chatResponseReceived3,kt.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"});static progress=o.register({name:h("accessibilitySignals.progress","Progress"),sound:kt.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:h("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"});static clear=o.register({name:h("accessibilitySignals.clear","Clear"),sound:kt.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:h("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"});static save=o.register({name:h("accessibilitySignals.save","Save"),sound:kt.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:h("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"});static format=o.register({name:h("accessibilitySignals.format","Format"),sound:kt.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:h("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"});static voiceRecordingStarted=o.register({name:h("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:kt.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"});static voiceRecordingStopped=o.register({name:h("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:kt.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"})};var BF=Y("speechService"),dBe=new ce("hasSpeechProvider",!1,{type:"boolean",description:h("hasSpeechProvider","A speech provider is registered to the speech service.")}),cBe=new ce("speechToTextInProgress",!1,{type:"boolean",description:h("speechToTextInProgress","A speech-to-text session is in progress.")}),uBe=new ce("textToSpeechInProgress",!1,{type:"boolean",description:h("textToSpeechInProgress","A text-to-speech session is in progress.")});var WF={"da-DK":{name:h("speechLanguage.da-DK","Danish (Denmark)")},"de-DE":{name:h("speechLanguage.de-DE","German (Germany)")},"en-AU":{name:h("speechLanguage.en-AU","English (Australia)")},"en-CA":{name:h("speechLanguage.en-CA","English (Canada)")},"en-GB":{name:h("speechLanguage.en-GB","English (United Kingdom)")},"en-IE":{name:h("speechLanguage.en-IE","English (Ireland)")},"en-IN":{name:h("speechLanguage.en-IN","English (India)")},"en-NZ":{name:h("speechLanguage.en-NZ","English (New Zealand)")},"en-US":{name:h("speechLanguage.en-US","English (United States)")},"es-ES":{name:h("speechLanguage.es-ES","Spanish (Spain)")},"es-MX":{name:h("speechLanguage.es-MX","Spanish (Mexico)")},"fr-CA":{name:h("speechLanguage.fr-CA","French (Canada)")},"fr-FR":{name:h("speechLanguage.fr-FR","French (France)")},"hi-IN":{name:h("speechLanguage.hi-IN","Hindi (India)")},"it-IT":{name:h("speechLanguage.it-IT","Italian (Italy)")},"ja-JP":{name:h("speechLanguage.ja-JP","Japanese (Japan)")},"ko-KR":{name:h("speechLanguage.ko-KR","Korean (South Korea)")},"nl-NL":{name:h("speechLanguage.nl-NL","Dutch (Netherlands)")},"pt-PT":{name:h("speechLanguage.pt-PT","Portuguese (Portugal)")},"pt-BR":{name:h("speechLanguage.pt-BR","Portuguese (Brazil)")},"ru-RU":{name:h("speechLanguage.ru-RU","Russian (Russia)")},"sv-SE":{name:h("speechLanguage.sv-SE","Swedish (Sweden)")},"tr-TR":{name:h("speechLanguage.tr-TR","Turkish (T\xFCrkiye)")},"zh-CN":{name:h("speechLanguage.zh-CN","Chinese (Simplified, China)")},"zh-HK":{name:h("speechLanguage.zh-HK","Chinese (Traditional, Hong Kong)")},"zh-TW":{name:h("speechLanguage.zh-TW","Chinese (Traditional, Taiwan)")}};var nl=new ce("accessibilityHelpIsShown",!1,!0),Yi=new ce("accessibleViewIsShown",!1,!0),sf=new ce("accessibleViewSupportsNavigation",!1,!0),Y1=new ce("accessibleViewVerbosityEnabled",!1,!0),Q1=new ce("accessibleViewGoToSymbolSupported",!1,!0),PBe=new ce("accessibleViewOnLastLine",!1,!0),af=new ce("accessibleViewCurrentProviderId",void 0,void 0),ABe=new ce("accessibleViewInCodeBlock",void 0,void 0),lf=new ce("accessibleViewContainsCodeBlocks",void 0,void 0),Z1=new ce("accessibleViewHasUnassignedKeybindings",void 0,void 0),X1=new ce("accessibleViewHasAssignedKeybindings",void 0,void 0);var Fo={type:"boolean",default:!0,tags:["accessibility"]},VF=Object.freeze({id:"accessibility",title:h("accessibilityConfigurationTitle","Accessibility"),type:"object"}),ln={type:"string",enum:["auto","on","off"],default:"auto",enumDescriptions:[h("sound.enabled.auto","Enable sound when a screen reader is attached."),h("sound.enabled.on","Enable sound."),h("sound.enabled.off","Disable sound.")],tags:["accessibility"]},si={type:"object",tags:["accessibility"],additionalProperties:!1,default:{sound:"auto",announcement:"auto"}},ai={type:"string",enum:["auto","off"],default:"auto",enumDescriptions:[h("announcement.enabled.auto","Enable announcement, will only play when in screen reader optimized mode."),h("announcement.enabled.off","Disable announcement.")],tags:["accessibility"]},Rc={type:"object",tags:["accessibility"],additionalProperties:!1,default:{sound:"auto"}},NBe={...VF,scope:4,properties:{"accessibility.verbosity.terminal":{description:h("verbosity.terminal.description","Provide information about how to access the terminal accessibility help menu when the terminal is focused."),...Fo},"accessibility.verbosity.diffEditor":{description:h("verbosity.diffEditor.description","Provide information about how to navigate changes in the diff editor when it is focused."),...Fo},"accessibility.verbosity.panelChat":{description:h("verbosity.chat.description","Provide information about how to access the chat help menu when the chat input is focused."),...Fo},"accessibility.verbosity.inlineChat":{description:h("verbosity.interactiveEditor.description","Provide information about how to access the inline editor chat accessibility help menu and alert with hints that describe how to use the feature when the input is focused."),...Fo},"accessibility.verbosity.inlineCompletions":{description:h("verbosity.inlineCompletions.description","Provide information about how to access the inline completions hover and Accessible View."),...Fo},"accessibility.verbosity.keybindingsEditor":{description:h("verbosity.keybindingsEditor.description","Provide information about how to change a keybinding in the keybindings editor when a row is focused."),...Fo},"accessibility.verbosity.notebook":{description:h("verbosity.notebook","Provide information about how to focus the cell container or inner editor when a notebook cell is focused."),...Fo},"accessibility.verbosity.hover":{description:h("verbosity.hover","Provide information about how to open the hover in an Accessible View."),...Fo},"accessibility.verbosity.notification":{description:h("verbosity.notification","Provide information about how to open the notification in an Accessible View."),...Fo},"accessibility.verbosity.emptyEditorHint":{description:h("verbosity.emptyEditorHint","Provide information about relevant actions in an empty text editor."),...Fo},"accessibility.verbosity.replInputHint":{description:h("verbosity.replInputHint","Provide information about relevant actions For the Repl input."),...Fo},"accessibility.verbosity.comments":{description:h("verbosity.comments","Provide information about actions that can be taken in the comment widget or in a file which contains comments."),...Fo},"accessibility.verbosity.diffEditorActive":{description:h("verbosity.diffEditorActive","Indicate when a diff editor becomes the active editor."),...Fo},"accessibility.verbosity.debug":{description:h("verbosity.debug","Provide information about how to access the debug console accessibility help dialog when the debug console or run and debug viewlet is focused. Note that a reload of the window is required for this to take effect."),...Fo},"accessibility.accessibleView.closeOnKeyPress":{markdownDescription:h("terminal.integrated.accessibleView.closeOnKeyPress","On keypress, close the Accessible View and focus the element from which it was invoked."),type:"boolean",default:!0},"accessibility.signalOptions.volume":{description:h("accessibility.signalOptions.volume","The volume of the sounds in percent (0-100)."),type:"number",minimum:0,maximum:100,default:70,tags:["accessibility"]},"accessibility.signalOptions.debouncePositionChanges":{description:h("accessibility.signalOptions.debouncePositionChanges","Whether or not position changes should be debounced"),type:"boolean",default:!1,tags:["accessibility"]},"accessibility.signalOptions.experimental.delays.general":{type:"object",description:"Delays for all signals besides error and warning at position",additionalProperties:!1,properties:{announcement:{description:h("accessibility.signalOptions.delays.general.announcement","The delay in milliseconds before an announcement is made."),type:"number",minimum:0,default:3e3},sound:{description:h("accessibility.signalOptions.delays.general.sound","The delay in milliseconds before a sound is played."),type:"number",minimum:0,default:400}},tags:["accessibility"]},"accessibility.signalOptions.experimental.delays.warningAtPosition":{type:"object",additionalProperties:!1,properties:{announcement:{description:h("accessibility.signalOptions.delays.warningAtPosition.announcement","The delay in milliseconds before an announcement is made when there's a warning at the position."),type:"number",minimum:0,default:3e3},sound:{description:h("accessibility.signalOptions.delays.warningAtPosition.sound","The delay in milliseconds before a sound is played when there's a warning at the position."),type:"number",minimum:0,default:1e3}},tags:["accessibility"]},"accessibility.signalOptions.experimental.delays.errorAtPosition":{type:"object",additionalProperties:!1,properties:{announcement:{description:h("accessibility.signalOptions.delays.errorAtPosition.announcement","The delay in milliseconds before an announcement is made when there's an error at the position."),type:"number",minimum:0,default:3e3},sound:{description:h("accessibility.signalOptions.delays.errorAtPosition.sound","The delay in milliseconds before a sound is played when there's an error at the position."),type:"number",minimum:0,default:1e3}},tags:["accessibility"]},"accessibility.signals.lineHasBreakpoint":{...si,description:h("accessibility.signals.lineHasBreakpoint","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has a breakpoint."),properties:{sound:{description:h("accessibility.signals.lineHasBreakpoint.sound","Plays a sound when the active line has a breakpoint."),...ln},announcement:{description:h("accessibility.signals.lineHasBreakpoint.announcement","Announces when the active line has a breakpoint."),...ai}}},"accessibility.signals.lineHasInlineSuggestion":{...Rc,description:h("accessibility.signals.lineHasInlineSuggestion","Plays a sound / audio cue when the active line has an inline suggestion."),properties:{sound:{description:h("accessibility.signals.lineHasInlineSuggestion.sound","Plays a sound when the active line has an inline suggestion."),...ln,default:"off"}}},"accessibility.signals.lineHasError":{...si,description:h("accessibility.signals.lineHasError","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has an error."),properties:{sound:{description:h("accessibility.signals.lineHasError.sound","Plays a sound when the active line has an error."),...ln},announcement:{description:h("accessibility.signals.lineHasError.announcement","Announces when the active line has an error."),...ai,default:"off"}}},"accessibility.signals.lineHasFoldedArea":{...si,description:h("accessibility.signals.lineHasFoldedArea","Plays a signal - sound (audio cue) and/or announcement (alert) - the active line has a folded area that can be unfolded."),properties:{sound:{description:h("accessibility.signals.lineHasFoldedArea.sound","Plays a sound when the active line has a folded area that can be unfolded."),...ln,default:"off"},announcement:{description:h("accessibility.signals.lineHasFoldedArea.announcement","Announces when the active line has a folded area that can be unfolded."),...ai}}},"accessibility.signals.lineHasWarning":{...si,description:h("accessibility.signals.lineHasWarning","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has a warning."),properties:{sound:{description:h("accessibility.signals.lineHasWarning.sound","Plays a sound when the active line has a warning."),...ln},announcement:{description:h("accessibility.signals.lineHasWarning.announcement","Announces when the active line has a warning."),...ai,default:"off"}}},"accessibility.signals.positionHasError":{...si,description:h("accessibility.signals.positionHasError","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has a warning."),properties:{sound:{description:h("accessibility.signals.positionHasError.sound","Plays a sound when the active line has a warning."),...ln},announcement:{description:h("accessibility.signals.positionHasError.announcement","Announces when the active line has a warning."),...ai,default:"on"}}},"accessibility.signals.positionHasWarning":{...si,description:h("accessibility.signals.positionHasWarning","Plays a signal - sound (audio cue) and/or announcement (alert) - when the active line has a warning."),properties:{sound:{description:h("accessibility.signals.positionHasWarning.sound","Plays a sound when the active line has a warning."),...ln},announcement:{description:h("accessibility.signals.positionHasWarning.announcement","Announces when the active line has a warning."),...ai,default:"on"}}},"accessibility.signals.onDebugBreak":{...si,description:h("accessibility.signals.onDebugBreak","Plays a signal - sound (audio cue) and/or announcement (alert) - when the debugger stopped on a breakpoint."),properties:{sound:{description:h("accessibility.signals.onDebugBreak.sound","Plays a sound when the debugger stopped on a breakpoint."),...ln},announcement:{description:h("accessibility.signals.onDebugBreak.announcement","Announces when the debugger stopped on a breakpoint."),...ai}}},"accessibility.signals.noInlayHints":{...si,description:h("accessibility.signals.noInlayHints","Plays a signal - sound (audio cue) and/or announcement (alert) - when trying to read a line with inlay hints that has no inlay hints."),properties:{sound:{description:h("accessibility.signals.noInlayHints.sound","Plays a sound when trying to read a line with inlay hints that has no inlay hints."),...ln},announcement:{description:h("accessibility.signals.noInlayHints.announcement","Announces when trying to read a line with inlay hints that has no inlay hints."),...ai}}},"accessibility.signals.taskCompleted":{...si,description:h("accessibility.signals.taskCompleted","Plays a signal - sound (audio cue) and/or announcement (alert) - when a task is completed."),properties:{sound:{description:h("accessibility.signals.taskCompleted.sound","Plays a sound when a task is completed."),...ln},announcement:{description:h("accessibility.signals.taskCompleted.announcement","Announces when a task is completed."),...ai}}},"accessibility.signals.taskFailed":{...si,description:h("accessibility.signals.taskFailed","Plays a signal - sound (audio cue) and/or announcement (alert) - when a task fails (non-zero exit code)."),properties:{sound:{description:h("accessibility.signals.taskFailed.sound","Plays a sound when a task fails (non-zero exit code)."),...ln},announcement:{description:h("accessibility.signals.taskFailed.announcement","Announces when a task fails (non-zero exit code)."),...ai}}},"accessibility.signals.terminalCommandFailed":{...si,description:h("accessibility.signals.terminalCommandFailed","Plays a signal - sound (audio cue) and/or announcement (alert) - when a terminal command fails (non-zero exit code) or when a command with such an exit code is navigated to in the accessible view."),properties:{sound:{description:h("accessibility.signals.terminalCommandFailed.sound","Plays a sound when a terminal command fails (non-zero exit code) or when a command with such an exit code is navigated to in the accessible view."),...ln},announcement:{description:h("accessibility.signals.terminalCommandFailed.announcement","Announces when a terminal command fails (non-zero exit code) or when a command with such an exit code is navigated to in the accessible view."),...ai}}},"accessibility.signals.terminalCommandSucceeded":{...si,description:h("accessibility.signals.terminalCommandSucceeded","Plays a signal - sound (audio cue) and/or announcement (alert) - when a terminal command succeeds (zero exit code) or when a command with such an exit code is navigated to in the accessible view."),properties:{sound:{description:h("accessibility.signals.terminalCommandSucceeded.sound","Plays a sound when a terminal command succeeds (zero exit code) or when a command with such an exit code is navigated to in the accessible view."),...ln},announcement:{description:h("accessibility.signals.terminalCommandSucceeded.announcement","Announces when a terminal command succeeds (zero exit code) or when a command with such an exit code is navigated to in the accessible view."),...ai}}},"accessibility.signals.terminalQuickFix":{...si,description:h("accessibility.signals.terminalQuickFix","Plays a signal - sound (audio cue) and/or announcement (alert) - when terminal Quick Fixes are available."),properties:{sound:{description:h("accessibility.signals.terminalQuickFix.sound","Plays a sound when terminal Quick Fixes are available."),...ln},announcement:{description:h("accessibility.signals.terminalQuickFix.announcement","Announces when terminal Quick Fixes are available."),...ai}}},"accessibility.signals.terminalBell":{...si,description:h("accessibility.signals.terminalBell","Plays a signal - sound (audio cue) and/or announcement (alert) - when the terminal bell is ringing."),properties:{sound:{description:h("accessibility.signals.terminalBell.sound","Plays a sound when the terminal bell is ringing."),...ln},announcement:{description:h("accessibility.signals.terminalBell.announcement","Announces when the terminal bell is ringing."),...ai}}},"accessibility.signals.diffLineInserted":{...Rc,description:h("accessibility.signals.diffLineInserted","Plays a sound / audio cue when the focus moves to an inserted line in Accessible Diff Viewer mode or to the next/previous change."),properties:{sound:{description:h("accessibility.signals.sound","Plays a sound when the focus moves to an inserted line in Accessible Diff Viewer mode or to the next/previous change."),...ln}}},"accessibility.signals.diffLineModified":{...Rc,description:h("accessibility.signals.diffLineModified","Plays a sound / audio cue when the focus moves to an modified line in Accessible Diff Viewer mode or to the next/previous change."),properties:{sound:{description:h("accessibility.signals.diffLineModified.sound","Plays a sound when the focus moves to a modified line in Accessible Diff Viewer mode or to the next/previous change."),...ln}}},"accessibility.signals.diffLineDeleted":{...Rc,description:h("accessibility.signals.diffLineDeleted","Plays a sound / audio cue when the focus moves to an deleted line in Accessible Diff Viewer mode or to the next/previous change."),properties:{sound:{description:h("accessibility.signals.diffLineDeleted.sound","Plays a sound when the focus moves to an deleted line in Accessible Diff Viewer mode or to the next/previous change."),...ln}}},"accessibility.signals.notebookCellCompleted":{...si,description:h("accessibility.signals.notebookCellCompleted","Plays a signal - sound (audio cue) and/or announcement (alert) - when a notebook cell execution is successfully completed."),properties:{sound:{description:h("accessibility.signals.notebookCellCompleted.sound","Plays a sound when a notebook cell execution is successfully completed."),...ln},announcement:{description:h("accessibility.signals.notebookCellCompleted.announcement","Announces when a notebook cell execution is successfully completed."),...ai}}},"accessibility.signals.notebookCellFailed":{...si,description:h("accessibility.signals.notebookCellFailed","Plays a signal - sound (audio cue) and/or announcement (alert) - when a notebook cell execution fails."),properties:{sound:{description:h("accessibility.signals.notebookCellFailed.sound","Plays a sound when a notebook cell execution fails."),...ln},announcement:{description:h("accessibility.signals.notebookCellFailed.announcement","Announces when a notebook cell execution fails."),...ai}}},"accessibility.signals.chatRequestSent":{...si,description:h("accessibility.signals.chatRequestSent","Plays a signal - sound (audio cue) and/or announcement (alert) - when a chat request is made."),properties:{sound:{description:h("accessibility.signals.chatRequestSent.sound","Plays a sound when a chat request is made."),...ln},announcement:{description:h("accessibility.signals.chatRequestSent.announcement","Announces when a chat request is made."),...ai}}},"accessibility.signals.progress":{...si,description:h("accessibility.signals.progress","Plays a signal - sound (audio cue) and/or announcement (alert) - on loop while progress is occurring."),properties:{sound:{description:h("accessibility.signals.progress.sound","Plays a sound on loop while progress is occurring."),...ln},announcement:{description:h("accessibility.signals.progress.announcement","Alerts on loop while progress is occurring."),...ai}}},"accessibility.signals.chatResponseReceived":{...Rc,description:h("accessibility.signals.chatResponseReceived","Plays a sound / audio cue when the response has been received."),properties:{sound:{description:h("accessibility.signals.chatResponseReceived.sound","Plays a sound on loop while the response has been received."),...ln}}},"accessibility.signals.voiceRecordingStarted":{...Rc,description:h("accessibility.signals.voiceRecordingStarted","Plays a sound / audio cue when the voice recording has started."),properties:{sound:{description:h("accessibility.signals.voiceRecordingStarted.sound","Plays a sound when the voice recording has started."),...ln}},default:{sound:"on"}},"accessibility.signals.voiceRecordingStopped":{...Rc,description:h("accessibility.signals.voiceRecordingStopped","Plays a sound / audio cue when the voice recording has stopped."),properties:{sound:{description:h("accessibility.signals.voiceRecordingStopped.sound","Plays a sound when the voice recording has stopped."),...ln,default:"off"}}},"accessibility.signals.clear":{...si,description:h("accessibility.signals.clear","Plays a signal - sound (audio cue) and/or announcement (alert) - when a feature is cleared (for example, the terminal, Debug Console, or Output channel)."),properties:{sound:{description:h("accessibility.signals.clear.sound","Plays a sound when a feature is cleared."),...ln},announcement:{description:h("accessibility.signals.clear.announcement","Announces when a feature is cleared."),...ai}}},"accessibility.signals.save":{type:"object",tags:["accessibility"],additionalProperties:!1,markdownDescription:h("accessibility.signals.save","Plays a signal - sound (audio cue) and/or announcement (alert) - when a file is saved."),properties:{sound:{description:h("accessibility.signals.save.sound","Plays a sound when a file is saved."),type:"string",enum:["userGesture","always","never"],default:"never",enumDescriptions:[h("accessibility.signals.save.sound.userGesture","Plays the sound when a user explicitly saves a file."),h("accessibility.signals.save.sound.always","Plays the sound whenever a file is saved, including auto save."),h("accessibility.signals.save.sound.never","Never plays the sound.")]},announcement:{description:h("accessibility.signals.save.announcement","Announces when a file is saved."),type:"string",enum:["userGesture","always","never"],default:"never",enumDescriptions:[h("accessibility.signals.save.announcement.userGesture","Announces when a user explicitly saves a file."),h("accessibility.signals.save.announcement.always","Announces whenever a file is saved, including auto save."),h("accessibility.signals.save.announcement.never","Never plays the announcement.")]}},default:{sound:"never",announcement:"never"}},"accessibility.signals.format":{type:"object",tags:["accessibility"],additionalProperties:!1,markdownDescription:h("accessibility.signals.format","Plays a signal - sound (audio cue) and/or announcement (alert) - when a file or notebook is formatted."),properties:{sound:{description:h("accessibility.signals.format.sound","Plays a sound when a file or notebook is formatted."),type:"string",enum:["userGesture","always","never"],default:"never",enumDescriptions:[h("accessibility.signals.format.userGesture","Plays the sound when a user explicitly formats a file."),h("accessibility.signals.format.always","Plays the sound whenever a file is formatted, including if it is set to format on save, type, or, paste, or run of a cell."),h("accessibility.signals.format.never","Never plays the sound.")]},announcement:{description:h("accessibility.signals.format.announcement","Announces when a file or notebook is formatted."),type:"string",enum:["userGesture","always","never"],default:"never",enumDescriptions:[h("accessibility.signals.format.announcement.userGesture","Announces when a user explicitly formats a file."),h("accessibility.signals.format.announcement.always","Announces whenever a file is formatted, including if it is set to format on save, type, or, paste, or run of a cell."),h("accessibility.signals.format.announcement.never","Never announces.")]}},default:{sound:"never",announcement:"never"}},"accessibility.underlineLinks":{type:"boolean",description:h("accessibility.underlineLinks","Controls whether links should be underlined in the workbench."),default:!1},"accessibility.debugWatchVariableAnnouncements":{type:"boolean",description:h("accessibility.debugWatchVariableAnnouncements","Controls whether variable changes should be announced in the debug watch view."),default:!0}}};var sU=1200,qI=class extends W{constructor(t,n){super();this.speechService=t;this.productService=n;this._register(de.runAndSubscribe(t.onDidChangeHasSpeechProvider,()=>this.updateConfiguration()))}static ID="workbench.contrib.dynamicSpeechAccessibilityConfiguration";updateConfiguration(){if(!this.speechService.hasSpeechProvider)return;let t=this.getLanguages(),n=Object.keys(t).sort((r,s)=>t[r].name.localeCompare(t[s].name));tt.as(Ns.Configuration).registerConfiguration({...VF,properties:{"accessibility.voice.speechTimeout":{markdownDescription:h("voice.speechTimeout","The duration in milliseconds that voice speech recognition remains active after you stop speaking. For example in a chat session, the transcribed text is submitted automatically after the timeout is met. Set to `0` to disable this feature."),type:"number",default:sU,minimum:0,tags:["accessibility"]},"accessibility.voice.speechLanguage":{markdownDescription:h("voice.speechLanguage","The language that text-to-speech and speech-to-text should use. Select `auto` to use the configured display language if possible. Note that not all display languages maybe supported by speech recognition and synthesizers."),type:"string",enum:n,default:"auto",tags:["accessibility"],enumDescriptions:n.map(r=>t[r].name),enumItemLabels:n.map(r=>t[r].name)},"accessibility.voice.autoSynthesize":{type:"string",enum:["on","off","auto"],enumDescriptions:[h("accessibility.voice.autoSynthesize.on","Enable the feature. When a screen reader is enabled, note that this will disable aria updates."),h("accessibility.voice.autoSynthesize.off","Disable the feature."),h("accessibility.voice.autoSynthesize.auto","When a screen reader is detected, disable the feature. Otherwise, enable the feature.")],markdownDescription:h("autoSynthesize","Whether a textual response should automatically be read out aloud when speech was used as input. For example in a chat session, a response is automatically synthesized when voice was used as chat request."),default:this.productService.quality!=="stable"?"auto":"off",tags:["accessibility"]}}})}getLanguages(){return{auto:{name:h("speechLanguage.auto","Auto (Use Display Language)")},...WF}}};qI=K([D(0,BF),D(1,mF)],qI);tt.as(ts.ConfigurationMigration).registerConfigurationMigrations([{key:"audioCues.volume",migrateFn:(o,e)=>[["accessibility.signalOptions.volume",{value:o}],["audioCues.volume",{value:void 0}]]}]);tt.as(ts.ConfigurationMigration).registerConfigurationMigrations([{key:"audioCues.debouncePositionChanges",migrateFn:o=>[["accessibility.signalOptions.debouncePositionChanges",{value:o}],["audioCues.debouncePositionChanges",{value:void 0}]]}]);tt.as(ts.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.signalOptions",migrateFn:(o,e)=>{let t=q1(e,"general"),n=q1(e,"errorAtPosition"),i=q1(e,"warningAtPosition"),r=aU(e),s=lU(e),a=[];return r&&a.push(["accessibility.signalOptions.volume",{value:r}]),t&&a.push(["accessibility.signalOptions.experimental.delays.general",{value:t}]),n&&a.push(["accessibility.signalOptions.experimental.delays.errorAtPosition",{value:n}]),i&&a.push(["accessibility.signalOptions.experimental.delays.warningAtPosition",{value:i}]),s&&a.push(["accessibility.signalOptions.debouncePositionChanges",{value:s}]),a.push(["accessibility.signalOptions",{value:void 0}]),a}}]);tt.as(ts.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.signals.sounds.volume",migrateFn:o=>[["accessibility.signalOptions.volume",{value:o}],["accessibility.signals.sounds.volume",{value:void 0}]]}]);tt.as(ts.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.signals.debouncePositionChanges",migrateFn:o=>[["accessibility.signalOptions.debouncePositionChanges",{value:o}],["accessibility.signals.debouncePositionChanges",{value:void 0}]]}]);function q1(o,e){return o(`accessibility.signalOptions.experimental.delays.${e}`)||o("accessibility.signalOptions")?.["experimental.delays"]?.[`${e}`]||o("accessibility.signalOptions")?.delays?.[`${e}`]}function aU(o){return o("accessibility.signalOptions.volume")||o("accessibility.signalOptions")?.volume||o("accessibility.signals.sounds.volume")||o("audioCues.volume")}function lU(o){return o("accessibility.signalOptions.debouncePositionChanges")||o("accessibility.signalOptions")?.debouncePositionChanges||o("accessibility.signals.debouncePositionChanges")||o("audioCues.debouncePositionChanges")}tt.as(ts.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.voice.autoSynthesize",migrateFn:o=>{let e;if(o===!0)e="on";else if(o===!1)e="off";else return[];return[["accessibility.voice.autoSynthesize",{value:e}]]}}]);tt.as(ts.ConfigurationMigration).registerConfigurationMigrations([{key:"accessibility.signals.chatResponsePending",migrateFn:(o,e)=>[["accessibility.signals.progress",{value:o}],["accessibility.signals.chatResponsePending",{value:void 0}]]}]);tt.as(ts.ConfigurationMigration).registerConfigurationMigrations(tl.allAccessibilitySignals.map(o=>o.legacySoundSettingsKey?{key:o.legacySoundSettingsKey,migrateFn:(e,t)=>{let n=[],i=o.legacyAnnouncementSettingsKey,r;return i&&(r=t(i)??void 0,r!==void 0&&typeof r!="string"&&(r=r?"auto":"off")),n.push([`${o.legacySoundSettingsKey}`,{value:void 0}]),n.push([`${o.settingsKey}`,{value:r!==void 0?{announcement:r,sound:e}:{sound:e}}]),n}}:void 0).filter(Pa));tt.as(ts.ConfigurationMigration).registerConfigurationMigrations(tl.allAccessibilitySignals.filter(o=>!!o.legacyAnnouncementSettingsKey&&!!o.legacySoundSettingsKey).map(o=>({key:o.legacyAnnouncementSettingsKey,migrateFn:(e,t)=>{let n=[],i=t(o.settingsKey)?.sound||t(o.legacySoundSettingsKey);return e!==void 0&&typeof e!="string"&&(e=e?"auto":"off"),n.push([`${o.settingsKey}`,{value:e!==void 0?{announcement:e,sound:i}:{sound:i}}]),n.push([`${o.legacyAnnouncementSettingsKey}`,{value:void 0}]),n.push([`${o.legacySoundSettingsKey}`,{value:void 0}]),n}})));function HF(o,e){let t=o;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}var Yt=window;var df=class o{static INSTANCE=new o;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new L;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,t){if(this.getZoomLevel(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(n,e),this._onDidChangeZoomLevel.fire(n)}mapWindowIdToZoomFactor=new Map;getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}_onDidChangeFullscreen=new L;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(e,t){if(this.isFullscreen(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToFullScreen.set(n,e),this._onDidChangeFullscreen.fire(n)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};function dU(o,e,t){typeof e=="string"&&(e=o.matchMedia(e)),e.addEventListener("change",t)}var UBe=df.INSTANCE.onDidChangeZoomLevel;function UF(o){return df.INSTANCE.getZoomFactor(o)}var zBe=df.INSTANCE.onDidChangeFullscreen,Gp=navigator.userAgent,Dn=Gp.indexOf("Firefox")>=0,ns=Gp.indexOf("AppleWebKit")>=0,ld=Gp.indexOf("Chrome")>=0,ar=!ld&&Gp.indexOf("Safari")>=0,zF=!ld&&!ar&&ns,KBe=Gp.indexOf("Electron/")>=0,J1=Gp.indexOf("Android")>=0,YI=!1;if(typeof Yt.matchMedia=="function"){let o=Yt.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Yt.matchMedia("(display-mode: fullscreen)");YI=o.matches,dU(Yt,o,({matches:t})=>{YI&&e.matches||(YI=t)})}function KF(){return YI}function cU(o){if(o.charCode){let t=String.fromCharCode(o.charCode).toUpperCase();return tf.fromString(t)}let e=o.keyCode;if(e===3)return 7;if(Dn)switch(e){case 59:return 85;case 60:if(Gt)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Be)return 57;break}else if(ns){if(Be&&e===93)return 57;if(!Be&&e===92)return 57}return _1[e]||0}var uU=Be?256:2048,pU=512,hU=1024,mU=Be?2048:256;var pt=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(e){let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=cU(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=uU),this.altKey&&(t|=pU),this.shiftKey&&(t|=hU),this.metaKey&&(t|=mU),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new sd(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}};var GF=new WeakMap;function gU(o){if(!o.parent||o.parent===o)return null;try{let e=o.location,t=o.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return o.parent}var QI=class{static getSameOriginWindowChain(e){let t=GF.get(e);if(!t){t=[],GF.set(e,t);let n=e,i;do i=gU(n),i?t.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):t.push({window:new WeakRef(n),iframeElement:null}),n=i;while(n)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let n=0,i=0,r=this.getSameOriginWindowChain(e);for(let s of r){let a=s.window.deref();if(n+=a?.scrollY??0,i+=a?.scrollX??0,a===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();n+=l.top,i+=l.left}return{top:n,left:i}}};var wi=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=QI.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var lr=class{browserEvent;deltaY;deltaX;target;constructor(e,t=0,n=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=n,this.deltaX=t;let i=!1;if(ld){let r=navigator.userAgent.match(/Chrome\/(\d+)/);i=(r?parseInt(r[1]):123)<=122}if(e){let r=e,s=e,a=e.view?.devicePixelRatio||1;if(typeof r.wheelDeltaY<"u")i?this.deltaY=r.wheelDeltaY/(120*a):this.deltaY=r.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Dn&&!Be?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof r.wheelDeltaX<"u")ar&&dt?this.deltaX=-(r.wheelDeltaX/120):i?this.deltaX=r.wheelDeltaX/(120*a):this.deltaX=r.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Dn&&!Be?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(i?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var ZI={clipboard:{writeText:Ma||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:Ma||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:Ma||KF()?0:navigator.keyboard||ar?1:2,touch:"ontouchstart"in Yt||navigator.maxTouchPoints>0,pointerEvents:Yt.PointerEvent&&("ontouchstart"in Yt||navigator.maxTouchPoints>0)};var{entries:JF,setPrototypeOf:$F,isFrozen:fU,getPrototypeOf:bU,getOwnPropertyDescriptor:vU}=Object,{freeze:fo,seal:os,create:yU}=Object,{apply:r0,construct:s0}=typeof Reflect<"u"&&Reflect;r0||(r0=function(e,t,n){return e.apply(t,n)});fo||(fo=function(e){return e});os||(os=function(e){return e});s0||(s0=function(e,t){return new e(...t)});var IU=Sr(Array.prototype.forEach),jF=Sr(Array.prototype.pop),cf=Sr(Array.prototype.push),eC=Sr(String.prototype.toLowerCase),e0=Sr(String.prototype.toString),CU=Sr(String.prototype.match),is=Sr(String.prototype.replace),SU=Sr(String.prototype.indexOf),xU=Sr(String.prototype.trim),dr=Sr(RegExp.prototype.test),uf=_U(TypeError);function Sr(o){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return r0(o,e,n)}}function _U(o){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s0(o,t)}}function ut(o,e,t){var n;t=(n=t)!==null&&n!==void 0?n:eC,$F&&$F(o,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){let s=t(r);s!==r&&(fU(e)||(e[i]=s),r=s)}o[r]=!0}return o}function $p(o){let e=yU(null);for(let[t,n]of JF(o))e[t]=n;return e}function XI(o,e){for(;o!==null;){let n=vU(o,e);if(n){if(n.get)return Sr(n.get);if(typeof n.value=="function")return Sr(n.value)}o=bU(o)}function t(n){return console.warn("fallback value for",n),null}return t}var qF=fo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),t0=fo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),n0=fo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),wU=fo(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),i0=fo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),EU=fo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),YF=fo(["#text"]),QF=fo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),o0=fo(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ZF=fo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),JI=fo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),TU=os(/\{\{[\w\W]*|[\w\W]*\}\}/gm),LU=os(/<%[\w\W]*|[\w\W]*%>/gm),kU=os(/\${[\w\W]*}/gm),DU=os(/^data-[\-\w.\u00B7-\uFFFF]/),RU=os(/^aria-[\-\w]+$/),e2=os(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),MU=os(/^(?:\w+script|data):/i),PU=os(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),t2=os(/^html$/i),XF=Object.freeze({__proto__:null,MUSTACHE_EXPR:TU,ERB_EXPR:LU,TMPLIT_EXPR:kU,DATA_ATTR:DU,ARIA_ATTR:RU,IS_ALLOWED_URI:e2,IS_SCRIPT_OR_DATA:MU,ATTR_WHITESPACE:PU,DOCTYPE_NAME:t2}),AU=()=>typeof window>"u"?null:window,NU=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));let r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function n2(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:AU(),e=Re=>n2(Re);if(e.version="3.0.5",e.removed=[],!o||!o.document||o.document.nodeType!==9)return e.isSupported=!1,e;let t=o.document,n=t.currentScript,{document:i}=o,{DocumentFragment:r,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:u,DOMParser:p,trustedTypes:m}=o,g=l.prototype,f=XI(g,"cloneNode"),b=XI(g,"nextSibling"),v=XI(g,"childNodes"),I=XI(g,"parentNode");if(typeof s=="function"){let Re=i.createElement("template");Re.content&&Re.content.ownerDocument&&(i=Re.content.ownerDocument)}let C,S="",{implementation:E,createNodeIterator:M,createDocumentFragment:A,getElementsByTagName:F}=i,{importNode:O}=t,H={};e.isSupported=typeof JF=="function"&&typeof I=="function"&&E&&E.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:U,ERB_EXPR:z,TMPLIT_EXPR:re,DATA_ATTR:ve,ARIA_ATTR:ee,IS_SCRIPT_OR_DATA:Q,ATTR_WHITESPACE:ae}=XF,{IS_ALLOWED_URI:ne}=XF,Z=null,Ce=ut({},[...qF,...t0,...n0,...i0,...YF]),xe=null,st=ut({},[...QF,...o0,...ZF,...JI]),Xe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,ti=null,Pn=!0,eo=!0,So=!1,yl=!0,fi=!1,Rr=!1,Md=!1,Il=!1,bi=!1,Cl=!1,Sl=!1,gu=!0,fu=!1,Ae="user-content-",Ca=!0,xl=!1,ys={},hr=null,cm=ut({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Pd=null,um=ut({},["audio","video","img","source","image","track"]),Is=null,pm=ut({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Cs="http://www.w3.org/1998/Math/MathML",Go="http://www.w3.org/2000/svg",xn="http://www.w3.org/1999/xhtml",$o=xn,Sa=!1,Bi=null,_l=ut({},[Cs,Go,xn],e0),Mr,Ss=["application/xhtml+xml","text/html"],he="text/html",se,P=null,J=i.createElement("form"),ue=function(V){return V instanceof RegExp||V instanceof Function},Ye=function(V){if(!(P&&P===V)){if((!V||typeof V!="object")&&(V={}),V=$p(V),Mr=Ss.indexOf(V.PARSER_MEDIA_TYPE)===-1?Mr=he:Mr=V.PARSER_MEDIA_TYPE,se=Mr==="application/xhtml+xml"?e0:eC,Z="ALLOWED_TAGS"in V?ut({},V.ALLOWED_TAGS,se):Ce,xe="ALLOWED_ATTR"in V?ut({},V.ALLOWED_ATTR,se):st,Bi="ALLOWED_NAMESPACES"in V?ut({},V.ALLOWED_NAMESPACES,e0):_l,Is="ADD_URI_SAFE_ATTR"in V?ut($p(pm),V.ADD_URI_SAFE_ATTR,se):pm,Pd="ADD_DATA_URI_TAGS"in V?ut($p(um),V.ADD_DATA_URI_TAGS,se):um,hr="FORBID_CONTENTS"in V?ut({},V.FORBID_CONTENTS,se):cm,ke="FORBID_TAGS"in V?ut({},V.FORBID_TAGS,se):{},ti="FORBID_ATTR"in V?ut({},V.FORBID_ATTR,se):{},ys="USE_PROFILES"in V?V.USE_PROFILES:!1,Pn=V.ALLOW_ARIA_ATTR!==!1,eo=V.ALLOW_DATA_ATTR!==!1,So=V.ALLOW_UNKNOWN_PROTOCOLS||!1,yl=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,fi=V.SAFE_FOR_TEMPLATES||!1,Rr=V.WHOLE_DOCUMENT||!1,bi=V.RETURN_DOM||!1,Cl=V.RETURN_DOM_FRAGMENT||!1,Sl=V.RETURN_TRUSTED_TYPE||!1,Il=V.FORCE_BODY||!1,gu=V.SANITIZE_DOM!==!1,fu=V.SANITIZE_NAMED_PROPS||!1,Ca=V.KEEP_CONTENT!==!1,xl=V.IN_PLACE||!1,ne=V.ALLOWED_URI_REGEXP||e2,$o=V.NAMESPACE||xn,Xe=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&ue(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Xe.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&ue(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Xe.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Xe.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),fi&&(eo=!1),Cl&&(bi=!0),ys&&(Z=ut({},[...YF]),xe=[],ys.html===!0&&(ut(Z,qF),ut(xe,QF)),ys.svg===!0&&(ut(Z,t0),ut(xe,o0),ut(xe,JI)),ys.svgFilters===!0&&(ut(Z,n0),ut(xe,o0),ut(xe,JI)),ys.mathMl===!0&&(ut(Z,i0),ut(xe,ZF),ut(xe,JI))),V.ADD_TAGS&&(Z===Ce&&(Z=$p(Z)),ut(Z,V.ADD_TAGS,se)),V.ADD_ATTR&&(xe===st&&(xe=$p(xe)),ut(xe,V.ADD_ATTR,se)),V.ADD_URI_SAFE_ATTR&&ut(Is,V.ADD_URI_SAFE_ATTR,se),V.FORBID_CONTENTS&&(hr===cm&&(hr=$p(hr)),ut(hr,V.FORBID_CONTENTS,se)),Ca&&(Z["#text"]=!0),Rr&&ut(Z,["html","head","body"]),Z.table&&(ut(Z,["tbody"]),delete ke.tbody),V.TRUSTED_TYPES_POLICY){if(typeof V.TRUSTED_TYPES_POLICY.createHTML!="function")throw uf('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof V.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw uf('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=V.TRUSTED_TYPES_POLICY,S=C.createHTML("")}else C===void 0&&(C=NU(m,n)),C!==null&&typeof S=="string"&&(S=C.createHTML(""));fo&&fo(V),P=V}},yt=ut({},["mi","mo","mn","ms","mtext"]),Kn=ut({},["foreignobject","desc","title","annotation-xml"]),vi=ut({},["title","style","font","a","script"]),Fe=ut({},t0);ut(Fe,n0),ut(Fe,wU);let _=ut({},i0);ut(_,EU);let T=function(V){let me=I(V);(!me||!me.tagName)&&(me={namespaceURI:$o,tagName:"template"});let Le=eC(V.tagName),Nt=eC(me.tagName);return Bi[V.namespaceURI]?V.namespaceURI===Go?me.namespaceURI===xn?Le==="svg":me.namespaceURI===Cs?Le==="svg"&&(Nt==="annotation-xml"||yt[Nt]):!!Fe[Le]:V.namespaceURI===Cs?me.namespaceURI===xn?Le==="math":me.namespaceURI===Go?Le==="math"&&Kn[Nt]:!!_[Le]:V.namespaceURI===xn?me.namespaceURI===Go&&!Kn[Nt]||me.namespaceURI===Cs&&!yt[Nt]?!1:!_[Le]&&(vi[Le]||!Fe[Le]):!!(Mr==="application/xhtml+xml"&&Bi[V.namespaceURI]):!1},k=function(V){cf(e.removed,{element:V});try{V.parentNode.removeChild(V)}catch{V.remove()}},N=function(V,me){try{cf(e.removed,{attribute:me.getAttributeNode(V),from:me})}catch{cf(e.removed,{attribute:null,from:me})}if(me.removeAttribute(V),V==="is"&&!xe[V])if(bi||Cl)try{k(me)}catch{}else try{me.setAttribute(V,"")}catch{}},B=function(V){let me,Le;if(Il)V="<remove></remove>"+V;else{let Wi=CU(V,/^[\r\n\t ]+/);Le=Wi&&Wi[0]}Mr==="application/xhtml+xml"&&$o===xn&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");let Nt=C?C.createHTML(V):V;if($o===xn)try{me=new p().parseFromString(Nt,Mr)}catch{}if(!me||!me.documentElement){me=E.createDocument($o,"template",null);try{me.documentElement.innerHTML=Sa?S:Nt}catch{}}let An=me.body||me.documentElement;return V&&Le&&An.insertBefore(i.createTextNode(Le),An.childNodes[0]||null),$o===xn?F.call(me,Rr?"html":"body")[0]:Rr?me.documentElement:An},j=function(V){return M.call(V.ownerDocument||V,V,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},X=function(V){return V instanceof u&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof c)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},Ie=function(V){return typeof a=="object"?V instanceof a:V&&typeof V=="object"&&typeof V.nodeType=="number"&&typeof V.nodeName=="string"},Te=function(V,me,Le){H[V]&&IU(H[V],Nt=>{Nt.call(e,me,Le,P)})},Ze=function(V){let me;if(Te("beforeSanitizeElements",V,null),X(V))return k(V),!0;let Le=se(V.nodeName);if(Te("uponSanitizeElement",V,{tagName:Le,allowedTags:Z}),V.hasChildNodes()&&!Ie(V.firstElementChild)&&(!Ie(V.content)||!Ie(V.content.firstElementChild))&&dr(/<[/\w]/g,V.innerHTML)&&dr(/<[/\w]/g,V.textContent))return k(V),!0;if(!Z[Le]||ke[Le]){if(!ke[Le]&&Vt(Le)&&(Xe.tagNameCheck instanceof RegExp&&dr(Xe.tagNameCheck,Le)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck(Le)))return!1;if(Ca&&!hr[Le]){let Nt=I(V)||V.parentNode,An=v(V)||V.childNodes;if(An&&Nt){let Wi=An.length;for(let vn=Wi-1;vn>=0;--vn)Nt.insertBefore(f(An[vn],!0),b(V))}}return k(V),!0}return V instanceof l&&!T(V)||(Le==="noscript"||Le==="noembed"||Le==="noframes")&&dr(/<\/no(script|embed|frames)/i,V.innerHTML)?(k(V),!0):(fi&&V.nodeType===3&&(me=V.textContent,me=is(me,U," "),me=is(me,z," "),me=is(me,re," "),V.textContent!==me&&(cf(e.removed,{element:V.cloneNode()}),V.textContent=me)),Te("afterSanitizeElements",V,null),!1)},mt=function(V,me,Le){if(gu&&(me==="id"||me==="name")&&(Le in i||Le in J))return!1;if(!(eo&&!ti[me]&&dr(ve,me))){if(!(Pn&&dr(ee,me))){if(!xe[me]||ti[me]){if(!(Vt(V)&&(Xe.tagNameCheck instanceof RegExp&&dr(Xe.tagNameCheck,V)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck(V))&&(Xe.attributeNameCheck instanceof RegExp&&dr(Xe.attributeNameCheck,me)||Xe.attributeNameCheck instanceof Function&&Xe.attributeNameCheck(me))||me==="is"&&Xe.allowCustomizedBuiltInElements&&(Xe.tagNameCheck instanceof RegExp&&dr(Xe.tagNameCheck,Le)||Xe.tagNameCheck instanceof Function&&Xe.tagNameCheck(Le))))return!1}else if(!Is[me]){if(!dr(ne,is(Le,ae,""))){if(!((me==="src"||me==="xlink:href"||me==="href")&&V!=="script"&&SU(Le,"data:")===0&&Pd[V])){if(!(So&&!dr(Q,is(Le,ae,"")))){if(Le)return!1}}}}}}return!0},Vt=function(V){return V.indexOf("-")>0},_n=function(V){let me,Le,Nt,An;Te("beforeSanitizeAttributes",V,null);let{attributes:Wi}=V;if(!Wi)return;let vn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(An=Wi.length;An--;){me=Wi[An];let{name:xs,namespaceURI:iw}=me;if(Le=xs==="value"?me.value:xU(me.value),Nt=se(xs),vn.attrName=Nt,vn.attrValue=Le,vn.keepAttr=!0,vn.forceKeepAttr=void 0,Te("uponSanitizeAttribute",V,vn),Le=vn.attrValue,vn.forceKeepAttr||(N(xs,V),!vn.keepAttr))continue;if(!yl&&dr(/\/>/i,Le)){N(xs,V);continue}fi&&(Le=is(Le,U," "),Le=is(Le,z," "),Le=is(Le,re," "));let kR=se(V.nodeName);if(mt(kR,Nt,Le)){if(fu&&(Nt==="id"||Nt==="name")&&(N(xs,V),Le=Ae+Le),C&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!iw)switch(m.getAttributeType(kR,Nt)){case"TrustedHTML":{Le=C.createHTML(Le);break}case"TrustedScriptURL":{Le=C.createScriptURL(Le);break}}try{iw?V.setAttributeNS(iw,xs,Le):V.setAttribute(xs,Le),jF(e.removed)}catch{}}}Te("afterSanitizeAttributes",V,null)},Xt=function Re(V){let me,Le=j(V);for(Te("beforeSanitizeShadowDOM",V,null);me=Le.nextNode();)Te("uponSanitizeShadowNode",me,null),!Ze(me)&&(me.content instanceof r&&Re(me.content),_n(me));Te("afterSanitizeShadowDOM",V,null)};return e.sanitize=function(Re){let V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},me,Le,Nt,An;if(Sa=!Re,Sa&&(Re="<!-->"),typeof Re!="string"&&!Ie(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw uf("dirty is not a string, aborting")}else throw uf("toString is not a function");if(!e.isSupported)return Re;if(Md||Ye(V),e.removed=[],typeof Re=="string"&&(xl=!1),xl){if(Re.nodeName){let xs=se(Re.nodeName);if(!Z[xs]||ke[xs])throw uf("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof a)me=B("<!---->"),Le=me.ownerDocument.importNode(Re,!0),Le.nodeType===1&&Le.nodeName==="BODY"||Le.nodeName==="HTML"?me=Le:me.appendChild(Le);else{if(!bi&&!fi&&!Rr&&Re.indexOf("<")===-1)return C&&Sl?C.createHTML(Re):Re;if(me=B(Re),!me)return bi?null:Sl?S:""}me&&Il&&k(me.firstChild);let Wi=j(xl?Re:me);for(;Nt=Wi.nextNode();)Ze(Nt)||(Nt.content instanceof r&&Xt(Nt.content),_n(Nt));if(xl)return Re;if(bi){if(Cl)for(An=A.call(me.ownerDocument);me.firstChild;)An.appendChild(me.firstChild);else An=me;return(xe.shadowroot||xe.shadowrootmode)&&(An=O.call(t,An,!0)),An}let vn=Rr?me.outerHTML:me.innerHTML;return Rr&&Z["!doctype"]&&me.ownerDocument&&me.ownerDocument.doctype&&me.ownerDocument.doctype.name&&dr(t2,me.ownerDocument.doctype.name)&&(vn="<!DOCTYPE "+me.ownerDocument.doctype.name+`>
`+vn),fi&&(vn=is(vn,U," "),vn=is(vn,z," "),vn=is(vn,re," ")),C&&Sl?C.createHTML(vn):vn},e.setConfig=function(Re){Ye(Re),Md=!0},e.clearConfig=function(){P=null,Md=!1},e.isValidAttribute=function(Re,V,me){P||Ye({});let Le=se(Re),Nt=se(V);return mt(Le,Nt,me)},e.addHook=function(Re,V){typeof V=="function"&&(H[Re]=H[Re]||[],cf(H[Re],V))},e.removeHook=function(Re){if(H[Re])return jF(H[Re])},e.removeHooks=function(Re){H[Re]&&(H[Re]=[])},e.removeAllHooks=function(){H={}},e}var aa=n2();var JBe=aa.version,eWe=aa.isSupported,tC=aa.sanitize,tWe=aa.setConfig,nWe=aa.clearConfig,iWe=aa.isValidAttribute,nC=aa.addHook,iC=aa.removeHook,oWe=aa.removeHooks,rWe=aa.removeAllHooks;function rs(o,e,t){return Math.min(Math.max(o,e),t)}var pf=class{_n=1;_val=0;update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}},oC=class{_n=0;_val=0;_values=[];_index=0;_sum=0;constructor(e){this._values=new Array(e),this._values.fill(0,0,e)}update(e){let t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}};var{registerWindow:wWe,getWindow:fe,getDocument:EWe,getWindows:r2,getWindowsCount:OU,getWindowId:jp,getWindowById:c0,hasWindow:TWe,onDidRegisterWindow:u0,onWillUnregisterWindow:LWe,onDidUnregisterWindow:s2}=function(){let o=new Map;HF(Yt,1);let e={window:Yt,disposables:new te};o.set(Yt.vscodeWindowId,e);let t=new L,n=new L,i=new L;function r(s,a){return(typeof s=="number"?o.get(s):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:i.event,onDidUnregisterWindow:n.event,registerWindow(s){if(o.has(s.vscodeWindowId))return W.None;let a=new te,l={window:s,disposables:a.add(new te)};return o.set(s.vscodeWindowId,l),a.add(ge(()=>{o.delete(s.vscodeWindowId),n.fire(s)})),a.add(q(s,we.BEFORE_UNLOAD,()=>{i.fire(s)})),t.fire(l),a},getWindows(){return o.values()},getWindowsCount(){return o.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return o.has(s)},getWindowById:r,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:Yt},getDocument(s){return fe(s).document}}}();function di(o){for(;o.firstChild;)o.firstChild.remove()}var a0=class{_handler;_node;_type;_options;constructor(e,t,n,i){this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function q(o,e,t,n){return new a0(o,e,t,n)}function FU(o,e){return function(t){return e(new wi(o,t))}}function BU(o){return function(e){return o(new pt(e))}}var Wn=function(e,t,n,i){let r=n;return t==="click"||t==="mousedown"||t==="contextmenu"?r=FU(fe(e),n):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=BU(n)),q(e,t,r,i)};function mf(o,e,t){return Vu(o,e,t)}var qp=class extends Xm{constructor(e,t){super(e,t)}},Qp,li;var Yp=class extends Pv{defaultTarget;constructor(e){super(),this.defaultTarget=e&&fe(e)}cancelAndSet(e,t,n){return super.cancelAndSet(e,t,n??this.defaultTarget)}},hf=class{_runner;priority;_canceled;constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Ue(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let o=new Map,e=new Map,t=new Map,n=new Map,i=r=>{t.set(r,!1);let s=o.get(r)??[];for(e.set(r,s),o.set(r,[]),n.set(r,!0);s.length>0;)s.sort(hf.sort),s.shift().execute();n.set(r,!1)};li=(r,s,a=0)=>{let l=jp(r),d=new hf(s,a),c=o.get(l);return c||(c=[],o.set(l,c)),c.push(d),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>i(l))),d},Qp=(r,s,a)=>{let l=jp(r);if(n.get(l)){let d=new hf(s,a),c=e.get(l);return c||(c=[],e.set(l,c)),c.push(d),d}else return li(r,s,a)}})();function a2(o){return fe(o).getComputedStyle(o,null)}function Mc(o,e){let t=fe(o),n=t.document;if(o!==n.body)return new Dt(o.clientWidth,o.clientHeight);if(wm&&t?.visualViewport)return new Dt(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new Dt(t.innerWidth,t.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new Dt(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new Dt(n.documentElement.clientWidth,n.documentElement.clientHeight);if(e)return Mc(e);throw new Error("Unable to figure out browser width and height")}var Qi=class o{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,n){let i=a2(e),r=i?i.getPropertyValue(t):"0";return o.convertToPixels(e,r)}static getBorderLeftWidth(e){return o.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return o.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return o.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return o.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return o.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return o.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return o.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return o.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return o.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return o.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return o.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return o.getDimension(e,"margin-bottom","marginBottom")}},Dt=class o{constructor(e,t){this.width=e;this.height=t}static None=new o(0,0);with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new o(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof o?e:new o(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};function l2(o){let e=o.offsetParent,t=o.offsetTop,n=o.offsetLeft;for(;(o=o.parentNode)!==null&&o!==o.ownerDocument.body&&o!==o.ownerDocument.documentElement;){t-=o.scrollTop;let i=u2(o)?null:a2(o);i&&(n-=i.direction!=="rtl"?o.scrollLeft:-o.scrollLeft),o===e&&(n+=Qi.getBorderLeftWidth(o),t+=Qi.getBorderTopWidth(o),t+=o.offsetTop,n+=o.offsetLeft,e=o.offsetParent)}return{left:n,top:t}}function d2(o,e,t){typeof e=="number"&&(o.style.width=`${e}px`),typeof t=="number"&&(o.style.height=`${t}px`)}function Zi(o){let e=o.getBoundingClientRect(),t=fe(o);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function Zp(o){let e=Qi.getMarginLeft(o)+Qi.getMarginRight(o);return o.offsetWidth+e}function aC(o){let e=Qi.getBorderLeftWidth(o)+Qi.getBorderRightWidth(o),t=Qi.getPaddingLeft(o)+Qi.getPaddingRight(o);return o.offsetWidth-e-t}function c2(o){let e=Qi.getBorderTopWidth(o)+Qi.getBorderBottomWidth(o),t=Qi.getPaddingTop(o)+Qi.getPaddingBottom(o);return o.offsetHeight-e-t}function lC(o){let e=Qi.getMarginTop(o)+Qi.getMarginBottom(o);return o.offsetHeight+e}function xr(o,e){return!!e?.contains(o)}function u2(o){return o&&!!o.host&&!!o.mode}function ud(o){for(;o.parentNode;){if(o===o.ownerDocument?.body)return null;o=o.parentNode}return u2(o)?o:null}function bo(){let o=p2().activeElement;for(;o?.shadowRoot;)o=o.shadowRoot.activeElement;return o}function ss(o){return bo()===o}function p2(){return OU()<=1?Yt.document:Array.from(r2()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Yt.document}function dC(){return p2().defaultView?.window??Yt}var WU=new Map;function h2(){return new l0}var l0=class{_currentCssStyle="";_styleSheet=void 0;setStyle(e){e!==this._currentCssStyle&&(this._currentCssStyle=e,this._styleSheet?this._styleSheet.innerText=e:this._styleSheet=as(Yt.document.head,t=>t.innerText=e))}dispose(){this._styleSheet&&(this._styleSheet.remove(),this._styleSheet=void 0)}};function as(o=Yt.document.head,e,t){let n=document.createElement("style");if(n.type="text/css",n.media="screen",e?.(n),o.appendChild(n),t&&t.add(ge(()=>n.remove())),o===Yt.document.head){let i=new Set;WU.set(n,i);for(let{window:r,disposables:s}of r2()){if(r===Yt)continue;let a=s.add(VU(n,i,r));t?.add(a)}}return n}function VU(o,e,t){let n=new te,i=o.cloneNode(!0);t.document.head.appendChild(i),n.add(ge(()=>i.remove()));for(let r of UU(o))i.sheet?.insertRule(r.cssText,i.sheet?.cssRules.length);return n.add(HU.observe(o,n,{childList:!0})(()=>{i.textContent=o.textContent})),e.add(i),n.add(ge(()=>e.delete(i))),n}var HU=new class{mutationObservers=new Map;observe(o,e,t){let n=this.mutationObservers.get(o);n||(n=new Map,this.mutationObservers.set(o,n));let i=tr(t),r=n.get(i);if(r)r.users+=1;else{let s=new L,a=new MutationObserver(d=>s.fire(d));a.observe(o,t);let l=r={users:1,observer:a,onDidMutate:s.event};e.add(ge(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),n?.delete(i),n?.size===0&&this.mutationObservers.delete(o))})),n.set(i,r)}return r.onDidMutate}};function UU(o){return o?.sheet?.rules?o.sheet.rules:o?.sheet?.cssRules?o.sheet.cssRules:[]}function Zn(o){return o instanceof HTMLElement||o instanceof fe(o).HTMLElement}function m2(o){return o instanceof SVGElement||o instanceof fe(o).SVGElement}function cC(o){return o instanceof MouseEvent||o instanceof fe(o).MouseEvent}function p0(o){return o instanceof KeyboardEvent||o instanceof fe(o).KeyboardEvent}var we={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:ns?"webkitAnimationStart":"animationstart",ANIMATION_END:ns?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:ns?"webkitAnimationIteration":"animationiteration"};var it={stop:(o,e)=>(o.preventDefault(),e&&o.stopPropagation(),o)};function g2(o){let e=[];for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)e[t]=o.scrollTop,o=o.parentNode;return e}function f2(o,e){for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)o.scrollTop!==e[t]&&(o.scrollTop=e[t]),o=o.parentNode}var d0=class o extends W{_onDidFocus=this._register(new L);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new L);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(e){if(Zn(e)){let t=ud(e),n=t?t.activeElement:e.ownerDocument.activeElement;return xr(n,e)}else{let t=e;return xr(t.document.activeElement,t.document)}}constructor(e){super();let t=o.hasFocusWithin(e),n=!1,i=()=>{n=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(n=!0,(Zn(e)?fe(e):e).setTimeout(()=>{n&&(n=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{o.hasFocusWithin(e)!==t&&(t?r():i())},this._register(q(e,we.FOCUS,i,!0)),this._register(q(e,we.BLUR,r,!0)),Zn(e)&&(this._register(q(e,we.FOCUS_IN,()=>this._refreshStateHandler())),this._register(q(e,we.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function Pc(o){return new d0(o)}function b2(o,e){return o.after(e),e}function Ee(o,...e){if(o.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function v2(o,e){return o.insertBefore(e,o.firstChild),e}function Xp(o,...e){o.innerText="",Ee(o,...e)}var zU=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function y2(o,e,t,...n){let i=zU.exec(e);if(!i)throw new Error("Bad use of emmet");let r=i[1]||"div",s;return o!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(o,r):s=document.createElement(r),i[3]&&(s.id=i[3]),i[4]&&(s.className=i[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...n),s}function Se(o,e,...t){return y2("http://www.w3.org/1999/xhtml",o,e,...t)}Se.SVG=function(o,e,...t){return y2("http://www.w3.org/2000/svg",o,e,...t)};function Bo(...o){for(let e of o)e.style.display="",e.removeAttribute("aria-hidden")}function vo(...o){for(let e of o)e.style.display="none",e.setAttribute("aria-hidden","true")}function h0(o,e){let t=o.devicePixelRatio*e;return Math.max(1,Math.floor(t))/o.devicePixelRatio}function I2(o,e){let t=()=>{e(),n=li(o,t)},n=li(o,t);return ge(()=>n.dispose())}yv.setPreferredWebSchema(/^https:/.test(Yt.location.href)?"https":"http");function Ac(o){return o?`url('${Zd.uriToBrowserUri(o).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function ls(o,e){if(o!==void 0){let t=o.match(/^\s*var\((.+)\)$/);if(t){let n=t[1].split(",",2);return n.length===2&&(e=ls(n[1].trim(),e)),`var(${n[0]}, ${e})`}return o}return e}function C2(o,e=!1){let t=document.createElement("a");return nC("afterSanitizeAttributes",n=>{for(let i of["href","src"])if(n.hasAttribute(i)){let r=n.getAttribute(i);if(i==="href"&&r.startsWith("#"))continue;if(t.href=r,!o.includes(t.protocol.replace(/:$/,""))){if(e&&i==="src"&&t.href.startsWith("data:"))continue;n.removeAttribute(i)}}}),ge(()=>{iC("afterSanitizeAttributes")})}var kWe=[$e.http,$e.https,$e.command],S2=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),DWe=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});var rC=class o extends L{_subscriptions=new te;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(de.runAndSubscribe(u0,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Yt,disposables:this._subscriptions}))}registerListeners(e,t){t.add(q(e,"keydown",n=>{if(n.defaultPrevented)return;let i=new pt(n);if(!(i.keyCode===6&&n.repeat)){if(n.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(n.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(n.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(n.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(i.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=n,this.fire(this._keyStatus))}},!0)),t.add(q(e,"keyup",n=>{n.defaultPrevented||(!n.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!n.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!n.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!n.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=n,this.fire(this._keyStatus)))},!0)),t.add(q(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(q(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(q(e.document.body,"mousemove",n=>{n.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(q(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return o.instance||(o.instance=new o),o.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var sC=class extends W{constructor(t,n){super();this.element=t;this.callbacks=n;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(q(this.element,we.DRAG_START,t=>{this.callbacks.onDragStart?.(t)})),this.callbacks.onDrag&&this._register(q(this.element,we.DRAG,t=>{this.callbacks.onDrag?.(t)})),this._register(q(this.element,we.DRAG_ENTER,t=>{this.counter++,this.dragStartTime=t.timeStamp,this.callbacks.onDragEnter?.(t)})),this._register(q(this.element,we.DRAG_OVER,t=>{t.preventDefault(),this.callbacks.onDragOver?.(t,t.timeStamp-this.dragStartTime)})),this._register(q(this.element,we.DRAG_LEAVE,t=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(t))})),this._register(q(this.element,we.DRAG_END,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(t)})),this._register(q(this.element,we.DROP,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(t)}))}},KU=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function Jp(o,...e){let t,n;Array.isArray(e[0])?(t={},n=e[0]):(t=e[0]||{},n=e[1]);let i=KU.exec(o);if(!i||!i.groups)throw new Error("Bad use of h");let r=i.groups.tag||"div",s=document.createElement(r);i.groups.id&&(s.id=i.groups.id);let a=[];if(i.groups.class)for(let d of i.groups.class.split("."))d!==""&&a.push(d);if(t.className!==void 0)for(let d of t.className.split("."))d!==""&&a.push(d);a.length>0&&(s.className=a.join(" "));let l={};if(i.groups.name&&(l[i.groups.name]=s),n)for(let d of n)Zn(d)?s.appendChild(d):typeof d=="string"?s.append(d):"root"in d&&(Object.assign(l,d),s.appendChild(d.root));for(let[d,c]of Object.entries(t))if(d!=="className")if(d==="style")for(let[u,p]of Object.entries(c))s.style.setProperty(o2(u),typeof p=="number"?p+"px":""+p);else d==="tabIndex"?s.tabIndex=c:s.setAttribute(o2(d),c.toString());return l.root=s,l}function o2(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function la(o){return o.tagName.toLowerCase()==="input"||o.tagName.toLowerCase()==="textarea"||Zn(o)&&!!o.editContext}var ht;(r=>(r.Tap="-monaco-gesturetap",r.Change="-monaco-gesturechange",r.Start="-monaco-gesturestart",r.End="-monaco-gesturesend",r.Contextmenu="-monaco-gesturecontextmenu"))(ht||={});var Ei=class Ei extends W{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new Gn;ignoreTargets=new Gn;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(de.runAndSubscribe(u0,({window:e,disposables:t})=>{t.add(q(e.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),t.add(q(e.document,"touchend",n=>this.onTouchEnd(e,n))),t.add(q(e.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:Yt,disposables:this._store}))}static addTarget(e){if(!Ei.isTouchDevice())return W.None;Ei.INSTANCE||(Ei.INSTANCE=Dl(new Ei));let t=Ei.INSTANCE.targets.push(e);return ge(t)}static ignoreTarget(e){if(!Ei.isTouchDevice())return W.None;Ei.INSTANCE||(Ei.INSTANCE=Dl(new Ei));let t=Ei.INSTANCE.ignoreTargets.push(e);return ge(t)}static isTouchDevice(){return"ontouchstart"in Yt||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,i=e.targetTouches.length;n<i;n++){let r=e.targetTouches.item(n);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};let s=this.newGestureEvent(ht.Start,r.target);s.pageX=r.pageX,s.pageY=r.pageY,this.dispatchEvent(s)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){let n=Date.now(),i=Object.keys(this.activeTouches).length;for(let r=0,s=t.changedTouches.length;r<s;r++){let a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<Ei.HOLD_DELAY&&Math.abs(l.initialPageX-io(l.rollingPageX))<30&&Math.abs(l.initialPageY-io(l.rollingPageY))<30){let c=this.newGestureEvent(ht.Tap,l.initialTarget);c.pageX=io(l.rollingPageX),c.pageY=io(l.rollingPageY),this.dispatchEvent(c)}else if(d>=Ei.HOLD_DELAY&&Math.abs(l.initialPageX-io(l.rollingPageX))<30&&Math.abs(l.initialPageY-io(l.rollingPageY))<30){let c=this.newGestureEvent(ht.Contextmenu,l.initialTarget);c.pageX=io(l.rollingPageX),c.pageY=io(l.rollingPageY),this.dispatchEvent(c)}else if(i===1){let c=io(l.rollingPageX),u=io(l.rollingPageY),p=io(l.rollingTimestamps)-l.rollingTimestamps[0],m=c-l.rollingPageX[0],g=u-l.rollingPageY[0],f=[...this.targets].filter(b=>l.initialTarget instanceof Node&&b.contains(l.initialTarget));this.inertia(e,f,n,Math.abs(m)/p,m>0?1:-1,c,Math.abs(g)/p,g>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(ht.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let n=document.createEvent("CustomEvent");return n.initEvent(e,!1,!0),n.initialTarget=t,n.tapCount=0,n}dispatchEvent(e){if(e.type===ht.Tap){let t=new Date().getTime(),n=0;t-this._lastSetTapCountTime>Ei.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=t,e.tapCount=n}else(e.type===ht.Change||e.type===ht.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(e.initialTarget))return;let t=[];for(let n of this.targets)if(n.contains(e.initialTarget)){let i=0,r=e.initialTarget;for(;r&&r!==n;)i++,r=r.parentElement;t.push([i,n])}t.sort((n,i)=>n[0]-i[0]);for(let[n,i]of t)i.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,n,i,r,s,a,l,d){this.handle=li(e,()=>{let c=Date.now(),u=c-n,p=0,m=0,g=!0;i+=Ei.SCROLL_FRICTION*u,a+=Ei.SCROLL_FRICTION*u,i>0&&(g=!1,p=r*i*u),a>0&&(g=!1,m=l*a*u);let f=this.newGestureEvent(ht.Change);f.translationX=p,f.translationY=m,t.forEach(b=>b.dispatchEvent(f)),g||this.inertia(e,t,c,i,r,s+p,a,l,d+m)})}onTouchMove(e){let t=Date.now();for(let n=0,i=e.changedTouches.length;n<i;n++){let r=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}let s=this.activeTouches[r.identifier],a=this.newGestureEvent(ht.Change,s.initialTarget);a.translationX=r.pageX-io(s.rollingPageX),a.translationY=r.pageY-io(s.rollingPageY),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(r.pageX),s.rollingPageY.push(r.pageY),s.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};K([Lt],Ei,"isTouchDevice",1);var Sn=Ei;var We=class{emitter;get event(){return this.emitter.event}constructor(e,t,n){let i=r=>this.emitter.fire(r);this.emitter=new L({onWillAddFirstListener:()=>e.addEventListener(t,i,n),onDidRemoveLastListener:()=>e.removeEventListener(t,i,n)})}dispose(){this.emitter.dispose()}};var GU=!1;var $U=4,jU=new L;var qU=300,YU=new L;var gf=class{constructor(e){this.el=e}disposables=new te;get onPointerMove(){return this.disposables.add(new We(fe(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new We(fe(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};K([Lt],gf.prototype,"onPointerMove",1),K([Lt],gf.prototype,"onPointerUp",1);var ff=class{constructor(e){this.el=e}disposables=new te;get onPointerMove(){return this.disposables.add(new We(this.el,ht.Change)).event}get onPointerUp(){return this.disposables.add(new We(this.el,ht.End)).event}dispose(){this.disposables.dispose()}};K([Lt],ff.prototype,"onPointerMove",1),K([Lt],ff.prototype,"onPointerUp",1);var eh=class{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};K([Lt],eh.prototype,"onPointerMove",1),K([Lt],eh.prototype,"onPointerUp",1);var x2="pointer-events-disabled",Nc=class o extends W{el;layoutProvider;orientation;size;hoverDelay=qU;hoverDelayer=this._register(new Oa(this.hoverDelay));_state=3;onDidEnablementChange=this._register(new L);_onDidStart=this._register(new L);_onDidChange=this._register(new L);_onDidReset=this._register(new L);_onDidEnd=this._register(new L);orthogonalStartSashDisposables=this._register(new te);_orthogonalStartSash;orthogonalStartDragHandleDisposables=this._register(new te);_orthogonalStartDragHandle;orthogonalEndSashDisposables=this._register(new te);_orthogonalEndSash;orthogonalEndDragHandleDisposables=this._register(new te);_orthogonalEndDragHandle;get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}onDidStart=this._onDidStart.event;onDidChange=this._onDidChange.event;onDidReset=this._onDidReset.event;onDidEnd=this._onDidEnd.event;linkedSash=void 0;set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){let t=n=>{this.orthogonalStartDragHandleDisposables.clear(),n!==0&&(this._orthogonalStartDragHandle=Ee(this.el,Se(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(ge(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new We(this._orthogonalStartDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new We(this._orthogonalStartDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){let t=n=>{this.orthogonalEndDragHandleDisposables.clear(),n!==0&&(this._orthogonalEndDragHandle=Ee(this.el,Se(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(ge(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new We(this._orthogonalEndDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new We(this._orthogonalEndDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,n){super(),this.el=Ee(e,Se(".monaco-sash")),n.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${n.orthogonalEdge}`),Be&&this.el.classList.add("mac");let i=this._register(new We(this.el,"mousedown")).event;this._register(i(u=>this.onPointerStart(u,new gf(e)),this));let r=this._register(new We(this.el,"dblclick")).event;this._register(r(this.onPointerDoublePress,this));let s=this._register(new We(this.el,"mouseenter")).event;this._register(s(()=>o.onMouseEnter(this)));let a=this._register(new We(this.el,"mouseleave")).event;this._register(a(()=>o.onMouseLeave(this))),this._register(Sn.addTarget(this.el));let l=this._register(new We(this.el,ht.Start)).event;this._register(l(u=>this.onPointerStart(u,new ff(this.el)),this));let d=this._register(new We(this.el,ht.Tap)).event,c;this._register(d(u=>{if(c){clearTimeout(c),c=void 0,this.onPointerDoublePress(u);return}clearTimeout(c),c=setTimeout(()=>c=void 0,250)},this)),typeof n.size=="number"?(this.size=n.size,n.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=$U,this._register(jU.event(u=>{this.size=u,this.layout()}))),this._register(YU.event(u=>this.hoverDelay=u)),this.layoutProvider=t,this.orthogonalStartSash=n.orthogonalStartSash,this.orthogonalEndSash=n.orthogonalEndSash,this.orientation=n.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",GU),this.layout()}onPointerStart(e,t){it.stop(e);let n=!1;if(!e.__orthogonalSashEvent){let g=this.getOrthogonalSash(e);g&&(n=!0,e.__orthogonalSashEvent=!0,g.onPointerStart(e,new eh(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new eh(t))),!this.state)return;let i=this.el.ownerDocument.getElementsByTagName("iframe");for(let g of i)g.classList.add(x2);let r=e.pageX,s=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:s,currentY:s,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);let d=as(this.el),c=()=>{let g="";n?g="all-scroll":this.orientation===1?this.state===1?g="s-resize":this.state===2?g="n-resize":g=Be?"row-resize":"ns-resize":this.state===1?g="e-resize":this.state===2?g="w-resize":g=Be?"col-resize":"ew-resize",d.textContent=`* { cursor: ${g} !important; }`},u=new te;c(),n||this.onDidEnablementChange.event(c,null,u);let p=g=>{it.stop(g,!1);let f={startX:r,currentX:g.pageX,startY:s,currentY:g.pageY,altKey:a};this._onDidChange.fire(f)},m=g=>{it.stop(g,!1),d.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(let f of i)f.classList.remove(x2)};t.onPointerMove(p,null,u),t.onPointerUp(m,null,u),u.add(t)}onPointerDoublePress(e){let t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&o.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&o.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){o.onMouseLeave(this)}layout(){if(this.orientation===0){let e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{let e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){let t=e.initialTarget??e.target;if(!(!t||!Zn(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}};var uC=class extends W{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(e,t){super(),this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null,t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()},n=!1,i=!1,r=()=>{if(n&&!i)try{n=!1,i=!0,t()}finally{li(fe(this._referenceDomElement),()=>{i=!1,r()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?e={width:s[0].contentRect.width,height:s[0].contentRect.height}:e=null,n=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let n=0,i=0;t?(n=t.width,i=t.height):this._referenceDomElement&&(n=this._referenceDomElement.clientWidth,i=this._referenceDomElement.clientHeight),n=Math.max(5,n),i=Math.max(5,i),(this._width!==n||this._height!==i)&&(this._width=n,this._height=i,e&&this._onDidChange.fire())}};var m0=class extends W{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(e){super(),this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}},g0=class extends W{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(e){super(),this._value=this._getPixelRatio(e);let t=this._register(new m0(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){let t=document.createElement("canvas").getContext("2d"),n=e.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i}},f0=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(e){let t=jp(e),n=this.mapWindowIdToPixelRatioMonitor.get(t);return n||(n=Dl(new g0(e)),this.mapWindowIdToPixelRatioMonitor.set(t,n),Dl(de.once(s2)(({vscodeWindowId:i})=>{i===t&&(n?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))}))),n}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}},th=new f0;var Oc=class{constructor(e){this.domNode=e}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(e){let t=Wo(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=Wo(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=Wo(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=Wo(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=Wo(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=Wo(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=Wo(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=Wo(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=Wo(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=Wo(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=Wo(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=Wo(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=Wo(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=Wo(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function Wo(o){return typeof o=="number"?`${o}px`:o}function Ne(o){return new Oc(o)}function Qt(o,e){o instanceof Oc?(o.setFontFamily(e.getMassagedFontFamily()),o.setFontWeight(e.fontWeight),o.setFontSize(e.fontSize),o.setFontFeatureSettings(e.fontFeatureSettings),o.setFontVariationSettings(e.fontVariationSettings),o.setLineHeight(e.lineHeight),o.setLetterSpacing(e.letterSpacing)):(o.style.fontFamily=e.getMassagedFontFamily(),o.style.fontWeight=e.fontWeight,o.style.fontSize=e.fontSize+"px",o.style.fontFeatureSettings=e.fontFeatureSettings,o.style.fontVariationSettings=e.fontVariationSettings,o.style.lineHeight=e.lineHeight+"px",o.style.letterSpacing=e.letterSpacing+"px")}var pC=class{chr;type;width;constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}},b0=class o{_bareFontInfo;_requests;_container;_testElements;constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";let t=document.createElement("div");Qt(t,this._bareFontInfo),e.appendChild(t);let n=document.createElement("div");Qt(n,this._bareFontInfo),n.style.fontWeight="bold",e.appendChild(n);let i=document.createElement("div");Qt(i,this._bareFontInfo),i.style.fontStyle="italic",e.appendChild(i);let r=[];for(let s of this._requests){let a;s.type===0&&(a=t),s.type===2&&(a=n),s.type===1&&(a=i),a.appendChild(document.createElement("br"));let l=document.createElement("span");o._render(l,s),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let n="\xA0";for(let i=0;i<8;i++)n+=n;e.innerText=n}else{let n=t.chr;for(let i=0;i<8;i++)n+=n;e.textContent=n}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){let n=this._requests[e],i=this._testElements[e];n.fulfill(i.offsetWidth/256)}}};function _2(o,e,t){new b0(e,t).read(o)}var v0=class extends W{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){let t=jp(e),n=this._cache.get(t);return n||(n=new y0,this._cache.set(t,n)),n}_writeToCache(e,t,n){this._ensureCache(e).put(t,n),!n.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){let t=this._ensureCache(e),n=t.getValues(),i=!1;for(let r of n)r.isTrusted||(i=!0,t.remove(r));i&&this._onDidChange.fire()}serializeFontInfo(e){return this._ensureCache(e).getValues().filter(n=>n.isTrusted)}restoreFontInfo(e,t){for(let n of t){if(n.version!==FE)continue;let i=new Uu(n,!1);this._writeToCache(e,i,i)}}readFontInfo(e,t){let n=this._ensureCache(e);if(!n.has(t)){let i=this._actualReadFontInfo(e,t);(i.typicalHalfwidthCharacterWidth<=2||i.typicalFullwidthCharacterWidth<=2||i.spaceWidth<=2||i.maxDigitWidth<=2)&&(i=new Uu({pixelRatio:th.getInstance(e).value,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFeatureSettings:i.fontFeatureSettings,fontVariationSettings:i.fontVariationSettings,lineHeight:i.lineHeight,letterSpacing:i.letterSpacing,isMonospace:i.isMonospace,typicalHalfwidthCharacterWidth:Math.max(i.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(i.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:i.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(i.spaceWidth,5),middotWidth:Math.max(i.middotWidth,5),wsmiddotWidth:Math.max(i.wsmiddotWidth,5),maxDigitWidth:Math.max(i.maxDigitWidth,5)},!1)),this._writeToCache(e,t,i)}return n.get(t)}_createRequest(e,t,n,i){let r=new pC(e,t);return n.push(r),i?.push(r),r}_actualReadFontInfo(e,t){let n=[],i=[],r=this._createRequest("n",0,n,i),s=this._createRequest("\uFF4D",0,n,null),a=this._createRequest(" ",0,n,i),l=this._createRequest("0",0,n,i),d=this._createRequest("1",0,n,i),c=this._createRequest("2",0,n,i),u=this._createRequest("3",0,n,i),p=this._createRequest("4",0,n,i),m=this._createRequest("5",0,n,i),g=this._createRequest("6",0,n,i),f=this._createRequest("7",0,n,i),b=this._createRequest("8",0,n,i),v=this._createRequest("9",0,n,i),I=this._createRequest("\u2192",0,n,i),C=this._createRequest("\uFFEB",0,n,null),S=this._createRequest("\xB7",0,n,i),E=this._createRequest("\u2E31",0,n,null),M="|/-_ilm%";for(let U=0,z=M.length;U<z;U++)this._createRequest(M.charAt(U),0,n,i),this._createRequest(M.charAt(U),1,n,i),this._createRequest(M.charAt(U),2,n,i);_2(e,t,n);let A=Math.max(l.width,d.width,c.width,u.width,p.width,m.width,g.width,f.width,b.width,v.width),F=t.fontFeatureSettings===Va.OFF,O=i[0].width;for(let U=1,z=i.length;F&&U<z;U++){let re=O-i[U].width;if(re<-.001||re>.001){F=!1;break}}let H=!0;return F&&C.width!==O&&(H=!1),C.width>I.width&&(H=!1),new Uu({pixelRatio:th.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:F,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:H,spaceWidth:a.width,middotWidth:S.width,wsmiddotWidth:E.width,maxDigitWidth:A},!0)}},y0=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId();return!!this._values[t]}get(e){let t=e.getId();return this._values[t]}put(e,t){let n=e.getId();this._keys[n]=e,this._values[n]=t}remove(e){let t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}},I0=new v0;var bf=class o{constructor(e,t){this.key=e;this.migrate=t}static items=[];apply(e){let t=o._read(e,this.key),n=r=>o._read(e,r),i=(r,s)=>o._write(e,r,s);this.migrate(t,n,i)}static _read(e,t){if(typeof e>"u")return;let n=t.indexOf(".");if(n>=0){let i=t.substring(0,n);return this._read(e[i],t.substring(n+1))}return e[t]}static _write(e,t,n){let i=t.indexOf(".");if(i>=0){let r=t.substring(0,i);e[r]=e[r]||{},this._write(e[r],t.substring(i+1),n);return}e[t]=n}};function ds(o,e){bf.items.push(new bf(o,e))}function yo(o,e){ds(o,(t,n,i)=>{if(typeof t<"u"){for(let[r,s]of e)if(t===r){i(o,s);return}}})}function w2(o){bf.items.forEach(e=>e.apply(o))}yo("wordWrap",[[!0,"on"],[!1,"off"]]);yo("lineNumbers",[[!0,"on"],[!1,"off"]]);yo("cursorBlinking",[["visible","solid"]]);yo("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);yo("renderLineHighlight",[[!0,"line"],[!1,"none"]]);yo("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);yo("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);yo("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);yo("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);yo("autoIndent",[[!1,"advanced"],[!0,"full"]]);yo("matchBrackets",[[!0,"always"],[!1,"never"]]);yo("renderFinalNewline",[[!0,"on"],[!1,"off"]]);yo("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);yo("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);yo("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);ds("autoClosingBrackets",(o,e,t)=>{o===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});ds("renderIndentGuides",(o,e,t)=>{typeof o<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!o))});ds("highlightActiveIndentGuide",(o,e,t)=>{typeof o<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!o))});var QU={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};ds("suggest.filteredTypes",(o,e,t)=>{if(o&&typeof o=="object"){for(let n of Object.entries(QU))o[n[0]]===!1&&typeof e(`suggest.${n[1]}`)>"u"&&t(`suggest.${n[1]}`,!1);t("suggest.filteredTypes",void 0)}});ds("quickSuggestions",(o,e,t)=>{if(typeof o=="boolean"){let n=o?"on":"off";t("quickSuggestions",{comments:n,strings:n,other:n})}});ds("experimental.stickyScroll.enabled",(o,e,t)=>{typeof o=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",o))});ds("experimental.stickyScroll.maxLineCount",(o,e,t)=>{typeof o=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",o))});ds("codeActionsOnSave",(o,e,t)=>{if(o&&typeof o=="object"){let n=!1,i={};for(let r of Object.entries(o))typeof r[1]=="boolean"?(n=!0,i[r[0]]=r[1]?"explicit":"never"):i[r[0]]=r[1];n&&t("codeActionsOnSave",i)}});ds("codeActionWidget.includeNearbyQuickfixes",(o,e,t)=>{typeof o=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",o))});ds("lightbulb.enabled",(o,e,t)=>{typeof o=="boolean"&&t("lightbulb.enabled",o?void 0:"off")});var C0=class{_tabFocus=!1;_onDidChangeTabFocus=new L;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}},nh=new C0;var ih=class extends W{constructor(t,n,i,r,s){super();this._accessibilityService=s;this.isSimpleWidget=t,this.contextMenuId=n,this._containerObserver=this._register(new uC(r,i.dimension)),this._targetWindowId=fe(r).vscodeWindowId,this._rawOptions=E2(i),this._validatedOptions=Fc.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Bs.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(nh.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(I0.onDidChange(()=>this._recomputeOptions())),this._register(th.getInstance(fe(r)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new L);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new cg;_rawOptions;_validatedOptions;options;_recomputeOptions(){let t=this._computeOptions(),n=Fc.checkEquals(this.options,t);n!==null&&(this.options=t,this._onDidChangeFast.fire(n),this._onDidChange.fire(n))}_computeOptions(){let t=this._readEnvConfiguration(),n=ag.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(n),r={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:nh.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Fc.computeOptions(this._validatedOptions,r)}_readEnvConfiguration(){return{extraEditorClassName:XU(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:ns||Dn,pixelRatio:th.getInstance(c0(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return I0.readFontInfo(c0(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){let n=E2(t);Fc.applyUpdate(this._rawOptions,n)&&(this._validatedOptions=Fc.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){let n=ZU(t);this._lineNumbersDigitCount!==n&&(this._lineNumbersDigitCount=n,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};ih=K([D(4,Si)],ih);function ZU(o){let e=0;for(;o;)o=Math.floor(o/10),e++;return e||1}function XU(){let o="";return!ar&&!zF&&(o+="no-user-select "),ar&&(o+="no-minimap-shadow ",o+="enable-user-select "),Be&&(o+="mac "),o}var S0=class{_values=[];_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}},x0=class{_values=[];_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}},Fc=class o{static validateOptions(e){let t=new S0;for(let n of ju){let i=n.name==="_never_"?void 0:e[n.name];t._write(n.id,n.validate(i))}return t}static computeOptions(e,t){let n=new x0;for(let i of ju)n._write(i.id,i.compute(t,n,e._read(i.id)));return n}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?Kt(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!o._deepEquals(e[n],t[n]))return!1;return!0}static checkEquals(e,t){let n=[],i=!1;for(let r of ju){let s=!o._deepEquals(e._read(r.id),t._read(r.id));n[r.id]=s,s&&(i=!0)}return i?new qv(n):null}static applyUpdate(e,t){let n=!1;for(let i of ju)if(t.hasOwnProperty(i.name)){let r=i.applyUpdate(e[i.name],t[i.name]);e[i.name]=r.newValue,n=n||r.didChange}return n}};function E2(o){let e=zv(o);return w2(e),e}var cs=class{originalStart;originalLength;modifiedStart;modifiedLength;constructor(e,t,n,i){this.originalStart=e,this.originalLength=t,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}};var pd=class{static Assert(e,t){if(!e)throw new Error(t)}},hd=class{static Copy(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}static Copy2(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}};var hC=class{m_changes;m_originalStart;m_modifiedStart;m_originalCount;m_modifiedCount;constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new cs(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},oh=class o{ContinueProcessingPredicate;_originalSequence;_modifiedSequence;_hasStrings;_originalStringElements;_originalElementsOrHash;_modifiedStringElements;_modifiedElementsOrHash;m_forwardHistory;m_reverseHistory;constructor(e,t,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=t;let[i,r,s]=o._getElements(e),[a,l,d]=o._getElements(t);this._hasStrings=s&&d,this._originalStringElements=i,this._originalElementsOrHash=r,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){let t=e.getElements();if(o._isStringArray(t)){let n=new Int32Array(t.length);for(let i=0,r=t.length;i<r;i++)n[i]=Fv(t[i],0);return[t,n,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;let n=o._getStrictElement(this._originalSequence,e),i=o._getStrictElement(this._modifiedSequence,t);return n===i}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,n,i,r){let s=[!1],a=this.ComputeDiffRecursive(e,t,n,i,s);return r&&(a=this.PrettifyChanges(a)),{quitEarly:s[0],changes:a}}ComputeDiffRecursive(e,t,n,i,r){for(r[0]=!1;e<=t&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;t>=e&&i>=n&&this.ElementsAreEqual(t,i);)t--,i--;if(e>t||n>i){let u;return n<=i?(pd.Assert(e===t+1,"originalStart should only be one more than originalEnd"),u=[new cs(e,0,n,i-n+1)]):e<=t?(pd.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),u=[new cs(e,t-e+1,n,0)]):(pd.Assert(e===t+1,"originalStart should only be one more than originalEnd"),pd.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}let s=[0],a=[0],l=this.ComputeRecursionPoint(e,t,n,i,s,a,r),d=s[0],c=a[0];if(l!==null)return l;if(!r[0]){let u=this.ComputeDiffRecursive(e,d,n,c,r),p=[];return r[0]?p=[new cs(d+1,t-(d+1)+1,c+1,i-(c+1)+1)]:p=this.ComputeDiffRecursive(d+1,t,c+1,i,r),this.ConcatenateChanges(u,p)}return[new cs(e,t-e+1,n,i-n+1)]}WALKTRACE(e,t,n,i,r,s,a,l,d,c,u,p,m,g,f,b,v,I){let C=null,S=null,E=new hC,M=t,A=n,F=m[0]-b[0]-i,O=-1073741824,H=this.m_forwardHistory.length-1;do{let U=F+e;U===M||U<A&&d[U-1]<d[U+1]?(u=d[U+1],g=u-F-i,u<O&&E.MarkNextChange(),O=u,E.AddModifiedElement(u+1,g),F=U+1-e):(u=d[U-1]+1,g=u-F-i,u<O&&E.MarkNextChange(),O=u-1,E.AddOriginalElement(u,g+1),F=U-1-e),H>=0&&(d=this.m_forwardHistory[H],e=d[0],M=1,A=d.length-1)}while(--H>=-1);if(C=E.getReverseChanges(),I[0]){let U=m[0]+1,z=b[0]+1;if(C!==null&&C.length>0){let re=C[C.length-1];U=Math.max(U,re.getOriginalEnd()),z=Math.max(z,re.getModifiedEnd())}S=[new cs(U,p-U+1,z,f-z+1)]}else{E=new hC,M=s,A=a,F=m[0]-b[0]-l,O=1073741824,H=v?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let U=F+r;U===M||U<A&&c[U-1]>=c[U+1]?(u=c[U+1]-1,g=u-F-l,u>O&&E.MarkNextChange(),O=u+1,E.AddOriginalElement(u+1,g+1),F=U+1-r):(u=c[U-1],g=u-F-l,u>O&&E.MarkNextChange(),O=u,E.AddModifiedElement(u+1,g+1),F=U-1-r),H>=0&&(c=this.m_reverseHistory[H],r=c[0],M=1,A=c.length-1)}while(--H>=-1);S=E.getChanges()}return this.ConcatenateChanges(C,S)}ComputeRecursionPoint(e,t,n,i,r,s,a){let l=0,d=0,c=0,u=0,p=0,m=0;e--,n--,r[0]=0,s[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let g=t-e+(i-n),f=g+1,b=new Int32Array(f),v=new Int32Array(f),I=i-n,C=t-e,S=e-n,E=t-i,A=(C-I)%2===0;b[I]=e,v[C]=t,a[0]=!1;for(let F=1;F<=g/2+1;F++){let O=0,H=0;c=this.ClipDiagonalBound(I-F,F,I,f),u=this.ClipDiagonalBound(I+F,F,I,f);for(let z=c;z<=u;z+=2){z===c||z<u&&b[z-1]<b[z+1]?l=b[z+1]:l=b[z-1]+1,d=l-(z-I)-S;let re=l;for(;l<t&&d<i&&this.ElementsAreEqual(l+1,d+1);)l++,d++;if(b[z]=l,l+d>O+H&&(O=l,H=d),!A&&Math.abs(z-C)<=F-1&&l>=v[z])return r[0]=l,s[0]=d,re<=v[z]&&F<=1448?this.WALKTRACE(I,c,u,S,C,p,m,E,b,v,l,t,r,d,i,s,A,a):null}let U=(O-e+(H-n)-F)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(O,U))return a[0]=!0,r[0]=O,s[0]=H,U>0&&F<=1448?this.WALKTRACE(I,c,u,S,C,p,m,E,b,v,l,t,r,d,i,s,A,a):(e++,n++,[new cs(e,t-e+1,n,i-n+1)]);p=this.ClipDiagonalBound(C-F,F,C,f),m=this.ClipDiagonalBound(C+F,F,C,f);for(let z=p;z<=m;z+=2){z===p||z<m&&v[z-1]>=v[z+1]?l=v[z+1]-1:l=v[z-1],d=l-(z-C)-E;let re=l;for(;l>e&&d>n&&this.ElementsAreEqual(l,d);)l--,d--;if(v[z]=l,A&&Math.abs(z-I)<=F&&l<=b[z])return r[0]=l,s[0]=d,re>=b[z]&&F<=1448?this.WALKTRACE(I,c,u,S,C,p,m,E,b,v,l,t,r,d,i,s,A,a):null}if(F<=1447){let z=new Int32Array(u-c+2);z[0]=I-c+1,hd.Copy2(b,c,z,1,u-c+1),this.m_forwardHistory.push(z),z=new Int32Array(m-p+2),z[0]=C-p+1,hd.Copy2(v,p,z,1,m-p+1),this.m_reverseHistory.push(z)}}return this.WALKTRACE(I,c,u,S,C,p,m,E,b,v,l,t,r,d,i,s,A,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){let n=e[t],i=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,s=n.originalLength>0,a=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<r&&(!s||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!a||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){let d=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!d)break;n.originalStart++,n.modifiedStart++}let l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){let n=e[t],i=0,r=0;if(t>0){let u=e[t-1];i=u.originalStart+u.originalLength,r=u.modifiedStart+u.modifiedLength}let s=n.originalLength>0,a=n.modifiedLength>0,l=0,d=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let u=1;;u++){let p=n.originalStart-u,m=n.modifiedStart-u;if(p<i||m<r||s&&!this.OriginalElementsAreEqual(p,p+n.originalLength)||a&&!this.ModifiedElementsAreEqual(m,m+n.modifiedLength))break;let f=(p===i&&m===r?5:0)+this._boundaryScore(p,n.originalLength,m,n.modifiedLength);f>d&&(d=f,l=u)}n.originalStart-=l,n.modifiedStart-=l;let c=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],c)){e[t-1]=c[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,n=e.length;t<n;t++){let i=e[t-1],r=e[t],s=r.originalStart-i.originalStart-i.originalLength,a=i.originalStart,l=r.originalStart+r.originalLength,d=l-a,c=i.modifiedStart,u=r.modifiedStart+r.modifiedLength,p=u-c;if(s<5&&d<20&&p<20){let m=this._findBetterContiguousSequence(a,d,c,p,s);if(m){let[g,f]=m;(g!==i.originalStart+i.originalLength||f!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=g-i.originalStart,i.modifiedLength=f-i.modifiedStart,r.originalStart=g+s,r.modifiedStart=f+s,r.originalLength=l-r.originalStart,r.modifiedLength=u-r.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,n,i,r){if(t<r||i<r)return null;let s=e+t-r+1,a=n+i-r+1,l=0,d=0,c=0;for(let u=e;u<s;u++)for(let p=n;p<a;p++){let m=this._contiguousSequenceScore(u,p,r);m>0&&m>l&&(l=m,d=u,c=p)}return l>0?[d,c]:null}_contiguousSequenceScore(e,t,n){let i=0;for(let r=0;r<n;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;i+=this._originalStringElements[e+r].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){let n=e+t;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){let n=e+t;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,t,n,i){let r=this._OriginalRegionIsBoundary(e,t)?1:0,s=this._ModifiedRegionIsBoundary(n,i)?1:0;return r+s}ConcatenateChanges(e,t){let n=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],n)){let i=new Array(e.length+t.length-1);return hd.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],hd.Copy(t,1,i,e.length,t.length-1),i}else{let i=new Array(e.length+t.length);return hd.Copy(e,0,i,0,e.length),hd.Copy(t,0,i,e.length,t.length),i}}ChangesOverlap(e,t,n){if(pd.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),pd.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){let i=e.originalStart,r=e.originalLength,s=e.modifiedStart,a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),n[0]=new cs(i,r,s,a),!0}else return n[0]=null,!1}ClipDiagonalBound(e,t,n,i){if(e>=0&&e<i)return e;let r=n,s=i-n-1,a=t%2===0;if(e<0){let l=r%2===0;return a===l?0:1}else{let l=s%2===0;return a===l?i-1:i-2}}};var mC=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}lineStartOffsetByLineIdx;getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new Et(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let t=bu(this.lineStartOffsetByLineIdx,r=>r<=e),n=t+1,i=e-this.lineStartOffsetByLineIdx[t]+1;return new R(n,i)}getRange(e){return w.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return Pi.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new Pi(e,this.text.length-this.lineStartOffsetByLineIdx[e])}};var il=class o{constructor(e){this.edits=e;Od(()=>uw(e,(t,n)=>t.range.getEndPosition().isBeforeOrEqual(n.range.getStartPosition())))}static single(e,t){return new o([new hn(e,t)])}normalize(){let e=[];for(let t of this.edits)if(e.length>0&&e[e.length-1].range.getEndPosition().equals(t.range.getStartPosition())){let n=e[e.length-1];e[e.length-1]=new hn(n.range.plusRange(t.range),n.text+t.text)}else t.isEmpty||e.push(t);return new o(e)}mapPosition(e){let t=0,n=0,i=0;for(let r of this.edits){let s=r.range.getStartPosition(),a=r.range.getEndPosition();if(e.isBeforeOrEqual(s))break;let l=Pi.ofText(r.text);if(e.isBefore(a)){let d=new R(s.lineNumber+t,s.column+(s.lineNumber+t===n?i:0)),c=l.addToPosition(d);return gC(d,c)}t+=l.lineCount-(r.range.endLineNumber-r.range.startLineNumber),l.lineCount===0?a.lineNumber!==s.lineNumber?i+=l.columnCount-(a.column-1):i+=l.columnCount-(a.column-s.column):i=l.columnCount,n=a.lineNumber+t}return new R(e.lineNumber+t,e.column+(e.lineNumber+t===n?i:0))}mapRange(e){function t(s){return s instanceof R?s:s.getStartPosition()}function n(s){return s instanceof R?s:s.getEndPosition()}let i=t(this.mapPosition(e.getStartPosition())),r=n(this.mapPosition(e.getEndPosition()));return gC(i,r)}inverseMapPosition(e,t){return this.inverse(t).mapPosition(e)}inverseMapRange(e,t){return this.inverse(t).mapRange(e)}apply(e){let t="",n=new R(1,1);for(let r of this.edits){let s=r.range,a=s.getStartPosition(),l=s.getEndPosition(),d=gC(n,a);d.isEmpty()||(t+=e.getValueOfRange(d)),t+=r.text,n=l}let i=gC(n,e.endPositionExclusive);return i.isEmpty()||(t+=e.getValueOfRange(i)),t}applyToString(e){let t=new w0(e);return this.apply(t)}inverse(e){let t=this.getNewRanges();return new o(this.edits.map((n,i)=>new hn(t[i],e.getValueOfRange(n.range))))}getNewRanges(){let e=[],t=0,n=0,i=0;for(let r of this.edits){let s=Pi.ofText(r.text),a=R.lift({lineNumber:r.range.startLineNumber+n,column:r.range.startColumn+(r.range.startLineNumber===t?i:0)}),l=s.createRange(a);e.push(l),n=l.endLineNumber-r.range.endLineNumber,i=l.endColumn-r.range.endColumn,t=r.range.endLineNumber}return e}},hn=class{constructor(e,t){this.range=e;this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};function gC(o,e){if(o.lineNumber===e.lineNumber&&o.column===Number.MAX_SAFE_INTEGER)return w.fromPositions(e,e);if(!o.isBeforeOrEqual(e))throw new Ke("start must be before end");return new w(o.lineNumber,o.column,e.lineNumber,e.column)}var _0=class{get endPositionExclusive(){return this.length.addToPosition(new R(1,1))}getValue(){return this.getValueOfRange(this.length.toRange())}};var w0=class extends _0{constructor(t){super();this.value=t}_t=new mC(this.value);getValueOfRange(t){return this._t.getOffsetRange(t).substring(this.value)}get length(){return this._t.textLength}};var ol=class{constructor(e,t,n,i,r){this.injectionOffsets=e;this.injectionOptions=t;this.breakOffsets=n;this.breakOffsetsVisibleColumn=i;this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){let t=e>0?this.breakOffsets[e-1]:0,i=this.breakOffsets[e]-t;return e>0&&(i+=this.wrappedTextIndentLength),i}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let i=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&i>this.injectionOffsets[r];r++)i<this.injectionOffsets[r]+this.injectionOptions[r].content.length?i=this.injectionOffsets[r]:i-=this.injectionOptions[r].content.length;return i}translateToOutputPosition(e,t=2){let n=e;if(this.injectionOffsets!==null)for(let i=0;i<this.injectionOffsets.length&&!(e<this.injectionOffsets[i]||t!==1&&e===this.injectionOffsets[i]);i++)n+=this.injectionOptions[i].content.length;return this.offsetInInputWithInjectionsToOutputPosition(n,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let n=0,i=this.breakOffsets.length-1,r=0,s=0;for(;n<=i;){r=n+(i-n)/2|0;let l=this.breakOffsets[r];if(s=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=s)i=r-1;else if(e>l)n=r+1;else break;else if(e<s)i=r-1;else if(e>=l)n=r+1;else break}let a=e-s;return r>0&&(a+=this.wrappedTextIndentLength),new rh(r,a)}normalizeOutputPosition(e,t,n){if(this.injectionOffsets!==null){let i=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(i,n);if(r!==i)return this.offsetInInputWithInjectionsToOutputPosition(r,n)}if(n===0){if(e>0&&t===this.getMinOutputOffset(e))return new rh(e-1,this.getMaxOutputOffset(e-1))}else if(n===1){let i=this.getOutputLineCount()-1;if(e<i&&t===this.getMaxOutputOffset(e))return new rh(e+1,this.getMinOutputOffset(e+1))}return new rh(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){let n=this.getInjectedTextAtOffset(e);if(!n)return e;if(t===2){if(e===n.offsetInInputWithInjections+n.length&&T2(this.injectionOptions[n.injectedTextIndex].cursorStops))return n.offsetInInputWithInjections+n.length;{let i=n.offsetInInputWithInjections;if(L2(this.injectionOptions[n.injectedTextIndex].cursorStops))return i;let r=n.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[n.injectedTextIndex]&&!(T2(this.injectionOptions[r].cursorStops)||(i-=this.injectionOptions[r].content.length,L2(this.injectionOptions[r].cursorStops)));)r--;return i}}else if(t===1||t===4){let i=n.offsetInInputWithInjections+n.length,r=n.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)i+=this.injectionOptions[r+1].content.length,r++;return i}else if(t===0||t===3){let i=n.offsetInInputWithInjections,r=n.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)i-=this.injectionOptions[r-1].content.length,r--;return i}Nd(t)}getInjectedText(e,t){let n=this.outputPositionToOffsetInInputWithInjections(e,t),i=this.getInjectedTextAtOffset(n);return i?{options:this.injectionOptions[i.injectedTextIndex]}:null}getInjectedTextAtOffset(e){let t=this.injectionOffsets,n=this.injectionOptions;if(t!==null){let i=0;for(let r=0;r<t.length;r++){let s=n[r].content.length,a=t[r]+i,l=t[r]+i+s;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:s};i+=s}}}};function T2(o){return o==null?!0:o===1||o===0}function L2(o){return o==null?!0:o===2||o===0}var rh=class{outputLineIndex;outputOffset;constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new R(e+this.outputLineIndex,this.outputOffset+1)}};var ez=()=>!0,tz=()=>!1,nz=o=>o===" "||o==="	",sl=class{constructor(e,t,n,i){this.languageConfigurationService=i;this._languageId=e;let r=n.options,s=r.get(147),a=r.get(51);this.readOnly=r.get(93),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=r.get(130),this.wordSeparators=r.get(133),this.emptySelectionClipboard=r.get(38),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(78),this.multiCursorPaste=r.get(80),this.multiCursorLimit=r.get(81),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.wordSegmenterLocales=r.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(e){return e.hasChanged(147)||e.hasChanged(133)||e.hasChanged(38)||e.hasChanged(78)||e.hasChanged(80)||e.hasChanged(81)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(130)||e.hasChanged(51)||e.hasChanged(93)||e.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(let t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,n){let i=js(t,n-1),r=this.languageConfigurationService.getLanguageConfiguration(i.languageId).electricCharacter;return r?r.onElectricCharacter(e,i,n-i.firstCharOffset):null}normalizeIndentation(e){return Wy(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,n){switch(t){case"beforeWhitespace":return nz;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,n);case"always":return ez;case"never":return tz}}_getLanguageDefinedShouldAutoClose(e,t){let n=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return i=>n.indexOf(i)!==-1}visibleColumnFromColumn(e,t){return St.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,n){let i=St.columnFromVisibleColumn(e.getLineContent(t),n,this.tabSize),r=e.getLineMinColumn(t);if(i<r)return r;let s=e.getLineMaxColumn(t);return i>s?s:i}},ze=class o{_cursorStateBrand=void 0;static fromModelState(e){return new E0(e)}static fromViewState(e){return new T0(e)}static fromModelSelection(e){let t=De.liftSelection(e),n=new bn(w.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return o.fromModelState(n)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}modelState;viewState;constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}},E0=class{modelState;viewState;constructor(e){this.modelState=e,this.viewState=null}},T0=class{modelState;viewState;constructor(e){this.modelState=null,this.viewState=e}};var bn=class o{constructor(e,t,n,i,r){this.selectionStart=e;this.selectionStartKind=t;this.selectionStartLeftoverVisibleColumns=n;this.position=i;this.leftoverVisibleColumns=r;this.selection=o._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new o(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new R(t,n),i):new o(new w(t,n,t,n),0,i,new R(t,n),i)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?De.fromPositions(e.getStartPosition(),t):De.fromPositions(e.getEndPosition(),t)}},Rn=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(e,t,n){this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}};function us(o){return o==="'"||o==='"'||o==="`"}var fC=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}};var bC=class{type=0;constructor(){}},vC=class{type=1;constructor(){}},yC=class{type=2;_source;constructor(e){this._source=e}hasChanged(e){return this._source.hasChanged(e)}},IC=class{constructor(e,t,n){this.selections=e;this.modelSelections=t;this.reason=n}type=3},da=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(e){e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},Bc=class{type=5;constructor(){}},CC=class{type=6;isFocused;constructor(e){this.isFocused=e}},SC=class{type=7},Wc=class{type=8;constructor(){}},vf=class{constructor(e,t){this.fromLineNumber=e;this.count=t}type=9},sh=class{type=10;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},ah=class{type=11;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}};var al=class{constructor(e,t,n,i,r,s,a){this.source=e;this.minimalReveal=t;this.range=n;this.selections=i;this.verticalType=r;this.revealHorizontal=s;this.scrollType=a}type=12},xC=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e){this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}},_C=class{constructor(e){this.theme=e}type=14},wC=class{type=15;ranges;constructor(e){this.ranges=e}},EC=class{type=16;constructor(){}},TC=class{type=17;constructor(){}};var _r=class extends W{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let n=0,i=e.length;n<i;n++){let r=e[n];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}};var yf=class{_viewportBrand=void 0;top;left;width;height;constructor(e,t,n,i){this.top=e|0,this.left=t|0,this.width=n|0,this.height=i|0}},LC=class{tabSize;data;constructor(e,t){this.tabSize=e,this.data=t}},Vc=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(e,t,n,i,r,s,a){this.content=e,this.continuesWithWrappedLine=t,this.minColumn=n,this.maxColumn=i,this.startVisibleColumn=r,this.tokens=s,this.inlineDecorations=a}},kC=class o{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(e,t,n,i,r,s,a,l,d,c){this.minColumn=e,this.maxColumn=t,this.content=n,this.continuesWithWrappedLine=i,this.isBasicASCII=o.isBasicASCII(n,s),this.containsRTL=o.containsRTL(n,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(e,t){return t?Qd(e):!0}static containsRTL(e,t,n){return!t&&n?Wr(e):!1}};var Hc=class{constructor(e,t,n){this.range=e;this.inlineClassName=t;this.type=n}},DC=class{constructor(e,t,n,i){this.startOffset=e;this.endOffset=t;this.inlineClassName=n;this.inlineClassNameAffectsLetterSpacing=i}toInlineDecoration(e){return new Hc(new w(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},dh=class{_viewModelDecorationBrand=void 0;range;options;constructor(e,t){this.range=e,this.options=t}},Uc=class o{constructor(e,t,n){this.color=e;this.zIndex=t;this.data=n}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&Kt(e.data,t.data)}static equalsArr(e,t){return Kt(e,t,o.equals)}};var RC=class{_colorZoneBrand=void 0;from;to;colorId;constructor(e,t,n){this.from=e|0,this.to=t|0,this.colorId=n|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}},L0=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(e,t,n,i){this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=n,this.color=i,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}},MC=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(L0.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),n=Math.floor(this.getCanvasHeight()),i=Math.floor(this._outerHeight),r=n/i,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!e){let S=c.getColorZones();if(S){a.push(S);continue}}let u=this._getVerticalOffsetForLine(c.startLineNumber),p=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+t:u+c.heightInLines*t,m=Math.floor(r*u),g=Math.floor(r*p),f=Math.floor((m+g)/2),b=g-f;b<s&&(b=s),f-b<0&&(f=b),f+b>n&&(f=n-b);let v=c.color,I=this._color2Id[v];I||(I=++this._lastAssignedId,this._color2Id[v]=I,this._id2Color[I]=v);let C=new RC(f-b,f+b,I);c.setColorZone(C),a.push(C)}return this._colorZonesInvalid=!1,a.sort(RC.compare),a}};var wr=Y("codeEditorService");var zc=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let t of e){let n=t.kbExpr;this.precondition&&(n?n=pe.and(n,this.precondition):n=this.precondition);let i={id:this.id,weight:t.weight,args:t.args,when:n,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Xr.registerKeybindingRule(i)}}nr.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){ra.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}},md=class extends zc{_implementations=[];addImplementation(e,t,n,i){return this._implementations.push({priority:e,name:t,implementation:n,when:i}),this._implementations.sort((r,s)=>s.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===n){this._implementations.splice(r,1);return}}}}runCommand(e,t){let n=e.get(En),i=e.get(rt);n.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let r of this._implementations){if(r.when){let a=i.getContext(bo());if(!r.when.evaluate(a))continue}let s=r.implementation(e,t);if(s)return n.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof s=="boolean"?void 0:s}n.trace(`The Command '${this.id}' was not handled by any implementation.`)}},PC=class extends zc{constructor(t,n){super(n);this.command=t}runCommand(t,n){return this.command.runCommand(t,n)}},ca=class o extends zc{static bindToContribution(e){return class extends o{_callback;constructor(n){super(n),this._callback=n.handler}runEditorCommand(n,i,r){let s=e(i);s&&this._callback(s,r)}}}static runEditorCommand(e,t,n,i){let r=e.get(wr),s=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(rt).contextMatchesRules(n??void 0))return i(a,s,t)})}runCommand(e,t){return o.runEditorCommand(e,t,this.precondition,(n,i,r)=>this.runEditorCommand(n,i,r))}},If=class o extends ca{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function n(i){return i.menuId||(i.menuId=Bt.EditorContext),i.title||(i.title=e.label),i.when=pe.and(e.precondition,i.when),i}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(n)):e.contextMenuOpts&&t.push(n(e.contextMenuOpts)),e.menuOpts=t,e}label;alias;constructor(e){super(o.convertOptions(e)),this.label=e.label,this.alias=e.alias}runEditorCommand(e,t,n){return this.reportTelemetry(e,t),this.run(e,t,n||{})}reportTelemetry(e,t){e.get(sr).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}};function ye(o){return ps.INSTANCE.registerEditorCommand(o),o}function k0(o){let e=new o;return ps.INSTANCE.registerEditorAction(e),e}function ch(o,e,t){ps.INSTANCE.registerEditorContribution(o,e,t)}var Sf;(r=>{function o(s){return ps.INSTANCE.getEditorCommand(s)}r.getEditorCommand=o;function e(){return ps.INSTANCE.getEditorActions()}r.getEditorActions=e;function t(){return ps.INSTANCE.getEditorContributions()}r.getEditorContributions=t;function n(s){return ps.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}r.getSomeEditorContributions=n;function i(){return ps.INSTANCE.getDiffEditorContributions()}r.getDiffEditorContributions=i})(Sf||={});var iz={EditorCommonContributions:"editor.contributions"},ps=class o{static INSTANCE=new o;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(e,t,n){this.editorContributions.push({id:e,ctor:t,instantiation:n})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(e,t){this.diffEditorContributions.push({id:e,ctor:t})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};tt.add(iz.EditorCommonContributions,ps.INSTANCE);function xf(o){return o.register(),o}var D0=xf(new md({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:Bt.MenubarEditMenu,group:"1_do",title:h({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:Bt.CommandPalette,group:"",title:h("undo","Undo"),order:1}]}));xf(new PC(D0,{id:"default:undo",precondition:void 0}));var R0=xf(new md({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:Bt.MenubarEditMenu,group:"1_do",title:h({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:Bt.CommandPalette,group:"",title:h("redo","Redo"),order:1}]}));xf(new PC(R0,{id:"default:redo",precondition:void 0}));var k2=xf(new md({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:Bt.MenubarSelectionMenu,group:"1_basic",title:h({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:Bt.CommandPalette,group:"",title:h("selectAll","Select All"),order:1}]}));var oz={Quickaccess:"workbench.contributions.quickaccess"},M0=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,n)=>n.prefix.length-t.prefix.length),ge(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return Ta([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(n=>e.startsWith(n.prefix))||void 0||this.defaultProvider}clear(){let e=[...this.providers],t=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=e,this.defaultProvider=t}}};tt.add(oz.Quickaccess,new M0);var X7e=new Nn(()=>{let o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:o,collatorIsNumeric:o.resolvedOptions().numeric}}),J7e=new Nn(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),e9e=new Nn(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));var p9e=Object.freeze({score:0}),h9e=1<<18,m9e=1<<17;var P0=class{constructor(e){this.options=e}getItemLabel(e){return e.label}getItemDescription(e){if(!this.options?.skipDescription)return e.description}getItemPath(e){if(!this.options?.skipPath)return e.resource?.scheme===$e.file?e.resource.fsPath:e.resource?.path}},B9e=new P0,W9e=Y("quickInputService");var cr=Y("accessibleViewService");function D2(o){let e=new te,t=e.add(h2());return e.add(Ht(n=>{t.setStyle(o.read(n))})),e}var R2=2e4,A2,A0,M2,N0,P2;function ua(o){A2&&(A0.textContent!==o?(di(M2),AC(A0,o)):(di(A0),AC(M2,o)))}function gd(o){A2&&(N0.textContent!==o?(di(P2),AC(N0,o)):(di(N0),AC(P2,o)))}function AC(o,e){di(o),e.length>R2&&(e=e.substr(0,R2)),o.textContent=e,o.style.visibility="hidden",o.style.visibility="visible"}function OC(){return Tm&&!!Tm.VSCODE_DEV}function O0(o){if(OC()){let e=sz();return e.add(o),{dispose(){e.delete(o)}}}else return{dispose(){}}}function sz(){NC||(NC=new Set);let o=globalThis;return o.$hotReload_applyNewExports||(o.$hotReload_applyNewExports=e=>{let t={config:{mode:void 0},...e},n=[];for(let i of NC){let r=i(t);r&&n.push(r)}if(n.length>0)return i=>{let r=!1;for(let s of n)s(i)&&(r=!0);return r}}),NC}var NC;OC()&&O0(({oldExports:o,newSrc:e,config:t})=>{if(t.mode==="patch-prototype")return n=>{for(let i in n){let r=n[i];if(console.log(`[hot-reload] Patching prototype methods of '${i}'`,{exportedItem:r}),typeof r=="function"&&r.prototype){let s=o[i];if(s){for(let a of Object.getOwnPropertyNames(r.prototype)){let l=Object.getOwnPropertyDescriptor(r.prototype,a),d=Object.getOwnPropertyDescriptor(s.prototype,a);l?.value?.toString()!==d?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${i}.${a}'`),Object.defineProperty(s.prototype,a,l)}n[i]=s}}}return!0}});function N2(o,e){return az([o],e),o}function az(o,e){OC()&&mm("reload",n=>O0(({oldExports:i})=>{if([...Object.values(i)].some(r=>o.includes(r)))return r=>(n(void 0),!0)})).read(e)}var fd=class o{static columnSelect(e,t,n,i,r,s){let a=Math.abs(r-n)+1,l=n>r,d=i>s,c=i<s,u=[];for(let p=0;p<a;p++){let m=n+(l?-p:p),g=e.columnFromVisibleColumn(t,m,i),f=e.columnFromVisibleColumn(t,m,s),b=e.visibleColumnFromColumn(t,new R(m,g)),v=e.visibleColumnFromColumn(t,new R(m,f));c&&(b>s||v<i)||d&&(v>i||b<s)||u.push(new bn(new w(m,g,m,g),0,0,new R(m,f),0))}if(u.length===0)for(let p=0;p<a;p++){let m=n+(l?-p:p),g=t.getLineMaxColumn(m);u.push(new bn(new w(m,g,m,g),0,0,new R(m,g),0))}return{viewStates:u,reversed:l,fromLineNumber:n,fromVisualColumn:i,toLineNumber:r,toVisualColumn:s}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,o.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let i=0,r=Math.min(n.fromViewLineNumber,n.toViewLineNumber),s=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let l=r;l<=s;l++){let d=t.getLineMaxColumn(l),c=e.visibleColumnFromColumn(t,new R(l,d));i=Math.max(i,c)}let a=n.toViewVisualColumn;return a<i&&a++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,a)}static columnSelectUp(e,t,n,i){let r=i?e.pageSize:1,s=Math.max(1,n.toViewLineNumber-r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){let r=i?e.pageSize:1,s=Math.min(t.getLineCount(),n.toViewLineNumber+r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}};var ci=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return De.fromPositions(i.getEndPosition())}};var Kc=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return De.fromPositions(i.getStartPosition())}},Gc=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(e,t,n,i,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=i,this._lineNumberDeltaOffset=n,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return De.fromPositions(i.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},BC=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(e,t,n,i=!1){this._range=e,this._text=t,this._initialSelection=n,this._forceMoveMarkers=i,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};var $c=class o{static whitespaceVisibleColumn(e,t,n){let i=e.length,r=0,s=-1,a=-1;for(let l=0;l<i;l++){if(l===t)return[s,a,r];switch(r%n===0&&(s=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=St.nextRenderTabStop(r,n);break;default:return[-1,-1,-1]}}return t===i?[s,a,r]:[-1,-1,-1]}static atomicPosition(e,t,n,i){let r=e.length,[s,a,l]=o.whitespaceVisibleColumn(e,t,n);if(l===-1)return-1;let d;switch(i){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%n===0)return t;d=l%n<=n/2;break}if(d){if(s===-1)return-1;let p=a;for(let m=s;m<r;++m){if(p===a+n)return s;switch(e.charCodeAt(m)){case 32:p+=1;break;case 9:p=St.nextRenderTabStop(p,n);break;default:return-1}}return p===a+n?s:-1}let c=St.nextRenderTabStop(l,n),u=l;for(let p=t;p<r;p++){if(u===c)return p;switch(e.charCodeAt(p)){case 32:u+=1;break;case 9:u=St.nextRenderTabStop(u,n);break;default:return-1}}return u===c?r:-1}};var _f=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(e,t,n){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}},Zt=class o{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-Zw(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){let n=t.lineNumber-1;return new R(n,e.getLineMaxColumn(n))}else return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){let i=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),s=$c.atomicPosition(r,t.column-1,n,0);if(s!==-1&&s+1>=i)return new R(t.lineNumber,s+1)}return this.leftPosition(e,t)}static left(e,t,n){let i=e.stickyTabStops?o.leftPositionAtomicSoftTabs(t,n,e.tabSize):o.leftPosition(t,n);return new _f(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.startLineNumber,a=n.selection.startColumn;else{let l=n.position.delta(void 0,-(r-1)),d=t.normalizePosition(o.clipPositionColumn(l,t),0),c=o.left(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static clipPositionColumn(e,t){return new R(e.lineNumber,o.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n=n+Nm(e.getLineContent(t),n-1):t<e.getLineCount()&&(t=t+1,n=e.getLineMinColumn(t)),new R(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,r){if(n<e.getLineIndentColumn(t)){let s=e.getLineContent(t),a=$c.atomicPosition(s,n-1,i,1);if(a!==-1)return new R(t,a+1)}return this.rightPosition(e,t,n)}static right(e,t,n){let i=e.stickyTabStops?o.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):o.rightPosition(t,n.lineNumber,n.column);return new _f(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.endLineNumber,a=n.selection.endColumn;else{let l=n.position.delta(void 0,r-1),d=t.normalizePosition(o.clipPositionColumn(l,t),1),c=o.right(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static vertical(e,t,n,i,r,s,a,l){let d=St.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+r,c=t.getLineCount(),u=n===1&&i===1,p=n===c&&i===t.getLineMaxColumn(n),m=s<n?u:p;if(n=s,n<1?(n=1,a?i=t.getLineMinColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):n>c?(n=c,a?i=t.getLineMaxColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):i=e.columnFromVisibleColumn(t,n,d),m?r=0:r=d-St.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),l!==void 0){let g=new R(n,i),f=t.normalizePosition(g,l);r=r+(i-f.column),n=f.lineNumber,i=f.column}return new _f(n,i,r)}static down(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n+s,a,4)}static moveDown(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.endLineNumber,a=n.selection.endColumn):(s=n.position.lineNumber,a=n.position.column);let l=0,d;do if(d=o.down(e,t,s+l,a,n.leftoverVisibleColumns,r,!0),t.normalizePosition(new R(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<t.getLineCount());return n.move(i,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(e,t,n){let i=n.selection,r=o.down(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.down(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new bn(new w(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new R(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n-s,a,3)}static moveUp(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.startLineNumber,a=n.selection.startColumn):(s=n.position.lineNumber,a=n.position.column);let l=o.up(e,t,s,a,n.leftoverVisibleColumns,r,!0);return n.move(i,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,n){let i=n.selection,r=o.up(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.up(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new bn(new w(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new R(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,n,i){let r=n.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return n.move(i,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,n,i){let r=t.getLineCount(),s=n.position.lineNumber;for(;s<r&&this._isBlankLine(t,s);)s++;for(;s<r&&!this._isBlankLine(t,s);)s++;return n.move(i,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,n,i){let r=n.position.lineNumber,s=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||s,l;return n.position.column===a?l=s:l=a,n.move(i,r,l,0)}static moveToEndOfLine(e,t,n,i,r){let s=n.position.lineNumber,a=t.getLineMaxColumn(s);return n.move(i,s,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let r=t.getLineCount(),s=t.getLineMaxColumn(r);return n.move(i,r,s,0)}};var ll=class o{static deleteRight(e,t,n,i){let r=[],s=e!==3;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d;if(c.isEmpty()){let u=d.getPosition(),p=Zt.right(t,n,u);c=new w(p.lineNumber,p.column,u.lineNumber,u.column)}if(c.isEmpty()){r[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),r[a]=new ci(c,"")}return[s,r]}static isAutoClosingPairDelete(e,t,n,i,r,s,a){if(t==="never"&&n==="never"||e==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],u=c.getPosition();if(!c.isEmpty())return!1;let p=r.getLineContent(u.lineNumber);if(u.column<2||u.column>=p.length+1)return!1;let m=p.charAt(u.column-2),g=i.get(m);if(!g)return!1;if(us(m)){if(n==="never")return!1}else if(t==="never")return!1;let f=p.charAt(u.column-1),b=!1;for(let v of g)v.open===m&&v.close===f&&(b=!0);if(!b)return!1;if(e==="auto"){let v=!1;for(let I=0,C=a.length;I<C;I++){let S=a[I];if(u.lineNumber===S.startLineNumber&&u.column===S.startColumn){v=!0;break}}if(!v)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].getPosition(),l=new w(a.lineNumber,a.column-1,a.lineNumber,a.column+1);i[r]=new ci(l,"")}return[!0,i]}static deleteLeft(e,t,n,i,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,r))return this._runAutoClosingPairDelete(t,n,i);let s=[],a=e!==2;for(let l=0,d=i.length;l<d;l++){let c=o.getDeleteRange(i[l],n,t);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new ci(c,"")}return[a,s]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;let i=e.getPosition();if(n.useTabStops&&i.column>1){let r=t.getLineContent(i.lineNumber),s=$t(r),a=s===-1?r.length+1:s+1;if(i.column<=a){let l=n.visibleColumnFromColumn(t,i),d=St.prevIndentTabStop(l,n.indentSize),c=n.columnFromVisibleColumn(t,i.lineNumber,d);return new w(i.lineNumber,c,i.lineNumber,i.column)}}return w.fromPositions(o.getPositionAfterDeleteLeft(i,t),i)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){let n=UM(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}else if(e.lineNumber>1){let n=e.lineNumber-1;return new R(n,t.getLineMaxColumn(n))}else return e}static cut(e,t,n){let i=[],r=null;n.sort((s,a)=>R.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=n.length;s<a;s++){let l=n[s];if(l.isEmpty())if(e.emptySelectionClipboard){let d=l.getPosition(),c,u,p,m;d.lineNumber<t.getLineCount()?(c=d.lineNumber,u=1,p=d.lineNumber+1,m=1):d.lineNumber>1&&r?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,u=t.getLineMaxColumn(d.lineNumber-1),p=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,u=1,p=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber));let g=new w(c,u,p,m);r=g,g.isEmpty()?i[s]=null:i[s]=new ci(g,"")}else i[s]=null;else i[s]=new ci(l,"")}return new Rn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var uh=class o{static _createWord(e,t,n,i,r){return{start:i,end:r,wordType:t,nextCharClass:n}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0,r=t.findPrevIntlWordBeforeOrAtOffset(e,n.column-2);for(let s=n.column-2;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return this._createIntlWord(r,l);if(l===0){if(i===2)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=1}else if(l===2){if(i===1)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=2}else if(l===1&&i!==0)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1))}return i!==0?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let r=t.findNextIntlWordAtOrAfterOffset(e,i),s=e.length;for(let a=i;a<s;a++){let l=e.charCodeAt(a),d=t.get(l);if(r&&a===r.index+r.segment.length||d===1||n===1&&d===2||n===2&&d===0)return a}return s}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,r=e.length,s=t.findNextIntlWordAtOrAfterOffset(e,n.column-1);for(let a=n.column-1;a<r;a++){let l=e.charCodeAt(a),d=t.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(i===2)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=1}else if(d===2){if(i===1)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=2}else if(d===1&&i!==0)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a)}return i!==0?this._createWord(e,i,1,this._findStartOfWord(e,t,i,r-1),r):null}static _findStartOfWord(e,t,n,i){let r=t.findPrevIntlWordBeforeOrAtOffset(e,i);for(let s=i;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return s;if(l===1||n===1&&l===2||n===2&&l===0)return s+1}return 0}static moveWordLeft(e,t,n,i,r){let s=n.lineNumber,a=n.column;a===1&&s>1&&(s=s-1,a=t.getLineMaxColumn(s));let l=o._findPreviousWordOnLine(e,t,new R(s,a));if(i===0)return new R(s,l?l.start+1:1);if(i===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findPreviousWordOnLine(e,t,new R(s,l.start+1))),new R(s,l?l.start+1:1);if(i===3){for(;l&&l.wordType===2;)l=o._findPreviousWordOnLine(e,t,new R(s,l.start+1));return new R(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=o._findPreviousWordOnLine(e,t,new R(s,l.start+1))),new R(s,l?l.end+1:1)}static _moveWordPartLeft(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===1)return n>1?new R(n-1,e.getLineMaxColumn(n-1)):t;let r=e.getLineContent(n);for(let s=t.column-1;s>1;s--){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a===95&&l!==95)return new R(n,s);if(a===45&&l!==45)return new R(n,s);if((Gd(a)||Pm(a))&&Ps(l))return new R(n,s);if(Ps(a)&&Ps(l)&&s+1<i){let d=r.charCodeAt(s);if(Gd(d)||Pm(d))return new R(n,s)}}return new R(n,1)}static moveWordRight(e,t,n,i){let r=n.lineNumber,s=n.column,a=!1;s===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,s=1);let l=o._findNextWordOnLine(e,t,new R(r,s));if(i===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findNextWordOnLine(e,t,new R(r,l.end+1))),l?s=l.end+1:s=t.getLineMaxColumn(r);else if(i===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=o._findNextWordOnLine(e,t,new R(r,l.end+1));l?s=l.start+1:s=t.getLineMaxColumn(r)}else l&&!a&&s>=l.start+1&&(l=o._findNextWordOnLine(e,t,new R(r,l.end+1))),l?s=l.start+1:s=t.getLineMaxColumn(r);return new R(r,s)}static _moveWordPartRight(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===i)return n<e.getLineCount()?new R(n+1,1):t;let r=e.getLineContent(n);for(let s=t.column+1;s<i;s++){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a!==95&&l===95)return new R(n,s);if(a!==45&&l===45)return new R(n,s);if((Gd(a)||Pm(a))&&Ps(l))return new R(n,s);if(Ps(a)&&Ps(l)&&s+1<i){let d=r.charCodeAt(s);if(Gd(d)||Pm(d))return new R(n,s)}}return new R(n,i)}static _deleteWordLeftWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-2,r=Zo(n,i);return r+1<i?new w(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(ll.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){let u=e.selection.getPosition();return new w(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}let a=new R(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let u=this._deleteWordLeftWhitespace(i,a);if(u)return u}let c=o._findPreviousWordOnLine(n,i,a);return t===0?c?d=c.start+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=o._findPreviousWordOnLine(n,i,new R(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l))),new w(l,d,a.lineNumber,a.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;let i=new R(n.positionLineNumber,n.positionColumn),r=this._deleteInsideWordWhitespace(t,i);return r||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){let n=e.charCodeAt(t);return n===32||n===9}static _deleteInsideWordWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=n.length;if(i===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,r))return null;let s=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,s))return null;for(;r>0&&this._charAtIsWhitespace(n,r-1);)r--;for(;s+1<i&&this._charAtIsWhitespace(n,s+1);)s++;return new w(t.lineNumber,r+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){let i=t.getLineContent(n.lineNumber),r=i.length;if(r===0)return n.lineNumber>1?new w(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new w(n.lineNumber,1,n.lineNumber+1,1):new w(n.lineNumber,1,n.lineNumber,1);let s=u=>u.start+1<=n.column&&n.column<=u.end+1,a=(u,p)=>(u=Math.min(u,n.column),p=Math.max(p,n.column),new w(n.lineNumber,u,n.lineNumber,p)),l=u=>{let p=u.start+1,m=u.end+1,g=!1;for(;m-1<r&&this._charAtIsWhitespace(i,m-1);)g=!0,m++;if(!g)for(;p>1&&this._charAtIsWhitespace(i,p-2);)p--;return a(p,m)},d=o._findPreviousWordOnLine(e,t,n);if(d&&s(d))return l(d);let c=o._findNextWordOnLine(e,t,n);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartLeft(e,n);return new w(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let r=e.charAt(i);if(r!==" "&&r!=="	")return i}return n}static _deleteWordRightWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-1,r=this._findFirstNonWhitespaceChar(n,i);return i+1<r?new w(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;let a=new R(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column,c=i.getLineCount(),u=i.getLineMaxColumn(l);if(l===c&&d===u)return null;if(s){let m=this._deleteWordRightWhitespace(i,a);if(m)return m}let p=o._findNextWordOnLine(n,i,a);return t===2?p?d=p.end+1:d<u||l===c?d=u:(l++,p=o._findNextWordOnLine(n,i,new R(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l)):(p&&d>=p.start+1&&(p=o._findNextWordOnLine(n,i,new R(l,p.end+1))),p?d=p.start+1:d<u||l===c?d=u:(l++,p=o._findNextWordOnLine(n,i,new R(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l))),new w(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartRight(e,n);return new w(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){let i=new w(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n,i){let r=Us(t,n),s=o._findPreviousWordOnLine(r,e,i);if(s&&s.wordType===1&&s.start<=i.column-1&&i.column-1<=s.end)return o._createWordAtPosition(e,i.lineNumber,s);let a=o._findNextWordOnLine(r,e,i);return a&&a.wordType===1&&a.start<=i.column-1&&i.column-1<=a.end?o._createWordAtPosition(e,i.lineNumber,a):null}static word(e,t,n,i,r){let s=Us(e.wordSeparators,e.wordSegmenterLocales),a=o._findPreviousWordOnLine(s,t,r),l=o._findNextWordOnLine(s,t,r);if(!i){let m,g;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end?(m=a.start+1,g=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end?(m=l.start+1,g=l.end+1):(a?m=a.end+1:m=1,l?g=l.start+1:g=t.getLineMaxColumn(r.lineNumber)),new bn(new w(r.lineNumber,m,r.lineNumber,g),1,0,new R(r.lineNumber,g),0)}let d,c;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(d=l.start+1,c=l.end+1):(d=r.column,c=r.column);let u=r.lineNumber,p;if(n.selectionStart.containsPosition(r))p=n.selectionStart.endColumn;else if(r.isBeforeOrEqual(n.selectionStart.getStartPosition())){p=d;let m=new R(u,p);n.selectionStart.containsPosition(m)&&(p=n.selectionStart.endColumn)}else{p=c;let m=new R(u,p);n.selectionStart.containsPosition(m)&&(p=n.selectionStart.startColumn)}return n.move(!0,u,p,0)}};var Vn=class{static addCursorDown(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new ze(l.modelState,l.viewState),n?i[r++]=ze.fromModelState(Zt.translateDown(e.cursorConfig,e.model,l.modelState)):i[r++]=ze.fromViewState(Zt.translateDown(e.cursorConfig,e,l.viewState))}return i}static addCursorUp(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new ze(l.modelState,l.viewState),n?i[r++]=ze.fromModelState(Zt.translateUp(e.cursorConfig,e.model,l.modelState)):i[r++]=ze.fromViewState(Zt.translateUp(e.cursorConfig,e,l.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=this._moveToLineStart(e,a,n)}return i}static _moveToLineStart(e,t,n){let i=t.viewState.position.column,r=t.modelState.position.column,s=i===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!s&&!(i===l)?this._moveToLineStartByView(e,t,n):this._moveToLineStartByModel(e,t,n)}static _moveToLineStartByView(e,t,n){return ze.fromViewState(Zt.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return ze.fromModelState(Zt.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=this._moveToLineEnd(e,l,n,i)}return r}static _moveToLineEnd(e,t,n,i){let r=t.viewState.position,s=e.getLineMaxColumn(r.lineNumber),a=r.column===s,l=t.modelState.position,d=e.model.getLineMaxColumn(l.lineNumber),c=s-r.column===d-l.column;return a||c?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return ze.fromViewState(Zt.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return ze.fromModelState(Zt.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=s.modelState.selection.startLineNumber,l=e.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=e.model.getLineMaxColumn(l):(d++,c=1),n[i]=ze.fromModelState(new bn(new w(a,1,a,1),0,0,new R(d,c),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=ze.fromModelState(Zt.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=ze.fromModelState(Zt.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static selectAll(e,t){let n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return ze.fromModelState(new bn(new w(1,1,1,1),0,0,new R(n,i),0))}static line(e,t,n,i,r){let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new R(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);if(!n){let d=e.model.getLineCount(),c=s.lineNumber+1,u=1;return c>d&&(c=d,u=e.model.getLineMaxColumn(c)),ze.fromModelState(new bn(new w(s.lineNumber,1,c,u),2,0,new R(c,u),0))}let l=t.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return ze.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=e.getLineCount(),c=a.lineNumber+1,u=1;return c>d&&(c=d,u=e.getLineMaxColumn(c)),ze.fromViewState(t.viewState.move(!0,c,u,0))}else{let d=t.modelState.selectionStart.getEndPosition();return ze.fromModelState(t.modelState.move(!0,d.lineNumber,d.column,0))}}static word(e,t,n,i){let r=e.model.validatePosition(i);return ze.fromModelState(uh.word(e.cursorConfig,e.model,t.modelState,n,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new ze(t.modelState,t.viewState);let n=t.viewState.position.lineNumber,i=t.viewState.position.column;return ze.fromViewState(new bn(new w(n,i,n,i),0,0,new R(n,i),0))}static moveTo(e,t,n,i,r){if(n){if(t.modelState.selectionStartKind===1)return this.word(e,t,n,i);if(t.modelState.selectionStartKind===2)return this.line(e,t,n,i,r)}let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new R(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);return ze.fromViewState(t.viewState.move(n,a.lineNumber,a.column,0))}static simpleMove(e,t,n,i,r,s){switch(n){case Oe.Direction.Left:return s===Oe.Unit.HalfLine?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,r);case Oe.Direction.Right:return s===Oe.Unit.HalfLine?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,r);case Oe.Direction.Up:return s===Oe.Unit.WrappedLine?this._moveUpByViewLines(e,t,i,r):this._moveUpByModelLines(e,t,i,r);case Oe.Direction.Down:return s===Oe.Unit.WrappedLine?this._moveDownByViewLines(e,t,i,r):this._moveDownByModelLines(e,t,i,r);case Oe.Direction.PrevBlankLine:return s===Oe.Unit.WrappedLine?t.map(a=>ze.fromViewState(Zt.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>ze.fromModelState(Zt.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Oe.Direction.NextBlankLine:return s===Oe.Unit.WrappedLine?t.map(a=>ze.fromViewState(Zt.moveToNextBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>ze.fromModelState(Zt.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Oe.Direction.WrappedLineStart:return this._moveToViewMinColumn(e,t,i);case Oe.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case Oe.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(e,t,i);case Oe.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(e,t,i);case Oe.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,r){let s=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(n){case Oe.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Oe.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Oe.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Oe.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=t.length;d<c;d++){let u=t[d];l[d]=this.findPositionInViewportIfOutside(e,u,s,i)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let r=t.viewState.position.lineNumber;if(n.startLineNumber<=r&&r<=n.endLineNumber-1)return new ze(t.modelState,t.viewState);{let s;r>n.endLineNumber-1?s=n.endLineNumber-1:r<n.startLineNumber?s=n.startLineNumber:s=r;let a=Zt.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,s,!1);return ze.fromViewState(t.viewState.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map(r=>ze.fromViewState(Zt.moveLeft(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineLeft(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=ze.fromViewState(Zt.moveLeft(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveRight(e,t,n,i){return t.map(r=>ze.fromViewState(Zt.moveRight(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineRight(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=ze.fromViewState(Zt.moveRight(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveDownByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=ze.fromViewState(Zt.moveDown(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveDownByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=ze.fromModelState(Zt.moveDown(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveUpByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=ze.fromViewState(Zt.moveUp(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveUpByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=ze.fromModelState(Zt.moveUp(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveToViewPosition(e,t,n,i,r){return ze.fromViewState(t.viewState.move(n,i,r,0))}static _moveToModelPosition(e,t,n,i,r){return ze.fromModelState(t.modelState.move(n,i,r,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMinColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineFirstNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMaxColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineLastNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}},Oe;(a=>{let o=function(l){if(!pn(l))return!1;let d=l;return!(!rn(d.to)||!ki(d.select)&&!rv(d.select)||!ki(d.by)&&!rn(d.by)||!ki(d.value)&&!ro(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function i(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=i;let r;(A=>(A[A.Left=0]="Left",A[A.Right=1]="Right",A[A.Up=2]="Up",A[A.Down=3]="Down",A[A.PrevBlankLine=4]="PrevBlankLine",A[A.NextBlankLine=5]="NextBlankLine",A[A.WrappedLineStart=6]="WrappedLineStart",A[A.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",A[A.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",A[A.WrappedLineEnd=9]="WrappedLineEnd",A[A.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",A[A.ViewPortTop=11]="ViewPortTop",A[A.ViewPortCenter=12]="ViewPortCenter",A[A.ViewPortBottom=13]="ViewPortBottom",A[A.ViewPortIfOutside=14]="ViewPortIfOutside"))(r=a.Direction||={});let s;(m=>(m[m.None=0]="None",m[m.Line=1]="Line",m[m.WrappedLine=2]="WrappedLine",m[m.Character=3]="Character",m[m.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(Oe||={});function dz(o,e,t){let n=o.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let i,r=-1;for(i=e-1;i>=1;i--){if(o.tokenization.getLanguageIdAtPosition(i,0)!==n)return r;let s=o.getLineContent(i);if(t.shouldIgnore(i)||/^\s+$/.test(s)||s===""){r=i;continue}return i}}return-1}function wf(o,e,t,n=!0,i){if(o<4)return null;let r=i.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;let s=new VC(e,r,i);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=dz(e,t,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=e.getLineContent(a);return{indentation:Rt(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=e.getLineContent(a);return{indentation:Rt(l),action:null,line:a}}else{if(a===1)return{indentation:Rt(e.getLineContent(a)),action:null,line:a};let l=a-1,d=r.getIndentMetadata(e.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(u)){c=u;break}return{indentation:Rt(e.getLineContent(c+1)),action:null,line:c+1}}if(n)return{indentation:Rt(e.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:Rt(e.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let u=0;for(let p=c-1;p>0;p--)if(!s.shouldIndentNextLine(c)){u=p;break}return{indentation:Rt(e.getLineContent(u+1)),action:null,line:u+1}}else if(s.shouldDecrease(c))return{indentation:Rt(e.getLineContent(c)),action:null,line:c}}return{indentation:Rt(e.getLineContent(1)),action:null,line:1}}}function F2(o,e,t,n,i){if(o<4)return null;let r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=i.getLanguageConfiguration(r).indentRulesSupport;if(!s)return null;e.tokenization.forceTokenization(t.startLineNumber);let l=new jc(e,i).getProcessedTokenContextAroundRange(t),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,u=Rt(c.getLineContent()),p=cz(e,t.startLineNumber,c),m=HC(e,t.getStartPosition()),g=e.getLineContent(t.startLineNumber),f=Rt(g),b=wf(o,p,t.startLineNumber+1,void 0,i);if(!b){let I=m?f:u;return{beforeEnter:I,afterEnter:I}}let v=m?f:b.indentation;return b.action===1&&(v=n.shiftIndent(v)),s.shouldDecrease(d.getLineContent())&&(v=n.unshiftIndent(v)),{beforeEnter:m?f:u,afterEnter:v}}function B2(o,e,t,n,i,r){let s=o.autoIndent;if(s<4||HC(e,t.getStartPosition()))return null;let l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),d=r.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let u=new jc(e,r).getProcessedTokenContextAroundRange(t),p=u.beforeRangeProcessedTokens.getLineContent(),m=u.afterRangeProcessedTokens.getLineContent(),g=p+m,f=p+n+m;if(!d.shouldDecrease(g)&&d.shouldDecrease(f)){let v=wf(s,e,t.startLineNumber,!1,r);if(!v)return null;let I=v.indentation;return v.action!==1&&(I=i.unshiftIndent(I)),I}let b=t.startLineNumber-1;if(b>0){let v=e.getLineContent(b);if(d.shouldIndentNextLine(v)&&d.shouldIncrease(f)){let C=wf(s,e,t.startLineNumber,!1,r)?.indentation;if(C!==void 0){let S=e.getLineContent(t.startLineNumber),E=Rt(S),A=i.shiftIndent(C)===E,F=/^\s*$/.test(g),O=o.autoClosingPairs.autoClosingPairsOpenByEnd.get(n),U=O&&O.length>0&&F;if(A&&U)return C}}}return null}function cz(o,e,t){return{tokenization:{getLineTokens:i=>i===e?t:o.tokenization.getLineTokens(i),getLanguageId:()=>o.getLanguageId(),getLanguageIdAtPosition:(i,r)=>o.getLanguageIdAtPosition(i,r)},getLineContent:i=>i===e?t.getLineContent():o.getLineContent(i)}}var VC=class{_indentRulesSupport;_indentationLineProcessor;constructor(e,t,n){this._indentRulesSupport=t,this._indentationLineProcessor=new UC(e,n)}shouldIncrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(n)}shouldDecrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(n)}shouldIgnore(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(n)}shouldIndentNextLine(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(n)}},jc=class{model;indentationLineProcessor;constructor(e,t){this.model=e,this.indentationLineProcessor=new UC(e,t)}getProcessedTokenContextAroundRange(e){let t=this._getProcessedTokensBeforeRange(e),n=this._getProcessedTokensAfterRange(e),i=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:n,previousLineProcessedTokens:i}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);let t=this.model.tokenization.getLineTokens(e.startLineNumber),n=js(t,e.startColumn-1),i;if(HC(this.model,e.getStartPosition())){let s=e.startColumn-1-n.firstCharOffset,a=n.firstCharOffset,l=a+s;i=t.sliceAndInflate(a,l,0)}else{let s=e.startColumn-1;i=t.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(i)}_getProcessedTokensAfterRange(e){let t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);let n=this.model.tokenization.getLineTokens(t.lineNumber),i=js(n,t.column-1),r=t.column-1-i.firstCharOffset,s=i.firstCharOffset+r,a=i.firstCharOffset+i.getLineLength(),l=n.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){let t=m=>{this.model.tokenization.forceTokenization(m);let g=this.model.tokenization.getLineTokens(m),f=this.model.getLineMaxColumn(m)-1;return js(g,f)};this.model.tokenization.forceTokenization(e.startLineNumber);let n=this.model.tokenization.getLineTokens(e.startLineNumber),i=js(n,e.startColumn-1),r=qt.createEmpty("",i.languageIdCodec),s=e.startLineNumber-1;if(s===0||!(i.firstCharOffset===0))return r;let d=t(s);if(!(i.languageId===d.languageId))return r;let u=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}},UC=class{constructor(e,t){this.model=e;this.languageConfigurationService=t}getProcessedLine(e,t){let n=(s,a)=>{let l=Rt(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(e);let i=this.model.tokenization.getLineTokens(e),r=this.getProcessedTokens(i).getLineContent();return t!==void 0&&(r=n(r,t)),r}getProcessedTokens(e){let t=l=>l===2||l===3||l===1,n=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew.getBracketRegExp({global:!0}),s=[];return e.forEach(l=>{let d=e.getStandardTokenType(l),c=e.getTokenText(l);t(d)&&(c=c.replace(r,""));let u=e.getMetadata(l);s.push({text:c,metadata:u})}),qt.createFromTextAndMetadata(s,e.languageIdCodec)}};function HC(o,e){o.tokenization.forceTokenization(e.lineNumber);let t=o.tokenization.getLineTokens(e.lineNumber),n=js(t,e.column-1),i=n.firstCharOffset===0,r=t.getLanguageId(0)===n.languageId;return!i&&!r}function Ef(o,e,t,n){e.tokenization.forceTokenization(t.startLineNumber);let i=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(i);if(!r)return null;let a=new jc(e,n).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),u=r.onEnter(o,l,d,c);if(!u)return null;let p=u.indentAction,m=u.appendText,g=u.removeText||0;m?p===1&&(m="	"+m):p===1||p===2?m="	":m="";let f=_y(e,t.startLineNumber,t.startColumn);return g&&(f=f.substring(0,f.length-g)),{indentAction:p,appendText:m,removeText:g,indentation:f}}var F0=Object.create(null);function qc(o,e){if(e<=0)return"";F0[o]||(F0[o]=["",o]);let t=F0[o];for(let n=t.length;n<=e;n++)t[n]=t[n-1]+o;return t[e]}var Vo=class{constructor(e,t,n){this._languageConfigurationService=n;this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,n,i,r){let s=St.visibleColumnFromColumn(e,t,n);if(r){let a=qc(" ",i),d=St.prevIndentTabStop(s,i)/i;return qc(a,d)}else{let a="	",d=St.prevRenderTabStop(s,n)/n;return qc(a,d)}}static shiftIndent(e,t,n,i,r){let s=St.visibleColumnFromColumn(e,t,n);if(r){let a=qc(" ",i),d=St.nextIndentTabStop(s,i)/i;return qc(a,d)}else{let a="	",d=St.nextRenderTabStop(s,n)/n;return qc(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(e,t,n){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,n):e.addEditOperation(t,n)}getEditOperations(e,t){let n=this._selection.startLineNumber,i=this._selection.endLineNumber;this._selection.endColumn===1&&n!==i&&(i=i-1);let{tabSize:r,indentSize:s,insertSpaces:a}=this._opts,l=n===i;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let u=n;u<=i;u++,d=c){c=0;let p=e.getLineContent(u),m=$t(p);if(this._opts.isUnshift&&(p.length===0||m===0)||!l&&!this._opts.isUnshift&&p.length===0)continue;if(m===-1&&(m=p.length),u>1&&St.visibleColumnFromColumn(p,m+1,r)%s!==0&&e.tokenization.isCheapToTokenize(u-1)){let b=Ef(this._opts.autoIndent,e,new w(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(b){if(c=d,b.appendText)for(let v=0,I=b.appendText.length;v<I&&c<s&&b.appendText.charCodeAt(v)===32;v++)c++;b.removeText&&(c=Math.max(0,c-b.removeText));for(let v=0;v<c&&!(m===0||p.charCodeAt(m-1)!==32);v++)m--}}if(this._opts.isUnshift&&m===0)continue;let g;this._opts.isUnshift?g=Vo.unshiftIndent(p,m+1,r,s,a):g=Vo.shiftIndent(p,m+1,r,s,a),this._addEditOperation(t,new w(u,1,u,m+1),g),u===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=m+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(n)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?qc(" ",s):"	";for(let c=n;c<=i;c++){let u=e.getLineContent(c),p=$t(u);if(!(this._opts.isUnshift&&(u.length===0||p===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(p===-1&&(p=u.length),!(this._opts.isUnshift&&p===0)))if(this._opts.isUnshift){p=Math.min(p,s);for(let m=0;m<p;m++)if(u.charCodeAt(m)===9){p=m+1;break}this._addEditOperation(t,new w(c,1,c,p+1),"")}else this._addEditOperation(t,new w(c,1,c,1),d),c===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let i=t.getInverseEditOperations()[0];return new De(i.range.endLineNumber,i.range.endColumn,i.range.endLineNumber,i.range.endColumn)}let n=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let i=this._selection.startColumn;return n.startColumn<=i?n:n.getDirection()===0?new De(n.startLineNumber,i,n.endLineNumber,n.endColumn):new De(n.endLineNumber,n.endColumn,n.startLineNumber,i)}return n}};Vo=K([D(2,Fn)],Vo);var zC=class{_range;_charBeforeSelection;_charAfterSelection;constructor(e,t,n){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=n}getEditOperations(e,t){t.addTrackedEditOperation(new w(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new w(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let n=t.getInverseEditOperations(),i=n[0].range,r=n[1].range;return new De(i.endLineNumber,i.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}},KC=class{constructor(e,t,n){this._position=e;this._text=t;this._charAfter=n}getEditOperations(e,t){t.addTrackedEditOperation(new w(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return new De(i.endLineNumber,i.startColumn,i.endLineNumber,i.endColumn-this._charAfter.length)}};var GC=class{static getEdits(e,t,n,i,r){if(!r&&this._isAutoIndentType(e,t,n)){let s=[];for(let l of n){let d=this._findActualIndentationForSelection(e,t,l,i);if(d===null)return;s.push({selection:l,indentation:d})}let a=ph.getAutoClosingPairClose(e,t,n,i,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,s,i,a)}}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let i=0,r=n.length;i<r;i++)if(!t.tokenization.isCheapToTokenize(n[i].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,n,i){let r=B2(e,t,n,i,{shiftIndent:a=>Tf(e,a),unshiftIndent:a=>gh(e,a)},e.languageConfigurationService);if(r===null)return null;let s=_y(t,n.startLineNumber,n.startColumn);return r===e.normalizeIndentation(s)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,n,i,r){let s=n.map(({selection:l,indentation:d})=>{if(r!==null){let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!1);return new W0(c,l,i,r)}else{let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!0);return Yc(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new Rn(4,s,a)}static _getEditFromIndentationAndSelection(e,t,n,i,r,s=!0){let a=i.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a),d=e.normalizeIndentation(n);if(l!==0){let u=t.getLineContent(a);d+=u.substring(l-1,i.startColumn-1)}return d+=s?r:"",{range:new w(a,1,i.endLineNumber,i.endColumn),text:d}}},$C=class{static getEdits(e,t,n,i,r,s){if(H2(t,n,i,r,s))return this._runAutoClosingOvertype(e,i,s)}static _runAutoClosingOvertype(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let l=t[r].getPosition(),d=new w(l.lineNumber,l.column,l.lineNumber,l.column+1);i[r]=new ci(d,n)}return new Rn(4,i,{shouldPushStackElementBefore:tS(e,4),shouldPushStackElementAfter:!1})}},jC=class{static getEdits(e,t,n,i,r){if(H2(e,t,n,i,r)){let s=n.map(a=>new ci(new w(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new Rn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},ph=class{static getEdits(e,t,n,i,r,s){if(!s){let a=this.getAutoClosingPairClose(e,t,n,i,r);if(a!==null)return this._runAutoClosingOpenCharType(n,i,r,a)}}static _runAutoClosingOpenCharType(e,t,n,i){let r=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];r[s]=new B0(l,t,!n,i)}return new Rn(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,n,i,r){for(let g of n)if(!g.isEmpty())return null;let s=n.map(g=>{let f=g.getPosition();return r?{lineNumber:f.lineNumber,beforeColumn:f.column-i.length,afterColumn:f.column}:{lineNumber:f.lineNumber,beforeColumn:f.column,afterColumn:f.column}}),a=this._findAutoClosingPairOpen(e,t,s.map(g=>new R(g.lineNumber,g.beforeColumn)),i);if(!a)return null;let l,d;if(us(i)?(l=e.autoClosingQuotes,d=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,d=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,d=e.shouldAutoCloseBefore.bracket),l==="never")return null;let u=this._findContainedAutoClosingPair(e,a),p=u?u.close:"",m=!0;for(let g of s){let{lineNumber:f,beforeColumn:b,afterColumn:v}=g,I=t.getLineContent(f),C=I.substring(0,b-1),S=I.substring(v-1);if(S.startsWith(p)||(m=!1),S.length>0){let F=S.charAt(0);if(!this._isBeforeClosingBrace(e,S)&&!d(F))return null}if(a.open.length===1&&(i==="'"||i==='"')&&l!=="always"){let F=Us(e.wordSeparators,[]);if(C.length>0){let O=C.charCodeAt(C.length-1);if(F.get(O)===0)return null}}if(!t.tokenization.isCheapToTokenize(f))return null;t.tokenization.forceTokenization(f);let E=t.tokenization.getLineTokens(f),M=js(E,b-1);if(!a.shouldAutoClose(M,b-M.firstCharOffset))return null;let A=a.findNeutralCharacter();if(A){let F=t.tokenization.getTokenTypeIfInsertingCharacter(f,b,A);if(!a.isOK(F))return null}}return m?a.close.substring(0,a.close.length-p.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;let n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[],r=null;for(let s of i)s.open!==t.open&&t.open.includes(s.open)&&t.close.endsWith(s.close)&&(!r||s.open.length>r.open.length)&&(r=s);return r}static _findAutoClosingPairOpen(e,t,n,i){let r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!r)return null;let s=null;for(let a of r)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of n)if(t.getValueInRange(new w(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+i!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(e,t){let n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],s=i.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!s&&a}},qC=class{static getEdits(e,t,n,i,r){if(!r&&this._isSurroundSelectionType(e,t,n,i))return this._runSurroundSelectionType(e,n,i)}static _runSurroundSelectionType(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=e.surroundingPairs[n];i[r]=new zC(a,n,l)}return new Rn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,n,i){if(!H0(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;let r=us(i);for(let s of n){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=t.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,u=l===s.endLineNumber?s.endColumn-1:d.length,p=d.substring(c,u);if(/[^ \t]/.test(p)){a=!1;break}}if(a)return!1;if(r&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=t.getValueInRange(s);if(us(l))return!1}}return!0}},YC=class{static getEdits(e,t,n,i,r,s){if(!s&&this._isTypeInterceptorElectricChar(t,n,i)){let a=this._typeInterceptorElectricChar(e,t,n,i[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,n){return!!(n.length===1&&t.tokenization.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,i,r){if(!t.electricChars.hasOwnProperty(r)||!i.isEmpty())return null;let s=i.getPosition();n.tokenization.forceTokenization(s.lineNumber);let a=n.tokenization.getLineTokens(s.lineNumber),l;try{l=t.onElectricCharacter(r,a,s.column)}catch(d){return Ue(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,c=n.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let u=n.getLineContent(c.startLineNumber),p=Rt(u),m=t.normalizeIndentation(p),g=n.getLineContent(s.lineNumber),f=n.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,b=g.substring(f-1,s.column-1),v=m+b+r,I=new w(s.lineNumber,1,s.lineNumber,s.column),C=new ci(I,v);return new Rn(V0(v,e),[C],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},QC=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new ci(t[s],n);let r=V0(n,e);return new Rn(r,i,{shouldPushStackElementBefore:tS(e,r),shouldPushStackElementAfter:!1})}},hh=class{static getEdits(e,t,n,i,r){if(!r&&i===`
`){let s=[];for(let a=0,l=n.length;a<l;a++)s[a]=this._enter(e,t,!1,n[a]);return new Rn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,n,i){if(e.autoIndent===0)return Yc(i,`
`,n);if(!t.tokenization.isCheapToTokenize(i.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(i.startLineNumber),d=Rt(l).substring(0,i.startColumn-1);return Yc(i,`
`+e.normalizeIndentation(d),n)}let r=Ef(e.autoIndent,t,i,e.languageConfigurationService);if(r){if(r.indentAction===0)return Yc(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===1)return Yc(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===2){let l=e.normalizeIndentation(r.indentation),d=e.normalizeIndentation(r.indentation+r.appendText),c=`
`+d+`
`+l;return n?new Kc(i,c,!0):new Gc(i,c,-1,d.length-l.length,!0)}else if(r.indentAction===3){let l=gh(e,r.indentation);return Yc(i,`
`+e.normalizeIndentation(l+r.appendText),n)}}let s=t.getLineContent(i.startLineNumber),a=Rt(s).substring(0,i.startColumn-1);if(e.autoIndent>=4){let l=F2(e.autoIndent,t,i,{unshiftIndent:d=>gh(e,d),shiftIndent:d=>Tf(e,d),normalizeIndentation:d=>e.normalizeIndentation(d)},e.languageConfigurationService);if(l){let d=e.visibleColumnFromColumn(t,i.getEndPosition()),c=i.endColumn,u=t.getLineContent(i.endLineNumber),p=$t(u);if(p>=0?i=i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,p+1)):i=i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new Kc(i,`
`+e.normalizeIndentation(l.afterEnter),!0);{let m=0;return c<=p+1&&(e.insertSpaces||(d=Math.ceil(d/e.indentSize)),m=Math.min(d+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new Gc(i,`
`+e.normalizeIndentation(l.afterEnter),0,m,!0)}}}return Yc(i,`
`+e.normalizeIndentation(a),n)}static lineInsertBefore(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber;if(a===1)i[r]=new Kc(new w(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new w(a,l,a,l))}}return i}static lineInsertAfter(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber,l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new w(a,l,a,l))}return i}static lineBreakInsert(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=this._enter(e,t,!0,n[r]);return i}},ZC=class{static getEdits(e,t,n,i,r,s){let a=this._distributePasteToCursors(e,n,i,r,s);return a?(n=n.sort(w.compareRangesUsingStarts),this._distributedPaste(e,t,n,a)):this._simplePaste(e,t,n,i,r)}static _distributePasteToCursors(e,t,n,i,r){if(i||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){n.charCodeAt(n.length-1)===10&&(n=n.substring(0,n.length-1)),n.charCodeAt(n.length-1)===13&&(n=n.substring(0,n.length-1));let s=Fr(n);if(s.length===t.length)return s}return null}static _distributedPaste(e,t,n,i){let r=[];for(let s=0,a=n.length;s<a;s++)r[s]=new ci(n[s],i[s]);return new Rn(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,r){let s=[];for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.getPosition();if(r&&!d.isEmpty()&&(r=!1),r&&i.indexOf(`
`)!==i.length-1&&(r=!1),r){let u=new w(c.lineNumber,1,c.lineNumber,1);s[a]=new BC(u,i,d,!0)}else s[a]=new ci(d,i)}return new Rn(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},XC=class{static getEdits(e,t,n,i,r,s,a,l){let d=i.map(c=>this._compositionType(n,c,r,s,a,l));return new Rn(4,d,{shouldPushStackElementBefore:tS(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,r,s){if(!t.isEmpty())return null;let a=t.getPosition(),l=Math.max(1,a.column-i),d=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),c=new w(a.lineNumber,l,a.lineNumber,d);return e.getValueInRange(c)===n&&s===0?null:new Gc(c,n,0,s)}},JC=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new ci(t[s],n);let r=V0(n,e);return new Rn(r,i,{shouldPushStackElementBefore:tS(e,r),shouldPushStackElementAfter:!1})}},eS=class{static getCommands(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(e,t,a.startLineNumber);d=d||"	";let c=e.normalizeIndentation(d);if(!l.startsWith(c)){i[r]=new ci(new w(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}i[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){i[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}i[r]=new Vo(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return i}static _goodIndentForLine(e,t,n){let i=null,r="",s=wf(e.autoIndent,t,n,!1,e.languageConfigurationService);if(s)i=s.action,r=s.indentation;else if(n>1){let a;for(a=n-1;a>=1;a--){let c=t.getLineContent(a);if(Zo(c)>=0)break}if(a<1)return null;let l=t.getLineMaxColumn(a),d=Ef(e.autoIndent,t,new w(a,l,a,l),e.languageConfigurationService);d&&(r=d.indentation+d.appendText)}return i&&(i===1&&(r=Tf(e,r)),i===3&&(r=gh(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,n,i){let r="",s=n.getStartPosition();if(e.insertSpaces){let a=e.visibleColumnFromColumn(t,s),l=e.indentSize,d=l-a%l;for(let c=0;c<d;c++)r+=" "}else r="	";return new ci(n,r,i)}},mh=class extends Gc{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(e,t,n,i,r,s){super(e,t,n,i),this._openCharacter=r,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,n){return this.closeCharacterRange=new w(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new w(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,n)}},B0=class extends mh{constructor(e,t,n,i){let r=(n?t:"")+i,s=0,a=-i.length;super(e,r,s,a,t,i)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,i,t)}},W0=class extends mh{_autoIndentationEdit;_autoClosingEdit;constructor(e,t,n,i){let r=n+i,s=0,a=n.length;super(t,r,s,a,n,i),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){let n=t.getInverseEditOperations();if(n.length!==2)throw new Error("There should be two inverse edit operations!");let i=n[0].range,r=n[1].range,s=i.plusRange(r);return this._computeCursorStateWithRange(e,s,t)}};function V0(o,e){return o===" "?e===5||e===6?6:5:4}function tS(o,e){return V2(o)&&!V2(e)?!0:o===5?!1:W2(o)!==W2(e)}function W2(o){return o===6||o===5?"space":o}function V2(o){return o===4||o===5||o===6}function H2(o,e,t,n,i){if(o.autoClosingOvertype==="never"||!o.autoClosingPairs.autoClosingPairsCloseSingleChar.has(i))return!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(!a.isEmpty())return!1;let l=a.getPosition(),d=e.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==i)return!1;let u=us(i);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&u)return!1;if(o.autoClosingOvertype==="auto"){let m=!1;for(let g=0,f=n.length;g<f;g++){let b=n[g];if(l.lineNumber===b.startLineNumber&&l.column===b.startColumn){m=!0;break}}if(!m)return!1}}return!0}function Yc(o,e,t){return t?new Kc(o,e,!0):new ci(o,e,!0)}function Tf(o,e,t){return t=t||1,Vo.shiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function gh(o,e,t){return t=t||1,Vo.unshiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function H0(o,e){return us(e)?o.autoSurround==="quotes"||o.autoSurround==="languageDefined":o.autoSurround==="brackets"||o.autoSurround==="languageDefined"}var hs=class{static indent(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new Vo(n[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static outdent(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new Vo(n[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static shiftIndent(e,t,n){return Tf(e,t,n)}static unshiftIndent(e,t,n){return gh(e,t,n)}static paste(e,t,n,i,r,s){return ZC.getEdits(e,t,n,i,r,s)}static tab(e,t,n){return eS.getCommands(e,t,n)}static compositionType(e,t,n,i,r,s,a,l){return XC.getEdits(e,t,n,i,r,s,a,l)}static compositionEndWithInterceptors(e,t,n,i,r,s){if(!i)return null;let a=null;for(let p of i)if(a===null)a=p.insertedText;else if(a!==p.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let p of i)if(p.deletedText.length!==0){d=!0;break}if(d){if(!H0(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;let p=us(l);for(let f of i)if(f.deletedSelectionStart!==0||f.deletedSelectionEnd!==f.deletedText.length||/^[ \t]+$/.test(f.deletedText)||p&&us(f.deletedText))return null;let m=[];for(let f of r){if(!f.isEmpty())return null;m.push(f.getPosition())}if(m.length!==i.length)return null;let g=[];for(let f=0,b=m.length;f<b;f++)g.push(new KC(m[f],i[f].deletedText,t.surroundingPairs[l]));return new Rn(4,g,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=jC.getEdits(t,n,r,s,l);if(c!==void 0)return c;let u=ph.getEdits(t,n,r,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(e,t,n,i,r,s,a){let l=hh.getEdits(n,i,r,a,e);if(l!==void 0)return l;let d=GC.getEdits(n,i,r,a,e);if(d!==void 0)return d;let c=$C.getEdits(t,n,i,r,s,a);if(c!==void 0)return c;let u=ph.getEdits(n,i,r,a,!1,e);if(u!==void 0)return u;let p=qC.getEdits(n,i,r,a,e);if(p!==void 0)return p;let m=YC.getEdits(t,n,i,r,a,e);return m!==void 0?m:QC.getEdits(t,r,a)}static typeWithoutInterceptors(e,t,n,i,r){return JC.getEdits(e,i,r)}},nS=class{constructor(e,t,n,i,r,s){this.deletedText=e;this.deletedSelectionStart=t;this.deletedSelectionEnd=n;this.insertedText=i;this.insertedSelectionStart=r;this.insertedSelectionEnd=s}};var oe;(Ae=>(Ae.editorSimpleInput=new ce("editorSimpleInput",!1,!0),Ae.editorTextFocus=new ce("editorTextFocus",!1,h("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),Ae.focus=new ce("editorFocus",!1,h("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),Ae.textInputFocus=new ce("textInputFocus",!1,h("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),Ae.readOnly=new ce("editorReadonly",!1,h("editorReadonly","Whether the editor is read-only")),Ae.inDiffEditor=new ce("inDiffEditor",!1,h("inDiffEditor","Whether the context is a diff editor")),Ae.isEmbeddedDiffEditor=new ce("isEmbeddedDiffEditor",!1,h("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),Ae.multiDiffEditorAllCollapsed=new ce("multiDiffEditorAllCollapsed",void 0,h("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),Ae.hasChanges=new ce("diffEditorHasChanges",!1,h("diffEditorHasChanges","Whether the diff editor has changes")),Ae.comparingMovedCode=new ce("comparingMovedCode",!1,h("comparingMovedCode","Whether a moved code block is selected for comparison")),Ae.accessibleDiffViewerVisible=new ce("accessibleDiffViewerVisible",!1,h("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),Ae.diffEditorRenderSideBySideInlineBreakpointReached=new ce("diffEditorRenderSideBySideInlineBreakpointReached",!1,h("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),Ae.diffEditorInlineMode=new ce("diffEditorInlineMode",!1,h("diffEditorInlineMode","Whether inline mode is active")),Ae.diffEditorOriginalWritable=new ce("diffEditorOriginalWritable",!1,h("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),Ae.diffEditorModifiedWritable=new ce("diffEditorModifiedWritable",!1,h("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),Ae.diffEditorOriginalUri=new ce("diffEditorOriginalUri","",h("diffEditorOriginalUri","The uri of the original document")),Ae.diffEditorModifiedUri=new ce("diffEditorModifiedUri","",h("diffEditorModifiedUri","The uri of the modified document")),Ae.columnSelection=new ce("editorColumnSelection",!1,h("editorColumnSelection","Whether `editor.columnSelection` is enabled")),Ae.writable=Ae.readOnly.toNegated(),Ae.hasNonEmptySelection=new ce("editorHasSelection",!1,h("editorHasSelection","Whether the editor has text selected")),Ae.hasOnlyEmptySelection=Ae.hasNonEmptySelection.toNegated(),Ae.hasMultipleSelections=new ce("editorHasMultipleSelections",!1,h("editorHasMultipleSelections","Whether the editor has multiple selections")),Ae.hasSingleSelection=Ae.hasMultipleSelections.toNegated(),Ae.tabMovesFocus=new ce("editorTabMovesFocus",!1,h("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),Ae.tabDoesNotMoveFocus=Ae.tabMovesFocus.toNegated(),Ae.isInEmbeddedEditor=new ce("isInEmbeddedEditor",!1,!0),Ae.canUndo=new ce("canUndo",!1,!0),Ae.canRedo=new ce("canRedo",!1,!0),Ae.hoverVisible=new ce("editorHoverVisible",!1,h("editorHoverVisible","Whether the editor hover is visible")),Ae.hoverFocused=new ce("editorHoverFocused",!1,h("editorHoverFocused","Whether the editor hover is focused")),Ae.stickyScrollFocused=new ce("stickyScrollFocused",!1,h("stickyScrollFocused","Whether the sticky scroll is focused")),Ae.stickyScrollVisible=new ce("stickyScrollVisible",!1,h("stickyScrollVisible","Whether the sticky scroll is visible")),Ae.standaloneColorPickerVisible=new ce("standaloneColorPickerVisible",!1,h("standaloneColorPickerVisible","Whether the standalone color picker is visible")),Ae.standaloneColorPickerFocused=new ce("standaloneColorPickerFocused",!1,h("standaloneColorPickerFocused","Whether the standalone color picker is focused")),Ae.inCompositeEditor=new ce("inCompositeEditor",void 0,h("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),Ae.notInCompositeEditor=Ae.inCompositeEditor.toNegated(),Ae.languageId=new ce("editorLangId","",h("editorLangId","The language identifier of the editor")),Ae.hasCompletionItemProvider=new ce("editorHasCompletionItemProvider",!1,h("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),Ae.hasCodeActionsProvider=new ce("editorHasCodeActionsProvider",!1,h("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),Ae.hasCodeLensProvider=new ce("editorHasCodeLensProvider",!1,h("editorHasCodeLensProvider","Whether the editor has a code lens provider")),Ae.hasDefinitionProvider=new ce("editorHasDefinitionProvider",!1,h("editorHasDefinitionProvider","Whether the editor has a definition provider")),Ae.hasDeclarationProvider=new ce("editorHasDeclarationProvider",!1,h("editorHasDeclarationProvider","Whether the editor has a declaration provider")),Ae.hasImplementationProvider=new ce("editorHasImplementationProvider",!1,h("editorHasImplementationProvider","Whether the editor has an implementation provider")),Ae.hasTypeDefinitionProvider=new ce("editorHasTypeDefinitionProvider",!1,h("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),Ae.hasHoverProvider=new ce("editorHasHoverProvider",!1,h("editorHasHoverProvider","Whether the editor has a hover provider")),Ae.hasDocumentHighlightProvider=new ce("editorHasDocumentHighlightProvider",!1,h("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),Ae.hasDocumentSymbolProvider=new ce("editorHasDocumentSymbolProvider",!1,h("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),Ae.hasReferenceProvider=new ce("editorHasReferenceProvider",!1,h("editorHasReferenceProvider","Whether the editor has a reference provider")),Ae.hasRenameProvider=new ce("editorHasRenameProvider",!1,h("editorHasRenameProvider","Whether the editor has a rename provider")),Ae.hasSignatureHelpProvider=new ce("editorHasSignatureHelpProvider",!1,h("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),Ae.hasInlayHintsProvider=new ce("editorHasInlayHintsProvider",!1,h("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),Ae.hasDocumentFormattingProvider=new ce("editorHasDocumentFormattingProvider",!1,h("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),Ae.hasDocumentSelectionFormattingProvider=new ce("editorHasDocumentSelectionFormattingProvider",!1,h("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),Ae.hasMultipleDocumentFormattingProvider=new ce("editorHasMultipleDocumentFormattingProvider",!1,h("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),Ae.hasMultipleDocumentSelectionFormattingProvider=new ce("editorHasMultipleDocumentSelectionFormattingProvider",!1,h("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(oe||={});var nt=0,Wt=class extends ca{runEditorCommand(e,t,n){let i=t._getViewModel();i&&this.runCoreEditorCommand(i,n||{})}},ui;(a=>{let o=function(l){if(!pn(l))return!1;let d=l;return!(!rn(d.to)||!ki(d.by)&&!rn(d.by)||!ki(d.value)&&!ro(d.value)||!ki(d.revealCursor)&&!rv(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function i(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let u=Math.floor(l.value||1),p=!!l.revealCursor;return{direction:d,unit:c,value:u,revealCursor:p,select:!!l.select}}a.parse=i;let r;(p=>(p[p.Up=1]="Up",p[p.Right=2]="Right",p[p.Down=3]="Down",p[p.Left=4]="Left"))(r=a.Direction||={});let s;(g=>(g[g.Line=1]="Line",g[g.WrappedLine=2]="WrappedLine",g[g.Page=3]="Page",g[g.HalfPage=4]="HalfPage",g[g.Editor=5]="Editor",g[g.Column=6]="Column"))(s=a.Unit||={})})(ui||={});var Lf;(n=>{let o=function(i){if(!pn(i))return!1;let r=i;return!(!ro(r.lineNumber)&&!rn(r.lineNumber)||!ki(r.at)&&!rn(r.at))};n.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:o,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(Lf||={});var kf=class{constructor(e){e.addImplementation(1e4,"code-editor",(t,n)=>{let i=t.get(wr).getFocusedCodeEditor();return i&&i.hasTextFocus()?this._runEditorCommand(t,i,n):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,n)=>{let i=bo();return i&&la(i)?(this.runDOMCommand(i),!0):!1}),e.addImplementation(0,"generic-dom",(t,n)=>{let i=t.get(wr).getActiveCodeEditor();return i?(i.focus(),this._runEditorCommand(t,i,n)):!1})}_runEditorCommand(e,t,n){let i=this.runEditorCommand(e,t,n);return i||!0}};var Mn;(he=>{class o extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){if(!J.position)return;P.model.pushStackElement(),P.setCursorStates(J.source,3,[Vn.moveTo(P,P.getPrimaryCursorState(),this._inSelectionMode,J.position,J.viewPosition)])&&J.revealType!==2&&P.revealAllCursors(J.source,!0,!0)}}he.MoveTo=ye(new o({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),he.MoveToSelect=ye(new o({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class n extends Wt{runCoreEditorCommand(P,J){P.model.pushStackElement();let ue=this._getColumnSelectResult(P,P.getPrimaryCursorState(),P.getCursorColumnSelectData(),J);ue!==null&&(P.setCursorStates(J.source,3,ue.viewStates.map(Ye=>ze.fromViewState(Ye))),P.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:ue.fromLineNumber,fromViewVisualColumn:ue.fromVisualColumn,toViewLineNumber:ue.toLineNumber,toViewVisualColumn:ue.toVisualColumn}),ue.reversed?P.revealTopMostCursor(J.source):P.revealBottomMostCursor(J.source))}}he.ColumnSelect=ye(new class extends n{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(se,P,J,ue){if(typeof ue.position>"u"||typeof ue.viewPosition>"u"||typeof ue.mouseColumn>"u")return null;let Ye=se.model.validatePosition(ue.position),yt=se.coordinatesConverter.validateViewPosition(new R(ue.viewPosition.lineNumber,ue.viewPosition.column),Ye),Kn=ue.doColumnSelect?J.fromViewLineNumber:yt.lineNumber,vi=ue.doColumnSelect?J.fromViewVisualColumn:ue.mouseColumn-1;return fd.columnSelect(se.cursorConfig,se,Kn,vi,yt.lineNumber,ue.mouseColumn-1)}}),he.CursorColumnSelectLeft=ye(new class extends n{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(se,P,J,ue){return fd.columnSelectLeft(se.cursorConfig,se,J)}}),he.CursorColumnSelectRight=ye(new class extends n{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(se,P,J,ue){return fd.columnSelectRight(se.cursorConfig,se,J)}});class a extends n{_isPaged;constructor(P){super(P),this._isPaged=P.isPaged}_getColumnSelectResult(P,J,ue,Ye){return fd.columnSelectUp(P.cursorConfig,P,ue,this._isPaged)}}he.CursorColumnSelectUp=ye(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:3600,linux:{primary:0}}})),he.CursorColumnSelectPageUp=ye(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends n{_isPaged;constructor(P){super(P),this._isPaged=P.isPaged}_getColumnSelectResult(P,J,ue,Ye){return fd.columnSelectDown(P.cursorConfig,P,ue,this._isPaged)}}he.CursorColumnSelectDown=ye(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:3602,linux:{primary:0}}})),he.CursorColumnSelectPageDown=ye(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:3596,linux:{primary:0}}}));class m extends Wt{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Oe.metadata})}runCoreEditorCommand(P,J){let ue=Oe.parse(J);ue&&this._runCursorMove(P,J.source,ue)}_runCursorMove(P,J,ue){P.model.pushStackElement(),P.setCursorStates(J,3,m._move(P,P.getCursorStates(),ue)),P.revealAllCursors(J,!0)}static _move(P,J,ue){let Ye=ue.select,yt=ue.value;switch(ue.direction){case Oe.Direction.Left:case Oe.Direction.Right:case Oe.Direction.Up:case Oe.Direction.Down:case Oe.Direction.PrevBlankLine:case Oe.Direction.NextBlankLine:case Oe.Direction.WrappedLineStart:case Oe.Direction.WrappedLineFirstNonWhitespaceCharacter:case Oe.Direction.WrappedLineColumnCenter:case Oe.Direction.WrappedLineEnd:case Oe.Direction.WrappedLineLastNonWhitespaceCharacter:return Vn.simpleMove(P,J,ue.direction,Ye,yt,ue.unit);case Oe.Direction.ViewPortTop:case Oe.Direction.ViewPortBottom:case Oe.Direction.ViewPortCenter:case Oe.Direction.ViewPortIfOutside:return Vn.viewportMove(P,J,ue.direction,Ye,yt);default:return null}}}he.CursorMoveImpl=m,he.CursorMove=ye(new m);let f;(P=>P[P.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(f||={});class b extends Wt{_staticArgs;constructor(P){super(P),this._staticArgs=P.args}runCoreEditorCommand(P,J){let ue=this._staticArgs;this._staticArgs.value===-1&&(ue={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:J.pageSize||P.cursorConfig.pageSize}),P.model.pushStackElement(),P.setCursorStates(J.source,3,Vn.simpleMove(P,P.getCursorStates(),ue.direction,ue.select,ue.value,ue.unit)),P.revealAllCursors(J.source,!0)}}he.CursorLeft=ye(new b({args:{direction:Oe.Direction.Left,unit:Oe.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),he.CursorLeftSelect=ye(new b({args:{direction:Oe.Direction.Left,unit:Oe.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:1039}})),he.CursorRight=ye(new b({args:{direction:Oe.Direction.Right,unit:Oe.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),he.CursorRightSelect=ye(new b({args:{direction:Oe.Direction.Right,unit:Oe.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:1041}})),he.CursorUp=ye(new b({args:{direction:Oe.Direction.Up,unit:Oe.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),he.CursorUpSelect=ye(new b({args:{direction:Oe.Direction.Up,unit:Oe.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),he.CursorPageUp=ye(new b({args:{direction:Oe.Direction.Up,unit:Oe.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:11}})),he.CursorPageUpSelect=ye(new b({args:{direction:Oe.Direction.Up,unit:Oe.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:1035}})),he.CursorDown=ye(new b({args:{direction:Oe.Direction.Down,unit:Oe.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),he.CursorDownSelect=ye(new b({args:{direction:Oe.Direction.Down,unit:Oe.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),he.CursorPageDown=ye(new b({args:{direction:Oe.Direction.Down,unit:Oe.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:12}})),he.CursorPageDownSelect=ye(new b({args:{direction:Oe.Direction.Down,unit:Oe.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:1036}})),he.CreateCursor=ye(new class extends Wt{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(se,P){if(!P.position)return;let J;P.wholeLine?J=Vn.line(se,se.getPrimaryCursorState(),!1,P.position,P.viewPosition):J=Vn.moveTo(se,se.getPrimaryCursorState(),!1,P.position,P.viewPosition);let ue=se.getCursorStates();if(ue.length>1){let Ye=J.modelState?J.modelState.position:null,yt=J.viewState?J.viewState.position:null;for(let Kn=0,vi=ue.length;Kn<vi;Kn++){let Fe=ue[Kn];if(!(Ye&&!Fe.modelState.selection.containsPosition(Ye))&&!(yt&&!Fe.viewState.selection.containsPosition(yt))){ue.splice(Kn,1),se.model.pushStackElement(),se.setCursorStates(P.source,3,ue);return}}}ue.push(J),se.model.pushStackElement(),se.setCursorStates(P.source,3,ue)}}),he.LastCursorMoveToSelect=ye(new class extends Wt{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(se,P){if(!P.position)return;let J=se.getLastAddedCursorIndex(),ue=se.getCursorStates(),Ye=ue.slice(0);Ye[J]=Vn.moveTo(se,ue[J],!0,P.position,P.viewPosition),se.model.pushStackElement(),se.setCursorStates(P.source,3,Ye)}});class ee extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){P.model.pushStackElement(),P.setCursorStates(J.source,3,Vn.moveToBeginningOfLine(P,P.getCursorStates(),this._inSelectionMode)),P.revealAllCursors(J.source,!0)}}he.CursorHome=ye(new ee({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),he.CursorHomeSelect=ye(new ee({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class ne extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){P.model.pushStackElement(),P.setCursorStates(J.source,3,this._exec(P.getCursorStates())),P.revealAllCursors(J.source,!0)}_exec(P){let J=[];for(let ue=0,Ye=P.length;ue<Ye;ue++){let yt=P[ue],Kn=yt.modelState.position.lineNumber;J[ue]=ze.fromModelState(yt.modelState.move(this._inSelectionMode,Kn,1,0))}return J}}he.CursorLineStart=ye(new ne({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:0,mac:{primary:287}}})),he.CursorLineStartSelect=ye(new ne({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:0,mac:{primary:1311}}}));class xe extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){P.model.pushStackElement(),P.setCursorStates(J.source,3,Vn.moveToEndOfLine(P,P.getCursorStates(),this._inSelectionMode,J.sticky||!1)),P.revealAllCursors(J.source,!0)}}he.CursorEnd=ye(new xe({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:nt,kbExpr:oe.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:h("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),he.CursorEndSelect=ye(new xe({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:nt,kbExpr:oe.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:h("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class ke extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){P.model.pushStackElement(),P.setCursorStates(J.source,3,this._exec(P,P.getCursorStates())),P.revealAllCursors(J.source,!0)}_exec(P,J){let ue=[];for(let Ye=0,yt=J.length;Ye<yt;Ye++){let Kn=J[Ye],vi=Kn.modelState.position.lineNumber,Fe=P.model.getLineMaxColumn(vi);ue[Ye]=ze.fromModelState(Kn.modelState.move(this._inSelectionMode,vi,Fe,0))}return ue}}he.CursorLineEnd=ye(new ke({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:0,mac:{primary:291}}})),he.CursorLineEndSelect=ye(new ke({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:0,mac:{primary:1315}}}));class eo extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){P.model.pushStackElement(),P.setCursorStates(J.source,3,Vn.moveToBeginningOfBuffer(P,P.getCursorStates(),this._inSelectionMode)),P.revealAllCursors(J.source,!0)}}he.CursorTop=ye(new eo({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:2062,mac:{primary:2064}}})),he.CursorTopSelect=ye(new eo({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:3086,mac:{primary:3088}}}));class fi extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){P.model.pushStackElement(),P.setCursorStates(J.source,3,Vn.moveToEndOfBuffer(P,P.getCursorStates(),this._inSelectionMode)),P.revealAllCursors(J.source,!0)}}he.CursorBottom=ye(new fi({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:2061,mac:{primary:2066}}})),he.CursorBottomSelect=ye(new fi({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:3085,mac:{primary:3090}}}));class Il extends Wt{constructor(){super({id:"editorScroll",precondition:void 0,metadata:ui.metadata})}determineScrollMethod(P){let J=[6],ue=[1,2,3,4,5,6],Ye=[4,2],yt=[1,3];return J.includes(P.unit)&&Ye.includes(P.direction)?this._runHorizontalEditorScroll.bind(this):ue.includes(P.unit)&&yt.includes(P.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(P,J){let ue=ui.parse(J);if(!ue)return;let Ye=this.determineScrollMethod(ue);Ye&&Ye(P,J.source,ue)}_runVerticalEditorScroll(P,J,ue){let Ye=this._computeDesiredScrollTop(P,ue);if(ue.revealCursor){let yt=P.getCompletelyVisibleViewRangeAtScrollTop(Ye);P.setCursorStates(J,3,[Vn.findPositionInViewportIfOutside(P,P.getPrimaryCursorState(),yt,ue.select)])}P.viewLayout.setScrollPosition({scrollTop:Ye},0)}_computeDesiredScrollTop(P,J){if(J.unit===1){let yt=P.viewLayout.getFutureViewport(),Kn=P.getCompletelyVisibleViewRangeAtScrollTop(yt.top),vi=P.coordinatesConverter.convertViewRangeToModelRange(Kn),Fe;J.direction===1?Fe=Math.max(1,vi.startLineNumber-J.value):Fe=Math.min(P.model.getLineCount(),vi.startLineNumber+J.value);let _=P.coordinatesConverter.convertModelPositionToViewPosition(new R(Fe,1));return P.viewLayout.getVerticalOffsetForLineNumber(_.lineNumber)}if(J.unit===5){let yt=0;return J.direction===3&&(yt=P.model.getLineCount()-P.cursorConfig.pageSize),P.viewLayout.getVerticalOffsetForLineNumber(yt)}let ue;J.unit===3?ue=P.cursorConfig.pageSize*J.value:J.unit===4?ue=Math.round(P.cursorConfig.pageSize/2)*J.value:ue=J.value;let Ye=(J.direction===1?-1:1)*ue;return P.viewLayout.getCurrentScrollTop()+Ye*P.cursorConfig.lineHeight}_runHorizontalEditorScroll(P,J,ue){let Ye=this._computeDesiredScrollLeft(P,ue);P.viewLayout.setScrollPosition({scrollLeft:Ye},0)}_computeDesiredScrollLeft(P,J){let ue=(J.direction===4?-1:1)*J.value;return P.viewLayout.getCurrentScrollLeft()+ue*P.cursorConfig.typicalHalfwidthCharacterWidth}}he.EditorScrollImpl=Il,he.EditorScroll=ye(new Il),he.ScrollLineUp=ye(new class extends Wt{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(se,P){he.EditorScroll.runCoreEditorCommand(se,{to:ui.RawDirection.Up,by:ui.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:P.source})}}),he.ScrollPageUp=ye(new class extends Wt{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(se,P){he.EditorScroll.runCoreEditorCommand(se,{to:ui.RawDirection.Up,by:ui.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:P.source})}}),he.ScrollEditorTop=ye(new class extends Wt{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus}})}runCoreEditorCommand(se,P){he.EditorScroll.runCoreEditorCommand(se,{to:ui.RawDirection.Up,by:ui.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:P.source})}}),he.ScrollLineDown=ye(new class extends Wt{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(se,P){he.EditorScroll.runCoreEditorCommand(se,{to:ui.RawDirection.Down,by:ui.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:P.source})}}),he.ScrollPageDown=ye(new class extends Wt{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(se,P){he.EditorScroll.runCoreEditorCommand(se,{to:ui.RawDirection.Down,by:ui.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:P.source})}}),he.ScrollEditorBottom=ye(new class extends Wt{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus}})}runCoreEditorCommand(se,P){he.EditorScroll.runCoreEditorCommand(se,{to:ui.RawDirection.Down,by:ui.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:P.source})}}),he.ScrollLeft=ye(new class extends Wt{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus}})}runCoreEditorCommand(se,P){he.EditorScroll.runCoreEditorCommand(se,{to:ui.RawDirection.Left,by:ui.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:P.source})}}),he.ScrollRight=ye(new class extends Wt{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus}})}runCoreEditorCommand(se,P){he.EditorScroll.runCoreEditorCommand(se,{to:ui.RawDirection.Right,by:ui.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:P.source})}});class hr extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){J.position&&(P.model.pushStackElement(),P.setCursorStates(J.source,3,[Vn.word(P,P.getPrimaryCursorState(),this._inSelectionMode,J.position)]),J.revealType!==2&&P.revealAllCursors(J.source,!0,!0))}}he.WordSelect=ye(new hr({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),he.WordSelectDrag=ye(new hr({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),he.LastCursorWordSelect=ye(new class extends Wt{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(se,P){if(!P.position)return;let J=se.getLastAddedCursorIndex(),ue=se.getCursorStates(),Ye=ue.slice(0),yt=ue[J];Ye[J]=Vn.word(se,yt,yt.modelState.hasSelection(),P.position),se.model.pushStackElement(),se.setCursorStates(P.source,3,Ye)}});class Is extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){J.position&&(P.model.pushStackElement(),P.setCursorStates(J.source,3,[Vn.line(P,P.getPrimaryCursorState(),this._inSelectionMode,J.position,J.viewPosition)]),J.revealType!==2&&P.revealAllCursors(J.source,!1,!0))}}he.LineSelect=ye(new Is({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),he.LineSelectDrag=ye(new Is({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class Go extends Wt{_inSelectionMode;constructor(P){super(P),this._inSelectionMode=P.inSelectionMode}runCoreEditorCommand(P,J){if(!J.position)return;let ue=P.getLastAddedCursorIndex(),Ye=P.getCursorStates(),yt=Ye.slice(0);yt[ue]=Vn.line(P,Ye[ue],this._inSelectionMode,J.position,J.viewPosition),P.model.pushStackElement(),P.setCursorStates(J.source,3,yt)}}he.LastCursorLineSelect=ye(new Go({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),he.LastCursorLineSelectDrag=ye(new Go({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),he.CancelSelection=ye(new class extends Wt{constructor(){super({id:"cancelSelection",precondition:oe.hasNonEmptySelection,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(se,P){se.model.pushStackElement(),se.setCursorStates(P.source,3,[Vn.cancelSelection(se,se.getPrimaryCursorState())]),se.revealAllCursors(P.source,!0)}}),he.RemoveSecondaryCursors=ye(new class extends Wt{constructor(){super({id:"removeSecondaryCursors",precondition:oe.hasMultipleSelections,kbOpts:{weight:nt+1,kbExpr:oe.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(se,P){se.model.pushStackElement(),se.setCursorStates(P.source,3,[se.getPrimaryCursorState()]),se.revealAllCursors(P.source,!0),gd(h("removedCursor","Removed secondary cursors"))}}),he.RevealLine=ye(new class extends Wt{constructor(){super({id:"revealLine",precondition:void 0,metadata:Lf.metadata})}runCoreEditorCommand(se,P){let J=P,ue=J.lineNumber||0,Ye=typeof ue=="number"?ue+1:parseInt(ue)+1;Ye<1&&(Ye=1);let yt=se.model.getLineCount();Ye>yt&&(Ye=yt);let Kn=new w(Ye,1,Ye,se.model.getLineMaxColumn(Ye)),vi=0;if(J.at)switch(J.at){case Lf.RawAtArgument.Top:vi=3;break;case Lf.RawAtArgument.Center:vi=1;break;case Lf.RawAtArgument.Bottom:vi=4;break;default:break}let Fe=se.coordinatesConverter.convertModelRangeToViewRange(Kn);se.revealRange(P.source,!1,Fe,vi,0)}}),he.SelectAll=new class extends kf{constructor(){super(k2)}runDOMCommand(se){Dn&&(se.focus(),se.select()),se.ownerDocument.execCommand("selectAll")}runEditorCommand(se,P,J){let ue=P._getViewModel();ue&&this.runCoreEditorCommand(ue,J)}runCoreEditorCommand(se,P){se.model.pushStackElement(),se.setCursorStates("keyboard",3,[Vn.selectAll(se,se.getPrimaryCursorState())])}},he.SetSelection=ye(new class extends Wt{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(se,P){P.selection&&(se.model.pushStackElement(),se.setCursorStates(P.source,3,[ze.fromModelSelection(P.selection)]))}})})(Mn||={});var pz=pe.and(oe.textInputFocus,oe.columnSelection);function bh(o,e){Xr.registerKeybindingRule({id:o,primary:e,when:pz,weight:nt+1})}bh(Mn.CursorColumnSelectLeft.id,1039);bh(Mn.CursorColumnSelectRight.id,1041);bh(Mn.CursorColumnSelectUp.id,1040);bh(Mn.CursorColumnSelectPageUp.id,1035);bh(Mn.CursorColumnSelectDown.id,1042);bh(Mn.CursorColumnSelectPageDown.id,1036);function U2(o){return o.register(),o}var Df;(l=>{class o extends ca{runEditorCommand(c,u,p){let m=u._getViewModel();m&&this.runCoreEditingCommand(u,m,p||{})}}l.CoreEditingCommand=o,l.LineBreakInsert=ye(new class extends o{constructor(){super({id:"lineBreakInsert",precondition:oe.writable,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,hh.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection)))}}),l.Outdent=ye(new class extends o{constructor(){super({id:"outdent",precondition:oe.writable,kbOpts:{weight:nt,kbExpr:pe.and(oe.editorTextFocus,oe.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,hs.outdent(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.Tab=ye(new class extends o{constructor(){super({id:"tab",precondition:oe.writable,kbOpts:{weight:nt,kbExpr:pe.and(oe.editorTextFocus,oe.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,hs.tab(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=ye(new class extends o{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,u){let[p,m]=ll.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(g=>g.modelState.selection),c.getCursorAutoClosedCharacters());p&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(2)}}),l.DeleteRight=ye(new class extends o{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:nt,kbExpr:oe.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,u){let[p,m]=ll.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(g=>g.modelState.selection));p&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(3)}}),l.Undo=new class extends kf{constructor(){super(D0)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends kf{constructor(){super(R0)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})(Df||={});var iS=class extends zc{_handlerId;constructor(e,t,n){super({id:e,precondition:void 0,metadata:n}),this._handlerId=t}runCommand(e,t){let n=e.get(wr).getFocusedCodeEditor();n&&n.trigger("keyboard",this._handlerId,t)}};function Zc(o,e){U2(new iS("default:"+o,o)),U2(new iS(o,o,e))}Zc("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Zc("replacePreviousChar");Zc("compositionType");Zc("compositionStart");Zc("compositionEnd");Zc("paste");Zc("cut");function oS(o){return U0.get(o)}var U0=class o extends W{constructor(t){super();this.editor=t;this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(n=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,n)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(n=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,n),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(n=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,n),this._forceUpdate()}finally{this._endUpdate()}}))}static _map=new Map;static get(t){let n=o._map.get(t);if(!n){n=new o(t),o._map.set(t,n);let i=t.onDidDispose(()=>{let r=o._map.get(t);r&&(o._map.delete(t),r.dispose(),i.dispose())})}return n}_updateCounter=0;_currentTransaction=void 0;_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new wl(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){let t=this._currentTransaction;this._currentTransaction=void 0,t.finish()}}forceUpdate(t){this._beginUpdate();try{return this._forceUpdate(),t?t(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}_model=qo(this,this.editor.getModel());model=this._model;isReadonly=fn(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(93));_versionId=Nb({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null);versionId=this._versionId;_selections=Nb({owner:this,equalsFn:Iu(yu(De.selectionsEqual)),lazy:!0},this.editor.getSelections()??null);selections=this._selections;positions=Li({owner:this,equalsFn:Iu(yu(R.equals))},t=>this.selections.read(t)?.map(n=>n.getStartPosition())??null);isFocused=fn(this,t=>{let n=this.editor.onDidFocusEditorWidget(t),i=this.editor.onDidBlurEditorWidget(t);return{dispose(){n.dispose(),i.dispose()}}},()=>this.editor.hasWidgetFocus());value=zR(this,t=>(this.versionId.read(t),this.model.read(t)?.getValue()??""),(t,n)=>{let i=this.model.get();i!==null&&t!==i.getValue()&&i.setValue(t)});valueIsEmpty=gn(this,t=>(this.versionId.read(t),this.editor.getModel()?.getValueLength()===0));cursorSelection=Li({owner:this,equalsFn:Iu(De.selectionsEqual)},t=>this.selections.read(t)?.[0]??null);cursorPosition=Li({owner:this,equalsFn:R.equals},t=>this.selections.read(t)?.[0]?.getPosition()??null);onDidType=Vd(this);scrollTop=fn(this.editor.onDidScrollChange,()=>this.editor.getScrollTop());scrollLeft=fn(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft());layoutInfo=fn(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo());layoutInfoContentLeft=this.layoutInfo.map(t=>t.contentLeft);layoutInfoDecorationsLeft=this.layoutInfo.map(t=>t.decorationsLeft);contentWidth=fn(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth());getOption(t){return fn(this,n=>this.editor.onDidChangeConfiguration(i=>{i.hasChanged(t)&&n(void 0)}),()=>this.editor.getOption(t))}setDecorations(t){let n=new te,i=this.editor.createDecorationsCollection();return n.add(Fd({owner:this,debugName:()=>`Apply decorations from ${t.debugName}`},r=>{let s=t.read(r);i.set(s)})),n.add({dispose:()=>{i.clear()}}),n}_overlayWidgetCounter=0;createOverlayWidget(t){let n="observableOverlayWidget"+this._overlayWidgetCounter++,i={getDomNode:()=>t.domNode,getPosition:()=>t.position.get(),getId:()=>n,allowEditorOverflow:t.allowEditorOverflow,getMinContentWidthInPx:()=>t.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);let r=Ht(s=>{t.position.read(s),t.minContentWidthInPx.read(s),this.editor.layoutOverlayWidget(i)});return ge(()=>{r.dispose(),this.editor.removeOverlayWidget(i)})}};var G0=Y("ILanguageFeatureDebounceService"),$0;(n=>{let o=new WeakMap,e=0;function t(i){let r=o.get(i);return r===void 0&&(r=++e,o.set(i,r)),r}n.of=t})($0||={});var z0=class{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}},K0=class{constructor(e,t,n,i,r,s){this._logService=e;this._name=t;this._registry=n;this._default=i;this._min=r;this._max=s}_cache=new Hi(50,.7);_key(e){return e.id+this._registry.all(e).reduce((t,n)=>ig($0.of(n),t),0)}get(e){let t=this._key(e),n=this._cache.get(t);return n?rs(n.value,this._min,this._max):this.default()}update(e,t){let n=this._key(e),i=this._cache.get(n);i||(i=new oC(6),this._cache.set(n,i));let r=rs(i.update(t),this._min,this._max);return jM(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${r}ms`),r}_overall(){let e=new pf;for(let[,t]of this._cache)e.update(t.value);return e.value}default(){let e=this._overall()|0||this._default;return rs(e,this._min,this._max)}},Rf=class{constructor(e,t){this._logService=e;this._isDev=t.isExtensionDevelopment||!t.isBuilt}_data=new Map;_isDev;for(e,t,n){let i=n?.min??50,r=n?.max??i**2,s=n?.key??void 0,a=`${$0.of(e)},${i}${s?","+s:""}`,l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new z0(i*1.5)):l=new K0(this._logService,t,e,this._overallAverage()|0||i*1.5,i,r),this._data.set(a,l)),l}_overallAverage(){let e=new pf;for(let t of this._data.values())e.update(t.default());return e.value}};Rf=K([D(0,En),D(1,Vr)],Rf);$i(G0,Rf,1);var Ho=Y("ILanguageFeaturesService");var rS={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:mc.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};var pa=class{_hooks=new te;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,e&&n&&n(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,n,i,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=i,this._onStopCallback=r;let s=e;try{e.setPointerCapture(t),this._hooks.add(ge(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=fe(e)}this._hooks.add(q(s,we.POINTER_MOVE,a=>{if(a.buttons!==n){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(q(s,we.POINTER_UP,a=>this.stopMonitoring(!0)))}};var pi=class extends W{onclick(e,t){this._register(q(e,we.CLICK,n=>t(new wi(fe(e),n))))}onmousedown(e,t){this._register(q(e,we.MOUSE_DOWN,n=>t(new wi(fe(e),n))))}onmouseover(e,t){this._register(q(e,we.MOUSE_OVER,n=>t(new wi(fe(e),n))))}onmouseleave(e,t){this._register(q(e,we.MOUSE_LEAVE,n=>t(new wi(fe(e),n))))}onkeydown(e,t){this._register(q(e,we.KEY_DOWN,n=>t(new pt(n))))}onkeyup(e,t){this._register(q(e,we.KEY_UP,n=>t(new pt(n))))}oninput(e,t){this._register(q(e,we.INPUT,t))}onblur(e,t){this._register(q(e,we.BLUR,t))}onfocus(e,t){this._register(q(e,we.FOCUS,t))}onchange(e,t){this._register(q(e,we.CHANGE,t))}ignoreGesture(e){return Sn.ignoreTarget(e)}};var bd=11,sS=class extends pi{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Je.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=bd+"px",this.domNode.style.height=bd+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new pa),this._register(Wn(this.bgDomNode,we.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(Wn(this.domNode,we.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new Yp),this._pointerdownScheduleRepeatTimer=this._register(new so)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,fe(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}};var vh=class o{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(e,t,n,i,r,s){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(e),this._visibleSize=i,this._scrollSize=r,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new o(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){let t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,n,i,r){let s=Math.max(0,n-e),a=Math.max(0,s-2*t),l=i>0&&i>n;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(n*a/i))),c=(a-d)/(i-n),u=r*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){let e=o._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize,n=this._scrollPosition;return t<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}};var aS=class extends W{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(e,t,n){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new so)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}};var hz=140,yh=class extends pi{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new aS(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new pa),this._shouldRender=!0,this.domNode=Ne(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(q(this.domNode.domNode,we.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new sS(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,n,i){this.slider=Ne(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof n=="number"&&this.slider.setWidth(n),typeof i=="number"&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(q(this.slider.domNode,we.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,n=t+this._scrollbarState.getSliderPosition(),i=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);n<=r&&r<=i?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,n;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,n=e.offsetY;else{let r=Zi(this.domNode.domNode);t=e.pageX-r.left,n=e.pageY-r.top}let i=this._pointerDownRelativePosition(t,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),n=this._sliderOrthogonalPointerPosition(e),i=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{let s=this._sliderOrthogonalPointerPosition(r),a=Math.abs(s-n);if(dt&&a>hz){this._setDesiredScrollPositionNow(i.getScrollPosition());return}let d=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(i.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var lS=class extends yh{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new vh(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,i.width,i.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){let s=(t.arrowSize-bd)/2,a=(t.horizontalScrollbarSize-bd)/2;this._createArrow({className:"scra",icon:le.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new lr(null,1,0))}),this._createArrow({className:"scra",icon:le.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new lr(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}};var dS=class extends yh{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new vh(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,i.height,i.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){let s=(t.arrowSize-bd)/2,a=(t.verticalScrollbarSize-bd)/2;this._createArrow({className:"scra",icon:le.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new lr(null,0,1))}),this._createArrow({className:"scra",icon:le.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new lr(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}};var mz=500,z2=50,K2=!0,j0=class{timestamp;deltaX;deltaY;score;constructor(e,t,n){this.timestamp=e,this.deltaX=t,this.deltaY=n,this.score=0}},Mf=class o{static INSTANCE=new o;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,n=1,i=this._rear;do{let r=i===this._front?e:Math.pow(2,-n);if(e-=r,t+=this._memory[i].score*r,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(ld){let t=fe(e.browserEvent),n=UF(t);this.accept(Date.now(),e.deltaX*n,e.deltaY*n)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,n){let i=null,r=new j0(e,t,n);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(i=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,i)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(n+=.25),t){let i=Math.abs(e.deltaX),r=Math.abs(e.deltaY),s=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(i,s),1),d=Math.max(Math.min(r,a),1),c=Math.max(i,s),u=Math.max(r,a);c%l===0&&u%d===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}},Pf=class extends pi{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new L);onScroll=this._onScroll.event;_onWillScroll=this._register(new L);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(e,t,n){super(),e.style.overflow="hidden",this._options=gz(t),this._scrollable=n,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));let i={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new dS(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new lS(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Ne(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Ne(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Ne(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new so),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=xt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Be&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new lr(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=xt(this._mouseWheelToDispose),e)){let n=i=>{this._onMouseWheel(new lr(i))};this._mouseWheelToDispose.push(q(this._listenOnDomNode,we.MOUSE_WHEEL,n,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=Mf.INSTANCE;K2&&t.acceptStandardWheelEvent(e);let n=!1;if(e.deltaY||e.deltaX){let r=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+r===0?s=r=0:Math.abs(r)>=Math.abs(s)?s=0:r=0),this._options.flipAxes&&([r,s]=[s,r]);let a=!Be&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=r,r=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(r){let c=z2*r,u=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,u)}if(s){let c=z2*s,u=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,u)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(K2&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),n=!0)}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,n=e.scrollLeft>0,i=n?" left":"",r=t?" top":"",s=n||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${r}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),mz)}},cS=class extends Pf{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new Wa({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>li(fe(e),i)});super(e,t,n),this._register(n)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Ih=class extends Pf{constructor(e,t,n){super(e,t,n)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Xc=class extends Pf{_element;constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new Wa({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>li(fe(e),i)});super(e,t,n),this._register(n),this._element=e,this._register(this.onScroll(i=>{i.scrollTopChanged&&(this._element.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this._element.scrollLeft=i.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}};function gz(o){let e={lazyRender:typeof o.lazyRender<"u"?o.lazyRender:!1,className:typeof o.className<"u"?o.className:"",useShadows:typeof o.useShadows<"u"?o.useShadows:!0,handleMouseWheel:typeof o.handleMouseWheel<"u"?o.handleMouseWheel:!0,flipAxes:typeof o.flipAxes<"u"?o.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof o.consumeMouseWheelIfScrollbarIsNeeded<"u"?o.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof o.alwaysConsumeMouseWheel<"u"?o.alwaysConsumeMouseWheel:!1,scrollYToX:typeof o.scrollYToX<"u"?o.scrollYToX:!1,mouseWheelScrollSensitivity:typeof o.mouseWheelScrollSensitivity<"u"?o.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof o.fastScrollSensitivity<"u"?o.fastScrollSensitivity:5,scrollPredominantAxis:typeof o.scrollPredominantAxis<"u"?o.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof o.mouseWheelSmoothScroll<"u"?o.mouseWheelSmoothScroll:!0,arrowSize:typeof o.arrowSize<"u"?o.arrowSize:11,listenOnDomNode:typeof o.listenOnDomNode<"u"?o.listenOnDomNode:null,horizontal:typeof o.horizontal<"u"?o.horizontal:1,horizontalScrollbarSize:typeof o.horizontalScrollbarSize<"u"?o.horizontalScrollbarSize:10,horizontalSliderSize:typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:0,horizontalHasArrows:typeof o.horizontalHasArrows<"u"?o.horizontalHasArrows:!1,vertical:typeof o.vertical<"u"?o.vertical:1,verticalScrollbarSize:typeof o.verticalScrollbarSize<"u"?o.verticalScrollbarSize:10,verticalHasArrows:typeof o.verticalHasArrows<"u"?o.verticalHasArrows:!1,verticalSliderSize:typeof o.verticalSliderSize<"u"?o.verticalSliderSize:0,scrollByPage:typeof o.scrollByPage<"u"?o.scrollByPage:!1};return e.horizontalSliderSize=typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof o.verticalSliderSize<"u"?o.verticalSliderSize:e.verticalScrollbarSize,Be&&(e.className+=" mac"),e}var fz=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),q0=fz,bz=new Nn(()=>q0("mouse",!1)),vz=new Nn(()=>q0("element",!1));function dn(o){return o==="element"?vz.value:bz.value}function vd(){return q0("element",!0)}var Tr=class extends W{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new te);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new Yo);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new L);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new L({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new L);onDidRun=this._onDidRun.event;_onWillRun=this._register(new L);onWillRun=this._onWillRun.event;constructor(e,t={}){super(),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(vd()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new Ur,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(r=>this._onDidRun.fire(r))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(r=>this._onWillRun.fire(r))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let n,i;switch(this._orientation){case 0:n=[15],i=[17];break;case 1:n=[16],i=[18],this.domNode.className+=" vertical";break}this._register(q(this.domNode,we.KEY_DOWN,r=>{let s=new pt(r),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusPrevious():i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof Oi&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(q(this.domNode,we.KEY_UP,r=>{let s=new pt(r);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Pc(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(bo()===this.domNode||!xr(bo(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(e){e?this.actionsList.setAttribute("aria-label",e):this.actionsList.removeAttribute("aria-label")}setFocusable(e){if(this.focusable=e,this.focusable){let t=this.viewItems.find(n=>n instanceof Oi&&n.isEnabled());t instanceof Oi&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof Oi&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(n=>{t=t||e.equals(n)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){let t=this.actionsList.children[e];if(xr(bo(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}hasAction(e){return this.viewItems.findIndex(t=>t.action.id===e.id)!==-1}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(Zn(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){let n=Array.isArray(e)?e:[e],i=ro(t.index)?t.index:null;n.forEach(r=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new ha(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,q(s,we.CONTEXT_MENU,d=>{it.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof Oi&&this.viewItems.length===0&&a.setFocusable(!0),i===null||i<0||i>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[i]),this.viewItems.splice(i,0,a),i++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}getHeight(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientHeight}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),xt(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=xt(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),di(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,n;if(e===void 0?t=!0:typeof e=="number"?n=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){let i=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=i===-1?void 0:i,this.updateFocus(void 0,void 0,!0)}else n!==void 0&&(this.focusedItem=n),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let n=this.focusedItem,i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=n,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==n&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===On.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let t=this.focusedItem,n;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}n=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===On.ID));return this.updateFocus(!0),!0}updateFocus(e,t,n=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let i=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(i){let r=!0;Pu(i.focus)||(r=!1),this.options.focusOnlyEnabledItems&&Pu(i.isEnabled)&&!i.isEnabled()&&(r=!1),i.action.id===On.ID&&(r=!1),r?(n||this.previouslyFocusedItem!==this.focusedItem)&&(i.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),r&&i.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;let t=this.viewItems[this.focusedItem];if(t instanceof Oi){let n=t._context===null||t._context===void 0?e:t._context;this.run(t._action,n)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=xt(this.viewItems),this.getContainer().remove(),super.dispose()}};var Xn;(i=>{function o(r,s){if(r.start>=s.end||s.start>=r.end)return{start:0,end:0};let a=Math.max(r.start,s.start),l=Math.min(r.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}i.intersect=o;function e(r){return r.end-r.start<=0}i.isEmpty=e;function t(r,s){return!e(o(r,s))}i.intersects=t;function n(r,s){let a=[],l={start:r.start,end:Math.min(s.start,r.end)},d={start:Math.max(s.end,r.start),end:r.end};return e(l)||a.push(l),e(d)||a.push(d),a}i.relativeComplement=n})(Xn||={});function G2(o,e={}){let t=uS(e);return t.textContent=o,t}function $2(o,e={}){let t=uS(e);return j2(t,yz(o,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function uS(o){let e=o.inline?"span":"div",t=document.createElement(e);return o.className&&(t.className=o.className),t}var Y0=class{source;index;constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){let e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}};function j2(o,e,t,n){let i;if(e.type===2)i=document.createTextNode(e.content||"");else if(e.type===3)i=document.createElement("b");else if(e.type===4)i=document.createElement("i");else if(e.type===7&&n)i=document.createElement("code");else if(e.type===5&&t){let r=document.createElement("a");t.disposables.add(Wn(r,"click",s=>{t.callback(String(e.index),s)})),i=r}else e.type===8?i=document.createElement("br"):e.type===1&&(i=o);i&&o!==i&&o.appendChild(i),i&&Array.isArray(e.children)&&e.children.forEach(r=>{j2(i,r,t,n)})}function yz(o,e){let t={type:1,children:[]},n=0,i=t,r=[],s=new Y0(o);for(;!s.eos();){let a=s.next(),l=a==="\\"&&Q0(s.peek(),e)!==0;if(l&&(a=s.next()),!l&&Iz(a,e)&&a===s.peek()){s.advance(),i.type===2&&(i=r.pop());let d=Q0(a,e);if(i.type===d||i.type===5&&d===6)i=r.pop();else{let c={type:d,children:[]};d===5&&(c.index=n,n++),i.children.push(c),r.push(i),i=c}}else if(a===`
`)i.type===2&&(i=r.pop()),i.children.push({type:8});else if(i.type!==2){let d={type:2,content:a};i.children.push(d),r.push(i),i=d}else i.content+=a}return i.type===2&&(i=r.pop()),r.length,t}function Iz(o,e){return Q0(o,e)!==0}function Q0(o,e){switch(o){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}var pS=class{constructor(e){this.spliceables=e}splice(e,t,n){this.spliceables.forEach(i=>i.splice(e,t,n))}};function q2(o,e){let t=[];for(let n of e){if(o.start>=n.range.end)continue;if(o.end<n.range.start)break;let i=Xn.intersect(o,n.range);Xn.isEmpty(i)||t.push({range:i,size:n.size})}return t}function mS({start:o,end:e},t){return{start:o+t,end:e+t}}function Cz(o){let e=[],t=null;for(let n of o){let i=n.range.start,r=n.range.end,s=n.size;if(t&&s===t.size){t.range.end=r;continue}t={range:{start:i,end:r},size:s},e.push(t)}return e}function Sz(...o){return Cz(o.reduce((e,t)=>e.concat(t),[]))}var hS=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,n=[]){let i=n.length-t,r=q2({start:0,end:e},this.groups),s=q2({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:mS(l.range,i),size:l.size})),a=n.map((l,d)=>({range:{start:e+d,end:e+d+1},size:l.size}));this.groups=Sz(r,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,n=this._paddingTop;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r*i.size;if(e<s)return t+Math.floor((e-n)/i.size);t+=r,n=s}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,n=0;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r;if(e<s)return this._paddingTop+t+(e-n)*i.size;t+=r*i.size,n=s}return-1}};var gS=class{constructor(e){this.renderers=e}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(e){let t=this.getTemplateCache(e).pop(),n=!1;if(t)n=this.transactionNodesPendingRemoval.has(t.domNode),n&&this.transactionNodesPendingRemoval.delete(t.domNode);else{let i=Se(".monaco-list-row"),s=this.getRenderer(e).renderTemplate(i);t={domNode:i,templateId:e,templateData:s}}return{row:t,isReusingConnectedDomNode:n}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(let t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){let{domNode:t,templateId:n}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(n).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(let n of e)this.getRenderer(t).disposeTemplate(n.templateData),n.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){let t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}};var Jc={CurrentDragAndDropData:void 0};var ma={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(o){return[o]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},fS=class{elements;_context;get context(){return this._context}set context(e){this._context=e}constructor(e){this.elements=e}update(){}getData(){return this.elements}},Z0=class{elements;constructor(e){this.elements=e}update(){}getData(){return this.elements}},X0=class{types;files;constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){let n=e.files.item(t);n&&(n.size||n.type)&&this.files.push(n)}}}getData(){return{types:this.types,files:this.files}}};function xz(o,e){return Array.isArray(o)&&Array.isArray(e)?Kt(o,e):o===e}var J0=class{getSetSize;getPosInSet;getRole;isChecked;constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,n,i)=>i,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,n)=>n+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}},Uo=class Uo{constructor(e,t,n,i=ma){this.virtualDelegate=t;if(i.horizontalScrolling&&i.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(i.paddingTop??0);for(let s of n)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new gS(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof i.mouseSupport=="boolean"?i.mouseSupport:!0),this._horizontalScrolling=i.horizontalScrolling??ma.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof i.paddingBottom>"u"?0:i.paddingBottom,this.accessibilityProvider=new J0(i.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(i.transformOptimization??ma.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Sn.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new Wa({forceIntegerValues:!0,smoothScrollDuration:i.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>li(fe(this.domNode),s)})),this.scrollableElement=this.disposables.add(new Ih(this.rowsContainer,{alwaysConsumeMouseWheel:i.alwaysConsumeMouseWheel??ma.alwaysConsumeMouseWheel,horizontal:1,vertical:i.verticalScrollMode??ma.verticalScrollMode,useShadows:i.useShadows??ma.useShadows,mouseWheelScrollSensitivity:i.mouseWheelScrollSensitivity,fastScrollSensitivity:i.fastScrollSensitivity,scrollByPage:i.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(q(this.rowsContainer,ht.Change,s=>this.onTouchChange(s))),this.disposables.add(q(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(q(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(q(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(q(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(q(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=i.setRowLineHeight??ma.setRowLineHeight,this.setRowHeight=i.setRowHeight??ma.setRowHeight,this.supportDynamicHeights=i.supportDynamicHeights??ma.supportDynamicHeights,this.dnd=i.dnd??this.disposables.add(ma.dnd),this.layout(i.initialSize?.height,i.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++Uo.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new Oa(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=W.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=W.None;onDragLeaveTimeout=W.None;disposables=new te;_onDidChangeContentHeight=new L;_onDidChangeContentWidth=new L;onDidChangeContentHeight=de.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=de.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:aC(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),i=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(n,Math.max(0,this.lastRenderTop+i),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(e){this.scrollableElement.delegateScrollFromMouseWheelEvent(e)}delegateVerticalScrollbarPointerDown(e){this.scrollableElement.delegateVerticalScrollbarPointerDown(e)}updateElementHeight(e,t,n){if(e<0||e>=this.items.length)return;let i=this.items[e].size;if(typeof t>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[e].lastDynamicHeightWidth=void 0,t=i+this.probeDynamicHeight(e)}if(i===t)return;let r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;e<r.start||n!==null&&n>e&&n<r.end?s=t-i:s=0,this.rangeMap.splice(e,1,[{size:t}]),this.items[e].size=t,this.render(r,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(e){return new hS(e)}splice(e,t,n=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,n)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,n=[]){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},s=Xn.intersect(i,r),a=new Map;for(let E=s.end-1;E>=s.start;E--){let M=this.items[E];if(M.dragStartDisposable.dispose(),M.checkedDisposable.dispose(),M.row){let A=a.get(M.templateId);A||(A=[],a.set(M.templateId,A));let F=this.renderers.get(M.templateId);F&&F.disposeElement&&F.disposeElement(M.element,E,M.row.templateData,M.size),A.unshift(M.row)}M.row=null,M.stale=!0}let l={start:e+t,end:this.items.length},d=Xn.intersect(l,i),c=Xn.relativeComplement(l,i),u=n.map(E=>({id:String(this.itemId++),element:E,templateId:this.virtualDelegate.getTemplateId(E),size:this.virtualDelegate.getHeight(E),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(E),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:W.None,checkedDisposable:W.None,stale:!1})),p;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),p=this.items,this.items=u):(this.rangeMap.splice(e,t,u),p=this.items.splice(e,t,...u));let m=n.length-t,g=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),f=mS(d,m),b=Xn.intersect(g,f);for(let E=b.start;E<b.end;E++)this.updateItemInDOM(this.items[E],E);let v=Xn.relativeComplement(f,g);for(let E of v)for(let M=E.start;M<E.end;M++)this.removeItemFromDOM(M);let I=c.map(E=>mS(E,m)),S=[{start:e,end:e+n.length},...I].map(E=>Xn.intersect(g,E)).reverse();for(let E of S)for(let M=E.end-1;M>=E.start;M--){let A=this.items[M],O=a.get(A.templateId)?.pop();this.insertItemInDOM(M,O)}for(let E of a.values())for(let M of E)this.cache.release(M);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),p.map(E=>E.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=li(fe(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(let t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(e){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let t=this.items[e];this.measureItemWidth(t),typeof t.width<"u"&&t.width>this.scrollWidth&&(this.scrollWidth=t.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let e=this.firstVisibleIndex,t=this.rangeMap.positionAt(e),n=this.rangeMap.positionAt(e+1);return n!==-1&&(n-t)/2+t<this.scrollTop?e+1:e}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){let t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let n={height:typeof e=="number"?e:c2(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,n.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(n),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:aC(this.domNode)})}render(e,t,n,i,r,s=!1){let a=this.getRenderRange(t,n),l=Xn.relativeComplement(a,e).reverse(),d=Xn.relativeComplement(e,a);if(s){let c=Xn.intersect(e,a);for(let u=c.start;u<c.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(let c of d)for(let u=c.start;u<c.end;u++)this.removeItemFromDOM(u);for(let c of l)for(let u=c.end-1;u>=c.start;u--)this.insertItemInDOM(u)}),i!==void 0&&(this.rowsContainer.style.left=`-${i}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=n}insertItemInDOM(e,t){let n=this.items[e];if(!n.row)if(t)n.row=t,n.stale=!0;else{let l=this.cache.alloc(n.templateId);n.row=l.row,n.stale||=l.isReusingConnectedDomNode}let i=this.accessibilityProvider.getRole(n.element)||"listitem";n.row.domNode.setAttribute("role",i);let r=this.accessibilityProvider.isChecked(n.element);if(typeof r=="boolean")n.row.domNode.setAttribute("aria-checked",String(!!r));else if(r){let l=d=>n.row.domNode.setAttribute("aria-checked",String(!!d));l(r.value),n.checkedDisposable=r.onDidChange(()=>l(r.value))}if(n.stale||!n.row.domNode.parentElement){let l=this.items.at(e+1)?.row?.domNode??null;(n.row.domNode.parentElement!==this.rowsContainer||n.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(n.row.domNode,l),n.stale=!1}this.updateItemInDOM(n,e);let s=this.renderers.get(n.templateId);if(!s)throw new Error(`No renderer found for template id ${n.templateId}`);s?.renderElement(n.element,e,n.row.templateData,n.size);let a=this.dnd.getDragURI(n.element);n.dragStartDisposable.dispose(),n.row.domNode.draggable=!!a,a&&(n.dragStartDisposable=q(n.row.domNode,"dragstart",l=>this.onDragStart(n.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(n),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=aC(e.row.domNode);let t=fe(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){let t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let n=this.renderers.get(t.templateId);n&&n.disposeElement&&n.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:e})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return de.map(this.disposables.add(new We(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return de.map(this.disposables.add(new We(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return de.filter(de.map(this.disposables.add(new We(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseUp(){return de.map(this.disposables.add(new We(this.domNode,"mouseup")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDown(){return de.map(this.disposables.add(new We(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return de.map(this.disposables.add(new We(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMove(){return de.map(this.disposables.add(new We(this.domNode,"mousemove")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return de.map(this.disposables.add(new We(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return de.any(de.map(this.disposables.add(new We(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),de.map(this.disposables.add(new We(this.domNode,ht.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return de.map(this.disposables.add(new We(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return de.map(this.disposables.add(new We(this.rowsContainer,ht.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toTouchEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toGestureEvent(e){let t=this.getItemIndexFromEventTarget(e.initialTarget||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toDragEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:i,sector:r}}onScroll(e){try{let t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,n){if(!n.dataTransfer)return;let i=this.dnd.getDragElements(e);if(n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setData(rS.TEXT,t),n.dataTransfer.setDragImage){let r;this.dnd.getDragLabel&&(r=this.dnd.getDragLabel(i,n)),typeof r>"u"&&(r=String(i.length));let s=Se(".monaco-drag-image");s.textContent=r,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),n.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new fS(i),Jc.CurrentDragAndDropData=new Z0(i),this.dnd.onDragStart?.(this.currentDragData,n)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),Jc.CurrentDragAndDropData&&Jc.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(Jc.CurrentDragAndDropData)this.currentDragData=Jc.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new X0}let t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let n;typeof t!="boolean"&&t.feedback?n=t.feedback:typeof e.index>"u"?n=[-1]:n=[e.index],n=La(n).filter(r=>r>=-1&&r<this.length).sort((r,s)=>r-s),n=n[0]===-1?[-1]:n;let i=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(xz(this.currentDragFeedback,n)&&this.currentDragFeedbackPosition===i)return!0;if(this.currentDragFeedback=n,this.currentDragFeedbackPosition=i,this.currentDragFeedbackDisposable.dispose(),n[0]===-1)this.domNode.classList.add(i),this.rowsContainer.classList.add(i),this.currentDragFeedbackDisposable=ge(()=>{this.domNode.classList.remove(i),this.rowsContainer.classList.remove(i)});else{if(n.length>1&&i!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");i==="drop-target-after"&&n[0]<this.length-1&&(n[0]+=1,i="drop-target-before");for(let r of n){let s=this.items[r];s.dropTarget=!0,s.row?.domNode.classList.add(i)}this.currentDragFeedbackDisposable=ge(()=>{for(let r of n){let s=this.items[r];s.dropTarget=!1,s.row?.domNode.classList.remove(i)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=rc(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;let t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Jc.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Jc.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=W.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){let t=l2(this.domNode).top;this.dragOverAnimationDisposable=I2(fe(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=rc(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;let t=this.dragOverMouseY-e,n=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>n&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-n))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;let n=e.offsetY/this.items[t].size,i=Math.floor(n/.25);return rs(i,0,3)}getItemIndexFromEventTarget(e){let t=this.scrollableElement.getDomNode(),n=e;for(;(Zn(n)||m2(n))&&n!==this.rowsContainer&&t.contains(n);){let i=n.getAttribute("data-index");if(i){let r=Number(i);if(!isNaN(r))return r}n=n.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,n){let i=this.getRenderRange(e,t),r,s;e===this.elementTop(i.start)?(r=i.start,s=0):i.end-i.start>1&&(r=i.start+1,s=this.elementTop(r)-e);let a=0;for(;;){let l=this.getRenderRange(e,t),d=!1;for(let c=l.start;c<l.end;c++){let u=this.probeDynamicHeight(c);u!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=u,d=d||u!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=Xn.relativeComplement(i,l);for(let p of c)for(let m=p.start;m<p.end;m++)this.items[m].row&&this.removeItemFromDOM(m);let u=Xn.relativeComplement(l,i).reverse();for(let p of u)for(let m=p.end-1;m>=p.start;m--)this.insertItemInDOM(m);for(let p=l.start;p<l.end;p++)this.items[p].row&&this.updateItemInDOM(this.items[p],p);if(typeof r=="number"){let p=this.scrollable.getFutureScrollPosition().scrollTop-e,m=this.elementTop(r)-s+p;this.setScrollTop(m,n)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){let t=this.items[e];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(t.element);if(s!==null){let a=t.size;return t.size=s,t.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;let n=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!xr(t.row.domNode,fe(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-n;let{row:i}=this.cache.alloc(t.templateId);i.domNode.style.height="",this.rowsContainer.appendChild(i.domNode);let r=this.renderers.get(t.templateId);if(!r)throw new Ke("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,i.templateData,void 0),t.size=i.domNode.offsetHeight,r.disposeElement?.(t.element,e,i.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,i.domNode.remove(),this.cache.release(i),t.size-n}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(let e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};K([Lt],Uo.prototype,"onMouseClick",1),K([Lt],Uo.prototype,"onMouseDblClick",1),K([Lt],Uo.prototype,"onMouseMiddleClick",1),K([Lt],Uo.prototype,"onMouseUp",1),K([Lt],Uo.prototype,"onMouseDown",1),K([Lt],Uo.prototype,"onMouseOver",1),K([Lt],Uo.prototype,"onMouseMove",1),K([Lt],Uo.prototype,"onMouseOut",1),K([Lt],Uo.prototype,"onContextMenu",1),K([Lt],Uo.prototype,"onTouchStart",1),K([Lt],Uo.prototype,"onTap",1);var bS=Uo;var ga=class extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}};var ek=class{constructor(e){this.trait=e}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,n){let i=this.renderedElements.findIndex(r=>r.templateData===n);if(i>=0){let r=this.renderedElements[i];this.trait.unrender(n),r.index=t}else{let r={index:t,templateData:n};this.renderedElements.push(r)}this.trait.renderIndex(t,n)}splice(e,t,n){let i=[];for(let r of this.renderedElements)r.index<e?i.push(r):r.index>=e+t&&i.push({index:r.index+n-t,templateData:r.templateData});this.renderedElements=i}renderIndexes(e){for(let{index:t,templateData:n}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,n)}disposeTemplate(e){let t=this.renderedElements.findIndex(n=>n.templateData===e);t<0||this.renderedElements.splice(t,1)}},Ch=class{constructor(e){this._trait=e}indexes=[];sortedIndexes=[];_onChange=new L;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new ek(this)}splice(e,t,n){let i=n.length-t,r=e+t,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)s.push(this.sortedIndexes[a++]);for(let l=0;l<n.length;l++)n[l]&&s.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)s.push(this.sortedIndexes[a++]+i);this.renderer.splice(e,t,n.length),this._set(s,s)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(Q2),t)}_set(e,t,n){let i=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;let s=rk(r,e);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:e,browserEvent:n}),i}get(){return this.indexes}contains(e){return Ub(this.sortedIndexes,e,Q2)>=0}dispose(){xt(this._onChange)}};K([Lt],Ch.prototype,"renderer",1);var tk=class extends Ch{constructor(t){super("selected");this.setAriaSelected=t}renderIndex(t,n){super.renderIndex(t,n),this.setAriaSelected&&(this.contains(t)?n.setAttribute("aria-selected","true"):n.setAttribute("aria-selected","false"))}},Nf=class{constructor(e,t,n){this.trait=e;this.view=t;this.identityProvider=n}splice(e,t,n){if(!this.identityProvider)return this.trait.splice(e,t,new Array(n.length).fill(!1));let i=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(i.length===0)return this.trait.splice(e,t,new Array(n.length).fill(!1));let r=new Set(i),s=n.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,s)}};function Z2(o,e){return o.classList.contains(e)?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:Z2(o.parentElement,e)}function Af(o){return Z2(o,"monaco-editor")}var vS=class{constructor(e,t,n){this.list=e;this.view=t;this.multipleSelectionSupport=n.multipleSelectionSupport,this.disposables.add(this.onKeyDown(i=>{switch(i.keyCode){case 3:return this.onEnter(i);case 16:return this.onUpArrow(i);case 18:return this.onDownArrow(i);case 11:return this.onPageUpArrow(i);case 12:return this.onPageDownArrow(i);case 9:return this.onEscape(i);case 31:this.multipleSelectionSupport&&(Be?i.metaKey:i.ctrlKey)&&this.onCtrlA(i)}}))}disposables=new te;multipleSelectionDisposables=new te;multipleSelectionSupport;get onKeyDown(){return de.chain(this.disposables.add(new We(this.view.domNode,"keydown")).event,e=>e.filter(t=>!la(t.target)).map(t=>new pt(t)))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(Kb(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};K([Lt],vS.prototype,"onKeyDown",1);var Ez=new class{mightProducePrintableCharacter(o){return o.ctrlKey||o.metaKey||o.altKey?!1:o.keyCode>=31&&o.keyCode<=56||o.keyCode>=21&&o.keyCode<=30||o.keyCode>=98&&o.keyCode<=107||o.keyCode>=85&&o.keyCode<=95}},nk=class{constructor(e,t,n,i,r){this.list=e;this.view=t;this.keyboardNavigationLabelProvider=n;this.keyboardNavigationEventFilter=i;this.delegate=r;this.updateOptions(e.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new te;disposables=new te;updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let e=!1,t=de.chain(this.enabledDisposables.add(new We(this.view.domNode,"keydown")).event,r=>r.filter(s=>!la(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new pt(s)).filter(s=>e||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>it.stop(s,!0)).map(s=>s.browserEvent.key)),n=de.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);de.reduce(de.any(t,n),(r,s)=>s===null?null:(r||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),n(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),n(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){let t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?ua(t):t&&ua(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=0,this.triggered=!1;return}let t=this.list.getFocus(),n=t.length>0?t[0]:0,i=this.state===0?1:0;this.state=1;for(let r=0;r<this.list.length;r++){let s=(n+r+i)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(Hu(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}let d=xP(e,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||Hu(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},ik=class{constructor(e,t){this.list=e;this.view=t;let n=de.chain(this.disposables.add(new We(t.domNode,"keydown")).event,r=>r.filter(s=>!la(s.target)).map(s=>new pt(s)));de.chain(n,r=>r.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new te;onTab(e){if(e.target!==this.view.domNode)return;let t=this.list.getFocus();if(t.length===0)return;let n=this.view.domElement(t[0]);if(!n)return;let i=n.querySelector("[tabIndex]");if(!i||!Zn(i)||i.tabIndex===-1)return;let r=fe(i).getComputedStyle(i);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),i.focus())}dispose(){this.disposables.dispose()}};function Tz(o){return Be?o.browserEvent.metaKey:o.browserEvent.ctrlKey}function Lz(o){return o.browserEvent.shiftKey}function kz(o){return cC(o)&&o.button===2}var Y2={isSelectionSingleChangeEvent:Tz,isSelectionRangeChangeEvent:Lz},yS=class{constructor(e){this.list=e;e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||Y2),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Sn.addTarget(e.getHTMLElement()))),de.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new te;_onPointer=new L;onPointer=this._onPointer.event;updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||Y2))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){Af(e.browserEvent.target)||bo()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(la(e.browserEvent.target)||Af(e.browserEvent.target))return;let t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||la(e.browserEvent.target)||Af(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),kz(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(la(e.browserEvent.target)||Af(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){let t=e.index,n=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof n>"u"&&(n=this.list.getFocus()[0]??t,this.list.setAnchor(n));let i=Math.min(n,t),r=Math.max(n,t),s=Kb(i,r+1),a=this.list.getSelection(),l=Rz(rk(a,[n]),n);if(l.length===0)return;let d=rk(s,Mz(a,l));this.list.setSelection(d,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){let i=this.list.getSelection(),r=i.filter(s=>s!==t);this.list.setFocus([t]),this.list.setAnchor(t),i.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}},ok=class{constructor(e,t){this.styleElement=e;this.selectorSuffix=t}style(e){let t=this.selectorSuffix&&`.${this.selectorSuffix}`,n=[];e.listBackground&&n.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&n.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(n.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&n.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);let i=ls(e.listFocusAndSelectionOutline,ls(e.listSelectionOutline,e.listFocusOutline??""));i&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${i}; outline-offset: -1px;}`),e.listFocusOutline&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);let r=ls(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&n.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&n.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&n.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&n.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&n.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&n.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&n.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=n.join(`
`)}},X2={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:G.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:G.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:G.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},Dz={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function Rz(o,e){let t=o.indexOf(e);if(t===-1)return[];let n=[],i=t-1;for(;i>=0&&o[i]===e-(t-i);)n.push(o[i--]);for(n.reverse(),i=t;i<o.length&&o[i]===e+(i-t);)n.push(o[i++]);return n}function rk(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){t.push(o[n]),n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):t.push(e[i++]);return t}function Mz(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):i++;return t}var Q2=(o,e)=>o-e,sk=class{constructor(e,t){this._templateId=e;this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,n,i){let r=0;for(let s of this.renderers)s.renderElement(e,t,n[r++],i)}disposeElement(e,t,n,i){let r=0;for(let s of this.renderers)s.disposeElement?.(e,t,n[r],i),r+=1}disposeTemplate(e){let t=0;for(let n of this.renderers)n.disposeTemplate(e[t++])}},ak=class{constructor(e){this.accessibilityProvider=e}templateId="a18n";renderTemplate(e){return{container:e,disposables:new te}}renderElement(e,t,n){let i=this.accessibilityProvider.getAriaLabel(e),r=i&&typeof i!="string"?i:Su(i);n.disposables.add(Ht(a=>{this.setAriaLabel(a.readObservable(r),n.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof s=="number"?n.container.setAttribute("aria-level",`${s}`):n.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,n,i){n.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}},lk=class{constructor(e,t){this.list=e;this.dnd=t}getDragElements(e){let t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,n,i,r){return this.dnd.onDragOver(e,t,n,i,r)}onDragLeave(e,t,n,i){this.dnd.onDragLeave?.(e,t,n,i)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,n,i,r){this.dnd.drop(e,t,n,i,r)}dispose(){this.dnd.dispose()}},Io=class{constructor(e,t,n,i,r=Dz){this.user=e;this._options=r;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new tk(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new ak(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),i=i.map(d=>new sk(d.templateId,[...a,d]));let l={...r,dnd:r.dnd&&new lk(this,r.dnd)};if(this.view=this.createListView(t,n,i,l),this.view.domNode.setAttribute("role",s),r.styleController)this.styleController=r.styleController(this.view.domId);else{let d=as(this.view.domNode);this.styleController=new ok(d,this.view.domId)}if(this.spliceable=new pS([new Nf(this.focus,this.view,r.identityProvider),new Nf(this.selection,this.view,r.identityProvider),new Nf(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new ik(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new vS(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){let d=r.keyboardNavigationDelegate||Ez;this.typeNavigationController=new nk(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new Ch("focused");selection;anchor=new Ch("anchor");eventBufferer=new Lu;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new te;get onDidChangeFocus(){return de.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return de.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1,t=de.chain(this.disposables.add(new We(this.view.domNode,"keydown")).event,r=>r.map(s=>new pt(s)).filter(s=>e=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>it.stop(s,!0)).filter(()=>!1)),n=de.chain(this.disposables.add(new We(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(s=>new pt(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>it.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),i=de.chain(this.view.onContextMenu,r=>r.filter(s=>!e).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new wi(fe(this.view.domNode),l),browserEvent:l})));return de.any(t,n,i)}get onKeyDown(){return this.disposables.add(new We(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new We(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new We(this.view.domNode,"keypress")).event}get onDidFocus(){return de.signal(this.disposables.add(new We(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return de.signal(this.disposables.add(new We(this.view.domNode,"blur",!0)).event)}_onDidDispose=new L;onDidDispose=this._onDidDispose.event;createListView(e,t,n,i){return new bS(e,t,n,i)}createMouseController(e){return new yS(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,n=[]){if(e<0||e>this.view.length)throw new ga(this.user,`Invalid start index: ${e}`);if(t<0)throw new ga(this.user,`Invalid delete count: ${t}`);t===0&&n.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,n))}updateWidth(e){this.view.updateWidth(e)}updateElementHeight(e,t){this.view.updateElementHeight(e,t,null)}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(e){this.view.setScrollLeft(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(e,t){for(let n of e)if(n<0||n>=this.length)throw new ga(this.user,`Invalid index ${n}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new ga(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(let n of e)if(n<0||n>=this.length)throw new ga(this.user,`Invalid index ${n}`);this.focus.set(e,t)}focusNext(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findNextIndex(r.length>0?r[0]+e:0,t,i);s>-1&&this.setFocus([s],n)}focusPrevious(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findPreviousIndex(r.length>0?r[0]-e:0,t,i);s>-1&&this.setFocus([s],n)}async focusNextPage(e,t){let n=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);n=n===0?0:n-1;let i=this.getFocus()[0];if(i!==n&&(i===void 0||n>i)){let r=this.findPreviousIndex(n,!1,t);r>-1&&i!==r?this.setFocus([r],e):this.setFocus([n],e)}else{let r=this.view.getScrollTop(),s=r+this.view.renderHeight;n>i&&(s-=this.view.elementHeight(n)),this.view.setScrollTop(s),this.view.getScrollTop()!==r&&(this.setFocus([]),await ao(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,n=()=>0){let i,r=n(),s=this.view.getScrollTop()+r;s===0?i=this.view.indexAt(s):i=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==i&&(a===void 0||a>=i)){let l=this.findNextIndex(i,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([i],e)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-r),this.view.getScrollTop()+n()!==l&&(this.setFocus([]),await ao(0),await this.focusPreviousPage(e,t,n))}}focusLast(e,t){if(this.length===0)return;let n=this.findPreviousIndex(this.length-1,!1,t);n>-1&&this.setFocus([n],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,n){if(this.length===0)return;let i=this.findNextIndex(e,!1,n);i>-1&&this.setFocus([i],t)}findNextIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!n||n(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!n||n(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,n=0){if(e<0||e>=this.length)throw new ga(this.user,`Invalid index ${e}`);let i=this.view.getScrollTop(),r=this.view.elementTop(e),s=this.view.elementHeight(e);if(ro(t)){let a=s-this.view.renderHeight+n;this.view.setScrollTop(a*rs(t,0,1)+r-n)}else{let a=r+s,l=i+this.view.renderHeight;r<i+n&&a>=l||(r<i+n||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(r-n):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new ga(this.user,`Invalid index ${e}`);let n=this.view.getScrollTop(),i=this.view.elementTop(e),r=this.view.elementHeight(e);if(i<n+t||i+r>n+this.view.renderHeight)return null;let s=r-this.view.renderHeight+t;return Math.abs((n+t-i)/s)}isDOMFocused(){return ss(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(n=>this.view.element(n)),browserEvent:t}}_onFocusChange(){let e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};K([Lt],Io.prototype,"onDidChangeFocus",1),K([Lt],Io.prototype,"onDidChangeSelection",1),K([Lt],Io.prototype,"onContextMenu",1),K([Lt],Io.prototype,"onKeyDown",1),K([Lt],Io.prototype,"onKeyUp",1),K([Lt],Io.prototype,"onKeyPress",1),K([Lt],Io.prototype,"onDidFocus",1),K([Lt],Io.prototype,"onDidBlur",1);var Pz=new RegExp(`(\\\\)?\\$\\((${Je.iconNameExpression}(?:${Je.iconModifierExpression})?)\\)`,"g");function eu(o){let e=new Array,t,n=0,i=0;for(;(t=Pz.exec(o))!==null;){i=t.index||0,n<i&&e.push(o.substring(n,i)),n=(t.index||0)+t[0].length;let[,r,s]=t;e.push(r?`$(${s})`:Az({id:s}))}return n<o.length&&e.push(o.substring(n)),e}function Az(o){let e=Se("span");return e.classList.add(...Je.asClassNameArray(o)),e}var dk=class{_prefix;_lastId;constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},ck=new dk("id#");var hi={};(function(){function o(e,t){t(hi)}o.amd=!0,function(e,t){typeof o=="function"&&o.amd?o(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){"use strict";function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function n(Fe){e.defaults=Fe}let i=/[&<>"']/,r=new RegExp(i.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=Fe=>l[Fe];function c(Fe,_){if(_){if(i.test(Fe))return Fe.replace(r,d)}else if(s.test(Fe))return Fe.replace(a,d);return Fe}let u=/(^|[^\[])\^/g;function p(Fe,_){let T=typeof Fe=="string"?Fe:Fe.source;_=_||"";let k={replace:(N,B)=>{let j=typeof B=="string"?B:B.source;return j=j.replace(u,"$1"),T=T.replace(N,j),k},getRegex:()=>new RegExp(T,_)};return k}function m(Fe){try{Fe=encodeURI(Fe).replace(/%25/g,"%")}catch{return null}return Fe}let g={exec:()=>null};function f(Fe,_){let T=Fe.replace(/\|/g,(B,j,X)=>{let Ie=!1,Te=j;for(;--Te>=0&&X[Te]==="\\";)Ie=!Ie;return Ie?"|":" |"}),k=T.split(/ \|/),N=0;if(k[0].trim()||k.shift(),k.length>0&&!k[k.length-1].trim()&&k.pop(),_)if(k.length>_)k.splice(_);else for(;k.length<_;)k.push("");for(;N<k.length;N++)k[N]=k[N].trim().replace(/\\\|/g,"|");return k}function b(Fe,_,T){let k=Fe.length;if(k===0)return"";let N=0;for(;N<k;){let B=Fe.charAt(k-N-1);if(B===_&&!T)N++;else if(B!==_&&T)N++;else break}return Fe.slice(0,k-N)}function v(Fe,_){if(Fe.indexOf(_[1])===-1)return-1;let T=0;for(let k=0;k<Fe.length;k++)if(Fe[k]==="\\")k++;else if(Fe[k]===_[0])T++;else if(Fe[k]===_[1]&&(T--,T<0))return k;return-1}function I(Fe,_,T,k){let N=_.href,B=_.title?c(_.title):null,j=Fe[1].replace(/\\([\[\]])/g,"$1");if(Fe[0].charAt(0)!=="!"){k.state.inLink=!0;let X={type:"link",raw:T,href:N,title:B,text:j,tokens:k.inlineTokens(j)};return k.state.inLink=!1,X}return{type:"image",raw:T,href:N,title:B,text:c(j)}}function C(Fe,_){let T=Fe.match(/^(\s+)(?:```)/);if(T===null)return _;let k=T[1];return _.split(`
`).map(N=>{let B=N.match(/^\s+/);if(B===null)return N;let[j]=B;return j.length>=k.length?N.slice(k.length):N}).join(`
`)}class S{options;rules;lexer;constructor(_){this.options=_||e.defaults}space(_){let T=this.rules.block.newline.exec(_);if(T&&T[0].length>0)return{type:"space",raw:T[0]}}code(_){let T=this.rules.block.code.exec(_);if(T){let k=T[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:T[0],codeBlockStyle:"indented",text:this.options.pedantic?k:b(k,`
`)}}}fences(_){let T=this.rules.block.fences.exec(_);if(T){let k=T[0],N=C(k,T[3]||"");return{type:"code",raw:k,lang:T[2]?T[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):T[2],text:N}}}heading(_){let T=this.rules.block.heading.exec(_);if(T){let k=T[2].trim();if(/#$/.test(k)){let N=b(k,"#");(this.options.pedantic||!N||/ $/.test(N))&&(k=N.trim())}return{type:"heading",raw:T[0],depth:T[1].length,text:k,tokens:this.lexer.inline(k)}}}hr(_){let T=this.rules.block.hr.exec(_);if(T)return{type:"hr",raw:b(T[0],`
`)}}blockquote(_){let T=this.rules.block.blockquote.exec(_);if(T){let k=b(T[0],`
`).split(`
`),N="",B="",j=[];for(;k.length>0;){let X=!1,Ie=[],Te;for(Te=0;Te<k.length;Te++)if(/^ {0,3}>/.test(k[Te]))Ie.push(k[Te]),X=!0;else if(!X)Ie.push(k[Te]);else break;k=k.slice(Te);let Ze=Ie.join(`
`),mt=Ze.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");N=N?`${N}
${Ze}`:Ze,B=B?`${B}
${mt}`:mt;let Vt=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(mt,j,!0),this.lexer.state.top=Vt,k.length===0)break;let _n=j[j.length-1];if(_n?.type==="code")break;if(_n?.type==="blockquote"){let Xt=_n,Re=Xt.raw+`
`+k.join(`
`),V=this.blockquote(Re);j[j.length-1]=V,N=N.substring(0,N.length-Xt.raw.length)+V.raw,B=B.substring(0,B.length-Xt.text.length)+V.text;break}else if(_n?.type==="list"){let Xt=_n,Re=Xt.raw+`
`+k.join(`
`),V=this.list(Re);j[j.length-1]=V,N=N.substring(0,N.length-_n.raw.length)+V.raw,B=B.substring(0,B.length-Xt.raw.length)+V.raw,k=Re.substring(j[j.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:N,tokens:j,text:B}}}list(_){let T=this.rules.block.list.exec(_);if(T){let k=T[1].trim(),N=k.length>1,B={type:"list",raw:"",ordered:N,start:N?+k.slice(0,-1):"",loose:!1,items:[]};k=N?`\\d{1,9}\\${k.slice(-1)}`:`\\${k}`,this.options.pedantic&&(k=N?k:"[*+-]");let j=new RegExp(`^( {0,3}${k})((?:[	 ][^\\n]*)?(?:\\n|$))`),X=!1;for(;_;){let Ie=!1,Te="",Ze="";if(!(T=j.exec(_))||this.rules.block.hr.test(_))break;Te=T[0],_=_.substring(Te.length);let mt=T[2].split(`
`,1)[0].replace(/^\t+/,me=>" ".repeat(3*me.length)),Vt=_.split(`
`,1)[0],_n=!mt.trim(),Xt=0;if(this.options.pedantic?(Xt=2,Ze=mt.trimStart()):_n?Xt=T[1].length+1:(Xt=T[2].search(/[^ ]/),Xt=Xt>4?1:Xt,Ze=mt.slice(Xt),Xt+=T[1].length),_n&&/^ *$/.test(Vt)&&(Te+=Vt+`
`,_=_.substring(Vt.length+1),Ie=!0),!Ie){let me=new RegExp(`^ {0,${Math.min(3,Xt-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Le=new RegExp(`^ {0,${Math.min(3,Xt-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Nt=new RegExp(`^ {0,${Math.min(3,Xt-1)}}(?:\`\`\`|~~~)`),An=new RegExp(`^ {0,${Math.min(3,Xt-1)}}#`);for(;_;){let Wi=_.split(`
`,1)[0];if(Vt=Wi,this.options.pedantic&&(Vt=Vt.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Nt.test(Vt)||An.test(Vt)||me.test(Vt)||Le.test(_))break;if(Vt.search(/[^ ]/)>=Xt||!Vt.trim())Ze+=`
`+Vt.slice(Xt);else{if(_n||mt.search(/[^ ]/)>=4||Nt.test(mt)||An.test(mt)||Le.test(mt))break;Ze+=`
`+Vt}!_n&&!Vt.trim()&&(_n=!0),Te+=Wi+`
`,_=_.substring(Wi.length+1),mt=Vt.slice(Xt)}}B.loose||(X?B.loose=!0:/\n *\n *$/.test(Te)&&(X=!0));let Re=null,V;this.options.gfm&&(Re=/^\[[ xX]\] /.exec(Ze),Re&&(V=Re[0]!=="[ ] ",Ze=Ze.replace(/^\[[ xX]\] +/,""))),B.items.push({type:"list_item",raw:Te,task:!!Re,checked:V,loose:!1,text:Ze,tokens:[]}),B.raw+=Te}B.items[B.items.length-1].raw=B.items[B.items.length-1].raw.trimEnd(),B.items[B.items.length-1].text=B.items[B.items.length-1].text.trimEnd(),B.raw=B.raw.trimEnd();for(let Ie=0;Ie<B.items.length;Ie++)if(this.lexer.state.top=!1,B.items[Ie].tokens=this.lexer.blockTokens(B.items[Ie].text,[]),!B.loose){let Te=B.items[Ie].tokens.filter(mt=>mt.type==="space"),Ze=Te.length>0&&Te.some(mt=>/\n.*\n/.test(mt.raw));B.loose=Ze}if(B.loose)for(let Ie=0;Ie<B.items.length;Ie++)B.items[Ie].loose=!0;return B}}html(_){let T=this.rules.block.html.exec(_);if(T)return{type:"html",block:!0,raw:T[0],pre:T[1]==="pre"||T[1]==="script"||T[1]==="style",text:T[0]}}def(_){let T=this.rules.block.def.exec(_);if(T){let k=T[1].toLowerCase().replace(/\s+/g," "),N=T[2]?T[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",B=T[3]?T[3].substring(1,T[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):T[3];return{type:"def",tag:k,raw:T[0],href:N,title:B}}}table(_){let T=this.rules.block.table.exec(_);if(!T||!/[:|]/.test(T[2]))return;let k=f(T[1]),N=T[2].replace(/^\||\| *$/g,"").split("|"),B=T[3]&&T[3].trim()?T[3].replace(/\n[ \t]*$/,"").split(`
`):[],j={type:"table",raw:T[0],header:[],align:[],rows:[]};if(k.length===N.length){for(let X of N)/^ *-+: *$/.test(X)?j.align.push("right"):/^ *:-+: *$/.test(X)?j.align.push("center"):/^ *:-+ *$/.test(X)?j.align.push("left"):j.align.push(null);for(let X=0;X<k.length;X++)j.header.push({text:k[X],tokens:this.lexer.inline(k[X]),header:!0,align:j.align[X]});for(let X of B)j.rows.push(f(X,j.header.length).map((Ie,Te)=>({text:Ie,tokens:this.lexer.inline(Ie),header:!1,align:j.align[Te]})));return j}}lheading(_){let T=this.rules.block.lheading.exec(_);if(T)return{type:"heading",raw:T[0],depth:T[2].charAt(0)==="="?1:2,text:T[1],tokens:this.lexer.inline(T[1])}}paragraph(_){let T=this.rules.block.paragraph.exec(_);if(T){let k=T[1].charAt(T[1].length-1)===`
`?T[1].slice(0,-1):T[1];return{type:"paragraph",raw:T[0],text:k,tokens:this.lexer.inline(k)}}}text(_){let T=this.rules.block.text.exec(_);if(T)return{type:"text",raw:T[0],text:T[0],tokens:this.lexer.inline(T[0])}}escape(_){let T=this.rules.inline.escape.exec(_);if(T)return{type:"escape",raw:T[0],text:c(T[1])}}tag(_){let T=this.rules.inline.tag.exec(_);if(T)return!this.lexer.state.inLink&&/^<a /i.test(T[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(T[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(T[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(T[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:T[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:T[0]}}link(_){let T=this.rules.inline.link.exec(_);if(T){let k=T[2].trim();if(!this.options.pedantic&&/^</.test(k)){if(!/>$/.test(k))return;let j=b(k.slice(0,-1),"\\");if((k.length-j.length)%2===0)return}else{let j=v(T[2],"()");if(j>-1){let Ie=(T[0].indexOf("!")===0?5:4)+T[1].length+j;T[2]=T[2].substring(0,j),T[0]=T[0].substring(0,Ie).trim(),T[3]=""}}let N=T[2],B="";if(this.options.pedantic){let j=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(N);j&&(N=j[1],B=j[3])}else B=T[3]?T[3].slice(1,-1):"";return N=N.trim(),/^</.test(N)&&(this.options.pedantic&&!/>$/.test(k)?N=N.slice(1):N=N.slice(1,-1)),I(T,{href:N&&N.replace(this.rules.inline.anyPunctuation,"$1"),title:B&&B.replace(this.rules.inline.anyPunctuation,"$1")},T[0],this.lexer)}}reflink(_,T){let k;if((k=this.rules.inline.reflink.exec(_))||(k=this.rules.inline.nolink.exec(_))){let N=(k[2]||k[1]).replace(/\s+/g," "),B=T[N.toLowerCase()];if(!B){let j=k[0].charAt(0);return{type:"text",raw:j,text:j}}return I(k,B,k[0],this.lexer)}}emStrong(_,T,k=""){let N=this.rules.inline.emStrongLDelim.exec(_);if(!N||N[3]&&k.match(/[\p{L}\p{N}]/u))return;if(!(N[1]||N[2]||"")||!k||this.rules.inline.punctuation.exec(k)){let j=[...N[0]].length-1,X,Ie,Te=j,Ze=0,mt=N[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(mt.lastIndex=0,T=T.slice(-1*_.length+j);(N=mt.exec(T))!=null;){if(X=N[1]||N[2]||N[3]||N[4]||N[5]||N[6],!X)continue;if(Ie=[...X].length,N[3]||N[4]){Te+=Ie;continue}else if((N[5]||N[6])&&j%3&&!((j+Ie)%3)){Ze+=Ie;continue}if(Te-=Ie,Te>0)continue;Ie=Math.min(Ie,Ie+Te+Ze);let Vt=[...N[0]][0].length,_n=_.slice(0,j+N.index+Vt+Ie);if(Math.min(j,Ie)%2){let Re=_n.slice(1,-1);return{type:"em",raw:_n,text:Re,tokens:this.lexer.inlineTokens(Re)}}let Xt=_n.slice(2,-2);return{type:"strong",raw:_n,text:Xt,tokens:this.lexer.inlineTokens(Xt)}}}}codespan(_){let T=this.rules.inline.code.exec(_);if(T){let k=T[2].replace(/\n/g," "),N=/[^ ]/.test(k),B=/^ /.test(k)&&/ $/.test(k);return N&&B&&(k=k.substring(1,k.length-1)),k=c(k,!0),{type:"codespan",raw:T[0],text:k}}}br(_){let T=this.rules.inline.br.exec(_);if(T)return{type:"br",raw:T[0]}}del(_){let T=this.rules.inline.del.exec(_);if(T)return{type:"del",raw:T[0],text:T[2],tokens:this.lexer.inlineTokens(T[2])}}autolink(_){let T=this.rules.inline.autolink.exec(_);if(T){let k,N;return T[2]==="@"?(k=c(T[1]),N="mailto:"+k):(k=c(T[1]),N=k),{type:"link",raw:T[0],text:k,href:N,tokens:[{type:"text",raw:k,text:k}]}}}url(_){let T;if(T=this.rules.inline.url.exec(_)){let k,N;if(T[2]==="@")k=c(T[0]),N="mailto:"+k;else{let B;do B=T[0],T[0]=this.rules.inline._backpedal.exec(T[0])?.[0]??"";while(B!==T[0]);k=c(T[0]),T[1]==="www."?N="http://"+T[0]:N=T[0]}return{type:"link",raw:T[0],text:k,href:N,tokens:[{type:"text",raw:k,text:k}]}}}inlineText(_){let T=this.rules.inline.text.exec(_);if(T){let k;return this.lexer.state.inRawBlock?k=T[0]:k=c(T[0]),{type:"text",raw:T[0],text:k}}}}let E=/^(?: *(?:\n|$))+/,M=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,A=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,F=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,O=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,H=/(?:[*+-]|\d{1,9}[.)])/,U=p(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,H).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),z=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,re=/^[^\n]+/,ve=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ee=p(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",ve).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Q=p(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,H).getRegex(),ae="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ne=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Z=p("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ne).replace("tag",ae).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ce=p(z).replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae).getRegex(),st={blockquote:p(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ce).getRegex(),code:M,def:ee,fences:A,heading:O,hr:F,html:Z,lheading:U,list:Q,newline:E,paragraph:Ce,table:g,text:re},Xe=p("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae).getRegex(),ke={...st,table:Xe,paragraph:p(z).replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Xe).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae).getRegex()},ti={...st,html:p(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ne).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:g,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:p(z).replace("hr",F).replace("heading",` *#{1,6} *[^
]`).replace("lheading",U).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Pn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,eo=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,So=/^( {2,}|\\)\n(?!\s*$)/,yl=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,fi="\\p{P}\\p{S}",Rr=p(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,fi).getRegex(),Md=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Il=p(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,fi).getRegex(),bi=p("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,fi).getRegex(),Cl=p("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,fi).getRegex(),Sl=p(/\\([punct])/,"gu").replace(/punct/g,fi).getRegex(),gu=p(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),fu=p(ne).replace("(?:-->|$)","-->").getRegex(),Ae=p("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",fu).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ca=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,xl=p(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Ca).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ys=p(/^!?\[(label)\]\[(ref)\]/).replace("label",Ca).replace("ref",ve).getRegex(),hr=p(/^!?\[(ref)\](?:\[\])?/).replace("ref",ve).getRegex(),cm=p("reflink|nolink(?!\\()","g").replace("reflink",ys).replace("nolink",hr).getRegex(),Pd={_backpedal:g,anyPunctuation:Sl,autolink:gu,blockSkip:Md,br:So,code:eo,del:g,emStrongLDelim:Il,emStrongRDelimAst:bi,emStrongRDelimUnd:Cl,escape:Pn,link:xl,nolink:hr,punctuation:Rr,reflink:ys,reflinkSearch:cm,tag:Ae,text:yl,url:g},um={...Pd,link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",Ca).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ca).getRegex()},Is={...Pd,escape:p(Pn).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},pm={...Is,br:p(So).replace("{2,}","*").getRegex(),text:p(Is.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Cs={normal:st,gfm:ke,pedantic:ti},Go={normal:Pd,gfm:Is,breaks:pm,pedantic:um};class xn{tokens;options;state;tokenizer;inlineQueue;constructor(_){this.tokens=[],this.tokens.links=Object.create(null),this.options=_||e.defaults,this.options.tokenizer=this.options.tokenizer||new S,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let T={block:Cs.normal,inline:Go.normal};this.options.pedantic?(T.block=Cs.pedantic,T.inline=Go.pedantic):this.options.gfm&&(T.block=Cs.gfm,this.options.breaks?T.inline=Go.breaks:T.inline=Go.gfm),this.tokenizer.rules=T}static get rules(){return{block:Cs,inline:Go}}static lex(_,T){return new xn(T).lex(_)}static lexInline(_,T){return new xn(T).inlineTokens(_)}lex(_){_=_.replace(/\r\n|\r/g,`
`),this.blockTokens(_,this.tokens);for(let T=0;T<this.inlineQueue.length;T++){let k=this.inlineQueue[T];this.inlineTokens(k.src,k.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(_,T=[],k=!1){this.options.pedantic?_=_.replace(/\t/g,"    ").replace(/^ +$/gm,""):_=_.replace(/^( *)(\t+)/gm,(X,Ie,Te)=>Ie+"    ".repeat(Te.length));let N,B,j;for(;_;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(X=>(N=X.call({lexer:this},_,T))?(_=_.substring(N.raw.length),T.push(N),!0):!1))){if(N=this.tokenizer.space(_)){_=_.substring(N.raw.length),N.raw.length===1&&T.length>0?T[T.length-1].raw+=`
`:T.push(N);continue}if(N=this.tokenizer.code(_)){_=_.substring(N.raw.length),B=T[T.length-1],B&&(B.type==="paragraph"||B.type==="text")?(B.raw+=`
`+N.raw,B.text+=`
`+N.text,this.inlineQueue[this.inlineQueue.length-1].src=B.text):T.push(N);continue}if(N=this.tokenizer.fences(_)){_=_.substring(N.raw.length),T.push(N);continue}if(N=this.tokenizer.heading(_)){_=_.substring(N.raw.length),T.push(N);continue}if(N=this.tokenizer.hr(_)){_=_.substring(N.raw.length),T.push(N);continue}if(N=this.tokenizer.blockquote(_)){_=_.substring(N.raw.length),T.push(N);continue}if(N=this.tokenizer.list(_)){_=_.substring(N.raw.length),T.push(N);continue}if(N=this.tokenizer.html(_)){_=_.substring(N.raw.length),T.push(N);continue}if(N=this.tokenizer.def(_)){_=_.substring(N.raw.length),B=T[T.length-1],B&&(B.type==="paragraph"||B.type==="text")?(B.raw+=`
`+N.raw,B.text+=`
`+N.raw,this.inlineQueue[this.inlineQueue.length-1].src=B.text):this.tokens.links[N.tag]||(this.tokens.links[N.tag]={href:N.href,title:N.title});continue}if(N=this.tokenizer.table(_)){_=_.substring(N.raw.length),T.push(N);continue}if(N=this.tokenizer.lheading(_)){_=_.substring(N.raw.length),T.push(N);continue}if(j=_,this.options.extensions&&this.options.extensions.startBlock){let X=1/0,Ie=_.slice(1),Te;this.options.extensions.startBlock.forEach(Ze=>{Te=Ze.call({lexer:this},Ie),typeof Te=="number"&&Te>=0&&(X=Math.min(X,Te))}),X<1/0&&X>=0&&(j=_.substring(0,X+1))}if(this.state.top&&(N=this.tokenizer.paragraph(j))){B=T[T.length-1],k&&B?.type==="paragraph"?(B.raw+=`
`+N.raw,B.text+=`
`+N.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=B.text):T.push(N),k=j.length!==_.length,_=_.substring(N.raw.length);continue}if(N=this.tokenizer.text(_)){_=_.substring(N.raw.length),B=T[T.length-1],B&&B.type==="text"?(B.raw+=`
`+N.raw,B.text+=`
`+N.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=B.text):T.push(N);continue}if(_){let X="Infinite loop on byte: "+_.charCodeAt(0);if(this.options.silent){console.error(X);break}else throw new Error(X)}}return this.state.top=!0,T}inline(_,T=[]){return this.inlineQueue.push({src:_,tokens:T}),T}inlineTokens(_,T=[]){let k,N,B,j=_,X,Ie,Te;if(this.tokens.links){let Ze=Object.keys(this.tokens.links);if(Ze.length>0)for(;(X=this.tokenizer.rules.inline.reflinkSearch.exec(j))!=null;)Ze.includes(X[0].slice(X[0].lastIndexOf("[")+1,-1))&&(j=j.slice(0,X.index)+"["+"a".repeat(X[0].length-2)+"]"+j.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(X=this.tokenizer.rules.inline.blockSkip.exec(j))!=null;)j=j.slice(0,X.index)+"["+"a".repeat(X[0].length-2)+"]"+j.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(X=this.tokenizer.rules.inline.anyPunctuation.exec(j))!=null;)j=j.slice(0,X.index)+"++"+j.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;_;)if(Ie||(Te=""),Ie=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(Ze=>(k=Ze.call({lexer:this},_,T))?(_=_.substring(k.raw.length),T.push(k),!0):!1))){if(k=this.tokenizer.escape(_)){_=_.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.tag(_)){_=_.substring(k.raw.length),N=T[T.length-1],N&&k.type==="text"&&N.type==="text"?(N.raw+=k.raw,N.text+=k.text):T.push(k);continue}if(k=this.tokenizer.link(_)){_=_.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.reflink(_,this.tokens.links)){_=_.substring(k.raw.length),N=T[T.length-1],N&&k.type==="text"&&N.type==="text"?(N.raw+=k.raw,N.text+=k.text):T.push(k);continue}if(k=this.tokenizer.emStrong(_,j,Te)){_=_.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.codespan(_)){_=_.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.br(_)){_=_.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.del(_)){_=_.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.autolink(_)){_=_.substring(k.raw.length),T.push(k);continue}if(!this.state.inLink&&(k=this.tokenizer.url(_))){_=_.substring(k.raw.length),T.push(k);continue}if(B=_,this.options.extensions&&this.options.extensions.startInline){let Ze=1/0,mt=_.slice(1),Vt;this.options.extensions.startInline.forEach(_n=>{Vt=_n.call({lexer:this},mt),typeof Vt=="number"&&Vt>=0&&(Ze=Math.min(Ze,Vt))}),Ze<1/0&&Ze>=0&&(B=_.substring(0,Ze+1))}if(k=this.tokenizer.inlineText(B)){_=_.substring(k.raw.length),k.raw.slice(-1)!=="_"&&(Te=k.raw.slice(-1)),Ie=!0,N=T[T.length-1],N&&N.type==="text"?(N.raw+=k.raw,N.text+=k.text):T.push(k);continue}if(_){let Ze="Infinite loop on byte: "+_.charCodeAt(0);if(this.options.silent){console.error(Ze);break}else throw new Error(Ze)}}return T}}class $o{options;parser;constructor(_){this.options=_||e.defaults}space(_){return""}code({text:_,lang:T,escaped:k}){let N=(T||"").match(/^\S*/)?.[0],B=_.replace(/\n$/,"")+`
`;return N?'<pre><code class="language-'+c(N)+'">'+(k?B:c(B,!0))+`</code></pre>
`:"<pre><code>"+(k?B:c(B,!0))+`</code></pre>
`}blockquote({tokens:_}){return`<blockquote>
${this.parser.parse(_)}</blockquote>
`}html({text:_}){return _}heading({tokens:_,depth:T}){return`<h${T}>${this.parser.parseInline(_)}</h${T}>
`}hr(_){return`<hr>
`}list(_){let T=_.ordered,k=_.start,N="";for(let X=0;X<_.items.length;X++){let Ie=_.items[X];N+=this.listitem(Ie)}let B=T?"ol":"ul",j=T&&k!==1?' start="'+k+'"':"";return"<"+B+j+`>
`+N+"</"+B+`>
`}listitem(_){let T="";if(_.task){let k=this.checkbox({checked:!!_.checked});_.loose?_.tokens.length>0&&_.tokens[0].type==="paragraph"?(_.tokens[0].text=k+" "+_.tokens[0].text,_.tokens[0].tokens&&_.tokens[0].tokens.length>0&&_.tokens[0].tokens[0].type==="text"&&(_.tokens[0].tokens[0].text=k+" "+_.tokens[0].tokens[0].text)):_.tokens.unshift({type:"text",raw:k+" ",text:k+" "}):T+=k+" "}return T+=this.parser.parse(_.tokens,!!_.loose),`<li>${T}</li>
`}checkbox({checked:_}){return"<input "+(_?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:_}){return`<p>${this.parser.parseInline(_)}</p>
`}table(_){let T="",k="";for(let B=0;B<_.header.length;B++)k+=this.tablecell(_.header[B]);T+=this.tablerow({text:k});let N="";for(let B=0;B<_.rows.length;B++){let j=_.rows[B];k="";for(let X=0;X<j.length;X++)k+=this.tablecell(j[X]);N+=this.tablerow({text:k})}return N&&(N=`<tbody>${N}</tbody>`),`<table>
<thead>
`+T+`</thead>
`+N+`</table>
`}tablerow({text:_}){return`<tr>
${_}</tr>
`}tablecell(_){let T=this.parser.parseInline(_.tokens),k=_.header?"th":"td";return(_.align?`<${k} align="${_.align}">`:`<${k}>`)+T+`</${k}>
`}strong({tokens:_}){return`<strong>${this.parser.parseInline(_)}</strong>`}em({tokens:_}){return`<em>${this.parser.parseInline(_)}</em>`}codespan({text:_}){return`<code>${_}</code>`}br(_){return"<br>"}del({tokens:_}){return`<del>${this.parser.parseInline(_)}</del>`}link({href:_,title:T,tokens:k}){let N=this.parser.parseInline(k),B=m(_);if(B===null)return N;_=B;let j='<a href="'+_+'"';return T&&(j+=' title="'+T+'"'),j+=">"+N+"</a>",j}image({href:_,title:T,text:k}){let N=m(_);if(N===null)return k;_=N;let B=`<img src="${_}" alt="${k}"`;return T&&(B+=` title="${T}"`),B+=">",B}text(_){return"tokens"in _&&_.tokens?this.parser.parseInline(_.tokens):_.text}}class Sa{strong({text:_}){return _}em({text:_}){return _}codespan({text:_}){return _}del({text:_}){return _}html({text:_}){return _}text({text:_}){return _}link({text:_}){return""+_}image({text:_}){return""+_}br(){return""}}class Bi{options;renderer;textRenderer;constructor(_){this.options=_||e.defaults,this.options.renderer=this.options.renderer||new $o,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Sa}static parse(_,T){return new Bi(T).parse(_)}static parseInline(_,T){return new Bi(T).parseInline(_)}parse(_,T=!0){let k="";for(let N=0;N<_.length;N++){let B=_[N];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[B.type]){let X=B,Ie=this.options.extensions.renderers[X.type].call({parser:this},X);if(Ie!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(X.type)){k+=Ie||"";continue}}let j=B;switch(j.type){case"space":{k+=this.renderer.space(j);continue}case"hr":{k+=this.renderer.hr(j);continue}case"heading":{k+=this.renderer.heading(j);continue}case"code":{k+=this.renderer.code(j);continue}case"table":{k+=this.renderer.table(j);continue}case"blockquote":{k+=this.renderer.blockquote(j);continue}case"list":{k+=this.renderer.list(j);continue}case"html":{k+=this.renderer.html(j);continue}case"paragraph":{k+=this.renderer.paragraph(j);continue}case"text":{let X=j,Ie=this.renderer.text(X);for(;N+1<_.length&&_[N+1].type==="text";)X=_[++N],Ie+=`
`+this.renderer.text(X);T?k+=this.renderer.paragraph({type:"paragraph",raw:Ie,text:Ie,tokens:[{type:"text",raw:Ie,text:Ie}]}):k+=Ie;continue}default:{let X='Token with "'+j.type+'" type was not found.';if(this.options.silent)return console.error(X),"";throw new Error(X)}}}return k}parseInline(_,T){T=T||this.renderer;let k="";for(let N=0;N<_.length;N++){let B=_[N];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[B.type]){let X=this.options.extensions.renderers[B.type].call({parser:this},B);if(X!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(B.type)){k+=X||"";continue}}let j=B;switch(j.type){case"escape":{k+=T.text(j);break}case"html":{k+=T.html(j);break}case"link":{k+=T.link(j);break}case"image":{k+=T.image(j);break}case"strong":{k+=T.strong(j);break}case"em":{k+=T.em(j);break}case"codespan":{k+=T.codespan(j);break}case"br":{k+=T.br(j);break}case"del":{k+=T.del(j);break}case"text":{k+=T.text(j);break}default:{let X='Token with "'+j.type+'" type was not found.';if(this.options.silent)return console.error(X),"";throw new Error(X)}}}return k}}class _l{options;constructor(_){this.options=_||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(_){return _}postprocess(_){return _}processAllTokens(_){return _}}class Mr{defaults=t();options=this.setOptions;parse=this.parseMarkdown(xn.lex,Bi.parse);parseInline=this.parseMarkdown(xn.lexInline,Bi.parseInline);Parser=Bi;Renderer=$o;TextRenderer=Sa;Lexer=xn;Tokenizer=S;Hooks=_l;constructor(..._){this.use(..._)}walkTokens(_,T){let k=[];for(let N of _)switch(k=k.concat(T.call(this,N)),N.type){case"table":{let B=N;for(let j of B.header)k=k.concat(this.walkTokens(j.tokens,T));for(let j of B.rows)for(let X of j)k=k.concat(this.walkTokens(X.tokens,T));break}case"list":{let B=N;k=k.concat(this.walkTokens(B.items,T));break}default:{let B=N;this.defaults.extensions?.childTokens?.[B.type]?this.defaults.extensions.childTokens[B.type].forEach(j=>{let X=B[j].flat(1/0);k=k.concat(this.walkTokens(X,T))}):B.tokens&&(k=k.concat(this.walkTokens(B.tokens,T)))}}return k}use(..._){let T=this.defaults.extensions||{renderers:{},childTokens:{}};return _.forEach(k=>{let N={...k};if(N.async=this.defaults.async||N.async||!1,k.extensions&&(k.extensions.forEach(B=>{if(!B.name)throw new Error("extension name required");if("renderer"in B){let j=T.renderers[B.name];j?T.renderers[B.name]=function(...X){let Ie=B.renderer.apply(this,X);return Ie===!1&&(Ie=j.apply(this,X)),Ie}:T.renderers[B.name]=B.renderer}if("tokenizer"in B){if(!B.level||B.level!=="block"&&B.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let j=T[B.level];j?j.unshift(B.tokenizer):T[B.level]=[B.tokenizer],B.start&&(B.level==="block"?T.startBlock?T.startBlock.push(B.start):T.startBlock=[B.start]:B.level==="inline"&&(T.startInline?T.startInline.push(B.start):T.startInline=[B.start]))}"childTokens"in B&&B.childTokens&&(T.childTokens[B.name]=B.childTokens)}),N.extensions=T),k.renderer){let B=this.defaults.renderer||new $o(this.defaults);for(let j in k.renderer){if(!(j in B))throw new Error(`renderer '${j}' does not exist`);if(["options","parser"].includes(j))continue;let X=j,Ie=k.renderer[X],Te=B[X];B[X]=(...Ze)=>{let mt=Ie.apply(B,Ze);return mt===!1&&(mt=Te.apply(B,Ze)),mt||""}}N.renderer=B}if(k.tokenizer){let B=this.defaults.tokenizer||new S(this.defaults);for(let j in k.tokenizer){if(!(j in B))throw new Error(`tokenizer '${j}' does not exist`);if(["options","rules","lexer"].includes(j))continue;let X=j,Ie=k.tokenizer[X],Te=B[X];B[X]=(...Ze)=>{let mt=Ie.apply(B,Ze);return mt===!1&&(mt=Te.apply(B,Ze)),mt}}N.tokenizer=B}if(k.hooks){let B=this.defaults.hooks||new _l;for(let j in k.hooks){if(!(j in B))throw new Error(`hook '${j}' does not exist`);if(j==="options")continue;let X=j,Ie=k.hooks[X],Te=B[X];_l.passThroughHooks.has(j)?B[X]=Ze=>{if(this.defaults.async)return Promise.resolve(Ie.call(B,Ze)).then(Vt=>Te.call(B,Vt));let mt=Ie.call(B,Ze);return Te.call(B,mt)}:B[X]=(...Ze)=>{let mt=Ie.apply(B,Ze);return mt===!1&&(mt=Te.apply(B,Ze)),mt}}N.hooks=B}if(k.walkTokens){let B=this.defaults.walkTokens,j=k.walkTokens;N.walkTokens=function(X){let Ie=[];return Ie.push(j.call(this,X)),B&&(Ie=Ie.concat(B.call(this,X))),Ie}}this.defaults={...this.defaults,...N}}),this}setOptions(_){return this.defaults={...this.defaults,..._},this}lexer(_,T){return xn.lex(_,T??this.defaults)}parser(_,T){return Bi.parse(_,T??this.defaults)}parseMarkdown(_,T){return(N,B)=>{let j={...B},X={...this.defaults,...j},Ie=this.onError(!!X.silent,!!X.async);if(this.defaults.async===!0&&j.async===!1)return Ie(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof N>"u"||N===null)return Ie(new Error("marked(): input parameter is undefined or null"));if(typeof N!="string")return Ie(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(N)+", string expected"));if(X.hooks&&(X.hooks.options=X),X.async)return Promise.resolve(X.hooks?X.hooks.preprocess(N):N).then(Te=>_(Te,X)).then(Te=>X.hooks?X.hooks.processAllTokens(Te):Te).then(Te=>X.walkTokens?Promise.all(this.walkTokens(Te,X.walkTokens)).then(()=>Te):Te).then(Te=>T(Te,X)).then(Te=>X.hooks?X.hooks.postprocess(Te):Te).catch(Ie);try{X.hooks&&(N=X.hooks.preprocess(N));let Te=_(N,X);X.hooks&&(Te=X.hooks.processAllTokens(Te)),X.walkTokens&&this.walkTokens(Te,X.walkTokens);let Ze=T(Te,X);return X.hooks&&(Ze=X.hooks.postprocess(Ze)),Ze}catch(Te){return Ie(Te)}}}onError(_,T){return k=>{if(k.message+=`
Please report this to https://github.com/markedjs/marked.`,_){let N="<p>An error occurred:</p><pre>"+c(k.message+"",!0)+"</pre>";return T?Promise.resolve(N):N}if(T)return Promise.reject(k);throw k}}}let Ss=new Mr;function he(Fe,_){return Ss.parse(Fe,_)}he.options=he.setOptions=function(Fe){return Ss.setOptions(Fe),he.defaults=Ss.defaults,n(he.defaults),he},he.getDefaults=t,he.defaults=e.defaults,he.use=function(...Fe){return Ss.use(...Fe),he.defaults=Ss.defaults,n(he.defaults),he},he.walkTokens=function(Fe,_){return Ss.walkTokens(Fe,_)},he.parseInline=Ss.parseInline,he.Parser=Bi,he.parser=Bi.parse,he.Renderer=$o,he.TextRenderer=Sa,he.Lexer=xn,he.lexer=xn.lex,he.Tokenizer=S,he.Hooks=_l,he.parse=he;let se=he.options,P=he.setOptions,J=he.use,ue=he.walkTokens,Ye=he.parseInline,yt=he,Kn=Bi.parse,vi=xn.lex;e.Hooks=_l,e.Lexer=xn,e.Marked=Mr,e.Parser=Bi,e.Renderer=$o,e.TextRenderer=Sa,e.Tokenizer=S,e.getDefaults=t,e.lexer=vi,e.marked=he,e.options=se,e.parse=yt,e.parseInline=Ye,e.parser=Kn,e.setOptions=P,e.use=J,e.walkTokens=ue})})();var WJe=hi.Hooks||exports.Hooks,VJe=hi.Lexer||exports.Lexer,HJe=hi.Marked||exports.Marked,UJe=hi.Parser||exports.Parser,uk=hi.Renderer||exports.Renderer,zJe=hi.TextRenderer||exports.TextRenderer,KJe=hi.Tokenizer||exports.Tokenizer,J2=hi.defaults||exports.defaults,GJe=hi.getDefaults||exports.getDefaults,Of=hi.lexer||exports.lexer,$Je=hi.marked||exports.marked,jJe=hi.options||exports.options,eB=hi.parse||exports.parse,qJe=hi.parseInline||exports.parseInline,tB=hi.parser||exports.parser,YJe=hi.setOptions||exports.setOptions,QJe=hi.use||exports.use,ZJe=hi.walkTokens||exports.walkTokens;var pk=Object.freeze({image:({href:o,title:e,text:t})=>{let n=[],i=[];return o&&({href:o,dimensions:n}=DP(o),i.push(`src="${sg(o)}"`)),t&&i.push(`alt="${sg(t)}"`),e&&i.push(`title="${sg(e)}"`),n.length&&(i=i.concat(n)),"<img "+i.join(" ")+">"},paragraph({tokens:o}){return`<p>${this.parser.parseInline(o)}</p>`},link({href:o,title:e,tokens:t}){let n=this.parser.parseInline(t);return typeof o!="string"?"":(o===n&&(n=Uv(n)),e=typeof e=="string"?sg(Uv(e)):"",o=Uv(o),o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${o}" title="${e||o}" draggable="false">${n}</a>`)}});function Ff(o,e={},t={}){let n=new te,i=!1,r=uS(e),s=function(f){let b;try{b=V1(decodeURIComponent(f))}catch{}return b?(b=RP(b,v=>{if(o.uris&&o.uris[v])return be.revive(o.uris[v])}),encodeURIComponent(JSON.stringify(b))):f},a=function(f,b){let v=o.uris&&o.uris[f],I=be.revive(v);return b?f.startsWith($e.data+":")?f:(I||(I=be.parse(f)),Zd.uriToBrowserUri(I).toString(!0)):!I||be.parse(f).toString()===I.toString()?f:(I.query&&(I=I.with({query:s(I.query)})),I.toString())},l=new uk;l.image=pk.image,l.link=pk.link,l.paragraph=pk.paragraph;let d=[],c=[];if(e.codeBlockRendererSync?l.code=({text:f,lang:b})=>{let v=ck.nextId(),I=e.codeBlockRendererSync(nB(b),f);return c.push([v,I]),`<div class="code" data-code="${v}">${Yd(f)}</div>`}:e.codeBlockRenderer&&(l.code=({text:f,lang:b})=>{let v=ck.nextId(),I=e.codeBlockRenderer(nB(b),f);return d.push(I.then(C=>[v,C])),`<div class="code" data-code="${v}">${Yd(f)}</div>`}),e.actionHandler){let f=function(I){let C=I.target.closest("a[data-href]");if(Zn(C))try{let S=C.dataset.href;S&&(o.baseUri&&(S=hk(be.from(o.baseUri),S)),e.actionHandler.callback(S,I))}catch(S){Ue(S)}finally{I.preventDefault()}},b=e.actionHandler.disposables.add(new We(r,"click")),v=e.actionHandler.disposables.add(new We(r,"auxclick"));e.actionHandler.disposables.add(de.any(b.event,v.event)(I=>{let C=new wi(fe(r),I);!C.leftButton&&!C.middleButton||f(C)})),e.actionHandler.disposables.add(q(r,"keydown",I=>{let C=new pt(I);!C.equals(10)&&!C.equals(3)||f(C)}))}o.supportHtml||(l.html=({text:f})=>e.sanitizerOptions?.replaceWithPlaintext?Yd(f):(o.isTrusted?f.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?f:""),t.renderer=l;let u=o.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}\u2026`),o.supportThemeIcons&&(u=kP(u));let p;if(e.fillInIncompleteTokens){let f={...J2,...t},b=Of(u,f),v=zz(b);p=tB(v,f)}else p=eB(u,{...t,async:!1});o.supportThemeIcons&&(p=eu(p).map(b=>typeof b=="string"?b:b.outerHTML).join(""));let g=new DOMParser().parseFromString(iB({isTrusted:o.isTrusted,...e.sanitizerOptions},p),"text/html");if(g.body.querySelectorAll("img, audio, video, source").forEach(f=>{let b=f.getAttribute("src");if(b){let v=b;try{o.baseUri&&(v=hk(be.from(o.baseUri),v))}catch{}if(f.setAttribute("src",a(v,!0)),e.remoteImageIsAllowed){let I=be.parse(v);I.scheme!==$e.file&&I.scheme!==$e.data&&!e.remoteImageIsAllowed(I)&&f.replaceWith(Se("",void 0,f.outerHTML))}}}),g.body.querySelectorAll("a").forEach(f=>{let b=f.getAttribute("href");if(f.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!o.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))f.replaceWith(...f.childNodes);else{let v=a(b,!1);o.baseUri&&(v=hk(be.from(o.baseUri),b)),f.dataset.href=v}}),r.innerHTML=iB({isTrusted:o.isTrusted,...e.sanitizerOptions},g.body.innerHTML),d.length>0)Promise.all(d).then(f=>{if(i)return;let b=new Map(f),v=r.querySelectorAll("div[data-code]");for(let I of v){let C=b.get(I.dataset.code??"");C&&Xp(I,C)}e.asyncRenderCallback?.()});else if(c.length>0){let f=new Map(c),b=r.querySelectorAll("div[data-code]");for(let v of b){let I=f.get(v.dataset.code??"");I&&Xp(v,I)}}if(e.asyncRenderCallback)for(let f of r.getElementsByTagName("img")){let b=n.add(q(f,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}return{element:r,dispose:()=>{i=!0,n.dispose()}}}function nB(o){if(!o)return"";let e=o.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:o}function hk(o,e){return/^\w[\w\d+.-]*:/.test(e)?e:o.path.endsWith("/")?dE(o,e).toString():dE(Iv(o),e).toString()}var Oz=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function iB(o,e){let{config:t,allowedSchemes:n}=Bz(o),i=new te;i.add(oB("uponSanitizeAttribute",(r,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(r.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(r.tagName==="INPUT"&&r.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),i.add(oB("uponSanitizeElement",(r,s)=>{if(s.tagName==="input"&&(r.attributes.getNamedItem("type")?.value==="checkbox"?r.setAttribute("disabled",""):o.replaceWithPlaintext||r.remove()),o.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&r.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${r.textContent}-->`;else{let p=Oz.includes(s.tagName),m=r.attributes.length?" "+Array.from(r.attributes).map(g=>`${g.name}="${g.value}"`).join(" "):"";a=`<${s.tagName}${m}>`,p||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=r.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let u=l?r.parentElement.ownerDocument.createTextNode(l):void 0;for(;r.firstChild;)d.appendChild(r.firstChild);u&&d.appendChild(u),r.parentElement.replaceChild(d,r)}})),i.add(C2(n));try{return tC(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{i.dispose()}}var Fz=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function Bz(o){let e=[$e.http,$e.https,$e.mailto,$e.data,$e.file,$e.vscodeFileResource,$e.vscodeRemote,$e.vscodeRemoteResource];return o.isTrusted&&e.push($e.command),{config:{ALLOWED_TAGS:o.allowedTags??[...S2],ALLOWED_ATTR:Fz,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function rB(){let o=new uk;return o.code=({text:e})=>e,o.blockquote=({text:e})=>e+`
`,o.html=e=>"",o.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.hr=()=>"",o.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},o.listitem=({text:e})=>e+`
`,o.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.table=function({header:e,rows:t}){return e.map(n=>this.tablecell(n)).join(" ")+`
`+t.map(n=>n.map(i=>this.tablecell(i)).join(" ")).join(`
`)+`
`},o.tablerow=({text:e})=>e,o.tablecell=function({tokens:e}){return this.parser.parseInline(e)},o.strong=({text:e})=>e,o.em=({text:e})=>e,o.codespan=({text:e})=>e,o.br=e=>`
`,o.del=({text:e})=>e,o.image=e=>"",o.text=({text:e})=>e,o.link=({text:e})=>e,o}var xet=new Nn(o=>rB()),_et=new Nn(()=>{let o=rB();return o.code=({text:e})=>`
\`\`\`
${e}
\`\`\`
`,o});function IS(o){let e="";return o.forEach(t=>{e+=t.raw}),e}function sB(o){if(o.tokens)for(let e=o.tokens.length-1;e>=0;e--){let t=o.tokens[e];if(t.type==="text"){let n=t.raw.split(`
`),i=n[n.length-1];if(i.includes("`"))return Gz(o);if(i.includes("**"))return Zz(o);if(i.match(/\*\w/))return $z(o);if(i.match(/(^|\s)__\w/))return Xz(o);if(i.match(/(^|\s)_\w/))return jz(o);if(Wz(i)||Vz(i)&&o.tokens.slice(0,e).some(r=>r.type==="text"&&r.raw.match(/\[[^\]]*$/))){let r=o.tokens.slice(e+1);return r[0]?.type==="link"&&r[1]?.type==="text"&&r[1].raw.match(/^ *"[^"]*$/)||i.match(/^[^"]* +"[^"]*$/)?Yz(o):qz(o)}else if(i.match(/(^|\s)\[\w*/))return Qz(o)}}}function Wz(o){return!!o.match(/(^|\s)\[.*\]\(\w*/)}function Vz(o){return!!o.match(/^[^\[]*\]\([^\)]*$/)}function Hz(o){let e=o.items[o.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,n;if(t?.type==="text"&&!("inRawBlock"in e)&&(n=sB(t)),!n||n.type!=="paragraph")return;let i=IS(o.items.slice(0,-1)),r=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!r)return;let s=r+IS(e.tokens.slice(0,-1))+n.raw,a=Of(i+s)[0];if(a.type==="list")return a}var Uz=3;function zz(o){for(let e=0;e<Uz;e++){let t=Kz(o);if(t)o=t;else break}return o}function Kz(o){let e,t;for(e=0;e<o.length;e++){let n=o[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=Jz(o.slice(e));break}if(e===o.length-1&&n.type==="list"){let i=Hz(n);if(i){t=[i];break}}if(e===o.length-1&&n.type==="paragraph"){let i=sB(n);if(i){t=[i];break}}}if(t){let n=[...o.slice(0,e),...t];return n.links=o.links,n}return null}function Gz(o){return yd(o,"`")}function $z(o){return yd(o,"*")}function jz(o){return yd(o,"_")}function qz(o){return yd(o,")")}function Yz(o){return yd(o,'")')}function Qz(o){return yd(o,"](https://microsoft.com)")}function Zz(o){return yd(o,"**")}function Xz(o){return yd(o,"__")}function yd(o,e){let t=IS(Array.isArray(o)?o:[o]);return Of(t+e)[0]}function Jz(o){let e=IS(o),t=e.split(`
`),n,i=!1;for(let r=0;r<t.length;r++){let s=t[r].trim();if(typeof n>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(n=a.length)}else if(typeof n=="number")if(s.match(/^\s*\|/)){if(r!==t.length-1)return;i=!0}else return}if(typeof n=="number"&&n>0){let r=i?t.slice(0,-1).join(`
`):e,s=!!r.match(/\|\s*$/),a=r+(s?"":"|")+`
|${" --- |".repeat(n)}`;return Of(a)}}function oB(o,e){return nC(o,e),ge(()=>iC(o))}var e7={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function mi(){return e7}var tu=Se,aB="selectOption.entry.template",mk=class{get templateId(){return aB}renderTemplate(e){let t=Object.create(null);return t.root=e,t.text=Ee(e,tu(".option-text")),t.detail=Ee(e,tu(".option-detail")),t.decoratorRight=Ee(e,tu(".option-decorator-right")),t}renderElement(e,t,n){let i=n,r=e.text,s=e.detail,a=e.decoratorRight,l=e.isDisabled;i.text.textContent=r,i.detail.textContent=s||"",i.decoratorRight.innerText=a||"",l?i.root.classList.add("option-disabled"):i.root.classList.remove("option-disabled")}disposeTemplate(e){}},CS=class o extends W{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(e,t,n,i,r){super(),this._isVisible=!1,this.styles=i,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=o.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new L,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(n),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(mi().setupManagedHover(dn("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return aB}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=Se(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=Ee(this.selectDropDownContainer,tu(".select-box-details-pane"));let t=Ee(this.selectDropDownContainer,tu(".select-box-dropdown-container-width-control")),n=Ee(t,tu(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",Ee(n,this.widthControlElement),this._dropDownPosition=0,this.styleElement=as(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(q(this.selectDropDownContainer,we.DRAG_START,i=>{it.stop(i,!0)}))}registerListeners(){this._register(Wn(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(q(this.selectElement,we.CLICK,t=>{it.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(q(this.selectElement,we.MOUSE_DOWN,t=>{it.stop(t)}));let e;this._register(q(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(q(this.selectElement,"touchend",t=>{it.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(q(this.selectElement,we.KEY_DOWN,t=>{let n=new pt(t),i=!1;Be?(n.keyCode===18||n.keyCode===16||n.keyCode===10||n.keyCode===3)&&(i=!0):(n.keyCode===18&&n.altKey||n.keyCode===16&&n.altKey||n.keyCode===10||n.keyCode===3)&&(i=!0),i&&(this.showSelectDropDown(),it.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){Kt(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled)),typeof n.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setEnabled(e){this.selectElement.disabled=!e}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){let e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",n=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=n}styleList(){let e=this.styles.selectBackground??"",t=ls(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;let n=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=n,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,n)=>{this.updateDetail(n),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let t=fe(this.selectElement),n=Zi(this.selectElement),i=fe(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(i.getPropertyValue("--dropdown-padding-top"))+parseFloat(i.getPropertyValue("--dropdown-padding-bottom")),s=t.innerHeight-n.top-n.height-(this.selectBoxOptions.minBottomMargin||0),a=n.top-o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let p=this._hasDetails?this._cachedMaxDetailsHeight:0,m=u+r+p,g=Math.floor((s-r-p)/this.getHeight()),f=Math.floor((a-r-p)/this.getHeight());if(e)return n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||g<1&&f<1?!1:(g<o.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&f>g&&this.options.length>g?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&g<1||this._dropDownPosition===1&&f<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&g+f<1)return this.hideSelectDropDown(!0),!1;m>s&&(u=g*this.getHeight())}else m>a&&(u=f*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let n=0,i=0;this.options.forEach((r,s)=>{let a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,d=r.text.length+a+l;d>i&&(n=s,i=d)}),e.textContent=this.options[n].text+(this.options[n].decoratorRight?this.options[n].decoratorRight+" ":""),t=Zp(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=Ee(e,tu(".select-box-dropdown-list-container")),this.listRenderer=new mk,this.selectList=this._register(new Io("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:i=>{let r=i.text;return i.detail&&(r+=`. ${i.detail}`),i.decoratorRight&&(r+=`. ${i.decoratorRight}`),i.description&&(r+=`. ${i.description}`),r},getWidgetAriaLabel:()=>h({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Be?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let t=this._register(new We(this.selectDropDownListContainer,"keydown")),n=de.chain(t.event,i=>i.filter(()=>this.selectList.length>0).map(r=>new pt(r)));this._register(de.chain(n,i=>i.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(q(this.selectList.getHTMLElement(),we.POINTER_UP,i=>this.onPointerUp(i))),this._register(this.selectList.onMouseOver(i=>typeof i.index<"u"&&this.selectList.setFocus([i.index]))),this._register(this.selectList.onDidChangeFocus(i=>this.onListFocus(i))),this._register(q(this.selectDropDownContainer,we.FOCUS_OUT,i=>{!this._isVisible||xr(i.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;it.stop(e);let t=e.target;if(!t||t.classList.contains("slider"))return;let n=t.closest(".monaco-list-row");if(!n)return;let i=Number(n.getAttribute("data-index")),r=n.classList.contains("option-disabled");i>=0&&i<this.options.length&&!r&&(this.selected=i,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){let n=r=>{for(let s=0;s<r.childNodes.length;s++){let a=r.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():n(a)}},i=Ff({value:e,supportThemeIcons:!0},{actionHandler:t});return i.element.classList.add("select-box-description-markdown"),n(i.element),i.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";let t=this.options[e],n=t?.description??"",i=t?.descriptionIsMarkdown??!1;if(n){if(i){let r=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(n,r))}else this.selectionDetailsPane.innerText=n;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){it.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){it.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){it.stop(e,!0);let t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(it.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){it.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){it.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){it.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){it.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){let t=tf.toString(e.keyCode),n=-1;for(let i=0;i<this.options.length-1;i++)if(n=(i+this.selected+1)%this.options.length,this.options[n].text.charAt(0).toUpperCase()===t&&!this.options[n].isDisabled){this.select(n),this.selectList.setFocus([n]),this.selectList.reveal(this.selectList.getFocus()[0]),it.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var SS=class extends W{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(e,t,n,i){super(),this.selectBoxOptions=i||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new L),this.styles=n,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Sn.addTarget(this.selectElement)),[ht.Tap].forEach(e=>{this._register(q(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(Wn(this.selectElement,"click",e=>{it.stop(e,!0)})),this._register(Wn(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(Wn(this.selectElement,"keydown",e=>{let t=!1;Be?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!Kt(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",e)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(e){this.selectElement.disabled=!e}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(e){this.styles=e,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}};var Ntt={...X2,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},xS=class extends pi{selectBoxDelegate;constructor(e,t,n,i,r){super(),Be&&!r?.useCustomDrawn?this.selectBoxDelegate=new SS(e,t,i,r):this.selectBoxDelegate=new CS(e,t,n,i,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}setAriaLabel(e){this.selectBoxDelegate.setAriaLabel(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}setEnabled(e){this.selectBoxDelegate.setEnabled(e)}render(e){this.selectBoxDelegate.render(e)}};var dl=class extends pi{_onChange=this._register(new L);onChange=this._onChange.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(e){super(),this._opts=e,this._checked=this._opts.isChecked;let t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Je.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(mi().setupManagedHover(e.hoverDelegate??dn("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,n=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),n.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,n=>{if(n.keyCode===10||n.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),n.preventDefault(),n.stopPropagation();return}this._onKeyDown.fire(n)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...Je.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...Je.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(e){this._hover.update(e),this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var Oi=class extends W{constructor(t,n,i={}){super();this.options=i;this._context=t||this,this._action=n,n instanceof er&&this._register(n.onDidChange(r=>{this.element&&this.handleActionChangeEvent(r)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(t){t.enabled!==void 0&&this.updateEnabled(),t.checked!==void 0&&this.updateChecked(),t.class!==void 0&&this.updateClass(),t.label!==void 0&&(this.updateLabel(),this.updateTooltip()),t.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new Ur)),this._actionRunner}set actionRunner(t){this._actionRunner=t}isEnabled(){return this._action.enabled}setActionContext(t){this._context=t}render(t){let n=this.element=t;this._register(Sn.addTarget(t));let i=this.options&&this.options.draggable;i&&(t.draggable=!0,Dn&&this._register(q(t,we.DRAG_START,r=>r.dataTransfer?.setData(rS.TEXT,this._action.label)))),this._register(q(n,ht.Tap,r=>this.onClick(r,!0))),this._register(q(n,we.MOUSE_DOWN,r=>{i||it.stop(r,!0),this._action.enabled&&r.button===0&&n.classList.add("active")})),Be&&this._register(q(n,we.CONTEXT_MENU,r=>{r.button===0&&r.ctrlKey===!0&&this.onClick(r)})),this._register(q(n,we.CLICK,r=>{it.stop(r,!0),this.options&&this.options.isMenu||this.onClick(r)})),this._register(q(n,we.DBLCLICK,r=>{it.stop(r,!0)})),[we.MOUSE_UP,we.MOUSE_OUT].forEach(r=>{this._register(q(n,r,s=>{it.stop(s),n.classList.remove("active")}))})}onClick(t,n=!1){it.stop(t,!0);let i=Ii(this._context)?this.options?.useEventAsContext?t:{preserveFocus:n}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(t){this.element&&(this.element.tabIndex=t?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let t=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=t;else if(!this.customHover&&t!==""){let n=this.options.hoverDelegate??dn("element");this.customHover=this._store.add(mi().setupManagedHover(n,this.element,t))}else this.customHover&&this.customHover.update(t)}updateAriaLabel(){if(this.element){let t=this.getTooltip()??"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},ha=class extends Oi{label;options;cssClass;constructor(e,t,n){super(e,t,n),this.options=n,this.options.icon=n.icon!==void 0?n.icon:!1,this.options.label=n.label!==void 0?n.label:!0,this.cssClass=""}render(e){super.render(e),Ci(this.element);let t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){let n=document.createElement("span");n.classList.add("keybinding"),n.textContent=this.options.keybinding,this.element.appendChild(n)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===On.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=h({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},_S=class extends Oi{selectBox;constructor(e,t,n,i,r,s,a){super(e,t),this.selectBox=new xS(n,i,r,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(e,t){this.selectBox.setOptions(e,t)}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}};var Sh=class{modifierLabels;constructor(e,t,n=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=n}toLabel(e,t,n){if(t.length===0)return null;let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=n(a);if(l===null)return null;i[r]=t7(a,l,this.modifierLabels[e])}return i.join(" ")}},wS=new Sh({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:h({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:h({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:h({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:h({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),Pnt=new Sh({ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:h({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),Ant=new Sh({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),Nnt=new Sh({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function t7(o,e,t){if(e===null)return"";let n=[];return o.ctrlKey&&n.push(t.ctrlKey),o.shiftKey&&n.push(t.shiftKey),o.altKey&&n.push(t.altKey),o.metaKey&&n.push(t.metaKey),e!==""&&n.push(e),n.join(t.separator)}var ES=Se,lB={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0},TS=class o extends W{constructor(t,n,i){super();this.os=n;this.options=i||Object.create(null);let r=this.options.keybindingLabelForeground;this.domNode=Ee(t,ES(".monaco-keybinding")),r&&(this.domNode.style.color=r),this.hover=this._register(mi().setupManagedHover(dn("mouse"),this.domNode,"")),this.didEverRender=!1,t.appendChild(this.domNode)}domNode;options;keyElements=new Set;hover;keybinding;matches;didEverRender;get element(){return this.domNode}set(t,n){this.didEverRender&&this.keybinding===t&&o.areSame(this.matches,n)||(this.keybinding=t,this.matches=n,this.render())}render(){if(this.clear(),this.keybinding){let t=this.keybinding.getChords();t[0]&&this.renderChord(this.domNode,t[0],this.matches?this.matches.firstPart:null);for(let i=1;i<t.length;i++)Ee(this.domNode,ES("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,t[i],this.matches?this.matches.chordPart:null);let n=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(n),this.domNode.setAttribute("aria-label",n||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){di(this.domNode),this.keyElements.clear()}renderChord(t,n,i){let r=wS.modifierLabels[this.os];n.ctrlKey&&this.renderKey(t,r.ctrlKey,!!i?.ctrlKey,r.separator),n.shiftKey&&this.renderKey(t,r.shiftKey,!!i?.shiftKey,r.separator),n.altKey&&this.renderKey(t,r.altKey,!!i?.altKey,r.separator),n.metaKey&&this.renderKey(t,r.metaKey,!!i?.metaKey,r.separator);let s=n.keyLabel;s&&this.renderKey(t,s,!!i?.keyCode,"")}renderKey(t,n,i,r){Ee(t,this.createKeyElement(n,i?".highlight":"")),r&&Ee(t,ES("span.monaco-keybinding-key-separator",void 0,r))}renderUnbound(t){Ee(t,this.createKeyElement(h("unbound","Unbound")))}createKeyElement(t,n=""){let i=ES("span.monaco-keybinding-key"+n,void 0,t);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(t,n){return t===n||!t&&!n?!0:!!t&&!!n&&sn(t.firstPart,n.firstPart)&&sn(t.chordPart,n.chordPart)}};var dB="editor.action.inlineSuggest.commit",cB="editor.action.inlineSuggest.showPrevious",uB="editor.action.inlineSuggest.showNext";var n7=[];function pB(){return n7}var LS=class{constructor(e,t){this.startColumn=e;this.endColumnExclusive=t;if(e>t)throw new Ke(`startColumn ${e} cannot be after endColumnExclusive ${t}`)}toRange(e){return new w(e,this.startColumn,e,this.endColumnExclusive)}equals(e){return this.startColumn===e.startColumn&&this.endColumnExclusive===e.endColumnExclusive}};function hB(o,e){return new R(o.lineNumber+e.lineNumber-1,e.lineNumber===1?o.column+e.column-1:e.column)}function gk(o,e){return new R(o.lineNumber-e.lineNumber+1,o.lineNumber-e.lineNumber===0?o.column-e.column+1:o.column)}var Id=class{constructor(e,t){this.lineNumber=e;this.parts=t}equals(e){return this.lineNumber===e.lineNumber&&this.parts.length===e.parts.length&&this.parts.every((t,n)=>t.equals(e.parts[n]))}render(e,t=!1){return new il([...this.parts.map(n=>new hn(w.fromPositions(new R(this.lineNumber,n.column)),t?`[${n.lines.join(`
`)}]`:n.lines.join(`
`)))]).applyToString(e)}renderForScreenReader(e){if(this.parts.length===0)return"";let t=this.parts[this.parts.length-1],n=e.substr(0,t.column-1);return new il([...this.parts.map(r=>new hn(w.fromPositions(new R(1,r.column)),r.lines.join(`
`)))]).applyToString(n).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every(e=>e.lines.length===0)}get lineCount(){return 1+this.parts.reduce((e,t)=>e+t.lines.length-1,0)}},xh=class{constructor(e,t,n){this.column=e;this.text=t;this.preview=n}lines=Fr(this.text);equals(e){return this.column===e.column&&this.lines.length===e.lines.length&&this.lines.every((t,n)=>t===e.lines[n])}},_h=class{constructor(e,t,n,i=0){this.lineNumber=e;this.columnRange=t;this.text=n;this.additionalReservedLineCount=i}parts=[new xh(this.columnRange.endColumnExclusive,this.text,!1)];newLines=Fr(this.text);renderForScreenReader(e){return this.newLines.join(`
`)}render(e,t=!1){let n=this.columnRange.toRange(this.lineNumber);return t?new il([new hn(w.fromPositions(n.getStartPosition()),"("),new hn(w.fromPositions(n.getEndPosition()),`)[${this.newLines.join(`
`)}]`)]).applyToString(e):new il([new hn(n,this.newLines.join(`
`))]).applyToString(e)}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every(e=>e.lines.length===0)}equals(e){return this.lineNumber===e.lineNumber&&this.columnRange.equals(e.columnRange)&&this.newLines.length===e.newLines.length&&this.newLines.every((t,n)=>t===e.newLines[n])&&this.additionalReservedLineCount===e.additionalReservedLineCount}};function fk(o,e){return Kt(o,e,bk)}function bk(o,e){return o===e?!0:!o||!e?!1:o instanceof Id&&e instanceof Id||o instanceof _h&&e instanceof _h?o.equals(e):!1}function mB(o,e){let t=new ep,n=new np(t,d=>e.getLanguageConfiguration(d)),i=new ip(new vk([o]),n),r=Dg(i,[],void 0,!0),s="",a=o.getLineContent();function l(d,c){if(d.kind===2)if(l(d.openingBracket,c),c=bt(c,d.openingBracket.length),d.child&&(l(d.child,c),c=bt(c,d.child.length)),d.closingBracket)l(d.closingBracket,c),c=bt(c,d.closingBracket.length);else{let p=n.getSingleLanguageBracketTokens(d.openingBracket.languageId).findClosingTokenText(d.openingBracket.bracketIds);s+=p}else if(d.kind!==3){if(d.kind===0||d.kind===1)s+=a.substring(c,bt(c,d.length));else if(d.kind===4)for(let u of d.children)l(u,c),c=bt(c,u.length)}}return l(r,Cn),s}var vk=class{constructor(e){this.lines=e}getValue(){return this.lines.map(e=>e.getLineContent()).join(`
`)}getLineCount(){return this.lines.length}getLineLength(e){return this.lines[e-1].getLineContent().length}tokenization={getLineTokens:e=>this.lines[e-1]}};var yk=class o{static _table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}value="";pos=0;text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let e=this.pos,t=0,n=this.value.charCodeAt(e),i;if(i=o._table[n],typeof i=="number")return this.pos+=1,{type:i,pos:e,len:1};if(o.isDigitCharacter(n)){i=8;do t+=1,n=this.value.charCodeAt(e+t);while(o.isDigitCharacter(n));return this.pos+=t,{type:i,pos:e,len:t}}if(o.isVariableCharacter(n)){i=9;do n=this.value.charCodeAt(e+ ++t);while(o.isVariableCharacter(n)||o.isDigitCharacter(n));return this.pos+=t,{type:i,pos:e,len:t}}i=10;do t+=1,n=this.value.charCodeAt(e+t);while(!isNaN(n)&&typeof o._table[n]>"u"&&!o.isDigitCharacter(n)&&!o.isVariableCharacter(n));return this.pos+=t,{type:i,pos:e,len:t}}},Cd=class{_markerBrand;parent;_children=[];appendChild(e){return e instanceof Jn&&this._children[this._children.length-1]instanceof Jn?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){let{parent:n}=e,i=n.children.indexOf(e),r=n.children.slice(0);r.splice(i,1,...t),n._children=r,function s(a,l){for(let d of a)d.parent=l,s(d.children,d)}(t,n)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof wh)return e;e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),"")}len(){return 0}},Jn=class o extends Cd{constructor(t){super();this.value=t}static escape(t){return t.replace(/\$|}|\\/g,"\\$&")}toString(){return this.value}toTextmateString(){return o.escape(this.value)}len(){return this.value.length}clone(){return new o(this.value)}},kS=class extends Cd{transform},zo=class o extends kS{constructor(t){super();this.index=t}static compareByIndex(t,n){return t.index===n.index?0:t.isFinalTabstop?1:n.isFinalTabstop||t.index<n.index?-1:t.index>n.index?1:0}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof nu?this._children[0]:void 0}toTextmateString(){let t="";return this.transform&&(t=this.transform.toTextmateString()),this.children.length===0&&!this.transform?`$${this.index}`:this.children.length===0?`\${${this.index}${t}}`:this.choice?`\${${this.index}|${this.choice.toTextmateString()}|${t}}`:`\${${this.index}:${this.children.map(n=>n.toTextmateString()).join("")}${t}}`}clone(){let t=new o(this.index);return this.transform&&(t.transform=this.transform.clone()),t._children=this.children.map(n=>n.clone()),t}},nu=class o extends Cd{options=[];appendChild(e){return e instanceof Jn&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}toTextmateString(){return this.options.map(e=>e.value.replace(/\||,|\\/g,"\\$&")).join(",")}len(){return this.options[0].len()}clone(){let e=new o;return this.options.forEach(e.appendChild,e),e}},Ik=class o extends Cd{regexp=new RegExp("");resolve(e){let t=this,n=!1,i=e.replace(this.regexp,function(){return n=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))});return!n&&this._children.some(r=>r instanceof ms&&!!r.elseValue)&&(i=this._replace([])),i}_replace(e){let t="";for(let n of this._children)if(n instanceof ms){let i=e[n.index]||"";i=n.resolve(i),t+=i}else t+=n.toString();return t}toString(){return""}toTextmateString(){return`/${this.regexp.source}/${this.children.map(e=>e.toTextmateString())}/${(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")}`}clone(){let e=new o;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(t=>t.clone()),e}},ms=class o extends Cd{constructor(t,n,i,r){super();this.index=t;this.shorthandName=n;this.ifValue=i;this.elseValue=r}resolve(t){return this.shorthandName==="upcase"?t?t.toLocaleUpperCase():"":this.shorthandName==="downcase"?t?t.toLocaleLowerCase():"":this.shorthandName==="capitalize"?t?t[0].toLocaleUpperCase()+t.substr(1):"":this.shorthandName==="pascalcase"?t?this._toPascalCase(t):"":this.shorthandName==="camelcase"?t?this._toCamelCase(t):"":t&&typeof this.ifValue=="string"?this.ifValue:!t&&typeof this.elseValue=="string"?this.elseValue:t||""}_toPascalCase(t){let n=t.match(/[a-z0-9]+/gi);return n?n.map(i=>i.charAt(0).toUpperCase()+i.substr(1)).join(""):t}_toCamelCase(t){let n=t.match(/[a-z0-9]+/gi);return n?n.map((i,r)=>r===0?i.charAt(0).toLowerCase()+i.substr(1):i.charAt(0).toUpperCase()+i.substr(1)).join(""):t}toTextmateString(){let t="${";return t+=this.index,this.shorthandName?t+=`:/${this.shorthandName}`:this.ifValue&&this.elseValue?t+=`:?${this.ifValue}:${this.elseValue}`:this.ifValue?t+=`:+${this.ifValue}`:this.elseValue&&(t+=`:-${this.elseValue}`),t+="}",t}clone(){return new o(this.index,this.shorthandName,this.ifValue,this.elseValue)}},Bf=class o extends kS{constructor(t){super();this.name=t}resolve(t){let n=t.resolve(this);return this.transform&&(n=this.transform.resolve(n||"")),n!==void 0?(this._children=[new Jn(n)],!0):!1}toTextmateString(){let t="";return this.transform&&(t=this.transform.toTextmateString()),this.children.length===0?`\${${this.name}${t}}`:`\${${this.name}:${this.children.map(n=>n.toTextmateString()).join("")}${t}}`}clone(){let t=new o(this.name);return this.transform&&(t.transform=this.transform.clone()),t._children=this.children.map(n=>n.clone()),t}};function gB(o,e){let t=[...o];for(;t.length>0;){let n=t.shift();if(!e(n))break;t.unshift(...n.children)}}var wh=class o extends Cd{_placeholders;get placeholderInfo(){if(!this._placeholders){let e=[],t;this.walk(function(n){return n instanceof zo&&(e.push(n),t=!t||t.index<n.index?n:t),!0}),this._placeholders={all:e,last:t}}return this._placeholders}get placeholders(){let{all:e}=this.placeholderInfo;return e}offset(e){let t=0,n=!1;return this.walk(i=>i===e?(n=!0,!1):(t+=i.len(),!0)),n?t:-1}fullLen(e){let t=0;return gB([e],n=>(t+=n.len(),!0)),t}enclosingPlaceholders(e){let t=[],{parent:n}=e;for(;n;)n instanceof zo&&t.push(n),n=n.parent;return t}resolveVariables(e){return this.walk(t=>(t instanceof Bf&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}toTextmateString(){return this.children.reduce((e,t)=>e+t.toTextmateString(),"")}clone(){let e=new o;return this._children=this.children.map(t=>t.clone()),e}walk(e){gB(this.children,e)}},ur=class o{static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static asInsertText(e){return new o().parse(e).toString()}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}_scanner=new yk;_token={type:14,pos:0,len:0};parse(e,t,n){let i=new wh;return this.parseFragment(e,i),this.ensureFinalTabstop(i,n??!1,t??!1),i}parseFragment(e,t){let n=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););let i=new Map,r=[];t.walk(l=>(l instanceof zo&&(l.isFinalTabstop?i.set(0,void 0):!i.has(l.index)&&l.children.length>0?i.set(l.index,l.children):r.push(l)),!0));let s=(l,d)=>{let c=i.get(l.index);if(!c)return;let u=new zo(l.index);u.transform=l.transform;for(let p of c){let m=p.clone();u.appendChild(m),m instanceof zo&&i.has(m.index)&&!d.has(m.index)&&(d.add(m.index),s(m,d),d.delete(m.index))}t.replace(l,[u])},a=new Set;for(let l of r)s(l,a);return t.children.slice(n)}ensureFinalTabstop(e,t,n){(t||n&&e.placeholders.length>0)&&(e.placeholders.find(r=>r.index===0)||e.appendChild(new zo(0)))}_accept(e,t){if(e===void 0||this._token.type===e){let n=t?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),n}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){let t=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){let i=this._scanner.next();if(i.type!==0&&i.type!==4&&i.type!==5)return!1}this._token=this._scanner.next()}let n=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),n}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return(t=this._accept(5,!0))?(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new Jn(t)),!0):!1}_parseTabstopOrVariableName(e){let t,n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new zo(Number(t)):new Bf(t)),!0):this._backTo(n)}_parseComplexPlaceholder(e){let t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);let r=new zo(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new Jn("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(r.index>0&&this._accept(7)){let s=new nu;for(;;){if(this._parseChoiceElement(s)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(s),this._accept(4)))return e.appendChild(r),!0}return this._backTo(n),!1}}else return this._accept(6)?this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(r),!0):this._backTo(n)}_parseChoiceElement(e){let t=this._token,n=[];for(;!(this._token.type===2||this._token.type===7);){let i;if((i=this._accept(5,!0))?i=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||i:i=this._accept(void 0,!0),!i)return this._backTo(t),!1;n.push(i)}return n.length===0?(this._backTo(t),!1):(e.appendChild(new Jn(n.join(""))),!0)}_parseComplexVariable(e){let t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);let r=new Bf(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new Jn("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(r),!0):this._backTo(n)}_parseTransform(e){let t=new Ik,n="",i="";for(;!this._accept(6);){let r;if(r=this._accept(5,!0)){r=this._accept(6,!0)||r,n+=r;continue}if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let r;if(r=this._accept(5,!0)){r=this._accept(5,!0)||this._accept(6,!0)||r,t.appendChild(new Jn(r));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(n,i)}catch{return!1}return e.transform=t,!0}_parseFormatString(e){let t=this._token;if(!this._accept(0))return!1;let n=!1;this._accept(3)&&(n=!0);let i=this._accept(8,!0);if(i)if(n){if(this._accept(4))return e.appendChild(new ms(Number(i))),!0;if(!this._accept(1))return this._backTo(t),!1}else return e.appendChild(new ms(Number(i))),!0;else return this._backTo(t),!1;if(this._accept(6)){let r=this._accept(9,!0);return!r||!this._accept(4)?(this._backTo(t),!1):(e.appendChild(new ms(Number(i),r)),!0)}else if(this._accept(11)){let r=this._until(4);if(r)return e.appendChild(new ms(Number(i),void 0,r,void 0)),!0}else if(this._accept(12)){let r=this._until(4);if(r)return e.appendChild(new ms(Number(i),void 0,void 0,r)),!0}else if(this._accept(13)){let r=this._until(1);if(r){let s=this._until(4);if(s)return e.appendChild(new ms(Number(i),void 0,r,s)),!0}}else{let r=this._until(4);if(r)return e.appendChild(new ms(Number(i),void 0,void 0,r)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new Jn(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}};async function bB(o,e,t,n,i=on.None,r){let s=e instanceof R?i7(e,t):e,a=o.all(t),l=new Ru;for(let v of a)v.groupId&&l.add(v.groupId,v);function d(v){if(!v.yieldsToGroupIds)return[];let I=[];for(let C of v.yieldsToGroupIds||[]){let S=l.get(C);for(let E of S)I.push(E)}return I}let c=new Map,u=new Set;function p(v,I){if(I=[...I,v],u.has(v))return I;u.add(v);try{let C=d(v);for(let S of C){let E=p(S,I);if(E)return E}}finally{u.delete(v)}}function m(v){let I=c.get(v);if(I)return I;let C=p(v,[]);C&&_a(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${C.map(E=>E.toString?E.toString():""+E).join(" -> ")}`));let S=new Os;return c.set(v,S.p),(async()=>{if(!C){let E=d(v);for(let M of E){let A=await m(M);if(A&&A.items.length>0)return}}try{return e instanceof R?await v.provideInlineCompletions(t,e,n,i):await v.provideInlineEdits?.(t,e,n,i)}catch(E){_a(E);return}})().then(E=>S.complete(E),E=>S.error(E)),S.p}let g=await Promise.all(a.map(async v=>({provider:v,completions:await m(v)}))),f=new Map,b=[];for(let v of g){let I=v.completions;if(!I)continue;let C=new Sk(I,v.provider);b.push(C);for(let S of I.items){let E=xk.from(S,C,s,t,r);f.set(E.hash(),E)}}return new Ck(Array.from(f.values()),new Set(f.keys()),b)}var Ck=class{constructor(e,t,n){this.completions=e;this.hashs=t;this.providerResults=n}has(e){return this.hashs.has(e.hash())}dispose(){for(let e of this.providerResults)e.removeRef()}},Sk=class{constructor(e,t){this.inlineCompletions=e;this.provider=t}refCount=1;addRef(){this.refCount++}removeRef(){this.refCount--,this.refCount===0&&this.provider.freeInlineCompletions(this.inlineCompletions)}},xk=class o{constructor(e,t,n,i,r,s,a,l){this.filterText=e;this.command=t;this.range=n;this.insertText=i;this.snippetInfo=r;this.additionalTextEdits=s;this.sourceInlineCompletion=a;this.source=l;e=e.replace(/\r\n|\r/g,`
`),i=e.replace(/\r\n|\r/g,`
`)}static from(e,t,n,i,r){let s,a,l=e.range?w.lift(e.range):n;if(typeof e.insertText=="string"){if(s=e.insertText,r&&e.completeBracketPairs){s=fB(s,l.getStartPosition(),i,r);let d=s.length-e.insertText.length;d!==0&&(l=new w(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+d))}a=void 0}else if("snippet"in e.insertText){let d=e.insertText.snippet.length;if(r&&e.completeBracketPairs){e.insertText.snippet=fB(e.insertText.snippet,l.getStartPosition(),i,r);let u=e.insertText.snippet.length-d;u!==0&&(l=new w(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+u))}let c=new ur().parse(e.insertText.snippet);c.children.length===1&&c.children[0]instanceof Jn?(s=c.children[0].value,a=void 0):(s=c.toString(),a={snippet:e.insertText.snippet,range:l})}else Nd(e.insertText);return new o(s,e.command,l,s,a,e.additionalTextEdits||pB(),e,t)}withRange(e){return new o(this.filterText,this.command,e,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}toSingleTextEdit(){return new hn(this.range,this.insertText)}};function i7(o,e){let t=e.getWordAtPosition(o),n=e.getLineMaxColumn(o.lineNumber);return t?new w(o.lineNumber,t.startColumn,o.lineNumber,n):w.fromPositions(o,o.with(void 0,n))}function fB(o,e,t,n){let r=t.getLineContent(e.lineNumber).substring(0,e.column-1)+o,s=rp.replace(Et.ofStartAndLength(e.column-1,r.length-(e.column-1)),o),l=t.tokenization.tokenizeLineWithEdit(e.lineNumber,s)?.mainLineTokens?.sliceAndInflate(e.column-1,r.length,0);return l?mB(l,n):o}function fa(o,e,t){let n=t?o.range.intersectRanges(t):o.range;if(!n)return o;let i=e.getValueInRange(n,1),r=Br(i,o.text),s=Pi.ofText(i.substring(0,r)).addToPosition(o.range.getStartPosition()),a=o.text.substring(r),l=w.fromPositions(s,o.range.getEndPosition());return new hn(l,a)}function RS(o,e){return o.text.startsWith(e.text)&&o7(o.range,e.range)}function _k(o,e,t,n,i=0){let r=fa(o,e);if(r.range.endLineNumber!==r.range.startLineNumber)return;let s=e.getLineContent(r.range.startLineNumber),a=Rt(s).length;if(r.range.startColumn-1<=a){let g=Rt(r.text).length,f=s.substring(r.range.startColumn-1,a),[b,v]=[r.range.getStartPosition(),r.range.getEndPosition()],I=b.column+f.length<=v.column?b.delta(0,f.length):v,C=w.fromPositions(I,v),S=r.text.startsWith(f)?r.text.substring(f.length):r.text.substring(g);r=new hn(C,S)}let d=e.getValueInRange(r.range),c=r7(d,r.text);if(!c)return;let u=r.range.startLineNumber,p=new Array;if(t==="prefix"){let g=c.filter(f=>f.originalLength===0);if(g.length>1||g.length===1&&g[0].originalStart!==d.length)return}let m=r.text.length-i;for(let g of c){let f=r.range.startColumn+g.originalStart+g.originalLength;if(t==="subwordSmart"&&n&&n.lineNumber===r.range.startLineNumber&&f<n.column||g.originalLength>0)return;if(g.modifiedLength===0)continue;let b=g.modifiedStart+g.modifiedLength,v=Math.max(g.modifiedStart,Math.min(b,m)),I=r.text.substring(g.modifiedStart,v),C=r.text.substring(v,Math.max(g.modifiedStart,b));I.length>0&&p.push(new xh(f,I,!1)),C.length>0&&p.push(new xh(f,C,!0))}return new Id(u,p)}function o7(o,e){return e.getStartPosition().equals(o.getStartPosition())&&e.getEndPosition().isBeforeOrEqual(o.getEndPosition())}var DS;function r7(o,e){if(DS?.originalValue===o&&DS?.newValue===e)return DS?.changes;{let t=yB(o,e,!0);if(t){let n=vB(t);if(n>0){let i=yB(o,e,!1);i&&vB(i)<n&&(t=i)}}return DS={originalValue:o,newValue:e,changes:t},t}}function vB(o){let e=0;for(let t of o)e+=t.originalLength;return e}function yB(o,e,t){if(o.length>5e3||e.length>5e3)return;function n(d){let c=0;for(let u=0,p=d.length;u<p;u++){let m=d.charCodeAt(u);m>c&&(c=m)}return c}let i=Math.max(n(o),n(e));function r(d){if(d<0)throw new Error("unexpected");return i+d+1}function s(d){let c=0,u=0,p=new Int32Array(d.length);for(let m=0,g=d.length;m<g;m++)if(t&&d[m]==="("){let f=u*100+c;p[m]=r(2*f),c++}else if(t&&d[m]===")"){c=Math.max(c-1,0);let f=u*100+c;p[m]=r(2*f+1),c===0&&u++}else p[m]=d.charCodeAt(m);return p}let a=s(o),l=s(e);return new oh({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var Eh=class extends W{constructor(t,n,i,r,s){super();this.textModel=t;this.versionId=n;this._debounceValue=i;this.languageFeaturesService=r;this.languageConfigurationService=s;this._register(this.textModel.onDidChangeContent(()=>{this._updateOperation.clear()}))}_updateOperation=this._register(new Ut);inlineCompletions=Pb("inlineCompletions",void 0);suggestWidgetInlineCompletions=Pb("suggestWidgetInlineCompletions",void 0);fetch(t,n,i){let r=new Ek(t,n,this.textModel.getVersionId()),s=n.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(this._updateOperation.value?.request.satisfies(r))return this._updateOperation.value.promise;if(s.get()?.request.satisfies(r))return Promise.resolve(!0);let a=!!this._updateOperation.value;this._updateOperation.clear();let l=new $n,d=(async()=>{if((a||n.triggerKind===0)&&await s7(this._debounceValue.get(this.textModel),l.token),l.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==r.versionId)return!1;let p=new Date,m=await bB(this.languageFeaturesService.inlineCompletionsProvider,t,this.textModel,n,l.token,this.languageConfigurationService);if(l.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==r.versionId)return!1;let g=new Date;this._debounceValue.update(this.textModel,g.getTime()-p.getTime());let f=new Lk(m,r,this.textModel,this.versionId);if(i){let b=i.toInlineCompletion(void 0);i.canBeReused(this.textModel,t)&&!m.has(b)&&f.prepend(i.inlineCompletion,b.range,!0)}return this._updateOperation.clear(),_o(b=>{s.set(f,b)}),!0})(),c=new Tk(r,l,d);return this._updateOperation.value=c,d}clear(t){this._updateOperation.clear(),this.inlineCompletions.set(void 0,t),this.suggestWidgetInlineCompletions.set(void 0,t)}clearSuggestWidgetInlineCompletions(t){this._updateOperation.value?.request.context.selectedSuggestionInfo&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,t)}cancelUpdate(){this._updateOperation.clear()}};Eh=K([D(3,Ho),D(4,Fn)],Eh);function s7(o,e){return new Promise(t=>{let n,i=setTimeout(()=>{n&&n.dispose(),t()},o);e&&(n=e.onCancellationRequested(()=>{clearTimeout(i),n&&n.dispose(),t()}))})}var Ek=class{constructor(e,t,n){this.position=e;this.context=t;this.versionId=n}satisfies(e){return this.position.equals(e.position)&&Iu(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,OR())&&(e.context.triggerKind===0||this.context.triggerKind===1)&&this.versionId===e.versionId}},Tk=class{constructor(e,t,n){this.request=e;this.cancellationTokenSource=t;this.promise=n}dispose(){this.cancellationTokenSource.cancel()}},Lk=class{constructor(e,t,n,i){this.inlineCompletionProviderResult=e;this.request=t;this._textModel=n;this._versionId=i;let r=n.deltaDecorations([],e.completions.map(s=>({range:s.range,options:{description:"inline-completion-tracking-range"}})));this._inlineCompletions=e.completions.map((s,a)=>new MS(s,r[a],this._textModel,this._versionId))}_inlineCompletions;get inlineCompletions(){return this._inlineCompletions}_refCount=1;_prependedInlineCompletionItems=[];clone(){return this._refCount++,this}dispose(){if(this._refCount--,this._refCount===0){setTimeout(()=>{this._textModel.isDisposed()||this._textModel.deltaDecorations(this._inlineCompletions.map(e=>e.decorationId),[])},0),this.inlineCompletionProviderResult.dispose();for(let e of this._prependedInlineCompletionItems)e.source.removeRef()}}prepend(e,t,n){n&&e.source.addRef();let i=this._textModel.deltaDecorations([],[{range:t,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new MS(e,i,this._textModel,this._versionId)),this._prependedInlineCompletionItems.push(e)}},MS=class{constructor(e,t,n,i){this.inlineCompletion=e;this.decorationId=t;this._textModel=n;this._modelVersion=i}semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]);get forwardStable(){return this.inlineCompletion.source.inlineCompletions.enableForwardStability??!1}_updatedRange=Li({owner:this,equalsFn:w.equalsRange},e=>(this._modelVersion.read(e),this._textModel.getDecorationRange(this.decorationId)));toInlineCompletion(e){return this.inlineCompletion.withRange(this._updatedRange.read(e)??wk)}toSingleTextEdit(e){return new hn(this._updatedRange.read(e)??wk,this.inlineCompletion.insertText)}isVisible(e,t,n){let i=fa(this._toFilterTextReplacement(n),e),r=this._updatedRange.read(n);if(!r||!this.inlineCompletion.range.getStartPosition().equals(r.getStartPosition())||t.lineNumber!==i.range.startLineNumber)return!1;let s=e.getValueInRange(i.range,1),a=i.text,l=Math.max(0,t.column-i.range.startColumn),d=a.substring(0,l),c=a.substring(l),u=s.substring(0,l),p=s.substring(l),m=e.getLineIndentColumn(i.range.startLineNumber);return i.range.startColumn<=m&&(u=u.trimStart(),u.length===0&&(p=p.trimStart()),d=d.trimStart(),d.length===0&&(c=c.trimStart())),d.startsWith(u)&&!!EE(p,c)}canBeReused(e,t){let n=this._updatedRange.read(void 0);return!!n&&n.containsPosition(t)&&this.isVisible(e,t,void 0)&&Pi.ofRange(n).isGreaterThanOrEqualTo(Pi.ofRange(this.inlineCompletion.range))}_toFilterTextReplacement(e){return new hn(this._updatedRange.read(e)??wk,this.inlineCompletion.filterText)}},wk=new w(1,1,1,1);var Ert=new RegExp("\\bMARK:\\s*(.*)$","d");var CB=Y("editorWorkerService");var PS=class o{async provideSelectionRanges(e,t){let n=[];for(let i of t){let r=[];n.push(r);let s=new Map;await new Promise(a=>o._bracketsRightYield(a,0,e,i,s)),await new Promise(a=>o._bracketsLeftYield(a,0,e,i,s,r))}return n}static _maxDuration=30;static _maxRounds=2;static _bracketsRightYield(e,t,n,i,r){let s=new Map,a=Date.now();for(;;){if(t>=o._maxRounds){e();break}if(!i){e();break}let l=n.bracketPairs.findNextBracket(i);if(!l){e();break}if(Date.now()-a>o._maxDuration){setTimeout(()=>o._bracketsRightYield(e,t+1,n,i,r));break}if(l.bracketInfo.isOpeningBracket){let c=l.bracketInfo.bracketText,u=s.has(c)?s.get(c):0;s.set(c,u+1)}else{let c=l.bracketInfo.getOpeningBrackets()[0].bracketText,u=s.has(c)?s.get(c):0;if(u-=1,s.set(c,Math.max(0,u)),u<0){let p=r.get(c);p||(p=new Gn,r.set(c,p)),p.push(l.range)}}i=l.range.getEndPosition()}}static _bracketsLeftYield(e,t,n,i,r,s){let a=new Map,l=Date.now();for(;;){if(t>=o._maxRounds&&r.size===0){e();break}if(!i){e();break}let d=n.bracketPairs.findPrevBracket(i);if(!d){e();break}if(Date.now()-l>o._maxDuration){setTimeout(()=>o._bracketsLeftYield(e,t+1,n,i,r,s));break}if(d.bracketInfo.isOpeningBracket){let u=d.bracketInfo.bracketText,p=a.has(u)?a.get(u):0;if(p-=1,a.set(u,Math.max(0,p)),p<0){let m=r.get(u);if(m){let g=m.shift();m.size===0&&r.delete(u);let f=w.fromPositions(d.range.getEndPosition(),g.getStartPosition()),b=w.fromPositions(d.range.getStartPosition(),g.getEndPosition());s.push({range:f}),s.push({range:b}),o._addBracketLeading(n,b,s)}}}else{let u=d.bracketInfo.getOpeningBrackets()[0].bracketText,p=a.has(u)?a.get(u):0;a.set(u,p+1)}i=d.range.getStartPosition()}}static _addBracketLeading(e,t,n){if(t.startLineNumber===t.endLineNumber)return;let i=t.startLineNumber,r=e.getLineFirstNonWhitespaceColumn(i);r!==0&&r!==t.startColumn&&(n.push({range:w.fromPositions(new R(i,r),t.getEndPosition())}),n.push({range:w.fromPositions(new R(i,1),t.getEndPosition())}));let s=i-1;if(s>0){let a=e.getLineFirstNonWhitespaceColumn(s);a===t.startColumn&&a!==e.getLineLastNonWhitespaceColumn(s)&&(n.push({range:w.fromPositions(new R(s,a),t.getEndPosition())}),n.push({range:w.fromPositions(new R(s,1),t.getEndPosition())}))}}};var AS=class o{static None=new class extends o{distance(){return 0}};static async create(e,t){if(!t.getOption(120).localityBonus||!t.hasModel())return o.None;let n=t.getModel(),i=t.getPosition();if(!e.canComputeWordRanges(n.uri))return o.None;let[r]=await new PS().provideSelectionRanges(n,[i]);if(r.length===0)return o.None;let s=await e.computeWordRanges(n.uri,r[0].range);if(!s)return o.None;let a=n.getWordUntilPosition(i);return delete s[a.word],new class extends o{distance(l,d){if(!i.equals(t.getPosition()))return 0;if(d.kind===17)return 2<<20;let c=typeof d.label=="string"?d.label:d.label.label,u=s[c];if(aM(u))return 2<<20;let p=Ub(u,w.fromPositions(l),w.compareRangesUsingStarts),m=p>=0?u[p]:u[Math.max(0,~p-1)],g=r.length;for(let f of r){if(!w.containsRange(f.range,m))break;g-=1}return g}}}};var NS=Y("clipboardService");var a7=h("caseDescription","Match Case"),l7=h("wordsDescription","Match Whole Word"),d7=h("regexDescription","Use Regular Expression"),OS=class extends dl{constructor(e){super({icon:le.caseSensitive,title:a7+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??dn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},FS=class extends dl{constructor(e){super({icon:le.wholeWord,title:l7+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??dn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},BS=class extends dl{constructor(e){super({icon:le.regex,title:d7+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??dn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}};var WS=class{constructor(e,t=0,n=e.length,i=t-1){this.items=e;this.start=t;this.end=n;this.index=i}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}};var VS=class{_history;_limit;_navigator;constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isFirst(){return this._currentPosition()===0}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}clear(){this._initialize([]),this._onChange()}_onChange(){this._reduceToLimit();let e=this._elements;this._navigator=new WS(e,0,e.length,e.length)}_reduceToLimit(){let e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){let e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(let t of e)this._history.add(t)}get _elements(){let e=[];return this._history.forEach(t=>e.push(t)),e}};var Vf=Se;var HS=class extends pi{contextViewProvider;element;input;actionbar;options;message;placeholder;tooltip;ariaLabel;validation;state="idle";mirror;cachedHeight;cachedContentHeight;maxHeight=Number.POSITIVE_INFINITY;scrollableElement;hover;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_onDidHeightChange=this._register(new L);onDidHeightChange=this._onDidHeightChange.event;constructor(e,t,n){super(),this.contextViewProvider=t,this.options=n,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=Ee(e,Vf(".monaco-inputbox.idle"));let i=this.options.flexibleHeight?"textarea":"input",r=Ee(this.element,Vf(".ibwrapper"));if(this.input=Ee(r,Vf(i+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=Ee(r,Vf("div.mirror")),this.mirror.innerText="\xA0",this.scrollableElement=new cS(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),Ee(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));let s=this._register(new We(e.ownerDocument,"selectionchange")),a=de.filter(s.event,()=>e.ownerDocument.getSelection()?.anchorNode===r);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new Tr(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(mi().setupManagedHover(dn("mouse"),this.input,e))}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get mirrorElement(){return this.mirror}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get step(){return this.input.step}set step(e){this.input.step=e}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:lC(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return ss(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){let e=this.input.selectionStart;if(e===null)return null;let t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}setEnabled(e){e?this.enable():this.disable()}get width(){return Zp(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){let n=parseFloat(this.mirror.style.paddingLeft||"")||0,i=parseFloat(this.mirror.style.paddingRight||"")||0;t=n+i}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;let e=this.cachedContentHeight,t=this.cachedHeight,n=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:n})}showMessage(e,t){if(this.state==="open"&&sn(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));let n=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${ls(n.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e?.type}stylesForType(e){let t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t=()=>e.style.width=Zp(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:i=>{if(!this.message)return null;e=Ee(i,Vf(".monaco-inputbox-container")),t();let r={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?$2(this.message.content,r):G2(this.message.content,r);s.classList.add(this.classForType(this.message.type));let a=this.stylesForType(this.message.type);return s.style.backgroundColor=a.background??"",s.style.color=a.foreground??"",s.style.border=a.border?`1px solid ${a.border}`:"",Ee(e,s),null},onHide:()=>{this.state="closed"},layout:t});let n;this.message.type===3?n=h("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?n=h("alertWarningMessage","Warning: {0}",this.message.content):n=h("alertInfoMessage","Info: {0}",this.message.content),ua(n),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;let e=this.value,n=e.charCodeAt(e.length-1)===10?" ":"";(e+n).replace(/\u000c/g,"")?this.mirror.textContent=e+n:this.mirror.innerText="\xA0",this.layout()}applyStyles(){let e=this.options.inputBoxStyles,t=e.inputBackground??"",n=e.inputForeground??"",i=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=n,this.input.style.backgroundColor="inherit",this.input.style.color=n,this.element.style.border=`1px solid ${ls(i,"transparent")}`}layout(){if(!this.mirror)return;let e=this.cachedContentHeight;this.cachedContentHeight=lC(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){let t=this.inputElement,n=t.selectionStart,i=t.selectionEnd,r=t.value;n!==null&&i!==null&&(this.value=r.substr(0,n)+e+r.substr(i),t.setSelectionRange(n+1,n+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}},Sd=class extends HS{history;observer;_onDidFocus=this._register(new L);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new L);onDidBlur=this._onDidBlur.event;constructor(e,t,n){let i=h({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," or {0} for history","\u21C5"),r=h({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," ({0} for history)","\u21C5");super(e,t,n),this.history=new VS(n.history,100);let s=()=>{if(n.showHistoryHint&&n.showHistoryHint()&&!this.placeholder.endsWith(i)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){let a=this.placeholder.endsWith(")")?i:r,l=this.placeholder+a;n.showPlaceholderOnFocus&&!ss(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(d=>{d.target.textContent||s()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>s()),this.onblur(this.input,()=>{let a=l=>{if(this.placeholder.endsWith(l)){let d=this.placeholder.slice(0,this.placeholder.length-l.length);return n.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};a(r)||a(i)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}prependHistory(e){let t=this.getHistory();this.clearHistory(),e.forEach(n=>{this.history.add(n)}),t.forEach(n=>{this.history.add(n)})}getHistory(){return this.history.getHistory()}isAtFirstInHistory(){return this.history.isFirst()}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",gd(this.value?this.value:h("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,gd(this.value))}clearHistory(){this.history.clear()}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}};var u7=h("defaultLabel","input"),Hf=class extends pi{static OPTION_CHANGE="optionChange";placeholder;validation;label;showCommonFindToggles;fixFocusOnOptionClickEnabled=!0;imeSessionInProgress=!1;additionalTogglesDisposables=this._register(new Ut);controls;regex;wholeWords;caseSensitive;additionalToggles=[];domNode;inputBox;_onDidOptionChange=this._register(new L);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new L);onMouseDown=this._onMouseDown.event;_onInput=this._register(new L);onInput=this._onInput.event;_onKeyUp=this._register(new L);onKeyUp=this._onKeyUp.event;_onCaseSensitiveKeyDown=this._register(new L);onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event;_onRegexKeyDown=this._register(new L);onRegexKeyDown=this._onRegexKeyDown.event;constructor(e,t,n){super(),this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||u7,this.showCommonFindToggles=!!n.showCommonFindToggles;let i=n.appendCaseSensitiveLabel||"",r=n.appendWholeWordsLabel||"",s=n.appendRegexLabel||"",a=n.history||[],l=!!n.flexibleHeight,d=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Sd(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:n.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles}));let u=this._register(vd());if(this.showCommonFindToggles){this.regex=this._register(new BS({appendTitle:s,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.regex.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(m=>{this._onRegexKeyDown.fire(m)})),this.wholeWords=this._register(new FS({appendTitle:r,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.wholeWords.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new OS({appendTitle:i,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.caseSensitive.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(m=>{this._onCaseSensitiveKeyDown.fire(m)}));let p=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let g=p.indexOf(this.domNode.ownerDocument.activeElement);if(g>=0){let f=-1;m.equals(17)?f=(g+1)%p.length:m.equals(15)&&(g===0?f=p.length-1:f=g-1),m.equals(9)?(p[g].blur(),this.inputBox.focus()):f>=0&&p[f].focus(),it.stop(m,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(n?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e?.appendChild(this.domNode),this._register(q(this.inputBox.inputElement,"compositionstart",p=>{this.imeSessionInProgress=!0})),this._register(q(this.inputBox.inputElement,"compositionend",p=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,p=>this._onKeyDown.fire(p)),this.onkeyup(this.inputBox.inputElement,p=>this._onKeyUp.fire(p)),this.oninput(this.inputBox.inputElement,p=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,p=>this._onMouseDown.fire(p))}get isImeSessionInProgress(){return this.imeSessionInProgress}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(let e of this.additionalToggles)e.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(let e of this.additionalToggles)e.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(let t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new te;for(let t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(n=>{this._onDidOptionChange.fire(n),!n&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((t,n)=>t+n.width(),0)}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}onSearchSubmit(){this.inputBox.addToHistory()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){return this.regex?.checked??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}focusOnRegex(){this.regex?.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}};var p7=h("defaultLabel","input"),h7=h("label.preserveCaseToggle","Preserve Case"),kk=class extends dl{constructor(e){super({icon:le.preserveCase,title:h7+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??dn("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},US=class extends pi{constructor(t,n,i,r){super();this._showOptionButtons=i;this.contextViewProvider=n,this.placeholder=r.placeholder||"",this.validation=r.validation,this.label=r.label||p7;let s=r.appendPreserveCaseLabel||"",a=r.history||[],l=!!r.flexibleHeight,d=!!r.flexibleWidth,c=r.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Sd(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:r.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:r.inputBoxStyles})),this.preserveCase=this._register(new kk({appendTitle:s,isChecked:!1,...r.toggleStyles})),this._register(this.preserveCase.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(m=>{this._onPreserveCaseKeyDown.fire(m)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let u=[this.preserveCase.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let g=u.indexOf(this.domNode.ownerDocument.activeElement);if(g>=0){let f=-1;m.equals(17)?f=(g+1)%u.length:m.equals(15)&&(g===0?f=u.length-1:f=g-1),m.equals(9)?(u[g].blur(),this.inputBox.focus()):f>=0&&u[f].focus(),it.stop(m,!0)}}});let p=document.createElement("div");p.className="controls",p.style.display=this._showOptionButtons?"block":"none",p.appendChild(this.preserveCase.domNode),this.domNode.appendChild(p),t?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,m=>this._onKeyDown.fire(m)),this.onkeyup(this.inputBox.inputElement,m=>this._onKeyUp.fire(m)),this.oninput(this.inputBox.inputElement,m=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,m=>this._onMouseDown.fire(m))}static OPTION_CHANGE="optionChange";contextViewProvider;placeholder;validation;label;fixFocusOnOptionClickEnabled=!0;preserveCase;cachedOptionsWidth=0;domNode;inputBox;_onDidOptionChange=this._register(new L);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new L);onMouseDown=this._onMouseDown.event;_onInput=this._register(new L);onInput=this._onInput.event;_onKeyUp=this._register(new L);onKeyUp=this._onKeyUp.event;_onPreserveCaseKeyDown=this._register(new L);onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event;enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setFocusInputOnOptionClick(t){this.fixFocusOnOptionClickEnabled=t}setEnabled(t){t?this.enable():this.disable()}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(t){this.inputBox.value!==t&&(this.inputBox.value=t)}onSearchSubmit(){this.inputBox.addToHistory()}applyStyles(){}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(t){this.preserveCase.checked=t}focusOnPreserve(){this.preserveCase.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox?.validate()}showMessage(t){this.inputBox?.showMessage(t)}clearMessage(){this.inputBox?.hideMessage()}clearValidation(){this.inputBox?.hideMessage()}set width(t){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=t+"px"}dispose(){super.dispose()}};var jS=new ce("suggestWidgetVisible",!1,h("suggestWidgetVisible","Whether suggestion are visible")),Dk="historyNavigationWidgetFocus",SB="historyNavigationForwardsEnabled",xB="historyNavigationBackwardsEnabled",Uf,zS=[];function Rk(o,e){if(zS.includes(e))throw new Error("Cannot register the same widget multiple times");zS.push(e);let t=new te,n=new ce(Dk,!1).bindTo(o),i=new ce(SB,!0).bindTo(o),r=new ce(xB,!0).bindTo(o),s=()=>{n.set(!0),Uf=e},a=()=>{n.set(!1),Uf===e&&(Uf=void 0)};return ss(e.element)&&s(),t.add(e.onDidFocus(()=>s())),t.add(e.onDidBlur(()=>a())),t.add(ge(()=>{zS.splice(zS.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:i,historyNavigationBackwardsEnablement:r,dispose(){t.dispose()}}}var KS=class extends Sd{constructor(e,t,n,i){super(e,t,n);let r=this._register(i.createScoped(this.element));this._register(Rk(r,this))}};KS=K([D(3,rt)],KS);var GS=class extends Hf{constructor(e,t,n,i){super(e,t,n);let r=this._register(i.createScoped(this.inputBox.element));this._register(Rk(r,this.inputBox))}};GS=K([D(3,rt)],GS);var $S=class extends US{constructor(e,t,n,i,r=!1){super(e,t,r,n);let s=this._register(i.createScoped(this.inputBox.element));this._register(Rk(s,this.inputBox))}};$S=K([D(3,rt)],$S);Xr.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:pe.and(pe.has(Dk),pe.equals(xB,!0),pe.not("isComposing"),jS.isEqualTo(!1)),primary:16,secondary:[528],handler:o=>{Uf?.showPreviousValue()}});Xr.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:pe.and(pe.has(Dk),pe.equals(SB,!0),pe.not("isComposing"),jS.isEqualTo(!1)),primary:18,secondary:[530],handler:o=>{Uf?.showNextValue()}});var Ve={Visible:jS,HasFocusedSuggestion:new ce("suggestWidgetHasFocusedSuggestion",!1,h("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new ce("suggestWidgetDetailsVisible",!1,h("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new ce("suggestWidgetMultipleSuggestions",!1,h("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new ce("suggestionMakesTextEdit",!0,h("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new ce("acceptSuggestionOnEnter",!0,h("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new ce("suggestionHasInsertAndReplaceRange",!1,h("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new ce("suggestionInsertMode",void 0,{type:"string",description:h("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new ce("suggestionCanResolve",!1,h("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},ba=new Bt("suggestWidgetStatusBar"),Mk=class{constructor(e,t,n,i){this.position=e;this.completion=t;this.container=n;this.provider=i;this.textLabel=typeof t.label=="string"?t.label:t.label?.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),this.extensionId=t.extensionId,w.isIRange(t.range)?(this.editStart=new R(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new R(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new R(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||w.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new R(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new R(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new R(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||w.spansMultipleLines(t.range.insert)||w.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),typeof i.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}_brand;editStart;editInsertEnd;editReplaceEnd;textLabel;labelLow;sortTextLow;filterTextLow;isInvalid=!1;score=ac.Default;distance=0;idx;word;extensionId;_resolveDuration;_resolveCache;get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(e){if(!this._resolveCache){let t=e.onCancellationRequested(()=>{this._resolveCache=void 0,this._resolveDuration=void 0}),n=new to(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then(i=>{Object.assign(this.completion,i),this._resolveDuration=n.elapsed()},i=>{hm(i)&&(this._resolveCache=void 0,this._resolveDuration=void 0)}).finally(()=>{t.dispose()})}return this._resolveCache}};var zf=class o{constructor(e=2,t=new Set,n=new Set,i=new Map,r=!0){this.snippetSortOrder=e;this.kindFilter=t;this.providerFilter=n;this.providerItemsToReuse=i;this.showDeprecated=r}static default=new o},Th;function EB(){return Th}var Pk=class{constructor(e,t,n,i){this.items=e;this.needsClipboard=t;this.durations=n;this.disposable=i}};async function Ak(o,e,t,n=zf.default,i={triggerKind:0},r=on.None){let s=new to;t=t.clone();let a=e.getWordAtPosition(t),l=a?new w(t.lineNumber,a.startColumn,t.lineNumber,a.endColumn):w.fromPositions(t),d={replace:l,insert:l.setEndPosition(t.lineNumber,t.column)},c=[],u=new te,p=[],m=!1,g=(b,v,I)=>{let C=!1;if(!v)return C;for(let S of v.suggestions)if(!n.kindFilter.has(S.kind)){if(!n.showDeprecated&&S?.tags?.includes(1))continue;S.range||(S.range=d),S.sortText||(S.sortText=typeof S.label=="string"?S.label:S.label.label),!m&&S.insertTextRules&&S.insertTextRules&4&&(m=ur.guessNeedsClipboard(S.insertText)),c.push(new Mk(t,S,v,b)),C=!0}return ov(v)&&u.add(v),p.push({providerName:b._debugDisplayName??"unknown_provider",elapsedProvider:v.duration??-1,elapsedOverall:I.elapsed()}),C},f=(async()=>{if(!Th||n.kindFilter.has(27))return;let b=n.providerItemsToReuse.get(Th);if(b){b.forEach(C=>c.push(C));return}if(n.providerFilter.size>0&&!n.providerFilter.has(Th))return;let v=new to,I=await Th.provideCompletionItems(e,t,i,r);g(Th,I,v)})();for(let b of o.orderedGroups(e)){let v=!1;if(await Promise.all(b.map(async I=>{if(n.providerItemsToReuse.has(I)){let C=n.providerItemsToReuse.get(I);C.forEach(S=>c.push(S)),v=v||C.length>0;return}if(!(n.providerFilter.size>0&&!n.providerFilter.has(I)))try{let C=new to,S=await I.provideCompletionItems(e,t,i,r);v=g(I,S,C)||v}catch(C){_a(C)}})),v||r.isCancellationRequested)break}return await f,r.isCancellationRequested?(u.dispose(),Promise.reject(new ni)):new Pk(c.sort(b7(n.snippetSortOrder)),m,{entries:p,elapsed:s.elapsed()},u)}function Nk(o,e){if(o.sortTextLow&&e.sortTextLow){if(o.sortTextLow<e.sortTextLow)return-1;if(o.sortTextLow>e.sortTextLow)return 1}return o.textLabel<e.textLabel?-1:o.textLabel>e.textLabel?1:o.completion.kind-e.completion.kind}function g7(o,e){if(o.completion.kind!==e.completion.kind){if(o.completion.kind===27)return-1;if(e.completion.kind===27)return 1}return Nk(o,e)}function f7(o,e){if(o.completion.kind!==e.completion.kind){if(o.completion.kind===27)return 1;if(e.completion.kind===27)return-1}return Nk(o,e)}var qS=new Map;qS.set(0,g7);qS.set(2,f7);qS.set(1,Nk);function b7(o){return qS.get(o)}nr.registerCommand("_executeCompletionItemProvider",async(o,...e)=>{let[t,n,i,r]=e;Ci(be.isUri(t)),Ci(R.isIPosition(n)),Ci(typeof i=="string"||!i),Ci(typeof r=="number"||!r);let{completionProvider:s}=o.get(Ho),a=await o.get(aL).createModelReference(t);try{let l={incomplete:!1,suggestions:[]},d=[],c=a.object.textEditorModel.validatePosition(n),u=await Ak(s,a.object.textEditorModel,c,void 0,{triggerCharacter:i??void 0,triggerKind:i?1:0});for(let p of u.items)d.length<(r??0)&&d.push(p.resolve(on.None)),l.incomplete=l.incomplete||p.container.incomplete,l.suggestions.push(p.completion);try{return await Promise.all(d),l}finally{setTimeout(()=>u.disposable.dispose(),100)}}finally{a.dispose()}});function TB(o,e){o.getContribution("editor.contrib.suggestController")?.triggerSuggest(new Set().add(e),void 0,!0)}var iu=class{static isAllOff(e){return e.other==="off"&&e.comments==="off"&&e.strings==="off"}static isAllOn(e){return e.other==="on"&&e.comments==="on"&&e.strings==="on"}static valueFor(e,t){switch(t){case 1:return e.comments;case 2:return e.strings;default:return e.other}}};var YS=class o{constructor(e,t,n,i,r,s,a=sc.default,l=void 0){this.clipboardText=l;this._items=e,this._column=t,this._wordDistance=i,this._options=r,this._refilterKind=1,this._lineContext=n,this._fuzzyScoreOptions=a,s==="top"?this._snippetCompareFn=o._compareCompletionItemsSnippetsUp:s==="bottom"&&(this._snippetCompareFn=o._compareCompletionItemsSnippetsDown)}_items;_column;_wordDistance;_options;_snippetCompareFn=o._compareCompletionItems;_fuzzyScoreOptions;_lineContext;_refilterKind;_filteredItems;_itemsByProvider;_stats;get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();let e=new Set;for(let[t,n]of this.getItemsByProvider())n.length>0&&n[0].container.incomplete&&e.add(t);return e}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;let e=[],{leadingLineContent:t,characterCountDelta:n}=this._lineContext,i="",r="",s=this._refilterKind===1?this._items:this._filteredItems,a=[],l=!this._options.filterGraceful||s.length>2e3?Ul:TP;for(let d=0;d<s.length;d++){let c=s[d];if(c.isInvalid)continue;let u=this._itemsByProvider.get(c.provider);u?u.push(c):this._itemsByProvider.set(c.provider,[c]);let p=c.position.column-c.editStart.column,m=p+n-(c.position.column-this._column);if(i.length!==m&&(i=m===0?"":t.slice(-m),r=i.toLowerCase()),c.word=i,m===0)c.score=ac.Default;else{let g=0;for(;g<p;){let f=i.charCodeAt(g);if(f===32||f===9)g+=1;else break}if(g>=m)c.score=ac.Default;else if(typeof c.completion.filterText=="string"){let f=l(i,r,g,c.completion.filterText,c.filterTextLow,0,this._fuzzyScoreOptions);if(!f)continue;Mm(c.completion.filterText,c.textLabel)===0?c.score=f:(c.score=_P(i,r,g,c.textLabel,c.labelLow,0),c.score[0]=f[0])}else{let f=l(i,r,g,c.textLabel,c.labelLow,0,this._fuzzyScoreOptions);if(!f)continue;c.score=f}}c.idx=d,c.distance=this._wordDistance.distance(c.position,c.completion),a.push(c),e.push(c.textLabel.length)}this._filteredItems=a.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?Vb(e.length-.85,e,(d,c)=>d-c):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return 1;if(t.completion.kind===27)return-1}return o._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return-1;if(t.completion.kind===27)return 1}return o._compareCompletionItems(e,t)}};var xd=class o extends W{constructor(t,n){super();this.contextKeyService=t;this.model=n;this._register(Ht(i=>{let s=this.model.read(i)?.state.read(i),a=!!s?.inlineCompletion&&s?.primaryGhostText!==void 0&&!s?.primaryGhostText.isEmpty();this.inlineCompletionVisible.set(a),s?.primaryGhostText&&s?.inlineCompletion&&this.suppressSuggestions.set(s.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)})),this._register(Ht(i=>{let r=this.model.read(i),s=!1,a=!0,l=r?.primaryGhostText.read(i);if(r?.selectedSuggestItem&&l&&l.parts.length>0){let{column:d,lines:c}=l.parts[0],u=c[0],p=r.textModel.getLineIndentColumn(l.lineNumber);if(d<=p){let g=$t(u);g===-1&&(g=u.length-1),s=g>0;let f=r.textModel.getOptions().tabSize;a=St.visibleColumnFromColumn(u,g+1,f)<f}}this.inlineCompletionSuggestsIndentation.set(s),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(a)}))}static inlineSuggestionVisible=new ce("inlineSuggestionVisible",!1,h("inlineSuggestionVisible","Whether an inline suggestion is visible"));static inlineSuggestionHasIndentation=new ce("inlineSuggestionHasIndentation",!1,h("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace"));static inlineSuggestionHasIndentationLessThanTabSize=new ce("inlineSuggestionHasIndentationLessThanTabSize",!0,h("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab"));static suppressSuggestions=new ce("inlineSuggestionSuppressSuggestions",void 0,h("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"));inlineCompletionVisible=o.inlineSuggestionVisible.bindTo(this.contextKeyService);inlineCompletionSuggestsIndentation=o.inlineSuggestionHasIndentation.bindTo(this.contextKeyService);inlineCompletionSuggestsIndentationLessThanTabSize=o.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService);suppressSuggestions=o.suppressSuggestions.bindTo(this.contextKeyService)};var QS={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0},nn=class{constructor(e,t,n,i,r){this._editor=e;this._logService=t;this._languageFeaturesService=n;this._languageConfigurationService=r;this._inSnippet=nn.InSnippetMode.bindTo(i),this._hasNextTabstop=nn.HasNextTabstop.bindTo(i),this._hasPrevTabstop=nn.HasPrevTabstop.bindTo(i)}static ID="snippetController2";static get(e){return e.getContribution(nn.ID)}static InSnippetMode=new ce("inSnippetMode",!1,h("inSnippetMode","Whether the editor in current in snippet mode"));static HasNextTabstop=new ce("hasNextTabstop",!1,h("hasNextTabstop","Whether there is a next tab stop when in snippet mode"));static HasPrevTabstop=new ce("hasPrevTabstop",!1,h("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode"));_inSnippet;_hasNextTabstop;_hasPrevTabstop;_session;_snippetListener=new te;_modelVersionId=-1;_currentChoice;_choiceCompletions;dispose(){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._session?.dispose(),this._snippetListener.dispose()}apply(e,t){try{this._doInsert(e,typeof t>"u"?QS:{...QS,...t})}catch(n){this.cancel(),this._logService.error(n),this._logService.error("snippet_error"),this._logService.error("insert_edits=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}insert(e,t){try{this._doInsert(e,typeof t>"u"?QS:{...QS,...t})}catch(n){this.cancel(),this._logService.error(n),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){if(this._editor.hasModel()){if(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof e!="string"&&this.cancel(),this._session?(Ci(typeof e=="string"),this._session.merge(e,t)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new Ti(this._editor,e,t,this._languageConfigurationService),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),this._session?.hasChoice){let n={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(d,c)=>{if(!this._session||d!==this._editor.getModel()||!R.equals(this._editor.getPosition(),c))return;let{activeChoice:u}=this._session;if(!u||u.choice.options.length===0)return;let p=d.getValueInRange(u.range),m=!!u.choice.options.find(f=>f.value===p),g=[];for(let f=0;f<u.choice.options.length;f++){let b=u.choice.options[f];g.push({kind:13,label:b.value,insertText:b.value,sortText:"a".repeat(f+1),range:u.range,filterText:m?`${p}_${b.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:h("next","Go to next placeholder...")}})}return{suggestions:g}}},i=this._editor.getModel(),r,s=!1,a=()=>{r?.dispose(),s=!1},l=()=>{s||(r=this._languageFeaturesService.completionProvider.register({language:i.getLanguageId(),pattern:i.uri.fsPath,scheme:i.uri.scheme,exclusive:!0},n),this._snippetListener.add(r),s=!0)};this._choiceCompletions={provider:n,enable:l,disable:a}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(n=>n.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}let{activeChoice:e}=this._session;if(!e||!this._choiceCompletions){this._choiceCompletions?.disable(),this._currentChoice=void 0;return}this._currentChoice!==e.choice&&(this._currentChoice=e.choice,this._choiceCompletions.enable(),queueMicrotask(()=>{TB(this._editor,this._choiceCompletions.provider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,this._session?.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session?.prev(),this._updateState()}next(){this._session?.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}getSessionEnclosingRange(){if(this._session)return this._session.getEnclosingRange()}};nn=K([D(1,En),D(2,Ho),D(3,rt),D(4,Fn)],nn);ch(nn.ID,nn,4);var ZS=ca.bindToContribution(nn.get);ye(new ZS({id:"jumpToNextSnippetPlaceholder",precondition:pe.and(nn.InSnippetMode,nn.HasNextTabstop),handler:o=>o.next(),kbOpts:{weight:130,kbExpr:oe.textInputFocus,primary:2}}));ye(new ZS({id:"jumpToPrevSnippetPlaceholder",precondition:pe.and(nn.InSnippetMode,nn.HasPrevTabstop),handler:o=>o.prev(),kbOpts:{weight:130,kbExpr:oe.textInputFocus,primary:1026}}));ye(new ZS({id:"leaveSnippet",precondition:nn.InSnippetMode,handler:o=>o.cancel(!0),kbOpts:{weight:130,kbExpr:oe.textInputFocus,primary:9,secondary:[1033]}}));ye(new ZS({id:"acceptSnippet",precondition:nn.InSnippetMode,handler:o=>o.finish()}));var cl=class{static shouldAutoTrigger(e){if(!e.hasModel())return!1;let t=e.getModel(),n=e.getPosition();t.tokenization.tokenizeIfCheap(n.lineNumber);let i=t.getWordAtPosition(n);return!(!i||i.endColumn!==n.column&&i.startColumn+1!==n.column||!isNaN(Number(i.word)))}lineNumber;column;leadingLineContent;leadingWord;triggerOptions;constructor(e,t,n){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.triggerOptions=n}};function v7(o,e,t){if(!e.getContextKeyValue(xd.inlineSuggestionVisible.key))return!0;let n=e.getContextKeyValue(xd.suppressSuggestions.key);return n!==void 0?!n:!o.getOption(63).suppressSuggestions}function y7(o,e,t){if(!e.getContextKeyValue("inlineSuggestionVisible"))return!0;let n=e.getContextKeyValue(xd.suppressSuggestions.key);return n!==void 0?!n:!o.getOption(63).suppressSuggestions}var _d=class{constructor(e,t,n,i,r,s,a,l,d){this._editor=e;this._editorWorkerService=t;this._clipboardService=n;this._telemetryService=i;this._logService=r;this._contextKeyService=s;this._configurationService=a;this._languageFeaturesService=l;this._envService=d;this._currentSelection=this._editor.getSelection()||new De(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let c=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{c=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{c=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(u=>{c||this._onCursorChange(u)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!c&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}_toDispose=new te;_triggerCharacterListener=new te;_triggerQuickSuggest=new so;_triggerState=void 0;_requestToken;_context;_currentSelection;_completionModel;_completionDisposables=new te;_onDidCancel=new L;_onDidTrigger=new L;_onDidSuggest=new L;onDidCancel=this._onDidCancel.event;onDidTrigger=this._onDidTrigger.event;onDidSuggest=this._onDidSuggest.event;dispose(){xt(this._triggerCharacterListener),xt([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(93)||!this._editor.hasModel()||!this._editor.getOption(123))return;let e=new Map;for(let n of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(let i of n.triggerCharacters||[]){let r=e.get(i);if(!r){r=new Set;let s=EB();s&&r.add(s),e.set(i,r)}r.add(n)}let t=n=>{if(!y7(this._editor,this._contextKeyService,this._configurationService)||cl.shouldAutoTrigger(this._editor))return;if(!n){let s=this._editor.getPosition();n=this._editor.getModel().getLineContent(s.lineNumber).substr(0,s.column-1)}let i="";As(n.charCodeAt(n.length-1))?Ot(n.charCodeAt(n.length-2))&&(i=n.substr(n.length-2)):i=n.charAt(n.length-1);let r=e.get(i);if(r){let s=new Map;if(this._completionModel)for(let[a,l]of this._completionModel.getItemsByProvider())r.has(a)||s.set(a,l);this.trigger({auto:!0,triggerKind:1,triggerCharacter:i,retrigger:!!this._completionModel,clipboardText:this._completionModel?.clipboardText,completionOptions:{providerFilter:r,providerItemsToReuse:s}})}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>t()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(e=!1){this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),this._requestToken?.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(e){if(!this._editor.hasModel())return;let t=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||e.reason!==0&&e.reason!==3||e.source!=="keyboard"&&e.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&e.reason===0?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&e.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){iu.isAllOff(this._editor.getOption(91))||this._editor.getOption(120).snippetsPreventQuickSuggestions&&nn.get(this._editor)?.isInSnippet()||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!cl.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;let e=this._editor.getModel(),t=this._editor.getPosition(),n=this._editor.getOption(91);if(!iu.isAllOff(n)){if(!iu.isAllOn(n)){e.tokenization.tokenizeIfCheap(t.lineNumber);let i=e.tokenization.getLineTokens(t.lineNumber),r=i.getStandardTokenType(i.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(iu.valueFor(n,r)!=="on")return}v7(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(e)&&this.trigger({auto:!0})}},this._editor.getOption(92)))}_refilterCompletionItems(){Ci(this._editor.hasModel()),Ci(this._triggerState!==void 0);let e=this._editor.getModel(),t=this._editor.getPosition(),n=new cl(e,t,{...this._triggerState,refilter:!0});this._onNewContext(n)}trigger(e){if(!this._editor.hasModel())return;let t=this._editor.getModel(),n=new cl(t,this._editor.getPosition(),e);this.cancel(e.retrigger),this._triggerState=e,this._onDidTrigger.fire({auto:e.auto,shy:e.shy??!1,position:this._editor.getPosition()}),this._context=n;let i={triggerKind:e.triggerKind??0};e.triggerCharacter&&(i={triggerKind:1,triggerCharacter:e.triggerCharacter}),this._requestToken=new $n;let r=this._editor.getOption(114),s=1;switch(r){case"top":s=0;break;case"bottom":s=2;break}let{itemKind:a,showDeprecated:l}=_d.createSuggestFilter(this._editor),d=new zf(s,e.completionOptions?.kindFilter??a,e.completionOptions?.providerFilter,e.completionOptions?.providerItemsToReuse,l),c=AS.create(this._editorWorkerService,this._editor),u=Ak(this._languageFeaturesService.completionProvider,t,this._editor.getPosition(),d,i,this._requestToken.token);Promise.all([u,c]).then(async([p,m])=>{if(this._requestToken?.dispose(),!this._editor.hasModel())return;let g=e?.clipboardText;if(!g&&p.needsClipboard&&(g=await this._clipboardService.readText()),this._triggerState===void 0)return;let f=this._editor.getModel(),b=new cl(f,this._editor.getPosition(),e),v={...sc.default,firstMatchCanBeWeak:!this._editor.getOption(120).matchOnWordStartOnly};if(this._completionModel=new YS(p.items,this._context.column,{leadingLineContent:b.leadingLineContent,characterCountDelta:b.column-this._context.column},m,this._editor.getOption(120),this._editor.getOption(114),v,g),this._completionDisposables.add(p.disposable),this._onNewContext(b),this._reportDurationsTelemetry(p.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(let I of p.items)I.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${I.provider._debugDisplayName}`,I.completion)}).catch(Ue)}_telemetryGate=0;_reportDurationsTelemetry(e){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)})}static createSuggestFilter(e){let t=new Set;e.getOption(114)==="none"&&t.add(27);let i=e.getOption(120);return i.showMethods||t.add(0),i.showFunctions||t.add(1),i.showConstructors||t.add(2),i.showFields||t.add(3),i.showVariables||t.add(4),i.showClasses||t.add(5),i.showStructs||t.add(6),i.showInterfaces||t.add(7),i.showModules||t.add(8),i.showProperties||t.add(9),i.showEvents||t.add(10),i.showOperators||t.add(11),i.showUnits||t.add(12),i.showValues||t.add(13),i.showConstants||t.add(14),i.showEnums||t.add(15),i.showEnumMembers||t.add(16),i.showKeywords||t.add(17),i.showWords||t.add(18),i.showColors||t.add(19),i.showFiles||t.add(20),i.showReferences||t.add(21),i.showColors||t.add(22),i.showFolders||t.add(23),i.showTypeParameters||t.add(24),i.showSnippets||t.add(27),i.showUsers||t.add(25),i.showIssues||t.add(26),{itemKind:t,showDeprecated:i.showDeprecated}}_onNewContext(e){if(this._context){if(e.lineNumber!==this._context.lineNumber){this.cancel();return}if(Rt(e.leadingLineContent)!==Rt(this._context.leadingLineContent)){this.cancel();return}if(e.column<this._context.column){e.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(e.leadingWord.word.length!==0&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){if(cl.shouldAutoTrigger(this._editor)&&this._context){let n=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:n}})}return}if(e.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&e.leadingWord.word.length!==0){let t=new Map,n=new Set;for(let[i,r]of this._completionModel.getItemsByProvider())r.length>0&&r[0].container.incomplete?n.add(i):t.set(i,r);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:n,providerItemsToReuse:t}})}else{let t=this._completionModel.lineContext,n=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},this._completionModel.items.length===0){let i=cl.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(i&&this._context.leadingWord.endColumn<e.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=t,n=this._completionModel.items.length>0,n&&e.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:e.triggerOptions,isFrozen:n})}}}}};_d=K([D(1,CB),D(2,NS),D(3,sr),D(4,En),D(5,rt),D(6,tn),D(7,Ho),D(8,Vr)],_d);var XS=class o{static _maxSelectionLength=51200;_disposables=new te;_lastOvertyped=[];_locked=!1;constructor(e,t){this._disposables.add(e.onWillType(()=>{if(this._locked||!e.hasModel())return;let n=e.getSelections(),i=n.length,r=!1;for(let a=0;a<i;a++)if(!n[a].isEmpty()){r=!0;break}if(!r){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];let s=e.getModel();for(let a=0;a<i;a++){let l=n[a];if(s.getValueLengthInRange(l)>o._maxSelectionLength)return;this._lastOvertyped[a]={value:s.getValueInRange(l),multiline:l.startLineNumber!==l.endLineNumber}}})),this._disposables.add(t.onDidTrigger(n=>{this._locked=!0})),this._disposables.add(t.onDidCancel(n=>{this._locked=!1}))}getLastOvertypedInfo(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}};var yut=Object.freeze({CURRENT_YEAR:!0,CURRENT_YEAR_SHORT:!0,CURRENT_MONTH:!0,CURRENT_DATE:!0,CURRENT_HOUR:!0,CURRENT_MINUTE:!0,CURRENT_SECOND:!0,CURRENT_DAY_NAME:!0,CURRENT_DAY_NAME_SHORT:!0,CURRENT_MONTH_NAME:!0,CURRENT_MONTH_NAME_SHORT:!0,CURRENT_SECONDS_UNIX:!0,CURRENT_TIMEZONE_OFFSET:!0,SELECTION:!0,CLIPBOARD:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0,CURSOR_INDEX:!0,CURSOR_NUMBER:!0,RELATIVE_FILEPATH:!0,BLOCK_COMMENT_START:!0,BLOCK_COMMENT_END:!0,LINE_COMMENT:!0,WORKSPACE_NAME:!0,WORKSPACE_FOLDER:!0,RANDOM:!0,RANDOM_HEX:!0,UUID:!0}),Kf=class{constructor(e){this._delegates=e}resolve(e){for(let t of this._delegates){let n=t.resolve(e);if(n!==void 0)return n}}},Gf=class{constructor(e,t,n,i){this._model=e;this._selection=t;this._selectionIdx=n;this._overtypingCapturer=i}resolve(e){let{name:t}=e;if(t==="SELECTION"||t==="TM_SELECTED_TEXT"){let n=this._model.getValueInRange(this._selection)||void 0,i=this._selection.startLineNumber!==this._selection.endLineNumber;if(!n&&this._overtypingCapturer){let r=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);r&&(n=r.value,i=r.multiline)}if(n&&i&&e.snippet){let r=this._model.getLineContent(this._selection.startLineNumber),s=Rt(r,0,this._selection.startColumn-1),a=s;e.snippet.walk(d=>d===e?!1:(d instanceof Jn&&(a=Rt(Fr(d.value).pop())),!0));let l=Br(a,s);n=n.replace(/(\r\n|\r|\n)(.*)/g,(d,c,u)=>`${c}${a.substr(l)}${u}`)}return n}else{if(t==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(t==="TM_CURRENT_WORD"){let n=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return n&&n.word||void 0}else{if(t==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(t==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(t==="CURSOR_INDEX")return String(this._selectionIdx);if(t==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}},$f=class{constructor(e,t){this._labelService=e;this._model=t}resolve(e){let{name:t}=e;if(t==="TM_FILENAME")return Rs(this._model.uri.fsPath);if(t==="TM_FILENAME_BASE"){let n=Rs(this._model.uri.fsPath),i=n.lastIndexOf(".");return i<=0?n:n.slice(0,i)}else{if(t==="TM_DIRECTORY")return Jb(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(Iv(this._model.uri));if(t==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(t==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}},jf=class{constructor(e,t,n,i){this._readClipboardText=e;this._selectionIdx=t;this._selectionCount=n;this._spread=i}resolve(e){if(e.name!=="CLIPBOARD")return;let t=this._readClipboardText();if(t){if(this._spread){let n=t.split(/\r\n|\n|\r/).filter(i=>!dv(i));if(n.length===this._selectionCount)return n[this._selectionIdx]}return t}}},ou=class{constructor(e,t,n){this._model=e;this._selection=t;this._languageConfigurationService=n}resolve(e){let{name:t}=e,n=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),i=this._languageConfigurationService.getLanguageConfiguration(n).comments;if(i){if(t==="LINE_COMMENT")return i.lineCommentToken||void 0;if(t==="BLOCK_COMMENT_START")return i.blockCommentStartToken||void 0;if(t==="BLOCK_COMMENT_END")return i.blockCommentEndToken||void 0}}};ou=K([D(2,Fn)],ou);var qf=class o{static dayNames=[h("Sunday","Sunday"),h("Monday","Monday"),h("Tuesday","Tuesday"),h("Wednesday","Wednesday"),h("Thursday","Thursday"),h("Friday","Friday"),h("Saturday","Saturday")];static dayNamesShort=[h("SundayShort","Sun"),h("MondayShort","Mon"),h("TuesdayShort","Tue"),h("WednesdayShort","Wed"),h("ThursdayShort","Thu"),h("FridayShort","Fri"),h("SaturdayShort","Sat")];static monthNames=[h("January","January"),h("February","February"),h("March","March"),h("April","April"),h("May","May"),h("June","June"),h("July","July"),h("August","August"),h("September","September"),h("October","October"),h("November","November"),h("December","December")];static monthNamesShort=[h("JanuaryShort","Jan"),h("FebruaryShort","Feb"),h("MarchShort","Mar"),h("AprilShort","Apr"),h("MayShort","May"),h("JuneShort","Jun"),h("JulyShort","Jul"),h("AugustShort","Aug"),h("SeptemberShort","Sep"),h("OctoberShort","Oct"),h("NovemberShort","Nov"),h("DecemberShort","Dec")];_date=new Date;resolve(e){let{name:t}=e;if(t==="CURRENT_YEAR")return String(this._date.getFullYear());if(t==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(t==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(t==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(t==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(t==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(t==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(t==="CURRENT_DAY_NAME")return o.dayNames[this._date.getDay()];if(t==="CURRENT_DAY_NAME_SHORT")return o.dayNamesShort[this._date.getDay()];if(t==="CURRENT_MONTH_NAME")return o.monthNames[this._date.getMonth()];if(t==="CURRENT_MONTH_NAME_SHORT")return o.monthNamesShort[this._date.getMonth()];if(t==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(t==="CURRENT_TIMEZONE_OFFSET"){let n=this._date.getTimezoneOffset(),i=n>0?"-":"+",r=Math.trunc(Math.abs(n/60)),s=r<10?"0"+r:r,a=Math.abs(n)-r*60,l=a<10?"0"+a:a;return i+s+":"+l}}},Yf=class{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;let t=XM(this._workspaceService.getWorkspace());if(!ZM(t)){if(e.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(t);if(e.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(t)}}_resolveWorkspaceName(e){if(Fl(e))return Rs(e.uri.path);let t=Rs(e.configPath.path);return t.endsWith(Vm)&&(t=t.substr(0,t.length-Vm.length-1)),t}_resoveWorkspacePath(e){if(Fl(e))return v1(e.uri.fsPath);let t=Rs(e.configPath.path),n=e.configPath.fsPath;return n.endsWith(t)&&(n=n.substr(0,n.length-t.length-1)),n?v1(n):"/"}},Qf=class{resolve(e){let{name:t}=e;if(t==="RANDOM")return Math.random().toString().slice(-6);if(t==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(t==="UUID")return Ua()}};var JS=class o{constructor(e,t,n){this._editor=e;this._snippet=t;this._snippetLineLeadingWhitespace=n;this._placeholderGroups=kw(t.placeholders,zo.compareByIndex),this._placeholderGroupsIdx=-1}_placeholderDecorations;_placeholderGroups;_offset=-1;_placeholderGroupsIdx;_nestingLevel=1;static _decor={active:Ln.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:Ln.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:Ln.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:Ln.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};initialize(e){this._offset=e.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;let e=this._editor.getModel();this._editor.changeDecorations(t=>{for(let n of this._snippet.placeholders){let i=this._snippet.offset(n),r=this._snippet.fullLen(n),s=w.fromPositions(e.getPositionAt(this._offset+i),e.getPositionAt(this._offset+i+r)),a=n.isFinalTabstop?o._decor.inactiveFinal:o._decor.inactive,l=t.addDecoration(s,a);this._placeholderDecorations.set(n,l)}})}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){let i=[];for(let r of this._placeholderGroups[this._placeholderGroupsIdx])if(r.transform){let s=this._placeholderDecorations.get(r),a=this._editor.getModel().getDecorationRange(s),l=this._editor.getModel().getValueInRange(a),d=r.transform.resolve(l).split(/\r\n|\r|\n/);for(let c=1;c<d.length;c++)d[c]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+d[c]);i.push(To.replace(a,d.join(this._editor.getModel().getEOL())))}i.length>0&&this._editor.executeEdits("snippet.placeholderTransform",i)}let t=!1;e===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):e===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);let n=this._editor.getModel().changeDecorations(i=>{let r=new Set,s=[];for(let a of this._placeholderGroups[this._placeholderGroupsIdx]){let l=this._placeholderDecorations.get(a),d=this._editor.getModel().getDecorationRange(l);s.push(new De(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(a),i.changeDecorationOptions(l,a.isFinalTabstop?o._decor.activeFinal:o._decor.active),r.add(a);for(let c of this._snippet.enclosingPlaceholders(a)){let u=this._placeholderDecorations.get(c);i.changeDecorationOptions(u,c.isFinalTabstop?o._decor.activeFinal:o._decor.active),r.add(c)}}for(let[a,l]of this._placeholderDecorations)r.has(a)||i.changeDecorationOptions(l,a.isFinalTabstop?o._decor.inactiveFinal:o._decor.inactive);return s});return t?this.move(e):n??[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof zo){let n=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(n).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){let[e]=this._snippet.placeholders;if(e.isFinalTabstop&&this._snippet.rightMostDescendant===e)return!0}return!1}computePossibleSelections(){let e=new Map;for(let t of this._placeholderGroups){let n;for(let i of t){if(i.isFinalTabstop)break;n||(n=[],e.set(i.index,n));let r=this._placeholderDecorations.get(i),s=this._editor.getModel().getDecorationRange(r);if(!s){e.delete(i.index);break}n.push(s)}}return e}get activeChoice(){if(!this._placeholderDecorations)return;let e=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!e?.choice)return;let t=this._placeholderDecorations.get(e);if(!t)return;let n=this._editor.getModel().getDecorationRange(t);if(n)return{range:n,choice:e.choice}}get hasChoice(){let e=!1;return this._snippet.walk(t=>(e=t instanceof nu,!e)),e}merge(e){let t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(n=>{for(let i of this._placeholderGroups[this._placeholderGroupsIdx]){let r=e.shift();console.assert(r._offset!==-1),console.assert(!r._placeholderDecorations);let s=r._snippet.placeholderInfo.last.index;for(let l of r._snippet.placeholderInfo.all)l.isFinalTabstop?l.index=i.index+(s+1)/this._nestingLevel:l.index=i.index+l.index/this._nestingLevel;this._snippet.replace(i,r._snippet.children);let a=this._placeholderDecorations.get(i);n.removeDecoration(a),this._placeholderDecorations.delete(i);for(let l of r._snippet.placeholders){let d=r._snippet.offset(l),c=r._snippet.fullLen(l),u=w.fromPositions(t.getPositionAt(r._offset+d),t.getPositionAt(r._offset+d+c)),p=n.addDecoration(u,o._decor.inactive);this._placeholderDecorations.set(l,p)}}this._placeholderGroups=kw(this._snippet.placeholders,zo.compareByIndex)})}getEnclosingRange(){let e,t=this._editor.getModel();for(let n of this._placeholderDecorations.values()){let i=t.getDecorationRange(n)??void 0;e?e=e.plusRange(i):e=i}return e}},LB={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0},Ti=class{constructor(e,t,n=LB,i){this._editor=e;this._template=t;this._options=n;this._languageConfigurationService=i}static adjustWhitespace(e,t,n,i,r){let s=e.getLineContent(t.lineNumber),a=Rt(s,0,t.column-1),l;return i.walk(d=>{if(!(d instanceof Jn)||d.parent instanceof nu||r&&!r.has(d))return!0;let c=d.value.split(/\r\n|\r|\n/);if(n){let p=i.offset(d);if(p===0)c[0]=e.normalizeIndentation(c[0]);else{l=l??i.toString();let m=l.charCodeAt(p-1);(m===10||m===13)&&(c[0]=e.normalizeIndentation(a+c[0]))}for(let m=1;m<c.length;m++)c[m]=e.normalizeIndentation(a+c[m])}let u=c.join(e.getEOL());return u!==d.value&&(d.parent.replace(d,[new Jn(u)]),l=void 0),!0}),a}static adjustSelection(e,t,n,i){if(n!==0||i!==0){let{positionLineNumber:r,positionColumn:s}=t,a=s-n,l=s+i,d=e.validateRange({startLineNumber:r,startColumn:a,endLineNumber:r,endColumn:l});t=De.createWithDirection(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn,t.getDirection())}return t}static createEditsAndSnippetsFromSelections(e,t,n,i,r,s,a,l,d){let c=[],u=[];if(!e.hasModel())return{edits:c,snippets:u};let p=e.getModel(),m=e.invokeWithinContext(S=>S.get(Na)),g=e.invokeWithinContext(S=>new $f(S.get(Qg),p)),f=()=>a,b=p.getValueInRange(Ti.adjustSelection(p,e.getSelection(),n,0)),v=p.getValueInRange(Ti.adjustSelection(p,e.getSelection(),0,i)),I=p.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber),C=e.getSelections().map((S,E)=>({selection:S,idx:E})).sort((S,E)=>w.compareRangesUsingStarts(S.selection,E.selection));for(let{selection:S,idx:E}of C){let M=Ti.adjustSelection(p,S,n,0),A=Ti.adjustSelection(p,S,0,i);b!==p.getValueInRange(M)&&(M=S),v!==p.getValueInRange(A)&&(A=S);let F=S.setStartPosition(M.startLineNumber,M.startColumn).setEndPosition(A.endLineNumber,A.endColumn),O=new ur().parse(t,!0,r),H=F.getStartPosition(),U=Ti.adjustWhitespace(p,H,s||E>0&&I!==p.getLineFirstNonWhitespaceColumn(S.positionLineNumber),O);O.resolveVariables(new Kf([g,new jf(f,E,C.length,e.getOption(80)==="spread"),new Gf(p,S,E,l),new ou(p,S,d),new qf,new Yf(m),new Qf])),c[E]=To.replace(F,O.toString()),c[E].identifier={major:E,minor:0},c[E]._isTracked=!0,u[E]=new JS(e,O,U)}return{edits:c,snippets:u}}static createEditsAndSnippetsFromEdits(e,t,n,i,r,s,a){if(!e.hasModel()||t.length===0)return{edits:[],snippets:[]};let l=[],d=e.getModel(),c=new ur,u=new wh,p=new Kf([e.invokeWithinContext(g=>new $f(g.get(Qg),d)),new jf(()=>r,0,e.getSelections().length,e.getOption(80)==="spread"),new Gf(d,e.getSelection(),0,s),new ou(d,e.getSelection(),a),new qf,new Yf(e.invokeWithinContext(g=>g.get(Na))),new Qf]);t=t.sort((g,f)=>w.compareRangesUsingStarts(g.range,f.range));let m=0;for(let g=0;g<t.length;g++){let{range:f,template:b}=t[g];if(g>0){let E=t[g-1].range,M=w.fromPositions(E.getEndPosition(),f.getStartPosition()),A=new Jn(d.getValueInRange(M));u.appendChild(A),m+=A.value.length}let v=c.parseFragment(b,u);Ti.adjustWhitespace(d,f.getStartPosition(),!0,u,new Set(v)),u.resolveVariables(p);let I=u.toString(),C=I.slice(m);m=I.length;let S=To.replace(f,C);S.identifier={major:g,minor:0},S._isTracked=!0,l.push(S)}return c.ensureFinalTabstop(u,n,!0),{edits:l,snippets:[new JS(e,u,"")]}}_templateMerges=[];_snippets=[];dispose(){xt(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;let{edits:e,snippets:t}=typeof this._template=="string"?Ti.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):Ti.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=t,this._editor.executeEdits("snippet",e,n=>{let i=n.filter(r=>!!r.identifier);for(let r=0;r<t.length;r++)t[r].initialize(i[r].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):i.map(r=>De.fromPositions(r.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=LB){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);let{edits:n,snippets:i}=Ti.createEditsAndSnippetsFromSelections(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",n,r=>{let s=r.filter(l=>!!l.identifier);for(let l=0;l<i.length;l++)i[l].initialize(s[l].textChange);let a=i[0].isTrivialSnippet;if(!a){for(let l of this._snippets)l.merge(i);console.assert(i.length===0)}return this._snippets[0].hasPlaceholder&&!a?this._move(void 0):s.map(l=>De.fromPositions(l.range.getEndPosition()))})}next(){let e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){let e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){let t=[];for(let n of this._snippets){let i=n.move(e);t.push(...i)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;let e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;let t=new Map;for(let n of this._snippets){let i=n.computePossibleSelections();if(t.size===0)for(let[r,s]of i){s.sort(w.compareRangesUsingStarts);for(let a of e)if(s[0].containsRange(a)){t.set(r,[]);break}}if(t.size===0)return!1;t.forEach((r,s)=>{r.push(...i.get(s))})}e.sort(w.compareRangesUsingStarts);for(let[n,i]of t){if(i.length!==e.length){t.delete(n);continue}i.sort(w.compareRangesUsingStarts);for(let r=0;r<i.length;r++)if(!i[r].containsRange(e[r])){t.delete(n);continue}}return t.size>0}getEnclosingRange(){let e;for(let t of this._snippets){let n=t.getEnclosingRange();e?e=e.plusRange(n):e=n}return e}};Ti=K([D(3,Fn)],Ti);var Zf=class o{constructor(e,t,n,i,r){this._initialScrollTop=e;this._initialContentHeight=t;this._visiblePosition=n;this._visiblePositionScrollDelta=i;this._cursorPosition=r}static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new o(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,n=0,i=e.getVisibleRanges();if(i.length>0){t=i[0].getStartPosition();let r=e.getTopForPosition(t.lineNumber,t.column);n=e.getScrollTop()-r}return new o(e.getScrollTop(),e.getContentHeight(),t,n,e.getPosition())}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){let t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;let t=e.getPosition();if(!this._cursorPosition||!t)return;let n=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+n,1)}};var I7="__$__isNewStorageMarker",ex="__$__targetStorageMarker",ul=Y("storageService");function C7(o){let e=o.get(ex);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}var kB=class o extends W{constructor(t={flushInterval:o.DEFAULT_FLUSH_INTERVAL}){super();this.options=t}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new Es);_onDidChangeTarget=this._register(new Es);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new L);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new zt(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new Ut);onDidChangeValue(t,n,i){return de.filter(this._onDidChangeValue.event,r=>r.scope===t&&(n===void 0||r.key===n),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Wl(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){xt([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{Hr("code/willInitStorage");try{await this.doInitialize()}finally{Hr("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(t,n){let{key:i,external:r}=n;if(i===ex){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:i,target:this.getKeyTargets(t)[i],external:r})}emitWillSaveState(t){this._onWillSaveState.fire({reason:t})}get(t,n,i){return this.getStorage(n)?.get(t,i)}getBoolean(t,n,i){return this.getStorage(n)?.getBoolean(t,i)}getNumber(t,n,i){return this.getStorage(n)?.getNumber(t,i)}getObject(t,n,i){return this.getStorage(n)?.getObject(t,i)}storeAll(t,n){this.withPausedEmitters(()=>{for(let i of t)this.store(i.key,i.value,i.scope,i.target,n)})}store(t,n,i,r,s=!1){if(Ii(n)){this.remove(t,i,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(t,i,r),this.getStorage(i)?.set(t,n,s)})}remove(t,n,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(t,n,void 0),this.getStorage(n)?.delete(t,i)})}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(t,n){let i=[],r=this.getKeyTargets(t);for(let s of Object.keys(r))r[s]===n&&i.push(s);return i}updateKeyTarget(t,n,i,r=!1){let s=this.getKeyTargets(n);typeof i=="number"?s[t]!==i&&(s[t]=i,this.getStorage(n)?.set(ex,JSON.stringify(s),r)):typeof s[t]=="number"&&(delete s[t],this.getStorage(n)?.set(ex,JSON.stringify(s),r))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){let n=this.getStorage(t);return n?C7(n):Object.create(null)}isNew(t){return this.getBoolean(I7,t)===!0}async flush(t=0){this._onWillSaveState.fire({reason:t});let n=this.getStorage(-1),i=this.getStorage(0),r=this.getStorage(1);switch(t){case 0:await br.settled([n?.whenFlushed()??Promise.resolve(),i?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case 1:await br.settled([n?.flush(0)??Promise.resolve(),i?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){let t=this.getStorage(-1)?.items??new Map,n=this.getStorage(0)?.items??new Map,i=this.getStorage(1)?.items??new Map;return S7(t,n,i,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(t){return await this.flush(),this.getStorage(t)?.optimize()}async switch(t,n){return this.emitWillSaveState(0),bF(t)?this.switchToProfile(t,n):this.switchToWorkspace(t,n)}canSwitchProfile(t,n){return!(t.id===n.id||DB(n)&&DB(t))}switchData(t,n,i){this.withPausedEmitters(()=>{let r=new Set;for(let[s,a]of t)r.add(s),n.get(s)!==a&&this.emitDidChangeValue(i,{key:s,external:!0});for(let[s]of n.items)r.has(s)||this.emitDidChangeValue(i,{key:s,external:!0})})}};function DB(o){return o.isDefault||!!o.useDefaultFlags?.globalState}async function S7(o,e,t,n,i,r){let s=f=>{try{return JSON.parse(f)}catch{return f}},a=new Map,l=new Map;o.forEach((f,b)=>{a.set(b,f),l.set(b,s(f))});let d=new Map,c=new Map;e.forEach((f,b)=>{d.set(b,f),c.set(b,s(f))});let u=new Map,p=new Map;t.forEach((f,b)=>{u.set(b,f),p.set(b,s(f))}),console.group(n!==i?`Storage: Application (path: ${n})`:`Storage: Application & Profile (path: ${n}, default profile)`);let m=[];if(a.forEach((f,b)=>{m.push({key:b,value:f})}),console.table(m),console.groupEnd(),console.log(l),n!==i){console.group(`Storage: Profile (path: ${i}, profile specific)`);let f=[];d.forEach((b,v)=>{f.push({key:v,value:b})}),console.table(f),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${r})`);let g=[];u.forEach((f,b)=>{g.push({key:b,value:f})}),console.table(g),console.groupEnd(),console.log(p)}var Xf=class{constructor(e){this.name=e}select(e,t,n){if(n.length===0)return 0;let i=n[0].score[0];for(let r=0;r<n.length;r++){let{score:s,completion:a}=n[r];if(s[0]!==i)break;if(a.preselect)return r}return 0}},tx=class extends Xf{constructor(){super("first")}memorize(e,t,n){}toJSON(){}fromJSON(){}},Fk=class extends Xf{constructor(){super("recentlyUsed")}_cache=new Hi(300,.66);_seq=0;memorize(e,t,n){let i=`${e.getLanguageId()}/${n.textLabel}`;this._cache.set(i,{touch:this._seq++,type:n.completion.kind,insertText:n.completion.insertText})}select(e,t,n){if(n.length===0)return 0;let i=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(i))return super.select(e,t,n);let r=n[0].score[0],s=-1,a=-1,l=-1;for(let d=0;d<n.length&&n[d].score[0]===r;d++){let c=`${e.getLanguageId()}/${n[d].textLabel}`,u=this._cache.peek(c);if(u&&u.touch>l&&u.type===n[d].completion.kind&&u.insertText===n[d].completion.insertText&&(l=u.touch,a=d),n[d].completion.preselect&&s===-1)return s=d}return a!==-1?a:s!==-1?s:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();let t=0;for(let[n,i]of e)i.touch=t,i.type=typeof i.type=="number"?i.type:Yu.fromString(i.type),this._cache.set(n,i);this._seq=this._cache.size}},Bk=class extends Xf{constructor(){super("recentlyUsedByPrefix")}_trie=Fu.forStrings();_seq=0;memorize(e,t,n){let{word:i}=e.getWordUntilPosition(t),r=`${e.getLanguageId()}/${i}`;this._trie.set(r,{type:n.completion.kind,insertText:n.completion.insertText,touch:this._seq++})}select(e,t,n){let{word:i}=e.getWordUntilPosition(t);if(!i)return super.select(e,t,n);let r=`${e.getLanguageId()}/${i}`,s=this._trie.get(r);if(s||(s=this._trie.findSubstr(r)),s)for(let a=0;a<n.length;a++){let{kind:l,insertText:d}=n[a].completion;if(l===s.type&&d===s.insertText)return a}return super.select(e,t,n)}toJSON(){let e=[];return this._trie.forEach((t,n)=>e.push([n,t])),e.sort((t,n)=>-(t[1].touch-n[1].touch)).forEach((t,n)=>t[1].touch=n),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(let[t,n]of e)n.type=typeof n.type=="number"?n.type:Yu.fromString(n.type),this._trie.set(t,n)}}},pl=class{constructor(e,t){this._storageService=e;this._configService=t;this._persistSoon=new zt(()=>this._saveState(),500),this._disposables.add(e.onWillSaveState(n=>{n.reason===1&&this._saveState()}))}static _strategyCtors=new Map([["recentlyUsedByPrefix",Bk],["recentlyUsed",Fk],["first",tx]]);static _storagePrefix="suggest/memories";_serviceBrand;_persistSoon;_disposables=new te;_strategy;dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,n){this._withStrategy(e,t).memorize(e,t,n),this._persistSoon.schedule()}select(e,t,n){return this._withStrategy(e,t).select(e,t,n)}_withStrategy(e,t){let n=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:e.getLanguageIdAtPosition(t.lineNumber,t.column),resource:e.uri});if(this._strategy?.name!==n){this._saveState();let i=pl._strategyCtors.get(n)||tx;this._strategy=new i;try{let s=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,a=this._storageService.get(`${pl._storagePrefix}/${n}`,s);a&&this._strategy.fromJSON(JSON.parse(a))}catch{}}return this._strategy}_saveState(){if(this._strategy){let t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,n=JSON.stringify(this._strategy);this._storageService.store(`${pl._storagePrefix}/${this._strategy.name}`,n,t,1)}}};pl=K([D(0,ul),D(1,tn)],pl);var Hk=Y("ISuggestMemories");$i(Hk,pl,1);var hl=class{constructor(e,t){this._editor=e;this._ckAtEnd=hl.AtEnd.bindTo(t),this._configListener=this._editor.onDidChangeConfiguration(n=>n.hasChanged(125)&&this._update()),this._update()}static AtEnd=new ce("atEndOfWord",!1);_ckAtEnd;_configListener;_enabled=!1;_selectionListener;dispose(){this._configListener.dispose(),this._selectionListener?.dispose(),this._ckAtEnd.reset()}_update(){let e=this._editor.getOption(125)==="on";if(this._enabled!==e)if(this._enabled=e,this._enabled){let t=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}let n=this._editor.getModel(),i=this._editor.getSelection(),r=n.getWordAtPosition(i.getStartPosition());if(!r){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(r.endColumn===i.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(t),t()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};hl=K([D(1,rt)],hl);var RB=Y("markerDecorationsService");var Lh=class{static ID="editor.contrib.markerDecorations";constructor(e,t){}dispose(){}};Lh=K([D(1,RB)],Lh);ch(Lh.ID,Lh,0);var ml;(A=>{let o={total:0,min:Number.MAX_VALUE,max:0},e={...o},t={...o},n={...o},i=0,r;(U=>(U[U.Before=0]="Before",U[U.InProgress=1]="InProgress",U[U.Finished=2]="Finished"))(r||={});let s={keydown:0,input:0,render:0};function a(){v(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}A.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,b()}A.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(u)}A.onInput=c;function u(){s.input===1&&(performance.mark("input/end"),s.input=2)}function p(){v()}A.onKeyUp=p;function m(){v()}A.onSelectionChange=m;function g(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(f),b())}A.onRenderStart=g;function f(){s.render===1&&(performance.mark("render/end"),s.render=2)}function b(){setTimeout(v)}function v(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),I("keydown",o),I("input",e),I("render",t),I("inputlatency",n),i++,C())}function I(F,O){let H=performance.getEntriesByName(F)[0].duration;O.total+=H,O.min=Math.min(O.min,H),O.max=Math.max(O.max,H)}function C(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function S(){if(i===0)return;let F={keydown:E(o),input:E(e),render:E(t),total:E(n),sampleCount:i};return M(o),M(e),M(t),M(n),i=0,F}A.getAndClearMeasurements=S;function E(F){return{average:F.total/i,max:F.max,min:F.min}}function M(F){F.total=0,F.min=Number.MAX_VALUE,F.max=0}})(ml||={});var wd=class{constructor(e,t){this.x=e;this.y=t}_pageCoordinatesBrand=void 0;toClientCoordinates(e){return new Jf(this.x-e.scrollX,this.y-e.scrollY)}},Jf=class{constructor(e,t){this.clientX=e;this.clientY=t}_clientCoordinatesBrand=void 0;toPageCoordinates(e){return new wd(this.clientX+e.scrollX,this.clientY+e.scrollY)}},Uk=class{constructor(e,t,n,i){this.x=e;this.y=t;this.width=n;this.height=i}_editorPagePositionBrand=void 0},zk=class{constructor(e,t){this.x=e;this.y=t}_positionRelativeToEditorBrand=void 0};function rx(o){let e=Zi(o);return new Uk(e.left,e.top,e.width,e.height)}function sx(o,e,t){let n=e.width/o.offsetWidth,i=e.height/o.offsetHeight,r=(t.x-e.x)/n,s=(t.y-e.y)/i;return new zk(r,s)}var Lr=class extends wi{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(e,t,n){super(fe(n),e),this.isFromPointerCapture=t,this.pos=new wd(this.posx,this.posy),this.editorPos=rx(n),this.relativePos=sx(n,this.editorPos,this.pos)}},nx=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new Lr(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return q(e,"contextmenu",n=>{t(this._create(n))})}onMouseUp(e,t){return q(e,"mouseup",n=>{t(this._create(n))})}onMouseDown(e,t){return q(e,we.MOUSE_DOWN,n=>{t(this._create(n))})}onPointerDown(e,t){return q(e,we.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onMouseLeave(e,t){return q(e,we.MOUSE_LEAVE,n=>{t(this._create(n))})}onMouseMove(e,t){return q(e,"mousemove",n=>t(this._create(n)))}},ix=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new Lr(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return q(e,"pointerup",n=>{t(this._create(n))})}onPointerDown(e,t){return q(e,we.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onPointerLeave(e,t){return q(e,we.POINTER_LEAVE,n=>{t(this._create(n))})}onPointerMove(e,t){return q(e,"pointermove",n=>t(this._create(n)))}},ox=class extends W{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new pa),this._keydownListener=null}startMonitoring(e,t,n,i,r){this._keydownListener=Wn(e.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,n,s=>{i(new Lr(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),r(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var ax=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(e,t,n,i){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=n,this._model=i,this.visibleRange=new w(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var Kk=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let n=this._viewLayout.getCurrentViewport();this.scrollTop=n.top,this.scrollLeft=n.left,this.viewportWidth=n.width,this.viewportHeight=n.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},lx=class extends Kk{_renderingContextBrand=void 0;_viewLines;constructor(e,t,n){super(e,t),this._viewLines=n}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}},dx=class{constructor(e,t,n,i){this.outsideRenderedLine=e;this.lineNumber=t;this.ranges=n;this.continuesOnNextLine=i}static firstLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber<t.lineNumber)&&(t=n);return t}static lastLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber>t.lineNumber)&&(t=n);return t}},kh=class o{_horizontalRangeBrand=void 0;left;width;static from(e){let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=new o(r.left,r.width)}return t}constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}},gs=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}},cx=class{outsideRenderedLine;left;originalLeft;constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}},eb=class{constructor(e,t){this.outsideRenderedLine=e;this.ranges=t}};var ux=class{configuration;viewModel;viewLayout;theme;constructor(e,t,n){this.configuration=e,this.theme=new fC(t),this.viewModel=n,this.viewLayout=n.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}};var At=class extends _r{_context;constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var Hn=class{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let n=[],i=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(n[i++]=this.read(e)),e=e.parentElement;let r=new Uint8Array(i);for(let s=0;s<i;s++)r[s]=n[i-s-1];return r}};function Ed(o,e){let t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(o,e)}catch(n){Ue(n);return}try{return globalThis.trustedTypes?.createPolicy(o,e)}catch(n){Ue(n);return}}var tb=class{constructor(e){this._lineFactory=e;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Ke("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;let n=this.getStartLineNumber(),i=this.getEndLineNumber();if(t<n){let l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>i)return null;let r=0,s=0;for(let l=n;l<=i;l++){let d=l-this._rendLineNumberStart;e<=l&&l<=t&&(s===0?(r=d,s=1):s++)}if(e<n){let l=0;t<n?l=t-e+1:l=n-e,this._rendLineNumberStart-=l}return this._lines.splice(r,s)}onLinesChanged(e,t){let n=e+t-1;if(this.getCount()===0)return!1;let i=this.getStartLineNumber(),r=this.getEndLineNumber(),s=!1;for(let a=e;a<=n;a++)a>=i&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;let n=t-e+1,i=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=i)return this._rendLineNumberStart+=n,null;if(e>r)return null;if(n+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);let s=[];for(let u=0;u<n;u++)s[u]=this._lineFactory.createLine();let a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-n),c=this._lines.slice(this._lines.length-n,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(e){if(this.getCount()===0)return!1;let t=this.getStartLineNumber(),n=this.getEndLineNumber(),i=!1;for(let r=0,s=e.length;r<s;r++){let a=e[r];if(a.toLineNumber<t||a.fromLineNumber>n)continue;let l=Math.max(t,a.fromLineNumber),d=Math.min(n,a.toLineNumber);for(let c=l;c<=d;c++){let u=c-this._rendLineNumberStart;this._lines[u].onTokensChanged(),i=!0}}return i}},Dh=class{constructor(e){this._lineFactory=e}domNode=this._createDomNode();_linesCollection=new tb(this._lineFactory);_createDomNode(){let e=Ne(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(147)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),n=new Gk(this.domNode.domNode,this._lineFactory,e),i={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=n.render(i,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}},Gk=class o{constructor(e,t,n){this._domNode=e;this._lineFactory=t;this._viewportData=n}static _ttPolicy=Ed("editorViewLayer",{createHTML:e=>e});render(e,t,n,i){let r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||n<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=n-t+1,r.lines=[];for(let s=t;s<=n;s++)r.lines[s-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,i),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(n-r.rendLineNumberStart,r.linesLength-1),i,t),r.rendLineNumberStart>t){let s=t,a=Math.min(n,r.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart<t){let s=Math.min(r.linesLength,t-r.rendLineNumberStart);s>0&&(this._removeLinesBefore(r,s),r.linesLength-=s)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<n){let s=r.rendLineNumberStart+r.linesLength,a=n;s<=a&&(this._insertLinesAfter(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart+r.linesLength-1>n){let s=Math.max(0,n-r.rendLineNumberStart+1),l=r.linesLength-1-s+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,i),r}_renderUntouchedLines(e,t,n,i,r){let s=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=n;l++){let d=s+l;a[l].layoutLine(d,i[d-r],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let n=0;n<t;n++)e.lines[n].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){let n=e.linesLength-t;for(let i=0;i<t;i++)e.lines[n+i].getDomNode()?.remove();e.lines.splice(n,t)}_finishRenderingNewLines(e,t,n,i){o._ttPolicy&&(n=o._ttPolicy.createHTML(n));let r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=n:r.insertAdjacentHTML("afterend",n);let s=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){let l=e.lines[a];i[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,n){let i=document.createElement("div");o._ttPolicy&&(t=o._ttPolicy.createHTML(t)),i.innerHTML=t;for(let r=0;r<e.linesLength;r++){let s=e.lines[r];if(n[r]){let a=i.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new Ha(1e5);_finishRendering(e,t,n){let i=o._sb,r=e.linesLength,s=e.lines,a=e.rendLineNumberStart,l=[];{i.reset();let d=!1;for(let c=0;c<r;c++){let u=s[c];l[c]=!1,!(u.getDomNode()||!u.renderLine(c+a,n[c],this._viewportData.lineHeight,this._viewportData,i))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,i.build(),l)}{i.reset();let d=!1,c=[];for(let u=0;u<r;u++){let p=s[u];c[u]=!1,!(l[u]||!p.renderLine(u+a,n[u],this._viewportData.lineHeight,this._viewportData,i))&&(c[u]=!0,d=!0)}d&&this._finishRenderingInvalidLines(e,i.build(),c)}}};var Rh=class{constructor(e,t){this._domNode=e;this.endNode=t}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var ru=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,n,i,r){let s=this._createRange();try{return s.setStart(e,t),s.setEnd(n,i),s.getClientRects()}catch{return null}finally{this._detachRange(s,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(gs.compare);let t=[],n=0,i=e[0];for(let r=1,s=e.length;r<s;r++){let a=e[r];i.left+i.width+.9>=a.left?i.width=Math.max(i.width,a.left+a.width-i.left):(t[n++]=i,i=a)}return t[n++]=i,t}static _createHorizontalRangesFromClientRects(e,t,n){if(!e||e.length===0)return null;let i=[];for(let r=0,s=e.length;r<s;r++){let a=e[r];i[r]=new gs(Math.max(0,(a.left-t)/n),a.width/n)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,n,i,r,s){let l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),i=Math.min(l,Math.max(0,i)),t===i&&n===r&&n===0&&!e.children[t].firstChild){let p=e.children[t].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(p,s.clientRectDeltaLeft,s.clientRectScale)}t!==i&&i>0&&r===0&&(i--,r=1073741824);let d=e.children[t].firstChild,c=e.children[i].firstChild;if((!d||!c)&&(!d&&n===0&&t>0&&(d=e.children[t-1].firstChild,n=1073741824),!c&&r===0&&i>0&&(c=e.children[i-1].firstChild,r=1073741824)),!d||!c)return null;n=Math.min(d.textContent.length,Math.max(0,n)),r=Math.min(c.textContent.length,Math.max(0,r));let u=this._readClientRects(d,n,c,r,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,s.clientRectDeltaLeft,s.clientRectScale)}};var mn=class{constructor(e,t,n,i){this.endIndex=e;this.type=t;this.metadata=n;this.containsRTL=i}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var kr=class o{constructor(e,t,n,i){this.startColumn=e;this.endColumn=t;this.className=n;this.type=i}_lineDecorationBrand=void 0;static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!o._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,n){if(e.length===0)return e;let i=t+1,r=n+1,s=n-t,a=[],l=0;for(let d of e)d.endColumn<=i||d.startColumn>=r||(a[l++]=new o(Math.max(1,d.startColumn-i+1),Math.min(s+1,d.endColumn-i+1),d.className,d.type));return a}static filter(e,t,n,i){if(e.length===0)return[];let r=[],s=0;for(let a=0,l=e.length;a<l;a++){let d=e[a],c=d.range;if(c.endLineNumber<t||c.startLineNumber>t||c.isEmpty()&&(d.type===0||d.type===3))continue;let u=c.startLineNumber===t?c.startColumn:n,p=c.endLineNumber===t?c.endColumn:i;r[s++]=new o(u,p,d.inlineClassName,d.type)}return r}static _typeCompare(e,t){let n=[2,0,1,3];return n[e]-n[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;let n=o._typeCompare(e.type,t.type);return n!==0?n:e.className!==t.className?e.className<t.className?-1:1:0}},px=class{startOffset;endOffset;className;metadata;constructor(e,t,n,i){this.startOffset=e,this.endOffset=t,this.className=n,this.metadata=i}},$k=class o{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let n=0,i=e.length;n<i;n++)t|=e[n];return t}consumeLowerThan(e,t,n){for(;this.count>0&&this.stopOffsets[0]<e;){let i=0;for(;i+1<this.count&&this.stopOffsets[i]===this.stopOffsets[i+1];)i++;n.push(new px(t,this.stopOffsets[i],this.classNames.join(" "),o._metadata(this.metadata))),t=this.stopOffsets[i]+1,this.stopOffsets.splice(0,i+1),this.classNames.splice(0,i+1),this.metadata.splice(0,i+1),this.count-=i+1}return this.count>0&&t<e&&(n.push(new px(t,e-1,this.classNames.join(" "),o._metadata(this.metadata))),t=e),t}insert(e,t,n){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(n);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t),this.metadata.splice(i,0,n);break}this.count++}},hx=class{static normalize(e,t){if(t.length===0)return[];let n=[],i=new $k,r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.startColumn,c=l.endColumn,u=l.className,p=l.type===1?2:l.type===2?4:0;if(d>1){let f=e.charCodeAt(d-2);Ot(f)&&d--}if(c>1){let f=e.charCodeAt(c-2);Ot(f)&&c--}let m=d-1,g=c-2;r=i.consumeLowerThan(m,r,n),i.count===0&&(r=m),i.insert(g,u,p)}return i.consumeLowerThan(1073741824,r,n),n}};var Mh=class{startOffset;endOffset;constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}},Ph=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(e,t,n,i,r,s,a,l,d,c,u,p,m,g,f,b,v,I,C){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.continuesWithWrappedLine=i,this.isBasicASCII=r,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(kr.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=p,this.stopRenderingLineAfter=f,this.renderWhitespace=b==="all"?4:b==="boundary"?1:b==="selection"?2:b==="trailing"?3:0,this.renderControlCharacters=v,this.fontLigatures=I,this.selectionsOnLine=C&&C.sort((M,A)=>M.startOffset<A.startOffset?-1:1);let S=Math.abs(g-p),E=Math.abs(m-p);S<E?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=m,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&kr.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}};var nb=class{constructor(e,t){this.partIndex=e;this.charIndex=t}},ib=class o{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}length;_data;_horizontalOffset;constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,n,i){let r=(t<<16|n<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=i}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){let t=this.charOffsetToPartData(e-1),n=o.getPartIndex(t),i=o.getCharIndex(t);return new nb(n,i)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,n){if(this.length===0)return 0;let i=(e<<16|n<<0)>>>0,r=0,s=this.length-1;for(;r+1<s;){let f=r+s>>>1,b=this._data[f];if(b===i)return f;b>i?s=f:r=f}if(r===s)return r;let a=this._data[r],l=this._data[s];if(a===i)return r;if(l===i)return s;let d=o.getPartIndex(a),c=o.getCharIndex(a),u=o.getPartIndex(l),p;d!==u?p=t:p=o.getCharIndex(l);let m=n-c,g=p-n;return m<=g?r:s}inflate(){let e=[];for(let t=0;t<this.length;t++){let n=this._data[t],i=o.getPartIndex(n),r=o.getCharIndex(n),s=this._horizontalOffset[t];e.push([i,r,s])}return e}};var ob=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(e,t,n){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=n}};function gx(o,e){if(o.lineContent.length===0){if(o.lineDecorations.length>0){e.appendString("<span>");let t=0,n=0,i=0;for(let s of o.lineDecorations)(s.type===1||s.type===2)&&(e.appendString('<span class="'),e.appendString(s.className),e.appendString('"></span>'),s.type===1&&(i|=1,t++),s.type===2&&(i|=2,n++));e.appendString("</span>");let r=new ib(1,t+n);return r.setColumnInfo(1,t,0,0),new ob(r,!1,i)}return e.appendString("<span><span></span></span>"),new ob(new ib(0,0),!1,0)}return R7(w7(o),e)}var jk=class{constructor(e,t,n,i,r,s,a,l,d,c,u,p,m,g,f,b){this.fontIsMonospace=e;this.canUseHalfwidthRightwardsArrow=t;this.lineContent=n;this.len=i;this.isOverflowing=r;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=u;this.containsRTL=p;this.spaceWidth=m;this.renderSpaceCharCode=g;this.renderWhitespace=f;this.renderControlCharacters=b}};function w7(o){let e=o.lineContent,t,n,i;o.stopRenderingLineAfter!==-1&&o.stopRenderingLineAfter<e.length?(t=!0,n=e.length-o.stopRenderingLineAfter,i=o.stopRenderingLineAfter):(t=!1,n=0,i=e.length);let r=E7(e,o.containsRTL,o.lineTokens,o.fauxIndentLength,i);o.renderControlCharacters&&!o.isBasicASCII&&(r=L7(e,r)),(o.renderWhitespace===4||o.renderWhitespace===1||o.renderWhitespace===2&&o.selectionsOnLine||o.renderWhitespace===3&&!o.continuesWithWrappedLine)&&(r=k7(o,e,i,r));let s=0;if(o.lineDecorations.length>0){for(let a=0,l=o.lineDecorations.length;a<l;a++){let d=o.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}r=D7(e,i,r,o.lineDecorations)}return o.containsRTL||(r=T7(e,r,!o.isBasicASCII||o.fontLigatures)),new jk(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,e,i,t,n,r,s,o.fauxIndentLength,o.tabSize,o.startVisibleColumn,o.containsRTL,o.spaceWidth,o.renderSpaceCharCode,o.renderWhitespace,o.renderControlCharacters)}function E7(o,e,t,n,i){let r=[],s=0;n>0&&(r[s++]=new mn(n,"",0,!1));let a=n;for(let l=0,d=t.getCount();l<d;l++){let c=t.getEndOffset(l);if(c<=n)continue;let u=t.getClassName(l);if(c>=i){let m=e?Wr(o.substring(a,i)):!1;r[s++]=new mn(i,u,0,m);break}let p=e?Wr(o.substring(a,c)):!1;r[s++]=new mn(c,u,0,p),a=c}return r}function T7(o,e,t){let n=0,i=[],r=0;if(t)for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex;if(n+50<d){let c=l.type,u=l.metadata,p=l.containsRTL,m=-1,g=n;for(let f=n;f<d;f++)o.charCodeAt(f)===32&&(m=f),m!==-1&&f-g>=50&&(i[r++]=new mn(m+1,c,u,p),g=m+1,m=-1);g!==d&&(i[r++]=new mn(d,c,u,p))}else i[r++]=l;n=d}else for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex,c=d-n;if(c>50){let u=l.type,p=l.metadata,m=l.containsRTL,g=Math.ceil(c/50);for(let f=1;f<g;f++){let b=n+f*50;i[r++]=new mn(b,u,p,m)}i[r++]=new mn(d,u,p,m)}else i[r++]=l;n=d}return i}function MB(o){return o<32?o!==9:o===127||o>=8234&&o<=8238||o>=8294&&o<=8297||o>=8206&&o<=8207||o===1564}function L7(o,e){let t=[],n=new mn(0,"",0,!1),i=0;for(let r of e){let s=r.endIndex;for(;i<s;i++){let a=o.charCodeAt(i);MB(a)&&(i>n.endIndex&&(n=new mn(i,r.type,r.metadata,r.containsRTL),t.push(n)),n=new mn(i+1,"mtkcontrol",r.metadata,!1),t.push(n))}i>n.endIndex&&(n=new mn(s,r.type,r.metadata,r.containsRTL),t.push(n))}return t}function k7(o,e,t,n){let i=o.continuesWithWrappedLine,r=o.fauxIndentLength,s=o.tabSize,a=o.startVisibleColumn,l=o.useMonospaceOptimizations,d=o.selectionsOnLine,c=o.renderWhitespace===1,u=o.renderWhitespace===3,p=o.renderSpaceWidth!==o.spaceWidth,m=[],g=0,f=0,b=n[f].type,v=n[f].containsRTL,I=n[f].endIndex,C=n.length,S=!1,E=$t(e),M;E===-1?(S=!0,E=t,M=t):M=Zo(e);let A=!1,F=0,O=d&&d[F],H=a%s;for(let z=r;z<t;z++){let re=e.charCodeAt(z);O&&z>=O.endOffset&&(F++,O=d&&d[F]);let ve;if(z<E||z>M)ve=!0;else if(re===9)ve=!0;else if(re===32)if(c)if(A)ve=!0;else{let ee=z+1<t?e.charCodeAt(z+1):0;ve=ee===32||ee===9}else ve=!0;else ve=!1;if(ve&&d&&(ve=!!O&&O.startOffset<=z&&O.endOffset>z),ve&&u&&(ve=S||z>M),ve&&v&&z>=E&&z<=M&&(ve=!1),A){if(!ve||!l&&H>=s){if(p){let ee=g>0?m[g-1].endIndex:r;for(let Q=ee+1;Q<=z;Q++)m[g++]=new mn(Q,"mtkw",1,!1)}else m[g++]=new mn(z,"mtkw",1,!1);H=H%s}}else(z===I||ve&&z>r)&&(m[g++]=new mn(z,b,0,v),H=H%s);for(re===9?H=s:Xo(re)?H+=2:H++,A=ve;z===I&&(f++,f<C);)b=n[f].type,v=n[f].containsRTL,I=n[f].endIndex}let U=!1;if(A)if(i&&c){let z=t>0?e.charCodeAt(t-1):0,re=t>1?e.charCodeAt(t-2):0;z===32&&re!==32&&re!==9||(U=!0)}else U=!0;if(U)if(p){let z=g>0?m[g-1].endIndex:r;for(let re=z+1;re<=t;re++)m[g++]=new mn(re,"mtkw",1,!1)}else m[g++]=new mn(t,"mtkw",1,!1);else m[g++]=new mn(t,b,0,v);return m}function D7(o,e,t,n){n.sort(kr.compare);let i=hx.normalize(o,n),r=i.length,s=0,a=[],l=0,d=0;for(let u=0,p=t.length;u<p;u++){let m=t[u],g=m.endIndex,f=m.type,b=m.metadata,v=m.containsRTL;for(;s<r&&i[s].startOffset<g;){let I=i[s];if(I.startOffset>d&&(d=I.startOffset,a[l++]=new mn(d,f,b,v)),I.endOffset+1<=g)d=I.endOffset+1,a[l++]=new mn(d,f+" "+I.className,b|I.metadata,v),s++;else{d=g,a[l++]=new mn(d,f+" "+I.className,b|I.metadata,v);break}}g>d&&(d=g,a[l++]=new mn(d,f,b,v))}let c=t[t.length-1].endIndex;if(s<r&&i[s].startOffset===c)for(;s<r&&i[s].startOffset===c;){let u=i[s];a[l++]=new mn(d,u.className,u.metadata,!1),s++}return a}function R7(o,e){let t=o.fontIsMonospace,n=o.canUseHalfwidthRightwardsArrow,i=o.containsForeignElements,r=o.lineContent,s=o.len,a=o.isOverflowing,l=o.overflowingCharCount,d=o.parts,c=o.fauxIndentLength,u=o.tabSize,p=o.startVisibleColumn,m=o.containsRTL,g=o.spaceWidth,f=o.renderSpaceCharCode,b=o.renderWhitespace,v=o.renderControlCharacters,I=new ib(s+1,d.length),C=!1,S=0,E=p,M=0,A=0,F=0;m?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let O=0,H=d.length;O<H;O++){let U=d[O],z=U.endIndex,re=U.type,ve=U.containsRTL,ee=b!==0&&U.isWhitespace(),Q=ee&&!t&&(re==="mtkw"||!i),ae=S===z&&U.isPseudoAfter();if(M=0,e.appendString("<span "),ve&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(Q?"mtkz":re),e.appendASCIICharCode(34),ee){let ne=0;{let Z=S,Ce=E;for(;Z<z;Z++){let st=(r.charCodeAt(Z)===9?u-Ce%u:1)|0;ne+=st,Z>=c&&(Ce+=st)}}for(Q&&(e.appendString(' style="width:'),e.appendString(String(g*ne)),e.appendString('px"')),e.appendASCIICharCode(62);S<z;S++){I.setColumnInfo(S+1,O-F,M,A),F=0;let Z=r.charCodeAt(S),Ce,xe;if(Z===9){Ce=u-E%u|0,xe=Ce,!n||xe>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let st=2;st<=xe;st++)e.appendCharCode(160)}else Ce=2,xe=1,e.appendCharCode(f),e.appendCharCode(8204);M+=Ce,A+=xe,S>=c&&(E+=xe)}}else for(e.appendASCIICharCode(62);S<z;S++){I.setColumnInfo(S+1,O-F,M,A),F=0;let ne=r.charCodeAt(S),Z=1,Ce=1;switch(ne){case 9:Z=u-E%u,Ce=Z;for(let xe=1;xe<=Z;xe++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:v?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Xo(ne)&&Ce++,v&&ne<32?e.appendCharCode(9216+ne):v&&ne===127?e.appendCharCode(9249):v&&MB(ne)?(e.appendString("[U+"),e.appendString(M7(ne)),e.appendString("]"),Z=8,Ce=Z):e.appendCharCode(ne)}M+=Z,A+=Ce,S>=c&&(E+=Ce)}ae?F++:F=0,S>=s&&!C&&U.isPseudoAfter()&&(C=!0,I.setColumnInfo(S+1,O,M,A)),e.appendString("</span>")}return C||I.setColumnInfo(s+1,d.length-1,M,A),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(h("showMore","Show more ({0})",P7(l))),e.appendString("</span>")),e.appendString("</span>"),new ob(I,m,i)}function M7(o){return o.toString(16).toUpperCase().padStart(4,"0")}function P7(o){return o<1024?h("overflow.chars","{0} chars",o):o<1024*1024?`${(o/1024).toFixed(1)} KB`:`${(o/1024/1024).toFixed(1)} MB`}var A7=function(){return Ma?!0:!(Gt||Dn||ar)}(),Nh=!0,rb=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(e,t){this.themeType=t;let n=e.options,i=n.get(51);n.get(39)==="off"?this.renderWhitespace=n.get(101):this.renderWhitespace="none",this.renderControlCharacters=n.get(96),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.useMonospaceOptimizations=i.isMonospace&&!n.get(33),this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=n.get(68),this.stopRenderingLineAfter=n.get(119),this.fontLigatures=n.get(52)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}},fs=class o{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=Ne(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return Ys(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,n,i,r){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=i.getViewLineRenderingData(e),a=this._options,l=kr.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn),d=null;if(Ys(a.themeType)||this._options.renderWhitespace==="selection"){let m=i.selections;for(let g of m){if(g.endLineNumber<e||g.startLineNumber>e)continue;let f=g.startLineNumber===e?g.startColumn:s.minColumn,b=g.endLineNumber===e?g.endColumn:s.maxColumn;f<b&&(Ys(a.themeType)&&l.push(new kr(f,b,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new Mh(f-1,b-1))))}}let c=new Ph(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==Va.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;" class="'),r.appendString(o.CLASS_NAME),r.appendString('">');let u=gx(c,r);r.appendString("</div>");let p=null;return Nh&&A7&&s.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(p=new Ah(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),p||(p=PB(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=p,!0}layoutLine(e,t,n){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(n))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof Ah:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof Ah?this._renderedViewLine.monospaceAssumptionsAreValid():Nh}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof Ah&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,n,i){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),n=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,n));let r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&n>r+1)return new eb(!0,[new gs(this.getWidth(i),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&n>r+1&&(n=r+1);let s=this._renderedViewLine.getVisibleRangesForRange(e,t,n,i);return s&&s.length>0?new eb(!1,s):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};var Ah=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(e,t,n){this.domNode=e,this.input=t;let i=Math.floor(t.lineContent.length/300);if(i>0){this._keyColumnPixelOffsetCache=new Float32Array(i);for(let r=0;r<i;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=n,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){let t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return Nh;if(this.input.lineContent.length<300){let e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),Nh=!1)}return Nh}toSlowRenderedLine(){return PB(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,n,i){let r=this._getColumnPixelOffset(e,t,i),s=this._getColumnPixelOffset(e,n,i);return[new gs(r,s-r)]}_getColumnPixelOffset(e,t,n){if(t<=300){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let i=Math.floor((t-1)/300)-1,r=(i+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[i],s===-1&&(s=this._actualReadPixelOffset(e,r,n),this._keyColumnPixelOffsetCache[i]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return s+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,n){if(!this.domNode)return-1;let i=this._characterMapping.getDomPosition(t),r=ru.readHorizontalRanges(this._getReadingTarget(this.domNode),i.partIndex,i.charIndex,i.partIndex,i.charIndex,n);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return AB(this._characterMapping,e,t)}},fx=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(e,t,n,i,r){if(this.domNode=e,this.input=t,this._characterMapping=n,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!i||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,n,i){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let r=this._readPixelOffset(this.domNode,e,t,i);if(r===-1)return null;let s=this._readPixelOffset(this.domNode,e,n,i);return s===-1?null:[new gs(r,s-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,n,i)}_readVisibleRangesForRange(e,t,n,i,r){if(n===i){let s=this._readPixelOffset(e,t,n,r);return s===-1?null:[new gs(s,0)]}else return this._readRawVisibleRangesForRange(e,n,i,r)}_readPixelOffset(e,t,n,i){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(i);let r=this._getReadingTarget(e);return r.firstChild?(i.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let r=this._pixelOffsetCache[n];if(r!==-1)return r;let s=this._actualReadPixelOffset(e,t,n,i);return this._pixelOffsetCache[n]=s,s}return this._actualReadPixelOffset(e,t,n,i)}_actualReadPixelOffset(e,t,n,i){if(this._characterMapping.length===0){let l=ru.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,i);return!l||l.length===0?-1:l[0].left}if(n===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(i);let r=this._characterMapping.getDomPosition(n),s=ru.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,i);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(n),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(e,t,n,i){if(t===1&&n===this._characterMapping.length)return[new gs(0,this.getWidth(i))];let r=this._characterMapping.getDomPosition(t),s=this._characterMapping.getDomPosition(n);return ru.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,s.partIndex,s.charIndex,i)}getColumnOfNodeOffset(e,t){return AB(this._characterMapping,e,t)}},qk=class extends fx{_readVisibleRangesForRange(e,t,n,i,r){let s=super._readVisibleRangesForRange(e,t,n,i,r);if(!s||s.length===0||n===i||n===1&&i===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(e,t,i,r);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},PB=function(){return ns?N7:O7}();function N7(o,e,t,n,i){return new qk(o,e,t,n,i)}function O7(o,e,t,n,i){return new fx(o,e,t,n,i)}function AB(o,e,t){let n=e.textContent.length,i=-1;for(;e;)e=e.previousSibling,i++;return o.getColumn(new nb(i,t),n)}var gl="monaco-mouse-cursor-text";var bx=class{constructor(e,t,n,i,r,s,a){this.top=e;this.left=t;this.paddingLeft=n;this.width=i;this.height=r;this.textContent=s;this.textContentClassName=a}};var sb=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(e,t){this._context=e;let n=this._context.configuration.options,i=n.get(51);this._cursorStyle=n.get(28),this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(n.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=Ne(document.createElement("div")),this._domNode.setClassName(`cursor ${gl}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),Qt(this._domNode,i),this._domNode.setDisplay("none"),this._position=new R(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(51);return this._cursorStyle=t.get(28),this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),Qt(this._domNode,n),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){let{lineNumber:e,column:t}=this._position,n=this._context.viewModel.getLineContent(e),[i,r]=mv(n,t-1);return[new R(e,i+1),n.substring(i,r)]}_prepareRender(e){let t="",n="",[i,r]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let p=e.visibleRangeForPosition(i);if(!p||p.outsideRenderedLine)return null;let m=fe(this._domNode.domNode),g;this._cursorStyle===1?(g=h0(m,this._lineCursorWidth>0?this._lineCursorWidth:2),g>2&&(t=r,n=this._getTokenClassName(i))):g=h0(m,1);let f=p.left,b=0;g>=2&&f>=1&&(b=1,f-=b);let v=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta;return new bx(v,f,b,g,this._lineHeight,t,n)}let s=e.linesVisibleRangesForRange(new w(i.lineNumber,i.column,i.lineNumber,i.column+r.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=r==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(t=r,n=this._getTokenClassName(i));let c=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,u=2),new bx(c,l.left,0,d,u,t,n)}_getTokenClassName(e){let t=this._context.viewModel.getViewLineData(e.lineNumber),n=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(n)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${gl} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var va=class{constructor(e=null){this.hitTarget=e}type=0},vx=class{constructor(e,t,n){this.position=e;this.spanNode=t;this.injectedText=n}type=1;get hitTarget(){return this.spanNode}},Oh;(e=>{function o(t,n,i){let r=t.getPositionFromDOMInfo(n,i);return r?new vx(r,n,null):new va(n)}e.createFromDOMInfo=o})(Oh||={});var yx=class{constructor(e,t){this.lastViewCursorsRenderData=e;this.lastTextareaPosition=t}},Un=class{static _deduceRage(e,t=null){return!t&&e?new w(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,n){return{type:0,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,n,i,r,s){return{type:e,element:t,mouseColumn:n,position:i,range:r,detail:s}}static createViewZone(e,t,n,i,r){return{type:e,element:t,mouseColumn:n,position:i,range:this._deduceRage(i),detail:r}}static createContentText(e,t,n,i,r){return{type:6,element:e,mouseColumn:t,position:n,range:this._deduceRage(n,i),detail:r}}static createContentEmpty(e,t,n,i){return{type:7,element:e,mouseColumn:t,position:n,range:this._deduceRage(n),detail:i}}static createContentWidget(e,t,n){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createScrollbar(e,t,n){return{type:11,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createOverlayWidget(e,t,n){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createOutsideEditor(e,t,n,i){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:n,outsideDistance:i}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}},gi=class{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}},Fh=class o{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(e,t,n){this.viewModel=e.viewModel;let i=e.configuration.options;this.layoutInfo=i.get(147),this.viewDomNode=t.viewDomNode,this.lineHeight=i.get(68),this.stickyTabStops=i.get(118),this.typicalHalfwidthCharacterWidth=i.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=n,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return o.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){let n=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(n){let i=n.verticalOffset+n.height/2,r=e.viewModel.getLineCount(),s=null,a,l=null;return n.afterLineNumber!==r&&(l=new R(n.afterLineNumber+1,1)),n.afterLineNumber>0&&(s=new R(n.afterLineNumber,e.viewModel.getLineMaxColumn(n.afterLineNumber))),l===null?a=s:s===null?a=l:t<i?a=s:a=l,{viewZoneId:n.id,afterLineNumber:n.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let i=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(i);return{range:new w(i,r,i,r),isAfterLines:!0}}let t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.viewModel.getLineMaxColumn(t);return{range:new w(t,1,t,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return o._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,n){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===n)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},Qk=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(e,t,n,i){this.editorPos=t,this.pos=n,this.relativePos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Bh._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}},Zk=class extends Qk{_ctx;_eventTarget;hitTestResult=new Nn(()=>Bh.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Hn.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,n,i,r){super(e,t,n,i),this._ctx=e,this._eventTarget=r;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?St.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Un.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Un.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,n,i){return Un.createMargin(e,this.target,this._getMouseColumn(t),t,n,i)}fulfillViewZone(e,t,n){return Un.createViewZone(e,this.target,this._getMouseColumn(t),t,n)}fulfillContentText(e,t,n){return Un.createContentText(this.target,this._getMouseColumn(e),e,t,n)}fulfillContentEmpty(e,t){return Un.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Un.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Un.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Un.createOverlayWidget(this.target,this._getMouseColumn(),e)}},NB={isAfterLines:!0};function Yk(o){return{isAfterLines:!1,horizontalDistanceToText:o}}var Bh=class o{_context;_viewHelper;constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,n=Hn.collect(t,this._viewHelper.viewDomNode);return!!(gi.isChildOfContentWidgets(n)||gi.isChildOfOverflowingContentWidgets(n)||gi.isChildOfOverlayWidgets(n)||gi.isChildOfOverflowingOverlayWidgets(n))}createMouseTarget(e,t,n,i,r){let s=new Fh(this._context,this._viewHelper,e),a=new Zk(s,t,n,i,r);try{let l=o._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=o._snapToSoftTabBoundary(l.position,s.viewModel),c=w.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();let n=t,i=null;return!gi.isChildOfOverflowGuard(t.targetPath)&&!gi.isChildOfOverflowingContentWidgets(t.targetPath)&&!gi.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(i=i||t.fulfillUnknown()),i=i||o._hitTestContentWidget(e,n),i=i||o._hitTestOverlayWidget(e,n),i=i||o._hitTestMinimap(e,n),i=i||o._hitTestScrollbarSlider(e,n),i=i||o._hitTestViewZone(e,n),i=i||o._hitTestMargin(e,n),i=i||o._hitTestViewCursor(e,n),i=i||o._hitTestTextArea(e,n),i=i||o._hitTestViewLines(e,n),i=i||o._hitTestScrollbar(e,n),i||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(gi.isChildOfContentWidgets(t.targetPath)||gi.isChildOfOverflowingContentWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillContentWidget(n):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(gi.isChildOfOverlayWidgets(t.targetPath)||gi.isChildOfOverflowingOverlayWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillOverlayWidget(n):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){let n=e.lastRenderData.lastViewCursorsRenderData;for(let i of n)if(t.target===i.domNode)return t.fulfillContentText(i.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){let n=e.lastRenderData.lastViewCursorsRenderData,i=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(let s of n){if(i<s.contentLeft||i>s.contentLeft+s.width)continue;let a=e.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=r&&r<=a+s.height)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){let n=e.getZoneAtCoord(t.mouseVerticalOffset);if(n){let i=t.isInContentArea?8:5;return t.fulfillViewZone(i,n.position,n)}return null}static _hitTestTextArea(e,t){return gi.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){let n=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),i=n.range.getStartPosition(),r=Math.abs(t.relativePos.x),s={isAfterLines:n.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){let a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(n.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,i,n.range,s)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,i,n.range,s):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,i,n.range,s))}return null}static _hitTestViewLines(e,t){if(!gi.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new R(1,1),NB);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){let i=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(i);return t.fulfillContentEmpty(new R(i,r),NB)}if(gi.isStrictChildOfViewLines(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(i)===0){let s=e.getLineWidth(i),a=Yk(t.mouseContentHorizontalOffset-s);return t.fulfillContentEmpty(new R(i,1),a)}let r=e.getLineWidth(i);if(t.mouseContentHorizontalOffset>=r){let s=Yk(t.mouseContentHorizontalOffset-r),a=new R(i,e.viewModel.getLineMaxColumn(i));return t.fulfillContentEmpty(a,s)}}let n=t.hitTestResult.value;return n.type===1?o.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(gi.isChildOfMinimap(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new R(n,i))}return null}static _hitTestScrollbarSlider(e,t){if(gi.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){let n=t.target.className;if(n&&/\b(slider|scrollbar)\b/.test(n)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new R(i,r))}}return null}static _hitTestScrollbar(e,t){if(gi.isChildOfScrollableElement(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new R(n,i))}return null}getMouseColumn(e){let t=this._context.configuration.options,n=t.get(147),i=this._context.viewLayout.getCurrentScrollLeft()+e.x-n.contentLeft;return o._getMouseColumn(i,t.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,n,i,r){let s=i.lineNumber,a=i.column,l=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>l){let v=Yk(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(i,v)}let d=e.visibleRangeForPosition(s,a);if(!d)return t.fulfillUnknown(i);let c=d.left;if(Math.abs(t.mouseContentHorizontalOffset-c)<1)return t.fulfillContentText(i,null,{mightBeForeignElement:!!r,injectedText:r});let u=[];if(u.push({offset:d.left,column:a}),a>1){let v=e.visibleRangeForPosition(s,a-1);v&&u.push({offset:v.left,column:a-1})}let p=e.viewModel.getLineMaxColumn(s);if(a<p){let v=e.visibleRangeForPosition(s,a+1);v&&u.push({offset:v.left,column:a+1})}u.sort((v,I)=>v.offset-I.offset);let m=t.pos.toClientCoordinates(fe(e.viewDomNode)),g=n.getBoundingClientRect(),f=g.left<=m.clientX&&m.clientX<=g.right,b=null;for(let v=1;v<u.length;v++){let I=u[v-1],C=u[v];if(I.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=C.offset){b=new w(s,I.column,s,C.column);let S=Math.abs(I.offset-t.mouseContentHorizontalOffset),E=Math.abs(C.offset-t.mouseContentHorizontalOffset);i=S<E?new R(s,I.column):new R(s,C.column);break}}return t.fulfillContentText(i,b,{mightBeForeignElement:!f||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.getVerticalOffsetForLineNumber(n),r=i+e.lineHeight;if(!(n===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){let a=Math.floor((i+r)/2),l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);let d=new wd(t.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(e,d.toClientCoordinates(fe(e.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(fe(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let n=ud(e.viewDomNode),i;if(n?typeof n.caretRangeFromPoint>"u"?i=B7(n,t.clientX,t.clientY):i=n.caretRangeFromPoint(t.clientX,t.clientY):i=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!i||!i.startContainer)return new va;let r=i.startContainer;if(r.nodeType===r.TEXT_NODE){let s=r.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===fs.CLASS_NAME?Oh.createFromDOMInfo(e,s,i.startOffset):new va(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){let s=r.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===fs.CLASS_NAME?Oh.createFromDOMInfo(e,r,r.textContent.length):new va(r)}return new va}static _doHitTestWithCaretPositionFromPoint(e,t){let n=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(n.offsetNode.nodeType===n.offsetNode.TEXT_NODE){let i=n.offsetNode.parentNode,r=i?i.parentNode:null,s=r?r.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===fs.CLASS_NAME?Oh.createFromDOMInfo(e,n.offsetNode.parentNode,n.offset):new va(n.offsetNode.parentNode)}if(n.offsetNode.nodeType===n.offsetNode.ELEMENT_NODE){let i=n.offsetNode.parentNode,r=i&&i.nodeType===i.ELEMENT_NODE?i.className:null,s=i?i.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(r===fs.CLASS_NAME){let l=n.offsetNode.childNodes[Math.min(n.offset,n.offsetNode.childNodes.length-1)];if(l)return Oh.createFromDOMInfo(e,l,0)}else if(a===fs.CLASS_NAME)return Oh.createFromDOMInfo(e,n.offsetNode,0)}return new va(n.offsetNode)}static _snapToSoftTabBoundary(e,t){let n=t.getLineContent(e.lineNumber),{tabSize:i}=t.model.getOptions(),r=$c.atomicPosition(n,e.column-1,i,2);return r!==-1?new R(e.lineNumber,r+1):e}static doHitTest(e,t){let n=new va;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?n=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(n=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(fe(e.viewDomNode)))),n.type===1){let i=e.viewModel.getInjectedTextAt(n.position),r=e.viewModel.normalizePosition(n.position,2);(i||!r.equals(n.position))&&(n=new vx(r,n.spanNode,i))}return n}};function B7(o,e,t){let n=document.createRange(),i=o.elementFromPoint(e,t);if(i!==null){for(;i&&i.firstChild&&i.firstChild.nodeType!==i.firstChild.TEXT_NODE&&i.lastChild&&i.lastChild.firstChild;)i=i.lastChild;let r=i.getBoundingClientRect(),s=fe(i),a=s.getComputedStyle(i,null).getPropertyValue("font-style"),l=s.getComputedStyle(i,null).getPropertyValue("font-variant"),d=s.getComputedStyle(i,null).getPropertyValue("font-weight"),c=s.getComputedStyle(i,null).getPropertyValue("font-size"),u=s.getComputedStyle(i,null).getPropertyValue("line-height"),p=s.getComputedStyle(i,null).getPropertyValue("font-family"),m=`${a} ${l} ${d} ${c}/${u} ${p}`,g=i.innerText,f=r.left,b=0,v;if(e>r.left+r.width)b=g.length;else{let I=Xk.getInstance();for(let C=0;C<g.length+1;C++){if(v=I.getCharWidth(g.charAt(C),m)/2,f+=v,e<f){b=C;break}f+=v}}n.setStart(i.firstChild,b),n.setEnd(i.firstChild,b)}return n}var Xk=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){let n=e+t;if(this._cache[n])return this._cache[n];let i=this._canvas.getContext("2d");i.font=t;let s=i.measureText(e).width;return this._cache[n]=s,s}};var Wh=class o{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(e){this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return o.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){let n={...e};return n.position&&(n.position=t.convertViewPositionToModelPosition(n.position)),n.range&&(n.range=t.convertViewRangeToModelRange(n.range)),(n.type===5||n.type===8)&&(n.detail=this.convertViewToModelViewZoneData(n.detail,t)),n}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new R(e.afterLineNumber,1)).lineNumber}}};var Ix=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(e,t,n,i){this.configuration=e,this.viewModel=t,this.userInputEvents=n,this.commandDelegate=i}paste(e,t,n,i){this.commandDelegate.paste(e,t,n,i)}type(e){this.commandDelegate.type(e)}compositionType(e,t,n,i){this.commandDelegate.compositionType(e,t,n,i)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Mn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){let t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new R(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){let t=this.configuration.options,n=Gt&&t.get(109),i=t.get(22);e.middleButton&&!n?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):i?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Mn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Mn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,n){e=this._validateViewColumn(e),Mn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:n})}_createCursor(e,t){e=this._validateViewColumn(e),Mn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Mn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Mn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Mn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Mn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Mn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Mn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Mn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Mn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Mn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}};var Vh=class extends _r{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(e,t,n){super(),this._context=e,this.viewController=t,this.viewHelper=n,this.mouseTargetFactory=new Bh(this._context,n),this._mouseDownOperation=this._register(new eD(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let i=new nx(this.viewHelper.viewDomNode);this._register(i.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(i.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=q(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new Lr(a,!1,this.viewHelper.viewDomNode))}))})),this._register(i.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(i.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let r=0;this._register(i.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{r=a})),this._register(q(this.viewHelper.viewDomNode,we.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(i.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let e=Mf.INSTANCE,t=0,n=Bs.getZoomLevel(),i=!1,r=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new lr(l);if(e.acceptStandardWheelEvent(d),e.isPhysicalMouseWheel()){if(a(l)){let c=Bs.getZoomLevel(),u=d.deltaY>0?1:-1;Bs.setZoomLevel(c+u),d.preventDefault(),d.stopPropagation()}}else Date.now()-t>50&&(n=Bs.getZoomLevel(),i=a(l),r=0),t=Date.now(),r+=d.deltaY,i&&(Bs.setZoomLevel(n+r/5),d.preventDefault(),d.stopPropagation())};this._register(q(this.viewHelper.viewDomNode,we.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return Be?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(147)){let t=this._context.configuration.options.get(147).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){let i=new Jf(e,t).toPageCoordinates(fe(this.viewHelper.viewDomNode)),r=rx(this.viewHelper.viewDomNode);if(i.y<r.y||i.y>r.y+r.height||i.x<r.x||i.x>r.x+r.width)return null;let s=sx(this.viewHelper.viewDomNode,r,i);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,i,s,null)}_createMouseTarget(e,t){let n=e.target;if(!this.viewHelper.viewDomNode.contains(n)){let i=ud(this.viewHelper.viewDomNode);i&&(n=i.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?n:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){let n=this._createMouseTarget(e,!0),i=n.type===6||n.type===7,r=n.type===2||n.type===3||n.type===4,s=n.type===3,a=this._context.configuration.options.get(111),l=n.type===8||n.type===5,d=n.type===9,c=e.leftButton||e.middleButton;Be&&e.leftButton&&e.ctrlKey&&(c=!1);let u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(i||s&&a))u(),this._mouseDownOperation.start(n.type,e,t);else if(r)e.preventDefault();else if(l){let p=n.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(p.viewZoneId)&&(u(),this._mouseDownOperation.start(n.type,e,t),e.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(n.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:n})}_onMouseWheel(e){this.viewController.emitMouseWheel(e)}},eD=class extends W{constructor(t,n,i,r,s,a){super();this._context=t;this._viewController=n;this._viewHelper=i;this._mouseTargetFactory=r;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new ox(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new tD(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new iD,this._currentSelection=new De(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);let n=this._findMousePosition(t,!1);n&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:n}):n.type===13&&(n.outsidePosition==="above"||n.outsidePosition==="below")?this._topBottomDragScrolling.start(n,t):(this._topBottomDragScrolling.stop(),this._dispatchMouse(n,!0,1)))}start(t,n,i){this._lastMouseEvent=n,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(n),this._mouseState.setModifiers(n);let r=this._findMousePosition(n,!0);if(!r||!r.position)return;this._mouseState.trySetCount(n.detail,r.position),n.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&n.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&r.type===6&&r.position&&this._currentSelection.containsPosition(r.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);p0(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(r,n.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){let n=t.editorPos,i=this._context.viewModel,r=this._context.viewLayout,s=this._getMouseColumn(t);if(t.posy<n.y){let l=n.y-t.posy,d=Math.max(r.getCurrentScrollTop()-l,0),c=Fh.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return Un.createOutsideEditor(s,p,"above",l)}let u=r.getLineNumberAtVerticalOffset(d);return Un.createOutsideEditor(s,new R(u,1),"above",l)}if(t.posy>n.y+n.height){let l=t.posy-n.y-n.height,d=r.getCurrentScrollTop()+t.relativePos.y,c=Fh.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return Un.createOutsideEditor(s,p,"below",l)}let u=r.getLineNumberAtVerticalOffset(d);return Un.createOutsideEditor(s,new R(u,i.getLineMaxColumn(u)),"below",l)}let a=r.getLineNumberAtVerticalOffset(r.getCurrentScrollTop()+t.relativePos.y);if(t.posx<n.x){let l=n.x-t.posx;return Un.createOutsideEditor(s,new R(a,1),"left",l)}if(t.posx>n.x+n.width){let l=t.posx-n.x-n.width;return Un.createOutsideEditor(s,new R(a,i.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(t,n){let i=this._getPositionOutsideEditor(t);if(i)return i;let r=this._createMouseTarget(t,n);if(!r.position)return null;if(r.type===8||r.type===5){let a=this._helpPositionJumpOverViewZone(r.detail);if(a)return Un.createViewZone(r.type,r.element,r.mouseColumn,a,r.detail)}return r}_helpPositionJumpOverViewZone(t){let n=new R(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=t.positionBefore,r=t.positionAfter;return i&&r?i.isBefore(n)?i:r:null}_dispatchMouse(t,n,i){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:n,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}},tD=class extends W{constructor(t,n,i,r){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(t,n){this._operation?this._operation.setPosition(t,n):this._operation=new nD(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,n)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},nD=class extends W{constructor(t,n,i,r,s,a){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=li(fe(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,n){this._position=t,this._mouseEvent=n}_tick(){let t=Date.now(),n=t-this._lastTime;return this._lastTime=t,n}_getScrollSpeed(){let t=this._context.configuration.options.get(68),n=this._context.configuration.options.get(147).height/t,i=this._position.outsideDistance/t;return i<=1.5?Math.max(30,n*(1+i)):i<=3?Math.max(60,n*(2+i)):Math.max(200,n*(7+i))}_execute(){let t=this._context.configuration.options.get(68),n=this._getScrollSpeed(),i=this._tick(),r=n*(i/1e3)*t,s=this._position.outsidePosition==="above"?-r:r;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=rx(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(147).horizontalScrollbarHeight,p=new wd(this._mouseEvent.pos.x,c.y+c.height-u-.1),m=sx(this._viewHelper.viewDomNode,c,p);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,p,m,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=Un.createOutsideEditor(this._position.mouseColumn,new R(l,1),"above",this._position.outsideDistance):d=Un.createOutsideEditor(this._position.mouseColumn,new R(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=li(fe(d.element),()=>this._execute())}},iD=class o{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let n=new Date().getTime();n-this._lastSetMouseDownCountTime>o.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=n,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};function Cx(o,e,t,n){let i=o.getPlainTextToCopy(e,t,dt),r=o.model.getEOL(),s=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(i)?i:null,l=Array.isArray(i)?i.join(r):i,d,c=null;if(V7.forceCopyWithSyntaxHighlighting||n&&l.length<65536){let p=o.getRichTextToCopy(e,t);p&&(d=p.html,c=p.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var au=class o{static INSTANCE=new o;_lastState;constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}},V7={forceCopyWithSyntaxHighlighting:!1};var Hh=class o{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){let n=e*t,i=n+1,r=n+t;return new w(i,1,r+1,1)}static fromEditorSelection(e,t,n,i){let s=o._getPageOfLine(t.startLineNumber,n),a=o._getRangeForPage(s,n),l=o._getPageOfLine(t.endLineNumber,n),d=o._getRangeForPage(l,n),c=a.intersectRanges(new w(1,1,t.startLineNumber,t.startColumn));if(i&&e.getValueLengthInRange(c,1)>500){let v=e.modifyPosition(c.getEndPosition(),-500);c=w.fromPositions(v,c.getEndPosition())}let u=e.getValueInRange(c,1),p=e.getLineCount(),m=e.getLineMaxColumn(p),g=d.intersectRanges(new w(t.endLineNumber,t.endColumn,p,m));if(i&&e.getValueLengthInRange(g,1)>500){let v=e.modifyPosition(g.getStartPosition(),500);g=w.fromPositions(g.getStartPosition(),v)}let f=e.getValueInRange(g,1),b;if(s===l||s+1===l)b=e.getValueInRange(t,1);else{let v=a.intersectRanges(t),I=d.intersectRanges(t);b=e.getValueInRange(v,1)+"\u2026"+e.getValueInRange(I,1)}return i&&b.length>2*500&&(b=b.substring(0,500)+"\u2026"+b.substring(b.length-500,b.length)),{value:u+b+f,selection:t,selectionStart:u.length,selectionEnd:u.length+b.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function ab(o,e){if(o.get(2)===1){let n=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),i=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),r=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=h("accessibilityModeOff","The editor is not accessible at this time.");return n?h("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,n):i?h("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,i):r?h("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,r):s}return o.get(4)}function lb(o){let e=0,t=-1;do{if(t=o.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var Co=!1,zn=class o{constructor(e,t,n,i,r){this.value=e;this.selectionStart=t;this.selectionEnd=n;this.selection=i;this.newlineCountBeforeSelection=r}static EMPTY=new o("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){let n=e.getValue(),i=e.getSelectionStart(),r=e.getSelectionEnd(),s;if(t){let a=n.substring(0,i),l=t.value.substring(0,t.selectionStart);a===l&&(s=t.newlineCountBeforeSelection)}return new o(n,i,r,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new o(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,n){Co&&console.log(`writeToTextArea ${e}: ${this.toString()}`),t.setValue(e,this.value),n&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){let i=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,i,-1)}if(e>=this.selectionEnd){let i=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,1)}let t=this.value.substring(this.selectionStart,e);if(t.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);let n=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,-1)}_finishDeduceEditorPosition(e,t,n){let i=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)i++;return[e,n*t.length,i]}static deduceInput(e,t,n){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};Co&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`));let i=Math.min(Br(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(Am(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd),s=e.value.substring(i,e.value.length-r),a=t.value.substring(i,t.value.length-r),l=e.selectionStart-i,d=e.selectionEnd-i,c=t.selectionStart-i,u=t.selectionEnd-i;if(Co&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${u}`)),c===u){let m=e.selectionStart-i;return Co&&console.log(`REMOVE PREVIOUS: ${m} chars`),{text:a,replacePrevCharCnt:m,replaceNextCharCnt:0,positionDelta:0}}let p=d-l;return{text:a,replacePrevCharCnt:p,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(Co&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`)),e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};let n=Math.min(Br(e.value,t.value),e.selectionEnd),i=Math.min(Am(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(n,e.value.length-i),s=t.value.substring(n,t.value.length-i),a=e.selectionStart-n,l=e.selectionEnd-n,d=t.selectionStart-n,c=t.selectionEnd-n;return Co&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${r}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:r.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(e){return new o(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};var xx;(e=>e.Tap="-monaco-textarea-synthetic-tap")(xx||={});var oD=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";let t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}},Uh=class extends W{constructor(t,n,i,r,s,a){super();this._host=t;this._textArea=n;this._OS=i;this._browser=r;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new zt(()=>this._onCut.fire(),0)),this._textAreaState=zn.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(de.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new zt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new pt(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new pt(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{Co&&console.log("[compositionstart]",d);let c=new oD;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){Co&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{Co&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let p=zn.readFromTextArea(this._textArea,this._textAreaState),m=zn.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(m),this._onCompositionUpdate.fire(d);return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=zn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{Co&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let p=zn.readFromTextArea(this._textArea,this._textAreaState),m=zn.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(m),this._onCompositionEnd.fire();return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=zn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(Co&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=zn.readFromTextArea(this._textArea,this._textAreaState),u=zn.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(Ot(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&this._onType.fire(u))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,u]=OB.getTextData(d.clipboardData);c&&(u=u||au.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new zt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new L);onFocus=this._onFocus.event;_onBlur=this._register(new L);onBlur=this._onBlur.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new L);onKeyUp=this._onKeyUp.event;_onCut=this._register(new L);onCut=this._onCut.event;_onPaste=this._register(new L);onPaste=this._onPaste.event;_onType=this._register(new L);onType=this._onType.event;_onCompositionStart=this._register(new L);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new L);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new L);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new L);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new Ut);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=zn.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let t=0;return q(this._textArea.ownerDocument,"selectionchange",n=>{if(ml.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let i=Date.now(),r=i-t;if(t=i,r<5)return;let s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(c[0],c[1],c[2]),p=this._textAreaState.deduceEditorPosition(d),m=this._host.deduceModelPosition(p[0],p[1],p[2]),g=new De(u.lineNumber,u.column,m.lineNumber,m.column);this._onSelectionChangeRequest.fire(g)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,n){this._hasFocus||(n=n.collapseSelection()),n.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=n}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){let n=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:n.isFromEmptySelection,multicursorText:n.multicursorText,mode:n.mode};au.INSTANCE.set(this._browser.isFirefox?n.text.replace(/\r\n/g,`
`):n.text,i),t.preventDefault(),t.clipboardData&&OB.setTextData(t.clipboardData,n.text,n.html,i)}};Uh=K([D(4,Si),D(5,En)],Uh);var OB={getTextData(o){let e=o.getData(mc.text),t=null,n=o.getData("vscode-editor-data");if(typeof n=="string")try{t=JSON.parse(n),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&o.files.length>0?[Array.prototype.slice.call(o.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(o,e,t,n){o.setData(mc.text,e),typeof t=="string"&&o.setData("text/html",t),o.setData("vscode-editor-data",JSON.stringify(n))}},Sx=class extends W{constructor(t){super();this._actual=t;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>ml.onKeyDown())),this._register(this.onBeforeInput(()=>ml.onBeforeInput())),this._register(this.onInput(()=>ml.onInput())),this._register(this.onKeyUp(()=>ml.onKeyUp())),this._register(q(this._actual,xx.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new We(this._actual,"keydown")).event;onKeyPress=this._register(new We(this._actual,"keypress")).event;onKeyUp=this._register(new We(this._actual,"keyup")).event;onCompositionStart=this._register(new We(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new We(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new We(this._actual,"compositionend")).event;onBeforeInput=this._register(new We(this._actual,"beforeinput")).event;onInput=this._register(new We(this._actual,"input")).event;onCut=this._register(new We(this._actual,"cut")).event;onCopy=this._register(new We(this._actual,"copy")).event;onPaste=this._register(new We(this._actual,"paste")).event;onFocus=this._register(new We(this._actual,"focus")).event;onBlur=this._register(new We(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new L);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let t=ud(this._actual);return t?t.activeElement===this._actual:this._actual.isConnected?bo()===this._actual:!1}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,n){let i=this._actual;i.value!==n&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=n)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,n,i){let r=this._actual,s=null,a=ud(r);a?s=a.activeElement:s=bo();let l=fe(s),d=s===r,c=r.selectionStart,u=r.selectionEnd;if(d&&c===n&&u===i){Dn&&l.parent!==l&&r.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),r.setSelectionRange(n,i),Dn&&l.parent!==l&&r.focus();return}try{let p=g2(r);this.setIgnoreSelectionChangeTime("setSelectionRange"),r.focus(),r.setSelectionRange(n,i),f2(r,p)}catch{}}};var rD=class extends Vh{_lastPointerType;constructor(e,t,n){super(e,t,n),this._register(Sn.addTarget(this.viewHelper.linesContentDomNode)),this._register(q(this.viewHelper.linesContentDomNode,ht.Tap,r=>this.onTap(r))),this._register(q(this.viewHelper.linesContentDomNode,ht.Change,r=>this.onChange(r))),this._register(q(this.viewHelper.linesContentDomNode,ht.Contextmenu,r=>this._onContextMenu(new Lr(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(q(this.viewHelper.linesContentDomNode,"pointerdown",r=>{let s=r.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let i=new ix(this.viewHelper.viewDomNode);this._register(i.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(i.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(i.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(i.onPointerDown(this.viewHelper.viewDomNode,(r,s)=>this._onMouseDown(r,s)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){let n=this._createMouseTarget(new Lr(e,!1,this.viewHelper.viewDomNode),!1);n.position&&this.viewController.dispatchMouse({position:n.position,mouseColumn:n.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:n.type===6&&n.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}},sD=class extends Vh{constructor(e,t,n){super(e,t,n),this._register(Sn.addTarget(this.viewHelper.linesContentDomNode)),this._register(q(this.viewHelper.linesContentDomNode,ht.Tap,i=>this.onTap(i))),this._register(q(this.viewHelper.linesContentDomNode,ht.Change,i=>this.onChange(i))),this._register(q(this.viewHelper.linesContentDomNode,ht.Contextmenu,i=>this._onContextMenu(new Lr(i,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();let t=this._createMouseTarget(new Lr(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){let n=document.createEvent("CustomEvent");n.initEvent(xx.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(n),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}},_x=class extends W{handler;constructor(e,t,n){super(),(wm||xM&&vM)&&ZI.pointerEvents?this.handler=this._register(new rD(e,t,n)):Yt.TouchEvent?this.handler=this._register(new sD(e,t,n)):this.handler=this._register(new Vh(e,t,n))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}};var Xi=class extends _r{};var wx=class extends At{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(e){super(e),this._visibleLines=new Dh({createLine:()=>new aD(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let n=this._context.configuration.options.get(51);Qt(this.domNode,n),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);let n=this._context.configuration.options.get(51);return Qt(this.domNode,n),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(n=>n.shouldRender());for(let n=0,i=t.length;n<i;n++){let r=t[n];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}},aD=class{_dynamicOverlays;_domNode;_renderedContent;constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=Ne(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,n,i,r){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(i.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;">'),r.appendString(s),r.appendString("</div>"),!0)}layoutLine(e,t,n){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(n))}},Ex=class extends wx{_contentWidth;constructor(e){super(e);let n=this._context.configuration.options.get(147);this._contentWidth=n.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._contentWidth=n.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}},Tx=class extends wx{_contentLeft;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._contentLeft=n.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),Qt(this.domNode,t.get(51))}onConfigurationChanged(e){let t=this._context.configuration.options;Qt(this.domNode,t.get(51));let n=t.get(147);return this._contentLeft=n.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);let t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}};var Lx=class extends At{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(e){super(e),this.domNode=Ne(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1,n=this._context.configuration.options.get(147),i=n.contentWidth-n.verticalScrollbarWidth;this.contentWidth!==i&&(this.contentWidth=i,e=!0);let r=n.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0,n=e.getDecorationsInViewport();for(let i of n){if(!i.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=Ne(document.createElement("div")),this.domNode.appendChild(r));let s,a;i.options.blockIsAfterEnd?(s=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0)):(s=e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!0),a=i.range.isEmpty()&&!i.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0));let[l,d,c,u]=i.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+i.options.blockClassName),r.setLeft(this.contentLeft-u),r.setWidth(this.contentWidth+u+d),r.setTop(s-e.scrollTop-l),r.setHeight(a-s+l+c),t++}for(let i=t;i<this.blocks.length;i++)this.blocks[i].domNode.remove();this.blocks.length=t}};var kx=class extends At{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=Ne(document.createElement("div")),Hn.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Ne(document.createElement("div")),Hn.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){let e=Object.keys(this._widgets);for(let t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){let t=new dD(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,n,i,r){this._widgets[e.getId()].setPosition(t,n,i,r),this.setShouldRender()}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let n=this._widgets[t];delete this._widgets[t];let i=n.domNode.domNode;i.remove(),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onBeforeRender(e)}prepareRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].prepareRender(e)}render(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].render(e)}},dD=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new lu(null,null);_secondaryAnchor=new lu(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(e,t,n){this._context=e,this._viewDomNode=t,this._actual=n,this.domNode=Ne(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let i=this._context.configuration.options,r=i.get(147);this._fixedOverflowWidgets=i.get(43),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=i.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){let t=this._context.configuration.options;if(this._lineHeight=t.get(68),e.hasChanged(147)){let n=t.get(147);this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,n){this._affinity=e,this._primaryAnchor=i(t,this._context.viewModel,this._affinity),this._secondaryAnchor=i(n,this._context.viewModel,this._affinity);function i(r,s,a){if(!r)return new lu(null,null);let l=s.model.validatePosition(r);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new lu(r,d)}return new lu(r,null)}}_getMaxWidth(){let e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,n,i){this._setPosition(i,e,t),this._preference=n,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,n,i){let r=e.top,s=r,a=e.top+e.height,l=i.viewportHeight-a,d=r-n,c=s>=n,u=a,p=l>=n,m=e.left;return m+t>i.scrollLeft+i.viewportWidth&&(m=i.scrollLeft+i.viewportWidth-t),m<i.scrollLeft&&(m=i.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:p,belowTop:u,left:m}}_layoutHorizontalSegmentInPage(e,t,n,i){let a=Math.max(15,t.left-i),l=Math.min(t.left+t.width+i,e.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,u=t.left+n-(c?.scrollX??0);if(u+i>l){let p=u-(l-i);u-=p,n-=p}if(u<a){let p=u-a;u-=p,n-=p}return[n,u]}_layoutBoxInPage(e,t,n,i){let r=e.top-n,s=e.top+e.height,a=Zi(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+r-(d?.scrollY??0),u=a.top+s-(d?.scrollY??0),p=Mc(l.body),[m,g]=this._layoutHorizontalSegmentInPage(p,a,e.left-i.scrollLeft+this._contentLeft,t),f=22,b=22,v=c>=f,I=u+n<=p.height-b;return this._fixedOverflowWidgets?{fitsAbove:v,aboveTop:Math.max(c,f),fitsBelow:I,belowTop:u,left:g}:{fitsAbove:v,aboveTop:r,fitsBelow:I,belowTop:s,left:m}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new du(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){let t=r(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),n=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,i=r(n,this._affinity,this._lineHeight);return{primary:t,secondary:i};function r(s,a,l){if(!s)return null;let d=e.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,u=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.scrollTop;return new Dx(u,c,l)}}_reduceAnchorCoordinates(e,t,n){if(!t)return e;let i=this._context.configuration.options.get(51),r=t.left;return r<e.left?r=Math.max(r,e.left-n+i.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+n-i.typicalFullwidthCharacterWidth),new Dx(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;let{primary:t,secondary:n}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=lD(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let i=this._reduceAnchorCoordinates(t,n,this._cachedDomNodeOffsetWidth),r;this.allowEditorOverflow?r=this._layoutBoxInPage(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!r)return null;if(s===2||r.fitsAbove)return{kind:"inViewport",coordinate:new du(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(s===2||r.fitsBelow)return{kind:"inViewport",coordinate:new du(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new du(i.top,i.left)),position:0}:{kind:"inViewport",coordinate:new du(i.top,i.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&lD(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&lD(this._actual.afterRender,this._actual,this._renderData.position)}},lu=class{constructor(e,t){this.modelPosition=e;this.viewPosition=t}},du=class{constructor(e,t){this.top=e;this.left=t}_coordinateBrand=void 0},Dx=class{constructor(e,t,n){this.top=e;this.left=t;this.height=n}_anchorCoordinateBrand=void 0};function lD(o,e,...t){try{return o.call(e,...t)}catch{return null}}var Rx=class extends Xi{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(e){super(),this._context=e;let t=this._context.configuration.options,n=t.get(147);this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new De(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1,t=new Set;for(let r of this._selections)t.add(r.positionLineNumber);let n=Array.from(t);n.sort((r,s)=>r-s),Kt(this._cursorLineNumbers,n)||(this._cursorLineNumbers=n,e=!0);let i=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=[];for(let s=t;s<=n;s++){let a=s-t;i[a]=""}if(this._wordWrap){let s=this._renderOne(e,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new R(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new R(d,1)).lineNumber,u=l.convertModelPositionToViewPosition(new R(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,p=Math.max(c,t),m=Math.min(u,n);for(let g=p;g<=m;g++){let f=g-t;i[f]=s}}}let r=this._renderOne(e,!0);for(let s of this._cursorLineNumbers){if(s<t||s>n)continue;let a=s-t;i[a]=r}this._renderData=i}render(e,t){if(!this._renderData)return"";let n=t-e;return n>=this._renderData.length?"":this._renderData[n]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},Mx=class extends Rx{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},Px=class extends Rx{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};ji((o,e)=>{let t=o.getColor(WL);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||o.defines(VL)){let n=o.getColor(VL);n&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${n}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${n}; }`),Ys(o.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var Ax=class extends Xi{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let l=0,d=t.length;l<d;l++){let c=t[l];c.options.className&&(n[i++]=c)}n=n.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,u=d.options.className;return c<u?-1:c>u?1:w.compareRangesUsingStarts(l.range,d.range)});let r=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=s;l++){let d=l-r;a[d]=""}this._renderWholeLineDecorations(e,n,a),this._renderNormalDecorations(e,n,a),this._renderResult=a}_renderWholeLineDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){let l=t[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,i),u=Math.min(l.range.endLineNumber,r);for(let p=c;p<=u;p++){let m=p-i;n[m]+=d}}}_renderNormalDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=null,s=!1,a=null,l=!1;for(let d=0,c=t.length;d<c;d++){let u=t[d];if(u.options.isWholeLine)continue;let p=u.options.className,m=!!u.options.showIfCollapsed,g=u.range;if(m&&g.endColumn===1&&g.endLineNumber!==g.startLineNumber&&(g=new w(g.startLineNumber,g.startColumn,g.endLineNumber-1,this._context.viewModel.getLineMaxColumn(g.endLineNumber-1))),r===p&&s===m&&w.areIntersectingOrTouching(a,g)){a=w.plusRange(a,g);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n),r=p,s=m,a=g,l=u.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n)}_renderNormalDecoration(e,t,n,i,r,s,a){let l=e.linesVisibleRangesForRange(t,n==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let u=l[d];if(u.outsideRenderedLine)continue;let p=u.lineNumber-s;if(r&&u.ranges.length===1){let m=u.ranges[0];if(m.width<this._typicalHalfwidthCharacterWidth){let g=Math.round(m.left+m.width/2),f=Math.max(0,Math.round(g-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new kh(f,this._typicalHalfwidthCharacterWidth)}}for(let m=0,g=u.ranges.length;m<g;m++){let f=i&&u.continuesOnNextLine&&g===1,b=u.ranges[m],v='<div class="cdr '+n+'" style="left:'+String(b.left)+"px;width:"+(f?"100%;":String(b.width)+"px;")+'"></div>';a[p]+=v}}}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};var Nx=class extends At{scrollbar;scrollbarDomNode;constructor(e,t,n,i){super(e);let r=this._context.configuration.options,s=r.get(105),a=r.get(76),l=r.get(41),d=r.get(108),c={listenOnDomNode:n.domNode,className:"editor-scrollable "+Mg(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new Ih(t.domNode,c,this._context.viewLayout.getScrollable())),Hn.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=Ne(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let u=(p,m,g)=>{let f={};if(m){let b=p.scrollTop;b&&(f.scrollTop=this._context.viewLayout.getCurrentScrollTop()+b,p.scrollTop=0)}if(g){let b=p.scrollLeft;b&&(f.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+b,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(f,1)};this._register(q(n.domNode,"scroll",p=>u(n.domNode,!0,!0))),this._register(q(t.domNode,"scroll",p=>u(t.domNode,!0,!1))),this._register(q(i.domNode,"scroll",p=>u(i.domNode,!0,!1))),this._register(q(this.scrollbarDomNode.domNode,"scroll",p=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let e=this._context.configuration.options,t=e.get(147);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(74).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(105)||e.hasChanged(76)||e.hasChanged(41)){let t=this._context.configuration.options,n=t.get(105),i=t.get(76),r=t.get(41),s=t.get(108),a={vertical:n.vertical,horizontal:n.horizontal,verticalScrollbarSize:n.verticalScrollbarSize,horizontalScrollbarSize:n.horizontalScrollbarSize,scrollByPage:n.scrollByPage,handleMouseWheel:n.handleMouseWheel,mouseWheelScrollSensitivity:i,fastScrollSensitivity:r,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return e.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+Mg(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}};var cu=class{constructor(e,t,n,i,r){this.startLineNumber=e;this.endLineNumber=t;this.className=n;this.tooltip=i;this.zIndex=r??0}_decorationToRenderBrand=void 0;zIndex},cD=class{constructor(e,t,n){this.className=e;this.zIndex=t;this.tooltip=n}},uD=class{decorations=[];add(e){this.decorations.push(e)}getDecorations(){return this.decorations}},zh=class extends Xi{_render(e,t,n){let i=[];for(let a=e;a<=t;a++){let l=a-e;i[l]=new uD}if(n.length===0)return i;n.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,s=0;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.className,u=d.zIndex,p=Math.max(d.startLineNumber,e)-e,m=Math.min(d.endLineNumber,t)-e;r===c?(p=Math.max(s+1,p),s=Math.max(s,m)):(r=c,s=m);for(let g=p;g<=s;g++)i[g].add(new cD(c,u,d.tooltip))}return i}},Ox=class extends At{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(e){super(e),this._context=e;let t=this._context.configuration.options,n=t.get(147);this.domNode=Ne(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){let t=Ne(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let n=this._widgets[e.getId()];return n.preference.lane===t.lane&&n.preference.zIndex===t.zIndex&&w.equalsRange(n.preference.range,t.range)?!1:(n.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId();if(this._widgets[t]){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(let s of r){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,n),d=Math.min(s.range.endLineNumber,i),c=s.options.glyphMargin?.position??2,u=s.options.zIndex??0;for(let p=l;p<=d;p++){let m=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new R(p,0)),g=this._context.viewModel.glyphLanes.getLanesAtLine(m.lineNumber).indexOf(c);t.push(new pD(p,g,u,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let r of Object.values(this._widgets)){let s=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(w.lift(s));if(!a||!l||l<n||a>i)continue;let d=Math.max(a,n),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new R(d,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(r.preference.lane);t.push(new hD(d,u,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){let t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((n,i)=>n.lineNumber===i.lineNumber?n.laneIndex===i.laneIndex?n.zIndex===i.zIndex?i.type===n.type?n.type===0&&i.type===0?n.className<i.className?-1:1:0:i.type-n.type:i.zIndex-n.zIndex:n.laneIndex-i.laneIndex:n.lineNumber-i.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let i of Object.values(this._widgets))i.renderInfo=null;let t=new no(this._collectSortedGlyphRenderRequests(e)),n=[];for(;t.length>0;){let i=t.peek();if(!i)break;let r=t.takeWhile(a=>a.lineNumber===i.lineNumber&&a.laneIndex===i.laneIndex);if(!r||r.length===0)break;let s=r[0];if(s.type===0){let a=[];for(let l of r){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}n.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=n}render(e){if(!this._glyphMargin){for(let n of Object.values(this._widgets))n.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let n of Object.values(this._widgets))if(!n.renderInfo)n.domNode.setDisplay("none");else{let i=e.viewportData.relativeVerticalOffset[n.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+n.renderInfo.laneIndex*this._lineHeight;n.domNode.setDisplay("block"),n.domNode.setTop(i),n.domNode.setLeft(r),n.domNode.setWidth(t),n.domNode.setHeight(this._lineHeight)}for(let n=0;n<this._decorationGlyphsToRender.length;n++){let i=this._decorationGlyphsToRender[n],r=e.viewportData.relativeVerticalOffset[i.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+i.laneIndex*this._lineHeight,a;n<this._managedDomNodes.length?a=this._managedDomNodes[n]:(a=Ne(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+i.combinedClassName),a.setPosition("absolute"),a.setTop(r),a.setLeft(s),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var pD=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.className=i}type=0;accept(e){return new mD(this.lineNumber,this.laneIndex,e)}},hD=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.widget=i}type=1},mD=class{constructor(e,t,n){this.lineNumber=e;this.laneIndex=t;this.combinedClassName=n}};var Fx=class extends Xi{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(e){super(),this._context=e,this._primaryPosition=null;let t=this._context.configuration.options,n=t.get(148),i=t.get(51);this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(148),i=t.get(51);return this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){let n=e.selections[0].getPosition();return this._primaryPosition?.equals(n)?!1:(this._primaryPosition=n,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=e.scrollWidth,r=this._primaryPosition,s=this.getGuidesByLine(t,Math.min(n+1,this._context.viewModel.getLineCount()),r),a=[];for(let l=t;l<=n;l++){let d=l-t,c=s[d],u="",p=e.visibleRangeForPosition(new R(l,1))?.left??0;for(let m of c){let g=m.column===-1?p+(m.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new R(l,m.column)).left;if(g>i||this._maxIndentLeft>0&&g>this._maxIndentLeft)break;let f=m.horizontalLine?m.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=m.horizontalLine?(e.visibleRangeForPosition(new R(l,m.horizontalLine.endColumn))?.left??g+this._spaceWidth)-g:this._spaceWidth;u+=`<div class="core-guide ${m.className} ${f}" style="left:${g}px;width:${b}px"></div>`}a[d]=u}this._renderResult=a}getGuidesByLine(e,t,n){let i=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,n,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&n){let u=this._context.viewModel.getActiveIndentGuide(n.lineNumber,e,t);s=u.startLineNumber,a=u.endLineNumber,l=u.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let u=e;u<=t;u++){let p=new Array;c.push(p);let m=i?i[u-e]:[],g=new no(m),f=r?r[u-e]:0;for(let b=1;b<=f;b++){let v=(b-1)*d+1,I=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||m.length===0)&&s<=u&&u<=a&&b===l;p.push(...g.takeWhile(S=>S.visibleColumn<v)||[]);let C=g.peek();(!C||C.visibleColumn!==v||C.horizontalLine)&&p.push(new Ir(v,-1,`core-guide-indent lvl-${(b-1)%30}`+(I?" indent-active":""),null,-1,-1))}p.push(...g.takeWhile(b=>!0)||[])}return c}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};function Kh(o){if(!(o&&o.isTransparent()))return o}ji((o,e)=>{let t=[{bracketColor:rI,guideColor:FO,guideColorActive:zO},{bracketColor:sI,guideColor:BO,guideColorActive:KO},{bracketColor:aI,guideColor:WO,guideColorActive:GO},{bracketColor:lI,guideColor:VO,guideColorActive:$O},{bracketColor:dI,guideColor:HO,guideColorActive:jO},{bracketColor:cI,guideColor:UO,guideColorActive:qO}],n=new Wg,i=[{indentColor:IO,indentColorActive:EO},{indentColor:CO,indentColorActive:TO},{indentColor:SO,indentColorActive:LO},{indentColor:xO,indentColorActive:kO},{indentColor:_O,indentColorActive:DO},{indentColor:wO,indentColorActive:RO}],r=t.map(a=>{let l=o.getColor(a.bracketColor),d=o.getColor(a.guideColor),c=o.getColor(a.guideColorActive),u=Kh(Kh(d)??l?.transparent(.3)),p=Kh(Kh(c)??l);if(!(!u||!p))return{guideColor:u,guideColorActive:p}}).filter(Pa),s=i.map(a=>{let l=o.getColor(a.indentColor),d=o.getColor(a.indentColorActive),c=Kh(l),u=Kh(d);if(!(!c||!u))return{indentColor:c,indentColorActive:u}}).filter(Pa);if(r.length>0){for(let a=0;a<30;a++){let l=r[a%r.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${n.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${n.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${n.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var Gh=class o extends Xi{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new R(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let e=this._context.configuration.options;this._lineHeight=e.get(68);let t=e.get(69);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(97);let n=e.get(147);this._lineNumbersLeft=n.lineNumbersLeft,this._lineNumbersWidth=n.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){let t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let n=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,n=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(n=!0),n}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){let t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new R(e,1));if(t.column!==1)return"";let n=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n);if(this._renderLineNumbers===2){let i=Math.abs(this._lastCursorModelPosition.lineNumber-n);return i===0?'<span class="relative-current-line-number">'+n+"</span>":String(i)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===n||n%10===0)return String(n);let i=this._context.viewModel.getLineCount();return n===i?String(n):""}return String(n)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}let t=Gt?this._lineHeight%2===0?" lh-even":" lh-odd":"",n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(d=>!!d.options.lineNumberClassName);r.sort((d,c)=>w.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=n;d<=i;d++){let c=d-n,u=this._getLineRenderLineNumber(d),p="";for(;s<r.length&&r[s].range.endLineNumber<d;)s++;for(let m=s;m<r.length;m++){let{range:g,options:f}=r[m];g.startLineNumber<=d&&(p+=" "+f.lineNumberClassName)}if(!u&&!p){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeLineNumber&&(p+=" active-line-number"),l[c]=`<div class="${o.CLASS_NAME}${t}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};ji((o,e)=>{let t=o.getColor(yO),n=o.getColor(MO);n?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${n}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});var gD=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new w(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}},fD=class{constructor(e,t,n,i,r,s,a){this.minimalReveal=e;this.lineNumber=t;this.startColumn=n;this.endColumn=i;this.startScrollTop=r;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=t,this.maxLineNumber=t}type="range";minLineNumber;maxLineNumber},bD=class{constructor(e,t,n,i,r){this.minimalReveal=e;this.selections=t;this.startScrollTop=n;this.stopScrollTop=i;this.scrollType=r;let s=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,d=t.length;l<d;l++){let c=t[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},Bx=class o extends At{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(e,t){super(e);let n=this._context.configuration,i=this._context.configuration.options,r=i.get(51),s=i.get(148);this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=i.get(102),this._cursorSurroundingLines=i.get(29),this._cursorSurroundingLinesStyle=i.get(30),this._canUseLayerHinting=!i.get(32),this._viewLineOptions=new rb(n,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Dh({createLine:()=>new fs(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Hn.write(this.domNode,8),this.domNode.setClassName(`view-lines ${gl}`),Qt(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new zt(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new zt(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new gD,this._horizontalRevealRequest=null,this._stickyScrollEnabled=i.get(117).enabled,this._maxNumberStickyLines=i.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(148)&&(this._maxLineWidth=0);let t=this._context.configuration.options,n=t.get(51),i=t.get(148);return this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.isViewportWrapping,this._revealHorizontalRightPadding=t.get(102),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(117).enabled,this._maxNumberStickyLines=t.get(117).maxLineCount,Qt(this.domNode,n),this._onOptionsMaybeChanged(),e.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let e=this._context.configuration,t=new rb(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=!1;for(let r=t;r<=n;r++)i=this._visibleLines.getVisibleLine(r).onSelectionChanged()||i;return i}onDecorationsChanged(e){{let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){let t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let n=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?n={scrollTop:n.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new fD(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new bD(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;let r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-n.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(n,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){let t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),n=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>n)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){let n=this._getViewLineDomNode(e);if(n===null)return null;let i=this._getLineNumberFor(n);if(i===-1||i<1||i>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(i)===1)return new R(i,1);let r=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(i<r||i>s)return null;let a=this._visibleLines.getVisibleLine(i).getColumnOfNodeOffset(e,t),l=this._context.viewModel.getLineMinColumn(i);return a<l&&(a=l),new R(i,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===fs.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){let r=this._visibleLines.getVisibleLine(i);if(e===r.getDomNode())return i}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();if(e<t||e>n)return-1;let i=new Rh(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;let n=e.endLineNumber,i=w.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!i)return null;let r=[],s=0,a=new Rh(this.domNode.domNode,this._textRangeRestingSpot),l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new R(i.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=i.startLineNumber;u<=i.endLineNumber;u++){if(u<d||u>c)continue;let p=u===i.startLineNumber?i.startColumn:1,m=u!==i.endLineNumber,g=m?this._context.viewModel.getLineMaxColumn(u):i.endColumn,f=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,p,g,a);if(f){if(t&&u<n){let b=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new R(u+1,1)).lineNumber,b!==l&&(f.ranges[f.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[s++]=new dx(f.outsideRenderedLine,u,kh.from(f.ranges),m)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:r}_visibleRangesForLineRange(e,t,n){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;let i=new Rh(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,n,i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}visibleRangeForPosition(e){let t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new cx(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=1,r=!0;for(let s=t;s<=n;s++){let a=this._visibleLines.getVisibleLine(s);if(e&&!a.getWidthIsFast()){r=!1;continue}i=Math.max(i,a.getWidth(null))}return r&&t===1&&n===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(i),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1,n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++){let s=this._visibleLines.getVisibleLine(r);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let n=this._horizontalRevealRequest;if(e.startLineNumber<=n.minLineNumber&&n.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let i=this._computeScrollLeftToReveal(n);i&&(this._isViewportWrapping||this._ensureMaxLineWidth(i.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:i.scrollLeft},n.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Gt&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,n,i,r,s){let a=e.top,l=e.height,d=a+l,c,u,p;if(r&&r.length>0){let v=r[0].startLineNumber,I=r[0].endLineNumber;for(let C=1,S=r.length;C<S;C++){let E=r[C];v=Math.min(v,E.startLineNumber),I=Math.max(I,E.endLineNumber)}c=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(v),p=this._context.viewLayout.getVerticalOffsetForLineNumber(I)+this._lineHeight}else if(i)c=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),p=this._context.viewLayout.getVerticalOffsetForLineNumber(i.endLineNumber)+this._lineHeight;else return-1;let m=(t==="mouse"||n)&&this._cursorSurroundingLinesStyle==="default",g=0,f=0;if(m)n||(g=this._lineHeight);else{let v=l/this._lineHeight,I=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),C=Math.min(v/2,I);g=C*this._lineHeight,f=Math.max(0,C-1)*this._lineHeight}n||(s===0||s===4)&&(f+=this._lineHeight),u-=g,p+=f;let b;if(p-u>l){if(!c)return-1;b=u}else if(s===5||s===6)if(s===6&&a<=u&&p<=d)b=a;else{let v=Math.max(5*this._lineHeight,l*.2),I=u-v,C=p-l;b=Math.max(C,I)}else if(s===1||s===2)if(s===2&&a<=u&&p<=d)b=a;else{let v=(u+p)/2;b=Math.max(0,v-l/2)}else b=this._computeMinimumScrolling(a,d,u,p,s===3,s===4);return b}_computeScrollLeftToReveal(e){let t=this._context.viewLayout.getCurrentViewport(),n=this._context.configuration.options.get(147),i=t.left,r=i+t.width-n.verticalScrollbarWidth,s=1073741824,a=0;if(e.type==="range"){let d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let u of c.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(s=Math.max(0,s-o.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(i,r,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,n,i,r,s){e=e|0,t=t|0,n=n|0,i=i|0,r=!!r,s=!!s;let a=t-e;if(i-n<a){if(r)return n;if(s)return Math.max(0,i-a);if(n<e)return n;if(i>t)return Math.max(0,i-a)}else return n;return e}};var Wx=class extends zh{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(e){super(),this._context=e;let n=this._context.configuration.options.get(147);this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(n[i++]=new cu(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(n[i++]=new cu(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+s+'px;"></div>',l=[];for(let d=t;d<=n;d++){let c=d-t,u=i[c].getDecorations(),p="";for(let m of u){let g='<div class="cldr '+m.className;m.tooltip!==null&&(g+='" title="'+m.tooltip),g+=a,p+=g}l[c]=p}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var $h=class o extends At{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._domNode=Ne(document.createElement("div")),this._domNode.setClassName(o.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Ne(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(o.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);let n=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(n),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(n)}};var Vx=class extends zh{_context;_renderResult;constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.marginClassName,d=a.options.zIndex;l&&(n[i++]=new cu(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=[];for(let s=t;s<=n;s++){let a=s-t,l=i[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';r[a]=d}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var bs=class o{_rgba8Brand=void 0;static Empty=new o(0,0,0,0);r;g;b;a;constructor(e,t,n,i){this.r=o._clamp(e),this.g=o._clamp(t),this.b=o._clamp(n),this.a=o._clamp(i)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};var BB=(()=>{let o=[];for(let e=32;e<=126;e++)o.push(e);return o.push(65533),o})(),WB=(o,e)=>(o-=32,o<0||o>96?e<=2?(o+96)%96:95:o);var db=class o{constructor(e,t){this.scale=t;this.charDataNormal=o.soften(e,12/15),this.charDataLight=o.soften(e,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(e,t){let n=new Uint8ClampedArray(e.length);for(let i=0,r=e.length;i<r;i++)n[i]=Kd(e[i]*t);return n}renderChar(e,t,n,i,r,s,a,l,d,c,u){let p=1*this.scale,m=2*this.scale,g=u?1:m;if(t+p>e.width||n+g>e.height){console.warn("bad render request outside image data");return}let f=c?this.charDataLight:this.charDataNormal,b=WB(i,d),v=e.width*4,I=a.r,C=a.g,S=a.b,E=r.r-I,M=r.g-C,A=r.b-S,F=Math.max(s,l),O=e.data,H=b*p*m,U=n*v+t*4;for(let z=0;z<g;z++){let re=U;for(let ve=0;ve<p;ve++){let ee=f[H++]/255*(s/255);O[re++]=I+E*ee,O[re++]=C+M*ee,O[re++]=S+A*ee,O[re++]=F}U+=v}}blockRenderChar(e,t,n,i,r,s,a,l){let d=1*this.scale,c=2*this.scale,u=l?1:c;if(t+d>e.width||n+u>e.height){console.warn("bad render request outside image data");return}let p=e.width*4,m=.5*(r/255),g=s.r,f=s.g,b=s.b,v=i.r-g,I=i.g-f,C=i.b-b,S=g+v*m,E=f+I*m,M=b+C*m,A=Math.max(r,a),F=e.data,O=n*p+t*4;for(let H=0;H<u;H++){let U=O;for(let z=0;z<d;z++)F[U++]=S,F[U++]=E,F[U++]=M,F[U++]=A;O+=p}}};var jh=class o extends W{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=Dl(new o)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new L;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(uo.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let e=uo.getColorMap();if(!e){this._colors=[bs.Empty],this._backgroundIsLight=!0;return}this._colors=[bs.Empty];for(let n=1;n<e.length;n++){let i=e[n].rgba;this._colors[n]=new bs(i.r,i.g,i.b,Math.round(i.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};var HB={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},UB=o=>{let e=new Uint8ClampedArray(o.length/2);for(let t=0;t<o.length;t+=2)e[t>>1]=HB[o[t]]<<4|HB[o[t+1]]&15;return e},vD={1:wa(()=>UB("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:wa(()=>UB("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var Hx=class o{static lastCreated;static lastFontFamily;static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let n;return vD[e]?n=new db(vD[e](),e):n=o.createFromSampleData(o.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=n,n}static createSampleData(e){let t=document.createElement("canvas"),n=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",n.fillStyle="#ffffff",n.font=`bold 16px ${e}`,n.textBaseline="middle";let i=0;for(let r of BB)n.fillText(String.fromCharCode(r),i,16/2),i+=10;return n.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){let n=16*10*4*96;if(e.length!==n)throw new Error("Unexpected source in MinimapCharRenderer");let i=o._downsample(e,t);return new db(i,t)}static _downsampleChar(e,t,n,i,r){let s=1*r,a=2*r,l=i,d=0;for(let c=0;c<a;c++){let u=c/a*16,p=(c+1)/a*16;for(let m=0;m<s;m++){let g=m/s*10,f=(m+1)/s*10,b=0,v=0;for(let C=u;C<p;C++){let S=t+Math.floor(C)*3840,E=1-(C-Math.floor(C));for(let M=g;M<f;M++){let A=1-(M-Math.floor(M)),F=S+Math.floor(M)*4,O=A*E;v+=O,b+=e[F]*e[F+3]/255*O}}let I=b/v;d=Math.max(d,I),n[l++]=Kd(I)}}return d}static _downsample(e,t){let n=2*t*1*t,i=n*96,r=new Uint8ClampedArray(i),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(e,a,r,s,t)),s+=n,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<i;c++)r[c]*=d}return r}};var zB=dt?'"Segoe WPC", "Segoe UI", sans-serif':Be?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var U7=140,z7=2,Ux=class o{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(e,t,n){let i=e.options,r=i.get(145),s=i.get(147),a=s.minimap,l=i.get(51),d=i.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=i.get(107),this.paddingTop=i.get(85).top,this.paddingBottom=i.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=i.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=zB,this.sectionHeaderFontSize=d.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=o._getSectionHeaderColor(t,n.getColor(1)),this.charRenderer=wa(()=>Hx.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=n.getColor(2),this.backgroundColor=o._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=o._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){let n=e.getColor(cN);return n?new bs(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}static _getMinimapForegroundOpacity(e){let t=e.getColor(uN);return t?bs._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){let n=e.getColor(Yy);return n?new bs(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}},yD=class o{constructor(e,t,n,i,r,s,a,l,d){this.scrollTop=e;this.scrollHeight=t;this.sliderNeeded=n;this._computedSliderRatio=i;this.sliderTop=r;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumber,e.endLineNumber);return t>n?null:[t,n]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,n,i,r,s,a,l,d,c,u){let p=e.pixelRatio,m=e.minimapLineHeight,g=Math.floor(e.canvasInnerHeight/m),f=e.lineHeight;if(e.minimapHeightIsEditorHeight){let M=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(M+=Math.max(0,r-e.lineHeight-e.paddingBottom));let A=Math.max(1,Math.floor(r*r/M)),F=Math.max(0,e.minimapHeight-A),O=F/(c-r),H=d*O,U=F>0,z=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),re=Math.floor(e.paddingTop/e.lineHeight);return new o(d,c,U,O,H,A,re,1,Math.min(a,z))}let b;if(s&&n!==a){let M=n-t+1;b=Math.floor(M*m/p)}else{let M=r/f;b=Math.floor(M*m/p)}let v=Math.floor(e.paddingTop/f),I=Math.floor(e.paddingBottom/f);if(e.scrollBeyondLastLine){let M=r/f;I=Math.max(I,M-1)}let C;if(I>0){let M=r/f;C=(v+a+I-M-1)*m/p}else C=Math.max(0,(v+a)*m/p-b);C=Math.min(e.minimapHeight-b,C);let S=C/(c-r),E=d*S;if(g>=v+a+I){let M=C>0;return new o(d,c,M,S,E,b,v,1,a)}else{let M;t>1?M=t+v:M=Math.max(1,d/f);let A,F=Math.max(1,Math.floor(M-E*p/m));F<v?(A=v-F+1,F=1):(A=0,F=Math.max(1,F-v)),u&&u.scrollHeight===c&&(u.scrollTop>d&&(F=Math.min(F,u.startLineNumber),A=Math.max(A,u.topPaddingLineCount)),u.scrollTop<d&&(F=Math.max(F,u.startLineNumber),A=Math.min(A,u.topPaddingLineCount)));let O=Math.min(a,F-A+g-1),H=(d-i)/f,U;return d>=e.paddingTop?U=(t-F+A+H)*m/p:U=d/e.paddingTop*(A+H)*m/p,new o(d,c,!0,S,U,b,A,F,O)}}},zx=class o{static INVALID=new o(-1);dy;constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},Kx=class{renderedLayout;_imageData;_renderedLines;constructor(e,t,n){this.renderedLayout=e,this._imageData=t,this._renderedLines=new tb({createLine:()=>zx.INVALID}),this._renderedLines._set(e.startLineNumber,n)}linesEquals(e){if(!this.scrollEquals(e))return!1;let n=this._renderedLines._get().lines;for(let i=0,r=n.length;i<r;i++)if(n[i].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){let e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}},ID=class o{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(e,t,n,i){this._backgroundFillData=o._createBackgroundFillData(t,n,i),this._buffers=[e.createImageData(t,n),e.createImageData(t,n)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,n){let i=n.r,r=n.g,s=n.b,a=n.a,l=new Uint8ClampedArray(e*t*4),d=0;for(let c=0;c<t;c++)for(let u=0;u<e;u++)l[d]=i,l[d+1]=r,l[d+2]=s,l[d+3]=a,d+=4;return l}},Gx=class o{constructor(e,t){this.samplingRatio=e;this.minimapLines=t}static compute(e,t,n){if(e.renderMinimap===0||!e.isSampling)return[null,[]];let{minimapLineCount:i}=ug.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/i,s=r/2;if(!n||n.minimapLines.length===0){let b=[];if(b[0]=1,i>1){for(let v=0,I=i-1;v<I;v++)b[v]=Math.round(v*r+s);b[i-1]=t}return[new o(r,b),[]]}let a=n.minimapLines,l=a.length,d=[],c=0,u=0,p=1,m=10,g=[],f=null;for(let b=0;b<i;b++){let v=Math.max(p,Math.round(b*r)),I=Math.max(v,Math.round((b+1)*r));for(;c<l&&a[c]<v;){if(g.length<m){let S=c+1+u;f&&f.type==="deleted"&&f._oldIndex===c-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:c,deleteFromLineNumber:S,deleteToLineNumber:S},g.push(f)),u--}c++}let C;if(c<l&&a[c]<=I)C=a[c],c++;else if(b===0?C=1:b+1===i?C=t:C=Math.round(b*r+s),g.length<m){let S=c+1+u;f&&f.type==="inserted"&&f._i===b-1?f.insertToLineNumber++:(f={type:"inserted",_i:b,insertFromLineNumber:S,insertToLineNumber:S},g.push(f)),u++}d[b]=C,p=C}if(g.length<m)for(;c<l;){let b=c+1+u;f&&f.type==="deleted"&&f._oldIndex===c-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:c,deleteFromLineNumber:b,deleteToLineNumber:b},g.push(f)),u--,c++}else g=[{type:"flush"}];return[new o(r,d),g]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e)-1;for(;n>0&&this.minimapLines[n-1]>=e;)n--;let i=this.modelLineToMinimapLine(t)-1;for(;i+1<this.minimapLines.length&&this.minimapLines[i+1]<=t;)i++;if(n===i){let r=this.minimapLines[n];if(r<e||r>t)return null}return[n+1,i+1]}decorationLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e),i=this.modelLineToMinimapLine(t);return e!==t&&i===n&&(i===this.minimapLines.length?n>1&&n--:i++),[n,i]}onLinesDeleted(e){let t=e.toLineNumber-e.fromLineNumber+1,n=this.minimapLines.length,i=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),n=Math.min(n,r),i=Math.max(i,r)):this.minimapLines[r]-=t;return[n,i]}onLinesInserted(e){let t=e.toLineNumber-e.fromLineNumber+1;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<e.fromLineNumber);n--)this.minimapLines[n]+=t}},$x=class extends At{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new Hi(10,1.5);_actual;constructor(e){super(e),this.tokensColorTracker=jh.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Ux(this._context.configuration,this._context.theme,this.tokensColorTracker);let[t]=Gx.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new CD(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let e=new Ux(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){let t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){let[t,n]=this._samplingState.onLinesDeleted(e);return t<=n&&this._actual.onLinesChanged(t+1,n-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(let n of e.ranges){let i=this._samplingState.modelLineRangeToMinimapLineRange(n.fromLineNumber,n.toLineNumber);i&&t.push({fromLineNumber:i[0],toLineNumber:i[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),n=this._samplingState.modelLineToMinimapLine(n));let i={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:n,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(i)}_recreateLineSampling(){this._minimapSelections=null;let e=!!this._samplingState,[t,n]=Gx.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(let i of n)switch(i.type){case"deleted":this._actual.onLinesDeleted(i.deleteFromLineNumber,i.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(i.insertFromLineNumber,i.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,n){if(this._samplingState){let i=[];for(let r=0,s=t-e+1;r<s;r++)n[r]?i[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):i[r]=null;return i}return this._context.viewModel.getMinimapLinesRenderingData(e,t,n).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let e of this._selections){let[t,n]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new De(t,e.startColumn,n,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let n=this._getMinimapDecorationsInViewport(e,t).filter(i=>!i.options.minimap?.sectionHeaderStyle);if(this._samplingState){let i=[];for(let r of n){if(!r.options.minimap)continue;let s=r.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);i.push(new dh(new w(a,s.startColumn,l,s.endColumn),r.options))}return i}return n}getSectionHeaderDecorationsInViewport(e,t){let n=this.options.minimapLineHeight,r=this.options.sectionHeaderFontSize/n;return e=Math.floor(Math.max(1,e-r)),this._getMinimapDecorationsInViewport(e,t).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let n;if(this._samplingState){let i=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];n=new w(i,1,r,this._context.viewModel.getLineMaxColumn(r))}else n=new w(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(n)}getSectionHeaderText(e,t){let n=e.options.minimap?.sectionHeaderText;if(!n)return null;let i=this._sectionHeaderCache.get(n);if(i)return i;let r=t(n);return this._sectionHeaderCache.set(n,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new w(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}},CD=class o extends W{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(e,t){super(),this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(RL),this._domNode=Ne(document.createElement("div")),Hn.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Ne(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Ne(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Ne(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Ne(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Ne(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=Wn(this._domNode.domNode,we.POINTER_DOWN,n=>{if(n.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(n.button===0&&this._lastRenderData){let d=Zi(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(n,c,this._lastRenderData.renderedLayout)}return}let r=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*n.offsetY,l=Math.floor(s/r)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new pa,this._sliderPointerDownListener=Wn(this._slider.domNode,we.POINTER_DOWN,n=>{n.preventDefault(),n.stopPropagation(),n.button===0&&this._lastRenderData&&this._startSliderDragging(n,n.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Sn.addTarget(this._domNode.domNode),this._sliderTouchStartListener=q(this._domNode.domNode,ht.Start,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(n))},{passive:!1}),this._sliderTouchMoveListener=q(this._domNode.domNode,ht.Change,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(n)},{passive:!1}),this._sliderTouchEndListener=Wn(this._domNode.domNode,ht.End,n=>{n.preventDefault(),n.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,n){if(!e.target||!(e.target instanceof Element))return;let i=e.pageX;this._slider.toggleClassName("active",!0);let r=(s,a)=>{let l=Zi(this._domNode.domNode),d=Math.min(Math.abs(a-i),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(dt&&d>U7){this._model.setScrollTop(n.scrollTop);return}let c=s-t;this._model.setScrollTop(n.getDesiredScrollTopFromDelta(c))};e.pageY!==t&&r(e.pageY,i),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>r(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){let t=this._domNode.domNode.getBoundingClientRect().top,n=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(n)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new ID(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(RL),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let n=yD.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(n.sliderNeeded?"block":"none"),this._slider.setTop(n.sliderTop),this._slider.setHeight(n.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(n.sliderHeight),this.renderDecorations(n),this._lastRenderData=this.renderLines(n)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;let t=this._model.getSelections();t.sort(w.compareRangesUsingStarts);let n=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);n.sort((p,m)=>(p.options.zIndex||0)-(m.options.zIndex||0));let{canvasInnerWidth:i,canvasInnerHeight:r}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,i,r);let c=new jx(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(d,t,c,e,s),this._renderDecorationsLineHighlights(d,n,c,e,s);let u=new jx(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(d,t,u,e,s,l,a,i),this._renderDecorationsHighlights(d,n,u,e,s,l,a,i),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,n,i,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of t){let d=i.intersectWithViewport(l);if(!d)continue;let[c,u]=d;for(let g=c;g<=u;g++)n.set(g,!0);let p=i.getYForLineNumber(c,r),m=i.getYForLineNumber(u,r);a>=p||(a>s&&e.fillRect(Kr,s,e.canvas.width,a-s),s=p),a=m}a>s&&e.fillRect(Kr,s,e.canvas.width,a-s)}_renderDecorationsLineHighlights(e,t,n,i,r){let s=new Map;for(let a=t.length-1;a>=0;a--){let l=t[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=i.intersectWithViewport(l.range);if(!c)continue;let[u,p]=c,m=d.getColor(this._theme.value);if(!m||m.isTransparent())continue;let g=s.get(m.toString());g||(g=m.transparent(.5).toString(),s.set(m.toString(),g)),e.fillStyle=g;for(let f=u;f<=p;f++){if(n.has(f))continue;n.set(f,!0);let b=i.getYForLineNumber(u,r);e.fillRect(Kr,b,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,n,i,r,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of t){let c=i.intersectWithViewport(d);if(!c)continue;let[u,p]=c;for(let m=u;m<=p;m++)this.renderDecorationOnLine(e,n,d,this._selectionColor,i,m,r,r,s,a,l)}}_renderDecorationsHighlights(e,t,n,i,r,s,a,l){for(let d of t){let c=d.options.minimap;if(!c)continue;let u=i.intersectWithViewport(d.range);if(!u)continue;let[p,m]=u,g=c.getColor(this._theme.value);if(!(!g||g.isTransparent()))for(let f=p;f<=m;f++)switch(c.position){case 1:this.renderDecorationOnLine(e,n,d.range,g,i,f,r,r,s,a,l);continue;case 2:{let b=i.getYForLineNumber(f,r);this.renderDecoration(e,g,2,b,z7,r);continue}}}}renderDecorationOnLine(e,t,n,i,r,s,a,l,d,c,u){let p=r.getYForLineNumber(s,l);if(p+a<0||p>this._model.options.canvasInnerHeight)return;let{startLineNumber:m,endLineNumber:g}=n,f=m===s?n.startColumn:1,b=g===s?n.endColumn:this._model.getLineMaxColumn(s),v=this.getXOffsetForPosition(t,s,f,d,c,u),I=this.getXOffsetForPosition(t,s,b,d,c,u);this.renderDecoration(e,i,v,p,I-v,a)}getXOffsetForPosition(e,t,n,i,r,s){if(n===1)return Kr;if((n-1)*r>=s)return s;let l=e.get(t);if(!l){let d=this._model.getLineContent(t);l=[Kr];let c=Kr;for(let u=1;u<d.length+1;u++){let p=d.charCodeAt(u-1),m=p===9?i*r:Xo(p)?2*r:r,g=c+m;if(g>=s){l[u]=s;break}l[u]=g,c=g}e.set(t,l)}return n-1<l.length?l[n-1]:s}renderDecoration(e,t,n,i,r,s){e.fillStyle=t&&t.toString()||"",e.fillRect(n,i,r,s)}_renderSectionHeaders(e){let t=this._model.options.minimapLineHeight,n=this._model.options.sectionHeaderFontSize,i=this._model.options.sectionHeaderLetterSpacing,r=n*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,u=c,p=this._decorationsCanvas.domNode.getContext("2d");p.letterSpacing=i+"px",p.font="500 "+n+"px "+this._model.options.sectionHeaderFontFamily,p.strokeStyle=u,p.lineWidth=.2;let m=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);m.sort((f,b)=>f.range.startLineNumber-b.range.startLineNumber);let g=o._fitSectionHeader.bind(null,p,s-Kr);for(let f of m){let b=e.getYForLineNumber(f.range.startLineNumber,t)+n,v=b-n,I=v+2,C=this._model.getSectionHeaderText(f,g);o._renderSectionLabel(p,C,f.options.minimap?.sectionHeaderStyle===2,l,c,s,v,r,b,I)}}static _fitSectionHeader(e,t,n){if(!n)return n;let i="\u2026",r=e.measureText(n).width,s=e.measureText(i).width;if(r<=t||r<=s)return n;let a=n.length,l=r/n.length,d=Math.floor((t-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(n[c-1]);)--c;return n.substring(0,c)+i+n.substring(a-(d-c))}static _renderSectionLabel(e,t,n,i,r,s,a,l,d,c){t&&(e.fillStyle=i,e.fillRect(0,a,s,l),e.fillStyle=r,e.fillText(t,Kr,d)),n&&(e.beginPath(),e.moveTo(0,c),e.lineTo(s,c),e.closePath(),e.stroke())}renderLines(e){let t=e.startLineNumber,n=e.endLineNumber,i=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){let ee=this._lastRenderData._get();return new Kx(e,ee.imageData,ee.lines)}let r=this._getBuffer();if(!r)return null;let[s,a,l]=o._renderUntouchedLines(r,e.topPaddingLineCount,t,n,i,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(t,n,l),c=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,p=this._model.options.backgroundColor,m=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,f=g.backgroundIsLight(),b=this._model.options.renderMinimap,v=this._model.options.charRenderer(),I=this._model.options.fontScale,C=this._model.options.minimapCharWidth,E=(b===1?2:3)*I,M=i>E?Math.floor((i-E)/2):0,A=p.a/255,F=new bs(Math.round((p.r-u.r)*A+u.r),Math.round((p.g-u.g)*A+u.g),Math.round((p.b-u.b)*A+u.b),255),O=e.topPaddingLineCount*i,H=[];for(let ee=0,Q=n-t+1;ee<Q;ee++)l[ee]&&o._renderLine(r,F,p.a,f,b,C,g,m,v,O,M,c,d[ee],I,i),H[ee]=new zx(O),O+=i;let U=s===-1?0:s,re=(a===-1?r.height:a)-U;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,U,r.width,re),new Kx(e,r,H)}static _renderUntouchedLines(e,t,n,i,r,s){let a=[];if(!s){for(let O=0,H=i-n+1;O<H;O++)a[O]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,u=l.lines,p=u.length,m=e.width,g=e.data,f=(i-n+1)*r*m*4,b=-1,v=-1,I=-1,C=-1,S=-1,E=-1,M=t*r;for(let O=n;O<=i;O++){let H=O-n,U=O-c,z=U>=0&&U<p?u[U].dy:-1;if(z===-1){a[H]=!0,M+=r;continue}let re=z*m*4,ve=(z+r)*m*4,ee=M*m*4,Q=(M+r)*m*4;C===re&&E===ee?(C=ve,E=Q):(I!==-1&&(g.set(d.subarray(I,C),S),b===-1&&I===0&&I===S&&(b=C),v===-1&&C===f&&I===S&&(v=I)),I=re,C=ve,S=ee,E=Q),a[H]=!1,M+=r}I!==-1&&(g.set(d.subarray(I,C),S),b===-1&&I===0&&I===S&&(b=C),v===-1&&C===f&&I===S&&(v=I));let A=b===-1?-1:b/(m*4),F=v===-1?-1:v/(m*4);return[A,F,a]}static _renderLine(e,t,n,i,r,s,a,l,d,c,u,p,m,g,f){let b=m.content,v=m.tokens,I=e.width-s,C=f===1,S=Kr,E=0,M=0;for(let A=0,F=v.getCount();A<F;A++){let O=v.getEndOffset(A),H=v.getForeground(A),U=a.getColor(H);for(;E<O;E++){if(S>I)return;let z=b.charCodeAt(E);if(z===9){let re=p-(E+M)%p;M+=re-1,S+=re*s}else if(z===32)S+=s;else{let re=Xo(z)?2:1;for(let ve=0;ve<re;ve++)if(r===2?d.blockRenderChar(e,S,c+u,U,l,t,n,C):d.renderChar(e,S,c+u,z,U,l,t,n,g,i,C),S+=s,S>I)return}}}}},jx=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(e,t,n){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=n,this._values=[];for(let i=0,r=this._endLineNumber-this._startLineNumber+1;i<r;i++)this._values[i]=n}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}};var qx=class extends At{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(e,t){super(e),this._viewDomNode=t;let i=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=Ne(document.createElement("div")),Hn.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=Ne(document.createElement("div")),Hn.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,!0}addWidget(e){let t=Ne(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){let n=this._widgets[e.getId()],i=t?t.preference:null,r=t?.stackOridinal;return n.preference===i&&n.stack===r?(this._updateMaxMinWidth(),!1):(n.preference=i,n.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0,t=Object.keys(this._widgets);for(let n=0,i=t.length;n<i;n++){let r=t[n],a=this._widgets[r].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){let n=e.domNode;if(e.preference===null){n.setTop("");return}let i=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){let r=n.domNode.clientHeight;n.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else n.setTop(0);e.stack!==void 0?(n.setTop(t[e.preference]),t[e.preference]+=n.domNode.clientWidth):n.setRight(i)}else if(e.preference===2)n.domNode.style.right="50%",e.stack!==void 0?(n.setTop(t[2]),t[2]+=n.domNode.clientHeight):n.setTop(0);else{let{top:r,left:s}=e.preference;if(this._context.configuration.options.get(43)&&e.widget.allowEditorOverflow){let l=this._viewDomNodeRect;n.setTop(r+l.top),n.setLeft(s+l.left),n.setPosition("fixed")}else n.setTop(r),n.setLeft(s),n.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=Zi(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);let t=Object.keys(this._widgets),n=Array.from({length:3},()=>0);t.sort((i,r)=>(this._widgets[i].stack||0)-(this._widgets[r].stack||0));for(let i=0,r=t.length;i<r;i++){let s=t[i];this._renderWidget(this._widgets[s],n)}}};var SD=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(e,t){let n=e.options;this.lineHeight=n.get(68),this.pixelRatio=n.get(145),this.overviewRulerLanes=n.get(84),this.renderBorder=n.get(83);let i=t.getColor(PO);this.borderColor=i?i.toString():null,this.hideCursor=n.get(60);let r=t.getColor(Sp);this.cursorColorSingle=r?r.transparent(.7).toString():null;let s=t.getColor(nI);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=t.getColor(iI);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;let l=n.get(74),d=l.enabled,c=l.side,u=t.getColor(AO),p=uo.getDefaultBackground();u?this.backgroundColor=u:d&&c==="right"?this.backgroundColor=p:this.backgroundColor=null;let g=n.get(147).overviewRuler;this.top=g.top,this.right=g.right,this.domWidth=g.width,this.domHeight=g.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[f,b]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=f,this.w=b}_initLanes(e,t,n){let i=t-e;if(n>=3){let r=Math.floor(i/3),s=Math.floor(i/3),a=i-r-s,l=e,d=l+r,c=l+r+a;return[[0,l,d,l,c,l,d,l],[0,r,a,r+a,s,r+a+s,a+s,r+a+s]]}else if(n===2){let r=Math.floor(i/2),s=i-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,s,r+s,r+s,r+s]]}else{let r=e,s=i;return[[0,r,r,r,r,r,r,r],[0,s,s,s,s,s,s,s]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&G.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}};var Yx=class extends At{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(e){super(e),this._domNode=Ne(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=uo.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new R(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){let t=new SD(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,n=e.selections.length;t<n;t++){let i=this._settings.cursorColorSingle;n>1&&(i=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:i})}return this._cursorPositions.sort((t,n)=>R.compare(t.position,n.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){let e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?G.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}let t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Uc.compareByRenderingProps),this._actualShouldRender===1&&!Uc.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!Kt(this._renderedCursorPositions,this._cursorPositions,(g,f)=>g.position.lineNumber===f.position.lineNumber&&g.color===f.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let n=this._settings.canvasWidth,i=this._settings.canvasHeight,r=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=i/a,d=6*this._settings.pixelRatio|0,c=d/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=G.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):(u.clearRect(0,0,n,i),u.fillStyle=G.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):u.clearRect(0,0,n,i);let p=this._settings.x,m=this._settings.w;for(let g of t){let f=g.color,b=g.data;u.fillStyle=f;let v=0,I=0,C=0;for(let S=0,E=b.length/3;S<E;S++){let M=b[3*S],A=b[3*S+1],F=b[3*S+2],O=s.getVerticalOffsetForLineNumber(A)*l|0,H=(s.getVerticalOffsetForLineNumber(F)+r)*l|0;if(H-O<d){let z=(O+H)/2|0;z<c?z=c:z+c>i&&(z=i-c),O=z-c,H=z+c}O>C+1||M!==v?(S!==0&&u.fillRect(p[v],I,m[v],C-I),v=M,I=O,C=H):H>C&&(C=H)}u.fillRect(p[v],I,m[v],C-I)}if(!this._settings.hideCursor){let g=2*this._settings.pixelRatio|0,f=g/2|0,b=this._settings.x[7],v=this._settings.w[7],I=-100,C=-100,S=null;for(let E=0,M=this._cursorPositions.length;E<M;E++){let A=this._cursorPositions[E].color;if(!A)continue;let F=this._cursorPositions[E].position,O=s.getVerticalOffsetForLineNumber(F.lineNumber)*l|0;O<f?O=f:O+f>i&&(O=i-f);let H=O-f,U=H+g;H>C+1||A!==S?(E!==0&&S&&u.fillRect(b,I,v,C-I),I=H,C=U):U>C&&(C=U),S=A,u.fillStyle=A}S&&u.fillRect(b,I,v,C-I)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,i),u.moveTo(1,0),u.lineTo(n,0),u.stroke())}};var Qx=class extends _r{_context;_domNode;_zoneManager;constructor(e,t){super(),this._context=e;let n=this._context.configuration.options;this._domNode=Ne(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new MC(i=>this._context.viewLayout.getVerticalOffsetForLineNumber(i)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(n.get(68)),this._zoneManager.setPixelRatio(n.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return e.hasChanged(68)&&(this._zoneManager.setLineHeight(t.get(68)),this._render()),e.hasChanged(145)&&(this._zoneManager.setPixelRatio(t.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),n=this._zoneManager.resolveColorZones(),i=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),n.length>0&&this._renderOneLane(r,n,i,e),!0}_renderOneLane(e,t,n,i){let r=0,s=0,a=0;for(let l of t){let d=l.colorId,c=l.from,u=l.to;d!==r?(e.fillRect(0,s,i,a-s),r=d,e.fillStyle=n[r],s=c,a=u):a>=c?a=Math.max(a,u):(e.fillRect(0,s,i,a-s),s=c,a=u)}e.fillRect(0,s,i,a-s)}};var Zx=class extends At{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(e){super(e),this.domNode=Ne(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let t=this._context.configuration.options;this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){let e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){let{tabSize:i}=this._context.viewModel.model.getOptions(),r=i,s=t-e;for(;s>0;){let a=Ne(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let n=e-t;for(;n>0;){let i=this._renderedRulers.pop();this.domNode.removeChild(i),n--}}render(e){this._ensureRulersCount();for(let t=0,n=this._rulers.length;t<n;t++){let i=this._renderedRulers[t],r=this._rulers[t];i.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}};var Xx=class extends At{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let n=this._context.configuration.options.get(105);this._useShadows=n.useShadows,this._domNode=Ne(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let t=this._context.configuration.options.get(147);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){let n=this._context.configuration.options.get(105);return this._useShadows=n.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var xD=class{left;width;startStyle;endStyle;constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}},_D=class{lineNumber;ranges;constructor(e,t){this.lineNumber=e,this.ranges=t}};function K7(o){return new xD(o)}function G7(o){return new _D(o.lineNumber,o.ranges.map(K7))}var e_=class o extends Xi{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,n=e.length;t<n;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,n){let i=this._typicalHalfwidthCharacterWidth/4,r=null,s=null;if(n&&n.length>0&&t.length>0){let a=t[0].lineNumber;if(a===e.startLineNumber)for(let d=0;!r&&d<n.length;d++)n[d].lineNumber===a&&(r=n[d].ranges[0]);let l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let d=n.length-1;!s&&d>=0;d--)n[d].lineNumber===l&&(s=n[d].ranges[0]);r&&!r.startStyle&&(r=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=t.length;a<l;a++){let d=t[a].ranges[0],c=d.left,u=d.left+d.width,p={top:0,bottom:0},m={top:0,bottom:0};if(a>0){let g=t[a-1].ranges[0].left,f=t[a-1].ranges[0].left+t[a-1].ranges[0].width;Jx(c-g)<i?p.top=2:c>g&&(p.top=1),Jx(u-f)<i?m.top=2:g<u&&u<f&&(m.top=1)}else r&&(p.top=r.startStyle.top,m.top=r.endStyle.top);if(a+1<l){let g=t[a+1].ranges[0].left,f=t[a+1].ranges[0].left+t[a+1].ranges[0].width;Jx(c-g)<i?p.bottom=2:g<c&&c<f&&(p.bottom=1),Jx(u-f)<i?m.bottom=2:u<f&&(m.bottom=1)}else s&&(p.bottom=s.startStyle.bottom,m.bottom=s.endStyle.bottom);d.startStyle=p,d.endStyle=m}}_getVisibleRangesWithStyle(e,t,n){let r=(t.linesVisibleRangesForRange(e,!0)||[]).map(G7);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,n),r}_createSelectionPiece(e,t,n,i,r){return'<div class="cslr '+n+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+i.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,n,i){if(i.length===0)return;let r=!!i[0].ranges[0].startStyle,s=i[0].lineNumber,a=i[i.length-1].lineNumber;for(let l=0,d=i.length;l<d;l++){let c=i[l],u=c.lineNumber,p=u-t,m=n&&u===s?1:0,g=n&&u!==s&&u===a?1:0,f="",b="";for(let v=0,I=c.ranges.length;v<I;v++){let C=c.ranges[v];if(r){let E=C.startStyle,M=C.endStyle;if(E.top===1||E.bottom===1){f+=this._createSelectionPiece(m,g,o.SELECTION_CLASS_NAME,C.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH);let A=o.EDITOR_BACKGROUND_CLASS_NAME;E.top===1&&(A+=" "+o.SELECTION_TOP_RIGHT),E.bottom===1&&(A+=" "+o.SELECTION_BOTTOM_RIGHT),f+=this._createSelectionPiece(m,g,A,C.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH)}if(M.top===1||M.bottom===1){f+=this._createSelectionPiece(m,g,o.SELECTION_CLASS_NAME,C.left+C.width,o.ROUNDED_PIECE_WIDTH);let A=o.EDITOR_BACKGROUND_CLASS_NAME;M.top===1&&(A+=" "+o.SELECTION_TOP_LEFT),M.bottom===1&&(A+=" "+o.SELECTION_BOTTOM_LEFT),f+=this._createSelectionPiece(m,g,A,C.left+C.width,o.ROUNDED_PIECE_WIDTH)}}let S=o.SELECTION_CLASS_NAME;if(r){let E=C.startStyle,M=C.endStyle;E.top===0&&(S+=" "+o.SELECTION_TOP_LEFT),E.bottom===0&&(S+=" "+o.SELECTION_BOTTOM_LEFT),M.top===0&&(S+=" "+o.SELECTION_TOP_RIGHT),M.bottom===0&&(S+=" "+o.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(m,g,S,C.left,C.width)}e[p][0]+=f,e[p][1]+=b}}_previousFrameVisibleRangesWithStyle=[];prepareRender(e){let t=[],n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let s=n;s<=i;s++){let a=s-n;t[a]=["",""]}let r=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){r[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[s]);r[s]=d,this._actualRenderOneSelection(t,n,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([s,a])=>s+a)}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};ji((o,e)=>{let t=o.getColor(JA);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function Jx(o){return o<0?-o:o}var t_=class o extends At{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(e){super(e);let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new sb(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=Ne(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new so,this._cursorFlatBlinkInterval=new Yp,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let n=0,i=this._secondaryCursors.length;n<i;n++)this._secondaryCursors[n].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,n){let i=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&n!==3;if(this._primaryCursor.setPlurality(t.length?1:0),this._primaryCursor.onCursorPositionChanged(e,i),this._updateBlinking(),this._secondaryCursors.length<t.length){let r=t.length-this._secondaryCursors.length;for(let s=0;s<r;s++){let a=new sb(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){let r=this._secondaryCursors.length-t.length;for(let s=0;s<r;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],i)}onCursorStateChanged(e){let t=[];for(let i=0,r=e.selections.length;i<r;i++)t[i]=e.selections[i].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);let n=e.selections[0].isEmpty();return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=n=>{for(let i=0,r=e.ranges.length;i<r;i++)if(e.ranges[i].fromLineNumber<=n.lineNumber&&n.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(let n of this._secondaryCursors)if(t(n.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let e=this._getCursorBlinking(),t=e===0,n=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!n&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},o.BLINK_INTERVAL,fe(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},o.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case 1:e+=" cursor-line-style";break;case 2:e+=" cursor-block-style";break;case 3:e+=" cursor-underline-style";break;case 4:e+=" cursor-line-thin-style";break;case 5:e+=" cursor-block-outline-style";break;case 6:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,n=this._secondaryCursors.length;t<n;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],n=0,i=this._primaryCursor.render(e);i&&(t[n++]=i);for(let r=0,s=this._secondaryCursors.length;r<s;r++){let a=this._secondaryCursors[r].render(e);a&&(t[n++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};ji((o,e)=>{let t=[{class:".cursor",foreground:Sp,background:tI},{class:".cursor-primary",foreground:nI,background:bO},{class:".cursor-secondary",foreground:iI,background:vO}];for(let n of t){let i=o.getColor(n.foreground);if(i){let r=o.getColor(n.background);r||(r=i.opposite()),e.addRule(`.monaco-editor .cursors-layer ${n.class} { background-color: ${i}; border-color: ${i}; color: ${r}; }`),Ys(o.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${n.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});var wD=()=>{throw new Error("Invalid change accessor")},n_=class extends At{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this.domNode=Ne(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Ne(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=this._context.viewLayout.getWhitespaces(),t=new Map;for(let i of e)t.set(i.id,i);let n=!1;return this._context.viewModel.changeWhitespace(i=>{let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let u=t.get(l);u&&(u.afterLineNumber!==c.afterViewLineNumber||u.height!==c.heightInPx)&&(i.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),n=!0)}}),n}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,e.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new R(s,this._context.viewModel.model.getLineMaxColumn(s))}let n;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});let i=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(n);return{isInHiddenArea:!r,afterViewLineNumber:i.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(n=>{let i={addZone:r=>(t=!0,this._addZone(n,r)),removeZone:r=>{r&&(t=this._removeZone(n,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(n,r)||t)}};$7(e,i),i.addZone=wD,i.removeZone=wD,i.layoutZone=wD}),t}_addZone(e,t){let n=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(n.afterViewLineNumber,this._getZoneOrdinal(t),n.heightInPx,n.minWidthInPx),delegate:t,isInHiddenArea:n.isInHiddenArea,isVisible:!1,domNode:Ne(t.domNode),marginDomNode:t.marginDomNode?Ne(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,n.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t];return delete this._zones[t],e.removeWhitespace(n.whitespaceId),n.domNode.removeAttribute("monaco-visible-view-zone"),n.domNode.removeAttribute("monaco-view-zone"),n.domNode.domNode.remove(),n.marginDomNode&&(n.marginDomNode.removeAttribute("monaco-visible-view-zone"),n.marginDomNode.removeAttribute("monaco-view-zone"),n.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t],i=this._computeWhitespaceProps(n.delegate);return n.isInHiddenArea=i.isInHiddenArea,e.changeOneWhitespace(n.whitespaceId,i.afterViewLineNumber,i.heightInPx),this._safeCallOnComputedHeight(n.delegate,i.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(n){Ue(n)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(n){Ue(n)}}prepareRender(e){}render(e){let t=e.viewportData.whitespaceViewportData,n={},i=!1;for(let s of t)this._zones[s.id].isInHiddenArea||(n[s.id]=s,i=!0);let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=0,u=0,p="none";n.hasOwnProperty(l)?(c=n[l].verticalOffset-e.bigNumbersDelta,u=n[l].height,p="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(n[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(u),d.domNode.setDisplay(p),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(u),d.marginDomNode.setDisplay(p))}i&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function $7(o,e){try{return o(e)}catch(t){Ue(t)}}var i_=class extends Xi{_context;_options;_selection;_renderResult;constructor(e){super(),this._context=e,this._options=new o_(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=new o_(this._context.configuration);return this._options.equals(t)?e.hasChanged(147):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber-t+1,r=new Array(i);for(let a=0;a<i;a++)r[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,r);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){let l=a-e.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let u=this._selection;for(let p of u){if(p.endLineNumber<a||p.startLineNumber>a)continue;let m=p.startLineNumber===a?p.startColumn:d.minColumn,g=p.endLineNumber===a?p.endColumn:d.maxColumn;m<g&&(c||(c=[]),c.push(new Mh(m-1,g-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,c,d)}}_applyRenderWhitespace(e,t,n,i){if(this._options.renderWhitespace==="selection"&&!n||this._options.renderWhitespace==="trailing"&&i.continuesWithWrappedLine)return"";let r=this._context.theme.getColor(oI),s=this._options.renderWithSVG,a=i.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=i.continuesWithWrappedLine,c=i.minColumn-1,u=this._options.renderWhitespace==="boundary",p=this._options.renderWhitespace==="trailing",m=this._options.lineHeight,g=this._options.middotWidth,f=this._options.wsmiddotWidth,b=this._options.spaceWidth,v=Math.abs(f-b),I=Math.abs(g-b),C=v<I?11825:183,S=this._options.canUseHalfwidthRightwardsArrow,E="",M=!1,A=$t(a),F;A===-1?(M=!0,A=l,F=l):F=Zo(a);let O=0,H=n&&n[O],U=0;for(let z=c;z<l;z++){let re=a.charCodeAt(z);if(H&&z>=H.endOffset&&(O++,H=n&&n[O]),re!==9&&re!==32||p&&!M&&z<=F)continue;if(u&&z>=A&&z<=F&&re===32){let ee=z-1>=0?a.charCodeAt(z-1):0,Q=z+1<l?a.charCodeAt(z+1):0;if(ee!==32&&Q!==32)continue}if(u&&d&&z===l-1){let ee=z-1>=0?a.charCodeAt(z-1):0;if(re===32&&ee!==32&&ee!==9)continue}if(n&&(!H||H.startOffset>z||H.endOffset<=z))continue;let ve=e.visibleRangeForPosition(new R(t,z+1));ve&&(s?(U=Math.max(U,ve.left),re===9?E+=this._renderArrow(m,b,ve.left):E+=`<circle cx="${(ve.left+b/2).toFixed(2)}" cy="${(m/2).toFixed(2)}" r="${(b/7).toFixed(2)}" />`):re===9?E+=`<div class="mwh" style="left:${ve.left}px;height:${m}px;">${S?"\uFFEB":"\u2192"}</div>`:E+=`<div class="mwh" style="left:${ve.left}px;height:${m}px;">${String.fromCharCode(C)}</div>`)}return s?(U=Math.round(U+b),`<svg style="bottom:0;position:absolute;width:${U}px;height:${m}px" viewBox="0 0 ${U} ${m}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+E+"</svg>"):E}_renderArrow(e,t,n){let i=t/7,r=t,s=e/2,a=n,l={x:0,y:i/2},d={x:100/125*r,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},u={x:c.x+.1*d.x,y:c.y+.1*d.x},p={x:u.x+.35*d.x,y:u.y-.35*d.x},m={x:p.x,y:-p.y},g={x:u.x,y:-u.y},f={x:c.x,y:-c.y},b={x:d.x,y:-d.y},v={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,u,p,m,g,f,b,v].map(S=>`${(a+S.x).toFixed(2)} ${(s+S.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}},o_=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(e){let t=e.options,n=t.get(51),i=t.get(39);i==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):i==="svg"?(this.renderWhitespace=t.get(101),this.renderWithSVG=!0):(this.renderWhitespace=t.get(101),this.renderWithSVG=!1),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(68),this.stopRenderingLineAfter=t.get(119)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}};var qh=class extends At{};var ED=class{_onDidChange=new L;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},TD=new ED;var kD=class{constructor(e,t,n,i,r){this._context=e;this.modelLineNumber=t;this.distanceToModelLineStart=n;this.widthOfHiddenLineTextBefore=i;this.distanceToModelLineEnd=r}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(e){let t=new R(this.modelLineNumber,this.distanceToModelLineStart+1),n=new R(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},LD=Dn,Yh=class extends qh{constructor(t,n,i,r,s){super(t);this._keybindingService=r;this._instantiationService=s;this._viewController=n,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new De(1,1,1,1)],this._modelSelections=[new De(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Ne(document.createElement("textarea")),Hn.write(this.textArea,7),this.textArea.setClassName(`inputarea ${gl}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",ab(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",h("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Ne(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:m=>this._context.viewModel.getLineMaxColumn(m),getValueInRange:(m,g)=>this._context.viewModel.getValueInRange(m,g),getValueLengthInRange:(m,g)=>this._context.viewModel.getValueLengthInRange(m,g),modifyPosition:(m,g)=>this._context.viewModel.modifyPosition(m,g)},u={getDataToCopy:()=>Cx(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let g=this._selections[0];if(Be&&g.isEmpty()){let b=g.getStartPosition(),v=this._getWordBeforePosition(b);if(v.length===0&&(v=this._getCharacterBeforePosition(b)),v.length>0)return new zn(v,v.length,v.length,w.fromPositions(b),0)}if(Be&&!g.isEmpty()&&c.getValueLengthInRange(g,0)<500){let b=c.getValueInRange(g,0);return new zn(b,0,b.length,g,0)}if(ar&&!g.isEmpty()){let b="vscode-placeholder";return new zn(b,0,b.length,null,void 0)}return zn.EMPTY}if(J1){let g=this._selections[0];if(g.isEmpty()){let f=g.getStartPosition(),[b,v]=this._getAndroidWordAtPosition(f);if(b.length>0)return new zn(b,v,v,w.fromPositions(f),0)}return zn.EMPTY}let m=Hh.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return zn.fromScreenReaderContentState(m)},deduceModelPosition:(m,g,f)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(m,g,f)},p=this._register(new Sx(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(Uh,u,p,mr,{isAndroid:J1,isChrome:ld,isFirefox:Dn,isSafari:ar})),this._register(this._textAreaInput.onKeyDown(m=>{this._viewController.emitKeyDown(m)})),this._register(this._textAreaInput.onKeyUp(m=>{this._viewController.emitKeyUp(m)})),this._register(this._textAreaInput.onPaste(m=>{let g=!1,f=null,b=null;m.metadata&&(g=this._emptySelectionClipboard&&!!m.metadata.isFromEmptySelection,f=typeof m.metadata.multicursorText<"u"?m.metadata.multicursorText:null,b=m.metadata.mode),this._viewController.paste(m.text,g,f,b)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(m=>{m.replacePrevCharCnt||m.replaceNextCharCnt||m.positionDelta?(Co&&console.log(` => compositionType: <<${m.text}>>, ${m.replacePrevCharCnt}, ${m.replaceNextCharCnt}, ${m.positionDelta}`),this._viewController.compositionType(m.text,m.replacePrevCharCnt,m.replaceNextCharCnt,m.positionDelta)):(Co&&console.log(` => type: <<${m.text}>>`),this._viewController.type(m.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(m=>{this._viewController.setSelection(m)})),this._register(this._textAreaInput.onCompositionStart(m=>{let g=this.textArea.domNode,f=this._modelSelections[0],{distanceToModelLineStart:b,widthOfHiddenTextBefore:v}=(()=>{let C=g.value.substring(0,Math.min(g.selectionStart,g.selectionEnd)),S=C.lastIndexOf(`
`),E=C.substring(S+1),M=E.lastIndexOf("	"),A=E.length-M-1,F=f.getStartPosition(),O=Math.min(F.column-1,A),H=F.column-1-O,U=E.substring(0,E.length-O),{tabSize:z}=this._context.viewModel.model.getOptions(),re=j7(this.textArea.domNode.ownerDocument,U,this._fontInfo,z);return{distanceToModelLineStart:H,widthOfHiddenTextBefore:re}})(),{distanceToModelLineEnd:I}=(()=>{let C=g.value.substring(Math.max(g.selectionStart,g.selectionEnd)),S=C.indexOf(`
`),E=S===-1?C:C.substring(0,S),M=E.indexOf("	"),A=M===-1?E.length:E.length-M-1,F=f.getEndPosition(),O=Math.min(this._context.viewModel.model.getLineMaxColumn(F.lineNumber)-F.column,A);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(F.lineNumber)-F.column-O}})();this._context.viewModel.revealRange("keyboard",!0,w.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new kD(this._context,f.startLineNumber,b,v,I),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${gl} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(m=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${gl}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(TD.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(t){t.appendChild(this.textArea),t.appendChild(this.textAreaCover)}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(t){let n='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(t.lineNumber),r=Us(n,[]),s=!0,a=t.column,l=!0,d=t.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let u=i.charCodeAt(a-2);r.get(u)!==0?s=!1:a--}if(l&&d>i.length&&(l=!1),l){let u=i.charCodeAt(d-1);r.get(u)!==0?l=!1:d++}c++}return[i.substring(a-1,d-1),t.column-a]}_getWordBeforePosition(t){let n=this._context.viewModel.getLineContent(t.lineNumber),i=Us(this._context.configuration.options.get(133),[]),r=t.column,s=0;for(;r>1;){let a=n.charCodeAt(r-2);if(i.get(a)!==0||s>50)return n.substring(r-1,t.column-1);s++,r--}return n.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){let i=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!Ot(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);let n=t.get(3);this._accessibilitySupport===2&&n===Ws.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=n;let r=t.get(147).wrappingColumn;if(r!==-1&&this._accessibilitySupport!==1){let s=t.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(r*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=LD?0:1}onConfigurationChanged(t){let n=this._context.configuration.options,i=n.get(147);this._setAccessibilityOptions(n),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=n.get(51),this._lineHeight=n.get(68),this._emptySelectionClipboard=n.get(38),this._copyWithSyntaxHighlighting=n.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:r}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${r*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",ab(n,this._keybindingService)),this.textArea.setAttribute("aria-required",n.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(n.get(126))),(t.hasChanged(34)||t.hasChanged(93))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){let t=this._context.configuration.options;!TD.enabled||t.get(34)&&t.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new R(1,1);_primaryCursorVisibleRange=null;prepareRender(t){this._primaryCursorPosition=new R(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let i=this._visibleTextArea.visibleTextareaStart,r=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&i&&r&&r.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=lb(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+i.left-this._scrollLeft,p=r.left-i.left+1;if(u<this._contentLeft){let I=this._contentLeft-u;u+=I,c+=I,p-=I}p>this._contentWidth&&(p=this._contentWidth);let m=this._context.viewModel.getViewLineData(s.lineNumber),g=m.tokens.findTokenIndexAtOffset(s.column-1),f=m.tokens.findTokenIndexAtOffset(a.column-1),b=g===f,v=this._visibleTextArea.definePresentation(b?m.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:u,width:p,height:this._lineHeight,useCover:!1,color:(uo.getColorMap()||[])[v.foreground],italic:v.italic,bold:v.bold,underline:v.underline,strikethrough:v.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let n=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(n<0||n>this._contentHeight){this._renderAtTopLeft();return}if(Be||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??lb(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:LD?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:LD?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;let n=this.textArea,i=this.textAreaCover;Qt(n,this._fontInfo),n.setTop(t.top),n.setLeft(t.left),n.setWidth(t.width),n.setHeight(t.height),n.setColor(t.color?G.Format.CSS.formatHex(t.color):""),n.setFontStyle(t.italic?"italic":""),t.bold&&n.setFontWeight("bold"),n.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),i.setTop(t.useCover?t.top:0),i.setLeft(t.useCover?t.left:0),i.setWidth(t.useCover?t.width:0),i.setHeight(t.useCover?t.height:0);let r=this._context.configuration.options;r.get(58)?i.setClassName("monaco-editor-background textAreaCover "+$h.OUTER_CLASS_NAME):r.get(69).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+Gh.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};Yh=K([D(3,kn),D(4,ct)],Yh);function j7(o,e,t,n){if(e.length===0)return 0;let i=o.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";let r=o.createElement("span");Qt(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${n*t.spaceWidth}px`,r.append(e),i.appendChild(r),o.body.appendChild(i);let s=r.offsetWidth;return i.remove(),s}var r_=class extends W{constructor(t,n){super();this._domNode=t;this._onFocusChange=n;this._register(q(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(q(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(t){this._isFocused!==t&&(this._isFocused=t,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function Qh(o,e,t,n){return o.addEventListener(e,t,n),{dispose(){o.removeEventListener(e,t)}}}var Zh=class{constructor(e,t,n){this._domNode=e;this._context=t;this._keybindingService=n;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new De(1,1,1,1);_screenReaderContentState;onConfigurationChanged(e){this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let e=this._context.configuration.options,t=e.get(147);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._fontInfo=e.get(51),this._lineHeight=e.get(68),this._accessibilitySupport=e.get(2),this._accessibilityPageSize=e.get(3)}_updateDomAttributes(){let e=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",ab(e,this._keybindingService));let t=this._context.viewModel.model.getOptions().tabSize,n=e.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${t*n}px`}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new De(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent()}render(e){if(!this._screenReaderContentState)return;Qt(this._domNode,this._fontInfo);let t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),n=this._context.viewLayout.getCurrentScrollTop(),i=t-n;this._domNode.setTop(i),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let r=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=lb(r);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let e=this._accessibilitySupport===1?1:this._accessibilityPageSize,t={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:n=>this._context.viewModel.getLineMaxColumn(n),getValueInRange:(n,i)=>this._context.viewModel.getValueInRange(n,i),getValueLengthInRange:(n,i)=>this._context.viewModel.getValueLengthInRange(n,i),modifyPosition:(n,i)=>this._context.viewModel.modifyPosition(n,i)};return Hh.fromEditorSelection(t,this._primarySelection,e,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(e,t){let i=dC().document.getSelection();if(!i)return;let r=this._domNode.domNode.firstChild;if(!r)return;let s=dC().document.activeElement,a=new globalThis.Range;a.setStart(r,e),a.setEnd(r,t),i.removeAllRanges(),i.addRange(a),Zn(s)&&s.focus()}};Zh=K([D(2,kn)],Zh);var Xh=class extends qh{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new De(1,1,1,1);_textStartPositionWithinEditor=new R(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(e,t,n,i){super(e),this.domNode=new Oc(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new r_(this.domNode.domNode,r=>this._context.viewModel.setHasFocus(r))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=n.createInstance(Zh,this.domNode,e),this._register(q(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(i))),this._register(q(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(i),t.cut()})),this._register(q(this.domNode.domNode,"keyup",r=>t.emitKeyUp(new pt(r)))),this._register(q(this.domNode.domNode,"keydown",async r=>{let s=new pt(r);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(t,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),t.emitKeyDown(s)})),this._register(Qh(this._editContext,"textformatupdate",r=>this._handleTextFormatUpdate(r))),this._register(Qh(this._editContext,"characterboundsupdate",r=>this._updateCharacterBounds())),this._register(Qh(this._editContext,"textupdate",r=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=w.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(t,r),this._screenReaderSupport.writeScreenReaderContent()})),this._register(Qh(this._editContext,"compositionstart",r=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=w.fromPositions(s,s);this._compositionRangeWithinEditor=a,t.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(Qh(this._editContext,"compositionend",r=>{this._compositionRangeWithinEditor=void 0,t.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(e){e.appendChild(this.domNode),this._parent=e.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._renderingContext=e,this._screenReaderSupport.prepareRender(e),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new De(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(126)))}_updateEditContext(){let e=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._textStartPositionWithinEditor=e.textStartPositionWithinEditor}_emitTypeEvent(e,t){if(!this._editContext)return;let n=this._context.viewModel.model,i=n.getOffsetAt(this._textStartPositionWithinEditor),r=n.getOffsetAt(this._primarySelection.getEndPosition()),s=n.getOffsetAt(this._primarySelection.getStartPosition()),a=r-i,l=s-i,d=0,c=0;t.updateRangeEnd>a&&(d=t.updateRangeEnd-a),t.updateRangeStart<l&&(c=l-t.updateRangeStart);let u="";l<t.updateRangeStart&&(u+=this._editContext.text.substring(l,t.updateRangeStart)),u+=t.text,a>t.updateRangeEnd&&(u+=this._editContext.text.substring(t.updateRangeEnd,a));let p={text:u,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(e,p);let m=l-c+u.length;this._updateCursorStatesAfterType(m,t.selectionStart,t.selectionEnd)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_updateCursorStatesAfterType(e,t,n){let i=t-e,r=n-e,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,u=d.column;return new De(c,u+i,c,u+r)}).map(d=>ze.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let e=this._primarySelection.startColumn-1,t=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?t+=this._primarySelection.endColumn-1:t+=this._context.viewModel.model.getLineMaxColumn(a);let n=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),i=new w(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,n),r=this._context.viewModel.model.getValueInRange(i,0),s=i.getStartPosition();return{text:r,selectionStartOffset:e,selectionEndOffset:t,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(e){if(!this._editContext)return;let t=e.getTextFormats(),n=this._textStartPositionWithinEditor,i=[];t.forEach(r=>{let s=this._context.viewModel.model,a=s.getOffsetAt(n),l=s.getPositionAt(a+r.rangeStart),d=s.getPositionAt(a+r.rangeEnd),c=w.fromPositions(l,d),u=["edit-context-format-decoration",`underline-style-${r.underlineStyle.toLowerCase()}`,`underline-thickness-${r.underlineThickness.toLowerCase()}`];i.push({range:c,options:{description:"textFormatDecoration",inlineClassName:u.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,i)}_updateSelectionAndControlBounds(){if(!this._parent)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=i.top+r-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*t,d=i.left+n,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let m=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];m.length>0&&(d+=Math.min(...m.map(g=>Math.min(...g.ranges.map(f=>f.left)))))}c=e.get(51).typicalHalfwidthCharacterWidth/2}else c=i.width-n;let u=new DOMRect(d,a,c,l),p=u;this._editContext.updateControlBounds(p),this._editContext.updateSelectionBounds(u)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(r.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=i.top+s-a,d=[];if(this._renderingContext){let g=this._renderingContext.linesVisibleRangesForRange(r,!0)??[];for(let f of g)for(let b of f.ranges)d.push(new DOMRect(i.left+n+b.left,l,b.width,t))}let c=this._context.viewModel.model,u=c.getOffsetAt(this._textStartPositionWithinEditor),m=c.getOffsetAt(r.getStartPosition())-u;this._editContext.updateCharacterBounds(m,d)}_ensureClipboardGetsEditorSelection(e){let t=this._context.configuration.options,n=t.get(38),i=t.get(25),r=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=Cx(this._context.viewModel,r,n,i),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};au.INSTANCE.set(Dn?s.text.replace(/\r\n/g,`
`):s.text,a),e.writeText(s.text)}};Xh=K([D(2,ct),D(3,NS)],Xh);var Jh=class extends _r{constructor(t,n,i,r,s,a,l){super();this._instantiationService=l;this._selections=[new De(1,1,1,1)],this._renderAnimationFrame=null;let d=new Ix(n,r,s,t);this._context=new ux(n,i,r),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(Xh,this._context,d):this._instantiationService.createInstance(Yh,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=Ne(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Ne(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=Ne(document.createElement("div")),Hn.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new Nx(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new Bx(this._context,this._linesContent),this._viewZones=new n_(this._context),this._viewParts.push(this._viewZones);let u=new Yx(this._context);this._viewParts.push(u);let p=new Xx(this._context);this._viewParts.push(p);let m=new Ex(this._context);this._viewParts.push(m),m.addDynamicOverlay(new Mx(this._context)),m.addDynamicOverlay(new e_(this._context)),m.addDynamicOverlay(new Fx(this._context)),m.addDynamicOverlay(new Ax(this._context)),m.addDynamicOverlay(new i_(this._context));let g=new Tx(this._context);this._viewParts.push(g),g.addDynamicOverlay(new Px(this._context)),g.addDynamicOverlay(new Vx(this._context)),g.addDynamicOverlay(new Wx(this._context)),g.addDynamicOverlay(new Gh(this._context)),this._glyphMarginWidgets=new Ox(this._context),this._viewParts.push(this._glyphMarginWidgets);let f=new $h(this._context);f.getDomNode().appendChild(this._viewZones.marginDomNode),f.getDomNode().appendChild(g.getDomNode()),f.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(f),this._contentWidgets=new kx(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new t_(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new qx(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let b=new Zx(this._context);this._viewParts.push(b);let v=new Lx(this._context);this._viewParts.push(v);let I=new $x(this._context);if(this._viewParts.push(I),u){let C=this._scrollbar.getOverviewRulerLayoutInfo();C.parent.insertBefore(u.getDomNode(),C.insertBefore)}this._linesContent.appendChild(m.getDomNode()),this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(f.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(I.getDomNode()),this._overflowGuardContainer.appendChild(v.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new _x(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let t=this._context.viewModel.model,n=this._context.viewModel.glyphLanes,i=[],r=0;i=i.concat(t.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return r=Math.max(r,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=t.validateRange(s.preference.range);return r=Math.max(r,a.endLineNumber),{range:a,lane:s.preference.lane}})),i.sort((s,a)=>w.compareRangesUsingStarts(s.range,a.range)),n.reset(r);for(let s of i)n.push(s.lane,s.range,s.persist);return n}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._editContext.domNode.domNode.dispatchEvent(t)},getLastRenderData:()=>{let t=this._viewCursors.getLastRenderData()||[],n=this._editContext.getLastRenderData();return new yx(t,n)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,n)),visibleRangeForPosition:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new R(t,n))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){let n=this._context.configuration.options.get(147);this.domNode.setWidth(n.width),this.domNode.setHeight(n.height),this._overflowGuardContainer.setWidth(n.width),this._overflowGuardContainer.setHeight(n.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let t=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+Mg(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new Ke;if(this._renderAnimationFrame===null){let t=this._createCoordinatedRendering();this._renderAnimationFrame=DD.INSTANCE.scheduleCoordinatedRendering({window:fe(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new Ke;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new Ke;return t.renderText()},prepareRender:(n,i)=>{if(this._store.isDisposed)throw new Ke;return t.prepareRender(n,i)},render:(n,i)=>{if(this._store.isDisposed)throw new Ke;return t.render(n,i)}})}}_flushAccumulatedAndRenderNow(){let t=this._createCoordinatedRendering();Td(()=>t.prepareRenderText());let n=Td(()=>t.renderText());if(n){let[i,r]=n;Td(()=>t.prepareRender(i,r)),Td(()=>t.render(i,r))}}_getViewPartsToRender(){let t=[],n=0;for(let i of this._viewParts)i.shouldRender()&&(t[n++]=i);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}ml.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;let n=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(n.startLineNumber,n.endLineNumber,n.centeredLineNumber);let i=new ax(this._selections,n,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new lx(this._context.viewLayout,i,this._viewLines)]},prepareRender:(t,n)=>{for(let i of t)i.prepareRender(n)},render:(t,n)=>{for(let i of t)i.render(n),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,n){let i=this._context.viewModel.model.validatePosition({lineNumber:t,column:n}),r=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new R(r.lineNumber,r.column));return s?s.left:-1}getTargetAtClientPoint(t,n){let i=this._pointerHandler.getTargetAtClientPoint(t,n);return i?Wh.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new Qx(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,n){if(n){this._viewLines.forceShouldRender();for(let i of this._viewParts)i.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._editContext.writeScreenReaderContent(t)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(t){this._editContext.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){this._contentWidgets.setWidgetPosition(t.widget,t.position?.position??null,t.position?.secondaryPosition??null,t.position?.preference??null,t.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){this._overlayWidgets.setWidgetPosition(t.widget,t.position)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){let n=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,n)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};Jh=K([D(6,ct)],Jh);function Td(o){try{return o()}catch(e){return Ue(e),null}}var DD=class o{static INSTANCE=new o;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{let t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(let[n,i]of this._animationFrameRunners)i.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){let t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,Qp(e,t,100))}}_onRenderScheduled(){let e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let n of e)Td(()=>n.prepareRenderText());let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=Td(()=>r.renderText())}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;Td(()=>r.prepareRender(a,l))}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;Td(()=>r.render(a,l))}}};var Y7=Ed("domLineBreaksComputer",{createHTML:o=>o}),s_=class o{constructor(e){this.targetWindow=e}static create(e){return new o(new WeakRef(e))}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>Q7(Ms(this.targetWindow.deref()),s,e,t,n,i,r,a)}}};function Q7(o,e,t,n,i,r,s,a){function l(O){let H=a[O];if(H){let U=po.applyInjectedText(e[O],H),z=H.map(ve=>ve.options),re=H.map(ve=>ve.column-1);return new ol(re,z,[U.length],[],0)}else return null}if(i===-1){let O=[];for(let H=0,U=e.length;H<U;H++)O[H]=l(H);return O}let d=Math.round(i*t.typicalHalfwidthCharacterWidth),c=r===3?2:r===2?1:0,u=Math.round(n*c),p=Math.ceil(t.spaceWidth*u),m=document.createElement("div");Qt(m,t);let g=new Ha(1e4),f=[],b=[],v=[],I=[],C=[];for(let O=0;O<e.length;O++){let H=po.applyInjectedText(e[O],a[O]),U=0,z=0,re=d;if(r!==0)if(U=$t(H),U===-1)U=0;else{for(let ae=0;ae<U;ae++){let ne=H.charCodeAt(ae)===9?n-z%n:1;z+=ne}let Q=Math.ceil(t.spaceWidth*z);Q+t.typicalFullwidthCharacterWidth>d?(U=0,z=0):re=d-Q}let ve=H.substr(U),ee=Z7(ve,z,n,re,g,p);f[O]=U,b[O]=z,v[O]=ve,I[O]=ee[0],C[O]=ee[1]}let S=g.build(),E=Y7?.createHTML(S)??S;m.innerHTML=E,m.style.position="absolute",m.style.top="10000",s==="keepAll"?(m.style.wordBreak="keep-all",m.style.overflowWrap="anywhere"):(m.style.wordBreak="inherit",m.style.overflowWrap="break-word"),o.document.body.appendChild(m);let M=document.createRange(),A=Array.prototype.slice.call(m.children,0),F=[];for(let O=0;O<e.length;O++){let H=A[O],U=X7(M,H,v[O],I[O]);if(U===null){F[O]=l(O);continue}let z=f[O],re=b[O]+u,ve=C[O],ee=[];for(let Z=0,Ce=U.length;Z<Ce;Z++)ee[Z]=ve[U[Z]];if(z!==0)for(let Z=0,Ce=U.length;Z<Ce;Z++)U[Z]+=z;let Q,ae,ne=a[O];ne?(Q=ne.map(Z=>Z.options),ae=ne.map(Z=>Z.column-1)):(Q=null,ae=null),F[O]=new ol(ae,Q,U,ee,re)}return m.remove(),F}function Z7(o,e,t,n,i,r){if(r!==0){let p=String(r);i.appendString('<div style="text-indent: -'),i.appendString(p),i.appendString("px; padding-left: "),i.appendString(p),i.appendString("px; box-sizing: border-box; width:")}else i.appendString('<div style="width:');i.appendString(String(n)),i.appendString('px;">');let s=o.length,a=e,l=0,d=[],c=[],u=0<s?o.charCodeAt(0):0;i.appendString("<span>");for(let p=0;p<s;p++){p!==0&&p%16384===0&&i.appendString("</span><span>"),d[p]=l,c[p]=a;let m=u;u=p+1<s?o.charCodeAt(p+1):0;let g=1,f=1;switch(m){case 9:g=t-a%t,f=g;for(let b=1;b<=g;b++)b<g?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 32:u===32?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 60:i.appendString("&lt;");break;case 62:i.appendString("&gt;");break;case 38:i.appendString("&amp;");break;case 0:i.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:i.appendCharCode(65533);break;default:Xo(m)&&f++,m<32?i.appendCharCode(9216+m):i.appendCharCode(m)}l+=g,a+=f}return i.appendString("</span>"),d[o.length]=l,c[o.length]=a,i.appendString("</div>"),[d,c]}function X7(o,e,t,n){if(t.length<=1)return null;let i=Array.prototype.slice.call(e.children,0),r=[];try{MD(o,i,n,0,null,t.length-1,null,r)}catch(s){return console.log(s),null}return r.length===0?null:(r.push(t.length),r)}function MD(o,e,t,n,i,r,s,a){if(n===r||(i=i||RD(o,e,t[n],t[n+1]),s=s||RD(o,e,t[r],t[r+1]),Math.abs(i[0].top-s[0].top)<=.1))return;if(n+1===r){a.push(r);return}let l=n+(r-n)/2|0,d=RD(o,e,t[l],t[l+1]);MD(o,e,t,n,i,l,d,a),MD(o,e,t,l,d,r,s,a)}function RD(o,e,t,n){return o.setStart(e[t/16384|0].firstChild,t%16384),o.setEnd(e[n/16384|0].firstChild,n%16384),o.getClientRects()}var a_=class extends W{_editor=null;_instantiationService=null;_instances=this._register(new Yo);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,n){this._editor=e,this._instantiationService=n;for(let i of t){if(this._pending.has(i.id)){Ue(new Error(`Cannot have two contributions with the same id ${i.id}`));continue}this._pending.set(i.id,i)}this._instantiateSome(0),this._register(mf(fe(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(mf(fe(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(mf(fe(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let e={};for(let[t,n]of this._instances)typeof n.saveViewState=="function"&&(e[t]=n.saveViewState());return e}restoreViewState(e){for(let[t,n]of this._instances)typeof n.restoreViewState=="function"&&n.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}set(e,t){this._instances.set(e,t)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return mf(fe(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;let t=this._findPendingContributionsByInstantiation(e);for(let n of t)this._instantiateById(n.id)}_findPendingContributionsByInstantiation(e){let t=[];for(let[,n]of this._pending)n.instantiation===e&&t.push(n);return t}_instantiateById(e){let t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let n=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,n),typeof n.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(n){Ue(n)}}}};var l_=class{constructor(e,t,n,i,r,s,a){this.id=e;this.label=t;this.alias=n;this.metadata=i;this._precondition=r;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}};var d_=class o{static create(e){return new o(e.get(136),e.get(135))}classifier;constructor(e,t){this.classifier=new PD(e,t)}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[],l=[];return{addRequest:(d,c,u)=>{s.push(d),a.push(c),l.push(u)},finalize:()=>{let d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,c=[];for(let u=0,p=s.length;u<p;u++){let m=a[u],g=l[u];g&&!g.injectionOptions&&!m?c[u]=J7(this.classifier,g,s[u],t,n,d,i,r):c[u]=e9(this.classifier,s[u],m,t,n,d,i,r)}return AD.length=0,ND.length=0,c}}}};var PD=class extends uc{constructor(e,t){super(0);for(let n=0;n<e.length;n++)this.set(e.charCodeAt(n),1);for(let n=0;n<t.length;n++)this.set(t.charCodeAt(n),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}},AD=[],ND=[];function J7(o,e,t,n,i,r,s,a){if(i===-1)return null;let l=t.length;if(l<=1)return null;let d=a==="keepAll",c=e.breakOffsets,u=e.breakOffsetsVisibleColumn,p=GB(t,n,i,r,s),m=i-p,g=AD,f=ND,b=0,v=0,I=0,C=i,S=c.length,E=0;if(E>=0){let M=Math.abs(u[E]-C);for(;E+1<S;){let A=Math.abs(u[E+1]-C);if(A>=M)break;M=A,E++}}for(;E<S;){let M=E<0?0:c[E],A=E<0?0:u[E];v>M&&(M=v,A=I);let F=0,O=0,H=0,U=0;if(A<=C){let re=A,ve=M===0?0:t.charCodeAt(M-1),ee=M===0?0:o.get(ve),Q=!0;for(let ae=M;ae<l;ae++){let ne=ae,Z=t.charCodeAt(ae),Ce,xe;if(Ot(Z)?(ae++,Ce=0,xe=2):(Ce=o.get(Z),xe=cb(Z,re,n,r)),ne>v&&OD(ve,ee,Z,Ce,d)&&(F=ne,O=re),re+=xe,re>C){ne>v?(H=ne,U=re-xe):(H=ae+1,U=re),re-O>m&&(F=0),Q=!1;break}ve=Z,ee=Ce}if(Q){b>0&&(g[b]=c[c.length-1],f[b]=u[c.length-1],b++);break}}if(F===0){let re=A,ve=t.charCodeAt(M),ee=o.get(ve),Q=!1;for(let ae=M-1;ae>=v;ae--){let ne=ae+1,Z=t.charCodeAt(ae);if(Z===9){Q=!0;break}let Ce,xe;if(As(Z)?(ae--,Ce=0,xe=2):(Ce=o.get(Z),xe=Xo(Z)?r:1),re<=C){if(H===0&&(H=ne,U=re),re<=C-m)break;if(OD(Z,Ce,ve,ee,d)){F=ne,O=re;break}}re-=xe,ve=Z,ee=Ce}if(F!==0){let ae=m-(U-O);if(ae<=n){let ne=t.charCodeAt(H),Z;Ot(ne)?Z=2:Z=cb(ne,U,n,r),ae-Z<0&&(F=0)}}if(Q){E--;continue}}if(F===0&&(F=H,O=U),F<=v){let re=t.charCodeAt(v);Ot(re)?(F=v+2,O=I+2):(F=v+1,O=I+cb(re,I,n,r))}for(v=F,g[b]=F,I=O,f[b]=O,b++,C=O+m;E<0||E<S&&u[E]<O;)E++;let z=Math.abs(u[E]-C);for(;E+1<S;){let re=Math.abs(u[E+1]-C);if(re>=z)break;z=re,E++}}return b===0?null:(g.length=b,f.length=b,AD=e.breakOffsets,ND=e.breakOffsetsVisibleColumn,e.breakOffsets=g,e.breakOffsetsVisibleColumn=f,e.wrappedTextIndentLength=p,e)}function e9(o,e,t,n,i,r,s,a){let l=po.applyInjectedText(e,t),d,c;if(t&&t.length>0?(d=t.map(O=>O.options),c=t.map(O=>O.column-1)):(d=null,c=null),i===-1)return d?new ol(c,d,[l.length],[],0):null;let u=l.length;if(u<=1)return d?new ol(c,d,[l.length],[],0):null;let p=a==="keepAll",m=GB(l,n,i,r,s),g=i-m,f=[],b=[],v=0,I=0,C=0,S=i,E=l.charCodeAt(0),M=o.get(E),A=cb(E,0,n,r),F=1;Ot(E)&&(A+=1,E=l.charCodeAt(1),M=o.get(E),F++);for(let O=F;O<u;O++){let H=O,U=l.charCodeAt(O),z,re;Ot(U)?(O++,z=0,re=2):(z=o.get(U),re=cb(U,A,n,r)),OD(E,M,U,z,p)&&(I=H,C=A),A+=re,A>S&&((I===0||A-C>g)&&(I=H,C=A-re),f[v]=I,b[v]=C,v++,S=C+g,I=0),E=U,M=z}return v===0&&(!t||t.length===0)?null:(f[v]=u,b[v]=A,new ol(c,d,f,b,m))}function cb(o,e,t,n){return o===9?t-e%t:Xo(o)||o<32?n:1}function KB(o,e){return e-o%e}function OD(o,e,t,n,i){return t!==32&&(e===2&&n!==2||e!==1&&n===1||!i&&e===3&&n!==2||!i&&n===3&&e!==1)}function GB(o,e,t,n,i){let r=0;if(i!==0){let s=$t(o);if(s!==-1){for(let l=0;l<s;l++){let d=o.charCodeAt(l)===9?KB(r,e):1;r+=d}let a=i===3?2:i===2?1:0;for(let l=0;l<a;l++){let d=KB(r,e);r+=d}r+n>t&&(r=0)}}return r}var ub=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(e,t,n,i){this.model=e,this.viewModel=t,this.coordinatesConverter=n,this.cursorConfig=i}};var pb=class o{modelState;viewState;_selTrackedRange;_trackSelection;constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new bn(new w(1,1,1,1),0,0,new R(1,1),0),new bn(new w(1,1,1,1),0,0,new R(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new ze(this.modelState,this.viewState)}readSelectionFromMarkers(e){let t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?De.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):De.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}static _validatePositionWithCache(e,t,n,i){return t.equals(n)?i:e.normalizePosition(t,2)}static _validateViewState(e,t){let n=t.position,i=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),s=e.normalizePosition(n,2),a=this._validatePositionWithCache(e,i,n,s),l=this._validatePositionWithCache(e,r,i,a);return n.equals(s)&&i.equals(a)&&r.equals(l)?t:new bn(w.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+i.column-a.column,s,t.leftoverVisibleColumns+n.column-s.column)}_setState(e,t,n){if(n&&(n=o._validateViewState(e.viewModel,n)),t){let i=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(i)?t.selectionStartLeftoverVisibleColumns:0,s=e.model.validatePosition(t.position),a=t.position.equals(s)?t.leftoverVisibleColumns:0;t=new bn(i,t.selectionStartKind,r,s,a)}else{if(!n)return;let i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new bn(i,n.selectionStartKind,n.selectionStartLeftoverVisibleColumns,r,n.leftoverVisibleColumns)}if(n){let i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new bn(i,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{let i=e.coordinatesConverter.convertModelPositionToViewPosition(new R(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new R(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),s=new w(i.lineNumber,i.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new bn(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}};var hb=class{context;cursors;lastAddedCursorIndex;constructor(e){this.context=e,this.cursors=[new pb(e)],this.lastAddedCursorIndex=0}dispose(){for(let e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(let e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(let e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(let e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return MR(this.cursors,Nr(e=>e.viewState.position,R.compare)).viewState.position}getBottomMostViewPosition(){return RR(this.cursors,Nr(e=>e.viewState.position,R.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(ze.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){let t=this.cursors.length-1,n=e.length;if(t<n){let i=n-t;for(let r=0;r<i;r++)this._addSecondaryCursor()}else if(t>n){let i=t-n;for(let r=0;r<i;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<n;i++)this.cursors[i+1].setState(this.context,e[i].modelState,e[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new pb(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;let e=this.cursors.slice(0),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort(Nr(n=>n.selection,w.compareRangesUsingStarts));for(let n=0;n<t.length-1;n++){let i=t[n],r=t[n+1],s=i.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=i.index<r.index?n:n+1,c=i.index<r.index?n+1:n,u=t[c].index,p=t[d].index,m=t[c].selection,g=t[d].selection;if(!m.equalsSelection(g)){let f=m.plusRange(g),b=m.selectionStartLineNumber===m.startLineNumber&&m.selectionStartColumn===m.startColumn,v=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn,I;u===this.lastAddedCursorIndex?(I=b,this.lastAddedCursorIndex=p):I=v;let C;I?C=new De(f.startLineNumber,f.startColumn,f.endLineNumber,f.endColumn):C=new De(f.endLineNumber,f.endColumn,f.startLineNumber,f.startColumn),t[d].selection=C;let S=ze.fromModelSelection(C);e[p].setState(this.context,S.modelState,S.viewState)}for(let f of t)f.index>u&&f.index--;e.splice(u,1),t.splice(c,1),this._removeSecondaryCursor(u-1),n--}}}};var c_=class extends W{_onEvent=this._register(new L);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,n=this._outgoingEvents.length;t<n;t++){let i=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(i){this._outgoingEvents[t]=i;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,n=this._eventHandlers.length;t<n;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new FD),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(let n of e)this._addOutgoingEvent(n);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let e=this._viewEventQueue;this._viewEventQueue=null;let t=this._eventHandlers.slice(0);for(let n of t)n.handleEvents(e)}}},FD=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}};var u_=class o{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(e,t,n,i){this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=n,this.contentHeight=i,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}},p_=class o{kind=1;oldHasFocus;hasFocus;constructor(e,t){this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldHasFocus,e.hasFocus)}},h_=class o{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e,t,n,i,r,s,a,l){this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=n,this._oldScrollTop=i,this.scrollWidth=r,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}},m_=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},g_=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},f_=class o{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(e,t,n,i,r,s,a){this.oldSelections=e,this.selections=t,this.oldModelVersionId=n,this.modelVersionId=i,this.source=r,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return o._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}},b_=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},v_=class{constructor(e){this.event=e}kind=7;isNoOp(){return!1}attemptToMerge(e){return null}},y_=class{constructor(e){this.event=e}kind=8;isNoOp(){return!1}attemptToMerge(e){return null}},I_=class{constructor(e){this.event=e}kind=9;isNoOp(){return!1}attemptToMerge(e){return null}},C_=class{constructor(e){this.event=e}kind=10;isNoOp(){return!1}attemptToMerge(e){return null}},S_=class{constructor(e){this.event=e}kind=11;isNoOp(){return!1}attemptToMerge(e){return null}},x_=class{constructor(e){this.event=e}kind=12;isNoOp(){return!1}attemptToMerge(e){return null}};var __=class extends W{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new ub(this._model,this._viewModel,this._coordinatesConverter,i),this._cursors=new hb(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=xt(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new ub(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){let n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let r=!1,s=this.context.cursorConfig.multiCursorLimit;i!==null&&i.length>s&&(i=i.slice(0,s),r=!0);let a=mb.from(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,n,i,r,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=w.fromPositions(a[0],a[0]),e.emitViewEvent(new al(t,n,l,d,i,r,s))}revealPrimary(e,t,n,i,r,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new al(t,n,null,l,i,r,s))}saveState(){let e=[],t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){let r=t[n];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),n.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,ze.fromModelSelections(n)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof op){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let n=t.rawContentChangedEvent;if(this._knownModelVersionId=n.versionId,this._isHandling)return;let i=n.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new hb(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&n.resultingSelection&&n.resultingSelection.length>0){let r=ze.fromModelSelections(n.resultingSelection);this.setStates(e,"modelChange",n.isUndoing?5:n.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{let r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,ze.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t,n,i){this.setStates(e,t,i,ze.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let a=0,l=e.length;a<l;a++)n.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});let r=this._model.deltaDecorations([],n),s=this._model.deltaDecorations([],i);this._autoClosedActions.push(new w_(this._model,r,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();let t=BD.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let r=0;r<e.commands.length;r++){let s=e.commands[r];s instanceof mh&&s.enclosingRange&&s.closeCharacterRange&&(n.push(s.closeCharacterRange),i.push(s.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,r){let s=mb.from(this._model,this);if(s.equals(i))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new IC(l,a,n)),!i||i.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(i.cursorState[c].modelState))){let d=i?i.cursorState.map(u=>u.modelState.selection):null,c=i?i.modelVersionId:0;e.emitOutgoingEvent(new f_(d,a,c,s.modelVersionId,t||"keyboard",n,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];if(!r.text||r.text.indexOf(`
`)>=0)return null;let s=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=r.text.length-s[2].length-1,u=r.text.lastIndexOf(d,c-1);if(u===-1)return null;t.push([u,c])}return t}executeEdits(e,t,n,i){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(n)),r&&(n[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),n,d=>{if(r)for(let u=0,p=r.length;u<p;u++){let[m,g]=r[u],f=d[u],b=f.range.startLineNumber,v=f.range.startColumn-1+m,I=f.range.startColumn-1+g;s.push(new w(b,I+1,b,I+2)),a.push(new w(b,v+1,b,I+2))}let c=i(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(e,t,n,i=0){if(this.context.cursorConfig.readOnly)return;let r=mb.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(s){Ue(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,i,r,!1)&&this.revealAll(t,n,!1,0,!0,0)}getAutoClosedCharacters(){return w_.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new VD(this._model,this.getSelections())}endComposition(e,t){let n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(hs.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,n){this._executeEdit(()=>{if(n==="keyboard"){let i=t.length,r=0;for(;r<i;){let s=Nm(t,r),a=t.substr(r,s);this._executeEditOperation(hs.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),r+=s}}else this._executeEditOperation(hs.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,n)}compositionType(e,t,n,i,r,s){if(t.length===0&&n===0&&i===0){if(r!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new De(d.lineNumber,d.column+r,d.lineNumber,d.column+r)});this.setSelections(e,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(hs.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,r))},e,s)}paste(e,t,n,i,r){this._executeEdit(()=>{this._executeEditOperation(hs.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(ll.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,n){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new Rn(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}executeCommands(e,t,n){this._executeEdit(()=>{this._executeEditOperation(new Rn(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}},mb=class o{constructor(e,t){this.modelVersionId=e;this.cursorState=t}static from(e,t){return new o(e.getVersionId(),t.getCursorStates())}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}},w_=class{static getAllAutoClosedCharacters(e){let t=[];for(let n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){let n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let n=0;n<this._autoClosedEnclosingDecorations.length;n++){let i=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[n]);if(i&&(t.push(i),i.startLineNumber!==i.endLineNumber))return!1}t.sort(w.compareRangesUsingStarts),e.sort(w.compareRangesUsingStarts);for(let n=0;n<e.length;n++)if(n>=t.length||!t[n].strictContainsRange(e[n]))return!1;return!0}},BD=class{static executeCommands(e,t,n){let i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(i,n);for(let s=0,a=i.trackedRanges.length;s<a;s++)i.model._setTrackedRange(i.trackedRanges[s],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;let n=this._getEditOperations(e,t);if(n.operations.length===0)return null;let i=n.operations,r=this._getLoserCursorMap(i);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=i.length;d<c;d++)r.hasOwnProperty(i[d].identifier.major.toString())||s.push(i[d]);n.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,s,d=>{let c=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m]=[];for(let m of d)m.identifier&&c[m.identifier.major].push(m);let u=(m,g)=>m.identifier.minor-g.identifier.minor,p=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m].length>0?(c[m].sort(u),p[m]=t[m].computeCursorState(e.model,{getInverseEditOperations:()=>c[m],getTrackedSelection:g=>{let f=parseInt(g,10),b=e.model._getTrackedRange(e.trackedRanges[f]);return e.trackedRangesDirection[f]===0?new De(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):new De(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn)}})):p[m]=e.selectionsBefore[m];return p});a||(a=e.selectionsBefore);let l=[];for(let d in r)r.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(a){let l=this._getEditOperationsFromCommand(e,r,a);n=n.concat(l.operations),i=i||l.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let i=[],r=0,s=(u,p,m=!1)=>{w.isEmpty(u)&&p===""||i.push({identifier:{major:t,minor:r++},range:u,text:p,forceMoveMarkers:m,isAutoWhitespaceEdit:n.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(u,p,m)=>{a=!0,s(u,p,m)},trackSelection:(u,p)=>{let m=De.liftSelection(u),g;if(m.isEmpty())if(typeof p=="boolean")p?g=2:g=3;else{let v=e.model.getLineMaxColumn(m.startLineNumber);m.startColumn===v?g=2:g=3}else g=1;let f=e.trackedRanges.length,b=e.model._setTrackedRange(null,m,g);return e.trackedRanges[f]=b,e.trackedRangesDirection[f]=m.getDirection(),f.toString()}};try{n.getEditOperations(e.model,c)}catch(u){return Ue(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:i,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((n,i)=>-w.compareRangesUsingEnds(n.range,i.range));let t={};for(let n=1;n<e.length;n++){let i=e[n-1],r=e[n];if(w.getStartPosition(i.range).isBefore(w.getEndPosition(r.range))){let s;i.identifier.major>r.identifier.major?s=i.identifier.major:s=r.identifier.major,t[s.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===s&&(e.splice(a,1),a<n&&n--,a--);n>0&&n--}}return t}},WD=class{constructor(e,t,n){this.text=e;this.startSelection=t;this.endSelection=n}},VD=class o{_original;static _capture(e,t){let n=[];for(let i of t){if(i.startLineNumber!==i.endLineNumber)return null;n.push(new WD(e.getLineContent(i.startLineNumber),i.startColumn-1,i.endColumn-1))}return n}constructor(e,t){this._original=o._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;let n=o._capture(e,t);if(!n||this._original.length!==n.length)return null;let i=[];for(let r=0,s=this._original.length;r<s;r++)i.push(o._deduceOutcome(this._original[r],n[r]));return i}static _deduceOutcome(e,t){let n=Math.min(e.startSelection,t.startSelection,Br(e.text,t.text)),i=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,Am(e.text,t.text)),r=e.text.substring(n,e.text.length-i),s=t.text.substring(n,t.text.length-i);return new nS(r,e.startSelection-n,e.endSelection-n,s,t.startSelection-n,t.endSelection-n)}};var $B={getInitialState:()=>i1,tokenizeEncoded:(o,e,t)=>II(0,t)};async function qB(o,e,t){if(!t)return jB(e,o.languageIdCodec,$B);let n=await uo.getOrCreate(t);return jB(e,o.languageIdCodec,n||$B)}function YB(o,e,t,n,i,r,s){let a="<div>",l=n,d=0,c=!0;for(let u=0,p=e.getCount();u<p;u++){let m=e.getEndOffset(u);if(m<=n)continue;let g="";for(;l<m&&l<i;l++){let f=o.charCodeAt(l);switch(f){case 9:{let b=r-(l+d)%r;for(d+=b-1;b>0;)s&&c?(g+="&#160;",c=!1):(g+=" ",c=!0),b--;break}case 60:g+="&lt;",c=!1;break;case 62:g+="&gt;",c=!1;break;case 38:g+="&amp;",c=!1;break;case 0:g+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:g+="\uFFFD",c=!1;break;case 13:g+="&#8203",c=!1;break;case 32:s&&c?(g+="&#160;",c=!1):(g+=" ",c=!0);break;default:g+=String.fromCharCode(f),c=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${g}</span>`,m>i||l>=i)break}return a+="</div>",a}function jB(o,e,t){let n='<div class="monaco-tokenized-source">',i=Fr(o),r=t.getInitialState();for(let s=0,a=i.length;s<a;s++){let l=i[s];s>0&&(n+="<br/>");let d=t.tokenizeEncoded(l,!0,r);qt.convertToEndOffset(d.tokens,l.length);let u=new qt(d.tokens,l,e).inflate(),p=0;for(let m=0,g=u.getCount();m<g;m++){let f=u.getClassName(m),b=u.getEndOffset(m);n+=`<span class="${f}">${Yd(l.substring(p,b))}</span>`,p=b}r=d.endState}return n+="</div>",n}var HD=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;let t=this._inserts,n=this._changes,i=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,n,i)}},UD=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(e,t,n,i,r){this.id=e,this.afterLineNumber=t,this.ordinal=n,this.height=i,this.minWidth=r,this.prefixSum=0}},E_=class o{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(e,t,n,i){this._instanceId=fv(++o.INSTANCE_COUNT),this._pendingChanges=new HD,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=n,this._paddingBottom=i}static findInsertionIndex(e,t,n){let i=0,r=e.length;for(;i<r;){let s=i+r>>>1;t===e[s].afterLineNumber?n<e[s].ordinal?r=s:i=s+1:t<e[s].afterLineNumber?r=s:i=s+1}return i}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(i,r,s,a)=>{t=!0,i=i|0,r=r|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new UD(l,i,r,s,a)),l},changeOneWhitespace:(i,r,s)=>{t=!0,r=r|0,s=s|0,this._pendingChanges.change({id:i,newAfterLineNumber:r,newHeight:s})},removeWhitespace:i=>{t=!0,this._pendingChanges.remove({id:i})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,n){if((e.length>0||n.length>0)&&(this._minWidth=-1),e.length+t.length+n.length<=1){for(let l of e)this._insertWhitespace(l);for(let l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of n){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let i=new Set;for(let l of n)i.add(l.id);let r=new Map;for(let l of t)r.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!i.has(c.id)){if(r.has(c.id)){let u=r.get(c.id);c.afterLineNumber=u.newAfterLineNumber,c.height=u.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(e));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){let t=o.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){let t=this._arr;for(let n=0,i=t.length;n<i;n++)if(t[n].id===e)return n;return-1}_changeOneWhitespace(e,t,n){let i=this._findWhitespaceIndex(e);if(i!==-1&&(this._arr[i].height!==n&&(this._arr[i].height=n,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,i-1)),this._arr[i].afterLineNumber!==t)){let r=this._arr[i];this._removeWhitespace(i),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&r<=t?this._arr[n].afterLineNumber=e-1:r>t&&(this._arr[n].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&(this._arr[n].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let n=t;n<=e;n++)this._arr[n].prefixSum=this._arr[n-1].prefixSum+this._arr[n].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;let t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;let t=this._arr,n=0,i=t.length-1;for(;n<=i;){let s=(i-n|0)/2|0,a=n+s|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;n=a+1|0}else i=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;let n=this._findLastWhitespaceBeforeLineNumber(e)+1;return n<this._arr.length?n:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n;e>1?n=this._lineHeight*(e-1):n=0;let i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return n+i+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n=this._lineHeight*e,i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return n+i+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,n=this._arr.length;t<n;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;let t=this._lineCount|0,n=this._lineHeight,i=1,r=t;for(;i<r;){let s=(i+r)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(e>=a+n)i=s+1;else{if(e>=a)return s;r=s}}return i>t?t:i}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this._lineHeight,i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,r=this.getVerticalOffsetForLineNumber(i)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(i)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let u=r,p=u,m=5e5,g=0;r>=m&&(g=Math.floor(r/m)*m,g=Math.floor(g/n)*n,p-=g);let f=[],b=e+(t-e)/2,v=-1;for(let E=i;E<=s;E++){if(v===-1){let M=u,A=u+n;(M<=b&&b<A||M>b)&&(v=E)}for(u+=n,f[E-i]=p,p+=n;c===E;)p+=d,u+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){s=E;break}}v===-1&&(v=s);let I=this.getVerticalOffsetForLineNumber(s)|0,C=i,S=s;return C<S&&r<e&&C++,C<S&&I+n>t&&S--,{bigNumbersDelta:g,startLineNumber:i,endLineNumber:s,relativeVerticalOffset:f,centeredLineNumber:v,completelyVisibleStartLineNumber:C,completelyVisibleEndLineNumber:S,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;let t=this.getAfterLineNumberForWhitespaceIndex(e),n;t>=1?n=this._lineHeight*t:n=0;let i;return e>0?i=this.getWhitespacesAccumulatedHeight(e-1):i=0,n+i+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,n=this.getWhitespacesCount()-1;if(n<0)return-1;let i=this.getVerticalOffsetForWhitespaceIndex(n),r=this.getHeightForWhitespaceIndex(n);if(e>=i+r)return-1;for(;t<n;){let s=Math.floor((t+n)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(e>=a+l)t=s+1;else{if(e>=a)return s;n=s}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;let n=this.getVerticalOffsetForWhitespaceIndex(t);if(n>e)return null;let i=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),s=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:s,verticalOffset:n,height:i}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),i=this.getWhitespacesCount()-1;if(n<0)return[];let r=[];for(let s=n;s<=i;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};var n9=125,uu=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(e,t,n,i){e=e|0,t=t|0,n=n|0,i=i|0,e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),i<0&&(i=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=n,this.contentHeight=i,this.scrollHeight=Math.max(n,i)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}},zD=class extends W{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new L);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(e,t){super(),this._dimensions=new uu(0,0,0,0),this._scrollable=this._register(new Wa({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;let t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);let n=t.contentWidth!==e.contentWidth,i=t.contentHeight!==e.contentHeight;(n||i)&&this._onDidContentSizeChange.fire(new u_(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},T_=class extends W{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(e,t,n){super(),this._configuration=e;let i=this._configuration.options,r=i.get(147),s=i.get(85);this._linesLayout=new E_(t,i.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new zD(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new uu(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?n9:0)}onConfigurationChanged(e){let t=this._configuration.options;if(e.hasChanged(68)&&this._linesLayout.setLineHeight(t.get(68)),e.hasChanged(85)){let n=t.get(85);this._linesLayout.setPadding(n.top,n.bottom)}if(e.hasChanged(147)){let n=t.get(147),i=n.contentWidth,r=n.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new uu(i,s.contentWidth,r,this._getContentHeight(i,r,a)))}else this._updateHeight();e.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){let i=this._configuration.options.get(105);return i.horizontal===2||e>=t?0:i.horizontalScrollbarSize}_getContentHeight(e,t,n){let i=this._configuration.options,r=this._linesLayout.getLinesTotalHeight();return i.get(107)?r+=Math.max(0,t-i.get(68)-i.get(85).bottom):i.get(105).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,n)),r}_updateHeight(){let e=this._scrollable.getScrollDimensions(),t=e.width,n=e.height,i=e.contentWidth;this._scrollable.setScrollDimensions(new uu(t,e.contentWidth,n,this._getContentHeight(t,n,i)))}getCurrentViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new yf(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new yf(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){let e=this._configuration.options,t=this._maxLineWidth,n=e.get(148),i=e.get(51),r=e.get(147);if(n.isViewportWrapping){let s=e.get(74);return t>r.contentWidth+i.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?t+r.verticalScrollbarWidth:t}else{let s=e.get(106)*i.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+s+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){let e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new uu(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){let e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,n=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),i=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(n);return{scrollTop:t,scrollTopWithoutViewZones:t-i,scrollLeft:e.scrollLeft}}changeWhitespace(e){let t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){let t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){let n=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:n.scrollLeft+e,scrollTop:n.scrollTop+t})}};function D_(o,e){return o===null?e?L_.INSTANCE:k_.INSTANCE:new GD(o,e)}var GD=class{_projectionData;_isVisible;constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,n){this._assertVisible();let i=n>0?this._projectionData.breakOffsets[n-1]:0,r=this._projectionData.breakOffsets[n],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new po(0,0,d+1,this._projectionData.injectionOptions[c],0));s=po.applyInjectedText(e.getLineContent(t),a).substring(i,r)}else s=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:r+1});return n>0&&(s=QB(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(e,t,n){return this._assertVisible(),this._projectionData.getLineLength(n)}getViewLineMinColumn(e,t,n){return this._assertVisible(),this._projectionData.getMinOutputOffset(n)+1}getViewLineMaxColumn(e,t,n){return this._assertVisible(),this._projectionData.getMaxOutputOffset(n)+1}getViewLineData(e,t,n){let i=new Array;return this.getViewLinesData(e,t,n,1,0,[!0],i),i[0]}getViewLinesData(e,t,n,i,r,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,u=null;if(d){u=[];let m=0,g=0;for(let f=0;f<l.getOutputLineCount();f++){let b=new Array;u[f]=b;let v=f>0?l.breakOffsets[f-1]:0,I=l.breakOffsets[f];for(;g<d.length;){let C=c[g].content.length,S=d[g]+m,E=S+C;if(S>I)break;if(v<E){let M=c[g];if(M.inlineClassName){let A=f>0?l.wrappedTextIndentLength:0,F=A+Math.max(S-v,0),O=A+Math.min(E-v,I-v);F!==O&&b.push(new DC(F,O,M.inlineClassName,M.inlineClassNameAffectsLetterSpacing))}}if(E<=I)m+=C,g++;else break}}}let p;if(d){let m=[];for(let g=0;g<d.length;g++){let f=d[g],b=c[g].tokens;b?b.forEach((v,I)=>{m.push({offset:f,text:v.substring(c[g].content),tokenMetadata:I.metadata})}):m.push({offset:f,text:c[g].content,tokenMetadata:qt.defaultTokenMetadata})}p=e.tokenization.getLineTokens(t).withInserted(m)}else p=e.tokenization.getLineTokens(t);for(let m=n;m<n+i;m++){let g=r+m-n;if(!s[g]){a[g]=null;continue}a[g]=this._getViewLineData(p,u?u[m]:null,m)}}_getViewLineData(e,t,n){this._assertVisible();let i=this._projectionData,r=n>0?i.wrappedTextIndentLength:0,s=n>0?i.breakOffsets[n-1]:0,a=i.breakOffsets[n],l=e.sliceAndInflate(s,a,r),d=l.getLineContent();n>0&&(d=QB(i.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(n)+1,u=d.length+1,p=n+1<this.getViewLineCount(),m=n===0?0:i.breakOffsetsVisibleColumn[n-1];return new Vc(d,p,c,u,m,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,n=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,n).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();let n=this._projectionData.translateToOutputPosition(t-1);return e+n.outputLineIndex}normalizePosition(e,t,n){let i=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,n).toPosition(i)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},L_=class o{static INSTANCE=new o;constructor(){}isVisible(){return!0}setVisible(e){return e?this:k_.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,n){return e.getLineContent(t)}getViewLineLength(e,t,n){return e.getLineLength(t)}getViewLineMinColumn(e,t,n){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,n){return e.getLineMaxColumn(t)}getViewLineData(e,t,n){let i=e.tokenization.getLineTokens(t),r=i.getLineContent();return new Vc(r,!1,1,r.length+1,0,i.inflate(),null)}getViewLinesData(e,t,n,i,r,s,a){if(!s[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new R(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,n){return t}getInjectedTextAt(e,t){return null}},k_=class o{static INSTANCE=new o;constructor(){}isVisible(){return!1}setVisible(e){return e?L_.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,n){throw new Error("Not supported")}getViewLineLength(e,t,n){throw new Error("Not supported")}getViewLineMinColumn(e,t,n){throw new Error("Not supported")}getViewLineMaxColumn(e,t,n){throw new Error("Not supported")}getViewLineData(e,t,n){throw new Error("Not supported")}getViewLinesData(e,t,n,i,r,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,n){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}},KD=[""];function QB(o){if(o>=KD.length)for(let e=1;e<=o;e++)KD[e]=i9(e);return KD[o]}function i9(o){return new Array(o+1).join(" ")}var R_=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();let t=this._indexBySum[e],n=t>0?this._prefixSum[t-1]:0;return new $D(t,e-n)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=Ls(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){let n=this._values[e],i=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=i+n;for(let r=0;r<n;r++)this._indexBySum[i+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}},$D=class{constructor(e,t){this.index=e;this.remainder=t;this.index=e,this.remainder=t}_prefixSumIndexOfResultBrand=void 0};var M_=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(e,t,n,i,r,s,a,l,d,c){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=n,this._monospaceLineBreaksComputerFactory=i,this.fontInfo=r,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new jD(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let n=this.model.getLinesContent(),i=this.model.getInjectedTextDecorations(this._editorId),r=n.length,s=this.createLineBreaksComputer(),a=new no(po.fromDecorations(i));for(let f=0;f<r;f++){let b=a.takeWhile(v=>v.lineNumber===f+1);s.addRequest(n[f],b,t?t[f]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(f=>this.model.getDecorationRange(f)).sort(w.compareRangesUsingStarts),u=1,p=0,m=-1,g=m+1<c.length?p+1:r+2;for(let f=0;f<r;f++){let b=f+1;b===g&&(m++,u=c[m].startLineNumber,p=c[m].endLineNumber,g=m+1<c.length?p+1:r+2);let v=b>=u&&b<=p,I=D_(l[f],!v);d[f]=I.getViewLineCount(),this.modelLineProjections[f]=I}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new R_(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){let t=e.map(p=>this.model.validateRange(p)),n=o9(t),i=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(w.compareRangesUsingStarts);if(n.length===i.length){let p=!1;for(let m=0;m<n.length;m++)if(!n[m].equalsRange(i[m])){p=!0;break}if(!p)return!1}let r=n.map(p=>({range:p,options:Ln.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);let s=n,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,u=!1;for(let p=0;p<this.modelLineProjections.length;p++){let m=p+1;m===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let g=!1;if(m>=a&&m<=l?this.modelLineProjections[p].isVisible()&&(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!1),g=!0):(u=!0,this.modelLineProjections[p].isVisible()||(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!0),g=!0)),g){let f=this.modelLineProjections[p].getViewLineCount();this.projectedModelLineLineCounts.setValue(p,f)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,n,i,r){let s=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===n,d=this.wrappingIndent===i,c=this.wordBreak===r;if(s&&a&&l&&d&&c)return!1;let u=s&&a&&!l&&d&&c;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=n,this.wrappingIndent=i,this.wordBreak=r;let p=null;if(u){p=[];for(let m=0,g=this.modelLineProjections.length;m<g;m++)p[m]=this.modelLineProjections[m].getProjectionData()}return this._constructLines(!1,p),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,n){if(!e||e<=this._validModelVersionId)return null;let i=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections.splice(t-1,n-t+1),this.projectedModelLineLineCounts.removeValues(t-1,n-t+1),new sh(i,r)}onModelLinesInserted(e,t,n,i){if(!e||e<=this._validModelVersionId)return null;let r=t>2&&!this.modelLineProjections[t-2].isVisible(),s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,a=0,l=[],d=[];for(let c=0,u=i.length;c<u;c++){let p=D_(i[c],!r);l.push(p);let m=p.getViewLineCount();a+=m,d[c]=m}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,d),new ah(s,s+a-1)}onModelLineChanged(e,t,n){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let i=t-1,r=this.modelLineProjections[i].getViewLineCount(),s=this.modelLineProjections[i].isVisible(),a=D_(n,s);this.modelLineProjections[i]=a;let l=this.modelLineProjections[i].getViewLineCount(),d=!1,c=0,u=-1,p=0,m=-1,g=0,f=-1;r>l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1,g=u+1,f=g+(r-l)-1,d=!0):r<l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+r-1,p=u+1,m=p+(l-r)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1),this.projectedModelLineLineCounts.setValue(i,l);let b=c<=u?new vf(c,u-c+1):null,v=p<=m?new ah(p,m):null,I=g<=f?new sh(g,f):null;return[d,b,v,I]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;let t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),n=this._toValidViewLineNumber(n);let i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(n,this.getViewLineMinColumn(n)),a=this.model.guides.getActiveIndentGuide(i.lineNumber,r.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.projectedModelLineLineCounts.getIndexOf(e-1),n=t.index,i=t.remainder;return new P_(n+1,i)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new R(e.modelLineNumber,i)}getModelEndPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new R(e.modelLineNumber,i)}getViewLineInfosGroupedByModelRanges(e,t){let n=this.getViewLineInfo(e),i=this.getViewLineInfo(t),r=new Array,s=this.getModelStartPositionOfViewLine(n),a=new Array;for(let l=n.modelLineNumber;l<=i.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===n.modelLineNumber?n.modelLineWrappedLineIdx:0,u=l===i.modelLineNumber?i.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let p=c;p<u;p++)a.push(new P_(l,p))}if(!d.isVisible()&&s){let c=new R(l-1,this.model.getLineMaxColumn(l-1)+1),u=w.fromPositions(s,c);r.push(new A_(u,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new R(l,1))}if(s){let l=w.fromPositions(s,this.getModelEndPositionOfViewLine(i));r.push(new A_(l,a))}return r}getViewLinesBracketGuides(e,t,n,i){let r=n?this.convertViewPositionToModelPosition(n.lineNumber,n.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(e,t)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,i);for(let c of a.viewLines){let p=d[c.modelLineNumber-l].map(m=>{if(m.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||m.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!m.horizontalLine)return m;let g=-1;if(m.column!==-1){let v=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.column);if(v.lineNumber===c.modelLineWrappedLineIdx)g=v.column;else if(v.lineNumber<c.modelLineWrappedLineIdx)g=this.getMinColumnOfViewLine(c);else if(v.lineNumber>c.modelLineWrappedLineIdx)return}let f=this.convertModelPositionToViewPosition(c.modelLineNumber,m.horizontalLine.endColumn),b=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.horizontalLine.endColumn);return b.lineNumber===c.modelLineWrappedLineIdx?new Ir(m.visibleColumn,g,m.className,new Ka(m.horizontalLine.top,f.column),-1,-1):b.lineNumber<c.modelLineWrappedLineIdx||m.visibleColumn!==-1?void 0:new Ir(m.visibleColumn,g,m.className,new Ka(m.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(p.filter(m=>!!m))}}return s}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),i=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t)),r=[],s=[],a=[],l=n.lineNumber-1,d=i.lineNumber-1,c=null;for(let g=l;g<=d;g++){let f=this.modelLineProjections[g];if(f.isVisible()){let b=f.getViewLineNumberOfModelPosition(0,g===l?n.column:1),v=f.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),I=v-b+1,C=0;I>1&&f.getViewLineMinColumn(this.model,g+1,v)===1&&(C=b===0?1:2),s.push(I),a.push(C),c===null&&(c=new R(g+1,0))}else c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,g)),c=null)}c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,i.lineNumber)),c=null);let u=t-e+1,p=new Array(u),m=0;for(let g=0,f=r.length;g<f;g++){let b=r[g],v=Math.min(u-m,s[g]),I=a[g],C;I===2?C=0:I===1?C=1:C=v;for(let S=0;S<v;S++)S===C&&(b=0),p[m++]=b}return p}getViewLineContent(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=e,s=i.index,a=i.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let u=this.modelLineProjections[d];if(!u.isVisible())continue;let p=d===s?a:0,m=u.getViewLineCount()-p,g=!1;if(r+m>t&&(g=!0,m=t-r+1),u.getViewLinesData(this.model,d+1,p,m,r-e,n,l),r+=m,g)break}return l}validateViewPosition(e,t,n){e=this._toValidViewLineNumber(e);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=i.index,s=i.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,s),d=a.getViewLineMaxColumn(this.model,r+1,s);t<l&&(t=l),t>d&&(t=d);let c=a.getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new R(r+1,c)).equals(n)?new R(e,t):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}validateViewRange(e,t){let n=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),i=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new w(n.lineNumber,n.column,i.lineNumber,i.column)}convertViewPositionToModelPosition(e,t){let n=this.getViewLineInfo(e),i=this.modelLineProjections[n.modelLineNumber-1].getModelColumnOfViewPosition(n.modelLineWrappedLineIdx,t);return this.model.validatePosition(new R(n.modelLineNumber,i))}convertViewRangeToModelRange(e){let t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new w(t.lineNumber,t.column,n.lineNumber,n.column)}convertModelPositionToViewPosition(e,t,n=2,i=!1,r=!1){let s=this.model.validatePosition(new R(e,t)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(r)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new R(i?0:1,1);let u=1+this.projectedModelLineLineCounts.getPrefixSum(d),p;return c?r?p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,1,n):p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(d+1),n):p=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,n),p}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return w.fromPositions(n)}else{let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),i=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new w(n.lineNumber,n.column,i.lineNumber,i.column)}}getViewLineNumberOfModelPosition(e,t){let n=e-1;if(this.modelLineProjections[n].isVisible()){let r=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(r,t)}for(;n>0&&!this.modelLineProjections[n].isVisible();)n--;if(n===0&&!this.modelLineProjections[n].isVisible())return 1;let i=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(i,this.model.getLineMaxColumn(n+1))}getDecorationsInRange(e,t,n,i,r){let s=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-s.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new w(s.lineNumber,1,a.lineNumber,a.column),t,n,i,r);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,u=null;for(let f=d;f<=c;f++)if(this.modelLineProjections[f].isVisible())u===null&&(u=new R(f+1,f===d?s.column:1));else if(u!==null){let v=this.model.getLineMaxColumn(f);l=l.concat(this.model.getDecorationsInRange(new w(u.lineNumber,u.column,f,v),t,n,i)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new w(u.lineNumber,u.column,a.lineNumber,a.column),t,n,i)),u=null),l.sort((f,b)=>{let v=w.compareRangesUsingStarts(f.range,b.range);return v===0?f.id<b.id?-1:f.id>b.id?1:0:v});let p=[],m=0,g=null;for(let f of l){let b=f.id;g!==b&&(g=b,p[m++]=f)}return p}getInjectedTextAt(e){let t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){let n=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[n.modelLineNumber-1].normalizePosition(n.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){let t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}};function o9(o){if(o.length===0)return[];let e=o.slice();e.sort(w.compareRangesUsingStarts);let t=[],n=e[0].startLineNumber,i=e[0].endLineNumber;for(let r=1,s=e.length;r<s;r++){let a=e[r];a.startLineNumber>i+1?(t.push(new w(n,1,i,1)),n=a.startLineNumber,i=a.endLineNumber):a.endLineNumber>i&&(i=a.endLineNumber)}return t.push(new w(n,1,i,1)),t}var P_=class{constructor(e,t){this.modelLineNumber=e;this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},A_=class{constructor(e,t){this.modelRange=e;this.viewLines=t}},jD=class{_lines;constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,n,i){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,n,i)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}};var N_=class{model;constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new qD(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,n,i){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,n,i)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,n){return new sh(t,n)}onModelLinesInserted(e,t,n,i){return new ah(t,n)}onModelLineChanged(e,t,n){return[!1,new vf(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,n){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,n){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){let n=t-e+1,i=new Array(n);for(let r=0;r<n;r++)i[r]=0;return i}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.tokenization.getLineTokens(e),n=t.getLineContent();return new Vc(n,!1,1,n.length+1,0,t.inflate(),null)}getViewLinesData(e,t,n){let i=this.model.getLineCount();e=Math.min(Math.max(1,e),i),t=Math.min(Math.max(1,t),i);let r=[];for(let s=e;s<=t;s++){let a=s-e;r[a]=n[a]?this.getViewLineData(s):null}return r}getDecorationsInRange(e,t,n,i,r){return this.model.getDecorationsInRange(e,t,n,i,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}},qD=class{_lines;constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){let t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}modelRangeIsVisible(e){let t=this._lines.model.getLineCount();return!(e.startLineNumber<1||e.startLineNumber>t||e.endLineNumber<1||e.endLineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}};var O_=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(e,t,n,i,r){this.editorId=e,this.model=t,this.configuration=n,this._linesCollection=i,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){let t=e.id,n=this._decorationsCache[t];if(!n){let i=e.range,r=e.options,s;if(r.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new R(i.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new R(i.endLineNumber,this.model.getLineMaxColumn(i.endLineNumber)),1);s=new w(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(i,1);n=new dh(s,r),this._decorationsCache[t]=n}return n}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,n=!1){let i=new w(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(i,t,n).inlineDecorations[0]}_getDecorationsInRange(e,t,n){let i=this._linesCollection.getDecorationsInRange(e,this.editorId,cc(this.configuration.options),t,n),r=e.startLineNumber,s=e.endLineNumber,a=[],l=0,d=[];for(let c=r;c<=s;c++)d[c-r]=[];for(let c=0,u=i.length;c<u;c++){let p=i[c],m=p.options;if(!r9(this.model,p))continue;let g=this._getOrCreateViewModelDecoration(p),f=g.range;if(a[l++]=g,m.inlineClassName){let b=new Hc(f,m.inlineClassName,m.inlineClassNameAffectsLetterSpacing?3:0),v=Math.max(r,f.startLineNumber),I=Math.min(s,f.endLineNumber);for(let C=v;C<=I;C++)d[C-r].push(b)}if(m.beforeContentClassName&&r<=f.startLineNumber&&f.startLineNumber<=s){let b=new Hc(new w(f.startLineNumber,f.startColumn,f.startLineNumber,f.startColumn),m.beforeContentClassName,1);d[f.startLineNumber-r].push(b)}if(m.afterContentClassName&&r<=f.endLineNumber&&f.endLineNumber<=s){let b=new Hc(new w(f.endLineNumber,f.endColumn,f.endLineNumber,f.endColumn),m.afterContentClassName,2);d[f.endLineNumber-r].push(b)}}return{decorations:a,inlineDecorations:d}}};function r9(o,e){return!(e.options.hideInCommentTokens&&s9(o,e)||e.options.hideInStringTokens&&a9(o,e))}function s9(o,e){return ZB(o,e.range,t=>t===1)}function a9(o,e){return ZB(o,e.range,t=>t===2)}function ZB(o,e,t){for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let i=o.tokenization.getLineTokens(n),r=n===e.startLineNumber,s=n===e.endLineNumber,a=r?i.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<i.getCount()&&!(s&&i.getStartOffset(a)>e.endColumn-1);){if(!t(i.getStandardTokenType(a)))return!1;a++}}return!0}var pu=3,F_=class{lanes;persist=0;_requiredLanes=1;constructor(e){this.lanes=new Uint8Array(Math.ceil((e+1)*pu/8))}reset(e){let t=Math.ceil((e+1)*pu/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,n){n&&(this.persist|=1<<e-1);for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let r=pu*i+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(i))}}getLanesAtLine(e){let t=[],n=pu*e;for(let i=0;i<pu;i++)(this.persist&1<<i||this.lanes[n>>>3]&1<<n%8)&&t.push(i+1),n++;return t.length?t:[2]}countAtLine(e){let t=pu*e,n=0;for(let i=0;i<pu;i++)(this.persist&1<<i||this.lanes[t>>>3]&1<<t%8)&&n++,t++;return n}};var l9=!0,B_=class extends W{constructor(t,n,i,r,s,a,l,d,c,u){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=u;if(this._editorId=t,this._configuration=n,this.model=i,this._eventDispatcher=new c_,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new sl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new zt(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=YD.create(this.model),this.glyphLanes=new F_(0),l9&&this.model.isTooLargeForTokenization())this._lines=new N_(this.model);else{let p=this._configuration.options,m=p.get(51),g=p.get(141),f=p.get(148),b=p.get(140),v=p.get(131);this._lines=new M_(this._editorId,this.model,r,s,m,this.model.getOptions().tabSize,g,f.wrappingColumn,b,v)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new __(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new T_(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(p=>{p.scrollTopChanged&&this._handleVisibleLinesChanged(),p.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new xC(p)),this._eventDispatcher.emitOutgoingEvent(new h_(p.oldScrollWidth,p.oldScrollLeft,p.oldScrollHeight,p.oldScrollTop,p.scrollWidth,p.scrollLeft,p.scrollHeight,p.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(p=>{this._eventDispatcher.emitOutgoingEvent(p)})),this._decorations=new O_(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(p=>{try{let m=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(m,p)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(jh.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new EC)})),this._register(this._themeService.onDidColorThemeChange(p=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new _C(p))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let t=this.viewLayout.getLinesViewportData(),n=new w(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(n)}visibleLinesStabilized(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new CC(t)),this._eventDispatcher.emitOutgoingEvent(new p_(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new bC)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new vC)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let t=new R(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),n=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new W_(n,this._viewportStart.startLineDelta)}return new W_(null,0)}_onConfigurationChanged(t,n){let i=this._captureStableViewport(),r=this._configuration.options,s=r.get(51),a=r.get(141),l=r.get(148),d=r.get(140),c=r.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(t.emitViewEvent(new Bc),t.emitViewEvent(new Wc),t.emitViewEvent(new da(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),n.hasChanged(93)&&(this._decorations.reset(),t.emitViewEvent(new da(null))),n.hasChanged(100)&&(this._decorations.reset(),t.emitViewEvent(new da(null))),t.emitViewEvent(new yC(n)),this.viewLayout.onConfigurationChanged(n),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),sl.shouldRecreate(n)&&(this.cursorConfig=new sl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(t=>{try{let i=this._eventDispatcher.beginEmitViewEvents(),r=!1,s=!1,a=t instanceof Yl?t.rawContentChangedEvent.changes:t.changes,l=t instanceof Yl?t.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let p of a)switch(p.changeType){case 4:{for(let m=0;m<p.detail.length;m++){let g=p.detail[m],f=p.injectedTexts[m];f&&(f=f.filter(b=>!b.ownerId||b.ownerId===this._editorId)),d.addRequest(g,f,null)}break}case 2:{let m=null;p.injectedText&&(m=p.injectedText.filter(g=>!g.ownerId||g.ownerId===this._editorId)),d.addRequest(p.detail,m,null);break}}let c=d.finalize(),u=new no(c);for(let p of a)switch(p.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new Bc),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),r=!0;break}case 3:{let m=this._lines.onModelLinesDeleted(l,p.fromLineNumber,p.toLineNumber);m!==null&&(i.emitViewEvent(m),this.viewLayout.onLinesDeleted(m.fromLineNumber,m.toLineNumber)),r=!0;break}case 4:{let m=u.takeCount(p.detail.length),g=this._lines.onModelLinesInserted(l,p.fromLineNumber,p.toLineNumber,m);g!==null&&(i.emitViewEvent(g),this.viewLayout.onLinesInserted(g.fromLineNumber,g.toLineNumber)),r=!0;break}case 2:{let m=u.dequeue(),[g,f,b,v]=this._lines.onModelLineChanged(l,p.lineNumber,m);s=g,f&&i.emitViewEvent(f),b&&(i.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),v&&(i.emitViewEvent(v),this.viewLayout.onLinesDeleted(v.fromLineNumber,v.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!r&&s&&(i.emitViewEvent(new Wc),i.emitViewEvent(new da(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){let i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){let r=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let i=this._eventDispatcher.beginEmitViewEvents();t instanceof Yl&&i.emitOutgoingEvent(new C_(t.contentChangedEvent)),this._cursor.onModelContentChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(t=>{let n=[];for(let i=0,r=t.ranges.length;i<r;i++){let s=t.ranges[i],a=this.coordinatesConverter.convertModelPositionToViewPosition(new R(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new R(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;n[i]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new wC(n)),this._eventDispatcher.emitOutgoingEvent(new x_(t))})),this._register(this.model.onDidChangeLanguageConfiguration(t=>{this._eventDispatcher.emitSingleViewEvent(new SC),this.cursorConfig=new sl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new I_(t))})),this._register(this.model.onDidChangeLanguage(t=>{this.cursorConfig=new sl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new y_(t))})),this._register(this.model.onDidChangeOptions(t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new Bc),n.emitViewEvent(new Wc),n.emitViewEvent(new da(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new sl(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new S_(t))})),this._register(this.model.onDidChangeDecorations(t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new da(t)),this._eventDispatcher.emitOutgoingEvent(new v_(t))}))}hiddenAreasModel=new ZD;previousHiddenAreas=[];setHiddenAreas(t,n){this.hiddenAreasModel.setHiddenAreas(n,t);let i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;let r=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(i),s&&(a.emitViewEvent(new Bc),a.emitViewEvent(new Wc),a.emitViewEvent(new da(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=r.viewportStartModelPosition?.lineNumber;l&&i.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||r.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new g_)}getVisibleRangesPlusViewportAboveBelow(){let t=this._configuration.options.get(147),n=this._configuration.options.get(68),i=Math.max(20,Math.round(t.height/n)),r=this.viewLayout.getLinesViewportData(),s=Math.max(1,r.completelyVisibleStartLineNumber-i),a=Math.min(this.getLineCount(),r.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new w(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){let n=this.coordinatesConverter.convertViewRangeToModelRange(t),i=this._lines.getHiddenAreas();if(i.length===0)return[n];let r=[],s=0,a=n.startLineNumber,l=n.startColumn,d=n.endLineNumber,c=n.endColumn;for(let u=0,p=i.length;u<p;u++){let m=i[u].startLineNumber,g=i[u].endLineNumber;g<a||m>d||(a<m&&(r[s++]=new w(a,l,m-1,this.model.getLineMaxColumn(m-1))),a=g+1,l=1)}return(a<d||a===d&&l<c)&&(r[s++]=new w(a,l,d,c)),r}getCompletelyVisibleViewRange(){let t=this.viewLayout.getLinesViewportData(),n=t.completelyVisibleStartLineNumber,i=t.completelyVisibleEndLineNumber;return new w(n,this.getLineMinColumn(n),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(t){let n=this.viewLayout.getLinesViewportDataAtScrollTop(t),i=n.completelyVisibleStartLineNumber,r=n.completelyVisibleEndLineNumber;return new w(i,this.getLineMinColumn(i),r,this.getLineMaxColumn(r))}saveState(){let t=this.viewLayout.saveState(),n=t.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(n),r=this.coordinatesConverter.convertViewPositionToModelPosition(new R(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-n;return{scrollLeft:t.scrollLeft,firstPosition:r,firstPositionDeltaTop:s}}reduceRestoreState(t){if(typeof t.firstPosition>"u")return this._reduceRestoreStateCompatibility(t);let n=this.model.validatePosition(t.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(n),r=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:r}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,n,i){this._viewportStart.update(this,t)}getActiveIndentGuide(t,n,i){return this._lines.getActiveIndentGuide(t,n,i)}getLinesIndentGuides(t,n){return this._lines.getViewLinesIndentGuides(t,n)}getBracketGuidesInRangeByLine(t,n,i,r){return this._lines.getViewLinesBracketGuides(t,n,i,r)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){let n=$t(this.getLineContent(t));return n===-1?0:n+1}getLineLastNonWhitespaceColumn(t){let n=Zo(this.getLineContent(t));return n===-1?0:n+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,n){let r=this._decorations.getDecorationsViewportData(t).inlineDecorations[n-t.startLineNumber];return this._getViewLineRenderingData(n,r)}getViewLineRenderingData(t){let n=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,n)}_getViewLineRenderingData(t,n){let i=this.model.mightContainRTL(),r=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(t);return a.inlineDecorations&&(n=[...n,...a.inlineDecorations.map(l=>l.toInlineDecoration(t))]),new kC(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,i,r,a.tokens,n,s,a.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,n,i){let r=this._lines.getViewLinesData(t,n,i);return new LC(this.getTabSize(),r)}getAllOverviewRulerDecorations(t){let n=this.model.getOverviewRulerDecorations(this._editorId,cc(this._configuration.options)),i=new QD;for(let r of n){let s=r.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(t.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.startLineNumber,r.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.endLineNumber,r.range.endColumn);i.accept(d,s.zIndex,c,u,l)}return i.asArray}_invalidateDecorationsColorCache(){let t=this.model.getOverviewRulerDecorations();for(let n of t)n.options.overviewRuler?.invalidateCachedColor(),n.options.minimap?.invalidateCachedColor()}getValueInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(i,n)}getValueLengthInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(i,n)}modifyPosition(t,n){let i=this.coordinatesConverter.convertViewPositionToModelPosition(t),r=this.model.modifyPosition(i,n);return this.coordinatesConverter.convertModelPositionToViewPosition(r)}deduceModelPositionRelativeToViewPosition(t,n,i){let r=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(n<0?n-=i:n+=i);let a=this.model.getOffsetAt(r)+n;return this.model.getPositionAt(a)}getPlainTextToCopy(t,n,i){let r=i?`\r
`:this.model.getEOL();t=t.slice(0),t.sort(w.compareRangesUsingStarts);let s=!1,a=!1;for(let d of t)d.isEmpty()?s=!0:a=!0;if(!a){if(!n)return"";let d=t.map(u=>u.startLineNumber),c="";for(let u=0;u<d.length;u++)u>0&&d[u-1]===d[u]||(c+=this.model.getLineContent(d[u])+r);return c}if(s&&n){let d=[],c=0;for(let u of t){let p=u.startLineNumber;u.isEmpty()?p!==c&&d.push(this.model.getLineContent(p)):d.push(this.model.getValueInRange(u,i?2:0)),c=p}return d.length===1?d[0]:d}let l=[];for(let d of t)d.isEmpty()||l.push(this.model.getValueInRange(d,i?2:0));return l.length===1?l[0]:l}getRichTextToCopy(t,n){let i=this.model.getLanguageId();if(i===or||t.length!==1)return null;let r=t[0];if(r.isEmpty()){if(!n)return null;let u=r.startLineNumber;r=new w(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===lo.fontFamily,c;return d?c=lo.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${lo.fontFamily}`),{mode:i,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(r,a)+"</div>"}}_getHTMLToCopy(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn,l=this.getTabSize(),d="";for(let c=i;c<=s;c++){let u=this.model.tokenization.getLineTokens(c),p=u.getLineContent(),m=c===i?r-1:0,g=c===s?a-1:p.length;p===""?d+="<br>":d+=YB(p,u.inflate(),n,m,g,l,dt)}return d}_getColorMap(){let t=uo.getColorMap(),n=["#000000"];if(t)for(let i=1,r=t.length;i<r;i++)n[i]=G.Format.CSS.formatHex(t[i]);return n}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,n,i){return this._withViewEventsCollector(r=>this._cursor.setStates(r,t,n,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,n,i=0){this._withViewEventsCollector(r=>this._cursor.setSelections(r,t,n,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector(n=>this._cursor.restoreState(n,t))}_executeCursorEdit(t){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new b_);return}this._withViewEventsCollector(t)}executeEdits(t,n,i){this._executeCursorEdit(r=>this._cursor.executeEdits(r,t,n,i))}startComposition(){this._executeCursorEdit(t=>this._cursor.startComposition(t))}endComposition(t){this._executeCursorEdit(n=>this._cursor.endComposition(n,t))}type(t,n){this._executeCursorEdit(i=>this._cursor.type(i,t,n))}compositionType(t,n,i,r,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,t,n,i,r,s))}paste(t,n,i,r){this._executeCursorEdit(s=>this._cursor.paste(s,t,n,i,r))}cut(t){this._executeCursorEdit(n=>this._cursor.cut(n,t))}executeCommand(t,n){this._executeCursorEdit(i=>this._cursor.executeCommand(i,t,n))}executeCommands(t,n){this._executeCursorEdit(i=>this._cursor.executeCommands(i,t,n))}revealAllCursors(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealAll(r,t,i,0,n,0))}revealPrimaryCursor(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealPrimary(r,t,i,0,n,0))}revealTopMostCursor(t){let n=this._cursor.getTopMostViewPosition(),i=new w(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new al(t,!1,i,null,0,!0,0)))}revealBottomMostCursor(t){let n=this._cursor.getBottomMostViewPosition(),i=new w(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new al(t,!1,i,null,0,!0,0)))}revealRange(t,n,i,r,s){this._withViewEventsCollector(a=>a.emitViewEvent(new al(t,!1,i,null,r,n,s)))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new TC),this._eventDispatcher.emitOutgoingEvent(new m_))}_withViewEventsCollector(t){return this._transactionalTarget.batchChanges(()=>{try{let n=this._eventDispatcher.beginEmitViewEvents();return t(n)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(t){this._withViewEventsCollector(()=>{t()})}normalizePosition(t,n){return this._lines.normalizePosition(t,n)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}},YD=class o{constructor(e,t,n,i,r){this._model=e;this._viewLineNumber=t;this._isValid=n;this._modelTrackedRange=i;this._startLineDelta=r}static create(e){let t=e._setTrackedRange(null,new w(1,1,1,1),1);return new o(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){let n=e.coordinatesConverter.convertViewPositionToModelPosition(new R(t,e.getLineMinColumn(t))),i=e.model._setTrackedRange(this._modelTrackedRange,new w(n.lineNumber,n.column,n.lineNumber,n.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),s=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=i,this._startLineDelta=s-r}invalidate(){this._isValid=!1}},QD=class{_asMap=Object.create(null);asArray=[];accept(e,t,n,i,r){let s=this._asMap[e];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===r&&d+1>=n){i>d&&(a[a.length-1]=i);return}a.push(r,n,i)}else{let a=new Uc(e,t,[r,n,i]);this._asMap[e]=a,this.asArray.push(a)}}},ZD=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(e,t){let n=this.hiddenAreas.get(e);n&&XB(n,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let e=Array.from(this.hiddenAreas.values()).reduce((t,n)=>d9(t,n),[]);return XB(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}};function d9(o,e){let t=[],n=0,i=0;for(;n<o.length&&i<e.length;){let r=o[n],s=e[i];if(r.endLineNumber<s.startLineNumber-1)t.push(o[n++]);else if(s.endLineNumber<r.startLineNumber-1)t.push(e[i++]);else{let a=Math.min(r.startLineNumber,s.startLineNumber),l=Math.max(r.endLineNumber,s.endLineNumber);t.push(new w(a,1,l,1)),n++,i++}}for(;n<o.length;)t.push(o[n++]);for(;i<e.length;)t.push(e[i++]);return t}function XB(o,e){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].equalsRange(e[t]))return!1;return!0}var W_=class{constructor(e,t){this.viewportStartModelPosition=e;this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;let n=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),i=t.getVerticalOffsetForLineNumber(n.lineNumber);t.setScrollPosition({scrollTop:i+this.startLineDelta},1)}};var Dr=class extends W{constructor(t,n,i,r,s,a,l,d,c,u,p,m){super();this.languageConfigurationService=p;s.willCreateCodeEditor();let g={...n};this._domElement=t,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++c9,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?Bt.SimpleEditorContext:Bt.EditorContext),g,u)),this._register(this._configuration.onDidChange(v=>{this._onDidChangeConfiguration.fire(v);let I=this._configuration.options;if(v.hasChanged(147)){let C=I.get(147);this._onDidLayoutChange.fire(C)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new eR(this,this._contextKeyService)),this._register(new tR(this,this._contextKeyService,m)),this._instantiationService=this._register(r.createChild(new sv([rt,this._contextKeyService]))),this._modelData=null,this._focusTracker=new nR(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let f;Array.isArray(i.contributions)?f=i.contributions:f=Sf.getEditorContributions(),this._contributions.initialize(this,f,this._instantiationService);for(let v of Sf.getEditorActions()){if(this._actions.has(v.id)){Ue(new Error(`Cannot have two actions with the same id ${v.id}`));continue}let I=new l_(v.id,v.label,v.alias,v.metadata,v.precondition??void 0,C=>this._instantiationService.invokeFunction(S=>Promise.resolve(v.runEditorCommand(S,this,C))),this._contextKeyService);this._actions.set(I.id,I)}let b=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new sC(this._domElement,{onDragOver:v=>{if(!b())return;let I=this.getTargetAtClientPoint(v.clientX,v.clientY);I?.position&&this.showDropIndicatorAt(I.position)},onDrop:async v=>{if(!b()||(this.removeDropIndicator(),!v.dataTransfer))return;let I=this.getTargetAtClientPoint(v.clientX,v.clientY);I?.position&&this._onDropIntoEditor.fire({position:I.position,event:v})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=Ln.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=oM();_contributions=this._register(new a_);_onDidDispose=this._register(new L);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new L({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new ei(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new V_({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new V_({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new ei(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new ei(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new ei(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new ei(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new ei(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new ei(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new ei(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new ei(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new ei(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new ei(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new ei(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new ei(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new ei(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new ei(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new ei(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new ei(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new ei(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new L);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new L);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(t){this._modelData?.view.writeScreenReaderContent(t)}_createConfiguration(t,n,i,r){return new ih(t,n,i,this._domElement,r)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return oL.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?uh.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),t):null}getValue(t=null){if(!this._modelData)return"";let n=!!(t&&t.preserveBOM),i=0;return t&&t.lineEnding&&t.lineEnding===`
`?i=1:t&&t.lineEnding&&t.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,n)}setValue(t){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(t)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){try{this._beginUpdate();let n=t;if(this._modelData===null&&n===null||this._modelData&&this._modelData.model===n)return;let i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:n?.uri||null};this._onWillChangeModel.fire(i);let r=this.hasTextFocus(),s=this._detachModel();this._attachModel(n),r&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let t in this._decorationTypeSubtypes){let n=this._decorationTypeSubtypes[t];for(let i in n)this._removeDecorationType(t+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,n,i,r){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,r)}getTopForLineNumber(t,n=!1){return this._modelData?Dr._getVerticalOffsetForPosition(this._modelData,t,1,n):-1}getTopForPosition(t,n){return this._modelData?Dr._getVerticalOffsetForPosition(this._modelData,t,n,!1):-1}static _getVerticalOffsetForPosition(t,n,i,r=!1){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,r)}getBottomForLineNumber(t,n=!1){if(!this._modelData)return-1;let i=this._modelData.model.getLineMaxColumn(t);return Dr._getVerticalOffsetAfterPosition(this._modelData,t,i,n)}setHiddenAreas(t,n){this._modelData?.viewModel.setHiddenAreas(t.map(i=>w.lift(i)),n)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return St.visibleColumnFromColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)+1}getStatusbarColumn(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return St.toStatusbarColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,n="api"){if(this._modelData){if(!R.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,n,i,r){if(!this._modelData)return;if(!w.isIRange(t))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(t),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,a,n,r)}revealLine(t,n=0){this._revealLine(t,0,n)}revealLineInCenter(t,n=0){this._revealLine(t,1,n)}revealLineInCenterIfOutsideViewport(t,n=0){this._revealLine(t,2,n)}revealLineNearTop(t,n=0){this._revealLine(t,5,n)}_revealLine(t,n,i){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new w(t,1,t,1),n,!1,i)}revealPosition(t,n=0){this._revealPosition(t,0,!0,n)}revealPositionInCenter(t,n=0){this._revealPosition(t,1,!0,n)}revealPositionInCenterIfOutsideViewport(t,n=0){this._revealPosition(t,2,!0,n)}revealPositionNearTop(t,n=0){this._revealPosition(t,5,!0,n)}_revealPosition(t,n,i,r){if(!R.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new w(t.lineNumber,t.column,t.lineNumber,t.column),n,i,r)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,n="api"){let i=De.isISelection(t),r=w.isIRange(t);if(!i&&!r)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(t,n);else if(r){let s={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(s,n)}}_setSelectionImpl(t,n){if(!this._modelData)return;let i=new De(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(n,[i])}revealLines(t,n,i=0){this._revealLines(t,n,0,i)}revealLinesInCenter(t,n,i=0){this._revealLines(t,n,1,i)}revealLinesInCenterIfOutsideViewport(t,n,i=0){this._revealLines(t,n,2,i)}revealLinesNearTop(t,n,i=0){this._revealLines(t,n,5,i)}_revealLines(t,n,i,r){if(typeof t!="number"||typeof n!="number")throw new Error("Invalid arguments");this._sendRevealRange(new w(t,1,n,1),i,!1,r)}revealRange(t,n=0,i=!1,r=!0){this._revealRange(t,i?1:0,r,n)}revealRangeInCenter(t,n=0){this._revealRange(t,1,!0,n)}revealRangeInCenterIfOutsideViewport(t,n=0){this._revealRange(t,2,!0,n)}revealRangeNearTop(t,n=0){this._revealRange(t,5,!0,n)}revealRangeNearTopIfOutsideViewport(t,n=0){this._revealRange(t,6,!0,n)}revealRangeAtTop(t,n=0){this._revealRange(t,3,!0,n)}_revealRange(t,n,i,r){if(!w.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(w.lift(t),n,i,r)}setSelections(t,n="api",i=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let r=0,s=t.length;r<s;r++)if(!De.isISelection(t[r]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,t,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},n)}}setScrollTop(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},n)}}setScrollPosition(t,n=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,n)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let t=this._contributions.saveViewState(),n=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:n,viewState:i,contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;let n=t;if(n&&n.cursorState&&n.viewState){let i=n.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(n.contributionsState||{});let r=this._modelData.viewModel.reduceRestoreState(n.viewState);this._modelData.view.restoreState(r)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter(n=>n.isSupported()),t}getAction(t){return this._actions.get(t)||null}trigger(t,n,i){i=i||{};try{switch(this._beginUpdate(),n){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(t);return;case"type":{let s=i;this._type(t,s.text||"");return}case"replacePreviousChar":{let s=i;this._compositionType(t,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=i;this._compositionType(t,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=i;this._paste(t,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(t);return}let r=this.getAction(n);if(r){Promise.resolve(r.run(i)).then(void 0,Ue);return}if(!this._modelData||this._triggerEditorCommand(t,n,i))return;this._triggerCommand(n,i)}finally{this._endUpdate()}}_triggerCommand(t,n){this._commandService.executeCommand(t,n)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,n){!this._modelData||n.length===0||(t==="keyboard"&&this._onWillType.fire(n),this._modelData.viewModel.type(n,t),t==="keyboard"&&this._onDidType.fire(n))}_compositionType(t,n,i,r,s){this._modelData&&this._modelData.viewModel.compositionType(n,i,r,s,t)}_paste(t,n,i,r,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(n,i,r,t);let c=l.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new w(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,n,i){let r=Sf.getEditorCommand(n);return r?(i=i||{},i.source=t,this._instantiationService.invokeFunction(s=>{Promise.resolve(r.runEditorCommand(s,this,i)).then(void 0,Ue)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(t,n,i){if(!this._modelData||this._configuration.options.get(93))return!1;let r;return i?Array.isArray(i)?r=()=>i:r=i:r=()=>null,this._modelData.viewModel.executeEdits(t,n,r),!0}executeCommand(t,n){this._modelData&&this._modelData.viewModel.executeCommand(n,t)}executeCommands(t,n){this._modelData&&this._modelData.viewModel.executeCommands(n,t)}createDecorationsCollection(t){return new iR(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,cc(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,cc(this._configuration.options)):null}deltaDecorations(t,n){return this._modelData?t.length===0&&n.length===0?t:this._modelData.model.deltaDecorations(t,n,this._id):[]}removeDecorations(t){!this._modelData||t.length===0||this._modelData.model.changeDecorations(n=>{n.deltaDecorations(t,[])})}setDecorationsByType(t,n,i){let r={},s=this._decorationTypeSubtypes[n]||{};this._decorationTypeSubtypes[n]=r;let a=[];for(let d of i){let c=n;if(d.renderOptions){let p=tr(d.renderOptions).toString(16);c=n+"-"+p,!s[p]&&!r[p]&&this._registerDecorationType(t,c,d.renderOptions,n),r[p]=!0}let u=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(u.hoverMessage=d.hoverMessage),a.push({range:d.range,options:u})}for(let d in s)r[d]||this._removeDecorationType(n+"-"+d);let l=this._decorationTypeKeysToIds[n]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[n]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(t,n){let i=this._decorationTypeSubtypes[t]||{};for(let l in i)this._removeDecorationType(t+"-"+l);this._decorationTypeSubtypes[t]={};let r=Ln.createDynamic(this._resolveDecorationOptions(t,!1)),s=new Array(n.length);for(let l=0,d=n.length;l<d;l++)s[l]={range:n[l],options:r};let a=this._decorationTypeKeysToIds[t]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[t]=l.deltaDecorations(a,s))}removeDecorationsByType(t){let n=this._decorationTypeKeysToIds[t];n&&this.changeDecorations(i=>i.deltaDecorations(n,[])),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(t)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,n=!1){this._configuration.observeContainer(t),n||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){let n={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(n)}layoutContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];delete this._contentWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(t){let n={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(n)}layoutOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];delete this._overlayWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(t){let n={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(n)}layoutGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];delete this._glyphMarginWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(t)}getTargetAtClientPoint(t,n){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(t,n)}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;let n=this._modelData.model.validatePosition(t),i=this._configuration.options,r=i.get(147),s=Dr._getVerticalOffsetForPosition(this._modelData,n.lineNumber,n.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(n.lineNumber,n.column)+r.glyphMarginWidth+r.lineNumbersWidth+r.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:i.get(68)}}getOffsetForColumn(t,n){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(t,n)}render(t=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,t)})}setAriaOptions(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(t)}applyFontInfo(t){Qt(t,this._configuration.options.get(51))}setBanner(t,n){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=t,this._configuration.setReservedHeight(t?n:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t){this._modelData=null;return}let n=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());let i=t.onBeforeAttached(),r=new B_(this._id,this._configuration,t,s_.create(fe(this._domElement)),d_.create(this._configuration.options),l=>li(fe(this._domElement),l),this.languageConfigurationService,this._themeService,i,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});n.push(t.onWillDispose(()=>this.setModel(null))),n.push(r.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let p=this.getOption(81),m=h("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",p);this._notificationService.prompt(BI.Warning,m,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:h("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let p=0,m=l.selections.length;p<m;p++)d[p]=l.selections[p].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let u={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(r);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addContentWidget(this._contentWidgets[u])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addOverlayWidget(this._overlayWidgets[u])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[u])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new JD(t,r,s,a,n,i)}_createView(t){let n;this.isSimpleWidget?n={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:n={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let i=new Wh(t.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new Jh(n,this._configuration,this._themeService.getColorTheme(),t,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let t=this._modelData.model,n=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),n&&this._domElement.contains(n)&&n.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),t}_registerDecorationType(t,n,i,r){this._codeEditorService.registerDecorationType(t,n,i,r,this)}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}_resolveDecorationOptions(t,n){return this._codeEditorService.resolveDecorationOptions(t,n)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){let n=[{range:new w(t.lineNumber,t.column,t.lineNumber,t.column),options:Dr.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(n),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,n){this._contextKeyService.createKey(t,n)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};Dr=K([D(3,ct),D(4,wr),D(5,In),D(6,rt),D(7,qr),D(8,el),D(9,Si),D(10,Fn),D(11,Ho)],Dr);var c9=0,JD=class{constructor(e,t,n,i,r,s){this.model=e;this.viewModel=t;this.view=n;this.hasRealView=i;this.listenersToRemove=r;this.attachedView=s}dispose(){xt(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var V_=class extends W{constructor(t){super();this._emitterOptions=t;this._value=0}_onDidChangeToTrue=this._register(new L(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new L(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(t){let n=t?2:1;this._value!==n&&(this._value=n,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},ei=class extends L{constructor(t,n){super({deliveryQueue:n});this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}},eR=class extends W{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=oe.editorSimpleInput.bindTo(t),this._editorFocus=oe.focus.bindTo(t),this._textInputFocus=oe.textInputFocus.bindTo(t),this._editorTextFocus=oe.editorTextFocus.bindTo(t),this._tabMovesFocus=oe.tabMovesFocus.bindTo(t),this._editorReadonly=oe.readOnly.bindTo(t),this._inDiffEditor=oe.inDiffEditor.bindTo(t),this._editorColumnSelection=oe.columnSelection.bindTo(t),this._hasMultipleSelections=oe.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=oe.hasNonEmptySelection.bindTo(t),this._canUndo=oe.canUndo.bindTo(t),this._canRedo=oe.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(nh.onDidChangeTabFocus(n=>this._tabMovesFocus.set(n))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let e=this._editor.getOptions();this._tabMovesFocus.set(nh.getTabFocusMode()),this._editorReadonly.set(e.get(93)),this._inDiffEditor.set(e.get(62)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){let e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}},tR=class extends W{constructor(t,n,i){super();this._editor=t;this._contextKeyService=n;this._languageFeaturesService=i;this._langId=oe.languageId.bindTo(n),this._hasCompletionItemProvider=oe.hasCompletionItemProvider.bindTo(n),this._hasCodeActionsProvider=oe.hasCodeActionsProvider.bindTo(n),this._hasCodeLensProvider=oe.hasCodeLensProvider.bindTo(n),this._hasDefinitionProvider=oe.hasDefinitionProvider.bindTo(n),this._hasDeclarationProvider=oe.hasDeclarationProvider.bindTo(n),this._hasImplementationProvider=oe.hasImplementationProvider.bindTo(n),this._hasTypeDefinitionProvider=oe.hasTypeDefinitionProvider.bindTo(n),this._hasHoverProvider=oe.hasHoverProvider.bindTo(n),this._hasDocumentHighlightProvider=oe.hasDocumentHighlightProvider.bindTo(n),this._hasDocumentSymbolProvider=oe.hasDocumentSymbolProvider.bindTo(n),this._hasReferenceProvider=oe.hasReferenceProvider.bindTo(n),this._hasRenameProvider=oe.hasRenameProvider.bindTo(n),this._hasSignatureHelpProvider=oe.hasSignatureHelpProvider.bindTo(n),this._hasInlayHintsProvider=oe.hasInlayHintsProvider.bindTo(n),this._hasDocumentFormattingProvider=oe.hasDocumentFormattingProvider.bindTo(n),this._hasDocumentSelectionFormattingProvider=oe.hasDocumentSelectionFormattingProvider.bindTo(n),this._hasMultipleDocumentFormattingProvider=oe.hasMultipleDocumentFormattingProvider.bindTo(n),this._hasMultipleDocumentSelectionFormattingProvider=oe.hasMultipleDocumentSelectionFormattingProvider.bindTo(n),this._isInEmbeddedEditor=oe.isInEmbeddedEditor.bindTo(n);let r=()=>this._update();this._register(t.onDidChangeModel(r)),this._register(t.onDidChangeModelLanguage(r)),this._register(i.completionProvider.onDidChange(r)),this._register(i.codeActionProvider.onDidChange(r)),this._register(i.codeLensProvider.onDidChange(r)),this._register(i.definitionProvider.onDidChange(r)),this._register(i.declarationProvider.onDidChange(r)),this._register(i.implementationProvider.onDidChange(r)),this._register(i.typeDefinitionProvider.onDidChange(r)),this._register(i.hoverProvider.onDidChange(r)),this._register(i.documentHighlightProvider.onDidChange(r)),this._register(i.documentSymbolProvider.onDidChange(r)),this._register(i.referenceProvider.onDidChange(r)),this._register(i.renameProvider.onDidChange(r)),this._register(i.documentFormattingEditProvider.onDidChange(r)),this._register(i.documentRangeFormattingEditProvider.onDidChange(r)),this._register(i.signatureHelpProvider.onDidChange(r)),this._register(i.inlayHintsProvider.onDidChange(r)),r()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let t=this._editor.getModel();if(!t){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===$e.walkThroughSnippet||t.uri.scheme===$e.vscodeChatCodeBlock)})}},nR=class extends W{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new L);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(e,t){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Pc(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(Pc(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},iR=class{constructor(e,t){this._editor=e;Array.isArray(t)&&t.length>0&&this.set(t)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(e,t,n){return this._editor.onDidChangeModelDecorations(i=>{this._isChangingDecorations||e.call(t,i)},n)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];let e=this._editor.getModel(),t=[];for(let n of this._decorationIds){let i=e.getDecorationRange(n);i&&t.push(i)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(n=>{t=n.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}},u9=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),p9=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function XD(o){return u9+encodeURIComponent(o.toString())+p9}var h9=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),m9=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function g9(o){return h9+encodeURIComponent(o.toString())+m9}ji((o,e)=>{let t=o.getColor(Og);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${XD(t)}") repeat-x bottom left; }`);let n=o.getColor(Cr);n&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${XD(n)}") repeat-x bottom left; }`);let i=o.getColor(Qr);i&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${XD(i)}") repeat-x bottom left; }`);let r=o.getColor(XA);r&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${g9(r)}") no-repeat bottom left; }`);let s=o.getColor(NO);s&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});var em=class extends Dr{_parentEditor;_overwriteOptions;constructor(e,t,n,i,r,s,a,l,d,c,u,p,m){super(e,{...i.getRawOptions(),overflowWidgetsDomNode:i.getOverflowWidgetsDomNode()},n,r,s,a,l,d,c,u,p,m),this._parentEditor=i,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(i.onDidChangeConfiguration(g=>this._onParentConfigurationChanged(g)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){PE(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};em=K([D(4,ct),D(5,wr),D(6,In),D(7,rt),D(8,qr),D(9,el),D(10,Si),D(11,Fn),D(12,Ho)],em);var oR=class extends Ur{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new L);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(e,t){super(),this._element=Ee(e,Se(".monaco-dropdown")),this._label=Ee(this._element,Se(".dropdown-label"));let n=t.labelRenderer;n||(n=r=>(r.textContent=t.label||"",null));for(let r of[we.CLICK,we.MOUSE_DOWN,ht.Tap])this._register(q(this.element,r,s=>it.stop(s,!0)));for(let r of[we.MOUSE_DOWN,ht.Tap])this._register(q(this._label,r,s=>{cC(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(q(this._label,we.KEY_UP,r=>{let s=new pt(r);(s.equals(3)||s.equals(10))&&(it.stop(r,!0),this.visible?this.hide():this.show())}));let i=n(this._label);i&&this._register(i),this._register(Sn.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(e){this._label&&(!this.hover&&e!==""?this.hover=this._register(mi().setupManagedHover(dn("mouse"),this._label,e)):this.hover&&this.hover.update(e))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(e,t){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},H_=class extends oR{constructor(t,n){super(t,n);this._options=n;this.actions=n.actions||[]}_menuOptions;_actions=[];set menuOptions(t){this._menuOptions=t}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(t){this._actions=t}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(t,n)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(t,n):void 0,getKeyBinding:t=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(t):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var Ld=class extends Oi{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new L);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(e,t,n,i=Object.create(null)){super(null,e,i),this.menuActionsOrProvider=t,this.contextMenuProvider=n,this.options=i,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;let t=r=>{this.element=Ee(r,Se("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(mi().setupManagedHover(this.options.hoverDelegate??dn("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},n=Array.isArray(this.menuActionsOrProvider),i={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:n?this.menuActionsOrProvider:void 0,actionProvider:n?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new H_(e,i)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{this.element?.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){let e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}};var JB=Y("contextViewService"),fl=Y("contextMenuService");var jWt={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:G.white.toString(),buttonForeground:G.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0};function y9(o,e){let t={...e};for(let n in o){let i=o[n];t[n]=i!==void 0?ie(i):void 0}return t}var nUt={keybindingLabelBackground:ie(WN),keybindingLabelForeground:ie(VN),keybindingLabelBorder:ie(HN),keybindingLabelBottomBorder:ie(UN),keybindingLabelShadow:ie(bp)};var iUt={buttonForeground:ie(NL),buttonSeparator:ie(wN),buttonBackground:ie(vp),buttonHoverBackground:ie(EN),buttonSecondaryForeground:ie(LN),buttonSecondaryBackground:ie(Qy),buttonSecondaryHoverBackground:ie(kN),buttonBorder:ie(TN)};var oUt={progressBarBackground:ie(zA)};var I9={inputActiveOptionBorder:ie(ML),inputActiveOptionForeground:ie(AL),inputActiveOptionBackground:ie(PL)},rUt={activeForeground:ie(yp),activeBackground:ie(DN),activeBorder:ie(RN),inactiveForeground:ie(MN),inactiveBackground:ie(PN),inactiveBorder:ie(AN),inactiveHoverBackground:ie(NN)};var sUt={checkboxBackground:ie(ON),checkboxBorder:ie(BN),checkboxForeground:ie(FN)};var aUt={dialogBackground:ie(_i),dialogForeground:ie(Cc),dialogShadow:ie(bp),dialogBorder:ie(et),errorIconForeground:ie(sN),warningIconForeground:ie(aN),infoIconForeground:ie(lN),textLinkForeground:ie(HA)};var C9={inputBackground:ie(pN),inputForeground:ie(hN),inputBorder:ie(mN),inputValidationInfoBorder:ie(bN),inputValidationInfoBackground:ie(gN),inputValidationInfoForeground:ie(fN),inputValidationWarningBorder:ie(IN),inputValidationWarningBackground:ie(vN),inputValidationWarningForeground:ie(yN),inputValidationErrorBorder:ie(xN),inputValidationErrorBackground:ie(CN),inputValidationErrorForeground:ie(SN)};var lUt={listFilterWidgetBackground:ie(tO),listFilterWidgetOutline:ie(nO),listFilterWidgetNoMatchesOutline:ie(iO),listFilterWidgetShadow:ie(oO),inputBoxStyles:C9,toggleStyles:I9},dUt={badgeBackground:ie(up),badgeForeground:ie(UA),badgeBorder:ie(et)};var cUt={breadcrumbsBackground:ie(iN),breadcrumbsForeground:ie(nN),breadcrumbsHoverForeground:ie(kL),breadcrumbsFocusForeground:ie(kL),breadcrumbsFocusAndSelectionForeground:ie(oN)};var S9={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:ie(zN),listFocusForeground:ie(KN),listFocusOutline:ie(GN),listActiveSelectionBackground:ie(Zs),listActiveSelectionForeground:ie(ed),listActiveSelectionIconForeground:ie(Zy),listFocusAndSelectionOutline:ie($N),listFocusAndSelectionBackground:ie(Zs),listFocusAndSelectionForeground:ie(ed),listInactiveSelectionBackground:ie(jN),listInactiveSelectionIconForeground:ie(YN),listInactiveSelectionForeground:ie(qN),listInactiveFocusBackground:ie(QN),listInactiveFocusOutline:ie(ZN),listHoverBackground:ie(OL),listHoverForeground:ie(FL),listDropOverBackground:ie(XN),listDropBetweenBackground:ie(JN),listSelectionOutline:ie(Pt),listHoverOutline:ie(Pt),treeIndentGuidesStroke:ie(BL),treeInactiveIndentGuidesStroke:ie(rO),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:ie(Ag),tableColumnsBorder:ie(sO),tableOddRowsBackgroundColor:ie(aO)};function eW(o){return y9(o,S9)}var tW={selectBackground:ie(Ip),selectListBackground:ie(_N),selectForeground:ie(Fg),decoratorRightForeground:ie(fO),selectBorder:ie(Bg),focusBorder:ie(Po),listFocusBackground:ie(eI),listInactiveSelectionIconForeground:ie(Jy),listFocusForeground:ie(Xy),listFocusOutline:FA(Pt,G.transparent.toString()),listHoverBackground:ie(OL),listHoverForeground:ie(FL),listHoverOutline:ie(Pt),selectListBorder:ie(Ng),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var uUt={shadowColor:ie(bp),borderColor:ie(lO),foregroundColor:ie(dO),backgroundColor:ie(cO),selectionForegroundColor:ie(uO),selectionBackgroundColor:ie(pO),selectionBorderColor:ie(hO),separatorColor:ie(mO),scrollbarShadow:ie(Ag),scrollbarSliderBackground:ie($y),scrollbarSliderHoverBackground:ie(jy),scrollbarSliderActiveBackground:ie(qy)};function $_(o,e,t,n,i,r){let s,a,l,d,c;if(Array.isArray(o))c=o,s=e,a=t,l=n,d=i;else{let p=e;c=o.getActions(p),s=t,a=n,l=i,d=r}x9(c,s,!1,typeof a=="string"?p=>p===a:a,l,d)}function x9(o,e,t,n=s=>s==="navigation",i=()=>!1,r=!1){let s,a;Array.isArray(e)?(s=e,a=e):(s=e.primary,a=e.secondary);let l=new Set;for(let[d,c]of o){let u;n(d)?(u=s,u.length>0&&r&&u.push(new On)):(u=a,u.length>0&&u.push(new On));for(let p of c){t&&(p=p instanceof Bn&&p.alt?p.alt:p);let m=u.push(p);p instanceof Fa&&l.add({group:d,action:p,index:m-1})}}for(let{group:d,action:c,index:u}of l){let p=n(d)?s:a,m=c.actions;i(c,d,p.length)&&p.splice(u,1,...m)}}var bl=class extends ha{constructor(t,n,i,r,s,a,l,d){super(void 0,t,{icon:!!(t.class||t.item.icon),label:!t.class&&!t.item.icon,draggable:n?.draggable,keybinding:n?.keybinding,hoverDelegate:n?.hoverDelegate});this._options=n;this._keybindingService=i;this._notificationService=r;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=rC.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new Ut);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(t){t.preventDefault(),t.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(n){this._notificationService.error(n)}}render(t){if(super.render(t),t.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let n=!1,i=()=>{let r=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||n)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&n);r!==this._wantsAltCommand&&(this._wantsAltCommand=r,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(q(t,"mouseleave",r=>{n=!1,i()})),this._register(q(t,"mouseenter",r=>{n=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),n=t&&t.getLabel(),i=this._commandAction.tooltip||this._commandAction.label,r=n?h("titleAndKb","{0} ({1})",i,n):i;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?h("titleAndKb","{0} ({1})",s,l):s;r=h("titleAndKbAndAlt",`{0}
[{1}] {2}`,r,wS.modifierLabels[mr].altKey,d)}return r}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(t){this._itemClassDispose.value=void 0;let{element:n,label:i}=this;if(!n||!i)return;let r=this._commandAction.checked&&gP(t.toggled)&&t.toggled.icon?t.toggled.icon:t.icon;if(r)if(Je.isThemeIcon(r)){let s=Je.asClassNameArray(r);i.classList.add(...s),this._itemClassDispose.value=ge(()=>{i.classList.remove(...s)})}else i.style.backgroundImage=CL(this._themeService.getColorTheme().type)?Ac(r.dark):Ac(r.light),i.classList.add("icon"),this._itemClassDispose.value=Ts(ge(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};bl=K([D(2,kn),D(3,el),D(4,rt),D(5,qr),D(6,fl),D(7,Si)],bl);var G_=class o extends bl{render(e){this.options.label=!0,this.options.icon=!1,super.render(e),e.classList.add("text-only"),e.classList.toggle("use-comma",this._options?.useComma??!1)}updateLabel(){let e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){let t=o._symbolPrintEnter(e);this._options?.conversational?this.label.textContent=h({key:"content2",comment:['A label with keybindg like "ESC to dismiss"']},"{1} to {0}",this._action.label,t):this.label.textContent=h({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,t)}}static _symbolPrintEnter(e){return e.getLabel()?.replace(/\benter\b/gi,"\u23CE").replace(/\bEscape\b/gi,"Esc")}},U_=class extends Ld{constructor(t,n,i,r,s){let a={...n,menuAsChild:n?.menuAsChild??!1,classNames:n?.classNames??(Je.isThemeIcon(t.item.icon)?Je.asClassName(t.item.icon):void 0),keybindingProvider:n?.keybindingProvider??(l=>i.lookupKeybinding(l.id))};super(t,{getActions:()=>t.actions},r,a);this._keybindingService=i;this._contextMenuService=r;this._themeService=s}render(t){super.render(t),Ci(this.element),t.classList.add("menu-entry");let n=this._action,{icon:i}=n.item;if(i&&!Je.isThemeIcon(i)){this.element.classList.add("icon");let r=()=>{this.element&&(this.element.style.backgroundImage=CL(this._themeService.getColorTheme().type)?Ac(i.dark):Ac(i.light))};r(),this._register(this._themeService.onDidColorThemeChange(()=>{r()}))}}};U_=K([D(2,kn),D(3,fl),D(4,qr)],U_);var z_=class extends Oi{constructor(t,n,i,r,s,a,l,d){super(null,t);this._keybindingService=i;this._notificationService=r;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=n,this._storageKey=`${t.item.submenu.id}_lastActionId`;let c,u=n?.persistLastActionId?d.get(this._storageKey,1):void 0;u&&(c=t.actions.find(m=>u===m.id)),c||(c=t.actions[0]),this._defaultAction=this._instaService.createInstance(bl,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let p={keybindingProvider:m=>this._keybindingService.lookupKeybinding(m.id),...n,menuAsChild:n?.menuAsChild??!0,classNames:n?.classNames??["codicon","codicon-chevron-down"],actionRunner:n?.actionRunner??new Ur};this._dropdown=new Ld(t,t.actions,this._contextMenuService,p),this._register(this._dropdown.actionRunner.onDidRun(m=>{m.action instanceof Bn&&this.update(m.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(t){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,t.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(bl,t,{keybinding:this._getDefaultActionKeybindingLabel(t)}),this._defaultAction.actionRunner=new class extends Ur{async runAction(n,i){await n.run(void 0)}},this._container&&this._defaultAction.render(v2(this._container,Se(".action-container")))}_getDefaultActionKeybindingLabel(t){let n;if(this._options?.renderKeybindingWithDefaultActionLabel){let i=this._keybindingService.lookupKeybinding(t.id);i&&(n=`(${i.getLabel()})`)}return n}setActionContext(t){super.setActionContext(t),this._defaultAction.setActionContext(t),this._dropdown.setActionContext(t)}render(t){this._container=t,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let n=Se(".action-container");this._defaultAction.render(Ee(this._container,n)),this._register(q(n,we.KEY_DOWN,r=>{let s=new pt(r);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let i=Se(".dropdown-action-container");this._dropdown.render(Ee(this._container,i)),this._register(q(i,we.KEY_DOWN,r=>{let s=new pt(r);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(t){t?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(t){t?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};z_=K([D(2,kn),D(3,el),D(4,fl),D(5,sa),D(6,ct),D(7,ul)],z_);var K_=class extends _S{constructor(e,t){super(null,e,e.actions.map(n=>({text:n.id===On.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":n.label,isDisabled:!n.enabled})),0,t,tW,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=ie(Bg)}runAction(e,t){let n=this.action.actions[t];n&&this.actionRunner.run(n)}};K_=K([D(1,JB)],K_);var tm=class{constructor(e,t,n,i,r){this._menuId=t;this._menuService=i;this._contextKeyService=r;this.element=Ee(e,Se(".suggest-status-bar"));let s=a=>a instanceof Bn?n.createInstance(G_,a,{useComma:!0}):void 0;this._leftActions=new Tr(this.element,{actionViewItemProvider:s}),this._rightActions=new Tr(this.element,{actionViewItemProvider:s}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}element;_leftActions;_rightActions;_menuDisposables=new te;dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){let e=this._menuService.createMenu(this._menuId,this._contextKeyService),t=()=>{let n=[],i=[];for(let[r,s]of e.getActions())r==="left"?n.push(...s):i.push(...s);this._leftActions.clear(),this._leftActions.push(n),this._rightActions.clear(),this._rightActions.push(i)};this._menuDisposables.add(e.onDidChange(()=>t())),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};tm=K([D(2,ct),D(3,sa),D(4,rt)],tm);var bzt=x("symbolIcon.arrayForeground",Pe,h("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),vzt=x("symbolIcon.booleanForeground",Pe,h("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),yzt=x("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},h("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Izt=x("symbolIcon.colorForeground",Pe,h("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Czt=x("symbolIcon.constantForeground",Pe,h("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Szt=x("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),xzt=x("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},h("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),_zt=x("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),wzt=x("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},h("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Ezt=x("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Tzt=x("symbolIcon.fileForeground",Pe,h("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Lzt=x("symbolIcon.folderForeground",Pe,h("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),kzt=x("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Dzt=x("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Rzt=x("symbolIcon.keyForeground",Pe,h("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Mzt=x("symbolIcon.keywordForeground",Pe,h("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Pzt=x("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Azt=x("symbolIcon.moduleForeground",Pe,h("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Nzt=x("symbolIcon.namespaceForeground",Pe,h("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Ozt=x("symbolIcon.nullForeground",Pe,h("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Fzt=x("symbolIcon.numberForeground",Pe,h("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Bzt=x("symbolIcon.objectForeground",Pe,h("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Wzt=x("symbolIcon.operatorForeground",Pe,h("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Vzt=x("symbolIcon.packageForeground",Pe,h("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Hzt=x("symbolIcon.propertyForeground",Pe,h("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Uzt=x("symbolIcon.referenceForeground",Pe,h("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),zzt=x("symbolIcon.snippetForeground",Pe,h("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Kzt=x("symbolIcon.stringForeground",Pe,h("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Gzt=x("symbolIcon.structForeground",Pe,h("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),$zt=x("symbolIcon.textForeground",Pe,h("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),jzt=x("symbolIcon.typeParameterForeground",Pe,h("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),qzt=x("symbolIcon.unitForeground",Pe,h("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Yzt=x("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));var nm=class{domNode;_onDidWillResize=new L;onDidWillResize=this._onDidWillResize.event;_onDidResize=new L;onDidResize=this._onDidResize.event;_northSash;_eastSash;_southSash;_westSash;_sashListener=new te;_size=new Dt(0,0);_minSize=new Dt(0,0);_maxSize=new Dt(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);_preferredSize;constructor(){this.domNode=document.createElement("div"),this._eastSash=new Nc(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Nc(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Nc(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:"north"}),this._southSash=new Nc(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:"south"}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,n=0;this._sashListener.add(de.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,n=0)})),this._sashListener.add(de.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,n=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(i=>{e&&(n=i.currentX-i.startX,this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(i=>{e&&(n=-(i.currentX-i.startX),this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(i=>{e&&(t=-(i.currentY-i.startY),this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(i=>{e&&(t=i.currentY-i.startY,this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(de.any(this._eastSash.onDidReset,this._westSash.onDidReset)(i=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(de.any(this._northSash.onDidReset,this._southSash.onDidReset)(i=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,n,i){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=n?3:0,this._westSash.state=i?3:0}layout(e=this.size.height,t=this.size.width){let{height:n,width:i}=this._minSize,{height:r,width:s}=this._maxSize;e=Math.max(n,Math.min(r,e)),t=Math.max(i,Math.min(s,t));let a=new Dt(t,e);Dt.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}};var nW=Y("openerService");var kd=class{constructor(e,t,n){this._options=e;this._languageService=t;this._openerService=n}static _ttpTokenizer=Ed("tokenizeToString",{createHTML(e){return e}});_onDidRenderAsync=new L;onDidRenderAsync=this._onDidRenderAsync.event;dispose(){this._onDidRenderAsync.dispose()}render(e,t,n){if(!e)return{element:document.createElement("span"),dispose:()=>{}};let i=new te,r=i.add(Ff(e,{...this._getRenderOptions(e,i),...t},n));return r.element.classList.add("rendered-markdown"),{element:r.element,dispose:()=>i.dispose()}}_getRenderOptions(e,t){return{codeBlockRenderer:async(n,i)=>{let r;n?r=this._languageService.getLanguageIdByLanguageName(n):this._options.editor&&(r=this._options.editor.getModel()?.getLanguageId()),r||(r=or);let s=await qB(this._languageService,i,r),a=document.createElement("span");if(a.innerHTML=kd._ttpTokenizer?.createHTML(s)??s,this._options.editor){let l=this._options.editor.getOption(51);Qt(a,l)}else this._options.codeBlockFontFamily&&(a.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(a.style.fontSize=this._options.codeBlockFontSize),a},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:n=>this.openMarkdownLink(n,e),disposables:t}}}async openMarkdownLink(e,t){await _9(this._openerService,e,t.isTrusted)}};kd=K([D(1,Ki),D(2,nW)],kd);async function _9(o,e,t){try{return await o.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:w9(t)})}catch(n){return Ue(n),!1}}function w9(o){return o===!0?!0:o&&Array.isArray(o.enabledCommands)?o.enabledCommands:!1}function gb(o){return!!o&&!!(o.completion.documentation||o.completion.detail&&o.completion.detail!==o.completion.label)}var im=class{constructor(e,t){this._editor=e;this.domNode=Se(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=t.createInstance(kd,{editor:e}),this._body=Se(".body"),this._scrollbar=new Xc(this._body,{alwaysConsumeMouseWheel:!0}),Ee(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=Ee(this._body,Se(".header")),this._close=Ee(this._header,Se("span"+Je.asCSSSelector(le.close))),this._close.title=h("details.close","Close"),this._close.role="button",this._close.tabIndex=-1,this._type=Ee(this._header,Se("p.type")),this._docs=Ee(this._body,Se("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(51)&&this._configureFont()}))}domNode;_onDidClose=new L;onDidClose=this._onDidClose.event;_onDidChangeContents=new L;onDidChangeContents=this._onDidChangeContents.event;_close;_scrollbar;_body;_header;_type;_docs;_disposables=new te;_markdownRenderer;_renderDisposeable=new te;_borderWidth=1;_size=new Dt(330,0);dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){let e=this._editor.getOptions(),t=e.get(51),n=t.getMassagedFontFamily(),i=e.get(121)||t.fontSize,r=e.get(122)||t.lineHeight,s=t.fontWeight,a=`${i}px`,l=`${r}px`;this.domNode.style.fontSize=a,this.domNode.style.lineHeight=`${r/i}`,this.domNode.style.fontWeight=s,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=n,this._close.style.height=l,this._close.style.width=l}getLayoutInfo(){let e=this._editor.getOption(122)||this._editor.getOption(51).lineHeight,t=this._borderWidth,n=t*2;return{lineHeight:e,borderWidth:t,borderHeight:n,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=h("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(e,t){this._renderDisposeable.clear();let{detail:n,documentation:i}=e.completion;if(t){let r="";r+=`score: ${e.score[0]}
`,r+=`prefix: ${e.word??"(no prefix)"}
`,r+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}
`,r+=`distance: ${e.distance} (localityBonus-setting)
`,r+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}
`,r+=`commit_chars: ${e.completion.commitCharacters?.join("")}
`,i=new Hv().appendCodeblock("empty",r),n=`Provider: ${e.provider._debugDisplayName}`}if(!t&&!gb(e)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),n){let r=n.length>1e5?`${n.substr(0,1e5)}\u2026`:n;this._type.textContent=r,this._type.title=r,Bo(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(r))}else di(this._type),this._type.title="",vo(this._type),this.domNode.classList.add("no-type");if(di(this._docs),typeof i=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=i;else if(i){this._docs.classList.add("markdown-docs"),di(this._docs);let r=this._markdownRenderer.render(i);this._docs.appendChild(r.element),this._renderDisposeable.add(r),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=r=>{r.preventDefault(),r.stopPropagation()},this._close.onclick=r=>{r.preventDefault(),r.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(e,t){let n=new Dt(e,t);Dt.equals(n,this._size)||(this._size=n,d2(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}focus(){this.domNode.focus()}};im=K([D(1,ct)],im);var j_=class{constructor(e,t){this.widget=e;this._editor=t;this._resizable=new nm,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let n,i,r=0,s=0;this._disposables.add(this._resizable.onDidWillResize(()=>{n=this._topLeft,i=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(a=>{if(n&&i){this.widget.layout(a.dimension.width,a.dimension.height);let l=!1;a.west&&(s=i.width-a.dimension.width,l=!0),a.north&&(r=i.height-a.dimension.height,l=!0),l&&this._applyTopLeft({top:n.top+r,left:n.left+s})}a.done&&(n=void 0,i=void 0,r=0,s=0,this._userSize=a.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,this._preferAlignAtTop)}))}allowEditorOverflow=!0;_disposables=new te;_resizable;_added=!1;_anchorBox;_preferAlignAtTop=!0;_userSize;_topLeft;dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e,t){let n=e.getBoundingClientRect();this._anchorBox=n,this._preferAlignAtTop=t,this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,t)}_placeAtAnchor(e,t,n){let i=Mc(this.getDomNode().ownerDocument.body),r=this.widget.getLayoutInfo(),s=new Dt(220,2*r.lineHeight),a=e.top,l=function(){let E=i.width-(e.left+e.width+r.borderWidth+r.horizontalPadding),M=-r.borderWidth+e.left+e.width,A=new Dt(E,i.height-e.top-r.borderHeight-r.verticalPadding),F=A.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:M,fit:E-t.width,maxSizeTop:A,maxSizeBottom:F,minSize:s.with(Math.min(E,s.width))}}(),d=function(){let E=e.left-r.borderWidth-r.horizontalPadding,M=Math.max(r.horizontalPadding,e.left-t.width-r.borderWidth),A=new Dt(E,i.height-e.top-r.borderHeight-r.verticalPadding),F=A.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:M,fit:E-t.width,maxSizeTop:A,maxSizeBottom:F,minSize:s.with(Math.min(E,s.width))}}(),c=function(){let E=e.left,M=-r.borderWidth+e.top+e.height,A=new Dt(e.width-r.borderHeight,i.height-e.top-e.height-r.verticalPadding);return{top:M,left:E,fit:A.height-t.height,maxSizeBottom:A,maxSizeTop:A,minSize:s.with(A.width)}}(),u=[l,d,c],p=u.find(E=>E.fit>=0)??u.sort((E,M)=>M.fit-E.fit)[0],m=e.top+e.height-r.borderHeight,g,f=t.height,b=Math.max(p.maxSizeTop.height,p.maxSizeBottom.height);f>b&&(f=b);let v;n?f<=p.maxSizeTop.height?(g=!0,v=p.maxSizeTop):(g=!1,v=p.maxSizeBottom):f<=p.maxSizeBottom.height?(g=!1,v=p.maxSizeBottom):(g=!0,v=p.maxSizeTop);let{top:I,left:C}=p;!g&&f>e.height&&(I=m-f);let S=this._editor.getDomNode();if(S){let E=S.getBoundingClientRect();I-=E.top,C-=E.left}this._applyTopLeft({left:C,top:I}),this._resizable.enableSashes(!g,p===l,g,p!==l),this._resizable.minSize=p.minSize,this._resizable.maxSize=v,this._resizable.layout(f,Math.min(v.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this._editor.layoutOverlayWidget(this)}};var Dd=class o extends W{constructor(t,n){super();this.options=n;this.supportIcons=n?.supportIcons??!1,this.domNode=Ee(t,Se("span.monaco-highlighted-label"))}domNode;text="";title="";highlights=[];supportIcons;didEverRender=!1;customHover;get element(){return this.domNode}set(t,n=[],i="",r){t||(t=""),r&&(t=o.escapeNewLines(t,n)),!(this.didEverRender&&this.text===t&&this.title===i&&sn(this.highlights,n))&&(this.text=t,this.title=i,this.highlights=n,this.render())}render(){let t=[],n=0;for(let i of this.highlights){if(i.end===i.start)continue;if(n<i.start){let a=this.text.substring(n,i.start);this.supportIcons?t.push(...eu(a)):t.push(a),n=i.start}let r=this.text.substring(n,i.end),s=Se("span.highlight",void 0,...this.supportIcons?eu(r):[r]);i.extraClasses&&s.classList.add(...i.extraClasses),t.push(s),n=i.end}if(n<this.text.length){let i=this.text.substring(n);this.supportIcons?t.push(...eu(i)):t.push(i)}if(Xp(this.domNode,...t),this.options?.hoverDelegate?.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){let i=this.options?.hoverDelegate??dn("mouse");this.customHover=this._register(mi().setupManagedHover(i,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(t,n){let i=0,r=0;return t.replace(/\r\n|\r|\n/g,(s,a)=>{r=s===`\r
`?-1:0,a+=i;for(let l of n)l.end<=a||(l.start>=a&&(l.start+=r),l.end>=a&&(l.end+=r));return i+=r,"\u23CE"})}};var hu=class{constructor(e){this._element=e}disposed;_textContent;_classNames;_empty;get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||sn(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}},q_=class extends W{creationOptions;domNode;nameContainer;nameNode;descriptionNode;suffixNode;labelContainer;hoverDelegate;customHovers=new Map;constructor(e,t){super(),this.creationOptions=t,this.domNode=this._register(new hu(Ee(e,Se(".monaco-icon-label")))),this.labelContainer=Ee(this.domNode.element,Se(".monaco-icon-label-container")),this.nameContainer=Ee(this.labelContainer,Se("span.monaco-icon-name-container")),t?.supportHighlights||t?.supportIcons?this.nameNode=this._register(new sR(this.nameContainer,!!t.supportIcons)):this.nameNode=new rR(this.nameContainer),this.hoverDelegate=t?.hoverDelegate??dn("mouse")}get element(){return this.domNode.element}setLabel(e,t,n){let i=["monaco-icon-label"],r=["monaco-icon-label-container"],s="";n&&(n.extraClasses&&i.push(...n.extraClasses),n.italic&&i.push("italic"),n.strikethrough&&i.push("strikethrough"),n.disabledCommand&&r.push("disabled"),n.title&&(typeof n.title=="string"?s+=n.title:s+=e));let a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(n?.iconPath){let l;!a||!Zn(a)?(l=Se(".monaco-icon-label-iconpath"),this.domNode.element.prepend(l)):l=a,l.style.backgroundImage=Ac(n?.iconPath)}else a&&a.remove();if(this.domNode.classNames=i,this.domNode.element.setAttribute("aria-label",s),this.labelContainer.classList.value="",this.labelContainer.classList.add(...r),this.setupHover(n?.descriptionTitle?this.labelContainer:this.element,n?.title),this.nameNode.setLabel(e,n),t||this.descriptionNode){let l=this.getOrCreateDescriptionNode();l instanceof Dd?(l.set(t||"",n?n.descriptionMatches:void 0,void 0,n?.labelEscapeNewLines),this.setupHover(l.element,n?.descriptionTitle)):(l.textContent=t&&n?.labelEscapeNewLines?Dd.escapeNewLines(t,[]):t||"",this.setupHover(l.element,n?.descriptionTitle||""),l.empty=!t)}if(n?.suffix||this.suffixNode){let l=this.getOrCreateSuffixNode();l.textContent=n?.suffix??""}}setupHover(e,t){let n=this.customHovers.get(e);if(n&&(n.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover){let r=function(s,a){rn(a)?s.title=RE(a):a?.markdownNotSupportedFallback?s.title=a.markdownNotSupportedFallback:s.removeAttribute("title")};var i=r;r(e,t)}else{let r=mi().setupManagedHover(this.hoverDelegate,e,t);r&&this.customHovers.set(e,r)}}dispose(){super.dispose();for(let e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){let e=this._register(new hu(b2(this.nameContainer,Se("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new hu(Ee(e.element,Se("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){if(!this.descriptionNode){let e=this._register(new hu(Ee(this.labelContainer,Se("span.monaco-icon-description-container"))));this.creationOptions?.supportDescriptionHighlights?this.descriptionNode=this._register(new Dd(Ee(e.element,Se("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new hu(Ee(e.element,Se("span.label-description"))))}return this.descriptionNode}},rR=class{constructor(e){this.container=e}label=void 0;singleLabel=void 0;options;setLabel(e,t){if(!(this.label===e&&sn(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=Ee(this.container,Se("a.label-name",{id:t?.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let n=0;n<e.length;n++){let i=e[n],r=t?.domId&&`${t?.domId}_${n}`;Ee(this.container,Se("a.label-name",{id:r,"data-icon-label-count":e.length,"data-icon-label-index":n,role:"treeitem"},i)),n<e.length-1&&Ee(this.container,Se("span.label-separator",void 0,t?.separator||"/"))}}}};function E9(o,e,t){if(!t)return;let n=0;return o.map(i=>{let r={start:n,end:n+i.length},s=t.map(a=>Xn.intersect(r,a)).filter(a=>!Xn.isEmpty(a)).map(({start:a,end:l})=>({start:a-n,end:l-n}));return n=r.end+e.length,s})}var sR=class extends W{constructor(t,n){super();this.container=t;this.supportIcons=n}label=void 0;singleLabel=void 0;options;setLabel(t,n){if(!(this.label===t&&sn(this.options,n)))if(this.label=t,this.options=n,typeof t=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new Dd(Ee(this.container,Se("a.label-name",{id:n?.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(t,n?.matches,void 0,n?.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;let i=n?.separator||"/",r=E9(t,i,n?.matches);for(let s=0;s<t.length;s++){let a=t[s],l=r?r[s]:void 0,d=n?.domId&&`${n?.domId}_${s}`,c=Se("a.label-name",{id:d,"data-icon-label-count":t.length,"data-icon-label-index":s,role:"treeitem"});this._register(new Dd(Ee(this.container,c),{supportIcons:this.supportIcons})).set(a,l,void 0,n?.labelEscapeNewLines),s<t.length-1&&Ee(c,Se("span.label-separator",void 0,i))}}}};var L9=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function fb(o,e,t,n,i){if(Je.isThemeIcon(i))return[`codicon-${i.id}`,"predefined-file-icon"];if(be.isUri(i))return[];let r=n===2?["rootfolder-icon"]:n===1?["folder-icon"]:["file-icon"];if(t){let s;if(t.scheme===$e.data)s=Bu.parseMetaData(t).get(Bu.META_DATA_LABEL);else{let a=t.path.match(L9);a?(s=Y_(a[2].toLowerCase()),a[1]&&r.push(`${Y_(a[1].toLowerCase())}-name-dir-icon`)):s=Y_(t.authority.toLowerCase())}if(n===2)r.push(`${s}-root-name-folder-icon`);else if(n===1)r.push(`${s}-name-folder-icon`);else{if(s){if(r.push(`${s}-name-file-icon`),r.push("name-file-icon"),s.length<=255){let l=s.split(".");for(let d=1;d<l.length;d++)r.push(`${l.slice(d).join(".")}-ext-file-icon`)}r.push("ext-file-icon")}let a=k9(o,e,t);a&&r.push(`${Y_(a)}-lang-file-icon`)}}return r}function k9(o,e,t){if(!t)return null;let n=null;if(t.scheme===$e.data){let r=Bu.parseMetaData(t).get(Bu.META_DATA_MIME);r&&(n=e.getLanguageIdByMimeType(r))}else{let i=o.getModel(t);i&&(n=i.getLanguageId())}return n&&n!==or?n:e.guessLanguageIdByFilepathOrFirstLine(t)}function Y_(o){return o.replace(/[\s]/g,"/")}function lR(o){return`suggest-aria-id:${o}`}var D9=Xl("suggest-more-info",le.chevronRight,h("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),R9=new class bb{static _regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/;static _regexStrict=new RegExp(`^${bb._regexRelaxed.source}$`,"i");extract(e,t){if(e.textLabel.match(bb._regexStrict))return t[0]=e.textLabel,!0;if(e.completion.detail&&e.completion.detail.match(bb._regexStrict))return t[0]=e.completion.detail,!0;if(e.completion.documentation){let n=typeof e.completion.documentation=="string"?e.completion.documentation:e.completion.documentation.value,i=bb._regexRelaxed.exec(n);if(i&&(i.index===0||i.index+i[0].length===n.length))return t[0]=i[0],!0}return!1}},om=class{constructor(e,t,n,i){this._editor=e;this._modelService=t;this._languageService=n;this._themeService=i}_onDidToggleDetails=new L;onDidToggleDetails=this._onDidToggleDetails.event;templateId="suggestion";dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){let t=new te,n=e;n.classList.add("show-file-icons");let i=Ee(e,Se(".icon")),r=Ee(i,Se("span.colorspan")),s=Ee(e,Se(".contents")),a=Ee(s,Se(".main")),l=Ee(a,Se(".icon-label.codicon")),d=Ee(a,Se("span.left")),c=Ee(a,Se("span.right")),u=new q_(d,{supportHighlights:!0,supportIcons:!0});t.add(u);let p=Ee(d,Se("span.signature-label")),m=Ee(d,Se("span.qualifier-label")),g=Ee(c,Se("span.details-label")),f=Ee(c,Se("span.readMore"+Je.asCSSSelector(D9)));return f.title=h("readMore","Read More"),{root:n,left:d,right:c,icon:i,colorspan:r,iconLabel:u,iconContainer:l,parametersLabel:p,qualifierLabel:m,detailsLabel:g,readMore:f,disposables:t,configureFont:()=>{let v=this._editor.getOptions(),I=v.get(51),C=I.getMassagedFontFamily(),S=I.fontFeatureSettings,E=v.get(121)||I.fontSize,M=v.get(122)||I.lineHeight,A=I.fontWeight,F=I.letterSpacing,O=`${E}px`,H=`${M}px`,U=`${F}px`;n.style.fontSize=O,n.style.fontWeight=A,n.style.letterSpacing=U,a.style.fontFamily=C,a.style.fontFeatureSettings=S,a.style.lineHeight=H,i.style.height=H,i.style.width=H,f.style.height=H,f.style.width=H}}}renderElement(e,t,n){n.configureFont();let{completion:i}=e;n.root.id=lR(t),n.colorspan.style.backgroundColor="";let r={labelEscapeNewLines:!0,matches:Vv(e.score)},s=[];if(i.kind===19&&R9.extract(e,s))n.icon.className="icon customcolor",n.iconContainer.className="icon hide",n.colorspan.style.backgroundColor=s[0];else if(i.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){n.icon.className="icon hide",n.iconContainer.className="icon hide";let a=fb(this._modelService,this._languageService,be.from({scheme:"fake",path:e.textLabel}),0),l=fb(this._modelService,this._languageService,be.from({scheme:"fake",path:i.detail}),0);r.extraClasses=a.length>l.length?a:l}else i.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(n.icon.className="icon hide",n.iconContainer.className="icon hide",r.extraClasses=[fb(this._modelService,this._languageService,be.from({scheme:"fake",path:e.textLabel}),1),fb(this._modelService,this._languageService,be.from({scheme:"fake",path:i.detail}),1)].flat()):(n.icon.className="icon hide",n.iconContainer.className="",n.iconContainer.classList.add("suggest-icon",...Je.asClassNameArray(Yu.toIcon(i.kind))));i.tags&&i.tags.indexOf(1)>=0&&(r.extraClasses=(r.extraClasses||[]).concat(["deprecated"]),r.matches=[]),n.iconLabel.setLabel(e.textLabel,void 0,r),typeof i.label=="string"?(n.parametersLabel.textContent="",n.detailsLabel.textContent=aR(i.detail||""),n.root.classList.add("string-label")):(n.parametersLabel.textContent=aR(i.label.detail||""),n.detailsLabel.textContent=aR(i.label.description||""),n.root.classList.remove("string-label")),this._editor.getOption(120).showInlineDetails?Bo(n.detailsLabel):vo(n.detailsLabel),gb(e)?(n.right.classList.add("can-expand-details"),Bo(n.readMore),n.readMore.onmousedown=a=>{a.stopPropagation(),a.preventDefault()},n.readMore.onclick=a=>{a.stopPropagation(),a.preventDefault(),this._onDidToggleDetails.fire()}):(n.right.classList.remove("can-expand-details"),vo(n.readMore),n.readMore.onmousedown=null,n.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};om=K([D(1,vc),D(2,Ki),D(3,qr)],om);function aR(o){return o.replace(/\r\n|\r|\n/g,"")}x("editorSuggestWidget.background",_i,h("editorSuggestWidgetBackground","Background color of the suggest widget."));x("editorSuggestWidget.border",Ng,h("editorSuggestWidgetBorder","Border color of the suggest widget."));var M9=x("editorSuggestWidget.foreground",Yy,h("editorSuggestWidgetForeground","Foreground color of the suggest widget."));x("editorSuggestWidget.selectedForeground",Xy,h("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget."));x("editorSuggestWidget.selectedIconForeground",Jy,h("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));var P9=x("editorSuggestWidget.selectedBackground",eI,h("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));x("editorSuggestWidget.highlightForeground",Cp,h("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget."));x("editorSuggestWidget.focusHighlightForeground",eO,h("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));x("editorSuggestWidgetStatus.foreground",He(M9,.5),h("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));var dR=class{constructor(e,t){this._service=e;this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof em}`}_key;restore(){let e=this._service.get(this._key,0)??"";try{let t=JSON.parse(e);if(Dt.is(t))return Dt.lift(t)}catch{}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}},vs=class{constructor(e,t,n,i,r){this.editor=e;this._storageService=t;this.element=new nm,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new cR(this,e),this._persistedSize=new dR(t,e);class s{constructor(m,g,f=!1,b=!1){this.persistedSize=m;this.currentSize=g;this.persistHeight=f;this.persistWidth=b}}let a;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),a=new s(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(p=>{if(this._resize(p.dimension.width,p.dimension.height),a&&(a.persistHeight=a.persistHeight||!!p.north||!!p.south,a.persistWidth=a.persistWidth||!!p.east||!!p.west),!!p.done){if(a){let{itemHeight:m,defaultSize:g}=this.getLayoutInfo(),f=Math.round(m/2),{width:b,height:v}=this.element.size;(!a.persistHeight||Math.abs(a.currentSize.height-v)<=f)&&(v=a.persistedSize?.height??g.height),(!a.persistWidth||Math.abs(a.currentSize.width-b)<=f)&&(b=a.persistedSize?.width??g.width),this._persistedSize.store(new Dt(b,v))}this._contentWidget.unlockPreference(),a=void 0}})),this._messageElement=Ee(this.element.domNode,Se(".message")),this._listElement=Ee(this.element.domNode,Se(".tree"));let l=this._disposables.add(r.createInstance(im,this.editor));l.onDidClose(()=>this.toggleDetails(),this,this._disposables),this._details=new j_(l,this.editor);let d=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(120).showIcons);d();let c=r.createInstance(om,this.editor);this._disposables.add(c),this._disposables.add(c.onDidToggleDetails(()=>this.toggleDetails())),this._list=new Io("SuggestWidget",this._listElement,{getHeight:p=>this.getLayoutInfo().itemHeight,getTemplateId:p=>"suggestion"},[c],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>h("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:p=>{let m=p.textLabel;if(typeof p.completion.label!="string"){let{detail:v,description:I}=p.completion.label;v&&I?m=h("label.full","{0} {1}, {2}",m,v,I):v?m=h("label.detail","{0} {1}",m,v):I&&(m=h("label.desc","{0}, {1}",m,I))}if(!p.isResolved||!this._isDetailsVisible())return m;let{documentation:g,detail:f}=p.completion,b=Qw("{0}{1}",f||"",g?typeof g=="string"?g:g.value:"");return h("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",m,b)}}}),this._list.style(eW({listInactiveFocusBackground:P9,listInactiveFocusOutline:Pt})),this._status=r.createInstance(tm,this.element.domNode,ba);let u=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(120).showStatusBar);u(),this._disposables.add(i.onDidColorThemeChange(p=>this._onThemeChange(p))),this._onThemeChange(i.getColorTheme()),this._disposables.add(this._list.onMouseDown(p=>this._onListMouseDownOrTap(p))),this._disposables.add(this._list.onTap(p=>this._onListMouseDownOrTap(p))),this._disposables.add(this._list.onDidChangeSelection(p=>this._onListSelection(p))),this._disposables.add(this._list.onDidChangeFocus(p=>this._onListFocus(p))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(p=>{p.hasChanged(120)&&(u(),d()),this._completionModel&&(p.hasChanged(51)||p.hasChanged(121)||p.hasChanged(122))&&this._list.splice(0,this._list.length,this._completionModel.items)})),this._ctxSuggestWidgetVisible=Ve.Visible.bindTo(n),this._ctxSuggestWidgetDetailsVisible=Ve.DetailsVisible.bindTo(n),this._ctxSuggestWidgetMultipleSuggestions=Ve.MultipleSuggestions.bindTo(n),this._ctxSuggestWidgetHasFocusedSuggestion=Ve.HasFocusedSuggestion.bindTo(n),this._disposables.add(Wn(this._details.widget.domNode,"keydown",p=>{this._onDetailsKeydown.fire(p)})),this._disposables.add(this.editor.onMouseDown(p=>this._onEditorMouseDown(p)))}static LOADING_MESSAGE=h("suggestWidget.loading","Loading...");static NO_SUGGESTIONS_MESSAGE=h("suggestWidget.noSuggestions","No suggestions.");_state=0;_isAuto=!1;_loadingTimeout;_pendingLayout=new Ut;_pendingShowDetails=new Ut;_currentSuggestionDetails;_focusedItem;_ignoreFocusEvents=!1;_completionModel;_cappedHeight;_forceRenderingAbove=!1;_explainMode=!1;element;_messageElement;_listElement;_list;_status;_details;_contentWidget;_persistedSize;_ctxSuggestWidgetVisible;_ctxSuggestWidgetDetailsVisible;_ctxSuggestWidgetMultipleSuggestions;_ctxSuggestWidgetHasFocusedSuggestion;_showTimeout=new so;_disposables=new te;_onDidSelect=new Es;_onDidFocus=new Es;_onDidHide=new L;_onDidShow=new L;onDidSelect=this._onDidSelect.event;onDidFocus=this._onDidFocus.event;onDidHide=this._onDidHide.event;onDidShow=this._onDidShow.event;_onDetailsKeydown=new L;onDetailsKeyDown=this._onDetailsKeydown.event;dispose(){this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),this._loadingTimeout?.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(e){typeof e.element>"u"||typeof e.index>"u"||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){let n=this._completionModel;n&&(this._onDidSelect.fire({item:e,index:t,model:n}),this.editor.focus())}_onThemeChange(e){this._details.widget.borderWidth=Ys(e.type)?2:1}_onListFocus(e){if(this._ignoreFocusEvents)return;if(this._state===5&&this._setState(3),!e.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);let t=e.elements[0],n=e.indexes[0];t!==this._focusedItem&&(this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=t,this._list.reveal(n),this._currentSuggestionDetails=oc(async i=>{let r=rc(()=>{this._isDetailsVisible()&&this._showDetails(!0,!1)},250),s=i.onCancellationRequested(()=>r.dispose());try{return await t.resolve(i)}finally{r.dispose(),s.dispose()}}),this._currentSuggestionDetails.then(()=>{n>=this._list.length||t!==this._list.element(n)||(this._ignoreFocusEvents=!0,this._list.splice(n,1,[t]),this._list.setFocus([n]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this._showDetails(!1,!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:lR(n)}))}).catch(Ue)),this._onDidFocus.fire({item:t,index:n,model:this._completionModel})}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",e===4),this.element.domNode.classList.remove("message"),e){case 0:vo(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=vs.LOADING_MESSAGE,vo(this._listElement,this._status.element),Bo(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,gd(vs.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=vs.NO_SUGGESTIONS_MESSAGE,vo(this._listElement,this._status.element),Bo(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,gd(vs.NO_SUGGESTIONS_MESSAGE);break;case 3:vo(this._messageElement),Bo(this._listElement,this._status.element),this._show();break;case 4:vo(this._messageElement),Bo(this._listElement,this._status.element),this._show();break;case 5:vo(this._messageElement),Bo(this._listElement,this._status.element),this._details.show(),this._show(),this._details.widget.focus();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(e,t){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=rc(()=>this._setState(1),t)))}showSuggestions(e,t,n,i,r){if(this._contentWidget.setPosition(this.editor.getPosition()),this._loadingTimeout?.dispose(),this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),n&&this._state!==2&&this._state!==0){this._setState(4);return}let s=this._completionModel.items.length,a=s===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(s>1),a){this._setState(i?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(n?4:3),this._list.reveal(t,0),this._list.setFocus(r?[]:[t])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=Qp(fe(this.element.domNode),()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._list.setFocus(this._list.getFocus()),this._setState(3)):this._state===3&&(this._setState(5),this._isDetailsVisible()?this._details.widget.focus():this.toggleDetails(!0))}toggleDetails(e=!1){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(gb(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this._showDetails(!1,e))}_showDetails(e,t){this._pendingShowDetails.value=Qp(fe(this.element.domNode),()=>{this._pendingShowDetails.clear(),this._details.show();let n=!1;e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details"),t&&(this._details.widget.focus(),n=!0)),n||this.editor.focus()})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this._showDetails(!1,!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){this._pendingLayout.clear(),this._pendingShowDetails.clear(),this._loadingTimeout?.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();let e=this._persistedSize.restore(),t=Math.ceil(this.getLayoutInfo().itemHeight*4.3);e&&e.height<t&&this._persistedSize.store(e.with(void 0,t))}isFrozen(){return this._state===4}_afterRender(e){if(e===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails())}_layout(e){if(!this.editor.hasModel()||!this.editor.getDomNode())return;let t=Mc(this.element.domNode.ownerDocument.body),n=this.getLayoutInfo();e||(e=n.defaultSize);let i=e.height,r=e.width;if(this._status.element.style.height=`${n.itemHeight}px`,this._state===2||this._state===1)i=n.itemHeight+n.borderHeight,r=n.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new Dt(r,i),this._contentWidget.setPreference(2);else{let s=t.width-n.borderHeight-2*n.horizontalPadding;r>s&&(r=s);let a=this._completionModel?this._completionModel.stats.pLabelLen*n.typicalHalfwidthCharacterWidth:r,l=n.statusBarHeight+this._list.contentHeight+n.borderHeight,d=n.itemHeight+n.statusBarHeight,c=Zi(this.editor.getDomNode()),u=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),p=c.top+u.top+u.height,m=Math.min(t.height-p-n.verticalPadding,l),g=c.top+u.top-n.verticalPadding,f=Math.min(g,l),b=Math.min(Math.max(f,m)+n.borderHeight,l);i===this._cappedHeight?.capped&&(i=this._cappedHeight.wanted),i<d&&(i=d),i>b&&(i=b),i>m||this._forceRenderingAbove&&g>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),b=f):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),b=m),this.element.preferredSize=new Dt(a,n.defaultSize.height),this.element.maxSize=new Dt(s,b),this.element.minSize=new Dt(220,d),this._cappedHeight=i===l?{wanted:this._cappedHeight?.wanted??e.height,capped:i}:void 0}this._resize(r,i)}_resize(e,t){let{width:n,height:i}=this.element.maxSize;e=Math.min(n,e),t=Math.min(i,t);let{statusBarHeight:r}=this.getLayoutInfo();this._list.layout(t-r,e),this._listElement.style.height=`${t-r}px`,this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,this._contentWidget.getPosition()?.preference[0]===2)}getLayoutInfo(){let e=this.editor.getOption(51),t=rs(this.editor.getOption(122)||e.lineHeight,8,1e3),n=!this.editor.getOption(120).showStatusBar||this._state===2||this._state===1?0:t,i=this._details.widget.borderWidth,r=2*i;return{itemHeight:t,statusBarHeight:n,borderWidth:i,borderHeight:r,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new Dt(430,n+12*t+r)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};vs=K([D(1,ul),D(2,rt),D(3,qr),D(4,ct)],vs);var cR=class{constructor(e,t){this._widget=e;this._editor=t}allowEditorOverflow=!0;suppressMouseDown=!1;_position;_preference;_preferenceLocked=!1;_added=!1;_hidden=!1;dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){let{height:e,width:t}=this._widget.element.size,{borderWidth:n,horizontalPadding:i}=this._widget.getLayoutInfo();return new Dt(t+2*n+i,e+2*n)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}};var pr=class{constructor(e,t){this._editor=e;this._ckOtherSuggestions=pr.OtherSuggestions.bindTo(t)}static OtherSuggestions=new ce("hasOtherSuggestions",!1);_ckOtherSuggestions;_index=0;_model;_acceptNext;_listener;_ignore;dispose(){this.reset()}reset(){this._ckOtherSuggestions.reset(),this._listener?.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:e,index:t},n){if(e.items.length===0){this.reset();return}if(pr._moveIndex(!0,e,t)===t){this.reset();return}this._acceptNext=n,this._model=e,this._index=t,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(e,t,n){let i=n;for(let r=t.items.length;r>0&&(i=(i+t.items.length+(e?1:-1))%t.items.length,!(i===n||!t.items[i].completion.additionalTextEdits));r--);return i}next(){this._move(!0)}prev(){this._move(!1)}_move(e){if(this._model)try{this._ignore=!0,this._index=pr._moveIndex(e,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};pr=K([D(1,rt)],pr);var Q_=class{_disposables=new te;_active;constructor(e,t,n,i){this._disposables.add(n.onDidSuggest(r=>{r.completionModel.items.length===0&&this.reset()})),this._disposables.add(n.onDidCancel(r=>{this.reset()})),this._disposables.add(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType(r=>{if(this._active&&!t.isFrozen()&&n.state!==0){let s=r.charCodeAt(r.length-1);this._active.acceptCharacters.has(s)&&e.getOption(0)&&i(this._active.item)}}))}_onItem(e){if(!e||!zb(e.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===e.item)return;let t=new ty;for(let n of e.item.completion.commitCharacters)n.length>0&&t.add(n.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}};var N9=!1,uR=class{constructor(e,t){this._model=e;this._position=t;if(e.getLineMaxColumn(t.lineNumber)!==t.column){let i=e.getOffsetAt(t),r=e.getPositionAt(i+1);e.changeDecorations(s=>{this._marker&&s.removeDecoration(this._marker),this._marker=s.addDecoration(w.fromPositions(t,r),this._decorationOptions)})}}_decorationOptions=Ln.register({description:"suggest-line-suffix",stickiness:1});_marker;dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations(e=>{e.removeDecoration(this._marker),this._marker=void 0})}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){let t=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}else return this._model.getLineMaxColumn(e.lineNumber)-e.column}};var Ji=class{constructor(e,t,n,i,r,s,a){this._memoryService=t;this._commandService=n;this._contextKeyService=i;this._instantiationService=r;this._logService=s;this._telemetryService=a;this.editor=e,this.model=r.createInstance(_d,this.editor),this._selectors.register({priority:0,select:(u,p,m)=>this._memoryService.select(u,p,m)});let l=Ve.InsertMode.bindTo(i);l.set(e.getOption(120).insertMode),this._toDispose.add(this.model.onDidTrigger(()=>l.set(e.getOption(120).insertMode))),this.widget=this._toDispose.add(new qp(fe(e.getDomNode()),()=>{let u=this._instantiationService.createInstance(vs,this.editor);this._toDispose.add(u),this._toDispose.add(u.onDidSelect(b=>this._insertSuggestion(b,0),this));let p=new Q_(this.editor,u,this.model,b=>this._insertSuggestion(b,2));this._toDispose.add(p);let m=Ve.MakesTextEdit.bindTo(this._contextKeyService),g=Ve.HasInsertAndReplaceRange.bindTo(this._contextKeyService),f=Ve.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(ge(()=>{m.reset(),g.reset(),f.reset()})),this._toDispose.add(u.onDidFocus(({item:b})=>{let v=this.editor.getPosition(),I=b.editStart.column,C=v.column,S=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!b.completion.additionalTextEdits&&!(b.completion.insertTextRules&4)&&C-I===b.completion.insertText.length&&(S=this.editor.getModel().getValueInRange({startLineNumber:v.lineNumber,startColumn:I,endLineNumber:v.lineNumber,endColumn:C})!==b.completion.insertText),m.set(S),g.set(!R.equals(b.editInsertEnd,b.editReplaceEnd)),f.set(!!b.provider.resolveCompletionItem||!!b.completion.documentation||b.completion.detail!==b.completion.label)})),this._toDispose.add(u.onDetailsKeyDown(b=>{if(b.toKeyCodeChord().equals(new sd(!0,!1,!1,!1,33))||Be&&b.toKeyCodeChord().equals(new sd(!1,!1,!1,!0,33))){b.stopPropagation();return}b.toKeyCodeChord().isModifierKey()||this.editor.focus()})),u})),this._overtypingCapturer=this._toDispose.add(new qp(fe(e.getDomNode()),()=>this._toDispose.add(new XS(this.editor,this.model)))),this._alternatives=this._toDispose.add(new qp(fe(e.getDomNode()),()=>this._toDispose.add(new pr(this.editor,this._contextKeyService)))),this._toDispose.add(r.createInstance(hl,e)),this._toDispose.add(this.model.onDidTrigger(u=>{this.widget.value.showTriggered(u.auto,u.shy?250:50),this._lineSuffix.value=new uR(this.editor.getModel(),u.position)})),this._toDispose.add(this.model.onDidSuggest(u=>{if(u.triggerOptions.shy)return;let p=-1;for(let g of this._selectors.itemsOrderedByPriorityDesc)if(p=g.select(this.editor.getModel(),this.editor.getPosition(),u.completionModel.items),p!==-1)break;if(p===-1&&(p=0),this.model.state===0)return;let m=!1;if(u.triggerOptions.auto){let g=this.editor.getOption(120);g.selectionMode==="never"||g.selectionMode==="always"?m=g.selectionMode==="never":g.selectionMode==="whenTriggerCharacter"?m=u.triggerOptions.triggerKind!==1:g.selectionMode==="whenQuickSuggestion"&&(m=u.triggerOptions.triggerKind===1&&!u.triggerOptions.refilter)}this.widget.value.showSuggestions(u.completionModel,p,u.isFrozen,u.triggerOptions.auto,m)})),this._toDispose.add(this.model.onDidCancel(u=>{u.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{N9||(this.model.cancel(),this.model.clear())}));let d=Ve.AcceptSuggestionsOnEnter.bindTo(i),c=()=>{let u=this.editor.getOption(1);d.set(u==="on"||u==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>c())),c()}static ID="editor.contrib.suggestController";static get(e){return e.getContribution(Ji.ID)}editor;model;widget;_alternatives;_lineSuffix=new Ut;_toDispose=new te;_overtypingCapturer;_selectors=new pR(e=>e.priority);_onWillInsertSuggestItem=new L;onWillInsertSuggestItem=this._onWillInsertSuggestItem.event;dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(e,t){if(!e||!e.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;let n=nn.get(this.editor);if(!n)return;this._onWillInsertSuggestItem.fire({item:e.item});let i=this.editor.getModel(),r=i.getAlternativeVersionId(),{item:s}=e,a=[],l=new $n;t&1||this.editor.pushUndoStop();let d=this.getOverwriteInfo(s,!!(t&8));this._memoryService.memorize(i,this.editor.getPosition(),s);let c=s.isResolved,u=-1,p=-1;if(Array.isArray(s.completion.additionalTextEdits)){this.model.cancel();let g=Zf.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",s.completion.additionalTextEdits.map(f=>{let b=w.lift(f.range);if(b.startLineNumber===s.position.lineNumber&&b.startColumn>s.position.column){let v=this.editor.getPosition().column-s.position.column,I=v,C=w.spansMultipleLines(b)?0:v;b=new w(b.startLineNumber,b.startColumn+I,b.endLineNumber,b.endColumn+C)}return To.replaceMove(b,f.text)})),g.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!c){let g=new to,f,b=i.onDidChangeContent(S=>{if(S.isFlush){l.cancel(),b.dispose();return}for(let E of S.changes){let M=w.getEndPosition(E.range);(!f||R.isBefore(M,f))&&(f=M)}}),v=t;t|=2;let I=!1,C=this.editor.onWillType(()=>{C.dispose(),I=!0,v&2||this.editor.pushUndoStop()});a.push(s.resolve(l.token).then(()=>{if(!s.completion.additionalTextEdits||l.token.isCancellationRequested)return;if(f&&s.completion.additionalTextEdits.some(E=>R.isBefore(f,w.getStartPosition(E.range))))return!1;I&&this.editor.pushUndoStop();let S=Zf.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",s.completion.additionalTextEdits.map(E=>To.replaceMove(w.lift(E.range),E.text))),S.restoreRelativeVerticalPositionOfCursor(this.editor),(I||!(v&2))&&this.editor.pushUndoStop(),!0}).then(S=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",g.elapsed(),S),p=S===!0?1:S===!1?0:-2}).finally(()=>{b.dispose(),C.dispose()}))}let{insertText:m}=s.completion;if(s.completion.insertTextRules&4||(m=ur.escape(m)),this.model.cancel(),n.insert(m,{overwriteBefore:d.overwriteBefore,overwriteAfter:d.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(s.completion.insertTextRules&1),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),t&2||this.editor.pushUndoStop(),s.completion.command)if(s.completion.command.id===Z_.id)this.model.trigger({auto:!0,retrigger:!0});else{let g=new to;a.push(this._commandService.executeCommand(s.completion.command.id,...s.completion.command.arguments?[...s.completion.command.arguments]:[]).catch(f=>{s.completion.extensionId?_a(f):Ue(f)}).finally(()=>{u=g.elapsed()}))}t&4&&this._alternatives.value.set(e,g=>{for(l.cancel();i.canUndo();){r!==i.getAlternativeVersionId()&&i.undo(),this._insertSuggestion(g,3|(t&8?8:0));break}}),this._alertCompletionItem(s),Promise.all(a).finally(()=>{this._reportSuggestionAcceptedTelemetry(s,i,c,u,p,e.index,e.model.items),this.model.clear(),l.dispose()})}_reportSuggestionAcceptedTelemetry(e,t,n,i,r,s,a){if(Math.floor(Math.random()*100)===0)return;let l=new Map;for(let p=0;p<Math.min(30,a.length);p++){let m=a[p].textLabel;l.has(m)?l.get(m).push(p):l.set(m,[p])}let d=l.get(e.textLabel),u=d&&d.length>1?d[0]:-1;this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:e.extensionId?.value??"unknown",providerId:e.provider._debugDisplayName??"unknown",kind:e.completion.kind,basenameHash:tr(Ol(t.uri)).toString(16),languageId:t.getLanguageId(),fileExtension:lE(t.uri),resolveInfo:e.provider.resolveCompletionItem?n?1:0:-1,resolveDuration:e.resolveDuration,commandDuration:i,additionalEditsAsync:r,index:s,firstIndex:u})}getOverwriteInfo(e,t){Ci(this.editor.hasModel());let n=this.editor.getOption(120).insertMode==="replace";t&&(n=!n);let i=e.position.column-e.editStart.column,r=(n?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column,s=this.editor.getPosition().column-e.position.column,a=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:i+s,overwriteAfter:r+a}}_alertCompletionItem(e){if(zb(e.completion.additionalTextEdits)){let t=h("aria.alert.snippet","Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length);ua(t)}}triggerSuggest(e,t,n){this.editor.hasModel()&&(this.model.trigger({auto:t??!1,completionOptions:{providerFilter:e,kindFilter:n?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;let t=this.editor.getPosition(),n=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},i=r=>{if(r.completion.insertTextRules&4||r.completion.additionalTextEdits)return!0;let s=this.editor.getPosition(),a=r.editStart.column,l=s.column;return l-a!==r.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:s.lineNumber,startColumn:a,endLineNumber:s.lineNumber,endColumn:l})!==r.completion.insertText};de.once(this.model.onDidTrigger)(r=>{let s=[];de.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{xt(s),n()},void 0,s),this.model.onDidSuggest(({completionModel:a})=>{if(xt(s),a.items.length===0){n();return}let l=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),a.items),d=a.items[l];if(!i(d)){n();return}this.editor.pushUndoStop(),this._insertSuggestion({index:l,item:d,model:a},7)},void 0,s)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){let n=this.widget.value.getFocusedItem(),i=0;e&&(i|=4),t&&(i|=8),this._insertSuggestion(n,i)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(e){return this._selectors.register(e)}};Ji=K([D(1,Hk),D(2,In),D(3,rt),D(4,ct),D(5,En),D(6,sr)],Ji);var pR=class{constructor(e){this.prioritySelector=e}_items=new Array;register(e){if(this._items.indexOf(e)!==-1)throw new Error("Value is already registered");return this._items.push(e),this._items.sort((t,n)=>this.prioritySelector(n)-this.prioritySelector(t)),{dispose:()=>{let t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}},Z_=class o extends If{static id="editor.action.triggerSuggest";constructor(){super({id:o.id,label:h("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:pe.and(oe.writable,oe.hasCompletionItemProvider,Ve.Visible.toNegated()),kbOpts:{kbExpr:oe.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t,n){let i=Ji.get(t);if(!i)return;let r;n&&typeof n=="object"&&n.auto===!0&&(r=!0),i.triggerSuggest(void 0,r,void 0)}};ch(Ji.ID,Ji,2);k0(Z_);var Ko=190,Fi=ca.bindToContribution(Ji.get);ye(new Fi({id:"acceptSelectedSuggestion",precondition:pe.and(Ve.Visible,Ve.HasFocusedSuggestion),handler(o){o.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:pe.and(Ve.Visible,oe.textInputFocus),weight:Ko},{primary:3,kbExpr:pe.and(Ve.Visible,oe.textInputFocus,Ve.AcceptSuggestionsOnEnter,Ve.MakesTextEdit),weight:Ko}],menuOpts:[{menuId:ba,title:h("accept.insert","Insert"),group:"left",order:1,when:Ve.HasInsertAndReplaceRange.toNegated()},{menuId:ba,title:h("accept.insert","Insert"),group:"left",order:1,when:pe.and(Ve.HasInsertAndReplaceRange,Ve.InsertMode.isEqualTo("insert"))},{menuId:ba,title:h("accept.replace","Replace"),group:"left",order:1,when:pe.and(Ve.HasInsertAndReplaceRange,Ve.InsertMode.isEqualTo("replace"))}]}));ye(new Fi({id:"acceptAlternativeSelectedSuggestion",precondition:pe.and(Ve.Visible,oe.textInputFocus,Ve.HasFocusedSuggestion),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:1027,secondary:[1026]},handler(o){o.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:ba,group:"left",order:2,when:pe.and(Ve.HasInsertAndReplaceRange,Ve.InsertMode.isEqualTo("insert")),title:h("accept.replace","Replace")},{menuId:ba,group:"left",order:2,when:pe.and(Ve.HasInsertAndReplaceRange,Ve.InsertMode.isEqualTo("replace")),title:h("accept.insert","Insert")}]}));nr.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");ye(new Fi({id:"hideSuggestWidget",precondition:Ve.Visible,handler:o=>o.cancelSuggestWidget(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:9,secondary:[1033]}}));ye(new Fi({id:"selectNextSuggestion",precondition:pe.and(Ve.Visible,pe.or(Ve.MultipleSuggestions,Ve.HasFocusedSuggestion.negate())),handler:o=>o.selectNextSuggestion(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));ye(new Fi({id:"selectNextPageSuggestion",precondition:pe.and(Ve.Visible,pe.or(Ve.MultipleSuggestions,Ve.HasFocusedSuggestion.negate())),handler:o=>o.selectNextPageSuggestion(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:12,secondary:[2060]}}));ye(new Fi({id:"selectLastSuggestion",precondition:pe.and(Ve.Visible,pe.or(Ve.MultipleSuggestions,Ve.HasFocusedSuggestion.negate())),handler:o=>o.selectLastSuggestion()}));ye(new Fi({id:"selectPrevSuggestion",precondition:pe.and(Ve.Visible,pe.or(Ve.MultipleSuggestions,Ve.HasFocusedSuggestion.negate())),handler:o=>o.selectPrevSuggestion(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));ye(new Fi({id:"selectPrevPageSuggestion",precondition:pe.and(Ve.Visible,pe.or(Ve.MultipleSuggestions,Ve.HasFocusedSuggestion.negate())),handler:o=>o.selectPrevPageSuggestion(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:11,secondary:[2059]}}));ye(new Fi({id:"selectFirstSuggestion",precondition:pe.and(Ve.Visible,pe.or(Ve.MultipleSuggestions,Ve.HasFocusedSuggestion.negate())),handler:o=>o.selectFirstSuggestion()}));ye(new Fi({id:"focusSuggestion",precondition:pe.and(Ve.Visible,Ve.HasFocusedSuggestion.negate()),handler:o=>o.focusSuggestion(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));ye(new Fi({id:"focusAndAcceptSuggestion",precondition:pe.and(Ve.Visible,Ve.HasFocusedSuggestion.negate()),handler:o=>{o.focusSuggestion(),o.acceptSelectedSuggestion(!0,!1)}}));ye(new Fi({id:"toggleSuggestionDetails",precondition:pe.and(Ve.Visible,Ve.HasFocusedSuggestion),handler:o=>o.toggleSuggestionDetails(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:ba,group:"right",order:1,when:pe.and(Ve.DetailsVisible,Ve.CanResolve),title:h("detail.more","Show Less")},{menuId:ba,group:"right",order:1,when:pe.and(Ve.DetailsVisible.toNegated(),Ve.CanResolve),title:h("detail.less","Show More")}]}));ye(new Fi({id:"toggleExplainMode",precondition:Ve.Visible,handler:o=>o.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));ye(new Fi({id:"toggleSuggestionFocus",precondition:Ve.Visible,handler:o=>o.toggleSuggestionFocus(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:2570,mac:{primary:778}}}));ye(new Fi({id:"insertBestCompletion",precondition:pe.and(oe.textInputFocus,pe.equals("config.editor.tabCompletion","on"),hl.AtEnd,Ve.Visible.toNegated(),pr.OtherSuggestions.toNegated(),nn.InSnippetMode.toNegated()),handler:(o,e)=>{o.triggerSuggestAndAcceptBest(pn(e)?{fallback:"tab",...e}:{fallback:"tab"})},kbOpts:{weight:Ko,primary:2}}));ye(new Fi({id:"insertNextSuggestion",precondition:pe.and(oe.textInputFocus,pe.equals("config.editor.tabCompletion","on"),pr.OtherSuggestions,Ve.Visible.toNegated(),nn.InSnippetMode.toNegated()),handler:o=>o.acceptNextSuggestion(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:2}}));ye(new Fi({id:"insertPrevSuggestion",precondition:pe.and(oe.textInputFocus,pe.equals("config.editor.tabCompletion","on"),pr.OtherSuggestions,Ve.Visible.toNegated(),nn.InSnippetMode.toNegated()),handler:o=>o.acceptPrevSuggestion(),kbOpts:{weight:Ko,kbExpr:oe.textInputFocus,primary:1026}}));k0(class extends If{constructor(){super({id:"editor.action.resetSuggestSize",label:h("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(o,e){Ji.get(e)?.resetWidgetSize()}});var X_=class extends W{constructor(t,n,i){super();this.editor=t;this.suggestControllerPreselector=n;this.onWillAccept=i;this._register(t.onKeyDown(s=>{s.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))})),this._register(t.onKeyUp(s=>{s.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))}));let r=Ji.get(this.editor);if(r){this._register(r.registerSelector({priority:100,select:(l,d,c)=>{let u=this.editor.getModel();if(!u)return-1;let p=this.suggestControllerPreselector(),m=p?fa(p,u):void 0;if(!m)return-1;let g=R.lift(d),f=c.map((v,I)=>{let C=vb.fromSuggestion(r,u,g,v,this.isShiftKeyPressed),S=fa(C.toSingleTextEdit(),u),E=RS(m,S);return{index:I,valid:E,prefixLength:S.text.length,suggestItem:v}}).filter(v=>v&&v.valid&&v.prefixLength>0),b=rw(f,Nr(v=>v.prefixLength,Pw));return b?b.index:-1}}));let s=!1,a=()=>{s||(s=!0,this._register(r.widget.value.onDidShow(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})),this._register(r.widget.value.onDidHide(()=>{this.isSuggestWidgetVisible=!1,this.update(!1)})),this._register(r.widget.value.onDidFocus(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})))};this._register(de.once(r.model.onDidTrigger)(l=>{a()})),this._register(r.onWillInsertSuggestItem(l=>{let d=this.editor.getPosition(),c=this.editor.getModel();if(!d||!c)return;let u=vb.fromSuggestion(r,c,d,l.item,this.isShiftKeyPressed);this.onWillAccept(u)}))}this.update(this._isActive)}isSuggestWidgetVisible=!1;isShiftKeyPressed=!1;_isActive=!1;_currentSuggestItemInfo=void 0;get selectedItem(){return this._currentSuggestItemInfo}_onDidSelectedItemChange=this._register(new L);onDidSelectedItemChange=this._onDidSelectedItemChange.event;update(t){let n=this.getSuggestItemInfo();(this._isActive!==t||!O9(this._currentSuggestItemInfo,n))&&(this._isActive=t,this._currentSuggestItemInfo=n,this._onDidSelectedItemChange.fire())}getSuggestItemInfo(){let t=Ji.get(this.editor);if(!t||!this.isSuggestWidgetVisible)return;let n=t.widget.value.getFocusedItem(),i=this.editor.getPosition(),r=this.editor.getModel();if(!(!n||!i||!r))return vb.fromSuggestion(t,r,i,n.item,this.isShiftKeyPressed)}stopForceRenderingAbove(){Ji.get(this.editor)?.stopForceRenderingAbove()}forceRenderingAbove(){Ji.get(this.editor)?.forceRenderingAbove()}},vb=class o{constructor(e,t,n,i){this.range=e;this.insertText=t;this.completionItemKind=n;this.isSnippetText=i}static fromSuggestion(e,t,n,i,r){let{insertText:s}=i.completion,a=!1;if(i.completion.insertTextRules&4){let d=new ur().parse(s);d.children.length<100&&Ti.adjustWhitespace(t,n,!0,d),s=d.toString(),a=!0}let l=e.getOverwriteInfo(i,r);return new o(w.fromPositions(n.delta(0,-l.overwriteBefore),n.delta(0,Math.max(l.overwriteAfter,0))),s,i.completion.kind,a)}equals(e){return this.range.equalsRange(e.range)&&this.insertText===e.insertText&&this.completionItemKind===e.completionItemKind&&this.isSnippetText===e.isSnippetText}toSelectedSuggestionInfo(){return new cy(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new hn(this.range,this.insertText)}};function O9(o,e){return o===e?!0:!o||!e?!1:o.equals(e)}var rm=class extends W{constructor(t,n,i,r,s,a,l,d,c,u,p,m){super();this.textModel=t;this.selectedSuggestItem=n;this._textModelVersionId=i;this._positions=r;this._debounceValue=s;this._suggestPreviewEnabled=a;this._suggestPreviewMode=l;this._inlineSuggestMode=d;this._enabled=c;this._instantiationService=u;this._commandService=p;this._languageConfigurationService=m;this._register(Db(this._fetchInlineCompletionsPromise));let g;this._register(Ht(f=>{let v=this.state.read(f)?.inlineCompletion;if(v?.semanticId!==g?.semanticId&&(g=v,v)){let I=v.inlineCompletion,C=I.source;C.provider.handleItemDidShow?.(C.inlineCompletions,I.sourceInlineCompletion,I.insertText)}}))}_source=this._register(this._instantiationService.createInstance(Eh,this.textModel,this._textModelVersionId,this._debounceValue));_isActive=qo(this,!1);_forceUpdateExplicitlySignal=Vd(this);_selectedInlineCompletionId=qo(this,void 0);_primaryPosition=gn(this,t=>this._positions.read(t)[0]??new R(1,1));_isAcceptingPartially=!1;get isAcceptingPartially(){return this._isAcceptingPartially}_preserveCurrentCompletionReasons=new Set([1,0,2]);_getReason(t){return t?.isUndoing?0:t?.isRedoing?1:this.isAcceptingPartially?2:3}_fetchInlineCompletionsPromise=gw({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:0}),handleChange:(t,n)=>(t.didChange(this._textModelVersionId)&&this._preserveCurrentCompletionReasons.has(this._getReason(t.change))?n.preserveCurrentCompletion=!0:t.didChange(this._forceUpdateExplicitlySignal)&&(n.inlineCompletionTriggerKind=1),!0)},(t,n)=>{if(this._forceUpdateExplicitlySignal.read(t),!(this._enabled.read(t)&&this.selectedSuggestItem.read(t)||this._isActive.read(t))){this._source.cancelUpdate();return}this._textModelVersionId.read(t);let r=this._source.suggestWidgetInlineCompletions.get(),s=this.selectedSuggestItem.read(t);if(r&&!s){let u=this._source.inlineCompletions.get();_o(p=>{(!u||r.request.versionId>u.request.versionId)&&this._source.inlineCompletions.set(r.clone(),p),this._source.clearSuggestWidgetInlineCompletions(p)})}let a=this._primaryPosition.read(t),l={triggerKind:n.inlineCompletionTriggerKind,selectedSuggestionInfo:s?.toSelectedSuggestionInfo()},d=this.selectedInlineCompletion.get(),c=n.preserveCurrentCompletion||d?.forwardStable?d:void 0;return this._source.fetch(a,l,c)});async trigger(t){this._isActive.set(!0,t),await this._fetchInlineCompletionsPromise.get()}async triggerExplicitly(t){xu(t,n=>{this._isActive.set(!0,n),this._forceUpdateExplicitlySignal.trigger(n)}),await this._fetchInlineCompletionsPromise.get()}stop(t){xu(t,n=>{this._isActive.set(!1,n),this._source.clear(n)})}_filteredInlineCompletionItems=Li({owner:this,equalsFn:yu()},t=>{let n=this._source.inlineCompletions.read(t);if(!n)return[];let i=this._primaryPosition.read(t);return n.inlineCompletions.filter(s=>s.isVisible(this.textModel,i,t))});selectedInlineCompletionIndex=gn(this,t=>{let n=this._selectedInlineCompletionId.read(t),i=this._filteredInlineCompletionItems.read(t),r=this._selectedInlineCompletionId===void 0?-1:i.findIndex(s=>s.semanticId===n);return r===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):r});selectedInlineCompletion=gn(this,t=>{let n=this._filteredInlineCompletionItems.read(t),i=this.selectedInlineCompletionIndex.read(t);return n[i]});activeCommands=Li({owner:this,equalsFn:yu()},t=>this.selectedInlineCompletion.read(t)?.inlineCompletion.source.inlineCompletions.commands??[]);lastTriggerKind=this._source.inlineCompletions.map(this,t=>t?.request.context.triggerKind);inlineCompletionsCount=gn(this,t=>{if(this.lastTriggerKind.read(t)===1)return this._filteredInlineCompletionItems.read(t).length});state=Li({owner:this,equalsFn:(t,n)=>!t||!n?t===n:fk(t.ghostTexts,n.ghostTexts)&&t.inlineCompletion===n.inlineCompletion&&t.suggestItem===n.suggestItem},t=>{let n=this.textModel,i=this.selectedSuggestItem.read(t);if(i){let r=fa(i.toSingleTextEdit(),n),s=this._computeAugmentation(r,t);if(!this._suggestPreviewEnabled.read(t)&&!s)return;let l=s?.edit??r,d=s?s.edit.text.length-r.text.length:0,c=this._suggestPreviewMode.read(t),u=this._positions.read(t),p=[l,...hR(this.textModel,u,l)],m=p.map((f,b)=>_k(f,n,c,u[b],d)).filter(Pa),g=m[0]??new Id(l.range.endLineNumber,[]);return{edits:p,primaryGhostText:g,ghostTexts:m,inlineCompletion:s?.completion,suggestItem:i}}else{if(!this._isActive.read(t))return;let r=this.selectedInlineCompletion.read(t);if(!r)return;let s=r.toSingleTextEdit(t),a=this._inlineSuggestMode.read(t),l=this._positions.read(t),d=[s,...hR(this.textModel,l,s)],c=d.map((u,p)=>_k(u,n,a,l[p],0)).filter(Pa);return c[0]?{edits:d,primaryGhostText:c[0],ghostTexts:c,inlineCompletion:r,suggestItem:void 0}:void 0}});_computeAugmentation(t,n){let i=this.textModel,r=this._source.suggestWidgetInlineCompletions.read(n),s=r?r.inlineCompletions:[this.selectedInlineCompletion.read(n)].filter(Pa);return PR(s,l=>{let d=l.toSingleTextEdit(n);return d=fa(d,i,w.fromPositions(d.range.getStartPosition(),t.range.getEndPosition())),RS(d,t)?{completion:l,edit:d}:void 0})}ghostTexts=Li({owner:this,equalsFn:fk},t=>{let n=this.state.read(t);if(n)return n.ghostTexts});primaryGhostText=Li({owner:this,equalsFn:bk},t=>{let n=this.state.read(t);if(n)return n?.primaryGhostText});async _deltaSelectedInlineCompletionIndex(t){await this.triggerExplicitly();let n=this._filteredInlineCompletionItems.get()||[];if(n.length>0){let i=(this.selectedInlineCompletionIndex.get()+t+n.length)%n.length;this._selectedInlineCompletionId.set(n[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(t){if(t.getModel()!==this.textModel)throw new Ke;let n=this.state.get();if(!n||n.primaryGhostText.isEmpty()||!n.inlineCompletion)return;let i=n.inlineCompletion.toInlineCompletion(void 0);if(i.command&&i.source.addRef(),t.pushUndoStop(),i.snippetInfo)t.executeEdits("inlineSuggestion.accept",[To.replace(i.range,""),...i.additionalTextEdits]),t.setPosition(i.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),nn.get(t)?.insert(i.snippetInfo.snippet,{undoStopBefore:!1});else{let r=n.edits,s=iW(r).map(a=>De.fromPositions(a));t.executeEdits("inlineSuggestion.accept",[...r.map(a=>To.replace(a.range,a.text)),...i.additionalTextEdits]),t.setSelections(s,"inlineCompletionAccept")}this.stop(),i.command&&(await this._commandService.executeCommand(i.command.id,...i.command.arguments||[]).then(void 0,_a),i.source.removeRef())}async acceptNextWord(t){await this._acceptNext(t,(n,i)=>{let r=this.textModel.getLanguageIdAtPosition(n.lineNumber,n.column),s=this._languageConfigurationService.getLanguageConfiguration(r),a=new RegExp(s.wordDefinition.source,s.wordDefinition.flags.replace("g","")),l=i.match(a),d=0;l&&l.index!==void 0?l.index===0?d=l[0].length:d=l.index:d=i.length;let u=/\s+/g.exec(i);return u&&u.index!==void 0&&u.index+u[0].length<d&&(d=u.index+u[0].length),d},0)}async acceptNextLine(t){await this._acceptNext(t,(n,i)=>{let r=i.match(/\n/);return r&&r.index!==void 0?r.index+1:i.length},1)}async _acceptNext(t,n,i){if(t.getModel()!==this.textModel)throw new Ke;let r=this.state.get();if(!r||r.primaryGhostText.isEmpty()||!r.inlineCompletion)return;let s=r.primaryGhostText,a=r.inlineCompletion.toInlineCompletion(void 0);if(a.snippetInfo||a.filterText!==a.insertText){await this.accept(t);return}let l=s.parts[0],d=new R(s.lineNumber,l.column),c=l.text,u=n(d,c);if(u===c.length&&s.parts.length===1){this.accept(t);return}let p=c.substring(0,u),m=this._positions.get(),g=m[0];a.source.addRef();try{this._isAcceptingPartially=!0;try{t.pushUndoStop();let f=w.fromPositions(g,d),b=t.getModel().getValueInRange(f)+p,v=new hn(f,b),I=[v,...hR(this.textModel,m,v)],C=iW(I).map(S=>De.fromPositions(S));t.executeEdits("inlineSuggestion.accept",I.map(S=>To.replace(S.range,S.text))),t.setSelections(C,"inlineCompletionPartialAccept"),t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1)}finally{this._isAcceptingPartially=!1}if(a.source.provider.handlePartialAccept){let f=w.fromPositions(a.range.getStartPosition(),Pi.ofText(p).addToPosition(d)),b=t.getModel().getValueInRange(f,1);a.source.provider.handlePartialAccept(a.source.inlineCompletions,a.sourceInlineCompletion,b.length,{kind:i})}}finally{a.source.removeRef()}}handleSuggestAccepted(t){let n=fa(t.toSingleTextEdit(),this.textModel),i=this._computeAugmentation(n,void 0);if(!i)return;let r=i.completion.inlineCompletion;r.source.provider.handlePartialAccept?.(r.source.inlineCompletions,r.sourceInlineCompletion,n.text.length,{kind:2})}};rm=K([D(9,ct),D(10,In),D(11,Fn)],rm);function hR(o,e,t){if(e.length===1)return[];let n=e[0],i=e.slice(1),r=t.range.getStartPosition(),s=t.range.getEndPosition(),a=o.getValueInRange(w.fromPositions(n,s)),l=gk(n,r);if(l.lineNumber<1)return Ue(new Ke(`positionWithinTextEdit line number should be bigger than 0.
			Invalid subtraction between ${n.toString()} and ${r.toString()}`)),[];let d=F9(t.text,l);return i.map(c=>{let u=hB(gk(c,r),s),p=o.getValueInRange(w.fromPositions(c,u)),m=Br(a,p),g=w.fromPositions(c,c.delta(0,m));return new hn(g,d)})}function F9(o,e){let t="",n=WM(o);for(let i=e.lineNumber-1;i<n.length;i++)t+=n[i].substring(i===e.lineNumber-1?e.column-1:0);return t}function iW(o){let e=Hb.createSortPermutation(o,Nr(r=>r.range,w.compareRangesUsingStarts)),n=new il(e.apply(o)).getNewRanges();return e.inverse().apply(n).map(r=>r.getEndPosition())}var J_=class extends W{options;actionBar;toggleMenuAction;toggleMenuActionViewItem;submenuActionViewItems=[];hasSecondaryActions=!1;element;_onDidChangeDropdownVisibility=this._register(new Im);onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event;disposables=this._register(new te);constructor(e,t,n={orientation:0}){super(),n.hoverDelegate=n.hoverDelegate??this._register(vd()),this.options=n,this.toggleMenuAction=this._register(new sm(()=>this.toggleMenuActionViewItem?.show(),n.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new Tr(this.element,{orientation:n.orientation,ariaLabel:n.ariaLabel,actionRunner:n.actionRunner,allowContextMenu:n.allowContextMenu,highlightToggledItems:n.highlightToggledItems,hoverDelegate:n.hoverDelegate,actionViewItemProvider:(i,r)=>{if(i.id===sm.ID)return this.toggleMenuActionViewItem=new Ld(i,i.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Je.asClassNameArray(n.moreIcon??le.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(n.actionViewItemProvider){let s=n.actionViewItemProvider(i,r);if(s)return s}if(i instanceof Fa){let s=new Ld(i,i.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:i.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return s.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(s),this.disposables.add(this._onDidChangeDropdownVisibility.add(s.onDidChangeVisibility)),s}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){this.actionBar.context=e,this.toggleMenuActionViewItem?.setActionContext(e);for(let t of this.submenuActionViewItems)t.setActionContext(e)}getElement(){return this.element}focus(){this.actionBar.focus()}getItemsWidth(){let e=0;for(let t=0;t<this.actionBar.length();t++)e+=this.actionBar.getWidth(t);return e}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}getItemsLength(){return this.actionBar.length()}setAriaLabel(e){this.actionBar.setAriaLabel(e)}setActions(e,t){this.clear();let n=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),n.push(this.toggleMenuAction)),n.forEach(i=>{this.actionBar.push(i,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(i)})})}isEmpty(){return this.actionBar.isEmpty()}getKeybindingLabel(e){return this.options.getKeyBinding?.(e)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}},sm=class o extends er{static ID="toolbar.toggle.more";_menuActions;toggleDropdownMenu;constructor(e,t){t=t||h("moreActions","More Actions..."),super(o.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};var ew=class{constructor(e,t,n){this._commandService=e;this._keybindingService=t;this._hiddenStates=new ya(n)}_hiddenStates;createMenu(e,t,n){return new am(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t)}getMenuActions(e,t,n){let i=new am(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t),r=i.getActions(n);return i.dispose(),r}getMenuContexts(e){let t=new tw(e,!1);return new Set([...t.structureContextKeys,...t.preconditionContextKeys,...t.toggledContextKeys])}resetHiddenStates(e){this._hiddenStates.reset(e)}};ew=K([D(0,In),D(1,kn),D(2,ul)],ew);var ya=class{constructor(e){this._storageService=e;try{let t=e.get(ya._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,ya._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{let t=e.get(ya._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}static _key="menu.hiddenCommands";_disposables=new te;_onDidChange=new L;onDidChange=this._onDidChange.event;_ignoreChangeEvent=!1;_data;_hiddenByDefaultCache=new Map;dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,n){this._hiddenByDefaultCache.set(`${e.id}/${t}`,n)}isHidden(e,t){let n=this._isHiddenByDefault(e,t),i=this._data[e.id]?.includes(t)??!1;return n?!i:i}updateHidden(e,t,n){this._isHiddenByDefault(e,t)&&(n=!n);let r=this._data[e.id];if(n)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){let s=r.indexOf(t);s>=0&&sM(r,s),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(let{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;let e=JSON.stringify(this._data);this._storageService.store(ya._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};ya=K([D(0,ul)],ya);var tw=class o{constructor(e,t){this._id=e;this._collectContextKeysForSubmenus=t;this.refresh()}_menuGroups=[];_allMenuIds=new Set;_structureContextKeys=new Set;_preconditionContextKeys=new Set;_toggledContextKeys=new Set;get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();let e=this._sort(ra.getMenuItems(this._id)),t;for(let n of e){let i=n.group||"";(!t||t[0]!==i)&&(t=[i,[]],this._menuGroups.push(t)),t[1].push(n),this._collectContextKeysAndSubmenuIds(n)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(o._fillInKbExprKeys(e.when,this._structureContextKeys),Bp(e)){if(e.command.precondition&&o._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){let t=e.command.toggled.condition||e.command.toggled;o._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(ra.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(let n of e.keys())t.add(n)}},vl=class extends tw{constructor(t,n,i,r,s,a){super(t,i);this._hiddenStates=n;this._commandService=r;this._keybindingService=s;this._contextKeyService=a;this.refresh()}createActionGroups(t){let n=[];for(let i of this._menuGroups){let[r,s]=i,a;for(let l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let d=Bp(l);d&&this._hiddenStates.setDefaultState(this._id,l.command.id,!!l.isHiddenByDefault);let c=B9(this._id,d?l.command:l,this._hiddenStates);if(d){let u=mR(this._commandService,this._keybindingService,l.command.id,l.when);(a??=[]).push(new Bn(l.command,l.alt,t,c,u,this._contextKeyService,this._commandService))}else{let u=new vl(l.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(t),p=On.join(...u.map(m=>m[1]));p.length>0&&(a??=[]).push(new Ja(l,c,p))}}a&&a.length>0&&n.push([r,a])}return n}_sort(t){return t.sort(vl._compareMenuItems)}static _compareMenuItems(t,n){let i=t.group,r=n.group;if(i!==r){if(i){if(!r)return-1}else return 1;if(i==="navigation")return-1;if(r==="navigation")return 1;let l=i.localeCompare(r);if(l!==0)return l}let s=t.order||0,a=n.order||0;return s<a?-1:s>a?1:vl._compareTitles(Bp(t)?t.command.title:t.title,Bp(n)?n.command.title:n.title)}static _compareTitles(t,n){let i=typeof t=="string"?t:t.original,r=typeof n=="string"?n:n.original;return i.localeCompare(r)}};vl=K([D(3,In),D(4,kn),D(5,rt)],vl);var am=class{_menuInfo;_disposables=new te;_onDidChange;onDidChange;constructor(e,t,n,i,r,s){this._menuInfo=new vl(e,t,n.emitEventsForSubmenuChanges,i,r,s);let a=new zt(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},n.eventDebounceDelay);this._disposables.add(a),this._disposables.add(ra.onDidChangeMenu(u=>{for(let p of this._menuInfo.allMenuIds)if(u.has(p)){a.schedule();break}}));let l=this._disposables.add(new te),d=u=>{let p=!1,m=!1,g=!1;for(let f of u)if(p=p||f.isStructuralChange,m=m||f.isEnablementChange,g=g||f.isToggleChange,p&&m&&g)break;return{menu:this,isStructuralChange:p,isEnablementChange:m,isToggleChange:g}},c=()=>{l.add(s.onDidChangeContext(u=>{let p=u.affectsSome(this._menuInfo.structureContextKeys),m=u.affectsSome(this._menuInfo.preconditionContextKeys),g=u.affectsSome(this._menuInfo.toggledContextKeys);(p||m||g)&&this._onDidChange.fire({menu:this,isStructuralChange:p,isEnablementChange:m,isToggleChange:g})})),l.add(t.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new Bb({onWillAddFirstListener:c,onDidRemoveLastListener:l.clear.bind(l),delay:n.eventDebounceDelay,merge:d}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};am=K([D(3,In),D(4,kn),D(5,rt)],am);function B9(o,e,t){let n=IF(e)?e.submenu.id:e.id,i=typeof e.title=="string"?e.title:e.title.value,r=Ri({id:`hide/${o.id}/${n}`,label:h("hide.label","Hide '{0}'",i),run(){t.updateHidden(o,n,!0)}}),s=Ri({id:`toggle/${o.id}/${n}`,label:i,get checked(){return!t.isHidden(o,n)},run(){t.updateHidden(o,n,!!this.checked)}});return{hide:r,toggle:s,get isHidden(){return!s.checked}}}function mR(o,e,t,n=void 0,i=!0){return Ri({id:`configureKeybinding/${t}`,label:h("configure keybinding","Configure Keybinding"),enabled:i,run(){let s=!!!e.lookupKeybinding(t)&&n?n.serialize():void 0;o.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(s?` +when:${s}`:""))}})}var mu=class extends J_{constructor(t,n,i,r,s,a,l,d){super(t,s,{getKeyBinding:u=>a.lookupKeybinding(u.id)??void 0,...n,allowContextMenu:!0,skipTelemetry:typeof n?.telemetrySource=="string"});this._options=n;this._menuService=i;this._contextKeyService=r;this._contextMenuService=s;this._keybindingService=a;this._commandService=l;let c=n?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(u=>d.publicLog2("workbenchActionExecuted",{id:u.action.id,from:c})))}_sessionDisposables=this._store.add(new te);setActions(t,n=[],i){this._sessionDisposables.clear();let r=t.slice(),s=n.slice(),a=[],l=0,d=[],c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let u=0;u<r.length;u++){let p=r[u];!(p instanceof Bn)&&!(p instanceof Ja)||p.hideActions&&(a.push(p.hideActions.toggle),p.hideActions.toggle.checked&&l++,p.hideActions.isHidden&&(c=!0,r[u]=void 0,this._options?.hiddenItemStrategy!==0&&(d[u]=p)))}if(this._options?.overflowBehavior!==void 0){let u=dM(new Set(this._options.overflowBehavior.exempted),gr.map(r,g=>g?.id)),p=this._options.overflowBehavior.maxItems-u.size,m=0;for(let g=0;g<r.length;g++){let f=r[g];f&&(m++,!u.has(f.id)&&m>=p&&(r[g]=void 0,d[g]=f))}}Dw(r),Dw(d),super.setActions(r,On.join(d,s)),(a.length>0||r.length>0)&&this._sessionDisposables.add(q(this.getElement(),"contextmenu",u=>{let p=new wi(fe(this.getElement()),u),m=this.getItemAction(p.target);if(!m)return;p.preventDefault(),p.stopPropagation();let g=[];if(m instanceof Bn&&m.menuKeybinding)g.push(m.menuKeybinding);else if(!(m instanceof Ja||m instanceof sm)){let b=!!this._keybindingService.lookupKeybinding(m.id);g.push(mR(this._commandService,this._keybindingService,m.id,void 0,b))}if(a.length>0){let b=!1;if(l===1&&this._options?.hiddenItemStrategy===0){b=!0;for(let v=0;v<a.length;v++)if(a[v].checked){a[v]=Ri({id:m.id,label:m.label,checked:!0,enabled:!1,run(){}});break}}if(!b&&(m instanceof Bn||m instanceof Ja)){if(!m.hideActions)return;g.push(m.hideActions.hide)}else g.push(Ri({id:"label",label:h("hide","Hide"),enabled:!1,run(){}}))}let f=On.join(g,a);this._options?.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(f.push(new On),f.push(Ri({id:"resetThisMenu",label:h("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),f.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>p,getActions:()=>f,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};mu=K([D(2,sa),D(3,rt),D(4,fl),D(5,kn),D(6,In),D(7,sr)],mu);var nw=class extends mu{_onDidChangeMenuItems=this._store.add(new L);onDidChangeMenuItems=this._onDidChangeMenuItems.event;constructor(e,t,n,i,r,s,a,l,d){super(e,{resetMenu:t,...n},i,r,s,a,l,d);let c=this._store.add(i.createMenu(t,r,{emitEventsForSubmenuChanges:!0})),u=()=>{let p=[],m=[];$_(c,n?.menuOptions,{primary:p,secondary:m},n?.toolbarOptions?.primaryGroup,n?.toolbarOptions?.shouldInlineSubmenu,n?.toolbarOptions?.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",p.length===0&&m.length===0),super.setActions(p,m)};this._store.add(c.onDidChange(()=>{u(),this._onDidChangeMenuItems.fire(this)})),u()}setActions(){throw new Ke("This toolbar is populated from a menu.")}};nw=K([D(3,sa),D(4,rt),D(5,fl),D(6,kn),D(7,In),D(8,sr)],nw);var lm=class extends W{constructor(t,n,i){super();this.editor=t;this.model=n;this.instantiationService=i;this._register(hw((r,s)=>{let a=this.model.read(r);if(!a||!this.alwaysShowToolbar.read(r))return;let l=fw((c,u)=>{let p=u.add(this.instantiationService.createInstance(Ia,this.editor,!0,this.position,a.selectedInlineCompletionIndex,a.inlineCompletionsCount,a.activeCommands));return t.addContentWidget(p),u.add(ge(()=>t.removeContentWidget(p))),u.add(Ht(m=>{this.position.read(m)&&a.lastTriggerKind.read(m)!==1&&a.triggerExplicitly()})),p}),d=gm(this,(c,u)=>!!this.position.read(c)||!!u);s.add(Ht(c=>{d.read(c)&&l.read(c)}))}))}alwaysShowToolbar=fn(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).showToolbar==="always");sessionPosition=void 0;position=gn(this,t=>{let n=this.model.read(t)?.primaryGhostText.read(t);if(!this.alwaysShowToolbar.read(t)||!n||n.parts.length===0)return this.sessionPosition=void 0,null;let i=n.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==n.lineNumber&&(this.sessionPosition=void 0);let r=new R(n.lineNumber,Math.min(i,this.sessionPosition?.column??Number.MAX_SAFE_INTEGER));return this.sessionPosition=r,r})};lm=K([D(2,ct)],lm);var W9=Xl("inline-suggestion-hints-next",le.chevronRight,h("parameterHintsNextIcon","Icon for show next parameter hint.")),V9=Xl("inline-suggestion-hints-previous",le.chevronLeft,h("parameterHintsPreviousIcon","Icon for show previous parameter hint.")),Ia=class extends W{constructor(t,n,i,r,s,a,l,d,c,u,p){super();this.editor=t;this.withBorder=n;this._position=i;this._currentSuggestionIdx=r;this._suggestionCount=s;this._extraCommands=a;this._commandService=l;this.keybindingService=c;this._contextKeyService=u;this._menuService=p;this.toolBar=this._register(d.createInstance(yb,this.nodes.toolBar,Bt.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:m=>m.startsWith("primary")},actionViewItemProvider:(m,g)=>{if(m instanceof Bn)return d.createInstance(fR,m,void 0);if(m===this.availableSuggestionCountAction){let f=new gR(void 0,m,{label:!0,icon:!1});return f.setClass("availableSuggestionCount"),f}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility(m=>{Ia._dropDownVisible=m})),this._register(Ht(m=>{this._position.read(m),this.editor.layoutContentWidget(this)})),this._register(Ht(m=>{let g=this._suggestionCount.read(m),f=this._currentSuggestionIdx.read(m);g!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${f+1}/${g}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),g!==void 0&&g>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(Ht(m=>{let f=this._extraCommands.read(m).map(b=>({class:void 0,id:b.id,enabled:!0,tooltip:b.tooltip||"",label:b.title,run:v=>this._commandService.executeCommand(b.id)}));for(let[b,v]of this.inlineCompletionsActionsMenus.getActions())for(let I of v)I instanceof Bn&&f.push(I);f.length>0&&f.unshift(new On),this.toolBar.setAdditionalSecondaryActions(f)}))}static _dropDownVisible=!1;static get dropDownVisible(){return this._dropDownVisible}static id=0;id=`InlineSuggestionHintsContentWidget${Ia.id++}`;allowEditorOverflow=!0;suppressMouseDown=!1;nodes=Jp("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[Jp("div@toolBar")]);createCommandAction(t,n,i){let r=new er(t,n,i,!0,()=>this._commandService.executeCommand(t)),s=this.keybindingService.lookupKeybinding(t,this._contextKeyService),a=n;return s&&(a=h({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",n,s.getLabel())),r.tooltip=a,r}previousAction=this.createCommandAction(cB,h("previous","Previous"),Je.asClassName(V9));availableSuggestionCountAction=new er("inlineSuggestionHints.availableSuggestionCount","",void 0,!1);nextAction=this.createCommandAction(uB,h("next","Next"),Je.asClassName(W9));toolBar;inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(Bt.InlineCompletionsActions,this._contextKeyService));clearAvailableSuggestionCountLabelDebounced=this._register(new zt(()=>{this.availableSuggestionCountAction.label=""},100));disableButtonsDebounced=this._register(new zt(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100));getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};Ia=K([D(6,In),D(7,ct),D(8,kn),D(9,rt),D(10,sa)],Ia);var gR=class extends ha{_className=void 0;setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}updateTooltip(){}},fR=class extends bl{updateLabel(){let e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){let t=Jp("div.keybinding").root;this._register(new TS(t,mr,{disableTitle:!0,...lB})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}updateTooltip(){}},yb=class extends mu{constructor(t,n,i,r,s,a,l,d,c){super(t,{resetMenu:n,...i},r,s,a,l,d,c);this.menuId=n;this.options2=i;this.menuService=r;this.contextKeyService=s;this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0}));additionalActions=[];prependedPrimaryActions=[];updateToolbar(){let t=[],n=[];$_(this.menu,this.options2?.menuOptions,{primary:t,secondary:n},this.options2?.toolbarOptions?.primaryGroup,this.options2?.toolbarOptions?.shouldInlineSubmenu,this.options2?.toolbarOptions?.useSeparatorsInPrimaryActions),n.push(...this.additionalActions),t.unshift(...this.prependedPrimaryActions),this.setActions(t,n)}setPrependedPrimaryActions(t){Kt(this.prependedPrimaryActions,t,(n,i)=>n===i)||(this.prependedPrimaryActions=t,this.updateToolbar())}setAdditionalSecondaryActions(t){Kt(this.additionalActions,t,(n,i)=>n===i)||(this.additionalActions=t,this.updateToolbar())}};yb=K([D(3,sa),D(4,rt),D(5,fl),D(6,kn),D(7,In),D(8,sr)],yb);var dm=class extends W{constructor(t,n,i){super();this._editor=t;this._model=n;this._languageService=i;this._register(ge(()=>{this._isDisposed.set(!0,void 0)})),this._register(this._editorObs.setDecorations(this.decorations))}_isDisposed=qo(this,!1);_editorObs=oS(this._editor);_useSyntaxHighlighting=this._editorObs.getOption(63).map(t=>t.syntaxHighlightingEnabled);uiState=gn(this,t=>{if(this._isDisposed.read(t))return;let n=this._editorObs.model.read(t);if(n!==this._model.targetTextModel.read(t))return;let i=this._model.ghostText.read(t);if(!i)return;let r=i instanceof _h?i.columnRange:void 0,s=this._useSyntaxHighlighting.read(t),a=s?" syntax-highlighted":"",{inlineTexts:l,additionalLines:d,hiddenRange:c}=H9(i,n,"ghost-text"+a),u=new bc(l.map(b=>rr.insert(b.column-1,b.text))),p=s?n.tokenization.tokenizeLineWithEdit(i.lineNumber,new rp(u,d.map(b=>b.content))):void 0,m=u.getNewTextRanges(),g=l.map((b,v)=>({...b,tokens:p?.mainLineTokens?.getTokensInRange(m[v])})),f=d.map((b,v)=>({content:p?.additionalLines?.[v]??qt.createEmpty(b.content,this._languageService.languageIdCodec),decorations:b.decorations}));return{replacedRange:r,inlineTexts:g,additionalLines:f,hiddenRange:c,lineNumber:i.lineNumber,additionalReservedLineCount:this._model.minReservedLineCount.read(t),targetTextModel:n,syntaxHighlightingEnabled:s}});decorations=gn(this,t=>{let n=this.uiState.read(t);if(!n)return[];let i=[],r=n.syntaxHighlightingEnabled?" syntax-highlighted":"";n.replacedRange&&i.push({range:n.replacedRange.toRange(n.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace"+r,description:"GhostTextReplacement"}}),n.hiddenRange&&i.push({range:n.hiddenRange.toRange(n.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(let s of n.inlineTexts)i.push({range:w.fromPositions(new R(n.lineNumber,s.column)),options:{description:"ghost-text-decoration",after:{content:s.text,tokens:s.tokens,inlineClassName:s.preview?"ghost-text-decoration-preview":"ghost-text-decoration"+r,cursorStops:2},showIfCollapsed:!0}});return i});additionalLinesWidget=this._register(new bR(this._editor,gn(t=>{let n=this.uiState.read(t);return n?{lineNumber:n.lineNumber,additionalLines:n.additionalLines,minReservedLineCount:n.additionalReservedLineCount,targetTextModel:n.targetTextModel}:void 0})));ownsViewZone(t){return this.additionalLinesWidget.viewZoneId===t}};dm=K([D(2,Ki)],dm);function H9(o,e,t){let n=[],i=[];function r(c,u){if(i.length>0){let p=i[i.length-1];u&&p.decorations.push(new kr(p.content.length+1,p.content.length+1+c[0].length,u,0)),p.content+=c[0],c=c.slice(1)}for(let p of c)i.push({content:p,decorations:u?[new kr(1,p.length+1,u,0)]:[]})}let s=e.getLineContent(o.lineNumber),a,l=0;for(let c of o.parts){let u=c.lines;a===void 0?(n.push({column:c.column,text:u[0],preview:c.preview}),u=u.slice(1)):r([s.substring(l,c.column-1)],void 0),u.length>0&&(r(u,t),a===void 0&&c.column<=s.length&&(a=c.column)),l=c.column-1}a!==void 0&&r([s.substring(l)],void 0);let d=a!==void 0?new LS(a,s.length+1):void 0;return{inlineTexts:n,additionalLines:i,hiddenRange:d}}var bR=class extends W{constructor(t,n){super();this.editor=t;this.lines=n;this._register(Ht(i=>{let r=this.lines.read(i);this.editorOptionsChanged.read(i),r?this.updateLines(r.lineNumber,r.additionalLines,r.minReservedLineCount):this.clear()}))}_viewZoneId=void 0;get viewZoneId(){return this._viewZoneId}editorOptionsChanged=mm("editorOptionChanged",de.filter(this.editor.onDidChangeConfiguration,t=>t.hasChanged(33)||t.hasChanged(119)||t.hasChanged(101)||t.hasChanged(96)||t.hasChanged(52)||t.hasChanged(51)||t.hasChanged(68)));dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones(t=>{this._viewZoneId&&(t.removeZone(this._viewZoneId),this._viewZoneId=void 0)})}updateLines(t,n,i){let r=this.editor.getModel();if(!r)return;let{tabSize:s}=r.getOptions();this.editor.changeViewZones(a=>{this._viewZoneId&&(a.removeZone(this._viewZoneId),this._viewZoneId=void 0);let l=Math.max(n.length,i);if(l>0){let d=document.createElement("div");U9(d,s,n,this.editor.getOptions()),this._viewZoneId=a.addZone({afterLineNumber:t,heightInLines:l,domNode:d,afterColumnAffinity:1})}})}};function U9(o,e,t,n){let i=n.get(33),r=n.get(119),s="none",a=n.get(96),l=n.get(52),d=n.get(51),c=n.get(68),u=new Ha(1e4);u.appendString('<div class="suggest-preview-text">');for(let g=0,f=t.length;g<f;g++){let b=t[g],v=b.content;u.appendString('<div class="view-line'),u.appendString('" style="top:'),u.appendString(String(g*c)),u.appendString('px;width:1000000px;">');let I=v.getLineContent(),C=Qd(I),S=Wr(I);gx(new Ph(d.isMonospace&&!i,d.canUseHalfwidthRightwardsArrow,I,!1,C,S,0,v,b.decorations,e,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,r,s,a,l!==Va.OFF,null),u),u.appendString("</div>")}u.appendString("</div>"),Qt(o,d);let p=u.build(),m=oW?oW.createHTML(p):p;o.innerHTML=m}var oW=Ed("editorGhostText",{createHTML:o=>o});var Rd=class extends W{constructor(t,n,i,r,s,a,l,d,c,u){super();this.editor=t;this._instantiationService=n;this._contextKeyService=i;this._configurationService=r;this._commandService=s;this._debounceService=a;this._languageFeaturesService=l;this._accessibilitySignalService=d;this._keybindingService=c;this._accessibilityService=u;this._register(new xd(this._contextKeyService,this.model)),this._register(Rb(this._editorObs.onDidType,(m,g)=>{this._enabled.get()&&this.model.get()?.trigger()})),this._register(this._commandService.onDidExecuteCommand(m=>{new Set([Df.Tab.id,Df.DeleteLeft.id,Df.DeleteRight.id,dB,"acceptSelectedSuggestion"]).has(m.commandId)&&t.hasTextFocus()&&this._enabled.get()&&this._editorObs.forceUpdate(f=>{this.model.get()?.trigger(f)})})),this._register(Rb(this._editorObs.selections,(m,g)=>{g.some(f=>f.reason===3||f.source==="api")&&this.model.get()?.stop()})),this._register(this.editor.onDidBlurEditorWidget(()=>{this._contextKeyService.getContextKeyValue("accessibleViewIsShown")||this._configurationService.getValue("editor.inlineSuggest.keepOnBlur")||t.getOption(63).keepOnBlur||Ia.dropDownVisible||_o(m=>{this.model.get()?.stop(m)})})),this._register(Ht(m=>{let g=this.model.read(m)?.state.read(m);g?.suggestItem?g.primaryGhostText.lineCount>=2&&this._suggestWidgetAdaptor.forceRenderingAbove():this._suggestWidgetAdaptor.stopForceRenderingAbove()})),this._register(ge(()=>{this._suggestWidgetAdaptor.stopForceRenderingAbove()}));let p=gm(this,(m,g)=>{let b=this.model.read(m)?.state.read(m);return this._suggestWidgetSelectedItem.get()?g:b?.inlineCompletion?.semanticId});this._register(qR(gn(m=>(this._playAccessibilitySignal.read(m),p.read(m),{})),async(m,g,f)=>{let b=this.model.get(),v=b?.state.get();if(!v||!b)return;let I=b.textModel.getLineContent(v.primaryGhostText.lineNumber);await ao(50,Lw(f)),await Sw(this._suggestWidgetSelectedItem,ki,()=>!1,Lw(f)),await this._accessibilitySignalService.playSignal(tl.inlineSuggestion),this.editor.getOption(8)&&this._provideScreenReaderUpdate(v.primaryGhostText.renderForScreenReader(I))})),this._register(new lm(this.editor,this.model,this._instantiationService)),this._register(D2(gn(m=>{let g=this._fontFamily.read(m);return g===""||g==="default"?"":`
.monaco-editor .ghost-text-decoration,
.monaco-editor .ghost-text-decoration-preview,
.monaco-editor .ghost-text {
	font-family: ${g};
}`}))),this._register(this._configurationService.onDidChangeConfiguration(m=>{m.affectsConfiguration("accessibility.verbosity.inlineCompletions")&&this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})})),this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})}static ID="editor.contrib.inlineCompletionsController";static get(t){return t.getContribution(Rd.ID)}_editorObs=oS(this.editor);_positions=gn(this,t=>this._editorObs.selections.read(t)?.map(n=>n.getEndPosition())??[new R(1,1)]);_suggestWidgetAdaptor=this._register(new X_(this.editor,()=>(this._editorObs.forceUpdate(),this.model.get()?.selectedInlineCompletion.get()?.toSingleTextEdit(void 0)),t=>this._editorObs.forceUpdate(n=>{this.model.get()?.handleSuggestAccepted(t)})));_suggestWidgetSelectedItem=fn(this,t=>this._suggestWidgetAdaptor.onDidSelectedItemChange(()=>{this._editorObs.forceUpdate(n=>t(void 0))}),()=>this._suggestWidgetAdaptor.selectedItem);_enabledInConfig=fn(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).enabled);_isScreenReaderEnabled=fn(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized());_editorDictationInProgress=fn(this,this._contextKeyService.onDidChangeContext,()=>this._contextKeyService.getContext(this.editor.getDomNode()).getValue("editorDictation.inProgress")===!0);_enabled=gn(this,t=>this._enabledInConfig.read(t)&&(!this._isScreenReaderEnabled.read(t)||!this._editorDictationInProgress.read(t)));_debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50});model=bw(this,t=>{if(this._editorObs.isReadonly.read(t))return;let n=this._editorObs.model.read(t);return n?this._instantiationService.createInstance(rm,n,this._suggestWidgetSelectedItem,this._editorObs.versionId,this._positions,this._debounceValue,fn(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(120).preview),fn(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(120).previewMode),fn(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).mode),this._enabled):void 0}).recomputeInitiallyAndOnChange(this._store);_ghostTexts=gn(this,t=>this.model.read(t)?.ghostTexts.read(t)??[]);_stablizedGhostTexts=z9(this._ghostTexts,this._store);_ghostTextWidgets=jR(this,this._stablizedGhostTexts,(t,n)=>bw(i=>this._instantiationService.createInstance(N2(dm,i),this.editor,{ghostText:t,minReservedLineCount:Su(0),targetTextModel:this.model.map(r=>r?.textModel)})).recomputeInitiallyAndOnChange(n)).recomputeInitiallyAndOnChange(this._store);_playAccessibilitySignal=Vd(this);_fontFamily=fn(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).fontFamily);playAccessibilitySignal(t){this._playAccessibilitySignal.trigger(t)}_provideScreenReaderUpdate(t){let n=this._contextKeyService.getContextKeyValue("accessibleViewIsShown"),i=this._keybindingService.lookupKeybinding("editor.action.accessibleView"),r;!n&&i&&this.editor.getOption(151)&&(r=h("showAccessibleViewHint","Inspect this in the accessible view ({0})",i.getAriaLabel())),ua(r?t+", "+r:t)}shouldShowHoverAt(t){let n=this.model.get()?.primaryGhostText.get();return n?n.parts.some(i=>t.containsPosition(new R(n.lineNumber,i.column))):!1}shouldShowHoverAtViewZone(t){return this._ghostTextWidgets.get()[0]?.get().ownsViewZone(t)??!1}hide(){_o(t=>{this.model.get()?.stop(t)})}};Rd=K([D(1,ct),D(2,rt),D(3,tn),D(4,In),D(5,G0),D(6,Ho),D(7,FF),D(8,kn),D(9,Si)],Rd);function z9(o,e){let t=qo("result",[]),n=[];return e.add(Ht(i=>{let r=o.read(i);_o(s=>{if(r.length!==n.length){n.length=r.length;for(let a=0;a<n.length;a++)n[a]||(n[a]=qo("item",r[a]));t.set([...n],s)}n.forEach((a,l)=>a.set(r[l],s))})})),t}var Ib={id:Bt.AccessibleView,group:"navigation",when:Yi},Cb={id:Bt.CommandPalette,group:"",order:1},vR=class extends Oo{constructor(){super({id:"editor.action.accessibleViewNext",precondition:pe.and(Yi,sf),keybinding:{primary:606,weight:200},menu:[Cb,{...Ib,when:pe.and(Yi,sf)}],icon:le.arrowDown,title:h("editor.action.accessibleViewNext","Show Next in Accessible View")})}run(e){e.get(cr).next()}};Jr(vR);var yR=class extends Oo{constructor(){super({id:"editor.action.accessibleViewNextCodeBlock",precondition:pe.and(lf,pe.equals(af.key,"panelChat")),keybinding:{primary:2572,mac:{primary:2572},weight:200},icon:le.arrowRight,menu:{...Ib,when:pe.and(Yi,lf)},title:h("editor.action.accessibleViewNextCodeBlock","Accessible View: Next Code Block")})}run(e){e.get(cr).navigateToCodeBlock("next")}};Jr(yR);var IR=class extends Oo{constructor(){super({id:"editor.action.accessibleViewPreviousCodeBlock",precondition:pe.and(lf,pe.equals(af.key,"panelChat")),keybinding:{primary:2571,mac:{primary:2571},weight:200},icon:le.arrowLeft,menu:{...Ib,when:pe.and(Yi,lf)},title:h("editor.action.accessibleViewPreviousCodeBlock","Accessible View: Previous Code Block")})}run(e){e.get(cr).navigateToCodeBlock("previous")}};Jr(IR);var CR=class extends Oo{constructor(){super({id:"editor.action.accessibleViewPrevious",precondition:pe.and(Yi,sf),keybinding:{primary:604,weight:200},icon:le.arrowUp,menu:[Cb,{...Ib,when:pe.and(Yi,sf)}],title:h("editor.action.accessibleViewPrevious","Show Previous in Accessible View")})}run(e){e.get(cr).previous()}};Jr(CR);var SR=class extends Oo{constructor(){super({id:"editor.action.accessibleViewGoToSymbol",precondition:pe.and(pe.or(Yi,nl),Q1),keybinding:{primary:3117,secondary:[3161],weight:210},icon:le.symbolField,menu:[Cb,{...Ib,when:pe.and(pe.or(Yi,nl),Q1)}],title:h("editor.action.accessibleViewGoToSymbol","Go To Symbol in Accessible View")})}run(e){e.get(cr).goToSymbol()}};Jr(SR);function rW(o){return o.register(),o}var LR=rW(new md({id:"editor.action.accessibilityHelp",precondition:void 0,kbOpts:{primary:571,weight:200,linux:{primary:1595,secondary:[571]},kbExpr:nl.toNegated()},menuOpts:[{menuId:Bt.CommandPalette,group:"",title:h("editor.action.accessibilityHelp","Open Accessibility Help"),order:1}]})),sW=rW(new md({id:"editor.action.accessibleView",precondition:void 0,kbOpts:{primary:572,weight:200,linux:{primary:1596,secondary:[572]}},menuOpts:[{menuId:Bt.CommandPalette,group:"",title:h("editor.action.accessibleView","Open Accessible View"),order:1}]})),xR=class extends Oo{constructor(){super({id:"editor.action.accessibleViewDisableHint",precondition:pe.and(pe.or(Yi,nl),Y1),keybinding:{primary:576,weight:200},icon:le.bellSlash,menu:[Cb,{id:Bt.AccessibleView,group:"navigation",when:pe.and(pe.or(Yi,nl),Y1)}],title:h("editor.action.accessibleViewDisableHint","Disable Accessible View Hint")})}run(e){e.get(cr).disableHint()}};Jr(xR);var _R=class extends Oo{constructor(){super({id:"editor.action.accessibilityHelpConfigureKeybindings",precondition:pe.and(nl,Z1),icon:le.key,keybinding:{primary:553,weight:200},menu:[{id:Bt.AccessibleView,group:"navigation",order:3,when:Z1}],title:h("editor.action.accessibilityHelpConfigureUnassignedKeybindings","Accessibility Help Configure Unassigned Keybindings")})}async run(e){await e.get(cr).configureKeybindings(!0)}};Jr(_R);var wR=class extends Oo{constructor(){super({id:"editor.action.accessibilityHelpConfigureAssignedKeybindings",precondition:pe.and(nl,X1),icon:le.key,keybinding:{primary:543,weight:200},menu:[{id:Bt.AccessibleView,group:"navigation",order:4,when:X1}],title:h("editor.action.accessibilityHelpConfigureAssignedKeybindings","Accessibility Help Configure Assigned Keybindings")})}async run(e){await e.get(cr).configureKeybindings(!1)}};Jr(wR);var ER=class extends Oo{constructor(){super({id:"editor.action.accessibilityHelpOpenHelpLink",precondition:pe.and(nl),keybinding:{primary:550,weight:200},title:h("editor.action.accessibilityHelpOpenHelpLink","Accessibility Help Open Help Link")})}run(e){e.get(cr).openHelpLink()}};Jr(ER);var TR=class extends Oo{constructor(){super({id:"editor.action.accessibleViewAcceptInlineCompletion",precondition:pe.and(Yi,pe.equals(af.key,"inlineCompletions")),keybinding:{primary:2138,mac:{primary:346},weight:200},icon:le.check,menu:[Cb,{id:Bt.AccessibleView,group:"navigation",order:0,when:pe.and(Yi,pe.equals(af.key,"inlineCompletions"))}],title:h("editor.action.accessibleViewAcceptInlineCompletionAction","Accept Inline Completion")})}async run(e){let t=e.get(wr),n=t.getActiveCodeEditor()||t.getFocusedCodeEditor();if(!n)return;let i=Rd.get(n)?.model.get(),r=i?.state.get();!i||!r||(await i.accept(n),i.stop(),n.focus())}};Jr(TR);var aW=new class{_implementations=[];register(e){return this._implementations.push(e),{dispose:()=>{let t=this._implementations.indexOf(e);t!==-1&&this._implementations.splice(t,1)}}}getImplementations(){return this._implementations}};var lW=class extends W{static ID;constructor(){super(),this._register(LR.addImplementation(115,"accessible-view-help",e=>(e.get(cr).showAccessibleViewHelp(),!0),Yi))}},dW=class extends W{static ID;constructor(){super(),aW.getImplementations().forEach(e=>{let t=n=>{let i=e.getProvider(n);if(!i)return!1;try{return n.get(cr).show(i),!0}catch{return i.dispose(),!1}};e.type==="view"?this._register(sW.addImplementation(e.priority,e.name,t,e.when)):this._register(LR.addImplementation(e.priority,e.name,t,e.when))})}};export{dW as AccesibleViewContributions,lW as AccesibleViewHelpContribution};
