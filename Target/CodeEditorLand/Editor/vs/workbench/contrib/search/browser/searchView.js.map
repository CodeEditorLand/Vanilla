{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/search/browser/searchView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport { StandardKeyboardEvent } from \"../../../../base/browser/keyboardEvent.js\";\nimport * as aria from \"../../../../base/browser/ui/aria/aria.js\";\nimport { MessageType } from \"../../../../base/browser/ui/inputbox/inputBox.js\";\nimport type { IIdentityProvider } from \"../../../../base/browser/ui/list/list.js\";\nimport type { ICompressedTreeElement } from \"../../../../base/browser/ui/tree/compressedObjectTreeModel.js\";\nimport {\n\ttype ITreeContextMenuEvent,\n\tObjectTreeElementCollapseState,\n} from \"../../../../base/browser/ui/tree/tree.js\";\nimport { Delayer, RunOnceScheduler } from \"../../../../base/common/async.js\";\nimport * as errors from \"../../../../base/common/errors.js\";\nimport { Event } from \"../../../../base/common/event.js\";\nimport { Iterable } from \"../../../../base/common/iterator.js\";\nimport { KeyCode, KeyMod } from \"../../../../base/common/keyCodes.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n\ttype IDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport * as network from \"../../../../base/common/network.js\";\nimport * as env from \"../../../../base/common/platform.js\";\nimport * as strings from \"../../../../base/common/strings.js\";\nimport { URI } from \"../../../../base/common/uri.js\";\nimport \"./media/searchview.css\";\nimport { getDefaultHoverDelegate } from \"../../../../base/browser/ui/hover/hoverDelegateFactory.js\";\nimport { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport {\n\tgetCodeEditor,\n\tisCodeEditor,\n\tisDiffEditor,\n} from \"../../../../editor/browser/editorBrowser.js\";\nimport { ICodeEditorService } from \"../../../../editor/browser/services/codeEditorService.js\";\nimport { EmbeddedCodeEditorWidget } from \"../../../../editor/browser/widget/codeEditor/embeddedCodeEditorWidget.js\";\nimport type { IEditorOptions } from \"../../../../editor/common/config/editorOptions.js\";\nimport { Selection } from \"../../../../editor/common/core/selection.js\";\nimport type { IEditor } from \"../../../../editor/common/editorCommon.js\";\nimport { CommonFindController } from \"../../../../editor/contrib/find/browser/findController.js\";\nimport { MultiCursorSelectionController } from \"../../../../editor/contrib/multicursor/browser/multicursor.js\";\nimport * as nls from \"../../../../nls.js\";\nimport { IAccessibilityService } from \"../../../../platform/accessibility/common/accessibility.js\";\nimport {\n\tAccessibilitySignal,\n\tIAccessibilitySignalService,\n} from \"../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js\";\nimport { MenuId } from \"../../../../platform/actions/common/actions.js\";\nimport { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport {\n\ttype IConfigurationChangeEvent,\n\tIConfigurationService,\n} from \"../../../../platform/configuration/common/configuration.js\";\nimport {\n\ttype IContextKey,\n\tIContextKeyService,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport {\n\tIContextMenuService,\n\tIContextViewService,\n} from \"../../../../platform/contextview/browser/contextView.js\";\nimport {\n\ttype IConfirmation,\n\tIDialogService,\n} from \"../../../../platform/dialogs/common/dialogs.js\";\nimport {\n\tFileChangeType,\n\ttype FileChangesEvent,\n\tIFileService,\n} from \"../../../../platform/files/common/files.js\";\nimport { IHoverService } from \"../../../../platform/hover/browser/hover.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { ServiceCollection } from \"../../../../platform/instantiation/common/serviceCollection.js\";\nimport { IKeybindingService } from \"../../../../platform/keybinding/common/keybinding.js\";\nimport {\n\tWorkbenchCompressibleObjectTree,\n\tgetSelectionKeyboardEvent,\n} from \"../../../../platform/list/browser/listService.js\";\nimport { ILogService } from \"../../../../platform/log/common/log.js\";\nimport { INotificationService } from \"../../../../platform/notification/common/notification.js\";\nimport {\n\tIOpenerService,\n\twithSelection,\n} from \"../../../../platform/opener/common/opener.js\";\nimport {\n\ttype IProgress,\n\tIProgressService,\n\ttype IProgressStep,\n} from \"../../../../platform/progress/common/progress.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n} from \"../../../../platform/storage/common/storage.js\";\nimport { ITelemetryService } from \"../../../../platform/telemetry/common/telemetry.js\";\nimport {\n\tdefaultInputBoxStyles,\n\tdefaultToggleStyles,\n} from \"../../../../platform/theme/browser/defaultStyles.js\";\nimport {\n\ttype IFileIconTheme,\n\tIThemeService,\n} from \"../../../../platform/theme/common/themeService.js\";\nimport {\n\tIWorkspaceContextService,\n\tWorkbenchState,\n} from \"../../../../platform/workspace/common/workspace.js\";\nimport {\n\tOpenFileFolderAction,\n\tOpenFolderAction,\n} from \"../../../browser/actions/workspaceActions.js\";\nimport { ResourceListDnDHandler } from \"../../../browser/dnd.js\";\nimport { ResourceLabels } from \"../../../browser/labels.js\";\nimport {\n\ttype IViewPaneOptions,\n\tViewPane,\n} from \"../../../browser/parts/views/viewPane.js\";\nimport type { IEditorPane } from \"../../../common/editor.js\";\nimport { Memento, type MementoObject } from \"../../../common/memento.js\";\nimport { IViewDescriptorService } from \"../../../common/views.js\";\nimport {\n\tACTIVE_GROUP,\n\tIEditorService,\n\tSIDE_GROUP,\n} from \"../../../services/editor/common/editorService.js\";\nimport {\n\tIPreferencesService,\n\ttype ISettingsEditorOptions,\n} from \"../../../services/preferences/common/preferences.js\";\nimport {\n\ttype ITextQueryBuilderOptions,\n\tQueryBuilder,\n} from \"../../../services/search/common/queryBuilder.js\";\nimport {\n\ttype IPatternInfo,\n\ttype ISearchComplete,\n\ttype ISearchConfiguration,\n\ttype ISearchConfigurationProperties,\n\ttype ITextQuery,\n\tQueryType,\n\tSearchCompletionExitCode,\n\tSearchSortOrder,\n\tTextSearchCompleteMessageType,\n\tViewMode,\n} from \"../../../services/search/common/search.js\";\nimport type { TextSearchCompleteMessage } from \"../../../services/search/common/searchExtTypes.js\";\nimport { ITextFileService } from \"../../../services/textfile/common/textfiles.js\";\nimport { NotebookEditor } from \"../../notebook/browser/notebookEditor.js\";\nimport { INotebookService } from \"../../notebook/common/notebookService.js\";\nimport { createEditorFromSearchResult } from \"../../searchEditor/browser/searchEditorActions.js\";\nimport * as Constants from \"../common/constants.js\";\nimport {\n\tSearchStateKey,\n\tSearchUIState,\n\tgetOutOfWorkspaceEditorResources,\n} from \"../common/search.js\";\nimport {\n\tISearchHistoryService,\n\ttype ISearchHistoryValues,\n\tSearchHistoryService,\n} from \"../common/searchHistoryService.js\";\nimport {\n\tExcludePatternInputWidget,\n\tIncludePatternInputWidget,\n} from \"./patternInputWidget.js\";\nimport { IReplaceService } from \"./replace.js\";\nimport { appendKeyBindingLabel } from \"./searchActionsBase.js\";\nimport type { IFindInFilesArgs } from \"./searchActionsFind.js\";\nimport { searchDetailsIcon } from \"./searchIcons.js\";\nimport { renderSearchMessage } from \"./searchMessage.js\";\nimport {\n\tFileMatch,\n\ttype FileMatchOrMatch,\n\tFolderMatch,\n\tFolderMatchWithResource,\n\ttype IChangeEvent,\n\tISearchViewModelWorkbenchService,\n\tMatch,\n\tMatchInNotebook,\n\ttype RenderableMatch,\n\ttype SearchModel,\n\tSearchModelLocation,\n\tSearchResult,\n\tsearchMatchComparer,\n} from \"./searchModel.js\";\nimport {\n\tFileMatchRenderer,\n\tFolderMatchRenderer,\n\tMatchRenderer,\n\tSearchAccessibilityProvider,\n\tSearchDelegate,\n} from \"./searchResultsView.js\";\nimport { SearchWidget } from \"./searchWidget.js\";\n\nconst $ = dom.$;\n\nexport enum SearchViewPosition {\n\tSideBar = 0,\n\tPanel = 1,\n}\n\nconst SEARCH_CANCELLED_MESSAGE = nls.localize(\n\t\"searchCanceled\",\n\t\"Search was canceled before any results could be found - \",\n);\nconst DEBOUNCE_DELAY = 75;\nexport class SearchView extends ViewPane {\n\tprivate static readonly ACTIONS_RIGHT_CLASS_NAME = \"actions-right\";\n\n\tprivate isDisposed = false;\n\n\tprivate container!: HTMLElement;\n\tprivate queryBuilder: QueryBuilder;\n\tprivate viewModel: SearchModel;\n\tprivate memento: Memento;\n\n\tprivate viewletVisible: IContextKey<boolean>;\n\tprivate inputBoxFocused: IContextKey<boolean>;\n\tprivate inputPatternIncludesFocused: IContextKey<boolean>;\n\tprivate inputPatternExclusionsFocused: IContextKey<boolean>;\n\tprivate firstMatchFocused: IContextKey<boolean>;\n\tprivate fileMatchOrMatchFocused: IContextKey<boolean>;\n\tprivate fileMatchOrFolderMatchFocus: IContextKey<boolean>;\n\tprivate fileMatchOrFolderMatchWithResourceFocus: IContextKey<boolean>;\n\tprivate fileMatchFocused: IContextKey<boolean>;\n\tprivate folderMatchFocused: IContextKey<boolean>;\n\tprivate folderMatchWithResourceFocused: IContextKey<boolean>;\n\tprivate matchFocused: IContextKey<boolean>;\n\tprivate isEditableItem: IContextKey<boolean>;\n\tprivate hasSearchResultsKey: IContextKey<boolean>;\n\tprivate lastFocusState: \"input\" | \"tree\" = \"input\";\n\n\tprivate searchStateKey: IContextKey<SearchUIState>;\n\tprivate hasSearchPatternKey: IContextKey<boolean>;\n\tprivate hasReplacePatternKey: IContextKey<boolean>;\n\tprivate hasFilePatternKey: IContextKey<boolean>;\n\tprivate hasSomeCollapsibleResultKey: IContextKey<boolean>;\n\n\tprivate tree!: WorkbenchCompressibleObjectTree<RenderableMatch>;\n\tprivate treeLabels!: ResourceLabels;\n\tprivate viewletState: MementoObject;\n\tprivate messagesElement!: HTMLElement;\n\tprivate readonly messageDisposables: DisposableStore =\n\t\tnew DisposableStore();\n\tprivate searchWidgetsContainerElement!: HTMLElement;\n\tprivate searchWidget!: SearchWidget;\n\tprivate size!: dom.Dimension;\n\tprivate queryDetails!: HTMLElement;\n\tprivate toggleQueryDetailsButton!: HTMLElement;\n\tprivate inputPatternExcludes!: ExcludePatternInputWidget;\n\tprivate inputPatternIncludes!: IncludePatternInputWidget;\n\tprivate resultsElement!: HTMLElement;\n\n\tprivate currentSelectedFileMatch: FileMatch | undefined;\n\n\tprivate delayedRefresh: Delayer<void>;\n\tprivate changedWhileHidden: boolean;\n\n\tprivate searchWithoutFolderMessageElement: HTMLElement | undefined;\n\n\tprivate currentSearchQ = Promise.resolve();\n\tprivate addToSearchHistoryDelayer: Delayer<void>;\n\n\tprivate toggleCollapseStateDelayer: Delayer<void>;\n\n\tprivate triggerQueryDelayer: Delayer<void>;\n\tprivate pauseSearching = false;\n\n\tprivate treeAccessibilityProvider: SearchAccessibilityProvider;\n\n\tprivate treeViewKey: IContextKey<boolean>;\n\tprivate aiResultsVisibleKey: IContextKey<boolean>;\n\n\tprivate _visibleMatches = 0;\n\n\tprivate _refreshResultsScheduler: RunOnceScheduler;\n\n\tprivate _onSearchResultChangedDisposable: IDisposable | undefined;\n\n\tprivate _stashedQueryDetailsVisibility: boolean | undefined = undefined;\n\tprivate _stashedReplaceVisibility: boolean | undefined = undefined;\n\n\tconstructor(\n\t\toptions: IViewPaneOptions,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@ICodeEditorService\n\t\tprivate readonly codeEditorService: ICodeEditorService,\n\t\t@IProgressService private readonly progressService: IProgressService,\n\t\t@INotificationService\n\t\tprivate readonly notificationService: INotificationService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IContextViewService\n\t\tprivate readonly contextViewService: IContextViewService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IWorkspaceContextService\n\t\tprivate readonly contextService: IWorkspaceContextService,\n\t\t@ISearchViewModelWorkbenchService\n\t\tprivate readonly searchViewModelWorkbenchService: ISearchViewModelWorkbenchService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IReplaceService private readonly replaceService: IReplaceService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService,\n\t\t@IPreferencesService\n\t\tprivate readonly preferencesService: IPreferencesService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ISearchHistoryService\n\t\tprivate readonly searchHistoryService: ISearchHistoryService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IAccessibilityService\n\t\tprivate readonly accessibilityService: IAccessibilityService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@INotebookService private readonly notebookService: INotebookService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IAccessibilitySignalService\n\t\tprivate readonly accessibilitySignalService: IAccessibilitySignalService,\n\t) {\n\t\tsuper(\n\t\t\toptions,\n\t\t\tkeybindingService,\n\t\t\tcontextMenuService,\n\t\t\tconfigurationService,\n\t\t\tcontextKeyService,\n\t\t\tviewDescriptorService,\n\t\t\tinstantiationService,\n\t\t\topenerService,\n\t\t\tthemeService,\n\t\t\ttelemetryService,\n\t\t\thoverService,\n\t\t);\n\n\t\tthis.container = dom.$(\".search-view\");\n\n\t\t// globals\n\t\tthis.viewletVisible =\n\t\t\tConstants.SearchContext.SearchViewVisibleKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.firstMatchFocused =\n\t\t\tConstants.SearchContext.FirstMatchFocusKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.fileMatchOrMatchFocused =\n\t\t\tConstants.SearchContext.FileMatchOrMatchFocusKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.fileMatchOrFolderMatchFocus =\n\t\t\tConstants.SearchContext.FileMatchOrFolderMatchFocusKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.fileMatchOrFolderMatchWithResourceFocus =\n\t\t\tConstants.SearchContext.FileMatchOrFolderMatchWithResourceFocusKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.fileMatchFocused = Constants.SearchContext.FileFocusKey.bindTo(\n\t\t\tthis.contextKeyService,\n\t\t);\n\t\tthis.folderMatchFocused = Constants.SearchContext.FolderFocusKey.bindTo(\n\t\t\tthis.contextKeyService,\n\t\t);\n\t\tthis.folderMatchWithResourceFocused =\n\t\t\tConstants.SearchContext.ResourceFolderFocusKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.hasSearchResultsKey =\n\t\t\tConstants.SearchContext.HasSearchResults.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.matchFocused = Constants.SearchContext.MatchFocusKey.bindTo(\n\t\t\tthis.contextKeyService,\n\t\t);\n\t\tthis.searchStateKey = SearchStateKey.bindTo(this.contextKeyService);\n\t\tthis.hasSearchPatternKey =\n\t\t\tConstants.SearchContext.ViewHasSearchPatternKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.hasReplacePatternKey =\n\t\t\tConstants.SearchContext.ViewHasReplacePatternKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.hasFilePatternKey =\n\t\t\tConstants.SearchContext.ViewHasFilePatternKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.hasSomeCollapsibleResultKey =\n\t\t\tConstants.SearchContext.ViewHasSomeCollapsibleKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.treeViewKey = Constants.SearchContext.InTreeViewKey.bindTo(\n\t\t\tthis.contextKeyService,\n\t\t);\n\t\tthis.aiResultsVisibleKey =\n\t\t\tConstants.SearchContext.AIResultsVisibleKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\n\t\tthis._register(\n\t\t\tthis.contextKeyService.onDidChangeContext((e) => {\n\t\t\t\tconst keys = Constants.SearchContext.hasAIResultProvider.keys();\n\t\t\t\tif (e.affectsSome(new Set(keys))) {\n\t\t\t\t\tthis.refreshHasAISetting();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\t// scoped\n\t\tthis.contextKeyService = this._register(\n\t\t\tthis.contextKeyService.createScoped(this.container),\n\t\t);\n\t\tConstants.SearchContext.SearchViewFocusedKey.bindTo(\n\t\t\tthis.contextKeyService,\n\t\t).set(true);\n\t\tthis.inputBoxFocused =\n\t\t\tConstants.SearchContext.InputBoxFocusedKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.inputPatternIncludesFocused =\n\t\t\tConstants.SearchContext.PatternIncludesFocusedKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.inputPatternExclusionsFocused =\n\t\t\tConstants.SearchContext.PatternExcludesFocusedKey.bindTo(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\tthis.isEditableItem = Constants.SearchContext.IsEditableItemKey.bindTo(\n\t\t\tthis.contextKeyService,\n\t\t);\n\n\t\tthis.instantiationService = this._register(\n\t\t\tthis.instantiationService.createChild(\n\t\t\t\tnew ServiceCollection([\n\t\t\t\t\tIContextKeyService,\n\t\t\t\t\tthis.contextKeyService,\n\t\t\t\t]),\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.configurationService.onDidChangeConfiguration((e) => {\n\t\t\t\tif (e.affectsConfiguration(\"search.sortOrder\")) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.searchConfig.sortOrder === SearchSortOrder.Modified\n\t\t\t\t\t) {\n\t\t\t\t\t\t// If changing away from modified, remove all fileStats\n\t\t\t\t\t\t// so that updated files are re-retrieved next time.\n\t\t\t\t\t\tthis.removeFileStats();\n\t\t\t\t\t}\n\t\t\t\t\tthis.refreshTree();\n\t\t\t\t} else if (e.affectsConfiguration(\"search.aiResults\")) {\n\t\t\t\t\tthis.refreshHasAISetting();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis.viewModel = this.searchViewModelWorkbenchService.searchModel;\n\t\tthis.queryBuilder =\n\t\t\tthis.instantiationService.createInstance(QueryBuilder);\n\t\tthis.memento = new Memento(this.id, storageService);\n\t\tthis.viewletState = this.memento.getMemento(\n\t\t\tStorageScope.WORKSPACE,\n\t\t\tStorageTarget.MACHINE,\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.fileService.onDidFilesChange((e) => this.onFilesChanged(e)),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.textFileService.untitled.onWillDispose((model) =>\n\t\t\t\tthis.onUntitledDidDispose(model.resource),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.contextService.onDidChangeWorkbenchState(() =>\n\t\t\t\tthis.onDidChangeWorkbenchState(),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.searchHistoryService.onDidClearHistory(() =>\n\t\t\t\tthis.clearHistory(),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.configurationService.onDidChangeConfiguration((e) =>\n\t\t\t\tthis.onConfigurationUpdated(e),\n\t\t\t),\n\t\t);\n\n\t\tthis.delayedRefresh = this._register(new Delayer<void>(250));\n\n\t\tthis.addToSearchHistoryDelayer = this._register(\n\t\t\tnew Delayer<void>(2000),\n\t\t);\n\t\tthis.toggleCollapseStateDelayer = this._register(\n\t\t\tnew Delayer<void>(100),\n\t\t);\n\t\tthis.triggerQueryDelayer = this._register(new Delayer<void>(0));\n\n\t\tthis.treeAccessibilityProvider =\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tSearchAccessibilityProvider,\n\t\t\t\tthis,\n\t\t\t);\n\t\tthis.isTreeLayoutViewVisible =\n\t\t\tthis.viewletState[\"view.treeLayout\"] ??\n\t\t\tthis.searchConfig.defaultViewMode === ViewMode.Tree;\n\n\t\tthis._refreshResultsScheduler = this._register(\n\t\t\tnew RunOnceScheduler(this._updateResults.bind(this), 80),\n\t\t);\n\n\t\t// storage service listener for for roaming changes\n\t\tthis._register(\n\t\t\tthis.storageService.onWillSaveState(() => {\n\t\t\t\tthis._saveSearchHistoryService();\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.storageService.onDidChangeValue(\n\t\t\t\tStorageScope.WORKSPACE,\n\t\t\t\tSearchHistoryService.SEARCH_HISTORY_KEY,\n\t\t\t\tthis._register(new DisposableStore()),\n\t\t\t)(() => {\n\t\t\t\tconst restoredHistory = this.searchHistoryService.load();\n\n\t\t\t\tif (restoredHistory.include) {\n\t\t\t\t\tthis.inputPatternIncludes.prependHistory(\n\t\t\t\t\t\trestoredHistory.include,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (restoredHistory.exclude) {\n\t\t\t\t\tthis.inputPatternExcludes.prependHistory(\n\t\t\t\t\t\trestoredHistory.exclude,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (restoredHistory.search) {\n\t\t\t\t\tthis.searchWidget.prependSearchHistory(\n\t\t\t\t\t\trestoredHistory.search,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (restoredHistory.replace) {\n\t\t\t\t\tthis.searchWidget.prependReplaceHistory(\n\t\t\t\t\t\trestoredHistory.replace,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis.changedWhileHidden = this.hasSearchResults();\n\t}\n\n\tget isTreeLayoutViewVisible(): boolean {\n\t\treturn this.treeViewKey.get() ?? false;\n\t}\n\n\tprivate set isTreeLayoutViewVisible(visible: boolean) {\n\t\tthis.treeViewKey.set(visible);\n\t}\n\n\tget aiResultsVisible(): boolean {\n\t\treturn this.aiResultsVisibleKey.get() ?? false;\n\t}\n\n\tprivate set aiResultsVisible(visible: boolean) {\n\t\tthis.aiResultsVisibleKey.set(visible);\n\t}\n\n\tsetTreeView(visible: boolean): void {\n\t\tif (visible === this.isTreeLayoutViewVisible) {\n\t\t\treturn;\n\t\t}\n\t\tthis.isTreeLayoutViewVisible = visible;\n\t\tthis.updateIndentStyles(this.themeService.getFileIconTheme());\n\t\tthis.refreshTree();\n\t}\n\n\tasync setAIResultsVisible(visible: boolean): Promise<void> {\n\t\tif (visible === this.aiResultsVisible) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (visible) {\n\t\t\tthis._stashedQueryDetailsVisibility = this._queryDetailsHidden();\n\t\t\tthis._stashedReplaceVisibility = this.searchWidget.isReplaceShown();\n\n\t\t\tthis.searchWidget.toggleReplace(false);\n\t\t\tthis.toggleQueryDetailsButton.style.display = \"none\";\n\n\t\t\tthis.searchWidget.replaceButtonVisibility = false;\n\t\t\tthis.toggleQueryDetails(undefined, false);\n\t\t} else {\n\t\t\tthis.toggleQueryDetailsButton.style.display = \"\";\n\t\t\tthis.searchWidget.replaceButtonVisibility = true;\n\n\t\t\tif (this._stashedReplaceVisibility) {\n\t\t\t\tthis.searchWidget.toggleReplace(this._stashedReplaceVisibility);\n\t\t\t}\n\n\t\t\tif (this._stashedQueryDetailsVisibility) {\n\t\t\t\tthis.toggleQueryDetails(\n\t\t\t\t\tundefined,\n\t\t\t\t\tthis._stashedQueryDetailsVisibility,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.aiResultsVisible = visible;\n\n\t\tif (this.viewModel.searchResult.isEmpty()) {\n\t\t\treturn;\n\t\t}\n\n\t\t// in each case, we want to cancel our current AI search because it is no longer valid\n\t\tthis.model.cancelAISearch();\n\t\tif (visible) {\n\t\t\tawait this.model.addAIResults();\n\t\t}\n\n\t\tthis.onSearchResultsChanged();\n\t\tthis.onSearchComplete(\n\t\t\t() => {},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tthis.viewModel.searchResult.getCachedSearchComplete(visible),\n\t\t);\n\t}\n\n\tprivate get state(): SearchUIState {\n\t\treturn this.searchStateKey.get() ?? SearchUIState.Idle;\n\t}\n\n\tprivate set state(v: SearchUIState) {\n\t\tthis.searchStateKey.set(v);\n\t}\n\n\tgetContainer(): HTMLElement {\n\t\treturn this.container;\n\t}\n\n\tget searchResult(): SearchResult {\n\t\treturn this.viewModel && this.viewModel.searchResult;\n\t}\n\n\tget model(): SearchModel {\n\t\treturn this.viewModel;\n\t}\n\n\tprivate refreshHasAISetting() {\n\t\tconst val = this.shouldShowAIButton();\n\t\tif (val && this.searchWidget.searchInput) {\n\t\t\tthis.searchWidget.searchInput.sparkleVisible = val;\n\t\t}\n\t}\n\tprivate onDidChangeWorkbenchState(): void {\n\t\tif (\n\t\t\tthis.contextService.getWorkbenchState() !== WorkbenchState.EMPTY &&\n\t\t\tthis.searchWithoutFolderMessageElement\n\t\t) {\n\t\t\tdom.hide(this.searchWithoutFolderMessageElement);\n\t\t}\n\t}\n\n\tprivate refreshInputs() {\n\t\tthis.pauseSearching = true;\n\t\tthis.searchWidget.setValue(\n\t\t\tthis.viewModel.searchResult.query?.contentPattern.pattern ?? \"\",\n\t\t);\n\t\tthis.searchWidget.setReplaceAllActionState(false);\n\t\tthis.searchWidget.toggleReplace(true);\n\t\tthis.inputPatternIncludes.setOnlySearchInOpenEditors(\n\t\t\tthis.viewModel.searchResult.query?.onlyOpenEditors || false,\n\t\t);\n\t\tthis.inputPatternExcludes.setUseExcludesAndIgnoreFiles(\n\t\t\t!this.viewModel.searchResult.query\n\t\t\t\t?.userDisabledExcludesAndIgnoreFiles || true,\n\t\t);\n\t\tthis.searchIncludePattern.setValue(\"\");\n\t\tthis.searchExcludePattern.setValue(\"\");\n\t\tthis.pauseSearching = false;\n\t}\n\n\tpublic async replaceSearchModel(\n\t\tsearchModel: SearchModel,\n\t\tasyncResults: Promise<ISearchComplete>,\n\t): Promise<void> {\n\t\tlet progressComplete: () => void;\n\t\tthis.progressService.withProgress(\n\t\t\t{ location: this.getProgressLocation(), delay: 0 },\n\t\t\t(_progress) => {\n\t\t\t\treturn new Promise<void>(\n\t\t\t\t\t(resolve) => (progressComplete = resolve),\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\tconst slowTimer = setTimeout(() => {\n\t\t\tthis.state = SearchUIState.SlowSearch;\n\t\t}, 2000);\n\n\t\tthis._refreshResultsScheduler.schedule();\n\n\t\t// remove old model and use the new searchModel\n\t\tsearchModel.location = SearchModelLocation.PANEL;\n\t\tsearchModel.replaceActive = this.viewModel.isReplaceActive();\n\t\tsearchModel.replaceString = this.searchWidget.getReplaceValue();\n\t\tthis._onSearchResultChangedDisposable?.dispose();\n\t\tthis._onSearchResultChangedDisposable = this._register(\n\t\t\tsearchModel.onSearchResultChanged((event) =>\n\t\t\t\tthis.onSearchResultsChanged(event),\n\t\t\t),\n\t\t);\n\n\t\t// this call will also dispose of the old model\n\t\tthis.searchViewModelWorkbenchService.searchModel = searchModel;\n\t\tthis.viewModel = searchModel;\n\n\t\tthis.onSearchResultsChanged();\n\t\tthis.refreshInputs();\n\n\t\tasyncResults.then(\n\t\t\t(complete) => {\n\t\t\t\tclearTimeout(slowTimer);\n\t\t\t\tthis.onSearchComplete(\n\t\t\t\t\tprogressComplete,\n\t\t\t\t\tundefined,\n\t\t\t\t\tundefined,\n\t\t\t\t\tcomplete,\n\t\t\t\t);\n\t\t\t},\n\t\t\t(e) => {\n\t\t\t\tclearTimeout(slowTimer);\n\t\t\t\tthis.onSearchError(e, progressComplete, undefined, undefined);\n\t\t\t},\n\t\t);\n\n\t\tconst collapseResults = this.searchConfig.collapseResults;\n\t\tif (\n\t\t\tcollapseResults !== \"alwaysCollapse\" &&\n\t\t\tthis.viewModel.searchResult.matches(this.aiResultsVisible)\n\t\t\t\t.length === 1\n\t\t) {\n\t\t\tconst onlyMatch = this.viewModel.searchResult.matches(\n\t\t\t\tthis.aiResultsVisible,\n\t\t\t)[0];\n\t\t\tif (onlyMatch.count() < 50) {\n\t\t\t\tthis.tree.expand(onlyMatch);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected override renderBody(parent: HTMLElement): void {\n\t\tsuper.renderBody(parent);\n\t\tthis.container = dom.append(parent, dom.$(\".search-view\"));\n\n\t\tthis.searchWidgetsContainerElement = dom.append(\n\t\t\tthis.container,\n\t\t\t$(\".search-widgets-container\"),\n\t\t);\n\t\tthis.createSearchWidget(this.searchWidgetsContainerElement);\n\t\tthis.refreshHasAISetting();\n\n\t\tconst history = this.searchHistoryService.load();\n\t\tconst filePatterns = this.viewletState[\"query.filePatterns\"] || \"\";\n\t\tconst patternExclusions =\n\t\t\tthis.viewletState[\"query.folderExclusions\"] || \"\";\n\t\tconst patternExclusionsHistory: string[] = history.exclude || [];\n\t\tconst patternIncludes = this.viewletState[\"query.folderIncludes\"] || \"\";\n\t\tconst patternIncludesHistory: string[] = history.include || [];\n\t\tconst onlyOpenEditors =\n\t\t\tthis.viewletState[\"query.onlyOpenEditors\"] || false;\n\n\t\tconst queryDetailsExpanded =\n\t\t\tthis.viewletState[\"query.queryDetailsExpanded\"] || \"\";\n\t\tconst useExcludesAndIgnoreFiles =\n\t\t\ttypeof this.viewletState[\"query.useExcludesAndIgnoreFiles\"] ===\n\t\t\t\"boolean\"\n\t\t\t\t? this.viewletState[\"query.useExcludesAndIgnoreFiles\"]\n\t\t\t\t: true;\n\n\t\tthis.queryDetails = dom.append(\n\t\t\tthis.searchWidgetsContainerElement,\n\t\t\t$(\".query-details\"),\n\t\t);\n\n\t\t// Toggle query details button\n\t\tconst toggleQueryDetailsLabel = nls.localize(\n\t\t\t\"moreSearch\",\n\t\t\t\"Toggle Search Details\",\n\t\t);\n\t\tthis.toggleQueryDetailsButton = dom.append(\n\t\t\tthis.queryDetails,\n\t\t\t$(\".more\" + ThemeIcon.asCSSSelector(searchDetailsIcon), {\n\t\t\t\ttabindex: 0,\n\t\t\t\trole: \"button\",\n\t\t\t\t\"aria-label\": toggleQueryDetailsLabel,\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.hoverService.setupManagedHover(\n\t\t\t\tgetDefaultHoverDelegate(\"element\"),\n\t\t\t\tthis.toggleQueryDetailsButton,\n\t\t\t\ttoggleQueryDetailsLabel,\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tthis.toggleQueryDetailsButton,\n\t\t\t\tdom.EventType.CLICK,\n\t\t\t\t(e) => {\n\t\t\t\t\tdom.EventHelper.stop(e);\n\t\t\t\t\tthis.toggleQueryDetails(\n\t\t\t\t\t\t!this.accessibilityService.isScreenReaderOptimized(),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tthis.toggleQueryDetailsButton,\n\t\t\t\tdom.EventType.KEY_UP,\n\t\t\t\t(e: KeyboardEvent) => {\n\t\t\t\t\tconst event = new StandardKeyboardEvent(e);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tevent.equals(KeyCode.Enter) ||\n\t\t\t\t\t\tevent.equals(KeyCode.Space)\n\t\t\t\t\t) {\n\t\t\t\t\t\tdom.EventHelper.stop(e);\n\t\t\t\t\t\tthis.toggleQueryDetails(false);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tthis.toggleQueryDetailsButton,\n\t\t\t\tdom.EventType.KEY_DOWN,\n\t\t\t\t(e: KeyboardEvent) => {\n\t\t\t\t\tconst event = new StandardKeyboardEvent(e);\n\n\t\t\t\t\tif (event.equals(KeyMod.Shift | KeyCode.Tab)) {\n\t\t\t\t\t\tif (this.searchWidget.isReplaceActive()) {\n\t\t\t\t\t\t\tthis.searchWidget.focusReplaceAllAction();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.searchWidget.isReplaceShown()\n\t\t\t\t\t\t\t\t? this.searchWidget.replaceInput?.focusOnPreserve()\n\t\t\t\t\t\t\t\t: this.searchWidget.focusRegexAction();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdom.EventHelper.stop(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\t// folder includes list\n\t\tconst folderIncludesList = dom.append(\n\t\t\tthis.queryDetails,\n\t\t\t$(\".file-types.includes\"),\n\t\t);\n\t\tconst filesToIncludeTitle = nls.localize(\n\t\t\t\"searchScope.includes\",\n\t\t\t\"files to include\",\n\t\t);\n\t\tdom.append(folderIncludesList, $(\"h4\", undefined, filesToIncludeTitle));\n\n\t\tthis.inputPatternIncludes = this._register(\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tIncludePatternInputWidget,\n\t\t\t\tfolderIncludesList,\n\t\t\t\tthis.contextViewService,\n\t\t\t\t{\n\t\t\t\t\tariaLabel: filesToIncludeTitle,\n\t\t\t\t\tplaceholder: nls.localize(\n\t\t\t\t\t\t\"placeholder.includes\",\n\t\t\t\t\t\t\"e.g. *.ts, src/**/include\",\n\t\t\t\t\t),\n\t\t\t\t\tshowPlaceholderOnFocus: true,\n\t\t\t\t\thistory: patternIncludesHistory,\n\t\t\t\t\tinputBoxStyles: defaultInputBoxStyles,\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tthis.inputPatternIncludes.setValue(patternIncludes);\n\t\tthis.inputPatternIncludes.setOnlySearchInOpenEditors(onlyOpenEditors);\n\n\t\tthis._register(\n\t\t\tthis.inputPatternIncludes.onCancel(() => this.cancelSearch(false)),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.inputPatternIncludes.onChangeSearchInEditorsBox(() =>\n\t\t\t\tthis.triggerQueryChange(),\n\t\t\t),\n\t\t);\n\n\t\tthis.trackInputBox(\n\t\t\tthis.inputPatternIncludes.inputFocusTracker,\n\t\t\tthis.inputPatternIncludesFocused,\n\t\t);\n\n\t\t// excludes list\n\t\tconst excludesList = dom.append(\n\t\t\tthis.queryDetails,\n\t\t\t$(\".file-types.excludes\"),\n\t\t);\n\t\tconst excludesTitle = nls.localize(\n\t\t\t\"searchScope.excludes\",\n\t\t\t\"files to exclude\",\n\t\t);\n\t\tdom.append(excludesList, $(\"h4\", undefined, excludesTitle));\n\t\tthis.inputPatternExcludes = this._register(\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tExcludePatternInputWidget,\n\t\t\t\texcludesList,\n\t\t\t\tthis.contextViewService,\n\t\t\t\t{\n\t\t\t\t\tariaLabel: excludesTitle,\n\t\t\t\t\tplaceholder: nls.localize(\n\t\t\t\t\t\t\"placeholder.excludes\",\n\t\t\t\t\t\t\"e.g. *.ts, src/**/exclude\",\n\t\t\t\t\t),\n\t\t\t\t\tshowPlaceholderOnFocus: true,\n\t\t\t\t\thistory: patternExclusionsHistory,\n\t\t\t\t\tinputBoxStyles: defaultInputBoxStyles,\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tthis.inputPatternExcludes.setValue(patternExclusions);\n\t\tthis.inputPatternExcludes.setUseExcludesAndIgnoreFiles(\n\t\t\tuseExcludesAndIgnoreFiles,\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.inputPatternExcludes.onCancel(() => this.cancelSearch(false)),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.inputPatternExcludes.onChangeIgnoreBox(() =>\n\t\t\t\tthis.triggerQueryChange(),\n\t\t\t),\n\t\t);\n\t\tthis.trackInputBox(\n\t\t\tthis.inputPatternExcludes.inputFocusTracker,\n\t\t\tthis.inputPatternExclusionsFocused,\n\t\t);\n\n\t\tconst updateHasFilePatternKey = () =>\n\t\t\tthis.hasFilePatternKey.set(\n\t\t\t\tthis.inputPatternIncludes.getValue().length > 0 ||\n\t\t\t\t\tthis.inputPatternExcludes.getValue().length > 0,\n\t\t\t);\n\t\tupdateHasFilePatternKey();\n\t\tconst onFilePatternSubmit = (triggeredOnType: boolean) => {\n\t\t\tthis.triggerQueryChange({\n\t\t\t\ttriggeredOnType,\n\t\t\t\tdelay: this.searchConfig.searchOnTypeDebouncePeriod,\n\t\t\t});\n\t\t\tif (triggeredOnType) {\n\t\t\t\tupdateHasFilePatternKey();\n\t\t\t}\n\t\t};\n\t\tthis._register(this.inputPatternIncludes.onSubmit(onFilePatternSubmit));\n\t\tthis._register(this.inputPatternExcludes.onSubmit(onFilePatternSubmit));\n\n\t\tthis.messagesElement = dom.append(\n\t\t\tthis.container,\n\t\t\t$(\".messages.text-search-provider-messages\"),\n\t\t);\n\t\tif (this.contextService.getWorkbenchState() === WorkbenchState.EMPTY) {\n\t\t\tthis.showSearchWithoutFolderMessage();\n\t\t}\n\n\t\tthis.createSearchResultsView(this.container);\n\n\t\tif (\n\t\t\tfilePatterns !== \"\" ||\n\t\t\tpatternExclusions !== \"\" ||\n\t\t\tpatternIncludes !== \"\" ||\n\t\t\tqueryDetailsExpanded !== \"\" ||\n\t\t\t!useExcludesAndIgnoreFiles\n\t\t) {\n\t\t\tthis.toggleQueryDetails(true, true, true);\n\t\t}\n\n\t\tthis._onSearchResultChangedDisposable = this._register(\n\t\t\tthis.viewModel.onSearchResultChanged((event) =>\n\t\t\t\tthis.onSearchResultsChanged(event),\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.onDidChangeBodyVisibility((visible) =>\n\t\t\t\tthis.onVisibilityChanged(visible),\n\t\t\t),\n\t\t);\n\n\t\tthis.updateIndentStyles(this.themeService.getFileIconTheme());\n\t\tthis._register(\n\t\t\tthis.themeService.onDidFileIconThemeChange(\n\t\t\t\tthis.updateIndentStyles,\n\t\t\t\tthis,\n\t\t\t),\n\t\t);\n\t}\n\n\tprivate updateIndentStyles(theme: IFileIconTheme): void {\n\t\tthis.resultsElement.classList.toggle(\n\t\t\t\"hide-arrows\",\n\t\t\tthis.isTreeLayoutViewVisible && theme.hidesExplorerArrows,\n\t\t);\n\t}\n\n\tprivate onVisibilityChanged(visible: boolean): void {\n\t\tthis.viewletVisible.set(visible);\n\t\tif (visible) {\n\t\t\tif (this.changedWhileHidden) {\n\t\t\t\t// Render if results changed while viewlet was hidden - #37818\n\t\t\t\tthis.refreshAndUpdateCount();\n\t\t\t\tthis.changedWhileHidden = false;\n\t\t\t}\n\t\t} else {\n\t\t\t// Reset last focus to input to preserve opening the viewlet always focusing the query editor.\n\t\t\tthis.lastFocusState = \"input\";\n\t\t}\n\n\t\t// Enable highlights if there are searchresults\n\t\tthis.viewModel?.searchResult.toggleHighlights(visible);\n\t}\n\n\tget searchAndReplaceWidget(): SearchWidget {\n\t\treturn this.searchWidget;\n\t}\n\n\tget searchIncludePattern(): IncludePatternInputWidget {\n\t\treturn this.inputPatternIncludes;\n\t}\n\n\tget searchExcludePattern(): ExcludePatternInputWidget {\n\t\treturn this.inputPatternExcludes;\n\t}\n\n\tprivate createSearchWidget(container: HTMLElement): void {\n\t\tconst contentPattern = this.viewletState[\"query.contentPattern\"] || \"\";\n\t\tconst replaceText = this.viewletState[\"query.replaceText\"] || \"\";\n\t\tconst isRegex = this.viewletState[\"query.regex\"] === true;\n\t\tconst isWholeWords = this.viewletState[\"query.wholeWords\"] === true;\n\t\tconst isCaseSensitive =\n\t\t\tthis.viewletState[\"query.caseSensitive\"] === true;\n\t\tconst history = this.searchHistoryService.load();\n\t\tconst searchHistory =\n\t\t\thistory.search || this.viewletState[\"query.searchHistory\"] || [];\n\t\tconst replaceHistory =\n\t\t\thistory.replace || this.viewletState[\"query.replaceHistory\"] || [];\n\t\tconst showReplace =\n\t\t\ttypeof this.viewletState[\"view.showReplace\"] === \"boolean\"\n\t\t\t\t? this.viewletState[\"view.showReplace\"]\n\t\t\t\t: true;\n\t\tconst preserveCase = this.viewletState[\"query.preserveCase\"] === true;\n\n\t\tconst isInNotebookMarkdownInput =\n\t\t\tthis.viewletState[\"query.isInNotebookMarkdownInput\"] ?? true;\n\t\tconst isInNotebookMarkdownPreview =\n\t\t\tthis.viewletState[\"query.isInNotebookMarkdownPreview\"] ?? true;\n\t\tconst isInNotebookCellInput =\n\t\t\tthis.viewletState[\"query.isInNotebookCellInput\"] ?? true;\n\t\tconst isInNotebookCellOutput =\n\t\t\tthis.viewletState[\"query.isInNotebookCellOutput\"] ?? true;\n\n\t\tthis.searchWidget = this._register(\n\t\t\tthis.instantiationService.createInstance(SearchWidget, container, {\n\t\t\t\tvalue: contentPattern,\n\t\t\t\treplaceValue: replaceText,\n\t\t\t\tisRegex: isRegex,\n\t\t\t\tisCaseSensitive: isCaseSensitive,\n\t\t\t\tisWholeWords: isWholeWords,\n\t\t\t\tsearchHistory: searchHistory,\n\t\t\t\treplaceHistory: replaceHistory,\n\t\t\t\tpreserveCase: preserveCase,\n\t\t\t\tinputBoxStyles: defaultInputBoxStyles,\n\t\t\t\ttoggleStyles: defaultToggleStyles,\n\t\t\t\tnotebookOptions: {\n\t\t\t\t\tisInNotebookMarkdownInput,\n\t\t\t\t\tisInNotebookMarkdownPreview,\n\t\t\t\t\tisInNotebookCellInput,\n\t\t\t\t\tisInNotebookCellOutput,\n\t\t\t\t},\n\t\t\t\tinitialAIButtonVisibility: this.shouldShowAIButton(),\n\t\t\t}),\n\t\t);\n\n\t\tif (!this.searchWidget.searchInput || !this.searchWidget.replaceInput) {\n\t\t\tthis.logService.warn(\n\t\t\t\t`Cannot fully create search widget. Search or replace input undefined. SearchInput: ${this.searchWidget.searchInput}, ReplaceInput: ${this.searchWidget.replaceInput}`,\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tif (showReplace) {\n\t\t\tthis.searchWidget.toggleReplace(true);\n\t\t}\n\n\t\tthis._register(\n\t\t\tthis.searchWidget.onSearchSubmit((options) =>\n\t\t\t\tthis.triggerQueryChange(options),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.searchWidget.onSearchCancel(({ focus }) =>\n\t\t\t\tthis.cancelSearch(focus),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.searchWidget.searchInput.onDidOptionChange(() => {\n\t\t\t\tif (\n\t\t\t\t\tthis.searchWidget.searchInput &&\n\t\t\t\t\tthis.searchWidget.searchInput.isAIEnabled !==\n\t\t\t\t\t\tthis.aiResultsVisible\n\t\t\t\t) {\n\t\t\t\t\tthis.setAIResultsVisible(\n\t\t\t\t\t\tthis.searchWidget.searchInput.isAIEnabled,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tthis.triggerQueryChange();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.searchWidget\n\t\t\t\t.getNotebookFilters()\n\t\t\t\t.onDidChange(() => this.triggerQueryChange()),\n\t\t);\n\n\t\tconst updateHasPatternKey = () =>\n\t\t\tthis.hasSearchPatternKey.set(\n\t\t\t\tthis.searchWidget.searchInput\n\t\t\t\t\t? this.searchWidget.searchInput.getValue().length > 0\n\t\t\t\t\t: false,\n\t\t\t);\n\t\tupdateHasPatternKey();\n\t\tthis._register(\n\t\t\tthis.searchWidget.searchInput.onDidChange(() =>\n\t\t\t\tupdateHasPatternKey(),\n\t\t\t),\n\t\t);\n\n\t\tconst updateHasReplacePatternKey = () =>\n\t\t\tthis.hasReplacePatternKey.set(\n\t\t\t\tthis.searchWidget.getReplaceValue().length > 0,\n\t\t\t);\n\t\tupdateHasReplacePatternKey();\n\t\tthis._register(\n\t\t\tthis.searchWidget.replaceInput.inputBox.onDidChange(() =>\n\t\t\t\tupdateHasReplacePatternKey(),\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.searchWidget.onDidHeightChange(() => this.reLayout()),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.searchWidget.onReplaceToggled(() => this.reLayout()),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.searchWidget.onReplaceStateChange((state) => {\n\t\t\t\tthis.viewModel.replaceActive = state;\n\t\t\t\tthis.refreshTree();\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.searchWidget.onPreserveCaseChange((state) => {\n\t\t\t\tthis.viewModel.preserveCase = state;\n\t\t\t\tthis.refreshTree();\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.searchWidget.onReplaceValueChanged(() => {\n\t\t\t\tthis.viewModel.replaceString =\n\t\t\t\t\tthis.searchWidget.getReplaceValue();\n\t\t\t\tthis.delayedRefresh.trigger(() => this.refreshTree());\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.searchWidget.onBlur(() => {\n\t\t\t\tthis.toggleQueryDetailsButton.focus();\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(this.searchWidget.onReplaceAll(() => this.replaceAll()));\n\n\t\tthis.trackInputBox(this.searchWidget.searchInputFocusTracker);\n\t\tthis.trackInputBox(this.searchWidget.replaceInputFocusTracker);\n\t}\n\n\tprivate shouldShowAIButton(): boolean {\n\t\tconst hasProvider =\n\t\t\tConstants.SearchContext.hasAIResultProvider.getValue(\n\t\t\t\tthis.contextKeyService,\n\t\t\t);\n\t\treturn !!(\n\t\t\tthis.configurationService.getValue<boolean>(\"search.aiResults\") &&\n\t\t\thasProvider\n\t\t);\n\t}\n\tprivate onConfigurationUpdated(event?: IConfigurationChangeEvent): void {\n\t\tif (\n\t\t\tevent &&\n\t\t\t(event.affectsConfiguration(\"search.decorations.colors\") ||\n\t\t\t\tevent.affectsConfiguration(\"search.decorations.badges\"))\n\t\t) {\n\t\t\tthis.refreshTree();\n\t\t}\n\t}\n\n\tprivate trackInputBox(\n\t\tinputFocusTracker: dom.IFocusTracker | undefined,\n\t\tcontextKey?: IContextKey<boolean>,\n\t): void {\n\t\tif (!inputFocusTracker) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._register(\n\t\t\tinputFocusTracker.onDidFocus(() => {\n\t\t\t\tthis.lastFocusState = \"input\";\n\t\t\t\tthis.inputBoxFocused.set(true);\n\t\t\t\tcontextKey?.set(true);\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tinputFocusTracker.onDidBlur(() => {\n\t\t\t\tthis.inputBoxFocused.set(\n\t\t\t\t\tthis.searchWidget.searchInputHasFocus() ||\n\t\t\t\t\t\tthis.searchWidget.replaceInputHasFocus() ||\n\t\t\t\t\t\tthis.inputPatternIncludes.inputHasFocus() ||\n\t\t\t\t\t\tthis.inputPatternExcludes.inputHasFocus(),\n\t\t\t\t);\n\t\t\t\tcontextKey?.set(false);\n\t\t\t}),\n\t\t);\n\t}\n\n\tprivate onSearchResultsChanged(event?: IChangeEvent): void {\n\t\tif (this.isVisible()) {\n\t\t\treturn this.refreshAndUpdateCount(event);\n\t\t} else {\n\t\t\tthis.changedWhileHidden = true;\n\t\t}\n\t}\n\n\tprivate refreshAndUpdateCount(event?: IChangeEvent): void {\n\t\tthis.searchWidget.setReplaceAllActionState(\n\t\t\t!this.viewModel.searchResult.isEmpty(this.aiResultsVisible),\n\t\t);\n\t\tthis.updateSearchResultCount(\n\t\t\tthis.viewModel.searchResult.query!\n\t\t\t\t.userDisabledExcludesAndIgnoreFiles,\n\t\t\tthis.viewModel.searchResult.query?.onlyOpenEditors,\n\t\t\tevent?.clearingAll,\n\t\t);\n\t\treturn this.refreshTree(event);\n\t}\n\n\trefreshTree(event?: IChangeEvent): void {\n\t\tconst collapseResults = this.searchConfig.collapseResults;\n\t\tif (!event || event.added || event.removed) {\n\t\t\t// Refresh whole tree\n\t\t\tif (this.searchConfig.sortOrder === SearchSortOrder.Modified) {\n\t\t\t\t// Ensure all matches have retrieved their file stat\n\t\t\t\tthis.retrieveFileStats().then(() =>\n\t\t\t\t\tthis.tree.setChildren(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tthis.createResultIterator(collapseResults),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.tree.setChildren(\n\t\t\t\t\tnull,\n\t\t\t\t\tthis.createResultIterator(collapseResults),\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\t// If updated counts affect our search order, re-sort the view.\n\t\t\tif (\n\t\t\t\tthis.searchConfig.sortOrder ===\n\t\t\t\t\tSearchSortOrder.CountAscending ||\n\t\t\t\tthis.searchConfig.sortOrder === SearchSortOrder.CountDescending\n\t\t\t) {\n\t\t\t\tthis.tree.setChildren(\n\t\t\t\t\tnull,\n\t\t\t\t\tthis.createResultIterator(collapseResults),\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t// FileMatch modified, refresh those elements\n\t\t\t\tevent.elements.forEach((element) => {\n\t\t\t\t\tthis.tree.setChildren(\n\t\t\t\t\t\telement,\n\t\t\t\t\t\tthis.createIterator(element, collapseResults),\n\t\t\t\t\t);\n\t\t\t\t\tthis.tree.rerender(element);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate createResultIterator(\n\t\tcollapseResults: ISearchConfigurationProperties[\"collapseResults\"],\n\t): Iterable<ICompressedTreeElement<RenderableMatch>> {\n\t\tconst folderMatches = this.searchResult\n\t\t\t.folderMatches(this.aiResultsVisible)\n\t\t\t.filter((fm) => !fm.isEmpty())\n\t\t\t.sort(searchMatchComparer);\n\n\t\tif (folderMatches.length === 1) {\n\t\t\treturn this.createFolderIterator(\n\t\t\t\tfolderMatches[0],\n\t\t\t\tcollapseResults,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\n\t\treturn Iterable.map(\n\t\t\tfolderMatches,\n\t\t\t(folderMatch): ICompressedTreeElement<RenderableMatch> => {\n\t\t\t\tconst children = this.createFolderIterator(\n\t\t\t\t\tfolderMatch,\n\t\t\t\t\tcollapseResults,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\t\t\t\treturn { element: folderMatch, children, incompressible: true }; // roots should always be incompressible\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate createFolderIterator(\n\t\tfolderMatch: FolderMatch,\n\t\tcollapseResults: ISearchConfigurationProperties[\"collapseResults\"],\n\t\tchildFolderIncompressible: boolean,\n\t): Iterable<ICompressedTreeElement<RenderableMatch>> {\n\t\tconst sortOrder = this.searchConfig.sortOrder;\n\n\t\tconst matchArray = this.isTreeLayoutViewVisible\n\t\t\t? folderMatch.matches()\n\t\t\t: folderMatch.allDownstreamFileMatches();\n\t\tconst matches = matchArray.sort((a, b) =>\n\t\t\tsearchMatchComparer(a, b, sortOrder),\n\t\t);\n\n\t\treturn Iterable.map(\n\t\t\tmatches,\n\t\t\t(match): ICompressedTreeElement<RenderableMatch> => {\n\t\t\t\tlet children;\n\t\t\t\tif (match instanceof FileMatch) {\n\t\t\t\t\tchildren = this.createFileIterator(match);\n\t\t\t\t} else {\n\t\t\t\t\tchildren = this.createFolderIterator(\n\t\t\t\t\t\tmatch,\n\t\t\t\t\t\tcollapseResults,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst collapsed =\n\t\t\t\t\tcollapseResults === \"alwaysCollapse\" ||\n\t\t\t\t\t(match.count() > 10 && collapseResults !== \"alwaysExpand\")\n\t\t\t\t\t\t? ObjectTreeElementCollapseState.PreserveOrCollapsed\n\t\t\t\t\t\t: ObjectTreeElementCollapseState.PreserveOrExpanded;\n\n\t\t\t\treturn {\n\t\t\t\t\telement: match,\n\t\t\t\t\tchildren,\n\t\t\t\t\tcollapsed,\n\t\t\t\t\tincompressible:\n\t\t\t\t\t\tmatch instanceof FileMatch\n\t\t\t\t\t\t\t? true\n\t\t\t\t\t\t\t: childFolderIncompressible,\n\t\t\t\t};\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate createFileIterator(\n\t\tfileMatch: FileMatch,\n\t): Iterable<ICompressedTreeElement<RenderableMatch>> {\n\t\tlet matches = fileMatch.matches().sort(searchMatchComparer);\n\n\t\tif (!this.aiResultsVisible) {\n\t\t\tmatches = matches.filter((e) => !e.aiContributed);\n\t\t}\n\t\treturn Iterable.map(\n\t\t\tmatches,\n\t\t\t(r): ICompressedTreeElement<RenderableMatch> => ({\n\t\t\t\telement: r,\n\t\t\t\tincompressible: true,\n\t\t\t}),\n\t\t);\n\t}\n\n\tprivate createIterator(\n\t\tmatch: FolderMatch | FileMatch | SearchResult,\n\t\tcollapseResults: ISearchConfigurationProperties[\"collapseResults\"],\n\t): Iterable<ICompressedTreeElement<RenderableMatch>> {\n\t\treturn match instanceof SearchResult\n\t\t\t? this.createResultIterator(collapseResults)\n\t\t\t: match instanceof FolderMatch\n\t\t\t\t? this.createFolderIterator(match, collapseResults, false)\n\t\t\t\t: this.createFileIterator(match);\n\t}\n\n\tprivate replaceAll(): void {\n\t\tif (this.viewModel.searchResult.count() === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst occurrences = this.viewModel.searchResult.count();\n\t\tconst fileCount = this.viewModel.searchResult.fileCount();\n\t\tconst replaceValue = this.searchWidget.getReplaceValue() || \"\";\n\t\tconst afterReplaceAllMessage = this.buildAfterReplaceAllMessage(\n\t\t\toccurrences,\n\t\t\tfileCount,\n\t\t\treplaceValue,\n\t\t);\n\n\t\tlet progressComplete: () => void;\n\t\tlet progressReporter: IProgress<IProgressStep>;\n\n\t\tthis.progressService.withProgress(\n\t\t\t{\n\t\t\t\tlocation: this.getProgressLocation(),\n\t\t\t\tdelay: 100,\n\t\t\t\ttotal: occurrences,\n\t\t\t},\n\t\t\t(p) => {\n\t\t\t\tprogressReporter = p;\n\n\t\t\t\treturn new Promise<void>(\n\t\t\t\t\t(resolve) => (progressComplete = resolve),\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\tconst confirmation: IConfirmation = {\n\t\t\ttitle: nls.localize(\"replaceAll.confirmation.title\", \"Replace All\"),\n\t\t\tmessage: this.buildReplaceAllConfirmationMessage(\n\t\t\t\toccurrences,\n\t\t\t\tfileCount,\n\t\t\t\treplaceValue,\n\t\t\t),\n\t\t\tprimaryButton: nls.localize(\n\t\t\t\t{\n\t\t\t\t\tkey: \"replaceAll.confirm.button\",\n\t\t\t\t\tcomment: [\"&& denotes a mnemonic\"],\n\t\t\t\t},\n\t\t\t\t\"&&Replace\",\n\t\t\t),\n\t\t};\n\n\t\tthis.dialogService.confirm(confirmation).then((res) => {\n\t\t\tif (res.confirmed) {\n\t\t\t\tthis.searchWidget.setReplaceAllActionState(false);\n\t\t\t\tthis.viewModel.searchResult.replaceAll(progressReporter).then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tprogressComplete();\n\t\t\t\t\t\tconst messageEl = this.clearMessage();\n\t\t\t\t\t\tdom.append(messageEl, afterReplaceAllMessage);\n\t\t\t\t\t\tthis.reLayout();\n\t\t\t\t\t},\n\t\t\t\t\t(error) => {\n\t\t\t\t\t\tprogressComplete();\n\t\t\t\t\t\terrors.isCancellationError(error);\n\t\t\t\t\t\tthis.notificationService.error(error);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tprogressComplete();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate buildAfterReplaceAllMessage(\n\t\toccurrences: number,\n\t\tfileCount: number,\n\t\treplaceValue?: string,\n\t) {\n\t\tif (occurrences === 1) {\n\t\t\tif (fileCount === 1) {\n\t\t\t\tif (replaceValue) {\n\t\t\t\t\treturn nls.localize(\n\t\t\t\t\t\t\"replaceAll.occurrence.file.message\",\n\t\t\t\t\t\t\"Replaced {0} occurrence across {1} file with '{2}'.\",\n\t\t\t\t\t\toccurrences,\n\t\t\t\t\t\tfileCount,\n\t\t\t\t\t\treplaceValue,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn nls.localize(\n\t\t\t\t\t\"removeAll.occurrence.file.message\",\n\t\t\t\t\t\"Replaced {0} occurrence across {1} file.\",\n\t\t\t\t\toccurrences,\n\t\t\t\t\tfileCount,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (replaceValue) {\n\t\t\t\treturn nls.localize(\n\t\t\t\t\t\"replaceAll.occurrence.files.message\",\n\t\t\t\t\t\"Replaced {0} occurrence across {1} files with '{2}'.\",\n\t\t\t\t\toccurrences,\n\t\t\t\t\tfileCount,\n\t\t\t\t\treplaceValue,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn nls.localize(\n\t\t\t\t\"removeAll.occurrence.files.message\",\n\t\t\t\t\"Replaced {0} occurrence across {1} files.\",\n\t\t\t\toccurrences,\n\t\t\t\tfileCount,\n\t\t\t);\n\t\t}\n\n\t\tif (fileCount === 1) {\n\t\t\tif (replaceValue) {\n\t\t\t\treturn nls.localize(\n\t\t\t\t\t\"replaceAll.occurrences.file.message\",\n\t\t\t\t\t\"Replaced {0} occurrences across {1} file with '{2}'.\",\n\t\t\t\t\toccurrences,\n\t\t\t\t\tfileCount,\n\t\t\t\t\treplaceValue,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn nls.localize(\n\t\t\t\t\"removeAll.occurrences.file.message\",\n\t\t\t\t\"Replaced {0} occurrences across {1} file.\",\n\t\t\t\toccurrences,\n\t\t\t\tfileCount,\n\t\t\t);\n\t\t}\n\n\t\tif (replaceValue) {\n\t\t\treturn nls.localize(\n\t\t\t\t\"replaceAll.occurrences.files.message\",\n\t\t\t\t\"Replaced {0} occurrences across {1} files with '{2}'.\",\n\t\t\t\toccurrences,\n\t\t\t\tfileCount,\n\t\t\t\treplaceValue,\n\t\t\t);\n\t\t}\n\n\t\treturn nls.localize(\n\t\t\t\"removeAll.occurrences.files.message\",\n\t\t\t\"Replaced {0} occurrences across {1} files.\",\n\t\t\toccurrences,\n\t\t\tfileCount,\n\t\t);\n\t}\n\n\tprivate buildReplaceAllConfirmationMessage(\n\t\toccurrences: number,\n\t\tfileCount: number,\n\t\treplaceValue?: string,\n\t) {\n\t\tif (occurrences === 1) {\n\t\t\tif (fileCount === 1) {\n\t\t\t\tif (replaceValue) {\n\t\t\t\t\treturn nls.localize(\n\t\t\t\t\t\t\"removeAll.occurrence.file.confirmation.message\",\n\t\t\t\t\t\t\"Replace {0} occurrence across {1} file with '{2}'?\",\n\t\t\t\t\t\toccurrences,\n\t\t\t\t\t\tfileCount,\n\t\t\t\t\t\treplaceValue,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn nls.localize(\n\t\t\t\t\t\"replaceAll.occurrence.file.confirmation.message\",\n\t\t\t\t\t\"Replace {0} occurrence across {1} file?\",\n\t\t\t\t\toccurrences,\n\t\t\t\t\tfileCount,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (replaceValue) {\n\t\t\t\treturn nls.localize(\n\t\t\t\t\t\"removeAll.occurrence.files.confirmation.message\",\n\t\t\t\t\t\"Replace {0} occurrence across {1} files with '{2}'?\",\n\t\t\t\t\toccurrences,\n\t\t\t\t\tfileCount,\n\t\t\t\t\treplaceValue,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn nls.localize(\n\t\t\t\t\"replaceAll.occurrence.files.confirmation.message\",\n\t\t\t\t\"Replace {0} occurrence across {1} files?\",\n\t\t\t\toccurrences,\n\t\t\t\tfileCount,\n\t\t\t);\n\t\t}\n\n\t\tif (fileCount === 1) {\n\t\t\tif (replaceValue) {\n\t\t\t\treturn nls.localize(\n\t\t\t\t\t\"removeAll.occurrences.file.confirmation.message\",\n\t\t\t\t\t\"Replace {0} occurrences across {1} file with '{2}'?\",\n\t\t\t\t\toccurrences,\n\t\t\t\t\tfileCount,\n\t\t\t\t\treplaceValue,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn nls.localize(\n\t\t\t\t\"replaceAll.occurrences.file.confirmation.message\",\n\t\t\t\t\"Replace {0} occurrences across {1} file?\",\n\t\t\t\toccurrences,\n\t\t\t\tfileCount,\n\t\t\t);\n\t\t}\n\n\t\tif (replaceValue) {\n\t\t\treturn nls.localize(\n\t\t\t\t\"removeAll.occurrences.files.confirmation.message\",\n\t\t\t\t\"Replace {0} occurrences across {1} files with '{2}'?\",\n\t\t\t\toccurrences,\n\t\t\t\tfileCount,\n\t\t\t\treplaceValue,\n\t\t\t);\n\t\t}\n\n\t\treturn nls.localize(\n\t\t\t\"replaceAll.occurrences.files.confirmation.message\",\n\t\t\t\"Replace {0} occurrences across {1} files?\",\n\t\t\toccurrences,\n\t\t\tfileCount,\n\t\t);\n\t}\n\n\tprivate clearMessage(): HTMLElement {\n\t\tthis.searchWithoutFolderMessageElement = undefined;\n\n\t\tconst wasHidden = this.messagesElement.style.display === \"none\";\n\t\tdom.clearNode(this.messagesElement);\n\t\tdom.show(this.messagesElement);\n\t\tthis.messageDisposables.clear();\n\n\t\tconst newMessage = dom.append(this.messagesElement, $(\".message\"));\n\t\tif (wasHidden) {\n\t\t\tthis.reLayout();\n\t\t}\n\n\t\treturn newMessage;\n\t}\n\n\tprivate createSearchResultsView(container: HTMLElement): void {\n\t\tthis.resultsElement = dom.append(\n\t\t\tcontainer,\n\t\t\t$(\".results.show-file-icons.file-icon-themable-tree\"),\n\t\t);\n\t\tconst delegate =\n\t\t\tthis.instantiationService.createInstance(SearchDelegate);\n\n\t\tconst identityProvider: IIdentityProvider<RenderableMatch> = {\n\t\t\tgetId(element: RenderableMatch) {\n\t\t\t\treturn element.id();\n\t\t\t},\n\t\t};\n\n\t\tthis.treeLabels = this._register(\n\t\t\tthis.instantiationService.createInstance(ResourceLabels, {\n\t\t\t\tonDidChangeVisibility: this.onDidChangeBodyVisibility,\n\t\t\t}),\n\t\t);\n\t\tthis.tree = this._register(\n\t\t\t<WorkbenchCompressibleObjectTree<RenderableMatch>>(\n\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\tWorkbenchCompressibleObjectTree,\n\t\t\t\t\t\"SearchView\",\n\t\t\t\t\tthis.resultsElement,\n\t\t\t\t\tdelegate,\n\t\t\t\t\t[\n\t\t\t\t\t\tthis._register(\n\t\t\t\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\t\t\t\tFolderMatchRenderer,\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tthis.treeLabels,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._register(\n\t\t\t\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\t\t\t\tFileMatchRenderer,\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tthis.treeLabels,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._register(\n\t\t\t\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\t\t\t\tMatchRenderer,\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t),\n\t\t\t\t\t],\n\t\t\t\t\t{\n\t\t\t\t\t\tidentityProvider,\n\t\t\t\t\t\taccessibilityProvider: this.treeAccessibilityProvider,\n\t\t\t\t\t\tdnd: this.instantiationService.createInstance(\n\t\t\t\t\t\t\tResourceListDnDHandler,\n\t\t\t\t\t\t\t(element) => {\n\t\t\t\t\t\t\t\tif (element instanceof FileMatch) {\n\t\t\t\t\t\t\t\t\treturn element.resource;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (element instanceof Match) {\n\t\t\t\t\t\t\t\t\treturn withSelection(\n\t\t\t\t\t\t\t\t\t\telement.parent().resource,\n\t\t\t\t\t\t\t\t\t\telement.range(),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t),\n\t\t\t\t\t\tmultipleSelectionSupport: true,\n\t\t\t\t\t\tselectionNavigation: true,\n\t\t\t\t\t\toverrideStyles:\n\t\t\t\t\t\t\tthis.getLocationBasedColors().listOverrideStyles,\n\t\t\t\t\t\tpaddingBottom: SearchDelegate.ITEM_HEIGHT,\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t),\n\t\t);\n\t\tthis._register(this.tree.onContextMenu((e) => this.onContextMenu(e)));\n\t\tconst updateHasSomeCollapsible = () =>\n\t\t\tthis.toggleCollapseStateDelayer.trigger(() =>\n\t\t\t\tthis.hasSomeCollapsibleResultKey.set(this.hasSomeCollapsible()),\n\t\t\t);\n\t\tupdateHasSomeCollapsible();\n\t\tthis._register(\n\t\t\tthis.tree.onDidChangeCollapseState(() =>\n\t\t\t\tupdateHasSomeCollapsible(),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.tree.onDidChangeModel(() => updateHasSomeCollapsible()),\n\t\t);\n\n\t\tthis._register(\n\t\t\tEvent.debounce(\n\t\t\t\tthis.tree.onDidOpen,\n\t\t\t\t(last, event) => event,\n\t\t\t\tDEBOUNCE_DELAY,\n\t\t\t\ttrue,\n\t\t\t)((options) => {\n\t\t\t\tif (options.element instanceof Match) {\n\t\t\t\t\tconst selectedMatch: Match = options.element;\n\t\t\t\t\tthis.currentSelectedFileMatch?.setSelectedMatch(null);\n\t\t\t\t\tthis.currentSelectedFileMatch = selectedMatch.parent();\n\t\t\t\t\tthis.currentSelectedFileMatch.setSelectedMatch(\n\t\t\t\t\t\tselectedMatch,\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.onFocus(\n\t\t\t\t\t\tselectedMatch,\n\t\t\t\t\t\toptions.editorOptions.preserveFocus,\n\t\t\t\t\t\toptions.sideBySide,\n\t\t\t\t\t\toptions.editorOptions.pinned,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tEvent.debounce(\n\t\t\t\tthis.tree.onDidChangeFocus,\n\t\t\t\t(last, event) => event,\n\t\t\t\tDEBOUNCE_DELAY,\n\t\t\t\ttrue,\n\t\t\t)(() => {\n\t\t\t\tconst selection = this.tree.getSelection();\n\t\t\t\tconst focus = this.tree.getFocus()[0];\n\t\t\t\tif (selection.length > 1 && focus instanceof Match) {\n\t\t\t\t\tthis.onFocus(focus, true);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tEvent.any<any>(\n\t\t\t\tthis.tree.onDidFocus,\n\t\t\t\tthis.tree.onDidChangeFocus,\n\t\t\t)(() => {\n\t\t\t\tconst focus = this.tree.getFocus()[0];\n\n\t\t\t\tif (this.tree.isDOMFocused()) {\n\t\t\t\t\tthis.firstMatchFocused.set(\n\t\t\t\t\t\tthis.tree.navigate().first() === focus,\n\t\t\t\t\t);\n\t\t\t\t\tthis.fileMatchOrMatchFocused.set(!!focus);\n\t\t\t\t\tthis.fileMatchFocused.set(focus instanceof FileMatch);\n\t\t\t\t\tthis.folderMatchFocused.set(focus instanceof FolderMatch);\n\t\t\t\t\tthis.matchFocused.set(focus instanceof Match);\n\t\t\t\t\tthis.fileMatchOrFolderMatchFocus.set(\n\t\t\t\t\t\tfocus instanceof FileMatch ||\n\t\t\t\t\t\t\tfocus instanceof FolderMatch,\n\t\t\t\t\t);\n\t\t\t\t\tthis.fileMatchOrFolderMatchWithResourceFocus.set(\n\t\t\t\t\t\tfocus instanceof FileMatch ||\n\t\t\t\t\t\t\tfocus instanceof FolderMatchWithResource,\n\t\t\t\t\t);\n\t\t\t\t\tthis.folderMatchWithResourceFocused.set(\n\t\t\t\t\t\tfocus instanceof FolderMatchWithResource,\n\t\t\t\t\t);\n\t\t\t\t\tthis.lastFocusState = \"tree\";\n\t\t\t\t}\n\n\t\t\t\tlet editable = false;\n\t\t\t\tif (focus instanceof Match) {\n\t\t\t\t\teditable =\n\t\t\t\t\t\tfocus instanceof MatchInNotebook\n\t\t\t\t\t\t\t? !focus.isReadonly()\n\t\t\t\t\t\t\t: true;\n\t\t\t\t} else if (focus instanceof FileMatch) {\n\t\t\t\t\teditable = !focus.hasOnlyReadOnlyMatches();\n\t\t\t\t} else if (focus instanceof FolderMatch) {\n\t\t\t\t\teditable = !focus.hasOnlyReadOnlyMatches();\n\t\t\t\t}\n\t\t\t\tthis.isEditableItem.set(editable);\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.tree.onDidBlur(() => {\n\t\t\t\tthis.firstMatchFocused.reset();\n\t\t\t\tthis.fileMatchOrMatchFocused.reset();\n\t\t\t\tthis.fileMatchFocused.reset();\n\t\t\t\tthis.folderMatchFocused.reset();\n\t\t\t\tthis.matchFocused.reset();\n\t\t\t\tthis.fileMatchOrFolderMatchFocus.reset();\n\t\t\t\tthis.fileMatchOrFolderMatchWithResourceFocus.reset();\n\t\t\t\tthis.folderMatchWithResourceFocused.reset();\n\t\t\t\tthis.isEditableItem.reset();\n\t\t\t}),\n\t\t);\n\t}\n\n\tprivate onContextMenu(\n\t\te: ITreeContextMenuEvent<RenderableMatch | null>,\n\t): void {\n\t\te.browserEvent.preventDefault();\n\t\te.browserEvent.stopPropagation();\n\n\t\tthis.contextMenuService.showContextMenu({\n\t\t\tmenuId: MenuId.SearchContext,\n\t\t\tmenuActionOptions: { shouldForwardArgs: true },\n\t\t\tcontextKeyService: this.contextKeyService,\n\t\t\tgetAnchor: () => e.anchor,\n\t\t\tgetActionsContext: () => e.element,\n\t\t});\n\t}\n\n\tprivate hasSomeCollapsible(): boolean {\n\t\tconst viewer = this.getControl();\n\t\tconst navigator = viewer.navigate();\n\t\tlet node = navigator.first();\n\t\tdo {\n\t\t\tif (!viewer.isCollapsed(node)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} while ((node = navigator.next()));\n\n\t\treturn false;\n\t}\n\n\tselectNextMatch(): void {\n\t\tif (!this.hasSearchResults()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [selected] = this.tree.getSelection();\n\n\t\t// Expand the initial selected node, if needed\n\t\tif (selected && !(selected instanceof Match)) {\n\t\t\tif (this.tree.isCollapsed(selected)) {\n\t\t\t\tthis.tree.expand(selected);\n\t\t\t}\n\t\t}\n\n\t\tconst navigator = this.tree.navigate(selected);\n\n\t\tlet next = navigator.next();\n\t\tif (!next) {\n\t\t\tnext = navigator.first();\n\t\t}\n\n\t\t// Expand until first child is a Match\n\t\twhile (next && !(next instanceof Match)) {\n\t\t\tif (this.tree.isCollapsed(next)) {\n\t\t\t\tthis.tree.expand(next);\n\t\t\t}\n\n\t\t\t// Select the first child\n\t\t\tnext = navigator.next();\n\t\t}\n\n\t\t// Reveal the newly selected element\n\t\tif (next) {\n\t\t\tif (next === selected) {\n\t\t\t\tthis.tree.setFocus([]);\n\t\t\t}\n\t\t\tconst event = getSelectionKeyboardEvent(undefined, false, false);\n\t\t\tthis.tree.setFocus([next], event);\n\t\t\tthis.tree.setSelection([next], event);\n\t\t\tthis.tree.reveal(next);\n\t\t\tconst ariaLabel = this.treeAccessibilityProvider.getAriaLabel(next);\n\t\t\tif (ariaLabel) {\n\t\t\t\taria.status(ariaLabel);\n\t\t\t}\n\t\t}\n\t}\n\n\tselectPreviousMatch(): void {\n\t\tif (!this.hasSearchResults()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [selected] = this.tree.getSelection();\n\t\tlet navigator = this.tree.navigate(selected);\n\n\t\tlet prev = navigator.previous();\n\n\t\t// Select previous until find a Match or a collapsed item\n\t\twhile (\n\t\t\t!prev ||\n\t\t\t(!(prev instanceof Match) && !this.tree.isCollapsed(prev))\n\t\t) {\n\t\t\tconst nextPrev = prev ? navigator.previous() : navigator.last();\n\n\t\t\tif (!prev && !nextPrev) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tprev = nextPrev;\n\t\t}\n\n\t\t// Expand until last child is a Match\n\t\twhile (!(prev instanceof Match)) {\n\t\t\tconst nextItem = navigator.next();\n\t\t\tthis.tree.expand(prev);\n\t\t\tnavigator = this.tree.navigate(nextItem); // recreate navigator because modifying the tree can invalidate it\n\t\t\tprev = nextItem ? navigator.previous() : navigator.last(); // select last child\n\t\t}\n\n\t\t// Reveal the newly selected element\n\t\tif (prev) {\n\t\t\tif (prev === selected) {\n\t\t\t\tthis.tree.setFocus([]);\n\t\t\t}\n\t\t\tconst event = getSelectionKeyboardEvent(undefined, false, false);\n\t\t\tthis.tree.setFocus([prev], event);\n\t\t\tthis.tree.setSelection([prev], event);\n\t\t\tthis.tree.reveal(prev);\n\t\t\tconst ariaLabel = this.treeAccessibilityProvider.getAriaLabel(prev);\n\t\t\tif (ariaLabel) {\n\t\t\t\taria.status(ariaLabel);\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveFocusToResults(): void {\n\t\tthis.tree.domFocus();\n\t}\n\n\toverride focus(): void {\n\t\tsuper.focus();\n\t\tif (this.lastFocusState === \"input\" || !this.hasSearchResults()) {\n\t\t\tconst updatedText = this.searchConfig.seedOnFocus\n\t\t\t\t? this.updateTextFromSelection({ allowSearchOnType: false })\n\t\t\t\t: false;\n\t\t\tthis.searchWidget.focus(undefined, undefined, updatedText);\n\t\t} else {\n\t\t\tthis.tree.domFocus();\n\t\t}\n\t}\n\n\tupdateTextFromFindWidgetOrSelection({\n\t\tallowUnselectedWord = true,\n\t\tallowSearchOnType = true,\n\t}): boolean {\n\t\tlet activeEditor = this.editorService.activeTextEditorControl;\n\t\tif (isCodeEditor(activeEditor) && !activeEditor?.hasTextFocus()) {\n\t\t\tconst controller = CommonFindController.get(activeEditor);\n\t\t\tif (controller && controller.isFindInputFocused()) {\n\t\t\t\treturn this.updateTextFromFindWidget(controller, {\n\t\t\t\t\tallowSearchOnType,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst editors = this.codeEditorService.listCodeEditors();\n\t\t\tactiveEditor =\n\t\t\t\teditors.find(\n\t\t\t\t\t(editor) =>\n\t\t\t\t\t\teditor instanceof EmbeddedCodeEditorWidget &&\n\t\t\t\t\t\teditor.getParentEditor() === activeEditor &&\n\t\t\t\t\t\teditor.hasTextFocus(),\n\t\t\t\t) ?? activeEditor;\n\t\t}\n\n\t\treturn this.updateTextFromSelection(\n\t\t\t{ allowUnselectedWord, allowSearchOnType },\n\t\t\tactiveEditor,\n\t\t);\n\t}\n\n\tprivate updateTextFromFindWidget(\n\t\tcontroller: CommonFindController,\n\t\t{ allowSearchOnType = true },\n\t): boolean {\n\t\tif (\n\t\t\t!this.searchConfig.seedWithNearestWord &&\n\t\t\t(dom.getActiveWindow().getSelection()?.toString() ?? \"\") === \"\"\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst searchString = controller.getState().searchString;\n\t\tif (searchString === \"\") {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.searchWidget.searchInput?.setCaseSensitive(\n\t\t\tcontroller.getState().matchCase,\n\t\t);\n\t\tthis.searchWidget.searchInput?.setWholeWords(\n\t\t\tcontroller.getState().wholeWord,\n\t\t);\n\t\tthis.searchWidget.searchInput?.setRegex(controller.getState().isRegex);\n\t\tthis.updateText(searchString, allowSearchOnType);\n\n\t\treturn true;\n\t}\n\n\tprivate updateTextFromSelection(\n\t\t{ allowUnselectedWord = true, allowSearchOnType = true },\n\t\teditor?: IEditor,\n\t): boolean {\n\t\tconst seedSearchStringFromSelection =\n\t\t\tthis.configurationService.getValue<IEditorOptions>(\"editor\").find!\n\t\t\t\t.seedSearchStringFromSelection;\n\t\tif (\n\t\t\t!seedSearchStringFromSelection ||\n\t\t\tseedSearchStringFromSelection === \"never\"\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet selectedText = this.getSearchTextFromEditor(\n\t\t\tallowUnselectedWord,\n\t\t\teditor,\n\t\t);\n\t\tif (selectedText === null) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.searchWidget.searchInput?.getRegex()) {\n\t\t\tselectedText = strings.escapeRegExpCharacters(selectedText);\n\t\t}\n\n\t\tthis.updateText(selectedText, allowSearchOnType);\n\t\treturn true;\n\t}\n\n\tprivate updateText(text: string, allowSearchOnType = true) {\n\t\tif (allowSearchOnType && !this.viewModel.searchResult.isDirty) {\n\t\t\tthis.searchWidget.setValue(text);\n\t\t} else {\n\t\t\tthis.pauseSearching = true;\n\t\t\tthis.searchWidget.setValue(text);\n\t\t\tthis.pauseSearching = false;\n\t\t}\n\t}\n\n\tfocusNextInputBox(): void {\n\t\tif (this.searchWidget.searchInputHasFocus()) {\n\t\t\tif (this.searchWidget.isReplaceShown()) {\n\t\t\t\tthis.searchWidget.focus(true, true);\n\t\t\t} else {\n\t\t\t\tthis.moveFocusFromSearchOrReplace();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.searchWidget.replaceInputHasFocus()) {\n\t\t\tthis.moveFocusFromSearchOrReplace();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.inputPatternIncludes.inputHasFocus()) {\n\t\t\tthis.inputPatternExcludes.focus();\n\t\t\tthis.inputPatternExcludes.select();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.inputPatternExcludes.inputHasFocus()) {\n\t\t\tthis.selectTreeIfNotSelected();\n\t\t\treturn;\n\t\t}\n\t}\n\n\tprivate moveFocusFromSearchOrReplace() {\n\t\tif (this.showsFileTypes()) {\n\t\t\tthis.toggleQueryDetails(true, this.showsFileTypes());\n\t\t} else {\n\t\t\tthis.selectTreeIfNotSelected();\n\t\t}\n\t}\n\n\tfocusPreviousInputBox(): void {\n\t\tif (this.searchWidget.searchInputHasFocus()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.searchWidget.replaceInputHasFocus()) {\n\t\t\tthis.searchWidget.focus(true);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.inputPatternIncludes.inputHasFocus()) {\n\t\t\tthis.searchWidget.focus(true, true);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.inputPatternExcludes.inputHasFocus()) {\n\t\t\tthis.inputPatternIncludes.focus();\n\t\t\tthis.inputPatternIncludes.select();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.tree.isDOMFocused()) {\n\t\t\tthis.moveFocusFromResults();\n\t\t\treturn;\n\t\t}\n\t}\n\n\tprivate moveFocusFromResults(): void {\n\t\tif (this.showsFileTypes()) {\n\t\t\tthis.toggleQueryDetails(true, true, false, true);\n\t\t} else {\n\t\t\tthis.searchWidget.focus(true, true);\n\t\t}\n\t}\n\n\tprivate reLayout(): void {\n\t\tif (this.isDisposed || !this.size) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionsPosition = this.searchConfig.actionsPosition;\n\t\tthis.getContainer().classList.toggle(\n\t\t\tSearchView.ACTIONS_RIGHT_CLASS_NAME,\n\t\t\tactionsPosition === \"right\",\n\t\t);\n\n\t\tthis.searchWidget.setWidth(this.size.width - 28 /* container margin */);\n\n\t\tthis.inputPatternExcludes.setWidth(\n\t\t\tthis.size.width - 28 /* container margin */,\n\t\t);\n\t\tthis.inputPatternIncludes.setWidth(\n\t\t\tthis.size.width - 28 /* container margin */,\n\t\t);\n\n\t\tconst widgetHeight = dom.getTotalHeight(\n\t\t\tthis.searchWidgetsContainerElement,\n\t\t);\n\t\tconst messagesHeight = dom.getTotalHeight(this.messagesElement);\n\t\tthis.tree.layout(\n\t\t\tthis.size.height - widgetHeight - messagesHeight,\n\t\t\tthis.size.width - 28,\n\t\t);\n\t}\n\n\tprotected override layoutBody(height: number, width: number): void {\n\t\tsuper.layoutBody(height, width);\n\t\tthis.size = new dom.Dimension(width, height);\n\t\tthis.reLayout();\n\t}\n\n\tgetControl() {\n\t\treturn this.tree;\n\t}\n\n\tallSearchFieldsClear(): boolean {\n\t\treturn (\n\t\t\tthis.searchWidget.getReplaceValue() === \"\" &&\n\t\t\t(!this.searchWidget.searchInput ||\n\t\t\t\tthis.searchWidget.searchInput.getValue() === \"\")\n\t\t);\n\t}\n\n\tallFilePatternFieldsClear(): boolean {\n\t\treturn (\n\t\t\tthis.searchExcludePattern.getValue() === \"\" &&\n\t\t\tthis.searchIncludePattern.getValue() === \"\"\n\t\t);\n\t}\n\n\thasSearchResults(): boolean {\n\t\treturn !this.viewModel.searchResult.isEmpty(this.aiResultsVisible);\n\t}\n\n\tclearSearchResults(clearInput = true): void {\n\t\tthis.viewModel.searchResult.clear();\n\t\tthis.showEmptyStage(true);\n\t\tif (this.contextService.getWorkbenchState() === WorkbenchState.EMPTY) {\n\t\t\tthis.showSearchWithoutFolderMessage();\n\t\t}\n\t\tif (clearInput) {\n\t\t\tif (this.allSearchFieldsClear()) {\n\t\t\t\tthis.clearFilePatternFields();\n\t\t\t}\n\t\t\tthis.searchWidget.clear();\n\t\t}\n\t\tthis.viewModel.cancelSearch();\n\t\tthis.tree.ariaLabel = nls.localize(\"emptySearch\", \"Empty Search\");\n\n\t\tthis.accessibilitySignalService.playSignal(AccessibilitySignal.clear);\n\t\tthis.reLayout();\n\t}\n\n\tclearFilePatternFields(): void {\n\t\tthis.searchExcludePattern.clear();\n\t\tthis.searchIncludePattern.clear();\n\t}\n\n\tcancelSearch(focus = true): boolean {\n\t\tif (this.viewModel.cancelSearch()) {\n\t\t\tif (focus) {\n\t\t\t\tthis.searchWidget.focus();\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate selectTreeIfNotSelected(): void {\n\t\tif (this.tree.getNode(null)) {\n\t\t\tthis.tree.domFocus();\n\t\t\tconst selection = this.tree.getSelection();\n\t\t\tif (selection.length === 0) {\n\t\t\t\tconst event = getSelectionKeyboardEvent();\n\t\t\t\tthis.tree.focusNext(undefined, undefined, event);\n\t\t\t\tthis.tree.setSelection(this.tree.getFocus(), event);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getSearchTextFromEditor(\n\t\tallowUnselectedWord: boolean,\n\t\teditor?: IEditor,\n\t): string | null {\n\t\tif (dom.isAncestorOfActiveElement(this.getContainer())) {\n\t\t\treturn null;\n\t\t}\n\n\t\teditor = editor ?? this.editorService.activeTextEditorControl;\n\n\t\tif (!editor) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst allowUnselected =\n\t\t\tthis.searchConfig.seedWithNearestWord && allowUnselectedWord;\n\t\treturn getSelectionTextFromEditor(allowUnselected, editor);\n\t}\n\n\tprivate showsFileTypes(): boolean {\n\t\treturn this.queryDetails.classList.contains(\"more\");\n\t}\n\n\ttoggleCaseSensitive(): void {\n\t\tthis.searchWidget.searchInput?.setCaseSensitive(\n\t\t\t!this.searchWidget.searchInput.getCaseSensitive(),\n\t\t);\n\t\tthis.triggerQueryChange();\n\t}\n\n\ttoggleWholeWords(): void {\n\t\tthis.searchWidget.searchInput?.setWholeWords(\n\t\t\t!this.searchWidget.searchInput.getWholeWords(),\n\t\t);\n\t\tthis.triggerQueryChange();\n\t}\n\n\ttoggleRegex(): void {\n\t\tthis.searchWidget.searchInput?.setRegex(\n\t\t\t!this.searchWidget.searchInput.getRegex(),\n\t\t);\n\t\tthis.triggerQueryChange();\n\t}\n\n\ttogglePreserveCase(): void {\n\t\tthis.searchWidget.replaceInput?.setPreserveCase(\n\t\t\t!this.searchWidget.replaceInput.getPreserveCase(),\n\t\t);\n\t\tthis.triggerQueryChange();\n\t}\n\n\tsetSearchParameters(args: IFindInFilesArgs = {}): void {\n\t\tif (typeof args.isCaseSensitive === \"boolean\") {\n\t\t\tthis.searchWidget.searchInput?.setCaseSensitive(\n\t\t\t\targs.isCaseSensitive,\n\t\t\t);\n\t\t}\n\t\tif (typeof args.matchWholeWord === \"boolean\") {\n\t\t\tthis.searchWidget.searchInput?.setWholeWords(args.matchWholeWord);\n\t\t}\n\t\tif (typeof args.isRegex === \"boolean\") {\n\t\t\tthis.searchWidget.searchInput?.setRegex(args.isRegex);\n\t\t}\n\t\tif (typeof args.filesToInclude === \"string\") {\n\t\t\tthis.searchIncludePattern.setValue(String(args.filesToInclude));\n\t\t}\n\t\tif (typeof args.filesToExclude === \"string\") {\n\t\t\tthis.searchExcludePattern.setValue(String(args.filesToExclude));\n\t\t}\n\t\tif (typeof args.query === \"string\") {\n\t\t\tthis.searchWidget.searchInput?.setValue(args.query);\n\t\t}\n\t\tif (typeof args.replace === \"string\") {\n\t\t\tthis.searchWidget.replaceInput?.setValue(args.replace);\n\t\t} else if (\n\t\t\tthis.searchWidget.replaceInput &&\n\t\t\tthis.searchWidget.replaceInput.getValue() !== \"\"\n\t\t) {\n\t\t\tthis.searchWidget.replaceInput.setValue(\"\");\n\t\t}\n\t\tif (typeof args.triggerSearch === \"boolean\" && args.triggerSearch) {\n\t\t\tthis.triggerQueryChange();\n\t\t}\n\t\tif (typeof args.preserveCase === \"boolean\") {\n\t\t\tthis.searchWidget.replaceInput?.setPreserveCase(args.preserveCase);\n\t\t}\n\t\tif (typeof args.useExcludeSettingsAndIgnoreFiles === \"boolean\") {\n\t\t\tthis.inputPatternExcludes.setUseExcludesAndIgnoreFiles(\n\t\t\t\targs.useExcludeSettingsAndIgnoreFiles,\n\t\t\t);\n\t\t}\n\t\tif (typeof args.onlyOpenEditors === \"boolean\") {\n\t\t\tthis.searchIncludePattern.setOnlySearchInOpenEditors(\n\t\t\t\targs.onlyOpenEditors,\n\t\t\t);\n\t\t}\n\t}\n\n\ttoggleQueryDetails(\n\t\tmoveFocus = true,\n\t\tshow?: boolean,\n\t\tskipLayout?: boolean,\n\t\treverse?: boolean,\n\t): void {\n\t\tconst cls = \"more\";\n\t\tshow =\n\t\t\ttypeof show === \"undefined\"\n\t\t\t\t? !this.queryDetails.classList.contains(cls)\n\t\t\t\t: Boolean(show);\n\t\tthis.viewletState[\"query.queryDetailsExpanded\"] = show;\n\t\tskipLayout = Boolean(skipLayout);\n\n\t\tif (show) {\n\t\t\tthis.toggleQueryDetailsButton.setAttribute(\"aria-expanded\", \"true\");\n\t\t\tthis.queryDetails.classList.add(cls);\n\t\t\tif (moveFocus) {\n\t\t\t\tif (reverse) {\n\t\t\t\t\tthis.inputPatternExcludes.focus();\n\t\t\t\t\tthis.inputPatternExcludes.select();\n\t\t\t\t} else {\n\t\t\t\t\tthis.inputPatternIncludes.focus();\n\t\t\t\t\tthis.inputPatternIncludes.select();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.toggleQueryDetailsButton.setAttribute(\n\t\t\t\t\"aria-expanded\",\n\t\t\t\t\"false\",\n\t\t\t);\n\t\t\tthis.queryDetails.classList.remove(cls);\n\t\t\tif (moveFocus) {\n\t\t\t\tthis.searchWidget.focus();\n\t\t\t}\n\t\t}\n\n\t\tif (!skipLayout && this.size) {\n\t\t\tthis.reLayout();\n\t\t}\n\t}\n\n\tprivate _queryDetailsHidden() {\n\t\treturn this.queryDetails.classList.contains(\"more\");\n\t}\n\n\tsearchInFolders(folderPaths: string[] = []): void {\n\t\tthis._searchWithIncludeOrExclude(true, folderPaths);\n\t}\n\n\tsearchOutsideOfFolders(folderPaths: string[] = []): void {\n\t\tthis._searchWithIncludeOrExclude(false, folderPaths);\n\t}\n\n\tprivate _searchWithIncludeOrExclude(\n\t\tinclude: boolean,\n\t\tfolderPaths: string[],\n\t) {\n\t\tif (\n\t\t\t!folderPaths.length ||\n\t\t\tfolderPaths.some((folderPath) => folderPath === \".\")\n\t\t) {\n\t\t\tthis.inputPatternIncludes.setValue(\"\");\n\t\t\tthis.searchWidget.focus();\n\t\t\treturn;\n\t\t}\n\n\t\t// Show 'files to include' box\n\t\tif (!this.showsFileTypes()) {\n\t\t\tthis.toggleQueryDetails(true, true);\n\t\t}\n\n\t\t(include\n\t\t\t? this.inputPatternIncludes\n\t\t\t: this.inputPatternExcludes\n\t\t).setValue(folderPaths.join(\", \"));\n\t\tthis.searchWidget.focus(false);\n\t}\n\n\ttriggerQueryChange(_options?: {\n\t\tpreserveFocus?: boolean;\n\t\ttriggeredOnType?: boolean;\n\t\tdelay?: number;\n\t}) {\n\t\tconst options = {\n\t\t\tpreserveFocus: true,\n\t\t\ttriggeredOnType: false,\n\t\t\tdelay: 0,\n\t\t\t..._options,\n\t\t};\n\n\t\tif (options.triggeredOnType && !this.searchConfig.searchOnType) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.pauseSearching) {\n\t\t\tconst delay = options.triggeredOnType ? options.delay : 0;\n\t\t\tthis.triggerQueryDelayer.trigger(() => {\n\t\t\t\tthis._onQueryChanged(\n\t\t\t\t\toptions.preserveFocus,\n\t\t\t\t\toptions.triggeredOnType,\n\t\t\t\t);\n\t\t\t}, delay);\n\t\t}\n\t}\n\n\tprivate _onQueryChanged(\n\t\tpreserveFocus: boolean,\n\t\ttriggeredOnType = false,\n\t): void {\n\t\tif (!this.searchWidget.searchInput?.inputBox.isInputValid()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isRegex = this.searchWidget.searchInput.getRegex();\n\t\tconst isInNotebookMarkdownInput =\n\t\t\tthis.searchWidget.getNotebookFilters().markupInput;\n\t\tconst isInNotebookMarkdownPreview =\n\t\t\tthis.searchWidget.getNotebookFilters().markupPreview;\n\t\tconst isInNotebookCellInput =\n\t\t\tthis.searchWidget.getNotebookFilters().codeInput;\n\t\tconst isInNotebookCellOutput =\n\t\t\tthis.searchWidget.getNotebookFilters().codeOutput;\n\n\t\tconst isWholeWords = this.searchWidget.searchInput.getWholeWords();\n\t\tconst isCaseSensitive =\n\t\t\tthis.searchWidget.searchInput.getCaseSensitive();\n\t\tconst contentPattern = this.searchWidget.searchInput.getValue();\n\t\tconst excludePatternText = this.inputPatternExcludes.getValue().trim();\n\t\tconst includePatternText = this.inputPatternIncludes.getValue().trim();\n\t\tconst useExcludesAndIgnoreFiles =\n\t\t\tthis.inputPatternExcludes.useExcludesAndIgnoreFiles();\n\t\tconst onlySearchInOpenEditors =\n\t\t\tthis.inputPatternIncludes.onlySearchInOpenEditors();\n\n\t\tif (contentPattern.length === 0) {\n\t\t\tthis.clearSearchResults(false);\n\t\t\tthis.clearMessage();\n\t\t\treturn;\n\t\t}\n\n\t\tconst content: IPatternInfo = {\n\t\t\tpattern: contentPattern,\n\t\t\tisRegExp: isRegex,\n\t\t\tisCaseSensitive: isCaseSensitive,\n\t\t\tisWordMatch: isWholeWords,\n\t\t\tnotebookInfo: {\n\t\t\t\tisInNotebookMarkdownInput,\n\t\t\t\tisInNotebookMarkdownPreview,\n\t\t\t\tisInNotebookCellInput,\n\t\t\t\tisInNotebookCellOutput,\n\t\t\t},\n\t\t};\n\n\t\tconst excludePattern = [\n\t\t\t{ pattern: this.inputPatternExcludes.getValue() },\n\t\t];\n\t\tconst includePattern = this.inputPatternIncludes.getValue();\n\n\t\t// Need the full match line to correctly calculate replace text, if this is a search/replace with regex group references ($1, $2, ...).\n\t\t// 10000 chars is enough to avoid sending huge amounts of text around, if you do a replace with a longer match, it may or may not resolve the group refs correctly.\n\t\t// https://github.com/microsoft/vscode/issues/58374\n\t\tconst charsPerLine = content.isRegExp ? 10000 : 1000;\n\n\t\tconst options: ITextQueryBuilderOptions = {\n\t\t\t_reason: \"searchView\",\n\t\t\textraFileResources: this.instantiationService.invokeFunction(\n\t\t\t\tgetOutOfWorkspaceEditorResources,\n\t\t\t),\n\t\t\tmaxResults: this.searchConfig.maxResults ?? undefined,\n\t\t\tdisregardIgnoreFiles: !useExcludesAndIgnoreFiles || undefined,\n\t\t\tdisregardExcludeSettings: !useExcludesAndIgnoreFiles || undefined,\n\t\t\tonlyOpenEditors: onlySearchInOpenEditors,\n\t\t\texcludePattern,\n\t\t\tincludePattern,\n\t\t\tpreviewOptions: {\n\t\t\t\tmatchLines: 1,\n\t\t\t\tcharsPerLine,\n\t\t\t},\n\t\t\tisSmartCase: this.searchConfig.smartCase,\n\t\t\texpandPatterns: true,\n\t\t};\n\t\tconst folderResources = this.contextService.getWorkspace().folders;\n\n\t\tconst onQueryValidationError = (err: Error) => {\n\t\t\tthis.searchWidget.searchInput?.showMessage({\n\t\t\t\tcontent: err.message,\n\t\t\t\ttype: MessageType.ERROR,\n\t\t\t});\n\t\t\tthis.viewModel.searchResult.clear();\n\t\t};\n\n\t\tlet query: ITextQuery;\n\t\ttry {\n\t\t\tquery = this.queryBuilder.text(\n\t\t\t\tcontent,\n\t\t\t\tfolderResources.map((folder) => folder.uri),\n\t\t\t\toptions,\n\t\t\t);\n\t\t} catch (err) {\n\t\t\tonQueryValidationError(err);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.validateQuery(query).then(() => {\n\t\t\tthis.onQueryTriggered(\n\t\t\t\tquery,\n\t\t\t\toptions,\n\t\t\t\texcludePatternText,\n\t\t\t\tincludePatternText,\n\t\t\t\ttriggeredOnType,\n\t\t\t);\n\n\t\t\tif (!preserveFocus) {\n\t\t\t\tthis.searchWidget.focus(false, undefined, true); // focus back to input field\n\t\t\t}\n\t\t}, onQueryValidationError);\n\t}\n\n\tprivate validateQuery(query: ITextQuery): Promise<void> {\n\t\t// Validate folderQueries\n\t\tconst folderQueriesExistP = query.folderQueries.map((fq) => {\n\t\t\treturn this.fileService.exists(fq.folder).catch(() => false);\n\t\t});\n\n\t\treturn Promise.all(folderQueriesExistP).then((existResults) => {\n\t\t\t// If no folders exist, show an error message about the first one\n\t\t\tconst existingFolderQueries = query.folderQueries.filter(\n\t\t\t\t(folderQuery, i) => existResults[i],\n\t\t\t);\n\t\t\tif (!query.folderQueries.length || existingFolderQueries.length) {\n\t\t\t\tquery.folderQueries = existingFolderQueries;\n\t\t\t} else {\n\t\t\t\tconst nonExistantPath = query.folderQueries[0].folder.fsPath;\n\t\t\t\tconst searchPathNotFoundError = nls.localize(\n\t\t\t\t\t\"searchPathNotFoundError\",\n\t\t\t\t\t\"Search path not found: {0}\",\n\t\t\t\t\tnonExistantPath,\n\t\t\t\t);\n\t\t\t\treturn Promise.reject(new Error(searchPathNotFoundError));\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t});\n\t}\n\n\tprivate onQueryTriggered(\n\t\tquery: ITextQuery,\n\t\toptions: ITextQueryBuilderOptions,\n\t\texcludePatternText: string,\n\t\tincludePatternText: string,\n\t\ttriggeredOnType: boolean,\n\t): void {\n\t\tthis.addToSearchHistoryDelayer.trigger(() => {\n\t\t\tthis.searchWidget.searchInput?.onSearchSubmit();\n\t\t\tthis.inputPatternExcludes.onSearchSubmit();\n\t\t\tthis.inputPatternIncludes.onSearchSubmit();\n\t\t});\n\n\t\tthis.viewModel.cancelSearch(true);\n\t\tthis.viewModel.cancelAISearch(true);\n\n\t\tthis.currentSearchQ = this.currentSearchQ\n\t\t\t.then(() =>\n\t\t\t\tthis.doSearch(\n\t\t\t\t\tquery,\n\t\t\t\t\texcludePatternText,\n\t\t\t\t\tincludePatternText,\n\t\t\t\t\ttriggeredOnType,\n\t\t\t\t),\n\t\t\t)\n\t\t\t.then(\n\t\t\t\t() => undefined,\n\t\t\t\t() => undefined,\n\t\t\t);\n\t}\n\n\tprivate _updateResults() {\n\t\tif (this.state === SearchUIState.Idle) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\t// Search result tree update\n\t\t\tconst fileCount = this.viewModel.searchResult.fileCount(\n\t\t\t\tthis.aiResultsVisible,\n\t\t\t);\n\t\t\tif (this._visibleMatches !== fileCount) {\n\t\t\t\tthis._visibleMatches = fileCount;\n\t\t\t\tthis.refreshAndUpdateCount();\n\t\t\t}\n\t\t} finally {\n\t\t\t// show frequent progress and results by scheduling updates 80 ms after the last one\n\t\t\tthis._refreshResultsScheduler.schedule();\n\t\t}\n\t}\n\n\tprivate onSearchComplete(\n\t\tprogressComplete: () => void,\n\t\texcludePatternText?: string,\n\t\tincludePatternText?: string,\n\t\tcompleted?: ISearchComplete,\n\t) {\n\t\tthis.state = SearchUIState.Idle;\n\n\t\t// Complete up to 100% as needed\n\t\tprogressComplete();\n\n\t\t// Do final render, then expand if just 1 file with less than 50 matches\n\t\tthis.onSearchResultsChanged();\n\n\t\tconst collapseResults = this.searchConfig.collapseResults;\n\t\tif (\n\t\t\tcollapseResults !== \"alwaysCollapse\" &&\n\t\t\tthis.viewModel.searchResult.matches(this.aiResultsVisible)\n\t\t\t\t.length === 1\n\t\t) {\n\t\t\tconst onlyMatch = this.viewModel.searchResult.matches(\n\t\t\t\tthis.aiResultsVisible,\n\t\t\t)[0];\n\t\t\tif (onlyMatch.count() < 50) {\n\t\t\t\tthis.tree.expand(onlyMatch);\n\t\t\t}\n\t\t}\n\n\t\tconst hasResults = !this.viewModel.searchResult.isEmpty(\n\t\t\tthis.aiResultsVisible,\n\t\t);\n\t\tif (completed?.exit === SearchCompletionExitCode.NewSearchStarted) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (hasResults) {\n\t\t\tthis.viewModel.searchResult.toggleHighlights(this.isVisible()); // show highlights\n\n\t\t\t// Indicate final search result count for ARIA\n\t\t\taria.status(\n\t\t\t\tnls.localize(\n\t\t\t\t\t\"ariaSearchResultsStatus\",\n\t\t\t\t\t\"Search returned {0} results in {1} files\",\n\t\t\t\t\tthis.viewModel.searchResult.count(this.aiResultsVisible),\n\t\t\t\t\tthis.viewModel.searchResult.fileCount(),\n\t\t\t\t),\n\t\t\t);\n\t\t} else {\n\t\t\tconst hasExcludes = !!excludePatternText;\n\t\t\tconst hasIncludes = !!includePatternText;\n\t\t\tlet message: string;\n\n\t\t\tif (!completed) {\n\t\t\t\tmessage = SEARCH_CANCELLED_MESSAGE;\n\t\t\t} else if (this.inputPatternIncludes.onlySearchInOpenEditors()) {\n\t\t\t\tif (hasIncludes && hasExcludes) {\n\t\t\t\t\tmessage = nls.localize(\n\t\t\t\t\t\t\"noOpenEditorResultsIncludesExcludes\",\n\t\t\t\t\t\t\"No results found in open editors matching '{0}' excluding '{1}' - \",\n\t\t\t\t\t\tincludePatternText,\n\t\t\t\t\t\texcludePatternText,\n\t\t\t\t\t);\n\t\t\t\t} else if (hasIncludes) {\n\t\t\t\t\tmessage = nls.localize(\n\t\t\t\t\t\t\"noOpenEditorResultsIncludes\",\n\t\t\t\t\t\t\"No results found in open editors matching '{0}' - \",\n\t\t\t\t\t\tincludePatternText,\n\t\t\t\t\t);\n\t\t\t\t} else if (hasExcludes) {\n\t\t\t\t\tmessage = nls.localize(\n\t\t\t\t\t\t\"noOpenEditorResultsExcludes\",\n\t\t\t\t\t\t\"No results found in open editors excluding '{0}' - \",\n\t\t\t\t\t\texcludePatternText,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tmessage = nls.localize(\n\t\t\t\t\t\t\"noOpenEditorResultsFound\",\n\t\t\t\t\t\t\"No results found in open editors. Review your settings for configured exclusions and check your gitignore files - \",\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else if (hasIncludes && hasExcludes) {\n\t\t\t\tmessage = nls.localize(\n\t\t\t\t\t\"noResultsIncludesExcludes\",\n\t\t\t\t\t\"No results found in '{0}' excluding '{1}' - \",\n\t\t\t\t\tincludePatternText,\n\t\t\t\t\texcludePatternText,\n\t\t\t\t);\n\t\t\t} else if (hasIncludes) {\n\t\t\t\tmessage = nls.localize(\n\t\t\t\t\t\"noResultsIncludes\",\n\t\t\t\t\t\"No results found in '{0}' - \",\n\t\t\t\t\tincludePatternText,\n\t\t\t\t);\n\t\t\t} else if (hasExcludes) {\n\t\t\t\tmessage = nls.localize(\n\t\t\t\t\t\"noResultsExcludes\",\n\t\t\t\t\t\"No results found excluding '{0}' - \",\n\t\t\t\t\texcludePatternText,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tmessage = nls.localize(\n\t\t\t\t\t\"noResultsFound\",\n\t\t\t\t\t\"No results found. Review your settings for configured exclusions and check your gitignore files - \",\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Indicate as status to ARIA\n\t\t\taria.status(message);\n\n\t\t\tconst messageEl = this.clearMessage();\n\t\t\tdom.append(messageEl, message);\n\n\t\t\tif (!completed) {\n\t\t\t\tconst searchAgainButton = this.messageDisposables.add(\n\t\t\t\t\tnew SearchLinkButton(\n\t\t\t\t\t\tnls.localize(\"rerunSearch.message\", \"Search again\"),\n\t\t\t\t\t\t() => this.triggerQueryChange({ preserveFocus: false }),\n\t\t\t\t\t\tthis.hoverService,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tdom.append(messageEl, searchAgainButton.element);\n\t\t\t} else if (hasIncludes || hasExcludes) {\n\t\t\t\tconst searchAgainButton = this.messageDisposables.add(\n\t\t\t\t\tnew SearchLinkButton(\n\t\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\t\"rerunSearchInAll.message\",\n\t\t\t\t\t\t\t\"Search again in all files\",\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis.onSearchAgain.bind(this),\n\t\t\t\t\t\tthis.hoverService,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tdom.append(messageEl, searchAgainButton.element);\n\t\t\t} else {\n\t\t\t\tconst openSettingsButton = this.messageDisposables.add(\n\t\t\t\t\tnew SearchLinkButton(\n\t\t\t\t\t\tnls.localize(\"openSettings.message\", \"Open Settings\"),\n\t\t\t\t\t\tthis.onOpenSettings.bind(this),\n\t\t\t\t\t\tthis.hoverService,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tdom.append(messageEl, openSettingsButton.element);\n\t\t\t}\n\n\t\t\tif (completed) {\n\t\t\t\tdom.append(messageEl, $(\"span\", undefined, \" - \"));\n\n\t\t\t\tconst learnMoreButton = this.messageDisposables.add(\n\t\t\t\t\tnew SearchLinkButton(\n\t\t\t\t\t\tnls.localize(\"openSettings.learnMore\", \"Learn More\"),\n\t\t\t\t\t\tthis.onLearnMore.bind(this),\n\t\t\t\t\t\tthis.hoverService,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tdom.append(messageEl, learnMoreButton.element);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.contextService.getWorkbenchState() === WorkbenchState.EMPTY\n\t\t\t) {\n\t\t\t\tthis.showSearchWithoutFolderMessage();\n\t\t\t}\n\t\t\tthis.reLayout();\n\t\t}\n\n\t\tif (completed && completed.limitHit) {\n\t\t\tcompleted.messages.push({\n\t\t\t\ttype: TextSearchCompleteMessageType.Warning,\n\t\t\t\ttext: nls.localize(\n\t\t\t\t\t\"searchMaxResultsWarning\",\n\t\t\t\t\t\"The result set only contains a subset of all matches. Be more specific in your search to narrow down the results.\",\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\n\t\tif (completed && completed.messages) {\n\t\t\tfor (const message of completed.messages) {\n\t\t\t\tthis.addMessage(message);\n\t\t\t}\n\t\t}\n\n\t\tthis.reLayout();\n\t}\n\n\tprivate onSearchError(\n\t\te: any,\n\t\tprogressComplete: () => void,\n\t\texcludePatternText?: string,\n\t\tincludePatternText?: string,\n\t\tcompleted?: ISearchComplete,\n\t) {\n\t\tthis.state = SearchUIState.Idle;\n\t\tif (errors.isCancellationError(e)) {\n\t\t\treturn this.onSearchComplete(\n\t\t\t\tprogressComplete,\n\t\t\t\texcludePatternText,\n\t\t\t\tincludePatternText,\n\t\t\t\tcompleted,\n\t\t\t);\n\t\t} else {\n\t\t\tprogressComplete();\n\t\t\tthis.searchWidget.searchInput?.showMessage({\n\t\t\t\tcontent: e.message,\n\t\t\t\ttype: MessageType.ERROR,\n\t\t\t});\n\t\t\tthis.viewModel.searchResult.clear();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tprivate doSearch(\n\t\tquery: ITextQuery,\n\t\texcludePatternText: string,\n\t\tincludePatternText: string,\n\t\ttriggeredOnType: boolean,\n\t): Thenable<void> {\n\t\tlet progressComplete: () => void;\n\t\tthis.progressService.withProgress(\n\t\t\t{\n\t\t\t\tlocation: this.getProgressLocation(),\n\t\t\t\tdelay: triggeredOnType ? 300 : 0,\n\t\t\t},\n\t\t\t(_progress) => {\n\t\t\t\treturn new Promise<void>(\n\t\t\t\t\t(resolve) => (progressComplete = resolve),\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\tthis.searchWidget.searchInput?.clearMessage();\n\t\tthis.state = SearchUIState.Searching;\n\t\tthis.showEmptyStage();\n\n\t\tconst slowTimer = setTimeout(() => {\n\t\t\tthis.state = SearchUIState.SlowSearch;\n\t\t}, 2000);\n\n\t\tthis._visibleMatches = 0;\n\n\t\tthis._refreshResultsScheduler.schedule();\n\n\t\tthis.searchWidget.setReplaceAllActionState(false);\n\n\t\tthis.tree.setSelection([]);\n\t\tthis.tree.setFocus([]);\n\n\t\tthis.viewModel.replaceString = this.searchWidget.getReplaceValue();\n\t\tconst result = this.viewModel.search(query);\n\t\tif (this.aiResultsVisible) {\n\t\t\tconst aiResult = this.viewModel.aiSearch({\n\t\t\t\t...query,\n\t\t\t\tcontentPattern: query.contentPattern.pattern,\n\t\t\t\ttype: QueryType.aiText,\n\t\t\t});\n\t\t\treturn result.asyncResults.then(() =>\n\t\t\t\taiResult.then(\n\t\t\t\t\t(complete) => {\n\t\t\t\t\t\tclearTimeout(slowTimer);\n\t\t\t\t\t\tthis.onSearchComplete(\n\t\t\t\t\t\t\tprogressComplete,\n\t\t\t\t\t\t\texcludePatternText,\n\t\t\t\t\t\t\tincludePatternText,\n\t\t\t\t\t\t\tcomplete,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\t(e) => {\n\t\t\t\t\t\tclearTimeout(slowTimer);\n\t\t\t\t\t\tthis.onSearchError(\n\t\t\t\t\t\t\te,\n\t\t\t\t\t\t\tprogressComplete,\n\t\t\t\t\t\t\texcludePatternText,\n\t\t\t\t\t\t\tincludePatternText,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\treturn result.asyncResults.then(\n\t\t\t(complete) => {\n\t\t\t\tclearTimeout(slowTimer);\n\t\t\t\tthis.onSearchComplete(\n\t\t\t\t\tprogressComplete,\n\t\t\t\t\texcludePatternText,\n\t\t\t\t\tincludePatternText,\n\t\t\t\t\tcomplete,\n\t\t\t\t);\n\t\t\t},\n\t\t\t(e) => {\n\t\t\t\tclearTimeout(slowTimer);\n\t\t\t\tthis.onSearchError(\n\t\t\t\t\te,\n\t\t\t\t\tprogressComplete,\n\t\t\t\t\texcludePatternText,\n\t\t\t\t\tincludePatternText,\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate onOpenSettings(e: dom.EventLike): void {\n\t\tdom.EventHelper.stop(e, false);\n\t\tthis.openSettings(\n\t\t\t\"@id:files.exclude,search.exclude,search.useParentIgnoreFiles,search.useGlobalIgnoreFiles,search.useIgnoreFiles\",\n\t\t);\n\t}\n\n\tprivate openSettings(query: string): Promise<IEditorPane | undefined> {\n\t\tconst options: ISettingsEditorOptions = { query };\n\t\treturn this.contextService.getWorkbenchState() !== WorkbenchState.EMPTY\n\t\t\t? this.preferencesService.openWorkspaceSettings(options)\n\t\t\t: this.preferencesService.openUserSettings(options);\n\t}\n\n\tprivate onLearnMore(): void {\n\t\tthis.openerService.open(\n\t\t\tURI.parse(\"https://go.microsoft.com/fwlink/?linkid=853977\"),\n\t\t);\n\t}\n\n\tprivate onSearchAgain(): void {\n\t\tthis.inputPatternExcludes.setValue(\"\");\n\t\tthis.inputPatternIncludes.setValue(\"\");\n\t\tthis.inputPatternIncludes.setOnlySearchInOpenEditors(false);\n\n\t\tthis.triggerQueryChange({ preserveFocus: false });\n\t}\n\n\tprivate onEnableExcludes(): void {\n\t\tthis.toggleQueryDetails(false, true);\n\t\tthis.searchExcludePattern.setUseExcludesAndIgnoreFiles(true);\n\t}\n\n\tprivate onDisableSearchInOpenEditors(): void {\n\t\tthis.toggleQueryDetails(false, true);\n\t\tthis.inputPatternIncludes.setOnlySearchInOpenEditors(false);\n\t}\n\n\tprivate updateSearchResultCount(\n\t\tdisregardExcludesAndIgnores?: boolean,\n\t\tonlyOpenEditors?: boolean,\n\t\tclear = false,\n\t): void {\n\t\tconst fileCount = this.viewModel.searchResult.fileCount(\n\t\t\tthis.aiResultsVisible,\n\t\t);\n\t\tconst resultCount = this.viewModel.searchResult.count(\n\t\t\tthis.aiResultsVisible,\n\t\t);\n\t\tthis.hasSearchResultsKey.set(fileCount > 0);\n\n\t\tconst msgWasHidden = this.messagesElement.style.display === \"none\";\n\n\t\tconst messageEl = this.clearMessage();\n\t\tconst resultMsg = clear\n\t\t\t? \"\"\n\t\t\t: this.buildResultCountMessage(resultCount, fileCount);\n\t\tthis.tree.ariaLabel =\n\t\t\tresultMsg +\n\t\t\tnls.localize(\n\t\t\t\t\"forTerm\",\n\t\t\t\t\" - Search: {0}\",\n\t\t\t\tthis.searchResult.query?.contentPattern.pattern ?? \"\",\n\t\t\t);\n\t\tdom.append(messageEl, resultMsg);\n\n\t\tif (fileCount > 0) {\n\t\t\tif (disregardExcludesAndIgnores) {\n\t\t\t\tconst excludesDisabledMessage =\n\t\t\t\t\t\" - \" +\n\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\"useIgnoresAndExcludesDisabled\",\n\t\t\t\t\t\t\"exclude settings and ignore files are disabled\",\n\t\t\t\t\t) +\n\t\t\t\t\t\" \";\n\t\t\t\tconst enableExcludesButton = this.messageDisposables.add(\n\t\t\t\t\tnew SearchLinkButton(\n\t\t\t\t\t\tnls.localize(\"excludes.enable\", \"enable\"),\n\t\t\t\t\t\tthis.onEnableExcludes.bind(this),\n\t\t\t\t\t\tthis.hoverService,\n\t\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\t\"useExcludesAndIgnoreFilesDescription\",\n\t\t\t\t\t\t\t\"Use Exclude Settings and Ignore Files\",\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tdom.append(\n\t\t\t\t\tmessageEl,\n\t\t\t\t\t$(\n\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\texcludesDisabledMessage,\n\t\t\t\t\t\t\"(\",\n\t\t\t\t\t\tenableExcludesButton.element,\n\t\t\t\t\t\t\")\",\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (onlyOpenEditors) {\n\t\t\t\tconst searchingInOpenMessage =\n\t\t\t\t\t\" - \" +\n\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\"onlyOpenEditors\",\n\t\t\t\t\t\t\"searching only in open files\",\n\t\t\t\t\t) +\n\t\t\t\t\t\" \";\n\t\t\t\tconst disableOpenEditorsButton = this.messageDisposables.add(\n\t\t\t\t\tnew SearchLinkButton(\n\t\t\t\t\t\tnls.localize(\"openEditors.disable\", \"disable\"),\n\t\t\t\t\t\tthis.onDisableSearchInOpenEditors.bind(this),\n\t\t\t\t\t\tthis.hoverService,\n\t\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\t\"disableOpenEditors\",\n\t\t\t\t\t\t\t\"Search in entire workspace\",\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tdom.append(\n\t\t\t\t\tmessageEl,\n\t\t\t\t\t$(\n\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tsearchingInOpenMessage,\n\t\t\t\t\t\t\"(\",\n\t\t\t\t\t\tdisableOpenEditorsButton.element,\n\t\t\t\t\t\t\")\",\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tdom.append(messageEl, \" - \");\n\n\t\t\tconst openInEditorTooltip = appendKeyBindingLabel(\n\t\t\t\tnls.localize(\n\t\t\t\t\t\"openInEditor.tooltip\",\n\t\t\t\t\t\"Copy current search results to an editor\",\n\t\t\t\t),\n\t\t\t\tthis.keybindingService.lookupKeybinding(\n\t\t\t\t\tConstants.SearchCommandIds.OpenInEditorCommandId,\n\t\t\t\t),\n\t\t\t);\n\t\t\tconst openInEditorButton = this.messageDisposables.add(\n\t\t\t\tnew SearchLinkButton(\n\t\t\t\t\tnls.localize(\"openInEditor.message\", \"Open in editor\"),\n\t\t\t\t\t() =>\n\t\t\t\t\t\tthis.instantiationService.invokeFunction(\n\t\t\t\t\t\t\tcreateEditorFromSearchResult,\n\t\t\t\t\t\t\tthis.searchResult,\n\t\t\t\t\t\t\tthis.searchIncludePattern.getValue(),\n\t\t\t\t\t\t\tthis.searchExcludePattern.getValue(),\n\t\t\t\t\t\t\tthis.searchIncludePattern.onlySearchInOpenEditors(),\n\t\t\t\t\t\t),\n\t\t\t\t\tthis.hoverService,\n\t\t\t\t\topenInEditorTooltip,\n\t\t\t\t),\n\t\t\t);\n\t\t\tdom.append(messageEl, openInEditorButton.element);\n\n\t\t\tthis.reLayout();\n\t\t} else if (!msgWasHidden) {\n\t\t\tdom.hide(this.messagesElement);\n\t\t}\n\t}\n\n\tprivate addMessage(message: TextSearchCompleteMessage) {\n\t\tconst messageBox = this.messagesElement.firstChild as HTMLDivElement;\n\t\tif (!messageBox) {\n\t\t\treturn;\n\t\t}\n\t\tdom.append(\n\t\t\tmessageBox,\n\t\t\trenderSearchMessage(\n\t\t\t\tmessage,\n\t\t\t\tthis.instantiationService,\n\t\t\t\tthis.notificationService,\n\t\t\t\tthis.openerService,\n\t\t\t\tthis.commandService,\n\t\t\t\tthis.messageDisposables,\n\t\t\t\t() => this.triggerQueryChange(),\n\t\t\t),\n\t\t);\n\t}\n\n\tprivate buildResultCountMessage(\n\t\tresultCount: number,\n\t\tfileCount: number,\n\t): string {\n\t\tif (resultCount === 1 && fileCount === 1) {\n\t\t\treturn nls.localize(\n\t\t\t\t\"search.file.result\",\n\t\t\t\t\"{0} result in {1} file\",\n\t\t\t\tresultCount,\n\t\t\t\tfileCount,\n\t\t\t);\n\t\t} else if (resultCount === 1) {\n\t\t\treturn nls.localize(\n\t\t\t\t\"search.files.result\",\n\t\t\t\t\"{0} result in {1} files\",\n\t\t\t\tresultCount,\n\t\t\t\tfileCount,\n\t\t\t);\n\t\t} else if (fileCount === 1) {\n\t\t\treturn nls.localize(\n\t\t\t\t\"search.file.results\",\n\t\t\t\t\"{0} results in {1} file\",\n\t\t\t\tresultCount,\n\t\t\t\tfileCount,\n\t\t\t);\n\t\t} else {\n\t\t\treturn nls.localize(\n\t\t\t\t\"search.files.results\",\n\t\t\t\t\"{0} results in {1} files\",\n\t\t\t\tresultCount,\n\t\t\t\tfileCount,\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate showSearchWithoutFolderMessage(): void {\n\t\tthis.searchWithoutFolderMessageElement = this.clearMessage();\n\n\t\tconst textEl = dom.append(\n\t\t\tthis.searchWithoutFolderMessageElement,\n\t\t\t$(\n\t\t\t\t\"p\",\n\t\t\t\tundefined,\n\t\t\t\tnls.localize(\n\t\t\t\t\t\"searchWithoutFolder\",\n\t\t\t\t\t\"You have not opened or specified a folder. Only open files are currently searched - \",\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\n\t\tconst openFolderButton = this.messageDisposables.add(\n\t\t\tnew SearchLinkButton(\n\t\t\t\tnls.localize(\"openFolder\", \"Open Folder\"),\n\t\t\t\t() => {\n\t\t\t\t\tthis.commandService\n\t\t\t\t\t\t.executeCommand(\n\t\t\t\t\t\t\tenv.isMacintosh && env.isNative\n\t\t\t\t\t\t\t\t? OpenFileFolderAction.ID\n\t\t\t\t\t\t\t\t: OpenFolderAction.ID,\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.catch((err) => errors.onUnexpectedError(err));\n\t\t\t\t},\n\t\t\t\tthis.hoverService,\n\t\t\t),\n\t\t);\n\t\tdom.append(textEl, openFolderButton.element);\n\t}\n\n\tprivate showEmptyStage(forceHideMessages = false): void {\n\t\tconst showingCancelled =\n\t\t\t(this.messagesElement.firstChild?.textContent?.indexOf(\n\t\t\t\tSEARCH_CANCELLED_MESSAGE,\n\t\t\t) ?? -1) > -1;\n\n\t\t// clean up ui\n\t\t// this.replaceService.disposeAllReplacePreviews();\n\t\tif (\n\t\t\tshowingCancelled ||\n\t\t\tforceHideMessages ||\n\t\t\t!this.configurationService.getValue<ISearchConfiguration>().search\n\t\t\t\t.searchOnType\n\t\t) {\n\t\t\t// when in search to type, don't preemptively hide, as it causes flickering and shifting of the live results\n\t\t\tdom.hide(this.messagesElement);\n\t\t}\n\n\t\tdom.show(this.resultsElement);\n\t\tthis.currentSelectedFileMatch = undefined;\n\t}\n\n\tprivate shouldOpenInNotebookEditor(match: Match, uri: URI): boolean {\n\t\t// Untitled files will return a false positive for getContributedNotebookTypes.\n\t\t// Since untitled files are already open, then untitled notebooks should return NotebookMatch results.\n\t\treturn (\n\t\t\tmatch instanceof MatchInNotebook ||\n\t\t\t(uri.scheme !== network.Schemas.untitled &&\n\t\t\t\tthis.notebookService.getContributedNotebookTypes(uri).length >\n\t\t\t\t\t0)\n\t\t);\n\t}\n\n\tprivate onFocus(\n\t\tlineMatch: Match,\n\t\tpreserveFocus?: boolean,\n\t\tsideBySide?: boolean,\n\t\tpinned?: boolean,\n\t): Promise<any> {\n\t\tconst useReplacePreview =\n\t\t\tthis.configurationService.getValue<ISearchConfiguration>().search\n\t\t\t\t.useReplacePreview;\n\n\t\tconst resource =\n\t\t\tlineMatch instanceof Match\n\t\t\t\t? lineMatch.parent().resource\n\t\t\t\t: (<FileMatch>lineMatch).resource;\n\t\treturn useReplacePreview &&\n\t\t\tthis.viewModel.isReplaceActive() &&\n\t\t\t!!this.viewModel.replaceString &&\n\t\t\t!this.shouldOpenInNotebookEditor(lineMatch, resource)\n\t\t\t? this.replaceService.openReplacePreview(\n\t\t\t\t\tlineMatch,\n\t\t\t\t\tpreserveFocus,\n\t\t\t\t\tsideBySide,\n\t\t\t\t\tpinned,\n\t\t\t\t)\n\t\t\t: this.open(lineMatch, preserveFocus, sideBySide, pinned, resource);\n\t}\n\n\tasync open(\n\t\telement: FileMatchOrMatch,\n\t\tpreserveFocus?: boolean,\n\t\tsideBySide?: boolean,\n\t\tpinned?: boolean,\n\t\tresourceInput?: URI,\n\t): Promise<void> {\n\t\tconst selection = getEditorSelectionFromMatch(element, this.viewModel);\n\t\tconst oldParentMatches =\n\t\t\telement instanceof Match ? element.parent().matches() : [];\n\t\tconst resource =\n\t\t\tresourceInput ??\n\t\t\t(element instanceof Match\n\t\t\t\t? element.parent().resource\n\t\t\t\t: (<FileMatch>element).resource);\n\t\tlet editor: IEditorPane | undefined;\n\n\t\tconst options = {\n\t\t\tpreserveFocus,\n\t\t\tpinned,\n\t\t\tselection,\n\t\t\trevealIfVisible: true,\n\t\t};\n\n\t\ttry {\n\t\t\teditor = await this.editorService.openEditor(\n\t\t\t\t{\n\t\t\t\t\tresource: resource,\n\t\t\t\t\toptions,\n\t\t\t\t},\n\t\t\t\tsideBySide ? SIDE_GROUP : ACTIVE_GROUP,\n\t\t\t);\n\n\t\t\tconst editorControl = editor?.getControl();\n\t\t\tif (\n\t\t\t\telement instanceof Match &&\n\t\t\t\tpreserveFocus &&\n\t\t\t\tisCodeEditor(editorControl)\n\t\t\t) {\n\t\t\t\tthis.viewModel.searchResult.rangeHighlightDecorations.highlightRange(\n\t\t\t\t\teditorControl.getModel()!,\n\t\t\t\t\telement.range(),\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.viewModel.searchResult.rangeHighlightDecorations.removeHighlightRange();\n\t\t\t}\n\t\t} catch (err) {\n\t\t\terrors.onUnexpectedError(err);\n\t\t\treturn;\n\t\t}\n\n\t\tif (editor instanceof NotebookEditor) {\n\t\t\tconst elemParent = element.parent() as FileMatch;\n\t\t\tif (element instanceof Match) {\n\t\t\t\tif (element instanceof MatchInNotebook) {\n\t\t\t\t\telement.parent().showMatch(element);\n\t\t\t\t} else {\n\t\t\t\t\tconst editorWidget = editor.getControl();\n\t\t\t\t\tif (editorWidget) {\n\t\t\t\t\t\t// Ensure that the editor widget is binded. If if is, then this should return immediately.\n\t\t\t\t\t\t// Otherwise, it will bind the widget.\n\t\t\t\t\t\telemParent.bindNotebookEditorWidget(editorWidget);\n\t\t\t\t\t\tawait elemParent.updateMatchesForEditorWidget();\n\n\t\t\t\t\t\tconst matchIndex = oldParentMatches.findIndex(\n\t\t\t\t\t\t\t(e) => e.id() === element.id(),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst matches = elemParent.matches();\n\t\t\t\t\t\tconst match =\n\t\t\t\t\t\t\tmatchIndex >= matches.length\n\t\t\t\t\t\t\t\t? matches[matches.length - 1]\n\t\t\t\t\t\t\t\t: matches[matchIndex];\n\n\t\t\t\t\t\tif (match instanceof MatchInNotebook) {\n\t\t\t\t\t\t\telemParent.showMatch(match);\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t!this.tree.getFocus().includes(match) ||\n\t\t\t\t\t\t\t\t!this.tree.getSelection().includes(match)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthis.tree.setSelection(\n\t\t\t\t\t\t\t\t\t[match],\n\t\t\t\t\t\t\t\t\tgetSelectionKeyboardEvent(),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.tree.setFocus([match]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\topenEditorWithMultiCursor(element: FileMatchOrMatch): Promise<void> {\n\t\tconst resource =\n\t\t\telement instanceof Match\n\t\t\t\t? element.parent().resource\n\t\t\t\t: (<FileMatch>element).resource;\n\t\treturn this.editorService\n\t\t\t.openEditor({\n\t\t\t\tresource: resource,\n\t\t\t\toptions: {\n\t\t\t\t\tpreserveFocus: false,\n\t\t\t\t\tpinned: true,\n\t\t\t\t\trevealIfVisible: true,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.then((editor) => {\n\t\t\t\tif (editor) {\n\t\t\t\t\tlet fileMatch = null;\n\t\t\t\t\tif (element instanceof FileMatch) {\n\t\t\t\t\t\tfileMatch = element;\n\t\t\t\t\t} else if (element instanceof Match) {\n\t\t\t\t\t\tfileMatch = element.parent();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (fileMatch) {\n\t\t\t\t\t\tconst selections = fileMatch\n\t\t\t\t\t\t\t.matches()\n\t\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t\t(m) =>\n\t\t\t\t\t\t\t\t\tnew Selection(\n\t\t\t\t\t\t\t\t\t\tm.range().startLineNumber,\n\t\t\t\t\t\t\t\t\t\tm.range().startColumn,\n\t\t\t\t\t\t\t\t\t\tm.range().endLineNumber,\n\t\t\t\t\t\t\t\t\t\tm.range().endColumn,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\tconst codeEditor = getCodeEditor(editor.getControl());\n\t\t\t\t\t\tif (codeEditor) {\n\t\t\t\t\t\t\tconst multiCursorController =\n\t\t\t\t\t\t\t\tMultiCursorSelectionController.get(codeEditor);\n\t\t\t\t\t\t\tmultiCursorController?.selectAllUsingSelections(\n\t\t\t\t\t\t\t\tselections,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.viewModel.searchResult.rangeHighlightDecorations.removeHighlightRange();\n\t\t\t}, errors.onUnexpectedError);\n\t}\n\n\tprivate onUntitledDidDispose(resource: URI): void {\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove search results from this resource as it got disposed\n\t\tlet matches = this.viewModel.searchResult.matches();\n\t\tfor (let i = 0, len = matches.length; i < len; i++) {\n\t\t\tif (resource.toString() === matches[i].resource.toString()) {\n\t\t\t\tthis.viewModel.searchResult.remove(matches[i]);\n\t\t\t}\n\t\t}\n\t\tmatches = this.viewModel.searchResult.matches(true);\n\t\tfor (let i = 0, len = matches.length; i < len; i++) {\n\t\t\tif (resource.toString() === matches[i].resource.toString()) {\n\t\t\t\tthis.viewModel.searchResult.remove(matches[i]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onFilesChanged(e: FileChangesEvent): void {\n\t\tif (\n\t\t\t!this.viewModel ||\n\t\t\t(this.searchConfig.sortOrder !== SearchSortOrder.Modified &&\n\t\t\t\t!e.gotDeleted())\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst matches = this.viewModel.searchResult.matches();\n\t\tif (e.gotDeleted()) {\n\t\t\tconst deletedMatches = matches.filter((m) =>\n\t\t\t\te.contains(m.resource, FileChangeType.DELETED),\n\t\t\t);\n\n\t\t\tthis.viewModel.searchResult.remove(deletedMatches);\n\t\t} else {\n\t\t\t// Check if the changed file contained matches\n\t\t\tconst changedMatches = matches.filter((m) =>\n\t\t\t\te.contains(m.resource),\n\t\t\t);\n\t\t\tif (\n\t\t\t\tchangedMatches.length &&\n\t\t\t\tthis.searchConfig.sortOrder === SearchSortOrder.Modified\n\t\t\t) {\n\t\t\t\t// No matches need to be removed, but modified files need to have their file stat updated.\n\t\t\t\tthis.updateFileStats(changedMatches).then(() =>\n\t\t\t\t\tthis.refreshTree(),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate get searchConfig(): ISearchConfigurationProperties {\n\t\treturn this.configurationService.getValue<ISearchConfigurationProperties>(\n\t\t\t\"search\",\n\t\t);\n\t}\n\n\tprivate clearHistory(): void {\n\t\tthis.searchWidget.clearHistory();\n\t\tthis.inputPatternExcludes.clearHistory();\n\t\tthis.inputPatternIncludes.clearHistory();\n\t}\n\n\tpublic override saveState(): void {\n\t\t// This can be called before renderBody() method gets called for the first time\n\t\t// if we move the searchView inside another viewPaneContainer\n\t\tif (!this.searchWidget) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst patternExcludes =\n\t\t\tthis.inputPatternExcludes?.getValue().trim() ?? \"\";\n\t\tconst patternIncludes =\n\t\t\tthis.inputPatternIncludes?.getValue().trim() ?? \"\";\n\t\tconst onlyOpenEditors =\n\t\t\tthis.inputPatternIncludes?.onlySearchInOpenEditors() ?? false;\n\t\tconst useExcludesAndIgnoreFiles =\n\t\t\tthis.inputPatternExcludes?.useExcludesAndIgnoreFiles() ?? true;\n\t\tconst preserveCase = this.viewModel.preserveCase;\n\n\t\tif (this.searchWidget.searchInput) {\n\t\t\tconst isRegex = this.searchWidget.searchInput.getRegex();\n\t\t\tconst isWholeWords = this.searchWidget.searchInput.getWholeWords();\n\t\t\tconst isCaseSensitive =\n\t\t\t\tthis.searchWidget.searchInput.getCaseSensitive();\n\t\t\tconst contentPattern = this.searchWidget.searchInput.getValue();\n\n\t\t\tconst isInNotebookCellInput =\n\t\t\t\tthis.searchWidget.getNotebookFilters().codeInput;\n\t\t\tconst isInNotebookCellOutput =\n\t\t\t\tthis.searchWidget.getNotebookFilters().codeOutput;\n\t\t\tconst isInNotebookMarkdownInput =\n\t\t\t\tthis.searchWidget.getNotebookFilters().markupInput;\n\t\t\tconst isInNotebookMarkdownPreview =\n\t\t\t\tthis.searchWidget.getNotebookFilters().markupPreview;\n\n\t\t\tthis.viewletState[\"query.contentPattern\"] = contentPattern;\n\t\t\tthis.viewletState[\"query.regex\"] = isRegex;\n\t\t\tthis.viewletState[\"query.wholeWords\"] = isWholeWords;\n\t\t\tthis.viewletState[\"query.caseSensitive\"] = isCaseSensitive;\n\n\t\t\tthis.viewletState[\"query.isInNotebookMarkdownInput\"] =\n\t\t\t\tisInNotebookMarkdownInput;\n\t\t\tthis.viewletState[\"query.isInNotebookMarkdownPreview\"] =\n\t\t\t\tisInNotebookMarkdownPreview;\n\t\t\tthis.viewletState[\"query.isInNotebookCellInput\"] =\n\t\t\t\tisInNotebookCellInput;\n\t\t\tthis.viewletState[\"query.isInNotebookCellOutput\"] =\n\t\t\t\tisInNotebookCellOutput;\n\t\t}\n\n\t\tthis.viewletState[\"query.folderExclusions\"] = patternExcludes;\n\t\tthis.viewletState[\"query.folderIncludes\"] = patternIncludes;\n\t\tthis.viewletState[\"query.useExcludesAndIgnoreFiles\"] =\n\t\t\tuseExcludesAndIgnoreFiles;\n\t\tthis.viewletState[\"query.preserveCase\"] = preserveCase;\n\t\tthis.viewletState[\"query.onlyOpenEditors\"] = onlyOpenEditors;\n\n\t\tconst isReplaceShown = this.searchAndReplaceWidget.isReplaceShown();\n\t\tthis.viewletState[\"view.showReplace\"] = isReplaceShown;\n\t\tthis.viewletState[\"view.treeLayout\"] = this.isTreeLayoutViewVisible;\n\t\tthis.viewletState[\"query.replaceText\"] =\n\t\t\tisReplaceShown && this.searchWidget.getReplaceValue();\n\n\t\tthis._saveSearchHistoryService();\n\n\t\tthis.memento.saveMemento();\n\n\t\tsuper.saveState();\n\t}\n\n\tprivate _saveSearchHistoryService() {\n\t\tif (this.searchWidget === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tconst history: ISearchHistoryValues = Object.create(null);\n\n\t\tconst searchHistory = this.searchWidget.getSearchHistory();\n\t\tif (searchHistory && searchHistory.length) {\n\t\t\thistory.search = searchHistory;\n\t\t}\n\n\t\tconst replaceHistory = this.searchWidget.getReplaceHistory();\n\t\tif (replaceHistory && replaceHistory.length) {\n\t\t\thistory.replace = replaceHistory;\n\t\t}\n\n\t\tconst patternExcludesHistory = this.inputPatternExcludes.getHistory();\n\t\tif (patternExcludesHistory && patternExcludesHistory.length) {\n\t\t\thistory.exclude = patternExcludesHistory;\n\t\t}\n\n\t\tconst patternIncludesHistory = this.inputPatternIncludes.getHistory();\n\t\tif (patternIncludesHistory && patternIncludesHistory.length) {\n\t\t\thistory.include = patternIncludesHistory;\n\t\t}\n\n\t\tthis.searchHistoryService.save(history);\n\t}\n\n\tprivate async retrieveFileStats(): Promise<void> {\n\t\tconst files = this.searchResult\n\t\t\t.matches(this.aiResultsVisible)\n\t\t\t.filter((f) => !f.fileStat)\n\t\t\t.map((f) => f.resolveFileStat(this.fileService));\n\t\tawait Promise.all(files);\n\t}\n\n\tprivate async updateFileStats(elements: FileMatch[]): Promise<void> {\n\t\tconst files = elements.map((f) => f.resolveFileStat(this.fileService));\n\t\tawait Promise.all(files);\n\t}\n\n\tprivate removeFileStats(): void {\n\t\tfor (const fileMatch of this.searchResult.matches()) {\n\t\t\tfileMatch.fileStat = undefined;\n\t\t}\n\t\tfor (const fileMatch of this.searchResult.matches(true)) {\n\t\t\tfileMatch.fileStat = undefined;\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tthis.isDisposed = true;\n\t\tthis.saveState();\n\t\tsuper.dispose();\n\t}\n}\n\nclass SearchLinkButton extends Disposable {\n\tpublic readonly element: HTMLElement;\n\n\tconstructor(\n\t\tlabel: string,\n\t\thandler: (e: dom.EventLike) => unknown,\n\t\thoverService: IHoverService,\n\t\ttooltip?: string,\n\t) {\n\t\tsuper();\n\t\tthis.element = $(\"a.pointer\", { tabindex: 0 }, label);\n\t\tthis._register(\n\t\t\thoverService.setupManagedHover(\n\t\t\t\tgetDefaultHoverDelegate(\"mouse\"),\n\t\t\t\tthis.element,\n\t\t\t\ttooltip,\n\t\t\t),\n\t\t);\n\t\tthis.addEventHandlers(handler);\n\t}\n\n\tprivate addEventHandlers(handler: (e: dom.EventLike) => unknown): void {\n\t\tconst wrappedHandler = (e: dom.EventLike) => {\n\t\t\tdom.EventHelper.stop(e, false);\n\t\t\thandler(e);\n\t\t};\n\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tthis.element,\n\t\t\t\tdom.EventType.CLICK,\n\t\t\t\twrappedHandler,\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tthis.element,\n\t\t\t\tdom.EventType.KEY_DOWN,\n\t\t\t\t(e) => {\n\t\t\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\t\t\tif (\n\t\t\t\t\t\tevent.equals(KeyCode.Space) ||\n\t\t\t\t\t\tevent.equals(KeyCode.Enter)\n\t\t\t\t\t) {\n\t\t\t\t\t\twrappedHandler(e);\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\t}\n}\n\nexport function getEditorSelectionFromMatch(\n\telement: FileMatchOrMatch,\n\tviewModel: SearchModel,\n): any {\n\tlet match: Match | null = null;\n\tif (element instanceof Match) {\n\t\tmatch = element;\n\t}\n\tif (element instanceof FileMatch && element.count() > 0) {\n\t\tmatch = element.matches()[element.matches().length - 1];\n\t}\n\tif (match) {\n\t\tconst range = match.range();\n\t\tif (viewModel.isReplaceActive() && !!viewModel.replaceString) {\n\t\t\tconst replaceString = match.replaceString;\n\t\t\treturn {\n\t\t\t\tstartLineNumber: range.startLineNumber,\n\t\t\t\tstartColumn: range.startColumn,\n\t\t\t\tendLineNumber: range.startLineNumber,\n\t\t\t\tendColumn: range.startColumn + replaceString.length,\n\t\t\t};\n\t\t}\n\t\treturn range;\n\t}\n\treturn undefined;\n}\n\nexport function getSelectionTextFromEditor(\n\tallowUnselectedWord: boolean,\n\tactiveEditor: IEditor,\n): string | null {\n\tlet editor = activeEditor;\n\n\tif (isDiffEditor(editor)) {\n\t\tif (editor.getOriginalEditor().hasTextFocus()) {\n\t\t\teditor = editor.getOriginalEditor();\n\t\t} else {\n\t\t\teditor = editor.getModifiedEditor();\n\t\t}\n\t}\n\n\tif (!isCodeEditor(editor) || !editor.hasModel()) {\n\t\treturn null;\n\t}\n\n\tconst range = editor.getSelection();\n\tif (!range) {\n\t\treturn null;\n\t}\n\n\tif (range.isEmpty()) {\n\t\tif (allowUnselectedWord) {\n\t\t\tconst wordAtPosition = editor\n\t\t\t\t.getModel()\n\t\t\t\t.getWordAtPosition(range.getStartPosition());\n\t\t\treturn wordAtPosition?.word ?? null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tlet searchText = \"\";\n\tfor (let i = range.startLineNumber; i <= range.endLineNumber; i++) {\n\t\tlet lineText = editor.getModel().getLineContent(i);\n\t\tif (i === range.endLineNumber) {\n\t\t\tlineText = lineText.substring(0, range.endColumn - 1);\n\t\t}\n\n\t\tif (i === range.startLineNumber) {\n\t\t\tlineText = lineText.substring(range.startColumn - 1);\n\t\t}\n\n\t\tif (i !== range.startLineNumber) {\n\t\t\tlineText = \"\\n\" + lineText;\n\t\t}\n\n\t\tsearchText += lineText;\n\t}\n\n\treturn searchText;\n}\n"],
  "mappings": "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",
  "names": ["SearchViewPosition"]
}
