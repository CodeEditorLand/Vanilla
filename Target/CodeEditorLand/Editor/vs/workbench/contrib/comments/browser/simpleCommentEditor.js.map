{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/comments/browser/simpleCommentEditor.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { EditorOption, IEditorOptions } from '../../../../editor/common/config/editorOptions.js';\nimport { EditorAction, EditorContributionInstantiation, EditorExtensionsRegistry, IEditorContributionDescription } from '../../../../editor/browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { CodeEditorWidget, ICodeEditorWidgetOptions } from '../../../../editor/browser/widget/codeEditor/codeEditorWidget.js';\nimport { IContextKeyService, RawContextKey, IContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\n\n// Allowed Editor Contributions:\nimport { MenuPreventer } from '../../codeEditor/browser/menuPreventer.js';\nimport { EditorDictation } from '../../codeEditor/browser/dictation/editorDictation.js';\nimport { ContextMenuController } from '../../../../editor/contrib/contextmenu/browser/contextmenu.js';\nimport { SuggestController } from '../../../../editor/contrib/suggest/browser/suggestController.js';\nimport { SnippetController2 } from '../../../../editor/contrib/snippet/browser/snippetController2.js';\nimport { TabCompletionController } from '../../snippets/browser/tabCompletion.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ICommentThreadWidget } from '../common/commentThreadWidget.js';\nimport { CommentContextKeys } from '../common/commentContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../../editor/common/services/languageFeatures.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport { CopyPasteController } from '../../../../editor/contrib/dropOrPasteInto/browser/copyPasteController.js';\nimport { CodeActionController } from '../../../../editor/contrib/codeAction/browser/codeActionController.js';\nimport { DropIntoEditorController } from '../../../../editor/contrib/dropOrPasteInto/browser/dropIntoEditorController.js';\nimport { InlineCompletionsController } from '../../../../editor/contrib/inlineCompletions/browser/controller/inlineCompletionsController.js';\nimport { LinkDetector } from '../../../../editor/contrib/links/browser/links.js';\nimport { MessageController } from '../../../../editor/contrib/message/browser/messageController.js';\nimport { SelectionClipboardContributionID } from '../../codeEditor/browser/selectionClipboard.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ContentHoverController } from '../../../../editor/contrib/hover/browser/contentHoverController.js';\nimport { GlyphHoverController } from '../../../../editor/contrib/hover/browser/glyphHoverController.js';\n\nexport const ctxCommentEditorFocused = new RawContextKey<boolean>('commentEditorFocused', false);\nexport const MIN_EDITOR_HEIGHT = 5 * 18;\nexport const MAX_EDITOR_HEIGHT = 25 * 18;\n\nexport interface LayoutableEditor {\n\tgetLayoutInfo(): { height: number };\n}\n\nexport class SimpleCommentEditor extends CodeEditorWidget {\n\tprivate _parentThread: ICommentThreadWidget;\n\tprivate _commentEditorFocused: IContextKey<boolean>;\n\tprivate _commentEditorEmpty: IContextKey<boolean>;\n\n\tconstructor(\n\t\tdomElement: HTMLElement,\n\t\toptions: IEditorOptions,\n\t\tscopedContextKeyService: IContextKeyService,\n\t\tparentThread: ICommentThreadWidget,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ICodeEditorService codeEditorService: ICodeEditorService,\n\t\t@ICommandService commandService: ICommandService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IAccessibilityService accessibilityService: IAccessibilityService,\n\t\t@ILanguageConfigurationService languageConfigurationService: ILanguageConfigurationService,\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService,\n\t) {\n\t\tconst codeEditorWidgetOptions: ICodeEditorWidgetOptions = {\n\t\t\tcontributions: <IEditorContributionDescription[]>[\n\t\t\t\t{ id: MenuPreventer.ID, ctor: MenuPreventer, instantiation: EditorContributionInstantiation.BeforeFirstInteraction },\n\t\t\t\t{ id: ContextMenuController.ID, ctor: ContextMenuController, instantiation: EditorContributionInstantiation.BeforeFirstInteraction },\n\t\t\t\t{ id: SuggestController.ID, ctor: SuggestController, instantiation: EditorContributionInstantiation.Eager },\n\t\t\t\t{ id: SnippetController2.ID, ctor: SnippetController2, instantiation: EditorContributionInstantiation.Lazy },\n\t\t\t\t{ id: TabCompletionController.ID, ctor: TabCompletionController, instantiation: EditorContributionInstantiation.Eager }, // eager because it needs to define a context key\n\t\t\t\t{ id: EditorDictation.ID, ctor: EditorDictation, instantiation: EditorContributionInstantiation.Lazy },\n\t\t\t\t...EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\t\tCopyPasteController.ID,\n\t\t\t\t\tDropIntoEditorController.ID,\n\t\t\t\t\tLinkDetector.ID,\n\t\t\t\t\tMessageController.ID,\n\t\t\t\t\tContentHoverController.ID,\n\t\t\t\t\tGlyphHoverController.ID,\n\t\t\t\t\tSelectionClipboardContributionID,\n\t\t\t\t\tInlineCompletionsController.ID,\n\t\t\t\t\tCodeActionController.ID,\n\t\t\t\t])\n\t\t\t],\n\t\t\tcontextMenuId: MenuId.SimpleEditorContext\n\t\t};\n\n\t\tsuper(domElement, options, codeEditorWidgetOptions, instantiationService, codeEditorService, commandService, scopedContextKeyService, themeService, notificationService, accessibilityService, languageConfigurationService, languageFeaturesService);\n\n\t\tthis._commentEditorFocused = ctxCommentEditorFocused.bindTo(scopedContextKeyService);\n\t\tthis._commentEditorEmpty = CommentContextKeys.commentIsEmpty.bindTo(scopedContextKeyService);\n\t\tthis._commentEditorEmpty.set(!this.getModel()?.getValueLength());\n\t\tthis._parentThread = parentThread;\n\n\t\tthis._register(this.onDidFocusEditorWidget(_ => this._commentEditorFocused.set(true)));\n\n\t\tthis._register(this.onDidChangeModelContent(e => this._commentEditorEmpty.set(!this.getModel()?.getValueLength())));\n\t\tthis._register(this.onDidBlurEditorWidget(_ => this._commentEditorFocused.reset()));\n\t}\n\n\tgetParentThread(): ICommentThreadWidget {\n\t\treturn this._parentThread;\n\t}\n\n\tprotected _getActions(): Iterable<EditorAction> {\n\t\treturn EditorExtensionsRegistry.getEditorActions();\n\t}\n\n\tpublic static getEditorOptions(configurationService: IConfigurationService): IEditorOptions {\n\t\treturn {\n\t\t\twordWrap: 'on',\n\t\t\tglyphMargin: false,\n\t\t\tlineNumbers: 'off',\n\t\t\tfolding: false,\n\t\t\tselectOnLineNumbers: false,\n\t\t\tscrollbar: {\n\t\t\t\tvertical: 'visible',\n\t\t\t\tverticalScrollbarSize: 14,\n\t\t\t\thorizontal: 'auto',\n\t\t\t\tuseShadows: true,\n\t\t\t\tverticalHasArrows: false,\n\t\t\t\thorizontalHasArrows: false,\n\t\t\t\talwaysConsumeMouseWheel: false\n\t\t\t},\n\t\t\toverviewRulerLanes: 2,\n\t\t\tlineDecorationsWidth: 0,\n\t\t\tscrollBeyondLastLine: false,\n\t\t\trenderLineHighlight: 'none',\n\t\t\tfixedOverflowWidgets: true,\n\t\t\tacceptSuggestionOnEnter: 'smart',\n\t\t\tminimap: {\n\t\t\t\tenabled: false\n\t\t\t},\n\t\t\tdropIntoEditor: { enabled: true },\n\t\t\tautoClosingBrackets: configurationService.getValue('editor.autoClosingBrackets'),\n\t\t\tquickSuggestions: false,\n\t\t\taccessibilitySupport: configurationService.getValue<'auto' | 'off' | 'on'>('editor.accessibilitySupport'),\n\t\t\tfontFamily: configurationService.getValue('editor.fontFamily'),\n\t\t};\n\t}\n}\n\nexport function calculateEditorHeight(parentEditor: LayoutableEditor, editor: ICodeEditor, currentHeight: number): number {\n\tconst layoutInfo = editor.getLayoutInfo();\n\tconst lineHeight = editor.getOption(EditorOption.lineHeight);\n\tconst contentHeight = (editor._getViewModel()?.getLineCount()! * lineHeight); // Can't just call getContentHeight() because it returns an incorrect, large, value when the editor is first created.\n\tif ((contentHeight > layoutInfo.height) ||\n\t\t(contentHeight < layoutInfo.height && currentHeight > MIN_EDITOR_HEIGHT)) {\n\t\tconst linesToAdd = Math.ceil((contentHeight - layoutInfo.height) / lineHeight);\n\t\tconst proposedHeight = layoutInfo.height + (lineHeight * linesToAdd);\n\t\treturn clamp(proposedHeight, MIN_EDITOR_HEIGHT, clamp(parentEditor.getLayoutInfo().height - 90, MIN_EDITOR_HEIGHT, MAX_EDITOR_HEIGHT));\n\t}\n\treturn currentHeight;\n}\n"],
  "mappings": "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",
  "names": []
}
