var x=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var g=(a,t,i,o)=>{for(var e=o>1?void 0:o?M(t,i):t,r=a.length-1,s;r>=0;r--)(s=a[r])&&(e=(o?s(t,i,e):s(e))||e);return o&&e&&x(t,i,e),e},n=(a,t)=>(i,o)=>t(i,o,a);import{clamp as I}from"../../../../../vs/base/common/numbers.js";import"../../../../../vs/editor/browser/editorBrowser.js";import{EditorContributionInstantiation as m,EditorExtensionsRegistry as u}from"../../../../../vs/editor/browser/editorExtensions.js";import{ICodeEditorService as H}from"../../../../../vs/editor/browser/services/codeEditorService.js";import{CodeEditorWidget as O}from"../../../../../vs/editor/browser/widget/codeEditor/codeEditorWidget.js";import{EditorOption as W}from"../../../../../vs/editor/common/config/editorOptions.js";import{ILanguageConfigurationService as F}from"../../../../../vs/editor/common/languages/languageConfigurationRegistry.js";import{ILanguageFeaturesService as A}from"../../../../../vs/editor/common/services/languageFeatures.js";import{CodeActionController as w}from"../../../../../vs/editor/contrib/codeAction/browser/codeActionController.js";import{ContextMenuController as f}from"../../../../../vs/editor/contrib/contextmenu/browser/contextmenu.js";import{CopyPasteController as B}from"../../../../../vs/editor/contrib/dropOrPasteInto/browser/copyPasteController.js";import{DropIntoEditorController as V}from"../../../../../vs/editor/contrib/dropOrPasteInto/browser/dropIntoEditorController.js";import{ContentHoverController as z}from"../../../../../vs/editor/contrib/hover/browser/contentHoverController2.js";import{MarginHoverController as K}from"../../../../../vs/editor/contrib/hover/browser/marginHoverController.js";import{InlineCompletionsController as N}from"../../../../../vs/editor/contrib/inlineCompletions/browser/controller/inlineCompletionsController.js";import{LinkDetector as R}from"../../../../../vs/editor/contrib/links/browser/links.js";import{MessageController as k}from"../../../../../vs/editor/contrib/message/browser/messageController.js";import{SnippetController2 as h}from"../../../../../vs/editor/contrib/snippet/browser/snippetController2.js";import{SuggestController as C}from"../../../../../vs/editor/contrib/suggest/browser/suggestController.js";import{IAccessibilityService as P}from"../../../../../vs/platform/accessibility/common/accessibility.js";import{MenuId as G}from"../../../../../vs/platform/actions/common/actions.js";import{ICommandService as q}from"../../../../../vs/platform/commands/common/commands.js";import"../../../../../vs/platform/configuration/common/configuration.js";import{RawContextKey as X}from"../../../../../vs/platform/contextkey/common/contextkey.js";import{IInstantiationService as j}from"../../../../../vs/platform/instantiation/common/instantiation.js";import{INotificationService as J}from"../../../../../vs/platform/notification/common/notification.js";import{IThemeService as Q}from"../../../../../vs/platform/theme/common/themeService.js";import{EditorDictation as E}from"../../../../../vs/workbench/contrib/codeEditor/browser/dictation/editorDictation.js";import{MenuPreventer as b}from"../../../../../vs/workbench/contrib/codeEditor/browser/menuPreventer.js";import{SelectionClipboardContributionID as U}from"../../../../../vs/workbench/contrib/codeEditor/browser/selectionClipboard.js";import{CommentContextKeys as Y}from"../../../../../vs/workbench/contrib/comments/common/commentContextKeys.js";import"../../../../../vs/workbench/contrib/comments/common/commentThreadWidget.js";import{TabCompletionController as v}from"../../../../../vs/workbench/contrib/snippets/browser/tabCompletion.js";const Z=new X("commentEditorFocused",!1),l=5*18,$=25*18;let d=class extends O{_parentThread;_commentEditorFocused;_commentEditorEmpty;constructor(t,i,o,e,r,s,c,y,D,S,_,L){const T={contributions:[{id:b.ID,ctor:b,instantiation:m.BeforeFirstInteraction},{id:f.ID,ctor:f,instantiation:m.BeforeFirstInteraction},{id:C.ID,ctor:C,instantiation:m.Eager},{id:h.ID,ctor:h,instantiation:m.Lazy},{id:v.ID,ctor:v,instantiation:m.Eager},{id:E.ID,ctor:E,instantiation:m.Lazy},...u.getSomeEditorContributions([B.ID,V.ID,R.ID,k.ID,z.ID,K.ID,U,N.ID,w.ID])],contextMenuId:G.SimpleEditorContext};super(t,i,T,r,s,c,o,y,D,S,_,L),this._commentEditorFocused=Z.bindTo(o),this._commentEditorEmpty=Y.commentIsEmpty.bindTo(o),this._commentEditorEmpty.set(!this.getModel()?.getValueLength()),this._parentThread=e,this._register(this.onDidFocusEditorWidget(p=>this._commentEditorFocused.set(!0))),this._register(this.onDidChangeModelContent(p=>this._commentEditorEmpty.set(!this.getModel()?.getValueLength()))),this._register(this.onDidBlurEditorWidget(p=>this._commentEditorFocused.reset()))}getParentThread(){return this._parentThread}_getActions(){return u.getEditorActions()}static getEditorOptions(t){return{wordWrap:"on",glyphMargin:!1,lineNumbers:"off",folding:!1,selectOnLineNumbers:!1,scrollbar:{vertical:"visible",verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,lineDecorationsWidth:0,scrollBeyondLastLine:!1,renderLineHighlight:"none",fixedOverflowWidgets:!0,acceptSuggestionOnEnter:"smart",minimap:{enabled:!1},dropIntoEditor:{enabled:!0},autoClosingBrackets:t.getValue("editor.autoClosingBrackets"),quickSuggestions:!1,accessibilitySupport:t.getValue("editor.accessibilitySupport"),fontFamily:t.getValue("editor.fontFamily")}}};d=g([n(4,j),n(5,H),n(6,q),n(7,Q),n(8,J),n(9,P),n(10,F),n(11,A)],d);function Pt(a,t,i){const o=t.getLayoutInfo(),e=t.getOption(W.lineHeight),r=t._getViewModel()?.getLineCount()*e;if(r>o.height||r<o.height&&i>l){const s=Math.ceil((r-o.height)/e),c=o.height+e*s;return I(c,l,I(a.getLayoutInfo().height-90,l,$))}return i}export{$ as MAX_EDITOR_HEIGHT,l as MIN_EDITOR_HEIGHT,d as SimpleCommentEditor,Pt as calculateEditorHeight,Z as ctxCommentEditorFocused};
