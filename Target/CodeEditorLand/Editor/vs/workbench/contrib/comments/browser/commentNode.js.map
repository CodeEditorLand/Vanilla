{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/comments/browser/commentNode.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport { DomEmitter } from \"../../../../base/browser/event.js\";\nimport { StandardMouseEvent } from \"../../../../base/browser/mouseEvent.js\";\nimport {\n\tActionViewItem,\n\ttype IActionViewItemOptions,\n} from \"../../../../base/browser/ui/actionbar/actionViewItems.js\";\nimport {\n\tActionBar,\n\tActionsOrientation,\n} from \"../../../../base/browser/ui/actionbar/actionbar.js\";\nimport { AnchorAlignment } from \"../../../../base/browser/ui/contextview/contextview.js\";\nimport { DropdownMenuActionViewItem } from \"../../../../base/browser/ui/dropdown/dropdownActionViewItem.js\";\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from \"../../../../base/browser/ui/mouseCursor/mouseCursor.js\";\nimport { SmoothScrollableElement } from \"../../../../base/browser/ui/scrollbar/scrollableElement.js\";\nimport { ToolBar } from \"../../../../base/browser/ui/toolbar/toolbar.js\";\nimport {\n\tAction,\n\tActionRunner,\n\ttype IAction,\n\ttype IActionRunner,\n\tSeparator,\n} from \"../../../../base/common/actions.js\";\nimport { Codicon } from \"../../../../base/common/codicons.js\";\nimport { Emitter, type Event } from \"../../../../base/common/event.js\";\nimport type { IMarkdownString } from \"../../../../base/common/htmlContent.js\";\nimport {\n\tDisposable,\n\ttype IDisposable,\n\ttype IReference,\n\tdispose,\n} from \"../../../../base/common/lifecycle.js\";\nimport { MarshalledId } from \"../../../../base/common/marshallingIds.js\";\nimport { FileAccess, Schemas } from \"../../../../base/common/network.js\";\nimport {\n\tScrollable,\n\tScrollbarVisibility,\n} from \"../../../../base/common/scrollable.js\";\nimport { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport { URI, type UriComponents } from \"../../../../base/common/uri.js\";\nimport type { MarkdownRenderer } from \"../../../../editor/browser/widget/markdownRenderer/browser/markdownRenderer.js\";\nimport type { IRange } from \"../../../../editor/common/core/range.js\";\nimport { Selection } from \"../../../../editor/common/core/selection.js\";\nimport * as languages from \"../../../../editor/common/languages.js\";\nimport {\n\ttype IResolvedTextEditorModel,\n\tITextModelService,\n} from \"../../../../editor/common/services/resolverService.js\";\nimport * as nls from \"../../../../nls.js\";\nimport { IAccessibilityService } from \"../../../../platform/accessibility/common/accessibility.js\";\nimport {\n\tMenuEntryActionViewItem,\n\tSubmenuEntryActionViewItem,\n} from \"../../../../platform/actions/browser/menuEntryActionViewItem.js\";\nimport {\n\ttype IMenu,\n\tMenuId,\n\tMenuItemAction,\n\tSubmenuItemAction,\n} from \"../../../../platform/actions/common/actions.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport {\n\ttype IContextKey,\n\tIContextKeyService,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { IContextMenuService } from \"../../../../platform/contextview/browser/contextView.js\";\nimport { IHoverService } from \"../../../../platform/hover/browser/hover.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { IKeybindingService } from \"../../../../platform/keybinding/common/keybinding.js\";\nimport { INotificationService } from \"../../../../platform/notification/common/notification.js\";\nimport type { MarshalledCommentThread } from \"../../../common/comments.js\";\nimport type { ICellRange } from \"../../notebook/common/notebookRange.js\";\nimport { CommentContextKeys } from \"../common/commentContextKeys.js\";\nimport type { ICommentThreadWidget } from \"../common/commentThreadWidget.js\";\nimport {\n\tCOMMENTS_SECTION,\n\ttype ICommentsConfiguration,\n} from \"../common/commentsConfiguration.js\";\nimport { CommentFormActions } from \"./commentFormActions.js\";\nimport type { CommentMenus } from \"./commentMenus.js\";\nimport { ICommentService } from \"./commentService.js\";\nimport {\n\tReactionAction,\n\tReactionActionViewItem,\n\tToggleReactionsAction,\n} from \"./reactionsAction.js\";\nimport {\n\ttype LayoutableEditor,\n\tMIN_EDITOR_HEIGHT,\n\tSimpleCommentEditor,\n\tcalculateEditorHeight,\n} from \"./simpleCommentEditor.js\";\nimport { TimestampWidget } from \"./timestamp.js\";\n\nclass CommentsActionRunner extends ActionRunner {\n\tprotected override async runAction(\n\t\taction: IAction,\n\t\tcontext: any[],\n\t): Promise<void> {\n\t\tawait action.run(...context);\n\t}\n}\n\nexport class CommentNode<T extends IRange | ICellRange> extends Disposable {\n\tprivate _domNode: HTMLElement;\n\tprivate _body: HTMLElement;\n\tprivate _avatar: HTMLElement;\n\tprivate _md: HTMLElement | undefined;\n\tprivate _plainText: HTMLElement | undefined;\n\tprivate _clearTimeout: any;\n\n\tprivate _editAction: Action | null = null;\n\tprivate _commentEditContainer: HTMLElement | null = null;\n\tprivate _commentDetailsContainer: HTMLElement;\n\tprivate _actionsToolbarContainer!: HTMLElement;\n\tprivate _reactionsActionBar?: ActionBar;\n\tprivate _reactionActionsContainer?: HTMLElement;\n\tprivate _commentEditor: SimpleCommentEditor | null = null;\n\tprivate _commentEditorDisposables: IDisposable[] = [];\n\tprivate _commentEditorModel: IReference<IResolvedTextEditorModel> | null =\n\t\tnull;\n\tprivate _editorHeight = MIN_EDITOR_HEIGHT;\n\n\tprivate _isPendingLabel!: HTMLElement;\n\tprivate _timestamp: HTMLElement | undefined;\n\tprivate _timestampWidget: TimestampWidget | undefined;\n\tprivate _contextKeyService: IContextKeyService;\n\tprivate _commentContextValue: IContextKey<string>;\n\tprivate _commentMenus: CommentMenus;\n\n\tprivate _scrollable!: Scrollable;\n\tprivate _scrollableElement!: SmoothScrollableElement;\n\n\tprotected actionRunner?: IActionRunner;\n\tprotected toolbar: ToolBar | undefined;\n\tprivate _commentFormActions: CommentFormActions | null = null;\n\tprivate _commentEditorActions: CommentFormActions | null = null;\n\n\tprivate readonly _onDidClick = new Emitter<CommentNode<T>>();\n\n\tpublic get domNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic isEditing = false;\n\n\tconstructor(\n\t\tprivate readonly parentEditor: LayoutableEditor,\n\t\tprivate commentThread: languages.CommentThread<T>,\n\t\tpublic comment: languages.Comment,\n\t\tprivate pendingEdit: string | undefined,\n\t\tprivate owner: string,\n\t\tprivate resource: URI,\n\t\tprivate parentThread: ICommentThreadWidget,\n\t\tprivate markdownRenderer: MarkdownRenderer,\n\t\t@IInstantiationService private instantiationService: IInstantiationService,\n\t\t@ICommentService private commentService: ICommentService,\n\t\t@INotificationService private notificationService: INotificationService,\n\t\t@IContextMenuService private contextMenuService: IContextMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService private configurationService: IConfigurationService,\n\t\t@IHoverService private hoverService: IHoverService,\n\t\t@IAccessibilityService private accessibilityService: IAccessibilityService,\n\t\t@IKeybindingService private keybindingService: IKeybindingService,\n\t\t@ITextModelService private readonly textModelService: ITextModelService,\n\t) {\n\t\tsuper();\n\n\t\tthis._domNode = dom.$('div.review-comment');\n\t\tthis._contextKeyService = this._register(contextKeyService.createScoped(this._domNode));\n\t\tthis._commentContextValue = CommentContextKeys.commentContext.bindTo(this._contextKeyService);\n\t\tif (this.comment.contextValue) {\n\t\t\tthis._commentContextValue.set(this.comment.contextValue);\n\t\t}\n\t\tthis._commentMenus = this.commentService.getCommentMenus(this.owner);\n\n\t\tthis._domNode.tabIndex = -1;\n\t\tthis._avatar = dom.append(this._domNode, dom.$('div.avatar-container'));\n\t\tthis.updateCommentUserIcon(this.comment.userIconPath);\n\n\t\tthis._commentDetailsContainer = dom.append(this._domNode, dom.$('.review-comment-contents'));\n\n\t\tthis.createHeader(this._commentDetailsContainer);\n\t\tthis._body = document.createElement(`div`);\n\t\tthis._body.classList.add('comment-body', MOUSE_CURSOR_TEXT_CSS_CLASS_NAME);\n\t\tif (configurationService.getValue<ICommentsConfiguration | undefined>(COMMENTS_SECTION)?.maxHeight !== false) {\n\t\t\tthis._body.classList.add('comment-body-max-height');\n\t\t}\n\n\t\tthis.createScroll(this._commentDetailsContainer, this._body);\n\t\tthis.updateCommentBody(this.comment.body);\n\n\t\tif (this.comment.commentReactions && this.comment.commentReactions.length && this.comment.commentReactions.filter(reaction => !!reaction.count).length) {\n\t\t\tthis.createReactionsContainer(this._commentDetailsContainer);\n\t\t}\n\n\t\tthis._domNode.setAttribute('aria-label', `${comment.userName}, ${this.commentBodyValue}`);\n\t\tthis._domNode.setAttribute('role', 'treeitem');\n\t\tthis._clearTimeout = null;\n\n\t\tthis._register(dom.addDisposableListener(this._domNode, dom.EventType.CLICK, () => this.isEditing || this._onDidClick.fire(this)));\n\t\tthis._register(dom.addDisposableListener(this._domNode, dom.EventType.CONTEXT_MENU, e => {\n\t\t\treturn this.onContextMenu(e);\n\t\t}));\n\n\t\tif (pendingEdit) {\n\t\t\tthis.switchToEditMode();\n\t\t}\n\t\tthis._register(this.accessibilityService.onDidChangeScreenReaderOptimized(() => {\n\t\t\tthis.toggleToolbarHidden(true);\n\t\t}));\n\n\t\tthis.activeCommentListeners();\n\t}\n\n\tprivate activeCommentListeners() {\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(\n\t\t\t\tthis._domNode,\n\t\t\t\tdom.EventType.FOCUS_IN,\n\t\t\t\t() => {\n\t\t\t\t\tthis.commentService.setActiveCommentAndThread(this.owner, {\n\t\t\t\t\t\tthread: this.commentThread,\n\t\t\t\t\t\tcomment: this.comment,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\ttrue,\n\t\t\t),\n\t\t);\n\t}\n\n\tprivate createScroll(container: HTMLElement, body: HTMLElement) {\n\t\tthis._scrollable = new Scrollable({\n\t\t\tforceIntegerValues: true,\n\t\t\tsmoothScrollDuration: 125,\n\t\t\tscheduleAtNextAnimationFrame: (cb) =>\n\t\t\t\tdom.scheduleAtNextAnimationFrame(dom.getWindow(container), cb),\n\t\t});\n\t\tthis._scrollableElement = this._register(\n\t\t\tnew SmoothScrollableElement(\n\t\t\t\tbody,\n\t\t\t\t{\n\t\t\t\t\thorizontal: ScrollbarVisibility.Visible,\n\t\t\t\t\tvertical: ScrollbarVisibility.Visible,\n\t\t\t\t},\n\t\t\t\tthis._scrollable,\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis._scrollableElement.onScroll((e) => {\n\t\t\t\tif (e.scrollLeftChanged) {\n\t\t\t\t\tbody.scrollLeft = e.scrollLeft;\n\t\t\t\t}\n\t\t\t\tif (e.scrollTopChanged) {\n\t\t\t\t\tbody.scrollTop = e.scrollTop;\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tconst onDidScrollViewContainer = this._register(\n\t\t\tnew DomEmitter(body, \"scroll\"),\n\t\t).event;\n\t\tthis._register(\n\t\t\tonDidScrollViewContainer((_) => {\n\t\t\t\tconst position = this._scrollableElement.getScrollPosition();\n\t\t\t\tconst scrollLeft =\n\t\t\t\t\tMath.abs(body.scrollLeft - position.scrollLeft) <= 1\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: body.scrollLeft;\n\t\t\t\tconst scrollTop =\n\t\t\t\t\tMath.abs(body.scrollTop - position.scrollTop) <= 1\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: body.scrollTop;\n\n\t\t\t\tif (scrollLeft !== undefined || scrollTop !== undefined) {\n\t\t\t\t\tthis._scrollableElement.setScrollPosition({\n\t\t\t\t\t\tscrollLeft,\n\t\t\t\t\t\tscrollTop,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tcontainer.appendChild(this._scrollableElement.getDomNode());\n\t}\n\n\tprivate updateCommentBody(body: string | IMarkdownString) {\n\t\tthis._body.innerText = \"\";\n\t\tthis._md = undefined;\n\t\tthis._plainText = undefined;\n\t\tif (typeof body === \"string\") {\n\t\t\tthis._plainText = dom.append(\n\t\t\t\tthis._body,\n\t\t\t\tdom.$(\".comment-body-plainstring\"),\n\t\t\t);\n\t\t\tthis._plainText.innerText = body;\n\t\t} else {\n\t\t\tthis._md = this.markdownRenderer.render(body).element;\n\t\t\tthis._body.appendChild(this._md);\n\t\t}\n\t}\n\n\tprivate updateCommentUserIcon(userIconPath: UriComponents | undefined) {\n\t\tthis._avatar.textContent = \"\";\n\t\tif (userIconPath) {\n\t\t\tconst img = <HTMLImageElement>(\n\t\t\t\tdom.append(this._avatar, dom.$(\"img.avatar\"))\n\t\t\t);\n\t\t\timg.src = FileAccess.uriToBrowserUri(\n\t\t\t\tURI.revive(userIconPath),\n\t\t\t).toString(true);\n\t\t\timg.onerror = (_) => img.remove();\n\t\t}\n\t}\n\n\tpublic get onDidClick(): Event<CommentNode<T>> {\n\t\treturn this._onDidClick.event;\n\t}\n\n\tprivate createTimestamp(container: HTMLElement) {\n\t\tthis._timestamp = dom.append(\n\t\t\tcontainer,\n\t\t\tdom.$(\"span.timestamp-container\"),\n\t\t);\n\t\tthis.updateTimestamp(this.comment.timestamp);\n\t}\n\n\tprivate updateTimestamp(raw?: string) {\n\t\tif (!this._timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst timestamp = raw !== undefined ? new Date(raw) : undefined;\n\t\tif (timestamp) {\n\t\t\tif (this._timestampWidget) {\n\t\t\t\tthis._timestampWidget.setTimestamp(timestamp);\n\t\t\t} else {\n\t\t\t\tthis._timestampWidget = new TimestampWidget(\n\t\t\t\t\tthis.configurationService,\n\t\t\t\t\tthis.hoverService,\n\t\t\t\t\tthis._timestamp,\n\t\t\t\t\ttimestamp,\n\t\t\t\t);\n\t\t\t\tthis._register(this._timestampWidget);\n\t\t\t}\n\t\t} else {\n\t\t\tthis._timestampWidget?.dispose();\n\t\t}\n\t}\n\n\tprivate createHeader(commentDetailsContainer: HTMLElement): void {\n\t\tconst header = dom.append(\n\t\t\tcommentDetailsContainer,\n\t\t\tdom.$(`div.comment-title.${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),\n\t\t);\n\t\tconst infoContainer = dom.append(header, dom.$(\"comment-header-info\"));\n\t\tconst author = dom.append(infoContainer, dom.$(\"strong.author\"));\n\t\tauthor.innerText = this.comment.userName;\n\t\tthis.createTimestamp(infoContainer);\n\t\tthis._isPendingLabel = dom.append(\n\t\t\tinfoContainer,\n\t\t\tdom.$(\"span.isPending\"),\n\t\t);\n\n\t\tif (this.comment.label) {\n\t\t\tthis._isPendingLabel.innerText = this.comment.label;\n\t\t} else {\n\t\t\tthis._isPendingLabel.innerText = \"\";\n\t\t}\n\n\t\tthis._actionsToolbarContainer = dom.append(\n\t\t\theader,\n\t\t\tdom.$(\".comment-actions\"),\n\t\t);\n\t\tthis.toggleToolbarHidden(true);\n\t\tthis.createActionsToolbar();\n\t}\n\n\tprivate toggleToolbarHidden(hidden: boolean) {\n\t\tif (hidden && !this.accessibilityService.isScreenReaderOptimized()) {\n\t\t\tthis._actionsToolbarContainer.classList.add(\"hidden\");\n\t\t} else {\n\t\t\tthis._actionsToolbarContainer.classList.remove(\"hidden\");\n\t\t}\n\t}\n\n\tprivate getToolbarActions(menu: IMenu): {\n\t\tprimary: IAction[];\n\t\tsecondary: IAction[];\n\t} {\n\t\tconst contributedActions = menu.getActions({ shouldForwardArgs: true });\n\t\tconst primary: IAction[] = [];\n\t\tconst secondary: IAction[] = [];\n\t\tconst result = { primary, secondary };\n\t\tfillInActions(contributedActions, result, false, (g) =>\n\t\t\t/^inline/.test(g),\n\t\t);\n\t\treturn result;\n\t}\n\n\tprivate get commentNodeContext(): [any, MarshalledCommentThread] {\n\t\treturn [\n\t\t\t{\n\t\t\t\tthread: this.commentThread,\n\t\t\t\tcommentUniqueId: this.comment.uniqueIdInThread,\n\t\t\t\t$mid: MarshalledId.CommentNode,\n\t\t\t},\n\t\t\t{\n\t\t\t\tcommentControlHandle: this.commentThread.controllerHandle,\n\t\t\t\tcommentThreadHandle: this.commentThread.commentThreadHandle,\n\t\t\t\t$mid: MarshalledId.CommentThread,\n\t\t\t},\n\t\t];\n\t}\n\n\tprivate createToolbar() {\n\t\tthis.toolbar = new ToolBar(\n\t\t\tthis._actionsToolbarContainer,\n\t\t\tthis.contextMenuService,\n\t\t\t{\n\t\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\t\treturn new DropdownMenuActionViewItem(\n\t\t\t\t\t\t\taction,\n\t\t\t\t\t\t\t(<ToggleReactionsAction>action).menuActions,\n\t\t\t\t\t\t\tthis.contextMenuService,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t...options,\n\t\t\t\t\t\t\t\tactionViewItemProvider: (action, options) =>\n\t\t\t\t\t\t\t\t\tthis.actionViewItemProvider(\n\t\t\t\t\t\t\t\t\t\taction as Action,\n\t\t\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tactionRunner: this.actionRunner,\n\t\t\t\t\t\t\t\tclassNames: [\n\t\t\t\t\t\t\t\t\t\"toolbar-toggle-pickReactions\",\n\t\t\t\t\t\t\t\t\t...ThemeIcon.asClassNameArray(\n\t\t\t\t\t\t\t\t\t\tCodicon.reactions,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\tanchorAlignmentProvider: () =>\n\t\t\t\t\t\t\t\t\tAnchorAlignment.RIGHT,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn this.actionViewItemProvider(\n\t\t\t\t\t\taction as Action,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\torientation: ActionsOrientation.HORIZONTAL,\n\t\t\t},\n\t\t);\n\n\t\tthis.toolbar.context = this.commentNodeContext;\n\t\tthis.toolbar.actionRunner = new CommentsActionRunner();\n\n\t\tthis.registerActionBarListeners(this._actionsToolbarContainer);\n\t\tthis._register(this.toolbar);\n\t}\n\n\tprivate createActionsToolbar() {\n\t\tconst actions: IAction[] = [];\n\n\t\tconst hasReactionHandler = this.commentService.hasReactionHandler(\n\t\t\tthis.owner,\n\t\t);\n\n\t\tif (hasReactionHandler) {\n\t\t\tconst toggleReactionAction = this.createReactionPicker(\n\t\t\t\tthis.comment.commentReactions || [],\n\t\t\t);\n\t\t\tactions.push(toggleReactionAction);\n\t\t}\n\n\t\tconst menu = this._commentMenus.getCommentTitleActions(\n\t\t\tthis.comment,\n\t\t\tthis._contextKeyService,\n\t\t);\n\t\tthis._register(menu);\n\t\tthis._register(\n\t\t\tmenu.onDidChange((e) => {\n\t\t\t\tconst { primary, secondary } = this.getToolbarActions(menu);\n\t\t\t\tif (!this.toolbar && (primary.length || secondary.length)) {\n\t\t\t\t\tthis.createToolbar();\n\t\t\t\t}\n\n\t\t\t\tthis.toolbar!.setActions(primary, secondary);\n\t\t\t}),\n\t\t);\n\n\t\tconst { primary, secondary } = this.getToolbarActions(menu);\n\t\tactions.push(...primary);\n\n\t\tif (actions.length || secondary.length) {\n\t\t\tthis.createToolbar();\n\t\t\tthis.toolbar!.setActions(actions, secondary);\n\t\t}\n\t}\n\n\tactionViewItemProvider(action: Action, options: IActionViewItemOptions) {\n\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\toptions = { label: false, icon: true };\n\t\t} else {\n\t\t\toptions = { label: false, icon: true };\n\t\t}\n\n\t\tif (action.id === ReactionAction.ID) {\n\t\t\tconst item = new ReactionActionViewItem(action);\n\t\t\treturn item;\n\t\t} else if (action instanceof MenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(\n\t\t\t\tMenuEntryActionViewItem,\n\t\t\t\taction,\n\t\t\t\t{ hoverDelegate: options.hoverDelegate },\n\t\t\t);\n\t\t} else if (action instanceof SubmenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(\n\t\t\t\tSubmenuEntryActionViewItem,\n\t\t\t\taction,\n\t\t\t\toptions,\n\t\t\t);\n\t\t} else {\n\t\t\tconst item = new ActionViewItem({}, action, options);\n\t\t\treturn item;\n\t\t}\n\t}\n\n\tasync submitComment(): Promise<void> {\n\t\tif (this._commentEditor && this._commentFormActions) {\n\t\t\tawait this._commentFormActions.triggerDefaultAction();\n\t\t\tthis.pendingEdit = undefined;\n\t\t}\n\t}\n\n\tprivate createReactionPicker(\n\t\treactionGroup: languages.CommentReaction[],\n\t): ToggleReactionsAction {\n\t\tconst toggleReactionAction = this._register(\n\t\t\tnew ToggleReactionsAction(\n\t\t\t\t() => {\n\t\t\t\t\ttoggleReactionActionViewItem?.show();\n\t\t\t\t},\n\t\t\t\tnls.localize(\"commentToggleReaction\", \"Toggle Reaction\"),\n\t\t\t),\n\t\t);\n\n\t\tlet reactionMenuActions: Action[] = [];\n\t\tif (reactionGroup && reactionGroup.length) {\n\t\t\treactionMenuActions = reactionGroup.map((reaction) => {\n\t\t\t\treturn new Action(\n\t\t\t\t\t`reaction.command.${reaction.label}`,\n\t\t\t\t\t`${reaction.label}`,\n\t\t\t\t\t\"\",\n\t\t\t\t\ttrue,\n\t\t\t\t\tasync () => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait this.commentService.toggleReaction(\n\t\t\t\t\t\t\t\tthis.owner,\n\t\t\t\t\t\t\t\tthis.resource,\n\t\t\t\t\t\t\t\tthis.commentThread,\n\t\t\t\t\t\t\t\tthis.comment,\n\t\t\t\t\t\t\t\treaction,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tconst error = e.message\n\t\t\t\t\t\t\t\t? nls.localize(\n\t\t\t\t\t\t\t\t\t\t\"commentToggleReactionError\",\n\t\t\t\t\t\t\t\t\t\t\"Toggling the comment reaction failed: {0}.\",\n\t\t\t\t\t\t\t\t\t\te.message,\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t: nls.localize(\n\t\t\t\t\t\t\t\t\t\t\"commentToggleReactionDefaultError\",\n\t\t\t\t\t\t\t\t\t\t\"Toggling the comment reaction failed\",\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.notificationService.error(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\ttoggleReactionAction.menuActions = reactionMenuActions;\n\n\t\tconst toggleReactionActionViewItem: DropdownMenuActionViewItem =\n\t\t\tnew DropdownMenuActionViewItem(\n\t\t\t\ttoggleReactionAction,\n\t\t\t\t(<ToggleReactionsAction>toggleReactionAction).menuActions,\n\t\t\t\tthis.contextMenuService,\n\t\t\t\t{\n\t\t\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\t\t\treturn toggleReactionActionViewItem;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this.actionViewItemProvider(\n\t\t\t\t\t\t\taction as Action,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tactionRunner: this.actionRunner,\n\t\t\t\t\tclassNames: \"toolbar-toggle-pickReactions\",\n\t\t\t\t\tanchorAlignmentProvider: () => AnchorAlignment.RIGHT,\n\t\t\t\t},\n\t\t\t);\n\n\t\treturn toggleReactionAction;\n\t}\n\n\tprivate createReactionsContainer(\n\t\tcommentDetailsContainer: HTMLElement,\n\t): void {\n\t\tthis._reactionActionsContainer = dom.append(\n\t\t\tcommentDetailsContainer,\n\t\t\tdom.$(\"div.comment-reactions\"),\n\t\t);\n\t\tthis._reactionsActionBar = new ActionBar(\n\t\t\tthis._reactionActionsContainer,\n\t\t\t{\n\t\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\t\treturn new DropdownMenuActionViewItem(\n\t\t\t\t\t\t\taction,\n\t\t\t\t\t\t\t(<ToggleReactionsAction>action).menuActions,\n\t\t\t\t\t\t\tthis.contextMenuService,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tactionViewItemProvider: (action, options) =>\n\t\t\t\t\t\t\t\t\tthis.actionViewItemProvider(\n\t\t\t\t\t\t\t\t\t\taction as Action,\n\t\t\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tactionRunner: this.actionRunner,\n\t\t\t\t\t\t\t\tclassNames: [\n\t\t\t\t\t\t\t\t\t\"toolbar-toggle-pickReactions\",\n\t\t\t\t\t\t\t\t\t...ThemeIcon.asClassNameArray(\n\t\t\t\t\t\t\t\t\t\tCodicon.reactions,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\tanchorAlignmentProvider: () =>\n\t\t\t\t\t\t\t\t\tAnchorAlignment.RIGHT,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn this.actionViewItemProvider(\n\t\t\t\t\t\taction as Action,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t\tthis._register(this._reactionsActionBar);\n\n\t\tconst hasReactionHandler = this.commentService.hasReactionHandler(\n\t\t\tthis.owner,\n\t\t);\n\t\tthis.comment\n\t\t\t.commentReactions!.filter((reaction) => !!reaction.count)\n\t\t\t.map((reaction) => {\n\t\t\t\tconst action = new ReactionAction(\n\t\t\t\t\t`reaction.${reaction.label}`,\n\t\t\t\t\t`${reaction.label}`,\n\t\t\t\t\treaction.hasReacted &&\n\t\t\t\t\t\t(reaction.canEdit || hasReactionHandler)\n\t\t\t\t\t\t? \"active\"\n\t\t\t\t\t\t: \"\",\n\t\t\t\t\treaction.canEdit || hasReactionHandler,\n\t\t\t\t\tasync () => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait this.commentService.toggleReaction(\n\t\t\t\t\t\t\t\tthis.owner,\n\t\t\t\t\t\t\t\tthis.resource,\n\t\t\t\t\t\t\t\tthis.commentThread,\n\t\t\t\t\t\t\t\tthis.comment,\n\t\t\t\t\t\t\t\treaction,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tlet error: string;\n\n\t\t\t\t\t\t\tif (reaction.hasReacted) {\n\t\t\t\t\t\t\t\terror = e.message\n\t\t\t\t\t\t\t\t\t? nls.localize(\n\t\t\t\t\t\t\t\t\t\t\t\"commentDeleteReactionError\",\n\t\t\t\t\t\t\t\t\t\t\t\"Deleting the comment reaction failed: {0}.\",\n\t\t\t\t\t\t\t\t\t\t\te.message,\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t: nls.localize(\n\t\t\t\t\t\t\t\t\t\t\t\"commentDeleteReactionDefaultError\",\n\t\t\t\t\t\t\t\t\t\t\t\"Deleting the comment reaction failed\",\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\terror = e.message\n\t\t\t\t\t\t\t\t\t? nls.localize(\n\t\t\t\t\t\t\t\t\t\t\t\"commentAddReactionError\",\n\t\t\t\t\t\t\t\t\t\t\t\"Deleting the comment reaction failed: {0}.\",\n\t\t\t\t\t\t\t\t\t\t\te.message,\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t: nls.localize(\n\t\t\t\t\t\t\t\t\t\t\t\"commentAddReactionDefaultError\",\n\t\t\t\t\t\t\t\t\t\t\t\"Deleting the comment reaction failed\",\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.notificationService.error(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\treaction.reactors,\n\t\t\t\t\treaction.iconPath,\n\t\t\t\t\treaction.count,\n\t\t\t\t);\n\n\t\t\t\tthis._reactionsActionBar?.push(action, {\n\t\t\t\t\tlabel: true,\n\t\t\t\t\ticon: true,\n\t\t\t\t});\n\t\t\t});\n\n\t\tif (hasReactionHandler) {\n\t\t\tconst toggleReactionAction = this.createReactionPicker(\n\t\t\t\tthis.comment.commentReactions || [],\n\t\t\t);\n\t\t\tthis._reactionsActionBar.push(toggleReactionAction, {\n\t\t\t\tlabel: false,\n\t\t\t\ticon: true,\n\t\t\t});\n\t\t}\n\t}\n\n\tget commentBodyValue(): string {\n\t\treturn typeof this.comment.body === \"string\"\n\t\t\t? this.comment.body\n\t\t\t: this.comment.body.value;\n\t}\n\n\tprivate async createCommentEditor(\n\t\teditContainer: HTMLElement,\n\t): Promise<void> {\n\t\tconst container = dom.append(editContainer, dom.$(\".edit-textarea\"));\n\t\tthis._commentEditor = this.instantiationService.createInstance(\n\t\t\tSimpleCommentEditor,\n\t\t\tcontainer,\n\t\t\tSimpleCommentEditor.getEditorOptions(this.configurationService),\n\t\t\tthis._contextKeyService,\n\t\t\tthis.parentThread,\n\t\t);\n\n\t\tconst resource = URI.from({\n\t\t\tscheme: Schemas.commentsInput,\n\t\t\tpath: `/commentinput-${this.comment.uniqueIdInThread}-${Date.now()}.md`,\n\t\t});\n\t\tconst modelRef =\n\t\t\tawait this.textModelService.createModelReference(resource);\n\t\tthis._commentEditorModel = modelRef;\n\n\t\tthis._commentEditor.setModel(\n\t\t\tthis._commentEditorModel.object.textEditorModel,\n\t\t);\n\t\tthis._commentEditor.setValue(this.pendingEdit ?? this.commentBodyValue);\n\t\tthis.pendingEdit = undefined;\n\t\tthis._commentEditor.layout({\n\t\t\twidth: container.clientWidth - 14,\n\t\t\theight: this._editorHeight,\n\t\t});\n\t\tthis._commentEditor.focus();\n\n\t\tdom.scheduleAtNextAnimationFrame(dom.getWindow(editContainer), () => {\n\t\t\tthis._commentEditor!.layout({\n\t\t\t\twidth: container.clientWidth - 14,\n\t\t\t\theight: this._editorHeight,\n\t\t\t});\n\t\t\tthis._commentEditor!.focus();\n\t\t});\n\n\t\tconst lastLine =\n\t\t\tthis._commentEditorModel.object.textEditorModel.getLineCount();\n\t\tconst lastColumn =\n\t\t\tthis._commentEditorModel.object.textEditorModel.getLineLength(\n\t\t\t\tlastLine,\n\t\t\t) + 1;\n\t\tthis._commentEditor.setSelection(\n\t\t\tnew Selection(lastLine, lastColumn, lastLine, lastColumn),\n\t\t);\n\n\t\tconst commentThread = this.commentThread;\n\t\tcommentThread.input = {\n\t\t\turi: this._commentEditor.getModel()!.uri,\n\t\t\tvalue: this.commentBodyValue,\n\t\t};\n\t\tthis.commentService.setActiveEditingCommentThread(commentThread);\n\t\tthis.commentService.setActiveCommentAndThread(this.owner, {\n\t\t\tthread: commentThread,\n\t\t\tcomment: this.comment,\n\t\t});\n\n\t\tthis._commentEditorDisposables.push(\n\t\t\tthis._commentEditor.onDidFocusEditorWidget(() => {\n\t\t\t\tcommentThread.input = {\n\t\t\t\t\turi: this._commentEditor!.getModel()!.uri,\n\t\t\t\t\tvalue: this.commentBodyValue,\n\t\t\t\t};\n\t\t\t\tthis.commentService.setActiveEditingCommentThread(\n\t\t\t\t\tcommentThread,\n\t\t\t\t);\n\t\t\t\tthis.commentService.setActiveCommentAndThread(this.owner, {\n\t\t\t\t\tthread: commentThread,\n\t\t\t\t\tcomment: this.comment,\n\t\t\t\t});\n\t\t\t}),\n\t\t);\n\n\t\tthis._commentEditorDisposables.push(\n\t\t\tthis._commentEditor.onDidChangeModelContent((e) => {\n\t\t\t\tif (\n\t\t\t\t\tcommentThread.input &&\n\t\t\t\t\tthis._commentEditor &&\n\t\t\t\t\tthis._commentEditor.getModel()!.uri ===\n\t\t\t\t\t\tcommentThread.input.uri\n\t\t\t\t) {\n\t\t\t\t\tconst newVal = this._commentEditor.getValue();\n\t\t\t\t\tif (newVal !== commentThread.input.value) {\n\t\t\t\t\t\tconst input = commentThread.input;\n\t\t\t\t\t\tinput.value = newVal;\n\t\t\t\t\t\tcommentThread.input = input;\n\t\t\t\t\t\tthis.commentService.setActiveEditingCommentThread(\n\t\t\t\t\t\t\tcommentThread,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.commentService.setActiveCommentAndThread(\n\t\t\t\t\t\t\tthis.owner,\n\t\t\t\t\t\t\t{ thread: commentThread, comment: this.comment },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis.calculateEditorHeight();\n\n\t\tthis._register(\n\t\t\tthis._commentEditorModel.object.textEditorModel.onDidChangeContent(\n\t\t\t\t() => {\n\t\t\t\t\tif (this._commentEditor && this.calculateEditorHeight()) {\n\t\t\t\t\t\tthis._commentEditor.layout({\n\t\t\t\t\t\t\theight: this._editorHeight,\n\t\t\t\t\t\t\twidth: this._commentEditor.getLayoutInfo().width,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis._commentEditor.render(true);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tthis._register(this._commentEditor);\n\t\tthis._register(this._commentEditorModel);\n\t}\n\n\tprivate calculateEditorHeight(): boolean {\n\t\tif (this._commentEditor) {\n\t\t\tconst newEditorHeight = calculateEditorHeight(\n\t\t\t\tthis.parentEditor,\n\t\t\t\tthis._commentEditor,\n\t\t\t\tthis._editorHeight,\n\t\t\t);\n\t\t\tif (newEditorHeight !== this._editorHeight) {\n\t\t\t\tthis._editorHeight = newEditorHeight;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetPendingEdit(): string | undefined {\n\t\tconst model = this._commentEditor?.getModel();\n\t\tif (model && model.getValueLength() > 0) {\n\t\t\treturn model.getValue();\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate removeCommentEditor() {\n\t\tthis.isEditing = false;\n\t\tif (this._editAction) {\n\t\t\tthis._editAction.enabled = true;\n\t\t}\n\t\tthis._body.classList.remove(\"hidden\");\n\n\t\tthis._commentEditorModel?.dispose();\n\n\t\tdispose(this._commentEditorDisposables);\n\t\tthis._commentEditorDisposables = [];\n\t\tthis._commentEditor?.dispose();\n\t\tthis._commentEditor = null;\n\n\t\tthis._commentEditContainer!.remove();\n\t}\n\n\tlayout(widthInPixel?: number) {\n\t\tconst editorWidth =\n\t\t\twidthInPixel !== undefined\n\t\t\t\t? widthInPixel - 72 /* - margin and scrollbar*/\n\t\t\t\t: (this._commentEditor?.getLayoutInfo().width ?? 0);\n\t\tthis._commentEditor?.layout({\n\t\t\twidth: editorWidth,\n\t\t\theight: this._editorHeight,\n\t\t});\n\t\tconst scrollWidth = this._body.scrollWidth;\n\t\tconst width = dom.getContentWidth(this._body);\n\t\tconst scrollHeight = this._body.scrollHeight;\n\t\tconst height = dom.getContentHeight(this._body) + 4;\n\t\tthis._scrollableElement.setScrollDimensions({\n\t\t\twidth,\n\t\t\tscrollWidth,\n\t\t\theight,\n\t\t\tscrollHeight,\n\t\t});\n\t}\n\n\tpublic async switchToEditMode() {\n\t\tif (this.isEditing) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isEditing = true;\n\t\tthis._body.classList.add(\"hidden\");\n\t\tthis._commentEditContainer = dom.append(\n\t\t\tthis._commentDetailsContainer,\n\t\t\tdom.$(\".edit-container\"),\n\t\t);\n\t\tawait this.createCommentEditor(this._commentEditContainer);\n\n\t\tconst formActions = dom.append(\n\t\t\tthis._commentEditContainer,\n\t\t\tdom.$(\".form-actions\"),\n\t\t);\n\t\tconst otherActions = dom.append(formActions, dom.$(\".other-actions\"));\n\t\tthis.createCommentWidgetFormActions(otherActions);\n\t\tconst editorActions = dom.append(formActions, dom.$(\".editor-actions\"));\n\t\tthis.createCommentWidgetEditorActions(editorActions);\n\t}\n\n\tprivate createCommentWidgetFormActions(container: HTMLElement) {\n\t\tconst menus = this.commentService.getCommentMenus(this.owner);\n\t\tconst menu = menus.getCommentActions(\n\t\t\tthis.comment,\n\t\t\tthis._contextKeyService,\n\t\t);\n\n\t\tthis._register(menu);\n\t\tthis._register(\n\t\t\tmenu.onDidChange(() => {\n\t\t\t\tthis._commentFormActions?.setActions(menu);\n\t\t\t}),\n\t\t);\n\n\t\tthis._commentFormActions = new CommentFormActions(\n\t\t\tthis.keybindingService,\n\t\t\tthis._contextKeyService,\n\t\t\tcontainer,\n\t\t\t(action: IAction): void => {\n\t\t\t\tconst text = this._commentEditor!.getValue();\n\n\t\t\t\taction.run({\n\t\t\t\t\tthread: this.commentThread,\n\t\t\t\t\tcommentUniqueId: this.comment.uniqueIdInThread,\n\t\t\t\t\ttext: text,\n\t\t\t\t\t$mid: MarshalledId.CommentThreadNode,\n\t\t\t\t});\n\n\t\t\t\tthis.removeCommentEditor();\n\t\t\t},\n\t\t);\n\n\t\tthis._register(this._commentFormActions);\n\t\tthis._commentFormActions.setActions(menu);\n\t}\n\n\tprivate createCommentWidgetEditorActions(container: HTMLElement) {\n\t\tconst menus = this.commentService.getCommentMenus(this.owner);\n\t\tconst menu = menus.getCommentEditorActions(this._contextKeyService);\n\n\t\tthis._register(menu);\n\t\tthis._register(\n\t\t\tmenu.onDidChange(() => {\n\t\t\t\tthis._commentEditorActions?.setActions(menu);\n\t\t\t}),\n\t\t);\n\n\t\tthis._commentEditorActions = new CommentFormActions(\n\t\t\tthis.keybindingService,\n\t\t\tthis._contextKeyService,\n\t\t\tcontainer,\n\t\t\t(action: IAction): void => {\n\t\t\t\tconst text = this._commentEditor!.getValue();\n\n\t\t\t\taction.run({\n\t\t\t\t\tthread: this.commentThread,\n\t\t\t\t\tcommentUniqueId: this.comment.uniqueIdInThread,\n\t\t\t\t\ttext: text,\n\t\t\t\t\t$mid: MarshalledId.CommentThreadNode,\n\t\t\t\t});\n\n\t\t\t\tthis._commentEditor?.focus();\n\t\t\t},\n\t\t);\n\n\t\tthis._register(this._commentEditorActions);\n\t\tthis._commentEditorActions.setActions(menu, true);\n\t}\n\n\tsetFocus(focused: boolean, visible = false) {\n\t\tif (focused) {\n\t\t\tthis._domNode.focus();\n\t\t\tthis.toggleToolbarHidden(false);\n\t\t\tthis._actionsToolbarContainer.classList.add(\"tabfocused\");\n\t\t\tthis._domNode.tabIndex = 0;\n\t\t\tif (this.comment.mode === languages.CommentMode.Editing) {\n\t\t\t\tthis._commentEditor?.focus();\n\t\t\t}\n\t\t} else {\n\t\t\tif (\n\t\t\t\tthis._actionsToolbarContainer.classList.contains(\n\t\t\t\t\t\"tabfocused\",\n\t\t\t\t) &&\n\t\t\t\t!this._actionsToolbarContainer.classList.contains(\"mouseover\")\n\t\t\t) {\n\t\t\t\tthis.toggleToolbarHidden(true);\n\t\t\t\tthis._domNode.tabIndex = -1;\n\t\t\t}\n\t\t\tthis._actionsToolbarContainer.classList.remove(\"tabfocused\");\n\t\t}\n\t}\n\n\tprivate registerActionBarListeners(actionsContainer: HTMLElement): void {\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(this._domNode, \"mouseenter\", () => {\n\t\t\t\tthis.toggleToolbarHidden(false);\n\t\t\t\tactionsContainer.classList.add(\"mouseover\");\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tdom.addDisposableListener(this._domNode, \"mouseleave\", () => {\n\t\t\t\tif (\n\t\t\t\t\tactionsContainer.classList.contains(\"mouseover\") &&\n\t\t\t\t\t!actionsContainer.classList.contains(\"tabfocused\")\n\t\t\t\t) {\n\t\t\t\t\tthis.toggleToolbarHidden(true);\n\t\t\t\t}\n\t\t\t\tactionsContainer.classList.remove(\"mouseover\");\n\t\t\t}),\n\t\t);\n\t}\n\n\tasync update(newComment: languages.Comment) {\n\t\tif (newComment.body !== this.comment.body) {\n\t\t\tthis.updateCommentBody(newComment.body);\n\t\t}\n\n\t\tif (\n\t\t\tthis.comment.userIconPath &&\n\t\t\tnewComment.userIconPath &&\n\t\t\tURI.from(this.comment.userIconPath).toString() !==\n\t\t\t\tURI.from(newComment.userIconPath).toString()\n\t\t) {\n\t\t\tthis.updateCommentUserIcon(newComment.userIconPath);\n\t\t}\n\n\t\tconst isChangingMode: boolean =\n\t\t\tnewComment.mode !== undefined &&\n\t\t\tnewComment.mode !== this.comment.mode;\n\n\t\tthis.comment = newComment;\n\n\t\tif (isChangingMode) {\n\t\t\tif (newComment.mode === languages.CommentMode.Editing) {\n\t\t\t\tawait this.switchToEditMode();\n\t\t\t} else {\n\t\t\t\tthis.removeCommentEditor();\n\t\t\t}\n\t\t}\n\n\t\tif (newComment.label) {\n\t\t\tthis._isPendingLabel.innerText = newComment.label;\n\t\t} else {\n\t\t\tthis._isPendingLabel.innerText = \"\";\n\t\t}\n\n\t\t// update comment reactions\n\t\tthis._reactionActionsContainer?.remove();\n\n\t\tthis._reactionsActionBar?.clear();\n\n\t\tif (\n\t\t\tthis.comment.commentReactions &&\n\t\t\tthis.comment.commentReactions.some((reaction) => !!reaction.count)\n\t\t) {\n\t\t\tthis.createReactionsContainer(this._commentDetailsContainer);\n\t\t}\n\n\t\tif (this.comment.contextValue) {\n\t\t\tthis._commentContextValue.set(this.comment.contextValue);\n\t\t} else {\n\t\t\tthis._commentContextValue.reset();\n\t\t}\n\n\t\tif (this.comment.timestamp) {\n\t\t\tthis.updateTimestamp(this.comment.timestamp);\n\t\t}\n\t}\n\n\tprivate onContextMenu(e: MouseEvent) {\n\t\tconst event = new StandardMouseEvent(dom.getWindow(this._domNode), e);\n\n\t\tthis.contextMenuService.showContextMenu({\n\t\t\tgetAnchor: () => event,\n\t\t\tmenuId: MenuId.CommentThreadCommentContext,\n\t\t\tmenuActionOptions: { shouldForwardArgs: true },\n\t\t\tcontextKeyService: this._contextKeyService,\n\t\t\tactionRunner: new CommentsActionRunner(),\n\t\t\tgetActionsContext: () => {\n\t\t\t\treturn this.commentNodeContext;\n\t\t\t},\n\t\t});\n\t}\n\n\tfocus() {\n\t\tthis.domNode.focus();\n\t\tif (!this._clearTimeout) {\n\t\t\tthis.domNode.classList.add(\"focus\");\n\t\t\tthis._clearTimeout = setTimeout(() => {\n\t\t\t\tthis.domNode.classList.remove(\"focus\");\n\t\t\t}, 3000);\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tdispose(this._commentEditorDisposables);\n\t}\n}\n\nfunction fillInActions(\n\tgroups: [string, Array<MenuItemAction | SubmenuItemAction>][],\n\ttarget: IAction[] | { primary: IAction[]; secondary: IAction[] },\n\tuseAlternativeActions: boolean,\n\tisPrimaryGroup: (group: string) => boolean = (group) =>\n\t\tgroup === \"navigation\",\n): void {\n\tfor (const tuple of groups) {\n\t\tlet [group, actions] = tuple;\n\t\tif (useAlternativeActions) {\n\t\t\tactions = actions.map((a) =>\n\t\t\t\ta instanceof MenuItemAction && !!a.alt ? a.alt : a,\n\t\t\t);\n\t\t}\n\n\t\tif (isPrimaryGroup(group)) {\n\t\t\tconst to = Array.isArray(target) ? target : target.primary;\n\n\t\t\tto.unshift(...actions);\n\t\t} else {\n\t\t\tconst to = Array.isArray(target) ? target : target.secondary;\n\n\t\t\tif (to.length > 0) {\n\t\t\t\tto.push(new Separator());\n\t\t\t}\n\n\t\t\tto.push(...actions);\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": ["action", "options", "primary", "secondary"]
}
