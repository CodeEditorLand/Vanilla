{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/comments/browser/commentsTreeViewer.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport { renderMarkdown } from \"../../../../base/browser/markdownRenderer.js\";\nimport { ActionViewItem } from \"../../../../base/browser/ui/actionbar/actionViewItems.js\";\nimport {\n\tActionBar,\n\ttype IActionViewItemProvider,\n} from \"../../../../base/browser/ui/actionbar/actionbar.js\";\nimport { getDefaultHoverDelegate } from \"../../../../base/browser/ui/hover/hoverDelegateFactory.js\";\nimport type {\n\tIListRenderer,\n\tIListVirtualDelegate,\n} from \"../../../../base/browser/ui/list/list.js\";\nimport type { IListStyles } from \"../../../../base/browser/ui/list/listWidget.js\";\nimport {\n\ttype ITreeContextMenuEvent,\n\ttype ITreeFilter,\n\ttype ITreeNode,\n\ttype TreeFilterResult,\n\tTreeVisibility,\n} from \"../../../../base/browser/ui/tree/tree.js\";\nimport type { IAction } from \"../../../../base/common/actions.js\";\nimport { Codicon } from \"../../../../base/common/codicons.js\";\nimport type { Color } from \"../../../../base/common/color.js\";\nimport type { IMatch } from \"../../../../base/common/filters.js\";\nimport type { IMarkdownString } from \"../../../../base/common/htmlContent.js\";\nimport {\n\tDisposableStore,\n\ttype IDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport { MarshalledId } from \"../../../../base/common/marshallingIds.js\";\nimport { basename } from \"../../../../base/common/resources.js\";\nimport { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport { openLinkFromMarkdown } from \"../../../../editor/browser/widget/markdownRenderer/browser/markdownRenderer.js\";\nimport {\n\tCommentThreadApplicability,\n\tCommentThreadState,\n} from \"../../../../editor/common/languages.js\";\nimport * as nls from \"../../../../nls.js\";\nimport type { ILocalizedString } from \"../../../../platform/action/common/action.js\";\nimport {\n\tcreateActionViewItem,\n\tcreateAndFillInContextMenuActions,\n} from \"../../../../platform/actions/browser/menuEntryActionViewItem.js\";\nimport {\n\tIMenuService,\n\tMenuId,\n} from \"../../../../platform/actions/common/actions.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport { IContextKeyService } from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { IContextMenuService } from \"../../../../platform/contextview/browser/contextView.js\";\nimport { IHoverService } from \"../../../../platform/hover/browser/hover.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { IKeybindingService } from \"../../../../platform/keybinding/common/keybinding.js\";\nimport {\n\tIListService,\n\ttype IWorkbenchAsyncDataTreeOptions,\n\tWorkbenchObjectTree,\n} from \"../../../../platform/list/browser/listService.js\";\nimport { IOpenerService } from \"../../../../platform/opener/common/opener.js\";\nimport type { IStyleOverride } from \"../../../../platform/theme/browser/defaultStyles.js\";\nimport {\n\ttype IColorTheme,\n\tIThemeService,\n} from \"../../../../platform/theme/common/themeService.js\";\nimport type {\n\tIResourceLabel,\n\tResourceLabels,\n} from \"../../../browser/labels.js\";\nimport type {\n\tMarshalledCommentThread,\n\tMarshalledCommentThreadInternal,\n} from \"../../../common/comments.js\";\nimport {\n\tCommentNode,\n\tResourceWithCommentThreads,\n} from \"../common/commentModel.js\";\nimport {\n\tcommentViewThreadStateColorVar,\n\tgetCommentThreadStateIconColor,\n} from \"./commentColors.js\";\nimport { FilterOptions } from \"./commentsFilterOptions.js\";\nimport { CommentsModel } from \"./commentsModel.js\";\nimport { TimestampWidget } from \"./timestamp.js\";\n\nexport const COMMENTS_VIEW_ID = \"workbench.panel.comments\";\nexport const COMMENTS_VIEW_STORAGE_ID = \"Comments\";\nexport const COMMENTS_VIEW_TITLE: ILocalizedString = nls.localize2(\n\t\"comments.view.title\",\n\t\"Comments\",\n);\n\ninterface IResourceTemplateData {\n\tresourceLabel: IResourceLabel;\n\tseparator: HTMLElement;\n\towner: HTMLElement;\n}\n\ninterface ICommentThreadTemplateData {\n\tthreadMetadata: {\n\t\trelevance: HTMLElement;\n\t\ticon: HTMLElement;\n\t\tuserNames: HTMLSpanElement;\n\t\ttimestamp: TimestampWidget;\n\t\tseparator: HTMLElement;\n\t\tcommentPreview: HTMLSpanElement;\n\t\trange: HTMLSpanElement;\n\t};\n\trepliesMetadata: {\n\t\tcontainer: HTMLElement;\n\t\ticon: HTMLElement;\n\t\tcount: HTMLSpanElement;\n\t\tlastReplyDetail: HTMLSpanElement;\n\t\tseparator: HTMLElement;\n\t\ttimestamp: TimestampWidget;\n\t};\n\tactionBar: ActionBar;\n\tdisposables: IDisposable[];\n}\n\nclass CommentsModelVirtualDelegate\n\timplements IListVirtualDelegate<ResourceWithCommentThreads | CommentNode>\n{\n\tprivate static readonly RESOURCE_ID = \"resource-with-comments\";\n\tprivate static readonly COMMENT_ID = \"comment-node\";\n\n\tgetHeight(element: any): number {\n\t\tif (element instanceof CommentNode && element.hasReply()) {\n\t\t\treturn 44;\n\t\t}\n\t\treturn 22;\n\t}\n\n\tpublic getTemplateId(element: any): string {\n\t\tif (element instanceof ResourceWithCommentThreads) {\n\t\t\treturn CommentsModelVirtualDelegate.RESOURCE_ID;\n\t\t}\n\t\tif (element instanceof CommentNode) {\n\t\t\treturn CommentsModelVirtualDelegate.COMMENT_ID;\n\t\t}\n\n\t\treturn \"\";\n\t}\n}\n\nexport class ResourceWithCommentsRenderer\n\timplements\n\t\tIListRenderer<\n\t\t\tITreeNode<ResourceWithCommentThreads>,\n\t\t\tIResourceTemplateData\n\t\t>\n{\n\ttemplateId = \"resource-with-comments\";\n\n\tconstructor(private labels: ResourceLabels) {}\n\n\trenderTemplate(container: HTMLElement) {\n\t\tconst labelContainer = dom.append(\n\t\t\tcontainer,\n\t\t\tdom.$(\".resource-container\"),\n\t\t);\n\t\tconst resourceLabel = this.labels.create(labelContainer);\n\t\tconst separator = dom.append(labelContainer, dom.$(\".separator\"));\n\t\tconst owner = labelContainer.appendChild(dom.$(\".owner\"));\n\n\t\treturn { resourceLabel, owner, separator };\n\t}\n\n\trenderElement(\n\t\tnode: ITreeNode<ResourceWithCommentThreads>,\n\t\tindex: number,\n\t\ttemplateData: IResourceTemplateData,\n\t\theight: number | undefined,\n\t): void {\n\t\ttemplateData.resourceLabel.setFile(node.element.resource);\n\t\ttemplateData.separator.innerText = \"\\u00b7\";\n\n\t\tif (node.element.ownerLabel) {\n\t\t\ttemplateData.owner.innerText = node.element.ownerLabel;\n\t\t\ttemplateData.separator.style.display = \"inline\";\n\t\t} else {\n\t\t\ttemplateData.owner.innerText = \"\";\n\t\t\ttemplateData.separator.style.display = \"none\";\n\t\t}\n\t}\n\n\tdisposeTemplate(templateData: IResourceTemplateData): void {\n\t\ttemplateData.resourceLabel.dispose();\n\t}\n}\n\nexport class CommentsMenus implements IDisposable {\n\tprivate contextKeyService: IContextKeyService | undefined;\n\n\tconstructor(@IMenuService private readonly menuService: IMenuService) {}\n\n\tgetResourceActions(element: CommentNode): { actions: IAction[] } {\n\t\tconst actions = this.getActions(\n\t\t\tMenuId.CommentsViewThreadActions,\n\t\t\telement,\n\t\t);\n\t\treturn { actions: actions.primary };\n\t}\n\n\tgetResourceContextActions(element: CommentNode): IAction[] {\n\t\treturn this.getActions(MenuId.CommentsViewThreadActions, element)\n\t\t\t.secondary;\n\t}\n\n\tpublic setContextKeyService(service: IContextKeyService) {\n\t\tthis.contextKeyService = service;\n\t}\n\n\tprivate getActions(\n\t\tmenuId: MenuId,\n\t\telement: CommentNode,\n\t): { primary: IAction[]; secondary: IAction[] } {\n\t\tif (!this.contextKeyService) {\n\t\t\treturn { primary: [], secondary: [] };\n\t\t}\n\n\t\tconst overlay: [string, any][] = [\n\t\t\t[\"commentController\", element.owner],\n\t\t\t[\"resourceScheme\", element.resource.scheme],\n\t\t\t[\"commentThread\", element.contextValue],\n\t\t\t[\"canReply\", element.thread.canReply],\n\t\t];\n\t\tconst contextKeyService = this.contextKeyService.createOverlay(overlay);\n\n\t\tconst menu = this.menuService.getMenuActions(\n\t\t\tmenuId,\n\t\t\tcontextKeyService,\n\t\t\t{ shouldForwardArgs: true },\n\t\t);\n\t\tconst primary: IAction[] = [];\n\t\tconst secondary: IAction[] = [];\n\t\tconst result = { primary, secondary, menu };\n\t\tcreateAndFillInContextMenuActions(menu, result, \"inline\");\n\n\t\treturn result;\n\t}\n\n\tdispose() {\n\t\tthis.contextKeyService = undefined;\n\t}\n}\n\nexport class CommentNodeRenderer\n\timplements IListRenderer<ITreeNode<CommentNode>, ICommentThreadTemplateData>\n{\n\ttemplateId = \"comment-node\";\n\n\tconstructor(\n\t\tprivate actionViewItemProvider: IActionViewItemProvider,\n\t\tprivate menus: CommentsMenus,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@IConfigurationService\n\t\tprivate readonly configurationService: IConfigurationService,\n\t\t@IHoverService private readonly hoverService: IHoverService,\n\t\t@IThemeService private themeService: IThemeService,\n\t) {}\n\n\trenderTemplate(container: HTMLElement) {\n\t\tconst threadContainer = dom.append(\n\t\t\tcontainer,\n\t\t\tdom.$(\".comment-thread-container\"),\n\t\t);\n\t\tconst metadataContainer = dom.append(\n\t\t\tthreadContainer,\n\t\t\tdom.$(\".comment-metadata-container\"),\n\t\t);\n\t\tconst metadata = dom.append(\n\t\t\tmetadataContainer,\n\t\t\tdom.$(\".comment-metadata\"),\n\t\t);\n\t\tconst threadMetadata = {\n\t\t\ticon: dom.append(metadata, dom.$(\".icon\")),\n\t\t\tuserNames: dom.append(metadata, dom.$(\".user\")),\n\t\t\ttimestamp: new TimestampWidget(\n\t\t\t\tthis.configurationService,\n\t\t\t\tthis.hoverService,\n\t\t\t\tdom.append(metadata, dom.$(\".timestamp-container\")),\n\t\t\t),\n\t\t\trelevance: dom.append(metadata, dom.$(\".relevance\")),\n\t\t\tseparator: dom.append(metadata, dom.$(\".separator\")),\n\t\t\tcommentPreview: dom.append(metadata, dom.$(\".text\")),\n\t\t\trange: dom.append(metadata, dom.$(\".range\")),\n\t\t};\n\t\tthreadMetadata.separator.innerText = \"\\u00b7\";\n\n\t\tconst actionsContainer = dom.append(\n\t\t\tmetadataContainer,\n\t\t\tdom.$(\".actions\"),\n\t\t);\n\t\tconst actionBar = new ActionBar(actionsContainer, {\n\t\t\tactionViewItemProvider: this.actionViewItemProvider,\n\t\t});\n\n\t\tconst snippetContainer = dom.append(\n\t\t\tthreadContainer,\n\t\t\tdom.$(\".comment-snippet-container\"),\n\t\t);\n\t\tconst repliesMetadata = {\n\t\t\tcontainer: snippetContainer,\n\t\t\ticon: dom.append(snippetContainer, dom.$(\".icon\")),\n\t\t\tcount: dom.append(snippetContainer, dom.$(\".count\")),\n\t\t\tlastReplyDetail: dom.append(\n\t\t\t\tsnippetContainer,\n\t\t\t\tdom.$(\".reply-detail\"),\n\t\t\t),\n\t\t\tseparator: dom.append(snippetContainer, dom.$(\".separator\")),\n\t\t\ttimestamp: new TimestampWidget(\n\t\t\t\tthis.configurationService,\n\t\t\t\tthis.hoverService,\n\t\t\t\tdom.append(snippetContainer, dom.$(\".timestamp-container\")),\n\t\t\t),\n\t\t};\n\t\trepliesMetadata.separator.innerText = \"\\u00b7\";\n\t\trepliesMetadata.icon.classList.add(\n\t\t\t...ThemeIcon.asClassNameArray(Codicon.indent),\n\t\t);\n\n\t\tconst disposables = [\n\t\t\tthreadMetadata.timestamp,\n\t\t\trepliesMetadata.timestamp,\n\t\t];\n\t\treturn { threadMetadata, repliesMetadata, actionBar, disposables };\n\t}\n\n\tprivate getCountString(commentCount: number): string {\n\t\tif (commentCount > 2) {\n\t\t\treturn nls.localize(\n\t\t\t\t\"commentsCountReplies\",\n\t\t\t\t\"{0} replies\",\n\t\t\t\tcommentCount - 1,\n\t\t\t);\n\t\t} else if (commentCount === 2) {\n\t\t\treturn nls.localize(\"commentsCountReply\", \"1 reply\");\n\t\t} else {\n\t\t\treturn nls.localize(\"commentCount\", \"1 comment\");\n\t\t}\n\t}\n\n\tprivate getRenderedComment(\n\t\tcommentBody: IMarkdownString,\n\t\tdisposables: DisposableStore,\n\t) {\n\t\tconst renderedComment = renderMarkdown(commentBody, {\n\t\t\tinline: true,\n\t\t\tactionHandler: {\n\t\t\t\tcallback: (link) =>\n\t\t\t\t\topenLinkFromMarkdown(\n\t\t\t\t\t\tthis.openerService,\n\t\t\t\t\t\tlink,\n\t\t\t\t\t\tcommentBody.isTrusted,\n\t\t\t\t\t),\n\t\t\t\tdisposables: disposables,\n\t\t\t},\n\t\t});\n\t\tconst images = renderedComment.element.getElementsByTagName(\"img\");\n\t\tfor (let i = 0; i < images.length; i++) {\n\t\t\tconst image = images[i];\n\t\t\tconst textDescription = dom.$(\"\");\n\t\t\ttextDescription.textContent = image.alt\n\t\t\t\t? nls.localize(\"imageWithLabel\", \"Image: {0}\", image.alt)\n\t\t\t\t: nls.localize(\"image\", \"Image\");\n\t\t\timage.parentNode!.replaceChild(textDescription, image);\n\t\t}\n\t\twhile (\n\t\t\trenderedComment.element.children.length > 1 &&\n\t\t\trenderedComment.element.firstElementChild?.tagName === \"HR\"\n\t\t) {\n\t\t\trenderedComment.element.removeChild(\n\t\t\t\trenderedComment.element.firstElementChild,\n\t\t\t);\n\t\t}\n\t\treturn renderedComment;\n\t}\n\n\tprivate getIcon(threadState?: CommentThreadState): ThemeIcon {\n\t\tif (threadState === CommentThreadState.Unresolved) {\n\t\t\treturn Codicon.commentUnresolved;\n\t\t} else {\n\t\t\treturn Codicon.comment;\n\t\t}\n\t}\n\n\trenderElement(\n\t\tnode: ITreeNode<CommentNode>,\n\t\tindex: number,\n\t\ttemplateData: ICommentThreadTemplateData,\n\t\theight: number | undefined,\n\t): void {\n\t\ttemplateData.actionBar.clear();\n\n\t\tconst commentCount = node.element.replies.length + 1;\n\t\tif (\n\t\t\tnode.element.threadRelevance === CommentThreadApplicability.Outdated\n\t\t) {\n\t\t\ttemplateData.threadMetadata.relevance.style.display = \"\";\n\t\t\ttemplateData.threadMetadata.relevance.innerText = nls.localize(\n\t\t\t\t\"outdated\",\n\t\t\t\t\"Outdated\",\n\t\t\t);\n\t\t\ttemplateData.threadMetadata.separator.style.display = \"none\";\n\t\t} else {\n\t\t\ttemplateData.threadMetadata.relevance.innerText = \"\";\n\t\t\ttemplateData.threadMetadata.relevance.style.display = \"none\";\n\t\t\ttemplateData.threadMetadata.separator.style.display = \"\";\n\t\t}\n\n\t\ttemplateData.threadMetadata.icon.classList.remove(\n\t\t\t...Array.from(\n\t\t\t\ttemplateData.threadMetadata.icon.classList.values(),\n\t\t\t).filter((value) => value.startsWith(\"codicon\")),\n\t\t);\n\t\ttemplateData.threadMetadata.icon.classList.add(\n\t\t\t...ThemeIcon.asClassNameArray(\n\t\t\t\tthis.getIcon(node.element.threadState),\n\t\t\t),\n\t\t);\n\t\tif (node.element.threadState !== undefined) {\n\t\t\tconst color = this.getCommentThreadWidgetStateColor(\n\t\t\t\tnode.element.threadState,\n\t\t\t\tthis.themeService.getColorTheme(),\n\t\t\t);\n\t\t\ttemplateData.threadMetadata.icon.style.setProperty(\n\t\t\t\tcommentViewThreadStateColorVar,\n\t\t\t\t`${color}`,\n\t\t\t);\n\t\t\ttemplateData.threadMetadata.icon.style.color = `var(${commentViewThreadStateColorVar})`;\n\t\t}\n\t\ttemplateData.threadMetadata.userNames.textContent =\n\t\t\tnode.element.comment.userName;\n\t\ttemplateData.threadMetadata.timestamp.setTimestamp(\n\t\t\tnode.element.comment.timestamp\n\t\t\t\t? new Date(node.element.comment.timestamp)\n\t\t\t\t: undefined,\n\t\t);\n\t\tconst originalComment = node.element;\n\n\t\ttemplateData.threadMetadata.commentPreview.innerText = \"\";\n\t\ttemplateData.threadMetadata.commentPreview.style.height = \"22px\";\n\t\tif (typeof originalComment.comment.body === \"string\") {\n\t\t\ttemplateData.threadMetadata.commentPreview.innerText =\n\t\t\t\toriginalComment.comment.body;\n\t\t} else {\n\t\t\tconst disposables = new DisposableStore();\n\t\t\ttemplateData.disposables.push(disposables);\n\t\t\tconst renderedComment = this.getRenderedComment(\n\t\t\t\toriginalComment.comment.body,\n\t\t\t\tdisposables,\n\t\t\t);\n\t\t\ttemplateData.disposables.push(renderedComment);\n\t\t\ttemplateData.threadMetadata.commentPreview.appendChild(\n\t\t\t\trenderedComment.element.firstElementChild ??\n\t\t\t\t\trenderedComment.element,\n\t\t\t);\n\t\t\ttemplateData.disposables.push(\n\t\t\t\tthis.hoverService.setupManagedHover(\n\t\t\t\t\tgetDefaultHoverDelegate(\"mouse\"),\n\t\t\t\t\ttemplateData.threadMetadata.commentPreview,\n\t\t\t\t\trenderedComment.element.textContent ?? \"\",\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tif (node.element.range) {\n\t\t\tif (\n\t\t\t\tnode.element.range.startLineNumber ===\n\t\t\t\tnode.element.range.endLineNumber\n\t\t\t) {\n\t\t\t\ttemplateData.threadMetadata.range.textContent = nls.localize(\n\t\t\t\t\t\"commentLine\",\n\t\t\t\t\t\"[Ln {0}]\",\n\t\t\t\t\tnode.element.range.startLineNumber,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttemplateData.threadMetadata.range.textContent = nls.localize(\n\t\t\t\t\t\"commentRange\",\n\t\t\t\t\t\"[Ln {0}-{1}]\",\n\t\t\t\t\tnode.element.range.startLineNumber,\n\t\t\t\t\tnode.element.range.endLineNumber,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst menuActions = this.menus.getResourceActions(node.element);\n\t\ttemplateData.actionBar.push(menuActions.actions, {\n\t\t\ticon: true,\n\t\t\tlabel: false,\n\t\t});\n\t\ttemplateData.actionBar.context = {\n\t\t\tcommentControlHandle: node.element.controllerHandle,\n\t\t\tcommentThreadHandle: node.element.threadHandle,\n\t\t\t$mid: MarshalledId.CommentThread,\n\t\t} satisfies MarshalledCommentThread;\n\n\t\tif (!node.element.hasReply()) {\n\t\t\ttemplateData.repliesMetadata.container.style.display = \"none\";\n\t\t\treturn;\n\t\t}\n\n\t\ttemplateData.repliesMetadata.container.style.display = \"\";\n\t\ttemplateData.repliesMetadata.count.textContent =\n\t\t\tthis.getCountString(commentCount);\n\t\tconst lastComment =\n\t\t\tnode.element.replies[node.element.replies.length - 1].comment;\n\t\ttemplateData.repliesMetadata.lastReplyDetail.textContent = nls.localize(\n\t\t\t\"lastReplyFrom\",\n\t\t\t\"Last reply from {0}\",\n\t\t\tlastComment.userName,\n\t\t);\n\t\ttemplateData.repliesMetadata.timestamp.setTimestamp(\n\t\t\tlastComment.timestamp ? new Date(lastComment.timestamp) : undefined,\n\t\t);\n\t}\n\n\tprivate getCommentThreadWidgetStateColor(\n\t\tstate: CommentThreadState | undefined,\n\t\ttheme: IColorTheme,\n\t): Color | undefined {\n\t\treturn state !== undefined\n\t\t\t? getCommentThreadStateIconColor(state, theme)\n\t\t\t: undefined;\n\t}\n\n\tdisposeTemplate(templateData: ICommentThreadTemplateData): void {\n\t\ttemplateData.disposables.forEach((disposeable) =>\n\t\t\tdisposeable.dispose(),\n\t\t);\n\t\ttemplateData.actionBar.dispose();\n\t}\n}\n\nexport interface ICommentsListOptions\n\textends IWorkbenchAsyncDataTreeOptions<any, any> {\n\toverrideStyles?: IStyleOverride<IListStyles>;\n}\n\nenum FilterDataType {\n\tResource = 0,\n\tComment = 1,\n}\n\ninterface ResourceFilterData {\n\ttype: FilterDataType.Resource;\n\turiMatches: IMatch[];\n}\n\ninterface CommentFilterData {\n\ttype: FilterDataType.Comment;\n\ttextMatches: IMatch[];\n}\n\ntype FilterData = ResourceFilterData | CommentFilterData;\n\nexport class Filter\n\timplements ITreeFilter<ResourceWithCommentThreads | CommentNode, FilterData>\n{\n\tconstructor(public options: FilterOptions) {}\n\n\tfilter(\n\t\telement: ResourceWithCommentThreads | CommentNode,\n\t\tparentVisibility: TreeVisibility,\n\t): TreeFilterResult<FilterData> {\n\t\tif (\n\t\t\tthis.options.filter === \"\" &&\n\t\t\tthis.options.showResolved &&\n\t\t\tthis.options.showUnresolved\n\t\t) {\n\t\t\treturn TreeVisibility.Visible;\n\t\t}\n\n\t\tif (element instanceof ResourceWithCommentThreads) {\n\t\t\treturn this.filterResourceMarkers(element);\n\t\t} else {\n\t\t\treturn this.filterCommentNode(element, parentVisibility);\n\t\t}\n\t}\n\n\tprivate filterResourceMarkers(\n\t\tresourceMarkers: ResourceWithCommentThreads,\n\t): TreeFilterResult<FilterData> {\n\t\t// Filter by text. Do not apply negated filters on resources instead use exclude patterns\n\t\tif (this.options.textFilter.text && !this.options.textFilter.negate) {\n\t\t\tconst uriMatches = FilterOptions._filter(\n\t\t\t\tthis.options.textFilter.text,\n\t\t\t\tbasename(resourceMarkers.resource),\n\t\t\t);\n\t\t\tif (uriMatches) {\n\t\t\t\treturn {\n\t\t\t\t\tvisibility: true,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttype: FilterDataType.Resource,\n\t\t\t\t\t\turiMatches: uriMatches || [],\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn TreeVisibility.Recurse;\n\t}\n\n\tprivate filterCommentNode(\n\t\tcomment: CommentNode,\n\t\tparentVisibility: TreeVisibility,\n\t): TreeFilterResult<FilterData> {\n\t\tconst matchesResolvedState =\n\t\t\tcomment.threadState === undefined ||\n\t\t\t(this.options.showResolved &&\n\t\t\t\tCommentThreadState.Resolved === comment.threadState) ||\n\t\t\t(this.options.showUnresolved &&\n\t\t\t\tCommentThreadState.Unresolved === comment.threadState);\n\n\t\tif (!matchesResolvedState) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.options.textFilter.text) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst textMatches =\n\t\t\t// Check body of comment for value\n\t\t\tFilterOptions._messageFilter(\n\t\t\t\tthis.options.textFilter.text,\n\t\t\t\ttypeof comment.comment.body === \"string\"\n\t\t\t\t\t? comment.comment.body\n\t\t\t\t\t: comment.comment.body.value,\n\t\t\t) ||\n\t\t\t// Check first user for value\n\t\t\tFilterOptions._messageFilter(\n\t\t\t\tthis.options.textFilter.text,\n\t\t\t\tcomment.comment.userName,\n\t\t\t) ||\n\t\t\t// Check all replies for value\n\t\t\t(\n\t\t\t\tcomment.replies\n\t\t\t\t\t.map((reply) => {\n\t\t\t\t\t\t// Check user for value\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tFilterOptions._messageFilter(\n\t\t\t\t\t\t\t\tthis.options.textFilter.text,\n\t\t\t\t\t\t\t\treply.comment.userName,\n\t\t\t\t\t\t\t) ||\n\t\t\t\t\t\t\t// Check body of reply for value\n\t\t\t\t\t\t\tFilterOptions._messageFilter(\n\t\t\t\t\t\t\t\tthis.options.textFilter.text,\n\t\t\t\t\t\t\t\ttypeof reply.comment.body === \"string\"\n\t\t\t\t\t\t\t\t\t? reply.comment.body\n\t\t\t\t\t\t\t\t\t: reply.comment.body.value,\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\t\t\t\t\t.filter((value) => !!value) as IMatch[][]\n\t\t\t).flat();\n\n\t\t// Matched and not negated\n\t\tif (textMatches.length && !this.options.textFilter.negate) {\n\t\t\treturn {\n\t\t\t\tvisibility: true,\n\t\t\t\tdata: { type: FilterDataType.Comment, textMatches },\n\t\t\t};\n\t\t}\n\n\t\t// Matched and negated - exclude it only if parent visibility is not set\n\t\tif (\n\t\t\ttextMatches.length &&\n\t\t\tthis.options.textFilter.negate &&\n\t\t\tparentVisibility === TreeVisibility.Recurse\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Not matched and negated - include it only if parent visibility is not set\n\t\tif (\n\t\t\ttextMatches.length === 0 &&\n\t\t\tthis.options.textFilter.negate &&\n\t\t\tparentVisibility === TreeVisibility.Recurse\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn parentVisibility;\n\t}\n}\n\nexport class CommentsList extends WorkbenchObjectTree<\n\tCommentsModel | ResourceWithCommentThreads | CommentNode,\n\tany\n> {\n\tprivate readonly menus: CommentsMenus;\n\n\tconstructor(\n\t\tlabels: ResourceLabels,\n\t\tcontainer: HTMLElement,\n\t\toptions: ICommentsListOptions,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IListService listService: IListService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IContextMenuService\n\t\tprivate readonly contextMenuService: IContextMenuService,\n\t\t@IKeybindingService\n\t\tprivate readonly keybindingService: IKeybindingService,\n\t) {\n\t\tconst delegate = new CommentsModelVirtualDelegate();\n\t\tconst actionViewItemProvider = createActionViewItem.bind(\n\t\t\tundefined,\n\t\t\tinstantiationService,\n\t\t);\n\t\tconst menus = instantiationService.createInstance(CommentsMenus);\n\t\tmenus.setContextKeyService(contextKeyService);\n\t\tconst renderers = [\n\t\t\tinstantiationService.createInstance(\n\t\t\t\tResourceWithCommentsRenderer,\n\t\t\t\tlabels,\n\t\t\t),\n\t\t\tinstantiationService.createInstance(\n\t\t\t\tCommentNodeRenderer,\n\t\t\t\tactionViewItemProvider,\n\t\t\t\tmenus,\n\t\t\t),\n\t\t];\n\n\t\tsuper(\n\t\t\t\"CommentsTree\",\n\t\t\tcontainer,\n\t\t\tdelegate,\n\t\t\trenderers,\n\t\t\t{\n\t\t\t\taccessibilityProvider: options.accessibilityProvider,\n\t\t\t\tidentityProvider: {\n\t\t\t\t\tgetId: (element: any) => {\n\t\t\t\t\t\tif (element instanceof CommentsModel) {\n\t\t\t\t\t\t\treturn \"root\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (element instanceof ResourceWithCommentThreads) {\n\t\t\t\t\t\t\treturn `${element.uniqueOwner}-${element.id}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (element instanceof CommentNode) {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t`${element.uniqueOwner}-${element.resource.toString()}-${element.threadId}-${element.comment.uniqueIdInThread}` +\n\t\t\t\t\t\t\t\t(element.isRoot ? \"-root\" : \"\")\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\texpandOnlyOnTwistieClick: true,\n\t\t\t\tcollapseByDefault: false,\n\t\t\t\toverrideStyles: options.overrideStyles,\n\t\t\t\tfilter: options.filter,\n\t\t\t\tsorter: options.sorter,\n\t\t\t\tfindWidgetEnabled: false,\n\t\t\t\tmultipleSelectionSupport: false,\n\t\t\t},\n\t\t\tinstantiationService,\n\t\t\tcontextKeyService,\n\t\t\tlistService,\n\t\t\tconfigurationService,\n\t\t);\n\t\tthis.menus = menus;\n\t\tthis.disposables.add(\n\t\t\tthis.onContextMenu((e) => this.commentsOnContextMenu(e)),\n\t\t);\n\t}\n\n\tprivate commentsOnContextMenu(\n\t\ttreeEvent: ITreeContextMenuEvent<\n\t\t\tCommentsModel | ResourceWithCommentThreads | CommentNode | null\n\t\t>,\n\t): void {\n\t\tconst node:\n\t\t\t| CommentsModel\n\t\t\t| ResourceWithCommentThreads\n\t\t\t| CommentNode\n\t\t\t| null = treeEvent.element;\n\t\tif (!(node instanceof CommentNode)) {\n\t\t\treturn;\n\t\t}\n\t\tconst event: UIEvent = treeEvent.browserEvent;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tthis.setFocus([node]);\n\t\tconst actions = this.menus.getResourceContextActions(node);\n\t\tif (!actions.length) {\n\t\t\treturn;\n\t\t}\n\t\tthis.contextMenuService.showContextMenu({\n\t\t\tgetAnchor: () => treeEvent.anchor,\n\t\t\tgetActions: () => actions,\n\t\t\tgetActionViewItem: (action) => {\n\t\t\t\tconst keybinding = this.keybindingService.lookupKeybinding(\n\t\t\t\t\taction.id,\n\t\t\t\t);\n\t\t\t\tif (keybinding) {\n\t\t\t\t\treturn new ActionViewItem(action, action, {\n\t\t\t\t\t\tlabel: true,\n\t\t\t\t\t\tkeybinding: keybinding.getLabel(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tonHide: (wasCancelled?: boolean) => {\n\t\t\t\tif (wasCancelled) {\n\t\t\t\t\tthis.domFocus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetActionsContext: (): MarshalledCommentThreadInternal => ({\n\t\t\t\tcommentControlHandle: node.controllerHandle,\n\t\t\t\tcommentThreadHandle: node.threadHandle,\n\t\t\t\t$mid: MarshalledId.CommentThread,\n\t\t\t\tthread: node.thread,\n\t\t\t}),\n\t\t});\n\t}\n\n\tfilterComments(): void {\n\t\tthis.refilter();\n\t}\n\n\tgetVisibleItemCount(): number {\n\t\tlet filtered = 0;\n\t\tconst root = this.getNode();\n\n\t\tfor (const resourceNode of root.children) {\n\t\t\tfor (const commentNode of resourceNode.children) {\n\t\t\t\tif (commentNode.visible && resourceNode.visible) {\n\t\t\t\t\tfiltered++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn filtered;\n\t}\n}\n"],
  "mappings": "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",
  "names": ["FilterDataType"]
}
