import{Codicon as c}from"../../../../base/common/codicons.js";import{Emitter as p}from"../../../../base/common/event.js";import{KeyCode as d,KeyMod as h}from"../../../../base/common/keyCodes.js";import{Disposable as f}from"../../../../base/common/lifecycle.js";import{localize as t}from"../../../../nls.js";import{MenuId as S,MenuRegistry as I,registerAction2 as n}from"../../../../platform/actions/common/actions.js";import{ContextKeyExpr as m,RawContextKey as l}from"../../../../platform/contextkey/common/contextkey.js";import"../../../../platform/instantiation/common/instantiation.js";import{KeybindingWeight as a}from"../../../../platform/keybinding/common/keybindingsRegistry.js";import{viewFilterSubmenu as w}from"../../../browser/parts/views/viewFilter.js";import{ViewAction as i}from"../../../browser/parts/views/viewPane.js";import{FocusedViewContext as b}from"../../../common/contextkeys.js";import{CommentsViewFilterFocusContextKey as g}from"./comments.js";import{COMMENTS_VIEW_ID as s}from"./commentsTreeViewer.js";var _=(o=>(o.ResourceAscending="resourceAscending",o.UpdatedAtDescending="updatedAtDescending",o))(_||{});const C=new l("commentsView.showResolvedFilter",!0),y=new l("commentsView.showUnResolvedFilter",!0),v=new l("commentsView.sortBy","resourceAscending");class $ extends f{constructor(o,V){super();this.contextKeyService=V;this._showResolved.set(o.showResolved),this._showUnresolved.set(o.showUnresolved),this._sortBy.set(o.sortBy)}_onDidChange=this._register(new p);onDidChange=this._onDidChange.event;_showUnresolved=y.bindTo(this.contextKeyService);get showUnresolved(){return!!this._showUnresolved.get()}set showUnresolved(o){this._showUnresolved.get()!==o&&(this._showUnresolved.set(o),this._onDidChange.fire({showUnresolved:!0}))}_showResolved=C.bindTo(this.contextKeyService);get showResolved(){return!!this._showResolved.get()}set showResolved(o){this._showResolved.get()!==o&&(this._showResolved.set(o),this._onDidChange.fire({showResolved:!0}))}_sortBy=v.bindTo(this.contextKeyService);get sortBy(){return this._sortBy.get()??"resourceAscending"}set sortBy(o){this._sortBy.get()!==o&&(this._sortBy.set(o),this._onDidChange.fire({sortBy:o}))}}n(class extends i{constructor(){super({id:"commentsFocusViewFromFilter",title:t("focusCommentsList","Focus Comments view"),keybinding:{when:g,weight:a.WorkbenchContrib,primary:h.CtrlCmd|d.DownArrow},viewId:s})}async runInView(r,e){e.focus()}}),n(class extends i{constructor(){super({id:"commentsClearFilterText",title:t("commentsClearFilterText","Clear filter text"),keybinding:{when:g,weight:a.WorkbenchContrib,primary:d.Escape},viewId:s})}async runInView(r,e){e.clearFilterText()}}),n(class extends i{constructor(){super({id:"commentsFocusFilter",title:t("focusCommentsFilter","Focus comments filter"),keybinding:{when:b.isEqualTo(s),weight:a.WorkbenchContrib,primary:h.CtrlCmd|d.KeyF},viewId:s})}async runInView(r,e){e.focusFilter()}}),n(class extends i{constructor(){super({id:`workbench.actions.${s}.toggleUnResolvedComments`,title:t("toggle unresolved","Show Unresolved"),category:t("comments","Comments"),toggled:{condition:y,title:t("unresolved","Show Unresolved")},menu:{id:w,group:"1_filter",when:m.equals("view",s),order:1},viewId:s})}async runInView(r,e){e.filters.showUnresolved=!e.filters.showUnresolved}}),n(class extends i{constructor(){super({id:`workbench.actions.${s}.toggleResolvedComments`,title:t("toggle resolved","Show Resolved"),category:t("comments","Comments"),toggled:{condition:C,title:t("resolved","Show Resolved")},menu:{id:w,group:"1_filter",when:m.equals("view",s),order:1},viewId:s})}async runInView(r,e){e.filters.showResolved=!e.filters.showResolved}});const u=new S("submenu.filter.commentSort");I.appendMenuItem(w,{submenu:u,title:t("comment sorts","Sort By"),group:"2_sort",icon:c.history,when:m.equals("view",s)}),n(class extends i{constructor(){super({id:`workbench.actions.${s}.toggleSortByUpdatedAt`,title:t("toggle sorting by updated at","Updated Time"),category:t("comments","Comments"),icon:c.history,viewId:s,toggled:{condition:m.equals(v.key,"updatedAtDescending"),title:t("sorting by updated at","Updated Time")},menu:{id:u,group:"navigation",order:1,isHiddenByDefault:!1}})}async runInView(r,e){e.filters.sortBy="updatedAtDescending"}}),n(class extends i{constructor(){super({id:`workbench.actions.${s}.toggleSortByResource`,title:t("toggle sorting by resource","Position in File"),category:t("comments","Comments"),icon:c.history,viewId:s,toggled:{condition:m.equals(v.key,"resourceAscending"),title:t("sorting by position in file","Position in File")},menu:{id:u,group:"navigation",order:0,isHiddenByDefault:!1}})}async runInView(r,e){e.filters.sortBy="resourceAscending"}});export{$ as CommentsFilters,_ as CommentsSortOrder};
