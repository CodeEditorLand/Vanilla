var _=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var u=(a,i,n,e)=>{for(var t=e>1?void 0:e?p(i,n):i,r=a.length-1,o;r>=0;r--)(o=a[r])&&(t=(e?o(i,n,t):o(t))||t);return e&&t&&_(i,n,t),t},h=(a,i)=>(n,e)=>i(n,e,a);import*as s from"../../../../base/browser/dom.js";import"../../../../base/common/actions.js";import{Disposable as l}from"../../../../base/common/lifecycle.js";import{MarshalledId as d}from"../../../../base/common/marshallingIds.js";import"../../../../editor/common/core/range.js";import"../../../../editor/common/languages.js";import"../../../../platform/actions/common/actions.js";import"../../../../platform/contextkey/common/contextkey.js";import{IKeybindingService as g}from"../../../../platform/keybinding/common/keybinding.js";import"../../notebook/common/notebookRange.js";import{CommentFormActions as v}from"./commentFormActions.js";import"./commentMenus.js";let m=class extends l{constructor(n,e,t,r,o,c){super();this._commentThread=e;this._contextKeyService=t;this._commentMenus=r;this._actionRunDelegate=o;this._keybindingService=c;this._container=s.append(n,s.$(".comment-additional-actions")),s.append(this._container,s.$(".section-separator")),this._buttonBar=s.append(this._container,s.$(".button-bar")),this._createAdditionalActions(this._buttonBar)}_container;_buttonBar;_commentFormActions;_showMenu(){this._container?.classList.remove("hidden")}_hideMenu(){this._container?.classList.add("hidden")}_enableDisableMenu(n){const e=n.getActions({shouldForwardArgs:!0});for(const t of e){const[,r]=t;for(const o of r){if(o.enabled){this._showMenu();return}for(const c of o.actions??[])if(c.enabled){this._showMenu();return}}}this._hideMenu()}_createAdditionalActions(n){const e=this._commentMenus.getCommentThreadAdditionalActions(this._contextKeyService);this._register(e),this._register(e.onDidChange(()=>{this._commentFormActions.setActions(e,!0),this._enableDisableMenu(e)})),this._commentFormActions=new v(this._keybindingService,this._contextKeyService,n,async t=>{this._actionRunDelegate?.(),t.run({thread:this._commentThread,$mid:d.CommentThreadInstance})},4),this._register(this._commentFormActions),this._commentFormActions.setActions(e,!0),this._enableDisableMenu(e)}};m=u([h(5,g)],m);export{m as CommentThreadAdditionalActions};
