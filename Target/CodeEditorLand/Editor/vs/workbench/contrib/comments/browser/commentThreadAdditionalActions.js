var h=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var p=(m,o,n,e)=>{for(var t=e>1?void 0:e?_(o,n):o,r=m.length-1,i;r>=0;r--)(i=m[r])&&(t=(e?i(o,n,t):i(t))||t);return e&&t&&h(o,n,t),t},u=(m,o)=>(n,e)=>o(n,e,m);import*as s from"../../../../base/browser/dom.js";import{Disposable as l}from"../../../../base/common/lifecycle.js";import{MarshalledId as d}from"../../../../base/common/marshallingIds.js";import{IKeybindingService as g}from"../../../../platform/keybinding/common/keybinding.js";import{CommentFormActions as b}from"./commentFormActions.js";let a=class extends l{constructor(n,e,t,r,i,c){super();this._commentThread=e;this._contextKeyService=t;this._commentMenus=r;this._actionRunDelegate=i;this._keybindingService=c;this._container=s.append(n,s.$(".comment-additional-actions")),s.append(this._container,s.$(".section-separator")),this._buttonBar=s.append(this._container,s.$(".button-bar")),this._createAdditionalActions(this._buttonBar)}_container;_buttonBar;_commentFormActions;_showMenu(){this._container?.classList.remove("hidden")}_hideMenu(){this._container?.classList.add("hidden")}_enableDisableMenu(n){const e=n.getActions({shouldForwardArgs:!0});for(const t of e){const[,r]=t;for(const i of r){if(i.enabled){this._showMenu();return}for(const c of i.actions??[])if(c.enabled){this._showMenu();return}}}this._hideMenu()}_createAdditionalActions(n){const e=this._commentMenus.getCommentThreadAdditionalActions(this._contextKeyService);this._register(e),this._register(e.onDidChange(()=>{this._commentFormActions.setActions(e,!0),this._enableDisableMenu(e)})),this._commentFormActions=new b(this._keybindingService,this._contextKeyService,n,async t=>{this._actionRunDelegate?.(),t.run({thread:this._commentThread,$mid:d.CommentThreadInstance})},4),this._register(this._commentFormActions),this._commentFormActions.setActions(e,!0),this._enableDisableMenu(e)}};a=p([u(5,g)],a);export{a as CommentThreadAdditionalActions};
