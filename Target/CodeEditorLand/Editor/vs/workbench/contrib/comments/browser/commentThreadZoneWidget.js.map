{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/comments/browser/commentThreadZoneWidget.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as dom from \"../../../../base/browser/dom.js\";\nimport { Color } from \"../../../../base/common/color.js\";\nimport { Emitter, type Event } from \"../../../../base/common/event.js\";\nimport {\n\tDisposableStore,\n\ttype IDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport {\n\ttype ICodeEditor,\n\ttype IEditorMouseEvent,\n\tMouseTargetType,\n} from \"../../../../editor/browser/editorBrowser.js\";\nimport { StableEditorScrollState } from \"../../../../editor/browser/stableEditorScroll.js\";\nimport {\n\tEDITOR_FONT_DEFAULTS,\n\tEditorOption,\n\ttype IEditorOptions,\n} from \"../../../../editor/common/config/editorOptions.js\";\nimport type { IPosition } from \"../../../../editor/common/core/position.js\";\nimport { type IRange, Range } from \"../../../../editor/common/core/range.js\";\nimport * as languages from \"../../../../editor/common/languages.js\";\nimport { peekViewBorder } from \"../../../../editor/contrib/peekView/browser/peekView.js\";\nimport { ZoneWidget } from \"../../../../editor/contrib/zoneWidget/browser/zoneWidget.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport { IContextKeyService } from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { ServiceCollection } from \"../../../../platform/instantiation/common/serviceCollection.js\";\nimport {\n\ttype IColorTheme,\n\tIThemeService,\n} from \"../../../../platform/theme/common/themeService.js\";\nimport type { ICellRange } from \"../../notebook/common/notebookRange.js\";\nimport type { ICommentThreadWidget } from \"../common/commentThreadWidget.js\";\nimport {\n\tcommentThreadStateBackgroundColorVar,\n\tcommentThreadStateColorVar,\n\tgetCommentThreadStateBorderColor,\n} from \"./commentColors.js\";\nimport { CommentGlyphWidget } from \"./commentGlyphWidget.js\";\nimport { ICommentService } from \"./commentService.js\";\nimport { CommentThreadWidget } from \"./commentThreadWidget.js\";\n\nfunction getCommentThreadWidgetStateColor(\n\tthread: languages.CommentThreadState | undefined,\n\ttheme: IColorTheme,\n): Color | undefined {\n\treturn (\n\t\tgetCommentThreadStateBorderColor(thread, theme) ??\n\t\ttheme.getColor(peekViewBorder)\n\t);\n}\n\nexport enum CommentWidgetFocus {\n\tNone = 0,\n\tWidget = 1,\n\tEditor = 2,\n}\n\nexport function parseMouseDownInfoFromEvent(e: IEditorMouseEvent) {\n\tconst range = e.target.range;\n\n\tif (!range) {\n\t\treturn null;\n\t}\n\n\tif (!e.event.leftButton) {\n\t\treturn null;\n\t}\n\n\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\treturn null;\n\t}\n\n\tconst data = e.target.detail;\n\tconst gutterOffsetX =\n\t\tdata.offsetX -\n\t\tdata.glyphMarginWidth -\n\t\tdata.lineNumbersWidth -\n\t\tdata.glyphMarginLeft;\n\n\t// don't collide with folding and git decorations\n\tif (gutterOffsetX > 20) {\n\t\treturn null;\n\t}\n\n\treturn { lineNumber: range.startLineNumber };\n}\n\nexport function isMouseUpEventDragFromMouseDown(\n\tmouseDownInfo: { lineNumber: number } | null,\n\te: IEditorMouseEvent,\n) {\n\tif (!mouseDownInfo) {\n\t\treturn null;\n\t}\n\n\tconst { lineNumber } = mouseDownInfo;\n\n\tconst range = e.target.range;\n\n\tif (!range) {\n\t\treturn null;\n\t}\n\n\treturn lineNumber;\n}\n\nexport function isMouseUpEventMatchMouseDown(\n\tmouseDownInfo: { lineNumber: number } | null,\n\te: IEditorMouseEvent,\n) {\n\tif (!mouseDownInfo) {\n\t\treturn null;\n\t}\n\n\tconst { lineNumber } = mouseDownInfo;\n\n\tconst range = e.target.range;\n\n\tif (!range || range.startLineNumber !== lineNumber) {\n\t\treturn null;\n\t}\n\n\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\treturn null;\n\t}\n\n\treturn lineNumber;\n}\n\nexport class ReviewZoneWidget\n\textends ZoneWidget\n\timplements ICommentThreadWidget\n{\n\tprivate _commentThreadWidget!: CommentThreadWidget;\n\tprivate readonly _onDidClose = new Emitter<ReviewZoneWidget | undefined>();\n\tprivate readonly _onDidCreateThread = new Emitter<ReviewZoneWidget>();\n\tprivate _isExpanded?: boolean;\n\tprivate _initialCollapsibleState?: languages.CommentThreadCollapsibleState;\n\tprivate _commentGlyph?: CommentGlyphWidget;\n\tprivate readonly _globalToDispose = new DisposableStore();\n\tprivate _commentThreadDisposables: IDisposable[] = [];\n\tprivate _contextKeyService: IContextKeyService;\n\tprivate _scopedInstantiationService: IInstantiationService;\n\n\tpublic get uniqueOwner(): string {\n\t\treturn this._uniqueOwner;\n\t}\n\tpublic get commentThread(): languages.CommentThread {\n\t\treturn this._commentThread;\n\t}\n\n\tpublic get expanded(): boolean | undefined {\n\t\treturn this._isExpanded;\n\t}\n\n\tprivate _commentOptions: languages.CommentOptions | undefined;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tprivate _uniqueOwner: string,\n\t\tprivate _commentThread: languages.CommentThread,\n\t\tprivate _pendingComment: string | undefined,\n\t\tprivate _pendingEdits: { [key: number]: string } | undefined,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IThemeService private themeService: IThemeService,\n\t\t@ICommentService private commentService: ICommentService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService\n\t\tprivate readonly configurationService: IConfigurationService,\n\t) {\n\t\tsuper(editor, { keepEditorSelection: true, isAccessible: true });\n\t\tthis._contextKeyService = contextKeyService.createScoped(this.domNode);\n\n\t\tthis._scopedInstantiationService = this._globalToDispose.add(\n\t\t\tinstantiationService.createChild(\n\t\t\t\tnew ServiceCollection([\n\t\t\t\t\tIContextKeyService,\n\t\t\t\t\tthis._contextKeyService,\n\t\t\t\t]),\n\t\t\t),\n\t\t);\n\n\t\tconst controller = this.commentService.getCommentController(\n\t\t\tthis._uniqueOwner,\n\t\t);\n\t\tif (controller) {\n\t\t\tthis._commentOptions = controller.options;\n\t\t}\n\n\t\tthis._initialCollapsibleState = _pendingComment\n\t\t\t? languages.CommentThreadCollapsibleState.Expanded\n\t\t\t: _commentThread.initialCollapsibleState;\n\t\t_commentThread.initialCollapsibleState = this._initialCollapsibleState;\n\t\tthis._commentThreadDisposables = [];\n\t\tthis.create();\n\n\t\tthis._globalToDispose.add(\n\t\t\tthis.themeService.onDidColorThemeChange(this._applyTheme, this),\n\t\t);\n\t\tthis._globalToDispose.add(\n\t\t\tthis.editor.onDidChangeConfiguration((e) => {\n\t\t\t\tif (e.hasChanged(EditorOption.fontInfo)) {\n\t\t\t\t\tthis._applyTheme(this.themeService.getColorTheme());\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t\tthis._applyTheme(this.themeService.getColorTheme());\n\t}\n\n\tpublic get onDidClose(): Event<ReviewZoneWidget | undefined> {\n\t\treturn this._onDidClose.event;\n\t}\n\n\tpublic get onDidCreateThread(): Event<ReviewZoneWidget> {\n\t\treturn this._onDidCreateThread.event;\n\t}\n\n\tpublic getPosition(): IPosition | undefined {\n\t\tif (this.position) {\n\t\t\treturn this.position;\n\t\t}\n\n\t\tif (this._commentGlyph) {\n\t\t\treturn this._commentGlyph.getPosition().position ?? undefined;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprotected override revealRange() {\n\t\t// we don't do anything here as we always do the reveal ourselves.\n\t}\n\n\tpublic reveal(\n\t\tcommentUniqueId?: number,\n\t\tfocus: CommentWidgetFocus = CommentWidgetFocus.None,\n\t) {\n\t\tthis.makeVisible(commentUniqueId, focus);\n\t\tconst comment = this._commentThread.comments?.find(\n\t\t\t(comment) => comment.uniqueIdInThread === commentUniqueId,\n\t\t);\n\t\tthis.commentService.setActiveCommentAndThread(this.uniqueOwner, {\n\t\t\tthread: this._commentThread,\n\t\t\tcomment,\n\t\t});\n\t}\n\n\tprivate _expandAndShowZoneWidget() {\n\t\tif (!this._isExpanded) {\n\t\t\tthis.show(this.arrowPosition(this._commentThread.range), 2);\n\t\t}\n\t}\n\n\tprivate _setFocus(focus: CommentWidgetFocus) {\n\t\tif (focus === CommentWidgetFocus.Widget) {\n\t\t\tthis._commentThreadWidget.focus();\n\t\t} else if (focus === CommentWidgetFocus.Editor) {\n\t\t\tthis._commentThreadWidget.focusCommentEditor();\n\t\t}\n\t}\n\n\tprivate _goToComment(commentUniqueId: number, focus: CommentWidgetFocus) {\n\t\tconst height = this.editor.getLayoutInfo().height;\n\t\tconst coords =\n\t\t\tthis._commentThreadWidget.getCommentCoords(commentUniqueId);\n\t\tif (coords) {\n\t\t\tlet scrollTop = 1;\n\t\t\tif (this._commentThread.range) {\n\t\t\t\tconst commentThreadCoords = coords.thread;\n\t\t\t\tconst commentCoords = coords.comment;\n\t\t\t\tscrollTop =\n\t\t\t\t\tthis.editor.getTopForLineNumber(\n\t\t\t\t\t\tthis._commentThread.range.startLineNumber,\n\t\t\t\t\t) -\n\t\t\t\t\theight / 2 +\n\t\t\t\t\tcommentCoords.top -\n\t\t\t\t\tcommentThreadCoords.top;\n\t\t\t}\n\t\t\tthis.editor.setScrollTop(scrollTop);\n\t\t\tthis._setFocus(focus);\n\t\t} else {\n\t\t\tthis._goToThread(focus);\n\t\t}\n\t}\n\n\tprivate _goToThread(focus: CommentWidgetFocus) {\n\t\tconst rangeToReveal = this._commentThread.range\n\t\t\t? new Range(\n\t\t\t\t\tthis._commentThread.range.startLineNumber,\n\t\t\t\t\tthis._commentThread.range.startColumn,\n\t\t\t\t\tthis._commentThread.range.endLineNumber + 1,\n\t\t\t\t\t1,\n\t\t\t\t)\n\t\t\t: new Range(1, 1, 1, 1);\n\n\t\tthis.editor.revealRangeInCenter(rangeToReveal);\n\t\tthis._setFocus(focus);\n\t}\n\n\tpublic makeVisible(\n\t\tcommentUniqueId?: number,\n\t\tfocus: CommentWidgetFocus = CommentWidgetFocus.None,\n\t) {\n\t\tthis._expandAndShowZoneWidget();\n\n\t\tif (commentUniqueId !== undefined) {\n\t\t\tthis._goToComment(commentUniqueId, focus);\n\t\t} else {\n\t\t\tthis._goToThread(focus);\n\t\t}\n\t}\n\n\tpublic getPendingComments(): {\n\t\tnewComment: string | undefined;\n\t\tedits: { [key: number]: string };\n\t} {\n\t\treturn {\n\t\t\tnewComment: this._commentThreadWidget.getPendingComment(),\n\t\t\tedits: this._commentThreadWidget.getPendingEdits(),\n\t\t};\n\t}\n\n\tpublic setPendingComment(comment: string) {\n\t\tthis._pendingComment = comment;\n\t\tthis.expand();\n\t\tthis._commentThreadWidget.setPendingComment(comment);\n\t}\n\n\tprotected _fillContainer(container: HTMLElement): void {\n\t\tthis.setCssClass(\"review-widget\");\n\t\tthis._commentThreadWidget =\n\t\t\tthis._scopedInstantiationService.createInstance(\n\t\t\t\tCommentThreadWidget,\n\t\t\t\tcontainer,\n\t\t\t\tthis.editor,\n\t\t\t\tthis._uniqueOwner,\n\t\t\t\tthis.editor.getModel()!.uri,\n\t\t\t\tthis._contextKeyService,\n\t\t\t\tthis._scopedInstantiationService,\n\t\t\t\tthis._commentThread as unknown as languages.CommentThread<\n\t\t\t\t\tIRange | ICellRange\n\t\t\t\t>,\n\t\t\t\tthis._pendingComment,\n\t\t\t\tthis._pendingEdits,\n\t\t\t\t{\n\t\t\t\t\teditor: this.editor,\n\t\t\t\t\tcodeBlockFontSize: \"\",\n\t\t\t\t\tcodeBlockFontFamily:\n\t\t\t\t\t\tthis.configurationService.getValue<IEditorOptions>(\n\t\t\t\t\t\t\t\"editor\",\n\t\t\t\t\t\t).fontFamily || EDITOR_FONT_DEFAULTS.fontFamily,\n\t\t\t\t},\n\t\t\t\tthis._commentOptions,\n\t\t\t\t{\n\t\t\t\t\tactionRunner: async () => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!this._commentThread.comments ||\n\t\t\t\t\t\t\t!this._commentThread.comments.length\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tconst newPosition = this.getPosition();\n\n\t\t\t\t\t\t\tif (newPosition) {\n\t\t\t\t\t\t\t\tconst originalRange = this._commentThread.range;\n\t\t\t\t\t\t\t\tif (!originalRange) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet range: Range;\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tnewPosition.lineNumber !==\n\t\t\t\t\t\t\t\t\toriginalRange.endLineNumber\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t// The widget could have moved as a result of editor changes.\n\t\t\t\t\t\t\t\t\t// We need to try to calculate the new, more correct, range for the comment.\n\t\t\t\t\t\t\t\t\tconst distance =\n\t\t\t\t\t\t\t\t\t\tnewPosition.lineNumber -\n\t\t\t\t\t\t\t\t\t\toriginalRange.endLineNumber;\n\t\t\t\t\t\t\t\t\trange = new Range(\n\t\t\t\t\t\t\t\t\t\toriginalRange.startLineNumber +\n\t\t\t\t\t\t\t\t\t\t\tdistance,\n\t\t\t\t\t\t\t\t\t\toriginalRange.startColumn,\n\t\t\t\t\t\t\t\t\t\toriginalRange.endLineNumber + distance,\n\t\t\t\t\t\t\t\t\t\toriginalRange.endColumn,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange = new Range(\n\t\t\t\t\t\t\t\t\t\toriginalRange.startLineNumber,\n\t\t\t\t\t\t\t\t\t\toriginalRange.startColumn,\n\t\t\t\t\t\t\t\t\t\toriginalRange.endLineNumber,\n\t\t\t\t\t\t\t\t\t\toriginalRange.endColumn,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tawait this.commentService.updateCommentThreadTemplate(\n\t\t\t\t\t\t\t\t\tthis.uniqueOwner,\n\t\t\t\t\t\t\t\t\tthis._commentThread.commentThreadHandle,\n\t\t\t\t\t\t\t\t\trange,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcollapse: () => {\n\t\t\t\t\t\tthis.collapse();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t) as unknown as CommentThreadWidget<IRange>;\n\n\t\tthis._disposables.add(this._commentThreadWidget);\n\t}\n\n\tprivate arrowPosition(range: IRange | undefined): IPosition | undefined {\n\t\tif (!range) {\n\t\t\treturn undefined;\n\t\t}\n\t\t// Arrow on top edge of zone widget will be at the start of the line if range is multi-line, else at midpoint of range (rounding rightwards)\n\t\treturn {\n\t\t\tlineNumber: range.endLineNumber,\n\t\t\tcolumn:\n\t\t\t\trange.endLineNumber === range.startLineNumber\n\t\t\t\t\t? (range.startColumn + range.endColumn + 1) / 2\n\t\t\t\t\t: 1,\n\t\t};\n\t}\n\n\tprivate deleteCommentThread(): void {\n\t\tthis.dispose();\n\t\tthis.commentService.disposeCommentThread(\n\t\t\tthis.uniqueOwner,\n\t\t\tthis._commentThread.threadId,\n\t\t);\n\t}\n\n\tpublic collapse() {\n\t\tthis._commentThread.collapsibleState =\n\t\t\tlanguages.CommentThreadCollapsibleState.Collapsed;\n\t}\n\n\tpublic expand(setActive?: boolean) {\n\t\tthis._commentThread.collapsibleState =\n\t\t\tlanguages.CommentThreadCollapsibleState.Expanded;\n\t\tif (setActive) {\n\t\t\tthis.commentService.setActiveCommentAndThread(this.uniqueOwner, {\n\t\t\t\tthread: this._commentThread,\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic getGlyphPosition(): number {\n\t\tif (this._commentGlyph) {\n\t\t\treturn this._commentGlyph.getPosition().position!.lineNumber;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tasync update(commentThread: languages.CommentThread<IRange>) {\n\t\tif (this._commentThread !== commentThread) {\n\t\t\tthis._commentThreadDisposables.forEach((disposable) =>\n\t\t\t\tdisposable.dispose(),\n\t\t\t);\n\t\t\tthis._commentThread = commentThread;\n\t\t\tthis._commentThreadDisposables = [];\n\t\t\tthis.bindCommentThreadListeners();\n\t\t}\n\n\t\tawait this._commentThreadWidget.updateCommentThread(commentThread);\n\n\t\t// Move comment glyph widget and show position if the line has changed.\n\t\tconst lineNumber = this._commentThread.range?.endLineNumber ?? 1;\n\t\tlet shouldMoveWidget = false;\n\t\tif (this._commentGlyph) {\n\t\t\tthis._commentGlyph.setThreadState(commentThread.state);\n\t\t\tif (\n\t\t\t\tthis._commentGlyph.getPosition().position!.lineNumber !==\n\t\t\t\tlineNumber\n\t\t\t) {\n\t\t\t\tshouldMoveWidget = true;\n\t\t\t\tthis._commentGlyph.setLineNumber(lineNumber);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\t(shouldMoveWidget && this._isExpanded) ||\n\t\t\t(this._commentThread.collapsibleState ===\n\t\t\t\tlanguages.CommentThreadCollapsibleState.Expanded &&\n\t\t\t\t!this._isExpanded)\n\t\t) {\n\t\t\tthis.show(this.arrowPosition(this._commentThread.range), 2);\n\t\t} else if (\n\t\t\tthis._commentThread.collapsibleState !==\n\t\t\tlanguages.CommentThreadCollapsibleState.Expanded\n\t\t) {\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\tprotected override _onWidth(widthInPixel: number): void {\n\t\tthis._commentThreadWidget.layout(widthInPixel);\n\t}\n\n\tprotected override _doLayout(\n\t\theightInPixel: number,\n\t\twidthInPixel: number,\n\t): void {\n\t\tthis._commentThreadWidget.layout(widthInPixel);\n\t}\n\n\tasync display(range: IRange | undefined, shouldReveal: boolean) {\n\t\tif (range) {\n\t\t\tthis._commentGlyph = new CommentGlyphWidget(\n\t\t\t\tthis.editor,\n\t\t\t\trange?.endLineNumber ?? -1,\n\t\t\t);\n\t\t\tthis._commentGlyph.setThreadState(this._commentThread.state);\n\t\t\tthis._globalToDispose.add(\n\t\t\t\tthis._commentGlyph.onDidChangeLineNumber(async (e) => {\n\t\t\t\t\tif (!this._commentThread.range) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst shift = e - this._commentThread.range.endLineNumber;\n\t\t\t\t\tconst newRange = new Range(\n\t\t\t\t\t\tthis._commentThread.range.startLineNumber + shift,\n\t\t\t\t\t\tthis._commentThread.range.startColumn,\n\t\t\t\t\t\tthis._commentThread.range.endLineNumber + shift,\n\t\t\t\t\t\tthis._commentThread.range.endColumn,\n\t\t\t\t\t);\n\t\t\t\t\tthis._commentThread.range = newRange;\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tawait this._commentThreadWidget.display(\n\t\t\tthis.editor.getOption(EditorOption.lineHeight),\n\t\t\tshouldReveal,\n\t\t);\n\t\tthis._disposables.add(\n\t\t\tthis._commentThreadWidget.onDidResize((dimension) => {\n\t\t\t\tthis._refresh(dimension);\n\t\t\t}),\n\t\t);\n\t\tif (\n\t\t\tthis._commentThread.collapsibleState ===\n\t\t\t\tlanguages.CommentThreadCollapsibleState.Expanded ||\n\t\t\trange === undefined\n\t\t) {\n\t\t\tthis.show(this.arrowPosition(range), 2);\n\t\t}\n\n\t\t// If this is a new comment thread awaiting user input then we need to reveal it.\n\t\tif (shouldReveal) {\n\t\t\tthis.makeVisible();\n\t\t}\n\n\t\tthis.bindCommentThreadListeners();\n\t}\n\n\tprivate bindCommentThreadListeners() {\n\t\tthis._commentThreadDisposables.push(\n\t\t\tthis._commentThread.onDidChangeComments(async (_) => {\n\t\t\t\tawait this.update(this._commentThread);\n\t\t\t}),\n\t\t);\n\n\t\tthis._commentThreadDisposables.push(\n\t\t\tthis._commentThread.onDidChangeCollapsibleState((state) => {\n\t\t\t\tif (\n\t\t\t\t\tstate ===\n\t\t\t\t\t\tlanguages.CommentThreadCollapsibleState.Expanded &&\n\t\t\t\t\t!this._isExpanded\n\t\t\t\t) {\n\t\t\t\t\tthis.show(this.arrowPosition(this._commentThread.range), 2);\n\t\t\t\t\tthis._commentThreadWidget.ensureFocusIntoNewEditingComment();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tstate ===\n\t\t\t\t\t\tlanguages.CommentThreadCollapsibleState.Collapsed &&\n\t\t\t\t\tthis._isExpanded\n\t\t\t\t) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tif (this._initialCollapsibleState === undefined) {\n\t\t\tconst onDidChangeInitialCollapsibleState =\n\t\t\t\tthis._commentThread.onDidChangeInitialCollapsibleState(\n\t\t\t\t\t(state) => {\n\t\t\t\t\t\t// File comments always start expanded\n\t\t\t\t\t\tthis._initialCollapsibleState = state;\n\t\t\t\t\t\tthis._commentThread.collapsibleState =\n\t\t\t\t\t\t\tthis._initialCollapsibleState;\n\t\t\t\t\t\tonDidChangeInitialCollapsibleState.dispose();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\tthis._commentThreadDisposables.push(\n\t\t\t\tonDidChangeInitialCollapsibleState,\n\t\t\t);\n\t\t}\n\n\t\tthis._commentThreadDisposables.push(\n\t\t\tthis._commentThread.onDidChangeState(() => {\n\t\t\t\tconst borderColor =\n\t\t\t\t\tgetCommentThreadWidgetStateColor(\n\t\t\t\t\t\tthis._commentThread.state,\n\t\t\t\t\t\tthis.themeService.getColorTheme(),\n\t\t\t\t\t) || Color.transparent;\n\t\t\t\tthis.style({\n\t\t\t\t\tframeColor: borderColor,\n\t\t\t\t\tarrowColor: borderColor,\n\t\t\t\t});\n\t\t\t\tthis.container?.style.setProperty(\n\t\t\t\t\tcommentThreadStateColorVar,\n\t\t\t\t\t`${borderColor}`,\n\t\t\t\t);\n\t\t\t\tthis.container?.style.setProperty(\n\t\t\t\t\tcommentThreadStateBackgroundColorVar,\n\t\t\t\t\t`${borderColor.transparent(0.1)}`,\n\t\t\t\t);\n\t\t\t}),\n\t\t);\n\t}\n\n\tasync submitComment(): Promise<void> {\n\t\treturn this._commentThreadWidget.submitComment();\n\t}\n\n\t_refresh(dimensions: dom.Dimension) {\n\t\tif (\n\t\t\tthis._isExpanded === undefined &&\n\t\t\tdimensions.height === 0 &&\n\t\t\tdimensions.width === 0\n\t\t) {\n\t\t\tthis.commentThread.collapsibleState =\n\t\t\t\tlanguages.CommentThreadCollapsibleState.Collapsed;\n\t\t\treturn;\n\t\t}\n\t\tif (this._isExpanded) {\n\t\t\tthis._commentThreadWidget.layout();\n\n\t\t\tconst headHeight = Math.ceil(\n\t\t\t\tthis.editor.getOption(EditorOption.lineHeight) * 1.2,\n\t\t\t);\n\t\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\t\tconst arrowHeight = Math.round(lineHeight / 3);\n\t\t\tconst frameThickness = Math.round(lineHeight / 9) * 2;\n\n\t\t\tconst computedLinesNumber = Math.ceil(\n\t\t\t\t(headHeight +\n\t\t\t\t\tdimensions.height +\n\t\t\t\t\tarrowHeight +\n\t\t\t\t\tframeThickness +\n\t\t\t\t\t8) /** margin bottom to avoid margin collapse */ /\n\t\t\t\t\tlineHeight,\n\t\t\t);\n\n\t\t\tif (this._viewZone?.heightInLines === computedLinesNumber) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentPosition = this.getPosition();\n\n\t\t\tif (\n\t\t\t\tthis._viewZone &&\n\t\t\t\tcurrentPosition &&\n\t\t\t\tcurrentPosition.lineNumber !== this._viewZone.afterLineNumber &&\n\t\t\t\tthis._viewZone.afterLineNumber !== 0\n\t\t\t) {\n\t\t\t\tthis._viewZone.afterLineNumber = currentPosition.lineNumber;\n\t\t\t}\n\n\t\t\tconst capture = StableEditorScrollState.capture(this.editor);\n\t\t\tthis._relayout(computedLinesNumber);\n\t\t\tcapture.restore(this.editor);\n\t\t}\n\t}\n\n\tprivate _applyTheme(theme: IColorTheme) {\n\t\tconst borderColor =\n\t\t\tgetCommentThreadWidgetStateColor(\n\t\t\t\tthis._commentThread.state,\n\t\t\t\tthis.themeService.getColorTheme(),\n\t\t\t) || Color.transparent;\n\t\tthis.style({\n\t\t\tarrowColor: borderColor,\n\t\t\tframeColor: borderColor,\n\t\t});\n\t\tconst fontInfo = this.editor.getOption(EditorOption.fontInfo);\n\n\t\t// Editor decorations should also be responsive to theme changes\n\t\tthis._commentThreadWidget.applyTheme(theme, fontInfo);\n\t}\n\n\toverride show(\n\t\trangeOrPos: IRange | IPosition | undefined,\n\t\theightInLines: number,\n\t): void {\n\t\tconst glyphPosition = this._commentGlyph?.getPosition();\n\t\tlet range = Range.isIRange(rangeOrPos)\n\t\t\t? rangeOrPos\n\t\t\t: rangeOrPos\n\t\t\t\t? Range.fromPositions(rangeOrPos)\n\t\t\t\t: undefined;\n\t\tif (\n\t\t\tglyphPosition?.position &&\n\t\t\trange &&\n\t\t\tglyphPosition.position.lineNumber !== range.endLineNumber\n\t\t) {\n\t\t\t// The widget could have moved as a result of editor changes.\n\t\t\t// We need to try to calculate the new, more correct, range for the comment.\n\t\t\tconst distance =\n\t\t\t\tglyphPosition.position.lineNumber - range.endLineNumber;\n\t\t\trange = new Range(\n\t\t\t\trange.startLineNumber + distance,\n\t\t\t\trange.startColumn,\n\t\t\t\trange.endLineNumber + distance,\n\t\t\t\trange.endColumn,\n\t\t\t);\n\t\t}\n\n\t\tthis._isExpanded = true;\n\t\tsuper.show(range ?? new Range(0, 0, 0, 0), heightInLines);\n\t\tthis._commentThread.collapsibleState =\n\t\t\tlanguages.CommentThreadCollapsibleState.Expanded;\n\t\tthis._refresh(this._commentThreadWidget.getDimensions());\n\t}\n\n\toverride hide() {\n\t\tif (this._isExpanded) {\n\t\t\tthis._isExpanded = false;\n\t\t\t// Focus the container so that the comment editor will be blurred before it is hidden\n\t\t\tif (this.editor.hasWidgetFocus()) {\n\t\t\t\tthis.editor.focus();\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!this._commentThread.comments ||\n\t\t\t\t!this._commentThread.comments.length\n\t\t\t) {\n\t\t\t\tthis.deleteCommentThread();\n\t\t\t}\n\t\t}\n\t\tsuper.hide();\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tif (this._commentGlyph) {\n\t\t\tthis._commentGlyph.dispose();\n\t\t\tthis._commentGlyph = undefined;\n\t\t}\n\n\t\tthis._globalToDispose.dispose();\n\t\tthis._commentThreadDisposables.forEach((global) => global.dispose());\n\t\tthis._onDidClose.fire(undefined);\n\t}\n}\n"],
  "mappings": "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",
  "names": ["CommentWidgetFocus", "comment"]
}
