{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/comments/browser/commentsView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport \"./media/panel.css\";\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport type { ITreeElement } from \"../../../../base/browser/ui/tree/tree.js\";\nimport { basename } from \"../../../../base/common/resources.js\";\nimport { isCodeEditor } from \"../../../../editor/browser/editorBrowser.js\";\nimport {\n\tCommentThreadApplicability,\n\tCommentThreadState,\n} from \"../../../../editor/common/languages.js\";\nimport * as nls from \"../../../../nls.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport {\n\ttype IContextKey,\n\tIContextKeyService,\n\tRawContextKey,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { IContextMenuService } from \"../../../../platform/contextview/browser/contextView.js\";\nimport { IHoverService } from \"../../../../platform/hover/browser/hover.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { IKeybindingService } from \"../../../../platform/keybinding/common/keybinding.js\";\nimport { IOpenerService } from \"../../../../platform/opener/common/opener.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n} from \"../../../../platform/storage/common/storage.js\";\nimport { ITelemetryService } from \"../../../../platform/telemetry/common/telemetry.js\";\nimport { IThemeService } from \"../../../../platform/theme/common/themeService.js\";\nimport { IUriIdentityService } from \"../../../../platform/uriIdentity/common/uriIdentity.js\";\nimport { registerNavigableContainer } from \"../../../browser/actions/widgetNavigationCommands.js\";\nimport { ResourceLabels } from \"../../../browser/labels.js\";\nimport {\n\tFilterViewPane,\n\ttype IViewPaneOptions,\n} from \"../../../browser/parts/views/viewPane.js\";\nimport { Memento, type MementoObject } from \"../../../common/memento.js\";\nimport { IViewDescriptorService } from \"../../../common/views.js\";\nimport { IEditorService } from \"../../../services/editor/common/editorService.js\";\nimport { IPathService } from \"../../../services/path/common/pathService.js\";\nimport { AccessibilityVerbositySettingId } from \"../../accessibility/browser/accessibilityConfiguration.js\";\nimport { AccessibleViewAction } from \"../../accessibility/browser/accessibleViewActions.js\";\nimport {\n\tCommentNode,\n\ttype ICommentThreadChangedEvent,\n\tResourceWithCommentThreads,\n} from \"../common/commentModel.js\";\nimport {\n\tICommentService,\n\ttype IWorkspaceCommentThreadsEvent,\n} from \"./commentService.js\";\nimport {\n\tCommentsViewFilterFocusContextKey,\n\ttype ICommentsView,\n} from \"./comments.js\";\nimport { revealCommentThread } from \"./commentsController.js\";\nimport { FilterOptions } from \"./commentsFilterOptions.js\";\nimport {\n\tCommentsModel,\n\ttype ICommentsModel,\n\tthreadHasMeaningfulComments,\n} from \"./commentsModel.js\";\nimport {\n\tCOMMENTS_VIEW_TITLE,\n\tCommentsList,\n\tFilter,\n} from \"./commentsTreeViewer.js\";\nimport {\n\tCommentsFilters,\n\ttype CommentsFiltersChangeEvent,\n\tCommentsSortOrder,\n} from \"./commentsViewActions.js\";\n\nexport const CONTEXT_KEY_HAS_COMMENTS = new RawContextKey<boolean>(\n\t\"commentsView.hasComments\",\n\tfalse,\n);\nexport const CONTEXT_KEY_SOME_COMMENTS_EXPANDED = new RawContextKey<boolean>(\n\t\"commentsView.someCommentsExpanded\",\n\tfalse,\n);\nexport const CONTEXT_KEY_COMMENT_FOCUSED = new RawContextKey<boolean>(\n\t\"commentsView.commentFocused\",\n\tfalse,\n);\nconst VIEW_STORAGE_ID = \"commentsViewState\";\n\ntype CommentsTreeNode =\n\t| CommentsModel\n\t| ResourceWithCommentThreads\n\t| CommentNode;\n\nfunction createResourceCommentsIterator(\n\tmodel: ICommentsModel,\n): Iterable<ITreeElement<CommentsTreeNode>> {\n\tconst result: ITreeElement<CommentsTreeNode>[] = [];\n\n\tfor (const m of model.resourceCommentThreads) {\n\t\tconst children = [];\n\t\tfor (const r of m.commentThreads) {\n\t\t\tif (threadHasMeaningfulComments(r.thread)) {\n\t\t\t\tchildren.push({ element: r });\n\t\t\t}\n\t\t}\n\t\tif (children.length > 0) {\n\t\t\tresult.push({ element: m, children });\n\t\t}\n\t}\n\treturn result;\n}\n\nexport class CommentsPanel extends FilterViewPane implements ICommentsView {\n\tprivate treeLabels!: ResourceLabels;\n\tprivate tree: CommentsList | undefined;\n\tprivate treeContainer!: HTMLElement;\n\tprivate messageBoxContainer!: HTMLElement;\n\tprivate totalComments = 0;\n\tprivate readonly hasCommentsContextKey: IContextKey<boolean>;\n\tprivate readonly someCommentsExpandedContextKey: IContextKey<boolean>;\n\tprivate readonly commentsFocusedContextKey: IContextKey<boolean>;\n\tprivate readonly filter: Filter;\n\treadonly filters: CommentsFilters;\n\n\tprivate currentHeight = 0;\n\tprivate currentWidth = 0;\n\tprivate readonly viewState: MementoObject;\n\tprivate readonly stateMemento: Memento;\n\tprivate cachedFilterStats: { total: number; filtered: number } | undefined =\n\t\tundefined;\n\n\treadonly onDidChangeVisibility = this.onDidChangeBodyVisibility;\n\n\tget focusedCommentNode(): CommentNode | undefined {\n\t\tconst focused = this.tree?.getFocus();\n\t\tif (focused?.length === 1 && focused[0] instanceof CommentNode) {\n\t\t\treturn focused[0];\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tget focusedCommentInfo(): string | undefined {\n\t\tif (!this.focusedCommentNode) {\n\t\t\treturn;\n\t\t}\n\t\treturn this.getScreenReaderInfoForNode(this.focusedCommentNode);\n\t}\n\n\tfocusNextNode(): void {\n\t\tif (!this.tree) {\n\t\t\treturn;\n\t\t}\n\t\tconst focused = this.tree.getFocus()?.[0];\n\t\tif (!focused) {\n\t\t\treturn;\n\t\t}\n\t\tlet next = this.tree.navigate(focused).next();\n\t\twhile (next && !(next instanceof CommentNode)) {\n\t\t\tnext = this.tree.navigate(next).next();\n\t\t}\n\t\tif (!next) {\n\t\t\treturn;\n\t\t}\n\t\tthis.tree.setFocus([next]);\n\t}\n\n\tfocusPreviousNode(): void {\n\t\tif (!this.tree) {\n\t\t\treturn;\n\t\t}\n\t\tconst focused = this.tree.getFocus()?.[0];\n\t\tif (!focused) {\n\t\t\treturn;\n\t\t}\n\t\tlet previous = this.tree.navigate(focused).previous();\n\t\twhile (previous && !(previous instanceof CommentNode)) {\n\t\t\tprevious = this.tree.navigate(previous).previous();\n\t\t}\n\t\tif (!previous) {\n\t\t\treturn;\n\t\t}\n\t\tthis.tree.setFocus([previous]);\n\t}\n\n\tconstructor(\n\t\toptions: IViewPaneOptions,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ICommentService private readonly commentService: ICommentService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@IUriIdentityService\n\t\tprivate readonly uriIdentityService: IUriIdentityService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IPathService private readonly pathService: IPathService,\n\t) {\n\t\tconst stateMemento = new Memento(VIEW_STORAGE_ID, storageService);\n\t\tconst viewState = stateMemento.getMemento(\n\t\t\tStorageScope.WORKSPACE,\n\t\t\tStorageTarget.MACHINE,\n\t\t);\n\t\tsuper(\n\t\t\t{\n\t\t\t\t...options,\n\t\t\t\tfilterOptions: {\n\t\t\t\t\tplaceholder: nls.localize(\n\t\t\t\t\t\t\"comments.filter.placeholder\",\n\t\t\t\t\t\t\"Filter (e.g. text, author)\",\n\t\t\t\t\t),\n\t\t\t\t\tariaLabel: nls.localize(\n\t\t\t\t\t\t\"comments.filter.ariaLabel\",\n\t\t\t\t\t\t\"Filter comments\",\n\t\t\t\t\t),\n\t\t\t\t\thistory: viewState[\"filterHistory\"] || [],\n\t\t\t\t\ttext: viewState[\"filter\"] || \"\",\n\t\t\t\t\tfocusContextKey: CommentsViewFilterFocusContextKey.key,\n\t\t\t\t},\n\t\t\t},\n\t\t\tkeybindingService,\n\t\t\tcontextMenuService,\n\t\t\tconfigurationService,\n\t\t\tcontextKeyService,\n\t\t\tviewDescriptorService,\n\t\t\tinstantiationService,\n\t\t\topenerService,\n\t\t\tthemeService,\n\t\t\ttelemetryService,\n\t\t\thoverService,\n\t\t);\n\t\tthis.hasCommentsContextKey =\n\t\t\tCONTEXT_KEY_HAS_COMMENTS.bindTo(contextKeyService);\n\t\tthis.someCommentsExpandedContextKey =\n\t\t\tCONTEXT_KEY_SOME_COMMENTS_EXPANDED.bindTo(contextKeyService);\n\t\tthis.commentsFocusedContextKey =\n\t\t\tCONTEXT_KEY_COMMENT_FOCUSED.bindTo(contextKeyService);\n\t\tthis.stateMemento = stateMemento;\n\t\tthis.viewState = viewState;\n\n\t\tthis.filters = this._register(\n\t\t\tnew CommentsFilters(\n\t\t\t\t{\n\t\t\t\t\tshowResolved: this.viewState[\"showResolved\"] !== false,\n\t\t\t\t\tshowUnresolved: this.viewState[\"showUnresolved\"] !== false,\n\t\t\t\t\tsortBy:\n\t\t\t\t\t\tthis.viewState[\"sortBy\"] ??\n\t\t\t\t\t\tCommentsSortOrder.ResourceAscending,\n\t\t\t\t},\n\t\t\t\tthis.contextKeyService,\n\t\t\t),\n\t\t);\n\t\tthis.filter = new Filter(\n\t\t\tnew FilterOptions(\n\t\t\t\tthis.filterWidget.getFilterText(),\n\t\t\t\tthis.filters.showResolved,\n\t\t\t\tthis.filters.showUnresolved,\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.filters.onDidChange((event: CommentsFiltersChangeEvent) => {\n\t\t\t\tif (event.showResolved || event.showUnresolved) {\n\t\t\t\t\tthis.updateFilter();\n\t\t\t\t}\n\t\t\t\tif (event.sortBy) {\n\t\t\t\t\tthis.refresh();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.filterWidget.onDidChangeFilterText(() => this.updateFilter()),\n\t\t);\n\t}\n\n\toverride saveState(): void {\n\t\tthis.viewState[\"filter\"] = this.filterWidget.getFilterText();\n\t\tthis.viewState[\"filterHistory\"] = this.filterWidget.getHistory();\n\t\tthis.viewState[\"showResolved\"] = this.filters.showResolved;\n\t\tthis.viewState[\"showUnresolved\"] = this.filters.showUnresolved;\n\t\tthis.viewState[\"sortBy\"] = this.filters.sortBy;\n\t\tthis.stateMemento.saveMemento();\n\t\tsuper.saveState();\n\t}\n\n\toverride render(): void {\n\t\tsuper.render();\n\t\tthis._register(\n\t\t\tregisterNavigableContainer({\n\t\t\t\tname: \"commentsView\",\n\t\t\t\tfocusNotifiers: [this, this.filterWidget],\n\t\t\t\tfocusNextWidget: () => {\n\t\t\t\t\tif (this.filterWidget.hasFocus()) {\n\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfocusPreviousWidget: () => {\n\t\t\t\t\tif (!this.filterWidget.hasFocus()) {\n\t\t\t\t\t\tthis.focusFilter();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}),\n\t\t);\n\t}\n\n\tpublic focusFilter(): void {\n\t\tthis.filterWidget.focus();\n\t}\n\n\tpublic clearFilterText(): void {\n\t\tthis.filterWidget.setFilterText(\"\");\n\t}\n\n\tpublic getFilterStats(): { total: number; filtered: number } {\n\t\tif (!this.cachedFilterStats) {\n\t\t\tthis.cachedFilterStats = {\n\t\t\t\ttotal: this.totalComments,\n\t\t\t\tfiltered: this.tree?.getVisibleItemCount() ?? 0,\n\t\t\t};\n\t\t}\n\n\t\treturn this.cachedFilterStats;\n\t}\n\n\tprivate updateFilter() {\n\t\tthis.filter.options = new FilterOptions(\n\t\t\tthis.filterWidget.getFilterText(),\n\t\t\tthis.filters.showResolved,\n\t\t\tthis.filters.showUnresolved,\n\t\t);\n\t\tthis.tree?.filterComments();\n\n\t\tthis.cachedFilterStats = undefined;\n\t\tconst { total, filtered } = this.getFilterStats();\n\t\tthis.filterWidget.updateBadge(\n\t\t\ttotal === filtered || total === 0\n\t\t\t\t? undefined\n\t\t\t\t: nls.localize(\n\t\t\t\t\t\t\"showing filtered results\",\n\t\t\t\t\t\t\"Showing {0} of {1}\",\n\t\t\t\t\t\tfiltered,\n\t\t\t\t\t\ttotal,\n\t\t\t\t\t),\n\t\t);\n\t\tthis.filterWidget.checkMoreFilters(\n\t\t\t!this.filters.showResolved || !this.filters.showUnresolved,\n\t\t);\n\t}\n\n\tprotected override renderBody(container: HTMLElement): void {\n\t\tsuper.renderBody(container);\n\n\t\tcontainer.classList.add(\"comments-panel\");\n\n\t\tconst domContainer = dom.append(\n\t\t\tcontainer,\n\t\t\tdom.$(\".comments-panel-container\"),\n\t\t);\n\n\t\tthis.treeContainer = dom.append(domContainer, dom.$(\".tree-container\"));\n\t\tthis.treeContainer.classList.add(\n\t\t\t\"file-icon-themable-tree\",\n\t\t\t\"show-file-icons\",\n\t\t);\n\n\t\tthis.cachedFilterStats = undefined;\n\t\tthis.createTree();\n\t\tthis.createMessageBox(domContainer);\n\n\t\tthis._register(\n\t\t\tthis.commentService.onDidSetAllCommentThreads(\n\t\t\t\tthis.onAllCommentsChanged,\n\t\t\t\tthis,\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.commentService.onDidUpdateCommentThreads(\n\t\t\t\tthis.onCommentsUpdated,\n\t\t\t\tthis,\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.commentService.onDidDeleteDataProvider(\n\t\t\t\tthis.onDataProviderDeleted,\n\t\t\t\tthis,\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.onDidChangeBodyVisibility((visible) => {\n\t\t\t\tif (visible) {\n\t\t\t\t\tthis.refresh();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis.renderComments();\n\t}\n\n\tpublic override focus(): void {\n\t\tsuper.focus();\n\n\t\tconst element = this.tree?.getHTMLElement();\n\t\tif (element && dom.isActiveElement(element)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!this.commentService.commentsModel.hasCommentThreads() &&\n\t\t\tthis.messageBoxContainer\n\t\t) {\n\t\t\tthis.messageBoxContainer.focus();\n\t\t} else if (this.tree) {\n\t\t\tthis.tree.domFocus();\n\t\t}\n\t}\n\n\tprivate renderComments(): void {\n\t\tthis.treeContainer.classList.toggle(\n\t\t\t\"hidden\",\n\t\t\t!this.commentService.commentsModel.hasCommentThreads(),\n\t\t);\n\t\tthis.renderMessage();\n\t\tthis.tree?.setChildren(\n\t\t\tnull,\n\t\t\tcreateResourceCommentsIterator(this.commentService.commentsModel),\n\t\t);\n\t}\n\n\tpublic collapseAll() {\n\t\tif (this.tree) {\n\t\t\tthis.tree.collapseAll();\n\t\t\tthis.tree.setSelection([]);\n\t\t\tthis.tree.setFocus([]);\n\t\t\tthis.tree.domFocus();\n\t\t\tthis.tree.focusFirst();\n\t\t}\n\t}\n\n\tpublic expandAll() {\n\t\tif (this.tree) {\n\t\t\tthis.tree.expandAll();\n\t\t\tthis.tree.setSelection([]);\n\t\t\tthis.tree.setFocus([]);\n\t\t\tthis.tree.domFocus();\n\t\t\tthis.tree.focusFirst();\n\t\t}\n\t}\n\n\tpublic get hasRendered(): boolean {\n\t\treturn !!this.tree;\n\t}\n\n\tprotected layoutBodyContent(\n\t\theight: number = this.currentHeight,\n\t\twidth: number = this.currentWidth,\n\t): void {\n\t\tif (this.messageBoxContainer) {\n\t\t\tthis.messageBoxContainer.style.height = `${height}px`;\n\t\t}\n\t\tthis.tree?.layout(height, width);\n\t\tthis.currentHeight = height;\n\t\tthis.currentWidth = width;\n\t}\n\n\tprivate createMessageBox(parent: HTMLElement): void {\n\t\tthis.messageBoxContainer = dom.append(\n\t\t\tparent,\n\t\t\tdom.$(\".message-box-container\"),\n\t\t);\n\t\tthis.messageBoxContainer.setAttribute(\"tabIndex\", \"0\");\n\t}\n\n\tprivate renderMessage(): void {\n\t\tthis.messageBoxContainer.textContent =\n\t\t\tthis.commentService.commentsModel.getMessage();\n\t\tthis.messageBoxContainer.classList.toggle(\n\t\t\t\"hidden\",\n\t\t\tthis.commentService.commentsModel.hasCommentThreads(),\n\t\t);\n\t}\n\n\tprivate getScreenReaderInfoForNode(\n\t\telement: CommentNode,\n\t\tforAriaLabel?: boolean,\n\t): string {\n\t\tlet accessibleViewHint = \"\";\n\t\tif (\n\t\t\tforAriaLabel &&\n\t\t\tthis.configurationService.getValue(\n\t\t\t\tAccessibilityVerbositySettingId.Comments,\n\t\t\t)\n\t\t) {\n\t\t\tconst kbLabel = this.keybindingService\n\t\t\t\t.lookupKeybinding(AccessibleViewAction.id)\n\t\t\t\t?.getAriaLabel();\n\t\t\taccessibleViewHint = kbLabel\n\t\t\t\t? nls.localize(\n\t\t\t\t\t\t\"acessibleViewHint\",\n\t\t\t\t\t\t\"Inspect this in the accessible view ({0}).\\n\",\n\t\t\t\t\t\tkbLabel,\n\t\t\t\t\t)\n\t\t\t\t: nls.localize(\n\t\t\t\t\t\t\"acessibleViewHintNoKbOpen\",\n\t\t\t\t\t\t\"Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding.\\n\",\n\t\t\t\t\t);\n\t\t}\n\t\tconst replyCount = this.getReplyCountAsString(element, forAriaLabel);\n\t\tconst replies = this.getRepliesAsString(element, forAriaLabel);\n\t\tconst editor = this.editorService.findEditors(element.resource);\n\t\tconst codeEditor = this.editorService.activeEditorPane?.getControl();\n\t\tlet content;\n\t\tif (element.range && editor?.length && isCodeEditor(codeEditor)) {\n\t\t\tcontent = codeEditor.getModel()?.getValueInRange(element.range);\n\t\t\tif (content) {\n\t\t\t\tcontent = \"\\nCorresponding code: \\n\" + content;\n\t\t\t}\n\t\t}\n\t\tif (element.range) {\n\t\t\tif (\n\t\t\t\telement.threadRelevance === CommentThreadApplicability.Outdated\n\t\t\t) {\n\t\t\t\treturn (\n\t\t\t\t\taccessibleViewHint +\n\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\"resourceWithCommentLabelOutdated\",\n\t\t\t\t\t\t\"Outdated from {0} at line {1} column {2} in {3}{4}\\nComment: {5}{6}\",\n\t\t\t\t\t\telement.comment.userName,\n\t\t\t\t\t\telement.range.startLineNumber,\n\t\t\t\t\t\telement.range.startColumn,\n\t\t\t\t\t\tbasename(element.resource),\n\t\t\t\t\t\treplyCount,\n\t\t\t\t\t\ttypeof element.comment.body === \"string\"\n\t\t\t\t\t\t\t? element.comment.body\n\t\t\t\t\t\t\t: element.comment.body.value,\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t) +\n\t\t\t\t\treplies\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\taccessibleViewHint +\n\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\"resourceWithCommentLabel\",\n\t\t\t\t\t\t\"{0} at line {1} column {2} in {3} {4}\\nComment: {5}{6}\",\n\t\t\t\t\t\telement.comment.userName,\n\t\t\t\t\t\telement.range.startLineNumber,\n\t\t\t\t\t\telement.range.startColumn,\n\t\t\t\t\t\tbasename(element.resource),\n\t\t\t\t\t\treplyCount,\n\t\t\t\t\t\ttypeof element.comment.body === \"string\"\n\t\t\t\t\t\t\t? element.comment.body\n\t\t\t\t\t\t\t: element.comment.body.value,\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t) +\n\t\t\t\t\treplies\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (\n\t\t\telement.threadRelevance === CommentThreadApplicability.Outdated\n\t\t) {\n\t\t\treturn (\n\t\t\t\taccessibleViewHint +\n\t\t\t\tnls.localize(\n\t\t\t\t\t\"resourceWithCommentLabelFileOutdated\",\n\t\t\t\t\t\"Outdated from {0} in {1} {2}\\nComment: {3}{4}{5}\",\n\t\t\t\t\telement.comment.userName,\n\t\t\t\t\tbasename(element.resource),\n\t\t\t\t\treplyCount,\n\t\t\t\t\ttypeof element.comment.body === \"string\"\n\t\t\t\t\t\t? element.comment.body\n\t\t\t\t\t\t: element.comment.body.value,\n\t\t\t\t) +\n\t\t\t\treplies\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\taccessibleViewHint +\n\t\t\t\tnls.localize(\n\t\t\t\t\t\"resourceWithCommentLabelFile\",\n\t\t\t\t\t\"{0} in {1} {2}\\nComment: {3}{4}\",\n\t\t\t\t\telement.comment.userName,\n\t\t\t\t\tbasename(element.resource),\n\t\t\t\t\treplyCount,\n\t\t\t\t\ttypeof element.comment.body === \"string\"\n\t\t\t\t\t\t? element.comment.body\n\t\t\t\t\t\t: element.comment.body.value,\n\t\t\t\t\tcontent,\n\t\t\t\t) +\n\t\t\t\treplies\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate getRepliesAsString(\n\t\tnode: CommentNode,\n\t\tforAriaLabel?: boolean,\n\t): string {\n\t\tif (!node.replies.length || forAriaLabel) {\n\t\t\treturn \"\";\n\t\t}\n\t\treturn (\n\t\t\t\"\\n\" +\n\t\t\tnode.replies\n\t\t\t\t.map((reply) =>\n\t\t\t\t\tnls.localize(\n\t\t\t\t\t\t\"resourceWithRepliesLabel\",\n\t\t\t\t\t\t\"{0} {1}\",\n\t\t\t\t\t\treply.comment.userName,\n\t\t\t\t\t\ttypeof reply.comment.body === \"string\"\n\t\t\t\t\t\t\t? reply.comment.body\n\t\t\t\t\t\t\t: reply.comment.body.value,\n\t\t\t\t\t),\n\t\t\t\t)\n\t\t\t\t.join(\"\\n\")\n\t\t);\n\t}\n\n\tprivate getReplyCountAsString(\n\t\tnode: CommentNode,\n\t\tforAriaLabel?: boolean,\n\t): string {\n\t\treturn node.replies.length && !forAriaLabel\n\t\t\t? nls.localize(\"replyCount\", \" {0} replies,\", node.replies.length)\n\t\t\t: \"\";\n\t}\n\n\tprivate createTree(): void {\n\t\tthis.treeLabels = this._register(\n\t\t\tthis.instantiationService.createInstance(ResourceLabels, this),\n\t\t);\n\t\tthis.tree = this._register(\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tCommentsList,\n\t\t\t\tthis.treeLabels,\n\t\t\t\tthis.treeContainer,\n\t\t\t\t{\n\t\t\t\t\toverrideStyles:\n\t\t\t\t\t\tthis.getLocationBasedColors().listOverrideStyles,\n\t\t\t\t\tselectionNavigation: true,\n\t\t\t\t\tfilter: this.filter,\n\t\t\t\t\tsorter: {\n\t\t\t\t\t\tcompare: (a: CommentsTreeNode, b: CommentsTreeNode) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\ta instanceof CommentsModel ||\n\t\t\t\t\t\t\t\tb instanceof CommentsModel\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.filters.sortBy ===\n\t\t\t\t\t\t\t\tCommentsSortOrder.UpdatedAtDescending\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn a.lastUpdatedAt > b.lastUpdatedAt\n\t\t\t\t\t\t\t\t\t? -1\n\t\t\t\t\t\t\t\t\t: 1;\n\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\tthis.filters.sortBy ===\n\t\t\t\t\t\t\t\tCommentsSortOrder.ResourceAscending\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\ta instanceof ResourceWithCommentThreads &&\n\t\t\t\t\t\t\t\t\tb instanceof ResourceWithCommentThreads\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tconst workspaceScheme =\n\t\t\t\t\t\t\t\t\t\tthis.pathService.defaultUriScheme;\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\ta.resource.scheme !==\n\t\t\t\t\t\t\t\t\t\t\tb.resource.scheme &&\n\t\t\t\t\t\t\t\t\t\t(a.resource.scheme ===\n\t\t\t\t\t\t\t\t\t\t\tworkspaceScheme ||\n\t\t\t\t\t\t\t\t\t\t\tb.resource.scheme ===\n\t\t\t\t\t\t\t\t\t\t\t\tworkspaceScheme)\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t// Workspace scheme should always come first\n\t\t\t\t\t\t\t\t\t\treturn b.resource.scheme ===\n\t\t\t\t\t\t\t\t\t\t\tworkspaceScheme\n\t\t\t\t\t\t\t\t\t\t\t? 1\n\t\t\t\t\t\t\t\t\t\t\t: -1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn a.resource.toString() >\n\t\t\t\t\t\t\t\t\t\tb.resource.toString()\n\t\t\t\t\t\t\t\t\t\t? 1\n\t\t\t\t\t\t\t\t\t\t: -1;\n\t\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\t\ta instanceof CommentNode &&\n\t\t\t\t\t\t\t\t\tb instanceof CommentNode &&\n\t\t\t\t\t\t\t\t\ta.thread.range &&\n\t\t\t\t\t\t\t\t\tb.thread.range\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\treturn a.thread.range?.startLineNumber >\n\t\t\t\t\t\t\t\t\t\tb.thread.range?.startLineNumber\n\t\t\t\t\t\t\t\t\t\t? 1\n\t\t\t\t\t\t\t\t\t\t: -1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tkeyboardNavigationLabelProvider: {\n\t\t\t\t\t\tgetKeyboardNavigationLabel: (\n\t\t\t\t\t\t\titem: CommentsTreeNode,\n\t\t\t\t\t\t) => {\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\taccessibilityProvider: {\n\t\t\t\t\t\tgetAriaLabel: (element: any): string => {\n\t\t\t\t\t\t\tif (element instanceof CommentsModel) {\n\t\t\t\t\t\t\t\treturn nls.localize(\n\t\t\t\t\t\t\t\t\t\"rootCommentsLabel\",\n\t\t\t\t\t\t\t\t\t\"Comments for current workspace\",\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (element instanceof ResourceWithCommentThreads) {\n\t\t\t\t\t\t\t\treturn nls.localize(\n\t\t\t\t\t\t\t\t\t\"resourceWithCommentThreadsLabel\",\n\t\t\t\t\t\t\t\t\t\"Comments in {0}, full path {1}\",\n\t\t\t\t\t\t\t\t\tbasename(element.resource),\n\t\t\t\t\t\t\t\t\telement.resource.fsPath,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (element instanceof CommentNode) {\n\t\t\t\t\t\t\t\treturn this.getScreenReaderInfoForNode(\n\t\t\t\t\t\t\t\t\telement,\n\t\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetWidgetAriaLabel(): string {\n\t\t\t\t\t\t\treturn COMMENTS_VIEW_TITLE.value;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.tree.onDidOpen((e) => {\n\t\t\t\tthis.openFile(\n\t\t\t\t\te.element,\n\t\t\t\t\te.editorOptions.pinned,\n\t\t\t\t\te.editorOptions.preserveFocus,\n\t\t\t\t\te.sideBySide,\n\t\t\t\t);\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.tree.onDidChangeModel(() => {\n\t\t\t\tthis.updateSomeCommentsExpanded();\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.tree.onDidChangeCollapseState(() => {\n\t\t\t\tthis.updateSomeCommentsExpanded();\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.tree.onDidFocus(() =>\n\t\t\t\tthis.commentsFocusedContextKey.set(true),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.tree.onDidBlur(() =>\n\t\t\t\tthis.commentsFocusedContextKey.set(false),\n\t\t\t),\n\t\t);\n\t}\n\n\tprivate openFile(\n\t\telement: any,\n\t\tpinned?: boolean,\n\t\tpreserveFocus?: boolean,\n\t\tsideBySide?: boolean,\n\t): void {\n\t\tif (!element) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!(\n\t\t\t\telement instanceof ResourceWithCommentThreads ||\n\t\t\t\telement instanceof CommentNode\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\tconst threadToReveal =\n\t\t\telement instanceof ResourceWithCommentThreads\n\t\t\t\t? element.commentThreads[0].thread\n\t\t\t\t: element.thread;\n\t\tconst commentToReveal =\n\t\t\telement instanceof ResourceWithCommentThreads\n\t\t\t\t? element.commentThreads[0].comment\n\t\t\t\t: undefined;\n\t\treturn revealCommentThread(\n\t\t\tthis.commentService,\n\t\t\tthis.editorService,\n\t\t\tthis.uriIdentityService,\n\t\t\tthreadToReveal,\n\t\t\tcommentToReveal,\n\t\t\tfalse,\n\t\t\tpinned,\n\t\t\tpreserveFocus,\n\t\t\tsideBySide,\n\t\t);\n\t}\n\n\tprivate async refresh(): Promise<void> {\n\t\tif (!this.tree) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.isVisible()) {\n\t\t\tthis.hasCommentsContextKey.set(\n\t\t\t\tthis.commentService.commentsModel.hasCommentThreads(),\n\t\t\t);\n\t\t\tthis.cachedFilterStats = undefined;\n\t\t\tthis.renderComments();\n\n\t\t\tif (\n\t\t\t\tthis.tree.getSelection().length === 0 &&\n\t\t\t\tthis.commentService.commentsModel.hasCommentThreads()\n\t\t\t) {\n\t\t\t\tconst firstComment =\n\t\t\t\t\tthis.commentService.commentsModel.resourceCommentThreads[0]\n\t\t\t\t\t\t.commentThreads[0];\n\t\t\t\tif (firstComment) {\n\t\t\t\t\tthis.tree.setFocus([firstComment]);\n\t\t\t\t\tthis.tree.setSelection([firstComment]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onAllCommentsChanged(e: IWorkspaceCommentThreadsEvent): void {\n\t\tthis.cachedFilterStats = undefined;\n\t\tthis.totalComments += e.commentThreads.length;\n\n\t\tlet unresolved = 0;\n\t\tfor (const thread of e.commentThreads) {\n\t\t\tif (thread.state === CommentThreadState.Unresolved) {\n\t\t\t\tunresolved++;\n\t\t\t}\n\t\t}\n\t\tthis.refresh();\n\t}\n\n\tprivate onCommentsUpdated(e: ICommentThreadChangedEvent): void {\n\t\tthis.cachedFilterStats = undefined;\n\n\t\tthis.totalComments += e.added.length;\n\t\tthis.totalComments -= e.removed.length;\n\n\t\tlet unresolved = 0;\n\t\tfor (const resource of this.commentService.commentsModel\n\t\t\t.resourceCommentThreads) {\n\t\t\tfor (const thread of resource.commentThreads) {\n\t\t\t\tif (thread.threadState === CommentThreadState.Unresolved) {\n\t\t\t\t\tunresolved++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.refresh();\n\t}\n\n\tprivate onDataProviderDeleted(owner: string | undefined): void {\n\t\tthis.cachedFilterStats = undefined;\n\t\tthis.totalComments = 0;\n\t\tthis.refresh();\n\t}\n\n\tprivate updateSomeCommentsExpanded() {\n\t\tthis.someCommentsExpandedContextKey.set(this.isSomeCommentsExpanded());\n\t}\n\n\tpublic areAllCommentsExpanded(): boolean {\n\t\tif (!this.tree) {\n\t\t\treturn false;\n\t\t}\n\t\tconst navigator = this.tree.navigate();\n\t\twhile (navigator.next()) {\n\t\t\tif (this.tree.isCollapsed(navigator.current())) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic isSomeCommentsExpanded(): boolean {\n\t\tif (!this.tree) {\n\t\t\treturn false;\n\t\t}\n\t\tconst navigator = this.tree.navigate();\n\t\twhile (navigator.next()) {\n\t\t\tif (!this.tree.isCollapsed(navigator.current())) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
