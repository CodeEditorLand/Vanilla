{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/issue/browser/issueReporterModel.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { mainWindow } from \"../../../../base/browser/window.js\";\nimport {\n\ttype SystemInfo,\n\tisRemoteDiagnosticError,\n} from \"../../../../platform/diagnostics/common/diagnostics.js\";\nimport type { OldIssueType } from \"../../../../platform/issue/common/issue.js\";\nimport {\n\ttype ISettingSearchResult,\n\ttype IssueReporterExtensionData,\n\tIssueType,\n} from \"../common/issue.js\";\n\nexport interface IssueReporterData {\n\tissueType: IssueType | OldIssueType;\n\tissueDescription?: string;\n\tissueTitle?: string;\n\textensionData?: string;\n\n\tversionInfo?: any;\n\tsystemInfo?: SystemInfo;\n\tsystemInfoWeb?: string;\n\tprocessInfo?: string;\n\tworkspaceInfo?: string;\n\n\tincludeSystemInfo: boolean;\n\tincludeWorkspaceInfo: boolean;\n\tincludeProcessInfo: boolean;\n\tincludeExtensions: boolean;\n\tincludeExperiments: boolean;\n\tincludeExtensionData: boolean;\n\n\tnumberOfThemeExtesions?: number;\n\tallExtensions: IssueReporterExtensionData[];\n\tenabledNonThemeExtesions?: IssueReporterExtensionData[];\n\textensionsDisabled?: boolean;\n\tfileOnExtension?: boolean;\n\tfileOnMarketplace?: boolean;\n\tfileOnProduct?: boolean;\n\tselectedExtension?: IssueReporterExtensionData;\n\tactualSearchResults?: ISettingSearchResult[];\n\tquery?: string;\n\tfilterResultCount?: number;\n\texperimentInfo?: string;\n\trestrictedMode?: boolean;\n\tisUnsupported?: boolean;\n}\n\nexport class IssueReporterModel {\n\tprivate readonly _data: IssueReporterData;\n\n\tconstructor(initialData?: Partial<IssueReporterData>) {\n\t\tconst defaultData = {\n\t\t\tissueType: IssueType.Bug,\n\t\t\tincludeSystemInfo: true,\n\t\t\tincludeWorkspaceInfo: true,\n\t\t\tincludeProcessInfo: true,\n\t\t\tincludeExtensions: true,\n\t\t\tincludeExperiments: true,\n\t\t\tincludeExtensionData: true,\n\t\t\tallExtensions: [],\n\t\t};\n\n\t\tthis._data = initialData\n\t\t\t? Object.assign(defaultData, initialData)\n\t\t\t: defaultData;\n\n\t\tmainWindow.addEventListener(\"message\", async (event) => {\n\t\t\tif (\n\t\t\t\tevent.data &&\n\t\t\t\tevent.data.sendChannel === \"vscode:triggerIssueData\"\n\t\t\t) {\n\t\t\t\tmainWindow.postMessage(\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tissueBody: this._data.issueDescription,\n\t\t\t\t\t\t\tissueTitle: this._data.issueTitle,\n\t\t\t\t\t\t},\n\t\t\t\t\t\treplyChannel: \"vscode:triggerIssueDataResponse\",\n\t\t\t\t\t},\n\t\t\t\t\t\"*\",\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetData(): IssueReporterData {\n\t\treturn this._data;\n\t}\n\n\tupdate(newData: Partial<IssueReporterData>): void {\n\t\tObject.assign(this._data, newData);\n\t}\n\n\tserialize(): string {\n\t\tconst modes = [];\n\t\tif (this._data.restrictedMode) {\n\t\t\tmodes.push(\"Restricted\");\n\t\t}\n\t\tif (this._data.isUnsupported) {\n\t\t\tmodes.push(\"Unsupported\");\n\t\t}\n\t\treturn `\nType: <b>${this.getIssueTypeTitle()}</b>\n\n${this._data.issueDescription}\n${this.getExtensionVersion()}\nVS Code version: ${this._data.versionInfo && this._data.versionInfo.vscodeVersion}\nOS version: ${this._data.versionInfo && this._data.versionInfo.os}\nModes:${modes.length ? \" \" + modes.join(\", \") : \"\"}\n${this.getRemoteOSes()}\n${this.getInfos()}\n<!-- generated by issue reporter -->`;\n\t}\n\n\tprivate getRemoteOSes(): string {\n\t\tif (this._data.systemInfo && this._data.systemInfo.remoteData.length) {\n\t\t\treturn (\n\t\t\t\tthis._data.systemInfo.remoteData\n\t\t\t\t\t.map((remote) =>\n\t\t\t\t\t\tisRemoteDiagnosticError(remote)\n\t\t\t\t\t\t\t? remote.errorMessage\n\t\t\t\t\t\t\t: `Remote OS version: ${remote.machineInfo.os}`,\n\t\t\t\t\t)\n\t\t\t\t\t.join(\"\\n\") + \"\\n\"\n\t\t\t);\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tfileOnExtension(): boolean | undefined {\n\t\tconst fileOnExtensionSupported =\n\t\t\tthis._data.issueType === IssueType.Bug ||\n\t\t\tthis._data.issueType === IssueType.PerformanceIssue ||\n\t\t\tthis._data.issueType === IssueType.FeatureRequest;\n\n\t\treturn fileOnExtensionSupported && this._data.fileOnExtension;\n\t}\n\n\tprivate getExtensionVersion(): string {\n\t\tif (this.fileOnExtension() && this._data.selectedExtension) {\n\t\t\treturn `\\nExtension version: ${this._data.selectedExtension.version}`;\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t}\n\n\tprivate getIssueTypeTitle(): string {\n\t\tif (this._data.issueType === IssueType.Bug) {\n\t\t\treturn \"Bug\";\n\t\t} else if (this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\treturn \"Performance Issue\";\n\t\t} else {\n\t\t\treturn \"Feature Request\";\n\t\t}\n\t}\n\n\tprivate getInfos(): string {\n\t\tlet info = \"\";\n\n\t\tif (this._data.fileOnMarketplace) {\n\t\t\treturn info;\n\t\t}\n\n\t\tconst isBugOrPerformanceIssue =\n\t\t\tthis._data.issueType === IssueType.Bug ||\n\t\t\tthis._data.issueType === IssueType.PerformanceIssue;\n\n\t\tif (isBugOrPerformanceIssue) {\n\t\t\tif (this._data.includeExtensionData && this._data.extensionData) {\n\t\t\t\tinfo += this.getExtensionData();\n\t\t\t}\n\n\t\t\tif (this._data.includeSystemInfo && this._data.systemInfo) {\n\t\t\t\tinfo += this.generateSystemInfoMd();\n\t\t\t}\n\n\t\t\tif (this._data.includeSystemInfo && this._data.systemInfoWeb) {\n\t\t\t\tinfo += \"System Info: \" + this._data.systemInfoWeb;\n\t\t\t}\n\t\t}\n\n\t\tif (this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\tif (this._data.includeProcessInfo) {\n\t\t\t\tinfo += this.generateProcessInfoMd();\n\t\t\t}\n\n\t\t\tif (this._data.includeWorkspaceInfo) {\n\t\t\t\tinfo += this.generateWorkspaceInfoMd();\n\t\t\t}\n\t\t}\n\n\t\tif (isBugOrPerformanceIssue) {\n\t\t\tif (!this._data.fileOnExtension && this._data.includeExtensions) {\n\t\t\t\tinfo += this.generateExtensionsMd();\n\t\t\t}\n\n\t\t\tif (this._data.includeExperiments && this._data.experimentInfo) {\n\t\t\t\tinfo += this.generateExperimentsInfoMd();\n\t\t\t}\n\t\t}\n\n\t\treturn info;\n\t}\n\n\tprivate getExtensionData(): string {\n\t\treturn this._data.extensionData ?? \"\";\n\t}\n\n\tprivate generateSystemInfoMd(): string {\n\t\tlet md = `<details>\n<summary>System Info</summary>\n\n|Item|Value|\n|---|---|\n`;\n\n\t\tif (this._data.systemInfo) {\n\t\t\tmd += `|CPUs|${this._data.systemInfo.cpus}|\n|GPU Status|${Object.keys(this._data.systemInfo.gpuStatus)\n\t\t\t\t.map(\n\t\t\t\t\t(key) => `${key}: ${this._data.systemInfo!.gpuStatus[key]}`,\n\t\t\t\t)\n\t\t\t\t.join(\"<br>\")}|\n|Load (avg)|${this._data.systemInfo.load}|\n|Memory (System)|${this._data.systemInfo.memory}|\n|Process Argv|${this._data.systemInfo.processArgs.replace(/\\\\/g, \"\\\\\\\\\")}|\n|Screen Reader|${this._data.systemInfo.screenReader}|\n|VM|${this._data.systemInfo.vmHint}|`;\n\n\t\t\tif (this._data.systemInfo.linuxEnv) {\n\t\t\t\tmd += `\\n|DESKTOP_SESSION|${this._data.systemInfo.linuxEnv.desktopSession}|\n|XDG_CURRENT_DESKTOP|${this._data.systemInfo.linuxEnv.xdgCurrentDesktop}|\n|XDG_SESSION_DESKTOP|${this._data.systemInfo.linuxEnv.xdgSessionDesktop}|\n|XDG_SESSION_TYPE|${this._data.systemInfo.linuxEnv.xdgSessionType}|`;\n\t\t\t}\n\n\t\t\tthis._data.systemInfo.remoteData.forEach((remote) => {\n\t\t\t\tif (isRemoteDiagnosticError(remote)) {\n\t\t\t\t\tmd += `\\n\\n${remote.errorMessage}`;\n\t\t\t\t} else {\n\t\t\t\t\tmd += `\n\n|Item|Value|\n|---|---|\n|Remote|${remote.latency ? `${remote.hostName} (latency: ${remote.latency.current.toFixed(2)}ms last, ${remote.latency.average.toFixed(2)}ms average)` : remote.hostName}|\n|OS|${remote.machineInfo.os}|\n|CPUs|${remote.machineInfo.cpus}|\n|Memory (System)|${remote.machineInfo.memory}|\n|VM|${remote.machineInfo.vmHint}|`;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tmd += \"\\n</details>\";\n\n\t\treturn md;\n\t}\n\n\tprivate generateProcessInfoMd(): string {\n\t\treturn `<details>\n<summary>Process Info</summary>\n\n\\`\\`\\`\n${this._data.processInfo}\n\\`\\`\\`\n\n</details>\n`;\n\t}\n\n\tprivate generateWorkspaceInfoMd(): string {\n\t\treturn `<details>\n<summary>Workspace Info</summary>\n\n\\`\\`\\`\n${this._data.workspaceInfo};\n\\`\\`\\`\n\n</details>\n`;\n\t}\n\n\tprivate generateExperimentsInfoMd(): string {\n\t\treturn `<details>\n<summary>A/B Experiments</summary>\n\n\\`\\`\\`\n${this._data.experimentInfo}\n\\`\\`\\`\n\n</details>\n`;\n\t}\n\n\tprivate generateExtensionsMd(): string {\n\t\tif (this._data.extensionsDisabled) {\n\t\t\treturn \"Extensions disabled\";\n\t\t}\n\n\t\tconst themeExclusionStr = this._data.numberOfThemeExtesions\n\t\t\t? `\\n(${this._data.numberOfThemeExtesions} theme extensions excluded)`\n\t\t\t: \"\";\n\n\t\tif (!this._data.enabledNonThemeExtesions) {\n\t\t\treturn \"Extensions: none\" + themeExclusionStr;\n\t\t}\n\n\t\tconst tableHeader = `Extension|Author (truncated)|Version\n---|---|---`;\n\t\tconst table = this._data.enabledNonThemeExtesions\n\t\t\t.map((e) => {\n\t\t\t\treturn `${e.name}|${e.publisher?.substr(0, 3) ?? \"N/A\"}|${e.version}`;\n\t\t\t})\n\t\t\t.join(\"\\n\");\n\n\t\treturn `<details><summary>Extensions (${this._data.enabledNonThemeExtesions.length})</summary>\n\n${tableHeader}\n${table}\n${themeExclusionStr}\n\n</details>`;\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
