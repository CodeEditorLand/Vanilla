{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/snippets/browser/snippetCodeActionProvider.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableStore } from \"../../../../base/common/lifecycle.js\";\nimport type { IRange, Range } from \"../../../../editor/common/core/range.js\";\nimport { Selection } from \"../../../../editor/common/core/selection.js\";\nimport type {\n\tCodeAction,\n\tCodeActionList,\n\tCodeActionProvider,\n\tWorkspaceEdit,\n} from \"../../../../editor/common/languages.js\";\nimport type { ITextModel } from \"../../../../editor/common/model.js\";\nimport { ILanguageFeaturesService } from \"../../../../editor/common/services/languageFeatures.js\";\nimport { CodeActionKind } from \"../../../../editor/contrib/codeAction/common/types.js\";\nimport { localize } from \"../../../../nls.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport type { IWorkbenchContribution } from \"../../../common/contributions.js\";\nimport { ApplyFileSnippetAction } from \"./commands/fileTemplateSnippets.js\";\nimport {\n\tSurroundWithSnippetEditorAction,\n\tgetSurroundableSnippets,\n} from \"./commands/surroundWithSnippet.js\";\nimport { ISnippetsService } from \"./snippets.js\";\nimport type { Snippet } from \"./snippetsFile.js\";\n\nclass SurroundWithSnippetCodeActionProvider implements CodeActionProvider {\n\tprivate static readonly _MAX_CODE_ACTIONS = 4;\n\n\tprivate static readonly _overflowCommandCodeAction: CodeAction = {\n\t\tkind: CodeActionKind.SurroundWith.value,\n\t\ttitle: localize(\"more\", \"More...\"),\n\t\tcommand: {\n\t\t\tid: SurroundWithSnippetEditorAction.options.id,\n\t\t\ttitle: SurroundWithSnippetEditorAction.options.title.value,\n\t\t},\n\t};\n\n\tconstructor(\n\t\t@ISnippetsService private readonly _snippetService: ISnippetsService,\n\t) {}\n\n\tasync provideCodeActions(\n\t\tmodel: ITextModel,\n\t\trange: Range | Selection,\n\t): Promise<CodeActionList | undefined> {\n\t\tif (range.isEmpty()) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst position = Selection.isISelection(range)\n\t\t\t? range.getPosition()\n\t\t\t: range.getStartPosition();\n\t\tconst snippets = await getSurroundableSnippets(\n\t\t\tthis._snippetService,\n\t\t\tmodel,\n\t\t\tposition,\n\t\t\tfalse,\n\t\t);\n\t\tif (!snippets.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst actions: CodeAction[] = [];\n\t\tfor (const snippet of snippets) {\n\t\t\tif (\n\t\t\t\tactions.length >=\n\t\t\t\tSurroundWithSnippetCodeActionProvider._MAX_CODE_ACTIONS\n\t\t\t) {\n\t\t\t\tactions.push(\n\t\t\t\t\tSurroundWithSnippetCodeActionProvider._overflowCommandCodeAction,\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tactions.push({\n\t\t\t\ttitle: localize(\"codeAction\", \"{0}\", snippet.name),\n\t\t\t\tkind: CodeActionKind.SurroundWith.value,\n\t\t\t\tedit: asWorkspaceEdit(model, range, snippet),\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tactions,\n\t\t\tdispose() {},\n\t\t};\n\t}\n}\n\nclass FileTemplateCodeActionProvider implements CodeActionProvider {\n\tprivate static readonly _MAX_CODE_ACTIONS = 4;\n\n\tprivate static readonly _overflowCommandCodeAction: CodeAction = {\n\t\ttitle: localize(\"overflow.start.title\", \"Start with Snippet\"),\n\t\tkind: CodeActionKind.SurroundWith.value,\n\t\tcommand: {\n\t\t\tid: ApplyFileSnippetAction.Id,\n\t\t\ttitle: \"\",\n\t\t},\n\t};\n\n\treadonly providedCodeActionKinds?: readonly string[] = [\n\t\tCodeActionKind.SurroundWith.value,\n\t];\n\n\tconstructor(\n\t\t@ISnippetsService private readonly _snippetService: ISnippetsService,\n\t) {}\n\n\tasync provideCodeActions(model: ITextModel) {\n\t\tif (model.getValueLength() !== 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst snippets = await this._snippetService.getSnippets(\n\t\t\tmodel.getLanguageId(),\n\t\t\t{ fileTemplateSnippets: true, includeNoPrefixSnippets: true },\n\t\t);\n\t\tconst actions: CodeAction[] = [];\n\t\tfor (const snippet of snippets) {\n\t\t\tif (\n\t\t\t\tactions.length >=\n\t\t\t\tFileTemplateCodeActionProvider._MAX_CODE_ACTIONS\n\t\t\t) {\n\t\t\t\tactions.push(\n\t\t\t\t\tFileTemplateCodeActionProvider._overflowCommandCodeAction,\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tactions.push({\n\t\t\t\ttitle: localize(\"title\", \"Start with: {0}\", snippet.name),\n\t\t\t\tkind: CodeActionKind.SurroundWith.value,\n\t\t\t\tedit: asWorkspaceEdit(\n\t\t\t\t\tmodel,\n\t\t\t\t\tmodel.getFullModelRange(),\n\t\t\t\t\tsnippet,\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tactions,\n\t\t\tdispose() {},\n\t\t};\n\t}\n}\n\nfunction asWorkspaceEdit(\n\tmodel: ITextModel,\n\trange: IRange,\n\tsnippet: Snippet,\n): WorkspaceEdit {\n\treturn {\n\t\tedits: [\n\t\t\t{\n\t\t\t\tversionId: model.getVersionId(),\n\t\t\t\tresource: model.uri,\n\t\t\t\ttextEdit: {\n\t\t\t\t\trange,\n\t\t\t\t\ttext: snippet.body,\n\t\t\t\t\tinsertAsSnippet: true,\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t};\n}\n\nexport class SnippetCodeActions implements IWorkbenchContribution {\n\tprivate readonly _store = new DisposableStore();\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageFeaturesService\n\t\tlanguageFeaturesService: ILanguageFeaturesService,\n\t\t@IConfigurationService configService: IConfigurationService,\n\t) {\n\t\tconst setting = \"editor.snippets.codeActions.enabled\";\n\t\tconst sessionStore = new DisposableStore();\n\t\tconst update = () => {\n\t\t\tsessionStore.clear();\n\t\t\tif (configService.getValue(setting)) {\n\t\t\t\tsessionStore.add(\n\t\t\t\t\tlanguageFeaturesService.codeActionProvider.register(\n\t\t\t\t\t\t\"*\",\n\t\t\t\t\t\tinstantiationService.createInstance(\n\t\t\t\t\t\t\tSurroundWithSnippetCodeActionProvider,\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tsessionStore.add(\n\t\t\t\t\tlanguageFeaturesService.codeActionProvider.register(\n\t\t\t\t\t\t\"*\",\n\t\t\t\t\t\tinstantiationService.createInstance(\n\t\t\t\t\t\t\tFileTemplateCodeActionProvider,\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\n\t\tupdate();\n\t\tthis._store.add(\n\t\t\tconfigService.onDidChangeConfiguration(\n\t\t\t\t(e) => e.affectsConfiguration(setting) && update(),\n\t\t\t),\n\t\t);\n\t\tthis._store.add(sessionStore);\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
