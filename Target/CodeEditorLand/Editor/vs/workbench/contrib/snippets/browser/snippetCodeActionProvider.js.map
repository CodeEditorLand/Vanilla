{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/snippets/browser/snippetCodeActionProvider.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { IRange, Range } from '../../../../editor/common/core/range.js';\nimport { Selection } from '../../../../editor/common/core/selection.js';\nimport { CodeAction, CodeActionList, CodeActionProvider, WorkspaceEdit } from '../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../editor/common/model.js';\nimport { ILanguageFeaturesService } from '../../../../editor/common/services/languageFeatures.js';\nimport { CodeActionKind } from '../../../../editor/contrib/codeAction/common/types.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { ApplyFileSnippetAction } from './commands/fileTemplateSnippets.js';\nimport { getSurroundableSnippets, SurroundWithSnippetEditorAction } from './commands/surroundWithSnippet.js';\nimport { Snippet } from './snippetsFile.js';\nimport { ISnippetsService } from './snippets.js';\n\nclass SurroundWithSnippetCodeActionProvider implements CodeActionProvider {\n\n\tprivate static readonly _MAX_CODE_ACTIONS = 4;\n\n\tprivate static readonly _overflowCommandCodeAction: CodeAction = {\n\t\tkind: CodeActionKind.SurroundWith.value,\n\t\ttitle: localize('more', \"More...\"),\n\t\tcommand: {\n\t\t\tid: SurroundWithSnippetEditorAction.options.id,\n\t\t\ttitle: SurroundWithSnippetEditorAction.options.title.value,\n\t\t},\n\t};\n\n\tconstructor(@ISnippetsService private readonly _snippetService: ISnippetsService) { }\n\n\tasync provideCodeActions(model: ITextModel, range: Range | Selection): Promise<CodeActionList | undefined> {\n\n\t\tif (range.isEmpty()) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst position = Selection.isISelection(range) ? range.getPosition() : range.getStartPosition();\n\t\tconst snippets = await getSurroundableSnippets(this._snippetService, model, position, false);\n\t\tif (!snippets.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst actions: CodeAction[] = [];\n\t\tfor (const snippet of snippets) {\n\t\t\tif (actions.length >= SurroundWithSnippetCodeActionProvider._MAX_CODE_ACTIONS) {\n\t\t\t\tactions.push(SurroundWithSnippetCodeActionProvider._overflowCommandCodeAction);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tactions.push({\n\t\t\t\ttitle: localize('codeAction', \"{0}\", snippet.name),\n\t\t\t\tkind: CodeActionKind.SurroundWith.value,\n\t\t\t\tedit: asWorkspaceEdit(model, range, snippet)\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tactions,\n\t\t\tdispose() { }\n\t\t};\n\t}\n}\n\nclass FileTemplateCodeActionProvider implements CodeActionProvider {\n\n\tprivate static readonly _MAX_CODE_ACTIONS = 4;\n\n\tprivate static readonly _overflowCommandCodeAction: CodeAction = {\n\t\ttitle: localize('overflow.start.title', 'Start with Snippet'),\n\t\tkind: CodeActionKind.SurroundWith.value,\n\t\tcommand: {\n\t\t\tid: ApplyFileSnippetAction.Id,\n\t\t\ttitle: ''\n\t\t}\n\t};\n\n\treadonly providedCodeActionKinds?: readonly string[] = [CodeActionKind.SurroundWith.value];\n\n\tconstructor(@ISnippetsService private readonly _snippetService: ISnippetsService) { }\n\n\tasync provideCodeActions(model: ITextModel) {\n\t\tif (model.getValueLength() !== 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst snippets = await this._snippetService.getSnippets(model.getLanguageId(), { fileTemplateSnippets: true, includeNoPrefixSnippets: true });\n\t\tconst actions: CodeAction[] = [];\n\t\tfor (const snippet of snippets) {\n\t\t\tif (actions.length >= FileTemplateCodeActionProvider._MAX_CODE_ACTIONS) {\n\t\t\t\tactions.push(FileTemplateCodeActionProvider._overflowCommandCodeAction);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tactions.push({\n\t\t\t\ttitle: localize('title', 'Start with: {0}', snippet.name),\n\t\t\t\tkind: CodeActionKind.SurroundWith.value,\n\t\t\t\tedit: asWorkspaceEdit(model, model.getFullModelRange(), snippet)\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tactions,\n\t\t\tdispose() { }\n\t\t};\n\t}\n}\n\nfunction asWorkspaceEdit(model: ITextModel, range: IRange, snippet: Snippet): WorkspaceEdit {\n\treturn {\n\t\tedits: [{\n\t\t\tversionId: model.getVersionId(),\n\t\t\tresource: model.uri,\n\t\t\ttextEdit: {\n\t\t\t\trange,\n\t\t\t\ttext: snippet.body,\n\t\t\t\tinsertAsSnippet: true,\n\t\t\t}\n\t\t}]\n\t};\n}\n\nexport class SnippetCodeActions implements IWorkbenchContribution {\n\n\tprivate readonly _store = new DisposableStore();\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService,\n\t\t@IConfigurationService configService: IConfigurationService,\n\t) {\n\n\t\tconst setting = 'editor.snippets.codeActions.enabled';\n\t\tconst sessionStore = new DisposableStore();\n\t\tconst update = () => {\n\t\t\tsessionStore.clear();\n\t\t\tif (configService.getValue(setting)) {\n\t\t\t\tsessionStore.add(languageFeaturesService.codeActionProvider.register('*', instantiationService.createInstance(SurroundWithSnippetCodeActionProvider)));\n\t\t\t\tsessionStore.add(languageFeaturesService.codeActionProvider.register('*', instantiationService.createInstance(FileTemplateCodeActionProvider)));\n\t\t\t}\n\t\t};\n\n\t\tupdate();\n\t\tthis._store.add(configService.onDidChangeConfiguration(e => e.affectsConfiguration(setting) && update()));\n\t\tthis._store.add(sessionStore);\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
