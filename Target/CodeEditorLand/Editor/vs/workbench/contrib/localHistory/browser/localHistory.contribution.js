var V5=Object.defineProperty;var H5=Object.getOwnPropertyDescriptor;var P=(o,e,t,n)=>{for(var i=n>1?void 0:n?H5(e,t):e,r=o.length-1,s;r>=0;r--)(s=o[r])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&V5(e,t,i),i},_=(o,e)=>(t,n)=>e(t,n,o);function E_(){return globalThis._VSCODE_NLS_MESSAGES}function Sg(){return globalThis._VSCODE_NLS_LANGUAGE}var U5=Sg()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Gv(o,e){let t;return e.length===0?t=o:t=o.replace(/\{(\d+)\}/g,(n,i)=>{let r=i[0],s=e[r],a=n;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),U5&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function m(o,e,...t){return Gv(typeof o=="number"?SN(o,e):e,t)}function SN(o,e){let t=E_()?.[o];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${o} !!!`)}return t}function kn(o,e,...t){let n;typeof o=="number"?n=SN(o,e):n=e;let i=Gv(n,t);return{value:i,original:e===n?i:Gv(e,t)}}var gp="en",wg=!1,xg=!1,Tg=!1,z5=!1,xN=!1,w_=!1,K5=!1,x_=!1,G5=!1,_N=!1,Eg,jv=gp,EN=gp,j5,rl,sl=globalThis,Sr;typeof sl.vscode<"u"&&typeof sl.vscode.process<"u"?Sr=sl.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Sr=process);var LN=typeof Sr?.versions?.electron=="string",q5=LN&&Sr?.type==="renderer";if(typeof Sr=="object"){wg=Sr.platform==="win32",xg=Sr.platform==="darwin",Tg=Sr.platform==="linux",z5=Tg&&!!Sr.env.SNAP&&!!Sr.env.SNAP_REVISION,K5=LN,G5=!!Sr.env.CI||!!Sr.env.BUILD_ARTIFACTSTAGINGDIRECTORY,Eg=gp,jv=gp;let o=Sr.env.VSCODE_NLS_CONFIG;if(o)try{let e=JSON.parse(o);Eg=e.userLocale,EN=e.osLocale,jv=e.resolvedLanguage||gp,j5=e.languagePack?.translationsConfigFile}catch{}xN=!0}else typeof navigator=="object"&&!q5?(rl=navigator.userAgent,wg=rl.indexOf("Windows")>=0,xg=rl.indexOf("Macintosh")>=0,x_=(rl.indexOf("Macintosh")>=0||rl.indexOf("iPad")>=0||rl.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Tg=rl.indexOf("Linux")>=0,_N=rl?.indexOf("Mobi")>=0,w_=!0,jv=Sg()||gp,Eg=navigator.language.toLowerCase(),EN=Eg):console.error("Unable to resolve platform.");var T_=0;xg?T_=1:wg?T_=3:Tg&&(T_=2);var pt=wg,Fe=xg,Wt=Tg;var aa=xN;var Zi=w_,$5=w_&&typeof sl.importScripts=="function",DN=$5?sl.origin:void 0,qr=x_,qv=_N;var sa=rl,jr=jv,Y5;(n=>{function o(){return jr}n.value=o;function e(){return jr.length===2?jr==="en":jr.length>=3?jr[0]==="e"&&jr[1]==="n"&&jr[2]==="-":!1}n.isDefaultVariant=e;function t(){return jr==="en"}n.isDefault=t})(Y5||={});var kN=Eg;var Z5=typeof sl.postMessage=="function"&&!sl.importScripts,$v=(()=>{if(Z5){let o=[];sl.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=o.length;n<i;n++){let r=o[n];if(r.id===t.data.vscodeScheduleAsyncWork){o.splice(n,1),r.callback();return}}});let e=0;return t=>{let n=++e;o.push({id:n,callback:t}),sl.postMessage({vscodeScheduleAsyncWork:n},"*")}}return o=>setTimeout(o)})();var $r=xg||x_?2:wg?1:3,TN=!0,wN=!1;function RN(){if(!wN){wN=!0;let o=new Uint8Array(2);o[0]=1,o[1]=2,TN=new Uint16Array(o.buffer)[0]===513}return TN}var __=!!(sa&&sa.indexOf("Chrome")>=0),Yv=!!(sa&&sa.indexOf("Firefox")>=0),MN=!!(!__&&sa&&sa.indexOf("Safari")>=0),ON=!!(sa&&sa.indexOf("Edg/")>=0),NN=!!(sa&&sa.indexOf("Android")>=0);var wc,L_=globalThis.vscode;if(typeof L_<"u"&&typeof L_.process<"u"){let o=L_.process;wc={get platform(){return o.platform},get arch(){return o.arch},get env(){return o.env},cwd(){return o.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?wc={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:wc={get platform(){return pt?"win32":Fe?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var _g=wc.cwd,gs=wc.env,AN=wc.platform,Fj=wc.arch;var X5=65,J5=97,e4=90,t4=122,sd=46,Fi=47,Yo=92,od=58,n4=63,Zv=class extends Error{code;constructor(e,t,n){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let r=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${r} ${i} of type ${t}`;s+=`. Received type ${typeof n}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function i4(o,e){if(o===null||typeof o!="object")throw new Zv(e,"Object",o)}function Wn(o,e){if(typeof o!="string")throw new Zv(e,"string",o)}var Zo=AN==="win32";function ft(o){return o===Fi||o===Yo}function D_(o){return o===Fi}function rd(o){return o>=X5&&o<=e4||o>=J5&&o<=t4}function Qv(o,e,t,n){let i="",r=0,s=-1,a=0,l=0;for(let d=0;d<=o.length;++d){if(d<o.length)l=o.charCodeAt(d);else{if(n(l))break;l=Fi}if(n(l)){if(!(s===d-1||a===1))if(a===2){if(i.length<2||r!==2||i.charCodeAt(i.length-1)!==sd||i.charCodeAt(i.length-2)!==sd){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",r=0):(i=i.slice(0,c),r=i.length-1-i.lastIndexOf(t)),s=d,a=0;continue}else if(i.length!==0){i="",r=0,s=d,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",r=2)}else i.length>0?i+=`${t}${o.slice(s+1,d)}`:i=o.slice(s+1,d),r=d-s-1;s=d,a=0}else l===sd&&a!==-1?++a:a=-1}return i}function o4(o){return o?`${o[0]==="."?"":"."}${o}`:""}function PN(o,e){i4(e,"pathObject");let t=e.dir||e.root,n=e.base||`${e.name||""}${o4(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}${o}${n}`:n}var Cn={resolve(...o){let e="",t="",n=!1;for(let i=o.length-1;i>=-1;i--){let r;if(i>=0){if(r=o[i],Wn(r,`paths[${i}]`),r.length===0)continue}else e.length===0?r=_g():(r=gs[`=${e}`]||_g(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===Yo)&&(r=`${e}\\`));let s=r.length,a=0,l="",d=!1,c=r.charCodeAt(0);if(s===1)ft(c)&&(a=1,d=!0);else if(ft(c))if(d=!0,ft(r.charCodeAt(1))){let u=2,p=u;for(;u<s&&!ft(r.charCodeAt(u));)u++;if(u<s&&u!==p){let h=r.slice(p,u);for(p=u;u<s&&ft(r.charCodeAt(u));)u++;if(u<s&&u!==p){for(p=u;u<s&&!ft(r.charCodeAt(u));)u++;(u===s||u!==p)&&(l=`\\\\${h}\\${r.slice(p,u)}`,a=u)}}}else a=1;else rd(c)&&r.charCodeAt(1)===od&&(l=r.slice(0,2),a=2,s>2&&ft(r.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,n=d,d&&e.length>0)break}return t=Qv(t,!n,"\\",ft),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(o){Wn(o,"path");let e=o.length;if(e===0)return".";let t=0,n,i=!1,r=o.charCodeAt(0);if(e===1)return D_(r)?"\\":o;if(ft(r))if(i=!0,ft(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ft(o.charCodeAt(a));)a++;if(a<e&&a!==l){let d=o.slice(l,a);for(l=a;a<e&&ft(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ft(o.charCodeAt(a));)a++;if(a===e)return`\\\\${d}\\${o.slice(l)}\\`;a!==l&&(n=`\\\\${d}\\${o.slice(l,a)}`,t=a)}}}else t=1;else rd(r)&&o.charCodeAt(1)===od&&(n=o.slice(0,2),t=2,e>2&&ft(o.charCodeAt(2))&&(i=!0,t=3));let s=t<e?Qv(o.slice(t),!i,"\\",ft):"";return s.length===0&&!i&&(s="."),s.length>0&&ft(o.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(o){Wn(o,"path");let e=o.length;if(e===0)return!1;let t=o.charCodeAt(0);return ft(t)||e>2&&rd(t)&&o.charCodeAt(1)===od&&ft(o.charCodeAt(2))},join(...o){if(o.length===0)return".";let e,t;for(let r=0;r<o.length;++r){let s=o[r];Wn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&ft(t.charCodeAt(0))){++i;let r=t.length;r>1&&ft(t.charCodeAt(1))&&(++i,r>2&&(ft(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&ft(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return Cn.normalize(e)},relative(o,e){if(Wn(o,"from"),Wn(e,"to"),o===e)return"";let t=Cn.resolve(o),n=Cn.resolve(e);if(t===n||(o=t.toLowerCase(),e=n.toLowerCase(),o===e))return"";let i=0;for(;i<o.length&&o.charCodeAt(i)===Yo;)i++;let r=o.length;for(;r-1>i&&o.charCodeAt(r-1)===Yo;)r--;let s=r-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Yo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Yo;)l--;let d=l-a,c=s<d?s:d,u=-1,p=0;for(;p<c;p++){let f=o.charCodeAt(i+p);if(f!==e.charCodeAt(a+p))break;f===Yo&&(u=p)}if(p!==c){if(u===-1)return n}else{if(d>c){if(e.charCodeAt(a+p)===Yo)return n.slice(a+p+1);if(p===2)return n.slice(a+p)}s>c&&(o.charCodeAt(i+p)===Yo?u=p:p===2&&(u=3)),u===-1&&(u=0)}let h="";for(p=i+u+1;p<=r;++p)(p===r||o.charCodeAt(p)===Yo)&&(h+=h.length===0?"..":"\\..");return a+=u,h.length>0?`${h}${n.slice(a,l)}`:(n.charCodeAt(a)===Yo&&++a,n.slice(a,l))},toNamespacedPath(o){if(typeof o!="string"||o.length===0)return o;let e=Cn.resolve(o);if(e.length<=2)return o;if(e.charCodeAt(0)===Yo){if(e.charCodeAt(1)===Yo){let t=e.charCodeAt(2);if(t!==n4&&t!==sd)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(rd(e.charCodeAt(0))&&e.charCodeAt(1)===od&&e.charCodeAt(2)===Yo)return`\\\\?\\${e}`;return o},dirname(o){Wn(o,"path");let e=o.length;if(e===0)return".";let t=-1,n=0,i=o.charCodeAt(0);if(e===1)return ft(i)?o:".";if(ft(i)){if(t=n=1,ft(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ft(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&ft(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ft(o.charCodeAt(a));)a++;if(a===e)return o;a!==l&&(t=n=a+1)}}}}else rd(i)&&o.charCodeAt(1)===od&&(t=e>2&&ft(o.charCodeAt(2))?3:2,n=t);let r=-1,s=!0;for(let a=e-1;a>=n;--a)if(ft(o.charCodeAt(a))){if(!s){r=a;break}}else s=!1;if(r===-1){if(t===-1)return".";r=t}return o.slice(0,r)},basename(o,e){e!==void 0&&Wn(e,"suffix"),Wn(o,"path");let t=0,n=-1,i=!0,r;if(o.length>=2&&rd(o.charCodeAt(0))&&o.charCodeAt(1)===od&&(t=2),e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=t;--r){let l=o.charCodeAt(r);if(ft(l)){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=t;--r)if(ft(o.charCodeAt(r))){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){Wn(o,"path");let e=0,t=-1,n=0,i=-1,r=!0,s=0;o.length>=2&&o.charCodeAt(1)===od&&rd(o.charCodeAt(0))&&(e=n=2);for(let a=o.length-1;a>=e;--a){let l=o.charCodeAt(a);if(ft(l)){if(!r){n=a+1;break}continue}i===-1&&(r=!1,i=a+1),l===sd?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":o.slice(t,i)},format:PN.bind(null,"\\"),parse(o){Wn(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.length,n=0,i=o.charCodeAt(0);if(t===1)return ft(i)?(e.root=e.dir=o,e):(e.base=e.name=o,e);if(ft(i)){if(n=1,ft(o.charCodeAt(1))){let u=2,p=u;for(;u<t&&!ft(o.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&ft(o.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&!ft(o.charCodeAt(u));)u++;u===t?n=u:u!==p&&(n=u+1)}}}}else if(rd(i)&&o.charCodeAt(1)===od){if(t<=2)return e.root=e.dir=o,e;if(n=2,ft(o.charCodeAt(2))){if(t===3)return e.root=e.dir=o,e;n=3}}n>0&&(e.root=o.slice(0,n));let r=-1,s=n,a=-1,l=!0,d=o.length-1,c=0;for(;d>=n;--d){if(i=o.charCodeAt(d),ft(i)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),i===sd?r===-1?r=d:c!==1&&(c=1):r!==-1&&(c=-1)}return a!==-1&&(r===-1||c===0||c===1&&r===a-1&&r===s+1?e.base=e.name=o.slice(s,a):(e.name=o.slice(s,r),e.base=o.slice(s,a),e.ext=o.slice(r,a))),s>0&&s!==n?e.dir=o.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},r4=(()=>{if(Zo){let o=/\\/g;return()=>{let e=_g().replace(o,"/");return e.slice(e.indexOf("/"))}}return()=>_g()})(),bt={resolve(...o){let e="",t=!1;for(let n=o.length-1;n>=-1&&!t;n--){let i=n>=0?o[n]:r4();Wn(i,`paths[${n}]`),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===Fi)}return e=Qv(e,!t,"/",D_),t?`/${e}`:e.length>0?e:"."},normalize(o){if(Wn(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===Fi,t=o.charCodeAt(o.length-1)===Fi;return o=Qv(o,!e,"/",D_),o.length===0?e?"/":t?"./":".":(t&&(o+="/"),e?`/${o}`:o)},isAbsolute(o){return Wn(o,"path"),o.length>0&&o.charCodeAt(0)===Fi},join(...o){if(o.length===0)return".";let e;for(let t=0;t<o.length;++t){let n=o[t];Wn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":bt.normalize(e)},relative(o,e){if(Wn(o,"from"),Wn(e,"to"),o===e||(o=bt.resolve(o),e=bt.resolve(e),o===e))return"";let t=1,n=o.length,i=n-t,r=1,s=e.length-r,a=i<s?i:s,l=-1,d=0;for(;d<a;d++){let u=o.charCodeAt(t+d);if(u!==e.charCodeAt(r+d))break;u===Fi&&(l=d)}if(d===a)if(s>a){if(e.charCodeAt(r+d)===Fi)return e.slice(r+d+1);if(d===0)return e.slice(r+d)}else i>a&&(o.charCodeAt(t+d)===Fi?l=d:d===0&&(l=0));let c="";for(d=t+l+1;d<=n;++d)(d===n||o.charCodeAt(d)===Fi)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(r+l)}`},toNamespacedPath(o){return o},dirname(o){if(Wn(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===Fi,t=-1,n=!0;for(let i=o.length-1;i>=1;--i)if(o.charCodeAt(i)===Fi){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":o.slice(0,t)},basename(o,e){e!==void 0&&Wn(e,"ext"),Wn(o,"path");let t=0,n=-1,i=!0,r;if(e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=0;--r){let l=o.charCodeAt(r);if(l===Fi){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=0;--r)if(o.charCodeAt(r)===Fi){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){Wn(o,"path");let e=-1,t=0,n=-1,i=!0,r=0;for(let s=o.length-1;s>=0;--s){let a=o.charCodeAt(s);if(a===Fi){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===sd?e===-1?e=s:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||n===-1||r===0||r===1&&e===n-1&&e===t+1?"":o.slice(e,n)},format:PN.bind(null,"/"),parse(o){Wn(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.charCodeAt(0)===Fi,n;t?(e.root="/",n=1):n=0;let i=-1,r=0,s=-1,a=!0,l=o.length-1,d=0;for(;l>=n;--l){let c=o.charCodeAt(l);if(c===Fi){if(!a){r=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===sd?i===-1?i=l:d!==1&&(d=1):i!==-1&&(d=-1)}if(s!==-1){let c=r===0&&t?1:r;i===-1||d===0||d===1&&i===s-1&&i===r+1?e.base=e.name=o.slice(c,s):(e.name=o.slice(c,i),e.base=o.slice(c,s),e.ext=o.slice(i,s))}return r>0?e.dir=o.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};bt.win32=Cn.win32=Cn;bt.posix=Cn.posix=bt;var ad=Zo?Cn.normalize:bt.normalize,k_=Zo?Cn.isAbsolute:bt.isAbsolute,Er=Zo?Cn.join:bt.join,fp=Zo?Cn.resolve:bt.resolve,FN=Zo?Cn.relative:bt.relative,Xv=Zo?Cn.dirname:bt.dirname,R_=Zo?Cn.basename:bt.basename,Jv=Zo?Cn.extname:bt.extname,Bj=Zo?Cn.format:bt.format,Wj=Zo?Cn.parse:bt.parse,Vj=Zo?Cn.toNamespacedPath:bt.toNamespacedPath,si=Zo?Cn.sep:bt.sep,Hj=Zo?Cn.delimiter:bt.delimiter;var a4=/^\w[\w\d+.-]*$/,l4=/^\//,d4=/^\/\//;function c4(o,e){if(!o.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${o.authority}", path: "${o.path}", query: "${o.query}", fragment: "${o.fragment}"}`);if(o.scheme&&!a4.test(o.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(o.path){if(o.authority){if(!l4.test(o.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(d4.test(o.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function u4(o,e){return!o&&!e?"file":o}function p4(o,e){switch(o){case"https":case"http":case"file":e?e[0]!==fs&&(e=fs+e):e=fs;break}return e}var un="",fs="/",h4=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,te=class o{static isUri(e){return e instanceof o?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,n,i,r,s=!1){typeof e=="object"?(this.scheme=e.scheme||un,this.authority=e.authority||un,this.path=e.path||un,this.query=e.query||un,this.fragment=e.fragment||un):(this.scheme=u4(e,s),this.authority=t||un,this.path=p4(this.scheme,n||un),this.query=i||un,this.fragment=r||un,c4(this,s))}get fsPath(){return Lg(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:r,fragment:s}=e;return t===void 0?t=this.scheme:t===null&&(t=un),n===void 0?n=this.authority:n===null&&(n=un),i===void 0?i=this.path:i===null&&(i=un),r===void 0?r=this.query:r===null&&(r=un),s===void 0?s=this.fragment:s===null&&(s=un),t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&s===this.fragment?this:new ld(t,n,i,r,s)}static parse(e,t=!1){let n=h4.exec(e);return n?new ld(n[2]||un,ey(n[4]||un),ey(n[5]||un),ey(n[7]||un),ey(n[9]||un),t):new ld(un,un,un,un,un)}static file(e){let t=un;if(pt&&(e=e.replace(/\\/g,fs)),e[0]===fs&&e[1]===fs){let n=e.indexOf(fs,2);n===-1?(t=e.substring(2),e=fs):(t=e.substring(2,n),e=e.substring(n)||fs)}return new ld("file",t,e,un,un)}static from(e,t){return new ld(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return pt&&e.scheme==="file"?n=o.file(Cn.join(Lg(e,!0),...t)).path:n=bt.join(e.path,...t),e.with({path:n})}toString(e=!1){return O_(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof o)return e;{let t=new ld(e);return t._formatted=e.external??null,t._fsPath=e._sep===VN?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var VN=pt?1:void 0,ld=class extends te{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=Lg(this,!1)),this._fsPath}toString(e=!1){return e?O_(this,!0):(this._formatted||(this._formatted=O_(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=VN),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},HN={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function BN(o,e,t){let n,i=-1;for(let r=0;r<o.length;r++){let s=o.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47||t&&s===91||t&&s===93||t&&s===58)i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n!==void 0&&(n+=o.charAt(r));else{n===void 0&&(n=o.substr(0,r));let a=HN[s];a!==void 0?(i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n+=a):i===-1&&(i=r)}}return i!==-1&&(n+=encodeURIComponent(o.substring(i))),n!==void 0?n:o}function m4(o){let e;for(let t=0;t<o.length;t++){let n=o.charCodeAt(t);n===35||n===63?(e===void 0&&(e=o.substr(0,t)),e+=HN[n]):e!==void 0&&(e+=o[t])}return e!==void 0?e:o}function Lg(o,e){let t;return o.authority&&o.path.length>1&&o.scheme==="file"?t=`//${o.authority}${o.path}`:o.path.charCodeAt(0)===47&&(o.path.charCodeAt(1)>=65&&o.path.charCodeAt(1)<=90||o.path.charCodeAt(1)>=97&&o.path.charCodeAt(1)<=122)&&o.path.charCodeAt(2)===58?e?t=o.path.substr(1):t=o.path[1].toLowerCase()+o.path.substr(2):t=o.path,pt&&(t=t.replace(/\//g,"\\")),t}function O_(o,e){let t=e?m4:BN,n="",{scheme:i,authority:r,path:s,query:a,fragment:l}=o;if(i&&(n+=i,n+=":"),(r||i==="file")&&(n+=fs,n+=fs),r){let d=r.indexOf("@");if(d!==-1){let c=r.substr(0,d);r=r.substr(d+1),d=c.lastIndexOf(":"),d===-1?n+=t(c,!1,!1):(n+=t(c.substr(0,d),!1,!1),n+=":",n+=t(c.substr(d+1),!1,!0)),n+="@"}r=r.toLowerCase(),d=r.lastIndexOf(":"),d===-1?n+=t(r,!1,!0):(n+=t(r.substr(0,d),!1,!0),n+=r.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}n+=t(s,!0,!1)}return a&&(n+="?",n+=t(a,!1,!1)),l&&(n+="#",n+=e?l:BN(l,!1,!1)),n}function UN(o){try{return decodeURIComponent(o)}catch{return o.length>3?o.substr(0,3)+UN(o.substr(3)):o}}var WN=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function ey(o){return o.match(WN)?o.replace(WN,e=>UN(e)):o}function xc(o,e){let t=g4(o,e);if(t!==-1)return o[t]}function g4(o,e,t=o.length-1){for(let n=t;n>=0;n--){let i=o[n];if(e(i))return n}return-1}function al(o,e){let t=ll(o,e);return t===-1?void 0:o[t]}function ll(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?i=s+1:r=s}return i-1}function zN(o,e){let t=kg(o,e);return t===o.length?void 0:o[t]}function kg(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?r=s:i=s+1}return i}var Dg=class o{constructor(e){this._array=e}static assertInvariants=!1;_findLastMonotonousLastIdx=0;_prevFindLastPredicate;findLastMonotonous(e){if(o.assertInvariants){if(this._prevFindLastPredicate){for(let n of this._array)if(this._prevFindLastPredicate(n)&&!e(n))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let t=ll(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};function f4(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>0&&(t=i)}return t}function KN(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>=0&&(t=i)}return t}function GN(o,e){return f4(o,(t,n)=>-e(t,n))}function jN(o,e){if(o.length===0)return-1;let t=0;for(let n=1;n<o.length;n++){let i=o[n];e(i,o[t])>0&&(t=n)}return t}var N_=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?dl.isErrorNoTelemetry(e)?new dl(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},qN=new N_;function bp(o){qN.onUnexpectedError(o)}function je(o){ny(o)||qN.onUnexpectedError(o)}var A_="Canceled";function ny(o){return o instanceof Bi?!0:o instanceof Error&&o.name===A_&&o.message===A_}var Bi=class extends Error{constructor(){super(A_),this.name=this.message}};function _c(o){return o?new Error(`Illegal argument: ${o}`):new Error("Illegal argument")}function $N(o){return o?new Error(`Illegal state: ${o}`):new Error("Illegal state")}var ty=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}};var dl=class o extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof o)return e;let t=new o;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},$e=class o extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,o.prototype)}};function ko(o,e=0){return o[o.length-(1+e)]}function oy(o){if(o.length===0)throw new Error("Invalid tail call");return[o.slice(0,o.length-1),o[o.length-1]]}function Ut(o,e,t=(n,i)=>n===i){if(o===e)return!0;if(!o||!e||o.length!==e.length)return!1;for(let n=0,i=o.length;n<i;n++)if(!t(o[n],e[n]))return!1;return!0}function YN(o,e){let t=o.length-1;e<t&&(o[e]=o[t]),o.pop()}function ZN(o,e,t){return v4(o.length,n=>t(o[n],e))}function v4(o,e){let t=0,n=o-1;for(;t<=n;){let i=(t+n)/2|0,r=e(i);if(r<0)t=i+1;else if(r>0)n=i-1;else return i}return-(t+1)}function*vp(o,e){let t,n;for(let i of o)n!==void 0&&e(n,i)?t.push(i):(t&&(yield t),t=[i]),n=i;t&&(yield t)}function ry(o,e){for(let t=0;t<=o.length;t++)e(t===0?void 0:o[t-1],t===o.length?void 0:o[t])}function QN(o,e){for(let t=0;t<o.length;t++)e(t===0?void 0:o[t-1],o[t],t+1===o.length?void 0:o[t+1])}function Ro(o){return o.filter(e=>!!e)}function P_(o){let e=0;for(let t=0;t<o.length;t++)o[t]&&(o[e]=o[t],e+=1);o.length=e}function bs(o,e=t=>t){let t=new Set;return o.filter(n=>{let i=e(n);return t.has(i)?!1:(t.add(i),!0)})}function Kn(o,e){let t=typeof e=="number"?o:0;typeof e=="number"?t=o:(t=0,e=o);let n=[];if(t<=e)for(let i=t;i<e;i++)n.push(i);else for(let i=t;i>e;i--)n.push(i);return n}function sy(o,e){return o.push(e),()=>y4(o,e)}function y4(o,e){let t=o.indexOf(e);if(t>-1)return o.splice(t,1),e}function la(o,e,t){let n=o.slice(0,e),i=o.slice(e);return n.concat(t,i)}function ay(o,e){let t=o.indexOf(e);t>-1&&(o.splice(t,1),o.unshift(e))}function Rg(o,e){let t=o.indexOf(e);t>-1&&(o.splice(t,1),o.push(e))}function Mg(o,e){for(let t of e)o.push(t)}function I4(o,e,t){let n=XN(o,e),i=o.length,r=t.length;o.length=i+r;for(let s=i-1;s>=n;s--)o[s+r]=o[s];for(let s=0;s<r;s++)o[s+n]=t[s]}function F_(o,e,t,n){let i=XN(o,e),r=o.splice(i,t);return r===void 0&&(r=[]),I4(o,i,n),r}function XN(o,e){return e<0?Math.max(e+o.length,0):Math.min(e,o.length)}var iy;(a=>{function o(l){return l<0}a.isLessThan=o;function e(l){return l<=0}a.isLessThanOrEqual=e;function t(l){return l>0}a.isGreaterThan=t;function n(l){return l===0}a.isNeitherLessOrGreaterThan=n,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(iy||={});function mo(o,e){return(t,n)=>e(o(t),o(n))}function JN(...o){return(e,t)=>{for(let n of o){let i=n(e,t);if(!iy.isNeitherLessOrGreaterThan(i))return i}return iy.neitherLessOrGreaterThan}}var da=(o,e)=>o-e,eA=(o,e)=>da(o?1:0,e?1:0);function tA(o){return(e,t)=>-o(e,t)}var Wi=class{constructor(e){this.items=e}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let n=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,n}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let n=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,n}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},cl=class o{constructor(e){this.iterate=e}static empty=new o(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new o(t=>this.iterate(n=>e(n)?t(n):!0))}map(e){return new o(t=>this.iterate(n=>t(e(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(i=>((n||iy.isGreaterThan(e(i,t)))&&(n=!1,t=i),!0)),t}};function nA(o,e){let t=new Set;for(let n of e)o.has(n)&&t.add(n);return t}function H_(o,e,t){let n=o.get(e);return n===void 0&&(n=t,o.set(e,n)),n}var B_=class{constructor(e,t){this.uri=e;this.value=t}};function C4(o){return Array.isArray(o)}var go=class o{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof o)this.map=new Map(e.map),this.toKey=t??o.defaultToKey;else if(C4(e)){this.map=new Map,this.toKey=t??o.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e??o.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new B_(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[n,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}},Lc=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(e,t){!e||typeof e=="function"?this._map=new go(e):(this._map=new go(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var W_=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.key,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.value,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:[n.key,n.value],done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},V_=class extends W_{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Qo=class extends V_{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}};var Dc=class{map=new Map;add(e,t){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(t)}delete(e,t){let n=this.map.get(e);n&&(n.delete(t),n.size===0&&this.map.delete(e))}forEach(e,t){let n=this.map.get(e);n&&n.forEach(t)}get(e){let t=this.map.get(e);return t||new Set}};function vs(o,e){let t=this,n=!1,i;return function(){if(n)return i;if(n=!0,e)try{i=o.apply(t,arguments)}finally{e()}else i=o.apply(t,arguments);return i}}var Je;(T=>{function o(S){return S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}T.is=o;let e=Object.freeze([]);function t(){return e}T.empty=t;function*n(S){yield S}T.single=n;function i(S){return o(S)?S:n(S)}T.wrap=i;function r(S){return S||e}T.from=r;function*s(S){for(let C=S.length-1;C>=0;C--)yield S[C]}T.reverse=s;function a(S){return!S||S[Symbol.iterator]().next().done===!0}T.isEmpty=a;function l(S){return S[Symbol.iterator]().next().value}T.first=l;function d(S,C){let w=0;for(let x of S)if(C(x,w++))return!0;return!1}T.some=d;function c(S,C){for(let w of S)if(C(w))return w}T.find=c;function*u(S,C){for(let w of S)C(w)&&(yield w)}T.filter=u;function*p(S,C){let w=0;for(let x of S)yield C(x,w++)}T.map=p;function*h(S,C){let w=0;for(let x of S)yield*C(x,w++)}T.flatMap=h;function*f(...S){for(let C of S)yield*C}T.concat=f;function g(S,C,w){let x=w;for(let D of S)x=C(x,D);return x}T.reduce=g;function*b(S,C,w=S.length){for(C<0&&(C+=S.length),w<0?w+=S.length:w>S.length&&(w=S.length);C<w;C++)yield S[C]}T.slice=b;function v(S,C=Number.POSITIVE_INFINITY){let w=[];if(C===0)return[w,S];let x=S[Symbol.iterator]();for(let D=0;D<C;D++){let O=x.next();if(O.done)return[w,T.empty()];w.push(O.value)}return[w,{[Symbol.iterator](){return x}}]}T.consume=v;async function I(S){let C=[];for await(let w of S)C.push(w);return Promise.resolve(C)}T.asyncToArray=I})(Je||={});var S4=!1,kc=null;function E4(o){kc=o}if(S4){let o="__is_disposable_tracked__";E4(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[o]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==F.None)try{e[o]=!0}catch{}}markAsDisposed(e){if(e&&e!==F.None)try{e[o]=!0}catch{}}markAsSingleton(e){}})}function Rc(o){return kc?.trackDisposable(o),o}function Mc(o){kc?.markAsDisposed(o)}function Og(o,e){kc?.setParent(o,e)}function T4(o,e){if(kc)for(let t of o)kc.setParent(t,e)}function dd(o){return kc?.markAsSingleton(o),o}function iA(o){return typeof o=="object"&&o!==null&&typeof o.dispose=="function"&&o.dispose.length===0}function Tt(o){if(Je.is(o)){let e=[];for(let t of o)if(t)try{t.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(o)?[]:o}else if(o)return o.dispose(),o}function Mo(...o){let e=pe(()=>Tt(o));return T4(o,e),e}function pe(o){let e=Rc({dispose:vs(()=>{Mc(e),o()})});return e}var ne=class o{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){Rc(this)}dispose(){this._isDisposed||(Mc(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Tt(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return Og(e,this),this._isDisposed?o.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),Og(e,null))}},F=class{static None=Object.freeze({dispose(){}});_store=new ne;constructor(){Rc(this),Og(this._store,this)}dispose(){Mc(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},on=class{_value;_isDisposed=!1;constructor(){Rc(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&Og(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Mc(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&Og(e,null),e}};var wr=class{_store=new Map;_isDisposed=!1;constructor(){Rc(this)}dispose(){Mc(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Tt(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var oA=Object.freeze(function(o,e){let t=setTimeout(o.bind(e),0);return{dispose(){clearTimeout(t)}}}),en;(n=>{function o(i){return i===n.None||i===n.Cancelled||i instanceof yp?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}n.isCancellationToken=o,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:j.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:oA})})(en||={});var yp=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?oA:(this._emitter||(this._emitter=new k),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Rn=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new yp),this._token}cancel(){this._token?this._token instanceof yp&&this._token.cancel():this._token=en.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof yp&&this._token.dispose():this._token=en.None}};var Sn=class o{static Undefined=new o(void 0);element;next;prev;constructor(e){this.element=e,this.next=o.Undefined,this.prev=o.Undefined}},Vi=class{_first=Sn.Undefined;_last=Sn.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===Sn.Undefined}clear(){let e=this._first;for(;e!==Sn.Undefined;){let t=e.next;e.prev=Sn.Undefined,e.next=Sn.Undefined,e=t}this._first=Sn.Undefined,this._last=Sn.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new Sn(e);if(this._first===Sn.Undefined)this._first=n,this._last=n;else if(t){let r=this._last;this._last=n,n.prev=r,r.next=n}else{let r=this._first;this._first=n,n.next=r,r.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==Sn.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Sn.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Sn.Undefined&&e.next!==Sn.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Sn.Undefined&&e.next===Sn.Undefined?(this._first=Sn.Undefined,this._last=Sn.Undefined):e.next===Sn.Undefined?(this._last=this._last.prev,this._last.next=Sn.Undefined):e.prev===Sn.Undefined&&(this._first=this._first.next,this._first.prev=Sn.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Sn.Undefined;)yield e.element,e=e.next}};var Hi=(o,e)=>o===e;function z_(o=Hi){return(e,t)=>Ut(e,t,o)}function ly(o,e,t){if(t!==void 0){let n=o;return n==null||e===void 0||e===null?e===n:t(n,e)}else{let n=o;return(i,r)=>i==null||r===void 0||r===null?r===i:n(i,r)}}function sA(o){return JSON.stringify(U_(o))}var w4=0,rA=new WeakMap;function U_(o){if(Array.isArray(o))return o.map(U_);if(o&&typeof o=="object")if(Object.getPrototypeOf(o)===Object.prototype){let e=o,t=Object.create(null);for(let n of Object.keys(e).sort())t[n]=U_(e[n]);return t}else{let e=rA.get(o);return e===void 0&&(e=w4++,rA.set(o,e)),e+"----2b76a038c20c4bcc"}return o}var gn=class{constructor(e,t,n){this.owner=e;this.debugNameSource=t;this.referenceFn=n}getDebugName(e){return cA(e,this)}},aA=new Map,K_=new WeakMap;function cA(o,e){let t=K_.get(o);if(t)return t;let n=x4(o,e);if(n){let i=aA.get(n)??0;i++,aA.set(n,i);let r=i===1?n:`${n}#${i}`;return K_.set(o,r),r}}function x4(o,e){let t=K_.get(o);if(t)return t;let n=e.owner?L4(e.owner)+".":"",i,r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(i=r(),i!==void 0)return n+i}else return n+r;let s=e.referenceFn;if(s!==void 0&&(i=dy(s),i!==void 0))return n+i;if(e.owner!==void 0){let a=_4(e.owner,o);if(a!==void 0)return n+a}}function _4(o,e){for(let t in o)if(o[t]===e)return t}var lA=new Map,dA=new WeakMap;function L4(o){let e=dA.get(o);if(e)return e;let t=D4(o),n=lA.get(t)??0;n++,lA.set(t,n);let i=n===1?t:`${t}#${n}`;return dA.set(o,i),i}function D4(o){let e=o.constructor;return e?e.name:"Object"}function dy(o){let e=o.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}function cy(o,e){if(!o)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function Ng(o,e="Unreachable"){throw new Error(e)}function G_(o){o||je(new $e("Soft Assertion Failed"))}function ys(o){if(!o()){debugger;o(),je(new $e("Assertion Failed"))}}function Ag(o,e){let t=0;for(;t<o.length-1;){let n=o[t],i=o[t+1];if(!e(n,i))return!1;t++}return!0}function ot(o){return new Ip(new gn(void 0,void 0,o),o,void 0,void 0)}function ul(o,e){return new Ip(new gn(o.owner,o.debugName,o.debugReferenceFn??e),e,void 0,void 0)}function cd(o,e){return new Ip(new gn(o.owner,o.debugName,o.debugReferenceFn??e),e,o.createEmptyChangeSummary,o.handleChange)}function yi(o){let e=new ne,t=ul({owner:void 0,debugName:void 0,debugReferenceFn:o},n=>{e.clear(),o(n,e)});return pe(()=>{t.dispose(),e.dispose()})}var Ip=class{constructor(e,t,n,i){this._debugNameData=e;this._runFn=t;this.createChangeSummary=n;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),Xo()?.handleAutorunCreated(this),this._runIfNeeded(),Rc(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),Mc(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){Xo()?.handleAutorunTriggered(this);let n=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}catch(i){bp(i)}}}finally{t||Xo()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}ys(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:i=>i===e},this.changeSummary):!0)&&(this.state=2)}catch(n){bp(n)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=Ip)(ot||={});function Me(o,e){return e!==void 0?new pl(new gn(o,void 0,e),e,void 0,void 0,void 0,Hi):new pl(new gn(void 0,void 0,o),o,void 0,void 0,void 0,Hi)}function Cp(o,e,t){return new j_(new gn(o,void 0,e),e,void 0,void 0,void 0,Hi,t)}function ca(o,e){return new pl(new gn(o.owner,o.debugName,o.debugReferenceFn),e,void 0,void 0,o.onLastObserverRemoved,o.equalsFn??Hi)}uA(ca);function hl(o,e){let t,n;e===void 0?(t=o,n=void 0):(n=o,t=e);let i=new ne;return new pl(new gn(n,void 0,t),r=>(i.clear(),t(r,i)),void 0,void 0,()=>i.dispose(),Hi)}function xr(o,e){let t,n;e===void 0?(t=o,n=void 0):(n=o,t=e);let i;return new pl(new gn(n,void 0,t),r=>{i?i.clear():i=new ne;let s=t(r);return s&&i.add(s),s},void 0,void 0,()=>{i&&(i.dispose(),i=void 0)},Hi)}var pl=class extends Is{constructor(t,n,i,r,s=void 0,a){super();this._debugNameData=t;this._computeFn=n;this.createChangeSummary=i;this._handleChange=r;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),Xo()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let n=this.state!==0,i=this.value;this.state=3;let r=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}r=n&&!this._equalityComparator(i,this.value),Xo()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:r,hadValue:n})}catch(s){bp(s)}if(r)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let i of this.observers)i.handlePossibleChange(this);if(n)for(let i of this.observers)i.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let i of n)i.endUpdate(this)}ys(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(t,n){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:t,change:n,didChange:s=>s===t},this.changeSummary):!0}catch(s){bp(s)}let r=this.state===3;if(i&&(this.state===1||r)&&(this.state=2,r))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let n=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),n}addObserver(t){let n=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),n&&t.endUpdate(this)}},j_=class extends pl{constructor(t,n,i,r,s=void 0,a,l){super(t,n,i,r,s,a);this.set=l}};function ud(o){return new q_(o)}var q_=class extends Pg{constructor(t){super();this.value=t}get debugName(){return this.toString()}get(){return this.value}addObserver(t){}removeObserver(t){}toString(){return`Const: ${this.value}`}};function Dt(...o){let e,t,n;return o.length===3?[e,t,n]=o:[t,n]=o,new ua(new gn(e,void 0,n),t,n,()=>ua.globalTransaction,Hi)}function pA(o,e,t){return new ua(new gn(o.owner,o.debugName,o.debugReferenceFn??t),e,t,()=>ua.globalTransaction,o.equalsFn??Hi)}var ua=class extends Is{constructor(t,n,i,r,s){super();this._debugNameData=t;this.event=n;this._getValue=i;this._getTransaction=r;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let n=this._getValue(t),i=this.value,r=!this.hasValue||!this._equalityComparator(i,n),s=!1;r&&(this.value=n,this.hasValue&&(s=!0,Nc(this._getTransaction(),a=>{Xo()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||Xo()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=ua;function e(n,i){let r=!1;ua.globalTransaction===void 0&&(ua.globalTransaction=n,r=!0);try{i()}finally{r&&(ua.globalTransaction=void 0)}}t.batchEventsGlobally=e})(Dt||={});function Ii(o,e){return new $_(o,e)}var $_=class extends Is{constructor(t,n){super();this.debugName=t;this.event=n}subscription;onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=()=>{Yt(t=>{for(let n of this.observers)t.updateObserver(n,this),n.handleChange(this,void 0)},()=>this.debugName)};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}};function Oc(o){return typeof o=="string"?new uy(o):new uy(void 0,o)}var uy=class extends Is{constructor(t,n){super();this._debugName=t;this._owner=n}get debugName(){return new gn(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(t,n){if(!t){Yt(i=>{this.trigger(i,n)},()=>`Trigger signal ${this.debugName}`);return}for(let i of this.observers)t.updateObserver(i,this),i.handleChange(this,n)}get(){}};function hA(o){let e=new py(!1,void 0);return o.addObserver(e),pe(()=>{o.removeObserver(e)})}bA(hA);function Sp(o,e){let t=new py(!0,e);return o.addObserver(t),e?e(o.get()):o.reportChanges(),pe(()=>{o.removeObserver(t)})}fA(Sp);var py=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};function mA(o,e){let t;return ca({owner:o,debugReferenceFn:e},i=>(t=e(i,t),t))}var hy=class{constructor(e){this.observable=e}get onDidChange(){return j.fromObservableLight(this.observable)}get value(){return this.observable.get()}};function gA(o,e){return mA(o,(t,n)=>n??e(t))}var vA;function yA(o){vA=o}function Xo(){return vA}var my=class{indentation=0;textToConsoleArgs(e){return M4([Ep(A4("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[Ep(" "),Cs(Bg(e.oldValue,70),{color:"red",strikeThrough:!0}),Ep(" "),Cs(Bg(e.newValue,60),{color:"green"})]:[Ep(" (unchanged)")]:[Ep(" "),Cs(Bg(e.newValue,60),{color:"green"}),Ep(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([Fg("observable value changed"),Cs(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return Cs(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleDerivedRecomputed(e,t){let n=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([Fg("derived recomputed"),Cs(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([Fg("observable from event triggered"),Cs(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([Fg("autorun"),Cs(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([Fg("transaction"),Cs(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function M4(o){let e=new Array,t=[],n="";function i(s){if("length"in s)for(let a of s)a&&i(a);else"text"in s?(n+=`%c${s.text}`,e.push(s.style),s.data&&t.push(...s.data)):"data"in s&&t.push(...s.data)}i(o);let r=[n,...e];return r.push(...t),r}function Ep(o){return Cs(o,{color:"black"})}function Fg(o){return Cs(P4(`${o}: `,10),{color:"black",bold:!0})}function Cs(o,e={color:"black"}){function t(i){return Object.entries(i).reduce((r,[s,a])=>`${r}${s}:${a};`,"")}let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:o,style:t(n)}}function Bg(o,e){switch(typeof o){case"number":return""+o;case"string":return o.length+2<=e?`"${o}"`:`"${o.substr(0,e-7)}"+...`;case"boolean":return o?"true":"false";case"undefined":return"undefined";case"object":return o===null?"null":Array.isArray(o)?O4(o,e):N4(o,e);case"symbol":return o.toString();case"function":return`[[Function${o.name?" "+o.name:""}]]`;default:return""+o}}function O4(o,e){let t="[ ",n=!0;for(let i of o){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${Bg(i,e-t.length)}`}return t+=" ]",t}function N4(o,e){let t="{ ",n=!0;for(let[i,r]of Object.entries(o)){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${i}: ${Bg(r,e-t.length)}`}return t+=" }",t}function A4(o,e){let t="";for(let n=1;n<=e;n++)t+=o;return t}function P4(o,e){for(;o.length<e;)o+=" ";return o}var IA;function fA(o){IA=o}var CA;function bA(o){CA=o}var Y_;function uA(o){Y_=o}var Pg=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=t===void 0?void 0:e,i=t===void 0?e:t;return Y_({owner:n,debugName:()=>{let r=dy(i);if(r!==void 0)return r;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(a)return`${this.debugName}.${a[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:i},r=>i(this.read(r),r))}flatten(){return Y_({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(IA(this,t)),this}keepObserved(e){return e.add(CA(this)),this}get debugValue(){return this.get()}},Is=class extends Pg{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function Yt(o,e){let t=new pd(o,e);try{o(t)}finally{t.finish()}}function Nc(o,e,t){o?e(o):Yt(e,t)}var pd=class{constructor(e,t){this._fn=e;this._getDebugName=t;Xo()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():dy(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:n,observable:i}=e[t];n.endUpdate(i)}this.updatingObservers=null,Xo()?.handleEndTransaction()}};function st(o,e){let t;return typeof o=="string"?t=new gn(void 0,o,void 0):t=new gn(o,void 0,void 0),new Tp(t,e,Hi)}var Tp=class extends Is{constructor(t,n,i){super();this._debugNameData=t;this._equalityComparator=i;this._value=n}_value;get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(t,n,i){if(i===void 0&&this._equalityComparator(this._value,t))return;let r;n||(n=r=new pd(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;this._setValue(t),Xo()?.handleObservableChanged(this,{oldValue:s,newValue:t,change:i,didChange:!0,hadValue:!0});for(let a of this.observers)n.updateObserver(a,this),a.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function Q_(o,e){let t;return typeof o=="string"?t=new gn(void 0,o,void 0):t=new gn(o,void 0,void 0),new Z_(t,e,Hi)}var Z_=class extends Tp{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){this._value?.dispose()}};function X_(o,e,t,n){return e||(e=i=>i!=null),new Promise((i,r)=>{let s=!0,a=!1,l=o.map(c=>({isFinished:e(c),error:t?t(c):!1,state:c})),d=ot(c=>{let{isFinished:u,error:p,state:h}=l.read(c);(u||p)&&(s?a=!0:d.dispose(),p?r(p===!0?h:p):i(h))});if(n){let c=n.onCancellationRequested(()=>{d.dispose(),c.dispose(),r(new Bi)});if(n.isCancellationRequested){d.dispose(),c.dispose(),r(new Bi);return}}s=!1,a&&d.dispose()})}var gy=class extends Is{constructor(t,n,i){super();this._debugNameData=t;this._equalityComparator=i;this._value=n}_value;_isUpToDate=!0;_deltas=[];get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(let t of this.observers)for(let n of this._deltas)t.handleChange(this,n);this._deltas.length=0}else for(let t of this.observers)t.handleChange(this,void 0)}_updateCounter=0;_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(let t of this.observers)t.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();let t=[...this.observers];for(let n of t)n.endUpdate(this)}}addObserver(t){let n=!this.observers.has(t)&&this._updateCounter>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this._updateCounter>0;super.removeObserver(t),n&&t.endUpdate(this)}set(t,n,i){if(i===void 0&&this._equalityComparator(this._value,t))return;let r;n||(n=r=new pd(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(t),i!==void 0&&this._deltas.push(i),n.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(s,a)=>{},handlePossibleChange:s=>{}},this),this._updateCounter>1)for(let s of this.observers)s.handlePossibleChange(this)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function fy(o,e){return o.lazy?new gy(new gn(o.owner,o.debugName,void 0),e,o.equalsFn??Hi):new Tp(new gn(o.owner,o.debugName,void 0),e,o.equalsFn??Hi)}var F4=!1;F4&&yA(new my);var B4=globalThis.performance&&typeof globalThis.performance.now=="function",Ss=class o{_startTime;_stopTime;_now;static create(e){return new o(e)}constructor(e){this._now=B4&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var by=Symbol("MicrotaskDelay");var W4=!1,SA=!1,V4=!1,j;(Se=>{Se.None=()=>F.None;function e(J){if(V4){let{onDidAddListener:X}=J,le=Wg.create(),re=0;J.onDidAddListener=()=>{++re===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),le.print()),X?.()}}}function t(J,X){return h(J,()=>{},0,void 0,!0,void 0,X)}Se.defer=t;function n(J){return(X,le=null,re)=>{let ee=!1,Te;return Te=J(ce=>{if(!ee)return Te?Te.dispose():ee=!0,X.call(le,ce)},null,re),ee&&Te.dispose(),Te}}Se.once=n;function i(J,X){return Se.once(Se.filter(J,X))}Se.onceIf=i;function r(J,X,le){return u((re,ee=null,Te)=>J(ce=>re.call(ee,X(ce)),null,Te),le)}Se.map=r;function s(J,X,le){return u((re,ee=null,Te)=>J(ce=>{X(ce),re.call(ee,ce)},null,Te),le)}Se.forEach=s;function a(J,X,le){return u((re,ee=null,Te)=>J(ce=>X(ce)&&re.call(ee,ce),null,Te),le)}Se.filter=a;function l(J){return J}Se.signal=l;function d(...J){return(X,le=null,re)=>{let ee=Mo(...J.map(Te=>Te(ce=>X.call(le,ce))));return p(ee,re)}}Se.any=d;function c(J,X,le,re){let ee=le;return r(J,Te=>(ee=X(ee,Te),ee),re)}Se.reduce=c;function u(J,X){let le,re={onWillAddFirstListener(){le=J(ee.fire,ee)},onDidRemoveLastListener(){le?.dispose()}};X||e(re);let ee=new k(re);return X?.add(ee),ee.event}function p(J,X){return X instanceof Array?X.push(J):X&&X.add(J),J}function h(J,X,le=100,re=!1,ee=!1,Te,ce){let Ze,Ue,_e,mn=0,an,Pn={leakWarningThreshold:Te,onWillAddFirstListener(){Ze=J(hs=>{mn++,Ue=X(Ue,hs),re&&!_e&&(oi.fire(Ue),Ue=void 0),an=()=>{let At=Ue;Ue=void 0,_e=void 0,(!re||mn>1)&&oi.fire(At),mn=0},typeof le=="number"?(clearTimeout(_e),_e=setTimeout(an,le)):_e===void 0&&(_e=0,queueMicrotask(an))})},onWillRemoveListener(){ee&&mn>0&&an?.()},onDidRemoveLastListener(){an=void 0,Ze.dispose()}};ce||e(Pn);let oi=new k(Pn);return ce?.add(oi),oi.event}Se.debounce=h;function f(J,X=0,le){return Se.debounce(J,(re,ee)=>re?(re.push(ee),re):[ee],X,void 0,!0,void 0,le)}Se.accumulate=f;function g(J,X=(re,ee)=>re===ee,le){let re=!0,ee;return a(J,Te=>{let ce=re||!X(Te,ee);return re=!1,ee=Te,ce},le)}Se.latch=g;function b(J,X,le){return[Se.filter(J,X,le),Se.filter(J,re=>!X(re),le)]}Se.split=b;function v(J,X=!1,le=[],re){let ee=le.slice(),Te=J(Ue=>{ee?ee.push(Ue):Ze.fire(Ue)});re&&re.add(Te);let ce=()=>{ee?.forEach(Ue=>Ze.fire(Ue)),ee=null},Ze=new k({onWillAddFirstListener(){Te||(Te=J(Ue=>Ze.fire(Ue)),re&&re.add(Te))},onDidAddFirstListener(){ee&&(X?setTimeout(ce):ce())},onDidRemoveLastListener(){Te&&Te.dispose(),Te=null}});return re&&re.add(Ze),Ze.event}Se.buffer=v;function I(J,X){return(re,ee,Te)=>{let ce=X(new S);return J(function(Ze){let Ue=ce.evaluate(Ze);Ue!==T&&re.call(ee,Ue)},void 0,Te)}}Se.chain=I;let T=Symbol("HaltChainable");class S{steps=[];map(X){return this.steps.push(X),this}forEach(X){return this.steps.push(le=>(X(le),le)),this}filter(X){return this.steps.push(le=>X(le)?le:T),this}reduce(X,le){let re=le;return this.steps.push(ee=>(re=X(re,ee),re)),this}latch(X=(le,re)=>le===re){let le=!0,re;return this.steps.push(ee=>{let Te=le||!X(ee,re);return le=!1,re=ee,Te?ee:T}),this}evaluate(X){for(let le of this.steps)if(X=le(X),X===T)break;return X}}function C(J,X,le=re=>re){let re=(...Ze)=>ce.fire(le(...Ze)),ee=()=>J.on(X,re),Te=()=>J.removeListener(X,re),ce=new k({onWillAddFirstListener:ee,onDidRemoveLastListener:Te});return ce.event}Se.fromNodeEventEmitter=C;function w(J,X,le=re=>re){let re=(...Ze)=>ce.fire(le(...Ze)),ee=()=>J.addEventListener(X,re),Te=()=>J.removeEventListener(X,re),ce=new k({onWillAddFirstListener:ee,onDidRemoveLastListener:Te});return ce.event}Se.fromDOMEventEmitter=w;function x(J){return new Promise(X=>n(J)(X))}Se.toPromise=x;function D(J){let X=new k;return J.then(le=>{X.fire(le)},()=>{X.fire(void 0)}).finally(()=>{X.dispose()}),X.event}Se.fromPromise=D;function O(J,X){return J(le=>X.fire(le))}Se.forward=O;function H(J,X,le){return X(le),J(re=>X(re))}Se.runAndSubscribe=H;class K{constructor(X,le){this._observable=X;let re={onWillAddFirstListener:()=>{X.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{X.removeObserver(this)}};le||e(re),this.emitter=new k(re),le&&le.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(X){this._counter++}handlePossibleChange(X){}handleChange(X,le){this._hasChanged=!0}endUpdate(X){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function z(J,X){return new K(J,X).emitter.event}Se.fromObservable=z;function ie(J){return(X,le,re)=>{let ee=0,Te=!1,ce={beginUpdate(){ee++},endUpdate(){ee--,ee===0&&(J.reportChanges(),Te&&(Te=!1,X.call(le)))},handlePossibleChange(){},handleChange(){Te=!0}};J.addObserver(ce),J.reportChanges();let Ze={dispose(){J.removeObserver(ce)}};return re instanceof ne?re.add(Ze):Array.isArray(re)&&re.push(Ze),Ze}}Se.fromObservableLight=ie})(j||={});var J_=class o{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${o._idPool++}`,o.all.add(this)}start(e){this._stopWatch=new Ss,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},EA=-1;var eL=class o{constructor(e,t,n=(o._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=n}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let n=this.threshold;if(n<=0||t<n)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[r,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(r);let l=new tL(a,r);this._errorHandler(l)}return()=>{let r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[n,i]of this._stacks)(!e||t<i)&&(e=[n,i],t=i);return e}},Wg=class o{constructor(e){this.value=e}static create(){let e=new Error;return new o(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},tL=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},nL=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},H4=0,wp=class{constructor(e){this.value=e}stack;id=H4++},U4=2,TA=(o,e)=>{if(o instanceof wp)e(o);else for(let t=0;t<o.length;t++){let n=o[t];n&&e(n)}},vy;if(W4){let o=[];setInterval(()=>{o.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(o.join(`
`)),o.length=0)},3e3),vy=new FinalizationRegistry(e=>{typeof e=="string"&&o.push(e)})}var k=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=EA>0||this._options?.leakWarningThreshold?new eL(e?.onListenerError??je,this._options?.leakWarningThreshold??EA):void 0,this._perfMon=this._options?._profName?new J_(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(SA){let e=this._listeners;queueMicrotask(()=>{TA(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new nL(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||je)(c),F.None}if(this._disposed)return F.None;t&&(e=e.bind(t));let i=new wp(e),r,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=Wg.create(),r=this._leakageMon.check(i.stack,this._size+1)),SA&&(i.stack=s??Wg.create()),this._listeners?this._listeners instanceof wp?(this._deliveryQueue??=new yy,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=pe(()=>{vy?.unregister(a),r?.(),this._removeListener(i)});if(n instanceof ne?n.add(a):Array.isArray(n)&&n.push(a),vy){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);vy.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*U4<=t.length){let r=0;for(let s=0;s<t.length;s++)t[s]?t[r++]=t[s]:i&&(this._deliveryQueue.end--,r<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=r}}_deliver(e,t){if(!e)return;let n=this._options?.onListenerError||je;if(!n){e.value(t);return}try{e.value(t)}catch(i){n(i)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof wp)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},wA=()=>new yy,yy=class{i=-1;end=0;current;value;enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},xp=class extends k{_asyncDeliveryQueue;async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new Vi),TA(this._listeners,i=>this._asyncDeliveryQueue.push([i.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[i,r]=this._asyncDeliveryQueue.shift(),s=[],a={...r,token:t,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");n&&(l=n(l,i)),s.push(l)}};try{i(a)}catch(l){je(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&je(d.reason)})}}},Ac=class extends k{_isPaused=0;_eventQueue=new Vi;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}},Iy=class extends Ac{_delay;_handle;constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}},Cy=class extends k{_queuedEvents=[];_mergeFn;constructor(e){super(e),this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}},Vg=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new k({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){let t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),pe(vs(()=>{this.hasListeners&&this.unhook(t);let i=this.events.indexOf(t);this.events.splice(i,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(let e of this.events)e.listener?.dispose();this.events=[]}};var hd=class{data=[];wrapEvent(e,t,n){return(i,r,s)=>e(a=>{let l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>i.call(r,a)):i.call(r,a);return}let d=l;if(!d){i.call(r,t(n,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=n?d.items.reduce(t,n):d.items.reduce(t),i.call(r,d.reducedResult)})},void 0,s)}bufferEvents(e){let t={buffers:new Array};this.data.push(t);let n=e();return this.data.pop(),t.buffers.forEach(i=>i()),n}},Yr=class{listening=!1;inputEvent=j.None;inputEventListener=F.None;emitter=new k({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}});event=this.emitter.event;set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}};function xA(o){return o}var Sy=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=xA):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},md=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=xA):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let n=this._fn(e);return this._map.set(e,n),this._map2.set(t,n),n}};var Gn=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function Pc(o){return o<0?0:o>255?255:o|0}function LA(o){return!o||typeof o!="string"?!0:o.trim().length===0}function DA(o){return o.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function _p(o){return o.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function fo(o){return o.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function Ty(o,e){if(!o||!e)return o;let t=e.length;if(t===0||o.length===0)return o;let n=0;for(;o.indexOf(e,n)===n;)n=n+t;return o.substring(n)}function kA(o){return o.replace(/\*/g,"")}function wy(o,e,t={}){if(!o)throw new Error("Cannot create regex from empty string");e||(o=fo(o)),t.wholeWord&&(/\B/.test(o.charAt(0))||(o="\\b"+o),/\B/.test(o.charAt(o.length-1))||(o=o+"\\b"));let n="";return t.global&&(n+="g"),t.matchCase||(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),new RegExp(o,n)}function Hg(o){return o.split(/\r\n|\r|\n/)}function fn(o){for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function jn(o,e=0,t=o.length){for(let n=e;n<t;n++){let i=o.charCodeAt(n);if(i!==32&&i!==9)return o.substring(e,n)}return o.substring(e,t)}function _r(o,e=o.length-1){for(let t=e;t>=0;t--){let n=o.charCodeAt(t);if(n!==32&&n!==9)return t}return-1}function rL(o,e){return o<e?-1:o>e?1:0}function RA(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l<d)return-1;if(l>d)return 1}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function sL(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l===d)continue;if(l>=128||d>=128)return RA(o.toLowerCase(),e.toLowerCase(),t,n,i,r);Fc(l)&&(l-=32),Fc(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function Ug(o){return o>=48&&o<=57}function Fc(o){return o>=97&&o<=122}function pa(o){return o>=65&&o<=90}function Lr(o,e){return o.length===e.length&&sL(o,e)===0}function fd(o,e){let t=e.length;return e.length>o.length?!1:sL(o,e,0,t)===0}function zg(o,e){let t=Math.min(o.length,e.length),n;for(n=0;n<t;n++)if(o.charCodeAt(n)!==e.charCodeAt(n))return n;return t}function Kg(o,e){let t=Math.min(o.length,e.length),n,i=o.length-1,r=e.length-1;for(n=0;n<t;n++)if(o.charCodeAt(i-n)!==e.charCodeAt(r-n))return n;return t}function rn(o){return 55296<=o&&o<=56319}function bd(o){return 56320<=o&&o<=57343}function xy(o,e){return(o-55296<<10)+(e-56320)+65536}function Lp(o,e,t){let n=o.charCodeAt(t);if(rn(n)&&t+1<e){let i=o.charCodeAt(t+1);if(bd(i))return xy(n,i)}return n}function K4(o,e){let t=o.charCodeAt(e-1);if(bd(t)&&e>1){let n=o.charCodeAt(e-2);if(rn(n))return xy(n,t)}return t}var Bc=class{_str;_len;_offset;get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=K4(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){let e=Lp(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},Wc=class{_iterator;get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new Bc(e,t)}nextGraphemeLength(){let e=Ey.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let r=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(_A(i,s)){t.setOffset(r);break}i=s}return t.offset-n}prevGraphemeLength(){let e=Ey.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let r=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(_A(s,i)){t.setOffset(r);break}i=s}return n-t.offset}eol(){return this._iterator.eol()}};function Gg(o,e){return new Wc(o,e).nextGraphemeLength()}function aL(o,e){return new Wc(o,e).prevGraphemeLength()}function _y(o,e){e>0&&bd(o.charCodeAt(e))&&e--;let t=e+Gg(o,e);return[t-aL(o,t),t]}var iL;function G4(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function ml(o){return iL||(iL=G4()),iL.test(o)}var j4=/^[\t\n\r\x20-\x7E]*$/;function jg(o){return j4.test(o)}var lL=/[\u2028\u2029]/;function Ly(o){return lL.test(o)}function Dr(o){return o>=11904&&o<=55215||o>=63744&&o<=64255||o>=65281&&o<=65374}function qg(o){return o>=127462&&o<=127487||o===8986||o===8987||o===9200||o===9203||o>=9728&&o<=10175||o===11088||o===11093||o>=127744&&o<=128591||o>=128640&&o<=128764||o>=128992&&o<=129008||o>=129280&&o<=129535||o>=129648&&o<=129782}var MA=String.fromCharCode(65279);function OA(o){return!!(o&&o.length>0&&o.charCodeAt(0)===65279)}function Dy(o){let e=26;return o=o%(2*e),o<e?String.fromCharCode(97+o):String.fromCharCode(65+o-e)}function _A(o,e){return o===0?e!==5&&e!==7:o===2&&e===3?!1:o===4||o===2||o===3||e===4||e===2||e===3?!0:!(o===8&&(e===8||e===9||e===11||e===12)||(o===11||o===9)&&(e===9||e===10)||(o===12||o===10)&&e===10||e===5||e===13||e===7||o===1||o===13&&e===14||o===6&&e===6)}var Ey=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_data;constructor(){this._data=q4()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,n=t.length/3,i=1;for(;i<=n;)if(e<t[3*i])i=2*i;else if(e>t[3*i+1])i=2*i+1;else return t[3*i+2];return 0}};function q4(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function NA(o,e){if(o===0)return 0;let t=$4(o,e);if(t!==void 0)return t;let n=new Bc(e,o);return n.prevCodePoint(),n.offset}function $4(o,e){let t=new Bc(e,o),n=t.prevCodePoint();for(;Y4(n)||n===65039||n===8419;){if(t.offset===0)return;n=t.prevCodePoint()}if(!qg(n))return;let i=t.offset;return i>0&&t.prevCodePoint()===8205&&(i=t.offset),i}function Y4(o){return 127995<=o&&o<=127999}var oL=class o{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new Gn(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new Sy({getCacheKey:JSON.stringify},e=>{function t(c){let u=new Map;for(let p=0;p<c.length;p+=2)u.set(c[p],c[p+1]);return u}function n(c,u){let p=new Map(c);for(let[h,f]of u)p.set(h,f);return p}function i(c,u){if(!c)return u;let p=new Map;for(let[h,f]of c)u.has(h)&&p.set(h,f);return p}let r=this.ambiguousCharacterData.value,s=e.filter(c=>!c.startsWith("_")&&c in r);s.length===0&&(s=["_default"]);let a;for(let c of s){let u=t(r[c]);a=i(a,u)}let l=t(r._common),d=n(l,a);return new o(d)});static getInstance(e){return o.cache.get(Array.from(e))}static _locales=new Gn(()=>Object.keys(o.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return o._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let n=e.codePointAt(t);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};var xe;(_e=>(_e.inMemory="inmemory",_e.vscode="vscode",_e.internal="private",_e.walkThrough="walkThrough",_e.walkThroughSnippet="walkThroughSnippet",_e.http="http",_e.https="https",_e.file="file",_e.mailto="mailto",_e.untitled="untitled",_e.data="data",_e.command="command",_e.vscodeRemote="vscode-remote",_e.vscodeRemoteResource="vscode-remote-resource",_e.vscodeManagedRemoteResource="vscode-managed-remote-resource",_e.vscodeUserData="vscode-userdata",_e.vscodeCustomEditor="vscode-custom-editor",_e.vscodeNotebookCell="vscode-notebook-cell",_e.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",_e.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",_e.vscodeNotebookCellOutput="vscode-notebook-cell-output",_e.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",_e.vscodeNotebookMetadata="vscode-notebook-metadata",_e.vscodeInteractiveInput="vscode-interactive-input",_e.vscodeSettings="vscode-settings",_e.vscodeWorkspaceTrust="vscode-workspace-trust",_e.vscodeTerminal="vscode-terminal",_e.vscodeChatCodeBlock="vscode-chat-code-block",_e.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",_e.vscodeChatSesssion="vscode-chat-editor",_e.webviewPanel="webview-panel",_e.vscodeWebview="vscode-webview",_e.extension="extension",_e.vscodeFileResource="vscode-file",_e.tmp="tmp",_e.vsls="vsls",_e.vscodeSourceControl="vscode-scm",_e.commentsInput="comment",_e.codeSetting="code-setting",_e.outputChannel="output"))(xe||={});function $g(o,e){return te.isUri(o)?Lr(o.scheme,e):fd(o,e+":")}var Z4="tkn",dL=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=Q4(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return bt.join(this._serverRootPath,xe.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return je(a),e}let t=e.authority,n=this._hosts[t];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let i=this._ports[t],r=this._connectionTokens[t],s=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(s+=`&${Z4}=${encodeURIComponent(r)}`),te.from({scheme:Zi?this._preferredWebSchema:xe.vscodeRemoteResource,authority:`${n}:${i}`,path:this._remoteResourcesPath,query:s})}},ky=new dL;function Q4(o,e){return bt.join(e??"/",`${o.quality??"oss"}-${o.commit??"dev"}`)}var uL="vscode-app",cL=class o{static FALLBACK_AUTHORITY=uL;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===xe.vscodeRemote?ky.rewrite(e):e.scheme===xe.file&&(aa||DN===`${xe.vscodeFileResource}://${o.FALLBACK_AUTHORITY}`)?e.with({scheme:xe.vscodeFileResource,authority:e.authority||o.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===xe.vscodeFileResource?e.with({scheme:xe.file,authority:e.authority!==o.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(te.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n))return te.joinPath(te.parse(n,!0),e);let i=Er(n,e);return te.file(i)}return te.parse(t.toUrl(e))}},ha=new cL,X4;(r=>{let o=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(o.get("3"));let t="vscode-coi";function n(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:te.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(t);if(l)return o.get(l)}r.getHeadersFromQuery=n;function i(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(t,d):s[t]=d}r.addSearchParam=i})(X4||={});function En(o){return typeof o=="string"}function bn(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&!(o instanceof RegExp)&&!(o instanceof Date)}function Ui(o){return typeof o=="number"&&!isNaN(o)}function pL(o){return!!o&&typeof o[Symbol.iterator]=="function"}function Ry(o){return o===!0||o===!1}function qn(o){return typeof o>"u"}function gl(o){return!zi(o)}function zi(o){return qn(o)||o===null}function Dp(o,e){if(!o)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function pn(o){if(zi(o))throw new Error("Assertion Failed: argument is undefined or null");return o}var J4=Object.prototype.hasOwnProperty;function Vc(o){if(!bn(o))return!1;for(let e in o)if(J4.call(o,e))return!1;return!0}function Hc(o){return typeof o=="function"}function AA(o,e){let t=Math.min(o.length,e.length);for(let n=0;n<t;n++)ez(o[n],e[n])}function ez(o,e){if(En(e)){if(typeof o!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Hc(e)){try{if(o instanceof e)return}catch{}if(!zi(o)&&o.constructor===e||e.length===1&&e.call(void 0,o)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var ai=class extends F{_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(e,t="",n="",i=!0,r){super(),this._id=e,this._label=t,this._cssClass=n,this._enabled=i,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}},Oo=class extends F{_onWillRun=this._register(new k);onWillRun=this._onWillRun.event;_onDidRun=this._register(new k);onDidRun=this._onDidRun.event;async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let n;try{await this.runAction(e,t)}catch(i){n=i}this._onDidRun.fire({action:e,error:n})}async runAction(e,t){await e.run(t)}},Ci=class o{static join(...e){let t=[];for(let n of e)n.length&&(t.length?t=[...t,new o,...n]:t=n);return t}static ID="vs.actions.separator";id=o.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}},bl=class{id;label;class;tooltip="";enabled=!0;checked=void 0;_actions;get actions(){return this._actions}constructor(e,t,n,i){this.id=e,this.label=t,this.class=i,this._actions=n}async run(){}};function Si(o){return{id:o.id,label:o.label,tooltip:o.tooltip??o.label,class:o.class,enabled:o.enabled??!0,checked:o.checked,run:async(...e)=>o.run(...e)}}function hL(o,e){return e&&(o.stack||o.stacktrace)?m("stackTrace.format","{0}: {1}",FA(o),PA(o.stack)||PA(o.stacktrace)):FA(o)}function PA(o){return Array.isArray(o)?o.join(`
`):o}function FA(o){return o.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${o.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof o.code=="string"&&typeof o.errno=="number"&&typeof o.syscall=="string"?m("nodeExceptionMessage","A system error occurred ({0})",o.message):o.message||m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function kp(o=null,e=!1){if(!o)return m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(o)){let t=Ro(o),n=kp(t[0],e);return t.length>1?m("error.moreErrors","{0} ({1} errors in total)",n,t.length):n}if(En(o))return o;if(o.detail){let t=o.detail;if(t.error)return hL(t.error,e);if(t.exception)return hL(t.exception,e)}return o.stack?hL(o,e):o.message?o.message:m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function mL(o){let e=o;return e instanceof Error&&Array.isArray(e.actions)}function BA(o,e){let t;return typeof o=="string"?t=new Error(o):t=o,t.actions=e,t}var Yg=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}};var Rp=class{_entries=new Map;constructor(...e){for(let[t,n]of e)this.set(t,n)}set(e,t){let n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var vd;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function n(r){return r[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=n})(vd||={});var Qe=Q("instantiationService");function tz(o,e,t){e[vd.DI_TARGET]===e?e[vd.DI_DEPENDENCIES].push({id:o,index:t}):(e[vd.DI_DEPENDENCIES]=[{id:o,index:t}],e[vd.DI_TARGET]=e)}function Q(o){if(vd.serviceIds.has(o))return vd.serviceIds.get(o);let e=function(t,n,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");tz(e,t,i)};return e.toString=()=>o,vd.serviceIds.set(o,e),e}var FZ=new Uint32Array(10);var BZ=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),WZ=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),VZ=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),HZ=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function VA(...o){return function(e,t){for(let n=0,i=o.length;n<i;n++){let r=o[n](e,t);if(r)return r}return null}}var $Z=HA.bind(void 0,!1),Uc=HA.bind(void 0,!0);function HA(o,e,t){if(!t||t.length<e.length)return null;let n;return o?n=fd(t,e):n=t.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}function nz(o,e){let t=e.toLowerCase().indexOf(o.toLowerCase());return t===-1?null:[{start:t,end:t+o.length}]}function iz(o,e){return fL(o.toLowerCase(),e.toLowerCase(),0,0)}function fL(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]===e[n]){let i=null;return(i=fL(o,e,t+1,n+1))?zA({start:n,end:n+1},i):null}return fL(o,e,t,n+1)}function IL(o){return 97<=o&&o<=122}function Mp(o){return 65<=o&&o<=90}function CL(o){return 48<=o&&o<=57}function oz(o){return o===32||o===9||o===10||o===13}var rz=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(o=>rz.add(o.charCodeAt(0)));function UA(o){return IL(o)||Mp(o)||CL(o)}function zA(o,e){return e.length===0?e=[o]:o.end===e[0].start?e[0].start=o.start:e.unshift(o),e}function KA(o,e){for(let t=e;t<o.length;t++){let n=o.charCodeAt(t);if(Mp(n)||CL(n)||t>0&&!UA(o.charCodeAt(t-1)))return t}return o.length}function bL(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]!==e[n].toLowerCase())return null;{let i=null,r=n+1;for(i=bL(o,e,t+1,n+1);!i&&(r=KA(e,r))<e.length;)i=bL(o,e,t+1,r),r++;return i===null?null:zA({start:n,end:n+1},i)}}function sz(o){let e=0,t=0,n=0,i=0,r=0;for(let c=0;c<o.length;c++)r=o.charCodeAt(c),Mp(r)&&e++,IL(r)&&t++,UA(r)&&n++,CL(r)&&i++;let s=e/o.length,a=t/o.length,l=n/o.length,d=i/o.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function az(o){let{upperPercent:e,lowerPercent:t}=o;return t===0&&e>.6}function lz(o){let{upperPercent:e,lowerPercent:t,alphaPercent:n,numericPercent:i}=o;return t>.2&&e<.8&&n>.6&&i<.2}function dz(o){let e=0,t=0,n=0,i=0;for(let r=0;r<o.length;r++)n=o.charCodeAt(r),Mp(n)&&e++,IL(n)&&t++,oz(n)&&i++;return(e===0||t===0)&&i===0?o.length<=30:e<=5}function GA(o,e){if(!e||(e=e.trim(),e.length===0)||!dz(o))return null;e.length>60&&(e=e.substring(0,60));let t=sz(e);if(!lz(t)){if(!az(t))return null;e=e.toLowerCase()}let n=null,i=0;for(o=o.toLowerCase();i<e.length&&(n=bL(o,e,0,i))===null;)i=KA(e,i+1);return n}var YZ=VA(Uc,GA,nz),ZZ=VA(Uc,GA,iz),QZ=new Qo(1e4);function jA(o,e){let t=Ny(o,o.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?qA(t):null}function qA(o){if(typeof o>"u")return[];let e=[],t=o[1];for(let n=o.length-1;n>1;n--){let i=o[n]+t,r=e[e.length-1];r&&r.end===i?r.end=i+1:e.push({start:i,end:i+1})}return e}var Id=128;function SL(){let o=[],e=[];for(let t=0;t<=Id;t++)e[t]=0;for(let t=0;t<=Id;t++)o.push(e.slice(0));return o}function $A(o){let e=[];for(let t=0;t<=o;t++)e[t]=0;return e}var YA=$A(2*Id),vL=$A(2*Id),ma=SL(),yd=SL(),Zg=SL(),cz=!1;function gL(o,e,t,n,i){function r(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${n.split("").map(a=>r(a,3)).join("|")}
`;for(let a=0;a<=t;a++)a===0?s+=" |":s+=`${e[a-1]}|`,s+=o[a].slice(0,i+1).map(l=>r(l.toString(),3)).join("|")+`
`;return s}function uz(o,e,t,n){o=o.substr(e),t=t.substr(n),console.log(gL(yd,o,o.length,t,t.length)),console.log(gL(Zg,o,o.length,t,t.length)),console.log(gL(ma,o,o.length,t,t.length))}function My(o,e){if(e<0||e>=o.length)return!1;let t=o.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!qg(t)}}function WA(o,e){if(e<0||e>=o.length)return!1;switch(o.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function Oy(o,e,t){return e[o]!==t[o]}function pz(o,e,t,n,i,r,s=!1){for(;e<t&&i<r;)o[e]===n[i]&&(s&&(YA[e]=i),e+=1),i+=1;return e===t}var zc;(t=>{t.Default=[-100,0];function e(n){return!n||n.length===2&&n[0]===-100&&n[1]===0}t.isDefault=e})(zc||={});var yL=class{constructor(e,t){this.firstMatchCanBeWeak=e;this.boostFullMatch=t}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function Ny(o,e,t,n,i,r,s=yL.default){let a=o.length>Id?Id:o.length,l=n.length>Id?Id:n.length;if(t>=a||r>=l||a-t>l-r||!pz(e,t,a,i,r,l,!0))return;hz(a,l,t,r,e,i);let d=1,c=1,u=t,p=r,h=[!1];for(d=1,u=t;u<a;d++,u++){let I=YA[u],T=vL[u],S=u+1<a?vL[u+1]:l;for(c=I-r+1,p=I;p<S;c++,p++){let C=Number.MIN_SAFE_INTEGER,w=!1;p<=T&&(C=mz(o,e,u,t,n,i,p,l,r,ma[d-1][c-1]===0,h));let x=0;C!==Number.MAX_SAFE_INTEGER&&(w=!0,x=C+yd[d-1][c-1]);let D=p>I,O=D?yd[d][c-1]+(ma[d][c-1]>0?-5:0):0,H=p>I+1&&ma[d][c-1]>0,K=H?yd[d][c-2]+(ma[d][c-2]>0?-5:0):0;if(H&&(!D||K>=O)&&(!w||K>=x))yd[d][c]=K,Zg[d][c]=3,ma[d][c]=0;else if(D&&(!w||O>=x))yd[d][c]=O,Zg[d][c]=2,ma[d][c]=0;else if(w)yd[d][c]=x,Zg[d][c]=1,ma[d][c]=ma[d-1][c-1]+1;else throw new Error("not possible")}}if(cz&&uz(o,t,n,r),!h[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let f=[yd[d][c],r],g=0,b=0;for(;d>=1;){let I=c;do{let T=Zg[d][I];if(T===3)I=I-2;else if(T===2)I=I-1;else break}while(I>=1);g>1&&e[t+d-1]===i[r+c-1]&&!Oy(I+r-1,n,i)&&g+1>ma[d][I]&&(I=c),I===c?g++:g=1,b||(b=I),d--,c=I-1,f.push(c)}l-r===a&&s.boostFullMatch&&(f[0]+=2);let v=b-a;return f[0]-=v,f}function hz(o,e,t,n,i,r){let s=o-1,a=e-1;for(;s>=t&&a>=n;)i[s]===r[a]&&(vL[s]=a,s--),a--}function mz(o,e,t,n,i,r,s,a,l,d,c){if(e[t]!==r[s])return Number.MIN_SAFE_INTEGER;let u=1,p=!1;return s===t-n?u=o[t]===i[s]?7:5:Oy(s,i,r)&&(s===0||!Oy(s-1,i,r))?(u=o[t]===i[s]?7:5,p=!0):My(r,s)&&(s===0||!My(r,s-1))?u=5:(My(r,s-1)||WA(r,s-1))&&(u=5,p=!0),u>1&&t===n&&(c[0]=!0),p||(p=Oy(s,i,r)||My(r,s-1)||WA(r,s-1)),t===n?s>l&&(u-=p?3:5):d?u+=p?2:0:u+=p?0:1,s+1===a&&(u-=p?3:5),u}var EL=Object.create(null);function y(o,e){if(En(e)){let t=EL[e];if(t===void 0)throw new Error(`${o} references an unknown codicon: ${e}`);e=t}return EL[o]=e,{id:o}}function TL(){return EL}var ZA={add:y("add",6e4),plus:y("plus",6e4),gistNew:y("gist-new",6e4),repoCreate:y("repo-create",6e4),lightbulb:y("lightbulb",60001),lightBulb:y("light-bulb",60001),repo:y("repo",60002),repoDelete:y("repo-delete",60002),gistFork:y("gist-fork",60003),repoForked:y("repo-forked",60003),gitPullRequest:y("git-pull-request",60004),gitPullRequestAbandoned:y("git-pull-request-abandoned",60004),recordKeys:y("record-keys",60005),keyboard:y("keyboard",60005),tag:y("tag",60006),gitPullRequestLabel:y("git-pull-request-label",60006),tagAdd:y("tag-add",60006),tagRemove:y("tag-remove",60006),person:y("person",60007),personFollow:y("person-follow",60007),personOutline:y("person-outline",60007),personFilled:y("person-filled",60007),gitBranch:y("git-branch",60008),gitBranchCreate:y("git-branch-create",60008),gitBranchDelete:y("git-branch-delete",60008),sourceControl:y("source-control",60008),mirror:y("mirror",60009),mirrorPublic:y("mirror-public",60009),star:y("star",60010),starAdd:y("star-add",60010),starDelete:y("star-delete",60010),starEmpty:y("star-empty",60010),comment:y("comment",60011),commentAdd:y("comment-add",60011),alert:y("alert",60012),warning:y("warning",60012),search:y("search",60013),searchSave:y("search-save",60013),logOut:y("log-out",60014),signOut:y("sign-out",60014),logIn:y("log-in",60015),signIn:y("sign-in",60015),eye:y("eye",60016),eyeUnwatch:y("eye-unwatch",60016),eyeWatch:y("eye-watch",60016),circleFilled:y("circle-filled",60017),primitiveDot:y("primitive-dot",60017),closeDirty:y("close-dirty",60017),debugBreakpoint:y("debug-breakpoint",60017),debugBreakpointDisabled:y("debug-breakpoint-disabled",60017),debugHint:y("debug-hint",60017),terminalDecorationSuccess:y("terminal-decoration-success",60017),primitiveSquare:y("primitive-square",60018),edit:y("edit",60019),pencil:y("pencil",60019),info:y("info",60020),issueOpened:y("issue-opened",60020),gistPrivate:y("gist-private",60021),gitForkPrivate:y("git-fork-private",60021),lock:y("lock",60021),mirrorPrivate:y("mirror-private",60021),close:y("close",60022),removeClose:y("remove-close",60022),x:y("x",60022),repoSync:y("repo-sync",60023),sync:y("sync",60023),clone:y("clone",60024),desktopDownload:y("desktop-download",60024),beaker:y("beaker",60025),microscope:y("microscope",60025),vm:y("vm",60026),deviceDesktop:y("device-desktop",60026),file:y("file",60027),fileText:y("file-text",60027),more:y("more",60028),ellipsis:y("ellipsis",60028),kebabHorizontal:y("kebab-horizontal",60028),mailReply:y("mail-reply",60029),reply:y("reply",60029),organization:y("organization",60030),organizationFilled:y("organization-filled",60030),organizationOutline:y("organization-outline",60030),newFile:y("new-file",60031),fileAdd:y("file-add",60031),newFolder:y("new-folder",60032),fileDirectoryCreate:y("file-directory-create",60032),trash:y("trash",60033),trashcan:y("trashcan",60033),history:y("history",60034),clock:y("clock",60034),folder:y("folder",60035),fileDirectory:y("file-directory",60035),symbolFolder:y("symbol-folder",60035),logoGithub:y("logo-github",60036),markGithub:y("mark-github",60036),github:y("github",60036),terminal:y("terminal",60037),console:y("console",60037),repl:y("repl",60037),zap:y("zap",60038),symbolEvent:y("symbol-event",60038),error:y("error",60039),stop:y("stop",60039),variable:y("variable",60040),symbolVariable:y("symbol-variable",60040),array:y("array",60042),symbolArray:y("symbol-array",60042),symbolModule:y("symbol-module",60043),symbolPackage:y("symbol-package",60043),symbolNamespace:y("symbol-namespace",60043),symbolObject:y("symbol-object",60043),symbolMethod:y("symbol-method",60044),symbolFunction:y("symbol-function",60044),symbolConstructor:y("symbol-constructor",60044),symbolBoolean:y("symbol-boolean",60047),symbolNull:y("symbol-null",60047),symbolNumeric:y("symbol-numeric",60048),symbolNumber:y("symbol-number",60048),symbolStructure:y("symbol-structure",60049),symbolStruct:y("symbol-struct",60049),symbolParameter:y("symbol-parameter",60050),symbolTypeParameter:y("symbol-type-parameter",60050),symbolKey:y("symbol-key",60051),symbolText:y("symbol-text",60051),symbolReference:y("symbol-reference",60052),goToFile:y("go-to-file",60052),symbolEnum:y("symbol-enum",60053),symbolValue:y("symbol-value",60053),symbolRuler:y("symbol-ruler",60054),symbolUnit:y("symbol-unit",60054),activateBreakpoints:y("activate-breakpoints",60055),archive:y("archive",60056),arrowBoth:y("arrow-both",60057),arrowDown:y("arrow-down",60058),arrowLeft:y("arrow-left",60059),arrowRight:y("arrow-right",60060),arrowSmallDown:y("arrow-small-down",60061),arrowSmallLeft:y("arrow-small-left",60062),arrowSmallRight:y("arrow-small-right",60063),arrowSmallUp:y("arrow-small-up",60064),arrowUp:y("arrow-up",60065),bell:y("bell",60066),bold:y("bold",60067),book:y("book",60068),bookmark:y("bookmark",60069),debugBreakpointConditionalUnverified:y("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:y("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:y("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:y("debug-breakpoint-data-unverified",60072),debugBreakpointData:y("debug-breakpoint-data",60073),debugBreakpointDataDisabled:y("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:y("debug-breakpoint-log-unverified",60074),debugBreakpointLog:y("debug-breakpoint-log",60075),debugBreakpointLogDisabled:y("debug-breakpoint-log-disabled",60075),briefcase:y("briefcase",60076),broadcast:y("broadcast",60077),browser:y("browser",60078),bug:y("bug",60079),calendar:y("calendar",60080),caseSensitive:y("case-sensitive",60081),check:y("check",60082),checklist:y("checklist",60083),chevronDown:y("chevron-down",60084),chevronLeft:y("chevron-left",60085),chevronRight:y("chevron-right",60086),chevronUp:y("chevron-up",60087),chromeClose:y("chrome-close",60088),chromeMaximize:y("chrome-maximize",60089),chromeMinimize:y("chrome-minimize",60090),chromeRestore:y("chrome-restore",60091),circleOutline:y("circle-outline",60092),circle:y("circle",60092),debugBreakpointUnverified:y("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:y("terminal-decoration-incomplete",60092),circleSlash:y("circle-slash",60093),circuitBoard:y("circuit-board",60094),clearAll:y("clear-all",60095),clippy:y("clippy",60096),closeAll:y("close-all",60097),cloudDownload:y("cloud-download",60098),cloudUpload:y("cloud-upload",60099),code:y("code",60100),collapseAll:y("collapse-all",60101),colorMode:y("color-mode",60102),commentDiscussion:y("comment-discussion",60103),creditCard:y("credit-card",60105),dash:y("dash",60108),dashboard:y("dashboard",60109),database:y("database",60110),debugContinue:y("debug-continue",60111),debugDisconnect:y("debug-disconnect",60112),debugPause:y("debug-pause",60113),debugRestart:y("debug-restart",60114),debugStart:y("debug-start",60115),debugStepInto:y("debug-step-into",60116),debugStepOut:y("debug-step-out",60117),debugStepOver:y("debug-step-over",60118),debugStop:y("debug-stop",60119),debug:y("debug",60120),deviceCameraVideo:y("device-camera-video",60121),deviceCamera:y("device-camera",60122),deviceMobile:y("device-mobile",60123),diffAdded:y("diff-added",60124),diffIgnored:y("diff-ignored",60125),diffModified:y("diff-modified",60126),diffRemoved:y("diff-removed",60127),diffRenamed:y("diff-renamed",60128),diff:y("diff",60129),diffSidebyside:y("diff-sidebyside",60129),discard:y("discard",60130),editorLayout:y("editor-layout",60131),emptyWindow:y("empty-window",60132),exclude:y("exclude",60133),extensions:y("extensions",60134),eyeClosed:y("eye-closed",60135),fileBinary:y("file-binary",60136),fileCode:y("file-code",60137),fileMedia:y("file-media",60138),filePdf:y("file-pdf",60139),fileSubmodule:y("file-submodule",60140),fileSymlinkDirectory:y("file-symlink-directory",60141),fileSymlinkFile:y("file-symlink-file",60142),fileZip:y("file-zip",60143),files:y("files",60144),filter:y("filter",60145),flame:y("flame",60146),foldDown:y("fold-down",60147),foldUp:y("fold-up",60148),fold:y("fold",60149),folderActive:y("folder-active",60150),folderOpened:y("folder-opened",60151),gear:y("gear",60152),gift:y("gift",60153),gistSecret:y("gist-secret",60154),gist:y("gist",60155),gitCommit:y("git-commit",60156),gitCompare:y("git-compare",60157),compareChanges:y("compare-changes",60157),gitMerge:y("git-merge",60158),githubAction:y("github-action",60159),githubAlt:y("github-alt",60160),globe:y("globe",60161),grabber:y("grabber",60162),graph:y("graph",60163),gripper:y("gripper",60164),heart:y("heart",60165),home:y("home",60166),horizontalRule:y("horizontal-rule",60167),hubot:y("hubot",60168),inbox:y("inbox",60169),issueReopened:y("issue-reopened",60171),issues:y("issues",60172),italic:y("italic",60173),jersey:y("jersey",60174),json:y("json",60175),kebabVertical:y("kebab-vertical",60176),key:y("key",60177),law:y("law",60178),lightbulbAutofix:y("lightbulb-autofix",60179),linkExternal:y("link-external",60180),link:y("link",60181),listOrdered:y("list-ordered",60182),listUnordered:y("list-unordered",60183),liveShare:y("live-share",60184),loading:y("loading",60185),location:y("location",60186),mailRead:y("mail-read",60187),mail:y("mail",60188),markdown:y("markdown",60189),megaphone:y("megaphone",60190),mention:y("mention",60191),milestone:y("milestone",60192),gitPullRequestMilestone:y("git-pull-request-milestone",60192),mortarBoard:y("mortar-board",60193),move:y("move",60194),multipleWindows:y("multiple-windows",60195),mute:y("mute",60196),noNewline:y("no-newline",60197),note:y("note",60198),octoface:y("octoface",60199),openPreview:y("open-preview",60200),package:y("package",60201),paintcan:y("paintcan",60202),pin:y("pin",60203),play:y("play",60204),run:y("run",60204),plug:y("plug",60205),preserveCase:y("preserve-case",60206),preview:y("preview",60207),project:y("project",60208),pulse:y("pulse",60209),question:y("question",60210),quote:y("quote",60211),radioTower:y("radio-tower",60212),reactions:y("reactions",60213),references:y("references",60214),refresh:y("refresh",60215),regex:y("regex",60216),remoteExplorer:y("remote-explorer",60217),remote:y("remote",60218),remove:y("remove",60219),replaceAll:y("replace-all",60220),replace:y("replace",60221),repoClone:y("repo-clone",60222),repoForcePush:y("repo-force-push",60223),repoPull:y("repo-pull",60224),repoPush:y("repo-push",60225),report:y("report",60226),requestChanges:y("request-changes",60227),rocket:y("rocket",60228),rootFolderOpened:y("root-folder-opened",60229),rootFolder:y("root-folder",60230),rss:y("rss",60231),ruby:y("ruby",60232),saveAll:y("save-all",60233),saveAs:y("save-as",60234),save:y("save",60235),screenFull:y("screen-full",60236),screenNormal:y("screen-normal",60237),searchStop:y("search-stop",60238),server:y("server",60240),settingsGear:y("settings-gear",60241),settings:y("settings",60242),shield:y("shield",60243),smiley:y("smiley",60244),sortPrecedence:y("sort-precedence",60245),splitHorizontal:y("split-horizontal",60246),splitVertical:y("split-vertical",60247),squirrel:y("squirrel",60248),starFull:y("star-full",60249),starHalf:y("star-half",60250),symbolClass:y("symbol-class",60251),symbolColor:y("symbol-color",60252),symbolConstant:y("symbol-constant",60253),symbolEnumMember:y("symbol-enum-member",60254),symbolField:y("symbol-field",60255),symbolFile:y("symbol-file",60256),symbolInterface:y("symbol-interface",60257),symbolKeyword:y("symbol-keyword",60258),symbolMisc:y("symbol-misc",60259),symbolOperator:y("symbol-operator",60260),symbolProperty:y("symbol-property",60261),wrench:y("wrench",60261),wrenchSubaction:y("wrench-subaction",60261),symbolSnippet:y("symbol-snippet",60262),tasklist:y("tasklist",60263),telescope:y("telescope",60264),textSize:y("text-size",60265),threeBars:y("three-bars",60266),thumbsdown:y("thumbsdown",60267),thumbsup:y("thumbsup",60268),tools:y("tools",60269),triangleDown:y("triangle-down",60270),triangleLeft:y("triangle-left",60271),triangleRight:y("triangle-right",60272),triangleUp:y("triangle-up",60273),twitter:y("twitter",60274),unfold:y("unfold",60275),unlock:y("unlock",60276),unmute:y("unmute",60277),unverified:y("unverified",60278),verified:y("verified",60279),versions:y("versions",60280),vmActive:y("vm-active",60281),vmOutline:y("vm-outline",60282),vmRunning:y("vm-running",60283),watch:y("watch",60284),whitespace:y("whitespace",60285),wholeWord:y("whole-word",60286),window:y("window",60287),wordWrap:y("word-wrap",60288),zoomIn:y("zoom-in",60289),zoomOut:y("zoom-out",60290),listFilter:y("list-filter",60291),listFlat:y("list-flat",60292),listSelection:y("list-selection",60293),selection:y("selection",60293),listTree:y("list-tree",60294),debugBreakpointFunctionUnverified:y("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:y("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:y("debug-breakpoint-function-disabled",60296),debugStackframeActive:y("debug-stackframe-active",60297),circleSmallFilled:y("circle-small-filled",60298),debugStackframeDot:y("debug-stackframe-dot",60298),terminalDecorationMark:y("terminal-decoration-mark",60298),debugStackframe:y("debug-stackframe",60299),debugStackframeFocused:y("debug-stackframe-focused",60299),debugBreakpointUnsupported:y("debug-breakpoint-unsupported",60300),symbolString:y("symbol-string",60301),debugReverseContinue:y("debug-reverse-continue",60302),debugStepBack:y("debug-step-back",60303),debugRestartFrame:y("debug-restart-frame",60304),debugAlt:y("debug-alt",60305),callIncoming:y("call-incoming",60306),callOutgoing:y("call-outgoing",60307),menu:y("menu",60308),expandAll:y("expand-all",60309),feedback:y("feedback",60310),gitPullRequestReviewer:y("git-pull-request-reviewer",60310),groupByRefType:y("group-by-ref-type",60311),ungroupByRefType:y("ungroup-by-ref-type",60312),account:y("account",60313),gitPullRequestAssignee:y("git-pull-request-assignee",60313),bellDot:y("bell-dot",60314),debugConsole:y("debug-console",60315),library:y("library",60316),output:y("output",60317),runAll:y("run-all",60318),syncIgnored:y("sync-ignored",60319),pinned:y("pinned",60320),githubInverted:y("github-inverted",60321),serverProcess:y("server-process",60322),serverEnvironment:y("server-environment",60323),pass:y("pass",60324),issueClosed:y("issue-closed",60324),stopCircle:y("stop-circle",60325),playCircle:y("play-circle",60326),record:y("record",60327),debugAltSmall:y("debug-alt-small",60328),vmConnect:y("vm-connect",60329),cloud:y("cloud",60330),merge:y("merge",60331),export:y("export",60332),graphLeft:y("graph-left",60333),magnet:y("magnet",60334),notebook:y("notebook",60335),redo:y("redo",60336),checkAll:y("check-all",60337),pinnedDirty:y("pinned-dirty",60338),passFilled:y("pass-filled",60339),circleLargeFilled:y("circle-large-filled",60340),circleLarge:y("circle-large",60341),circleLargeOutline:y("circle-large-outline",60341),combine:y("combine",60342),gather:y("gather",60342),table:y("table",60343),variableGroup:y("variable-group",60344),typeHierarchy:y("type-hierarchy",60345),typeHierarchySub:y("type-hierarchy-sub",60346),typeHierarchySuper:y("type-hierarchy-super",60347),gitPullRequestCreate:y("git-pull-request-create",60348),runAbove:y("run-above",60349),runBelow:y("run-below",60350),notebookTemplate:y("notebook-template",60351),debugRerun:y("debug-rerun",60352),workspaceTrusted:y("workspace-trusted",60353),workspaceUntrusted:y("workspace-untrusted",60354),workspaceUnknown:y("workspace-unknown",60355),terminalCmd:y("terminal-cmd",60356),terminalDebian:y("terminal-debian",60357),terminalLinux:y("terminal-linux",60358),terminalPowershell:y("terminal-powershell",60359),terminalTmux:y("terminal-tmux",60360),terminalUbuntu:y("terminal-ubuntu",60361),terminalBash:y("terminal-bash",60362),arrowSwap:y("arrow-swap",60363),copy:y("copy",60364),personAdd:y("person-add",60365),filterFilled:y("filter-filled",60366),wand:y("wand",60367),debugLineByLine:y("debug-line-by-line",60368),inspect:y("inspect",60369),layers:y("layers",60370),layersDot:y("layers-dot",60371),layersActive:y("layers-active",60372),compass:y("compass",60373),compassDot:y("compass-dot",60374),compassActive:y("compass-active",60375),azure:y("azure",60376),issueDraft:y("issue-draft",60377),gitPullRequestClosed:y("git-pull-request-closed",60378),gitPullRequestDraft:y("git-pull-request-draft",60379),debugAll:y("debug-all",60380),debugCoverage:y("debug-coverage",60381),runErrors:y("run-errors",60382),folderLibrary:y("folder-library",60383),debugContinueSmall:y("debug-continue-small",60384),beakerStop:y("beaker-stop",60385),graphLine:y("graph-line",60386),graphScatter:y("graph-scatter",60387),pieChart:y("pie-chart",60388),bracket:y("bracket",60175),bracketDot:y("bracket-dot",60389),bracketError:y("bracket-error",60390),lockSmall:y("lock-small",60391),azureDevops:y("azure-devops",60392),verifiedFilled:y("verified-filled",60393),newline:y("newline",60394),layout:y("layout",60395),layoutActivitybarLeft:y("layout-activitybar-left",60396),layoutActivitybarRight:y("layout-activitybar-right",60397),layoutPanelLeft:y("layout-panel-left",60398),layoutPanelCenter:y("layout-panel-center",60399),layoutPanelJustify:y("layout-panel-justify",60400),layoutPanelRight:y("layout-panel-right",60401),layoutPanel:y("layout-panel",60402),layoutSidebarLeft:y("layout-sidebar-left",60403),layoutSidebarRight:y("layout-sidebar-right",60404),layoutStatusbar:y("layout-statusbar",60405),layoutMenubar:y("layout-menubar",60406),layoutCentered:y("layout-centered",60407),target:y("target",60408),indent:y("indent",60409),recordSmall:y("record-small",60410),errorSmall:y("error-small",60411),terminalDecorationError:y("terminal-decoration-error",60411),arrowCircleDown:y("arrow-circle-down",60412),arrowCircleLeft:y("arrow-circle-left",60413),arrowCircleRight:y("arrow-circle-right",60414),arrowCircleUp:y("arrow-circle-up",60415),layoutSidebarRightOff:y("layout-sidebar-right-off",60416),layoutPanelOff:y("layout-panel-off",60417),layoutSidebarLeftOff:y("layout-sidebar-left-off",60418),blank:y("blank",60419),heartFilled:y("heart-filled",60420),map:y("map",60421),mapHorizontal:y("map-horizontal",60421),foldHorizontal:y("fold-horizontal",60421),mapFilled:y("map-filled",60422),mapHorizontalFilled:y("map-horizontal-filled",60422),foldHorizontalFilled:y("fold-horizontal-filled",60422),circleSmall:y("circle-small",60423),bellSlash:y("bell-slash",60424),bellSlashDot:y("bell-slash-dot",60425),commentUnresolved:y("comment-unresolved",60426),gitPullRequestGoToChanges:y("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:y("git-pull-request-new-changes",60428),searchFuzzy:y("search-fuzzy",60429),commentDraft:y("comment-draft",60430),send:y("send",60431),sparkle:y("sparkle",60432),insert:y("insert",60433),mic:y("mic",60434),thumbsdownFilled:y("thumbsdown-filled",60435),thumbsupFilled:y("thumbsup-filled",60436),coffee:y("coffee",60437),snake:y("snake",60438),game:y("game",60439),vr:y("vr",60440),chip:y("chip",60441),piano:y("piano",60442),music:y("music",60443),micFilled:y("mic-filled",60444),repoFetch:y("repo-fetch",60445),copilot:y("copilot",60446),lightbulbSparkle:y("lightbulb-sparkle",60447),robot:y("robot",60448),sparkleFilled:y("sparkle-filled",60449),diffSingle:y("diff-single",60450),diffMultiple:y("diff-multiple",60451),surroundWith:y("surround-with",60452),share:y("share",60453),gitStash:y("git-stash",60454),gitStashApply:y("git-stash-apply",60455),gitStashPop:y("git-stash-pop",60456),vscode:y("vscode",60457),vscodeInsiders:y("vscode-insiders",60458),codeOss:y("code-oss",60459),runCoverage:y("run-coverage",60460),runAllCoverage:y("run-all-coverage",60461),coverage:y("coverage",60462),githubProject:y("github-project",60463),mapVertical:y("map-vertical",60464),foldVertical:y("fold-vertical",60464),mapVerticalFilled:y("map-vertical-filled",60465),foldVerticalFilled:y("fold-vertical-filled",60465),goToSearch:y("go-to-search",60466),percentage:y("percentage",60467),sortPercentage:y("sort-percentage",60467),attach:y("attach",60468)};var gz={dialogError:y("dialog-error","error"),dialogWarning:y("dialog-warning","warning"),dialogInfo:y("dialog-info","info"),dialogClose:y("dialog-close","close"),treeItemExpanded:y("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:y("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:y("tree-filter-on-type-off","list-selection"),treeFilterClear:y("tree-filter-clear","close"),treeItemLoading:y("tree-item-loading","loading"),menuSelection:y("menu-selection","check"),menuSubmenu:y("menu-submenu","chevron-right"),menuBarMore:y("menubar-more","more"),scrollbarButtonLeft:y("scrollbar-button-left","triangle-left"),scrollbarButtonRight:y("scrollbar-button-right","triangle-right"),scrollbarButtonUp:y("scrollbar-button-up","triangle-up"),scrollbarButtonDown:y("scrollbar-button-down","triangle-down"),toolBarMore:y("toolbar-more","more"),quickInputBack:y("quick-input-back","arrow-left"),dropDownButton:y("drop-down-button",60084),symbolCustomColor:y("symbol-customcolor",60252),exportIcon:y("export",60332),workspaceUnspecified:y("workspace-unspecified",60355),newLine:y("newline",60394),thumbsDownFilled:y("thumbsdown-filled",60435),thumbsUpFilled:y("thumbsup-filled",60436),gitFetch:y("git-fetch",60445),lightbulbSparkleAutofix:y("lightbulb-sparkle-autofix",60447),debugBreakpointPending:y("debug-breakpoint-pending",60377)},ae={...ZA,...gz};var QA;(e=>{function o(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=o})(QA||={});var Be;(g=>{g.iconNameSegment="[A-Za-z0-9]+",g.iconNameExpression="[A-Za-z0-9-]+",g.iconModifierExpression="~[A-Za-z]+",g.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${g.iconNameExpression})(${g.iconModifierExpression})?$`);function r(b){let v=i.exec(b.id);if(!v)return r(ae.error);let[,I,T]=v,S=["codicon","codicon-"+I];return T&&S.push("codicon-modifier-"+T.substring(1)),S}g.asClassNameArray=r;function s(b){return r(b).join(" ")}g.asClassName=s;function a(b){return"."+r(b).join(".")}g.asCSSSelector=a;function l(b){return b&&typeof b=="object"&&typeof b.id=="string"&&(typeof b.color>"u"||QA.isThemeColor(b.color))}g.isThemeIcon=l;let d=new RegExp(`^\\$\\((${g.iconNameExpression}(?:${g.iconModifierExpression})?)\\)$`);function c(b){let v=d.exec(b);if(!v)return;let[,I]=v;return{id:I}}g.fromString=c;function u(b){return{id:b}}g.fromId=u;function p(b,v){let I=b.id,T=I.lastIndexOf("~");return T!==-1&&(I=I.substring(0,T)),v&&(I=`${I}~${v}`),{id:I}}g.modify=p;function h(b){let v=b.id.lastIndexOf("~");if(v!==-1)return b.id.substring(v+1)}g.getModifier=h;function f(b,v){return b.id===v.id&&b.color?.id===v.color?.id}g.isEqual=f})(Be||={});var wL=new RegExp(`\\$\\(${Be.iconNameExpression}(?:${Be.iconModifierExpression})?\\)`,"g"),fz=new RegExp(`(\\\\)?${wL.source}`,"g");function XA(o){return o.replace(fz,(e,t)=>t?e:`\\${e}`)}var bz=new RegExp(`\\\\${wL.source}`,"g");function JA(o){return o.replace(bz,e=>`\\${e}`)}var bQ=new RegExp(`(\\s)?(\\\\)?${wL.source}(\\s)?`,"g");var vQ=new RegExp(`\\$\\(${Be.iconNameCharacter}+\\)`,"g");function Cd(o){return o===47||o===92}function Ay(o){return o.replace(/[\\/]/g,bt.sep)}function tP(o){return o.indexOf("/")===-1&&(o=Ay(o)),/^[a-zA-Z]:(\/|$)/.test(o)&&(o="/"+o),o}function xL(o,e=bt.sep){if(!o)return"";let t=o.length,n=o.charCodeAt(0);if(Cd(n)){if(Cd(o.charCodeAt(1))&&!Cd(o.charCodeAt(2))){let r=3,s=r;for(;r<t&&!Cd(o.charCodeAt(r));r++);if(s!==r&&!Cd(o.charCodeAt(r+1))){for(r+=1;r<t;r++)if(Cd(o.charCodeAt(r)))return o.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(iP(n)&&o.charCodeAt(1)===58)return Cd(o.charCodeAt(2))?o.slice(0,2)+e:o.slice(0,2);let i=o.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(Cd(o.charCodeAt(i)))return o.slice(0,i+1)}return""}var vz=/[\\/:\*\?"<>\|]/g,yz=/[/]/g,Iz=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function nP(o,e=pt){let t=e?vz:yz;return!(!o||o.length===0||/^\s+$/.test(o)||(t.lastIndex=0,t.test(o))||e&&Iz.test(o)||o==="."||o===".."||e&&o[o.length-1]==="."||e&&o.length!==o.trim().length||o.length>255)}function Qg(o,e,t,n=si){if(o===e)return!0;if(!o||!e||e.length>o.length)return!1;if(t){if(!fd(o,e))return!1;if(e.length===o.length)return!0;let r=e.length;return e.charAt(e.length-1)===n&&r--,o.charAt(r)===n}return e.charAt(e.length-1)!==n&&(e+=n),o.indexOf(e)===0}function iP(o){return o>=65&&o<=90||o>=97&&o<=122}function oP(o,e=pt){return e?iP(o.charCodeAt(0))&&o.charCodeAt(1)===58:!1}function rP(o,e=pt){return oP(o,e)?o[0]:void 0}function sP(o,e,t){return e.length>o.length?-1:o===e?0:(t&&(o=o.toLowerCase(),e=e.toLowerCase()),o.indexOf(e))}function aP(o){let e=o.split(":"),t,n,i;for(let r of e){let s=Number(r);Ui(s)?n===void 0?n=s:i===void 0&&(i=s):t=t?[t,r].join(":"):r}if(!t)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:t,line:n!==void 0?n:void 0,column:i!==void 0?i:n!==void 0?1:void 0}}function vl(o){return Lg(o,!0)}var Xg=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:rL(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===xe.file)return Qg(vl(e),vl(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if(lP(e.authority,t.authority))return Qg(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return te.joinPath(e,...t)}basenameOrAuthority(e){return Jo(e)||e.authority}basename(e){return bt.basename(e.path)}extname(e){return bt.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===xe.file?t=te.file(Xv(vl(e))).path:(t=bt.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===xe.file?t=te.file(ad(vl(e))).path:t=bt.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!lP(e.authority,t.authority))return;if(e.scheme===xe.file){let r=FN(vl(e),vl(t));return pt?Ay(r):r}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(let s=Math.min(n.length,i.length);r<s&&!(n.charCodeAt(r)!==i.charCodeAt(r)&&n.charAt(r).toLowerCase()!==i.charAt(r).toLowerCase());r++);n=i.substr(0,r)+n.substr(r)}return bt.relative(n,i)}resolvePath(e,t){if(e.scheme===xe.file){let n=te.file(fp(vl(e),t));return e.with({authority:n.authority,path:n.path})}return t=tP(t),e.with({path:bt.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Lr(e,t)}hasTrailingPathSeparator(e,t=si){if(e.scheme===xe.file){let n=vl(e);return n.length>xL(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=si){return dP(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=si){let n=!1;if(e.scheme===xe.file){let i=vl(e);n=i!==void 0&&i.length===xL(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!dP(e,t)?e.with({path:e.path+"/"}):e}},Pt=new Xg(()=>!1),Sz=new Xg(o=>o.scheme===xe.file?!Wt:!0),Ez=new Xg(o=>!0),Qi=Pt.isEqual.bind(Pt),kQ=Pt.isEqualOrParent.bind(Pt),RQ=Pt.getComparisonKey.bind(Pt),Py=Pt.basenameOrAuthority.bind(Pt),Jo=Pt.basename.bind(Pt),Fy=Pt.extname.bind(Pt),Op=Pt.dirname.bind(Pt),It=Pt.joinPath.bind(Pt),MQ=Pt.normalizePath.bind(Pt),By=Pt.relativePath.bind(Pt),_L=Pt.resolvePath.bind(Pt),OQ=Pt.isAbsolutePath.bind(Pt),lP=Pt.isEqualAuthority.bind(Pt),dP=Pt.hasTrailingPathSeparator.bind(Pt),NQ=Pt.removeTrailingPathSeparator.bind(Pt),AQ=Pt.addTrailingPathSeparator.bind(Pt);var Np;(r=>{r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[u,p]=c.split(":");u&&p&&a.set(u,p)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(r.META_DATA_MIME,d),a}r.parseMetaData=i})(Np||={});var Ap=class{value;isTrusted;supportThemeIcons;supportHtml;baseUri;constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw _c("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=Tz(this.supportThemeIcons?XA(e):e).replace(/([ \t]+)/g,(n,i)=>"&nbsp;".repeat(i.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${wz(t,e)}
`,this}appendLink(e,t,n){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),n&&(this.value+=` "${this._escape(this._escape(n,'"'),")")}"`),this.value+=")",this}_escape(e,t){let n=new RegExp(fo(t),"g");return e.replace(n,(i,r)=>e.charAt(r-1)!=="\\"?`\\${i}`:i)}};function Tz(o){return o.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function wz(o,e){let t=o.match(/^`+/gm)?.reduce((i,r)=>i.length>r.length?i:r).length??0,n=t>=3?t+1:3;return[`${"`".repeat(n)}${e}`,o,`${"`".repeat(n)}`].join(`
`)}function Jg(o){return o.replace(/"/g,"&quot;")}function Wy(o){return o&&o.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function cP(o){let e=[],t=o.split("|").map(i=>i.trim());o=t[0];let n=t[1];if(n){let i=/height=(\d+)/.exec(n),r=/width=(\d+)/.exec(n),s=i?i[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&e.push(`width="${a}"`),d&&e.push(`height="${s}"`)}return{href:o,dimensions:e}}function uP(o){let e=!1,t=new Map,n=new Map;if(xz(o,c=>{if(o===c)return!0;let u=JSON.stringify(c);if(u.length<30)return!0;let p=t.get(u);if(!p){let h={schemas:[c]};return t.set(u,h),n.set(c,h),!0}return p.schemas.push(c),n.set(c,p),e=!0,!1}),t.clear(),!e)return JSON.stringify(o);let r="$defs";for(;o.hasOwnProperty(r);)r+="_";let s=[];function a(c){return JSON.stringify(c,(u,p)=>{if(p!==c){let h=n.get(p);if(h&&h.schemas.length>1)return h.id||(h.id=`_${s.length}`,s.push(h.schemas[0])),{$ref:`#/${r}/${h.id}`}}return p})}let l=a(o),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${r}":{${d.join(",")}}}`:l}function Pp(o){return typeof o=="object"&&o!==null}function xz(o,e){if(!o||typeof o!="object")return;let t=(...l)=>{for(let d of l)Pp(d)&&s.push(d)},n=(...l)=>{for(let d of l)if(Pp(d))for(let c in d){let u=d[c];Pp(u)&&s.push(u)}},i=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)Pp(c)&&s.push(c)},r=l=>{if(Array.isArray(l))for(let d of l)Pp(d)&&s.push(d);else Pp(l)&&s.push(l)},s=[o],a=s.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),i(a.anyOf,a.allOf,a.oneOf,a.prefixItems),r(a.items)),a=s.pop()}function Sd(o){if(!o||typeof o!="object"||o instanceof RegExp)return o;let e=Array.isArray(o)?[]:{};return Object.entries(o).forEach(([t,n])=>{e[t]=n&&typeof n=="object"?Sd(n):n}),e}var _z=Object.prototype.hasOwnProperty;function pP(o,e){return LL(o,e,new Set)}function LL(o,e,t){if(zi(o))return o;let n=e(o);if(typeof n<"u")return n;if(Array.isArray(o)){let i=[];for(let r of o)i.push(LL(r,e,t));return i}if(bn(o)){if(t.has(o))throw new Error("Cannot clone recursive data-structure");t.add(o);let i={};for(let r in o)_z.call(o,r)&&(i[r]=LL(o[r],e,t));return t.delete(o),i}return o}function Ei(o,e){if(o===e)return!0;if(o==null||e===null||e===void 0||typeof o!=typeof e||typeof o!="object"||Array.isArray(o)!==Array.isArray(e))return!1;let t,n;if(Array.isArray(o)){if(o.length!==e.length)return!1;for(t=0;t<o.length;t++)if(!Ei(o[t],e[t]))return!1}else{let i=[];for(n in o)i.push(n);i.sort();let r=[];for(n in e)r.push(n);if(r.sort(),!Ei(i,r))return!1;for(t=0;t<i.length;t++)if(!Ei(o[i[t]],e[i[t]]))return!1}return!0}function hP(o,e){let t=Object.create(null);return!o||!e||Object.keys(e).forEach(i=>{let r=o[i],s=e[i];Ei(r,s)||(t[i]=s)}),t}var kL=class o{constructor(e,t,n,i,r,s,a){this._forceIntegerValues=e;this._forceIntegerValues&&(t=t|0,n=n|0,i=i|0,r=r|0,s=s|0,a=a|0),this.rawScrollLeft=i,this.rawScrollTop=a,t<0&&(t=0),i+t>n&&(i=n-t),i<0&&(i=0),r<0&&(r=0),a+r>s&&(a=s-r),a<0&&(a=0),this.width=t,this.scrollWidth=n,this.scrollLeft=i,this.height=r,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new o(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new o(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){let n=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:i,scrollLeftChanged:r,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},Es=class extends F{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new k);onScroll=this._onScroll.event;constructor(e){super(),this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new kL(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let n=this._state.withScrollDimensions(e,t);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let n=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;t?i=new Hy(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):i=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{let n=this._state.withScrollPosition(e);this._smoothScrolling=Hy.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let n=this._state;n.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(n,t)))}},Vy=class{scrollLeft;scrollTop;isDone;constructor(e,t,n){this.scrollLeft=e,this.scrollTop=t,this.isDone=n}};function DL(o,e){let t=e-o;return function(n){return o+t*kz(n)}}function Lz(o,e,t){return function(n){return n<t?o(n/t):e((n-t)/(1-t))}}var Hy=class o{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(e,t,n,i){this.from=e,this.to=t,this.duration=i,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,n){if(Math.abs(e-t)>2.5*n){let r,s;return e<t?(r=e+.75*n,s=t-.75*n):(r=e-.75*n,s=t+.75*n),Lz(DL(e,r),DL(s,t),.33)}return DL(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let t=(e-this.startTime)/this.duration;if(t<1){let n=this.scrollLeft(t),i=this.scrollTop(t);return new Vy(n,i,!1)}return new Vy(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,n){return o.start(e,t,n)}static start(e,t,n){n=n+10;let i=Date.now()-10;return new o(e,t,i,n)}};function Dz(o){return Math.pow(o,3)}function kz(o){return 1-Dz(1-o)}var ga=new class{_zoomLevel=0;_onDidChangeZoomLevel=new k;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(o){o=Math.min(Math.max(-5,o),20),this._zoomLevel!==o&&(this._zoomLevel=o,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var Rz=Fe?1.5:1.35,RL=8,ef=class o{_bareFontInfoBrand=void 0;static createFromValidatedSettings(e,t,n){let i=e.get(50),r=e.get(54),s=e.get(53),a=e.get(52),l=e.get(55),d=e.get(68),c=e.get(65);return o._create(i,r,s,a,l,d,c,t,n)}static createFromRawSettings(e,t,n=!1){let i=Zr.fontFamily.validate(e.fontFamily),r=Zr.fontWeight.validate(e.fontWeight),s=Zr.fontSize.validate(e.fontSize),a=Zr.fontLigatures2.validate(e.fontLigatures),l=Zr.fontVariations.validate(e.fontVariations),d=Zr.lineHeight.validate(e.lineHeight),c=Zr.letterSpacing.validate(e.letterSpacing);return o._create(i,r,s,a,l,d,c,t,n)}static _create(e,t,n,i,r,s,a,l,d){s===0?s=Rz*n:s<RL&&(s=s*n),s=Math.round(s),s<RL&&(s=RL);let c=1+(d?0:ga.getZoomLevel()*.1);return n*=c,s*=c,r===Bp.TRANSLATE&&(t==="normal"||t==="bold"?r=Bp.OFF:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new o({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:n,fontFeatureSettings:i,fontVariationSettings:r,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(e){this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let e=No.fontFamily,t=o._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}},ML=2,Fp=class extends ef{_editorStylingBrand=void 0;version=ML;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}};var fa={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var OL="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function Mz(o=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of OL)o.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var Uy=Mz();function tf(o){let e=Uy;if(o&&o instanceof RegExp)if(o.global)e=o;else{let t="g";o.ignoreCase&&(t+="i"),o.multiline&&(t+="m"),o.unicode&&(t+="u"),e=new RegExp(o.source,t)}return e.lastIndex=0,e}var gP=new Vi;gP.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function nf(o,e,t,n,i){if(e=tf(e),i||(i=Je.first(gP)),t.length>i.maxLen){let d=o-i.maxLen/2;return d<0?d=0:n+=d,t=t.substring(d,o+i.maxLen/2),nf(o,e,t,n,i)}let r=Date.now(),s=o-1-n,a=-1,l=null;for(let d=1;!(Date.now()-r>=i.timeBudget);d++){let c=s-i.windowSize*d;e.lastIndex=Math.max(0,c);let u=Oz(e,t,s,a);if(!u&&l||(l=u,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return e.lastIndex=0,d}return null}function Oz(o,e,t,n){let i;for(;i=o.exec(e);){let r=i.index||0;if(r<=t&&o.lastIndex>=t)return i;if(n>0&&r>n)return null}return null}function NL(...o){switch(o.length){case 1:return m("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",o[0]);case 2:return m("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",o[0],o[1]);case 3:return m("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",o[0],o[1],o[2]);default:return}}var Nz=m("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),Az=m("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),Ed=class o{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw $N(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(NL("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(NL("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(NL("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,n=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),n=o._keywords.get(t);n?this._addToken(n):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(Nz);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,n=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(Az);return}let r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!n){e++;break}else r===91?n=!0:r===92?t=!0:r===93&&(n=!1);e++}for(;e<this._input.length&&o._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var Ti=new Map;Ti.set("false",!1);Ti.set("true",!0);Ti.set("isMac",Fe);Ti.set("isLinux",Wt);Ti.set("isWindows",pt);Ti.set("isWeb",Zi);Ti.set("isMacNative",Fe&&!Zi);Ti.set("isEdge",ON);Ti.set("isFirefox",Yv);Ti.set("isChrome",__);Ti.set("isSafari",MN);var Pz=Object.prototype.hasOwnProperty;var Fz={regexParsingWithErrorRecovery:!0},Bz=m("contextkey.parser.error.emptyString","Empty context key expression"),Wz=m("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),Vz=m("contextkey.parser.error.noInAfterNot","'in' after 'not'."),fP=m("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),Hz=m("contextkey.parser.error.unexpectedToken","Unexpected token"),Uz=m("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),zz=m("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),Kz=m("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),AL=class o{constructor(e=Fz){this._config=e}static _parseError=new Error;_scanner=new Ed;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:Bz,offset:0,lexeme:"",additionalInfo:Wz});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let n=this._peek(),i=n.type===17?Uz:void 0;throw this._parsingErrors.push({message:Hz,offset:n.offset,lexeme:Ed.getLexeme(n),additionalInfo:i}),o._parseError}return t}catch(t){if(t!==o._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:Ct.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:Ct.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),Xi.INSTANCE;case 12:return this._advance(),bo.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,fP),t?.negate()}case 17:return this._advance(),Gc.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),Ct.true();case 12:return this._advance(),Ct.false();case 0:{this._advance();let t=this._expr();return this._consume(1,fP),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let r=i.lexeme,s=r.lastIndexOf("/"),a=s===r.length-1?void 0:this._removeFlagsGY(r.substring(s+1)),l;try{l=new RegExp(r.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",i)}return uf.create(t,l)}switch(i.type){case 10:case 19:{let r=[i.lexeme];this._advance();let s=this._peek(),a=0;for(let p=0;p<i.lexeme.length;p++)i.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let p=0;p<s.lexeme.length;p++)s.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--}if(a<0)break;r.push(Ed.getLexeme(s)),this._advance(),s=this._peek()}let l=r.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),u;try{u=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",i)}return Ct.regex(t,u)}case 18:{let r=i.lexeme;this._advance();let s=null;if(!LA(r)){let a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){let d=r.slice(a+1,l),c=r[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return uf.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,Vz);let i=this._value();return Ct.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return Ct.equals(t,i);switch(i){case"true":return Ct.has(t);case"false":return Ct.not(t);default:return Ct.equals(t,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return Ct.notEquals(t,i);switch(i){case"true":return Ct.not(t);case"false":return Ct.has(t);default:return Ct.notEquals(t,i)}}case 5:return this._advance(),df.create(t,this._value());case 6:return this._advance(),cf.create(t,this._value());case 7:return this._advance(),af.create(t,this._value());case 8:return this._advance(),lf.create(t,this._value());case 13:return this._advance(),Ct.in(t,this._value());default:return Ct.has(t)}}case 20:throw this._parsingErrors.push({message:zz,offset:e.offset,lexeme:"",additionalInfo:Kz}),o._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){let i=m("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,Ed.getLexeme(t)),r=t.offset,s=Ed.getLexeme(t);return this._parsingErrors.push({message:i,offset:r,lexeme:s,additionalInfo:n}),o._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},Ct=class{static false(){return Xi.INSTANCE}static true(){return bo.INSTANCE}static has(e){return Kc.create(e)}static equals(e,t){return rf.create(e,t)}static notEquals(e,t){return sf.create(e,t)}static regex(e,t){return uf.create(e,t)}static in(e,t){return zy.create(e,t)}static notIn(e,t){return Ky.create(e,t)}static not(e){return Gc.create(e)}static and(...e){return Gy.create(e,null,!0)}static or(...e){return pf.create(e,null,!0)}static greater(e,t){return af.create(e,t)}static greaterEquals(e,t){return lf.create(e,t)}static smaller(e,t){return df.create(e,t)}static smallerEquals(e,t){return cf.create(e,t)}static _parser=new AL({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function of(o,e){return o.cmp(e)}var Xi=class o{static INSTANCE=new o;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return bo.INSTANCE}},bo=class o{static INSTANCE=new o;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Xi.INSTANCE}},Kc=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=Ti.get(e);return typeof n=="boolean"?n?bo.INSTANCE:Xi.INSTANCE:new o(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:yP(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=Ti.get(this.key);return typeof e=="boolean"?e?bo.INSTANCE:Xi.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=Gc.create(this.key,this)),this.negated}},rf=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?Kc.create(e,n):Gc.create(e,n);let i=Ti.get(e);return typeof i=="boolean"?t===(i?"true":"false")?bo.INSTANCE:Xi.INSTANCE:new o(e,t,n)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:jc(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=Ti.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?bo.INSTANCE:Xi.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=sf.create(this.key,this.value,this)),this.negated}},zy=class o{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new o(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:jc(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n=="string"&&typeof t=="object"&&t!==null?Pz.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=Ky.create(this.key,this.valueKey)),this.negated}},Ky=class o{constructor(e,t){this.key=e;this.valueKey=t;this._negated=zy.create(e,t)}static create(e,t){return new o(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},sf=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?Gc.create(e,n):Kc.create(e,n);let i=Ti.get(e);return typeof i=="boolean"?t===(i?"true":"false")?Xi.INSTANCE:bo.INSTANCE:new o(e,t,n)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:jc(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=Ti.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?Xi.INSTANCE:bo.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=rf.create(this.key,this.value,this)),this.negated}},Gc=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=Ti.get(e);return typeof n=="boolean"?n?Xi.INSTANCE:bo.INSTANCE:new o(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:yP(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=Ti.get(this.key);return typeof e=="boolean"?e?Xi.INSTANCE:bo.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=Kc.create(this.key,this)),this.negated}};function jy(o,e){if(typeof o=="string"){let t=parseFloat(o);isNaN(t)||(o=t)}return typeof o=="string"||typeof o=="number"?e(o):Xi.INSTANCE}var af=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return jy(t,i=>new o(e,i,n))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:jc(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=cf.create(this.key,this.value,this)),this.negated}},lf=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return jy(t,i=>new o(e,i,n))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:jc(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=df.create(this.key,this.value,this)),this.negated}},df=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return jy(t,i=>new o(e,i,n))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:jc(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=lf.create(this.key,this.value,this)),this.negated}},cf=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return jy(t,i=>new o(e,i,n))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:jc(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=af.create(this.key,this.value,this)),this.negated}},uf=class o{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new o(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=PL.create(this)),this.negated}},PL=class o{constructor(e){this._actual=e}static create(e){return new o(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new o(this._actual.map(e))}negate(){return this._actual}};function vP(o){let e=null;for(let t=0,n=o.length;t<n;t++){let i=o[t].substituteConstants();if(o[t]!==i&&e===null){e=[];for(let r=0;r<t;r++)e[r]=o[r]}e!==null&&(e[t]=i)}return e===null?o:e}var Gy=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=of(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=vP(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,n){let i=[],r=!1;for(let s of e)if(s){if(s.type===1){r=!0;continue}if(s.type===0)return Xi.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&r)return bo.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(of);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){let s=i[i.length-1];if(s.type!==9)break;i.pop();let a=i.pop(),l=i.length===0,d=pf.create(s.expr.map(c=>o.create([c,a],null,n)),null,l);d&&(i.push(d),i.sort(of))}if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return Xi.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=pf.create(e,this,!0)}return this.negated}},pf=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=of(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=vP(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,n){let i=[],r=!1;if(e){for(let s=0,a=e.length;s<a;s++){let l=e[s];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return bo.INSTANCE;if(l.type===9){i=i.concat(l.expr);continue}i.push(l)}}if(i.length===0&&r)return Xi.INSTANCE;i.sort(of)}if(i.length!==0){if(i.length===1)return i[0];for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return bo.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),n=e.shift(),i=[];for(let r of bP(t))for(let s of bP(n))i.push(Gy.create([r,s],null,!1));e.unshift(o.create(i,null,!1))}this.negated=o.create(e,this,!0)}return this.negated}},$=class o extends Kc{static _info=[];static all(){return o._info.values()}_defaultValue;constructor(e,t,n){super(e,null),this._defaultValue=t,typeof n=="object"?o._info.push({...n,key:e}):n!==!0&&o._info.push({key:e,description:n,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return rf.create(this.key,e)}notEqualsTo(e){return sf.create(this.key,e)}},St=Q("contextKeyService");function yP(o,e){return o<e?-1:o>e?1:0}function jc(o,e,t,n){return o<t?-1:o>t?1:e<n?-1:e>n?1:0}function bP(o){return o.type===9?o.expr:[o]}var vo=Q("accessibilityService");var NX=new $("accessibilityModeEnabled",!1);var kr=Q("environmentService"),qX=kr;var ba=Q("contextService");function $y(o){let e=o;return typeof e?.id=="string"&&te.isUri(e.uri)}function Yy(o){let e=o;return typeof e?.id=="string"&&te.isUri(e.configPath)}var IP="code-workspace",aJ=`.${IP}`,lJ=[{name:m("codeWorkspace","Code Workspace"),extensions:[IP]}];var ut=Q("configurationService");function CP(o){return o.replace(/[\[\]]/g,"")}var FL=class{data=new Map;add(e,t){cy(En(e)),cy(bn(t)),cy(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},lt=new FL;var qc={JSONContribution:"base.contributions.json"};function jz(o){return o.length>0&&o.charAt(o.length-1)==="#"?o.substring(0,o.length-1):o}var BL=class{schemasById;_onDidChangeSchema=new k;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(e,t){this.schemasById[jz(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?uP(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}},qz=new BL;lt.add(qc.JSONContribution,qz);var DJ=Q("policy");var Qr={Configuration:"base.contributions.configuration"};var Qy={properties:{},patternProperties:{}},Xy={properties:{},patternProperties:{}},Jy={properties:{},patternProperties:{}},eI={properties:{},patternProperties:{}},tI={properties:{},patternProperties:{}},hf={properties:{},patternProperties:{}},$c="vscode://schemas/settings/resourceLanguage";var nI=lt.as(qc.JSONContribution),WL=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new k;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new k;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:m("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},nI.registerSchema($c,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){let n=new Set;this.doRegisterConfigurations(e,t,n),nI.registerSchema($c,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),nI.registerSchema($c,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),nI.registerSchema($c,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let n=[];for(let{overrides:i,source:r}of e)for(let s in i){t.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=i[s];if(a.configurationDefaultOverrides.push({value:l,source:r}),Wp.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,r),n.push(...$z(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let n of e){let i=this.registeredConfigurationDefaults.indexOf(n);i!==-1&&this.registeredConfigurationDefaults.splice(i,1)}for(let{overrides:n,source:i}of e)for(let r in n){let s=this.configurationDefaultsOverrides.get(r);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>i?l.source?.id===i.id:l.value===n[r]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(r),Wp.test(r)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(r,d.value,d.source,l);l&&!Vc(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(r,l,i)):(this.configurationDefaultsOverrides.delete(r),delete this.configurationProperties[r],delete this.defaultLanguageConfigurationOverridesNode.properties[r])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(r,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}t.add(r)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){let i={type:"object",default:t.value,description:m("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",CP(e)),$ref:$c,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=i,this.defaultLanguageConfigurationOverridesNode.properties[e]=i}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,i){let r=i?.value||{},s=i?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(t)){let l=t[a];if(bn(l)&&(qn(r[a])||bn(r[a]))){if(r[a]={...r[a]??{},...l},n)for(let c in l)s.set(`${a}.${c}`,n)}else r[a]=l,n?s.set(a,n):s.delete(a)}return{value:r,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,i){let r=this.configurationProperties[e],s=i?.value??r?.defaultDefaultValue,a=n;if(bn(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(qn(s)||bn(s)))){if(a=i?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in t)n&&a.set(`${e}.${d}`,n);t={...bn(s)?s:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1,n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(i=>{this.validateAndRegisterProperties(i,t,i.extensionInfo,i.restrictedProperties,void 0,n),this.configurationContributors.push(i),this.registerJSONConfiguration(i)})}doDeregisterConfigurations(e,t){let n=i=>{if(i.properties)for(let r in i.properties){t.add(r);let s=this.configurationProperties[r];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[r],this.removeFromSchema(r,i.properties[r])}i.allOf?.forEach(r=>n(r))};for(let i of e){n(i);let r=this.configurationContributors.indexOf(i);r!==-1&&this.configurationContributors.splice(r,1)}}validateAndRegisterProperties(e,t=!0,n,i,r=3,s){r=zi(e.scope)?r:e.scope;let a=e.properties;if(a)for(let d in a){let c=a[d];if(t&&Zz(d,c)){delete a[d];continue}if(c.source=n,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),Wp.test(d)?c.scope=void 0:(c.scope=zi(c.scope)?r:c.scope,c.restricted=zi(c.restricted)?!!i?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=e.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,t,n,i,r,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=n=>{let i=n.properties;if(i)for(let s in i)this.updateSchema(s,i[s]);n.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(Qy.properties[e]=t,t.scope){case 1:Xy.properties[e]=t;break;case 2:Jy.properties[e]=t;break;case 6:eI.properties[e]=t;break;case 3:tI.properties[e]=t;break;case 4:hf.properties[e]=t;break;case 5:hf.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete Qy.properties[e],t.scope){case 1:delete Xy.properties[e];break;case 2:delete Jy.properties[e];break;case 6:delete eI.properties[e];break;case 3:delete tI.properties[e];break;case 4:case 5:delete hf.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,n={type:"object",description:m("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:m("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:$c};this.updatePropertyDefaultValue(t,n),Qy.properties[t]=n,Xy.properties[t]=n,Jy.properties[t]=n,eI.properties[t]=n,tI.properties[t]=n,hf.properties[t]=n}}registerOverridePropertyPatternKey(){let e={type:"object",description:m("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:m("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:$c};Qy.patternProperties[Yc]=e,Xy.patternProperties[Yc]=e,Jy.patternProperties[Yc]=e,eI.patternProperties[Yc]=e,tI.patternProperties[Yc]=e,hf.patternProperties[Yc]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,i,r;n&&(!t.disallowConfigurationDefault||!n.source)&&(i=n.value,r=n.source),qn(i)&&(i=t.defaultDefaultValue,r=void 0),qn(i)&&(i=Yz(t.type)),t.default=i,t.defaultValueSource=r}},EP="\\[([^\\]]+)\\]",SP=new RegExp(EP,"g"),Yc=`^(${EP})+$`,Wp=new RegExp(Yc);function $z(o){let e=[];if(Wp.test(o)){let t=SP.exec(o);for(;t?.length;){let n=t[1].trim();n&&e.push(n),t=SP.exec(o)}}return bs(e)}function Yz(o){switch(Array.isArray(o)?o[0]:o){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var iI=new WL;lt.add(Qr.Configuration,iI);function Zz(o,e){return o.trim()?Wp.test(o)?m("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",o):iI.getConfigurationProperties()[o]!==void 0?m("config.property.duplicate","Cannot register '{0}'. This property is already registered.",o):e.policy?.name&&iI.getPolicyConfigurations().get(e.policy?.name)!==void 0?m("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",o,e.policy?.name,iI.getPolicyConfigurations().get(e.policy?.name)):null:m("config.property.empty","Cannot register an empty property")}var xs=8,oI=class{_values;constructor(e){this._values=e}hasChanged(e){return this._values[e]}},mf=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},Mt=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return sI(e,t)}compute(e,t,n){return n}},Hp=class{constructor(e,t){this.newValue=e;this.didChange=t}};function sI(o,e){if(typeof o!="object"||typeof e!="object"||!o||!e)return new Hp(e,o!==e);if(Array.isArray(o)||Array.isArray(e)){let n=Array.isArray(o)&&Array.isArray(e)&&Ut(o,e);return new Hp(e,!n)}let t=!1;for(let n in e)if(e.hasOwnProperty(n)){let i=sI(o[n],e[n]);i.didChange&&(o[n]=i.newValue,t=!0)}return new Hp(o,t)}var Qc=class{id;name;defaultValue;schema=void 0;constructor(e){this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return sI(e,t)}validate(e){return this.defaultValue}},Td=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return sI(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,n){return n}};function be(o,e){return typeof o>"u"?e:o==="false"?!1:!!o}var nt=class extends Td{constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="boolean",i.default=n),super(e,t,n,i)}validate(e){return be(e,this.defaultValue)}};function wd(o,e,t,n){if(typeof o>"u")return e;let i=parseInt(o,10);return isNaN(i)?e:(i=Math.max(t,i),i=Math.min(n,i),i|0)}var Lt=class o extends Td{static clampedInt(e,t,n,i){return wd(e,t,n,i)}minimum;maximum;constructor(e,t,n,i,r,s=void 0){typeof s<"u"&&(s.type="integer",s.default=n,s.minimum=i,s.maximum=r),super(e,t,n,s),this.minimum=i,this.maximum=r}validate(e){return o.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}};function wP(o,e,t,n){if(typeof o>"u")return e;let i=er.float(o,e);return er.clamp(i,t,n)}var er=class o extends Td{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;let n=parseFloat(e);return isNaN(n)?t:n}validationFn;constructor(e,t,n,i,r){typeof r<"u"&&(r.type="number",r.default=n),super(e,t,n,r),this.validationFn=i}validate(e){return this.validationFn(o.float(e,this.defaultValue))}},Ki=class o extends Td{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="string",i.default=n),super(e,t,n,i)}validate(e){return o.string(e,this.defaultValue)}};function Zt(o,e,t,n){return typeof o!="string"?e:n&&o in n?n[o]:t.indexOf(o)===-1?e:o}var zt=class extends Td{_allowedValues;constructor(e,t,n,i,r=void 0){typeof r<"u"&&(r.type="string",r.enum=i,r.default=n),super(e,t,n,r),this._allowedValues=i}validate(e){return Zt(e,this.defaultValue,this._allowedValues)}},Vp=class extends Mt{_allowedValues;_convert;constructor(e,t,n,i,r,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=i),super(e,t,n,a),this._allowedValues=r,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function Qz(o){switch(o){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var VL=class extends Mt{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[m("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),m("accessibilitySupport.on","Optimize for usage with a Screen Reader."),m("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:m("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,n){return n===0?e.accessibilitySupport:n}},HL=class extends Mt{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:m("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:m("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertSpace:be(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:be(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function Xz(o){switch(o){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function Jz(o){switch(o){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var UL=class extends Qc{constructor(){super(144)}compute(e,t,n){let i=["monaco-editor"];return t.get(40)&&i.push(t.get(40)),e.extraEditorClassName&&i.push(e.extraEditorClassName),t.get(75)==="default"?i.push("mouse-default"):t.get(75)==="copy"&&i.push("mouse-copy"),t.get(113)&&i.push("showUnused"),t.get(142)&&i.push("showDeprecated"),i.join(" ")}},zL=class extends nt{constructor(){super(38,"emptySelectionClipboard",!0,{description:m("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}},KL=class extends Mt{constructor(){let e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:m("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[m("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),m("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),m("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:m("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[m("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),m("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),m("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:m("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:m("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Fe},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:m("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:m("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{cursorMoveOnType:be(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":Zt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":Zt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:be(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:be(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:be(t.loop,this.defaultValue.loop)}}},ws=class o extends Mt{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",o.OFF,{anyOf:[{type:"boolean",description:m("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:m("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:m("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?o.OFF:e==="true"?o.ON:e:e?o.ON:o.OFF}},Bp=class o extends Mt{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",o.OFF,{anyOf:[{type:"boolean",description:m("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:m("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:m("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?o.OFF:e==="true"?o.TRANSLATE:e:e?o.TRANSLATE:o.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}},GL=class extends Qc{constructor(){super(51)}compute(e,t,n){return e.fontInfo}},jL=class extends Td{constructor(){super(53,"fontSize",No.fontSize,{type:"number",minimum:6,maximum:100,default:No.fontSize,description:m("fontSize","Controls the font size in pixels.")})}validate(e){let t=er.float(e,this.defaultValue);return t===0?No.fontSize:er.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}},qL=class o extends Mt{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",No.fontWeight,{anyOf:[{type:"number",minimum:o.MINIMUM_VALUE,maximum:o.MAXIMUM_VALUE,errorMessage:m("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:o.SUGGESTION_VALUES}],default:No.fontWeight,description:m("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Lt.clampedInt(e,No.fontWeight,o.MINIMUM_VALUE,o.MAXIMUM_VALUE))}},$L=class extends Mt{constructor(){let e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[m("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),m("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),m("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:m("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:m("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:m("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:m("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:m("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:m("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:m("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:m("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:m("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:m("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:m("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{multiple:Zt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??Zt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??Zt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??Zt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??Zt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??Zt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??Zt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Ki.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Ki.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Ki.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Ki.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Ki.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Ki.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},YL=class extends Mt{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:m("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:m("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:m("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:m("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:m("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),delay:Lt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:be(t.sticky,this.defaultValue.sticky),hidingDelay:Lt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:be(t.above,this.defaultValue.above)}}};var gf=class o extends Qc{constructor(){super(147)}compute(e,t,n){return o.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight),i=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(i=Math.max(i,t-1));let r=(n+e.viewLineCount+i)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:i,desiredRatio:r,minimapLineCount:s}}static _computeMinimapLayout(e,t){let n=e.outerWidth,i=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};let s=t.stableMinimapLayoutInput,a=s&&e.outerHeight===s.outerHeight&&e.lineHeight===s.lineHeight&&e.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&e.pixelRatio===s.pixelRatio&&e.scrollBeyondLastLine===s.scrollBeyondLastLine&&e.paddingTop===s.paddingTop&&e.paddingBottom===s.paddingBottom&&e.minimap.enabled===s.minimap.enabled&&e.minimap.side===s.minimap.side&&e.minimap.size===s.minimap.size&&e.minimap.showSlider===s.minimap.showSlider&&e.minimap.renderCharacters===s.minimap.renderCharacters&&e.minimap.maxColumn===s.minimap.maxColumn&&e.minimap.scale===s.minimap.scale&&e.verticalScrollbarWidth===s.verticalScrollbarWidth&&e.isViewportWrapping===s.isViewportWrapping,l=e.lineHeight,d=e.typicalHalfwidthCharacterWidth,c=e.scrollBeyondLastLine,u=e.minimap.renderCharacters,p=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale,h=e.minimap.maxColumn,f=e.minimap.size,g=e.minimap.side,b=e.verticalScrollbarWidth,v=e.viewLineCount,I=e.remainingWidth,T=e.isViewportWrapping,S=u?2:3,C=Math.floor(r*i),w=C/r,x=!1,D=!1,O=S*p,H=p/r,K=1;if(f==="fill"||f==="fit"){let{typicalViewportLineCount:re,extraLinesBeforeFirstLine:ee,extraLinesBeyondLastLine:Te,desiredRatio:ce,minimapLineCount:Ze}=o.computeContainedMinimapLineCount({viewLineCount:v,scrollBeyondLastLine:c,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:i,lineHeight:l,pixelRatio:r});if(v/Ze>1)x=!0,D=!0,p=1,O=1,H=p/r;else{let _e=!1,mn=p+1;if(f==="fit"){let an=Math.ceil((ee+v+Te)*O);T&&a&&I<=t.stableFitRemainingWidth?(_e=!0,mn=t.stableFitMaxMinimapScale):_e=an>C}if(f==="fill"||_e){x=!0;let an=p;O=Math.min(l*r,Math.max(1,Math.floor(1/ce))),T&&a&&I<=t.stableFitRemainingWidth&&(mn=t.stableFitMaxMinimapScale),p=Math.min(mn,Math.max(1,Math.floor(O/S))),p>an&&(K=Math.min(2,p/an)),H=p/r/K,C=Math.ceil(Math.max(re,ee+v+Te)*O),T?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=I,t.stableFitMaxMinimapScale=p):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}let z=Math.floor(h*H),ie=Math.min(z,Math.max(0,Math.floor((I-b-2)*H/(d+H)))+xs),Se=Math.floor(r*ie),J=Se/r;Se=Math.floor(Se*K);let X=u?1:2,le=g==="left"?0:n-ie-b;return{renderMinimap:X,minimapLeft:le,minimapWidth:ie,minimapHeightIsEditorHeight:x,minimapIsSampling:D,minimapScale:p,minimapLineHeight:O,minimapCanvasInnerWidth:Se,minimapCanvasInnerHeight:C,minimapCanvasOuterWidth:J,minimapCanvasOuterHeight:w}}static computeLayout(e,t){let n=t.outerWidth|0,i=t.outerHeight|0,r=t.lineHeight|0,s=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,d=t.pixelRatio,c=t.viewLineCount,u=e.get(139),p=u==="inherit"?e.get(138):u,h=p==="inherit"?e.get(134):p,f=e.get(137),g=t.isDominatedByLongLines,b=e.get(58),v=e.get(69).renderType!==0,I=e.get(70),T=e.get(107),S=e.get(85),C=e.get(74),w=e.get(105),x=w.verticalScrollbarSize,D=w.verticalHasArrows,O=w.arrowSize,H=w.horizontalScrollbarSize,K=e.get(44),z=e.get(112)!=="never",ie=e.get(67);K&&z&&(ie+=16);let Se=0;if(v){let oi=Math.max(s,I);Se=Math.round(oi*l)}let J=0;b&&(J=r*t.glyphMarginDecorationLaneCount);let X=0,le=X+J,re=le+Se,ee=re+ie,Te=n-J-Se-ie,ce=!1,Ze=!1,Ue=-1;p==="inherit"&&g?(ce=!0,Ze=!0):h==="on"||h==="bounded"?Ze=!0:h==="wordWrapColumn"&&(Ue=f);let _e=o._computeMinimapLayout({outerWidth:n,outerHeight:i,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:T,paddingTop:S.top,paddingBottom:S.bottom,minimap:C,verticalScrollbarWidth:x,viewLineCount:c,remainingWidth:Te,isViewportWrapping:Ze},t.memory||new mf);_e.renderMinimap!==0&&_e.minimapLeft===0&&(X+=_e.minimapWidth,le+=_e.minimapWidth,re+=_e.minimapWidth,ee+=_e.minimapWidth);let mn=Te-_e.minimapWidth,an=Math.max(1,Math.floor((mn-x-2)/a)),Pn=D?O:0;return Ze&&(Ue=Math.max(1,an),h==="bounded"&&(Ue=Math.min(Ue,f))),{width:n,height:i,glyphMarginLeft:X,glyphMarginWidth:J,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:le,lineNumbersWidth:Se,decorationsLeft:re,decorationsWidth:ie,contentLeft:ee,contentWidth:mn,minimap:_e,viewportColumn:an,isWordWrapMinified:ce,isViewportWrapping:Ze,wrappingColumn:Ue,verticalScrollbarWidth:x,horizontalScrollbarHeight:H,overviewRuler:{top:Pn,width:x,height:i-2*Pn,right:0}}}},ZL=class extends Mt{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[m("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),m("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:m("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return Zt(e,"simple",["simple","advanced"])}compute(e,t,n){return t.get(2)===2?"advanced":n}};var QL=class extends Mt{constructor(){let e={enabled:"onCode"};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:e.enabled,enumDescriptions:[m("editor.lightbulb.enabled.off","Disable the code action menu."),m("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),m("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:m("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Zt(e.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},XL=class extends Mt{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:m("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:m("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:m("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:m("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),maxLineCount:Lt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:Zt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:be(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},JL=class extends Mt{constructor(){let e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:m("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[m("editor.inlayHints.on","Inlay hints are enabled"),m("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Fe?"Ctrl+Option":"Ctrl+Alt"),m("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Fe?"Ctrl+Option":"Ctrl+Alt"),m("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:m("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:m("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:m("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:m("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:Zt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Lt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Ki.string(t.fontFamily,this.defaultValue.fontFamily),padding:be(t.padding,this.defaultValue.padding),maximumLength:Lt.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},eD=class extends Mt{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Lt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?Lt.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}},tD=class extends er{constructor(){super(68,"lineHeight",No.lineHeight,e=>er.clamp(e,0,150),{markdownDescription:m("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,n){return e.fontInfo.lineHeight}},nD=class extends Mt{constructor(){let e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:m("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:m("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[m("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),m("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),m("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:m("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:m("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:m("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:m("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:m("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:m("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:m("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:m("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:m("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:m("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),autohide:be(t.autohide,this.defaultValue.autohide),size:Zt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:Zt(t.side,this.defaultValue.side,["right","left"]),showSlider:Zt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:be(t.renderCharacters,this.defaultValue.renderCharacters),scale:Lt.clampedInt(t.scale,1,1,3),maxColumn:Lt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:be(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:be(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:er.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:er.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function e7(o){return o==="ctrlCmd"?Fe?"metaKey":"ctrlKey":"altKey"}var iD=class extends Mt{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:m("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:m("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{top:Lt.clampedInt(t.top,0,0,1e3),bottom:Lt.clampedInt(t.bottom,0,0,1e3)}}},oD=class extends Mt{constructor(){let e={enabled:!0,cycle:!0};super(87,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:m("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:m("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),cycle:be(t.cycle,this.defaultValue.cycle)}}},rD=class extends Qc{constructor(){super(145)}compute(e,t,n){return e.pixelRatio}},sD=class extends Mt{constructor(){super(89,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},aD=class extends Mt{defaultValue;constructor(){let e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[m("on","Quick suggestions show inside the suggest widget"),m("inline","Quick suggestions show as ghost text"),m("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:m("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:m("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:m("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:m("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){let d=e?"on":"off";return{comments:d,strings:d,other:d}}if(!e||typeof e!="object")return this.defaultValue;let{other:t,comments:n,strings:i}=e,r=["on","inline","off"],s,a,l;return typeof t=="boolean"?s=t?"on":"off":s=Zt(t,this.defaultValue.other,r),typeof n=="boolean"?a=n?"on":"off":a=Zt(n,this.defaultValue.comments,r),typeof i=="boolean"?l=i?"on":"off":l=Zt(i,this.defaultValue.strings,r),{other:s,comments:a,strings:l}}};var lD=class extends Mt{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[m("lineNumbers.off","Line numbers are not rendered."),m("lineNumbers.on","Line numbers are rendered as absolute number."),m("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),m("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:m("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,n=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:n}}};function Xc(o){let e=o.get(100);return e==="editable"?o.get(93):e!=="on"}var dD=class extends Mt{constructor(){let e=[],t={type:"number",description:m("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:m("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:m("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="number")t.push({column:Lt.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n=="object"){let i=n;t.push({column:Lt.clampedInt(i.column,0,0,1e4),color:i.color})}return t.sort((n,i)=>n.column-i.column),t}return this.defaultValue}},cD=class extends Mt{constructor(){super(94,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function TP(o,e){if(typeof o!="string")return e;switch(o){case"hidden":return 2;case"visible":return 3;default:return 1}}var uD=class extends Mt{constructor(){let e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),m("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),m("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:m("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),m("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),m("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:m("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:m("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:m("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:m("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:m("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e,n=Lt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),i=Lt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Lt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:TP(t.vertical,this.defaultValue.vertical),horizontal:TP(t.horizontal,this.defaultValue.horizontal),useShadows:be(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:be(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:be(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:be(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:be(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:Lt.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:i,verticalSliderSize:Lt.clampedInt(t.verticalSliderSize,i,0,1e3),scrollByPage:be(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:be(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},Ts="inUntrustedWorkspace",Zc={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},pD=class extends Mt{constructor(){let e={nonBasicASCII:Ts,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Ts,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",e,{[Zc.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ts],default:e.nonBasicASCII,description:m("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Zc.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:m("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[Zc.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:m("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Zc.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ts],default:e.includeComments,description:m("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[Zc.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ts],default:e.includeStrings,description:m("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[Zc.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:m("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Zc.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:m("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&(Ei(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&(Ei(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));let i=super.applyUpdate(e,t);return n?new Hp(i.newValue,!0):i}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{nonBasicASCII:Up(t.nonBasicASCII,Ts,[!0,!1,Ts]),invisibleCharacters:be(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:be(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:Up(t.includeComments,Ts,[!0,!1,Ts]),includeStrings:Up(t.includeStrings,Ts,[!0,!1,Ts]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;let n={};for(let[i,r]of Object.entries(e))r===!0&&(n[i]=!0);return n}},hD=class extends Mt{constructor(){let e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:m("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[m("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),m("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),m("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:m("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:m("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:m("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:m("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),mode:Zt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:Zt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:be(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:be(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Ki.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:be(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},mD=class extends Mt{constructor(){let e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:m("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[m("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),m("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),m("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:m("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:m("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showToolbar:Zt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:Ki.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:be(t.keepOnBlur,this.defaultValue.keepOnBlur)}}},gD=class extends Mt{constructor(){let e={enabled:fa.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:fa.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:m("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:be(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},fD=class extends Mt{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("editor.guides.bracketPairs.true","Enables bracket pair guides."),m("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),m("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:m("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),m("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),m("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:m("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:m("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:m("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[m("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),m("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),m("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:m("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{bracketPairs:Up(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:Up(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:be(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:be(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:Up(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function Up(o,e,t){let n=t.indexOf(o);return n===-1?e:t[n]}var bD=class extends Mt{constructor(){let e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[m("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),m("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:m("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:m("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:m("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:m("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[m("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),m("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),m("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),m("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:m("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:m("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:m("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:m("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:m("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:m("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:m("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:m("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertMode:Zt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:be(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:be(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:be(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:be(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:Zt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:be(t.showIcons,this.defaultValue.showIcons),showStatusBar:be(t.showStatusBar,this.defaultValue.showStatusBar),preview:be(t.preview,this.defaultValue.preview),previewMode:Zt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:be(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:be(t.showMethods,this.defaultValue.showMethods),showFunctions:be(t.showFunctions,this.defaultValue.showFunctions),showConstructors:be(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:be(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:be(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:be(t.showFields,this.defaultValue.showFields),showVariables:be(t.showVariables,this.defaultValue.showVariables),showClasses:be(t.showClasses,this.defaultValue.showClasses),showStructs:be(t.showStructs,this.defaultValue.showStructs),showInterfaces:be(t.showInterfaces,this.defaultValue.showInterfaces),showModules:be(t.showModules,this.defaultValue.showModules),showProperties:be(t.showProperties,this.defaultValue.showProperties),showEvents:be(t.showEvents,this.defaultValue.showEvents),showOperators:be(t.showOperators,this.defaultValue.showOperators),showUnits:be(t.showUnits,this.defaultValue.showUnits),showValues:be(t.showValues,this.defaultValue.showValues),showConstants:be(t.showConstants,this.defaultValue.showConstants),showEnums:be(t.showEnums,this.defaultValue.showEnums),showEnumMembers:be(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:be(t.showKeywords,this.defaultValue.showKeywords),showWords:be(t.showWords,this.defaultValue.showWords),showColors:be(t.showColors,this.defaultValue.showColors),showFiles:be(t.showFiles,this.defaultValue.showFiles),showReferences:be(t.showReferences,this.defaultValue.showReferences),showFolders:be(t.showFolders,this.defaultValue.showFolders),showTypeParameters:be(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:be(t.showSnippets,this.defaultValue.showSnippets),showUsers:be(t.showUsers,this.defaultValue.showUsers),showIssues:be(t.showIssues,this.defaultValue.showIssues)}}},vD=class extends Mt{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:m("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:m("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:be(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:be(e.selectSubwords,this.defaultValue.selectSubwords)}}},yD=class extends Mt{constructor(){let e=[];super(132,"wordSegmenterLocales",e,{anyOf:[{description:m("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:m("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="string")try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}};var ID=class extends Mt{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[m("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),m("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),m("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),m("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:m("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,n){return t.get(2)===2?0:n}},CD=class extends Qc{constructor(){super(148)}compute(e,t,n){let i=t.get(147);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:i.isWordWrapMinified,isViewportWrapping:i.isViewportWrapping,wrappingColumn:i.wrappingColumn}}},SD=class extends Mt{constructor(){let e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:m("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[m("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),m("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showDropSelector:Zt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},ED=class extends Mt{constructor(){let e={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:m("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[m("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),m("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showPasteSelector:Zt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},t7="Consolas, 'Courier New', monospace",n7="Menlo, Monaco, 'Courier New', monospace",i7="'Droid Sans Mono', 'monospace', monospace",No={fontFamily:Fe?n7:Wt?i7:t7,fontWeight:"normal",fontSize:Fe?12:14,lineHeight:0,letterSpacing:0},zp=[];function Y(o){return zp[o.id]=o,o}var Zr={acceptSuggestionOnCommitCharacter:Y(new nt(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:m("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:Y(new zt(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",m("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:m("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:Y(new VL),accessibilityPageSize:Y(new Lt(3,"accessibilityPageSize",10,1,1073741824,{description:m("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:Y(new Ki(4,"ariaLabel",m("editorViewAccessibleLabel","Editor content"))),ariaRequired:Y(new nt(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:Y(new nt(8,"screenReaderAnnounceInlineSuggestion",!0,{description:m("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:Y(new zt(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),m("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:m("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:Y(new zt(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),m("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:m("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:Y(new zt(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",m("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:m("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:Y(new zt(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",m("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:m("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:Y(new zt(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),m("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:m("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:Y(new Vp(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],Qz,{enumDescriptions:[m("editor.autoIndent.none","The editor will not insert indentation automatically."),m("editor.autoIndent.keep","The editor will keep the current line's indentation."),m("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),m("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),m("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:m("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:Y(new nt(13,"automaticLayout",!1)),autoSurround:Y(new zt(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[m("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),m("editor.autoSurround.quotes","Surround with quotes but not brackets."),m("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:m("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:Y(new gD),bracketPairGuides:Y(new fD),stickyTabStops:Y(new nt(118,"stickyTabStops",!1,{description:m("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:Y(new nt(17,"codeLens",!0,{description:m("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:Y(new Ki(18,"codeLensFontFamily","",{description:m("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:Y(new Lt(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:m("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:Y(new nt(20,"colorDecorators",!0,{description:m("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:Y(new zt(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[m("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),m("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),m("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:m("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:Y(new Lt(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:m("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:Y(new nt(22,"columnSelection",!1,{description:m("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:Y(new HL),contextmenu:Y(new nt(24,"contextmenu",!0)),copyWithSyntaxHighlighting:Y(new nt(25,"copyWithSyntaxHighlighting",!0,{description:m("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:Y(new Vp(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],Xz,{description:m("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:Y(new zt(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[m("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),m("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),m("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:m("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:Y(new Vp(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],Jz,{description:m("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:Y(new Lt(29,"cursorSurroundingLines",0,0,1073741824,{description:m("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:Y(new zt(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[m("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),m("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:m("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:Y(new Lt(31,"cursorWidth",0,0,1073741824,{markdownDescription:m("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:Y(new nt(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:Y(new nt(33,"disableMonospaceOptimizations",!1)),domReadOnly:Y(new nt(34,"domReadOnly",!1)),dragAndDrop:Y(new nt(35,"dragAndDrop",!0,{description:m("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:Y(new zL),dropIntoEditor:Y(new SD),experimentalEditContextEnabled:Y(new nt(37,"experimentalEditContextEnabled",!1,{description:m("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:Y(new XL),experimentalWhitespaceRendering:Y(new zt(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[m("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),m("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),m("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:m("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:Y(new Ki(40,"extraEditorClassName","")),fastScrollSensitivity:Y(new er(41,"fastScrollSensitivity",5,o=>o<=0?5:o,{markdownDescription:m("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:Y(new KL),fixedOverflowWidgets:Y(new nt(43,"fixedOverflowWidgets",!1)),folding:Y(new nt(44,"folding",!0,{description:m("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:Y(new zt(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[m("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),m("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:m("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:Y(new nt(46,"foldingHighlight",!0,{description:m("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:Y(new nt(47,"foldingImportsByDefault",!1,{description:m("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:Y(new Lt(48,"foldingMaximumRegions",5e3,10,65e3,{description:m("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:Y(new nt(49,"unfoldOnClickAfterEndOfLine",!1,{description:m("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:Y(new Ki(50,"fontFamily",No.fontFamily,{description:m("fontFamily","Controls the font family.")})),fontInfo:Y(new GL),fontLigatures2:Y(new ws),fontSize:Y(new jL),fontWeight:Y(new qL),fontVariations:Y(new Bp),formatOnPaste:Y(new nt(56,"formatOnPaste",!1,{description:m("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:Y(new nt(57,"formatOnType",!1,{description:m("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:Y(new nt(58,"glyphMargin",!0,{description:m("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:Y(new $L),hideCursorInOverviewRuler:Y(new nt(60,"hideCursorInOverviewRuler",!1,{description:m("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:Y(new YL),inDiffEditor:Y(new nt(62,"inDiffEditor",!1)),letterSpacing:Y(new er(65,"letterSpacing",No.letterSpacing,o=>er.clamp(o,-5,20),{description:m("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:Y(new QL),lineDecorationsWidth:Y(new eD),lineHeight:Y(new tD),lineNumbers:Y(new lD),lineNumbersMinChars:Y(new Lt(70,"lineNumbersMinChars",5,1,300)),linkedEditing:Y(new nt(71,"linkedEditing",!1,{description:m("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:Y(new nt(72,"links",!0,{description:m("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:Y(new zt(73,"matchBrackets","always",["always","near","never"],{description:m("matchBrackets","Highlight matching brackets.")})),minimap:Y(new nD),mouseStyle:Y(new zt(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:Y(new er(76,"mouseWheelScrollSensitivity",1,o=>o===0?1:o,{markdownDescription:m("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:Y(new nt(77,"mouseWheelZoom",!1,{markdownDescription:Fe?m("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):m("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:Y(new nt(78,"multiCursorMergeOverlapping",!0,{description:m("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:Y(new Vp(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],e7,{markdownEnumDescriptions:[m("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),m("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:m({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:Y(new zt(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[m("multiCursorPaste.spread","Each cursor pastes a single line of the text."),m("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:m("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:Y(new Lt(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:m("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:Y(new zt(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[m("occurrencesHighlight.off","Does not highlight occurrences."),m("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),m("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:m("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:Y(new nt(83,"overviewRulerBorder",!0,{description:m("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:Y(new Lt(84,"overviewRulerLanes",3,0,3)),padding:Y(new iD),pasteAs:Y(new ED),parameterHints:Y(new oD),peekWidgetDefaultFocus:Y(new zt(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[m("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),m("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:m("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:Y(new sD),definitionLinkOpensInPeek:Y(new nt(90,"definitionLinkOpensInPeek",!1,{description:m("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:Y(new aD),quickSuggestionsDelay:Y(new Lt(92,"quickSuggestionsDelay",10,0,1073741824,{description:m("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:Y(new nt(93,"readOnly",!1)),readOnlyMessage:Y(new cD),renameOnType:Y(new nt(95,"renameOnType",!1,{description:m("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:m("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:Y(new nt(96,"renderControlCharacters",!0,{description:m("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:Y(new zt(97,"renderFinalNewline",Wt?"dimmed":"on",["off","on","dimmed"],{description:m("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:Y(new zt(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",m("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:m("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:Y(new nt(99,"renderLineHighlightOnlyWhenFocus",!1,{description:m("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:Y(new zt(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:Y(new zt(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",m("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),m("renderWhitespace.selection","Render whitespace characters only on selected text."),m("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:m("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:Y(new Lt(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:Y(new nt(103,"roundedSelection",!0,{description:m("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:Y(new dD),scrollbar:Y(new uD),scrollBeyondLastColumn:Y(new Lt(106,"scrollBeyondLastColumn",4,0,1073741824,{description:m("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:Y(new nt(107,"scrollBeyondLastLine",!0,{description:m("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:Y(new nt(108,"scrollPredominantAxis",!0,{description:m("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:Y(new nt(109,"selectionClipboard",!0,{description:m("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:Wt})),selectionHighlight:Y(new nt(110,"selectionHighlight",!0,{description:m("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:Y(new nt(111,"selectOnLineNumbers",!0)),showFoldingControls:Y(new zt(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[m("showFoldingControls.always","Always show the folding controls."),m("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),m("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:m("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:Y(new nt(113,"showUnused",!0,{description:m("showUnused","Controls fading out of unused code.")})),showDeprecated:Y(new nt(142,"showDeprecated",!0,{description:m("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:Y(new JL),snippetSuggestions:Y(new zt(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[m("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),m("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),m("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),m("snippetSuggestions.none","Do not show snippet suggestions.")],description:m("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:Y(new vD),smoothScrolling:Y(new nt(116,"smoothScrolling",!1,{description:m("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:Y(new Lt(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:Y(new bD),inlineSuggest:Y(new hD),inlineEdit:Y(new mD),inlineCompletionsAccessibilityVerbose:Y(new nt(151,"inlineCompletionsAccessibilityVerbose",!1,{description:m("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:Y(new Lt(121,"suggestFontSize",0,0,1e3,{markdownDescription:m("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:Y(new Lt(122,"suggestLineHeight",0,0,1e3,{markdownDescription:m("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:Y(new nt(123,"suggestOnTriggerCharacters",!0,{description:m("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:Y(new zt(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[m("suggestSelection.first","Always select the first suggestion."),m("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),m("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:m("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:Y(new zt(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[m("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),m("tabCompletion.off","Disable tab completions."),m("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:m("tabCompletion","Enables tab completions.")})),tabIndex:Y(new Lt(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:Y(new pD),unusualLineTerminators:Y(new zt(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[m("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),m("unusualLineTerminators.off","Unusual line terminators are ignored."),m("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:m("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:Y(new nt(129,"useShadowDOM",!0)),useTabStops:Y(new nt(130,"useTabStops",!0,{description:m("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:Y(new zt(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[m("wordBreak.normal","Use the default line break rule."),m("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:m("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:Y(new yD),wordSeparators:Y(new Ki(133,"wordSeparators",OL,{description:m("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:Y(new zt(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[m("wordWrap.off","Lines will never wrap."),m("wordWrap.on","Lines will wrap at the viewport width."),m({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),m({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:m({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:Y(new Ki(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:Y(new Ki(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:Y(new Lt(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:m({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:Y(new zt(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:Y(new zt(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:Y(new UL),defaultColorDecorators:Y(new nt(149,"defaultColorDecorators",!1,{markdownDescription:m("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:Y(new rD),tabFocusMode:Y(new nt(146,"tabFocusMode",!1,{markdownDescription:m("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:Y(new gf),wrappingInfo:Y(new CD),wrappingIndent:Y(new ID),wrappingStrategy:Y(new ZL)};var A=class o{lineNumber;column;constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new o(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return o.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return o.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return o.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let n=e.lineNumber|0,i=t.lineNumber|0;if(n===i){let r=e.column|0,s=t.column|0;return r-s}return n-i}clone(){return new o(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new o(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var M=class o{startLineNumber;startColumn;endLineNumber;endColumn;constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return o.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return o.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return o.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return o.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return o.plusRange(this,e)}static plusRange(e,t){let n,i,r,s;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,s=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,s=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,s=e.endColumn),new o(n,i,r,s)}intersectRanges(e){return o.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,s=e.endColumn,a=t.startLineNumber,l=t.startColumn,d=t.endLineNumber,c=t.endColumn;return n<a?(n=a,i=l):n===a&&(i=Math.max(i,l)),r>d?(r=d,s=c):r===d&&(s=Math.min(s,c)),n>r||n===r&&i>s?null:new o(n,i,r,s)}equalsRange(e){return o.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return o.getEndPosition(this)}static getEndPosition(e){return new A(e.endLineNumber,e.endColumn)}getStartPosition(){return o.getStartPosition(this)}static getStartPosition(e){return new A(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new o(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new o(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return o.collapseToStart(this)}static collapseToStart(e){return new o(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return o.collapseToEnd(this)}static collapseToEnd(e){return new o(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new o(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let r=e.startLineNumber|0,s=t.startLineNumber|0;if(r===s){let a=e.startColumn|0,l=t.startColumn|0;if(a===l){let d=e.endLineNumber|0,c=t.endLineNumber|0;if(d===c){let u=e.endColumn|0,p=t.endColumn|0;return u-p}return d-c}return a-l}return r-s}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var qe=class o extends M{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return o.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new o(this.startLineNumber,this.startColumn,e,t):new o(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new A(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new A(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new o(e,t,this.endLineNumber,this.endColumn):new o(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new o(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new o(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,n,i,r){return r===0?new o(e,t,n,i):new o(n,i,e,t)}};function wD(o,e){return new TD(o,e)}var TD=class{constructor(e,t){this.reducer=e;this.options=t}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?je(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let n;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){let i=n.indexOf(t);i>=0&&n.splice(i,1)}}flowData(){if(this.buffer.data.length>0){let e=this.reducer(this.buffer.data);this.emitData(e),this.buffer.data.length=0;let t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(n=>n())}}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function xD(o,e,t){o.on("error",n=>{t?.isCancellationRequested||e.onError(n)}),o.on("end",()=>{t?.isCancellationRequested||e.onEnd()}),o.on("data",n=>{t?.isCancellationRequested||e.onData(n)})}function xP(o,e){let t=wD(e);return t.end(o),t}function _P(o){let e=!1;return{read:()=>e?null:(e=!0,o)}}var aI=typeof Buffer<"u",r7=new Gn(()=>new Uint8Array(256)),_D,LD,_n=class o{static alloc(e){return aI?new o(Buffer.allocUnsafe(e)):new o(new Uint8Array(e))}static wrap(e){return aI&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new o(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&aI?new o(Buffer.from(e)):(_D||(_D=new TextEncoder),new o(_D.encode(e)))}static fromByteArray(e){let t=o.alloc(e.length);for(let n=0,i=e.length;n<i;n++)t.buffer[n]=e[n];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].byteLength}let n=o.alloc(t),i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];n.set(a,i),i+=a.byteLength}return n}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=o.alloc(this.byteLength);return e.set(this),e}toString(){return aI?this.buffer.toString():(LD||(LD=new TextDecoder),LD.decode(this.buffer))}slice(e,t){return new o(this.buffer.subarray(e,t))}set(e,t){if(e instanceof o)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return li(this.buffer,e)}writeUInt32BE(e,t){di(this.buffer,e,t)}readUInt32LE(e){return a7(this.buffer,e)}writeUInt32LE(e,t){l7(this.buffer,e,t)}readUInt8(e){return lI(this.buffer,e)}writeUInt8(e,t){dI(this.buffer,e,t)}indexOf(e,t=0){return s7(this.buffer,e instanceof o?e.buffer:e,t)}};function s7(o,e,t=0){let n=e.byteLength,i=o.byteLength;if(n===0)return 0;if(n===1)return o.indexOf(e[0]);if(n>i-t)return-1;let r=r7.value;r.fill(e.length);for(let d=0;d<e.length;d++)r[e[d]]=e.length-d-1;let s=t+e.length-1,a=s,l=-1;for(;s<i;)if(o[s]===e[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(e.length-a,r[o[s]]),a=e.length-1;return l}function LP(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0}function DP(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255}function li(o,e){return o[e]*2**24+o[e+1]*2**16+o[e+2]*2**8+o[e+3]}function di(o,e,t){o[t+3]=e,e=e>>>8,o[t+2]=e,e=e>>>8,o[t+1]=e,e=e>>>8,o[t]=e}function a7(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0|o[e+2]<<16>>>0|o[e+3]<<24>>>0}function l7(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255,e=e>>>8,o[t+2]=e&255,e=e>>>8,o[t+3]=e&255}function lI(o,e){return o[e]}function dI(o,e,t){o[t]=e}function kP(o){return _P(o)}function RP(o){return xP(o,e=>_n.concat(e))}var kD;function MP(){return kD||(kD=new TextDecoder("UTF-16LE")),kD}var RD;function d7(){return RD||(RD=new TextDecoder("UTF-16BE")),RD}var MD;function OD(){return MD||(MD=RN()?MP():d7()),MD}function OP(o,e,t){let n=new Uint16Array(o.buffer,e,t);return t>0&&(n[0]===65279||n[0]===65534)?c7(o,e,t):MP().decode(n)}function c7(o,e,t){let n=[],i=0;for(let r=0;r<t;r++){let s=LP(o,e);e+=2,n[i++]=String.fromCharCode(s)}return n.join("")}var va=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return OD().decode(e)}_flushBuffer(){let e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){let t=this._capacity-this._bufferLength;t<=1&&(t===0||rn(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){let t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}};function cI(o){return o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var tr=class o{constructor(e,t,n,i){this.oldPosition=e;this.oldText=t;this.newPosition=n;this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${cI(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${cI(this.oldText)}")`:`(replace@${this.oldPosition} "${cI(this.oldText)}" with "${cI(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){let i=t.length;di(e,i,n),n+=4;for(let r=0;r<i;r++)DP(e,t.charCodeAt(r),n),n+=2;return n}static _readString(e,t){let n=li(e,t);return t+=4,OP(e,t,n)}writeSize(){return 8+o._writeStringSize(this.oldText)+o._writeStringSize(this.newText)}write(e,t){return di(e,this.oldPosition,t),t+=4,di(e,this.newPosition,t),t+=4,t=o._writeString(e,this.oldText,t),t=o._writeString(e,this.newText,t),t}static read(e,t,n){let i=li(e,t);t+=4;let r=li(e,t);t+=4;let s=o._readString(e,t);t+=o._writeStringSize(s);let a=o._readString(e,t);return t+=o._writeStringSize(a),n.push(new o(i,s,r,a)),t}};function NP(o,e){return o===null||o.length===0?e:new ND(o,e).compress()}var ND=class o{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(n===null){this._acceptCurr(i),i=this._getCurr(++t);continue}if(i===null){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){let[d,c]=o._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(d),i=c;continue}if(n.newPosition<i.oldPosition){let[d,c]=o._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(d),n=c;continue}let a,l;if(i.oldEnd===n.newEnd)a=n,l=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){let[d,c]=o._splitPrev(n,i.oldLength);a=d,l=i,n=c,i=this._getCurr(++t)}else{let[d,c]=o._splitCurr(i,n.newLength);a=n,l=d,n=this._getPrev(++e),i=c}this._result[this._resultLen++]=new tr(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let r=o._merge(this._result);return o._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=o._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=o._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new tr(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new tr(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){let n=e.newText.substr(0,t),i=e.newText.substr(t);return[new tr(e.oldPosition,e.oldText,e.newPosition,n),new tr(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){let n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new tr(e.oldPosition,n,e.newPosition,e.newText),new tr(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],n=0,i=e[0];for(let r=1;r<e.length;r++){let s=e[r];i.oldEnd===s.oldPosition?i=new tr(i.oldPosition,i.oldText+s.oldText,i.newPosition,i.newText+s.newText):(t[n++]=i,i=s)}return t[n++]=i,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],n=0;for(let i=0;i<e.length;i++){let r=e[i];r.oldText!==r.newText&&(t[n++]=r)}return t}};var Kp=class o{_asciiMap;_map;_defaultValue;constructor(e){let t=Pc(e);this._defaultValue=t,this._asciiMap=o._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let n=Pc(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var AD=class extends Kp{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(e,t){super(0),this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let n=0,i=e.length;n<i;n++)this.set(e.charCodeAt(n),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(let i of this._getIntlSegmenterWordsOnLine(e)){if(i.index>t)break;n=i}return n}findNextIntlWordAtOrAfterOffset(e,t){for(let n of this._getIntlSegmenterWordsOnLine(e))if(!(n.index<t))return n;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}},AP=new Qo(10);function ya(o,e){let t=`${o}/${e.join(",")}`,n=AP.get(t);return n||(n=new AD(o,e),AP.set(t,n)),n}function _d(o,e){let t=Math.pow(10,e);return Math.round(o*t)/t}var et=class{_rgbaBrand=void 0;r;g;b;a;constructor(e,t,n,i=1){this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,n))|0,this.a=_d(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}},xd=class o{_hslaBrand=void 0;h;s;l;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=_d(Math.max(Math.min(1,t),0),3),this.l=_d(Math.max(Math.min(1,n),0),3),this.a=_d(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=e.a,s=Math.max(t,n,i),a=Math.min(t,n,i),l=0,d=0,c=(a+s)/2,u=s-a;if(u>0){switch(d=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),s){case t:l=(n-i)/u+(n<i?6:0);break;case n:l=(i-t)/u+2;break;case i:l=(t-n)/u+4;break}l*=60,l=Math.round(l)}return new o(l,d,c,r)}static _hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}static toRGBA(e){let t=e.h/360,{s:n,l:i,a:r}=e,s,a,l;if(n===0)s=a=l=i;else{let d=i<.5?i*(1+n):i+n-i*n,c=2*i-d;s=o._hue2rgb(c,d,t+1/3),a=o._hue2rgb(c,d,t),l=o._hue2rgb(c,d,t-1/3)}return new et(Math.round(s*255),Math.round(a*255),Math.round(l*255),r)}},Gp=class o{_hsvaBrand=void 0;h;s;v;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=_d(Math.max(Math.min(1,t),0),3),this.v=_d(Math.max(Math.min(1,n),0),3),this.a=_d(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),a=r-s,l=r===0?0:a/r,d;return a===0?d=0:r===t?d=((n-i)/a%6+6)%6:r===n?d=(i-t)/a+2:d=(t-n)/a+4,new o(Math.round(d*60),l,r,e.a)}static toRGBA(e){let{h:t,s:n,v:i,a:r}=e,s=i*n,a=s*(1-Math.abs(t/60%2-1)),l=i-s,[d,c,u]=[0,0,0];return t<60?(d=s,c=a):t<120?(d=a,c=s):t<180?(c=s,u=a):t<240?(c=a,u=s):t<300?(d=a,u=s):t<=360&&(d=s,u=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),u=Math.round((u+l)*255),new et(d,c,u,r)}},V=class o{static fromHex(e){return o.Format.CSS.parseHex(e)||o.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:xd.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:Gp.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof et)this.rgba=e;else if(e instanceof xd)this._hsla=e,this.rgba=xd.toRGBA(e);else if(e instanceof Gp)this._hsva=e,this.rgba=Gp.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&et.equals(this.rgba,e.rgba)&&xd.equals(this.hsla,e.hsla)&&Gp.equals(this.hsva,e.hsva)}getRelativeLuminance(){let e=o._relativeLuminanceForComponent(this.rgba.r),t=o._relativeLuminanceForComponent(this.rgba.g),n=o._relativeLuminanceForComponent(this.rgba.b),i=.2126*e+.7152*t+.0722*n;return _d(i,4)}static _relativeLuminanceForComponent(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n}isDarkerThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t<n}lighten(e){return new o(new xd(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new o(new xd(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new et(t,n,i,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new o(new et(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){let t=e.rgba,n=this.rgba.a,i=t.a,r=n+i*(1-n);if(r<1e-6)return o.transparent;let s=this.rgba.r*n/r+t.r*i*(1-n)/r,a=this.rgba.g*n/r+t.g*i*(1-n)/r,l=this.rgba.b*n/r+t.b*i*(1-n)/r;return new o(new et(s,a,l,r))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new et(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-n),e.rgba.b-r*(e.rgba.b-i),1))}flatten(...e){let t=e.reduceRight((n,i)=>o._flatten(i,n));return o._flatten(this,t)}static _flatten(e,t){let n=1-e.rgba.a;return new o(new et(n*t.rgba.r+e.rgba.a*e.rgba.r,n*t.rgba.g+e.rgba.a*e.rgba.g,n*t.rgba.b+e.rgba.a*e.rgba.b))}_toString;toString(){return this._toString||(this._toString=o.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,n){if(e.isLighterThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(r-i)/r,e.lighten(n)}static getDarkerColor(e,t,n){if(e.isDarkerThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(i-r)/i,e.darken(n)}static white=new o(new et(255,255,255,1));static black=new o(new et(0,0,0,1));static red=new o(new et(255,0,0,1));static blue=new o(new et(0,0,255,1));static green=new o(new et(0,255,0,1));static cyan=new o(new et(0,255,255,1));static lightgrey=new o(new et(211,211,211,1));static transparent=new o(new et(0,0,0,0))};(e=>{let o;(n=>{let t;(f=>{function i(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:e.Format.CSS.formatRGBA(g)}f.formatRGB=i;function r(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}f.formatRGBA=r;function s(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:e.Format.CSS.formatHSLA(g)}f.formatHSL=s;function a(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}f.formatHSLA=a;function l(g){let b=g.toString(16);return b.length!==2?"0"+b:b}function d(g){return`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}`}f.formatHex=d;function c(g,b=!1){return b&&g.rgba.a===1?e.Format.CSS.formatHex(g):`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}${l(Math.round(g.rgba.a*255))}`}f.formatHexA=c;function u(g){return g.isOpaque()?e.Format.CSS.formatHex(g):e.Format.CSS.formatRGBA(g)}f.format=u;function p(g){let b=g.length;if(b===0||g.charCodeAt(0)!==35)return null;if(b===7){let v=16*h(g.charCodeAt(1))+h(g.charCodeAt(2)),I=16*h(g.charCodeAt(3))+h(g.charCodeAt(4)),T=16*h(g.charCodeAt(5))+h(g.charCodeAt(6));return new e(new et(v,I,T,1))}if(b===9){let v=16*h(g.charCodeAt(1))+h(g.charCodeAt(2)),I=16*h(g.charCodeAt(3))+h(g.charCodeAt(4)),T=16*h(g.charCodeAt(5))+h(g.charCodeAt(6)),S=16*h(g.charCodeAt(7))+h(g.charCodeAt(8));return new e(new et(v,I,T,S/255))}if(b===4){let v=h(g.charCodeAt(1)),I=h(g.charCodeAt(2)),T=h(g.charCodeAt(3));return new e(new et(16*v+v,16*I+I,16*T+T))}if(b===5){let v=h(g.charCodeAt(1)),I=h(g.charCodeAt(2)),T=h(g.charCodeAt(3)),S=h(g.charCodeAt(4));return new e(new et(16*v+v,16*I+I,16*T+T,(16*S+S)/255))}return null}f.parseHex=p;function h(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(t=n.CSS||={})})(o=e.Format||={})})(V||={});var Jc=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let o;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?o=crypto.getRandomValues.bind(crypto):o=function(n){for(let i=0;i<n.length;i++)n[i]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),t=[];for(let n=0;n<256;n++)t.push(n.toString(16).padStart(2,"0"));return function(){o(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=0,r="";return r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r}}();var p7=Object.freeze({create:o=>bs(o.map(e=>e.toString())).join(`\r
`),split:o=>o.split(`\r
`),parse:o=>p7.split(o).filter(e=>!e.startsWith("#"))});var PP=class o{constructor(e){this.value=e}static sep=".";static None=new o("@@none@@");static Empty=new o("");equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+o.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new o((this.value?[this.value,...e]:e).join(o.sep))}};var nr=class{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let n="mtk"+this.getForeground(e),i=this.getFontStyle(e);return i&1&&(n+=" mtki"),i&2&&(n+=" mtkb"),i&4&&(n+=" mtku"),i&8&&(n+=" mtks"),n}static getInlineStyleFromMetadata(e,t){let n=this.getForeground(e),i=this.getFontStyle(e),r=`color: ${t[n]};`;i&1&&(r+="font-style: italic;"),i&2&&(r+="font-weight: bold;");let s="";return i&4&&(s+=" underline"),i&8&&(s+=" line-through"),s&&(r+=`text-decoration:${s};`),r}static getPresentationFromMetadata(e){let t=this.getForeground(e),n=this.getFontStyle(e);return{foreground:t,italic:!!(n&1),bold:!!(n&2),underline:!!(n&4),strikethrough:!!(n&8)}}};function mI(o){return!!o&&typeof o.then=="function"}function eu(o){let e=new Rn,t=o(e.token),n=new Promise((i,r)=>{let s=e.token.onCancellationRequested(()=>{s.dispose(),r(new Bi)});Promise.resolve(t).then(a=>{s.dispose(),e.dispose(),i(a)},a=>{s.dispose(),e.dispose(),r(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,r){return n.then(i,r)}catch(i){return this.then(void 0,i)}finally(i){return n.finally(i)}}}function vf(o,e,t){return new Promise((n,i)=>{let r=e.onCancellationRequested(()=>{r.dispose(),n(t)});o.then(n,i).finally(()=>r.dispose())})}function BP(){let o,e;return{promise:new Promise((n,i)=>{o=n,e=i}),resolve:o,reject:e}}var PD=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(t,t).then(n)})}return new Promise((t,n)=>{this.queuedPromise.then(t,n)})}return this.activePromise=e(),new Promise((t,n)=>{this.activePromise.then(i=>{this.activePromise=null,t(i)},i=>{this.activePromise=null,n(i)})})}dispose(){this.isDisposed=!0}};var h7=(o,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},o);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},m7=o=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,o())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},_s=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,r)=>{this.doResolve=i,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===by?m7(n):h7(t,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new Bi),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},ff=class{delayer;throttler;constructor(e){this.delayer=new _s(e),this.throttler=new PD}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},qp=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function wi(o,e){return e?new Promise((t,n)=>{let i=setTimeout(()=>{r.dispose(),t()},o),r=e.onCancellationRequested(()=>{clearTimeout(i),r.dispose(),n(new Bi)})}):eu(t=>wi(o,t))}function yf(o,e=0,t){let n=setTimeout(()=>{o(),t&&i.dispose()},e),i=pe(()=>{clearTimeout(n),t?.deleteAndLeak(i)});return t?.add(i),i}var Ls=class{_token;_isDisposed=!1;constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new $e("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new $e("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},uI=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new $e("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let i=n.setInterval(()=>{e()},t);this.disposable=pe(()=>{n.clearInterval(i),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},ln=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var Dd,jp;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?jp=(o,e)=>{$v(()=>{if(t)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:jp=(o,e,t)=>{let n=o.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),i=!1;return{dispose(){i||(i=!0,o.cancelIdleCallback(n))}}},Dd=o=>jp(globalThis,o)})();var pI=class{_executor;_handle;_didRun=!1;_value;_error;constructor(e,t){this._executor=()=>{try{this._value=t()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=jp(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},bf=class extends pI{constructor(e){super(globalThis,e)}};var hI=class{_running;_queued;isRunning(e){return typeof e=="number"?this._running?.taskId===e:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(e,t,n){return this._running={taskId:e,cancel:()=>n?.(),promise:t},t.then(()=>this.doneRunning(e),()=>this.doneRunning(e)),t}doneRunning(e){this._running&&e===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let e=this._queued;this._queued=void 0,e.run().then(e.promiseResolve,e.promiseReject)}}queue(e){if(this._queued)this._queued.run=e;else{let{promise:t,resolve:n,reject:i}=BP();this._queued={run:e,promise:t,promiseResolve:n,promiseReject:i}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var Ld=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new Bi)}},Ao;(t=>{async function o(n){let i,r=await Promise.all(n.map(s=>s.then(a=>a,a=>{i||(i=a)})));if(typeof i<"u")throw i;return r}t.settled=o;function e(n){return new Promise(async(i,r)=>{try{await n(i,r)}catch(s){r(s)}})}t.withAsyncBody=e})(Ao||={});var FP=class o{static fromArray(e){return new o(t=>{t.emitMany(e)})}static fromPromise(e){return new o(async t=>{t.emitMany(await e)})}static fromPromises(e){return new o(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new o(async t=>{await Promise.all(e.map(async n=>{for await(let i of n)t.emitOne(i)}))})}static EMPTY=o.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new k,queueMicrotask(async()=>{let n={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(n)),this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await j.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new o(async n=>{for await(let i of e)n.emitOne(t(i))})}map(e){return o.map(this,e)}static filter(e,t){return new o(async n=>{for await(let i of e)t(i)&&n.emitOne(i)})}filter(e){return o.filter(this,e)}static coalesce(e){return o.filter(e,t=>!!t)}coalesce(){return o.coalesce(this)}static async toPromise(e){let t=[];for await(let n of e)t.push(n);return t}toPromise(){return o.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var gI="**",WP="/",fI="[/\\\\]",bI="[^/\\\\]",g7=/\//g;function VP(o,e){switch(o){case 0:return"";case 1:return`${bI}*?`;default:return`(?:${fI}|${bI}+${fI}${e?`|${fI}${bI}+`:""})*?`}}function HP(o,e){if(!o)return[];let t=[],n=!1,i=!1,r="";for(let s of o){switch(s){case e:if(!n&&!i){t.push(r),r="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":i=!0;break;case"]":i=!1;break}r+=s}return r&&t.push(r),t}function jP(o){if(!o)return"";let e="",t=HP(o,WP);if(t.every(n=>n===gI))e=".*";else{let n=!1;t.forEach((i,r)=>{if(i===gI){if(n)return;e+=VP(2,r===t.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of i){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let u;c==="-"?u=c:(c==="^"||c==="!")&&!d?u="^":c===WP?u="":u=fo(c),d+=u;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let p=`(?:${HP(a,",").map(h=>jP(h)).join("|")})`;e+=p,s=!1,a="";break}case"]":{e+="["+d+"]",l=!1,d="";break}case"?":e+=bI;continue;case"*":e+=VP(1);continue;default:e+=fo(c)}}r<t.length-1&&(t[r+1]!==gI||r+2<t.length)&&(e+=fI)}n=i===gI})}return e}var f7=/^\*\*\/\*\.[\w\.-]+$/,b7=/^\*\*\/([\w\.-]+)\/?$/,v7=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,y7=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,I7=/^\*\*((\/[\w\.-]+)+)\/?$/,C7=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,UP=new Qo(1e4),zP=function(){return!1},Ia=function(){return null};function BD(o,e){if(!o)return Ia;let t;typeof o!="string"?t=o.pattern:t=o,t=t.trim();let n=`${t}_${!!e.trimForExclusions}`,i=UP.get(n);if(i)return KP(i,o);let r;return f7.test(t)?i=S7(t.substr(4),t):(r=b7.exec(FD(t,e)))?i=E7(r[1],t):(e.trimForExclusions?y7:v7).test(t)?i=T7(t,e):(r=I7.exec(FD(t,e)))?i=GP(r[1].substr(1),t,!0):(r=C7.exec(FD(t,e)))?i=GP(r[1],t,!1):i=w7(t),UP.set(n,i),KP(i,o)}function KP(o,e){if(typeof e=="string")return o;let t=function(n,i){return Qg(n,e.base,!Wt)?o(Ty(n.substr(e.base.length),si),i):null};return t.allBasenames=o.allBasenames,t.allPaths=o.allPaths,t.basenames=o.basenames,t.patterns=o.patterns,t}function FD(o,e){return e.trimForExclusions&&o.endsWith("/**")?o.substr(0,o.length-2):o}function S7(o,e){return function(t,n){return typeof t=="string"&&t.endsWith(o)?e:null}}function E7(o,e){let t=`/${o}`,n=`\\${o}`,i=function(s,a){return typeof s!="string"?null:a?a===o?e:null:s===o||s.endsWith(t)||s.endsWith(n)?e:null},r=[o];return i.basenames=r,i.patterns=[e],i.allBasenames=r,i}function T7(o,e){let t=qP(o.slice(1,-1).split(",").map(a=>BD(a,e)).filter(a=>a!==Ia),o),n=t.length;if(!n)return Ia;if(n===1)return t[0];let i=function(a,l){for(let d=0,c=t.length;d<c;d++)if(t[d](a,l))return o;return null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function GP(o,e,t){let n=si===bt.sep,i=n?o:o.replace(g7,si),r=si+i,s=bt.sep+o,a;return t?a=function(l,d){return typeof l=="string"&&(l===i||l.endsWith(r)||!n&&(l===o||l.endsWith(s)))?e:null}:a=function(l,d){return typeof l=="string"&&(l===i||!n&&l===o)?e:null},a.allPaths=[(t?"*/":"./")+o],a}function w7(o){try{let e=new RegExp(`^${jP(o)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?o:null}}catch{return Ia}}function WD(o,e={}){if(!o)return zP;if(typeof o=="string"||x7(o)){let t=BD(o,e);if(t===Ia)return zP;let n=function(i,r){return!!t(i,r)};return t.allBasenames&&(n.allBasenames=t.allBasenames),t.allPaths&&(n.allPaths=t.allPaths),n}return _7(o,e)}function x7(o){let e=o;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function _7(o,e){let t=qP(Object.getOwnPropertyNames(o).map(a=>L7(a,o[a],e)).filter(a=>a!==Ia)),n=t.length;if(!n)return Ia;if(!t.some(a=>!!a.requiresSiblings)){if(n===1)return t[0];let a=function(c,u){let p;for(let h=0,f=t.length;h<f;h++){let g=t[h](c,u);if(typeof g=="string")return g;mI(g)&&(p||(p=[]),p.push(g))}return p?(async()=>{for(let h of p){let f=await h;if(typeof f=="string")return f}return null})():null},l=t.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=t.reduce((c,u)=>u.allPaths?c.concat(u.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let i=function(a,l,d){let c,u;for(let p=0,h=t.length;p<h;p++){let f=t[p];f.requiresSiblings&&d&&(l||(l=R_(a)),c||(c=l.substr(0,l.length-Jv(a).length)));let g=f(a,l,c,d);if(typeof g=="string")return g;mI(g)&&(u||(u=[]),u.push(g))}return u?(async()=>{for(let p of u){let h=await p;if(typeof h=="string")return h}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function L7(o,e,t){if(e===!1)return Ia;let n=BD(o,t);if(n===Ia)return Ia;if(typeof e=="boolean")return n;if(e){let i=e.when;if(typeof i=="string"){let r=(s,a,l,d)=>{if(!d||!n(s,a))return null;let c=i.replace("$(basename)",()=>l),u=d(c);return mI(u)?u.then(p=>p?o:null):u?o:null};return r.requiresSiblings=!0,r}}return n}function qP(o,e){let t=o.filter(a=>!!a.basenames);if(t.length<2)return o;let n=t.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),i;if(e){i=[];for(let a=0,l=n.length;a<l;a++)i.push(e)}else i=t.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let r=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let u=a.charCodeAt(c-1);if(u===47||u===92)break}l=a.substr(c)}let d=n.indexOf(l);return d!==-1?i[d]:null};r.basenames=n,r.patterns=i,r.allBasenames=n;let s=o.filter(a=>!a.basenames);return s.push(r),s}var If=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new k;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),pe(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let n=new VD(this,e,t);return this._factories.set(e,n),pe(()=>{let i=this._factories.get(e);!i||i!==n||(this._factories.delete(e),i.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;let n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},VD=class extends F{constructor(t,n,i){super();this._registry=t;this._languageId=n;this._factory=i}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}};function Po(o){let e=0,t=0,n=0,i=0;for(let r=0,s=o.length;r<s;r++){let a=o.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<s&&o.charCodeAt(r+1)===10?(i|=2,r++):i|=3,n=r+1):a===10&&(i|=1,e===0&&(t=r),e++,n=r+1)}return e===0&&(t=o.length),[e,t,o.length-n,i]}var ke=class o{constructor(e,t){this.start=e;this.endExclusive=t;if(e>t)throw new $e(`Invalid range: ${this.toString()}`)}static addRange(e,t){let n=0;for(;n<t.length&&t[n].endExclusive<e.start;)n++;let i=n;for(;i<t.length&&t[i].start<=e.endExclusive;)i++;if(n===i)t.splice(n,0,e);else{let r=Math.min(e.start,t[n].start),s=Math.max(e.endExclusive,t[i-1].endExclusive);t.splice(n,i-n,new o(r,s))}}static tryCreate(e,t){if(!(e>t))return new o(e,t)}static ofLength(e){return new o(0,e)}static ofStartAndLength(e,t){return new o(e,e+t)}static emptyAt(e){return new o(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new o(this.start+e,this.endExclusive+e)}deltaStart(e){return new o(this.start+e,this.endExclusive)}deltaEnd(e){return new o(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new o(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(t<=n)return new o(t,n)}intersectionLength(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-t)}intersects(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<n}intersectsOrTouches(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new $e(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new $e(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let n=this.start;n<this.endExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}},vI=class o{_sortedRanges=[];addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let n=t;for(;n<this._sortedRanges.length&&this._sortedRanges[n].start<=e.endExclusive;)n++;if(t===n)this._sortedRanges.splice(t,0,e);else{let i=Math.min(e.start,this._sortedRanges[t].start),r=Math.max(e.endExclusive,this._sortedRanges[n-1].endExclusive);this._sortedRanges.splice(t,n-t,new ke(i,r))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){let t=new o;for(let n of this._sortedRanges){let i=n.intersect(e);i&&t.addRange(i)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}};var HD=class o{constructor(e){this._tokenInfo=e}static create(e){return new o(e)}forEach(e){let t=0;for(let n of this._tokenInfo){let i=new ke(t,t+n.length);e(i,n),t+=n.length}}slice(e){let t=[],n=0;for(let i of this._tokenInfo){let r=n,s=r+i.length;if(s>e.start){if(r>=e.endExclusive)break;let a=Math.max(0,e.start-r),l=Math.max(0,s-e.endExclusive);t.push(new yI(i.length-a-l,i.metadata))}n+=i.length}return o.create(t)}},yI=class{constructor(e,t){this.length=e;this.metadata=t}},II=class{_tokens=[];add(e,t){this._tokens.push(new yI(e,t))}build(){return HD.create(this._tokens)}};var vn=class o{static createEmpty(e,t){let n=o.defaultTokenMetadata,i=new Uint32Array(2);return i[0]=e.length,i[1]=n,new o(i,e,t)}static createFromTextAndMetadata(e,t){let n=0,i="",r=new Array;for(let{text:s,metadata:a}of e)r.push(n+s.length,a),n+=s.length,i+=s;return new o(new Uint32Array(r),i,t)}static convertToEndOffset(e,t){let i=(e.length>>>1)-1;for(let r=0;r<i;r++)e[r<<1]=e[r+1<<1];e[i<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){let r=n+Math.floor((i-n)/2),s=e[r<<1];if(s===t)return r+1;s<t?n=r+1:s>t&&(i=r)}return n}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(e,t,n){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=n}equals(e){return e instanceof o?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,n){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let i=t<<1,r=i+(n<<1);for(let s=i;s<r;s++)if(this._tokens[s]!==e._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let t=this._tokens[(e<<1)+1],n=nr.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(n)}getStandardTokenType(e){let t=this._tokens[(e<<1)+1];return nr.getTokenType(t)}getForeground(e){let t=this._tokens[(e<<1)+1];return nr.getForeground(t)}getClassName(e){let t=this._tokens[(e<<1)+1];return nr.getClassNameFromMetadata(t)}getInlineStyle(e,t){let n=this._tokens[(e<<1)+1];return nr.getInlineStyleFromMetadata(n,t)}getPresentation(e){let t=this._tokens[(e<<1)+1];return nr.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return o.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new UD(this,e,t,n)}withInserted(e){if(e.length===0)return this;let t=0,n=0,i="",r=new Array,s=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=n<e.length?e[n]:null;if(a!==-1&&(l===null||a<=l.offset)){i+=this._text.substring(s,a);let d=this._tokens[(t<<1)+1];r.push(i.length,d),t++,s=a}else if(l){if(l.offset>s){i+=this._text.substring(s,l.offset);let d=this._tokens[(t<<1)+1];r.push(i.length,d),s=l.offset}i+=l.text,r.push(i.length,l.tokenMetadata),n++}else break}return new o(new Uint32Array(r),i,this.languageIdCodec)}getTokensInRange(e){let t=new II,n=this.findTokenIndexAtOffset(e.start),i=this.findTokenIndexAtOffset(e.endExclusive);for(let r=n;r<=i;r++){let a=new ke(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(r))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),n=this.getEndOffset(e);return this._text.substring(t,n)}forEach(e){let t=this.getCount();for(let n=0;n<t;n++)e(n)}},UD=class o{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,s=e.getCount();r<s&&!(e.getStartOffset(r)>=n);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof o?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,n=this._source.getStartOffset(t),i=this._source.getEndOffset(t),r=this._source.getTokenText(t);return n<this._startOffset&&(r=r.substring(this._startOffset-n)),i>this._endOffset&&(r=r.substring(0,r.length-(i-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}};var Ca=new Uint32Array(0).buffer,ci=class o{static deleteBeginning(e,t){return e===null||e===Ca?e:o.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===Ca)return e;let n=Sa(e),i=n[n.length-2];return o.delete(e,t,i)}static delete(e,t,n){if(e===null||e===Ca||t===n)return e;let i=Sa(e),r=i.length>>>1;if(t===0&&i[i.length-2]===n)return Ca;let s=vn.findIndexInTokensArray(i,t),a=s>0?i[s-1<<1]:0,l=i[s<<1];if(n<l){let h=n-t;for(let f=s;f<r;f++)i[f<<1]-=h;return e}let d,c;a!==t?(i[s<<1]=t,d=s+1<<1,c=t):(d=s<<1,c=a);let u=n-t;for(let h=s+1;h<r;h++){let f=i[h<<1]-u;f>c&&(i[d++]=f,i[d++]=i[(h<<1)+1],c=f)}if(d===i.length)return e;let p=new Uint32Array(d);return p.set(i.subarray(0,d),0),p.buffer}static append(e,t){if(t===Ca)return e;if(e===Ca)return t;if(e===null)return e;if(t===null)return null;let n=Sa(e),i=Sa(t),r=i.length>>>1,s=new Uint32Array(n.length+i.length);s.set(n,0);let a=n.length,l=n[n.length-2];for(let d=0;d<r;d++)s[a++]=i[d<<1]+l,s[a++]=i[(d<<1)+1];return s.buffer}static insert(e,t,n){if(e===null||e===Ca)return e;let i=Sa(e),r=i.length>>>1,s=vn.findIndexInTokensArray(i,t);s>0&&i[s-1<<1]===t&&s--;for(let a=s;a<r;a++)i[a<<1]+=n;return e}};function Sa(o){return o instanceof Uint32Array?o:new Uint32Array(o)}var De=class o{static fromRange(e){return new o(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new o(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(e.startLineNumber,t.startLineNumber),new o(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new o(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new Rr(e[0].slice());for(let n=1;n<e.length;n++)t=t.getUnion(new Rr(e[n].slice()));return t.ranges}static join(e){if(e.length===0)throw new $e("lineRanges cannot be empty");let t=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let i=1;i<e.length;i++)t=Math.min(t,e[i].startLineNumber),n=Math.max(n,e[i].endLineNumberExclusive);return new o(t,n)}static ofLength(e,t){return new o(e,e+t)}static deserialize(e){return new o(e[0],e[1])}startLineNumber;endLineNumberExclusive;constructor(e,t){if(e>t)throw new $e(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new o(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new o(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new o(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=n)return new o(t,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new M(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new M(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new ke(this.startLineNumber-1,this.endLineNumberExclusive-1)}},Rr=class o{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=kg(this._normalizedRanges,i=>i.endLineNumberExclusive>=e.startLineNumber),n=ll(this._normalizedRanges,i=>i.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)this._normalizedRanges.splice(t,0,e);else if(t===n-1){let i=this._normalizedRanges[t];this._normalizedRanges[t]=i.join(e)}else{let i=this._normalizedRanges[t].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(t,n-t,i)}}contains(e){let t=al(this._normalizedRanges,n=>n.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=al(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],n=0,i=0,r=null;for(;n<this._normalizedRanges.length||i<e._normalizedRanges.length;){let s=null;if(n<this._normalizedRanges.length&&i<e._normalizedRanges.length){let a=this._normalizedRanges[n],l=e._normalizedRanges[i];a.startLineNumber<l.startLineNumber?(s=a,n++):(s=l,i++)}else n<this._normalizedRanges.length?(s=this._normalizedRanges[n],n++):(s=e._normalizedRanges[i],i++);r===null?r=s:r.endLineNumberExclusive>=s.startLineNumber?r=new De(r.startLineNumber,Math.max(r.endLineNumberExclusive,s.endLineNumberExclusive)):(t.push(r),r=s)}return r!==null&&t.push(r),new o(t)}subtractFrom(e){let t=kg(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),n=ll(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)return new o([e]);let i=[],r=e.startLineNumber;for(let s=t;s<n;s++){let a=this._normalizedRanges[s];a.startLineNumber>r&&i.push(new De(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&i.push(new De(r,e.endLineNumberExclusive)),new o(i)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],n=0,i=0;for(;n<this._normalizedRanges.length&&i<e._normalizedRanges.length;){let r=this._normalizedRanges[n],s=e._normalizedRanges[i],a=r.intersect(s);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<s.endLineNumberExclusive?n++:i++}return new o(t)}getWithDelta(e){return new o(this._normalizedRanges.map(t=>t.delta(e)))}};var Cf=class o{static deserialize(e,t,n){let i=new Uint32Array(e.buffer),r=li(e,t);t+=4;let s=li(e,t);t+=4;let a=[];for(let l=0;l<s;l++){let d=li(e,t);t+=4,a.push(i.subarray(t/4,t/4+d/4)),t+=d}return n.push(new o(r,a)),t}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new De(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e=0;e+=4,e+=4;for(let t=0;t<this._tokens.length;t++){let n=this._tokens[t];if(!(n instanceof Uint32Array))throw new Error("Not supported!");e+=4,e+=n.byteLength}return e}serialize(e,t){di(e,this._startLineNumber,t),t+=4,di(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++){let i=this._tokens[n];if(!(i instanceof Uint32Array))throw new Error("Not supported!");di(e,i.byteLength,t),t+=4,e.set(new Uint8Array(i.buffer),t),t+=i.byteLength}return t}applyEdit(e,t){let[n,i]=Po(t);this._acceptDeleteRange(e),this._acceptInsertText(new A(e.startLineNumber,e.startColumn),n,i)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let i=n-t;this._startLineNumber-=i;return}if(!(t>=this._tokens.length)){if(t<0&&n>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===n){this._tokens[t]=ci.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=ci.deleteEnding(this._tokens[t],e.startColumn-1),n<this._tokens.length){let i=ci.deleteBeginning(this._tokens[n],e.endColumn-1);this._tokens[t]=ci.append(this._tokens[t],i),this._tokens.splice(t+1,n-t)}else this._tokens[t]=ci.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else{let i=-t;this._startLineNumber-=i,this._tokens[n]=ci.deleteBeginning(this._tokens[n],e.endColumn-1),this._tokens=this._tokens.slice(n)}}}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-this._startLineNumber;if(i<0){this._startLineNumber+=t;return}if(!(i>=this._tokens.length)){if(t===0){this._tokens[i]=ci.insert(this._tokens[i],e.column-1,n);return}this._tokens[i]=ci.deleteEnding(this._tokens[i],e.column-1),this._tokens[i]=ci.insert(this._tokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._tokens=la(this._tokens,e,n)}};var CI=(i=>(i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i))(CI||{});(a=>{let o="error",e="warning",t="warn",n="info",i="ignore";function r(l){return l?Lr(o,l)?3:Lr(e,l)||Lr(t,l)?2:Lr(n,l)?1:0:0}a.fromValue=r;function s(l){switch(l){case 3:return o;case 2:return e;case 1:return n;default:return i}}a.toString=s})(CI||={});var ui=CI;var R7=Object.freeze({View:kn("view","View"),Help:kn("help","Help"),Test:kn("test","Test"),File:kn("file","File"),Preferences:kn("preferences","Preferences"),Developer:kn({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});var Gi=Q("commandService"),ir=new class{_commands=new Map;_onDidRegisterCommand=new k;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(o,e){if(!o)throw new Error("invalid command");if(typeof o=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:o,handler:e})}if(o.metadata&&Array.isArray(o.metadata.args)){let s=[];for(let l of o.metadata.args)s.push(l.constraint);let a=o.handler;o.handler=function(l,...d){return AA(d,s),a(l,...d)}}let{id:t}=o,n=this._commands.get(t);n||(n=new Vi,this._commands.set(t,n));let i=n.unshift(o),r=pe(()=>{i(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(o,e){return ir.registerCommand(o,(t,...n)=>t.get(Gi).executeCommand(e,...n))}getCommand(o){let e=this._commands.get(o);if(!(!e||e.isEmpty()))return Je.first(e)}getCommands(){let o=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&o.set(e,t)}return o}};ir.registerCommand("noop",()=>{});function YP(o){return o?o.condition!==void 0:!1}var aie=Q("IBuiltinExtensionsScannerService");var Sf=(i=>(i[i.Hint=1]="Hint",i[i.Info=2]="Info",i[i.Warning=4]="Warning",i[i.Error=8]="Error",i))(Sf||{});(r=>{function o(s,a){return a-s}r.compare=o;let e=Object.create(null);e[8]=m("sev.error","Error"),e[4]=m("sev.warning","Warning"),e[2]=m("sev.info","Info");function t(s){return e[s]||""}r.toString=t;function n(s){switch(s){case ui.Error:return 8;case ui.Warning:return 4;case ui.Info:return 2;case ui.Ignore:return 1}}r.fromSeverity=n;function i(s){switch(s){case 8:return ui.Error;case 4:return ui.Warning;case 2:return ui.Info;case 1:return ui.Ignore}}r.toSeverity=i})(Sf||={});var M7;(n=>{let o="";function e(i){return t(i,!0)}n.makeKey=e;function t(i,r){let s=[o];return i.source?s.push(i.source.replace("\xA6","\\\xA6")):s.push(o),i.code?typeof i.code=="string"?s.push(i.code.replace("\xA6","\\\xA6")):s.push(i.code.value.replace("\xA6","\\\xA6")):s.push(o),i.severity!==void 0&&i.severity!==null?s.push(Sf.toString(i.severity)):s.push(o),i.message&&r?s.push(i.message.replace("\xA6","\\\xA6")):s.push(o),i.startLineNumber!==void 0&&i.startLineNumber!==null?s.push(i.startLineNumber.toString()):s.push(o),i.startColumn!==void 0&&i.startColumn!==null?s.push(i.startColumn.toString()):s.push(o),i.endLineNumber!==void 0&&i.endLineNumber!==null?s.push(i.endLineNumber.toString()):s.push(o),i.endColumn!==void 0&&i.endColumn!==null?s.push(i.endColumn.toString()):s.push(o),s.push(o),s.join("\xA6")}n.makeKeyOptionalMessage=t})(M7||={});var ZP=Q("markerService");var SI=class{constructor(e,t){this.tokens=e;this.endState=t}_encodedTokenizationResultBrand=void 0};var O7;(i=>{let o=new Map;o.set(0,ae.symbolMethod),o.set(1,ae.symbolFunction),o.set(2,ae.symbolConstructor),o.set(3,ae.symbolField),o.set(4,ae.symbolVariable),o.set(5,ae.symbolClass),o.set(6,ae.symbolStruct),o.set(7,ae.symbolInterface),o.set(8,ae.symbolModule),o.set(9,ae.symbolProperty),o.set(10,ae.symbolEvent),o.set(11,ae.symbolOperator),o.set(12,ae.symbolUnit),o.set(13,ae.symbolValue),o.set(15,ae.symbolEnum),o.set(14,ae.symbolConstant),o.set(15,ae.symbolEnum),o.set(16,ae.symbolEnumMember),o.set(17,ae.symbolKeyword),o.set(27,ae.symbolSnippet),o.set(18,ae.symbolText),o.set(19,ae.symbolColor),o.set(20,ae.symbolFile),o.set(21,ae.symbolReference),o.set(22,ae.symbolCustomColor),o.set(23,ae.symbolFolder),o.set(24,ae.symbolTypeParameter),o.set(25,ae.account),o.set(26,ae.issues);function e(r){let s=o.get(r);return s||(console.info("No codicon found for CompletionItemKind "+r),s=ae.symbolProperty),s}i.toIcon=e;let t=new Map;t.set("method",0),t.set("function",1),t.set("constructor",2),t.set("field",3),t.set("variable",4),t.set("class",5),t.set("struct",6),t.set("interface",7),t.set("module",8),t.set("property",9),t.set("event",10),t.set("operator",11),t.set("unit",12),t.set("value",13),t.set("constant",14),t.set("enum",15),t.set("enum-member",16),t.set("enumMember",16),t.set("keyword",17),t.set("snippet",27),t.set("text",18),t.set("color",19),t.set("file",20),t.set("reference",21),t.set("customcolor",22),t.set("folder",23),t.set("type-parameter",24),t.set("typeParameter",24),t.set("account",25),t.set("issue",26);function n(r,s){let a=t.get(r);return typeof a>"u"&&!s&&(a=9),a}i.fromString=n})(O7||={});var aoe={17:m("Array","array"),16:m("Boolean","boolean"),4:m("Class","class"),13:m("Constant","constant"),8:m("Constructor","constructor"),9:m("Enum","enumeration"),21:m("EnumMember","enumeration member"),23:m("Event","event"),7:m("Field","field"),0:m("File","file"),11:m("Function","function"),10:m("Interface","interface"),19:m("Key","key"),5:m("Method","method"),1:m("Module","module"),2:m("Namespace","namespace"),20:m("Null","null"),15:m("Number","number"),18:m("Object","object"),24:m("Operator","operator"),3:m("Package","package"),6:m("Property","property"),14:m("String","string"),22:m("Struct","struct"),25:m("TypeParameter","type parameter"),12:m("Variable","variable")};var KD;(t=>{let o=new Map;o.set(0,ae.symbolFile),o.set(1,ae.symbolModule),o.set(2,ae.symbolNamespace),o.set(3,ae.symbolPackage),o.set(4,ae.symbolClass),o.set(5,ae.symbolMethod),o.set(6,ae.symbolProperty),o.set(7,ae.symbolField),o.set(8,ae.symbolConstructor),o.set(9,ae.symbolEnum),o.set(10,ae.symbolInterface),o.set(11,ae.symbolFunction),o.set(12,ae.symbolVariable),o.set(13,ae.symbolConstant),o.set(14,ae.symbolString),o.set(15,ae.symbolNumber),o.set(16,ae.symbolBoolean),o.set(17,ae.symbolArray),o.set(18,ae.symbolObject),o.set(19,ae.symbolKey),o.set(20,ae.symbolNull),o.set(21,ae.symbolEnumMember),o.set(22,ae.symbolStruct),o.set(23,ae.symbolEvent),o.set(24,ae.symbolOperator),o.set(25,ae.symbolTypeParameter);function e(n){let i=o.get(n);return i||(console.info("No codicon found for SymbolKind "+n),i=ae.symbolProperty),i}t.toIcon=e})(KD||={});var QP=class o{constructor(e){this.value=e}static Comment=new o("comment");static Imports=new o("imports");static Region=new o("region");static fromValue(e){switch(e){case"comment":return o.Comment;case"imports":return o.Imports;case"region":return o.Region}return new o(e)}};var N7;(e=>{function o(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}e.is=o})(N7||={});var or=new If,Ef=new If;var $n=Q("languageService");function Ea(o,e){let t=o.getCount(),n=o.findTokenIndexAtOffset(e),i=o.getLanguageId(n),r=n;for(;r+1<t&&o.getLanguageId(r+1)===i;)r++;let s=n;for(;s>0&&o.getLanguageId(s-1)===i;)s--;return new GD(o,i,s,r+1,o.getStartOffset(s),o.getEndOffset(r))}var GD=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(e,t,n,i,r,s){this._actual=e,this.languageId=t,this._firstTokenIndex=n,this._lastTokenIndex=i,this.firstCharOffset=r,this._lastCharOffset=s,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},XP=(e=>(e[e.value=3]="value",e))(XP||{});function Jr(o){return(o&XP.value)!==0}var $p=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(e){if(this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,n=e.notIn.length;t<n;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;let n=e.findTokenIndexAtOffset(t-2),i=e.getStandardTokenType(n);return this.isOK(i)}_findNeutralCharacterInRange(e,t){for(let n=e;n<=t;n++){let i=String.fromCharCode(n);if(!this.open.includes(i)&&!this.close.includes(i))return i}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},EI=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let t of e)Tf(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),Tf(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),Tf(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),Tf(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&Tf(this.autoClosingPairsCloseSingleChar,t.close,t)}};function Tf(o,e,t){o.has(e)?o.get(e).push(t):o.set(e,[t])}var jD=class o{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(e,t,n,i,r,s){this.languageId=e,this.index=t,this.open=n,this.close=i,this.forwardRegex=r,this.reversedRegex=s,this._openSet=o._toSet(this.open),this._closeSet=o._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){let t=new Set;for(let n of e)t.add(n);return t}};function A7(o){let e=o.length;o=o.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let t=[];for(let s=0;s<e;s++)t[s]=s;let n=(s,a)=>{let[l,d]=s,[c,u]=a;return l===c||l===u||d===c||d===u},i=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<e;c++)t[c]===d&&(t[c]=l)};for(let s=0;s<e;s++){let a=o[s];for(let l=s+1;l<e;l++){let d=o[l];n(a,d)&&i(t[s],t[l])}}let r=[];for(let s=0;s<e;s++){let a=[],l=[];for(let d=0;d<e;d++)if(t[d]===s){let[c,u]=o[d];a.push(c),l.push(u)}a.length>0&&r.push({open:a,close:l})}return r}var TI=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(e,t){let n=A7(t);this.brackets=n.map((i,r)=>new jD(e,r,i.open,i.close,P7(i.open,i.close,n,r),F7(i.open,i.close,n,r))),this.forwardRegex=B7(this.brackets),this.reversedRegex=W7(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let i of this.brackets){for(let r of i.open)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(let r of i.close)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}};function JP(o,e,t,n){for(let i=0,r=e.length;i<r;i++){if(i===t)continue;let s=e[i];for(let a of s.open)a.indexOf(o)>=0&&n.push(a);for(let a of s.close)a.indexOf(o)>=0&&n.push(a)}}function eF(o,e){return o.length-e.length}function wI(o){if(o.length<=1)return o;let e=[],t=new Set;for(let n of o)t.has(n)||(e.push(n),t.add(n));return e}function P7(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)JP(i[r],t,n,i);return i=wI(i),i.sort(eF),i.reverse(),Yp(i)}function F7(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)JP(i[r],t,n,i);return i=wI(i),i.sort(eF),i.reverse(),Yp(i.map(qD))}function B7(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=wI(e),Yp(e)}function W7(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=wI(e),Yp(e.map(qD))}function V7(o){let e=/^[\w ]+$/.test(o);return o=fo(o),e?`\\b${o}\\b`:o}function Yp(o,e){let t=`(${o.map(V7).join(")|(")})`;return wy(t,!0,e)}var qD=function(){function o(n){let i=new Uint16Array(n.length),r=0;for(let s=n.length-1;s>=0;s--)i[r++]=n.charCodeAt(s);return OD().decode(i)}let e=null,t=null;return function(i){return e!==i&&(e=i,t=o(e)),t}}(),yo=class{static _findPrevBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=n.length-(r.index||0),a=r[0].length,l=i+s;return new M(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,n,i,r){let a=qD(n).substring(n.length-r,n.length-i);return this._findPrevBracketInText(e,t,a,i)}static findNextBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=r.index||0,a=r[0].length;if(a===0)return null;let l=i+s;return new M(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,n,i,r){let s=n.substring(i,r);return this.findNextBracketInText(e,t,s,i)}};var xI=class{constructor(e,t){this.languageId=e;let n=t.brackets?tF(t.brackets):[],i=new md(a=>{let l=new Set;return{info:new $D(this,a,l),closing:l}}),r=new md(a=>{let l=new Set,d=new Set;return{info:new YD(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of n){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=t.colorizedBracketPairs?tF(t.colorizedBracketPairs):n.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...i.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){let t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return Yp(t,e)}};function tF(o){return o.filter(([e,t])=>e!==""&&t!=="")}var _I=class{constructor(e,t){this.config=e;this.bracketText=t}get languageId(){return this.config.languageId}},$D=class extends _I{constructor(t,n,i){super(t,n);this.openedBrackets=i}isOpeningBracket=!0},YD=class extends _I{constructor(t,n,i,r){super(t,n);this.openingBrackets=i;this.openingColorizedBrackets=r}isOpeningBracket=!1;closes(t){return t.config!==this.config?!1:this.openingBrackets.has(t)}closesColorized(t){return t.config!==this.config?!1:this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}};var Ft=class o{static _nextVisibleColumn(e,t,n){return e===9?o.nextRenderTabStop(t,n):Dr(e)||qg(e)?t+2:t+1}static visibleColumnFromColumn(e,t,n){let i=Math.min(t-1,e.length),r=e.substring(0,i),s=new Wc(r),a=0;for(;!s.eol();){let l=Lp(r,i,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,n)}return a}static toStatusbarColumn(e,t,n){let i=e.substring(0,Math.min(t-1,e.length)),r=new Bc(i),s=0;for(;!r.eol();)r.nextCodePoint()===9?s=o.nextRenderTabStop(s,n):s=s+1;return s+1}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;let i=e.length,r=new Wc(e),s=0,a=1;for(;!r.eol();){let l=Lp(e,i,r.offset);r.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,n),c=r.offset+1;if(d>=t){let u=t-s;return d-t<u?c:a}s=d,a=c}return i+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}};var Fo=class o{constructor(e,t){this.lineCount=e;this.columnCount=t}static zero=new o(0,0);static lengthDiffNonNegative(e,t){return t.isLessThan(e)?o.zero:e.lineCount===t.lineCount?new o(0,t.columnCount-e.columnCount):new o(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new o(0,t.column-e.column):new o(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return o.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,n=0;for(let i of e)i===`
`?(t++,n=0):n++;return new o(t,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new o(this.lineCount,this.columnCount+e.columnCount):new o(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new M(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new M(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new M(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new A(e.lineNumber,e.column+this.columnCount):new A(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};function nF(o,e,t,n){return o!==t?Qt(t-o,n):Qt(0,n-e)}var Yn=0;function Zp(o){return o===0}var rr=2**26;function Qt(o,e){return o*rr+e}function Ji(o){let e=o,t=Math.floor(e/rr),n=e-t*rr;return new Fo(t,n)}function iF(o){return Math.floor(o/rr)}function Kt(o,e){let t=o+e;return e>=rr&&(t=t-o%rr),t}function oF(o,e){return o.reduce((t,n)=>Kt(t,e(n)),Yn)}function ZD(o,e){return o===e}function nu(o,e){let t=o,n=e;if(n-t<=0)return Yn;let r=Math.floor(t/rr),s=Math.floor(n/rr),a=n-s*rr;if(r===s){let l=t-r*rr;return Qt(0,a-l)}else return Qt(s-r,a)}function Il(o,e){return o<e}function kd(o,e){return o<=e}function Qp(o,e){return o>=e}function Rd(o){return Qt(o.lineNumber-1,o.column-1)}function Md(o,e){let t=o,n=Math.floor(t/rr),i=t-n*rr,r=e,s=Math.floor(r/rr),a=r-s*rr;return new M(n+1,i+1,s+1,a+1)}function rF(o){let e=Hg(o);return Qt(e.length-1,e[e.length-1].length)}var LI=[],xi=class o{constructor(e,t){this.items=e;this.additionalItems=t}static cache=new Array(129);static create(e,t){if(e<=128&&t.length===0){let n=o.cache[e];return n||(n=new o(e,t),o.cache[e]=n),n}return new o(e,t)}static empty=o.create(0,LI);static getEmpty(){return this.empty}add(e,t){let n=t.getKey(e),i=n>>5;if(i===0){let s=1<<n|this.items;return s===this.items?this:o.create(s,this.additionalItems)}i--;let r=this.additionalItems.slice(0);for(;r.length<i;)r.push(0);return r[i]|=1<<(n&31),o.create(this.items,r)}has(e,t){let n=t.getKey(e),i=n>>5;return i===0?(this.items&1<<n)!==0:(i--,((this.additionalItems[i]||0)&1<<(n&31))!==0)}merge(e){let t=this.items|e.items;if(this.additionalItems===LI&&e.additionalItems===LI)return t===this.items?this:t===e.items?e:o.create(t,LI);let n=[];for(let i=0;i<Math.max(this.additionalItems.length,e.additionalItems.length);i++){let r=this.additionalItems[i]||0,s=e.additionalItems[i]||0;n.push(r|s)}return o.create(t,n)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}equals(e){if(this.items!==e.items||this.additionalItems.length!==e.additionalItems.length)return!1;for(let t=0;t<this.additionalItems.length;t++)if(this.additionalItems[t]!==e.additionalItems[t])return!1;return!0}},QD={getKey(o){return o}},DI=class{items=new Map;getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}reverseLookup(e){return[...this.items].find(([t,n])=>n===e)?.[0]}reverseLookupSet(e){let t=[];for(let[n]of this.items)e.has(n,this)&&t.push(n);return t}keys(){return this.items.keys()}};var kI=class o{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new $p(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new $p({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){let t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new $p({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var RI=class{_richEditBrackets;constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(let t of this._richEditBrackets.brackets)for(let n of t.close){let i=n.charAt(n.length-1);e.push(i)}return bs(e)}onElectricCharacter(e,t,n){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let i=t.findTokenIndexAtOffset(n-1);if(Jr(t.getStandardTokenType(i)))return null;let r=this._richEditBrackets.reversedRegex,s=t.getLineContent().substring(0,n-1)+e,a=yo.findPrevBracketInRange(r,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function MI(o){return o.global&&(o.lastIndex=0),!0}var OI=class{_indentationRules;constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&MI(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&MI(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&MI(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&MI(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}};var NI=class o{_brackets;_regExpRules;constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{let n=o._createOpenBracketRegExp(t[0]),i=o._createCloseBracketRegExp(t[1]);n&&i&&this._brackets.push({open:t[0],openRegExp:n,close:t[1],closeRegExp:i})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,n,i){if(e>=3)for(let r=0,s=this._regExpRules.length;r<s;r++){let a=this._regExpRules[r];if([{reg:a.beforeText,text:n},{reg:a.afterText,text:i},{reg:a.previousLineText,text:t}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(e>=2&&n.length>0&&i.length>0)for(let r=0,s=this._brackets.length;r<s;r++){let a=this._brackets[r];if(a.openRegExp.test(n)&&a.closeRegExp.test(i))return{indentAction:2}}if(e>=2&&n.length>0){for(let r=0,s=this._brackets.length;r<s;r++)if(this._brackets[r].openRegExp.test(n))return{indentAction:1}}return null}static _createOpenBracketRegExp(e){let t=fo(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",o._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=fo(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,o._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return je(t),null}}};var H7=[];function ji(o,e,t){e instanceof Yg||(e=new Yg(e,[],!!t)),H7.push([o,e])}var iu=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});var U7={ModesRegistry:"editor.modesRegistry"},JD=class{_languages;_onDidChangeLanguages=new k;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}},aF=new JD;lt.add(U7.ModesRegistry,aF);var Ds="plaintext",z7=".txt";aF.registerLanguage({id:Ds,extensions:[z7],aliases:[m("plainText.alias","Plain Text"),"text"],mimetypes:[iu.text]});lt.as(Qr.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var xf=class{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}},Cl=Q("languageConfigurationService"),wf=class extends F{constructor(t,n){super();this.configurationService=t;this.languageService=n;let i=new Set(Object.values(e0));this._register(this.configurationService.onDidChangeConfiguration(r=>{let s=r.change.keys.some(l=>i.has(l)),a=r.change.overrides.filter(([l,d])=>d.some(c=>i.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new xf(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new xf(l)))})),this._register(this._registry.onDidChange(r=>{this.configurations.delete(r.languageId),this.onDidChangeEmitter.fire(new xf(r.languageId))}))}_serviceBrand;_registry=this._register(new n0);onDidChangeEmitter=this._register(new k);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(t,n,i){return this._registry.register(t,n,i)}getLanguageConfiguration(t){let n=this.configurations.get(t);return n||(n=K7(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,n)),n}};wf=P([_(0,ut),_(1,$n)],wf);function K7(o,e,t,n){let i=e.getLanguageConfiguration(o);if(!i){if(!n.isRegisteredLanguageId(o))return new Xp(o,{});i=new Xp(o,{})}let r=G7(i.languageId,t),s=dF([i.underlyingConfig,r]);return new Xp(i.languageId,s)}var e0={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function G7(o,e){let t=e.getValue(e0.brackets,{overrideIdentifier:o}),n=e.getValue(e0.colorizedBracketPairs,{overrideIdentifier:o});return{brackets:lF(t),colorizedBracketPairs:lF(n)}}function lF(o){if(Array.isArray(o))return o.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function FI(o,e,t){let n=o.getLineContent(e),i=jn(n);return i.length>t-1&&(i=i.substring(0,t-1)),i}var t0=class{constructor(e){this.languageId=e;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(e,t){let n=new AI(e,t,++this._order);return this._entries.push(n),this._resolved=null,pe(()=>{for(let i=0;i<this._entries.length;i++)if(this._entries[i]===n){this._entries.splice(i,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let e=this._resolve();e&&(this._resolved=new Xp(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(AI.cmp),dF(this._entries.map(e=>e.configuration)))}};function dF(o){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let t of o)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}var AI=class{constructor(e,t,n){this.configuration=e;this.priority=t;this.order=n}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}},PI=class{constructor(e){this.languageId=e}},n0=class extends F{_entries=new Map;_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(Ds,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,n=0){let i=this._entries.get(e);i||(i=new t0(e),this._entries.set(e,i));let r=i.register(t,n);return this._onDidChange.fire(new PI(e)),pe(()=>{r.dispose(),this._onDidChange.fire(new PI(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}},Xp=class o{constructor(e,t){this.languageId=e;this.underlyingConfig=t;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new NI(this.underlyingConfig):null,this.comments=o._handleComments(this.underlyingConfig),this.characterPair=new kI(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||Uy,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new OI(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new xI(e,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return tf(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new TI(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new RI(this.brackets)),this._electricCharacter}onEnter(e,t,n,i){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,n,i):null}getAutoClosingPairs(){return new EI(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){let t=e.comments;if(!t)return null;let n={};if(t.lineComment&&(n.lineCommentToken=t.lineComment),t.blockComment){let[i,r]=t.blockComment;n.blockCommentStartToken=i,n.blockCommentEndToken=r}return n}};ji(Cl,wf,1);var i0=class o{constructor(e){this.map=e}static createFromLanguage(e,t){function n(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}let i=new Map;for(let r of e.bracketsNew.openingBrackets){let s=Qt(0,r.bracketText.length),a=n(r),l=xi.getEmpty().add(a,QD);i.set(r.bracketText,new ks(s,1,a,l,_f.create(s,r,l)))}for(let r of e.bracketsNew.closingBrackets){let s=Qt(0,r.bracketText.length),a=xi.getEmpty(),l=r.getOpeningBrackets();for(let d of l)a=a.add(n(d),QD);i.set(r.bracketText,new ks(s,2,n(l[0]),a,_f.create(s,r,a)))}return new o(i)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>j7(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(let[t,n]of this.map)if(n.kind===2&&n.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}};function j7(o){let e=fo(o);return/^[\w ]+/.test(o)&&(e=`\\b${e}`),/[\w ]+$/.test(o)&&(e=`${e}\\b`),e}var BI=class{constructor(e,t){this.denseKeyProvider=e;this.getLanguageConfiguration=t}languageIdToBracketTokens=new Map;didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=i0.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}getToken(e,t){return this.getSingleLanguageBracketTokens(t).getToken(e)}};var ks=class{constructor(e,t,n,i,r){this.length=e;this.kind=t;this.bracketId=n;this.bracketIds=i;this.astNode=r}},WI=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new o0(this.textModel,this.bracketTokens);_offset=Yn;get offset(){return this._offset}get length(){return Qt(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(e){this.didPeek=!1,this._offset=Kt(this._offset,e);let t=Ji(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}didPeek=!1;peeked=null;read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=Kt(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},o0=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let e=this.lineIdx,t=this.lineCharOffset,n=0;for(;;){let r=this.lineTokens,s=r.getCount(),a=null;if(this.lineTokenOffset<s){let l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=nr.getTokenType(l)===0,c=nr.containsBalancedBrackets(l),u=r.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<u){let p=r.getLanguageId(this.lineTokenOffset),h=this.line.substring(this.lineCharOffset,u),f=this.bracketTokens.getSingleLanguageBracketTokens(p),g=f.regExpGlobal;if(g){g.lastIndex=0;let b=g.exec(h);b&&(a=f.getToken(b[0]),a&&(this.lineCharOffset+=b.index))}}if(n+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n+=33,n>1e3))break;if(n>1500)break}let i=nF(e,t,this.lineIdx,this.lineCharOffset);return new ks(i,0,-1,xi.getEmpty(),new Rs(i))}},VI=class{constructor(e,t){this.text=e;let n=t.getRegExpStr(),i=n?new RegExp(n+`|
`,"gi"):null,r=[],s,a=0,l=0,d=0,c=0,u=[];for(let f=0;f<60;f++)u.push(new ks(Qt(0,f),0,-1,xi.getEmpty(),new Rs(Qt(0,f))));let p=[];for(let f=0;f<60;f++)p.push(new ks(Qt(1,f),0,-1,xi.getEmpty(),new Rs(Qt(1,f))));if(i)for(i.lastIndex=0;(s=i.exec(e))!==null;){let f=s.index,g=s[0];if(g===`
`)a++,l=f+1;else{if(d!==f){let b;if(c===a){let v=f-d;if(v<u.length)b=u[v];else{let I=Qt(0,v);b=new ks(I,0,-1,xi.getEmpty(),new Rs(I))}}else{let v=a-c,I=f-l;if(v===1&&I<p.length)b=p[I];else{let T=Qt(v,I);b=new ks(T,0,-1,xi.getEmpty(),new Rs(T))}}r.push(b)}r.push(t.getToken(g)),d=f+g.length,c=a}}let h=e.length;if(d!==h){let f=c===a?Qt(0,h-d):Qt(a-c,h-l);r.push(new ks(f,0,-1,xi.getEmpty(),new Rs(f)))}this.length=Qt(a,h-l),this.tokens=r}_offset=Yn;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new ty}getText(){return this.text}};var Lf=class{_length;get length(){return this._length}constructor(e){this._length=e}},Df=class o extends Lf{constructor(t,n,i,r,s){super(t);this.openingBracket=n;this.child=i;this.closingBracket=r;this.missingOpeningBracketIds=s}static create(t,n,i){let r=t.length;return n&&(r=Kt(r,n.length)),i&&(r=Kt(r,i.length)),new o(r,t,n,i,n?n.missingOpeningBracketIds:xi.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}canBeReused(t){return!(this.closingBracket===null||t.intersects(this.missingOpeningBracketIds))}flattenLists(){return o.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new o(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,n){return this.child?this.child.computeMinIndentation(Kt(t,this.openingBracket.length),n):Number.MAX_SAFE_INTEGER}},sr=class o extends Lf{constructor(t,n,i){super(t);this.listHeight=n;this._missingOpeningBracketIds=i}static create23(t,n,i,r=!1){let s=t.length,a=t.missingOpeningBracketIds;if(t.listHeight!==n.listHeight)throw new Error("Invalid list heights");if(s=Kt(s,n.length),a=a.merge(n.missingOpeningBracketIds),i){if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=Kt(s,i.length),a=a.merge(i.missingOpeningBracketIds)}return r?new r0(s,t.listHeight+1,t,n,i,a):new kf(s,t.listHeight+1,t,n,i,a)}static create(t,n=!1){if(t.length===0)return this.getEmpty();{let i=t[0].length,r=t[0].missingOpeningBracketIds;for(let s=1;s<t.length;s++)i=Kt(i,t[s].length),r=r.merge(t[s].missingOpeningBracketIds);return n?new HI(i,t[0].listHeight+1,t,r):new Rf(i,t[0].listHeight+1,t,r)}}static getEmpty(){return new HI(Yn,0,[],xi.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let t=this.childrenLength;if(t===0)return;let n=this.getChild(t-1),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(t-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let n=this.getChild(0),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(0,i),i}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let n=this;for(;n.kind===4;){let i=n.childrenLength;if(i===0)throw new $e;n=n.getChild(i-1)}return n.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();let t=this.childrenLength,n=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let r=1;r<t;r++){let s=this.getChild(r);n=Kt(n,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=n,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}flattenLists(){let t=[];for(let n of this.children){let i=n.flattenLists();i.kind===4?t.push(...i.children):t.push(i)}return o.create(t)}computeMinIndentation(t,n){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,r=t;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(i=Math.min(i,a.computeMinIndentation(r,n)),r=Kt(r,a.length))}return this.cachedMinIndentation=i,i}},kf=class o extends sr{constructor(t,n,i,r,s,a){super(t,n,a);this._item1=i;this._item2=r;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,n){switch(t){case 0:this._item1=n;return;case 1:this._item2=n;return;case 2:this._item3=n;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new o(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}},r0=class extends kf{toMutable(){return new kf(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},Rf=class o extends sr{constructor(t,n,i,r){super(t,n,r);this._children=i}get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,n){this._children[t]=n}get children(){return this._children}deepClone(){let t=new Array(this._children.length);for(let n=0;n<this._children.length;n++)t[n]=this._children[n].deepClone();return new o(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}},HI=class extends Rf{toMutable(){return new Rf(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},$7=[],Mf=class extends Lf{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return $7}flattenLists(){return this}deepClone(){return this}},Rs=class extends Mf{get kind(){return 0}get missingOpeningBracketIds(){return xi.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){let n=Ji(e),i=(n.columnCount===0?n.lineCount:n.lineCount+1)+1,r=iF(Kt(e,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=i;a<=r;a++){let l=t.getLineFirstNonWhitespaceColumn(a),d=t.getLineContent(a);if(l===0)continue;let c=Ft.visibleColumnFromColumn(d,l,t.getOptions().tabSize);s=Math.min(s,c)}return s}},_f=class o extends Mf{constructor(t,n,i){super(t);this.bracketInfo=n;this.bracketIds=i}static create(t,n,i){return new o(t,n,i)}get kind(){return 1}get missingOpeningBracketIds(){return xi.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,n){return Number.MAX_SAFE_INTEGER}},UI=class extends Mf{get kind(){return 3}missingOpeningBracketIds;constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}};var Of=class{constructor(e,t,n,i){this.range=e;this.nestingLevel=t;this.nestingLevelOfEqualBracketType=n;this.isInvalid=i}},s0=class{constructor(e,t,n,i,r,s){this.range=e;this.openingBracketRange=t;this.closingBracketRange=n;this.nestingLevel=i;this.nestingLevelOfEqualBracketType=r;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},zI=class extends s0{constructor(t,n,i,r,s,a,l){super(t,n,i,r,s,a);this.minVisibleColumnIndentation=l}};var KI=class{changeType=1},Bo=class o{constructor(e,t,n,i,r){this.ownerId=e;this.lineNumber=t;this.column=n;this.options=i;this.order=r}static applyInjectedText(e,t){if(!t||t.length===0)return e;let n="",i=0;for(let r of t)n+=e.substring(i,r.column-1),i=r.column-1,n+=r.options.content;return n+=e.substring(i),n}static fromDecorations(e){let t=[];for(let n of e)n.options.before&&n.options.before.content.length>0&&t.push(new o(n.ownerId,n.range.startLineNumber,n.range.startColumn,n.options.before,0)),n.options.after&&n.options.after.content.length>0&&t.push(new o(n.ownerId,n.range.endLineNumber,n.range.endColumn,n.options.after,1));return t.sort((n,i)=>n.lineNumber===i.lineNumber?n.column===i.column?n.order-i.order:n.column-i.column:n.lineNumber-i.lineNumber),t}withText(e){return new o(this.ownerId,this.lineNumber,this.column,{...this.options,content:e},this.order)}},Nf=class{changeType=2;lineNumber;detail;injectedText;constructor(e,t,n){this.lineNumber=e,this.detail=t,this.injectedText=n}},GI=class{changeType=3;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},jI=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(e,t,n,i){this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}},qI=class{changeType=5},ou=class o{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.versionId,r=e.isUndoing||t.isUndoing,s=e.isRedoing||t.isRedoing;return new o(n,i,r,s)}},Jp=class{changes;constructor(e){this.changes=e}},Nd=class o{constructor(e,t){this.rawContentChangedEvent=e;this.contentChangedEvent=t}merge(e){let t=ou.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=o._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new o(t,n)}static _mergeChangeEvents(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.eol,r=t.versionId,s=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,d=e.isEolChange&&t.isEolChange;return{changes:n,eol:i,isEolChange:d,versionId:r,isUndoing:s,isRedoing:a,isFlush:l}}};var es=class{constructor(e,t,n,i,r,s){this.visibleColumn=e;this.column=t;this.className=n;this.horizontalLine=i;this.forWrappedLinesAfterColumn=r;this.forWrappedLinesBeforeOrAtColumn=s;if(e!==-1==(t!==-1))throw new Error}},Sl=class{constructor(e,t){this.top=e;this.endColumn=t}};var $I=class o{constructor(e){this.edits=e;let t=-1;for(let n of e){if(!(n.replaceRange.start>=t))throw new $e(`Edits must be disjoint and sorted. Found ${n} after ${t}`);t=n.replaceRange.endExclusive}}static empty=new o([]);static fromJson(e){return new o(e.map(Ms.fromJson))}static replace(e,t){return new o([new Ms(e,t)])}static insert(e,t){return o.replace(ke.emptyAt(e),t)}normalize(){let e=[],t;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(t&&t.replaceRange.endExclusive===n.replaceRange.start?t=new Ms(t.replaceRange.join(n.replaceRange),t.newText+n.newText):(t&&e.push(t),t=n));return t&&e.push(t),new o(e)}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],n=0;for(let i of this.edits)t.push(e.substring(n,i.replaceRange.start)),t.push(i.newText),n=i.replaceRange.endExclusive;return t.push(e.substring(n)),t.join("")}compose(e){return Z7(this,e)}inverse(e){let t=[],n=0;for(let i of this.edits)t.push(new Ms(ke.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e.substring(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new o(t)}getNewTextRanges(){let e=[],t=0;for(let n of this.edits)e.push(ke.ofStartAndLength(n.replaceRange.start+t,n.newText.length)),t+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],n=0,i=0,r=0;for(;i<this.edits.length||n<e.edits.length;){let s=e.edits[n],a=this.edits[i];if(a)s?a.replaceRange.intersects(s.replaceRange)?i++:a.replaceRange.start<s.replaceRange.start?(t.push(new Ms(a.replaceRange.delta(r),a.newText)),i++):(n++,r+=s.newText.length-s.replaceRange.length):(t.push(new Ms(a.replaceRange.delta(r),a.newText)),i++);else break}return new o(t)}applyToOffset(e){let t=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+t;t+=n.newText.length-n.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new ke(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let t=0;for(let n of this.edits){let i=n.newText.length;if(n.replaceRange.start<=e-t){if(e-t<n.replaceRange.start+i)return n.replaceRange.start;t+=i-n.replaceRange.length}else break}return e-t}},Ms=class o{constructor(e,t){this.replaceRange=e;this.newText=t}static fromJson(e){return new o(ke.ofStartAndLength(e.pos,e.len),e.txt)}static insert(e,t){return new o(ke.emptyAt(e),t)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function Z7(o,e){if(o=o.normalize(),e=e.normalize(),o.isEmpty)return e;if(e.isEmpty)return o;let t=[...o.edits],n=[],i=0;for(let r of e.edits){for(;;){let d=t[0];if(!d||d.replaceRange.start+i+d.newText.length>=r.replaceRange.start)break;t.shift(),n.push(d),i+=d.newText.length-d.replaceRange.length}let s=i,a,l;for(;;){let d=t[0];if(!d||d.replaceRange.start+i>r.replaceRange.endExclusive)break;a||(a=d),l=d,t.shift(),i+=d.newText.length-d.replaceRange.length}if(!a)n.push(new Ms(r.replaceRange.delta(-i),r.newText));else{let d="",c=r.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let u=l.replaceRange.endExclusive+i-r.replaceRange.endExclusive;if(u>0){let f=new Ms(ke.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-u));t.unshift(f),i-=f.newText.length-f.replaceRange.length}let p=d+r.newText,h=new ke(Math.min(a.replaceRange.start,r.replaceRange.start-s),r.replaceRange.endExclusive-i);n.push(new Ms(h,p))}}for(;;){let r=t.shift();if(!r)break;n.push(r)}return new $I(n).normalize()}var pF=Q("undoRedoService");var cF=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o},uF=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o};var eh=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&Ei(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}},Ad=class{_findMatchBrand=void 0;range;matches;constructor(e,t){this.range=e,this.matches=t}};function hF(o){return o&&typeof o.read=="function"}var th=class{constructor(e,t,n,i,r,s){this.identifier=e;this.range=t;this.text=n;this.forceMoveMarkers=i;this.isAutoWhitespaceEdit=r;this._isTracked=s}},YI=class{regex;wordSeparators;simpleSearch;constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}},ZI=class{constructor(e,t,n){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=n}};var Af={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};function l0(o){let e=o;return typeof e?.resolve=="function"&&typeof e?.isResolved=="function"}var Mn=Q("fileService");function mF(o){return!!(o.capabilities&2)}function gF(o){return!!(o.capabilities&2048)}var d0=class o extends Error{constructor(t,n){super(t);this.code=n}static create(t,n){let i=new o(t.toString(),n);return X7(i,n),i}};function X7(o,e){return o.name=e?`${e} (FileSystemError)`:"FileSystemError",o}function J7(o){if(!o)return"Unknown";if(o instanceof d0)return o.code;let e=/^(.+) \(FileSystemError\)$/.exec(o.name);if(!e)return"Unknown";switch(e[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function fF(o){if(o instanceof nh)return o.fileOperationResult;switch(J7(o)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var nh=class extends Error{constructor(t,n,i){super(t);this.fileOperationResult=n;this.options=i}},QI=class extends nh{constructor(t,n,i,r){super(t,n,r);this.fileOperationResult=n;this.size=i}},XI=class extends nh{constructor(t,n,i){super(t,2,i);this.stat=n}};var Os={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},ih={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"};var bF="files.readonlyInclude",vF="files.readonlyExclude";var Pf="";var JI=class o{static KB=1024;static MB=o.KB*o.KB;static GB=o.MB*o.KB;static TB=o.GB*o.KB;static formatSize(e){return Ui(e)||(e=0),e<o.KB?m("sizeB","{0}B",e.toFixed(0)):e<o.MB?m("sizeKB","{0}KB",(e/o.KB).toFixed(2)):e<o.GB?m("sizeMB","{0}MB",(e/o.MB).toFixed(2)):e<o.TB?m("sizeGB","{0}GB",(e/o.GB).toFixed(2)):m("sizeTB","{0}TB",(e/o.TB).toFixed(2))}};var e9=Q("textModelService");var yF="";var Pd=class extends F{_onWillDispose=this._register(new k);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var ar=Q("modelService");var eC=Q("ILanguageDetectionService"),c0="languageDetection";var Ns=class extends Pd{constructor(t,n,i,r,s){super();this.modelService=t;this.languageService=n;this.languageDetectionService=i;this.accessibilityService=r;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new on);autoDetectLanguageThrottler=this._register(new ff(Ns.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(t){let n=this.modelService.getModel(t);if(!n)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.textEditorModelHandle=t,this.registerModelDisposeListener(n)}registerModelDisposeListener(t){this.modelDisposeListener.value=t.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(t,n){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(t,n)}setLanguageIdInternal(t,n){this.isResolved()&&(!t||t===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(t),n))}installModelListeners(t){let n=this._register(t.onDidChangeLanguage(i=>{i.source!==c0&&(this._hasLanguageSetExplicitly=!0,n.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??Ds))return;let t=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),n=this.getLanguageId();if(t&&t!==n&&!this.isDisposed()){this.setLanguageIdInternal(t,c0);let i=this.languageService.getLanguageName(t);this.accessibilityService.alert(m("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",i??t))}}createTextEditorModel(t,n,i){let r=this.getFirstLineText(t),s=this.getOrCreateLanguage(n,this.languageService,i,r);return this.doCreateTextEditorModel(t,s,n)}doCreateTextEditorModel(t,n,i){let r=i&&this.modelService.getModel(i);return r?this.updateTextEditorModel(t,n.languageId):(r=this.modelService.createModel(t,n,i),this.createdEditorModel=!0,this.registerModelDisposeListener(r)),this.textEditorModelHandle=r.uri,r}getFirstLineText(t){let n=t;return typeof n.getFirstLineText=="function"?n.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(t,n,i,r){return!i||i===Ds?n.createByFilepathOrFirstLine(t??null,r):n.createById(i)}updateTextEditorModel(t,n){this.isResolved()&&(t&&this.modelService.updateModel(this.textEditorModel,t),n&&n!==Ds&&this.textEditorModel.getLanguageId()!==n&&this.textEditorModel.setLanguage(this.languageService.createById(n)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};Ns=P([_(0,ar),_(1,$n),_(2,eC),_(3,vo)],Ns);var tC=Q("workingCopyBackupService");var Mr=Q("textResourceConfigurationService"),Zue=Q("textResourcePropertiesService");function t9(o,e,t){let n=0;for(let r=0;r<o.length;r++)o.charAt(r)==="	"?n=Ft.nextIndentTabStop(n,e):n++;let i="";if(!t){let r=Math.floor(n/e);n=n%e;for(let s=0;s<r;s++)i+="	"}for(let r=0;r<n;r++)i+=" ";return i}function nC(o,e,t){let n=fn(o);return n===-1&&(n=o.length),t9(o.substring(0,n),e,t)+o.substring(n)}var ts=class o{constructor(e,t,n){this.startOffset=e;this.endOffset=t;this.newLength=n}static fromModelContentChanges(e){return e.map(n=>{let i=M.lift(n.range);return new o(Rd(i.getStartPosition()),Rd(i.getEndPosition()),rF(n.text))}).reverse()}toString(){return`[${Ji(this.startOffset)}...${Ji(this.endOffset)}) -> ${Ji(this.newLength)}`}},iC=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(e){this.edits=e.map(t=>u0.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);let t=this.edits[this.nextEditIdx],n=t?this.translateOldToCur(t.offsetObj):null;return n===null?null:nu(e,n)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Qt(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Qt(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){let t=Ji(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Qt(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Qt(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){let t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if(kd(n,e)){this.nextEditIdx++;let i=Ji(n),r=Ji(this.translateOldToCur(t.endOffsetBeforeObj)),s=i.lineCount-r.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=i.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}},u0=class o{static from(e){return new o(e.startOffset,e.endOffset,e.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(e,t,n){this.endOffsetBeforeObj=Ji(t),this.endOffsetAfterObj=Ji(Kt(e,n)),this.offsetObj=Ji(e)}};function SF(o){if(o.length===0)return null;if(o.length===1)return o[0];let e=0;function t(){if(e>=o.length)return null;let s=e,a=o[s].listHeight;for(e++;e<o.length&&o[e].listHeight===a;)e++;return e-s>=2?h0(s===0&&e===o.length?o:o.slice(s,e),!1):o[s]}let n=t(),i=t();if(!i)return n;for(let s=t();s;s=t())IF(n,i)<=IF(i,s)?(n=p0(n,i),i=s):i=p0(i,s);return p0(n,i)}function h0(o,e=!1){if(o.length===0)return null;if(o.length===1)return o[0];let t=o.length;for(;t>3;){let n=t>>1;for(let i=0;i<n;i++){let r=i<<1;o[i]=sr.create23(o[r],o[r+1],r+3===t?o[r+2]:null,e)}t=n}return sr.create23(o[0],o[1],t>=3?o[2]:null,e)}function IF(o,e){return Math.abs(o.listHeight-e.listHeight)}function p0(o,e){return o.listHeight===e.listHeight?sr.create23(o,e,null,!1):o.listHeight>e.listHeight?n9(o,e):i9(e,o)}function n9(o,e){o=o.toMutable();let t=o,n=[],i;for(;;){if(e.listHeight===t.listHeight){i=e;break}if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeLastElementMutable()}for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=sr.create23(s.unappendChild(),i,null,!1):(s.appendChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?sr.create23(o,i,null,!1):o}function i9(o,e){o=o.toMutable();let t=o,n=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeFirstElementMutable()}let i=e;for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=sr.create23(i,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?sr.create23(i,o,null,!1):o}var oC=class{nextNodes;offsets;idxs;lastOffset=Yn;constructor(e){this.nextNodes=[e],this.offsets=[Yn],this.idxs=[]}readLongestNodeAt(e,t){if(Il(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){let n=Ff(this.nextNodes);if(!n)return;let i=Ff(this.offsets);if(Il(e,i))return;if(Il(i,e))if(Kt(i,n.length)<=e)this.nextNodeAfterCurrent();else{let r=m0(n);r!==-1?(this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(n))return this.nextNodeAfterCurrent(),n;{let r=m0(n);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){let e=Ff(this.offsets),t=Ff(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let n=Ff(this.nextNodes),i=m0(n,this.idxs[this.idxs.length-1]);if(i!==-1){this.nextNodes.push(n.getChild(i)),this.offsets.push(Kt(e,t.length)),this.idxs[this.idxs.length-1]=i;break}else this.idxs.pop()}}};function m0(o,e=-1){for(;;){if(e++,e>=o.childrenLength)return-1;if(o.getChild(e))return e}}function Ff(o){return o.length>0?o[o.length-1]:void 0}function f0(o,e,t,n){return new g0(o,e,t,n).parseDocument()}var g0=class{constructor(e,t,n,i){this.tokenizer=e;this.createImmutableLists=i;if(n&&i)throw new Error("Not supported");this.oldNodeReader=n?new oC(n):void 0,this.positionMapper=new iC(t)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(xi.getEmpty(),0);return e||(e=sr.getEmpty()),e}parseList(e,t){let n=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||n.push(r)}return this.oldNodeReader?SF(n):h0(n,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){let t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!Zp(t)){let n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),i=>t!==null&&!Il(i.length,t)?!1:i.canBeReused(e));if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}}parseChild(e,t){this._itemsConstructed++;let n=this.tokenizer.read();switch(n.kind){case 2:return new UI(n.bracketIds,n.length);case 0:return n.astNode;case 1:{if(t>300)return new Rs(n.length);let i=e.merge(n.bracketIds),r=this.parseList(i,t+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===n.bracketId||s.bracketIds.intersects(n.bracketIds))?(this.tokenizer.read(),Df.create(n.astNode,r,s.astNode)):Df.create(n.astNode,r,null)}default:throw new Error("unexpected")}}};function oh(o,e){if(o.length===0)return e;if(e.length===0)return o;let t=new Wi(EF(o)),n=EF(e);n.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let i=t.dequeue();function r(d){if(d===void 0){let u=t.takeWhile(p=>!0)||[];return i&&u.unshift(i),u}let c=[];for(;i&&!Zp(d);){let[u,p]=i.splitAt(d);c.push(u),d=nu(u.lengthAfter,d),i=p??t.dequeue()}return Zp(d)||c.push(new Bf(!1,d,d)),c}let s=[];function a(d,c,u){if(s.length>0&&ZD(s[s.length-1].endOffset,d)){let p=s[s.length-1];s[s.length-1]=new ts(p.startOffset,c,Kt(p.newLength,u))}else s.push({startOffset:d,endOffset:c,newLength:u})}let l=Yn;for(let d of n){let c=r(d.lengthBefore);if(d.modified){let u=oF(c,h=>h.lengthBefore),p=Kt(l,u);a(l,p,d.lengthAfter),l=p}else for(let u of c){let p=l;l=Kt(l,u.lengthBefore),u.modified&&a(p,l,u.lengthAfter)}}return s}var Bf=class o{constructor(e,t,n){this.modified=e;this.lengthBefore=t;this.lengthAfter=n}splitAt(e){let t=nu(e,this.lengthAfter);return ZD(t,Yn)?[this,void 0]:this.modified?[new o(this.modified,this.lengthBefore,e),new o(this.modified,Yn,t)]:[new o(this.modified,e,e),new o(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${Ji(this.lengthBefore)} -> ${Ji(this.lengthAfter)}`}};function EF(o){let e=[],t=Yn;for(let n of o){let i=nu(t,n.startOffset);Zp(i)||e.push(new Bf(!1,i,i));let r=nu(n.startOffset,n.endOffset);e.push(new Bf(!0,r,n.newLength)),t=n.endOffset}return e}var rC=class extends F{constructor(t,n){super();this.textModel=t;this.getLanguageConfiguration=n;if(t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),r=new VI(this.textModel.getValue(),i);this.initialAstWithoutTokens=f0(r,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new k;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new DI;brackets=new BI(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(t){return this.brackets.didLanguageChange(t)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){let n=t.map(i=>new ts(Qt(i.fromLineNumber-1,0),Qt(i.toLineNumber,0),Qt(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(n,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){let n=ts.fromModelContentChanges(t.changes);this.handleEdits(n,!1)}handleEdits(t,n){let i=oh(this.queuedTextEdits,t);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!n&&(this.queuedTextEditsForInitialAstWithoutTokens=oh(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,n,i){let s=n,a=new WI(this.textModel,this.brackets);return f0(a,t,s,i)}getBracketsInRange(t,n){this.flushQueue();let i=Qt(t.startLineNumber-1,t.startColumn-1),r=Qt(t.endLineNumber-1,t.endColumn-1);return new cl(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;b0(a,Yn,a.length,i,r,s,0,0,new Map,n)})}getBracketPairsInRange(t,n){this.flushQueue();let i=Rd(t.getStartPosition()),r=Rd(t.getEndPosition());return new cl(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new v0(s,n,this.textModel);y0(a,Yn,a.length,i,r,l,0,new Map)})}getFirstBracketAfter(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return wF(n,Yn,n.length,Rd(t))}getFirstBracketBefore(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return TF(n,Yn,n.length,Rd(t))}};function TF(o,e,t,n){if(o.kind===4||o.kind===2){let i=[];for(let r of o.children)t=Kt(e,r.length),i.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=i.length-1;r>=0;r--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=i[r];if(Il(s,n)){let l=TF(o.children[r],s,a,n);if(l)return l}}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=Md(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function wF(o,e,t,n){if(o.kind===4||o.kind===2){for(let i of o.children){if(t=Kt(e,i.length),Il(n,t)){let r=wF(i,e,t,n);if(r)return r}e=t}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=Md(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function b0(o,e,t,n,i,r,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(o.kind){case 4:{let u=o.childrenLength;for(let p=0;p<u;p++){let h=o.getChild(p);if(h){if(t=Kt(e,h.length),kd(e,i)&&Qp(t,n)){if(Qp(t,i)){o=h;continue e}if(!b0(h,e,t,n,i,r,s,0,l,d))return!1}e=t}}return!0}case 2:{let u=!d||!o.closingBracket||o.closingBracket.bracketInfo.closesColorized(o.openingBracket.bracketInfo),p=0;if(l){let f=l.get(o.openingBracket.text);f===void 0&&(f=0),p=f,u&&(f++,l.set(o.openingBracket.text,f))}let h=o.childrenLength;for(let f=0;f<h;f++){let g=o.getChild(f);if(g){if(t=Kt(e,g.length),kd(e,i)&&Qp(t,n)){if(Qp(t,i)&&g.kind!==1){o=g,u?(s++,a=p+1):a=p;continue e}if((u||g.kind!==1||!o.closingBracket)&&!b0(g,e,t,n,i,r,u?s+1:s,u?p+1:p,l,d,!o.closingBracket))return!1}e=t}}return l?.set(o.openingBracket.text,p),!0}case 3:{let u=Md(e,t);return r(new Of(u,s-1,0,!0))}case 1:{let u=Md(e,t);return r(new Of(u,s-1,a-1,c))}case 0:return!0}}var v0=class{constructor(e,t,n){this.push=e;this.includeMinIndentation=t;this.textModel=n}};function y0(o,e,t,n,i,r,s,a){if(s>200)return!0;let l=!0;if(o.kind===2){let d=0;if(a){let p=a.get(o.openingBracket.text);p===void 0&&(p=0),d=p,p++,a.set(o.openingBracket.text,p)}let c=Kt(e,o.openingBracket.length),u=-1;if(r.includeMinIndentation&&(u=o.computeMinIndentation(e,r.textModel)),l=r.push(new zI(Md(e,t),Md(e,c),o.closingBracket?Md(Kt(c,o.child?.length||Yn),t):void 0,s,d,o,u)),e=c,l&&o.child){let p=o.child;if(t=Kt(e,p.length),kd(e,i)&&Qp(t,n)&&(l=y0(p,e,t,n,i,r,s+1,a),!l))return!1}a?.set(o.openingBracket.text,d)}else{let d=e;for(let c of o.children){let u=d;if(d=Kt(d,c.length),kd(u,i)&&kd(n,d)&&(l=y0(c,u,d,n,i,r,s,a),!l))return!1}}return l}var aC=class extends F{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}bracketPairsTree=this._register(new on);onDidChangeEmitter=new k;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(t){(!t.languageId||this.bracketPairsTree.value?.object.didLanguageChange(t.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){this.bracketPairsTree.value?.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){this.bracketPairsTree.value?.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let t=new ne;this.bracketPairsTree.value=o9(t.add(new rC(this.textModel,n=>this.languageConfigurationService.getLanguageConfiguration(n))),t),t.add(this.bracketPairsTree.value.object.onDidChange(n=>this.onDidChangeEmitter.fire(n))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!1)||cl.empty}getBracketPairsInRangeWithMinIndentation(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!0)||cl.empty}getBracketsInRange(t,n=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(t,n)||cl.empty}findMatchingBracketUp(t,n,i){let r=this.textModel.validatePosition(n),s=this.textModel.getLanguageIdAtPosition(r.lineNumber,r.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(t);if(!a)return null;let l=this.getBracketPairsInRange(M.fromPositions(n,n)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=t.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?sC(this._findMatchingBracketUp(d,r,C0(i))):null}}matchBracket(t,n){if(this.canBuildAST){let i=this.getBracketPairsInRange(M.fromPositions(t,t)).filter(r=>r.closingBracketRange!==void 0&&(r.openingBracketRange.containsPosition(t)||r.closingBracketRange.containsPosition(t))).findLastMaxBy(mo(r=>r.openingBracketRange.containsPosition(t)?r.openingBracketRange:r.closingBracketRange,M.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{let i=C0(n);return this._matchBracket(this.textModel.validatePosition(t),i)}}_establishBracketSearchOffsets(t,n,i,r){let s=n.getCount(),a=n.getLanguageId(r),l=Math.max(0,t.column-1-i.maxBracketLength);for(let c=r-1;c>=0;c--){let u=n.getEndOffset(c);if(u<=l)break;if(Jr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){l=u;break}}let d=Math.min(n.getLineContent().length,t.column-1+i.maxBracketLength);for(let c=r+1;c<s;c++){let u=n.getStartOffset(c);if(u>=d)break;if(Jr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){d=u;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(t,n){let i=t.lineNumber,r=this.textModel.tokenization.getLineTokens(i),s=this.textModel.getLineContent(i),a=r.findTokenIndexAtOffset(t.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(a)).brackets;if(l&&!Jr(r.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(t,r,l,a),u=null;for(;;){let p=yo.findNextBracketInRange(l.forwardRegex,i,s,d,c);if(!p)break;if(p.startColumn<=t.column&&t.column<=p.endColumn){let h=s.substring(p.startColumn-1,p.endColumn-1).toLowerCase(),f=this._matchFoundBracket(p,l.textIsBracket[h],l.textIsOpenBracket[h],n);if(f){if(f instanceof El)return null;u=f}}d=p.endColumn-1}if(u)return u}if(a>0&&r.getStartOffset(a)===t.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(d)).brackets;if(c&&!Jr(r.getStandardTokenType(d))){let{searchStartOffset:u,searchEndOffset:p}=this._establishBracketSearchOffsets(t,r,c,d),h=yo.findPrevBracketInRange(c.reversedRegex,i,s,u,p);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn){let f=s.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),g=this._matchFoundBracket(h,c.textIsBracket[f],c.textIsOpenBracket[f],n);if(g)return g instanceof El?null:g}}}return null}_matchFoundBracket(t,n,i,r){if(!n)return null;let s=i?this._findMatchingBracketDown(n,t.getEndPosition(),r):this._findMatchingBracketUp(n,t.getStartPosition(),r);return s?s instanceof El?s:[t,s]:null}_findMatchingBracketUp(t,n,i){let r=t.languageId,s=t.reversedRegex,a=-1,l=0,d=(c,u,p,h)=>{for(;;){if(i&&++l%100===0&&!i())return El.INSTANCE;let f=yo.findPrevBracketInRange(s,c,u,p,h);if(!f)break;let g=u.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(t.isOpen(g)?a++:t.isClose(g)&&a--,a===0)return f;h=f.startColumn-1}return null};for(let c=n.lineNumber;c>=1;c--){let u=this.textModel.tokenization.getLineTokens(c),p=u.getCount(),h=this.textModel.getLineContent(c),f=p-1,g=h.length,b=h.length;c===n.lineNumber&&(f=u.findTokenIndexAtOffset(n.column-1),g=n.column-1,b=n.column-1);let v=!0;for(;f>=0;f--){let I=u.getLanguageId(f)===r&&!Jr(u.getStandardTokenType(f));if(I)v?g=u.getStartOffset(f):(g=u.getStartOffset(f),b=u.getEndOffset(f));else if(v&&g!==b){let T=d(c,h,g,b);if(T)return T}v=I}if(v&&g!==b){let I=d(c,h,g,b);if(I)return I}}return null}_findMatchingBracketDown(t,n,i){let r=t.languageId,s=t.forwardRegex,a=1,l=0,d=(u,p,h,f)=>{for(;;){if(i&&++l%100===0&&!i())return El.INSTANCE;let g=yo.findNextBracketInRange(s,u,p,h,f);if(!g)break;let b=p.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(t.isOpen(b)?a++:t.isClose(b)&&a--,a===0)return g;h=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=n.lineNumber;u<=c;u++){let p=this.textModel.tokenization.getLineTokens(u),h=p.getCount(),f=this.textModel.getLineContent(u),g=0,b=0,v=0;u===n.lineNumber&&(g=p.findTokenIndexAtOffset(n.column-1),b=n.column-1,v=n.column-1);let I=!0;for(;g<h;g++){let T=p.getLanguageId(g)===r&&!Jr(p.getStandardTokenType(g));if(T)I||(b=p.getStartOffset(g)),v=p.getEndOffset(g);else if(I&&b!==v){let S=d(u,f,b,v);if(S)return S}I=T}if(I&&b!==v){let T=d(u,f,b,v);if(T)return T}}return null}findPrevBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(n)||null;let i=null,r=null,s=null;for(let a=n.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),u=d-1,p=c.length,h=c.length;if(a===n.lineNumber){u=l.findTokenIndexAtOffset(n.column-1),p=n.column-1,h=n.column-1;let g=l.getLanguageId(u);i!==g&&(i=g,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let f=!0;for(;u>=0;u--){let g=l.getLanguageId(u);if(i!==g){if(r&&s&&f&&p!==h){let v=yo.findPrevBracketInRange(r.reversedRegex,a,c,p,h);if(v)return this._toFoundBracket(s,v);f=!1}i=g,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}let b=!!r&&!Jr(l.getStandardTokenType(u));if(b)f?p=l.getStartOffset(u):(p=l.getStartOffset(u),h=l.getEndOffset(u));else if(s&&r&&f&&p!==h){let v=yo.findPrevBracketInRange(r.reversedRegex,a,c,p,h);if(v)return this._toFoundBracket(s,v)}f=b}if(s&&r&&f&&p!==h){let g=yo.findPrevBracketInRange(r.reversedRegex,a,c,p,h);if(g)return this._toFoundBracket(s,g)}}return null}findNextBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(n)||null;let i=this.textModel.getLineCount(),r=null,s=null,a=null;for(let l=n.lineNumber;l<=i;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),u=this.textModel.getLineContent(l),p=0,h=0,f=0;if(l===n.lineNumber){p=d.findTokenIndexAtOffset(n.column-1),h=n.column-1,f=n.column-1;let b=d.getLanguageId(p);r!==b&&(r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew)}let g=!0;for(;p<c;p++){let b=d.getLanguageId(p);if(r!==b){if(a&&s&&g&&h!==f){let I=yo.findNextBracketInRange(s.forwardRegex,l,u,h,f);if(I)return this._toFoundBracket(a,I);g=!1}r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew}let v=!!s&&!Jr(d.getStandardTokenType(p));if(v)g||(h=d.getStartOffset(p)),f=d.getEndOffset(p);else if(a&&s&&g&&h!==f){let I=yo.findNextBracketInRange(s.forwardRegex,l,u,h,f);if(I)return this._toFoundBracket(a,I)}g=v}if(a&&s&&g&&h!==f){let b=yo.findNextBracketInRange(s.forwardRegex,l,u,h,f);if(b)return this._toFoundBracket(a,b)}}return null}findEnclosingBrackets(t,n){let i=this.textModel.validatePosition(t);if(this.canBuildAST){let f=M.fromPositions(i),g=this.getBracketPairsInRange(M.fromPositions(i,i)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}let r=C0(n),s=this.textModel.getLineCount(),a=new Map,l=[],d=(f,g)=>{if(!a.has(f)){let b=[];for(let v=0,I=g?g.brackets.length:0;v<I;v++)b[v]=0;a.set(f,b)}l=a.get(f)},c=0,u=(f,g,b,v,I)=>{for(;;){if(r&&++c%100===0&&!r())return El.INSTANCE;let T=yo.findNextBracketInRange(f.forwardRegex,g,b,v,I);if(!T)break;let S=b.substring(T.startColumn-1,T.endColumn-1).toLowerCase(),C=f.textIsBracket[S];if(C&&(C.isOpen(S)?l[C.index]++:C.isClose(S)&&l[C.index]--,l[C.index]===-1))return this._matchFoundBracket(T,C,!1,r);v=T.endColumn-1}return null},p=null,h=null;for(let f=i.lineNumber;f<=s;f++){let g=this.textModel.tokenization.getLineTokens(f),b=g.getCount(),v=this.textModel.getLineContent(f),I=0,T=0,S=0;if(f===i.lineNumber){I=g.findTokenIndexAtOffset(i.column-1),T=i.column-1,S=i.column-1;let w=g.getLanguageId(I);p!==w&&(p=w,h=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,h))}let C=!0;for(;I<b;I++){let w=g.getLanguageId(I);if(p!==w){if(h&&C&&T!==S){let D=u(h,f,v,T,S);if(D)return sC(D);C=!1}p=w,h=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,h)}let x=!!h&&!Jr(g.getStandardTokenType(I));if(x)C||(T=g.getStartOffset(I)),S=g.getEndOffset(I);else if(h&&C&&T!==S){let D=u(h,f,v,T,S);if(D)return sC(D)}C=x}if(h&&C&&T!==S){let w=u(h,f,v,T,S);if(w)return sC(w)}}return null}_toFoundBracket(t,n){if(!n)return null;let i=this.textModel.getValueInRange(n);i=i.toLowerCase();let r=t.getBracketInfo(i);return r?{range:n,bracketInfo:r}:null}};function o9(o,e){return{object:o,dispose:()=>e?.dispose()}}function C0(o){if(typeof o>"u")return()=>!0;{let e=Date.now();return()=>Date.now()-e<=o}}var El=class o{static INSTANCE=new o;_searchCanceledBrand=void 0;constructor(){}};function sC(o){return o instanceof El?null:o}var r9={IconContribution:"base.contributions.icons"},s9;(e=>{function o(t,n){let i=t.defaults;for(;Be.isThemeIcon(i);){let r=rh.getIcon(i.id);if(!r)return;i=r.defaults}return i}e.getDefinition=o})(s9||={});var a9;(t=>{function o(n){return{weight:n.weight,style:n.style,src:n.src.map(i=>({format:i.format,location:i.location.toString()}))}}t.toJSONObject=o;function e(n){let i=r=>En(r)?r:void 0;if(n&&Array.isArray(n.src)&&n.src.every(r=>En(r.format)&&En(r.location)))return{weight:i(n.weight),style:i(n.style),src:n.src.map(r=>({format:r.format,location:te.parse(r.location)}))}}t.fromJSONObject=e})(a9||={});var S0=class{_onDidChange=new k;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:m("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:m("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${Be.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,i){let r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;let l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=n),this._onDidChange.fire()}return r}let s={id:e,description:n,defaults:t,deprecationMessage:i};this.iconsById[e]=s;let a={$ref:"#/definitions/icons"};return i&&(a.deprecationMessage=i),n&&(a.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(r,s)=>r.id.localeCompare(s.id),t=r=>{for(;Be.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let i=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(let r of i.filter(s=>!!s.description).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|${Be.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(let r of i.filter(s=>!Be.isThemeIcon(s.defaults)).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|`);return n.join(`
`)}},rh=new S0;lt.add(r9.IconContribution,rh);function Or(o,e,t,n){return rh.registerIcon(o,e,t,n)}function l9(){let o=TL();for(let e in o){let t="\\"+o[e].toString(16);rh.registerIcon(e,{fontCharacter:t})}}l9();var _F="vscode://schemas/icons",LF=lt.as(qc.JSONContribution);LF.registerSchema(_F,rh.getIconSchema());var xF=new ln(()=>LF.notifySchemaChanged(_F),200);rh.onDidChange(()=>{xF.isScheduled()||xF.schedule()});var gme=Or("widget-close",ae.close,m("widgetClose","Icon for the close action in widgets.")),fme=Or("goto-previous-location",ae.arrowUp,m("previousChangeIcon","Icon for goto previous editor location.")),bme=Or("goto-next-location",ae.arrowDown,m("nextChangeIcon","Icon for goto next editor location.")),vme=Be.modify(ae.sync,"spin"),yme=Be.modify(ae.loading,"spin");function Fd(o){return o==="hcDark"||o==="hcLight"}function E0(o){return o==="dark"||o==="hcDark"}var Wo=Q("themeService");var Bme=ae.file,Wme=ae.folder;function Wf(o){switch(o){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var c9={ThemingContribution:"base.contributions.theming"},T0=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new k}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),pe(()=>{let t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},DF=new T0;lt.add(c9.ThemingContribution,DF);function Io(o){return DF.onColorThemeChange(o)}var lC=class extends F{constructor(t){super();this.themeService=t;this.theme=t.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(n=>this.onThemeChange(n)))}theme;onThemeChange(t){this.theme=t,this.updateStyles()}updateStyles(){}getColor(t,n){let i=this.theme.getColor(t);return i&&n&&(i=n(i,this.theme)),i?i.toString():null}};function RF(o){return`--vscode-${o.replace(/\./g,"-")}`}function de(o){return`var(${RF(o)})`}function MF(o,e){return`var(${RF(o)}, ${e})`}function u9(o){return o!==null&&typeof o=="object"&&"light"in o&&"dark"in o}var p9={ColorContribution:"base.contributions.colors"},h9="default",w0=class{_onDidChangeSchema=new k;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(e){for(let t of Object.keys(this.colorsById)){let n=e.getColor(t);n&&(this.colorSchema.properties[t].oneOf[0].defaultSnippets[0].body=`\${1:${n.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(e,t,n,i=!1,r){let s={id:e,description:n,defaults:t,needsTransparency:i,deprecationMessage:r};this.colorsById[e]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),i&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=m("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:n,oneOf:[a,{type:"string",const:h9,description:m("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(n),this._onDidChangeSchema.fire(),e}deregisterColor(e){delete this.colorsById[e],delete this.colorSchema.properties[e];let t=this.colorReferenceSchema.enum.indexOf(e);t!==-1&&(this.colorReferenceSchema.enum.splice(t,1),this.colorReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let n=this.colorsById[e];if(n?.defaults){let i=u9(n.defaults)?n.defaults[t.type]:n.defaults;return As(i,t)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let e=(t,n)=>{let i=t.indexOf(".")===-1?0:1,r=n.indexOf(".")===-1?0:1;return i!==r?i-r:t.localeCompare(n)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}},dC=new w0;lt.add(p9.ColorContribution,dC);function E(o,e,t,n,i){return dC.registerColor(o,e,t,n,i)}function m9(o,e){switch(o.op){case 0:return As(o.value,e)?.darken(o.factor);case 1:return As(o.value,e)?.lighten(o.factor);case 2:return As(o.value,e)?.transparent(o.factor);case 3:{let t=As(o.background,e);return t?As(o.value,e)?.makeOpaque(t):As(o.value,e)}case 4:for(let t of o.values){let n=As(t,e);if(n)return n}return;case 6:return As(e.defines(o.if)?o.then:o.else,e);case 5:{let t=As(o.value,e);if(!t)return;let n=As(o.background,e);return n?t.isDarkerThan(n)?V.getLighterColor(t,n,o.factor).transparent(o.transparency):V.getDarkerColor(t,n,o.factor).transparent(o.transparency):t.transparent(o.factor*o.transparency)}default:throw Ng(o)}}function eo(o,e){return{op:0,value:o,factor:e}}function Co(o,e){return{op:1,value:o,factor:e}}function ye(o,e){return{op:2,value:o,factor:e}}function x0(...o){return{op:4,values:o}}function OF(o,e,t){return{op:6,if:o,then:e,else:t}}function _0(o,e,t,n){return{op:5,value:o,background:e,factor:t,transparency:n}}function As(o,e){if(o!==null){if(typeof o=="string")return o[0]==="#"?V.fromHex(o):e.getColor(o);if(o instanceof V)return o;if(typeof o=="object")return m9(o,e)}}var NF="vscode://schemas/workbench-colors",AF=lt.as(qc.JSONContribution);AF.registerSchema(NF,dC.getColorSchema());var kF=new ln(()=>AF.notifySchemaChanged(NF),200);dC.onDidChangeSchema(()=>{kF.isScheduled()||kF.schedule()});var mt=E("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},m("foreground","Overall foreground color. This color is only used if not overridden by a component.")),nge=E("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},m("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),L0=E("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},m("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),ige=E("descriptionForeground",{light:"#717171",dark:ye(mt,.7),hcDark:ye(mt,.7),hcLight:ye(mt,.7)},m("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),Vf=E("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},m("iconForeground","The default color for icons in the workbench.")),to=E("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},m("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Ee=E("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},m("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),Ot=E("contrastActiveBorder",{light:null,dark:null,hcDark:to,hcLight:to},m("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),oge=E("selection.background",null,m("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),cC=E("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},m("textLinkForeground","Foreground color for links in text.")),rge=E("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},m("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),sge=E("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:V.black,hcLight:"#292929"},m("textSeparatorForeground","Color for text separators.")),age=E("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},m("textPreformatForeground","Foreground color for preformatted text segments.")),lge=E("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},m("textPreformatBackground","Background color for preformatted text segments.")),dge=E("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},m("textBlockQuoteBackground","Background color for block quotes in text.")),cge=E("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:V.white,hcLight:"#292929"},m("textBlockQuoteBorder","Border color for block quotes in text.")),uge=E("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:V.black,hcLight:"#F2F2F2"},m("textCodeBlockBackground","Background color for code blocks in text."));var fge=E("sash.hoverBorder",to,m("sashActiveBorder","Border color of active sashes.")),sh=E("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:V.black,hcLight:"#0F4A85"},m("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),PF=E("badge.foreground",{dark:V.white,light:"#333",hcDark:V.white,hcLight:V.white},m("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),Bd=E("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},m("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),uC=E("scrollbarSlider.background",{dark:V.fromHex("#797979").transparent(.4),light:V.fromHex("#646464").transparent(.4),hcDark:ye(Ee,.6),hcLight:ye(Ee,.4)},m("scrollbarSliderBackground","Scrollbar slider background color.")),pC=E("scrollbarSlider.hoverBackground",{dark:V.fromHex("#646464").transparent(.7),light:V.fromHex("#646464").transparent(.7),hcDark:ye(Ee,.8),hcLight:ye(Ee,.8)},m("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),hC=E("scrollbarSlider.activeBackground",{dark:V.fromHex("#BFBFBF").transparent(.4),light:V.fromHex("#000000").transparent(.6),hcDark:Ee,hcLight:Ee},m("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),FF=E("progressBar.background",{dark:V.fromHex("#0E70C0"),light:V.fromHex("#0E70C0"),hcDark:Ee,hcLight:Ee},m("progressBarBackground","Background color of the progress bar that can show for long running operations."));var ns=E("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:V.black,hcLight:V.white},m("editorBackground","Editor background color.")),Ta=E("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:V.white,hcLight:mt},m("editorForeground","Editor default foreground color.")),Sge=E("editorStickyScroll.background",ns,m("editorStickyScrollBackground","Background color of sticky scroll in the editor")),Ege=E("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:V.fromHex("#0F4A85").transparent(.1)},m("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),Tge=E("editorStickyScroll.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("editorStickyScrollBorder","Border color of sticky scroll in the editor")),wge=E("editorStickyScroll.shadow",Bd,m("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),_i=E("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:V.white},m("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),wa=E("editorWidget.foreground",mt,m("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),M0=E("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Ee,hcLight:Ee},m("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),xge=E("editorWidget.resizeBorder",null,m("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),_ge=E("editorError.background",null,m("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),ru=E("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},m("editorError.foreground","Foreground color of error squigglies in the editor.")),Lge=E("editorError.border",{dark:null,light:null,hcDark:V.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},m("errorBorder","If set, color of double underlines for errors in the editor.")),UF=E("editorWarning.background",null,m("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),So=E("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},m("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),ch=E("editorWarning.border",{dark:null,light:null,hcDark:V.fromHex("#FFCC00").transparent(.8),hcLight:V.fromHex("#FFCC00").transparent(.8)},m("warningBorder","If set, color of double underlines for warnings in the editor.")),Dge=E("editorInfo.background",null,m("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),lr=E("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},m("editorInfo.foreground","Foreground color of info squigglies in the editor.")),uh=E("editorInfo.border",{dark:null,light:null,hcDark:V.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},m("infoBorder","If set, color of double underlines for infos in the editor.")),zF=E("editorHint.foreground",{dark:V.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},m("editorHint.foreground","Foreground color of hint squigglies in the editor.")),kge=E("editorHint.border",{dark:null,light:null,hcDark:V.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},m("hintBorder","If set, color of double underlines for hints in the editor.")),Rge=E("editorLink.activeForeground",{dark:"#4E94CE",light:V.blue,hcDark:V.cyan,hcLight:"#292929"},m("activeLinkForeground","Color of active links.")),ah=E("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},m("editorSelectionBackground","Color of the editor selection.")),KF=E("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:V.white},m("editorSelectionForeground","Color of the selected text for high contrast.")),Mge=E("editor.inactiveSelectionBackground",{light:ye(ah,.5),dark:ye(ah,.5),hcDark:ye(ah,.7),hcLight:ye(ah,.5)},m("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),Oge=E("editor.selectionHighlightBackground",{light:_0(ah,ns,.3,.6),dark:_0(ah,ns,.3,.6),hcDark:null,hcLight:null},m("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),Nge=E("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Ot,hcLight:Ot},m("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),Age=E("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},m("editorFindMatch","Color of the current search match.")),Pge=E("editor.findMatchForeground",null,m("editorFindMatchForeground","Text color of the current search match.")),Ps=E("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},m("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),Fge=E("editor.findMatchHighlightForeground",null,m("findMatchHighlightForeground","Foreground color of the other search matches."),!0),Bge=E("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},m("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Wge=E("editor.findMatchBorder",{light:null,dark:null,hcDark:Ot,hcLight:Ot},m("editorFindMatchBorder","Border color of the current search match.")),Wd=E("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Ot,hcLight:Ot},m("findMatchHighlightBorder","Border color of the other search matches.")),Vge=E("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:ye(Ot,.4),hcLight:ye(Ot,.4)},m("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Hge=E("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},m("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),BF=E("editorHoverWidget.background",_i,m("hoverBackground","Background color of the editor hover.")),Uge=E("editorHoverWidget.foreground",wa,m("hoverForeground","Foreground color of the editor hover.")),zge=E("editorHoverWidget.border",M0,m("hoverBorder","Border color of the editor hover.")),Kge=E("editorHoverWidget.statusBarBackground",{dark:Co(BF,.2),light:eo(BF,.05),hcDark:_i,hcLight:_i},m("statusBarBackground","Background color of the editor hover status bar.")),GF=E("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:V.white,hcLight:V.black},m("editorInlayHintForeground","Foreground color of inline hints")),jF=E("editorInlayHint.background",{dark:ye(sh,.1),light:ye(sh,.1),hcDark:ye(V.white,.1),hcLight:ye(sh,.1)},m("editorInlayHintBackground","Background color of inline hints")),Gge=E("editorInlayHint.typeForeground",GF,m("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),jge=E("editorInlayHint.typeBackground",jF,m("editorInlayHintBackgroundTypes","Background color of inline hints for types")),qge=E("editorInlayHint.parameterForeground",GF,m("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),$ge=E("editorInlayHint.parameterBackground",jF,m("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),g9=E("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},m("editorLightBulbForeground","The color used for the lightbulb actions icon.")),Yge=E("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},m("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),Zge=E("editorLightBulbAi.foreground",g9,m("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),Qge=E("editor.snippetTabstopHighlightBackground",{dark:new V(new et(124,124,124,.3)),light:new V(new et(10,50,100,.2)),hcDark:new V(new et(124,124,124,.3)),hcLight:new V(new et(10,50,100,.2))},m("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),Xge=E("editor.snippetTabstopHighlightBorder",null,m("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),Jge=E("editor.snippetFinalTabstopHighlightBackground",null,m("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),efe=E("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new V(new et(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},m("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),mC=new V(new et(155,185,85,.2)),gC=new V(new et(255,0,0,.2)),qF=E("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},m("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),$F=E("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},m("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),tfe=E("diffEditor.insertedLineBackground",{dark:mC,light:mC,hcDark:null,hcLight:null},m("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),nfe=E("diffEditor.removedLineBackground",{dark:gC,light:gC,hcDark:null,hcLight:null},m("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),ife=E("diffEditorGutter.insertedLineBackground",null,m("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),ofe=E("diffEditorGutter.removedLineBackground",null,m("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),YF=E("diffEditorOverview.insertedForeground",null,m("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),ZF=E("diffEditorOverview.removedForeground",null,m("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),rfe=E("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},m("diffEditorInsertedOutline","Outline color for the text that got inserted.")),sfe=E("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},m("diffEditorRemovedOutline","Outline color for text that got removed.")),afe=E("diffEditor.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("diffEditorBorder","Border color between the two text editors.")),lfe=E("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},m("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),dfe=E("diffEditor.unchangedRegionBackground","sideBar.background",m("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),cfe=E("diffEditor.unchangedRegionForeground","foreground",m("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),ufe=E("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},m("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),ph=E("widget.shadow",{dark:ye(V.black,.36),light:ye(V.black,.16),hcDark:null,hcLight:null},m("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Uf=E("widget.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("widgetBorder","Border color of widgets such as find/replace inside the editor.")),Hf=E("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},m("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),pfe=E("toolbar.hoverOutline",{dark:null,light:null,hcDark:Ot,hcLight:Ot},m("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),hfe=E("toolbar.activeBackground",{dark:Co(Hf,.1),light:eo(Hf,.1),hcDark:null,hcLight:null},m("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),QF=E("breadcrumb.foreground",ye(mt,.8),m("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),XF=E("breadcrumb.background",ns,m("breadcrumbsBackground","Background color of breadcrumb items.")),O0=E("breadcrumb.focusForeground",{light:eo(mt,.2),dark:Co(mt,.1),hcDark:Co(mt,.1),hcLight:Co(mt,.1)},m("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),JF=E("breadcrumb.activeSelectionForeground",{light:eo(mt,.2),dark:Co(mt,.1),hcDark:Co(mt,.1),hcLight:Co(mt,.1)},m("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),mfe=E("breadcrumbPicker.background",_i,m("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),eB=.5,WF=V.fromHex("#40C8AE").transparent(eB),VF=V.fromHex("#40A6FF").transparent(eB),HF=V.fromHex("#606060").transparent(.4),N0=.4,lh=1,D0=E("merge.currentHeaderBackground",{dark:WF,light:WF,hcDark:null,hcLight:null},m("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),gfe=E("merge.currentContentBackground",ye(D0,N0),m("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),k0=E("merge.incomingHeaderBackground",{dark:VF,light:VF,hcDark:null,hcLight:null},m("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),ffe=E("merge.incomingContentBackground",ye(k0,N0),m("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),R0=E("merge.commonHeaderBackground",{dark:HF,light:HF,hcDark:null,hcLight:null},m("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),bfe=E("merge.commonContentBackground",ye(R0,N0),m("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),dh=E("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},m("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),vfe=E("editorOverviewRuler.currentContentForeground",{dark:ye(D0,lh),light:ye(D0,lh),hcDark:dh,hcLight:dh},m("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),yfe=E("editorOverviewRuler.incomingContentForeground",{dark:ye(k0,lh),light:ye(k0,lh),hcDark:dh,hcLight:dh},m("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),Ife=E("editorOverviewRuler.commonContentForeground",{dark:ye(R0,lh),light:ye(R0,lh),hcDark:dh,hcLight:dh},m("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),Cfe=E("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},m("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),Sfe=E("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",m("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),tB=E("problemsErrorIcon.foreground",ru,m("problemsErrorIconForeground","The color used for the problems error icon.")),nB=E("problemsWarningIcon.foreground",So,m("problemsWarningIconForeground","The color used for the problems warning icon.")),iB=E("problemsInfoIcon.foreground",lr,m("problemsInfoIconForeground","The color used for the problems info icon."));var oB=E("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},m("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),Lfe=E("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},m("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),A0=E("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},m("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),Dfe=E("minimap.infoHighlight",{dark:lr,light:lr,hcDark:uh,hcLight:uh},m("minimapInfo","Minimap marker color for infos.")),kfe=E("minimap.warningHighlight",{dark:So,light:So,hcDark:ch,hcLight:ch},m("overviewRuleWarning","Minimap marker color for warnings.")),Rfe=E("minimap.errorHighlight",{dark:new V(new et(255,18,18,.7)),light:new V(new et(255,18,18,.7)),hcDark:new V(new et(255,50,50,1)),hcLight:"#B5200D"},m("minimapError","Minimap marker color for errors.")),rB=E("minimap.background",null,m("minimapBackground","Minimap background color.")),sB=E("minimap.foregroundOpacity",V.fromHex("#000f"),m("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),Mfe=E("minimapSlider.background",ye(uC,.5),m("minimapSliderBackground","Minimap slider background color.")),Ofe=E("minimapSlider.hoverBackground",ye(pC,.5),m("minimapSliderHoverBackground","Minimap slider background color when hovering.")),Nfe=E("minimapSlider.activeBackground",ye(hC,.5),m("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var Vfe=E("charts.foreground",mt,m("chartsForeground","The foreground color used in charts.")),Hfe=E("charts.lines",ye(mt,.5),m("chartsLines","The color used for horizontal lines in charts.")),Ufe=E("charts.red",ru,m("chartsRed","The red color used in chart visualizations.")),zfe=E("charts.blue",lr,m("chartsBlue","The blue color used in chart visualizations.")),Kfe=E("charts.yellow",So,m("chartsYellow","The yellow color used in chart visualizations.")),Gfe=E("charts.orange",oB,m("chartsOrange","The orange color used in chart visualizations.")),jfe=E("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},m("chartsGreen","The green color used in chart visualizations.")),qfe=E("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},m("chartsPurple","The purple color used in chart visualizations."));var aB=E("input.background",{dark:"#3C3C3C",light:V.white,hcDark:V.black,hcLight:V.white},m("inputBoxBackground","Input box background.")),lB=E("input.foreground",mt,m("inputBoxForeground","Input box foreground.")),gh=E("input.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("inputBoxBorder","Input box border.")),P0=E("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Ee,hcLight:Ee},m("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),f9=E("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},m("inputOption.hoverBackground","Background color of activated options in input fields.")),F0=E("inputOption.activeBackground",{dark:ye(to,.4),light:ye(to,.2),hcDark:V.transparent,hcLight:V.transparent},m("inputOption.activeBackground","Background hover color of options in input fields.")),B0=E("inputOption.activeForeground",{dark:V.white,light:V.black,hcDark:mt,hcLight:mt},m("inputOption.activeForeground","Foreground color of activated options in input fields.")),Jfe=E("input.placeholderForeground",{light:ye(mt,.5),dark:ye(mt,.5),hcDark:ye(mt,.7),hcLight:ye(mt,.7)},m("inputPlaceholderForeground","Input box foreground color for placeholder text.")),dB=E("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:V.black,hcLight:V.white},m("inputValidationInfoBackground","Input validation background color for information severity.")),cB=E("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:mt},m("inputValidationInfoForeground","Input validation foreground color for information severity.")),uB=E("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Ee,hcLight:Ee},m("inputValidationInfoBorder","Input validation border color for information severity.")),pB=E("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:V.black,hcLight:V.white},m("inputValidationWarningBackground","Input validation background color for warning severity.")),hB=E("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:mt},m("inputValidationWarningForeground","Input validation foreground color for warning severity.")),mB=E("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Ee,hcLight:Ee},m("inputValidationWarningBorder","Input validation border color for warning severity.")),gB=E("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:V.black,hcLight:V.white},m("inputValidationErrorBackground","Input validation background color for error severity.")),fB=E("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:mt},m("inputValidationErrorForeground","Input validation foreground color for error severity.")),bB=E("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Ee,hcLight:Ee},m("inputValidationErrorBorder","Input validation border color for error severity.")),fh=E("dropdown.background",{dark:"#3C3C3C",light:V.white,hcDark:V.black,hcLight:V.white},m("dropdownBackground","Dropdown background.")),vB=E("dropdown.listBackground",{dark:null,light:null,hcDark:V.black,hcLight:V.white},m("dropdownListBackground","Dropdown list background.")),zf=E("dropdown.foreground",{dark:"#F0F0F0",light:mt,hcDark:V.white,hcLight:mt},m("dropdownForeground","Dropdown foreground.")),Kf=E("dropdown.border",{dark:fh,light:"#CECECE",hcDark:Ee,hcLight:Ee},m("dropdownBorder","Dropdown border.")),W0=E("button.foreground",V.white,m("buttonForeground","Button foreground color.")),yB=E("button.separator",ye(W0,.4),m("buttonSeparator","Button separator color.")),hh=E("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},m("buttonBackground","Button background color.")),IB=E("button.hoverBackground",{dark:Co(hh,.2),light:eo(hh,.2),hcDark:hh,hcLight:hh},m("buttonHoverBackground","Button background color when hovering.")),CB=E("button.border",Ee,m("buttonBorder","Button border color.")),SB=E("button.secondaryForeground",{dark:V.white,light:V.white,hcDark:V.white,hcLight:mt},m("buttonSecondaryForeground","Secondary button foreground color.")),fC=E("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:V.white},m("buttonSecondaryBackground","Secondary button background color.")),EB=E("button.secondaryHoverBackground",{dark:Co(fC,.2),light:eo(fC,.2),hcDark:null,hcLight:null},m("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),mh=E("radio.activeForeground",B0,m("radioActiveForeground","Foreground color of active radio option.")),TB=E("radio.activeBackground",F0,m("radioBackground","Background color of active radio option.")),wB=E("radio.activeBorder",P0,m("radioActiveBorder","Border color of the active radio option.")),xB=E("radio.inactiveForeground",null,m("radioInactiveForeground","Foreground color of inactive radio option.")),_B=E("radio.inactiveBackground",null,m("radioInactiveBackground","Background color of inactive radio option.")),LB=E("radio.inactiveBorder",{light:ye(mh,.2),dark:ye(mh,.2),hcDark:ye(mh,.4),hcLight:ye(mh,.2)},m("radioInactiveBorder","Border color of the inactive radio option.")),DB=E("radio.inactiveHoverBackground",f9,m("radioHoverBackground","Background color of inactive active radio option when hovering.")),kB=E("checkbox.background",fh,m("checkbox.background","Background color of checkbox widget.")),ebe=E("checkbox.selectBackground",_i,m("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),RB=E("checkbox.foreground",zf,m("checkbox.foreground","Foreground color of checkbox widget.")),MB=E("checkbox.border",Kf,m("checkbox.border","Border color of checkbox widget.")),tbe=E("checkbox.selectBorder",Vf,m("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),OB=E("keybindingLabel.background",{dark:new V(new et(128,128,128,.17)),light:new V(new et(221,221,221,.4)),hcDark:V.transparent,hcLight:V.transparent},m("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),NB=E("keybindingLabel.foreground",{dark:V.fromHex("#CCCCCC"),light:V.fromHex("#555555"),hcDark:V.white,hcLight:mt},m("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),AB=E("keybindingLabel.border",{dark:new V(new et(51,51,51,.6)),light:new V(new et(204,204,204,.4)),hcDark:new V(new et(111,195,223)),hcLight:Ee},m("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),PB=E("keybindingLabel.bottomBorder",{dark:new V(new et(68,68,68,.6)),light:new V(new et(187,187,187,.4)),hcDark:new V(new et(111,195,223)),hcLight:mt},m("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var FB=E("list.focusBackground",null,m("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),BB=E("list.focusForeground",null,m("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),WB=E("list.focusOutline",{dark:to,light:to,hcDark:Ot,hcLight:Ot},m("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),VB=E("list.focusAndSelectionOutline",null,m("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),Vo=E("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:V.fromHex("#0F4A85").transparent(.1)},m("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),xa=E("list.activeSelectionForeground",{dark:V.white,light:V.white,hcDark:null,hcLight:null},m("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),vC=E("list.activeSelectionIconForeground",null,m("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),HB=E("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:V.fromHex("#0F4A85").transparent(.1)},m("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),UB=E("list.inactiveSelectionForeground",null,m("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),zB=E("list.inactiveSelectionIconForeground",null,m("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),KB=E("list.inactiveFocusBackground",null,m("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),GB=E("list.inactiveFocusOutline",null,m("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),V0=E("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:V.white.transparent(.1),hcLight:V.fromHex("#0F4A85").transparent(.1)},m("listHoverBackground","List/Tree background when hovering over items using the mouse.")),H0=E("list.hoverForeground",null,m("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),jB=E("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},m("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),qB=E("list.dropBetweenBackground",{dark:Vf,light:Vf,hcDark:null,hcLight:null},m("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),bC=E("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:to,hcLight:to},m("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),abe=E("list.focusHighlightForeground",{dark:bC,light:OF(Vo,bC,"#BBE7FF"),hcDark:bC,hcLight:bC},m("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),lbe=E("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},m("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),dbe=E("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},m("listErrorForeground","Foreground color of list items containing errors.")),cbe=E("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},m("listWarningForeground","Foreground color of list items containing warnings.")),$B=E("listFilterWidget.background",{light:eo(_i,0),dark:Co(_i,0),hcDark:_i,hcLight:_i},m("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),YB=E("listFilterWidget.outline",{dark:V.transparent,light:V.transparent,hcDark:"#f38518",hcLight:"#007ACC"},m("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),ZB=E("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Ee,hcLight:Ee},m("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),QB=E("listFilterWidget.shadow",ph,m("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),ube=E("list.filterMatchBackground",{dark:Ps,light:Ps,hcDark:null,hcLight:null},m("listFilterMatchHighlight","Background color of the filtered match.")),pbe=E("list.filterMatchBorder",{dark:Wd,light:Wd,hcDark:Ee,hcLight:Ot},m("listFilterMatchHighlightBorder","Border color of the filtered match.")),hbe=E("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},m("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),bh=E("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},m("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),XB=E("tree.inactiveIndentGuidesStroke",ye(bh,.4),m("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),JB=E("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},m("tableColumnsBorder","Table border color between columns.")),e2=E("tree.tableOddRowsBackground",{dark:ye(mt,.04),light:ye(mt,.04),hcDark:null,hcLight:null},m("tableOddRowsBackgroundColor","Background color for odd table rows.")),mbe=E("editorActionList.background",_i,m("editorActionListBackground","Action List background color.")),gbe=E("editorActionList.foreground",wa,m("editorActionListForeground","Action List foreground color.")),fbe=E("editorActionList.focusForeground",xa,m("editorActionListFocusForeground","Action List foreground color for the focused item.")),bbe=E("editorActionList.focusBackground",Vo,m("editorActionListFocusBackground","Action List background color for the focused item."));var t2=E("menu.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("menuBorder","Border color of menus.")),n2=E("menu.foreground",zf,m("menuForeground","Foreground color of menu items.")),i2=E("menu.background",fh,m("menuBackground","Background color of menu items.")),o2=E("menu.selectionForeground",xa,m("menuSelectionForeground","Foreground color of the selected menu item in menus.")),r2=E("menu.selectionBackground",Vo,m("menuSelectionBackground","Background color of the selected menu item in menus.")),s2=E("menu.selectionBorder",{dark:null,light:null,hcDark:Ot,hcLight:Ot},m("menuSelectionBorder","Border color of the selected menu item in menus.")),a2=E("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Ee,hcLight:Ee},m("menuSeparatorBackground","Color of a separator menu item in menus."));var Lbe=E("quickInput.background",_i,m("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),Dbe=E("quickInput.foreground",wa,m("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),kbe=E("quickInputTitle.background",{dark:new V(new et(255,255,255,.105)),light:new V(new et(0,0,0,.06)),hcDark:"#000000",hcLight:V.white},m("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),d2=E("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:V.white,hcLight:"#0F4A85"},m("pickerGroupForeground","Quick picker color for grouping labels.")),Rbe=E("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:V.white,hcLight:"#0F4A85"},m("pickerGroupBorder","Quick picker color for grouping borders.")),l2=E("quickInput.list.focusBackground",null,"",void 0,m("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),c2=E("quickInputList.focusForeground",xa,m("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),u2=E("quickInputList.focusIconForeground",vC,m("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),p2=E("quickInputList.focusBackground",{dark:x0(l2,Vo),light:x0(l2,Vo),hcDark:null,hcLight:null},m("quickInput.listFocusBackground","Quick picker background color for the focused item."));var Pbe=E("search.resultsInfoForeground",{light:mt,dark:ye(mt,.65),hcDark:mt,hcLight:mt},m("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),Fbe=E("searchEditor.findMatchBackground",{light:ye(Ps,.66),dark:ye(Ps,.66),hcDark:Ps,hcLight:Ps},m("searchEditor.queryMatch","Color of the Search Editor query matches.")),Bbe=E("searchEditor.findMatchBorder",{light:ye(Wd,.66),dark:ye(Wd,.66),hcDark:Wd,hcLight:Wd},m("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var U0=E("editor.lineHighlightBackground",null,m("lineHighlight","Background color for the highlight of line at the cursor position.")),z0=E("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Ee},m("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),tve=E("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},m("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),nve=E("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Ot,hcLight:Ot},m("rangeHighlightBorder","Background color of the border around highlighted ranges.")),ive=E("editor.symbolHighlightBackground",{dark:Ps,light:Ps,hcDark:null,hcLight:null},m("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),ove=E("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Ot,hcLight:Ot},m("symbolHighlightBorder","Background color of the border around highlighted symbols.")),vh=E("editorCursor.foreground",{dark:"#AEAFAD",light:V.black,hcDark:V.white,hcLight:"#0F4A85"},m("caret","Color of the editor cursor.")),yC=E("editorCursor.background",null,m("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),IC=E("editorMultiCursor.primary.foreground",vh,m("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),h2=E("editorMultiCursor.primary.background",yC,m("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),CC=E("editorMultiCursor.secondary.foreground",vh,m("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),m2=E("editorMultiCursor.secondary.background",yC,m("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),SC=E("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},m("editorWhitespaces","Color of whitespace characters in the editor.")),g2=E("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:V.white,hcLight:"#292929"},m("editorLineNumbers","Color of editor line numbers.")),b9=E("editorIndentGuide.background",SC,m("editorIndentGuides","Color of the editor indentation guides."),!1,m("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),v9=E("editorIndentGuide.activeBackground",SC,m("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,m("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),f2=E("editorIndentGuide.background1",b9,m("editorIndentGuides1","Color of the editor indentation guides (1).")),b2=E("editorIndentGuide.background2","#00000000",m("editorIndentGuides2","Color of the editor indentation guides (2).")),v2=E("editorIndentGuide.background3","#00000000",m("editorIndentGuides3","Color of the editor indentation guides (3).")),y2=E("editorIndentGuide.background4","#00000000",m("editorIndentGuides4","Color of the editor indentation guides (4).")),I2=E("editorIndentGuide.background5","#00000000",m("editorIndentGuides5","Color of the editor indentation guides (5).")),C2=E("editorIndentGuide.background6","#00000000",m("editorIndentGuides6","Color of the editor indentation guides (6).")),S2=E("editorIndentGuide.activeBackground1",v9,m("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),E2=E("editorIndentGuide.activeBackground2","#00000000",m("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),T2=E("editorIndentGuide.activeBackground3","#00000000",m("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),w2=E("editorIndentGuide.activeBackground4","#00000000",m("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),x2=E("editorIndentGuide.activeBackground5","#00000000",m("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),_2=E("editorIndentGuide.activeBackground6","#00000000",m("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),y9=E("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Ot,hcLight:Ot},m("editorActiveLineNumber","Color of editor active line number"),!1,m("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),rve=E("editorLineNumber.activeForeground",y9,m("editorActiveLineNumber","Color of editor active line number")),L2=E("editorLineNumber.dimmedForeground",null,m("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),sve=E("editorRuler.foreground",{dark:"#5A5A5A",light:V.lightgrey,hcDark:V.white,hcLight:"#292929"},m("editorRuler","Color of the editor rulers.")),ave=E("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},m("editorCodeLensForeground","Foreground color of editor CodeLens")),lve=E("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},m("editorBracketMatchBackground","Background color behind matching brackets")),dve=E("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Ee,hcLight:Ee},m("editorBracketMatchBorder","Color for matching brackets boxes")),D2=E("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},m("editorOverviewRulerBorder","Color of the overview ruler border.")),k2=E("editorOverviewRuler.background",null,m("editorOverviewRulerBackground","Background color of the editor overview ruler.")),cve=E("editorGutter.background",ns,m("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),uve=E("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:V.fromHex("#fff").transparent(.8),hcLight:Ee},m("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),R2=E("editorUnnecessaryCode.opacity",{dark:V.fromHex("#000a"),light:V.fromHex("#0007"),hcDark:null,hcLight:null},m("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),pve=E("editorGhostText.border",{dark:null,light:null,hcDark:V.fromHex("#fff").transparent(.8),hcLight:V.fromHex("#292929").transparent(.8)},m("editorGhostTextBorder","Border color of ghost text in the editor.")),hve=E("editorGhostText.foreground",{dark:V.fromHex("#ffffff56"),light:V.fromHex("#0007"),hcDark:null,hcLight:null},m("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),mve=E("editorGhostText.background",null,m("editorGhostTextBackground","Background color of the ghost text in the editor.")),I9=new V(new et(0,122,204,.6)),gve=E("editorOverviewRuler.rangeHighlightForeground",I9,m("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),fve=E("editorOverviewRuler.errorForeground",{dark:new V(new et(255,18,18,.7)),light:new V(new et(255,18,18,.7)),hcDark:new V(new et(255,50,50,1)),hcLight:"#B5200D"},m("overviewRuleError","Overview ruler marker color for errors.")),bve=E("editorOverviewRuler.warningForeground",{dark:So,light:So,hcDark:ch,hcLight:ch},m("overviewRuleWarning","Overview ruler marker color for warnings.")),vve=E("editorOverviewRuler.infoForeground",{dark:lr,light:lr,hcDark:uh,hcLight:uh},m("overviewRuleInfo","Overview ruler marker color for infos.")),EC=E("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},m("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),TC=E("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},m("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),wC=E("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},m("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),xC=E("editorBracketHighlight.foreground4","#00000000",m("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),_C=E("editorBracketHighlight.foreground5","#00000000",m("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),LC=E("editorBracketHighlight.foreground6","#00000000",m("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),M2=E("editorBracketHighlight.unexpectedBracket.foreground",{dark:new V(new et(255,18,18,.8)),light:new V(new et(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},m("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),O2=E("editorBracketPairGuide.background1","#00000000",m("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),N2=E("editorBracketPairGuide.background2","#00000000",m("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),A2=E("editorBracketPairGuide.background3","#00000000",m("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),P2=E("editorBracketPairGuide.background4","#00000000",m("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),F2=E("editorBracketPairGuide.background5","#00000000",m("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),B2=E("editorBracketPairGuide.background6","#00000000",m("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),W2=E("editorBracketPairGuide.activeBackground1","#00000000",m("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),V2=E("editorBracketPairGuide.activeBackground2","#00000000",m("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),H2=E("editorBracketPairGuide.activeBackground3","#00000000",m("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),U2=E("editorBracketPairGuide.activeBackground4","#00000000",m("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),z2=E("editorBracketPairGuide.activeBackground5","#00000000",m("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),K2=E("editorBracketPairGuide.activeBackground6","#00000000",m("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),yve=E("editorUnicodeHighlight.border",So,m("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),Ive=E("editorUnicodeHighlight.background",UF,m("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));Io((o,e)=>{let t=o.getColor(ns),n=o.getColor(U0),i=n&&!n.isTransparent()?n:t;i&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${i}; }`)});var DC=class extends F{constructor(t){super();this.textModel=t;this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange(n=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new kC;onDidChangeEmitter=new k;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,n,i,r){return r?[]:n===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(t,n){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new M(1,1,this.textModel.getLineCount(),1),t,n):[]}},kC=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}};Io((o,e)=>{let t=[EC,TC,wC,xC,_C,LC],n=new kC;e.addRule(`.monaco-editor .${n.unexpectedClosingBracketClassName} { color: ${o.getColor(M2)}; }`);let i=t.map(r=>o.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){let s=i[r%i.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(r)} { color: ${s}; }`)}});function yh(o){return o.toString()}var Ho=class o{constructor(e,t,n,i,r,s,a){this.beforeVersionId=e;this.afterVersionId=t;this.beforeEOL=n;this.afterEOL=i;this.beforeCursorState=r;this.afterCursorState=s;this.changes=a}static create(e,t){let n=e.getAlternativeVersionId(),i=j0(e);return new o(n,n,i,i,t,t,[])}append(e,t,n,i,r){t.length>0&&(this.changes=NP(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,n){if(di(e,t?t.length:0,n),n+=4,t)for(let i of t)di(e,i.selectionStartLineNumber,n),n+=4,di(e,i.selectionStartColumn,n),n+=4,di(e,i.positionLineNumber,n),n+=4,di(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){let i=li(e,t);t+=4;for(let r=0;r<i;r++){let s=li(e,t);t+=4;let a=li(e,t);t+=4;let l=li(e,t);t+=4;let d=li(e,t);t+=4,n.push(new qe(s,a,l,d))}return t}serialize(){let e=10+o._writeSelectionsSize(this.beforeCursorState)+o._writeSelectionsSize(this.afterCursorState)+4;for(let i of this.changes)e+=i.writeSize();let t=new Uint8Array(e),n=0;di(t,this.beforeVersionId,n),n+=4,di(t,this.afterVersionId,n),n+=4,dI(t,this.beforeEOL,n),n+=1,dI(t,this.afterEOL,n),n+=1,n=o._writeSelections(t,this.beforeCursorState,n),n=o._writeSelections(t,this.afterCursorState,n),di(t,this.changes.length,n),n+=4;for(let i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){let t=new Uint8Array(e),n=0,i=li(t,n);n+=4;let r=li(t,n);n+=4;let s=lI(t,n);n+=1;let a=lI(t,n);n+=1;let l=[];n=o._readSelections(t,n,l);let d=[];n=o._readSelections(t,n,d);let c=li(t,n);n+=4;let u=[];for(let p=0;p<c;p++)n=tr.read(t,n,u);return new o(i,r,s,a,l,d,u)}},RC=class{constructor(e,t,n,i){this.label=e;this.code=t;this.model=n,this._data=Ho.create(n,i)}model;_data;get type(){return 0}get resource(){return te.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof Ho?this._data:Ho.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(te.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof Ho}append(e,t,n,i,r){this._data instanceof Ho&&this._data.append(e,t,n,i,r)}close(){this._data instanceof Ho&&(this._data=this._data.serialize())}open(){this._data instanceof Ho||(this._data=Ho.deserialize(this._data))}undo(){if(te.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Ho&&(this._data=this._data.serialize());let e=Ho.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(te.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Ho&&(this._data=this._data.serialize());let e=Ho.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof Ho&&(this._data=this._data.serialize()),this._data.byteLength+168}},G0=class{constructor(e,t,n){this.label=e;this.code=t;this._isOpen=!0,this._editStackElementsArr=n.slice(0),this._editStackElementsMap=new Map;for(let i of this._editStackElementsArr){let r=yh(i.resource);this._editStackElementsMap.set(r,i)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(e=>e.resource)}setDelegate(e){this._delegate=e}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let e=[];for(let t of this._editStackElementsArr)te.isUri(t.model)&&e.push(t.model);return e}matchesResource(e){let t=yh(e);return this._editStackElementsMap.has(t)}setModel(e){let t=yh(te.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;let t=yh(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,n,i,r){let s=yh(e.uri);this._editStackElementsMap.get(s).append(e,t,n,i,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let e of this._editStackElementsArr)e.undo()}redo(){for(let e of this._editStackElementsArr)e.redo()}heapSize(e){let t=yh(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(let t of this._editStackElementsArr)e.push(`${Jo(t.resource)}: ${t}`);return`{${e.join(", ")}}`}};function j0(o){return o.getEOL()===`
`?0:1}function K0(o){return o?o instanceof RC||o instanceof G0:!1}var MC=class o{_model;_undoRedoService;constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);K0(e)&&e.close()}popStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);K0(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){let n=this._undoRedoService.getLastElement(this._model.uri);if(K0(n)&&n.canAppend(this._model))return n;let i=new RC(m("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(i,t),i}pushEOL(e){let t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],j0(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n,i){let r=this._getOrCreateEditStackElement(e,i),s=this._model.applyEdits(t,!0),a=o._computeCursorState(n,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),r.append(this._model,l.map(d=>d.textChange),j0(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(n){return je(n),null}}};var Ih=class extends F{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function j2(o,e){let t=0,n=0,i=o.length;for(;n<i;){let r=o.charCodeAt(n);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;n++}return n===i?-1:t}var OC=class extends Ih{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return j2(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,n,i){this.assertNotDisposed();let r=this.textModel.getLineCount();if(t<1||t>r)throw new $e("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,u=-1,p=D=>{if(l!==-1&&(l===-2||l>D-1)){l=-1,d=-1;for(let O=D-2;O>=0;O--){let H=this._computeIndentLevel(O);if(H>=0){l=O,d=H;break}}}if(c===-2){c=-1,u=-1;for(let O=D;O<r;O++){let H=this._computeIndentLevel(O);if(H>=0){c=O,u=H;break}}}},h=-2,f=-1,g=-2,b=-1,v=D=>{if(h===-2){h=-1,f=-1;for(let O=D-2;O>=0;O--){let H=this._computeIndentLevel(O);if(H>=0){h=O,f=H;break}}}if(g!==-1&&(g===-2||g<D-1)){g=-1,b=-1;for(let O=D;O<r;O++){let H=this._computeIndentLevel(O);if(H>=0){g=O,b=H;break}}}},I=0,T=!0,S=0,C=!0,w=0,x=0;for(let D=0;T||C;D++){let O=t-D,H=t+D;D>1&&(O<1||O<n)&&(T=!1),D>1&&(H>r||H>i)&&(C=!1),D>5e4&&(T=!1,C=!1);let K=-1;if(T&&O>=1){let ie=this._computeIndentLevel(O-1);ie>=0?(c=O-1,u=ie,K=Math.ceil(ie/this.textModel.getOptions().indentSize)):(p(O),K=this._getIndentLevelForWhitespaceLine(a,d,u))}let z=-1;if(C&&H<=r){let ie=this._computeIndentLevel(H-1);ie>=0?(h=H-1,f=ie,z=Math.ceil(ie/this.textModel.getOptions().indentSize)):(v(H),z=this._getIndentLevelForWhitespaceLine(a,f,b))}if(D===0){x=K;continue}if(D===1){if(H<=r&&z>=0&&x+1===z){T=!1,I=H,S=H,w=z;continue}if(O>=1&&K>=0&&K-1===x){C=!1,I=O,S=O,w=K;continue}if(I=t,S=t,w=x,w===0)return{startLineNumber:I,endLineNumber:S,indent:w}}T&&(K>=w?I=O:T=!1),C&&(z>=w?S=H:C=!1)}return{startLineNumber:I,endLineNumber:S,indent:w}}getLinesBracketGuides(t,n,i,r){let s=[];for(let p=t;p<=n;p++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new M(t,1,n,this.textModel.getLineMaxColumn(n))).toArray(),d;if(i&&l.length>0){let p=(t<=i.lineNumber&&i.lineNumber<=n?l:this.textModel.bracketPairs.getBracketPairsInRange(M.fromPositions(i)).toArray()).filter(h=>M.strictContainsPosition(h.range,i));d=xc(p,h=>a||h.range.startLineNumber!==h.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new Gf;for(let p of l){if(!p.closingBracketRange)continue;let h=d&&p.range.equalsRange(d);if(!h&&!r.includeInactive)continue;let f=u.getInlineClassName(p.nestingLevel,p.nestingLevelOfEqualBracketType,c)+(r.highlightActive&&h?" "+u.activeClassName:""),g=p.openingBracketRange.getStartPosition(),b=p.closingBracketRange.getStartPosition(),v=r.horizontalGuides===2||r.horizontalGuides===1&&h;if(p.range.startLineNumber===p.range.endLineNumber){a&&v&&s[p.range.startLineNumber-t].push(new es(-1,p.openingBracketRange.getEndPosition().column,f,new Sl(!1,b.column),-1,-1));continue}let I=this.getVisibleColumnFromPosition(b),T=this.getVisibleColumnFromPosition(p.openingBracketRange.getStartPosition()),S=Math.min(T,I,p.minVisibleColumnIndentation+1),C=!1;fn(this.textModel.getLineContent(p.closingBracketRange.startLineNumber))<p.closingBracketRange.startColumn-1&&(C=!0);let D=Math.max(g.lineNumber,t),O=Math.min(b.lineNumber,n),H=C?1:0;for(let K=D;K<O+H;K++)s[K-t].push(new es(S,-1,f,null,K===g.lineNumber?g.column:-1,K===b.lineNumber?b.column:-1));v&&(g.lineNumber>=t&&T>S&&s[g.lineNumber-t].push(new es(S,-1,f,new Sl(!1,g.column),-1,-1)),b.lineNumber<=n&&I>S&&s[b.lineNumber-t].push(new es(S,-1,f,new Sl(!C,b.column),-1,-1)))}for(let p of s)p.sort((h,f)=>h.visibleColumn-f.visibleColumn);return s}getVisibleColumnFromPosition(t){return Ft.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,n){this.assertNotDisposed();let i=this.textModel.getLineCount();if(t<1||t>i)throw new Error("Illegal value for startLineNumber");if(n<1||n>i)throw new Error("Illegal value for endLineNumber");let r=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(n-t+1),d=-2,c=-1,u=-2,p=-1;for(let h=t;h<=n;h++){let f=h-t,g=this._computeIndentLevel(h-1);if(g>=0){d=h-1,c=g,l[f]=Math.ceil(g/r.indentSize);continue}if(d===-2){d=-1,c=-1;for(let b=h-2;b>=0;b--){let v=this._computeIndentLevel(b);if(v>=0){d=b,c=v;break}}}if(u!==-1&&(u===-2||u<h-1)){u=-1,p=-1;for(let b=h;b<i;b++){let v=this._computeIndentLevel(b);if(v>=0){u=b,p=v;break}}}l[f]=this._getIndentLevelForWhitespaceLine(a,c,p)}return l}_getIndentLevelForWhitespaceLine(t,n,i){let r=this.textModel.getOptions();return n===-1||i===-1?0:n<i?1+Math.floor(n/r.indentSize):n===i||t?Math.ceil(i/r.indentSize):1+Math.floor(i/r.indentSize)}},Gf=class{activeClassName="indent-active";getInlineClassName(e,t,n){return this.getInlineClassNameOfLevel(n?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}};var q0=class{spacesDiff=0;looksLikeAlignment=!1};function S9(o,e,t,n,i){i.spacesDiff=0,i.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<n;r++){let p=o.charCodeAt(r),h=t.charCodeAt(r);if(p!==h)break}let s=0,a=0;for(let p=r;p<e;p++)o.charCodeAt(p)===32?s++:a++;let l=0,d=0;for(let p=r;p<n;p++)t.charCodeAt(p)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),u=Math.abs(s-l);if(c===0){i.spacesDiff=u,u>0&&0<=l-1&&l-1<o.length&&l<t.length&&t.charCodeAt(l)!==32&&o.charCodeAt(l-1)===32&&o.charCodeAt(o.length-1)===44&&(i.looksLikeAlignment=!0);return}if(u%c===0){i.spacesDiff=u/c;return}}function $0(o,e,t){let n=Math.min(o.getLineCount(),1e4),i=0,r=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],u=new q0;for(let f=1;f<=n;f++){let g=o.getLineLength(f),b=o.getLineContent(f),v=g<=65536,I=!1,T=0,S=0,C=0;for(let x=0,D=g;x<D;x++){let O=v?b.charCodeAt(x):o.getLineCharCode(f,x);if(O===9)C++;else if(O===32)S++;else{I=!0,T=x;break}}if(!I||(C>0?i++:S>1&&r++,S9(s,a,b,T,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;let w=u.spacesDiff;w<=d&&c[w]++,s=b,a=T}let p=t;i!==r&&(p=i<r);let h=e;if(p){let f=p?0:.1*n;l.forEach(g=>{let b=c[g];b>f&&(f=b,h=g)}),h===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(h=2)}return{insertSpaces:p,tabSize:h}}function Eo(o){return(o.metadata&1)>>>0}function Bt(o,e){o.metadata=o.metadata&254|e<<0}function pi(o){return(o.metadata&2)>>>1===1}function Nt(o,e){o.metadata=o.metadata&253|(e?1:0)<<1}function eW(o){return(o.metadata&4)>>>2===1}function q2(o,e){o.metadata=o.metadata&251|(e?1:0)<<2}function tW(o){return(o.metadata&64)>>>6===1}function $2(o,e){o.metadata=o.metadata&191|(e?1:0)<<6}function E9(o){return(o.metadata&24)>>>3}function Y2(o,e){o.metadata=o.metadata&231|e<<3}function T9(o){return(o.metadata&32)>>>5===1}function Z2(o,e){o.metadata=o.metadata&223|(e?1:0)<<5}var $f=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,Bt(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,q2(this,!1),$2(this,!1),Y2(this,1),Z2(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,Nt(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;q2(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),$2(this,this.options.glyphMarginClassName!==null),Y2(this,this.options.stickiness),Z2(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}},Xe=new $f(null,0,0);Xe.parent=Xe;Xe.left=Xe;Xe.right=Xe;Bt(Xe,0);var Sh=class{root;requestNormalizeDelta;constructor(){this.root=Xe,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,r,s){return this.root===Xe?[]:R9(this,e,t,n,i,r,s)}search(e,t,n,i){return this.root===Xe?[]:Q2(this,e,t,n,i)}collectNodesFromOwner(e){return D9(this,e)}collectNodesPostOrder(){return k9(this)}insert(e){X2(this,e),this._normalizeDeltaIfNecessary()}delete(e){J2(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){let n=e,i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;let r=n.start+i,s=n.end+i;n.setCachedOffsets(r,s,t)}acceptReplace(e,t,n,i){let r=_9(this,e,e+t);for(let s=0,a=r.length;s<a;s++){let l=r[s];J2(this,l)}this._normalizeDeltaIfNecessary(),L9(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let s=0,a=r.length;s<a;s++){let l=r[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,x9(l,e,e+t,n,i),l.maxEnd=l.end,X2(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return Q2(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,w9(this))}};function w9(o){let e=o.root,t=0;for(;e!==Xe;){if(e.left!==Xe&&!pi(e.left)){e=e.left;continue}if(e.right!==Xe&&!pi(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,Tl(e),Nt(e,!0),Nt(e.left,!1),Nt(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}Nt(o.root,!1)}function Ch(o,e,t,n){return o<t?!0:o>t||n===1?!1:n===2?!0:e}function x9(o,e,t,n,i){let r=E9(o),s=r===0||r===2,a=r===1||r===2,l=t-e,d=n,c=Math.min(l,d),u=o.start,p=!1,h=o.end,f=!1;e<=u&&h<=t&&T9(o)&&(o.start=e,p=!0,o.end=e,f=!0);{let b=i?1:l>0?2:0;!p&&Ch(u,s,e,b)&&(p=!0),!f&&Ch(h,a,e,b)&&(f=!0)}if(c>0&&!i){let b=l>d?2:0;!p&&Ch(u,s,e+c,b)&&(p=!0),!f&&Ch(h,a,e+c,b)&&(f=!0)}{let b=i?1:0;!p&&Ch(u,s,t,b)&&(o.start=e+d,p=!0),!f&&Ch(h,a,t,b)&&(o.end=e+d,f=!0)}let g=d-l;p||(o.start=Math.max(0,u+g)),f||(o.end=Math.max(0,h+g)),o.start>o.end&&(o.end=o.start)}function _9(o,e,t){let n=o.root,i=0,r=0,s=0,a=0,l=[],d=0;for(;n!==Xe;){if(pi(n)){Nt(n.left,!1),Nt(n.right,!1),n===n.parent.right&&(i-=n.parent.delta),n=n.parent;continue}if(!pi(n.left)){if(r=i+n.maxEnd,r<e){Nt(n,!0);continue}if(n.left!==Xe){n=n.left;continue}}if(s=i+n.start,s>t){Nt(n,!0);continue}if(a=i+n.end,a>=e&&(n.setCachedOffsets(s,a,0),l[d++]=n),Nt(n,!0),n.right!==Xe&&!pi(n.right)){i+=n.delta,n=n.right;continue}}return Nt(o.root,!1),l}function L9(o,e,t,n){let i=o.root,r=0,s=0,a=0,l=n-(t-e);for(;i!==Xe;){if(pi(i)){Nt(i.left,!1),Nt(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),Tl(i),i=i.parent;continue}if(!pi(i.left)){if(s=r+i.maxEnd,s<e){Nt(i,!0);continue}if(i.left!==Xe){i=i.left;continue}}if(a=r+i.start,a>t){i.start+=l,i.end+=l,i.delta+=l,(i.delta<-1073741824||i.delta>1073741824)&&(o.requestNormalizeDelta=!0),Nt(i,!0);continue}if(Nt(i,!0),i.right!==Xe&&!pi(i.right)){r+=i.delta,i=i.right;continue}}Nt(o.root,!1)}function D9(o,e){let t=o.root,n=[],i=0;for(;t!==Xe;){if(pi(t)){Nt(t.left,!1),Nt(t.right,!1),t=t.parent;continue}if(t.left!==Xe&&!pi(t.left)){t=t.left;continue}if(t.ownerId===e&&(n[i++]=t),Nt(t,!0),t.right!==Xe&&!pi(t.right)){t=t.right;continue}}return Nt(o.root,!1),n}function k9(o){let e=o.root,t=[],n=0;for(;e!==Xe;){if(pi(e)){Nt(e.left,!1),Nt(e.right,!1),e=e.parent;continue}if(e.left!==Xe&&!pi(e.left)){e=e.left;continue}if(e.right!==Xe&&!pi(e.right)){e=e.right;continue}t[n++]=e,Nt(e,!0)}return Nt(o.root,!1),t}function Q2(o,e,t,n,i){let r=o.root,s=0,a=0,l=0,d=[],c=0;for(;r!==Xe;){if(pi(r)){Nt(r.left,!1),Nt(r.right,!1),r===r.parent.right&&(s-=r.parent.delta),r=r.parent;continue}if(r.left!==Xe&&!pi(r.left)){r=r.left;continue}a=s+r.start,l=s+r.end,r.setCachedOffsets(a,l,n);let u=!0;if(e&&r.ownerId&&r.ownerId!==e&&(u=!1),t&&eW(r)&&(u=!1),i&&!tW(r)&&(u=!1),u&&(d[c++]=r),Nt(r,!0),r.right!==Xe&&!pi(r.right)){s+=r.delta,r=r.right;continue}}return Nt(o.root,!1),d}function R9(o,e,t,n,i,r,s){let a=o.root,l=0,d=0,c=0,u=0,p=[],h=0;for(;a!==Xe;){if(pi(a)){Nt(a.left,!1),Nt(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!pi(a.left)){if(d=l+a.maxEnd,d<e){Nt(a,!0);continue}if(a.left!==Xe){a=a.left;continue}}if(c=l+a.start,c>t){Nt(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(c,u,r);let f=!0;n&&a.ownerId&&a.ownerId!==n&&(f=!1),i&&eW(a)&&(f=!1),s&&!tW(a)&&(f=!1),f&&(p[h++]=a)}if(Nt(a,!0),a.right!==Xe&&!pi(a.right)){l+=a.delta,a=a.right;continue}}return Nt(o.root,!1),p}function X2(o,e){if(o.root===Xe)return e.parent=Xe,e.left=Xe,e.right=Xe,Bt(e,0),o.root=e,o.root;M9(o,e),Vd(e.parent);let t=e;for(;t!==o.root&&Eo(t.parent)===1;)if(t.parent===t.parent.parent.left){let n=t.parent.parent.right;Eo(n)===1?(Bt(t.parent,0),Bt(n,0),Bt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,jf(o,t)),Bt(t.parent,0),Bt(t.parent.parent,1),qf(o,t.parent.parent))}else{let n=t.parent.parent.left;Eo(n)===1?(Bt(t.parent,0),Bt(n,0),Bt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,qf(o,t)),Bt(t.parent,0),Bt(t.parent.parent,1),jf(o,t.parent.parent))}return Bt(o.root,0),e}function M9(o,e){let t=0,n=o.root,i=e.start,r=e.end;for(;;)if(N9(i,r,n.start+t,n.end+t)<0)if(n.left===Xe){e.start-=t,e.end-=t,e.maxEnd-=t,n.left=e;break}else n=n.left;else if(n.right===Xe){e.start-=t+n.delta,e.end-=t+n.delta,e.maxEnd-=t+n.delta,n.right=e;break}else t+=n.delta,n=n.right;e.parent=n,e.left=Xe,e.right=Xe,Bt(e,1)}function J2(o,e){let t,n;if(e.left===Xe?(t=e.right,n=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Xe?(t=e.left,n=e):(n=O9(e.right),t=n.right,t.start+=n.delta,t.end+=n.delta,t.delta+=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),n.start+=e.delta,n.end+=e.delta,n.delta=e.delta,(n.delta<-1073741824||n.delta>1073741824)&&(o.requestNormalizeDelta=!0)),n===o.root){o.root=t,Bt(t,0),e.detach(),Y0(),Tl(t),o.root.parent=Xe;return}let i=Eo(n)===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?t.parent=n.parent:(n.parent===e?t.parent=n:t.parent=n.parent,n.left=e.left,n.right=e.right,n.parent=e.parent,Bt(n,Eo(e)),e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Xe&&(n.left.parent=n),n.right!==Xe&&(n.right.parent=n)),e.detach(),i){Vd(t.parent),n!==e&&(Vd(n),Vd(n.parent)),Y0();return}Vd(t),Vd(t.parent),n!==e&&(Vd(n),Vd(n.parent));let r;for(;t!==o.root&&Eo(t)===0;)t===t.parent.left?(r=t.parent.right,Eo(r)===1&&(Bt(r,0),Bt(t.parent,1),jf(o,t.parent),r=t.parent.right),Eo(r.left)===0&&Eo(r.right)===0?(Bt(r,1),t=t.parent):(Eo(r.right)===0&&(Bt(r.left,0),Bt(r,1),qf(o,r),r=t.parent.right),Bt(r,Eo(t.parent)),Bt(t.parent,0),Bt(r.right,0),jf(o,t.parent),t=o.root)):(r=t.parent.left,Eo(r)===1&&(Bt(r,0),Bt(t.parent,1),qf(o,t.parent),r=t.parent.left),Eo(r.left)===0&&Eo(r.right)===0?(Bt(r,1),t=t.parent):(Eo(r.left)===0&&(Bt(r.right,0),Bt(r,1),jf(o,r),r=t.parent.left),Bt(r,Eo(t.parent)),Bt(t.parent,0),Bt(r.left,0),qf(o,t.parent),t=o.root));Bt(t,0),Y0()}function O9(o){for(;o.left!==Xe;)o=o.left;return o}function Y0(){Xe.parent=Xe,Xe.delta=0,Xe.start=0,Xe.end=0}function jf(o,e){let t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Xe&&(t.left.parent=e),t.parent=e.parent,e.parent===Xe?o.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,Tl(e),Tl(t)}function qf(o,e){let t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(o.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Xe&&(t.right.parent=e),t.parent=e.parent,e.parent===Xe?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,Tl(e),Tl(t)}function nW(o){let e=o.end;if(o.left!==Xe){let t=o.left.maxEnd;t>e&&(e=t)}if(o.right!==Xe){let t=o.right.maxEnd+o.delta;t>e&&(e=t)}return e}function Tl(o){o.maxEnd=nW(o)}function Vd(o){for(;o!==Xe;){let e=nW(o);if(o.maxEnd===e)return;o.maxEnd=e,o=o.parent}}function N9(o,e,t,n){return o===t?e-n:o-t}var Eh=class{parent;left;right;color;piece;size_left;lf_left;constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Pe)return AC(this.right);let e=this;for(;e.parent!==Pe&&e.parent.left!==e;)e=e.parent;return e.parent===Pe?Pe:e.parent}prev(){if(this.left!==Pe)return Q0(this.left);let e=this;for(;e.parent!==Pe&&e.parent.right!==e;)e=e.parent;return e.parent===Pe?Pe:e.parent}detach(){this.parent=null,this.left=null,this.right=null}};var Pe=new Eh(null,0);Pe.parent=Pe;Pe.left=Pe;Pe.right=Pe;Pe.color=0;function AC(o){for(;o.left!==Pe;)o=o.left;return o}function Q0(o){for(;o.right!==Pe;)o=o.right;return o}function X0(o){return o===Pe?0:o.size_left+o.piece.length+X0(o.right)}function J0(o){return o===Pe?0:o.lf_left+o.piece.lineFeedCnt+J0(o.right)}function Z0(){Pe.parent=Pe}function Zf(o,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Pe&&(t.left.parent=e),t.parent=e.parent,e.parent===Pe?o.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Qf(o,e){let t=e.left;e.left=t.right,t.right!==Pe&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Pe?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Xf(o,e){let t,n;if(e.left===Pe?(n=e,t=n.right):e.right===Pe?(n=e,t=n.left):(n=AC(e.right),t=n.right),n===o.root){o.root=t,t.color=0,e.detach(),Z0(),o.root.parent=Pe;return}let i=n.color===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?(t.parent=n.parent,Yf(o,t)):(n.parent===e?t.parent=n:t.parent=n.parent,Yf(o,t),n.left=e.left,n.right=e.right,n.parent=e.parent,n.color=e.color,e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Pe&&(n.left.parent=n),n.right!==Pe&&(n.right.parent=n),n.size_left=e.size_left,n.lf_left=e.lf_left,Yf(o,n)),e.detach(),t.parent.left===t){let s=X0(t),a=J0(t);if(s!==t.parent.size_left||a!==t.parent.lf_left){let l=s-t.parent.size_left,d=a-t.parent.lf_left;t.parent.size_left=s,t.parent.lf_left=a,_a(o,t.parent,l,d)}}if(Yf(o,t.parent),i){Z0();return}let r;for(;t!==o.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,Zf(o,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,Qf(o,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,Zf(o,t.parent),t=o.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,Qf(o,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,Zf(o,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,Qf(o,t.parent),t=o.root));t.color=0,Z0()}function ek(o,e){for(Yf(o,e);e!==o.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,Zf(o,e)),e.parent.color=0,e.parent.parent.color=1,Qf(o,e.parent.parent))}else{let t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Qf(o,e)),e.parent.color=0,e.parent.parent.color=1,Zf(o,e.parent.parent))}o.root.color=0}function _a(o,e,t,n){for(;e!==o.root&&e!==Pe;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}function Yf(o,e){let t=0,n=0;if(e!==o.root){for(;e!==o.root&&e===e.parent.right;)e=e.parent;if(e!==o.root)for(e=e.parent,t=X0(e.left)-e.size_left,n=J0(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=n;e!==o.root&&(t!==0||n!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}}var A9=999,xl=class{searchString;isRegex;matchCase;wordSeparators;constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=P9(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=wy(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new YI(t,this.wordSeparators?ya(this.wordSeparators,[]):null,n?this.searchString:null)}};function P9(o){if(!o||o.length===0)return!1;for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n===10)return!0;if(n===92){if(e++,e>=t)break;let i=o.charCodeAt(e);if(i===110||i===114||i===87)return!0}}return!1}function Hd(o,e,t){if(!t)return new Ad(o,null);let n=[];for(let i=0,r=e.length;i<r;i++)n[i]=e[i];return new Ad(o,n)}var PC=class{_lineFeedsOffsets;constructor(e){let t=[],n=0;for(let i=0,r=e.length;i<r;i++)e.charCodeAt(i)===10&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){let t=this._lineFeedsOffsets,n=0,i=t.length-1;if(i===-1||e<=t[0])return 0;for(;n<i;){let r=n+((i-n)/2>>0);t[r]>=e?i=r-1:t[r+1]>=e?(n=r,i=r):n=r+1}return n+1}},su=class{static findMatches(e,t,n,i,r){let s=t.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(e,n,new wl(s.wordSeparators,s.regex),i,r):this._doFindMatchesLineByLine(e,n,s,i,r):[]}static _getMultilineMatchRange(e,t,n,i,r,s){let a,l=0;i?(l=i.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let d;if(i){let h=i.findLineFeedCountBeforeOffset(r+s.length)-l;d=a+s.length+h}else d=a+s.length;let c=e.getPositionAt(a),u=e.getPositionAt(d);return new M(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,n,i,r){let s=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new PC(a):null,d=[],c=0,u;for(n.reset(0);u=n.next(a);)if(d[c++]=Hd(this._getMultilineMatchRange(e,s,a,l,u.index,u[0]),u,i),c>=r)return d;return d}static _doFindMatchesLineByLine(e,t,n,i,r){let s=[],a=0;if(t.startLineNumber===t.endLineNumber){let d=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(n,d,t.startLineNumber,t.startColumn-1,a,s,i,r),s}let l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(n,l,t.startLineNumber,t.startColumn-1,a,s,i,r);for(let d=t.startLineNumber+1;d<t.endLineNumber&&a<r;d++)a=this._findMatchesInLine(n,e.getLineContent(d),d,0,a,s,i,r);if(a<r){let d=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(n,d,t.endLineNumber,0,a,s,i,r)}return s}static _findMatchesInLine(e,t,n,i,r,s,a,l){let d=e.wordSeparators;if(!a&&e.simpleSearch){let p=e.simpleSearch,h=p.length,f=t.length,g=-h;for(;(g=t.indexOf(p,g+h))!==-1;)if((!d||FC(d,t,f,g,h))&&(s[r++]=new Ad(new M(n,g+1+i,n,g+1+h+i),null),r>=l))return r;return r}let c=new wl(e.wordSeparators,e.regex),u;c.reset(0);do if(u=c.next(t),u&&(s[r++]=Hd(new M(n,u.index+1+i,n,u.index+1+u[0].length+i),u,a),r>=l))return r;while(u);return r}static findNextMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new wl(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,n,s,i):this._doFindNextMatchLineByLine(e,n,s,i)}static _doFindNextMatchMultiline(e,t,n,i){let r=new A(t.lineNumber,1),s=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new M(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),d=e.getEOL()===`\r
`?new PC(l):null;n.reset(t.column-1);let c=n.next(l);return c?Hd(this._getMultilineMatchRange(e,s,l,d,c.index,c[0]),c,i):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new A(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s),l=this._findFirstMatchInLine(n,a,s,t.column,i);if(l)return l;for(let d=1;d<=r;d++){let c=(s+d-1)%r,u=e.getLineContent(c+1),p=this._findFirstMatchInLine(n,u,c+1,1,i);if(p)return p}return null}static _findFirstMatchInLine(e,t,n,i,r){e.reset(i-1);let s=e.next(t);return s?Hd(new M(n,s.index+1,n,s.index+1+s[0].length),s,r):null}static findPreviousMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new wl(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,n,s,i):this._doFindPreviousMatchLineByLine(e,n,s,i)}static _doFindPreviousMatchMultiline(e,t,n,i){let r=this._doFindMatchesMultiline(e,new M(1,1,t.lineNumber,t.column),n,i,10*A9);if(r.length>0)return r[r.length-1];let s=e.getLineCount();return t.lineNumber!==s||t.column!==e.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(e,new A(s,e.getLineMaxColumn(s)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s).substring(0,t.column-1),l=this._findLastMatchInLine(n,a,s,i);if(l)return l;for(let d=1;d<=r;d++){let c=(r+s-d-1)%r,u=e.getLineContent(c+1),p=this._findLastMatchInLine(n,u,c+1,i);if(p)return p}return null}static _findLastMatchInLine(e,t,n,i){let r=null,s;for(e.reset(0);s=e.next(t);)r=Hd(new M(n,s.index+1,n,s.index+1+s[0].length),s,i);return r}};function F9(o,e,t,n,i){if(n===0)return!0;let r=e.charCodeAt(n-1);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n);if(o.get(s)!==0)return!0}return!1}function B9(o,e,t,n,i){if(n+i===t)return!0;let r=e.charCodeAt(n+i);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n+i-1);if(o.get(s)!==0)return!0}return!1}function FC(o,e,t,n,i){return F9(o,e,t,n,i)&&B9(o,e,t,n,i)}var wl=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;let i=n.index,r=n[0].length;if(i===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){Lp(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=i,this._prevMatchLength=r,!this._wordSeparators||FC(this._wordSeparators,e,t,i,r))return n}while(n);return null}};var _l=65535;function iW(o){let e;return o[o.length-1]<65536?e=new Uint16Array(o.length):e=new Uint32Array(o.length),e.set(o,0),e}var nk=class{constructor(e,t,n,i,r){this.lineStarts=e;this.cr=t;this.lf=n;this.crlf=i;this.isBasicASCII=r}};function La(o,e=!0){let t=[0],n=1;for(let i=0,r=o.length;i<r;i++){let s=o.charCodeAt(i);s===13?i+1<r&&o.charCodeAt(i+1)===10?(t[n++]=i+2,i++):t[n++]=i+1:s===10&&(t[n++]=i+1)}return e?iW(t):t}function oW(o,e){o.length=0,o[0]=0;let t=1,n=0,i=0,r=0,s=!0;for(let l=0,d=e.length;l<d;l++){let c=e.charCodeAt(l);c===13?l+1<d&&e.charCodeAt(l+1)===10?(r++,o[t++]=l+2,l++):(n++,o[t++]=l+1):c===10?(i++,o[t++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new nk(iW(o),n,i,r,s);return o.length=0,a}var no=class{bufferIndex;start;end;length;lineFeedCnt;constructor(e,t,n,i,r){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=r}},Da=class{buffer;lineStarts;constructor(e,t){this.buffer=e,this.lineStarts=t}},ik=class{_pieces;_index;_tree;_BOM;constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Pe&&e.iterate(e.root,n=>(n!==Pe&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},ok=class{_limit;_cache;constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let r=n[i];if(r.node.parent===null||r.nodeStartOffset>=e){n[i]=null,t=!0;continue}}if(t){let i=[];for(let r of n)r!==null&&i.push(r);this._cache=i}}},BC=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new Da("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Pe,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let r=0,s=e.length;r<s;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=La(e[r].buffer));let a=new no(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),i=this.rbInsertRight(i,a)}this._searchCache=new ok(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=_l,n=t-Math.floor(t/3),i=n*2,r="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=n||s+c<i)return r+=d,s+=c,!0;let u=r.replace(/\r\n|\r|\n/g,e);return a.push(new Da(u,La(u))),r=d,s=c,!0}),s>0){let l=r.replace(/\r\n|\r|\n/g,e);a.push(new Da(l,La(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new ik(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,i=>{if(i===Pe)return!0;let r=this.getNodeContent(i),s=r.length,a=e.nodeAt(t),l=e.nodeAt(t+s),d=e.getValueInRange2(a,l);return t+=s,r===d})}getOffsetAt(e,t){let n=0,i=this.root;for(;i!==Pe;)if(i.left!==Pe&&i.lf_left+1>=e)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;let r=this.getAccumulatedValue(i,e-i.lf_left-2);return n+=r+t-1}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;for(;t!==Pe;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let r=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+r.index,r.index===0){let s=this.getOffsetAt(n+1,1),a=i-s;return new A(n+1,a+1)}return new A(n+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===Pe){let r=this.getOffsetAt(n+1,1),s=i-e-r;return new A(n+1,s+1)}else t=t.right;return new A(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(n,i);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+e.remainder,d+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),s=i.substring(r+e.remainder,r+n.piece.length);for(n=n.next();n!==Pe;){let a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){s+=a.substring(l,l+t.remainder);break}else s+=a.substr(l,n.piece.length);n=n.next()}return s}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,r=>{if(r===Pe)return!0;let s=r.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line,p=d[c]+s.start.column;if(i&&(l.charCodeAt(p)===10&&(p++,a--),e[t++]=n,n="",i=!1,a===0))return!0;if(c===u)return!this._EOLNormalized&&l.charCodeAt(p+a-1)===13?(i=!0,n+=l.substr(p,a-1)):n+=l.substr(p,a),!0;n+=this._EOLNormalized?l.substring(p,Math.max(p,d[c+1]-this._EOLLength)):l.substring(p,d[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let h=c+1;h<u;h++)n=this._EOLNormalized?l.substring(d[h],d[h+1]-this._EOLLength):l.substring(d[h],d[h+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return!this._EOLNormalized&&l.charCodeAt(d[u]+s.end.column-1)===13?(i=!0,s.end.column===0?t--:n=l.substr(d[u],s.end.column-1)):n=l.substr(d[u],s.end.column),!0}),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}else{let t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let n=t.node.next();if(!n||n===Pe)return"";let i=this._buffers[n.piece.bufferIndex],r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.buffer.substring(r,r+n.piece.length)}else{let n=this._buffers[t.node.piece.bufferIndex],i=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=i+t.remainder,s=i+t.node.piece.length;return n.buffer.substring(r,s)}}findMatchesInNode(e,t,n,i,r,s,a,l,d,c,u){let p=this._buffers[e.piece.bufferIndex],h=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),f=this.offsetInBuffer(e.piece.bufferIndex,r),g=this.offsetInBuffer(e.piece.bufferIndex,s),b,v={line:0,column:0},I,T;t._wordSeparators?(I=p.buffer.substring(f,g),T=S=>S+f,t.reset(0)):(I=p.buffer,T=S=>S,t.reset(f));do if(b=t.next(I),b){if(T(b.index)>=g)return c;this.positionInBuffer(e,T(b.index)-h,v);let S=this.getLineFeedCnt(e.piece.bufferIndex,r,v),C=v.line===r.line?v.column-r.column+i:v.column+1,w=C+b[0].length;if(u[c++]=Hd(new M(n+S,C,n+S,w),b,l),T(b.index)+b[0].length>=g||c>=d)return c}while(b);return c}findMatchesLineByLine(e,t,n,i){let r=[],s=0,a=new wl(t.wordSeparators,t.regex),l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let d=this.nodeAt2(e.endLineNumber,e.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,c,u,t,n,i,s,r),r;let p=e.startLineNumber,h=l.node;for(;h!==d.node;){let g=this.getLineFeedCnt(h.piece.bufferIndex,c,h.piece.end);if(g>=1){let v=this._buffers[h.piece.bufferIndex].lineStarts,I=this.offsetInBuffer(h.piece.bufferIndex,h.piece.start),T=v[c.line+g],S=p===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(h,a,p,S,c,this.positionInBuffer(h,T-I),t,n,i,s,r),s>=i)return r;p+=g}let b=p===e.startLineNumber?e.startColumn-1:0;if(p===e.endLineNumber){let v=this.getLineContent(p).substring(b,e.endColumn-1);return s=this._findMatchesInLine(t,a,v,e.endLineNumber,b,s,r,n,i),r}if(s=this._findMatchesInLine(t,a,this.getLineContent(p).substr(b),p,b,s,r,n,i),s>=i)return r;p++,l=this.nodeAt2(p,1),h=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(p===e.endLineNumber){let g=p===e.startLineNumber?e.startColumn-1:0,b=this.getLineContent(p).substring(g,e.endColumn-1);return s=this._findMatchesInLine(t,a,b,e.endLineNumber,g,s,r,n,i),r}let f=p===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(d.node,a,p,f,c,u,t,n,i,s,r),r}_findMatchesInLine(e,t,n,i,r,s,a,l,d){let c=e.wordSeparators;if(!l&&e.simpleSearch){let p=e.simpleSearch,h=p.length,f=n.length,g=-h;for(;(g=n.indexOf(p,g+h))!==-1;)if((!c||FC(c,n,f,g,h))&&(a[s++]=new Ad(new M(i,g+1+r,i,g+1+h+r),null),s>=d))return s;return s}let u;t.reset(0);do if(u=t.next(n),u&&(a[s++]=Hd(new M(i,u.index+1+r,i,u.index+1+u[0].length+r),u,l),s>=d))return s;while(u);return s}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Pe){let{node:i,remainder:r,nodeStartOffset:s}=this.nodeAt(e),a=i.piece,l=a.bufferIndex,d=this.positionInBuffer(i,r);if(i.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===e&&t.length<_l){this.appendToNode(i,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(s+i.piece.length>e){let c=[],u=new no(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(i,r)===10){let g={line:u.start.line+1,column:0};u=new no(u.bufferIndex,g,u.end,this.getLineFeedCnt(u.bufferIndex,g,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(i,r-1)===13){let g=this.positionInBuffer(i,r-1);this.deleteNodeTail(i,g),t="\r"+t,i.piece.length===0&&c.push(i)}else this.deleteNodeTail(i,d);else this.deleteNodeTail(i,d);let p=this.createNewPieces(t);u.length>0&&this.rbInsertRight(i,u);let h=i;for(let f=0;f<p.length;f++)h=this.rbInsertRight(h,p[f]);this.deleteNodes(c)}else this.insertContentToNodeRight(t,i)}else{let i=this.createNewPieces(t),r=this.rbInsertLeft(null,i[0]);for(let s=1;s<i.length;s++)r=this.rbInsertRight(r,i[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Pe)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),r=n.node,s=i.node;if(r===s){let p=this.positionInBuffer(r,n.remainder),h=this.positionInBuffer(r,i.remainder);if(n.nodeStartOffset===e){if(t===r.piece.length){let f=r.next();Xf(this,r),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}this.deleteNodeHead(r,h),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,p),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,p,h),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);let d=this.positionInBuffer(s,i.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=r.next();for(let p=c;p!==Pe&&p!==s;p=p.next())a.push(p);let u=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let s=t.piece,a={line:s.start.line+1,column:0},l=new no(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);t.piece=l,e+=`
`,_a(this,t,-1,-1),t.piece.length===0&&n.push(t)}let i=this.createNewPieces(e),r=this.rbInsertLeft(t,i[i.length-1]);for(let s=i.length-2;s>=0;s--)r=this.rbInsertLeft(r,i[s]);this.validateCRLFWithPrevNode(r),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),r=i;for(let s=1;s<n.length;s++)r=this.rbInsertRight(r,n[s]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,r=e.piece.bufferIndex,s=this._buffers[r].lineStarts,l=s[i.start.line]+i.start.column+t,d=i.start.line,c=i.end.line,u=0,p=0,h=0;for(;d<=c&&(u=d+(c-d)/2|0,h=s[u],u!==c);)if(p=s[u+1],l<h)c=u-1;else if(l>=p)d=u+1;else break;return n?(n.line=u,n.column=l-h,null):{line:u,column:l-h}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let r=i[n.line+1],s=i[n.line]+n.column;if(r>s+1)return n.line-t.line;let a=s-1;return this._buffers[e].buffer.charCodeAt(a)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Xf(this,e[t])}createNewPieces(e){if(e.length>_l){let c=[];for(;e.length>_l;){let p=e.charCodeAt(_l-1),h;p===13||p>=55296&&p<=56319?(h=e.substring(0,_l-1),e=e.substring(_l-1)):(h=e.substring(0,_l),e=e.substring(_l));let f=La(h);c.push(new no(this._buffers.length,{line:0,column:0},{line:f.length-1,column:h.length-f[f.length-1]},f.length-1,h.length)),this._buffers.push(new Da(h,f))}let u=La(e);return c.push(new no(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new Da(e,u)),c}let t=this._buffers[0].buffer.length,n=La(e,!1),i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let c=0;c<n.length;c++)n[c]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let c=0;c<n.length;c++)n[c]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}let r=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new no(0,i,l,this.getLineFeedCnt(0,i,l),r-t);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,i="",r=this._searchCache.get2(e);if(r){n=r.node;let s=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e)i=a.substring(l+s,l+n.piece.length);else{let d=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return a.substring(l+s,l+d-t)}}else{let s=0,a=e;for(;n!==Pe;)if(n.left!==Pe&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this.getAccumulatedValue(n,e-n.lf_left-1),c=this._buffers[n.piece.bufferIndex].buffer,u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:s,nodeStartLineNumber:a-(e-1-n.lf_left)}),c.substring(u+l,u+d-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this._buffers[n.piece.bufferIndex].buffer,c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=d.substring(c+l,c+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==Pe;){let s=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(n,0),l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=s.substring(l,l+a-t),i}else{let a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=s.substr(a,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==Pe;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),r=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let s=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(s!==r)return{index:s,remainder:0}}return{index:r,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,r=n.start.line+t+1;return r>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[r]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.end),s=t,a=this.offsetInBuffer(n.bufferIndex,s),l=this.getLineFeedCnt(n.bufferIndex,n.start,s),d=l-i,c=a-r,u=n.length+c;e.piece=new no(n.bufferIndex,n.start,s,l,u),_a(this,e,c,d)}deleteNodeHead(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.start),s=t,a=this.getLineFeedCnt(n.bufferIndex,s,n.end),l=this.offsetInBuffer(n.bufferIndex,s),d=a-i,c=r-l,u=n.length+c;e.piece=new no(n.bufferIndex,s,n.end,a,u),_a(this,e,c,d)}shrinkNode(e,t,n){let i=e.piece,r=i.start,s=i.end,a=i.length,l=i.lineFeedCnt,d=t,c=this.getLineFeedCnt(i.bufferIndex,i.start,d),u=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,r);e.piece=new no(i.bufferIndex,i.start,d,c,u),_a(this,e,u-a,c-l);let p=new no(i.bufferIndex,n,s,this.getLineFeedCnt(i.bufferIndex,n,s),this.offsetInBuffer(i.bufferIndex,s)-this.offsetInBuffer(i.bufferIndex,n)),h=this.rbInsertRight(e,p);this.validateCRLFWithPrevNode(h)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let r=La(t,!1);for(let h=0;h<r.length;h++)r[h]+=i;if(n){let h=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-h}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=e.piece.length+t.length,c=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),p=u-c;e.piece=new no(e.piece.bufferIndex,e.piece.start,l,u,d),this._lastChangeBufferPos=l,_a(this,e,t.length,p)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;for(;t!==Pe;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){i+=t.size_left;let r={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,i=0;for(;n!==Pe;)if(n.left!==Pe&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2),s=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(r+t-1,s),nodeStartOffset:i}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+t-1<=n.piece.length)return{node:n,remainder:r+t-1,nodeStartOffset:i};t-=n.piece.length-r;break}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==Pe;){if(n.piece.lineFeedCnt>0){let r=this.getAccumulatedValue(n,0),s=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,r),nodeStartOffset:s}}else if(n.piece.length>=t-1){let r=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:r}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Pe||e.piece.lineFeedCnt===0)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,r=n[i]+t.start.column;return i===n.length-1||n[i+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Pe||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n=[],i=this._buffers[e.piece.bufferIndex].lineStarts,r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:i[e.piece.end.line]-i[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};let s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new no(e.piece.bufferIndex,e.piece.start,r,a,s),_a(this,e,-1,-1),e.piece.length===0&&n.push(e);let l={line:t.piece.start.line+1,column:0},d=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new no(t.piece.bufferIndex,l,t.piece.end,c,d),_a(this,t,-1,-1),t.piece.length===0&&n.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let p=0;p<n.length;p++)Xf(this,n[p])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)Xf(this,n);else{let i=n.piece,r={line:i.start.line+1,column:0},s=i.length-1,a=this.getLineFeedCnt(i.bufferIndex,r,i.end);n.piece=new no(i.bufferIndex,r,i.end,a,s),_a(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Pe)return t(Pe);let n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Pe)return"";let t=this._buffers[e.piece.bufferIndex],n=e.piece,i=this.offsetInBuffer(n.bufferIndex,n.start),r=this.offsetInBuffer(n.bufferIndex,n.end);return t.buffer.substring(i,r)}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,i)}rbInsertRight(e,t){let n=new Eh(t,1);if(n.left=Pe,n.right=Pe,n.parent=Pe,n.size_left=0,n.lf_left=0,this.root===Pe)this.root=n,n.color=0;else if(e.right===Pe)e.right=n,n.parent=e;else{let r=AC(e.right);r.left=n,n.parent=r}return ek(this,n),n}rbInsertLeft(e,t){let n=new Eh(t,1);if(n.left=Pe,n.right=Pe,n.parent=Pe,n.size_left=0,n.lf_left=0,this.root===Pe)this.root=n,n.color=0;else if(e.left===Pe)e.left=n,n.parent=e;else{let i=Q0(e.left);i.right=n,n.parent=i}return ek(this,n),n}getContentOfSubTree(e){let t="";return this.iterate(e,n=>(t+=this.getNodeContent(n),!0)),t}};var Th=class o extends F{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new k);onDidChangeContent=this._onDidChangeContent.event;constructor(e,t,n,i,r,s,a){super(),this._BOM=t,this._mightContainNonBasicASCII=!s,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._pieceTree=new BC(e,n,a)}equals(e){return!(e instanceof o)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t,i=this.getPositionAt(e),r=this.getPositionAt(n);return new M(i.lineNumber,i.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";let n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),i=this.getOffsetAt(e.endLineNumber,e.endColumn),r=0,s=this._getEndOfLine(t),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=e.endLineNumber-e.startLineNumber;r=l*d}return i-n+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0,i=e.startLineNumber,r=e.endLineNumber;for(let s=i;s<=r;s++){let a=this.getLineContent(s),l=s===i?e.startColumn-1:0,d=s===r?e.endColumn-1:a.length;for(let c=l;c<d;c++)rn(a.charCodeAt(c))?(n=n+1,c=c+1):n=n+1}return n+=this._getEndOfLine(t).length*(r-i),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=fn(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=_r(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let g=0;g<e.length;g++){let b=e[g];a&&b._isTracked&&(a=!1);let v=b.range;if(b.text){let w=!0;s||(w=!jg(b.text),s=w),!i&&w&&(i=ml(b.text)),!r&&w&&(r=Ly(b.text))}let I="",T=0,S=0,C=0;if(b.text){let w;[T,S,C,w]=Po(b.text);let x=this.getEOL(),D=x===`\r
`?2:1;w===0||w===D?I=b.text:I=b.text.replace(/\r\n|\r|\n/g,x)}l[g]={sortIndex:g,identifier:b.identifier||null,range:v,rangeOffset:this.getOffsetAt(v.startLineNumber,v.startColumn),rangeLength:this.getValueLengthInRange(v),text:I,eolCount:T,firstLineLength:S,lastLineLength:C,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(o._sortOpsAscending);let d=!1;for(let g=0,b=l.length-1;g<b;g++){let v=l[g].range.getEndPosition(),I=l[g+1].range.getStartPosition();if(I.isBeforeOrEqual(v)){if(I.isBefore(v))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=n||t?o._getInverseEditRanges(l):[],u=[];if(t)for(let g=0;g<l.length;g++){let b=l[g],v=c[g];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let I=v.startLineNumber;I<=v.endLineNumber;I++){let T="";I===v.startLineNumber&&(T=this.getLineContent(b.range.startLineNumber),fn(T)!==-1)||u.push({lineNumber:I,oldContent:T})}}let p=null;if(n){let g=0;p=[];for(let b=0;b<l.length;b++){let v=l[b],I=c[b],T=this.getValueInRange(v.range),S=v.rangeOffset+g;g+=v.text.length-T.length,p[b]={sortIndex:v.sortIndex,identifier:v.identifier,range:I,text:T,textChange:new tr(v.rangeOffset,T,S,v.text)}}d||p.sort((b,v)=>b.sortIndex-v.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=s;let h=this._doApplyEdits(l),f=null;if(t&&u.length>0){u.sort((g,b)=>b.lineNumber-g.lineNumber),f=[];for(let g=0,b=u.length;g<b;g++){let v=u[g].lineNumber;if(g>0&&u[g-1].lineNumber===v)continue;let I=u[g].oldContent,T=this.getLineContent(v);T.length===0||T===I||fn(T)!==-1||f.push(v)}}return this._onDidChangeContent.fire(),new ZI(p,h,f)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,n=e[0].range,i=e[e.length-1].range,r=new M(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn),s=n.startLineNumber,a=n.startColumn,l=[];for(let h=0,f=e.length;h<f;h++){let g=e[h],b=g.range;t=t||g.forceMoveMarkers,l.push(this.getValueInRange(new M(s,a,b.startLineNumber,b.startColumn))),g.text.length>0&&l.push(g.text),s=b.endLineNumber,a=b.endColumn}let d=l.join(""),[c,u,p]=Po(d);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:d,eolCount:c,firstLineLength:u,lastLineLength:p,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(o._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n],r=i.range.startLineNumber,s=i.range.startColumn,a=i.range.endLineNumber,l=i.range.endColumn;if(r===a&&s===l&&i.text.length===0)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);let d=new M(r,s,a,l);t.push({range:d,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let n=e.startLineNumber,i=e.startColumn,[r,s,a]=Po(t),l;if(t.length>0){let d=r+1;d===1?l=new M(n,i,n,i+s):l=new M(n,i,n+d-1,a+1)}else l=new M(n,i,n,i);return l}static _getInverseEditRanges(e){let t=[],n=0,i=0,r=null;for(let s=0,a=e.length;s<a;s++){let l=e[s],d,c;r?r.range.endLineNumber===l.range.startLineNumber?(d=n,c=i+(l.range.startColumn-r.range.endColumn)):(d=n+(l.range.startLineNumber-r.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let u;if(l.text.length>0){let p=l.eolCount+1;p===1?u=new M(d,c,d,c+l.firstLineLength):u=new M(d,c,d+p-1,l.lastLineLength+1)}else u=new M(d,c,d,c);n=u.endLineNumber,i=u.endColumn,t.push(u),r=l}return t}static _sortOpsAscending(e,t){let n=M.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=M.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}};var rk=class{constructor(e,t,n,i,r,s,a,l,d){this._chunks=e;this._bom=t;this._cr=n;this._lf=i;this._crlf=r;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(e){let t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,s=n.length;r<s;r++){let a=n[r].buffer.replace(/\r\n|\r|\n/g,t),l=La(a);n[r]=new Da(a,l)}let i=new Th(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},wh=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&OA(e)&&(this.BOM=MA,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=oW(this._tmpLineStarts,e);this.chunks.push(new Da(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=ml(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Ly(e)))}finish(e=!0){return this._finish(),new rk(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=La(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}};var rW=new class{clone(){return this}equals(o){return this===o}};function sk(o,e){let t=new Uint32Array(2);return t[0]=0,t[1]=(o<<0|0|0|32768|2<<24)>>>0,new SI(t,e===null?rW:e)}var WC=class{constructor(e){this._default=e}_store=[];get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,n){if(e>=this._store.length)return;if(t===0){this.insert(e,n);return}else if(n===0){this.delete(e,t);return}let i=this._store.slice(0,e),r=this._store.slice(e+t),s=V9(n,this._default);this._store=i.concat(s,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;let n=[];for(let i=0;i<t;i++)n[i]=this._default;this._store=la(this._store,e,n)}};function V9(o,e){let t=[];for(let n=0;n<o;n++)t[n]=e;return t}var lu=class{static deserialize(e){let t=0,n=li(e,t);t+=4;let i=[];for(let r=0;r<n;r++)t=Cf.deserialize(e,t,i);return i}_tokens;constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let n=this._tokens[this._tokens.length-1];if(n.endLineNumber+1===e){n.appendLineTokens(t);return}}this._tokens.push(new Cf(e,[t]))}finalize(){return this._tokens}serialize(){let e=this._serializeSize(),t=new Uint8Array(e);return this._serialize(t),t}_serializeSize(){let e=0;e+=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;di(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++)t=this._tokens[n].serialize(e,t)}};var ak=class{constructor(e,t){this.tokenizationSupport=t;this.store=new _h(e)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},VC=class extends ak{constructor(t,n,i,r){super(t,n);this._textModel=i;this._languageIdCodec=r}updateTokensUntilLine(t,n){let i=this._textModel.getLanguageId();for(;;){let r=this.getFirstInvalidLine();if(!r||r.lineNumber>n)break;let s=this._textModel.getLineContent(r.lineNumber),a=xh(this._languageIdCodec,i,this.tokenizationSupport,s,!0,r.startState);t.add(r.lineNumber,a.tokens),this.store.setEndState(r.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(t,n){let i=this.getStartState(t.lineNumber);if(!i)return 0;let r=this._textModel.getLanguageId(),s=this._textModel.getLineContent(t.lineNumber),a=s.substring(0,t.column-1)+n+s.substring(t.column-1),l=xh(this._languageIdCodec,r,this.tokenizationSupport,a,!0,i),d=new vn(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(t.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(t,n){let i=this.getStartState(t);if(!i)return{mainLineTokens:null,additionalLines:null};let r=this._textModel.getLineContent(t),s=n.lineEdit.apply(r),a=this._textModel.getLanguageIdAtPosition(t,0),l=xh(this._languageIdCodec,a,this.tokenizationSupport,s,!0,i),d=null;if(n.additionalLines){d=[];let u=l.endState;for(let p of n.additionalLines){let h=xh(this._languageIdCodec,a,this.tokenizationSupport,p,!0,u);d.push(new vn(h.tokens,p,this._languageIdCodec)),u=h.endState}}return{mainLineTokens:new vn(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n}isCheapToTokenize(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n||t===n&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,n,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,i),{heuristicTokens:!1};let r=this.guessStartState(n),s=this._textModel.getLanguageId();for(let a=n;a<=i;a++){let l=this._textModel.getLineContent(a),d=xh(this._languageIdCodec,s,this.tokenizationSupport,l,!0,r);t.add(a,d.tokens),r=d.endState}return{heuristicTokens:!0}}guessStartState(t){let n=this._textModel.getLineFirstNonWhitespaceColumn(t),i=[],r=null;for(let l=t-1;n>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<n&&(i.push(this._textModel.getLineContent(l)),n=d,r=this.getStartState(l),r))break}r||(r=this.tokenizationSupport.getInitialState()),i.reverse();let s=this._textModel.getLanguageId(),a=r;for(let l of i)a=xh(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},_h=class{constructor(e){this.lineCount=e;this._invalidEndStatesLineNumbers.addRange(new ke(1,e+1))}_tokenizationStateStore=new lk;_invalidEndStatesLineNumbers=new dk;getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new $e("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let n=this._tokenizationStateStore.setEndState(e,t);return n&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new ke(e+1,e+2)),n}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new ke(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[n]=Po(t.text);this.acceptChange(new De(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new ke(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;let n=this.getStartState(t,e);if(!n)throw new $e("Start state must be defined");return{lineNumber:t,startState:n}}},lk=class{_lineEndStates=new WC(null);getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let n=this._lineEndStates.get(e);return n&&n.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let n=e.length;t>0&&n>0&&(n--,t--),this._lineEndStates.replace(e.startLineNumber,n,t)}acceptChanges(e){for(let t of e){let[n]=Po(t.text);this.acceptChange(new De(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}},dk=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new ke(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(n=>n.contains(e));if(t!==-1){let n=this._ranges[t];n.start===e?n.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new ke(e+1,n.endExclusive):n.endExclusive===e+1?this._ranges[t]=new ke(n.start,e):this._ranges.splice(t,1,new ke(n.start,e),new ke(e+1,n.endExclusive))}}addRange(e){ke.addRange(e,this._ranges)}addRangeAndResize(e,t){let n=0;for(;!(n>=this._ranges.length||e.start<=this._ranges[n].endExclusive);)n++;let i=n;for(;!(i>=this._ranges.length||e.endExclusive<this._ranges[i].start);)i++;let r=t-e.length;for(let s=i;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(r);if(n===i){let s=new ke(e.start,e.start+t);s.isEmpty||this._ranges.splice(n,0,s)}else{let s=Math.min(e.start,this._ranges[n].start),a=Math.max(e.endExclusive,this._ranges[i-1].endExclusive),l=new ke(s,a+r);l.isEmpty?this._ranges.splice(n,i-n):this._ranges.splice(n,i-n,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}};function xh(o,e,t,n,i,r){let s=null;if(t)try{s=t.tokenizeEncoded(n,i,r.clone())}catch(a){je(a)}return s||(s=sk(o.encodeLanguageId(e),r)),vn.convertToEndOffset(s.tokens,n.length),s}var HC=class{constructor(e,t){this._tokenizerWithStateStore=e;this._backgroundTokenStore=t}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Dd(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),n=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?$v(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new lu,n=Ss.create(!1);do if(n.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new De(e,t))}};var UC=class{_onDidChangeVisibleRanges=new k;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let e=new ck(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}},ck=class{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){let n=e.map(i=>new De(i.startLineNumber,i.endLineNumber+1));this.handleStateChange({visibleLineRanges:n,stabilized:t})}},zC=class extends F{constructor(t){super();this._refreshTokens=t}runner=this._register(new ln(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){Ut(this._computedLineRanges,this._lineRanges,(t,n)=>t.equals(n))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},Lh=class extends F{constructor(t,n,i){super();this._languageIdCodec=t;this._textModel=n;this.getLanguageId=i}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new k);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new k);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}};var sW=Q("treeSitterParserService");var Jf=class extends Lh{constructor(t,n,i,r){super(n,i,r);this._treeSitterService=t;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let t=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==t)&&(this._lastLanguageId=t,this._tokenizationSupport=Ef.get(t))}getLineTokens(t){let n=this._textModel.getLineContent(t);if(this._tokenizationSupport){let i=this._tokenizationSupport.tokenizeEncoded(t,this._textModel);if(i)return new vn(i,n,this._languageIdCodec)}return vn.createEmpty(n,this._languageIdCodec)}resetTokenization(t=!0){t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(t){t.isFlush&&this.resetTokenization(!1)}forceTokenization(t){}hasAccurateTokensForLine(t){return!0}isCheapToTokenize(t){return!0}getTokenTypeIfInsertingCharacter(t,n,i){return 0}tokenizeLineWithEdit(t,n){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var eb=class o{_lineTokens;_len;_languageIdCodec;constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),i!==null&&i!==Ca)return new vn(Sa(i),n,this._languageIdCodec);let r=new Uint32Array(2);return r[0]=n.length,r[1]=aW(this._languageIdCodec.encodeLanguageId(e)),new vn(r,n,this._languageIdCodec)}static _massageTokens(e,t,n){let i=n?Sa(n):null;if(t===0){let r=!1;if(i&&i.length>1&&(r=nr.getLanguageId(i[1])!==e),!r)return Ca}if(!i||i.length===0){let r=new Uint32Array(2);return r[0]=t,r[1]=aW(e),r.buffer}return i[i.length-2]=t,i.byteOffset===0&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=la(this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,r){let s=o._massageTokens(this._languageIdCodec.encodeLanguageId(e),n,i);this._ensureLine(t);let a=this._lineTokens[t];return this._lineTokens[t]=s,r?!o._equals(a,s):!1}static _equals(e,t){if(!e||!t)return!e&&!t;let n=Sa(e),i=Sa(t);if(n.length!==i.length)return!1;for(let r=0,s=n.length;r<s;r++)if(n[r]!==i[r])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new A(e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){let t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=ci.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=ci.deleteEnding(this._lineTokens[t],e.startColumn-1);let n=e.endLineNumber-1,i=null;n<this._len&&(i=ci.deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=ci.append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-1;if(!(i>=this._len)){if(t===0){this._lineTokens[i]=ci.insert(this._lineTokens[i],e.column-1,n);return}this._lineTokens[i]=ci.deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=ci.insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&n.push({fromLineNumber:a,toLineNumber:l})}return{changes:n}}};function aW(o){return(o<<0|0|0|32768|2<<24|1024)>>>0}var KC=class o{_pieces;_isComplete;_languageIdCodec;constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){let r=t[0].getRange(),s=t[t.length-1].getRange();if(!r||!s)return e;n=e.plusRange(r).plusRange(s)}let i=null;for(let r=0,s=this._pieces.length;r<s;r++){let a=this._pieces[r];if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};break}if(a.removeTokens(n),a.isEmpty()){this._pieces.splice(r,1),r--,s--;continue}if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};continue}let[l,d]=a.split(n);if(l.isEmpty()){i=i||{index:r};continue}d.isEmpty()||(this._pieces.splice(r,1,l,d),r++,s++,i=i||{index:r})}return i=i||{index:this._pieces.length},t.length>0&&(this._pieces=la(this._pieces,i.index,t)),n}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;let n=this._pieces;if(n.length===0)return t;let i=o._findFirstPieceWithLine(n,e),r=n[i].getLineTokens(e);if(!r)return t;let s=t.getCount(),a=r.getCount(),l=0,d=[],c=0,u=0,p=(h,f)=>{h!==u&&(u=h,d[c++]=h,d[c++]=f)};for(let h=0;h<a;h++){let f=r.getStartCharacter(h),g=r.getEndCharacter(h),b=r.getMetadata(h),v=((b&1?2048:0)|(b&2?4096:0)|(b&4?8192:0)|(b&8?16384:0)|(b&16?16744448:0)|(b&32?4278190080:0))>>>0,I=~v>>>0;for(;l<s&&t.getEndOffset(l)<=f;)p(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<s&&t.getStartOffset(l)<f&&p(f,t.getMetadata(l));l<s&&t.getEndOffset(l)<g;)p(t.getEndOffset(l),t.getMetadata(l)&I|b&v),l++;if(l<s)p(g,t.getMetadata(l)&I|b&v),t.getEndOffset(l)===g&&l++;else{let T=Math.min(Math.max(0,l-1),s-1);p(g,t.getMetadata(T)&I|b&v)}}for(;l<s;)p(t.getEndOffset(l),t.getMetadata(l)),l++;return new vn(new Uint32Array(d),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;for(;n<i;){let r=n+Math.floor((i-n)/2);if(e[r].endLineNumber<t)n=r+1;else if(e[r].startLineNumber>t)i=r-1;else{for(;r>n&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return n}acceptEdit(e,t,n,i,r){for(let s of this._pieces)s.acceptEdit(e,t,n,i,r)}};var Ll=class extends Ih{constructor(t,n,i,r,s,a,l){super();this._textModel=t;this._bracketPairsTextModelPart=n;this._languageId=i;this._attachedViews=r;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(j.filter(Ef.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new KC(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new k);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new k);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new k);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new ne);createGrammarTokens(){return this._register(new GC(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new Jf(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(t){let n=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=t?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),n&&this._tokens.resetTokenization()}createPreferredTokenProvider(){Ef.get(this._languageId)?this._tokens instanceof Jf||this.createTokens(!0):this._tokens instanceof GC||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(t){t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(let n of t.changes){let[i,r,s]=Po(n.text);this._semanticTokens.acceptEdit(n.range,i,r,s,n.text.length>0?n.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(t)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);let n=this._tokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,n)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new $e("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this._tokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this._tokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this._tokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this._tokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,n,i){return this._tokens.getTokenTypeIfInsertingCharacter(t,n,i)}tokenizeLineWithEdit(t,n){return this._tokens.tokenizeLineWithEdit(t,n)}setSemanticTokens(t,n){this._semanticTokens.set(t,n),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,n){if(this.hasCompleteSemanticTokens())return;let i=this._textModel.validateRange(this._semanticTokens.setPartial(t,n));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();let n=this._textModel.validatePosition(t),i=this._textModel.getLineContent(n.lineNumber),r=this.getLineTokens(n.lineNumber),s=r.findTokenIndexAtOffset(n.column-1),[a,l]=Ll._findLanguageBoundaries(r,s),d=nf(n.column,this.getLanguageConfiguration(r.getLanguageId(s)).getWordDefinition(),i.substring(a,l),a);if(d&&d.startColumn<=t.column&&t.column<=d.endColumn)return d;if(s>0&&a===n.column-1){let[c,u]=Ll._findLanguageBoundaries(r,s-1),p=nf(n.column,this.getLanguageConfiguration(r.getLanguageId(s-1)).getWordDefinition(),i.substring(c,u),c);if(p&&p.startColumn<=t.column&&t.column<=p.endColumn)return p}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,n){let i=t.getLanguageId(n),r=0;for(let a=n;a>=0&&t.getLanguageId(a)===i;a--)r=t.getStartOffset(a);let s=t.getLineContent().length;for(let a=n,l=t.getCount();a<l&&t.getLanguageId(a)===i;a++)s=t.getEndOffset(a);return[r,s]}getWordUntilPosition(t){let n=this.getWordAtPosition(t);return n?{word:n.word.substr(0,t.column-n.startColumn),startColumn:n.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,n){let i=this._textModel.validatePosition(new A(t,n)),r=this.getLineTokens(i.lineNumber);return r.getLanguageId(r.findTokenIndexAtOffset(i.column-1))}setLanguageId(t,n="api"){if(this._languageId===t)return;let i={oldLanguage:this._languageId,newLanguage:t,source:n};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};Ll=P([_(4,$n),_(5,Cl),_(6,sW)],Ll);var GC=class extends Lh{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new on);_tokens=new eb(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new on);_attachedViewStates=this._register(new wr);constructor(e,t,n,i){super(e,t,n),this._register(or.onDidChange(r=>{let s=this.getLanguageId();r.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(i.onDidChangeVisibleRanges(({view:r,state:s})=>{if(s){let a=this._attachedViewStates.get(r);a||(a=new zC(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(r)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new _h(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let r=or.get(this.getLanguageId());if(!r)return[null,null];let s;try{s=r.getInitialState()}catch(a){return je(a),[null,null]}return[r,s]},[n,i]=t();if(n&&i?this._tokenizer=new VC(this._textModel.getLineCount(),n,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let r={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};n&&n.createBackgroundTokenizer&&!n.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,r)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new HC(this._tokenizer,r),this._defaultBackgroundTokenizer.handleChanges()),n?.backgroundTokenizerShouldOnlyVerifyTokens&&n.createBackgroundTokenizer?(this._debugBackgroundTokens=new eb(this._languageIdCodec),this._debugBackgroundStates=new _h(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(let t of e.changes){let[n,i]=Po(t.text);this._tokens.acceptEdit(t.range,n,i),this._debugBackgroundTokens?.acceptEdit(t.range,n,i)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){let{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){let e=De.joinMany([...this._attachedViewStates].map(([t,n])=>n.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(let t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);let n=new lu,{heuristicTokens:i}=this._tokenizer.tokenizeHeuristically(n,e,t),r=this.setTokens(n.finalize());if(i)for(let s of r.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){let t=new lu;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){let t=this._textModel.getLineContent(e),n=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){let i=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!n.equals(i)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return n}getTokenTypeIfInsertingCharacter(e,t,n){if(!this._tokenizer)return 0;let i=this._textModel.validatePosition(new A(e,t));return this.forceTokenization(i.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLineWithEdit(e,t)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function vk(o){let e=new wh;return e.acceptChunk(o),e.finish()}function uW(o){return new Promise((e,t)=>{let n=new wh,i=!1;xD(o,{onData:r=>{n.acceptChunk(typeof r=="string"?r:r.toString())},onError:r=>{i||(i=!0,t(r))},onEnd:()=>{i||(i=!0,e(n.finish()))}})})}function H9(o){let e=new wh,t;for(;typeof(t=o.read())=="string";)e.acceptChunk(t);return e.finish()}function lW(o,e){let t;return typeof o=="string"?t=vk(o):hF(o)?t=H9(o):t=o,t.create(e)}var jC=0,U9=999,z9=1e4,pk=class{_source;_eos;constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;do{let i=this._source.read();if(i===null)return this._eos=!0,t===0?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=64*1024)return e.join("")}while(!0)}},tb=()=>{throw new Error("Invalid change accessor")};var Ra=class extends F{constructor(t,n,i,r=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;jC++,this.id="$model"+jC,this.isForSimpleWidget=i.isForSimpleWidget,typeof r>"u"||r===null?this._associatedResource=te.parse("inmemory://model/"+jC):this._associatedResource=r,this._attachedEditorCount=0;let{textBuffer:c,disposable:u}=lW(t,i.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=Ra.resolveOptions(this._buffer,i);let p=typeof n=="string"?n:n.languageId;typeof n!="string"&&(this._languageSelectionListener.value=n.onDidChange(()=>this._setLanguage(n.languageId))),this._bracketPairs=this._register(new aC(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new OC(this,this._languageConfigurationService)),this._decorationProvider=this._register(new DC(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(Ll,this,this._bracketPairs,p,this._attachedViews);let h=this._buffer.getLineCount(),f=this._buffer.getValueLengthInRange(new M(1,1,h,this._buffer.getLineLength(h)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=f>Ra.LARGE_FILE_SIZE_THRESHOLD||h>Ra.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=f>Ra.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=f>Ra._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=Dy(jC),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new $C,this._commandManager=new MC(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(g=>{this._bracketPairs.handleLanguageConfigurationServiceChange(g),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(g)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:fa.tabSize,indentSize:fa.indentSize,insertSpaces:fa.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:fa.trimAutoWhitespace,largeFileOptimizations:fa.largeFileOptimizations,bracketPairColorizationOptions:fa.bracketPairColorizationOptions};static resolveOptions(t,n){if(n.detectIndentation){let i=$0(t,n.tabSize,n.insertSpaces);return new eh({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:n.trimAutoWhitespace,defaultEOL:n.defaultEOL,bracketPairColorizationOptions:n.bracketPairColorizationOptions})}return new eh(n)}_onWillDispose=this._register(new k);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new fk(t=>this.handleBeforeFireDecorationsChangedEvent(t)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new k);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new k);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new k);_eventEmitter=this._register(new bk);onDidChangeContent(t){return this._eventEmitter.slowEvent(n=>t(n.contentChangedEvent))}onDidChangeContentOrInjectedText(t){return Mo(this._eventEmitter.fastEvent(n=>t(n)),this._onDidChangeInjectedText.event(n=>t(n)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new on);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new UC;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let t=new Th([],"",`
`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=F.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new $e("Model is disposed!")}equalsTextBuffer(t){return this._assertNotDisposed(),this._buffer.equals(t)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(t,n){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(n),this._bracketPairs.handleDidChangeContent(n),this._eventEmitter.fire(new Nd(t,n)))}setValue(t){if(this._assertNotDisposed(),t==null)throw _c();let{textBuffer:n,disposable:i}=lW(t,this._options.defaultEOL);this._setValueFromTextBuffer(n,i)}_createContentChanged2(t,n,i,r,s,a,l,d){return{changes:[{range:t,rangeOffset:n,rangeLength:i,text:r}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(t,n){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=n,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new $C,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new ou([new KI],this._versionId,!1,!1),this._createContentChanged2(new M(1,1,s,a),0,r,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();let n=t===1?`\r
`:`
`;if(this._buffer.getEOL()===n)return;let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(n),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new ou([new qI],this._versionId,!1,!1),this._createContentChanged2(new M(1,1,s,a),0,r,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let t=this.getVersionId(),n=this._decorationsTree.collectNodesPostOrder();for(let i=0,r=n.length;i<r;i++){let s=n[i],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=t,s.start=d-l,s.end=c-l,Tl(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,n=0,i=this._buffer.getLineCount();for(let r=1;r<=i;r++){let s=this._buffer.getLineLength(r);s>=z9?n+=s:t+=s}return n>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();let n=typeof t.tabSize<"u"?t.tabSize:this._options.tabSize,i=typeof t.indentSize<"u"?t.indentSize:this._options.originalIndentSize,r=typeof t.insertSpaces<"u"?t.insertSpaces:this._options.insertSpaces,s=typeof t.trimAutoWhitespace<"u"?t.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof t.bracketColorizationOptions<"u"?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new eh({tabSize:n,indentSize:i,insertSpaces:r,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(t,n){this._assertNotDisposed();let i=$0(this._buffer,n,t);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),nC(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){let n=this.findMatches(lL.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,n.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();let n=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(n.lineNumber,n.column)}getPositionAt(t){this._assertNotDisposed();let n=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(n)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,n=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new $e("Operation would exceed heap memory limits");let i=this.getFullModelRange(),r=this.getValueInRange(i,t);return n?this._buffer.getBOM()+r:r}createSnapshot(t=!1){return new pk(this._buffer.createSnapshot(t))}getValueLength(t,n=!1){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i,t);return n?this._buffer.getBOM().length+r:r}getValueInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),n)}getValueLengthInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),n)}getCharacterCountInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),n)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new $e("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){let n=this._buffer.getLineCount(),i=t.startLineNumber,r=t.startColumn,s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=Math.floor(typeof r=="number"&&!isNaN(r)?r:1);if(s<1)s=1,a=1;else if(s>n)s=n,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let p=this.getLineMaxColumn(s);a>=p&&(a=p)}let l=t.endLineNumber,d=t.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),u=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,u=1;else if(c>n)c=n,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{let p=this.getLineMaxColumn(c);u>=p&&(u=p)}return i===s&&r===a&&l===c&&d===u&&t instanceof M&&!(t instanceof qe)?t:new M(s,a,c,u)}_isValidPosition(t,n,i){if(typeof t!="number"||typeof n!="number"||isNaN(t)||isNaN(n)||t<1||n<1||(t|0)!==t||(n|0)!==n)return!1;let r=this._buffer.getLineCount();if(t>r)return!1;if(n===1)return!0;let s=this.getLineMaxColumn(t);if(n>s)return!1;if(i===1){let a=this._buffer.getLineCharCode(t,n-2);if(rn(a))return!1}return!0}_validatePosition(t,n,i){let r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=this._buffer.getLineCount();if(r<1)return new A(1,1);if(r>a)return new A(a,this.getLineMaxColumn(a));if(s<=1)return new A(r,1);let l=this.getLineMaxColumn(r);if(s>=l)return new A(r,l);if(i===1){let d=this._buffer.getLineCharCode(r,s-2);if(rn(d))return new A(r,s-1)}return new A(r,s)}validatePosition(t){let n=1;return this._assertNotDisposed(),t instanceof A&&this._isValidPosition(t.lineNumber,t.column,n)?t:this._validatePosition(t.lineNumber,t.column,n)}_isValidRange(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn;if(!this._isValidPosition(i,r,0)||!this._isValidPosition(s,a,0))return!1;if(n===1){let l=r>1?this._buffer.getLineCharCode(i,r-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=rn(l),u=rn(d);return!c&&!u}return!0}validateRange(t){let n=1;if(this._assertNotDisposed(),t instanceof M&&!(t instanceof qe)&&this._isValidRange(t,n))return t;let i=this._validatePosition(t.startLineNumber,t.startColumn,0),r=this._validatePosition(t.endLineNumber,t.endColumn,0),s=i.lineNumber,a=i.column,l=r.lineNumber,d=r.column;if(n===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,u=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,p=rn(c),h=rn(u);return!p&&!h?new M(s,a,l,d):s===l&&a===d?new M(s,a-1,l,d-1):p&&h?new M(s,a-1,l,d+1):p?new M(s,a-1,l,d):new M(s,a,l,d+1)}return new M(s,a,l,d)}modifyPosition(t,n){this._assertNotDisposed();let i=this.getOffsetAt(t)+n;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();let t=this.getLineCount();return new M(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,n,i,r){return this._buffer.findMatchesLineByLine(t,n,i,r)}findMatches(t,n,i,r,s,a,l=U9){this._assertNotDisposed();let d=null;n!==null&&(Array.isArray(n)||(n=[n]),n.every(p=>M.isIRange(p))&&(d=n.map(p=>this.validateRange(p)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((p,h)=>p.startLineNumber-h.startLineNumber||p.startColumn-h.startColumn);let c=[];c.push(d.reduce((p,h)=>M.areIntersecting(p,h)?p.plusRange(h):(c.push(p),h)));let u;if(!i&&t.indexOf(`
`)<0){let h=new xl(t,i,r,s).parseSearchRequest();if(!h)return[];u=f=>this.findMatchesLineByLine(f,h,a,l)}else u=p=>su.findMatches(this,new xl(t,i,r,s),p,a,l);return c.map(u).reduce((p,h)=>p.concat(h),[])}findNextMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);if(!i&&t.indexOf(`
`)<0){let c=new xl(t,i,r,s).parseSearchRequest();if(!c)return null;let u=this.getLineCount(),p=new M(l.lineNumber,l.column,u,this.getLineMaxColumn(u)),h=this.findMatchesLineByLine(p,c,a,1);return su.findNextMatch(this,new xl(t,i,r,s),l,a),h.length>0||(p=new M(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),h=this.findMatchesLineByLine(p,c,a,1),h.length>0)?h[0]:null}return su.findNextMatch(this,new xl(t,i,r,s),l,a)}findPreviousMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);return su.findPreviousMatch(this,new xl(t,i,r,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`
`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof th?t:new th(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){let n=[];for(let i=0,r=t.length;i<r;i++)n[i]=this._validateEditOperation(t[i]);return n}pushEditOperations(t,n,i,r){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(n),i,r)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,n,i,r){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=n.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(t)for(let l=0,d=t.length;l<d;l++){let c=t[l],u=!1;for(let p=0,h=s.length;p<h;p++){let f=s[p].range,g=f.startLineNumber>c.endLineNumber,b=c.startLineNumber>f.endLineNumber;if(!g&&!b){u=!0;break}}if(!u){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],u=this.getLineMaxColumn(c),p=!0;for(let h=0,f=s.length;h<f;h++){let g=s[h].range,b=s[h].text;if(!(c<g.startLineNumber||c>g.endLineNumber)&&!(c===g.startLineNumber&&g.startColumn===u&&g.isEmpty()&&b&&b.length>0&&b.charAt(0)===`
`)&&!(c===g.startLineNumber&&g.startColumn===1&&g.isEmpty()&&b&&b.length>0&&b.charAt(b.length-1)===`
`)){p=!1;break}}if(p){let h=new M(c,1,c,u);n.push(new th(null,h,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,n,i,r)}_applyUndo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new M(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,n,!0,!1,i,r)}_applyRedo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new M(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,n,!1,!0,i,r)}_applyUndoRedoEdits(t,n,i,r,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=r,this.applyEdits(t,!1),this.setEOL(n),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,n=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let i=this._validateEditOperations(t);return this._doApplyEdits(i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,n){let i=this._buffer.getLineCount(),r=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,n),s=this._buffer.getLineCount(),a=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,u=a.length;c<u;c++){let p=a[c];this._decorationsTree.acceptReplace(p.rangeOffset,p.rangeLength,p.text.length,p.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=i;for(let c=0,u=a.length;c<u;c++){let p=a[c],[h]=Po(p.text);this._onDidChangeDecorations.fire();let f=p.range.startLineNumber,g=p.range.endLineNumber,b=g-f,v=h,I=Math.min(b,v),T=v-b,S=s-d-T+f,C=S,w=S+v,x=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new A(C,1)),this.getOffsetAt(new A(w,this.getLineMaxColumn(w))),0),D=Bo.fromDecorations(x),O=new Wi(D);for(let H=I;H>=0;H--){let K=f+H,z=S+H;O.takeFromEndWhile(Se=>Se.lineNumber>z);let ie=O.takeFromEndWhile(Se=>Se.lineNumber===z);l.push(new Nf(K,this.getLineContent(z),ie))}if(I<b){let H=f+I;l.push(new GI(H+1,g))}if(I<v){let H=new Wi(D),K=f+I,z=v-I,ie=s-d-z+K+1,Se=[],J=[];for(let X=0;X<z;X++){let le=ie+X;J[X]=this.getLineContent(le),H.takeWhile(re=>re.lineNumber<le),Se[X]=H.takeWhile(re=>re.lineNumber===le)}l.push(new jI(K+1,f+v,J,Se))}d+=T}this._emitContentChangedEvent(new ou(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;let i=Array.from(t).map(r=>new Nf(r,this.getLineContent(r),this._getInjectedTextInLine(r)));this._onDidChangeInjectedText.fire(new Jp(i))}changeDecorations(t,n=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(n,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,n){let i={addDecoration:(s,a)=>this._deltaDecorationsImpl(t,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,cW(a))},removeDecoration:s=>{this._deltaDecorationsImpl(t,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(t,s,a)},r=null;try{r=n(i)}catch(s){je(s)}return i.addDecoration=tb,i.changeDecoration=tb,i.changeDecorationOptions=tb,i.removeDecoration=tb,i.deltaDecorations=tb,r}deltaDecorations(t,n,i=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&n.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),je(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,t,n)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,n,i){let r=t?this._decorations[t]:null;if(!r)return n?this._deltaDecorationsImpl(0,[],[{range:n,options:dW[i]}],!0)[0]:null;if(!n)return this._decorationsTree.delete(r),delete this._decorations[r.id],null;let s=this._validateRangeRelaxedNoAllocations(n),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(r),r.reset(this.getVersionId(),a,l,s),r.setOptions(dW[i]),this._decorationsTree.insert(r),r.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;let n=this._decorationsTree.collectNodesFromOwner(t);for(let i=0,r=n.length;i<r;i++){let s=n[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(t){let n=this._decorations[t];return n?n.options:null}getDecorationRange(t){let n=this._decorations[t];return n?this._decorationsTree.getNodeRange(this,n):null}getLineDecorations(t,n=0,i=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,n,i)}getLinesDecorations(t,n,i=0,r=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,t)),d=Math.min(a,Math.max(1,n)),c=this.getLineMaxColumn(d),u=new M(l,1,d,c),p=this._getDecorationsInRange(u,i,r,s);return Mg(p,this._decorationProvider.getDecorationsInRange(u,i,r)),p}getDecorationsInRange(t,n=0,i=!1,r=!1,s=!1){let a=this.validateRange(t),l=this._getDecorationsInRange(a,n,i,s);return Mg(l,this._decorationProvider.getDecorationsInRange(a,n,i,r)),l}getOverviewRulerDecorations(t=0,n=!1){return this._decorationsTree.getAll(this,t,n,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){let n=this._buffer.getOffsetAt(t,1),i=n+this._buffer.getLineLength(t),r=this._decorationsTree.getInjectedTextInInterval(this,n,i,0);return Bo.fromDecorations(r).filter(s=>s.lineNumber===t)}getAllDecorations(t=0,n=!1){let i=this._decorationsTree.getAll(this,t,n,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(t,n)),i}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,n,i,r){let s=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),a=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,n,i,r)}getRangeAt(t,n){return this._buffer.getRangeAt(t,n-t)}_changeDecorationImpl(t,n){let i=this._decorations[t];if(!i)return;if(i.options.after){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let r=this._validateRangeRelaxedNoAllocations(n),s=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,a,r),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber)}_changeDecorationOptionsImpl(t,n){let i=this._decorations[t];if(!i)return;let r=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(n.overviewRuler&&n.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(n),i.options.after||n.after){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(i.options.before||n.before){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=r!==s,l=G9(n)!==qC(i);a||l?(this._decorationsTree.delete(i),i.setOptions(n),this._decorationsTree.insert(i)):i.setOptions(n)}_deltaDecorationsImpl(t,n,i,r=!1){let s=this.getVersionId(),a=n.length,l=0,d=i.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let u=new Array(d);for(;l<a||c<d;){let p=null;if(l<a){do p=this._decorations[n[l++]];while(!p&&l<a);if(p){if(p.options.after){let h=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.endLineNumber)}if(p.options.before){let h=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.startLineNumber)}this._decorationsTree.delete(p),r||this._onDidChangeDecorations.checkAffectedAndFire(p.options)}}if(c<d){if(!p){let I=++this._lastDecorationId,T=`${this._instanceId};${I}`;p=new $f(T,0,0),this._decorations[T]=p}let h=i[c],f=this._validateRangeRelaxedNoAllocations(h.range),g=cW(h.options),b=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),v=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);p.ownerId=t,p.reset(s,b,v,f),p.setOptions(g),p.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),p.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),r||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(p),u[c]=p.id,c++}else p&&delete this._decorations[p.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,n){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,n)):(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId,n)),this._setLanguage(t.languageId,n))}_setLanguage(t,n){this.tokenization.setLanguageId(t,n),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,n){return this.tokenization.getLanguageIdAtPosition(t,n)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,n){return t}getLineIndentColumn(t){return K9(this.getLineContent(t))+1}};Ra=P([_(4,pF),_(5,$n),_(6,Cl),_(7,Qe)],Ra);function K9(o){let e=0;for(let t of o)if(t===" "||t==="	")e++;else break;return e}function uk(o){return!!(o.options.overviewRuler&&o.options.overviewRuler.color)}function G9(o){return!!o.after||!!o.before}function qC(o){return!!o.options.after||!!o.options.before}var $C=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new Sh,this._decorationsTree1=new Sh,this._injectedTextDecorationsTree=new Sh}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(let n of t)n.range===null&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,r,s){let a=e.getVersionId(),l=this._intervalSearch(t,n,i,r,a,s);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,n,i,r,s){let a=this._decorationsTree0.intervalSearch(e,t,n,i,r,s),l=this._decorationsTree1.intervalSearch(e,t,n,i,r,s),d=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,r,s);return a.concat(l).concat(d)}getInjectedTextInInterval(e,t,n,i){let r=e.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,r,!1);return this._ensureNodesHaveRanges(e,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){let n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n,!1);return this._ensureNodesHaveRanges(e,i).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAll(e,t,n,i,r){let s=e.getVersionId(),a=this._search(t,n,i,s,r);return this._ensureNodesHaveRanges(e,a)}_search(e,t,n,i,r){if(n)return this._decorationsTree1.search(e,t,i,r);{let s=this._decorationsTree0.search(e,t,i,r),a=this._decorationsTree1.search(e,t,i,r),l=this._injectedTextDecorationsTree.search(e,t,i,r);return s.concat(a).concat(l)}}collectNodesFromOwner(e){let t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){let e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){qC(e)?this._injectedTextDecorationsTree.insert(e):uk(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){qC(e)?this._injectedTextDecorationsTree.delete(e):uk(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){let n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){qC(e)?this._injectedTextDecorationsTree.resolveNode(e,t):uk(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}};function ka(o){return o.replace(/[^a-z0-9\-_]/gi," ")}var YC=class{color;darkColor;constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}},hk=class extends YC{position;_resolvedColor;constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:2}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}},mk=class{position;persistLane;constructor(e){this.position=e?.position??2,this.persistLane=e?.persistLane}},gk=class extends YC{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?V.fromHex(e):t.getColor(e.id)}},ZC=class o{static from(e){return e instanceof o?e:new o(e)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}},yn=class o{static EMPTY;static register(e){return new o(e)}static createDynamic(e){return new o(e)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?ka(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?ka(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new hk(e.overviewRuler):null,this.minimap=e.minimap?new gk(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new mk(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?ka(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?ka(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?ka(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?DA(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?ka(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?ka(e.marginClassName):null,this.inlineClassName=e.inlineClassName?ka(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?ka(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?ka(e.afterContentClassName):null,this.after=e.after?ZC.from(e.after):null,this.before=e.before?ZC.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}};yn.EMPTY=yn.register({description:"empty"});var dW=[yn.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),yn.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),yn.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),yn.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function cW(o){return o instanceof yn?o:yn.createDynamic(o)}var fk=class extends F{constructor(t){super();this.handleBeforeFire=t;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new k);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){this._affectsMinimap||=!!t.minimap?.position,this._affectsOverviewRuler||=!!t.overviewRuler?.color,this._affectsGlyphMargin||=!!t.glyphMarginClassName,this._affectsLineNumber||=!!t.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}},bk=class extends F{_fastEmitter=this._register(new k);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new k);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;let t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}};var Ma=Q("workingCopyService"),yk=class extends F{_onDidRegister=this._register(new k);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new k);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new k);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new k);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new k);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new go;mapWorkingCopyToListeners=this._register(new wr);registerWorkingCopy(e){let t=this.mapResourceToWorkingCopies.get(e.resource);if(t?.has(e.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${e.resource.toString()} and type ${e.typeId}.`);this._workingCopies.add(e),t||(t=new Map,this.mapResourceToWorkingCopies.set(e.resource,t)),t.set(e.typeId,e);let n=new ne;return n.add(e.onDidChangeContent(()=>this._onDidChangeContent.fire(e))),n.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),n.add(e.onDidSave(i=>this._onDidSave.fire({workingCopy:e,...i}))),this.mapWorkingCopyToListeners.set(e,n),this._onDidRegister.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e),pe(()=>{this.unregisterWorkingCopy(e),this._onDidUnregister.fire(e)})}unregisterWorkingCopy(e){this._workingCopies.delete(e);let t=this.mapResourceToWorkingCopies.get(e.resource);t?.delete(e.typeId)&&t.size===0&&this.mapResourceToWorkingCopies.delete(e.resource),e.isDirty()&&this._onDidChangeDirty.fire(e),this.mapWorkingCopyToListeners.deleteAndDispose(e)}has(e){return te.isUri(e)?this.mapResourceToWorkingCopies.has(e):this.mapResourceToWorkingCopies.get(e.resource)?.has(e.typeId)??!1}get(e){return this.mapResourceToWorkingCopies.get(e.resource)?.get(e.typeId)}getAll(e){let t=this.mapResourceToWorkingCopies.get(e);if(t)return Array.from(t.values())}get hasDirty(){for(let e of this._workingCopies)if(e.isDirty())return!0;return!1}get dirtyCount(){let e=0;for(let t of this._workingCopies)t.isDirty()&&e++;return e}get dirtyWorkingCopies(){return this.workingCopies.filter(e=>e.isDirty())}get modifiedCount(){let e=0;for(let t of this._workingCopies)t.isModified()&&e++;return e}get modifiedWorkingCopies(){return this.workingCopies.filter(e=>e.isModified())}isDirty(e,t){let n=this.mapResourceToWorkingCopies.get(e);if(n){if(typeof t=="string")return n.get(t)?.isDirty()??!1;for(let[,i]of n)if(i.isDirty())return!0}return!1}};ji(Ma,yk,1);var du=Q("labelService");var Li=Q("telemetryService"),Owe=Q("customEndpointTelemetryService");var pW="\u2026",nb="\\\\",ib="~";function hW(o,e=si){let t=new Array(o.length),n=!1;for(let i=0;i<o.length;i++){let r=o[i];if(r===""){t[i]=`.${e}`;continue}if(!r){t[i]=r;continue}n=!0;let s="",a=r;a.indexOf(nb)===0?(s=a.substr(0,a.indexOf(nb)+nb.length),a=a.substr(a.indexOf(nb)+nb.length)):a.indexOf(e)===0?(s=a.substr(0,a.indexOf(e)+e.length),a=a.substr(a.indexOf(e)+e.length)):a.indexOf(ib)===0&&(s=a.substr(0,a.indexOf(ib)+ib.length),a=a.substr(a.indexOf(ib)+ib.length));let l=a.split(e);for(let d=1;n&&d<=l.length;d++)for(let c=l.length-d;n&&c>=0;c--){n=!1;let u=l.slice(c,c+d).join(e);for(let p=0;!n&&p<o.length;p++)if(p!==i&&o[p]&&o[p].indexOf(u)>-1){let h=c+d===l.length,f=c>0&&o[p].indexOf(e)>-1?e+u:u,g=o[p].endsWith(f);n=!h||g}if(!n){let p="";(l[0].endsWith(":")||s!=="")&&(c===1&&(c=0,d++,u=l[0]+e+u),c>0&&(p=l[0]+e),p=s+p),c>0&&(p=p+pW+e),p=p+u,c+d<l.length&&(p=p+e+pW),t[i]=p}}n&&(t[i]=r)}return t}var mW=Q("productService");var Dl=Q("dialogService");var fxe=Q("fileDialogService");var kl=class extends ob{_onDidChangeDirty=this._register(new k);_onDidChangeLabel=this._register(new k);_onDidChangeCapabilities=this._register(new k);_onWillDispose=this._register(new k);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(hi(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:Qi(this.resource,Nr.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var mi=class extends kl{constructor(t,n,i,r,s){super();this.preferredName=t;this.preferredDescription=n;this.secondary=i;this.primary=r;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return mi.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(j.once(j.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let t=this.getPreferredName();return t||(this.hasIdenticalSides?this.primary.getName():m("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(t){let n=this.getPreferredDescription();return n||(this.hasIdenticalSides?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.preferredDescription}getTitle(t){let n;this.hasIdenticalSides?n=this.primary.getTitle(t)??this.getName():n=super.getTitle(t);let i=this.getPreferredTitle();return i&&(n=`${i} (${n})`),n}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,n){let i=await this.primary.save(t,n);return this.saveResultToEditor(i)}async saveAs(t,n){let i=await this.primary.saveAs(t,n);return this.saveResultToEditor(i)}saveResultToEditor(t){if(!t||!this.hasIdenticalSides)return t;if(this.primary.matches(t))return this;if(t instanceof kl)return new mi(this.preferredName,this.preferredDescription,t,t,this.editorService);if(!Fs(t)&&!kh(t)&&!Ud(t)&&!zd(t))return{primary:t,secondary:t,label:this.preferredName,description:this.preferredDescription}}revert(t,n){return this.primary.revert(t,n)}async rename(t,n){if(!this.hasIdenticalSides)return;let i=await this.primary.rename(t,n);if(i){if(hi(i.editor))return{editor:new mi(this.preferredName,this.preferredDescription,i.editor,i.editor,this.editorService),options:{...i.options,viewState:XC(this,t,this.editorService)}};if(gW(i.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:i.editor,secondary:i.editor,options:{...i.options,viewState:XC(this,t,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){let n=this.primary.toUntyped(t),i=this.secondary.toUntyped(t);if(n&&i&&!Fs(n)&&!Fs(i)&&!kh(n)&&!kh(i)&&!Ud(n)&&!Ud(i)&&!zd(n)&&!zd(i)){let r={label:this.preferredName,description:this.preferredDescription,primary:n,secondary:i};return typeof t?.preserveViewState=="number"&&(r.options={viewState:XC(this,t.preserveViewState,this.editorService)}),r}}matches(t){return this===t?!0:Ck(t)||Fs(t)?!1:t instanceof mi?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):Ud(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};mi=P([_(4,Vt)],mi);var Sk={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function $9(o){let e=o;return!!(e&&typeof e=="object"&&Array.isArray(e.editors)&&Array.isArray(e.mru))}var Oa=class extends F{constructor(t,n,i){super();this.instantiationService=n;this.configurationService=i;$9(t)?this._id=this.deserialize(t):this._id=Oa.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new k({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t&&!t.affectsConfiguration("workbench.editor.openPositioning")&&!t.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(t,n){let i=t===0?this.mru.slice(0):this.editors.slice(0);return n?.excludeSticky?t===0?i.filter(r=>!this.isSticky(r)):i.slice(this.sticky+1):i}getEditorByIndex(t){return this.editors[t]}get activeEditor(){return this.active}isActive(t){return this.matches(this.active,t)}get previewEditor(){return this.preview}openEditor(t,n){let i=n?.sticky||typeof n?.index=="number"&&this.isSticky(n.index),r=n?.pinned||n?.sticky,s=!!n?.transient,a=n?.active||!this.activeEditor||!r&&this.preview===this.activeEditor,l=this.findEditor(t,n);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),r&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),n&&typeof n.index=="number"&&this.moveEditor(d,n.index),i&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=t,c=this.indexOf(this.active),u;if(n&&typeof n.index=="number"?u=n.index:this.editorOpenPositioning===Sk.FIRST?(u=0,!i&&this.isSticky(u)&&(u=this.sticky+1)):this.editorOpenPositioning===Sk.LAST?u=this.editors.length:(this.editorOpenPositioning===Sk.LEFT?c===0||!this.editors.length?u=0:u=c:u=c+1,!i&&this.isSticky(u)&&(u=this.sticky+1)),i&&(this.sticky++,this.isSticky(u)||(u=this.sticky)),(r||!this.preview)&&this.splice(u,!1,d),s&&this.doSetTransient(d,u,!0),!r){if(this.preview){let h=this.indexOf(this.preview);u>h&&u--,this.replaceEditor(this.preview,d,u,!a)}this.preview=d}this.registerEditorListeners(d);let p={kind:5,editor:d,editorIndex:u};return this._onDidModelChange.fire(p),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(t){let n=new ne;this.editorListeners.add(n),n.add(j.once(t.onWillDispose)(()=>{let i=this.editors.indexOf(t);if(i>=0){let r={kind:15,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}})),n.add(t.onDidChangeDirty(()=>{let i={kind:14,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeLabel(()=>{let i={kind:9,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeCapabilities(()=>{let i={kind:10,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(this.onDidModelChange(i=>{i.kind===6&&i.editor?.matches(t)&&(Tt(n),this.editorListeners.delete(n))}))}replaceEditor(t,n,i,r=!0){let s=this.doCloseEditor(t,1,r);if(this.splice(i,!1,n),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(t,n=0,i=!0){let r=this.doCloseEditor(t,n,i);if(r){let s={kind:6,...r};return this._onDidModelChange.fire(s),r}}doCloseEditor(t,n,i){let r=this.indexOf(t);if(r===-1)return;let s=this.editors[r],a=this.isSticky(r),l=this.active===s;if(i&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:r===this.editors.length-1?d=this.editors[r-1]:d=this.editors[r+1];let c=this.selection.filter(u=>u!==s&&u!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(r,!0),{editor:s,sticky:a,editorIndex:r,context:n}}moveEditor(t,n){n>=this.editors.length?n=this.editors.length-1:n<0&&(n=0);let i=this.indexOf(t);if(i<0||n===i)return;let r=this.editors[i],s=this.sticky;this.isSticky(i)&&n>this.sticky?this.sticky--:!this.isSticky(i)&&n<=this.sticky&&this.sticky++,this.editors.splice(i,1),this.editors.splice(n,0,r);let a={kind:7,editor:r,oldEditorIndex:i,editorIndex:n};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:r,editorIndex:n};this._onDidModelChange.fire(l)}return r}setActive(t){let n;return t?n=this.setEditorActive(t):this.setGroupActive(),n}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doSetSelection(i,r,[]),i}get selectedEditors(){return this.editors.filter(t=>this.doIsSelected(t))}isSelected(t){let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.doIsSelected(n)}doIsSelected(t){return this.selection.includes(t)}setSelection(t,n){let i=this.findEditor(t);if(!i)return;let[r,s]=i,a=new Set;for(let l of n){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==r&&a.add(c)}this.doSetSelection(r,s,Array.from(a))}doSetSelection(t,n,i){let r=this.activeEditor,s=this.selection,a;t?a=[t,...i]:a=[],this.selection=a;let l=t&&typeof n=="number"&&r!==t;if(l){let d=this.indexOf(t,this.mru);this.mru.splice(d,1),this.mru.unshift(t);let c={kind:8,editor:t,editorIndex:n};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(t){this._onDidModelChange.fire({kind:1})}setLabel(t){this._onDidModelChange.fire({kind:2})}pin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doPin(i,r),i}doPin(t,n){if(this.isPinned(t))return;this.setTransient(t,!1),this.preview=null;let i={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(i)}unpin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnpin(i,r),i}doUnpin(t,n){if(!this.isPinned(t))return;let i=this.preview;this.preview=t;let r={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(r),i&&this.closeEditor(i,3)}isPinned(t){let n;return typeof t=="number"?n=this.editors[t]:n=t,!this.matches(this.preview,n)}stick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doStick(i,r),i}doStick(t,n){if(this.isSticky(n))return;this.pin(t);let i=this.sticky+1;this.moveEditor(t,i),this.sticky++;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}unstick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnstick(i,r),i}doUnstick(t,n){if(!this.isSticky(n))return;let i=this.sticky;this.moveEditor(t,i),this.sticky--;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}isSticky(t){if(this.sticky<0)return!1;let n;return typeof t=="number"?n=t:n=this.indexOf(t),n<0?!1:n<=this.sticky}setTransient(t,n){if(!n&&this.transient.size===0)return;let i=this.findEditor(t);if(!i)return;let[r,s]=i;return this.doSetTransient(r,s,n),r}doSetTransient(t,n,i){if(i){if(this.transient.has(t))return;this.transient.add(t)}else{if(!this.transient.has(t))return;this.transient.delete(t)}let r={kind:12,editor:t,editorIndex:n};this._onDidModelChange.fire(r)}isTransient(t){if(this.transient.size===0)return!1;let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.transient.has(n)}splice(t,n,i){let r=this.editors[t];if(n&&this.isSticky(t)&&this.sticky--,i?this.editors.splice(t,n?1:0,i):this.editors.splice(t,n?1:0),!n&&i)this.mru.length===0?this.mru.push(i):this.mru.splice(1,0,i);else{let s=this.indexOf(r,this.mru);n&&!i?this.mru.splice(s,1):n&&i&&this.mru.splice(s,1,i)}}indexOf(t,n=this.editors,i){let r=-1;if(!t)return r;for(let s=0;s<n.length;s++){let a=n[s];if(this.matches(a,t,i))if(i?.supportSideBySide&&a instanceof mi&&!(t instanceof mi))r=s;else{r=s;break}}return r}findEditor(t,n){let i=this.indexOf(t,this.editors,n);if(i!==-1)return[this.editors[i],i]}isFirst(t,n=this.editors){return this.matches(n[0],t)}isLast(t,n=this.editors){return this.matches(n[n.length-1],t)}contains(t,n){return this.indexOf(t,this.editors,n)!==-1}matches(t,n,i){if(!t||!n)return!1;if(i?.supportSideBySide&&t instanceof mi&&!(n instanceof mi))switch(i.supportSideBySide){case 4:if(this.matches(t.primary,n,i)||this.matches(t.secondary,n,i))return!0;break;case 3:if(this.matches(t.primary,n,i)&&this.matches(t.secondary,n,i))return!0;break}let r=t===n;return i?.strictEquals?r:r||t.matches(n)}get isLocked(){return this.locked}lock(t){this.isLocked!==t&&(this.locked=t,this._onDidModelChange.fire({kind:3}))}clone(){let t=this.instantiationService.createInstance(Oa,void 0);t.editors=this.editors.slice(0),t.mru=this.mru.slice(0),t.preview=this.preview,t.selection=this.selection.slice(0),t.sticky=this.sticky;for(let n of t.editors)t.registerEditorListeners(n);return t}serialize(){let t=lt.as(Bs.EditorFactory),n=[],i=[],r,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,u=t.getEditorSerializer(d);if(u){let p=u.canSerialize(d)?u.serialize(d):void 0;typeof p=="string"?(c=!0,i.push({id:d.typeId,value:p}),n.push(d),this.preview===d&&(r=n.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,n)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:i,mru:a,preview:r,sticky:s>=0?s:void 0}}deserialize(t){let n=lt.as(Bs.EditorFactory);return typeof t.id=="number"?(this._id=t.id,Oa.IDS=Math.max(t.id+1,Oa.IDS)):this._id=Oa.IDS++,t.locked&&(this.locked=!0),this.editors=Ro(t.editors.map((i,r)=>{let s,a=n.getEditorSerializer(i.id);if(a){let l=a.deserialize(this.instantiationService,i.value);l instanceof kl&&(s=l,this.registerEditorListeners(s))}return!s&&typeof t.sticky=="number"&&r<=t.sticky&&t.sticky--,s})),this.mru=Ro(t.mru.map(i=>this.editors[i])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof t.preview=="number"&&(this.preview=this.editors[t.preview]),typeof t.sticky=="number"&&(this.sticky=t.sticky),this._id}dispose(){Tt(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};Oa=P([_(1,Qe),_(2,ut)],Oa);var rb={exports:{}};(function(){function e(r){let s=[];typeof r=="number"&&s.push("code/timeOrigin",r);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(r){performance.mark(r)},getMarks(){let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(r+a.startTime)});return s}};if(typeof process=="object"){let r=performance?.timeOrigin;return e(r)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function n(r){return r.MonacoPerformanceMarks||(r.MonacoPerformanceMarks=t()),r.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof rb=="object"&&typeof rb.exports=="object"?rb.exports=n(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=n(i))})();var Zn=rb.exports.mark,L_e=rb.exports.getMarks;function is(o){return wk(o,0)}function wk(o,e){switch(typeof o){case"object":return o===null?Rl(349,e):Array.isArray(o)?X9(o,e):J9(o,e);case"string":return JC(o,e);case"boolean":return Q9(o,e);case"number":return Rl(o,e);case"undefined":return Rl(937,e);default:return Rl(617,e)}}function Rl(o,e){return(e<<5)-e+o|0}function Q9(o,e){return Rl(o?433:863,e)}function JC(o,e){e=Rl(149417,e);for(let t=0,n=o.length;t<n;t++)e=Rl(o.charCodeAt(t),e);return e}function X9(o,e){return e=Rl(104579,e),o.reduce((t,n)=>wk(n,t),e)}function J9(o,e){return e=Rl(181387,e),Object.keys(o).sort().reduce((t,n)=>(t=JC(n,t),wk(o[n],t)),e)}function Tk(o,e,t=32){let n=t-e,i=~((1<<n)-1);return(o<<e|(i&o)>>>n)>>>0}function fW(o,e=0,t=o.byteLength,n=0){for(let i=0;i<t;i++)o[e+i]=n}function e8(o,e,t="0"){for(;o.length<e;)o=t+o;return o}function sb(o,e=32){return o instanceof ArrayBuffer?Array.from(new Uint8Array(o)).map(t=>t.toString(16).padStart(2,"0")).join(""):e8((o>>>0).toString(16),e/4)}var bW=class o{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let n=this._buff,i=this._buffLen,r=this._leftoverHighSurrogate,s,a;for(r!==0?(s=r,a=-1,r=0):(s=e.charCodeAt(0),a=0);;){let l=s;if(rn(s))if(a+1<t){let d=e.charCodeAt(a+1);bd(d)?(a++,l=xy(s,d)):l=65533}else{r=s;break}else bd(s)&&(l=65533);if(i=this._push(n,i,l),a++,a<t)s=e.charCodeAt(a);else break}this._buffLen=i,this._leftoverHighSurrogate=r}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(n&1984)>>>6,e[t++]=128|(n&63)>>>0):n<65536?(e[t++]=224|(n&61440)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0):(e[t++]=240|(n&1835008)>>>18,e[t++]=128|(n&258048)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),sb(this._h0)+sb(this._h1)+sb(this._h2)+sb(this._h3)+sb(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,fW(this._buff,this._buffLen),this._buffLen>56&&(this._step(),fW(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=o._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,Tk(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let n=this._h0,i=this._h1,r=this._h2,s=this._h3,a=this._h4,l,d,c;for(let u=0;u<80;u++)u<20?(l=i&r|~i&s,d=1518500249):u<40?(l=i^r^s,d=1859775393):u<60?(l=i&r|i&s|r&s,d=2400959708):(l=i^r^s,d=3395469782),c=Tk(n,5)+l+a+d+e.getUint32(u*4,!1)&4294967295,a=s,s=r,r=Tk(i,30),i=n,n=c;this._h0=this._h0+n&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};var gi=Q("logService"),X_e=Q("loggerService");function eS(o){switch(o){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var J_e=new $("logLevel",eS(3));var cu=Q("IUriIdentityService");function vW(o){let e=o;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&te.isUri(e.location)&&te.isUri(e.globalStorageHome)&&te.isUri(e.settingsResource)&&te.isUri(e.keybindingsResource)&&te.isUri(e.tasksResource)&&te.isUri(e.snippetsHome)&&te.isUri(e.extensionsResource))}var yW=Q("IUserDataProfilesService");function tS(o,e,t,n,i,r){return{id:o,name:e,location:t,isDefault:!1,shortName:i?.shortName,icon:i?.icon,globalStorageHome:r&&i?.useDefaultFlags?.globalState?r.globalStorageHome:It(t,"globalStorage"),settingsResource:r&&i?.useDefaultFlags?.settings?r.settingsResource:It(t,"settings.json"),keybindingsResource:r&&i?.useDefaultFlags?.keybindings?r.keybindingsResource:It(t,"keybindings.json"),tasksResource:r&&i?.useDefaultFlags?.tasks?r.tasksResource:It(t,"tasks.json"),snippetsHome:r&&i?.useDefaultFlags?.snippets?r.snippetsHome:It(t,"snippets"),extensionsResource:r&&i?.useDefaultFlags?.extensions?r.extensionsResource:It(t,"extensions.json"),cacheHome:It(n,o),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient}}var nS=class extends F{constructor(t,n,i,r){super();this.environmentService=t;this.fileService=n;this.uriIdentityService=i;this.logService=r;this.profilesHome=It(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=It(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new k);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new k);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new k);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new k);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new go,workspaces:new go,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(t){this.enabled!==t&&(this._profilesObject=void 0,this.enabled=t)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let t=this.createDefaultProfile(),n=[t];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!En(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}n.push(tS(Jo(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.logService.error(s)}let i=new go,r=new Map;if(n.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=te.parse(a),c=n.find(u=>u.id===l);c&&i.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=n.find(c=>c.id===l);d&&r.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:n,workspaces:i,emptyWindows:r}}return this._profilesObject}createDefaultProfile(){let t=tS("__default__profile__",m("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){let n="Temp",i=new RegExp(`${fo(n)}\\s(\\d+)`),r=0;for(let a of this.profiles){let l=i.exec(a.name),d=l?parseInt(l[1]):0;r=d>r?d:r}let s=`${n} ${r+1}`;return this.createProfile(is(Jc()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,n,i){return this.createProfile(is(Jc()).toString(16),t,n,i)}async createProfile(t,n,i,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(t,n,i);return r&&await this.setProfileForWorkspace(r,s),s}async doCreateProfile(t,n,i){if(!En(n)||!n)throw new Error("Name of the profile is mandatory and must be of type `string`");let r=this.profileCreationPromises.get(n);return r||(r=(async()=>{try{if(this.profiles.find(d=>d.name===n||d.id===t))throw new Error(`Profile with ${n} name already exists`);let a=tS(t,n,It(this.profilesHome,t),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await Ao.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(n)}})(),this.profileCreationPromises.set(n,r)),r}async updateProfile(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);return i=tS(i.id,n.name??i.name,i.location,this.profilesCacheHome,{shortName:n.shortName??i.shortName,icon:n.icon===null?void 0:n.icon??i.icon,transient:n.transient??i.isTransient,useDefaultFlags:n.useDefaultFlags??i.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[i]),i}async removeProfile(t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(t.isDefault)throw new Error("Cannot remove default profile");let n=this.profiles.find(r=>r.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);let i=[];this._onWillRemoveProfile.fire({profile:n,join(r){i.push(r)}});try{await Promise.allSettled(i)}catch(r){this.logService.error(r)}for(let r of[...this.profilesObject.emptyWindows.keys()])n.id===this.profilesObject.emptyWindows.get(r)?.id&&this.profilesObject.emptyWindows.delete(r);for(let r of[...this.profilesObject.workspaces.keys()])n.id===this.profilesObject.workspaces.get(r)?.id&&this.profilesObject.workspaces.delete(r);this.updateStoredProfileAssociations(),this.updateProfiles([],[n],[]);try{await this.fileService.del(n.cacheHome,{recursive:!0})}catch(r){fF(r)!==1&&this.logService.error(r)}}async setProfileForWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===n.id);if(!i)throw new Error(`Profile '${n.name}' does not exist`);this.updateWorkspaceAssociation(t,i)}unsetWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(t,void 0,n)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(n=>n.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,n.resource))).map(n=>this.fileService.del(n.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let t=this.transientProfilesObject.profiles.filter(n=>!this.isProfileAssociatedToWorkspace(n));await Promise.allSettled(t.map(n=>this.removeProfile(n)))}getProfileForWorkspace(t){let n=this.getWorkspace(t),i=te.isUri(n)?this.profilesObject.workspaces.get(n):this.profilesObject.emptyWindows.get(n);return i||($y(t)?this.transientProfilesObject.folders.get(t.uri):Yy(t)?this.transientProfilesObject.workspaces.get(t.configPath):this.transientProfilesObject.emptyWindows.get(t.id))}getWorkspace(t){return $y(t)?t.uri:Yy(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!([...this.profilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.profilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.folders.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location)))}updateProfiles(t,n,i){let r=[...this.profiles,...t],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of r){if(l.isDefault||n.some(c=>l.id===c.id))continue;l=i.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,u]of this.transientProfilesObject.emptyWindows.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,u]of this.transientProfilesObject.workspaces.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,u]of this.transientProfilesObject.folders.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(t,n,i)}triggerProfilesChanges(t,n,i){this._onDidChangeProfiles.fire({added:t,removed:n,updated:i,all:this.profiles})}updateWorkspaceAssociation(t,n,i){if(i=n?.isTransient?!0:i,i)$y(t)?(this.transientProfilesObject.folders.delete(t.uri),n&&this.transientProfilesObject.folders.set(t.uri,n)):Yy(t)?(this.transientProfilesObject.workspaces.delete(t.configPath),n&&this.transientProfilesObject.workspaces.set(t.configPath,n)):(this.transientProfilesObject.emptyWindows.delete(t.id),n&&this.transientProfilesObject.emptyWindows.set(t.id,n));else{this.updateWorkspaceAssociation(t,void 0,!0);let r=this.getWorkspace(t);te.isUri(r)?(this.profilesObject.workspaces.delete(r),n&&this.profilesObject.workspaces.set(r,n)):(this.profilesObject.emptyWindows.delete(r),n&&this.profilesObject.emptyWindows.set(r,n)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let t={};for(let[i,r]of this.profilesObject.workspaces.entries())t[i.toString()]=r.id;let n={};for(let[i,r]of this.profilesObject.emptyWindows.entries())n[i.toString()]=r.id;this.saveStoredProfileAssociations({workspaces:t,emptyWindows:n}),this._profilesObject=void 0}migrateStoredProfileAssociations(t){let n={},i=this.createDefaultProfile();if(t.workspaces)for(let[s,a]of Object.entries(t.workspaces)){let l=te.parse(a);n[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}let r={};if(t.emptyWindows)for(let[s,a]of Object.entries(t.emptyWindows)){let l=te.parse(a);r[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:n,emptyWindows:r}}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};nS=P([_(0,kr),_(1,Mn),_(2,cu),_(3,gi)],nS);var _k={WIDTH:400,WIDTH_WITH_VERTICAL_PANEL:600,HEIGHT:270};var ab=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},iS=new ab,Lk=new ab,Dk=new ab,Rk=new Array(230),t8={},n8=[],i8=Object.create(null),o8=Object.create(null);var IW=[],kk=[];for(let o=0;o<=193;o++)IW[o]=-1;for(let o=0;o<=132;o++)kk[o]=-1;(function(){let o="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",o,o],[1,1,"Hyper",0,o,0,o,o,o],[1,2,"Super",0,o,0,o,o,o],[1,3,"Fn",0,o,0,o,o,o],[1,4,"FnLock",0,o,0,o,o,o],[1,5,"Suspend",0,o,0,o,o,o],[1,6,"Resume",0,o,0,o,o,o],[1,7,"Turbo",0,o,0,o,o,o],[1,8,"Sleep",0,o,0,"VK_SLEEP",o,o],[1,9,"WakeUp",0,o,0,o,o,o],[0,10,"KeyA",31,"A",65,"VK_A",o,o],[0,11,"KeyB",32,"B",66,"VK_B",o,o],[0,12,"KeyC",33,"C",67,"VK_C",o,o],[0,13,"KeyD",34,"D",68,"VK_D",o,o],[0,14,"KeyE",35,"E",69,"VK_E",o,o],[0,15,"KeyF",36,"F",70,"VK_F",o,o],[0,16,"KeyG",37,"G",71,"VK_G",o,o],[0,17,"KeyH",38,"H",72,"VK_H",o,o],[0,18,"KeyI",39,"I",73,"VK_I",o,o],[0,19,"KeyJ",40,"J",74,"VK_J",o,o],[0,20,"KeyK",41,"K",75,"VK_K",o,o],[0,21,"KeyL",42,"L",76,"VK_L",o,o],[0,22,"KeyM",43,"M",77,"VK_M",o,o],[0,23,"KeyN",44,"N",78,"VK_N",o,o],[0,24,"KeyO",45,"O",79,"VK_O",o,o],[0,25,"KeyP",46,"P",80,"VK_P",o,o],[0,26,"KeyQ",47,"Q",81,"VK_Q",o,o],[0,27,"KeyR",48,"R",82,"VK_R",o,o],[0,28,"KeyS",49,"S",83,"VK_S",o,o],[0,29,"KeyT",50,"T",84,"VK_T",o,o],[0,30,"KeyU",51,"U",85,"VK_U",o,o],[0,31,"KeyV",52,"V",86,"VK_V",o,o],[0,32,"KeyW",53,"W",87,"VK_W",o,o],[0,33,"KeyX",54,"X",88,"VK_X",o,o],[0,34,"KeyY",55,"Y",89,"VK_Y",o,o],[0,35,"KeyZ",56,"Z",90,"VK_Z",o,o],[0,36,"Digit1",22,"1",49,"VK_1",o,o],[0,37,"Digit2",23,"2",50,"VK_2",o,o],[0,38,"Digit3",24,"3",51,"VK_3",o,o],[0,39,"Digit4",25,"4",52,"VK_4",o,o],[0,40,"Digit5",26,"5",53,"VK_5",o,o],[0,41,"Digit6",27,"6",54,"VK_6",o,o],[0,42,"Digit7",28,"7",55,"VK_7",o,o],[0,43,"Digit8",29,"8",56,"VK_8",o,o],[0,44,"Digit9",30,"9",57,"VK_9",o,o],[0,45,"Digit0",21,"0",48,"VK_0",o,o],[1,46,"Enter",3,"Enter",13,"VK_RETURN",o,o],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",o,o],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",o,o],[1,49,"Tab",2,"Tab",9,"VK_TAB",o,o],[1,50,"Space",10,"Space",32,"VK_SPACE",o,o],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,o,0,o,o,o],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",o,o],[1,64,"F1",59,"F1",112,"VK_F1",o,o],[1,65,"F2",60,"F2",113,"VK_F2",o,o],[1,66,"F3",61,"F3",114,"VK_F3",o,o],[1,67,"F4",62,"F4",115,"VK_F4",o,o],[1,68,"F5",63,"F5",116,"VK_F5",o,o],[1,69,"F6",64,"F6",117,"VK_F6",o,o],[1,70,"F7",65,"F7",118,"VK_F7",o,o],[1,71,"F8",66,"F8",119,"VK_F8",o,o],[1,72,"F9",67,"F9",120,"VK_F9",o,o],[1,73,"F10",68,"F10",121,"VK_F10",o,o],[1,74,"F11",69,"F11",122,"VK_F11",o,o],[1,75,"F12",70,"F12",123,"VK_F12",o,o],[1,76,"PrintScreen",0,o,0,o,o,o],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",o,o],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",o,o],[1,79,"Insert",19,"Insert",45,"VK_INSERT",o,o],[1,80,"Home",14,"Home",36,"VK_HOME",o,o],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",o,o],[1,82,"Delete",20,"Delete",46,"VK_DELETE",o,o],[1,83,"End",13,"End",35,"VK_END",o,o],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",o,o],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",o],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",o],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",o],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",o],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",o,o],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",o,o],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",o,o],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",o,o],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",o,o],[1,94,"NumpadEnter",3,o,0,o,o,o],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",o,o],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",o,o],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",o,o],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",o,o],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",o,o],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",o,o],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",o,o],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",o,o],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",o,o],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",o,o],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",o,o],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",o,o],[1,107,"ContextMenu",58,"ContextMenu",93,o,o,o],[1,108,"Power",0,o,0,o,o,o],[1,109,"NumpadEqual",0,o,0,o,o,o],[1,110,"F13",71,"F13",124,"VK_F13",o,o],[1,111,"F14",72,"F14",125,"VK_F14",o,o],[1,112,"F15",73,"F15",126,"VK_F15",o,o],[1,113,"F16",74,"F16",127,"VK_F16",o,o],[1,114,"F17",75,"F17",128,"VK_F17",o,o],[1,115,"F18",76,"F18",129,"VK_F18",o,o],[1,116,"F19",77,"F19",130,"VK_F19",o,o],[1,117,"F20",78,"F20",131,"VK_F20",o,o],[1,118,"F21",79,"F21",132,"VK_F21",o,o],[1,119,"F22",80,"F22",133,"VK_F22",o,o],[1,120,"F23",81,"F23",134,"VK_F23",o,o],[1,121,"F24",82,"F24",135,"VK_F24",o,o],[1,122,"Open",0,o,0,o,o,o],[1,123,"Help",0,o,0,o,o,o],[1,124,"Select",0,o,0,o,o,o],[1,125,"Again",0,o,0,o,o,o],[1,126,"Undo",0,o,0,o,o,o],[1,127,"Cut",0,o,0,o,o,o],[1,128,"Copy",0,o,0,o,o,o],[1,129,"Paste",0,o,0,o,o,o],[1,130,"Find",0,o,0,o,o,o],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",o,o],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",o,o],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",o,o],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",o,o],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",o,o],[1,136,"KanaMode",0,o,0,o,o,o],[0,137,"IntlYen",0,o,0,o,o,o],[1,138,"Convert",0,o,0,o,o,o],[1,139,"NonConvert",0,o,0,o,o,o],[1,140,"Lang1",0,o,0,o,o,o],[1,141,"Lang2",0,o,0,o,o,o],[1,142,"Lang3",0,o,0,o,o,o],[1,143,"Lang4",0,o,0,o,o,o],[1,144,"Lang5",0,o,0,o,o,o],[1,145,"Abort",0,o,0,o,o,o],[1,146,"Props",0,o,0,o,o,o],[1,147,"NumpadParenLeft",0,o,0,o,o,o],[1,148,"NumpadParenRight",0,o,0,o,o,o],[1,149,"NumpadBackspace",0,o,0,o,o,o],[1,150,"NumpadMemoryStore",0,o,0,o,o,o],[1,151,"NumpadMemoryRecall",0,o,0,o,o,o],[1,152,"NumpadMemoryClear",0,o,0,o,o,o],[1,153,"NumpadMemoryAdd",0,o,0,o,o,o],[1,154,"NumpadMemorySubtract",0,o,0,o,o,o],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",o,o],[1,156,"NumpadClearEntry",0,o,0,o,o,o],[1,0,o,5,"Ctrl",17,"VK_CONTROL",o,o],[1,0,o,4,"Shift",16,"VK_SHIFT",o,o],[1,0,o,6,"Alt",18,"VK_MENU",o,o],[1,0,o,57,"Meta",91,"VK_COMMAND",o,o],[1,157,"ControlLeft",5,o,0,"VK_LCONTROL",o,o],[1,158,"ShiftLeft",4,o,0,"VK_LSHIFT",o,o],[1,159,"AltLeft",6,o,0,"VK_LMENU",o,o],[1,160,"MetaLeft",57,o,0,"VK_LWIN",o,o],[1,161,"ControlRight",5,o,0,"VK_RCONTROL",o,o],[1,162,"ShiftRight",4,o,0,"VK_RSHIFT",o,o],[1,163,"AltRight",6,o,0,"VK_RMENU",o,o],[1,164,"MetaRight",57,o,0,"VK_RWIN",o,o],[1,165,"BrightnessUp",0,o,0,o,o,o],[1,166,"BrightnessDown",0,o,0,o,o,o],[1,167,"MediaPlay",0,o,0,o,o,o],[1,168,"MediaRecord",0,o,0,o,o,o],[1,169,"MediaFastForward",0,o,0,o,o,o],[1,170,"MediaRewind",0,o,0,o,o,o],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",o,o],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",o,o],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",o,o],[1,174,"Eject",0,o,0,o,o,o],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",o,o],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",o,o],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",o,o],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",o,o],[1,179,"LaunchApp1",0,o,0,"VK_MEDIA_LAUNCH_APP1",o,o],[1,180,"SelectTask",0,o,0,o,o,o],[1,181,"LaunchScreenSaver",0,o,0,o,o,o],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",o,o],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",o,o],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",o,o],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",o,o],[1,186,"BrowserStop",0,o,0,"VK_BROWSER_STOP",o,o],[1,187,"BrowserRefresh",0,o,0,"VK_BROWSER_REFRESH",o,o],[1,188,"BrowserFavorites",0,o,0,"VK_BROWSER_FAVORITES",o,o],[1,189,"ZoomToggle",0,o,0,o,o,o],[1,190,"MailReply",0,o,0,o,o,o],[1,191,"MailForward",0,o,0,o,o,o],[1,192,"MailSend",0,o,0,o,o,o],[1,0,o,114,"KeyInComposition",229,o,o,o],[1,0,o,116,"ABNT_C2",194,"VK_ABNT_C2",o,o],[1,0,o,96,"OEM_8",223,"VK_OEM_8",o,o],[1,0,o,0,o,0,"VK_KANA",o,o],[1,0,o,0,o,0,"VK_HANGUL",o,o],[1,0,o,0,o,0,"VK_JUNJA",o,o],[1,0,o,0,o,0,"VK_FINAL",o,o],[1,0,o,0,o,0,"VK_HANJA",o,o],[1,0,o,0,o,0,"VK_KANJI",o,o],[1,0,o,0,o,0,"VK_CONVERT",o,o],[1,0,o,0,o,0,"VK_NONCONVERT",o,o],[1,0,o,0,o,0,"VK_ACCEPT",o,o],[1,0,o,0,o,0,"VK_MODECHANGE",o,o],[1,0,o,0,o,0,"VK_SELECT",o,o],[1,0,o,0,o,0,"VK_PRINT",o,o],[1,0,o,0,o,0,"VK_EXECUTE",o,o],[1,0,o,0,o,0,"VK_SNAPSHOT",o,o],[1,0,o,0,o,0,"VK_HELP",o,o],[1,0,o,0,o,0,"VK_APPS",o,o],[1,0,o,0,o,0,"VK_PROCESSKEY",o,o],[1,0,o,0,o,0,"VK_PACKET",o,o],[1,0,o,0,o,0,"VK_DBE_SBCSCHAR",o,o],[1,0,o,0,o,0,"VK_DBE_DBCSCHAR",o,o],[1,0,o,0,o,0,"VK_ATTN",o,o],[1,0,o,0,o,0,"VK_CRSEL",o,o],[1,0,o,0,o,0,"VK_EXSEL",o,o],[1,0,o,0,o,0,"VK_EREOF",o,o],[1,0,o,0,o,0,"VK_PLAY",o,o],[1,0,o,0,o,0,"VK_ZOOM",o,o],[1,0,o,0,o,0,"VK_NONAME",o,o],[1,0,o,0,o,0,"VK_PA1",o,o],[1,0,o,0,o,0,"VK_OEM_CLEAR",o,o]],t=[],n=[];for(let i of e){let[r,s,a,l,d,c,u,p,h]=i;if(n[s]||(n[s]=!0,n8[s]=a,i8[a]=s,o8[a.toLowerCase()]=s,r&&(IW[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(kk[l]=s))),!t[l]){if(t[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);iS.define(l,d),Lk.define(l,p||d),Dk.define(l,h||p||d)}c&&(Rk[c]=l),u&&(t8[u]=l)}kk[3]=46})();var lb;(s=>{function o(a){return iS.keyCodeToStr(a)}s.toString=o;function e(a){return iS.strToKeyCode(a)}s.fromString=e;function t(a){return Lk.keyCodeToStr(a)}s.toUserSettingsUS=t;function n(a){return Dk.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function i(a){return Lk.strToKeyCode(a)||Dk.strToKeyCode(a)}s.fromUserSettings=i;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return iS.keyCodeToStr(a)}s.toElectronAccelerator=r})(lb||={});function Mk(o,e){if(typeof o=="number"){if(o===0)return null;let t=(o&65535)>>>0,n=(o&4294901760)>>>16;return n!==0?new Mh([oS(t,e),oS(n,e)]):new Mh([oS(t,e)])}else{let t=[];for(let n=0;n<o.length;n++)t.push(oS(o[n],e));return new Mh(t)}}function oS(o,e){let t=!!(o&2048),n=!!(o&256),i=e===2?n:t,r=!!(o&1024),s=!!(o&512),a=e===2?t:n,l=o&255;return new db(i,r,s,a,l)}var db=class o{constructor(e,t,n,i,r){this.ctrlKey=e;this.shiftKey=t;this.altKey=n;this.metaKey=i;this.keyCode=r}equals(e){return e instanceof o&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",t=this.shiftKey?"1":"0",n=this.altKey?"1":"0",i=this.metaKey?"1":"0";return`K${e}${t}${n}${i}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new Mh([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var Mh=class{chords;constructor(e){if(e.length===0)throw _c("chords");this.chords=e}getHashCode(){let e="";for(let t=0,n=this.chords.length;t<n;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};var Ok=class o{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new Vi,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if($r===1){if(e&&e.win)return e.win}else if($r===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){let t=o.bindToCurrentPlatform(e),n=new ne;if(t&&t.primary){let i=Mk(t.primary,$r);i&&n.add(this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let i=0,r=t.secondary.length;i<r;i++){let s=t.secondary[i],a=Mk(s,$r);a&&n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-i-1,e.when))}return n}setExtensionKeybindings(e){let t=[],n=0;for(let i of e)i.keybinding&&(t[n++]={keybinding:i.keybinding,command:i.id,commandArgs:i.args,when:i.when,weight1:i.weight,weight2:0,extensionId:i.extensionId||null,isBuiltinExtension:i.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return Mo(this.registerKeybindingRule(e),ir.registerCommand(e))}_registerDefaultKeybinding(e,t,n,i,r,s){let a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:s,weight1:i,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,pe(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(s8)),this._cachedMergedKeybindings.slice(0)}},Na=new Ok,r8={EditorModes:"platform.keybindingsRegistry"};lt.add(r8.EditorModes,Na);function s8(o,e){if(o.weight1!==e.weight1)return o.weight1-e.weight1;if(o.command&&e.command){if(o.command<e.command)return-1;if(o.command>e.command)return 1}return o.weight2-e.weight2}function Oh(o){return o.command!==void 0}function CW(o){return o.submenu!==void 0}var Gt=class o{static _instances=new Map;static CommandPalette=new o("CommandPalette");static DebugBreakpointsContext=new o("DebugBreakpointsContext");static DebugCallStackContext=new o("DebugCallStackContext");static DebugConsoleContext=new o("DebugConsoleContext");static DebugVariablesContext=new o("DebugVariablesContext");static NotebookVariablesContext=new o("NotebookVariablesContext");static DebugHoverContext=new o("DebugHoverContext");static DebugWatchContext=new o("DebugWatchContext");static DebugToolBar=new o("DebugToolBar");static DebugToolBarStop=new o("DebugToolBarStop");static DebugCallStackToolbar=new o("DebugCallStackToolbar");static DebugCreateConfiguration=new o("DebugCreateConfiguration");static EditorContext=new o("EditorContext");static SimpleEditorContext=new o("SimpleEditorContext");static EditorContent=new o("EditorContent");static EditorLineNumberContext=new o("EditorLineNumberContext");static EditorContextCopy=new o("EditorContextCopy");static EditorContextPeek=new o("EditorContextPeek");static EditorContextShare=new o("EditorContextShare");static EditorTitle=new o("EditorTitle");static EditorTitleRun=new o("EditorTitleRun");static EditorTitleContext=new o("EditorTitleContext");static EditorTitleContextShare=new o("EditorTitleContextShare");static EmptyEditorGroup=new o("EmptyEditorGroup");static EmptyEditorGroupContext=new o("EmptyEditorGroupContext");static EditorTabsBarContext=new o("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new o("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new o("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new o("EditorActionsPositionSubmenu");static ExplorerContext=new o("ExplorerContext");static ExplorerContextShare=new o("ExplorerContextShare");static ExtensionContext=new o("ExtensionContext");static ExtensionEditorContextMenu=new o("ExtensionEditorContextMenu");static GlobalActivity=new o("GlobalActivity");static CommandCenter=new o("CommandCenter");static CommandCenterCenter=new o("CommandCenterCenter");static LayoutControlMenuSubmenu=new o("LayoutControlMenuSubmenu");static LayoutControlMenu=new o("LayoutControlMenu");static MenubarMainMenu=new o("MenubarMainMenu");static MenubarAppearanceMenu=new o("MenubarAppearanceMenu");static MenubarDebugMenu=new o("MenubarDebugMenu");static MenubarEditMenu=new o("MenubarEditMenu");static MenubarCopy=new o("MenubarCopy");static MenubarFileMenu=new o("MenubarFileMenu");static MenubarGoMenu=new o("MenubarGoMenu");static MenubarHelpMenu=new o("MenubarHelpMenu");static MenubarLayoutMenu=new o("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new o("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new o("PanelAlignmentMenu");static PanelPositionMenu=new o("PanelPositionMenu");static ActivityBarPositionMenu=new o("ActivityBarPositionMenu");static MenubarPreferencesMenu=new o("MenubarPreferencesMenu");static MenubarRecentMenu=new o("MenubarRecentMenu");static MenubarSelectionMenu=new o("MenubarSelectionMenu");static MenubarShare=new o("MenubarShare");static MenubarSwitchEditorMenu=new o("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new o("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new o("MenubarTerminalMenu");static MenubarViewMenu=new o("MenubarViewMenu");static MenubarHomeMenu=new o("MenubarHomeMenu");static OpenEditorsContext=new o("OpenEditorsContext");static OpenEditorsContextShare=new o("OpenEditorsContextShare");static ProblemsPanelContext=new o("ProblemsPanelContext");static SCMInputBox=new o("SCMInputBox");static SCMChangesContext=new o("SCMChangesContext");static SCMChangeContext=new o("SCMChangeContext");static SCMResourceContext=new o("SCMResourceContext");static SCMResourceContextShare=new o("SCMResourceContextShare");static SCMResourceFolderContext=new o("SCMResourceFolderContext");static SCMResourceGroupContext=new o("SCMResourceGroupContext");static SCMSourceControl=new o("SCMSourceControl");static SCMSourceControlInline=new o("SCMSourceControlInline");static SCMSourceControlTitle=new o("SCMSourceControlTitle");static SCMHistoryTitle=new o("SCMHistoryTitle");static SCMTitle=new o("SCMTitle");static SearchContext=new o("SearchContext");static SearchActionMenu=new o("SearchActionContext");static StatusBarWindowIndicatorMenu=new o("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new o("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new o("StickyScrollContext");static TestItem=new o("TestItem");static TestItemGutter=new o("TestItemGutter");static TestProfilesContext=new o("TestProfilesContext");static TestMessageContext=new o("TestMessageContext");static TestMessageContent=new o("TestMessageContent");static TestPeekElement=new o("TestPeekElement");static TestPeekTitle=new o("TestPeekTitle");static TestCallStack=new o("TestCallStack");static TouchBarContext=new o("TouchBarContext");static TitleBarContext=new o("TitleBarContext");static TitleBarTitleContext=new o("TitleBarTitleContext");static TunnelContext=new o("TunnelContext");static TunnelPrivacy=new o("TunnelPrivacy");static TunnelProtocol=new o("TunnelProtocol");static TunnelPortInline=new o("TunnelInline");static TunnelTitle=new o("TunnelTitle");static TunnelLocalAddressInline=new o("TunnelLocalAddressInline");static TunnelOriginInline=new o("TunnelOriginInline");static ViewItemContext=new o("ViewItemContext");static ViewContainerTitle=new o("ViewContainerTitle");static ViewContainerTitleContext=new o("ViewContainerTitleContext");static ViewTitle=new o("ViewTitle");static ViewTitleContext=new o("ViewTitleContext");static CommentEditorActions=new o("CommentEditorActions");static CommentThreadTitle=new o("CommentThreadTitle");static CommentThreadActions=new o("CommentThreadActions");static CommentThreadAdditionalActions=new o("CommentThreadAdditionalActions");static CommentThreadTitleContext=new o("CommentThreadTitleContext");static CommentThreadCommentContext=new o("CommentThreadCommentContext");static CommentTitle=new o("CommentTitle");static CommentActions=new o("CommentActions");static CommentsViewThreadActions=new o("CommentsViewThreadActions");static InteractiveToolbar=new o("InteractiveToolbar");static InteractiveCellTitle=new o("InteractiveCellTitle");static InteractiveCellDelete=new o("InteractiveCellDelete");static InteractiveCellExecute=new o("InteractiveCellExecute");static InteractiveInputExecute=new o("InteractiveInputExecute");static InteractiveInputConfig=new o("InteractiveInputConfig");static ReplInputExecute=new o("ReplInputExecute");static IssueReporter=new o("IssueReporter");static NotebookToolbar=new o("NotebookToolbar");static NotebookStickyScrollContext=new o("NotebookStickyScrollContext");static NotebookCellTitle=new o("NotebookCellTitle");static NotebookCellDelete=new o("NotebookCellDelete");static NotebookCellInsert=new o("NotebookCellInsert");static NotebookCellBetween=new o("NotebookCellBetween");static NotebookCellListTop=new o("NotebookCellTop");static NotebookCellExecute=new o("NotebookCellExecute");static NotebookCellExecuteGoTo=new o("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new o("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new o("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new o("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new o("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new o("NotebookOutputToolbar");static NotebookOutlineFilter=new o("NotebookOutlineFilter");static NotebookOutlineActionMenu=new o("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new o("NotebookEditorLayoutConfigure");static NotebookKernelSource=new o("NotebookKernelSource");static BulkEditTitle=new o("BulkEditTitle");static BulkEditContext=new o("BulkEditContext");static TimelineItemContext=new o("TimelineItemContext");static TimelineTitle=new o("TimelineTitle");static TimelineTitleContext=new o("TimelineTitleContext");static TimelineFilterSubMenu=new o("TimelineFilterSubMenu");static AccountsContext=new o("AccountsContext");static SidebarTitle=new o("SidebarTitle");static PanelTitle=new o("PanelTitle");static AuxiliaryBarTitle=new o("AuxiliaryBarTitle");static AuxiliaryBarHeader=new o("AuxiliaryBarHeader");static TerminalInstanceContext=new o("TerminalInstanceContext");static TerminalEditorInstanceContext=new o("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new o("TerminalNewDropdownContext");static TerminalTabContext=new o("TerminalTabContext");static TerminalTabEmptyAreaContext=new o("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new o("TerminalStickyScrollContext");static WebviewContext=new o("WebviewContext");static InlineCompletionsActions=new o("InlineCompletionsActions");static InlineEditsActions=new o("InlineEditsActions");static InlineEditActions=new o("InlineEditActions");static NewFile=new o("NewFile");static MergeInput1Toolbar=new o("MergeToolbar1Toolbar");static MergeInput2Toolbar=new o("MergeToolbar2Toolbar");static MergeBaseToolbar=new o("MergeBaseToolbar");static MergeInputResultToolbar=new o("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new o("InlineSuggestionToolbar");static InlineEditToolbar=new o("InlineEditToolbar");static ChatContext=new o("ChatContext");static ChatCodeBlock=new o("ChatCodeblock");static ChatCompareBlock=new o("ChatCompareBlock");static ChatMessageTitle=new o("ChatMessageTitle");static ChatExecute=new o("ChatExecute");static ChatExecuteSecondary=new o("ChatExecuteSecondary");static ChatInputSide=new o("ChatInputSide");static AccessibleView=new o("AccessibleView");static MultiDiffEditorFileToolbar=new o("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new o("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new o("DiffEditorSelectionToolbar");static for(e){return o._instances.get(e)??new o(e)}id;constructor(e){if(o._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);o._instances.set(e,this),this.id=e}},pu=Q("menuService"),uu=class o{constructor(e){this.id=e;this.has=t=>t===e}static _all=new Map;static for(e){let t=this._all.get(e);return t||(t=new o(e),this._all.set(e,t)),t}static merge(e){let t=new Set;for(let n of e)n instanceof o&&t.add(n.id);return t}has},Ar=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new Cy({merge:uu.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(o){return this._commands.set(o.id,o),this._onDidChangeMenu.fire(uu.for(Gt.CommandPalette)),pe(()=>{this._commands.delete(o.id)&&this._onDidChangeMenu.fire(uu.for(Gt.CommandPalette))})}getCommand(o){return this._commands.get(o)}getCommands(){let o=new Map;return this._commands.forEach((e,t)=>o.set(t,e)),o}appendMenuItem(o,e){let t=this._menuItems.get(o);t||(t=new Vi,this._menuItems.set(o,t));let n=t.push(e);return this._onDidChangeMenu.fire(uu.for(o)),pe(()=>{n(),this._onDidChangeMenu.fire(uu.for(o))})}appendMenuItems(o){let e=new ne;for(let{id:t,item:n}of o)e.add(this.appendMenuItem(t,n));return e}getMenuItems(o){let e;return this._menuItems.has(o)?e=[...this._menuItems.get(o)]:e=[],o===Gt.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(o){let e=new Set;for(let t of o)Oh(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,n)=>{e.has(n)||o.push({command:t})})}},Ml=class extends bl{constructor(t,n,i){super(`submenuitem.${t.submenu.id}`,typeof t.title=="string"?t.title:t.title.value,i,"submenu");this.item=t;this.hideActions=n}},To=class{constructor(e,t,n,i,r,s,a){this.hideActions=i;this.menuKeybinding=r;this._commandService=a;this.id=e.id,this.label=To.label(e,n),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||s.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){let d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&Be.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=Be.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new To(t,void 0,n,i,void 0,s,a):void 0,this._options=n,this.class=l&&Be.asClassName(l)}static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};To=P([_(5,St),_(6,Gi)],To);var io=class{constructor(e){this.desc=e}};function dr(o){let e=[],t=new o,{f1:n,menu:i,keybinding:r,...s}=t.desc;if(ir.getCommand(s.id))throw new Error(`Cannot register two commands with the same id: ${s.id}`);if(e.push(ir.registerCommand({id:s.id,handler:(a,...l)=>t.run(a,...l),metadata:s.metadata})),Array.isArray(i))for(let a of i)e.push(Ar.appendMenuItem(a.id,{command:{...s,precondition:a.precondition===null?void 0:s.precondition},...a}));else i&&e.push(Ar.appendMenuItem(i.id,{command:{...s,precondition:i.precondition===null?void 0:s.precondition},...i}));if(n&&(e.push(Ar.appendMenuItem(Gt.CommandPalette,{command:s,when:s.precondition})),e.push(Ar.addCommand(s))),Array.isArray(r))for(let a of r)e.push(Na.registerKeybindingRule({...a,id:s.id,when:s.precondition?Ct.and(s.precondition,a.when):a.when}));else r&&e.push(Na.registerKeybindingRule({...r,id:s.id,when:s.precondition?Ct.and(s.precondition,r.when):r.when}));return{dispose(){Tt(e)}}}var cr=Q("editorGroupsService");var Vt=Q("editorService");var Nk=class{constructor(e,t,n){this.id=e;this.dependencies=t;this.callback=n}};var SW=class o{static INSTANCE=new o;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(e,t,n)=>{typeof e!="string"&&(n=t,t=e,e=null),(typeof t!="object"||!Array.isArray(t))&&(n=t,t=null),this._defineCalls.push(new Nk(e,t,n))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){if(e.startsWith(window.location.origin)||e.startsWith(`${xe.vscodeFileResource}://${uL}`))return e;throw new Error(`[trusted_script_src] Invalid script url: ${e}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){return e}}))}async load(e){if(this._initialize(),this._state===3)return new Promise(s=>{let a=Jc();console.log(`[amdX] Using external define("${a}", ["${e}"])`),globalThis.define(a,[e],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}let n={},i=[],r=[];if(Array.isArray(t.dependencies))for(let s of t.dependencies)s==="exports"?i.push(n):r.push(s);if(r.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${r.join(", ")}`);return typeof t.callback=="function"?t.callback(...i)??n:t.callback}_rendererLoadScript(e){return new Promise((t,n)=>{let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("type","text/javascript");let r=()=>{i.removeEventListener("load",s),i.removeEventListener("error",a)},s=l=>{r(),t(this._defineCalls.pop())},a=l=>{r(),n(l)};i.addEventListener("load",s),i.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),i.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(i)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{let t=(await import("fs")).default,n=(await import("vm")).default,i=(await import("module")).default,r=te.parse(e).fsPath,s=t.readFileSync(r).toString(),a=i.wrap(s.replace(/^#!.*/,""));return new n.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};var Pk="utf8";var e1e=512*8,t1e=512*128;var Ak={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},n1e=(()=>{let o={};for(let e in Ak)Ak[e].guessableName&&(o[e]=Ak[e]);return o})();var Ws=class extends Ns{constructor(t,n,i,r,s,a,l,d,c,u,p,h,f,g,b){super(l,a,g,b);this.resource=t;this.hasAssociatedFilePath=n;this.initialValue=i;this.preferredLanguageId=r;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=u;this.textFileService=p;this.labelService=h;this.editorService=f;this._register(this.workingCopyService.registerWorkingCopy(this)),r&&this.setLanguageId(r),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new k);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new k);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new k);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new k);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new k);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new k);onDidRevert=this._onDidRevert.event;typeId=yF;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(t=>this.onConfigurationChange(t,!0)))}onConfigurationChange(t,n){if(!t||t.affectsConfiguration(this.resource,"files.encoding")){let i=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==i&&typeof i=="string"&&(this.configuredEncoding=i,n&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!t||t.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let i=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==i&&(i==="content"||i==="name")&&(this.configuredLabelFormat=i,n&&this._onDidChangeName.fire())}}setLanguageId(t,n){let i=t===Ws.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:t;this.preferredLanguageId=i,i&&super.setLanguageId(i,n)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(t){let n=this.getEncoding();this.preferredEncoding=t,n!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(t){this.dirty!==t&&(this.dirty=t,this._onDidChangeDirty.fire())}async save(t){let n=await this.textFileService.save(this.resource,t);return n&&this._onDidSave.fire({reason:t?.reason,source:t?.source}),!!n}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(vk(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(t){let n;return this.isResolved()?n=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:Pk}):typeof this.initialValue=="string"&&(n=kP(_n.fromString(this.initialValue))),{content:n}}ignoreDirtyOnModelContentChange=!1;async resolve(){let t=!1,n=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let r,s=await this.workingCopyBackupService.resolve(this);s?(r=s.value,n=!0):r=RP(_n.fromString(this.initialValue||""));let a=await uW(await this.textFileService.getDecodedStream(this.resource,r,{encoding:Pk}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),t=!0}let i=pn(this.textEditorModel);return this.installModelListeners(i),t&&((n||this.initialValue)&&this.updateNameFromFirstLine(i),this.setDirty(this.hasAssociatedFilePath||!!n||!!this.initialValue),(n||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n))),this._register(t.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(t)}onModelContentChanged(t,n){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&t.getLineCount()===1&&t.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),n.changes.some(i=>(i.range.startLineNumber===1||i.range.endLineNumber===1)&&i.range.startColumn<=Ws.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(t),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(t){if(this.hasAssociatedFilePath)return;let n,i=t.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:Ws.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");i=i.substr(0,_y(i,Ws.FIRST_LINE_NAME_MAX_LENGTH)[0]),i&&tf().exec(i)&&(n=i),n!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=n,this._onDidChangeName.fire())}isReadonly(){return!1}};Ws=P([_(5,$n),_(6,ar),_(7,tC),_(8,Mr),_(9,Ma),_(10,TW),_(11,du),_(12,Vt),_(13,eC),_(14,vo)],Ws);var wW=Q("untitledTextEditorService"),hu=class extends F{constructor(t,n){super();this.instantiationService=t;this.configurationService=n}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new k);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new k);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new k);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new k);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new k);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new go;get(t){return this.mapResourceToModel.get(t)}getValue(t){return this.get(t)?.textEditorModel?.getValue()}async resolve(t){let n=this.doCreateOrGet(t);return await n.resolve(),n}create(t){return this.doCreateOrGet(t)}doCreateOrGet(t=Object.create(null)){let n=this.massageOptions(t);return n.untitledResource&&this.mapResourceToModel.has(n.untitledResource)?this.mapResourceToModel.get(n.untitledResource):this.doCreate(n)}massageOptions(t){let n=Object.create(null);if(t.associatedResource?(n.untitledResource=te.from({scheme:xe.untitled,authority:t.associatedResource.authority,fragment:t.associatedResource.fragment,path:t.associatedResource.path,query:t.associatedResource.query}),n.associatedResource=t.associatedResource):t.untitledResource?.scheme===xe.untitled&&(n.untitledResource=t.untitledResource),t.languageId)n.languageId=t.languageId;else if(!n.associatedResource){let i=this.configurationService.getValue();i.files?.defaultLanguage&&(n.languageId=i.files.defaultLanguage)}return n.encoding=t.encoding,n.initialValue=t.initialValue,n}doCreate(t){let n=t.untitledResource;if(!n){let r=1;do n=te.from({scheme:xe.untitled,path:`Untitled-${r}`}),r++;while(this.mapResourceToModel.has(n))}let i=this._register(this.instantiationService.createInstance(Ws,n,!!t.associatedResource,t.initialValue,t.languageId,t.encoding));return this.registerModel(i),i}registerModel(t){let n=new ne;n.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),n.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire(t))),n.add(t.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(t))),n.add(t.onWillDispose(()=>this._onWillDispose.fire(t))),j.once(t.onWillDispose)(()=>{this.mapResourceToModel.delete(t.resource),n.dispose()}),this.mapResourceToModel.set(t.resource,t),this._onDidCreate.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t)}isUntitledWithAssociatedResource(t){return t.scheme===xe.untitled&&t.path.length>1&&!hu.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(t.path)}canDispose(t){return t.isDisposed()?!0:this.doCanDispose(t)}async doCanDispose(t){return t.isDirty()?(await j.toPromise(t.onDidChangeDirty),this.canDispose(t)):!0}};hu=P([_(0,Qe),_(1,ut)],hu);ji(wW,hu,1);var rS=ui,mu=Q("notificationService");var Fk=Q("progressService");var TRe=Object.freeze({total(){},worked(){},done(){}}),xW=class{constructor(e){this.callback=e}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(e){this._value=e,this.callback(this._value)}};var sS=class extends F{deferred=new Ld;reporter;lastStep;constructor(e,t){super(),t.withProgress(e,n=>(this.reporter=n,this.lastStep&&n.report(this.lastStep),this.deferred.p)),this._register(pe(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};sS=P([_(1,Fk)],sS);var _W=Q("editorProgressService");var Nh=class extends F{constructor(t,n){super();this.logService=t;this.configurationService=n}participants=new Vi;addFileOperationParticipant(t){let n=this.participants.push(t);return pe(()=>n())}async participate(t,n,i,r){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(t,n,i,s,r)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};Nh=P([_(0,gi),_(1,ut)],Nh);var Uo=class extends F{constructor(t,n,i,r){super();this.getExpression=t;this.shouldUpdate=n;this.contextService=i;this.configurationService=r;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new k);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{this.shouldUpdate(t)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(t){let n=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!Ei(c.expression,d.expression))&&(n=!0,this.mapFolderToParsedExpression.set(l,WD(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(n=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let i=new Lc(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==Uo.NO_FOLDER&&(i.has(te.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),n=!0));let r=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(Uo.NO_FOLDER);r?(!s||!Ei(s.expression,r.expression))&&(n=!0,this.mapFolderToParsedExpression.set(Uo.NO_FOLDER,WD(r.expression)),this.mapFolderToConfiguredExpression.set(Uo.NO_FOLDER,r)):s&&(n=!0,this.mapFolderToParsedExpression.delete(Uo.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(Uo.NO_FOLDER)),t&&n&&this._onExpressionChange.fire()}doGetExpression(t){let n=this.getExpression(t);if(!n)return;let i=Object.keys(n);if(i.length===0)return;let r=!1,s=Object.create(null);for(let a of i){r||(r=k_(a));let l=a,d=rP(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=n[a]}return{expression:s,hasAbsolutePath:r}}matches(t,n){if(this.mapFolderToParsedExpression.size===0)return!1;let i=this.contextService.getWorkspaceFolder(t),r,s;if(i&&this.mapFolderToParsedExpression.has(i.uri.toString())?(r=this.mapFolderToParsedExpression.get(i.uri.toString()),s=this.mapFolderToConfiguredExpression.get(i.uri.toString())):(r=this.mapFolderToParsedExpression.get(Uo.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(Uo.NO_FOLDER)),!r)return!1;let a;return i?a=By(i.uri,t):a=this.uriToPath(t),typeof a=="string"&&r(a,void 0,n)?!0:a!==this.uriToPath(t)&&s?.hasAbsolutePath?!!r(this.uriToPath(t),void 0,n):!1}uriToPath(t){return t.scheme===xe.file?t.fsPath:t.path}};Uo=P([_(2,ba),_(3,ut)],Uo);var d8=new $("autoSaveAfterShortDelayContext",!1,!0);var Bk=Q("filesConfigurationService"),zo=class extends F{constructor(t,n,i,r,s,a,l,d){super();this.contextKeyService=t;this.configurationService=n;this.contextService=i;this.environmentService=r;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=n.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||ih.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=Zi?Os.AFTER_DELAY:Os.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:m("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:m({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:m({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:m({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:m("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new k);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new k);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new k);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new k);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new Qo(1e3);autoSaveDisabledOverrides=new go;autoSaveAfterShortDelayContext=d8.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new bf(()=>this.createReadonlyMatcher(bF)));readonlyExcludeMatcher=this._register(new bf(()=>this.createReadonlyMatcher(vF)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new go(t=>this.uriIdentityService.extUri.getComparisonKey(t));createReadonlyMatcher(t){let n=this._register(new Uo(i=>this.configurationService.getValue(t,{resource:i}),i=>i.affectsConfiguration(t),this.contextService,this.configurationService));return this._register(n.onExpressionChange(()=>this._onDidChangeReadonly.fire())),n}isReadonly(t,n){let i=this.fileService.getProvider(t.scheme);if(i&&gF(i))return i.readOnlyMessage??zo.READONLY_MESSAGES.providerReadonly;let r=this.sessionReadonlyOverrides.get(t);return typeof r=="boolean"?r===!0?zo.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(t,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(t,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(t)?this.readonlyExcludeMatcher.value.matches(t)?!1:zo.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&n?.locked?zo.READONLY_MESSAGES.fileLocked:n?.readonly?zo.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(t,n){if(n==="toggle"){let i;try{i=await this.fileService.resolve(t,{resolveMetadata:!0})}catch{}n=!this.isReadonly(t,i)}n==="reset"?this.sessionReadonlyOverrides.delete(t):this.sessionReadonlyOverrides.set(t,n),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(t,n){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,t.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),n&&this._onDidChangeAutoSaveConfiguration.fire();let i=t?.files?.associations;Ei(this.currentFilesAssociationConfiguration,i)||(this.currentFilesAssociationConfiguration=i,n&&this._onDidChangeFilesAssociation.fire());let r=t?.files?.hotExit;r===ih.OFF||r===ih.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=r:this.currentHotExitConfiguration=ih.ON_EXIT;let s=!!t?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,n&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(t){let n=this.toResource(t);if(n){let i=this.autoSaveConfigurationCache.get(n);return i||(i=this.computeAutoSaveConfiguration(n,this.textResourceConfigurationService.getValue(n,"files")),this.autoSaveConfigurationCache.set(n,i)),i}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(t,n){let i,r,s,a,l,d;switch(n?.autoSave??zo.DEFAULT_AUTO_SAVE_MODE){case Os.AFTER_DELAY:{i="afterDelay",r=typeof n?.autoSaveDelay=="number"&&n.autoSaveDelay>=0?n.autoSaveDelay:zo.DEFAULT_AUTO_SAVE_DELAY,d=r<=zo.DEFAULT_AUTO_SAVE_DELAY;break}case Os.ON_FOCUS_CHANGE:i="onFocusChange";break;case Os.ON_WINDOW_CHANGE:i="onWindowChange";break}return n?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,t&&!this.contextService.isInsideWorkspace(t)&&(l=!0,d=void 0)),n?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:i,autoSaveDelay:r,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(t){return t instanceof kl?Nr.getOriginalUri(t,{supportSideBySide:1}):t}hasShortAutoSaveDelay(t){let n=this.toResource(t);return this.getAutoSaveConfiguration(n).isShortAutoSaveDelay?!n||!this.autoSaveDisabledOverrides.has(n):!1}getAutoSaveMode(t,n){let i=this.toResource(t);if(i&&this.autoSaveDisabledOverrides.has(i))return{mode:0,reason:4};let r=this.getAutoSaveConfiguration(i);if(typeof r.autoSave>"u")return{mode:0,reason:1};if(typeof n=="number"&&(r.autoSave==="afterDelay"&&n!==2||r.autoSave==="onFocusChange"&&n!==3&&n!==4||r.autoSave==="onWindowChange"&&n!==4))return{mode:0,reason:1};if(i){if(r.autoSaveWorkspaceFilesOnly&&r.isOutOfWorkspace)return{mode:0,reason:2};if(r.autoSaveWhenNoErrors&&this.markerService.read({resource:i,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(r.autoSave){case"afterDelay":return typeof r.autoSaveDelay=="number"&&r.autoSaveDelay<=zo.DEFAULT_AUTO_SAVE_DELAY?{mode:r.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let t=this.configurationService.getValue("files.autoSave"),n;return[Os.AFTER_DELAY,Os.ON_FOCUS_CHANGE,Os.ON_WINDOW_CHANGE].some(i=>i===t)?n=Os.OFF:n=Os.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",n)}disableAutoSave(t){let n=this.toResource(t);if(!n)return F.None;let i=this.autoSaveDisabledOverrides.get(n)??0;return this.autoSaveDisabledOverrides.set(n,i+1),i===0&&this._onDidChangeAutoSaveDisabled.fire(n),pe(()=>{let r=this.autoSaveDisabledOverrides.get(n)??0;r<=1?(this.autoSaveDisabledOverrides.delete(n),this._onDidChangeAutoSaveDisabled.fire(n)):this.autoSaveDisabledOverrides.set(n,r-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==ih.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(t,n){return this.configurationService.getValue("files.saveConflictResolution",{resource:t,overrideIdentifier:n})!=="overwriteFileOnDisk"}};zo=P([_(0,St),_(1,ut),_(2,ba),_(3,kr),_(4,cu),_(5,Mn),_(6,ZP),_(7,Mr)],zo);ji(Bk,zo,0);var Wk=Q("workingCopyEditorService"),cb=class extends F{constructor(t){super();this.editorService=t}_onDidRegisterHandler=this._register(new k);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(t){return this.handlers.add(t),this._onDidRegisterHandler.fire(t),pe(()=>this.handlers.delete(t))}findEditor(t){for(let n of this.editorService.getEditors(0))if(this.isOpen(t,n.editor))return n}isOpen(t,n){for(let i of this.handlers)if(i.isOpen(t,n))return!0;return!1}};cb=P([_(0,Vt)],cb);ji(Wk,cb,1);var LW=Q("elevatedFileService");var Ah=class extends F{constructor(t,n){super();this.resource=t;this.fileService=n;this._register(this.fileService.onDidFilesChange(i=>this.onDidFilesChange(i)))}_onDidChangeOrphaned=this._register(new k);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(t){let n=!1,i;if(this.orphaned?t.contains(this.resource,1)&&(i=!1,n=!0):t.contains(this.resource,2)&&(i=!0,n=!0),n&&this.orphaned!==i){let r=!1;i&&(await wi(100,en.None),this.isDisposed()?r=!0:r=!await this.fileService.exists(this.resource)),this.orphaned!==r&&!this.isDisposed()&&this.setOrphaned(r)}}setOrphaned(t){this.orphaned!==t&&(this.orphaned=t,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new k);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};Ah=P([_(1,Mn)],Ah);var gu=class extends Ah{constructor(t,n,i,r,s,a,l,d,c,u,p,h,f,g,b,v){super(n,a);this.typeId=t;this.name=i;this.modelFactory=r;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=u;this.notificationService=h;this.workingCopyEditorService=f;this.editorService=g;this.elevatedFileService=b;this.progressService=v;this._register(p.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new k);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new k);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new k);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new k);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new k);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new k);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new k);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(t){if(!this.isResolved())return;let n=this.dirty;this.doSetDirty(t),t!==n&&this._onDidChangeDirty.fire()}doSetDirty(t){let n=this.dirty,i=this.inConflictMode,r=this.inErrorMode,s=this.savedVersionId;return t?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=n,this.inConflictMode=i,this.inErrorMode=r,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(t){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!t?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(t)}async doResolve(t){if(t?.contents)return this.resolveFromBuffer(t.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(t)}async resolveFromBuffer(t){this.trace("resolveFromBuffer()");let n,i,r,s;try{let a=await this.fileService.stat(this.resource);n=a.mtime,i=a.ctime,r=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){n=Date.now(),i=Date.now(),r=0,s=Pf,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:n,ctime:i,size:r,etag:s,value:t,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let t=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):t?(await this.doResolveFromBackup(t),!0):!1}async doResolveFromBackup(t){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:t.meta?t.meta.mtime:Date.now(),ctime:t.meta?t.meta.ctime:Date.now(),size:t.meta?t.meta.size:0,etag:t.meta?t.meta.etag:Pf,value:t.value,readonly:!1,locked:!1},!0),t.meta&&t.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(t){this.trace("resolveFromFile()");let n=t?.forceReadFromFile,i;n?i=Pf:this.lastResolvedFileStat&&(i=this.lastResolvedFileStat.etag);let r=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:i,limits:t?.limits});if(this.setOrphaned(!1),r!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof XI&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!n)return;throw s}}async resolveFromContent(t,n){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:t.name,mtime:t.mtime,ctime:t.ctime,size:t.size,etag:t.etag,readonly:t.readonly,locked:t.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(t.value):await this.doCreateModel(t.value),this.setDirty(!!n),this._onDidResolve.fire()}async doCreateModel(t){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,t,en.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(t){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(t,en.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n.isUndoing||n.isRedoing))),this._register(t.onWillDispose(()=>this.dispose()))}onModelContentChanged(t,n){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),n&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(t.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let i=this.dirty;this.setDirty(!1),i&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(t){let n;this.lastResolvedFileStat&&(n={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let i;return this.isResolved()&&(i=await vf(this.model.snapshot(2,t),t)),{meta:n,content:i}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new hI;ignoreSaveFromSaveParticipants=!1;async save(t=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(t.reason===2||t.reason===3||t.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(t),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(t){typeof t.reason!="number"&&(t.reason=1);let n=this.versionId;if(this.trace(`doSave(${n}) - enter with versionId ${n}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${n}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(n))return this.trace(`doSave(${n}) - exit - found a running save for versionId ${n}`),this.saveSequentializer.running;if(!t.force&&!this.dirty){this.trace(`doSave(${n}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${n}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(t));this.isResolved()&&this.model.pushStackElement();let i=new Rn;return this.progressService.withProgress({title:m("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},r=>this.doSaveSequential(n,t,r,i),()=>{i.cancel()}).finally(()=>{i.dispose()})}doSaveSequential(t,n,i,r){return this.saveSequentializer.run(t,(async()=>{if(this.isResolved()&&!n.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(n.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<gu.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await wi(gu.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!r.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:n.reason??1,savedFrom:n.from},i,r.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${t}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(r.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;t=this.versionId,this.inErrorMode=!1,i.report({message:m("saveTextFile","Writing into file...")}),this.trace(`doSave(${t}) - before write()`);let s=pn(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(t,(async()=>{try{let l={mtime:s.mtime,etag:n.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?Pf:s.etag,unlock:n.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,r.token)}catch(c){if(r.token.isCancellationRequested)return;throw c}else{let c=await vf(a.model.snapshot(1,r.token),r.token);if(r.token.isCancellationRequested)return;r.dispose(),n?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,pn(c),l):d=await this.fileService.writeFile(s.resource,pn(c),l)}this.handleSaveSuccess(d,t,n)}catch(l){this.handleSaveError(l,t,n)}})(),()=>r.cancel())})(),()=>r.cancel())}handleSaveSuccess(t,n,i){this.updateLastResolvedFileStat(t),n===this.versionId?(this.trace(`handleSaveSuccess(${n}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${n}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:i.reason,stat:t,source:i.source})}handleSaveError(t,n,i){if((i.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${n}) - exit - resulted in a save error: ${t.toString()}`,this.resource.toString(),this.typeId]),i.ignoreErrorHandler)throw t;this.setDirty(!0),this.inErrorMode=!0,t.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(t,i),this._onDidSaveError.fire()}doHandleSaveError(t,n){let i=t,r=[],s;if(i.fileOperationResult===3)s=m("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),r.push(Si({id:"fileWorkingCopy.overwrite",label:m("overwrite","Overwrite"),run:()=>this.save({...n,ignoreModifiedSince:!0,reason:1})})),r.push(Si({id:"fileWorkingCopy.revert",label:m("revert","Revert"),run:()=>this.revert()}));else{let d=i.fileOperationResult===5,c=d&&i.options?.unlock,u=i.fileOperationResult===6,p=this.elevatedFileService.isSupported(this.resource);mL(t)&&r.push(...t.actions),p&&(u||c)?r.push(Si({id:"fileWorkingCopy.saveElevated",label:c?pt?m("overwriteElevated","Overwrite as Admin..."):m("overwriteElevatedSudo","Overwrite as Sudo..."):pt?m("saveElevated","Retry as Admin..."):m("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...n,writeElevated:!0,writeUnlock:c,reason:1})}})):d?r.push(Si({id:"fileWorkingCopy.unlock",label:m("overwrite","Overwrite"),run:()=>this.save({...n,writeUnlock:!0,reason:1})})):r.push(Si({id:"fileWorkingCopy.retry",label:m("retry","Retry"),run:()=>this.save({...n,reason:1})})),r.push(Si({id:"fileWorkingCopy.saveAs",label:m("saveAs","Save As..."),run:async()=>{let h=this.workingCopyEditorService.findEditor(this);h&&((await this.editorService.save(h,{saveAs:!0,reason:1})).success||this.doHandleSaveError(t,n))}})),r.push(Si({id:"fileWorkingCopy.revert",label:m("revert","Revert"),run:()=>this.revert()})),d?c&&p?s=pt?m("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):m("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=m("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):p&&u?s=pt?m("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):m("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=m({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,kp(t,!1))}let a=this.notificationService.notify({id:`${is(this.resource.toString())}`,severity:rS.Error,message:s,actions:{primary:r}}),l=this._register(j.once(j.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(j.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(t){let n=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=t.mtime?this.lastResolvedFileStat=t:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:t.readonly,locked:t.locked}:this.lastResolvedFileStat=t,this.isReadonly()!==n&&this._onDidChangeReadonly.fire()}async revert(t){if(!this.isResolved()||!this.dirty&&!t?.force)return;this.trace("revert()");let n=this.dirty,i=this.doSetDirty(!1);if(!t?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw i(),s}this._onDidRevert.fire(),n&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(t){switch(t){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(t){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(t){this.logService.trace(`[stored file working copy] ${t}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};gu=P([_(5,Mn),_(6,gi),_(7,Vk),_(8,Bk),_(9,tC),_(10,Ma),_(11,mu),_(12,Wk),_(13,Vt),_(14,LW),_(15,Fk)],gu);var Ph=class extends F{constructor(t){super();this.logService=t}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(t){let n=sy(this.saveParticipants,t);return pe(()=>n())}async participate(t,n,i,r){t.model?.pushStackElement();for(let s of this.saveParticipants){if(r.isCancellationRequested||t.isDisposed())break;try{let a=s.participate(t,n,i,r);await vf(a,r)}catch(a){this.logService.warn(a)}}t.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};Ph=P([_(0,gi)],Ph);var Vk=Q("workingCopyFileService"),ub=class extends F{constructor(t,n,i,r){super();this.fileService=t;this.workingCopyService=n;this.instantiationService=i;this.uriIdentityService=r;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new xp);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new xp);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new xp);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(t,n,i){return this.doCreateFileOrFolder(t,!0,n,i)}createFolder(t,n,i){return this.doCreateFileOrFolder(t,!1,n,i)}async doCreateFileOrFolder(t,n,i,r){if(t.length===0)return[];if(n){let c=(await Ao.settled(t.map(u=>this.fileService.canCreateFile(u.resource,{overwrite:u.overwrite})))).find(u=>u instanceof Error);if(c instanceof Error)throw c}let s=t.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,r,i);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,en.None);let l;try{n?l=await Ao.settled(t.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await Ao.settled(t.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,en.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,en.None),l}async move(t,n,i){return this.doMoveOrCopy(t,!0,n,i)}async copy(t,n,i){return this.doMoveOrCopy(t,!1,n,i)}async doMoveOrCopy(t,n,i,r){let s=[];for(let{file:{source:d,target:c},overwrite:u}of t){let p=await(n?this.fileService.canMove(d,c,u):this.fileService.canCopy(d,c,u));if(p instanceof Error)throw p}let a=t.map(d=>d.file);await this.runFileOperationParticipants(a,n?2:3,r,i);let l={correlationId:this.correlationIds++,operation:n?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,en.None);try{for(let{file:{source:d,target:c},overwrite:u}of t){if(!this.uriIdentityService.extUri.isEqual(d,c)){let p=n?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await Ao.settled(p.map(h=>h.revert({soft:!0})))}n?s.push(await this.fileService.move(d,c,u)):s.push(await this.fileService.copy(d,c,u))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,en.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,en.None),s}async delete(t,n,i){for(let a of t){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let r=t.map(a=>({target:a.resource}));await this.runFileOperationParticipants(r,1,i,n);let s={correlationId:this.correlationIds++,operation:1,files:r};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,en.None);for(let a of t){let l=this.getDirty(a.resource);await Ao.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of t)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,en.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,en.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(Nh));addFileOperationParticipant(t){return this.fileOperationParticipants.addFileOperationParticipant(t)}runFileOperationParticipants(t,n,i,r){return this.fileOperationParticipants.participate(t,n,i,r)}saveParticipants=this._register(this.instantiationService.createInstance(Ph));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(t){return this.saveParticipants.addSaveParticipant(t)}runSaveParticipants(t,n,i,r){return this.saveParticipants.participate(t,n,i,r)}workingCopyProviders=[];registerWorkingCopyProvider(t){let n=sy(this.workingCopyProviders,t);return pe(n)}getDirty(t){let n=new Set;for(let i of this.workingCopyProviders)for(let r of i(t))r.isDirty()&&n.add(r);return Array.from(n)}};ub=P([_(0,Mn),_(1,Ma),_(2,Qe),_(3,cu)],ub);ji(Vk,ub,1);var TW=Q("textFileService");var u8;(e=>e.DEFAULT={allowTrailingComma:!0})(u8||={});var Qn=Q("keybindingService");var Hk=".vscode",p8="settings",xFe=`${Hk}/${p8}.json`;var _Fe=[1],LFe=[2,3,4,5,6],h8=[3,4,5],DFe=[1,...h8],kFe=[2,3,4,5,6],m8=[3,4,5,6],g8=[4,5,6],aS="tasks",DW="launch",RW=Object.create(null);RW[aS]=`${Hk}/${aS}.json`;RW[DW]=`${Hk}/${DW}.json`;var f8=Object.create(null);f8[aS]=`${aS}.json`;var RFe=ut;var Uk=class extends Pd{_currentResultGroups=new Map;updateResultGroup(e,t){return t?this._currentResultGroups.set(e,t):this._currentResultGroups.delete(e),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let e=new Set;[...this._currentResultGroups.keys()].sort((t,n)=>this._currentResultGroups.get(t).order-this._currentResultGroups.get(n).order).forEach(t=>{let n=this._currentResultGroups.get(t);n.result.filterMatches=n.result.filterMatches.filter(i=>!e.has(i.setting.key)),n.result.filterMatches.forEach(i=>e.add(i.setting.key))})}filterSettings(e,t,n){let i=this.filterGroups,r=[];for(let s of i){let a=t(s);for(let l of s.sections)for(let d of l.settings){let c=n(d,s);(a||c)&&r.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return r}getPreference(e){for(let t of this.settingsGroups)for(let n of t.sections)for(let i of n.settings)if(e===i.key)return i}collectMetadata(e){let t=Object.create(null),n=!1;return e.forEach(i=>{i.result.metadata&&(t[i.id]=i.result.metadata,n=!0)}),n?t:null}get filterGroups(){return this.settingsGroups}};var lS=class extends Uk{constructor(t,n){super();this._defaultSettings=t;this._register(n.onDidChangeConfiguration(i=>{i.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(lt.as(Qr.Configuration).onDidSchemaChange(i=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new k);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let t=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...t,...this.additionalGroups]}setAdditionalGroups(t){this.additionalGroups=t}findValueMatches(t,n){return[]}update(){throw new Error("Not supported")}};lS=P([_(1,ut)],lS);function v8(o){return"// "+m("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+o.getDefaultKeybindingsContent()}var dS=class{constructor(e,t){this._uri=e;this.keybindingService=t}_content;get uri(){return this._uri}get content(){return this._content||(this._content=v8(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};dS=P([_(1,Qn)],dS);var MW=Q("preferencesService");var Bs={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},OW={id:"default",displayName:m("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:m("builtinProviderDisplayName","Built-in")},NW="workbench.editor.sidebysideEditor",cS="workbench.editors.textDiffEditor",AW="workbench.editors.binaryResourceDiffEditor";function jk(o){let e=o;return!!e&&typeof e.getSelection=="function"&&!!e.onDidChangeSelection}function XC(o,e,t){for(let n of t.visibleEditorPanes)if(n.group.id===e&&o.matches(n.input))return n.getViewState()}function gW(o){if(hi(o))return!1;let e=o;return te.isUri(e?.resource)}function Fs(o){if(hi(o))return!1;let e=o;return e?.original!==void 0&&e.modified!==void 0}function kh(o){if(hi(o))return!1;let e=o;return!e||e.resources&&!Array.isArray(e.resources)?!1:!!e.resources||!!e.multiDiffSource}function Ud(o){if(hi(o)||Fs(o))return!1;let e=o;return e?.primary!==void 0&&e.secondary!==void 0}function zd(o){if(hi(o))return!1;let e=o;return te.isUri(e?.base?.resource)&&te.isUri(e?.input1?.resource)&&te.isUri(e?.input2?.resource)&&te.isUri(e?.result?.resource)}var zk=class{mapIdToSaveSource=new Map;registerSource(e,t){let n=this.mapIdToSaveSource.get(e);return n||(n={source:e,label:t},this.mapIdToSaveSource.set(e,n)),n.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},Vs=new zk;var ob=class extends F{};function hi(o){return o instanceof ob}function I8(o){let e=o;return te.isUri(e?.preferredResource)}function C8(o){let e=o;return hi(e?.primary)&&hi(e?.secondary)}function Ck(o){let e=o;return hi(e?.modified)&&hi(e?.original)}function PW(o,e,t,n,i){return S8(n,[Si({id:"workbench.action.openLargeFile",label:m("openLargeFile","Open Anyway"),run:()=>{let r={...t,limits:{size:Number.MAX_VALUE}};o.openEditor(e,r)}}),Si({id:"workbench.action.configureEditorLargeFileConfirmation",label:m("configureEditorLargeFileConfirmation","Configure Limit"),run:()=>i.openUserSettings({query:"workbench.editorLargeFileConfirmation"})})],{forceMessage:!0,forceSeverity:ui.Warning})}var Kk=class{getOriginalUri(e,t){if(!e)return;if(zd(e))return Nr.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getOriginalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getOriginalUri(i,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(Fs(e)||kh(e)||Ud(e)||zd(e))return;let n=I8(e)?e.preferredResource:e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}getSideEditors(e){return C8(e)||Ud(e)?{primary:e.primary,secondary:e.secondary}:Ck(e)||Fs(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(zd(e))return Nr.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getCanonicalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getCanonicalUri(i,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(Fs(e)||kh(e)||Ud(e)||zd(e))return;let n=e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(n=>e.scheme===n))return e}else if(t===e.scheme)return e}};var Nr=new Kk;var Gk=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(e){let t=this.instantiationService=e.get(Qe);for(let[n,i]of this.editorSerializerConstructors)this.createEditorSerializer(n,i,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){let i=n.createInstance(t);this.editorSerializerInstances.set(e,i)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return pn(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),pe(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};lt.add(Bs.EditorFactory,new Gk);function pb(o){let e=o;if(!e)return!1;let t=e;if(t.modified)return pb(t.modified);let n=e;return!!(n.contributionsState&&n.viewState&&Array.isArray(n.cursorState))}function S8(o,e,t){let n=BA(o,e);return n.forceMessage=t?.forceMessage,n.forceSeverity=t?.forceSeverity,n.allowDialog=t?.allowDialog,n}var ur=Q("workingCopyHistoryService");function uS(o,e){let t=o;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}var Oe=window;function qk(o){return o===Oe?!1:typeof o?.vscodeWindowId=="number"}var fu=class o{static INSTANCE=new o;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new k;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,t){if(this.getZoomLevel(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(n,e),this._onDidChangeZoomLevel.fire(n)}mapWindowIdToZoomFactor=new Map;getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}_onDidChangeFullscreen=new k;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(e,t){if(this.isFullscreen(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToFullScreen.set(n,e),this._onDidChangeFullscreen.fire(n)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};function E8(o,e,t){typeof e=="string"&&(e=o.matchMedia(e)),e.addEventListener("change",t)}function FW(o){return fu.INSTANCE.getZoomLevel(o)}var FWe=fu.INSTANCE.onDidChangeZoomLevel;function BW(o){return fu.INSTANCE.getZoomFactor(o)}function WW(o,e){fu.INSTANCE.setFullscreen(o,e)}var BWe=fu.INSTANCE.onDidChangeFullscreen,Fh=navigator.userAgent,Vn=Fh.indexOf("Firefox")>=0,Hs=Fh.indexOf("AppleWebKit")>=0,Kd=Fh.indexOf("Chrome")>=0,Ko=!Kd&&Fh.indexOf("Safari")>=0,VW=!Kd&&!Ko&&Hs,WWe=Fh.indexOf("Electron/")>=0,$k=Fh.indexOf("Android")>=0,pS=!1;if(typeof Oe.matchMedia=="function"){let o=Oe.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Oe.matchMedia("(display-mode: fullscreen)");pS=o.matches,E8(Oe,o,({matches:t})=>{pS&&e.matches||(pS=t)})}function HW(){return pS}function T8(o){if(o.charCode){let t=String.fromCharCode(o.charCode).toUpperCase();return lb.fromString(t)}let e=o.keyCode;if(e===3)return 7;if(Vn)switch(e){case 59:return 85;case 60:if(Wt)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Fe)return 57;break}else if(Hs){if(Fe&&e===93)return 57;if(!Fe&&e===92)return 57}return Rk[e]||0}var w8=Fe?256:2048,x8=512,_8=1024,L8=Fe?2048:256;var gt=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(e){let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=T8(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=w8),this.altKey&&(t|=x8),this.shiftKey&&(t|=_8),this.metaKey&&(t|=L8),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new db(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}};var UW=new WeakMap;function D8(o){if(!o.parent||o.parent===o)return null;try{let e=o.location,t=o.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return o.parent}var hS=class{static getSameOriginWindowChain(e){let t=UW.get(e);if(!t){t=[],UW.set(e,t);let n=e,i;do i=D8(n),i?t.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):t.push({window:new WeakRef(n),iframeElement:null}),n=i;while(n)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let n=0,i=0,r=this.getSameOriginWindowChain(e);for(let s of r){let a=s.window.deref();if(n+=a?.scrollY??0,i+=a?.scrollX??0,a===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();n+=l.top,i+=l.left}return{top:n,left:i}}};var qi=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=hS.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Pr=class{browserEvent;deltaY;deltaX;target;constructor(e,t=0,n=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=n,this.deltaX=t;let i=!1;if(Kd){let r=navigator.userAgent.match(/Chrome\/(\d+)/);i=(r?parseInt(r[1]):123)<=122}if(e){let r=e,s=e,a=e.view?.devicePixelRatio||1;if(typeof r.wheelDeltaY<"u")i?this.deltaY=r.wheelDeltaY/(120*a):this.deltaY=r.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Vn&&!Fe?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof r.wheelDeltaX<"u")Ko&&pt?this.deltaX=-(r.wheelDeltaX/120):i?this.deltaX=r.wheelDeltaX/(120*a):this.deltaX=r.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Vn&&!Fe?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(i?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var mS={clipboard:{writeText:aa||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:aa||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:aa||HW()?0:navigator.keyboard||Ko?1:2,touch:"ontouchstart"in Oe||navigator.maxTouchPoints>0,pointerEvents:Oe.PointerEvent&&("ontouchstart"in Oe||navigator.maxTouchPoints>0)};var{entries:ZW,setPrototypeOf:zW,isFrozen:k8,getPrototypeOf:R8,getOwnPropertyDescriptor:M8}=Object,{freeze:Go,seal:zs,create:O8}=Object,{apply:e1,construct:t1}=typeof Reflect<"u"&&Reflect;e1||(e1=function(e,t,n){return e.apply(t,n)});Go||(Go=function(e){return e});zs||(zs=function(e){return e});t1||(t1=function(e,t){return new e(...t)});var N8=os(Array.prototype.forEach),KW=os(Array.prototype.pop),hb=os(Array.prototype.push),bS=os(String.prototype.toLowerCase),Yk=os(String.prototype.toString),A8=os(String.prototype.match),Us=os(String.prototype.replace),P8=os(String.prototype.indexOf),F8=os(String.prototype.trim),Fr=os(RegExp.prototype.test),mb=B8(TypeError);function os(o){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e1(o,e,n)}}function B8(o){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t1(o,t)}}function Et(o,e,t){var n;t=(n=t)!==null&&n!==void 0?n:bS,zW&&zW(o,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){let s=t(r);s!==r&&(k8(e)||(e[i]=s),r=s)}o[r]=!0}return o}function Bh(o){let e=O8(null);for(let[t,n]of ZW(o))e[t]=n;return e}function gS(o,e){for(;o!==null;){let n=M8(o,e);if(n){if(n.get)return os(n.get);if(typeof n.value=="function")return os(n.value)}o=R8(o)}function t(n){return console.warn("fallback value for",n),null}return t}var GW=Go(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Zk=Go(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qk=Go(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),W8=Go(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xk=Go(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),V8=Go(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),jW=Go(["#text"]),qW=Go(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Jk=Go(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$W=Go(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),fS=Go(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H8=zs(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U8=zs(/<%[\w\W]*|[\w\W]*%>/gm),z8=zs(/\${[\w\W]*}/gm),K8=zs(/^data-[\-\w.\u00B7-\uFFFF]/),G8=zs(/^aria-[\-\w]+$/),QW=zs(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),j8=zs(/^(?:\w+script|data):/i),q8=zs(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),XW=zs(/^html$/i),YW=Object.freeze({__proto__:null,MUSTACHE_EXPR:H8,ERB_EXPR:U8,TMPLIT_EXPR:z8,DATA_ATTR:K8,ARIA_ATTR:G8,IS_ALLOWED_URI:QW,IS_SCRIPT_OR_DATA:j8,ATTR_WHITESPACE:q8,DOCTYPE_NAME:XW}),$8=()=>typeof window>"u"?null:window,Y8=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));let r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function JW(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$8(),e=Ae=>JW(Ae);if(e.version="3.0.5",e.removed=[],!o||!o.document||o.document.nodeType!==9)return e.isSupported=!1,e;let t=o.document,n=t.currentScript,{document:i}=o,{DocumentFragment:r,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:u,DOMParser:p,trustedTypes:h}=o,f=l.prototype,g=gS(f,"cloneNode"),b=gS(f,"nextSibling"),v=gS(f,"childNodes"),I=gS(f,"parentNode");if(typeof s=="function"){let Ae=i.createElement("template");Ae.content&&Ae.content.ownerDocument&&(i=Ae.content.ownerDocument)}let T,S="",{implementation:C,createNodeIterator:w,createDocumentFragment:x,getElementsByTagName:D}=i,{importNode:O}=t,H={};e.isSupported=typeof ZW=="function"&&typeof I=="function"&&C&&C.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:K,ERB_EXPR:z,TMPLIT_EXPR:ie,DATA_ATTR:Se,ARIA_ATTR:J,IS_SCRIPT_OR_DATA:X,ATTR_WHITESPACE:le}=YW,{IS_ALLOWED_URI:re}=YW,ee=null,Te=Et({},[...GW,...Zk,...Qk,...Xk,...jW]),ce=null,Ze=Et({},[...qW,...Jk,...$W,...fS]),Ue=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_e=null,mn=null,an=!0,Pn=!0,oi=!1,hs=!0,At=!1,Ni=!1,Ec=!1,Jl=!1,Ai=!1,ed=!1,td=!1,hp=!0,mp=!1,Ve="user-content-",il=!0,nd=!1,ta={},Gr=null,yg=Et({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Tc=null,Ig=Et({},["audio","video","img","source","image","track"]),na=null,Cg=Et({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ia="http://www.w3.org/1998/Math/MathML",Ir="http://www.w3.org/2000/svg",Fn="http://www.w3.org/1999/xhtml",Cr=Fn,ol=!1,po=null,id=Et({},[ia,Ir,Fn],Yk),ms,oa=["application/xhtml+xml","text/html"],ve="text/html",ue,B=null,se=i.createElement("form"),fe=function(G){return G instanceof RegExp||G instanceof Function},tt=function(G){if(!(B&&B===G)){if((!G||typeof G!="object")&&(G={}),G=Bh(G),ms=oa.indexOf(G.PARSER_MEDIA_TYPE)===-1?ms=ve:ms=G.PARSER_MEDIA_TYPE,ue=ms==="application/xhtml+xml"?Yk:bS,ee="ALLOWED_TAGS"in G?Et({},G.ALLOWED_TAGS,ue):Te,ce="ALLOWED_ATTR"in G?Et({},G.ALLOWED_ATTR,ue):Ze,po="ALLOWED_NAMESPACES"in G?Et({},G.ALLOWED_NAMESPACES,Yk):id,na="ADD_URI_SAFE_ATTR"in G?Et(Bh(Cg),G.ADD_URI_SAFE_ATTR,ue):Cg,Tc="ADD_DATA_URI_TAGS"in G?Et(Bh(Ig),G.ADD_DATA_URI_TAGS,ue):Ig,Gr="FORBID_CONTENTS"in G?Et({},G.FORBID_CONTENTS,ue):yg,_e="FORBID_TAGS"in G?Et({},G.FORBID_TAGS,ue):{},mn="FORBID_ATTR"in G?Et({},G.FORBID_ATTR,ue):{},ta="USE_PROFILES"in G?G.USE_PROFILES:!1,an=G.ALLOW_ARIA_ATTR!==!1,Pn=G.ALLOW_DATA_ATTR!==!1,oi=G.ALLOW_UNKNOWN_PROTOCOLS||!1,hs=G.ALLOW_SELF_CLOSE_IN_ATTR!==!1,At=G.SAFE_FOR_TEMPLATES||!1,Ni=G.WHOLE_DOCUMENT||!1,Ai=G.RETURN_DOM||!1,ed=G.RETURN_DOM_FRAGMENT||!1,td=G.RETURN_TRUSTED_TYPE||!1,Jl=G.FORCE_BODY||!1,hp=G.SANITIZE_DOM!==!1,mp=G.SANITIZE_NAMED_PROPS||!1,il=G.KEEP_CONTENT!==!1,nd=G.IN_PLACE||!1,re=G.ALLOWED_URI_REGEXP||QW,Cr=G.NAMESPACE||Fn,Ue=G.CUSTOM_ELEMENT_HANDLING||{},G.CUSTOM_ELEMENT_HANDLING&&fe(G.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ue.tagNameCheck=G.CUSTOM_ELEMENT_HANDLING.tagNameCheck),G.CUSTOM_ELEMENT_HANDLING&&fe(G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ue.attributeNameCheck=G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),G.CUSTOM_ELEMENT_HANDLING&&typeof G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ue.allowCustomizedBuiltInElements=G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),At&&(Pn=!1),ed&&(Ai=!0),ta&&(ee=Et({},[...jW]),ce=[],ta.html===!0&&(Et(ee,GW),Et(ce,qW)),ta.svg===!0&&(Et(ee,Zk),Et(ce,Jk),Et(ce,fS)),ta.svgFilters===!0&&(Et(ee,Qk),Et(ce,Jk),Et(ce,fS)),ta.mathMl===!0&&(Et(ee,Xk),Et(ce,$W),Et(ce,fS))),G.ADD_TAGS&&(ee===Te&&(ee=Bh(ee)),Et(ee,G.ADD_TAGS,ue)),G.ADD_ATTR&&(ce===Ze&&(ce=Bh(ce)),Et(ce,G.ADD_ATTR,ue)),G.ADD_URI_SAFE_ATTR&&Et(na,G.ADD_URI_SAFE_ATTR,ue),G.FORBID_CONTENTS&&(Gr===yg&&(Gr=Bh(Gr)),Et(Gr,G.FORBID_CONTENTS,ue)),il&&(ee["#text"]=!0),Ni&&Et(ee,["html","head","body"]),ee.table&&(Et(ee,["tbody"]),delete _e.tbody),G.TRUSTED_TYPES_POLICY){if(typeof G.TRUSTED_TYPES_POLICY.createHTML!="function")throw mb('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof G.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw mb('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');T=G.TRUSTED_TYPES_POLICY,S=T.createHTML("")}else T===void 0&&(T=Y8(h,n)),T!==null&&typeof S=="string"&&(S=T.createHTML(""));Go&&Go(G),B=G}},kt=Et({},["mi","mo","mn","ms","mtext"]),ri=Et({},["foreignobject","desc","title","annotation-xml"]),Pi=Et({},["title","style","font","a","script"]),ze=Et({},Zk);Et(ze,Qk),Et(ze,W8);let L=Et({},Xk);Et(L,V8);let R=function(G){let Ie=I(G);(!Ie||!Ie.tagName)&&(Ie={namespaceURI:Cr,tagName:"template"});let Re=bS(G.tagName),$t=bS(Ie.tagName);return po[G.namespaceURI]?G.namespaceURI===Ir?Ie.namespaceURI===Fn?Re==="svg":Ie.namespaceURI===ia?Re==="svg"&&($t==="annotation-xml"||kt[$t]):!!ze[Re]:G.namespaceURI===ia?Ie.namespaceURI===Fn?Re==="math":Ie.namespaceURI===Ir?Re==="math"&&ri[$t]:!!L[Re]:G.namespaceURI===Fn?Ie.namespaceURI===Ir&&!ri[$t]||Ie.namespaceURI===ia&&!kt[$t]?!1:!L[Re]&&(Pi[Re]||!ze[Re]):!!(ms==="application/xhtml+xml"&&po[G.namespaceURI]):!1},N=function(G){hb(e.removed,{element:G});try{G.parentNode.removeChild(G)}catch{G.remove()}},W=function(G,Ie){try{hb(e.removed,{attribute:Ie.getAttributeNode(G),from:Ie})}catch{hb(e.removed,{attribute:null,from:Ie})}if(Ie.removeAttribute(G),G==="is"&&!ce[G])if(Ai||ed)try{N(Ie)}catch{}else try{Ie.setAttribute(G,"")}catch{}},U=function(G){let Ie,Re;if(Jl)G="<remove></remove>"+G;else{let ho=A8(G,/^[\r\n\t ]+/);Re=ho&&ho[0]}ms==="application/xhtml+xml"&&Cr===Fn&&(G='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+G+"</body></html>");let $t=T?T.createHTML(G):G;if(Cr===Fn)try{Ie=new p().parseFromString($t,ms)}catch{}if(!Ie||!Ie.documentElement){Ie=C.createDocument(Cr,"template",null);try{Ie.documentElement.innerHTML=ol?S:$t}catch{}}let zn=Ie.body||Ie.documentElement;return G&&Re&&zn.insertBefore(i.createTextNode(Re),zn.childNodes[0]||null),Cr===Fn?D.call(Ie,Ni?"html":"body")[0]:Ni?Ie.documentElement:zn},Z=function(G){return w.call(G.ownerDocument||G,G,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},oe=function(G){return G instanceof u&&(typeof G.nodeName!="string"||typeof G.textContent!="string"||typeof G.removeChild!="function"||!(G.attributes instanceof c)||typeof G.removeAttribute!="function"||typeof G.setAttribute!="function"||typeof G.namespaceURI!="string"||typeof G.insertBefore!="function"||typeof G.hasChildNodes!="function")},we=function(G){return typeof a=="object"?G instanceof a:G&&typeof G=="object"&&typeof G.nodeType=="number"&&typeof G.nodeName=="string"},Le=function(G,Ie,Re){H[G]&&N8(H[G],$t=>{$t.call(e,Ie,Re,B)})},it=function(G){let Ie;if(Le("beforeSanitizeElements",G,null),oe(G))return N(G),!0;let Re=ue(G.nodeName);if(Le("uponSanitizeElement",G,{tagName:Re,allowedTags:ee}),G.hasChildNodes()&&!we(G.firstElementChild)&&(!we(G.content)||!we(G.content.firstElementChild))&&Fr(/<[/\w]/g,G.innerHTML)&&Fr(/<[/\w]/g,G.textContent))return N(G),!0;if(!ee[Re]||_e[Re]){if(!_e[Re]&&nn(Re)&&(Ue.tagNameCheck instanceof RegExp&&Fr(Ue.tagNameCheck,Re)||Ue.tagNameCheck instanceof Function&&Ue.tagNameCheck(Re)))return!1;if(il&&!Gr[Re]){let $t=I(G)||G.parentNode,zn=v(G)||G.childNodes;if(zn&&$t){let ho=zn.length;for(let Dn=ho-1;Dn>=0;--Dn)$t.insertBefore(g(zn[Dn],!0),b(G))}}return N(G),!0}return G instanceof l&&!R(G)||(Re==="noscript"||Re==="noembed"||Re==="noframes")&&Fr(/<\/no(script|embed|frames)/i,G.innerHTML)?(N(G),!0):(At&&G.nodeType===3&&(Ie=G.textContent,Ie=Us(Ie,K," "),Ie=Us(Ie,z," "),Ie=Us(Ie,ie," "),G.textContent!==Ie&&(hb(e.removed,{element:G.cloneNode()}),G.textContent=Ie)),Le("afterSanitizeElements",G,null),!1)},xt=function(G,Ie,Re){if(hp&&(Ie==="id"||Ie==="name")&&(Re in i||Re in se))return!1;if(!(Pn&&!mn[Ie]&&Fr(Se,Ie))){if(!(an&&Fr(J,Ie))){if(!ce[Ie]||mn[Ie]){if(!(nn(G)&&(Ue.tagNameCheck instanceof RegExp&&Fr(Ue.tagNameCheck,G)||Ue.tagNameCheck instanceof Function&&Ue.tagNameCheck(G))&&(Ue.attributeNameCheck instanceof RegExp&&Fr(Ue.attributeNameCheck,Ie)||Ue.attributeNameCheck instanceof Function&&Ue.attributeNameCheck(Ie))||Ie==="is"&&Ue.allowCustomizedBuiltInElements&&(Ue.tagNameCheck instanceof RegExp&&Fr(Ue.tagNameCheck,Re)||Ue.tagNameCheck instanceof Function&&Ue.tagNameCheck(Re))))return!1}else if(!na[Ie]){if(!Fr(re,Us(Re,le,""))){if(!((Ie==="src"||Ie==="xlink:href"||Ie==="href")&&G!=="script"&&P8(Re,"data:")===0&&Tc[G])){if(!(oi&&!Fr(X,Us(Re,le,"")))){if(Re)return!1}}}}}}return!0},nn=function(G){return G.indexOf("-")>0},Bn=function(G){let Ie,Re,$t,zn;Le("beforeSanitizeAttributes",G,null);let{attributes:ho}=G;if(!ho)return;let Dn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ce};for(zn=ho.length;zn--;){Ie=ho[zn];let{name:ra,namespaceURI:S_}=Ie;if(Re=ra==="value"?Ie.value:F8(Ie.value),$t=ue(ra),Dn.attrName=$t,Dn.attrValue=Re,Dn.keepAttr=!0,Dn.forceKeepAttr=void 0,Le("uponSanitizeAttribute",G,Dn),Re=Dn.attrValue,Dn.forceKeepAttr||(W(ra,G),!Dn.keepAttr))continue;if(!hs&&Fr(/\/>/i,Re)){W(ra,G);continue}At&&(Re=Us(Re,K," "),Re=Us(Re,z," "),Re=Us(Re,ie," "));let CN=ue(G.nodeName);if(xt(CN,$t,Re)){if(mp&&($t==="id"||$t==="name")&&(W(ra,G),Re=Ve+Re),T&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!S_)switch(h.getAttributeType(CN,$t)){case"TrustedHTML":{Re=T.createHTML(Re);break}case"TrustedScriptURL":{Re=T.createScriptURL(Re);break}}try{S_?G.setAttributeNS(S_,ra,Re):G.setAttribute(ra,Re),KW(e.removed)}catch{}}}Le("afterSanitizeAttributes",G,null)},cn=function Ae(G){let Ie,Re=Z(G);for(Le("beforeSanitizeShadowDOM",G,null);Ie=Re.nextNode();)Le("uponSanitizeShadowNode",Ie,null),!it(Ie)&&(Ie.content instanceof r&&Ae(Ie.content),Bn(Ie));Le("afterSanitizeShadowDOM",G,null)};return e.sanitize=function(Ae){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ie,Re,$t,zn;if(ol=!Ae,ol&&(Ae="<!-->"),typeof Ae!="string"&&!we(Ae))if(typeof Ae.toString=="function"){if(Ae=Ae.toString(),typeof Ae!="string")throw mb("dirty is not a string, aborting")}else throw mb("toString is not a function");if(!e.isSupported)return Ae;if(Ec||tt(G),e.removed=[],typeof Ae=="string"&&(nd=!1),nd){if(Ae.nodeName){let ra=ue(Ae.nodeName);if(!ee[ra]||_e[ra])throw mb("root node is forbidden and cannot be sanitized in-place")}}else if(Ae instanceof a)Ie=U("<!---->"),Re=Ie.ownerDocument.importNode(Ae,!0),Re.nodeType===1&&Re.nodeName==="BODY"||Re.nodeName==="HTML"?Ie=Re:Ie.appendChild(Re);else{if(!Ai&&!At&&!Ni&&Ae.indexOf("<")===-1)return T&&td?T.createHTML(Ae):Ae;if(Ie=U(Ae),!Ie)return Ai?null:td?S:""}Ie&&Jl&&N(Ie.firstChild);let ho=Z(nd?Ae:Ie);for(;$t=ho.nextNode();)it($t)||($t.content instanceof r&&cn($t.content),Bn($t));if(nd)return Ae;if(Ai){if(ed)for(zn=x.call(Ie.ownerDocument);Ie.firstChild;)zn.appendChild(Ie.firstChild);else zn=Ie;return(ce.shadowroot||ce.shadowrootmode)&&(zn=O.call(t,zn,!0)),zn}let Dn=Ni?Ie.outerHTML:Ie.innerHTML;return Ni&&ee["!doctype"]&&Ie.ownerDocument&&Ie.ownerDocument.doctype&&Ie.ownerDocument.doctype.name&&Fr(XW,Ie.ownerDocument.doctype.name)&&(Dn="<!DOCTYPE "+Ie.ownerDocument.doctype.name+`>
`+Dn),At&&(Dn=Us(Dn,K," "),Dn=Us(Dn,z," "),Dn=Us(Dn,ie," ")),T&&td?T.createHTML(Dn):Dn},e.setConfig=function(Ae){tt(Ae),Ec=!0},e.clearConfig=function(){B=null,Ec=!1},e.isValidAttribute=function(Ae,G,Ie){B||tt({});let Re=ue(Ae),$t=ue(G);return xt(Re,$t,Ie)},e.addHook=function(Ae,G){typeof G=="function"&&(H[Ae]=H[Ae]||[],hb(H[Ae],G))},e.removeHook=function(Ae){if(H[Ae])return KW(H[Ae])},e.removeHooks=function(Ae){H[Ae]&&(H[Ae]=[])},e.removeAllHooks=function(){H={}},e}var Aa=JW();var $We=Aa.version,YWe=Aa.isSupported,vS=Aa.sanitize,ZWe=Aa.setConfig,QWe=Aa.clearConfig,XWe=Aa.isValidAttribute,yS=Aa.addHook,IS=Aa.removeHook,JWe=Aa.removeHooks,eVe=Aa.removeAllHooks;function Di(o,e,t){return Math.min(Math.max(o,e),t)}var{registerWindow:oV,getWindow:Ce,getDocument:IVe,getWindows:fb,getWindowsCount:SS,getWindowId:jd,getWindowById:vu,hasWindow:CVe,onDidRegisterWindow:o1,onWillUnregisterWindow:SVe,onDidUnregisterWindow:rV}=function(){let o=new Map;uS(Oe,1);let e={window:Oe,disposables:new ne};o.set(Oe.vscodeWindowId,e);let t=new k,n=new k,i=new k;function r(s,a){return(typeof s=="number"?o.get(s):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:i.event,onDidUnregisterWindow:n.event,registerWindow(s){if(o.has(s.vscodeWindowId))return F.None;let a=new ne,l={window:s,disposables:a.add(new ne)};return o.set(s.vscodeWindowId,l),a.add(pe(()=>{o.delete(s.vscodeWindowId),n.fire(s)})),a.add(q(s,he.BEFORE_UNLOAD,()=>{i.fire(s)})),t.fire(l),a},getWindows(){return o.values()},getWindowsCount(){return o.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return o.has(s)},getWindowById:r,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:Oe},getDocument(s){return Ce(s).document}}}();function fi(o){for(;o.firstChild;)o.firstChild.remove()}var n1=class{_handler;_node;_type;_options;constructor(e,t,n,i){this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function q(o,e,t,n){return new n1(o,e,t,n)}function Z8(o,e){return function(t){return e(new qi(o,t))}}function Q8(o){return function(e){return o(new gt(e))}}var hn=function(e,t,n,i){let r=n;return t==="click"||t==="mousedown"||t==="contextmenu"?r=Z8(Ce(e),n):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=Q8(n)),q(e,t,r,i)};function bb(o,e,t){return jp(o,e,t)}var r1,Xn;var Wh=class extends uI{defaultTarget;constructor(e){super(),this.defaultTarget=e&&Ce(e)}cancelAndSet(e,t,n){return super.cancelAndSet(e,t,n??this.defaultTarget)}},gb=class{_runner;priority;_canceled;constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){je(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let o=new Map,e=new Map,t=new Map,n=new Map,i=r=>{t.set(r,!1);let s=o.get(r)??[];for(e.set(r,s),o.set(r,[]),n.set(r,!0);s.length>0;)s.sort(gb.sort),s.shift().execute();n.set(r,!1)};Xn=(r,s,a=0)=>{let l=jd(r),d=new gb(s,a),c=o.get(l);return c||(c=[],o.set(l,c)),c.push(d),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>i(l))),d},r1=(r,s,a)=>{let l=jd(r);if(n.get(l)){let d=new gb(s,a),c=e.get(l);return c||(c=[],e.set(l,c)),c.push(d),d}else return Xn(r,s,a)}})();function sV(o){return Ce(o).getComputedStyle(o,null)}function yu(o,e){let t=Ce(o),n=t.document;if(o!==n.body)return new oo(o.clientWidth,o.clientHeight);if(qr&&t?.visualViewport)return new oo(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new oo(t.innerWidth,t.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new oo(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new oo(n.documentElement.clientWidth,n.documentElement.clientHeight);if(e)return yu(e);throw new Error("Unable to figure out browser width and height")}var wo=class o{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,n){let i=sV(e),r=i?i.getPropertyValue(t):"0";return o.convertToPixels(e,r)}static getBorderLeftWidth(e){return o.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return o.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return o.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return o.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return o.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return o.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return o.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return o.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return o.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return o.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return o.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return o.getDimension(e,"margin-bottom","marginBottom")}},oo=class o{constructor(e,t){this.width=e;this.height=t}static None=new o(0,0);with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new o(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof o?e:new o(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};function vb(o){let e=o.offsetParent,t=o.offsetTop,n=o.offsetLeft;for(;(o=o.parentNode)!==null&&o!==o.ownerDocument.body&&o!==o.ownerDocument.documentElement;){t-=o.scrollTop;let i=lV(o)?null:sV(o);i&&(n-=i.direction!=="rtl"?o.scrollLeft:-o.scrollLeft),o===e&&(n+=wo.getBorderLeftWidth(o),t+=wo.getBorderTopWidth(o),t+=o.offsetTop,n+=o.offsetLeft,e=o.offsetParent)}return{left:n,top:t}}function aV(o,e,t,n,i,r="absolute"){typeof e=="number"&&(o.style.top=`${e}px`),typeof t=="number"&&(o.style.right=`${t}px`),typeof n=="number"&&(o.style.bottom=`${n}px`),typeof i=="number"&&(o.style.left=`${i}px`),o.style.position=r}function ro(o){let e=o.getBoundingClientRect(),t=Ce(o);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function Hh(o){let e=wo.getMarginLeft(o)+wo.getMarginRight(o);return o.offsetWidth+e}function Uh(o){let e=wo.getBorderLeftWidth(o)+wo.getBorderRightWidth(o),t=wo.getPaddingLeft(o)+wo.getPaddingRight(o);return o.offsetWidth-e-t}function ES(o){let e=wo.getBorderTopWidth(o)+wo.getBorderBottomWidth(o),t=wo.getPaddingTop(o)+wo.getPaddingBottom(o);return o.offsetHeight-e-t}function TS(o){let e=wo.getMarginTop(o)+wo.getMarginBottom(o);return o.offsetHeight+e}function rs(o,e){return!!e?.contains(o)}function X8(o,e,t){for(;o&&o.nodeType===o.ELEMENT_NODE;){if(o.classList.contains(e))return o;if(t){if(typeof t=="string"){if(o.classList.contains(t))return null}else if(o===t)return null}o=o.parentNode}return null}function wS(o,e,t){return!!X8(o,e,t)}function lV(o){return o&&!!o.host&&!!o.mode}function qd(o){for(;o.parentNode;){if(o===o.ownerDocument?.body)return null;o=o.parentNode}return lV(o)?o:null}function xo(){let o=s1().activeElement;for(;o?.shadowRoot;)o=o.shadowRoot.activeElement;return o}function Br(o){return xo()===o}function s1(){return SS()<=1?Oe.document:Array.from(fb()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Oe.document}function $d(){return s1().defaultView?.window??Oe}var a1=new Map;function dV(o){return a1.has(o)}function pr(o=Oe.document.head,e,t){let n=document.createElement("style");if(n.type="text/css",n.media="screen",e?.(n),o.appendChild(n),t&&t.add(pe(()=>n.remove())),o===Oe.document.head){let i=new Set;a1.set(n,i);for(let{window:r,disposables:s}of fb()){if(r===Oe)continue;let a=s.add(uV(n,i,r));t?.add(a)}}return n}function cV(o){let e=new ne;for(let[t,n]of a1)e.add(uV(t,n,o));return e}function uV(o,e,t){let n=new ne,i=o.cloneNode(!0);t.document.head.appendChild(i),n.add(pe(()=>i.remove()));for(let r of J8(o))i.sheet?.insertRule(r.cssText,i.sheet?.cssRules.length);return n.add(xS.observe(o,n,{childList:!0})(()=>{i.textContent=o.textContent})),e.add(i),n.add(pe(()=>e.delete(i))),n}var xS=new class{mutationObservers=new Map;observe(o,e,t){let n=this.mutationObservers.get(o);n||(n=new Map,this.mutationObservers.set(o,n));let i=is(t),r=n.get(i);if(r)r.users+=1;else{let s=new k,a=new MutationObserver(d=>s.fire(d));a.observe(o,t);let l=r={users:1,observer:a,onDidMutate:s.event};e.add(pe(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),n?.delete(i),n?.size===0&&this.mutationObservers.delete(o))})),n.set(i,r)}return r.onDidMutate}};function pV(o=Oe.document.head){return mV("meta",o)}function hV(o=Oe.document.head){return mV("link",o)}function mV(o,e=Oe.document.head){let t=document.createElement(o);return e.appendChild(t),t}function J8(o){return o?.sheet?.rules?o.sheet.rules:o?.sheet?.cssRules?o.sheet.cssRules:[]}function On(o){return o instanceof HTMLElement||o instanceof Ce(o).HTMLElement}function gV(o){return o instanceof SVGElement||o instanceof Ce(o).SVGElement}function _S(o){return o instanceof MouseEvent||o instanceof Ce(o).MouseEvent}function ss(o){return o instanceof KeyboardEvent||o instanceof Ce(o).KeyboardEvent}var he={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Hs?"webkitAnimationStart":"animationstart",ANIMATION_END:Hs?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Hs?"webkitAnimationIteration":"animationiteration"};var rt={stop:(o,e)=>(o.preventDefault(),e&&o.stopPropagation(),o)};function fV(o){let e=[];for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)e[t]=o.scrollTop,o=o.parentNode;return e}function bV(o,e){for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)o.scrollTop!==e[t]&&(o.scrollTop=e[t]),o=o.parentNode}var i1=class o extends F{_onDidFocus=this._register(new k);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new k);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(e){if(On(e)){let t=qd(e),n=t?t.activeElement:e.ownerDocument.activeElement;return rs(n,e)}else{let t=e;return rs(t.document.activeElement,t.document)}}constructor(e){super();let t=o.hasFocusWithin(e),n=!1,i=()=>{n=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(n=!0,(On(e)?Ce(e):e).setTimeout(()=>{n&&(n=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{o.hasFocusWithin(e)!==t&&(t?r():i())},this._register(q(e,he.FOCUS,i,!0)),this._register(q(e,he.BLUR,r,!0)),On(e)&&(this._register(q(e,he.FOCUS_IN,()=>this._refreshStateHandler())),this._register(q(e,he.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function Ol(o){return new i1(o)}function dt(o,...e){if(o.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function l1(o,e){return o.insertBefore(e,o.firstChild),e}function Wr(o,...e){o.innerText="",dt(o,...e)}var e3=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function vV(o,e,t,...n){let i=e3.exec(e);if(!i)throw new Error("Bad use of emmet");let r=i[1]||"div",s;return o!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(o,r):s=document.createElement(r),i[3]&&(s.id=i[3]),i[4]&&(s.className=i[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...n),s}function Ke(o,e,...t){return vV("http://www.w3.org/1999/xhtml",o,e,...t)}Ke.SVG=function(o,e,...t){return vV("http://www.w3.org/2000/svg",o,e,...t)};function d1(o,e){let t=o.devicePixelRatio*e;return Math.max(1,Math.floor(t))/o.devicePixelRatio}function c1(o){Oe.open(o,"_blank","noopener")}var tV=780,nV=640;function u1(o){let e=Math.floor(Oe.screenLeft+Oe.innerWidth/2-tV/2),t=Math.floor(Oe.screenTop+Oe.innerHeight/2-nV/2);Oe.open(o,"_blank",`width=${tV},height=${nV},top=${t},left=${e}`)}function yV(o,e=!0){let t=Oe.open();return t?(e&&(t.opener=null),t.location.href=o,!0):!1}function IV(o,e){let t=()=>{e(),n=Xn(o,t)},n=Xn(o,t);return pe(()=>n.dispose())}ky.setPreferredWebSchema(/^https:/.test(Oe.location.href)?"https":"http");function yb(o){return o?`url('${ha.uriToBrowserUri(o).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function Vr(o,e){if(o!==void 0){let t=o.match(/^\s*var\((.+)\)$/);if(t){let n=t[1].split(",",2);return n.length===2&&(e=Vr(n[1].trim(),e)),`var(${n[0]}, ${e})`}return o}return e}function CV(o,e=!1){let t=document.createElement("a");return yS("afterSanitizeAttributes",n=>{for(let i of["href","src"])if(n.hasAttribute(i)){let r=n.getAttribute(i);if(i==="href"&&r.startsWith("#"))continue;if(t.href=r,!o.includes(t.protocol.replace(/:$/,""))){if(e&&i==="src"&&t.href.startsWith("data:"))continue;n.removeAttribute(i)}}}),pe(()=>{IS("afterSanitizeAttributes")})}var EVe=[xe.http,xe.https,xe.command],SV=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),TVe=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});function t3(o){let e=new Uint16Array(o.length);for(let i=0;i<e.length;i++)e[i]=o.charCodeAt(i);let t="",n=new Uint8Array(e.buffer);for(let i=0;i<n.length;i++)t+=String.fromCharCode(n[i]);return t}function zh(o){return btoa(t3(o))}var Vh=class o extends k{_subscriptions=new ne;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(j.runAndSubscribe(o1,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Oe,disposables:this._subscriptions}))}registerListeners(e,t){t.add(q(e,"keydown",n=>{if(n.defaultPrevented)return;let i=new gt(n);if(!(i.keyCode===6&&n.repeat)){if(n.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(n.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(n.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(n.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(i.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=n,this.fire(this._keyStatus))}},!0)),t.add(q(e,"keyup",n=>{n.defaultPrevented||(!n.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!n.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!n.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!n.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=n,this.fire(this._keyStatus)))},!0)),t.add(q(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(q(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(q(e.document.body,"mousemove",n=>{n.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(q(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return o.instance||(o.instance=new o),o.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var CS=class extends F{constructor(t,n){super();this.element=t;this.callbacks=n;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(q(this.element,he.DRAG_START,t=>{this.callbacks.onDragStart?.(t)})),this.callbacks.onDrag&&this._register(q(this.element,he.DRAG,t=>{this.callbacks.onDrag?.(t)})),this._register(q(this.element,he.DRAG_ENTER,t=>{this.counter++,this.dragStartTime=t.timeStamp,this.callbacks.onDragEnter?.(t)})),this._register(q(this.element,he.DRAG_OVER,t=>{t.preventDefault(),this.callbacks.onDragOver?.(t,t.timeStamp-this.dragStartTime)})),this._register(q(this.element,he.DRAG_LEAVE,t=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(t))})),this._register(q(this.element,he.DRAG_END,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(t)})),this._register(q(this.element,he.DROP,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(t)}))}},n3=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function vt(o,...e){let t,n;Array.isArray(e[0])?(t={},n=e[0]):(t=e[0]||{},n=e[1]);let i=n3.exec(o);if(!i||!i.groups)throw new Error("Bad use of h");let r=i.groups.tag||"div",s=document.createElement(r);i.groups.id&&(s.id=i.groups.id);let a=[];if(i.groups.class)for(let d of i.groups.class.split("."))d!==""&&a.push(d);if(t.className!==void 0)for(let d of t.className.split("."))d!==""&&a.push(d);a.length>0&&(s.className=a.join(" "));let l={};if(i.groups.name&&(l[i.groups.name]=s),n)for(let d of n)On(d)?s.appendChild(d):typeof d=="string"?s.append(d):"root"in d&&(Object.assign(l,d),s.appendChild(d.root));for(let[d,c]of Object.entries(t))if(d!=="className")if(d==="style")for(let[u,p]of Object.entries(c))s.style.setProperty(iV(u),typeof p=="number"?p+"px":""+p);else d==="tabIndex"?s.tabIndex=c:s.setAttribute(iV(d),c.toString());return l.root=s,l}function iV(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function LS(o,e,t){for(let{name:n,value:i}of o.attributes)(!t||t.includes(n))&&e.setAttribute(n,i)}function i3(o,e,t){let n=o.getAttribute(t);n?e.setAttribute(t,n):e.removeAttribute(t)}function DS(o,e,t){LS(o,e,t);let n=new ne;return n.add(xS.observe(o,n,{attributes:!0,attributeFilter:t})(i=>{for(let r of i)r.type==="attributes"&&r.attributeName&&i3(o,e,r.attributeName)})),n}function as(o){return o.tagName.toLowerCase()==="input"||o.tagName.toLowerCase()==="textarea"||On(o)&&!!o.editContext}function me(o,e,t){let n=null,i=null;if(typeof t.value=="function"?(n="value",i=t.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(n="get",i=t.get),!i)throw new Error("not supported");let r=`$memoize$${e}`;t[n]=function(...s){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,s)}),this[r]}}var wt;(r=>(r.Tap="-monaco-gesturetap",r.Change="-monaco-gesturechange",r.Start="-monaco-gesturestart",r.End="-monaco-gesturesend",r.Contextmenu="-monaco-gesturecontextmenu"))(wt||={});var $i=class $i extends F{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new Vi;ignoreTargets=new Vi;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(j.runAndSubscribe(o1,({window:e,disposables:t})=>{t.add(q(e.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),t.add(q(e.document,"touchend",n=>this.onTouchEnd(e,n))),t.add(q(e.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:Oe,disposables:this._store}))}static addTarget(e){if(!$i.isTouchDevice())return F.None;$i.INSTANCE||($i.INSTANCE=dd(new $i));let t=$i.INSTANCE.targets.push(e);return pe(t)}static ignoreTarget(e){if(!$i.isTouchDevice())return F.None;$i.INSTANCE||($i.INSTANCE=dd(new $i));let t=$i.INSTANCE.ignoreTargets.push(e);return pe(t)}static isTouchDevice(){return"ontouchstart"in Oe||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,i=e.targetTouches.length;n<i;n++){let r=e.targetTouches.item(n);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};let s=this.newGestureEvent(wt.Start,r.target);s.pageX=r.pageX,s.pageY=r.pageY,this.dispatchEvent(s)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){let n=Date.now(),i=Object.keys(this.activeTouches).length;for(let r=0,s=t.changedTouches.length;r<s;r++){let a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<$i.HOLD_DELAY&&Math.abs(l.initialPageX-ko(l.rollingPageX))<30&&Math.abs(l.initialPageY-ko(l.rollingPageY))<30){let c=this.newGestureEvent(wt.Tap,l.initialTarget);c.pageX=ko(l.rollingPageX),c.pageY=ko(l.rollingPageY),this.dispatchEvent(c)}else if(d>=$i.HOLD_DELAY&&Math.abs(l.initialPageX-ko(l.rollingPageX))<30&&Math.abs(l.initialPageY-ko(l.rollingPageY))<30){let c=this.newGestureEvent(wt.Contextmenu,l.initialTarget);c.pageX=ko(l.rollingPageX),c.pageY=ko(l.rollingPageY),this.dispatchEvent(c)}else if(i===1){let c=ko(l.rollingPageX),u=ko(l.rollingPageY),p=ko(l.rollingTimestamps)-l.rollingTimestamps[0],h=c-l.rollingPageX[0],f=u-l.rollingPageY[0],g=[...this.targets].filter(b=>l.initialTarget instanceof Node&&b.contains(l.initialTarget));this.inertia(e,g,n,Math.abs(h)/p,h>0?1:-1,c,Math.abs(f)/p,f>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(wt.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let n=document.createEvent("CustomEvent");return n.initEvent(e,!1,!0),n.initialTarget=t,n.tapCount=0,n}dispatchEvent(e){if(e.type===wt.Tap){let t=new Date().getTime(),n=0;t-this._lastSetTapCountTime>$i.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=t,e.tapCount=n}else(e.type===wt.Change||e.type===wt.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(e.initialTarget))return;let t=[];for(let n of this.targets)if(n.contains(e.initialTarget)){let i=0,r=e.initialTarget;for(;r&&r!==n;)i++,r=r.parentElement;t.push([i,n])}t.sort((n,i)=>n[0]-i[0]);for(let[n,i]of t)i.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,n,i,r,s,a,l,d){this.handle=Xn(e,()=>{let c=Date.now(),u=c-n,p=0,h=0,f=!0;i+=$i.SCROLL_FRICTION*u,a+=$i.SCROLL_FRICTION*u,i>0&&(f=!1,p=r*i*u),a>0&&(f=!1,h=l*a*u);let g=this.newGestureEvent(wt.Change);g.translationX=p,g.translationY=h,t.forEach(b=>b.dispatchEvent(g)),f||this.inertia(e,t,c,i,r,s+p,a,l,d+h)})}onTouchMove(e){let t=Date.now();for(let n=0,i=e.changedTouches.length;n<i;n++){let r=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}let s=this.activeTouches[r.identifier],a=this.newGestureEvent(wt.Change,s.initialTarget);a.translationX=r.pageX-ko(s.rollingPageX),a.translationY=r.pageY-ko(s.rollingPageY),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(r.pageX),s.rollingPageY.push(r.pageY),s.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};P([me],$i,"isTouchDevice",1);var Nn=$i;var Ne=class{emitter;get event(){return this.emitter.event}constructor(e,t,n){let i=r=>this.emitter.fire(r);this.emitter=new k({onWillAddFirstListener:()=>e.addEventListener(t,i,n),onDidRemoveLastListener:()=>e.removeEventListener(t,i,n)})}dispose(){this.emitter.dispose()}};var o3=!1;var r3=4,s3=new k;var a3=300,l3=new k;var Ib=class{constructor(e){this.el=e}disposables=new ne;get onPointerMove(){return this.disposables.add(new Ne(Ce(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Ne(Ce(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};P([me],Ib.prototype,"onPointerMove",1),P([me],Ib.prototype,"onPointerUp",1);var Cb=class{constructor(e){this.el=e}disposables=new ne;get onPointerMove(){return this.disposables.add(new Ne(this.el,wt.Change)).event}get onPointerUp(){return this.disposables.add(new Ne(this.el,wt.End)).event}dispose(){this.disposables.dispose()}};P([me],Cb.prototype,"onPointerMove",1),P([me],Cb.prototype,"onPointerUp",1);var Kh=class{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};P([me],Kh.prototype,"onPointerMove",1),P([me],Kh.prototype,"onPointerUp",1);var EV="pointer-events-disabled",Iu=class o extends F{el;layoutProvider;orientation;size;hoverDelay=a3;hoverDelayer=this._register(new _s(this.hoverDelay));_state=3;onDidEnablementChange=this._register(new k);_onDidStart=this._register(new k);_onDidChange=this._register(new k);_onDidReset=this._register(new k);_onDidEnd=this._register(new k);orthogonalStartSashDisposables=this._register(new ne);_orthogonalStartSash;orthogonalStartDragHandleDisposables=this._register(new ne);_orthogonalStartDragHandle;orthogonalEndSashDisposables=this._register(new ne);_orthogonalEndSash;orthogonalEndDragHandleDisposables=this._register(new ne);_orthogonalEndDragHandle;get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}onDidStart=this._onDidStart.event;onDidChange=this._onDidChange.event;onDidReset=this._onDidReset.event;onDidEnd=this._onDidEnd.event;linkedSash=void 0;set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){let t=n=>{this.orthogonalStartDragHandleDisposables.clear(),n!==0&&(this._orthogonalStartDragHandle=dt(this.el,Ke(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(pe(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new Ne(this._orthogonalStartDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new Ne(this._orthogonalStartDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){let t=n=>{this.orthogonalEndDragHandleDisposables.clear(),n!==0&&(this._orthogonalEndDragHandle=dt(this.el,Ke(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(pe(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new Ne(this._orthogonalEndDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new Ne(this._orthogonalEndDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,n){super(),this.el=dt(e,Ke(".monaco-sash")),n.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${n.orthogonalEdge}`),Fe&&this.el.classList.add("mac");let i=this._register(new Ne(this.el,"mousedown")).event;this._register(i(u=>this.onPointerStart(u,new Ib(e)),this));let r=this._register(new Ne(this.el,"dblclick")).event;this._register(r(this.onPointerDoublePress,this));let s=this._register(new Ne(this.el,"mouseenter")).event;this._register(s(()=>o.onMouseEnter(this)));let a=this._register(new Ne(this.el,"mouseleave")).event;this._register(a(()=>o.onMouseLeave(this))),this._register(Nn.addTarget(this.el));let l=this._register(new Ne(this.el,wt.Start)).event;this._register(l(u=>this.onPointerStart(u,new Cb(this.el)),this));let d=this._register(new Ne(this.el,wt.Tap)).event,c;this._register(d(u=>{if(c){clearTimeout(c),c=void 0,this.onPointerDoublePress(u);return}clearTimeout(c),c=setTimeout(()=>c=void 0,250)},this)),typeof n.size=="number"?(this.size=n.size,n.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=r3,this._register(s3.event(u=>{this.size=u,this.layout()}))),this._register(l3.event(u=>this.hoverDelay=u)),this.layoutProvider=t,this.orthogonalStartSash=n.orthogonalStartSash,this.orthogonalEndSash=n.orthogonalEndSash,this.orientation=n.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",o3),this.layout()}onPointerStart(e,t){rt.stop(e);let n=!1;if(!e.__orthogonalSashEvent){let f=this.getOrthogonalSash(e);f&&(n=!0,e.__orthogonalSashEvent=!0,f.onPointerStart(e,new Kh(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new Kh(t))),!this.state)return;let i=this.el.ownerDocument.getElementsByTagName("iframe");for(let f of i)f.classList.add(EV);let r=e.pageX,s=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:s,currentY:s,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);let d=pr(this.el),c=()=>{let f="";n?f="all-scroll":this.orientation===1?this.state===1?f="s-resize":this.state===2?f="n-resize":f=Fe?"row-resize":"ns-resize":this.state===1?f="e-resize":this.state===2?f="w-resize":f=Fe?"col-resize":"ew-resize",d.textContent=`* { cursor: ${f} !important; }`},u=new ne;c(),n||this.onDidEnablementChange.event(c,null,u);let p=f=>{rt.stop(f,!1);let g={startX:r,currentX:f.pageX,startY:s,currentY:f.pageY,altKey:a};this._onDidChange.fire(g)},h=f=>{rt.stop(f,!1),d.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(let g of i)g.classList.remove(EV)};t.onPointerMove(p,null,u),t.onPointerUp(h,null,u),u.add(t)}onPointerDoublePress(e){let t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&o.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&o.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){o.onMouseLeave(this)}layout(){if(this.orientation===0){let e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{let e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){let t=e.initialTarget??e.target;if(!(!t||!On(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}};var Gh=class extends F{_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(e,t){super(),this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null,t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()},n=!1,i=!1,r=()=>{if(n&&!i)try{n=!1,i=!0,t()}finally{Xn(Ce(this._referenceDomElement),()=>{i=!1,r()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?e={width:s[0].contentRect.width,height:s[0].contentRect.height}:e=null,n=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let n=0,i=0;t?(n=t.width,i=t.height):this._referenceDomElement&&(n=this._referenceDomElement.clientWidth,i=this._referenceDomElement.clientHeight),n=Math.max(5,n),i=Math.max(5,i),(this._width!==n||this._height!==i)&&(this._width=n,this._height=i,e&&this._onDidChange.fire())}};var p1=class extends F{_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(e){super(),this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}},h1=class extends F{_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(e){super(),this._value=this._getPixelRatio(e);let t=this._register(new p1(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){let t=document.createElement("canvas").getContext("2d"),n=e.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i}},m1=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(e){let t=jd(e),n=this.mapWindowIdToPixelRatioMonitor.get(t);return n||(n=dd(new h1(e)),this.mapWindowIdToPixelRatioMonitor.set(t,n),dd(j.once(rV)(({vscodeWindowId:i})=>{i===t&&(n?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))}))),n}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}},jh=new m1;var Cu=class{constructor(e){this.domNode=e}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(e){let t=hr(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=hr(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=hr(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=hr(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=hr(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=hr(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=hr(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=hr(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=hr(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=hr(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=hr(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=hr(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=hr(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=hr(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function hr(o){return typeof o=="number"?`${o}px`:o}function We(o){return new Cu(o)}function tn(o,e){o instanceof Cu?(o.setFontFamily(e.getMassagedFontFamily()),o.setFontWeight(e.fontWeight),o.setFontSize(e.fontSize),o.setFontFeatureSettings(e.fontFeatureSettings),o.setFontVariationSettings(e.fontVariationSettings),o.setLineHeight(e.lineHeight),o.setLetterSpacing(e.letterSpacing)):(o.style.fontFamily=e.getMassagedFontFamily(),o.style.fontWeight=e.fontWeight,o.style.fontSize=e.fontSize+"px",o.style.fontFeatureSettings=e.fontFeatureSettings,o.style.fontVariationSettings=e.fontVariationSettings,o.style.lineHeight=e.lineHeight+"px",o.style.letterSpacing=e.letterSpacing+"px")}var kS=class{chr;type;width;constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}},g1=class o{_bareFontInfo;_requests;_container;_testElements;constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";let t=document.createElement("div");tn(t,this._bareFontInfo),e.appendChild(t);let n=document.createElement("div");tn(n,this._bareFontInfo),n.style.fontWeight="bold",e.appendChild(n);let i=document.createElement("div");tn(i,this._bareFontInfo),i.style.fontStyle="italic",e.appendChild(i);let r=[];for(let s of this._requests){let a;s.type===0&&(a=t),s.type===2&&(a=n),s.type===1&&(a=i),a.appendChild(document.createElement("br"));let l=document.createElement("span");o._render(l,s),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let n="\xA0";for(let i=0;i<8;i++)n+=n;e.innerText=n}else{let n=t.chr;for(let i=0;i<8;i++)n+=n;e.textContent=n}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){let n=this._requests[e],i=this._testElements[e];n.fulfill(i.offsetWidth/256)}}};function TV(o,e,t){new g1(e,t).read(o)}var f1=class extends F{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){let t=jd(e),n=this._cache.get(t);return n||(n=new b1,this._cache.set(t,n)),n}_writeToCache(e,t,n){this._ensureCache(e).put(t,n),!n.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){let t=this._ensureCache(e),n=t.getValues(),i=!1;for(let r of n)r.isTrusted||(i=!0,t.remove(r));i&&this._onDidChange.fire()}serializeFontInfo(e){return this._ensureCache(e).getValues().filter(n=>n.isTrusted)}restoreFontInfo(e,t){for(let n of t){if(n.version!==ML)continue;let i=new Fp(n,!1);this._writeToCache(e,i,i)}}readFontInfo(e,t){let n=this._ensureCache(e);if(!n.has(t)){let i=this._actualReadFontInfo(e,t);(i.typicalHalfwidthCharacterWidth<=2||i.typicalFullwidthCharacterWidth<=2||i.spaceWidth<=2||i.maxDigitWidth<=2)&&(i=new Fp({pixelRatio:jh.getInstance(e).value,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFeatureSettings:i.fontFeatureSettings,fontVariationSettings:i.fontVariationSettings,lineHeight:i.lineHeight,letterSpacing:i.letterSpacing,isMonospace:i.isMonospace,typicalHalfwidthCharacterWidth:Math.max(i.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(i.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:i.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(i.spaceWidth,5),middotWidth:Math.max(i.middotWidth,5),wsmiddotWidth:Math.max(i.wsmiddotWidth,5),maxDigitWidth:Math.max(i.maxDigitWidth,5)},!1)),this._writeToCache(e,t,i)}return n.get(t)}_createRequest(e,t,n,i){let r=new kS(e,t);return n.push(r),i?.push(r),r}_actualReadFontInfo(e,t){let n=[],i=[],r=this._createRequest("n",0,n,i),s=this._createRequest("\uFF4D",0,n,null),a=this._createRequest(" ",0,n,i),l=this._createRequest("0",0,n,i),d=this._createRequest("1",0,n,i),c=this._createRequest("2",0,n,i),u=this._createRequest("3",0,n,i),p=this._createRequest("4",0,n,i),h=this._createRequest("5",0,n,i),f=this._createRequest("6",0,n,i),g=this._createRequest("7",0,n,i),b=this._createRequest("8",0,n,i),v=this._createRequest("9",0,n,i),I=this._createRequest("\u2192",0,n,i),T=this._createRequest("\uFFEB",0,n,null),S=this._createRequest("\xB7",0,n,i),C=this._createRequest("\u2E31",0,n,null),w="|/-_ilm%";for(let K=0,z=w.length;K<z;K++)this._createRequest(w.charAt(K),0,n,i),this._createRequest(w.charAt(K),1,n,i),this._createRequest(w.charAt(K),2,n,i);TV(e,t,n);let x=Math.max(l.width,d.width,c.width,u.width,p.width,h.width,f.width,g.width,b.width,v.width),D=t.fontFeatureSettings===ws.OFF,O=i[0].width;for(let K=1,z=i.length;D&&K<z;K++){let ie=O-i[K].width;if(ie<-.001||ie>.001){D=!1;break}}let H=!0;return D&&T.width!==O&&(H=!1),T.width>I.width&&(H=!1),new Fp({pixelRatio:jh.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:D,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:H,spaceWidth:a.width,middotWidth:S.width,wsmiddotWidth:C.width,maxDigitWidth:x},!0)}},b1=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId();return!!this._values[t]}get(e){let t=e.getId();return this._values[t]}put(e,t){let n=e.getId();this._keys[n]=e,this._values[n]=t}remove(e){let t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}},v1=new f1;var Sb=class o{constructor(e,t){this.key=e;this.migrate=t}static items=[];apply(e){let t=o._read(e,this.key),n=r=>o._read(e,r),i=(r,s)=>o._write(e,r,s);this.migrate(t,n,i)}static _read(e,t){if(typeof e>"u")return;let n=t.indexOf(".");if(n>=0){let i=t.substring(0,n);return this._read(e[i],t.substring(n+1))}return e[t]}static _write(e,t,n){let i=t.indexOf(".");if(i>=0){let r=t.substring(0,i);e[r]=e[r]||{},this._write(e[r],t.substring(i+1),n);return}e[t]=n}};function Ks(o,e){Sb.items.push(new Sb(o,e))}function jo(o,e){Ks(o,(t,n,i)=>{if(typeof t<"u"){for(let[r,s]of e)if(t===r){i(o,s);return}}})}function wV(o){Sb.items.forEach(e=>e.apply(o))}jo("wordWrap",[[!0,"on"],[!1,"off"]]);jo("lineNumbers",[[!0,"on"],[!1,"off"]]);jo("cursorBlinking",[["visible","solid"]]);jo("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);jo("renderLineHighlight",[[!0,"line"],[!1,"none"]]);jo("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);jo("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);jo("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);jo("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);jo("autoIndent",[[!1,"advanced"],[!0,"full"]]);jo("matchBrackets",[[!0,"always"],[!1,"never"]]);jo("renderFinalNewline",[[!0,"on"],[!1,"off"]]);jo("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);jo("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);jo("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);Ks("autoClosingBrackets",(o,e,t)=>{o===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});Ks("renderIndentGuides",(o,e,t)=>{typeof o<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!o))});Ks("highlightActiveIndentGuide",(o,e,t)=>{typeof o<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!o))});var d3={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};Ks("suggest.filteredTypes",(o,e,t)=>{if(o&&typeof o=="object"){for(let n of Object.entries(d3))o[n[0]]===!1&&typeof e(`suggest.${n[1]}`)>"u"&&t(`suggest.${n[1]}`,!1);t("suggest.filteredTypes",void 0)}});Ks("quickSuggestions",(o,e,t)=>{if(typeof o=="boolean"){let n=o?"on":"off";t("quickSuggestions",{comments:n,strings:n,other:n})}});Ks("experimental.stickyScroll.enabled",(o,e,t)=>{typeof o=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",o))});Ks("experimental.stickyScroll.maxLineCount",(o,e,t)=>{typeof o=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",o))});Ks("codeActionsOnSave",(o,e,t)=>{if(o&&typeof o=="object"){let n=!1,i={};for(let r of Object.entries(o))typeof r[1]=="boolean"?(n=!0,i[r[0]]=r[1]?"explicit":"never"):i[r[0]]=r[1];n&&t("codeActionsOnSave",i)}});Ks("codeActionWidget.includeNearbyQuickfixes",(o,e,t)=>{typeof o=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",o))});Ks("lightbulb.enabled",(o,e,t)=>{typeof o=="boolean"&&t("lightbulb.enabled",o?void 0:"off")});var y1=class{_tabFocus=!1;_onDidChangeTabFocus=new k;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}},qh=new y1;var $h=class extends F{constructor(t,n,i,r,s){super();this._accessibilityService=s;this.isSimpleWidget=t,this.contextMenuId=n,this._containerObserver=this._register(new Gh(r,i.dimension)),this._targetWindowId=Ce(r).vscodeWindowId,this._rawOptions=xV(i),this._validatedOptions=Su.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(ga.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(qh.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(v1.onDidChange(()=>this._recomputeOptions())),this._register(jh.getInstance(Ce(r)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new k);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new mf;_rawOptions;_validatedOptions;options;_recomputeOptions(){let t=this._computeOptions(),n=Su.checkEquals(this.options,t);n!==null&&(this.options=t,this._onDidChangeFast.fire(n),this._onDidChange.fire(n))}_computeOptions(){let t=this._readEnvConfiguration(),n=ef.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(n),r={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:qh.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Su.computeOptions(this._validatedOptions,r)}_readEnvConfiguration(){return{extraEditorClassName:u3(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Hs||Vn,pixelRatio:jh.getInstance(vu(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return v1.readFontInfo(vu(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){let n=xV(t);Su.applyUpdate(this._rawOptions,n)&&(this._validatedOptions=Su.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){let n=c3(t);this._lineNumbersDigitCount!==n&&(this._lineNumbersDigitCount=n,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};$h=P([_(4,vo)],$h);function c3(o){let e=0;for(;o;)o=Math.floor(o/10),e++;return e||1}function u3(){let o="";return!Ko&&!VW&&(o+="no-user-select "),Ko&&(o+="no-minimap-shadow ",o+="enable-user-select "),Fe&&(o+="mac "),o}var I1=class{_values=[];_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}},C1=class{_values=[];_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}},Su=class o{static validateOptions(e){let t=new I1;for(let n of zp){let i=n.name==="_never_"?void 0:e[n.name];t._write(n.id,n.validate(i))}return t}static computeOptions(e,t){let n=new C1;for(let i of zp)n._write(i.id,i.compute(t,n,e._read(i.id)));return n}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?Ut(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!o._deepEquals(e[n],t[n]))return!1;return!0}static checkEquals(e,t){let n=[],i=!1;for(let r of zp){let s=!o._deepEquals(e._read(r.id),t._read(r.id));n[r.id]=s,s&&(i=!0)}return i?new oI(n):null}static applyUpdate(e,t){let n=!1;for(let i of zp)if(t.hasOwnProperty(i.name)){let r=i.applyUpdate(e[i.name],t[i.name]);e[i.name]=r.newValue,n=n||r.didChange}return n}};function xV(o){let e=Sd(o);return wV(e),e}var Gs=class{originalStart;originalLength;modifiedStart;modifiedLength;constructor(e,t,n,i){this.originalStart=e,this.originalLength=t,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}};var Yd=class{static Assert(e,t){if(!e)throw new Error(t)}},Zd=class{static Copy(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}static Copy2(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}};var RS=class{m_changes;m_originalStart;m_modifiedStart;m_originalCount;m_modifiedCount;constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Gs(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},Eb=class o{ContinueProcessingPredicate;_originalSequence;_modifiedSequence;_hasStrings;_originalStringElements;_originalElementsOrHash;_modifiedStringElements;_modifiedElementsOrHash;m_forwardHistory;m_reverseHistory;constructor(e,t,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=t;let[i,r,s]=o._getElements(e),[a,l,d]=o._getElements(t);this._hasStrings=s&&d,this._originalStringElements=i,this._originalElementsOrHash=r,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){let t=e.getElements();if(o._isStringArray(t)){let n=new Int32Array(t.length);for(let i=0,r=t.length;i<r;i++)n[i]=JC(t[i],0);return[t,n,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;let n=o._getStrictElement(this._originalSequence,e),i=o._getStrictElement(this._modifiedSequence,t);return n===i}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,n,i,r){let s=[!1],a=this.ComputeDiffRecursive(e,t,n,i,s);return r&&(a=this.PrettifyChanges(a)),{quitEarly:s[0],changes:a}}ComputeDiffRecursive(e,t,n,i,r){for(r[0]=!1;e<=t&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;t>=e&&i>=n&&this.ElementsAreEqual(t,i);)t--,i--;if(e>t||n>i){let u;return n<=i?(Yd.Assert(e===t+1,"originalStart should only be one more than originalEnd"),u=[new Gs(e,0,n,i-n+1)]):e<=t?(Yd.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),u=[new Gs(e,t-e+1,n,0)]):(Yd.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Yd.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}let s=[0],a=[0],l=this.ComputeRecursionPoint(e,t,n,i,s,a,r),d=s[0],c=a[0];if(l!==null)return l;if(!r[0]){let u=this.ComputeDiffRecursive(e,d,n,c,r),p=[];return r[0]?p=[new Gs(d+1,t-(d+1)+1,c+1,i-(c+1)+1)]:p=this.ComputeDiffRecursive(d+1,t,c+1,i,r),this.ConcatenateChanges(u,p)}return[new Gs(e,t-e+1,n,i-n+1)]}WALKTRACE(e,t,n,i,r,s,a,l,d,c,u,p,h,f,g,b,v,I){let T=null,S=null,C=new RS,w=t,x=n,D=h[0]-b[0]-i,O=-1073741824,H=this.m_forwardHistory.length-1;do{let K=D+e;K===w||K<x&&d[K-1]<d[K+1]?(u=d[K+1],f=u-D-i,u<O&&C.MarkNextChange(),O=u,C.AddModifiedElement(u+1,f),D=K+1-e):(u=d[K-1]+1,f=u-D-i,u<O&&C.MarkNextChange(),O=u-1,C.AddOriginalElement(u,f+1),D=K-1-e),H>=0&&(d=this.m_forwardHistory[H],e=d[0],w=1,x=d.length-1)}while(--H>=-1);if(T=C.getReverseChanges(),I[0]){let K=h[0]+1,z=b[0]+1;if(T!==null&&T.length>0){let ie=T[T.length-1];K=Math.max(K,ie.getOriginalEnd()),z=Math.max(z,ie.getModifiedEnd())}S=[new Gs(K,p-K+1,z,g-z+1)]}else{C=new RS,w=s,x=a,D=h[0]-b[0]-l,O=1073741824,H=v?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let K=D+r;K===w||K<x&&c[K-1]>=c[K+1]?(u=c[K+1]-1,f=u-D-l,u>O&&C.MarkNextChange(),O=u+1,C.AddOriginalElement(u+1,f+1),D=K+1-r):(u=c[K-1],f=u-D-l,u>O&&C.MarkNextChange(),O=u,C.AddModifiedElement(u+1,f+1),D=K-1-r),H>=0&&(c=this.m_reverseHistory[H],r=c[0],w=1,x=c.length-1)}while(--H>=-1);S=C.getChanges()}return this.ConcatenateChanges(T,S)}ComputeRecursionPoint(e,t,n,i,r,s,a){let l=0,d=0,c=0,u=0,p=0,h=0;e--,n--,r[0]=0,s[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let f=t-e+(i-n),g=f+1,b=new Int32Array(g),v=new Int32Array(g),I=i-n,T=t-e,S=e-n,C=t-i,x=(T-I)%2===0;b[I]=e,v[T]=t,a[0]=!1;for(let D=1;D<=f/2+1;D++){let O=0,H=0;c=this.ClipDiagonalBound(I-D,D,I,g),u=this.ClipDiagonalBound(I+D,D,I,g);for(let z=c;z<=u;z+=2){z===c||z<u&&b[z-1]<b[z+1]?l=b[z+1]:l=b[z-1]+1,d=l-(z-I)-S;let ie=l;for(;l<t&&d<i&&this.ElementsAreEqual(l+1,d+1);)l++,d++;if(b[z]=l,l+d>O+H&&(O=l,H=d),!x&&Math.abs(z-T)<=D-1&&l>=v[z])return r[0]=l,s[0]=d,ie<=v[z]&&D<=1448?this.WALKTRACE(I,c,u,S,T,p,h,C,b,v,l,t,r,d,i,s,x,a):null}let K=(O-e+(H-n)-D)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(O,K))return a[0]=!0,r[0]=O,s[0]=H,K>0&&D<=1448?this.WALKTRACE(I,c,u,S,T,p,h,C,b,v,l,t,r,d,i,s,x,a):(e++,n++,[new Gs(e,t-e+1,n,i-n+1)]);p=this.ClipDiagonalBound(T-D,D,T,g),h=this.ClipDiagonalBound(T+D,D,T,g);for(let z=p;z<=h;z+=2){z===p||z<h&&v[z-1]>=v[z+1]?l=v[z+1]-1:l=v[z-1],d=l-(z-T)-C;let ie=l;for(;l>e&&d>n&&this.ElementsAreEqual(l,d);)l--,d--;if(v[z]=l,x&&Math.abs(z-I)<=D&&l<=b[z])return r[0]=l,s[0]=d,ie>=b[z]&&D<=1448?this.WALKTRACE(I,c,u,S,T,p,h,C,b,v,l,t,r,d,i,s,x,a):null}if(D<=1447){let z=new Int32Array(u-c+2);z[0]=I-c+1,Zd.Copy2(b,c,z,1,u-c+1),this.m_forwardHistory.push(z),z=new Int32Array(h-p+2),z[0]=T-p+1,Zd.Copy2(v,p,z,1,h-p+1),this.m_reverseHistory.push(z)}}return this.WALKTRACE(I,c,u,S,T,p,h,C,b,v,l,t,r,d,i,s,x,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){let n=e[t],i=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,s=n.originalLength>0,a=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<r&&(!s||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!a||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){let d=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!d)break;n.originalStart++,n.modifiedStart++}let l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){let n=e[t],i=0,r=0;if(t>0){let u=e[t-1];i=u.originalStart+u.originalLength,r=u.modifiedStart+u.modifiedLength}let s=n.originalLength>0,a=n.modifiedLength>0,l=0,d=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let u=1;;u++){let p=n.originalStart-u,h=n.modifiedStart-u;if(p<i||h<r||s&&!this.OriginalElementsAreEqual(p,p+n.originalLength)||a&&!this.ModifiedElementsAreEqual(h,h+n.modifiedLength))break;let g=(p===i&&h===r?5:0)+this._boundaryScore(p,n.originalLength,h,n.modifiedLength);g>d&&(d=g,l=u)}n.originalStart-=l,n.modifiedStart-=l;let c=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],c)){e[t-1]=c[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,n=e.length;t<n;t++){let i=e[t-1],r=e[t],s=r.originalStart-i.originalStart-i.originalLength,a=i.originalStart,l=r.originalStart+r.originalLength,d=l-a,c=i.modifiedStart,u=r.modifiedStart+r.modifiedLength,p=u-c;if(s<5&&d<20&&p<20){let h=this._findBetterContiguousSequence(a,d,c,p,s);if(h){let[f,g]=h;(f!==i.originalStart+i.originalLength||g!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=f-i.originalStart,i.modifiedLength=g-i.modifiedStart,r.originalStart=f+s,r.modifiedStart=g+s,r.originalLength=l-r.originalStart,r.modifiedLength=u-r.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,n,i,r){if(t<r||i<r)return null;let s=e+t-r+1,a=n+i-r+1,l=0,d=0,c=0;for(let u=e;u<s;u++)for(let p=n;p<a;p++){let h=this._contiguousSequenceScore(u,p,r);h>0&&h>l&&(l=h,d=u,c=p)}return l>0?[d,c]:null}_contiguousSequenceScore(e,t,n){let i=0;for(let r=0;r<n;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;i+=this._originalStringElements[e+r].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){let n=e+t;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){let n=e+t;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,t,n,i){let r=this._OriginalRegionIsBoundary(e,t)?1:0,s=this._ModifiedRegionIsBoundary(n,i)?1:0;return r+s}ConcatenateChanges(e,t){let n=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],n)){let i=new Array(e.length+t.length-1);return Zd.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Zd.Copy(t,1,i,e.length,t.length-1),i}else{let i=new Array(e.length+t.length);return Zd.Copy(e,0,i,0,e.length),Zd.Copy(t,0,i,e.length,t.length),i}}ChangesOverlap(e,t,n){if(Yd.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Yd.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){let i=e.originalStart,r=e.originalLength,s=e.modifiedStart,a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),n[0]=new Gs(i,r,s,a),!0}else return n[0]=null,!1}ClipDiagonalBound(e,t,n,i){if(e>=0&&e<i)return e;let r=n,s=i-n-1,a=t%2===0;if(e<0){let l=r%2===0;return a===l?0:1}else{let l=s%2===0;return a===l?i-1:i-2}}};var MS=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}lineStartOffsetByLineIdx;getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new ke(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let t=ll(this.lineStartOffsetByLineIdx,r=>r<=e),n=t+1,i=e-this.lineStartOffsetByLineIdx[t]+1;return new A(n,i)}getRange(e){return M.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return Fo.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new Fo(e,this.text.length-this.lineStartOffsetByLineIdx[e])}};var NS=class o{constructor(e){this.edits=e;ys(()=>Ag(e,(t,n)=>t.range.getEndPosition().isBeforeOrEqual(n.range.getStartPosition())))}static single(e,t){return new o([new Eu(e,t)])}normalize(){let e=[];for(let t of this.edits)if(e.length>0&&e[e.length-1].range.getEndPosition().equals(t.range.getStartPosition())){let n=e[e.length-1];e[e.length-1]=new Eu(n.range.plusRange(t.range),n.text+t.text)}else t.isEmpty||e.push(t);return new o(e)}mapPosition(e){let t=0,n=0,i=0;for(let r of this.edits){let s=r.range.getStartPosition(),a=r.range.getEndPosition();if(e.isBeforeOrEqual(s))break;let l=Fo.ofText(r.text);if(e.isBefore(a)){let d=new A(s.lineNumber+t,s.column+(s.lineNumber+t===n?i:0)),c=l.addToPosition(d);return OS(d,c)}t+=l.lineCount-(r.range.endLineNumber-r.range.startLineNumber),l.lineCount===0?a.lineNumber!==s.lineNumber?i+=l.columnCount-(a.column-1):i+=l.columnCount-(a.column-s.column):i=l.columnCount,n=a.lineNumber+t}return new A(e.lineNumber+t,e.column+(e.lineNumber+t===n?i:0))}mapRange(e){function t(s){return s instanceof A?s:s.getStartPosition()}function n(s){return s instanceof A?s:s.getEndPosition()}let i=t(this.mapPosition(e.getStartPosition())),r=n(this.mapPosition(e.getEndPosition()));return OS(i,r)}inverseMapPosition(e,t){return this.inverse(t).mapPosition(e)}inverseMapRange(e,t){return this.inverse(t).mapRange(e)}apply(e){let t="",n=new A(1,1);for(let r of this.edits){let s=r.range,a=s.getStartPosition(),l=s.getEndPosition(),d=OS(n,a);d.isEmpty()||(t+=e.getValueOfRange(d)),t+=r.text,n=l}let i=OS(n,e.endPositionExclusive);return i.isEmpty()||(t+=e.getValueOfRange(i)),t}applyToString(e){let t=new S1(e);return this.apply(t)}inverse(e){let t=this.getNewRanges();return new o(this.edits.map((n,i)=>new Eu(t[i],e.getValueOfRange(n.range))))}getNewRanges(){let e=[],t=0,n=0,i=0;for(let r of this.edits){let s=Fo.ofText(r.text),a=A.lift({lineNumber:r.range.startLineNumber+n,column:r.range.startColumn+(r.range.startLineNumber===t?i:0)}),l=s.createRange(a);e.push(l),n=l.endLineNumber-r.range.endLineNumber,i=l.endColumn-r.range.endColumn,t=r.range.endLineNumber}return e}},Eu=class{constructor(e,t){this.range=e;this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};function OS(o,e){if(o.lineNumber===e.lineNumber&&o.column===Number.MAX_SAFE_INTEGER)return M.fromPositions(e,e);if(!o.isBeforeOrEqual(e))throw new $e("start must be before end");return new M(o.lineNumber,o.column,e.lineNumber,e.column)}var Tb=class{get endPositionExclusive(){return this.length.addToPosition(new A(1,1))}getValue(){return this.getValueOfRange(this.length.toRange())}};var S1=class extends Tb{constructor(t){super();this.value=t}_t=new MS(this.value);getValueOfRange(t){return this._t.getOffsetRange(t).substring(this.value)}get length(){return this._t.textLength}};var Yi=class o{static inverse(e,t,n){let i=[],r=1,s=1;for(let l of e){let d=new o(new De(r,l.original.startLineNumber),new De(s,l.modified.startLineNumber));d.modified.isEmpty||i.push(d),r=l.original.endLineNumberExclusive,s=l.modified.endLineNumberExclusive}let a=new o(new De(r,t+1),new De(s,n+1));return a.modified.isEmpty||i.push(a),i}static clip(e,t,n){let i=[];for(let r of e){let s=r.original.intersect(t),a=r.modified.intersect(n);s&&!s.isEmpty&&a&&!a.isEmpty&&i.push(new o(s,a))}return i}original;modified;constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new o(this.modified,this.original)}join(e){return new o(this.original.join(e.original),this.modified.join(e.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new so(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new $e("not a valid diff");return new so(new M(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new M(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new so(new M(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new M(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(_V(this.original.endLineNumberExclusive,e)&&_V(this.modified.endLineNumberExclusive,t))return new so(new M(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new M(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new so(M.fromPositions(new A(this.original.startLineNumber,1),Yh(new A(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),M.fromPositions(new A(this.modified.startLineNumber,1),Yh(new A(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new so(M.fromPositions(Yh(new A(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),Yh(new A(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),M.fromPositions(Yh(new A(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),Yh(new A(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new $e}};function Yh(o,e){if(o.lineNumber<1)return new A(1,1);if(o.lineNumber>e.length)return new A(e.length,e[e.length-1].length+1);let t=e[o.lineNumber-1];return o.column>t.length+1?new A(o.lineNumber,t.length+1):o}function _V(o,e){return o>=1&&o<=e.length}var mr=class o extends Yi{static fromRangeMappings(e){let t=De.join(e.map(i=>De.fromRangeInclusive(i.originalRange))),n=De.join(e.map(i=>De.fromRangeInclusive(i.modifiedRange)));return new o(t,n,e)}innerChanges;constructor(e,t,n){super(e,t),this.innerChanges=n}flip(){return new o(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new o(this.original,this.modified,[this.toRangeMapping()])}},so=class o{static assertSorted(e){for(let t=1;t<e.length;t++){let n=e[t-1],i=e[t];if(!(n.originalRange.getEndPosition().isBeforeOrEqual(i.originalRange.getStartPosition())&&n.modifiedRange.getEndPosition().isBeforeOrEqual(i.modifiedRange.getStartPosition())))throw new $e("Range mappings must be sorted")}}originalRange;modifiedRange;constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new o(this.modifiedRange,this.originalRange)}toTextEdit(e){let t=e.getValueOfRange(this.modifiedRange);return new Eu(this.originalRange,t)}};var Tu=class{constructor(e,t,n){this.changes=e;this.moves=t;this.hitTimeout=n}},AS=class o{lineRangeMapping;changes;constructor(e,t){this.lineRangeMapping=e,this.changes=t}flip(){return new o(this.lineRangeMapping.flip(),this.changes.map(e=>e.flip()))}};var Nl=class{constructor(e,t,n,i,r){this.injectionOffsets=e;this.injectionOptions=t;this.breakOffsets=n;this.breakOffsetsVisibleColumn=i;this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){let t=e>0?this.breakOffsets[e-1]:0,i=this.breakOffsets[e]-t;return e>0&&(i+=this.wrappedTextIndentLength),i}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let i=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&i>this.injectionOffsets[r];r++)i<this.injectionOffsets[r]+this.injectionOptions[r].content.length?i=this.injectionOffsets[r]:i-=this.injectionOptions[r].content.length;return i}translateToOutputPosition(e,t=2){let n=e;if(this.injectionOffsets!==null)for(let i=0;i<this.injectionOffsets.length&&!(e<this.injectionOffsets[i]||t!==1&&e===this.injectionOffsets[i]);i++)n+=this.injectionOptions[i].content.length;return this.offsetInInputWithInjectionsToOutputPosition(n,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let n=0,i=this.breakOffsets.length-1,r=0,s=0;for(;n<=i;){r=n+(i-n)/2|0;let l=this.breakOffsets[r];if(s=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=s)i=r-1;else if(e>l)n=r+1;else break;else if(e<s)i=r-1;else if(e>=l)n=r+1;else break}let a=e-s;return r>0&&(a+=this.wrappedTextIndentLength),new Zh(r,a)}normalizeOutputPosition(e,t,n){if(this.injectionOffsets!==null){let i=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(i,n);if(r!==i)return this.offsetInInputWithInjectionsToOutputPosition(r,n)}if(n===0){if(e>0&&t===this.getMinOutputOffset(e))return new Zh(e-1,this.getMaxOutputOffset(e-1))}else if(n===1){let i=this.getOutputLineCount()-1;if(e<i&&t===this.getMaxOutputOffset(e))return new Zh(e+1,this.getMinOutputOffset(e+1))}return new Zh(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){let n=this.getInjectedTextAtOffset(e);if(!n)return e;if(t===2){if(e===n.offsetInInputWithInjections+n.length&&LV(this.injectionOptions[n.injectedTextIndex].cursorStops))return n.offsetInInputWithInjections+n.length;{let i=n.offsetInInputWithInjections;if(DV(this.injectionOptions[n.injectedTextIndex].cursorStops))return i;let r=n.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[n.injectedTextIndex]&&!(LV(this.injectionOptions[r].cursorStops)||(i-=this.injectionOptions[r].content.length,DV(this.injectionOptions[r].cursorStops)));)r--;return i}}else if(t===1||t===4){let i=n.offsetInInputWithInjections+n.length,r=n.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)i+=this.injectionOptions[r+1].content.length,r++;return i}else if(t===0||t===3){let i=n.offsetInInputWithInjections,r=n.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)i-=this.injectionOptions[r-1].content.length,r--;return i}Ng(t)}getInjectedText(e,t){let n=this.outputPositionToOffsetInInputWithInjections(e,t),i=this.getInjectedTextAtOffset(n);return i?{options:this.injectionOptions[i.injectedTextIndex]}:null}getInjectedTextAtOffset(e){let t=this.injectionOffsets,n=this.injectionOptions;if(t!==null){let i=0;for(let r=0;r<t.length;r++){let s=n[r].content.length,a=t[r]+i,l=t[r]+i+s;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:s};i+=s}}}};function LV(o){return o==null?!0:o===1||o===0}function DV(o){return o==null?!0:o===2||o===0}var Zh=class{outputLineIndex;outputOffset;constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new A(e+this.outputLineIndex,this.outputOffset+1)}};var p3=()=>!0,h3=()=>!1,m3=o=>o===" "||o==="	",Al=class{constructor(e,t,n,i){this.languageConfigurationService=i;this._languageId=e;let r=n.options,s=r.get(147),a=r.get(51);this.readOnly=r.get(93),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=r.get(130),this.wordSeparators=r.get(133),this.emptySelectionClipboard=r.get(38),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(78),this.multiCursorPaste=r.get(80),this.multiCursorLimit=r.get(81),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.wordSegmenterLocales=r.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(e){return e.hasChanged(147)||e.hasChanged(133)||e.hasChanged(38)||e.hasChanged(78)||e.hasChanged(80)||e.hasChanged(81)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(130)||e.hasChanged(51)||e.hasChanged(93)||e.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(let t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,n){let i=Ea(t,n-1),r=this.languageConfigurationService.getLanguageConfiguration(i.languageId).electricCharacter;return r?r.onElectricCharacter(e,i,n-i.firstCharOffset):null}normalizeIndentation(e){return nC(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,n){switch(t){case"beforeWhitespace":return m3;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,n);case"always":return p3;case"never":return h3}}_getLanguageDefinedShouldAutoClose(e,t){let n=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return i=>n.indexOf(i)!==-1}visibleColumnFromColumn(e,t){return Ft.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,n){let i=Ft.columnFromVisibleColumn(e.getLineContent(t),n,this.tabSize),r=e.getLineMinColumn(t);if(i<r)return r;let s=e.getLineMaxColumn(t);return i>s?s:i}},Ye=class o{_cursorStateBrand=void 0;static fromModelState(e){return new E1(e)}static fromViewState(e){return new T1(e)}static fromModelSelection(e){let t=qe.liftSelection(e),n=new Ln(M.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return o.fromModelState(n)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}modelState;viewState;constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}},E1=class{modelState;viewState;constructor(e){this.modelState=e,this.viewState=null}},T1=class{modelState;viewState;constructor(e){this.modelState=null,this.viewState=e}};var Ln=class o{constructor(e,t,n,i,r){this.selectionStart=e;this.selectionStartKind=t;this.selectionStartLeftoverVisibleColumns=n;this.position=i;this.leftoverVisibleColumns=r;this.selection=o._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new o(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new A(t,n),i):new o(new M(t,n,t,n),0,i,new A(t,n),i)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?qe.fromPositions(e.getStartPosition(),t):qe.fromPositions(e.getEndPosition(),t)}},Hn=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(e,t,n){this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}};function js(o){return o==="'"||o==='"'||o==="`"}var PS=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}};var FS=class{type=0;constructor(){}},BS=class{type=1;constructor(){}},WS=class{type=2;_source;constructor(e){this._source=e}hasChanged(e){return this._source.hasChanged(e)}},VS=class{constructor(e,t,n){this.selections=e;this.modelSelections=t;this.reason=n}type=3},Pa=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(e){e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},xu=class{type=5;constructor(){}},HS=class{type=6;isFocused;constructor(e){this.isFocused=e}},US=class{type=7},_u=class{type=8;constructor(){}},wb=class{constructor(e,t){this.fromLineNumber=e;this.count=t}type=9},Qh=class{type=10;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},Xh=class{type=11;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}};var Pl=class{constructor(e,t,n,i,r,s,a){this.source=e;this.minimalReveal=t;this.range=n;this.selections=i;this.verticalType=r;this.revealHorizontal=s;this.scrollType=a}type=12},zS=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e){this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}},KS=class{constructor(e){this.theme=e}type=14},GS=class{type=15;ranges;constructor(e){this.ranges=e}},jS=class{type=16;constructor(){}},qS=class{type=17;constructor(){}};var ls=class extends F{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let n=0,i=e.length;n<i;n++){let r=e[n];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}};var xb=class{_viewportBrand=void 0;top;left;width;height;constructor(e,t,n,i){this.top=e|0,this.left=t|0,this.width=n|0,this.height=i|0}},$S=class{tabSize;data;constructor(e,t){this.tabSize=e,this.data=t}},Lu=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(e,t,n,i,r,s,a){this.content=e,this.continuesWithWrappedLine=t,this.minColumn=n,this.maxColumn=i,this.startVisibleColumn=r,this.tokens=s,this.inlineDecorations=a}},Fa=class o{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(e,t,n,i,r,s,a,l,d,c){this.minColumn=e,this.maxColumn=t,this.content=n,this.continuesWithWrappedLine=i,this.isBasicASCII=o.isBasicASCII(n,s),this.containsRTL=o.containsRTL(n,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(e,t){return t?jg(e):!0}static containsRTL(e,t,n){return!t&&n?ml(e):!1}};var Fl=class{constructor(e,t,n){this.range=e;this.inlineClassName=t;this.type=n}},YS=class{constructor(e,t,n,i){this.startOffset=e;this.endOffset=t;this.inlineClassName=n;this.inlineClassNameAffectsLetterSpacing=i}toInlineDecoration(e){return new Fl(new M(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},em=class{_viewModelDecorationBrand=void 0;range;options;constructor(e,t){this.range=e,this.options=t}},Du=class o{constructor(e,t,n){this.color=e;this.zIndex=t;this.data=n}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&Ut(e.data,t.data)}static equalsArr(e,t){return Ut(e,t,o.equals)}};var ZS=class{_colorZoneBrand=void 0;from;to;colorId;constructor(e,t,n){this.from=e|0,this.to=t|0,this.colorId=n|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}},_b=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(e,t,n,i){this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=n,this.color=i,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}},QS=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(_b.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),n=Math.floor(this.getCanvasHeight()),i=Math.floor(this._outerHeight),r=n/i,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!e){let S=c.getColorZones();if(S){a.push(S);continue}}let u=this._getVerticalOffsetForLine(c.startLineNumber),p=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+t:u+c.heightInLines*t,h=Math.floor(r*u),f=Math.floor(r*p),g=Math.floor((h+f)/2),b=f-g;b<s&&(b=s),g-b<0&&(g=b),g+b>n&&(g=n-b);let v=c.color,I=this._color2Id[v];I||(I=++this._lastAssignedId,this._color2Id[v]=I,this._id2Color[I]=v);let T=new ZS(g-b,g+b,I);c.setColorZone(T),a.push(T)}return this._colorZonesInvalid=!1,a.sort(ZS.compare),a}};var ge;(Ve=>(Ve.editorSimpleInput=new $("editorSimpleInput",!1,!0),Ve.editorTextFocus=new $("editorTextFocus",!1,m("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),Ve.focus=new $("editorFocus",!1,m("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),Ve.textInputFocus=new $("textInputFocus",!1,m("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),Ve.readOnly=new $("editorReadonly",!1,m("editorReadonly","Whether the editor is read-only")),Ve.inDiffEditor=new $("inDiffEditor",!1,m("inDiffEditor","Whether the context is a diff editor")),Ve.isEmbeddedDiffEditor=new $("isEmbeddedDiffEditor",!1,m("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),Ve.multiDiffEditorAllCollapsed=new $("multiDiffEditorAllCollapsed",void 0,m("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),Ve.hasChanges=new $("diffEditorHasChanges",!1,m("diffEditorHasChanges","Whether the diff editor has changes")),Ve.comparingMovedCode=new $("comparingMovedCode",!1,m("comparingMovedCode","Whether a moved code block is selected for comparison")),Ve.accessibleDiffViewerVisible=new $("accessibleDiffViewerVisible",!1,m("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),Ve.diffEditorRenderSideBySideInlineBreakpointReached=new $("diffEditorRenderSideBySideInlineBreakpointReached",!1,m("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),Ve.diffEditorInlineMode=new $("diffEditorInlineMode",!1,m("diffEditorInlineMode","Whether inline mode is active")),Ve.diffEditorOriginalWritable=new $("diffEditorOriginalWritable",!1,m("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),Ve.diffEditorModifiedWritable=new $("diffEditorModifiedWritable",!1,m("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),Ve.diffEditorOriginalUri=new $("diffEditorOriginalUri","",m("diffEditorOriginalUri","The uri of the original document")),Ve.diffEditorModifiedUri=new $("diffEditorModifiedUri","",m("diffEditorModifiedUri","The uri of the modified document")),Ve.columnSelection=new $("editorColumnSelection",!1,m("editorColumnSelection","Whether `editor.columnSelection` is enabled")),Ve.writable=Ve.readOnly.toNegated(),Ve.hasNonEmptySelection=new $("editorHasSelection",!1,m("editorHasSelection","Whether the editor has text selected")),Ve.hasOnlyEmptySelection=Ve.hasNonEmptySelection.toNegated(),Ve.hasMultipleSelections=new $("editorHasMultipleSelections",!1,m("editorHasMultipleSelections","Whether the editor has multiple selections")),Ve.hasSingleSelection=Ve.hasMultipleSelections.toNegated(),Ve.tabMovesFocus=new $("editorTabMovesFocus",!1,m("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),Ve.tabDoesNotMoveFocus=Ve.tabMovesFocus.toNegated(),Ve.isInEmbeddedEditor=new $("isInEmbeddedEditor",!1,!0),Ve.canUndo=new $("canUndo",!1,!0),Ve.canRedo=new $("canRedo",!1,!0),Ve.hoverVisible=new $("editorHoverVisible",!1,m("editorHoverVisible","Whether the editor hover is visible")),Ve.hoverFocused=new $("editorHoverFocused",!1,m("editorHoverFocused","Whether the editor hover is focused")),Ve.stickyScrollFocused=new $("stickyScrollFocused",!1,m("stickyScrollFocused","Whether the sticky scroll is focused")),Ve.stickyScrollVisible=new $("stickyScrollVisible",!1,m("stickyScrollVisible","Whether the sticky scroll is visible")),Ve.standaloneColorPickerVisible=new $("standaloneColorPickerVisible",!1,m("standaloneColorPickerVisible","Whether the standalone color picker is visible")),Ve.standaloneColorPickerFocused=new $("standaloneColorPickerFocused",!1,m("standaloneColorPickerFocused","Whether the standalone color picker is focused")),Ve.inCompositeEditor=new $("inCompositeEditor",void 0,m("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),Ve.notInCompositeEditor=Ve.inCompositeEditor.toNegated(),Ve.languageId=new $("editorLangId","",m("editorLangId","The language identifier of the editor")),Ve.hasCompletionItemProvider=new $("editorHasCompletionItemProvider",!1,m("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),Ve.hasCodeActionsProvider=new $("editorHasCodeActionsProvider",!1,m("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),Ve.hasCodeLensProvider=new $("editorHasCodeLensProvider",!1,m("editorHasCodeLensProvider","Whether the editor has a code lens provider")),Ve.hasDefinitionProvider=new $("editorHasDefinitionProvider",!1,m("editorHasDefinitionProvider","Whether the editor has a definition provider")),Ve.hasDeclarationProvider=new $("editorHasDeclarationProvider",!1,m("editorHasDeclarationProvider","Whether the editor has a declaration provider")),Ve.hasImplementationProvider=new $("editorHasImplementationProvider",!1,m("editorHasImplementationProvider","Whether the editor has an implementation provider")),Ve.hasTypeDefinitionProvider=new $("editorHasTypeDefinitionProvider",!1,m("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),Ve.hasHoverProvider=new $("editorHasHoverProvider",!1,m("editorHasHoverProvider","Whether the editor has a hover provider")),Ve.hasDocumentHighlightProvider=new $("editorHasDocumentHighlightProvider",!1,m("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),Ve.hasDocumentSymbolProvider=new $("editorHasDocumentSymbolProvider",!1,m("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),Ve.hasReferenceProvider=new $("editorHasReferenceProvider",!1,m("editorHasReferenceProvider","Whether the editor has a reference provider")),Ve.hasRenameProvider=new $("editorHasRenameProvider",!1,m("editorHasRenameProvider","Whether the editor has a rename provider")),Ve.hasSignatureHelpProvider=new $("editorHasSignatureHelpProvider",!1,m("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),Ve.hasInlayHintsProvider=new $("editorHasInlayHintsProvider",!1,m("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),Ve.hasDocumentFormattingProvider=new $("editorHasDocumentFormattingProvider",!1,m("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),Ve.hasDocumentSelectionFormattingProvider=new $("editorHasDocumentSelectionFormattingProvider",!1,m("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),Ve.hasMultipleDocumentFormattingProvider=new $("editorHasMultipleDocumentFormattingProvider",!1,m("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),Ve.hasMultipleDocumentSelectionFormattingProvider=new $("editorHasMultipleDocumentSelectionFormattingProvider",!1,m("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(ge||={});var ao;(i=>{function o(r,s){if(r.start>=s.end||s.start>=r.end)return{start:0,end:0};let a=Math.max(r.start,s.start),l=Math.min(r.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}i.intersect=o;function e(r){return r.end-r.start<=0}i.isEmpty=e;function t(r,s){return!e(o(r,s))}i.intersects=t;function n(r,s){let a=[],l={start:r.start,end:Math.min(s.start,r.end)},d={start:Math.max(s.end,r.start),end:r.end};return e(l)||a.push(l),e(d)||a.push(d),a}i.relativeComplement=n})(ao||={});var XS={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:iu.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};var Ba=class{_hooks=new ne;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,e&&n&&n(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,n,i,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=i,this._onStopCallback=r;let s=e;try{e.setPointerCapture(t),this._hooks.add(pe(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=Ce(e)}this._hooks.add(q(s,he.POINTER_MOVE,a=>{if(a.buttons!==n){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(q(s,he.POINTER_UP,a=>this.stopMonitoring(!0)))}};var lo=class extends F{onclick(e,t){this._register(q(e,he.CLICK,n=>t(new qi(Ce(e),n))))}onmousedown(e,t){this._register(q(e,he.MOUSE_DOWN,n=>t(new qi(Ce(e),n))))}onmouseover(e,t){this._register(q(e,he.MOUSE_OVER,n=>t(new qi(Ce(e),n))))}onmouseleave(e,t){this._register(q(e,he.MOUSE_LEAVE,n=>t(new qi(Ce(e),n))))}onkeydown(e,t){this._register(q(e,he.KEY_DOWN,n=>t(new gt(n))))}onkeyup(e,t){this._register(q(e,he.KEY_UP,n=>t(new gt(n))))}oninput(e,t){this._register(q(e,he.INPUT,t))}onblur(e,t){this._register(q(e,he.BLUR,t))}onfocus(e,t){this._register(q(e,he.FOCUS,t))}onchange(e,t){this._register(q(e,he.CHANGE,t))}ignoreGesture(e){return Nn.ignoreTarget(e)}};var Qd=11,JS=class extends lo{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Be.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=Qd+"px",this.domNode.style.height=Qd+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new Ba),this._register(hn(this.bgDomNode,he.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(hn(this.domNode,he.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new Wh),this._pointerdownScheduleRepeatTimer=this._register(new Ls)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Ce(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}};var Xd=class o{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(e,t,n,i,r,s){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(e),this._visibleSize=i,this._scrollSize=r,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new o(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){let t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,n,i,r){let s=Math.max(0,n-e),a=Math.max(0,s-2*t),l=i>0&&i>n;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(n*a/i))),c=(a-d)/(i-n),u=r*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){let e=o._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize,n=this._scrollPosition;return t<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}};var eE=class extends F{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(e,t,n){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Ls)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}};var g3=140,tm=class extends lo{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new eE(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Ba),this._shouldRender=!0,this.domNode=We(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(q(this.domNode.domNode,he.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new JS(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,n,i){this.slider=We(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof n=="number"&&this.slider.setWidth(n),typeof i=="number"&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(q(this.slider.domNode,he.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,n=t+this._scrollbarState.getSliderPosition(),i=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);n<=r&&r<=i?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,n;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,n=e.offsetY;else{let r=ro(this.domNode.domNode);t=e.pageX-r.left,n=e.pageY-r.top}let i=this._pointerDownRelativePosition(t,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),n=this._sliderOrthogonalPointerPosition(e),i=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{let s=this._sliderOrthogonalPointerPosition(r),a=Math.abs(s-n);if(pt&&a>g3){this._setDesiredScrollPositionNow(i.getScrollPosition());return}let d=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(i.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var tE=class extends tm{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Xd(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,i.width,i.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){let s=(t.arrowSize-Qd)/2,a=(t.horizontalScrollbarSize-Qd)/2;this._createArrow({className:"scra",icon:ae.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Pr(null,1,0))}),this._createArrow({className:"scra",icon:ae.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Pr(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}};var nE=class extends tm{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Xd(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,i.height,i.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){let s=(t.arrowSize-Qd)/2,a=(t.verticalScrollbarSize-Qd)/2;this._createArrow({className:"scra",icon:ae.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Pr(null,0,1))}),this._createArrow({className:"scra",icon:ae.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Pr(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}};var f3=500,MV=50,OV=!0,w1=class{timestamp;deltaX;deltaY;score;constructor(e,t,n){this.timestamp=e,this.deltaX=t,this.deltaY=n,this.score=0}},Lb=class o{static INSTANCE=new o;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,n=1,i=this._rear;do{let r=i===this._front?e:Math.pow(2,-n);if(e-=r,t+=this._memory[i].score*r,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(Kd){let t=Ce(e.browserEvent),n=BW(t);this.accept(Date.now(),e.deltaX*n,e.deltaY*n)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,n){let i=null,r=new w1(e,t,n);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(i=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,i)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(n+=.25),t){let i=Math.abs(e.deltaX),r=Math.abs(e.deltaY),s=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(i,s),1),d=Math.max(Math.min(r,a),1),c=Math.max(i,s),u=Math.max(r,a);c%l===0&&u%d===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}},Db=class extends lo{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new k);onScroll=this._onScroll.event;_onWillScroll=this._register(new k);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(e,t,n){super(),e.style.overflow="hidden",this._options=b3(t),this._scrollable=n,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));let i={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new nE(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new tE(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=We(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=We(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=We(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new Ls),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=Tt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Fe&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Pr(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Tt(this._mouseWheelToDispose),e)){let n=i=>{this._onMouseWheel(new Pr(i))};this._mouseWheelToDispose.push(q(this._listenOnDomNode,he.MOUSE_WHEEL,n,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=Lb.INSTANCE;OV&&t.acceptStandardWheelEvent(e);let n=!1;if(e.deltaY||e.deltaX){let r=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+r===0?s=r=0:Math.abs(r)>=Math.abs(s)?s=0:r=0),this._options.flipAxes&&([r,s]=[s,r]);let a=!Fe&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=r,r=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(r){let c=MV*r,u=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,u)}if(s){let c=MV*s,u=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,u)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(OV&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),n=!0)}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,n=e.scrollLeft>0,i=n?" left":"",r=t?" top":"",s=n||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${r}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),f3)}},iE=class extends Db{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new Es({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>Xn(Ce(e),i)});super(e,t,n),this._register(n)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Jd=class extends Db{constructor(e,t,n){super(e,t,n)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},ku=class extends Db{_element;constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new Es({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>Xn(Ce(e),i)});super(e,t,n),this._register(n),this._element=e,this._register(this.onScroll(i=>{i.scrollTopChanged&&(this._element.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this._element.scrollLeft=i.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}};function b3(o){let e={lazyRender:typeof o.lazyRender<"u"?o.lazyRender:!1,className:typeof o.className<"u"?o.className:"",useShadows:typeof o.useShadows<"u"?o.useShadows:!0,handleMouseWheel:typeof o.handleMouseWheel<"u"?o.handleMouseWheel:!0,flipAxes:typeof o.flipAxes<"u"?o.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof o.consumeMouseWheelIfScrollbarIsNeeded<"u"?o.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof o.alwaysConsumeMouseWheel<"u"?o.alwaysConsumeMouseWheel:!1,scrollYToX:typeof o.scrollYToX<"u"?o.scrollYToX:!1,mouseWheelScrollSensitivity:typeof o.mouseWheelScrollSensitivity<"u"?o.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof o.fastScrollSensitivity<"u"?o.fastScrollSensitivity:5,scrollPredominantAxis:typeof o.scrollPredominantAxis<"u"?o.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof o.mouseWheelSmoothScroll<"u"?o.mouseWheelSmoothScroll:!0,arrowSize:typeof o.arrowSize<"u"?o.arrowSize:11,listenOnDomNode:typeof o.listenOnDomNode<"u"?o.listenOnDomNode:null,horizontal:typeof o.horizontal<"u"?o.horizontal:1,horizontalScrollbarSize:typeof o.horizontalScrollbarSize<"u"?o.horizontalScrollbarSize:10,horizontalSliderSize:typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:0,horizontalHasArrows:typeof o.horizontalHasArrows<"u"?o.horizontalHasArrows:!1,vertical:typeof o.vertical<"u"?o.vertical:1,verticalScrollbarSize:typeof o.verticalScrollbarSize<"u"?o.verticalScrollbarSize:10,verticalHasArrows:typeof o.verticalHasArrows<"u"?o.verticalHasArrows:!1,verticalSliderSize:typeof o.verticalSliderSize<"u"?o.verticalSliderSize:0,scrollByPage:typeof o.scrollByPage<"u"?o.scrollByPage:!1};return e.horizontalSliderSize=typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof o.verticalSliderSize<"u"?o.verticalSliderSize:e.verticalScrollbarSize,Fe&&(e.className+=" mac"),e}function NV(o,e){let t=[];for(let n of e){if(o.start>=n.range.end)continue;if(o.end<n.range.start)break;let i=ao.intersect(o,n.range);ao.isEmpty(i)||t.push({range:i,size:n.size})}return t}function rE({start:o,end:e},t){return{start:o+t,end:e+t}}function v3(o){let e=[],t=null;for(let n of o){let i=n.range.start,r=n.range.end,s=n.size;if(t&&s===t.size){t.range.end=r;continue}t={range:{start:i,end:r},size:s},e.push(t)}return e}function y3(...o){return v3(o.reduce((e,t)=>e.concat(t),[]))}var oE=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,n=[]){let i=n.length-t,r=NV({start:0,end:e},this.groups),s=NV({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:rE(l.range,i),size:l.size})),a=n.map((l,d)=>({range:{start:e+d,end:e+d+1},size:l.size}));this.groups=y3(r,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,n=this._paddingTop;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r*i.size;if(e<s)return t+Math.floor((e-n)/i.size);t+=r,n=s}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,n=0;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r;if(e<s)return this._paddingTop+t+(e-n)*i.size;t+=r*i.size,n=s}return-1}};var sE=class{constructor(e){this.renderers=e}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(e){let t=this.getTemplateCache(e).pop(),n=!1;if(t)n=this.transactionNodesPendingRemoval.has(t.domNode),n&&this.transactionNodesPendingRemoval.delete(t.domNode);else{let i=Ke(".monaco-list-row"),s=this.getRenderer(e).renderTemplate(i);t={domNode:i,templateId:e,templateData:s}}return{row:t,isReusingConnectedDomNode:n}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(let t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){let{domNode:t,templateId:n}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(n).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(let n of e)this.getRenderer(t).disposeTemplate(n.templateData),n.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){let t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}};var AV=2e4,BV,x1,PV,_1,FV;function ec(o){BV&&(x1.textContent!==o?(fi(PV),aE(x1,o)):(fi(x1),aE(PV,o)))}function kb(o){BV&&(_1.textContent!==o?(fi(FV),aE(_1,o)):(fi(_1),aE(FV,o)))}function aE(o,e){fi(o),e.length>AV&&(e=e.substr(0,AV)),o.textContent=e,o.style.visibility="hidden",o.style.visibility="visible"}var Ru={CurrentDragAndDropData:void 0};var Wa={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(o){return[o]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},Bl=class{elements;_context;get context(){return this._context}set context(e){this._context=e}constructor(e){this.elements=e}update(){}getData(){return this.elements}},L1=class{elements;constructor(e){this.elements=e}update(){}getData(){return this.elements}},D1=class{types;files;constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){let n=e.files.item(t);n&&(n.size||n.type)&&this.files.push(n)}}}getData(){return{types:this.types,files:this.files}}};function C3(o,e){return Array.isArray(o)&&Array.isArray(e)?Ut(o,e):o===e}var k1=class{getSetSize;getPosInSet;getRole;isChecked;constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,n,i)=>i,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,n)=>n+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}},gr=class gr{constructor(e,t,n,i=Wa){this.virtualDelegate=t;if(i.horizontalScrolling&&i.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(i.paddingTop??0);for(let s of n)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new sE(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof i.mouseSupport=="boolean"?i.mouseSupport:!0),this._horizontalScrolling=i.horizontalScrolling??Wa.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof i.paddingBottom>"u"?0:i.paddingBottom,this.accessibilityProvider=new k1(i.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(i.transformOptimization??Wa.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Nn.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new Es({forceIntegerValues:!0,smoothScrollDuration:i.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>Xn(Ce(this.domNode),s)})),this.scrollableElement=this.disposables.add(new Jd(this.rowsContainer,{alwaysConsumeMouseWheel:i.alwaysConsumeMouseWheel??Wa.alwaysConsumeMouseWheel,horizontal:1,vertical:i.verticalScrollMode??Wa.verticalScrollMode,useShadows:i.useShadows??Wa.useShadows,mouseWheelScrollSensitivity:i.mouseWheelScrollSensitivity,fastScrollSensitivity:i.fastScrollSensitivity,scrollByPage:i.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(q(this.rowsContainer,wt.Change,s=>this.onTouchChange(s))),this.disposables.add(q(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(q(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(q(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(q(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(q(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=i.setRowLineHeight??Wa.setRowLineHeight,this.setRowHeight=i.setRowHeight??Wa.setRowHeight,this.supportDynamicHeights=i.supportDynamicHeights??Wa.supportDynamicHeights,this.dnd=i.dnd??this.disposables.add(Wa.dnd),this.layout(i.initialSize?.height,i.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++gr.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new _s(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=F.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=F.None;onDragLeaveTimeout=F.None;disposables=new ne;_onDidChangeContentHeight=new k;_onDidChangeContentWidth=new k;onDidChangeContentHeight=j.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=j.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:Uh(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),i=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(n,Math.max(0,this.lastRenderTop+i),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(e){this.scrollableElement.delegateScrollFromMouseWheelEvent(e)}delegateVerticalScrollbarPointerDown(e){this.scrollableElement.delegateVerticalScrollbarPointerDown(e)}updateElementHeight(e,t,n){if(e<0||e>=this.items.length)return;let i=this.items[e].size;if(typeof t>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[e].lastDynamicHeightWidth=void 0,t=i+this.probeDynamicHeight(e)}if(i===t)return;let r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;e<r.start||n!==null&&n>e&&n<r.end?s=t-i:s=0,this.rangeMap.splice(e,1,[{size:t}]),this.items[e].size=t,this.render(r,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(e){return new oE(e)}splice(e,t,n=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,n)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,n=[]){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},s=ao.intersect(i,r),a=new Map;for(let C=s.end-1;C>=s.start;C--){let w=this.items[C];if(w.dragStartDisposable.dispose(),w.checkedDisposable.dispose(),w.row){let x=a.get(w.templateId);x||(x=[],a.set(w.templateId,x));let D=this.renderers.get(w.templateId);D&&D.disposeElement&&D.disposeElement(w.element,C,w.row.templateData,w.size),x.unshift(w.row)}w.row=null,w.stale=!0}let l={start:e+t,end:this.items.length},d=ao.intersect(l,i),c=ao.relativeComplement(l,i),u=n.map(C=>({id:String(this.itemId++),element:C,templateId:this.virtualDelegate.getTemplateId(C),size:this.virtualDelegate.getHeight(C),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(C),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:F.None,checkedDisposable:F.None,stale:!1})),p;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),p=this.items,this.items=u):(this.rangeMap.splice(e,t,u),p=this.items.splice(e,t,...u));let h=n.length-t,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),g=rE(d,h),b=ao.intersect(f,g);for(let C=b.start;C<b.end;C++)this.updateItemInDOM(this.items[C],C);let v=ao.relativeComplement(g,f);for(let C of v)for(let w=C.start;w<C.end;w++)this.removeItemFromDOM(w);let I=c.map(C=>rE(C,h)),S=[{start:e,end:e+n.length},...I].map(C=>ao.intersect(f,C)).reverse();for(let C of S)for(let w=C.end-1;w>=C.start;w--){let x=this.items[w],O=a.get(x.templateId)?.pop();this.insertItemInDOM(w,O)}for(let C of a.values())for(let w of C)this.cache.release(w);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),p.map(C=>C.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Xn(Ce(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(let t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(e){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let t=this.items[e];this.measureItemWidth(t),typeof t.width<"u"&&t.width>this.scrollWidth&&(this.scrollWidth=t.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let e=this.firstVisibleIndex,t=this.rangeMap.positionAt(e),n=this.rangeMap.positionAt(e+1);return n!==-1&&(n-t)/2+t<this.scrollTop?e+1:e}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){let t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let n={height:typeof e=="number"?e:ES(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,n.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(n),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:Uh(this.domNode)})}render(e,t,n,i,r,s=!1){let a=this.getRenderRange(t,n),l=ao.relativeComplement(a,e).reverse(),d=ao.relativeComplement(e,a);if(s){let c=ao.intersect(e,a);for(let u=c.start;u<c.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(let c of d)for(let u=c.start;u<c.end;u++)this.removeItemFromDOM(u);for(let c of l)for(let u=c.end-1;u>=c.start;u--)this.insertItemInDOM(u)}),i!==void 0&&(this.rowsContainer.style.left=`-${i}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=n}insertItemInDOM(e,t){let n=this.items[e];if(!n.row)if(t)n.row=t,n.stale=!0;else{let l=this.cache.alloc(n.templateId);n.row=l.row,n.stale||=l.isReusingConnectedDomNode}let i=this.accessibilityProvider.getRole(n.element)||"listitem";n.row.domNode.setAttribute("role",i);let r=this.accessibilityProvider.isChecked(n.element);if(typeof r=="boolean")n.row.domNode.setAttribute("aria-checked",String(!!r));else if(r){let l=d=>n.row.domNode.setAttribute("aria-checked",String(!!d));l(r.value),n.checkedDisposable=r.onDidChange(()=>l(r.value))}if(n.stale||!n.row.domNode.parentElement){let l=this.items.at(e+1)?.row?.domNode??null;(n.row.domNode.parentElement!==this.rowsContainer||n.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(n.row.domNode,l),n.stale=!1}this.updateItemInDOM(n,e);let s=this.renderers.get(n.templateId);if(!s)throw new Error(`No renderer found for template id ${n.templateId}`);s?.renderElement(n.element,e,n.row.templateData,n.size);let a=this.dnd.getDragURI(n.element);n.dragStartDisposable.dispose(),n.row.domNode.draggable=!!a,a&&(n.dragStartDisposable=q(n.row.domNode,"dragstart",l=>this.onDragStart(n.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(n),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=Uh(e.row.domNode);let t=Ce(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){let t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let n=this.renderers.get(t.templateId);n&&n.disposeElement&&n.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:e})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return j.map(this.disposables.add(new Ne(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return j.map(this.disposables.add(new Ne(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return j.filter(j.map(this.disposables.add(new Ne(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseUp(){return j.map(this.disposables.add(new Ne(this.domNode,"mouseup")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDown(){return j.map(this.disposables.add(new Ne(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return j.map(this.disposables.add(new Ne(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMove(){return j.map(this.disposables.add(new Ne(this.domNode,"mousemove")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return j.map(this.disposables.add(new Ne(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return j.any(j.map(this.disposables.add(new Ne(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),j.map(this.disposables.add(new Ne(this.domNode,wt.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return j.map(this.disposables.add(new Ne(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return j.map(this.disposables.add(new Ne(this.rowsContainer,wt.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toTouchEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toGestureEvent(e){let t=this.getItemIndexFromEventTarget(e.initialTarget||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toDragEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:i,sector:r}}onScroll(e){try{let t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,n){if(!n.dataTransfer)return;let i=this.dnd.getDragElements(e);if(n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setData(XS.TEXT,t),n.dataTransfer.setDragImage){let r;this.dnd.getDragLabel&&(r=this.dnd.getDragLabel(i,n)),typeof r>"u"&&(r=String(i.length));let s=Ke(".monaco-drag-image");s.textContent=r,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),n.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new Bl(i),Ru.CurrentDragAndDropData=new L1(i),this.dnd.onDragStart?.(this.currentDragData,n)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),Ru.CurrentDragAndDropData&&Ru.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(Ru.CurrentDragAndDropData)this.currentDragData=Ru.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new D1}let t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let n;typeof t!="boolean"&&t.feedback?n=t.feedback:typeof e.index>"u"?n=[-1]:n=[e.index],n=bs(n).filter(r=>r>=-1&&r<this.length).sort((r,s)=>r-s),n=n[0]===-1?[-1]:n;let i=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(C3(this.currentDragFeedback,n)&&this.currentDragFeedbackPosition===i)return!0;if(this.currentDragFeedback=n,this.currentDragFeedbackPosition=i,this.currentDragFeedbackDisposable.dispose(),n[0]===-1)this.domNode.classList.add(i),this.rowsContainer.classList.add(i),this.currentDragFeedbackDisposable=pe(()=>{this.domNode.classList.remove(i),this.rowsContainer.classList.remove(i)});else{if(n.length>1&&i!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");i==="drop-target-after"&&n[0]<this.length-1&&(n[0]+=1,i="drop-target-before");for(let r of n){let s=this.items[r];s.dropTarget=!0,s.row?.domNode.classList.add(i)}this.currentDragFeedbackDisposable=pe(()=>{for(let r of n){let s=this.items[r];s.dropTarget=!1,s.row?.domNode.classList.remove(i)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=yf(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;let t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Ru.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Ru.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=F.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){let t=vb(this.domNode).top;this.dragOverAnimationDisposable=IV(Ce(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=yf(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;let t=this.dragOverMouseY-e,n=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>n&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-n))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;let n=e.offsetY/this.items[t].size,i=Math.floor(n/.25);return Di(i,0,3)}getItemIndexFromEventTarget(e){let t=this.scrollableElement.getDomNode(),n=e;for(;(On(n)||gV(n))&&n!==this.rowsContainer&&t.contains(n);){let i=n.getAttribute("data-index");if(i){let r=Number(i);if(!isNaN(r))return r}n=n.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,n){let i=this.getRenderRange(e,t),r,s;e===this.elementTop(i.start)?(r=i.start,s=0):i.end-i.start>1&&(r=i.start+1,s=this.elementTop(r)-e);let a=0;for(;;){let l=this.getRenderRange(e,t),d=!1;for(let c=l.start;c<l.end;c++){let u=this.probeDynamicHeight(c);u!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=u,d=d||u!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=ao.relativeComplement(i,l);for(let p of c)for(let h=p.start;h<p.end;h++)this.items[h].row&&this.removeItemFromDOM(h);let u=ao.relativeComplement(l,i).reverse();for(let p of u)for(let h=p.end-1;h>=p.start;h--)this.insertItemInDOM(h);for(let p=l.start;p<l.end;p++)this.items[p].row&&this.updateItemInDOM(this.items[p],p);if(typeof r=="number"){let p=this.scrollable.getFutureScrollPosition().scrollTop-e,h=this.elementTop(r)-s+p;this.setScrollTop(h,n)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){let t=this.items[e];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(t.element);if(s!==null){let a=t.size;return t.size=s,t.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;let n=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!rs(t.row.domNode,Ce(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-n;let{row:i}=this.cache.alloc(t.templateId);i.domNode.style.height="",this.rowsContainer.appendChild(i.domNode);let r=this.renderers.get(t.templateId);if(!r)throw new $e("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,i.templateData,void 0),t.size=i.domNode.offsetHeight,r.disposeElement?.(t.element,e,i.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,i.domNode.remove(),this.cache.release(i),t.size-n}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(let e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};P([me],gr.prototype,"onMouseClick",1),P([me],gr.prototype,"onMouseDblClick",1),P([me],gr.prototype,"onMouseMiddleClick",1),P([me],gr.prototype,"onMouseUp",1),P([me],gr.prototype,"onMouseDown",1),P([me],gr.prototype,"onMouseOver",1),P([me],gr.prototype,"onMouseMove",1),P([me],gr.prototype,"onMouseOut",1),P([me],gr.prototype,"onContextMenu",1),P([me],gr.prototype,"onTouchStart",1),P([me],gr.prototype,"onTap",1);var lE=gr;var Va=class extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}};var dE=class{constructor(e){this.spliceables=e}splice(e,t,n){this.spliceables.forEach(i=>i.splice(e,t,n))}};var R1=class{constructor(e){this.trait=e}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,n){let i=this.renderedElements.findIndex(r=>r.templateData===n);if(i>=0){let r=this.renderedElements[i];this.trait.unrender(n),r.index=t}else{let r={index:t,templateData:n};this.renderedElements.push(r)}this.trait.renderIndex(t,n)}splice(e,t,n){let i=[];for(let r of this.renderedElements)r.index<e?i.push(r):r.index>=e+t&&i.push({index:r.index+n-t,templateData:r.templateData});this.renderedElements=i}renderIndexes(e){for(let{index:t,templateData:n}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,n)}disposeTemplate(e){let t=this.renderedElements.findIndex(n=>n.templateData===e);t<0||this.renderedElements.splice(t,1)}},im=class{constructor(e){this._trait=e}indexes=[];sortedIndexes=[];_onChange=new k;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new R1(this)}splice(e,t,n){let i=n.length-t,r=e+t,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)s.push(this.sortedIndexes[a++]);for(let l=0;l<n.length;l++)n[l]&&s.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)s.push(this.sortedIndexes[a++]+i);this.renderer.splice(e,t,n.length),this._set(s,s)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(VV),t)}_set(e,t,n){let i=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;let s=A1(r,e);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:e,browserEvent:n}),i}get(){return this.indexes}contains(e){return ZN(this.sortedIndexes,e,VV)>=0}dispose(){Tt(this._onChange)}};P([me],im.prototype,"renderer",1);var M1=class extends im{constructor(t){super("selected");this.setAriaSelected=t}renderIndex(t,n){super.renderIndex(t,n),this.setAriaSelected&&(this.contains(t)?n.setAttribute("aria-selected","true"):n.setAttribute("aria-selected","false"))}},Rb=class{constructor(e,t,n){this.trait=e;this.view=t;this.identityProvider=n}splice(e,t,n){if(!this.identityProvider)return this.trait.splice(e,t,new Array(n.length).fill(!1));let i=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(i.length===0)return this.trait.splice(e,t,new Array(n.length).fill(!1));let r=new Set(i),s=n.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,s)}};function Ob(o,e){return o.classList.contains(e)?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:Ob(o.parentElement,e)}function nm(o){return Ob(o,"monaco-editor")}function HV(o){return Ob(o,"monaco-custom-toggle")}function UV(o){return Ob(o,"action-item")}function om(o){return Ob(o,"monaco-tree-sticky-row")}function rm(o){return o.classList.contains("monaco-tree-sticky-container")}function W1(o){return o.tagName==="A"&&o.classList.contains("monaco-button")||o.tagName==="DIV"&&o.classList.contains("monaco-button-dropdown")?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:W1(o.parentElement)}var cE=class{constructor(e,t,n){this.list=e;this.view=t;this.multipleSelectionSupport=n.multipleSelectionSupport,this.disposables.add(this.onKeyDown(i=>{switch(i.keyCode){case 3:return this.onEnter(i);case 16:return this.onUpArrow(i);case 18:return this.onDownArrow(i);case 11:return this.onPageUpArrow(i);case 12:return this.onPageDownArrow(i);case 9:return this.onEscape(i);case 31:this.multipleSelectionSupport&&(Fe?i.metaKey:i.ctrlKey)&&this.onCtrlA(i)}}))}disposables=new ne;multipleSelectionDisposables=new ne;multipleSelectionSupport;get onKeyDown(){return j.chain(this.disposables.add(new Ne(this.view.domNode,"keydown")).event,e=>e.filter(t=>!as(t.target)).map(t=>new gt(t)))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(Kn(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};P([me],cE.prototype,"onKeyDown",1);var T3=new class{mightProducePrintableCharacter(o){return o.ctrlKey||o.metaKey||o.altKey?!1:o.keyCode>=31&&o.keyCode<=56||o.keyCode>=21&&o.keyCode<=30||o.keyCode>=98&&o.keyCode<=107||o.keyCode>=85&&o.keyCode<=95}},O1=class{constructor(e,t,n,i,r){this.list=e;this.view=t;this.keyboardNavigationLabelProvider=n;this.keyboardNavigationEventFilter=i;this.delegate=r;this.updateOptions(e.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new ne;disposables=new ne;updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let e=!1,t=j.chain(this.enabledDisposables.add(new Ne(this.view.domNode,"keydown")).event,r=>r.filter(s=>!as(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new gt(s)).filter(s=>e||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>rt.stop(s,!0)).map(s=>s.browserEvent.key)),n=j.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);j.reduce(j.any(t,n),(r,s)=>s===null?null:(r||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),n(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),n(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){let t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?ec(t):t&&ec(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=0,this.triggered=!1;return}let t=this.list.getFocus(),n=t.length>0?t[0]:0,i=this.state===0?1:0;this.state=1;for(let r=0;r<this.list.length;r++){let s=(n+r+i)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(Uc(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}let d=jA(e,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||Uc(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},N1=class{constructor(e,t){this.list=e;this.view=t;let n=j.chain(this.disposables.add(new Ne(t.domNode,"keydown")).event,r=>r.filter(s=>!as(s.target)).map(s=>new gt(s)));j.chain(n,r=>r.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new ne;onTab(e){if(e.target!==this.view.domNode)return;let t=this.list.getFocus();if(t.length===0)return;let n=this.view.domElement(t[0]);if(!n)return;let i=n.querySelector("[tabIndex]");if(!i||!On(i)||i.tabIndex===-1)return;let r=Ce(i).getComputedStyle(i);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),i.focus())}dispose(){this.disposables.dispose()}};function V1(o){return Fe?o.browserEvent.metaKey:o.browserEvent.ctrlKey}function H1(o){return o.browserEvent.shiftKey}function w3(o){return _S(o)&&o.button===2}var WV={isSelectionSingleChangeEvent:V1,isSelectionRangeChangeEvent:H1},Mb=class{constructor(e){this.list=e;e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||WV),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Nn.addTarget(e.getHTMLElement()))),j.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new ne;_onPointer=new k;onPointer=this._onPointer.event;updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||WV))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){nm(e.browserEvent.target)||xo()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(as(e.browserEvent.target)||nm(e.browserEvent.target))return;let t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||as(e.browserEvent.target)||nm(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),w3(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(as(e.browserEvent.target)||nm(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){let t=e.index,n=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof n>"u"&&(n=this.list.getFocus()[0]??t,this.list.setAnchor(n));let i=Math.min(n,t),r=Math.max(n,t),s=Kn(i,r+1),a=this.list.getSelection(),l=_3(A1(a,[n]),n);if(l.length===0)return;let d=A1(s,L3(a,l));this.list.setSelection(d,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){let i=this.list.getSelection(),r=i.filter(s=>s!==t);this.list.setFocus([t]),this.list.setAnchor(t),i.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}},uE=class{constructor(e,t){this.styleElement=e;this.selectorSuffix=t}style(e){let t=this.selectorSuffix&&`.${this.selectorSuffix}`,n=[];e.listBackground&&n.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&n.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(n.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&n.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);let i=Vr(e.listFocusAndSelectionOutline,Vr(e.listSelectionOutline,e.listFocusOutline??""));i&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${i}; outline-offset: -1px;}`),e.listFocusOutline&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);let r=Vr(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&n.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&n.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&n.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&n.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&n.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&n.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&n.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=n.join(`
`)}},pE={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:V.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:V.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:V.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},x3={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function _3(o,e){let t=o.indexOf(e);if(t===-1)return[];let n=[],i=t-1;for(;i>=0&&o[i]===e-(t-i);)n.push(o[i--]);for(n.reverse(),i=t;i<o.length&&o[i]===e+(i-t);)n.push(o[i++]);return n}function A1(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){t.push(o[n]),n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):t.push(e[i++]);return t}function L3(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):i++;return t}var VV=(o,e)=>o-e,P1=class{constructor(e,t){this._templateId=e;this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,n,i){let r=0;for(let s of this.renderers)s.renderElement(e,t,n[r++],i)}disposeElement(e,t,n,i){let r=0;for(let s of this.renderers)s.disposeElement?.(e,t,n[r],i),r+=1}disposeTemplate(e){let t=0;for(let n of this.renderers)n.disposeTemplate(e[t++])}},F1=class{constructor(e){this.accessibilityProvider=e}templateId="a18n";renderTemplate(e){return{container:e,disposables:new ne}}renderElement(e,t,n){let i=this.accessibilityProvider.getAriaLabel(e),r=i&&typeof i!="string"?i:ud(i);n.disposables.add(ot(a=>{this.setAriaLabel(a.readObservable(r),n.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof s=="number"?n.container.setAttribute("aria-level",`${s}`):n.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,n,i){n.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}},B1=class{constructor(e,t){this.list=e;this.dnd=t}getDragElements(e){let t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,n,i,r){return this.dnd.onDragOver(e,t,n,i,r)}onDragLeave(e,t,n,i){this.dnd.onDragLeave?.(e,t,n,i)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,n,i,r){this.dnd.drop(e,t,n,i,r)}dispose(){this.dnd.dispose()}},Jn=class{constructor(e,t,n,i,r=x3){this.user=e;this._options=r;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new M1(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new F1(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),i=i.map(d=>new P1(d.templateId,[...a,d]));let l={...r,dnd:r.dnd&&new B1(this,r.dnd)};if(this.view=this.createListView(t,n,i,l),this.view.domNode.setAttribute("role",s),r.styleController)this.styleController=r.styleController(this.view.domId);else{let d=pr(this.view.domNode);this.styleController=new uE(d,this.view.domId)}if(this.spliceable=new dE([new Rb(this.focus,this.view,r.identityProvider),new Rb(this.selection,this.view,r.identityProvider),new Rb(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new N1(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new cE(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){let d=r.keyboardNavigationDelegate||T3;this.typeNavigationController=new O1(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new im("focused");selection;anchor=new im("anchor");eventBufferer=new hd;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new ne;get onDidChangeFocus(){return j.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return j.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1,t=j.chain(this.disposables.add(new Ne(this.view.domNode,"keydown")).event,r=>r.map(s=>new gt(s)).filter(s=>e=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>rt.stop(s,!0)).filter(()=>!1)),n=j.chain(this.disposables.add(new Ne(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(s=>new gt(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>rt.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),i=j.chain(this.view.onContextMenu,r=>r.filter(s=>!e).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new qi(Ce(this.view.domNode),l),browserEvent:l})));return j.any(t,n,i)}get onKeyDown(){return this.disposables.add(new Ne(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new Ne(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new Ne(this.view.domNode,"keypress")).event}get onDidFocus(){return j.signal(this.disposables.add(new Ne(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return j.signal(this.disposables.add(new Ne(this.view.domNode,"blur",!0)).event)}_onDidDispose=new k;onDidDispose=this._onDidDispose.event;createListView(e,t,n,i){return new lE(e,t,n,i)}createMouseController(e){return new Mb(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,n=[]){if(e<0||e>this.view.length)throw new Va(this.user,`Invalid start index: ${e}`);if(t<0)throw new Va(this.user,`Invalid delete count: ${t}`);t===0&&n.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,n))}updateWidth(e){this.view.updateWidth(e)}updateElementHeight(e,t){this.view.updateElementHeight(e,t,null)}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(e){this.view.setScrollLeft(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(e,t){for(let n of e)if(n<0||n>=this.length)throw new Va(this.user,`Invalid index ${n}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new Va(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(let n of e)if(n<0||n>=this.length)throw new Va(this.user,`Invalid index ${n}`);this.focus.set(e,t)}focusNext(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findNextIndex(r.length>0?r[0]+e:0,t,i);s>-1&&this.setFocus([s],n)}focusPrevious(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findPreviousIndex(r.length>0?r[0]-e:0,t,i);s>-1&&this.setFocus([s],n)}async focusNextPage(e,t){let n=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);n=n===0?0:n-1;let i=this.getFocus()[0];if(i!==n&&(i===void 0||n>i)){let r=this.findPreviousIndex(n,!1,t);r>-1&&i!==r?this.setFocus([r],e):this.setFocus([n],e)}else{let r=this.view.getScrollTop(),s=r+this.view.renderHeight;n>i&&(s-=this.view.elementHeight(n)),this.view.setScrollTop(s),this.view.getScrollTop()!==r&&(this.setFocus([]),await wi(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,n=()=>0){let i,r=n(),s=this.view.getScrollTop()+r;s===0?i=this.view.indexAt(s):i=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==i&&(a===void 0||a>=i)){let l=this.findNextIndex(i,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([i],e)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-r),this.view.getScrollTop()+n()!==l&&(this.setFocus([]),await wi(0),await this.focusPreviousPage(e,t,n))}}focusLast(e,t){if(this.length===0)return;let n=this.findPreviousIndex(this.length-1,!1,t);n>-1&&this.setFocus([n],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,n){if(this.length===0)return;let i=this.findNextIndex(e,!1,n);i>-1&&this.setFocus([i],t)}findNextIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!n||n(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!n||n(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,n=0){if(e<0||e>=this.length)throw new Va(this.user,`Invalid index ${e}`);let i=this.view.getScrollTop(),r=this.view.elementTop(e),s=this.view.elementHeight(e);if(Ui(t)){let a=s-this.view.renderHeight+n;this.view.setScrollTop(a*Di(t,0,1)+r-n)}else{let a=r+s,l=i+this.view.renderHeight;r<i+n&&a>=l||(r<i+n||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(r-n):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new Va(this.user,`Invalid index ${e}`);let n=this.view.getScrollTop(),i=this.view.elementTop(e),r=this.view.elementHeight(e);if(i<n+t||i+r>n+this.view.renderHeight)return null;let s=r-this.view.renderHeight+t;return Math.abs((n+t-i)/s)}isDOMFocused(){return Br(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(n=>this.view.element(n)),browserEvent:t}}_onFocusChange(){let e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};P([me],Jn.prototype,"onDidChangeFocus",1),P([me],Jn.prototype,"onDidChangeSelection",1),P([me],Jn.prototype,"onContextMenu",1),P([me],Jn.prototype,"onKeyDown",1),P([me],Jn.prototype,"onKeyUp",1),P([me],Jn.prototype,"onKeyPress",1),P([me],Jn.prototype,"onDidFocus",1),P([me],Jn.prototype,"onDidBlur",1);var U1=class{constructor(e,t){this.renderer=e;this.modelProvider=t}get templateId(){return this.renderer.templateId}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:F.None}}renderElement(e,t,n,i){if(n.disposable?.dispose(),!n.data)return;let r=this.modelProvider();if(r.isResolved(e))return this.renderer.renderElement(r.get(e),e,n.data,i);let s=new Rn,a=r.resolve(e,s.token);n.disposable={dispose:()=>s.cancel()},this.renderer.renderPlaceholder(e,n.data),a.then(l=>this.renderer.renderElement(l,e,n.data,i))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}},z1=class{constructor(e,t){this.modelProvider=e;this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){let t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}};function D3(o,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new z1(o,e.accessibilityProvider)}}var hE=class{list;_model;constructor(e,t,n,i,r={}){let s=()=>this.model,a=i.map(l=>new U1(l,s));this.list=new Jn(e,t,n,a,D3(s,r))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}isDOMFocused(){return Br(this.getHTMLElement())}domFocus(){this.list.domFocus()}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseClick(){return j.map(this.list.onMouseClick,({element:e,index:t,browserEvent:n})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:n}))}get onMouseDblClick(){return j.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:n})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:n}))}get onTap(){return j.map(this.list.onTap,({element:e,index:t,browserEvent:n})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:n}))}get onPointer(){return j.map(this.list.onPointer,({element:e,index:t,browserEvent:n})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:n}))}get onDidChangeFocus(){return j.map(this.list.onDidChangeFocus,({elements:e,indexes:t,browserEvent:n})=>({elements:e.map(i=>this._model.get(i)),indexes:t,browserEvent:n}))}get onDidChangeSelection(){return j.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:n})=>({elements:e.map(i=>this._model.get(i)),indexes:t,browserEvent:n}))}get onContextMenu(){return j.map(this.list.onContextMenu,({element:e,index:t,anchor:n,browserEvent:i})=>typeof e>"u"?{element:e,index:t,anchor:n,browserEvent:i}:{element:this._model.get(e),index:t,anchor:n,browserEvent:i})}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,Kn(e.length))}get length(){return this.list.length}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(e){this.list.scrollLeft=e}setAnchor(e){this.list.setAnchor(e)}getAnchor(){return this.list.getAnchor()}setFocus(e){this.list.setFocus(e)}focusNext(e,t){this.list.focusNext(e,t)}focusPrevious(e,t){this.list.focusPrevious(e,t)}focusNextPage(){return this.list.focusNextPage()}focusPreviousPage(){return this.list.focusPreviousPage()}focusLast(){this.list.focusLast()}focusFirst(){this.list.focusFirst()}getFocus(){return this.list.getFocus()}setSelection(e,t){this.list.setSelection(e,t)}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}layout(e,t){this.list.layout(e,t)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}reveal(e,t){this.list.reveal(e,t)}style(e){this.list.style(e)}dispose(){this.list.dispose()}};var k3={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function _o(){return k3}var R3=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),K1=R3,M3=new Gn(()=>K1("mouse",!1)),O3=new Gn(()=>K1("element",!1));function An(o){return o==="element"?O3.value:M3.value}function Wl(){return K1("element",!0)}var A3={separatorBorder:V.transparent};var mE=class{constructor(e,t,n,i){this.container=e;this.view=t;this.disposable=i;typeof n=="number"?(this._size=n,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=n.cachedVisibleSize)}_size;set size(e){this._size=e}get size(){return this._size}_cachedVisibleSize=void 0;get cachedVisibleSize(){return this._cachedVisibleSize}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){if(e!==this.visible){e?(this.size=Di(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{this.view.setVisible?.(e)}catch(n){console.error("Splitview: Failed to set visible view"),console.error(n)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(n){console.error("Splitview: Failed to layout view"),console.error(n)}}dispose(){this.disposable.dispose()}},G1=class extends mE{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}},j1=class extends mE{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}};var nc;(i=>{i.Distribute={type:"distribute"};function e(r){return{type:"split",index:r}}i.Split=e;function t(r){return{type:"auto",index:r}}i.Auto=t;function n(r){return{type:"invisible",cachedVisibleSize:r}}i.Invisible=n})(nc||={});var Mu=class extends F{orientation;el;sashContainer;viewContainer;scrollable;scrollableElement;size=0;layoutContext;_contentSize=0;proportions=void 0;viewItems=[];sashItems=[];sashDragState;state=0;inverseAltBehavior;proportionalLayout;getSashOrthogonalSize;_onDidSashChange=this._register(new k);_onDidSashReset=this._register(new k);_orthogonalStartSash;_orthogonalEndSash;_startSnappingEnabled=!0;_endSnappingEnabled=!0;get contentSize(){return this._contentSize}onDidSashChange=this._onDidSashChange.event;onDidSashReset=this._onDidSashReset.event;onDidScroll;get length(){return this.viewItems.length}get minimumSize(){return this.viewItems.reduce((e,t)=>e+t.minimumSize,0)}get maximumSize(){return this.length===0?Number.POSITIVE_INFINITY:this.viewItems.reduce((e,t)=>e+t.maximumSize,0)}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(let t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(let t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}get sashes(){return this.sashItems.map(e=>e.sash)}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=dt(this.el,Ke(".sash-container")),this.viewContainer=Ke(".split-view-container"),this.scrollable=this._register(new Es({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:i=>Xn(Ce(this.el),i)})),this.scrollableElement=this._register(new Jd(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));let n=this._register(new Ne(this.viewContainer,"scroll")).event;this._register(n(i=>{let r=this.scrollableElement.getScrollPosition(),s=Math.abs(this.viewContainer.scrollLeft-r.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-r.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(s!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:s,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(i=>{i.scrollTopChanged&&(this.viewContainer.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this.viewContainer.scrollLeft=i.scrollLeft)})),dt(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||A3),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((i,r)=>{let s=qn(i.visible)||i.visible?i.size:{type:"invisible",cachedVisibleSize:i.size},a=i.view;this.doAddView(a,s,r,!0)}),this._contentSize=this.viewItems.reduce((i,r)=>i+r.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,n=this.viewItems.length,i){this.doAddView(e,t,n,i)}removeView(e,t){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{t?.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index});let n=t?.type==="split"?this.viewItems[t.index]:void 0,i=this.viewItems.splice(e,1)[0];if(n&&(n.size+=i.size),this.viewItems.length>=1){let s=Math.max(e-1,0);this.sashItems.splice(s,1)[0].disposable.dispose()}this.relayout(),t?.type==="distribute"&&this.distributeViewSizes();let r=i.view;return i.dispose(),r}finally{this.state=0}}removeAllViews(){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let e=this.viewItems.splice(0,this.viewItems.length);for(let n of e)n.dispose();let t=this.sashItems.splice(0,this.sashItems.length);for(let n of t)n.disposable.dispose();return this.relayout(),e.map(n=>n.view)}finally{this.state=0}}moveView(e,t){if(this.state!==0)throw new Error("Cant modify splitview");let n=this.getViewCachedVisibleSize(e),i=typeof n>"u"?this.getViewSize(e):nc.Invisible(n),r=this.removeView(e);this.addView(r,i,t)}swapViews(e,t){if(this.state!==0)throw new Error("Cant modify splitview");if(e>t)return this.swapViews(t,e);let n=this.getViewSize(e),i=this.getViewSize(t),r=this.removeView(t),s=this.removeView(e);this.addView(r,n,e),this.addView(s,i,t)}isViewVisible(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].visible}setViewVisible(e,t){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");this.viewItems[e].setVisible(t),this.distributeEmptySpace(e),this.layoutViews(),this.saveProportions()}getViewCachedVisibleSize(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].cachedVisibleSize}layout(e,t){let n=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let i=0;for(let r=0;r<this.viewItems.length;r++){let s=this.viewItems[r],a=this.proportions[r];typeof a=="number"?i+=a:e-=s.size}for(let r=0;r<this.viewItems.length;r++){let s=this.viewItems[r],a=this.proportions[r];typeof a=="number"&&i>0&&(s.size=Di(Math.round(a*e/i),s.minimumSize,s.maximumSize))}}else{let i=Kn(this.viewItems.length),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-n,void 0,r,s)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:n}){for(let a of this.viewItems)a.enabled=!1;let i=this.sashItems.findIndex(a=>a.sash===e),r=Mo(q(this.el.ownerDocument.body,"keydown",a=>s(this.sashDragState.current,a.altKey)),q(this.el.ownerDocument.body,"keyup",()=>s(this.sashDragState.current,!1))),s=(a,l)=>{let d=this.viewItems.map(f=>f.size),c=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(i===this.sashItems.length-1){let g=this.viewItems[i];c=(g.minimumSize-g.size)/2,u=(g.maximumSize-g.size)/2}else{let g=this.viewItems[i+1];c=(g.size-g.maximumSize)/2,u=(g.size-g.minimumSize)/2}let p,h;if(!l){let f=Kn(i,-1),g=Kn(i+1,this.viewItems.length),b=f.reduce((D,O)=>D+(this.viewItems[O].minimumSize-d[O]),0),v=f.reduce((D,O)=>D+(this.viewItems[O].viewMaximumSize-d[O]),0),I=g.length===0?Number.POSITIVE_INFINITY:g.reduce((D,O)=>D+(d[O]-this.viewItems[O].minimumSize),0),T=g.length===0?Number.NEGATIVE_INFINITY:g.reduce((D,O)=>D+(d[O]-this.viewItems[O].viewMaximumSize),0),S=Math.max(b,T),C=Math.min(I,v),w=this.findFirstSnapIndex(f),x=this.findFirstSnapIndex(g);if(typeof w=="number"){let D=this.viewItems[w],O=Math.floor(D.viewMinimumSize/2);p={index:w,limitDelta:D.visible?S-O:S+O,size:D.size}}if(typeof x=="number"){let D=this.viewItems[x],O=Math.floor(D.viewMinimumSize/2);h={index:x,limitDelta:D.visible?C+O:C-O,size:D.size}}}this.sashDragState={start:a,current:a,index:i,sizes:d,minDelta:c,maxDelta:u,alt:l,snapBefore:p,snapAfter:h,disposable:r}};s(t,n)}onSashChange({current:e}){let{index:t,start:n,sizes:i,alt:r,minDelta:s,maxDelta:a,snapBefore:l,snapAfter:d}=this.sashDragState;this.sashDragState.current=e;let c=e-n,u=this.resize(t,c,i,void 0,void 0,s,a,l,d);if(r){let p=t===this.sashItems.length-1,h=this.viewItems.map(T=>T.size),f=p?t:t+1,g=this.viewItems[f],b=g.size-g.maximumSize,v=g.size-g.minimumSize,I=p?t-1:t+1;this.resize(I,-u,h,void 0,void 0,b,v)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(let t of this.viewItems)t.enabled=!0}onViewChange(e,t){let n=this.viewItems.indexOf(e);n<0||n>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=Di(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&n>0?(this.resize(n-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([n],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let n=Kn(this.viewItems.length).filter(a=>a!==e),i=[...n.filter(a=>this.viewItems[a].priority===1),e],r=n.filter(a=>this.viewItems[a].priority===2),s=this.viewItems[e];t=Math.round(t),t=Di(t,s.minimumSize,Math.min(s.maximumSize,this.size)),s.size=t,this.relayout(i,r)}finally{this.state=0}}}isViewExpanded(e){if(e<0||e>=this.viewItems.length)return!1;for(let t of this.viewItems)if(t!==this.viewItems[e]&&t.size>t.minimumSize)return!1;return!0}distributeViewSizes(){let e=[],t=0;for(let a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);let n=Math.floor(t/e.length);for(let a of e)a.size=Di(n,a.minimumSize,a.maximumSize);let i=Kn(this.viewItems.length),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);this.relayout(r,s)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,n=this.viewItems.length,i){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let r=Ke(".split-view-view");n===this.viewItems.length?this.viewContainer.appendChild(r):this.viewContainer.insertBefore(r,this.viewContainer.children.item(n));let s=e.onDidChange(p=>this.onViewChange(c,p)),a=pe(()=>r.remove()),l=Mo(s,a),d;typeof t=="number"?d=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?d=this.getViewSize(t.index)/2:t.type==="invisible"?d={cachedVisibleSize:t.cachedVisibleSize}:d=e.minimumSize);let c=this.orientation===0?new G1(r,e,d,l):new j1(r,e,d,l);if(this.viewItems.splice(n,0,c),this.viewItems.length>1){let p={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},h=this.orientation===0?new Iu(this.sashContainer,{getHorizontalSashTop:D=>this.getSashPosition(D),getHorizontalSashWidth:this.getSashOrthogonalSize},{...p,orientation:1}):new Iu(this.sashContainer,{getVerticalSashLeft:D=>this.getSashPosition(D),getVerticalSashHeight:this.getSashOrthogonalSize},{...p,orientation:0}),f=this.orientation===0?D=>({sash:h,start:D.startY,current:D.currentY,alt:D.altKey}):D=>({sash:h,start:D.startX,current:D.currentX,alt:D.altKey}),b=j.map(h.onDidStart,f)(this.onSashStart,this),I=j.map(h.onDidChange,f)(this.onSashChange,this),S=j.map(h.onDidEnd,()=>this.sashItems.findIndex(D=>D.sash===h))(this.onSashEnd,this),C=h.onDidReset(()=>{let D=this.sashItems.findIndex(ie=>ie.sash===h),O=Kn(D,-1),H=Kn(D+1,this.viewItems.length),K=this.findFirstSnapIndex(O),z=this.findFirstSnapIndex(H);typeof K=="number"&&!this.viewItems[K].visible||typeof z=="number"&&!this.viewItems[z].visible||this._onDidSashReset.fire(D)}),w=Mo(b,I,S,C,h),x={sash:h,disposable:w};this.sashItems.splice(n-1,0,x)}r.appendChild(e.element);let u;typeof t!="number"&&t.type==="split"&&(u=[t.index]),i||this.relayout([n],u),!i&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=0}}relayout(e,t){let n=this.viewItems.reduce((i,r)=>i+r.size,0);this.resize(this.viewItems.length-1,this.size-n,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,n=this.viewItems.map(c=>c.size),i,r,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,d){if(e<0||e>=this.viewItems.length)return 0;let c=Kn(e,-1),u=Kn(e+1,this.viewItems.length);if(r)for(let x of r)ay(c,x),ay(u,x);if(i)for(let x of i)Rg(c,x),Rg(u,x);let p=c.map(x=>this.viewItems[x]),h=c.map(x=>n[x]),f=u.map(x=>this.viewItems[x]),g=u.map(x=>n[x]),b=c.reduce((x,D)=>x+(this.viewItems[D].minimumSize-n[D]),0),v=c.reduce((x,D)=>x+(this.viewItems[D].maximumSize-n[D]),0),I=u.length===0?Number.POSITIVE_INFINITY:u.reduce((x,D)=>x+(n[D]-this.viewItems[D].minimumSize),0),T=u.length===0?Number.NEGATIVE_INFINITY:u.reduce((x,D)=>x+(n[D]-this.viewItems[D].maximumSize),0),S=Math.max(b,T,s),C=Math.min(I,v,a),w=!1;if(l){let x=this.viewItems[l.index],D=t>=l.limitDelta;w=D!==x.visible,x.setVisible(D,l.size)}if(!w&&d){let x=this.viewItems[d.index],D=t<d.limitDelta;w=D!==x.visible,x.setVisible(D,d.size)}if(w)return this.resize(e,t,n,i,r,s,a);t=Di(t,S,C);for(let x=0,D=t;x<p.length;x++){let O=p[x],H=Di(h[x]+D,O.minimumSize,O.maximumSize),K=H-h[x];D-=K,O.size=H}for(let x=0,D=t;x<f.length;x++){let O=f[x],H=Di(g[x]-D,O.minimumSize,O.maximumSize),K=H-g[x];D+=K,O.size=H}return t}distributeEmptySpace(e){let t=this.viewItems.reduce((a,l)=>a+l.size,0),n=this.size-t,i=Kn(this.viewItems.length-1,-1),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);for(let a of s)ay(i,a);for(let a of r)Rg(i,a);typeof e=="number"&&Rg(i,e);for(let a=0;n!==0&&a<i.length;a++){let l=this.viewItems[i[a]],d=Di(l.size+n,l.minimumSize,l.maximumSize),c=d-l.size;n-=c,l.size=d}}layoutViews(){this._contentSize=this.viewItems.reduce((t,n)=>t+n.size,0);let e=0;for(let t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1,t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;let n=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),i=[...this.viewItems].reverse();e=!1;let r=i.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;let s=i.map(l=>e=l.maximumSize-l.size>0||e).reverse(),a=0;for(let l=0;l<this.sashItems.length;l++){let{sash:d}=this.sashItems[l],c=this.viewItems[l];a+=c.size;let u=!(t[l]&&s[l+1]),p=!(n[l]&&r[l+1]);if(u&&p){let h=Kn(l,-1),f=Kn(l+1,this.viewItems.length),g=this.findFirstSnapIndex(h),b=this.findFirstSnapIndex(f),v=typeof g=="number"&&!this.viewItems[g].visible,I=typeof b=="number"&&!this.viewItems[b].visible;v&&r[l]&&(a>0||this.startSnappingEnabled)?d.state=1:I&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?d.state=2:d.state=0}else u&&!p?d.state=1:!u&&p?d.state=2:d.state=3}}getSashPosition(e){let t=0;for(let n=0;n<this.sashItems.length;n++)if(t+=this.viewItems[n].size,this.sashItems[n].sash===e)return t;return 0}findFirstSnapIndex(e){for(let t of e){let n=this.viewItems[t];if(n.visible&&n.snap)return t}for(let t of e){let n=this.viewItems[t];if(n.visible&&n.maximumSize-n.minimumSize>0)return;if(!n.visible&&n.snap)return t}}areViewsDistributed(){let e,t;for(let n of this.viewItems)if(e=e===void 0?n.size:Math.min(e,n.size),t=t===void 0?n.size:Math.max(t,n.size),t-e>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),Tt(this.viewItems),this.viewItems=[],this.sashItems.forEach(e=>e.disposable.dispose()),this.sashItems=[],super.dispose()}};var gE=class o{constructor(e,t,n){this.columns=e;this.getColumnSize=n;let i=new Map(t.map(r=>[r.templateId,r]));this.renderers=[];for(let r of e){let s=i.get(r.templateId);if(!s)throw new Error(`Table cell renderer for template id ${r.templateId} not found.`);this.renderers.push(s)}}static TemplateId="row";templateId=o.TemplateId;renderers;renderedTemplates=new Set;renderTemplate(e){let t=dt(e,Ke(".monaco-table-tr")),n=[],i=[];for(let s=0;s<this.columns.length;s++){let a=this.renderers[s],l=dt(t,Ke(".monaco-table-td",{"data-col-index":s}));l.style.width=`${this.getColumnSize(s)}px`,n.push(l),i.push(a.renderTemplate(l))}let r={container:e,cellContainers:n,cellTemplateData:i};return this.renderedTemplates.add(r),r}renderElement(e,t,n,i){for(let r=0;r<this.columns.length;r++){let a=this.columns[r].project(e);this.renderers[r].renderElement(a,t,n.cellTemplateData[r],i)}}disposeElement(e,t,n,i){for(let r=0;r<this.columns.length;r++){let s=this.renderers[r];if(s.disposeElement){let l=this.columns[r].project(e);s.disposeElement(l,t,n.cellTemplateData[r],i)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);fi(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(let{cellContainers:n}of this.renderedTemplates)n[e].style.width=`${t}px`}};function P3(o){return{getHeight(e){return o.getHeight(e)},getTemplateId(){return gE.TemplateId}}}var q1=class extends F{constructor(t,n){super();this.column=t;this.index=n;this.element=Ke(".monaco-table-th",{"data-col-index":n},t.label),t.tooltip&&this._register(_o().setupManagedHover(An("mouse"),this.element,t.tooltip))}element;get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??j.None}_onDidLayout=new k;onDidLayout=this._onDidLayout.event;layout(t){this._onDidLayout.fire([this.index,t])}},fE=class o{constructor(e,t,n,i,r,s){this.virtualDelegate=n;this.columns=i;this.domNode=dt(t,Ke(`.monaco-table.${this.domId}`));let a=i.map((c,u)=>this.disposables.add(new q1(c,u))),l={size:a.reduce((c,u)=>c+u.column.weight,0),views:a.map(c=>({size:c.column.weight,view:c}))};this.splitview=this.disposables.add(new Mu(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${n.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${n.headerRowHeight}px`;let d=new gE(i,r,c=>this.splitview.getViewSize(c));this.list=this.disposables.add(new Jn(e,this.domNode,P3(n),[d],s)),j.any(...a.map(c=>c.onDidLayout))(([c,u])=>d.layoutColumn(c,u),null,this.disposables),this.splitview.onDidSashReset(c=>{let u=i.reduce((h,f)=>h+f.weight,0),p=i[c].weight/u*this.cachedWidth;this.splitview.resizeView(c,p)},null,this.disposables),this.styleElement=pr(this.domNode),this.style(pE)}static InstanceCount=0;domId=`table_id_${++o.InstanceCount}`;domNode;splitview;list;styleElement;disposables=new ne;cachedWidth=0;cachedHeight=0;get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseClick(){return this.list.onMouseClick}get onMouseDblClick(){return this.list.onMouseDblClick}get onMouseMiddleClick(){return this.list.onMouseMiddleClick}get onPointer(){return this.list.onPointer}get onMouseUp(){return this.list.onMouseUp}get onMouseDown(){return this.list.onMouseDown}get onMouseOver(){return this.list.onMouseOver}get onMouseMove(){return this.list.onMouseMove}get onMouseOut(){return this.list.onMouseOut}get onTouchStart(){return this.list.onTouchStart}get onTap(){return this.list.onTap}get onContextMenu(){return this.list.onContextMenu}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(e){this.list.scrollLeft=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}getColumnLabels(){return this.columns.map(e=>e.label)}resizeColumn(e,t){let n=Math.round(t/100*this.cachedWidth);this.splitview.resizeView(e,n)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,n=[]){this.list.splice(e,t,n)}rerender(){this.list.rerender()}row(e){return this.list.element(e)}indexOf(e){return this.list.indexOf(e)}get length(){return this.list.length}getHTMLElement(){return this.domNode}layout(e,t){e=e??ES(this.domNode),t=t??Uh(this.domNode),this.cachedWidth=t,this.cachedHeight=e,this.splitview.layout(t);let n=e-this.virtualDelegate.headerRowHeight;this.list.getHTMLElement().style.height=`${n}px`,this.list.layout(n,t)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}style(e){let t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}domFocus(){this.list.domFocus()}setAnchor(e){this.list.setAnchor(e)}getAnchor(){return this.list.getAnchor()}getSelectedElements(){return this.list.getSelectedElements()}setSelection(e,t){this.list.setSelection(e,t)}getSelection(){return this.list.getSelection()}setFocus(e,t){this.list.setFocus(e,t)}focusNext(e=1,t=!1,n){this.list.focusNext(e,t,n)}focusPrevious(e=1,t=!1,n){this.list.focusPrevious(e,t,n)}focusNextPage(e){return this.list.focusNextPage(e)}focusPreviousPage(e){return this.list.focusPreviousPage(e)}focusFirst(e){this.list.focusFirst(e)}focusLast(e){this.list.focusLast(e)}getFocus(){return this.list.getFocus()}getFocusedElements(){return this.list.getFocusedElements()}getRelativeTop(e){return this.list.getRelativeTop(e)}reveal(e,t){this.list.reveal(e,t)}dispose(){this.disposables.dispose()}};function zV(o,e={}){let t=bE(e);return t.textContent=o,t}function KV(o,e={}){let t=bE(e);return GV(t,F3(o,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function bE(o){let e=o.inline?"span":"div",t=document.createElement(e);return o.className&&(t.className=o.className),t}var $1=class{source;index;constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){let e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}};function GV(o,e,t,n){let i;if(e.type===2)i=document.createTextNode(e.content||"");else if(e.type===3)i=document.createElement("b");else if(e.type===4)i=document.createElement("i");else if(e.type===7&&n)i=document.createElement("code");else if(e.type===5&&t){let r=document.createElement("a");t.disposables.add(hn(r,"click",s=>{t.callback(String(e.index),s)})),i=r}else e.type===8?i=document.createElement("br"):e.type===1&&(i=o);i&&o!==i&&o.appendChild(i),i&&Array.isArray(e.children)&&e.children.forEach(r=>{GV(i,r,t,n)})}function F3(o,e){let t={type:1,children:[]},n=0,i=t,r=[],s=new $1(o);for(;!s.eos();){let a=s.next(),l=a==="\\"&&Y1(s.peek(),e)!==0;if(l&&(a=s.next()),!l&&B3(a,e)&&a===s.peek()){s.advance(),i.type===2&&(i=r.pop());let d=Y1(a,e);if(i.type===d||i.type===5&&d===6)i=r.pop();else{let c={type:d,children:[]};d===5&&(c.index=n,n++),i.children.push(c),r.push(i),i=c}}else if(a===`
`)i.type===2&&(i=r.pop()),i.children.push({type:8});else if(i.type!==2){let d={type:2,content:a};i.children.push(d),r.push(i),i=d}else i.content+=a}return i.type===2&&(i=r.pop()),r.length,t}function B3(o,e){return Y1(o,e)!==0}function Y1(o,e){switch(o){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}var W3=new RegExp(`(\\\\)?\\$\\((${Be.iconNameExpression}(?:${Be.iconModifierExpression})?)\\)`,"g");function Nb(o){let e=new Array,t,n=0,i=0;for(;(t=W3.exec(o))!==null;){i=t.index||0,n<i&&e.push(o.substring(n,i)),n=(t.index||0)+t[0].length;let[,r,s]=t;e.push(r?`$(${s})`:sm({id:s}))}return n<o.length&&e.push(o.substring(n)),e}function sm(o){let e=Ke("span");return e.classList.add(...Be.asClassNameArray(o)),e}var Z1=class{_prefix;_lastId;constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},Q1=new Z1("id#");var ki={};(function(){function o(e,t){t(ki)}o.amd=!0,function(e,t){typeof o=="function"&&o.amd?o(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){"use strict";function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function n(ze){e.defaults=ze}let i=/[&<>"']/,r=new RegExp(i.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=ze=>l[ze];function c(ze,L){if(L){if(i.test(ze))return ze.replace(r,d)}else if(s.test(ze))return ze.replace(a,d);return ze}let u=/(^|[^\[])\^/g;function p(ze,L){let R=typeof ze=="string"?ze:ze.source;L=L||"";let N={replace:(W,U)=>{let Z=typeof U=="string"?U:U.source;return Z=Z.replace(u,"$1"),R=R.replace(W,Z),N},getRegex:()=>new RegExp(R,L)};return N}function h(ze){try{ze=encodeURI(ze).replace(/%25/g,"%")}catch{return null}return ze}let f={exec:()=>null};function g(ze,L){let R=ze.replace(/\|/g,(U,Z,oe)=>{let we=!1,Le=Z;for(;--Le>=0&&oe[Le]==="\\";)we=!we;return we?"|":" |"}),N=R.split(/ \|/),W=0;if(N[0].trim()||N.shift(),N.length>0&&!N[N.length-1].trim()&&N.pop(),L)if(N.length>L)N.splice(L);else for(;N.length<L;)N.push("");for(;W<N.length;W++)N[W]=N[W].trim().replace(/\\\|/g,"|");return N}function b(ze,L,R){let N=ze.length;if(N===0)return"";let W=0;for(;W<N;){let U=ze.charAt(N-W-1);if(U===L&&!R)W++;else if(U!==L&&R)W++;else break}return ze.slice(0,N-W)}function v(ze,L){if(ze.indexOf(L[1])===-1)return-1;let R=0;for(let N=0;N<ze.length;N++)if(ze[N]==="\\")N++;else if(ze[N]===L[0])R++;else if(ze[N]===L[1]&&(R--,R<0))return N;return-1}function I(ze,L,R,N){let W=L.href,U=L.title?c(L.title):null,Z=ze[1].replace(/\\([\[\]])/g,"$1");if(ze[0].charAt(0)!=="!"){N.state.inLink=!0;let oe={type:"link",raw:R,href:W,title:U,text:Z,tokens:N.inlineTokens(Z)};return N.state.inLink=!1,oe}return{type:"image",raw:R,href:W,title:U,text:c(Z)}}function T(ze,L){let R=ze.match(/^(\s+)(?:```)/);if(R===null)return L;let N=R[1];return L.split(`
`).map(W=>{let U=W.match(/^\s+/);if(U===null)return W;let[Z]=U;return Z.length>=N.length?W.slice(N.length):W}).join(`
`)}class S{options;rules;lexer;constructor(L){this.options=L||e.defaults}space(L){let R=this.rules.block.newline.exec(L);if(R&&R[0].length>0)return{type:"space",raw:R[0]}}code(L){let R=this.rules.block.code.exec(L);if(R){let N=R[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:R[0],codeBlockStyle:"indented",text:this.options.pedantic?N:b(N,`
`)}}}fences(L){let R=this.rules.block.fences.exec(L);if(R){let N=R[0],W=T(N,R[3]||"");return{type:"code",raw:N,lang:R[2]?R[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):R[2],text:W}}}heading(L){let R=this.rules.block.heading.exec(L);if(R){let N=R[2].trim();if(/#$/.test(N)){let W=b(N,"#");(this.options.pedantic||!W||/ $/.test(W))&&(N=W.trim())}return{type:"heading",raw:R[0],depth:R[1].length,text:N,tokens:this.lexer.inline(N)}}}hr(L){let R=this.rules.block.hr.exec(L);if(R)return{type:"hr",raw:b(R[0],`
`)}}blockquote(L){let R=this.rules.block.blockquote.exec(L);if(R){let N=b(R[0],`
`).split(`
`),W="",U="",Z=[];for(;N.length>0;){let oe=!1,we=[],Le;for(Le=0;Le<N.length;Le++)if(/^ {0,3}>/.test(N[Le]))we.push(N[Le]),oe=!0;else if(!oe)we.push(N[Le]);else break;N=N.slice(Le);let it=we.join(`
`),xt=it.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");W=W?`${W}
${it}`:it,U=U?`${U}
${xt}`:xt;let nn=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(xt,Z,!0),this.lexer.state.top=nn,N.length===0)break;let Bn=Z[Z.length-1];if(Bn?.type==="code")break;if(Bn?.type==="blockquote"){let cn=Bn,Ae=cn.raw+`
`+N.join(`
`),G=this.blockquote(Ae);Z[Z.length-1]=G,W=W.substring(0,W.length-cn.raw.length)+G.raw,U=U.substring(0,U.length-cn.text.length)+G.text;break}else if(Bn?.type==="list"){let cn=Bn,Ae=cn.raw+`
`+N.join(`
`),G=this.list(Ae);Z[Z.length-1]=G,W=W.substring(0,W.length-Bn.raw.length)+G.raw,U=U.substring(0,U.length-cn.raw.length)+G.raw,N=Ae.substring(Z[Z.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:W,tokens:Z,text:U}}}list(L){let R=this.rules.block.list.exec(L);if(R){let N=R[1].trim(),W=N.length>1,U={type:"list",raw:"",ordered:W,start:W?+N.slice(0,-1):"",loose:!1,items:[]};N=W?`\\d{1,9}\\${N.slice(-1)}`:`\\${N}`,this.options.pedantic&&(N=W?N:"[*+-]");let Z=new RegExp(`^( {0,3}${N})((?:[	 ][^\\n]*)?(?:\\n|$))`),oe=!1;for(;L;){let we=!1,Le="",it="";if(!(R=Z.exec(L))||this.rules.block.hr.test(L))break;Le=R[0],L=L.substring(Le.length);let xt=R[2].split(`
`,1)[0].replace(/^\t+/,Ie=>" ".repeat(3*Ie.length)),nn=L.split(`
`,1)[0],Bn=!xt.trim(),cn=0;if(this.options.pedantic?(cn=2,it=xt.trimStart()):Bn?cn=R[1].length+1:(cn=R[2].search(/[^ ]/),cn=cn>4?1:cn,it=xt.slice(cn),cn+=R[1].length),Bn&&/^ *$/.test(nn)&&(Le+=nn+`
`,L=L.substring(nn.length+1),we=!0),!we){let Ie=new RegExp(`^ {0,${Math.min(3,cn-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Re=new RegExp(`^ {0,${Math.min(3,cn-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),$t=new RegExp(`^ {0,${Math.min(3,cn-1)}}(?:\`\`\`|~~~)`),zn=new RegExp(`^ {0,${Math.min(3,cn-1)}}#`);for(;L;){let ho=L.split(`
`,1)[0];if(nn=ho,this.options.pedantic&&(nn=nn.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),$t.test(nn)||zn.test(nn)||Ie.test(nn)||Re.test(L))break;if(nn.search(/[^ ]/)>=cn||!nn.trim())it+=`
`+nn.slice(cn);else{if(Bn||xt.search(/[^ ]/)>=4||$t.test(xt)||zn.test(xt)||Re.test(xt))break;it+=`
`+nn}!Bn&&!nn.trim()&&(Bn=!0),Le+=ho+`
`,L=L.substring(ho.length+1),xt=nn.slice(cn)}}U.loose||(oe?U.loose=!0:/\n *\n *$/.test(Le)&&(oe=!0));let Ae=null,G;this.options.gfm&&(Ae=/^\[[ xX]\] /.exec(it),Ae&&(G=Ae[0]!=="[ ] ",it=it.replace(/^\[[ xX]\] +/,""))),U.items.push({type:"list_item",raw:Le,task:!!Ae,checked:G,loose:!1,text:it,tokens:[]}),U.raw+=Le}U.items[U.items.length-1].raw=U.items[U.items.length-1].raw.trimEnd(),U.items[U.items.length-1].text=U.items[U.items.length-1].text.trimEnd(),U.raw=U.raw.trimEnd();for(let we=0;we<U.items.length;we++)if(this.lexer.state.top=!1,U.items[we].tokens=this.lexer.blockTokens(U.items[we].text,[]),!U.loose){let Le=U.items[we].tokens.filter(xt=>xt.type==="space"),it=Le.length>0&&Le.some(xt=>/\n.*\n/.test(xt.raw));U.loose=it}if(U.loose)for(let we=0;we<U.items.length;we++)U.items[we].loose=!0;return U}}html(L){let R=this.rules.block.html.exec(L);if(R)return{type:"html",block:!0,raw:R[0],pre:R[1]==="pre"||R[1]==="script"||R[1]==="style",text:R[0]}}def(L){let R=this.rules.block.def.exec(L);if(R){let N=R[1].toLowerCase().replace(/\s+/g," "),W=R[2]?R[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",U=R[3]?R[3].substring(1,R[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):R[3];return{type:"def",tag:N,raw:R[0],href:W,title:U}}}table(L){let R=this.rules.block.table.exec(L);if(!R||!/[:|]/.test(R[2]))return;let N=g(R[1]),W=R[2].replace(/^\||\| *$/g,"").split("|"),U=R[3]&&R[3].trim()?R[3].replace(/\n[ \t]*$/,"").split(`
`):[],Z={type:"table",raw:R[0],header:[],align:[],rows:[]};if(N.length===W.length){for(let oe of W)/^ *-+: *$/.test(oe)?Z.align.push("right"):/^ *:-+: *$/.test(oe)?Z.align.push("center"):/^ *:-+ *$/.test(oe)?Z.align.push("left"):Z.align.push(null);for(let oe=0;oe<N.length;oe++)Z.header.push({text:N[oe],tokens:this.lexer.inline(N[oe]),header:!0,align:Z.align[oe]});for(let oe of U)Z.rows.push(g(oe,Z.header.length).map((we,Le)=>({text:we,tokens:this.lexer.inline(we),header:!1,align:Z.align[Le]})));return Z}}lheading(L){let R=this.rules.block.lheading.exec(L);if(R)return{type:"heading",raw:R[0],depth:R[2].charAt(0)==="="?1:2,text:R[1],tokens:this.lexer.inline(R[1])}}paragraph(L){let R=this.rules.block.paragraph.exec(L);if(R){let N=R[1].charAt(R[1].length-1)===`
`?R[1].slice(0,-1):R[1];return{type:"paragraph",raw:R[0],text:N,tokens:this.lexer.inline(N)}}}text(L){let R=this.rules.block.text.exec(L);if(R)return{type:"text",raw:R[0],text:R[0],tokens:this.lexer.inline(R[0])}}escape(L){let R=this.rules.inline.escape.exec(L);if(R)return{type:"escape",raw:R[0],text:c(R[1])}}tag(L){let R=this.rules.inline.tag.exec(L);if(R)return!this.lexer.state.inLink&&/^<a /i.test(R[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(R[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(R[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(R[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:R[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:R[0]}}link(L){let R=this.rules.inline.link.exec(L);if(R){let N=R[2].trim();if(!this.options.pedantic&&/^</.test(N)){if(!/>$/.test(N))return;let Z=b(N.slice(0,-1),"\\");if((N.length-Z.length)%2===0)return}else{let Z=v(R[2],"()");if(Z>-1){let we=(R[0].indexOf("!")===0?5:4)+R[1].length+Z;R[2]=R[2].substring(0,Z),R[0]=R[0].substring(0,we).trim(),R[3]=""}}let W=R[2],U="";if(this.options.pedantic){let Z=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(W);Z&&(W=Z[1],U=Z[3])}else U=R[3]?R[3].slice(1,-1):"";return W=W.trim(),/^</.test(W)&&(this.options.pedantic&&!/>$/.test(N)?W=W.slice(1):W=W.slice(1,-1)),I(R,{href:W&&W.replace(this.rules.inline.anyPunctuation,"$1"),title:U&&U.replace(this.rules.inline.anyPunctuation,"$1")},R[0],this.lexer)}}reflink(L,R){let N;if((N=this.rules.inline.reflink.exec(L))||(N=this.rules.inline.nolink.exec(L))){let W=(N[2]||N[1]).replace(/\s+/g," "),U=R[W.toLowerCase()];if(!U){let Z=N[0].charAt(0);return{type:"text",raw:Z,text:Z}}return I(N,U,N[0],this.lexer)}}emStrong(L,R,N=""){let W=this.rules.inline.emStrongLDelim.exec(L);if(!W||W[3]&&N.match(/[\p{L}\p{N}]/u))return;if(!(W[1]||W[2]||"")||!N||this.rules.inline.punctuation.exec(N)){let Z=[...W[0]].length-1,oe,we,Le=Z,it=0,xt=W[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(xt.lastIndex=0,R=R.slice(-1*L.length+Z);(W=xt.exec(R))!=null;){if(oe=W[1]||W[2]||W[3]||W[4]||W[5]||W[6],!oe)continue;if(we=[...oe].length,W[3]||W[4]){Le+=we;continue}else if((W[5]||W[6])&&Z%3&&!((Z+we)%3)){it+=we;continue}if(Le-=we,Le>0)continue;we=Math.min(we,we+Le+it);let nn=[...W[0]][0].length,Bn=L.slice(0,Z+W.index+nn+we);if(Math.min(Z,we)%2){let Ae=Bn.slice(1,-1);return{type:"em",raw:Bn,text:Ae,tokens:this.lexer.inlineTokens(Ae)}}let cn=Bn.slice(2,-2);return{type:"strong",raw:Bn,text:cn,tokens:this.lexer.inlineTokens(cn)}}}}codespan(L){let R=this.rules.inline.code.exec(L);if(R){let N=R[2].replace(/\n/g," "),W=/[^ ]/.test(N),U=/^ /.test(N)&&/ $/.test(N);return W&&U&&(N=N.substring(1,N.length-1)),N=c(N,!0),{type:"codespan",raw:R[0],text:N}}}br(L){let R=this.rules.inline.br.exec(L);if(R)return{type:"br",raw:R[0]}}del(L){let R=this.rules.inline.del.exec(L);if(R)return{type:"del",raw:R[0],text:R[2],tokens:this.lexer.inlineTokens(R[2])}}autolink(L){let R=this.rules.inline.autolink.exec(L);if(R){let N,W;return R[2]==="@"?(N=c(R[1]),W="mailto:"+N):(N=c(R[1]),W=N),{type:"link",raw:R[0],text:N,href:W,tokens:[{type:"text",raw:N,text:N}]}}}url(L){let R;if(R=this.rules.inline.url.exec(L)){let N,W;if(R[2]==="@")N=c(R[0]),W="mailto:"+N;else{let U;do U=R[0],R[0]=this.rules.inline._backpedal.exec(R[0])?.[0]??"";while(U!==R[0]);N=c(R[0]),R[1]==="www."?W="http://"+R[0]:W=R[0]}return{type:"link",raw:R[0],text:N,href:W,tokens:[{type:"text",raw:N,text:N}]}}}inlineText(L){let R=this.rules.inline.text.exec(L);if(R){let N;return this.lexer.state.inRawBlock?N=R[0]:N=c(R[0]),{type:"text",raw:R[0],text:N}}}}let C=/^(?: *(?:\n|$))+/,w=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,x=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,D=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,O=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,H=/(?:[*+-]|\d{1,9}[.)])/,K=p(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,H).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),z=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ie=/^[^\n]+/,Se=/(?!\s*\])(?:\\.|[^\[\]\\])+/,J=p(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Se).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),X=p(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,H).getRegex(),le="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",re=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ee=p("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",re).replace("tag",le).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Te=p(z).replace("hr",D).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",le).getRegex(),Ze={blockquote:p(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Te).getRegex(),code:w,def:J,fences:x,heading:O,hr:D,html:ee,lheading:K,list:X,newline:C,paragraph:Te,table:f,text:ie},Ue=p("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",D).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",le).getRegex(),_e={...Ze,table:Ue,paragraph:p(z).replace("hr",D).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ue).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",le).getRegex()},mn={...Ze,html:p(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",re).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:f,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:p(z).replace("hr",D).replace("heading",` *#{1,6} *[^
]`).replace("lheading",K).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},an=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Pn=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,oi=/^( {2,}|\\)\n(?!\s*$)/,hs=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,At="\\p{P}\\p{S}",Ni=p(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,At).getRegex(),Ec=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Jl=p(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,At).getRegex(),Ai=p("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,At).getRegex(),ed=p("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,At).getRegex(),td=p(/\\([punct])/,"gu").replace(/punct/g,At).getRegex(),hp=p(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),mp=p(re).replace("(?:-->|$)","-->").getRegex(),Ve=p("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",mp).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),il=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,nd=p(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",il).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ta=p(/^!?\[(label)\]\[(ref)\]/).replace("label",il).replace("ref",Se).getRegex(),Gr=p(/^!?\[(ref)\](?:\[\])?/).replace("ref",Se).getRegex(),yg=p("reflink|nolink(?!\\()","g").replace("reflink",ta).replace("nolink",Gr).getRegex(),Tc={_backpedal:f,anyPunctuation:td,autolink:hp,blockSkip:Ec,br:oi,code:Pn,del:f,emStrongLDelim:Jl,emStrongRDelimAst:Ai,emStrongRDelimUnd:ed,escape:an,link:nd,nolink:Gr,punctuation:Ni,reflink:ta,reflinkSearch:yg,tag:Ve,text:hs,url:f},Ig={...Tc,link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",il).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",il).getRegex()},na={...Tc,escape:p(an).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Cg={...na,br:p(oi).replace("{2,}","*").getRegex(),text:p(na.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ia={normal:Ze,gfm:_e,pedantic:mn},Ir={normal:Tc,gfm:na,breaks:Cg,pedantic:Ig};class Fn{tokens;options;state;tokenizer;inlineQueue;constructor(L){this.tokens=[],this.tokens.links=Object.create(null),this.options=L||e.defaults,this.options.tokenizer=this.options.tokenizer||new S,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let R={block:ia.normal,inline:Ir.normal};this.options.pedantic?(R.block=ia.pedantic,R.inline=Ir.pedantic):this.options.gfm&&(R.block=ia.gfm,this.options.breaks?R.inline=Ir.breaks:R.inline=Ir.gfm),this.tokenizer.rules=R}static get rules(){return{block:ia,inline:Ir}}static lex(L,R){return new Fn(R).lex(L)}static lexInline(L,R){return new Fn(R).inlineTokens(L)}lex(L){L=L.replace(/\r\n|\r/g,`
`),this.blockTokens(L,this.tokens);for(let R=0;R<this.inlineQueue.length;R++){let N=this.inlineQueue[R];this.inlineTokens(N.src,N.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(L,R=[],N=!1){this.options.pedantic?L=L.replace(/\t/g,"    ").replace(/^ +$/gm,""):L=L.replace(/^( *)(\t+)/gm,(oe,we,Le)=>we+"    ".repeat(Le.length));let W,U,Z;for(;L;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(oe=>(W=oe.call({lexer:this},L,R))?(L=L.substring(W.raw.length),R.push(W),!0):!1))){if(W=this.tokenizer.space(L)){L=L.substring(W.raw.length),W.raw.length===1&&R.length>0?R[R.length-1].raw+=`
`:R.push(W);continue}if(W=this.tokenizer.code(L)){L=L.substring(W.raw.length),U=R[R.length-1],U&&(U.type==="paragraph"||U.type==="text")?(U.raw+=`
`+W.raw,U.text+=`
`+W.text,this.inlineQueue[this.inlineQueue.length-1].src=U.text):R.push(W);continue}if(W=this.tokenizer.fences(L)){L=L.substring(W.raw.length),R.push(W);continue}if(W=this.tokenizer.heading(L)){L=L.substring(W.raw.length),R.push(W);continue}if(W=this.tokenizer.hr(L)){L=L.substring(W.raw.length),R.push(W);continue}if(W=this.tokenizer.blockquote(L)){L=L.substring(W.raw.length),R.push(W);continue}if(W=this.tokenizer.list(L)){L=L.substring(W.raw.length),R.push(W);continue}if(W=this.tokenizer.html(L)){L=L.substring(W.raw.length),R.push(W);continue}if(W=this.tokenizer.def(L)){L=L.substring(W.raw.length),U=R[R.length-1],U&&(U.type==="paragraph"||U.type==="text")?(U.raw+=`
`+W.raw,U.text+=`
`+W.raw,this.inlineQueue[this.inlineQueue.length-1].src=U.text):this.tokens.links[W.tag]||(this.tokens.links[W.tag]={href:W.href,title:W.title});continue}if(W=this.tokenizer.table(L)){L=L.substring(W.raw.length),R.push(W);continue}if(W=this.tokenizer.lheading(L)){L=L.substring(W.raw.length),R.push(W);continue}if(Z=L,this.options.extensions&&this.options.extensions.startBlock){let oe=1/0,we=L.slice(1),Le;this.options.extensions.startBlock.forEach(it=>{Le=it.call({lexer:this},we),typeof Le=="number"&&Le>=0&&(oe=Math.min(oe,Le))}),oe<1/0&&oe>=0&&(Z=L.substring(0,oe+1))}if(this.state.top&&(W=this.tokenizer.paragraph(Z))){U=R[R.length-1],N&&U?.type==="paragraph"?(U.raw+=`
`+W.raw,U.text+=`
`+W.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=U.text):R.push(W),N=Z.length!==L.length,L=L.substring(W.raw.length);continue}if(W=this.tokenizer.text(L)){L=L.substring(W.raw.length),U=R[R.length-1],U&&U.type==="text"?(U.raw+=`
`+W.raw,U.text+=`
`+W.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=U.text):R.push(W);continue}if(L){let oe="Infinite loop on byte: "+L.charCodeAt(0);if(this.options.silent){console.error(oe);break}else throw new Error(oe)}}return this.state.top=!0,R}inline(L,R=[]){return this.inlineQueue.push({src:L,tokens:R}),R}inlineTokens(L,R=[]){let N,W,U,Z=L,oe,we,Le;if(this.tokens.links){let it=Object.keys(this.tokens.links);if(it.length>0)for(;(oe=this.tokenizer.rules.inline.reflinkSearch.exec(Z))!=null;)it.includes(oe[0].slice(oe[0].lastIndexOf("[")+1,-1))&&(Z=Z.slice(0,oe.index)+"["+"a".repeat(oe[0].length-2)+"]"+Z.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(oe=this.tokenizer.rules.inline.blockSkip.exec(Z))!=null;)Z=Z.slice(0,oe.index)+"["+"a".repeat(oe[0].length-2)+"]"+Z.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(oe=this.tokenizer.rules.inline.anyPunctuation.exec(Z))!=null;)Z=Z.slice(0,oe.index)+"++"+Z.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;L;)if(we||(Le=""),we=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(it=>(N=it.call({lexer:this},L,R))?(L=L.substring(N.raw.length),R.push(N),!0):!1))){if(N=this.tokenizer.escape(L)){L=L.substring(N.raw.length),R.push(N);continue}if(N=this.tokenizer.tag(L)){L=L.substring(N.raw.length),W=R[R.length-1],W&&N.type==="text"&&W.type==="text"?(W.raw+=N.raw,W.text+=N.text):R.push(N);continue}if(N=this.tokenizer.link(L)){L=L.substring(N.raw.length),R.push(N);continue}if(N=this.tokenizer.reflink(L,this.tokens.links)){L=L.substring(N.raw.length),W=R[R.length-1],W&&N.type==="text"&&W.type==="text"?(W.raw+=N.raw,W.text+=N.text):R.push(N);continue}if(N=this.tokenizer.emStrong(L,Z,Le)){L=L.substring(N.raw.length),R.push(N);continue}if(N=this.tokenizer.codespan(L)){L=L.substring(N.raw.length),R.push(N);continue}if(N=this.tokenizer.br(L)){L=L.substring(N.raw.length),R.push(N);continue}if(N=this.tokenizer.del(L)){L=L.substring(N.raw.length),R.push(N);continue}if(N=this.tokenizer.autolink(L)){L=L.substring(N.raw.length),R.push(N);continue}if(!this.state.inLink&&(N=this.tokenizer.url(L))){L=L.substring(N.raw.length),R.push(N);continue}if(U=L,this.options.extensions&&this.options.extensions.startInline){let it=1/0,xt=L.slice(1),nn;this.options.extensions.startInline.forEach(Bn=>{nn=Bn.call({lexer:this},xt),typeof nn=="number"&&nn>=0&&(it=Math.min(it,nn))}),it<1/0&&it>=0&&(U=L.substring(0,it+1))}if(N=this.tokenizer.inlineText(U)){L=L.substring(N.raw.length),N.raw.slice(-1)!=="_"&&(Le=N.raw.slice(-1)),we=!0,W=R[R.length-1],W&&W.type==="text"?(W.raw+=N.raw,W.text+=N.text):R.push(N);continue}if(L){let it="Infinite loop on byte: "+L.charCodeAt(0);if(this.options.silent){console.error(it);break}else throw new Error(it)}}return R}}class Cr{options;parser;constructor(L){this.options=L||e.defaults}space(L){return""}code({text:L,lang:R,escaped:N}){let W=(R||"").match(/^\S*/)?.[0],U=L.replace(/\n$/,"")+`
`;return W?'<pre><code class="language-'+c(W)+'">'+(N?U:c(U,!0))+`</code></pre>
`:"<pre><code>"+(N?U:c(U,!0))+`</code></pre>
`}blockquote({tokens:L}){return`<blockquote>
${this.parser.parse(L)}</blockquote>
`}html({text:L}){return L}heading({tokens:L,depth:R}){return`<h${R}>${this.parser.parseInline(L)}</h${R}>
`}hr(L){return`<hr>
`}list(L){let R=L.ordered,N=L.start,W="";for(let oe=0;oe<L.items.length;oe++){let we=L.items[oe];W+=this.listitem(we)}let U=R?"ol":"ul",Z=R&&N!==1?' start="'+N+'"':"";return"<"+U+Z+`>
`+W+"</"+U+`>
`}listitem(L){let R="";if(L.task){let N=this.checkbox({checked:!!L.checked});L.loose?L.tokens.length>0&&L.tokens[0].type==="paragraph"?(L.tokens[0].text=N+" "+L.tokens[0].text,L.tokens[0].tokens&&L.tokens[0].tokens.length>0&&L.tokens[0].tokens[0].type==="text"&&(L.tokens[0].tokens[0].text=N+" "+L.tokens[0].tokens[0].text)):L.tokens.unshift({type:"text",raw:N+" ",text:N+" "}):R+=N+" "}return R+=this.parser.parse(L.tokens,!!L.loose),`<li>${R}</li>
`}checkbox({checked:L}){return"<input "+(L?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:L}){return`<p>${this.parser.parseInline(L)}</p>
`}table(L){let R="",N="";for(let U=0;U<L.header.length;U++)N+=this.tablecell(L.header[U]);R+=this.tablerow({text:N});let W="";for(let U=0;U<L.rows.length;U++){let Z=L.rows[U];N="";for(let oe=0;oe<Z.length;oe++)N+=this.tablecell(Z[oe]);W+=this.tablerow({text:N})}return W&&(W=`<tbody>${W}</tbody>`),`<table>
<thead>
`+R+`</thead>
`+W+`</table>
`}tablerow({text:L}){return`<tr>
${L}</tr>
`}tablecell(L){let R=this.parser.parseInline(L.tokens),N=L.header?"th":"td";return(L.align?`<${N} align="${L.align}">`:`<${N}>`)+R+`</${N}>
`}strong({tokens:L}){return`<strong>${this.parser.parseInline(L)}</strong>`}em({tokens:L}){return`<em>${this.parser.parseInline(L)}</em>`}codespan({text:L}){return`<code>${L}</code>`}br(L){return"<br>"}del({tokens:L}){return`<del>${this.parser.parseInline(L)}</del>`}link({href:L,title:R,tokens:N}){let W=this.parser.parseInline(N),U=h(L);if(U===null)return W;L=U;let Z='<a href="'+L+'"';return R&&(Z+=' title="'+R+'"'),Z+=">"+W+"</a>",Z}image({href:L,title:R,text:N}){let W=h(L);if(W===null)return N;L=W;let U=`<img src="${L}" alt="${N}"`;return R&&(U+=` title="${R}"`),U+=">",U}text(L){return"tokens"in L&&L.tokens?this.parser.parseInline(L.tokens):L.text}}class ol{strong({text:L}){return L}em({text:L}){return L}codespan({text:L}){return L}del({text:L}){return L}html({text:L}){return L}text({text:L}){return L}link({text:L}){return""+L}image({text:L}){return""+L}br(){return""}}class po{options;renderer;textRenderer;constructor(L){this.options=L||e.defaults,this.options.renderer=this.options.renderer||new Cr,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ol}static parse(L,R){return new po(R).parse(L)}static parseInline(L,R){return new po(R).parseInline(L)}parse(L,R=!0){let N="";for(let W=0;W<L.length;W++){let U=L[W];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[U.type]){let oe=U,we=this.options.extensions.renderers[oe.type].call({parser:this},oe);if(we!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(oe.type)){N+=we||"";continue}}let Z=U;switch(Z.type){case"space":{N+=this.renderer.space(Z);continue}case"hr":{N+=this.renderer.hr(Z);continue}case"heading":{N+=this.renderer.heading(Z);continue}case"code":{N+=this.renderer.code(Z);continue}case"table":{N+=this.renderer.table(Z);continue}case"blockquote":{N+=this.renderer.blockquote(Z);continue}case"list":{N+=this.renderer.list(Z);continue}case"html":{N+=this.renderer.html(Z);continue}case"paragraph":{N+=this.renderer.paragraph(Z);continue}case"text":{let oe=Z,we=this.renderer.text(oe);for(;W+1<L.length&&L[W+1].type==="text";)oe=L[++W],we+=`
`+this.renderer.text(oe);R?N+=this.renderer.paragraph({type:"paragraph",raw:we,text:we,tokens:[{type:"text",raw:we,text:we}]}):N+=we;continue}default:{let oe='Token with "'+Z.type+'" type was not found.';if(this.options.silent)return console.error(oe),"";throw new Error(oe)}}}return N}parseInline(L,R){R=R||this.renderer;let N="";for(let W=0;W<L.length;W++){let U=L[W];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[U.type]){let oe=this.options.extensions.renderers[U.type].call({parser:this},U);if(oe!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(U.type)){N+=oe||"";continue}}let Z=U;switch(Z.type){case"escape":{N+=R.text(Z);break}case"html":{N+=R.html(Z);break}case"link":{N+=R.link(Z);break}case"image":{N+=R.image(Z);break}case"strong":{N+=R.strong(Z);break}case"em":{N+=R.em(Z);break}case"codespan":{N+=R.codespan(Z);break}case"br":{N+=R.br(Z);break}case"del":{N+=R.del(Z);break}case"text":{N+=R.text(Z);break}default:{let oe='Token with "'+Z.type+'" type was not found.';if(this.options.silent)return console.error(oe),"";throw new Error(oe)}}}return N}}class id{options;constructor(L){this.options=L||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(L){return L}postprocess(L){return L}processAllTokens(L){return L}}class ms{defaults=t();options=this.setOptions;parse=this.parseMarkdown(Fn.lex,po.parse);parseInline=this.parseMarkdown(Fn.lexInline,po.parseInline);Parser=po;Renderer=Cr;TextRenderer=ol;Lexer=Fn;Tokenizer=S;Hooks=id;constructor(...L){this.use(...L)}walkTokens(L,R){let N=[];for(let W of L)switch(N=N.concat(R.call(this,W)),W.type){case"table":{let U=W;for(let Z of U.header)N=N.concat(this.walkTokens(Z.tokens,R));for(let Z of U.rows)for(let oe of Z)N=N.concat(this.walkTokens(oe.tokens,R));break}case"list":{let U=W;N=N.concat(this.walkTokens(U.items,R));break}default:{let U=W;this.defaults.extensions?.childTokens?.[U.type]?this.defaults.extensions.childTokens[U.type].forEach(Z=>{let oe=U[Z].flat(1/0);N=N.concat(this.walkTokens(oe,R))}):U.tokens&&(N=N.concat(this.walkTokens(U.tokens,R)))}}return N}use(...L){let R=this.defaults.extensions||{renderers:{},childTokens:{}};return L.forEach(N=>{let W={...N};if(W.async=this.defaults.async||W.async||!1,N.extensions&&(N.extensions.forEach(U=>{if(!U.name)throw new Error("extension name required");if("renderer"in U){let Z=R.renderers[U.name];Z?R.renderers[U.name]=function(...oe){let we=U.renderer.apply(this,oe);return we===!1&&(we=Z.apply(this,oe)),we}:R.renderers[U.name]=U.renderer}if("tokenizer"in U){if(!U.level||U.level!=="block"&&U.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let Z=R[U.level];Z?Z.unshift(U.tokenizer):R[U.level]=[U.tokenizer],U.start&&(U.level==="block"?R.startBlock?R.startBlock.push(U.start):R.startBlock=[U.start]:U.level==="inline"&&(R.startInline?R.startInline.push(U.start):R.startInline=[U.start]))}"childTokens"in U&&U.childTokens&&(R.childTokens[U.name]=U.childTokens)}),W.extensions=R),N.renderer){let U=this.defaults.renderer||new Cr(this.defaults);for(let Z in N.renderer){if(!(Z in U))throw new Error(`renderer '${Z}' does not exist`);if(["options","parser"].includes(Z))continue;let oe=Z,we=N.renderer[oe],Le=U[oe];U[oe]=(...it)=>{let xt=we.apply(U,it);return xt===!1&&(xt=Le.apply(U,it)),xt||""}}W.renderer=U}if(N.tokenizer){let U=this.defaults.tokenizer||new S(this.defaults);for(let Z in N.tokenizer){if(!(Z in U))throw new Error(`tokenizer '${Z}' does not exist`);if(["options","rules","lexer"].includes(Z))continue;let oe=Z,we=N.tokenizer[oe],Le=U[oe];U[oe]=(...it)=>{let xt=we.apply(U,it);return xt===!1&&(xt=Le.apply(U,it)),xt}}W.tokenizer=U}if(N.hooks){let U=this.defaults.hooks||new id;for(let Z in N.hooks){if(!(Z in U))throw new Error(`hook '${Z}' does not exist`);if(Z==="options")continue;let oe=Z,we=N.hooks[oe],Le=U[oe];id.passThroughHooks.has(Z)?U[oe]=it=>{if(this.defaults.async)return Promise.resolve(we.call(U,it)).then(nn=>Le.call(U,nn));let xt=we.call(U,it);return Le.call(U,xt)}:U[oe]=(...it)=>{let xt=we.apply(U,it);return xt===!1&&(xt=Le.apply(U,it)),xt}}W.hooks=U}if(N.walkTokens){let U=this.defaults.walkTokens,Z=N.walkTokens;W.walkTokens=function(oe){let we=[];return we.push(Z.call(this,oe)),U&&(we=we.concat(U.call(this,oe))),we}}this.defaults={...this.defaults,...W}}),this}setOptions(L){return this.defaults={...this.defaults,...L},this}lexer(L,R){return Fn.lex(L,R??this.defaults)}parser(L,R){return po.parse(L,R??this.defaults)}parseMarkdown(L,R){return(W,U)=>{let Z={...U},oe={...this.defaults,...Z},we=this.onError(!!oe.silent,!!oe.async);if(this.defaults.async===!0&&Z.async===!1)return we(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof W>"u"||W===null)return we(new Error("marked(): input parameter is undefined or null"));if(typeof W!="string")return we(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(W)+", string expected"));if(oe.hooks&&(oe.hooks.options=oe),oe.async)return Promise.resolve(oe.hooks?oe.hooks.preprocess(W):W).then(Le=>L(Le,oe)).then(Le=>oe.hooks?oe.hooks.processAllTokens(Le):Le).then(Le=>oe.walkTokens?Promise.all(this.walkTokens(Le,oe.walkTokens)).then(()=>Le):Le).then(Le=>R(Le,oe)).then(Le=>oe.hooks?oe.hooks.postprocess(Le):Le).catch(we);try{oe.hooks&&(W=oe.hooks.preprocess(W));let Le=L(W,oe);oe.hooks&&(Le=oe.hooks.processAllTokens(Le)),oe.walkTokens&&this.walkTokens(Le,oe.walkTokens);let it=R(Le,oe);return oe.hooks&&(it=oe.hooks.postprocess(it)),it}catch(Le){return we(Le)}}}onError(L,R){return N=>{if(N.message+=`
Please report this to https://github.com/markedjs/marked.`,L){let W="<p>An error occurred:</p><pre>"+c(N.message+"",!0)+"</pre>";return R?Promise.resolve(W):W}if(R)return Promise.reject(N);throw N}}}let oa=new ms;function ve(ze,L){return oa.parse(ze,L)}ve.options=ve.setOptions=function(ze){return oa.setOptions(ze),ve.defaults=oa.defaults,n(ve.defaults),ve},ve.getDefaults=t,ve.defaults=e.defaults,ve.use=function(...ze){return oa.use(...ze),ve.defaults=oa.defaults,n(ve.defaults),ve},ve.walkTokens=function(ze,L){return oa.walkTokens(ze,L)},ve.parseInline=oa.parseInline,ve.Parser=po,ve.parser=po.parse,ve.Renderer=Cr,ve.TextRenderer=ol,ve.Lexer=Fn,ve.lexer=Fn.lex,ve.Tokenizer=S,ve.Hooks=id,ve.parse=ve;let ue=ve.options,B=ve.setOptions,se=ve.use,fe=ve.walkTokens,tt=ve.parseInline,kt=ve,ri=po.parse,Pi=Fn.lex;e.Hooks=id,e.Lexer=Fn,e.Marked=ms,e.Parser=po,e.Renderer=Cr,e.TextRenderer=ol,e.Tokenizer=S,e.getDefaults=t,e.lexer=Pi,e.marked=ve,e.options=ue,e.parse=kt,e.parseInline=tt,e.parser=ri,e.setOptions=B,e.use=se,e.walkTokens=fe})})();var Cje=ki.Hooks||exports.Hooks,Sje=ki.Lexer||exports.Lexer,Eje=ki.Marked||exports.Marked,Tje=ki.Parser||exports.Parser,X1=ki.Renderer||exports.Renderer,wje=ki.TextRenderer||exports.TextRenderer,xje=ki.Tokenizer||exports.Tokenizer,jV=ki.defaults||exports.defaults,_je=ki.getDefaults||exports.getDefaults,Ab=ki.lexer||exports.lexer,Lje=ki.marked||exports.marked,Dje=ki.options||exports.options,qV=ki.parse||exports.parse,kje=ki.parseInline||exports.parseInline,$V=ki.parser||exports.parser,Rje=ki.setOptions||exports.setOptions,Mje=ki.use||exports.use,Oje=ki.walkTokens||exports.walkTokens;function J1(o){let e=JSON.parse(o);return e=am(e),e}function am(o,e=0){if(!o||e>200)return o;if(typeof o=="object"){switch(o.$mid){case 1:return te.revive(o);case 2:return new RegExp(o.source,o.flags);case 17:return new Date(o.source)}if(o instanceof _n||o instanceof Uint8Array)return o;if(Array.isArray(o))for(let t=0;t<o.length;++t)o[t]=am(o[t],e+1);else for(let t in o)Object.hasOwnProperty.call(o,t)&&(o[t]=am(o[t],e+1))}return o}var eR=Object.freeze({image:({href:o,title:e,text:t})=>{let n=[],i=[];return o&&({href:o,dimensions:n}=cP(o),i.push(`src="${Jg(o)}"`)),t&&i.push(`alt="${Jg(t)}"`),e&&i.push(`title="${Jg(e)}"`),n.length&&(i=i.concat(n)),"<img "+i.join(" ")+">"},paragraph({tokens:o}){return`<p>${this.parser.parseInline(o)}</p>`},link({href:o,title:e,tokens:t}){let n=this.parser.parseInline(t);return typeof o!="string"?"":(o===n&&(n=Wy(n)),e=typeof e=="string"?Jg(Wy(e)):"",o=Wy(o),o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${o}" title="${e||o}" draggable="false">${n}</a>`)}});function nR(o,e={},t={}){let n=new ne,i=!1,r=bE(e),s=function(g){let b;try{b=J1(decodeURIComponent(g))}catch{}return b?(b=pP(b,v=>{if(o.uris&&o.uris[v])return te.revive(o.uris[v])}),encodeURIComponent(JSON.stringify(b))):g},a=function(g,b){let v=o.uris&&o.uris[g],I=te.revive(v);return b?g.startsWith(xe.data+":")?g:(I||(I=te.parse(g)),ha.uriToBrowserUri(I).toString(!0)):!I||te.parse(g).toString()===I.toString()?g:(I.query&&(I=I.with({query:s(I.query)})),I.toString())},l=new X1;l.image=eR.image,l.link=eR.link,l.paragraph=eR.paragraph;let d=[],c=[];if(e.codeBlockRendererSync?l.code=({text:g,lang:b})=>{let v=Q1.nextId(),I=e.codeBlockRendererSync(YV(b),g);return c.push([v,I]),`<div class="code" data-code="${v}">${_p(g)}</div>`}:e.codeBlockRenderer&&(l.code=({text:g,lang:b})=>{let v=Q1.nextId(),I=e.codeBlockRenderer(YV(b),g);return d.push(I.then(T=>[v,T])),`<div class="code" data-code="${v}">${_p(g)}</div>`}),e.actionHandler){let g=function(I){let T=I.target.closest("a[data-href]");if(On(T))try{let S=T.dataset.href;S&&(o.baseUri&&(S=tR(te.from(o.baseUri),S)),e.actionHandler.callback(S,I))}catch(S){je(S)}finally{I.preventDefault()}},b=e.actionHandler.disposables.add(new Ne(r,"click")),v=e.actionHandler.disposables.add(new Ne(r,"auxclick"));e.actionHandler.disposables.add(j.any(b.event,v.event)(I=>{let T=new qi(Ce(r),I);!T.leftButton&&!T.middleButton||g(T)})),e.actionHandler.disposables.add(q(r,"keydown",I=>{let T=new gt(I);!T.equals(10)&&!T.equals(3)||g(T)}))}o.supportHtml||(l.html=({text:g})=>e.sanitizerOptions?.replaceWithPlaintext?_p(g):(o.isTrusted?g.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?g:""),t.renderer=l;let u=o.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}\u2026`),o.supportThemeIcons&&(u=JA(u));let p;if(e.fillInIncompleteTokens){let g={...jV,...t},b=Ab(u,g),v=$3(b);p=$V(v,g)}else p=qV(u,{...t,async:!1});o.supportThemeIcons&&(p=Nb(p).map(b=>typeof b=="string"?b:b.outerHTML).join(""));let f=new DOMParser().parseFromString(ZV({isTrusted:o.isTrusted,...e.sanitizerOptions},p),"text/html");if(f.body.querySelectorAll("img, audio, video, source").forEach(g=>{let b=g.getAttribute("src");if(b){let v=b;try{o.baseUri&&(v=tR(te.from(o.baseUri),v))}catch{}if(g.setAttribute("src",a(v,!0)),e.remoteImageIsAllowed){let I=te.parse(v);I.scheme!==xe.file&&I.scheme!==xe.data&&!e.remoteImageIsAllowed(I)&&g.replaceWith(Ke("",void 0,g.outerHTML))}}}),f.body.querySelectorAll("a").forEach(g=>{let b=g.getAttribute("href");if(g.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!o.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))g.replaceWith(...g.childNodes);else{let v=a(b,!1);o.baseUri&&(v=tR(te.from(o.baseUri),b)),g.dataset.href=v}}),r.innerHTML=ZV({isTrusted:o.isTrusted,...e.sanitizerOptions},f.body.innerHTML),d.length>0)Promise.all(d).then(g=>{if(i)return;let b=new Map(g),v=r.querySelectorAll("div[data-code]");for(let I of v){let T=b.get(I.dataset.code??"");T&&Wr(I,T)}e.asyncRenderCallback?.()});else if(c.length>0){let g=new Map(c),b=r.querySelectorAll("div[data-code]");for(let v of b){let I=g.get(v.dataset.code??"");I&&Wr(v,I)}}if(e.asyncRenderCallback)for(let g of r.getElementsByTagName("img")){let b=n.add(q(g,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}return{element:r,dispose:()=>{i=!0,n.dispose()}}}function YV(o){if(!o)return"";let e=o.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:o}function tR(o,e){return/^\w[\w\d+.-]*:/.test(e)?e:o.path.endsWith("/")?_L(o,e).toString():_L(Op(o),e).toString()}var H3=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function ZV(o,e){let{config:t,allowedSchemes:n}=z3(o),i=new ne;i.add(QV("uponSanitizeAttribute",(r,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(r.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(r.tagName==="INPUT"&&r.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),i.add(QV("uponSanitizeElement",(r,s)=>{if(s.tagName==="input"&&(r.attributes.getNamedItem("type")?.value==="checkbox"?r.setAttribute("disabled",""):o.replaceWithPlaintext||r.remove()),o.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&r.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${r.textContent}-->`;else{let p=H3.includes(s.tagName),h=r.attributes.length?" "+Array.from(r.attributes).map(f=>`${f.name}="${f.value}"`).join(" "):"";a=`<${s.tagName}${h}>`,p||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=r.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let u=l?r.parentElement.ownerDocument.createTextNode(l):void 0;for(;r.firstChild;)d.appendChild(r.firstChild);u&&d.appendChild(u),r.parentElement.replaceChild(d,r)}})),i.add(CV(n));try{return vS(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{i.dispose()}}var U3=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function z3(o){let e=[xe.http,xe.https,xe.mailto,xe.data,xe.file,xe.vscodeFileResource,xe.vscodeRemote,xe.vscodeRemoteResource];return o.isTrusted&&e.push(xe.command),{config:{ALLOWED_TAGS:o.allowedTags??[...SV],ALLOWED_ATTR:U3,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function XV(){let o=new X1;return o.code=({text:e})=>e,o.blockquote=({text:e})=>e+`
`,o.html=e=>"",o.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.hr=()=>"",o.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},o.listitem=({text:e})=>e+`
`,o.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.table=function({header:e,rows:t}){return e.map(n=>this.tablecell(n)).join(" ")+`
`+t.map(n=>n.map(i=>this.tablecell(i)).join(" ")).join(`
`)+`
`},o.tablerow=({text:e})=>e,o.tablecell=function({tokens:e}){return this.parser.parseInline(e)},o.strong=({text:e})=>e,o.em=({text:e})=>e,o.codespan=({text:e})=>e,o.br=e=>`
`,o.del=({text:e})=>e,o.image=e=>"",o.text=({text:e})=>e,o.link=({text:e})=>e,o}var lqe=new Gn(o=>XV()),dqe=new Gn(()=>{let o=XV();return o.code=({text:e})=>`
\`\`\`
${e}
\`\`\`
`,o});function vE(o){let e="";return o.forEach(t=>{e+=t.raw}),e}function JV(o){if(o.tokens)for(let e=o.tokens.length-1;e>=0;e--){let t=o.tokens[e];if(t.type==="text"){let n=t.raw.split(`
`),i=n[n.length-1];if(i.includes("`"))return Z3(o);if(i.includes("**"))return n6(o);if(i.match(/\*\w/))return Q3(o);if(i.match(/(^|\s)__\w/))return i6(o);if(i.match(/(^|\s)_\w/))return X3(o);if(K3(i)||G3(i)&&o.tokens.slice(0,e).some(r=>r.type==="text"&&r.raw.match(/\[[^\]]*$/))){let r=o.tokens.slice(e+1);return r[0]?.type==="link"&&r[1]?.type==="text"&&r[1].raw.match(/^ *"[^"]*$/)||i.match(/^[^"]* +"[^"]*$/)?e6(o):J3(o)}else if(i.match(/(^|\s)\[\w*/))return t6(o)}}}function K3(o){return!!o.match(/(^|\s)\[.*\]\(\w*/)}function G3(o){return!!o.match(/^[^\[]*\]\([^\)]*$/)}function j3(o){let e=o.items[o.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,n;if(t?.type==="text"&&!("inRawBlock"in e)&&(n=JV(t)),!n||n.type!=="paragraph")return;let i=vE(o.items.slice(0,-1)),r=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!r)return;let s=r+vE(e.tokens.slice(0,-1))+n.raw,a=Ab(i+s)[0];if(a.type==="list")return a}var q3=3;function $3(o){for(let e=0;e<q3;e++){let t=Y3(o);if(t)o=t;else break}return o}function Y3(o){let e,t;for(e=0;e<o.length;e++){let n=o[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=o6(o.slice(e));break}if(e===o.length-1&&n.type==="list"){let i=j3(n);if(i){t=[i];break}}if(e===o.length-1&&n.type==="paragraph"){let i=JV(n);if(i){t=[i];break}}}if(t){let n=[...o.slice(0,e),...t];return n.links=o.links,n}return null}function Z3(o){return ic(o,"`")}function Q3(o){return ic(o,"*")}function X3(o){return ic(o,"_")}function J3(o){return ic(o,")")}function e6(o){return ic(o,'")')}function t6(o){return ic(o,"](https://microsoft.com)")}function n6(o){return ic(o,"**")}function i6(o){return ic(o,"__")}function ic(o,e){let t=vE(Array.isArray(o)?o:[o]);return Ab(t+e)[0]}function o6(o){let e=vE(o),t=e.split(`
`),n,i=!1;for(let r=0;r<t.length;r++){let s=t[r].trim();if(typeof n>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(n=a.length)}else if(typeof n=="number")if(s.match(/^\s*\|/)){if(r!==t.length-1)return;i=!0}else return}if(typeof n=="number"&&n>0){let r=i?t.slice(0,-1).join(`
`):e,s=!!r.match(/\|\s*$/),a=r+(s?"":"|")+`
|${" --- |".repeat(n)}`;return Ab(a)}}function QV(o,e){return yS(o,e),pe(()=>IS(o))}var Ou=Ke,eH="selectOption.entry.template",iR=class{get templateId(){return eH}renderTemplate(e){let t=Object.create(null);return t.root=e,t.text=dt(e,Ou(".option-text")),t.detail=dt(e,Ou(".option-detail")),t.decoratorRight=dt(e,Ou(".option-decorator-right")),t}renderElement(e,t,n){let i=n,r=e.text,s=e.detail,a=e.decoratorRight,l=e.isDisabled;i.text.textContent=r,i.detail.textContent=s||"",i.decoratorRight.innerText=a||"",l?i.root.classList.add("option-disabled"):i.root.classList.remove("option-disabled")}disposeTemplate(e){}},yE=class o extends F{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(e,t,n,i,r){super(),this._isVisible=!1,this.styles=i,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=o.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new k,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(n),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(_o().setupManagedHover(An("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return eH}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=Ke(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=dt(this.selectDropDownContainer,Ou(".select-box-details-pane"));let t=dt(this.selectDropDownContainer,Ou(".select-box-dropdown-container-width-control")),n=dt(t,Ou(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",dt(n,this.widthControlElement),this._dropDownPosition=0,this.styleElement=pr(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(q(this.selectDropDownContainer,he.DRAG_START,i=>{rt.stop(i,!0)}))}registerListeners(){this._register(hn(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(q(this.selectElement,he.CLICK,t=>{rt.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(q(this.selectElement,he.MOUSE_DOWN,t=>{rt.stop(t)}));let e;this._register(q(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(q(this.selectElement,"touchend",t=>{rt.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(q(this.selectElement,he.KEY_DOWN,t=>{let n=new gt(t),i=!1;Fe?(n.keyCode===18||n.keyCode===16||n.keyCode===10||n.keyCode===3)&&(i=!0):(n.keyCode===18&&n.altKey||n.keyCode===16&&n.altKey||n.keyCode===10||n.keyCode===3)&&(i=!0),i&&(this.showSelectDropDown(),rt.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){Ut(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled)),typeof n.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setEnabled(e){this.selectElement.disabled=!e}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){let e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",n=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=n}styleList(){let e=this.styles.selectBackground??"",t=Vr(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;let n=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=n,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,n)=>{this.updateDetail(n),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let t=Ce(this.selectElement),n=ro(this.selectElement),i=Ce(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(i.getPropertyValue("--dropdown-padding-top"))+parseFloat(i.getPropertyValue("--dropdown-padding-bottom")),s=t.innerHeight-n.top-n.height-(this.selectBoxOptions.minBottomMargin||0),a=n.top-o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let p=this._hasDetails?this._cachedMaxDetailsHeight:0,h=u+r+p,f=Math.floor((s-r-p)/this.getHeight()),g=Math.floor((a-r-p)/this.getHeight());if(e)return n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1?!1:(f<o.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;h>s&&(u=f*this.getHeight())}else h>a&&(u=g*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let n=0,i=0;this.options.forEach((r,s)=>{let a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,d=r.text.length+a+l;d>i&&(n=s,i=d)}),e.textContent=this.options[n].text+(this.options[n].decoratorRight?this.options[n].decoratorRight+" ":""),t=Hh(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=dt(e,Ou(".select-box-dropdown-list-container")),this.listRenderer=new iR,this.selectList=this._register(new Jn("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:i=>{let r=i.text;return i.detail&&(r+=`. ${i.detail}`),i.decoratorRight&&(r+=`. ${i.decoratorRight}`),i.description&&(r+=`. ${i.description}`),r},getWidgetAriaLabel:()=>m({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Fe?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let t=this._register(new Ne(this.selectDropDownListContainer,"keydown")),n=j.chain(t.event,i=>i.filter(()=>this.selectList.length>0).map(r=>new gt(r)));this._register(j.chain(n,i=>i.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(j.chain(n,i=>i.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(q(this.selectList.getHTMLElement(),he.POINTER_UP,i=>this.onPointerUp(i))),this._register(this.selectList.onMouseOver(i=>typeof i.index<"u"&&this.selectList.setFocus([i.index]))),this._register(this.selectList.onDidChangeFocus(i=>this.onListFocus(i))),this._register(q(this.selectDropDownContainer,he.FOCUS_OUT,i=>{!this._isVisible||rs(i.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;rt.stop(e);let t=e.target;if(!t||t.classList.contains("slider"))return;let n=t.closest(".monaco-list-row");if(!n)return;let i=Number(n.getAttribute("data-index")),r=n.classList.contains("option-disabled");i>=0&&i<this.options.length&&!r&&(this.selected=i,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){let n=r=>{for(let s=0;s<r.childNodes.length;s++){let a=r.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():n(a)}},i=nR({value:e,supportThemeIcons:!0},{actionHandler:t});return i.element.classList.add("select-box-description-markdown"),n(i.element),i.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";let t=this.options[e],n=t?.description??"",i=t?.descriptionIsMarkdown??!1;if(n){if(i){let r=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(n,r))}else this.selectionDetailsPane.innerText=n;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){rt.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){rt.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){rt.stop(e,!0);let t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(rt.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){rt.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){rt.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){rt.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){rt.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){let t=lb.toString(e.keyCode),n=-1;for(let i=0;i<this.options.length-1;i++)if(n=(i+this.selected+1)%this.options.length,this.options[n].text.charAt(0).toUpperCase()===t&&!this.options[n].isDisabled){this.select(n),this.selectList.setFocus([n]),this.selectList.reveal(this.selectList.getFocus()[0]),rt.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var IE=class extends F{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(e,t,n,i){super(),this.selectBoxOptions=i||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new k),this.styles=n,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Nn.addTarget(this.selectElement)),[wt.Tap].forEach(e=>{this._register(q(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(hn(this.selectElement,"click",e=>{rt.stop(e,!0)})),this._register(hn(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(hn(this.selectElement,"keydown",e=>{let t=!1;Fe?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!Ut(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",e)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(e){this.selectElement.disabled=!e}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(e){this.styles=e,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}};var y$e={...pE,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},CE=class extends lo{selectBoxDelegate;constructor(e,t,n,i,r){super(),Fe&&!r?.useCustomDrawn?this.selectBoxDelegate=new IE(e,t,i,r):this.selectBoxDelegate=new yE(e,t,n,i,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}setAriaLabel(e){this.selectBoxDelegate.setAriaLabel(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}setEnabled(e){this.selectBoxDelegate.setEnabled(e)}render(e){this.selectBoxDelegate.render(e)}};var tH={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};var Vl=class extends lo{_onChange=this._register(new k);onChange=this._onChange.event;_onKeyDown=this._register(new k);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(e){super(),this._opts=e,this._checked=this._opts.isChecked;let t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Be.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(_o().setupManagedHover(e.hoverDelegate??An("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,n=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),n.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,n=>{if(n.keyCode===10||n.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),n.preventDefault(),n.stopPropagation();return}this._onKeyDown.fire(n)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...Be.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...Be.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(e){this._hover.update(e),this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var co=class extends F{constructor(t,n,i={}){super();this.options=i;this._context=t||this,this._action=n,n instanceof ai&&this._register(n.onDidChange(r=>{this.element&&this.handleActionChangeEvent(r)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(t){t.enabled!==void 0&&this.updateEnabled(),t.checked!==void 0&&this.updateChecked(),t.class!==void 0&&this.updateClass(),t.label!==void 0&&(this.updateLabel(),this.updateTooltip()),t.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new Oo)),this._actionRunner}set actionRunner(t){this._actionRunner=t}isEnabled(){return this._action.enabled}setActionContext(t){this._context=t}render(t){let n=this.element=t;this._register(Nn.addTarget(t));let i=this.options&&this.options.draggable;i&&(t.draggable=!0,Vn&&this._register(q(t,he.DRAG_START,r=>r.dataTransfer?.setData(XS.TEXT,this._action.label)))),this._register(q(n,wt.Tap,r=>this.onClick(r,!0))),this._register(q(n,he.MOUSE_DOWN,r=>{i||rt.stop(r,!0),this._action.enabled&&r.button===0&&n.classList.add("active")})),Fe&&this._register(q(n,he.CONTEXT_MENU,r=>{r.button===0&&r.ctrlKey===!0&&this.onClick(r)})),this._register(q(n,he.CLICK,r=>{rt.stop(r,!0),this.options&&this.options.isMenu||this.onClick(r)})),this._register(q(n,he.DBLCLICK,r=>{rt.stop(r,!0)})),[he.MOUSE_UP,he.MOUSE_OUT].forEach(r=>{this._register(q(n,r,s=>{rt.stop(s),n.classList.remove("active")}))})}onClick(t,n=!1){rt.stop(t,!0);let i=zi(this._context)?this.options?.useEventAsContext?t:{preserveFocus:n}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(t){this.element&&(this.element.tabIndex=t?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let t=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=t;else if(!this.customHover&&t!==""){let n=this.options.hoverDelegate??An("element");this.customHover=this._store.add(_o().setupManagedHover(n,this.element,t))}else this.customHover&&this.customHover.update(t)}updateAriaLabel(){if(this.element){let t=this.getTooltip()??"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},oc=class extends co{label;options;cssClass;constructor(e,t,n){super(e,t,n),this.options=n,this.options.icon=n.icon!==void 0?n.icon:!1,this.options.label=n.label!==void 0?n.label:!0,this.cssClass=""}render(e){super.render(e),Dp(this.element);let t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){let n=document.createElement("span");n.classList.add("keybinding"),n.textContent=this.options.keybinding,this.element.appendChild(n)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===Ci.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=m({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},SE=class extends co{selectBox;constructor(e,t,n,i,r,s,a){super(e,t),this.selectBox=new CE(n,i,r,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(e,t){this.selectBox.setOptions(e,t)}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}};var fr=class extends F{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new ne);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new wr);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new k);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new k({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new k);onDidRun=this._onDidRun.event;_onWillRun=this._register(new k);onWillRun=this._onWillRun.event;constructor(e,t={}){super(),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(Wl()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new Oo,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(r=>this._onDidRun.fire(r))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(r=>this._onWillRun.fire(r))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let n,i;switch(this._orientation){case 0:n=[15],i=[17];break;case 1:n=[16],i=[18],this.domNode.className+=" vertical";break}this._register(q(this.domNode,he.KEY_DOWN,r=>{let s=new gt(r),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusPrevious():i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof co&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(q(this.domNode,he.KEY_UP,r=>{let s=new gt(r);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Ol(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(xo()===this.domNode||!rs(xo(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(e){e?this.actionsList.setAttribute("aria-label",e):this.actionsList.removeAttribute("aria-label")}setFocusable(e){if(this.focusable=e,this.focusable){let t=this.viewItems.find(n=>n instanceof co&&n.isEnabled());t instanceof co&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof co&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(n=>{t=t||e.equals(n)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){let t=this.actionsList.children[e];if(rs(xo(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}hasAction(e){return this.viewItems.findIndex(t=>t.action.id===e.id)!==-1}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(On(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){let n=Array.isArray(e)?e:[e],i=Ui(t.index)?t.index:null;n.forEach(r=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new oc(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,q(s,he.CONTEXT_MENU,d=>{rt.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof co&&this.viewItems.length===0&&a.setFocusable(!0),i===null||i<0||i>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[i]),this.viewItems.splice(i,0,a),i++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}getHeight(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientHeight}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),Tt(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=Tt(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),fi(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,n;if(e===void 0?t=!0:typeof e=="number"?n=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){let i=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=i===-1?void 0:i,this.updateFocus(void 0,void 0,!0)}else n!==void 0&&(this.focusedItem=n),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let n=this.focusedItem,i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=n,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==n&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===Ci.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let t=this.focusedItem,n;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}n=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===Ci.ID));return this.updateFocus(!0),!0}updateFocus(e,t,n=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let i=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(i){let r=!0;Hc(i.focus)||(r=!1),this.options.focusOnlyEnabledItems&&Hc(i.isEnabled)&&!i.isEnabled()&&(r=!1),i.action.id===Ci.ID&&(r=!1),r?(n||this.previouslyFocusedItem!==this.focusedItem)&&(i.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),r&&i.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;let t=this.viewItems[this.focusedItem];if(t instanceof co){let n=t._context===null||t._context===void 0?e:t._context;this.run(t._action,n)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=Tt(this.viewItems),this.getContainer().remove(),super.dispose()}};var r6=m("caseDescription","Match Case"),s6=m("wordsDescription","Match Whole Word"),a6=m("regexDescription","Use Regular Expression"),EE=class extends Vl{constructor(e){super({icon:ae.caseSensitive,title:r6+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??An("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},TE=class extends Vl{constructor(e){super({icon:ae.wholeWord,title:s6+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??An("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},wE=class extends Vl{constructor(e){super({icon:ae.regex,title:a6+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??An("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}};var xE=class{constructor(e,t=0,n=e.length,i=t-1){this.items=e;this.start=t;this.end=n;this.index=i}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}};var _E=class{_history;_limit;_navigator;constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isFirst(){return this._currentPosition()===0}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}clear(){this._initialize([]),this._onChange()}_onChange(){this._reduceToLimit();let e=this._elements;this._navigator=new xE(e,0,e.length,e.length)}_reduceToLimit(){let e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){let e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(let t of e)this._history.add(t)}get _elements(){let e=[];return this._history.forEach(t=>e.push(t)),e}};var Pb=Ke;var nH={inputBackground:"#3C3C3C",inputForeground:"#CCCCCC",inputValidationInfoBorder:"#55AAFF",inputValidationInfoBackground:"#063B49",inputValidationWarningBorder:"#B89500",inputValidationWarningBackground:"#352A05",inputValidationErrorBorder:"#BE1100",inputValidationErrorBackground:"#5A1D1D",inputBorder:void 0,inputValidationErrorForeground:void 0,inputValidationInfoForeground:void 0,inputValidationWarningForeground:void 0},LE=class extends lo{contextViewProvider;element;input;actionbar;options;message;placeholder;tooltip;ariaLabel;validation;state="idle";mirror;cachedHeight;cachedContentHeight;maxHeight=Number.POSITIVE_INFINITY;scrollableElement;hover;_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;_onDidHeightChange=this._register(new k);onDidHeightChange=this._onDidHeightChange.event;constructor(e,t,n){super(),this.contextViewProvider=t,this.options=n,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=dt(e,Pb(".monaco-inputbox.idle"));let i=this.options.flexibleHeight?"textarea":"input",r=dt(this.element,Pb(".ibwrapper"));if(this.input=dt(r,Pb(i+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=dt(r,Pb("div.mirror")),this.mirror.innerText="\xA0",this.scrollableElement=new iE(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),dt(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));let s=this._register(new Ne(e.ownerDocument,"selectionchange")),a=j.filter(s.event,()=>e.ownerDocument.getSelection()?.anchorNode===r);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new fr(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(_o().setupManagedHover(An("mouse"),this.input,e))}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get mirrorElement(){return this.mirror}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get step(){return this.input.step}set step(e){this.input.step=e}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:TS(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return Br(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){let e=this.input.selectionStart;if(e===null)return null;let t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}setEnabled(e){e?this.enable():this.disable()}get width(){return Hh(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){let n=parseFloat(this.mirror.style.paddingLeft||"")||0,i=parseFloat(this.mirror.style.paddingRight||"")||0;t=n+i}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;let e=this.cachedContentHeight,t=this.cachedHeight,n=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:n})}showMessage(e,t){if(this.state==="open"&&Ei(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));let n=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Vr(n.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e?.type}stylesForType(e){let t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t=()=>e.style.width=Hh(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:i=>{if(!this.message)return null;e=dt(i,Pb(".monaco-inputbox-container")),t();let r={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?KV(this.message.content,r):zV(this.message.content,r);s.classList.add(this.classForType(this.message.type));let a=this.stylesForType(this.message.type);return s.style.backgroundColor=a.background??"",s.style.color=a.foreground??"",s.style.border=a.border?`1px solid ${a.border}`:"",dt(e,s),null},onHide:()=>{this.state="closed"},layout:t});let n;this.message.type===3?n=m("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?n=m("alertWarningMessage","Warning: {0}",this.message.content):n=m("alertInfoMessage","Info: {0}",this.message.content),ec(n),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;let e=this.value,n=e.charCodeAt(e.length-1)===10?" ":"";(e+n).replace(/\u000c/g,"")?this.mirror.textContent=e+n:this.mirror.innerText="\xA0",this.layout()}applyStyles(){let e=this.options.inputBoxStyles,t=e.inputBackground??"",n=e.inputForeground??"",i=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=n,this.input.style.backgroundColor="inherit",this.input.style.color=n,this.element.style.border=`1px solid ${Vr(i,"transparent")}`}layout(){if(!this.mirror)return;let e=this.cachedContentHeight;this.cachedContentHeight=TS(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){let t=this.inputElement,n=t.selectionStart,i=t.selectionEnd,r=t.value;n!==null&&i!==null&&(this.value=r.substr(0,n)+e+r.substr(i),t.setSelectionRange(n+1,n+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}},DE=class extends LE{history;observer;_onDidFocus=this._register(new k);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new k);onDidBlur=this._onDidBlur.event;constructor(e,t,n){let i=m({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," or {0} for history","\u21C5"),r=m({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," ({0} for history)","\u21C5");super(e,t,n),this.history=new _E(n.history,100);let s=()=>{if(n.showHistoryHint&&n.showHistoryHint()&&!this.placeholder.endsWith(i)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){let a=this.placeholder.endsWith(")")?i:r,l=this.placeholder+a;n.showPlaceholderOnFocus&&!Br(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(d=>{d.target.textContent||s()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>s()),this.onblur(this.input,()=>{let a=l=>{if(this.placeholder.endsWith(l)){let d=this.placeholder.slice(0,this.placeholder.length-l.length);return n.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};a(r)||a(i)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}prependHistory(e){let t=this.getHistory();this.clearHistory(),e.forEach(n=>{this.history.add(n)}),t.forEach(n=>{this.history.add(n)})}getHistory(){return this.history.getHistory()}isAtFirstInHistory(){return this.history.isFirst()}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",kb(this.value?this.value:m("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,kb(this.value))}clearHistory(){this.history.clear()}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}};var d6=m("defaultLabel","input"),kE=class extends lo{static OPTION_CHANGE="optionChange";placeholder;validation;label;showCommonFindToggles;fixFocusOnOptionClickEnabled=!0;imeSessionInProgress=!1;additionalTogglesDisposables=this._register(new on);controls;regex;wholeWords;caseSensitive;additionalToggles=[];domNode;inputBox;_onDidOptionChange=this._register(new k);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new k);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new k);onMouseDown=this._onMouseDown.event;_onInput=this._register(new k);onInput=this._onInput.event;_onKeyUp=this._register(new k);onKeyUp=this._onKeyUp.event;_onCaseSensitiveKeyDown=this._register(new k);onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event;_onRegexKeyDown=this._register(new k);onRegexKeyDown=this._onRegexKeyDown.event;constructor(e,t,n){super(),this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||d6,this.showCommonFindToggles=!!n.showCommonFindToggles;let i=n.appendCaseSensitiveLabel||"",r=n.appendWholeWordsLabel||"",s=n.appendRegexLabel||"",a=n.history||[],l=!!n.flexibleHeight,d=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new DE(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:n.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles}));let u=this._register(Wl());if(this.showCommonFindToggles){this.regex=this._register(new wE({appendTitle:s,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.regex.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(h=>{this._onRegexKeyDown.fire(h)})),this.wholeWords=this._register(new TE({appendTitle:r,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.wholeWords.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new EE({appendTitle:i,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.caseSensitive.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(h=>{this._onCaseSensitiveKeyDown.fire(h)}));let p=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,h=>{if(h.equals(15)||h.equals(17)||h.equals(9)){let f=p.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;h.equals(17)?g=(f+1)%p.length:h.equals(15)&&(f===0?g=p.length-1:g=f-1),h.equals(9)?(p[f].blur(),this.inputBox.focus()):g>=0&&p[g].focus(),rt.stop(h,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(n?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e?.appendChild(this.domNode),this._register(q(this.inputBox.inputElement,"compositionstart",p=>{this.imeSessionInProgress=!0})),this._register(q(this.inputBox.inputElement,"compositionend",p=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,p=>this._onKeyDown.fire(p)),this.onkeyup(this.inputBox.inputElement,p=>this._onKeyUp.fire(p)),this.oninput(this.inputBox.inputElement,p=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,p=>this._onMouseDown.fire(p))}get isImeSessionInProgress(){return this.imeSessionInProgress}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(let e of this.additionalToggles)e.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(let e of this.additionalToggles)e.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(let t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new ne;for(let t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(n=>{this._onDidOptionChange.fire(n),!n&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((t,n)=>t+n.width(),0)}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}onSearchSubmit(){this.inputBox.addToHistory()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){return this.regex?.checked??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}focusOnRegex(){this.regex?.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}};var sn=class extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}},Nu=class{constructor(e){this.fn=e}_map=new WeakMap;map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}};function Fb(o){return typeof o=="object"&&"visibility"in o&&"data"in o}function Au(o){switch(o){case!0:return 1;case!1:return 0;default:return o}}function oR(o){return typeof o.collapsible=="boolean"}var RE=class{constructor(e,t,n={}){this.user=e;this.collapseByDefault=typeof n.collapseByDefault>"u"?!1:n.collapseByDefault,this.allowNonCollapsibleParents=n.allowNonCollapsibleParents??!1,this.filter=n.filter,this.autoExpandSingleChildren=typeof n.autoExpandSingleChildren>"u"?!1:n.autoExpandSingleChildren,this.root={parent:void 0,element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}rootRef=[];root;eventBufferer=new hd;_onDidSpliceModel=new k;onDidSpliceModel=this._onDidSpliceModel.event;_onDidSpliceRenderedNodes=new k;onDidSpliceRenderedNodes=this._onDidSpliceRenderedNodes.event;_onDidChangeCollapseState=new k;onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event);_onDidChangeRenderNodeCount=new k;onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event);collapseByDefault;allowNonCollapsibleParents;filter;autoExpandSingleChildren;refilterDelayer=new _s(by);splice(e,t,n=Je.empty(),i={}){if(e.length===0)throw new sn(this.user,"Invalid tree location");i.diffIdentityProvider?this.spliceSmart(i.diffIdentityProvider,e,t,n,i):this.spliceSimple(e,t,n,i)}spliceSmart(e,t,n,i=Je.empty(),r,s=r.diffDepth??0){let{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,n,i,r);let l=[...i],d=t[t.length-1],c=new Eb({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,d),...l,...a.children.slice(d+n)].map(g=>e.getId(g.element).toString())}).ComputeDiff(!1);if(c.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,n,l,r);let u=t.slice(0,-1),p=(g,b,v)=>{if(s>0)for(let I=0;I<v;I++)g--,b--,this.spliceSmart(e,[...u,g,0],Number.MAX_SAFE_INTEGER,l[b].children,r,s-1)},h=Math.min(a.children.length,d+n),f=l.length;for(let g of c.changes.sort((b,v)=>v.originalStart-b.originalStart))p(h,f,h-(g.originalStart+g.originalLength)),h=g.originalStart,f=g.modifiedStart-d,this.spliceSimple([...u,h],g.originalLength,Je.slice(l,f,f+g.modifiedLength),r);p(h,f,h)}spliceSimple(e,t,n=Je.empty(),{onDidCreateNode:i,onDidDeleteNode:r,diffIdentityProvider:s}){let{parentNode:a,listIndex:l,revealed:d,visible:c}=this.getParentNodeWithListIndex(e),u=[],p=Je.map(n,C=>this.createTreeNode(C,a,a.visible?1:0,d,u,i)),h=e[e.length-1],f=0;for(let C=h;C>=0&&C<a.children.length;C--){let w=a.children[C];if(w.visible){f=w.visibleChildIndex;break}}let g=[],b=0,v=0;for(let C of p)g.push(C),v+=C.renderNodeCount,C.visible&&(C.visibleChildIndex=f+b++);let I=F_(a.children,h,t,g);s?a.lastDiffIds?F_(a.lastDiffIds,h,t,g.map(C=>s.getId(C.element).toString())):a.lastDiffIds=a.children.map(C=>s.getId(C.element).toString()):a.lastDiffIds=void 0;let T=0;for(let C of I)C.visible&&T++;if(T!==0)for(let C=h+g.length;C<a.children.length;C++){let w=a.children[C];w.visible&&(w.visibleChildIndex-=T)}if(a.visibleChildrenCount+=b-T,d&&c){let C=I.reduce((w,x)=>w+(x.visible?x.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,v-C),this._onDidSpliceRenderedNodes.fire({start:l,deleteCount:C,elements:u})}if(I.length>0&&r){let C=w=>{r(w),w.children.forEach(C)};I.forEach(C)}this._onDidSpliceModel.fire({insertedNodes:g,deletedNodes:I});let S=a;for(;S;){if(S.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}S=S.parent}}rerender(e){if(e.length===0)throw new sn(this.user,"Invalid tree location");let{node:t,listIndex:n,revealed:i}=this.getTreeNodeWithListIndex(e);t.visible&&i&&this._onDidSpliceRenderedNodes.fire({start:n,deleteCount:1,elements:[t]})}has(e){return this.hasTreeNode(e)}getListIndex(e){let{listIndex:t,visible:n,revealed:i}=this.getTreeNodeWithListIndex(e);return n&&i?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){let n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsible);let i={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,i))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,n){let i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsed);let r={collapsed:t,recursive:n||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,r))}_setCollapseState(e,t){let{node:n,listIndex:i,revealed:r}=this.getTreeNodeWithListIndex(e),s=this._setListNodeCollapseState(n,i,r,t);if(n!==this.root&&this.autoExpandSingleChildren&&s&&!oR(t)&&n.collapsible&&!n.collapsed&&!t.recursive){let a=-1;for(let l=0;l<n.children.length;l++)if(n.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return s}_setListNodeCollapseState(e,t,n,i){let r=this._setNodeCollapseState(e,i,!1);if(!n||!e.visible||!r)return r;let s=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=s-(t===-1?0:1);return this._onDidSpliceRenderedNodes.fire({start:t+1,deleteCount:l,elements:a.slice(1)}),r}_setNodeCollapseState(e,t,n){let i;if(e===this.root?i=!1:(oR(t)?(i=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(i=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):i=!1,i&&this._onDidChangeCollapseState.fire({node:e,deep:n})),!oR(t)&&t.recursive)for(let r of e.children)i=this._setNodeCollapseState(r,t,!0)||i;return i}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){let e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this._onDidSpliceRenderedNodes.fire({start:0,deleteCount:e,elements:t}),this.refilterDelayer.cancel()}createTreeNode(e,t,n,i,r,s){let a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,n);a.visibility=l,i&&r.push(a);let d=e.children||Je.empty(),c=i&&l!==0&&!a.collapsed,u=0,p=1;for(let h of d){let f=this.createTreeNode(h,a,l,c,r,s);a.children.push(f),p+=f.renderNodeCount,f.visible&&(f.visibleChildIndex=u++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=u,a.visible=l===2?u>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=p):(a.renderNodeCount=0,i&&r.pop()),s?.(a),a}updateNodeAfterCollapseChange(e){let t=e.renderNodeCount,n=[];return this._updateNodeAfterCollapseChange(e,n),this._updateAncestorsRenderNodeCount(e.parent,n.length-t),n}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(let n of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(n,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){let t=e.renderNodeCount,n=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,n),this._updateAncestorsRenderNodeCount(e.parent,n.length-t),n}_updateNodeAfterFilterChange(e,t,n,i=!0){let r;if(e!==this.root){if(r=this._filterNode(e,t),r===0)return e.visible=!1,e.renderNodeCount=0,!1;i&&n.push(e)}let s=n.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||r!==0){let l=0;for(let d of e.children)a=this._updateNodeAfterFilterChange(d,r,n,i&&!e.collapsed)||a,d.visible&&(d.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=r===2?a:r===1,e.visibility=r),e.visible?e.collapsed||(e.renderNodeCount+=n.length-s):(e.renderNodeCount=0,i&&n.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){let n=this.filter?this.filter.filter(e.element,t):1;return typeof n=="boolean"?(e.filterData=void 0,n?1:0):Fb(n)?(e.filterData=n.data,Au(n.visibility)):(e.filterData=void 0,Au(n))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;let[n,...i]=e;return n<0||n>t.children.length?!1:this.hasTreeNode(i,t.children[n])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;let[n,...i]=e;if(n<0||n>t.children.length)throw new sn(this.user,"Invalid tree location");return this.getTreeNode(i,t.children[n])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};let{parentNode:t,listIndex:n,revealed:i,visible:r}=this.getParentNodeWithListIndex(e),s=e[e.length-1];if(s<0||s>t.children.length)throw new sn(this.user,"Invalid tree location");let a=t.children[s];return{node:a,listIndex:n,revealed:i,visible:r&&a.visible}}getParentNodeWithListIndex(e,t=this.root,n=0,i=!0,r=!0){let[s,...a]=e;if(s<0||s>t.children.length)throw new sn(this.user,"Invalid tree location");for(let l=0;l<s;l++)n+=t.children[l].renderNodeCount;return i=i&&!t.collapsed,r=r&&t.visible,a.length===0?{parentNode:t,listIndex:n,revealed:i,visible:r}:this.getParentNodeWithListIndex(a,t.children[s],n+1,i,r)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){let t=[],n=e;for(;n.parent;)t.push(n.parent.children.indexOf(n)),n=n.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:oy(e)[0]}getFirstElementChild(e){let t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}getLastElementAncestor(e=[]){let t=this.getTreeNode(e);if(t.children.length!==0)return this._getLastElementAncestor(t)}_getLastElementAncestor(e){return e.children.length===0?e.element:this._getLastElementAncestor(e.children[e.children.length-1])}};var sR=class extends Bl{constructor(t){super(t.elements.map(n=>n.element));this.data=t}set context(t){this.data.context=t}get context(){return this.data.context}};function rR(o){return o instanceof Bl?new sR(o):o}var aR=class{constructor(e,t){this.modelProvider=e;this.dnd=t}autoExpandNode;autoExpandDisposable=F.None;disposables=new ne;getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(n=>n.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(rR(e),t)}onDragOver(e,t,n,i,r,s=!0){let a=this.dnd.onDragOver(rR(e),t&&t.element,n,i,r),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=yf(()=>{let h=this.modelProvider(),f=h.getNodeLocation(t);h.isCollapsed(f)&&h.setCollapsed(f,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!s){let h=typeof a=="boolean"?a:a.accept,f=typeof a=="boolean"?void 0:a.effect;return{accept:h,effect:f,feedback:[n]}}return a}if(a.bubble===1){let h=this.modelProvider(),f=h.getNodeLocation(t),g=h.getParentNodeLocation(f),b=h.getNode(g),v=g&&h.getListIndex(g);return this.onDragOver(e,b,v,i,r,!1)}let d=this.modelProvider(),c=d.getNodeLocation(t),u=d.getListIndex(c),p=d.getListRenderCount(c);return{...a,feedback:Kn(u,u+p)}}drop(e,t,n,i,r){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(rR(e),t&&t.element,n,i,r)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}};function c6(o,e){return e&&{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new aR(o,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element})},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})}},accessibilityProvider:e.accessibilityProvider&&{...e.accessibilityProvider,getSetSize(t){let n=o(),i=n.getNodeLocation(t),r=n.getParentNodeLocation(i);return n.getNode(r).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}}}}var dm=class{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){this.delegate.setDynamicHeight?.(e.element,t)}},lR=class o{focus;selection;expanded;scrollTop;static lift(e){return e instanceof o?e:new o(e)}static empty(e=0){return new o({focus:[],selection:[],expanded:Object.create(null),scrollTop:e})}constructor(e){if(this.focus=new Set(e.focus),this.selection=new Set(e.selection),e.expanded instanceof Array){this.expanded=Object.create(null);for(let t of e.expanded)this.expanded[t]=1}else this.expanded=e.expanded;this.expanded=e.expanded,this.scrollTop=e.scrollTop}toJSON(){return{focus:Array.from(this.focus),selection:Array.from(this.selection),expanded:this.expanded,scrollTop:this.scrollTop}}};var dR=class{constructor(e,t=[]){this._elements=t;this.onDidChange=j.forEach(e,n=>this._elements=n,this.disposables)}disposables=new ne;onDidChange;get elements(){return this._elements}dispose(){this.disposables.dispose()}},cR=class o{constructor(e,t,n,i,r,s={}){this.renderer=e;this.model=t;this.activeNodes=i;this.renderedIndentGuides=r;this.templateId=e.templateId,this.updateOptions(s),j.map(n,a=>a.node)(this.onDidChangeNodeTwistieState,this,this.disposables),e.onDidChangeTwistieState?.(this.onDidChangeTwistieState,this,this.disposables)}static DefaultIndent=8;templateId;renderedElements=new Map;renderedNodes=new Map;indent=o.DefaultIndent;hideTwistiesOfChildlessElements=!1;shouldRenderIndentGuides=!1;activeIndentNodes=new Set;indentGuidesDisposable=F.None;disposables=new ne;updateOptions(e={}){if(typeof e.indent<"u"){let t=Di(e.indent,0,40);if(t!==this.indent){this.indent=t;for(let[n,i]of this.renderedNodes)this.renderTreeElement(n,i)}}if(typeof e.renderIndentGuides<"u"){let t=e.renderIndentGuides!=="none";if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(let[n,i]of this.renderedNodes)this._renderIndentGuides(n,i);if(this.indentGuidesDisposable.dispose(),t){let n=new ne;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,n),this.indentGuidesDisposable=n,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){let t=dt(e,Ke(".monaco-tl-row")),n=dt(t,Ke(".monaco-tl-indent")),i=dt(t,Ke(".monaco-tl-twistie")),r=dt(t,Ke(".monaco-tl-contents")),s=this.renderer.renderTemplate(r);return{container:e,indent:n,twistie:i,indentGuidesDisposable:F.None,templateData:s}}renderElement(e,t,n,i){this.renderedNodes.set(e,n),this.renderedElements.set(e.element,e),this.renderTreeElement(e,n),this.renderer.renderElement(e,t,n.templateData,i)}disposeElement(e,t,n,i){n.indentGuidesDisposable.dispose(),this.renderer.disposeElement?.(e,t,n.templateData,i),typeof i=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){let t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){let t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){let n=o.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${n}px`,t.indent.style.width=`${n+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...Be.asClassNameArray(ae.treeItemExpanded));let i=!1;this.renderer.renderTwistie&&(i=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(i||t.twistie.classList.add(...Be.asClassNameArray(ae.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(fi(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;let n=new ne;for(;;){let i=this.model.getNodeLocation(e),r=this.model.getParentNodeLocation(i);if(!r)break;let s=this.model.getNode(r),a=Ke(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(s)&&a.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(a):t.indent.insertBefore(a,t.indent.firstElementChild),this.renderedIndentGuides.add(s,a),n.add(pe(()=>this.renderedIndentGuides.delete(s,a))),e=s}t.indentGuidesDisposable=n}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;let t=new Set;e.forEach(n=>{let i=this.model.getNodeLocation(n);try{let r=this.model.getParentNodeLocation(i);n.collapsible&&n.children.length>0&&!n.collapsed?t.add(n):r&&t.add(this.model.getNode(r))}catch{}}),this.activeIndentNodes.forEach(n=>{t.has(n)||this.renderedIndentGuides.forEach(n,i=>i.classList.remove("active"))}),t.forEach(n=>{this.activeIndentNodes.has(n)||this.renderedIndentGuides.forEach(n,i=>i.classList.add("active"))}),this.activeIndentNodes=t}setModel(e){this.model=e}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),Tt(this.disposables)}},uR=class{constructor(e,t,n){this.tree=e;this.keyboardNavigationLabelProvider=t;this._filter=n;e.onWillRefilter(this.reset,this,this.disposables)}_totalCount=0;get totalCount(){return this._totalCount}_matchCount=0;get matchCount(){return this._matchCount}_pattern="";_lowercasePattern="";disposables=new ne;set pattern(e){this._pattern=e,this._lowercasePattern=e.toLowerCase()}filter(e,t){let n=1;if(this._filter){let s=this._filter.filter(e,t);if(typeof s=="boolean"?n=s?1:0:Fb(s)?n=Au(s.visibility):n=s,n===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:zc.Default,visibility:n};let i=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),r=Array.isArray(i)?i:[i];for(let s of r){let a=s&&s.toString();if(typeof a>"u")return{data:zc.Default,visibility:n};let l;if(this.tree.findMatchType===1){let d=a.toLowerCase().indexOf(this._lowercasePattern);if(d>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let c=this._lowercasePattern.length;c>0;c--)l.push(d+c-1)}}else l=Ny(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,r.length===1?{data:l,visibility:n}:{data:{label:a,score:l},visibility:n}}return this.tree.findMode===1?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:zc.Default,visibility:n}}reset(){this._totalCount=0,this._matchCount=0}dispose(){Tt(this.disposables)}},pR=class extends Vl{constructor(e){super({icon:ae.listFilter,title:m("filter","Filter"),isChecked:e.isChecked??!1,hoverDelegate:e.hoverDelegate??An("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},hR=class extends Vl{constructor(e){super({icon:ae.searchFuzzy,title:m("fuzzySearch","Fuzzy Match"),isChecked:e.isChecked??!1,hoverDelegate:e.hoverDelegate??An("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},u6={inputBoxStyles:nH,toggleStyles:tH,listFilterWidgetBackground:void 0,listFilterWidgetNoMatchesOutline:void 0,listFilterWidgetOutline:void 0,listFilterWidgetShadow:void 0};var mR=class extends F{constructor(t,n,i,r,s,a){super();this.tree=n;t.appendChild(this.elements.root),this._register(pe(()=>this.elements.root.remove()));let l=a?.styles??u6;l.listFilterWidgetBackground&&(this.elements.root.style.backgroundColor=l.listFilterWidgetBackground),l.listFilterWidgetShadow&&(this.elements.root.style.boxShadow=`0 0 8px 2px ${l.listFilterWidgetShadow}`);let d=this._register(Wl());this.modeToggle=this._register(new pR({...l.toggleStyles,isChecked:r===1,hoverDelegate:d})),this.matchTypeToggle=this._register(new hR({...l.toggleStyles,isChecked:s===0,hoverDelegate:d})),this.onDidChangeMode=j.map(this.modeToggle.onChange,()=>this.modeToggle.checked?1:0,this._store),this.onDidChangeMatchType=j.map(this.matchTypeToggle.onChange,()=>this.matchTypeToggle.checked?0:1,this._store),this.findInput=this._register(new kE(this.elements.findInput,i,{label:m("type to search","Type to search"),additionalToggles:[this.modeToggle,this.matchTypeToggle],showCommonFindToggles:!1,inputBoxStyles:l.inputBoxStyles,toggleStyles:l.toggleStyles,history:a?.history})),this.actionbar=this._register(new fr(this.elements.actionbar)),this.mode=r;let c=this._register(new Ne(this.findInput.inputBox.inputElement,"keydown")),u=j.chain(c.event,g=>g.map(b=>new gt(b)));this._register(u(g=>{if(g.equals(3)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.addToHistory(),this.tree.domFocus();return}if(g.equals(18)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.isAtLastInHistory()||this.findInput.inputBox.isNowhereInHistory()?(this.findInput.inputBox.addToHistory(),this.tree.domFocus()):this.findInput.inputBox.showNextValue();return}if(g.equals(16)){g.preventDefault(),g.stopPropagation(),this.findInput.inputBox.showPreviousValue();return}}));let p=this._register(new ai("close",m("close","Close"),"codicon codicon-close",!0,()=>this.dispose()));this.actionbar.push(p,{icon:!0,label:!1});let h=this._register(new Ne(this.elements.grab,"mousedown"));this._register(h.event(g=>{let b=new ne,v=b.add(new Ne(Ce(g),"mousemove")),I=b.add(new Ne(Ce(g),"mouseup")),T=this.right,S=g.pageX,C=this.top,w=g.pageY;this.elements.grab.classList.add("grabbing");let x=this.elements.root.style.transition;this.elements.root.style.transition="unset";let D=O=>{let H=O.pageX-S;this.right=T-H;let K=O.pageY-w;this.top=C+K,this.layout()};b.add(v.event(D)),b.add(I.event(O=>{D(O),this.elements.grab.classList.remove("grabbing"),this.elements.root.style.transition=x,b.dispose()}))}));let f=j.chain(this._register(new Ne(this.elements.grab,"keydown")).event,g=>g.map(b=>new gt(b)));this._register(f(g=>{let b,v;if(g.keyCode===15?b=Number.POSITIVE_INFINITY:g.keyCode===17?b=0:g.keyCode===10&&(b=this.right===0?Number.POSITIVE_INFINITY:0),g.keyCode===16?v=0:g.keyCode===18&&(v=Number.POSITIVE_INFINITY),b!==void 0&&(g.preventDefault(),g.stopPropagation(),this.right=b,this.layout()),v!==void 0){g.preventDefault(),g.stopPropagation(),this.top=v;let I=this.elements.root.style.transition;this.elements.root.style.transition="unset",this.layout(),setTimeout(()=>{this.elements.root.style.transition=I},0)}})),this.onDidChangeValue=this.findInput.onDidChange}elements=vt(".monaco-tree-type-filter",[vt(".monaco-tree-type-filter-grab.codicon.codicon-debug-gripper@grab",{tabIndex:0}),vt(".monaco-tree-type-filter-input@findInput"),vt(".monaco-tree-type-filter-actionbar@actionbar")]);set mode(t){this.modeToggle.checked=t===1,this.findInput.inputBox.setPlaceHolder(t===1?m("type to filter","Type to filter"):m("type to search","Type to search"))}set matchType(t){this.matchTypeToggle.checked=t===0}get value(){return this.findInput.inputBox.value}set value(t){this.findInput.inputBox.value=t}modeToggle;matchTypeToggle;findInput;actionbar;width=0;right=0;top=0;_onDidDisable=new k;onDidDisable=this._onDidDisable.event;onDidChangeValue;onDidChangeMode;onDidChangeMatchType;getHistory(){return this.findInput.inputBox.getHistory()}focus(){this.findInput.focus()}select(){this.findInput.select(),this.findInput.inputBox.addToHistory(!0)}layout(t=this.width){this.width=t,this.right=Di(this.right,0,Math.max(0,t-212)),this.elements.root.style.right=`${this.right}px`,this.top=Di(this.top,0,24),this.elements.root.style.top=`${this.top}px`}showMessage(t){this.findInput.showMessage(t)}clearMessage(){this.findInput.clearMessage()}async dispose(){this._onDidDisable.fire(),this.elements.root.classList.add("disabled"),await wi(300),super.dispose()}},gR=class{constructor(e,t,n,i,r={}){this.tree=e;this.view=t;this.filter=n;this.contextViewProvider=i;this.options=r;this._mode=e.options.defaultFindMode??0,this._matchType=e.options.defaultFindMatchType??0}_history;_pattern="";get pattern(){return this._pattern}previousPattern="";_mode;get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}_matchType;get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}widget;width=0;_onDidChangeMode=new k;onDidChangeMode=this._onDidChangeMode.event;_onDidChangeMatchType=new k;onDidChangeMatchType=this._onDidChangeMatchType.event;_onDidChangePattern=new k;onDidChangePattern=this._onDidChangePattern.event;_onDidChangeOpenState=new k;onDidChangeOpenState=this._onDidChangeOpenState.event;enabledDisposables=new ne;disposables=new ne;updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}isOpened(){return!!this.widget}open(){if(this.widget){this.widget.focus(),this.widget.select();return}this.widget=new mR(this.view.getHTMLElement(),this.tree,this.contextViewProvider,this.mode,this.matchType,{...this.options,history:this._history}),this.enabledDisposables.add(this.widget),this.widget.onDidChangeValue(this.onDidChangeValue,this,this.enabledDisposables),this.widget.onDidChangeMode(e=>this.mode=e,void 0,this.enabledDisposables),this.widget.onDidChangeMatchType(e=>this.matchType=e,void 0,this.enabledDisposables),this.widget.onDidDisable(this.close,this,this.enabledDisposables),this.widget.layout(this.width),this.widget.focus(),this.widget.value=this.previousPattern,this.widget.select(),this._onDidChangeOpenState.fire(!0)}close(){this.widget&&(this._history=this.widget.getHistory(),this.widget=void 0,this.enabledDisposables.clear(),this.previousPattern=this.pattern,this.onDidChangeValue(""),this.tree.domFocus(),this._onDidChangeOpenState.fire(!1))}onDidChangeValue(e){this._pattern=e,this._onDidChangePattern.fire(e),this.filter.pattern=e,this.tree.refilter(),e&&this.tree.focusNext(0,!0,void 0,n=>!zc.isDefault(n.filterData));let t=this.tree.getFocus();if(t.length>0){let n=t[0];this.tree.getRelativeTop(n)===null&&this.tree.reveal(n,.5)}this.render()}render(){let e=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&e?(ec(m("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?this.widget?.showMessage({type:2,content:m("not found","No elements found.")}):this.widget?.showMessage({type:2})):(this.widget?.clearMessage(),this.pattern&&ec(m("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(e){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!zc.isDefault(e.filterData)}layout(e){this.width=e,this.widget?.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function p6(o,e){return o.position===e.position&&oH(o,e)}function oH(o,e){return o.node.element===e.node.element&&o.startIndex===e.startIndex&&o.height===e.height&&o.endIndex===e.endIndex}var fR=class{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return Ut(this.stickyNodes,e.stickyNodes,p6)}lastNodePartiallyVisible(){if(this.count===0)return!1;let e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;let t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!Ut(this.stickyNodes,e.stickyNodes,oH)||this.count===0)return!1;let t=this.stickyNodes[this.count-1],n=e.stickyNodes[e.count-1];return t.position!==n.position}},bR=class{constrainStickyScrollNodes(e,t,n){for(let i=0;i<e.length;i++){let r=e[i];if(r.position+r.height>n||i>=t)return e.slice(0,i)}return e}},OE=class extends F{constructor(t,n,i,r,s,a={}){super();this.tree=t;this.model=n;this.view=i;this.treeDelegate=s;let l=this.validateStickySettings(a);this.stickyScrollMaxItemCount=l.stickyScrollMaxItemCount,this.stickyScrollDelegate=a.stickyScrollDelegate??new bR,this._widget=this._register(new vR(i.getScrollableElement(),i,t,r,s,a.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll(()=>this.update())),this._register(i.onDidChangeContentHeight(()=>this.update())),this._register(t.onDidChangeCollapseState(()=>this.update())),this.update()}onDidChangeHasFocus;onContextMenu;stickyScrollDelegate;stickyScrollMaxItemCount;maxWidgetViewRatio=.4;_widget;get height(){return this._widget.height}get count(){return this._widget.count}getNode(t){return this._widget.getNode(t)}getNodeAtHeight(t){let n;if(t===0?n=this.view.firstVisibleIndex:n=this.view.indexAt(t+this.view.scrollTop),!(n<0||n>=this.view.length))return this.view.element(n)}update(){let t=this.getNodeAtHeight(0);if(!t||this.tree.scrollTop===0){this._widget.setState(void 0);return}let n=this.findStickyState(t);this._widget.setState(n)}findStickyState(t){let n=[],i=t,r=0,s=this.getNextStickyNode(i,void 0,r);for(;s&&(n.push(s),r+=s.height,!(n.length<=this.stickyScrollMaxItemCount&&(i=this.getNextVisibleNode(s),!i)));)s=this.getNextStickyNode(i,s.node,r);let a=this.constrainStickyNodes(n);return a.length?new fR(a):void 0}getNextVisibleNode(t){return this.getNodeAtHeight(t.position+t.height)}getNextStickyNode(t,n,i){let r=this.getAncestorUnderPrevious(t,n);if(r&&!(r===t&&(!this.nodeIsUncollapsedParent(t)||this.nodeTopAlignsWithStickyNodesBottom(t,i))))return this.createStickyScrollNode(r,i)}nodeTopAlignsWithStickyNodesBottom(t,n){let i=this.getNodeIndex(t),r=this.view.getElementTop(i),s=n;return this.view.scrollTop===r-s}createStickyScrollNode(t,n){let i=this.treeDelegate.getHeight(t),{startIndex:r,endIndex:s}=this.getNodeRange(t),a=this.calculateStickyNodePosition(s,n,i);return{node:t,position:a,height:i,startIndex:r,endIndex:s}}getAncestorUnderPrevious(t,n=void 0){let i=t,r=this.getParentNode(i);for(;r;){if(r===n)return i;i=r,r=this.getParentNode(i)}if(n===void 0)return i}calculateStickyNodePosition(t,n,i){let r=this.view.getRelativeTop(t);if(r===null&&this.view.firstVisibleIndex===t&&t+1<this.view.length){let c=this.treeDelegate.getHeight(this.view.element(t)),u=this.view.getRelativeTop(t+1);r=u?u-c/this.view.renderHeight:null}if(r===null)return n;let s=this.view.element(t),a=this.treeDelegate.getHeight(s),d=r*this.view.renderHeight+a;return n+i>d&&n<=d?d-i:n}constrainStickyNodes(t){if(t.length===0)return[];let n=this.view.renderHeight*this.maxWidgetViewRatio,i=t[t.length-1];if(t.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=n)return t;let r=this.stickyScrollDelegate.constrainStickyScrollNodes(t,this.stickyScrollMaxItemCount,n);if(!r.length)return[];let s=r[r.length-1];if(r.length>this.stickyScrollMaxItemCount||s.position+s.height>n)throw new Error("stickyScrollDelegate violates constraints");return r}getParentNode(t){let n=this.model.getNodeLocation(t),i=this.model.getParentNodeLocation(n);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(t){let n=this.model.getNodeLocation(t);return this.model.getListRenderCount(n)>1}getNodeIndex(t){let n=this.model.getNodeLocation(t);return this.model.getListIndex(n)}getNodeRange(t){let n=this.model.getNodeLocation(t),i=this.model.getListIndex(n);if(i<0)throw new Error("Node not found in tree");let r=this.model.getListRenderCount(n),s=i+r-1;return{startIndex:i,endIndex:s}}nodePositionTopBelowWidget(t){let n=[],i=this.getParentNode(t);for(;i;)n.push(i),i=this.getParentNode(i);let r=0;for(let s=0;s<n.length&&s<this.stickyScrollMaxItemCount;s++)r+=this.treeDelegate.getHeight(n[s]);return r}getFocus(){return this._widget.getFocus()}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(t={}){if(!t.stickyScrollMaxItemCount)return;let n=this.validateStickySettings(t);this.stickyScrollMaxItemCount!==n.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=n.stickyScrollMaxItemCount,this.update())}validateStickySettings(t){let n=7;return typeof t.stickyScrollMaxItemCount=="number"&&(n=Math.max(t.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:n}}setModel(t){this.model=t}},vR=class{constructor(e,t,n,i,r,s){this.view=t;this.tree=n;this.treeRenderers=i;this.treeDelegate=r;this.accessibilityProvider=s;this._rootDomNode=Ke(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);let a=Ke(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new yR(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}_rootDomNode;_previousState;_previousElements=[];_previousStateDisposables=new ne;stickyScrollFocus;onDidChangeHasFocus;onContextMenu;get height(){if(!this._previousState)return 0;let e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}get count(){return this._previousState?.count??0}getNode(e){return this._previousState?.stickyNodes.find(t=>t.node===e)}setState(e){let t=!!this._previousState&&this._previousState.count>0,n=!!e&&e.count>0;if(!t&&!n||t&&n&&this._previousState.equal(e))return;if(t!==n&&this.setVisible(n),!n){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}let i=e.stickyNodes[e.count-1];if(this._previousState&&e.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${i.position}px`;else{this._previousStateDisposables.clear();let r=Array(e.count);for(let s=e.count-1;s>=0;s--){let a=e.stickyNodes[s],{element:l,disposable:d}=this.createElement(a,s,e.count);r[s]=l,this._rootDomNode.appendChild(l),this._previousStateDisposables.add(d)}this.stickyScrollFocus.updateElements(r,e),this._previousElements=r}this._previousState=e,this._rootDomNode.style.height=`${i.position+i.height}px`}createElement(e,t,n){let i=e.startIndex,r=document.createElement("div");r.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(r.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(r.style.lineHeight=`${e.height}px`),r.classList.add("monaco-tree-sticky-row"),r.classList.add("monaco-list-row"),r.setAttribute("data-index",`${i}`),r.setAttribute("data-parity",i%2===0?"even":"odd"),r.setAttribute("id",this.view.getElementID(i));let s=this.setAccessibilityAttributes(r,e.node.element,t,n),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(p=>p.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let d=e.node;d===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(d=new Proxy(e.node,{}));let c=l.renderTemplate(r);l.renderElement(d,e.startIndex,c,e.height);let u=pe(()=>{s.dispose(),l.disposeElement(d,e.startIndex,c,e.height),l.disposeTemplate(c),r.remove()});return{element:r,disposable:u}}setAccessibilityAttributes(e,t,n,i){if(!this.accessibilityProvider)return F.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,n,i))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,n))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");let r=this.accessibilityProvider.getAriaLabel(t),s=r&&typeof r!="string"?r:ud(r),a=ot(d=>{let c=d.readObservable(s);c?e.setAttribute("aria-label",c):e.removeAttribute("aria-label")});typeof r=="string"||r&&e.setAttribute("aria-label",r.get());let l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}getFocus(){return this.stickyScrollFocus.getFocus()}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}},yR=class extends F{constructor(t,n){super();this.container=t;this.view=n;this._register(q(this.container,"focus",()=>this.onFocus())),this._register(q(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(i=>this.onKeyDown(i))),this._register(this.view.onMouseDown(i=>this.onMouseDown(i))),this._register(this.view.onContextMenu(i=>this.handleContextMenu(i)))}focusedIndex=-1;elements=[];state;_onDidChangeHasFocus=new k;onDidChangeHasFocus=this._onDidChangeHasFocus.event;_onContextMenu=new k;onContextMenu=this._onContextMenu.event;_domHasFocus=!1;get domHasFocus(){return this._domHasFocus}set domHasFocus(t){t!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(t),this._domHasFocus=t)}handleContextMenu(t){let n=t.browserEvent.target;if(!rm(n)&&!om(n)){this.focusedLast()&&this.view.domFocus();return}if(!ss(t.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");let a=this.state.stickyNodes.findIndex(l=>l.node.element===t.element?.element);if(a===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(a);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");let r=this.state.stickyNodes[this.focusedIndex].node.element,s=this.elements[this.focusedIndex];this._onContextMenu.fire({element:r,anchor:s,browserEvent:t.browserEvent,isStickyScroll:!0})}onKeyDown(t){if(this.domHasFocus&&this.state){if(t.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),t.preventDefault(),t.stopPropagation();else if(t.key==="ArrowDown"||t.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){let n=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([n]),this.scrollNodeUnderWidget(n,this.state)}else this.setFocusedElement(this.focusedIndex+1);t.preventDefault(),t.stopPropagation()}}}onMouseDown(t){let n=t.browserEvent.target;!rm(n)&&!om(n)||(t.browserEvent.preventDefault(),t.browserEvent.stopPropagation())}updateElements(t,n){if(n&&n.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(n&&n.count!==t.length)throw new Error("Sticky scroll focus received illigel state");let i=this.focusedIndex;if(this.removeFocus(),this.elements=t,this.state=n,n){let r=Di(i,0,n.count-1);this.setFocus(r)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=n?0:-1}setFocusedElement(t){let n=this.state;if(!n)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(t),!(t<n.count-1)&&n.lastNodePartiallyVisible()){let i=n.stickyNodes[t];this.scrollNodeUnderWidget(i.endIndex+1,n)}}scrollNodeUnderWidget(t,n){let i=n.stickyNodes[n.count-1],r=n.count>1?n.stickyNodes[n.count-2]:void 0,s=this.view.getElementTop(t),a=r?r.position+r.height+i.height:i.height;this.view.scrollTop=s-a}getFocus(){if(!(!this.state||this.focusedIndex===-1))return this.state.stickyNodes[this.focusedIndex].node.element}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(t){if(0>t)throw new Error("addFocus() can not remove focus");if(!this.state&&t>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&t>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");let n=this.focusedIndex;n>=0&&this.toggleElementFocus(this.elements[n],!1),t>=0&&this.toggleElementFocus(this.elements[t],!0),this.focusedIndex=t}toggleElementFocus(t,n){this.toggleElementActiveFocus(t,n&&this.domHasFocus),this.toggleElementPassiveFocus(t,n)}toggleCurrentElementActiveFocus(t){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],t)}toggleElementActiveFocus(t,n){t.classList.toggle("focused",n)}toggleElementPassiveFocus(t,n){t.classList.toggle("passive-focused",n)}toggleStickyScrollFocused(t){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",t)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}};function lm(o){let e=0;return wS(o.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=1:wS(o.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=2:wS(o.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=3),{browserEvent:o.browserEvent,element:o.element?o.element.element:null,target:e}}function h6(o){let e=rm(o.browserEvent.target);return{element:o.element?o.element.element:null,browserEvent:o.browserEvent,anchor:o.anchor,isStickyScroll:e}}function ME(o,e){e(o),o.children.forEach(t=>ME(t,e))}var Bb=class{constructor(e,t){this.getFirstViewElementWithTrait=e;this.identityProvider=t}nodes=[];elements;_onDidChange=new k;onDidChange=this._onDidChange.event;_nodeSet;get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(e,t){!t?.__forceEvent&&Ut(this.nodes,e)||this._set(e,!1,t)}_set(e,t,n){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){let i=this;this._onDidChange.fire({get elements(){return i.get()},browserEvent:n})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){let l=this.createNodeSet(),d=c=>l.delete(c);t.forEach(c=>ME(c,d)),this.set([...l.values()]);return}let n=new Set,i=l=>n.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>ME(l,i));let r=new Map,s=l=>r.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>ME(l,s));let a=[];for(let l of this.nodes){let d=this.identityProvider.getId(l.element).toString();if(!n.has(d))a.push(l);else{let u=r.get(d);u&&u.visible&&a.push(u)}}if(this.nodes.length>0&&a.length===0){let l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){let e=new Set;for(let t of this.nodes)e.add(t);return e}},IR=class extends Mb{constructor(t,n,i){super(t);this.tree=n;this.stickyScrollProvider=i}onViewPointer(t){if(W1(t.browserEvent.target)||as(t.browserEvent.target)||nm(t.browserEvent.target)||t.browserEvent.isHandledByList)return;let n=t.element;if(!n)return super.onViewPointer(t);if(this.isSelectionRangeChangeEvent(t)||this.isSelectionSingleChangeEvent(t))return super.onViewPointer(t);let i=t.browserEvent.target,r=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.browserEvent.offsetX<16,s=om(t.browserEvent.target),a=!1;if(s?a=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?a=this.tree.expandOnlyOnTwistieClick(n.element):a=!!this.tree.expandOnlyOnTwistieClick,s)this.handleStickyScrollMouseEvent(t,n);else{if(a&&!r&&t.browserEvent.detail!==2)return super.onViewPointer(t);if(!this.tree.expandOnDoubleClick&&t.browserEvent.detail===2)return super.onViewPointer(t)}if(n.collapsible&&(!s||r)){let l=this.tree.getNodeLocation(n),d=t.browserEvent.altKey;if(this.tree.setFocus([l]),this.tree.toggleCollapsed(l,d),r){t.browserEvent.isHandledByList=!0;return}}s||super.onViewPointer(t)}handleStickyScrollMouseEvent(t,n){if(HV(t.browserEvent.target)||UV(t.browserEvent.target))return;let i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");let r=this.list.indexOf(n),s=this.list.getElementTop(r),a=i.nodePositionTopBelowWidget(n);this.tree.scrollTop=s-a,this.list.domFocus(),this.list.setFocus([r]),this.list.setSelection([r])}onDoubleClick(t){t.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||t.browserEvent.isHandledByList||super.onDoubleClick(t)}onMouseDown(t){let n=t.browserEvent.target;if(!rm(n)&&!om(n)){super.onMouseDown(t);return}}onContextMenu(t){let n=t.browserEvent.target;if(!rm(n)&&!om(n)){super.onContextMenu(t);return}}},CR=class extends Jn{constructor(t,n,i,r,s,a,l,d){super(t,n,i,r,d);this.focusTrait=s;this.selectionTrait=a;this.anchorTrait=l}createMouseController(t){return new IR(this,t.tree,t.stickyScrollProvider)}splice(t,n,i=[]){if(super.splice(t,n,i),i.length===0)return;let r=[],s=[],a;i.forEach((l,d)=>{this.focusTrait.has(l)&&r.push(t+d),this.selectionTrait.has(l)&&s.push(t+d),this.anchorTrait.has(l)&&(a=t+d)}),r.length>0&&super.setFocus(bs([...super.getFocus(),...r])),s.length>0&&super.setSelection(bs([...super.getSelection(),...s])),typeof a=="number"&&super.setAnchor(a)}setFocus(t,n,i=!1){super.setFocus(t,n),i||this.focusTrait.set(t.map(r=>this.element(r)),n)}setSelection(t,n,i=!1){super.setSelection(t,n),i||this.selectionTrait.set(t.map(r=>this.element(r)),n)}setAnchor(t,n=!1){super.setAnchor(t),n||(typeof t>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(t)]))}};var cm=class{constructor(e,t,n,i,r={}){this._user=e;this._options=r;let s;r.keyboardNavigationLabelProvider&&(s=new uR(this,r.keyboardNavigationLabelProvider,r.filter),r={...r,filter:s},this.disposables.add(s)),this.model=this.createModel(e,r),this.treeDelegate=new dm(n);let a=this.disposables.add(new dR(this.onDidChangeActiveNodesRelay.event)),l=new Dc;this.renderers=i.map(d=>new cR(d,this.model,this.onDidChangeCollapseStateRelay.event,a,l,r));for(let d of this.renderers)this.disposables.add(d);if(this.focus=new Bb(()=>this.view.getFocusedElements()[0],r.identityProvider),this.selection=new Bb(()=>this.view.getSelectedElements()[0],r.identityProvider),this.anchor=new Bb(()=>this.view.getAnchorElement(),r.identityProvider),this.view=new CR(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...c6(()=>this.model,r),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.setupModel(this.model),r.keyboardSupport!==!1){let d=j.chain(this.view.onKeyDown,c=>c.filter(u=>!as(u.target)).map(u=>new gt(u)));j.chain(d,c=>c.filter(u=>u.keyCode===15))(this.onLeftArrow,this,this.disposables),j.chain(d,c=>c.filter(u=>u.keyCode===17))(this.onRightArrow,this,this.disposables),j.chain(d,c=>c.filter(u=>u.keyCode===10))(this.onSpace,this,this.disposables)}if((r.findWidgetEnabled??!0)&&r.keyboardNavigationLabelProvider&&r.contextViewProvider){let d=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new gR(this,this.view,s,r.contextViewProvider,d),this.focusNavigationFilter=c=>this.findController.shouldAllowFocus(c),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType,this.disposables.add(this.onDidSpliceModelRelay.event(()=>{!this.findController.isOpened()||this.findController.pattern.length===0||(this.refilter(),this.findController.render())}))}else this.onDidChangeFindMode=j.None,this.onDidChangeFindMatchType=j.None;r.enableStickyScroll&&(this.stickyScrollController=new OE(this,this.model,this.view,this.renderers,this.treeDelegate,r),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=pr(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}view;renderers;model;treeDelegate;focus;selection;anchor;eventBufferer=new hd;findController;onDidChangeFindOpenState=j.None;onDidChangeStickyScrollFocused=j.None;focusNavigationFilter;stickyScrollController;styleElement;disposables=new ne;get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseClick(){return j.map(this.view.onMouseClick,lm)}get onMouseDblClick(){return j.filter(j.map(this.view.onMouseDblClick,lm),e=>e.target!==3)}get onMouseOver(){return j.map(this.view.onMouseOver,lm)}get onMouseOut(){return j.map(this.view.onMouseOut,lm)}get onContextMenu(){return j.any(j.filter(j.map(this.view.onContextMenu,h6),e=>!e.isStickyScroll),this.stickyScrollController?.onContextMenu??j.None)}get onTap(){return j.map(this.view.onTap,lm)}get onPointer(){return j.map(this.view.onPointer,lm)}get onKeyDown(){return this.view.onKeyDown}get onKeyUp(){return this.view.onKeyUp}get onKeyPress(){return this.view.onKeyPress}get onDidFocus(){return this.view.onDidFocus}get onDidBlur(){return this.view.onDidBlur}onDidSwapModel=this.disposables.add(new k);onDidChangeModelRelay=this.disposables.add(new Yr);onDidSpliceModelRelay=this.disposables.add(new Yr);onDidChangeCollapseStateRelay=this.disposables.add(new Yr);onDidChangeRenderNodeCountRelay=this.disposables.add(new Yr);onDidChangeActiveNodesRelay=this.disposables.add(new Yr);get onDidChangeModel(){return j.any(this.onDidChangeModelRelay.event,this.onDidSwapModel.event)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}_onWillRefilter=new k;onWillRefilter=this._onWillRefilter.event;get findMode(){return this.findController?.mode??0}set findMode(e){this.findController&&(this.findController.mode=e)}onDidChangeFindMode;get findMatchType(){return this.findController?.matchType??0}set findMatchType(e){this.findController&&(this.findController.matchType=e)}onDidChangeFindMatchType;get onDidChangeFindPattern(){return this.findController?this.findController.onDidChangePattern:j.None}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}_onDidUpdateOptions=new k;onDidUpdateOptions=this._onDidUpdateOptions.event;get onDidDispose(){return this.view.onDidDispose}updateOptions(e={}){this._options={...this._options,...e};for(let t of this.renderers)t.updateOptions(e);this.view.updateOptions(this._options),this.findController?.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}get options(){return this._options}updateStickyScroll(e){!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new OE(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=j.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),this.stickyScrollController?.updateOptions(e)}updateWidth(e){let t=this.model.getListIndex(e);t!==-1&&this.view.updateWidth(t)}getHTMLElement(){return this.view.getHTMLElement()}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollLeft(){return this.view.scrollLeft}set scrollLeft(e){this.view.scrollLeft=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleElement(){let e=this.view.firstVisibleIndex;return this.stickyScrollController&&(e+=this.stickyScrollController.count),e<0||e>=this.view.length?void 0:this.view.element(e).element}get lastVisibleElement(){let e=this.view.lastVisibleIndex;return this.view.element(e).element}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}get selectionSize(){return this.selection.getNodes().length}domFocus(){this.stickyScrollController?.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}isDOMFocused(){return Br(this.getHTMLElement())}layout(e,t){this.view.layout(e,t),Ui(t)&&this.findController?.layout(t)}style(e){let t=`.${this.view.domId}`,n=[];e.treeIndentGuidesStroke&&(n.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),n.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`));let i=e.treeStickyScrollBackground??e.listBackground;i&&(n.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${i}; }`),n.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${i}; }`)),e.treeStickyScrollBorder&&n.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&n.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(n.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),n.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));let r=Vr(e.listFocusAndSelectionOutline,Vr(e.listSelectionOutline,e.listFocusOutline??""));r&&(n.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${r}; outline-offset: -1px;}`),n.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(n.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),n.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=n.join(`
`),this.view.style(e)}getParentElement(e){let t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}expandAll(){this.model.setCollapsed(this.model.rootRef,!1,!0)}collapseAll(){this.model.setCollapsed(this.model.rootRef,!0,!0)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}expandTo(e){this.model.expandTo(e)}triggerTypeNavigation(){this.view.triggerTypeNavigation()}openFind(){this.findController?.open()}closeFind(){this.findController?.close()}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setAnchor(e){if(typeof e>"u")return this.view.setAnchor(void 0);this.eventBufferer.bufferEvents(()=>{let t=this.model.getNode(e);this.anchor.set([t]);let n=this.model.getListIndex(e);n>-1&&this.view.setAnchor(n,!0)})}getAnchor(){return this.anchor.get().at(0)}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{let n=e.map(r=>this.model.getNode(r));this.selection.set(n,t);let i=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setSelection(i,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{let n=e.map(r=>this.model.getNode(r));this.focus.set(n,t);let i=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setFocus(i,t,!0)})}focusNext(e=1,t=!1,n,i=ss(n)&&n.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,n,i)}focusPrevious(e=1,t=!1,n,i=ss(n)&&n.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,n,i)}focusNextPage(e,t=ss(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=ss(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>this.stickyScrollController?.height??0)}focusLast(e,t=ss(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=ss(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}getStickyScrollFocus(){let e=this.stickyScrollController?.getFocus();return e!==void 0?[e]:[]}getFocusedPart(){return this.stickyScrollController?.focusedLast()?1:0}reveal(e,t){this.model.expandTo(e);let n=this.model.getListIndex(e);if(n!==-1)if(!this.stickyScrollController)this.view.reveal(n,t);else{let i=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(n,t,i)}}getRelativeTop(e){let t=this.model.getListIndex(e);if(t===-1)return null;let n=this.stickyScrollController?.getNode(this.getNode(e));return this.view.getRelativeTop(t,n?.position??this.stickyScrollController?.height)}getViewState(e=this.options.identityProvider){if(!e)throw new sn(this._user,"Can't get tree view state without an identity provider");let t=s=>e.getId(s).toString(),n=lR.empty(this.scrollTop);for(let s of this.getFocus())n.focus.add(t(s));for(let s of this.getSelection())n.selection.add(t(s));let i=this.model.getNode(),r=[i];for(;r.length>0;){let s=r.shift();s!==i&&s.collapsible&&(n.expanded[t(s.element)]=s.collapsed?0:1),r.push(...s.children)}return n}onLeftArrow(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let n=t[0],i=this.model.getNodeLocation(n);if(!this.model.setCollapsed(i,!0)){let s=this.model.getParentNodeLocation(i);if(!s)return;let a=this.model.getListIndex(s);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let n=t[0],i=this.model.getNodeLocation(n);if(!this.model.setCollapsed(i,!1)){if(!n.children.some(l=>l.visible))return;let[s]=this.view.getFocus(),a=s+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();let t=this.view.getFocusedElements();if(t.length===0)return;let n=t[0],i=this.model.getNodeLocation(n),r=e.browserEvent.altKey;this.model.setCollapsed(i,void 0,r)}modelDisposables=new ne;setupModel(e){this.modelDisposables.clear(),this.modelDisposables.add(e.onDidSpliceRenderedNodes(({start:r,deleteCount:s,elements:a})=>this.view.splice(r,s,a)));let t=j.forEach(e.onDidSpliceModel,r=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(r),this.selection.onDidModelSplice(r)})},this.modelDisposables);t(()=>null,null,this.modelDisposables);let n=this.modelDisposables.add(new k),i=this.modelDisposables.add(new _s(0));this.modelDisposables.add(j.any(t,this.focus.onDidChange,this.selection.onDidChange)(()=>{i.trigger(()=>{let r=new Set;for(let s of this.focus.getNodes())r.add(s);for(let s of this.selection.getNodes())r.add(s);n.fire([...r.values()])})})),this.onDidChangeActiveNodesRelay.input=n.event,this.onDidChangeModelRelay.input=j.signal(e.onDidSpliceModel),this.onDidChangeCollapseStateRelay.input=e.onDidChangeCollapseState,this.onDidChangeRenderNodeCountRelay.input=e.onDidChangeRenderNodeCount}setModel(e){let t=this.model;this.model=e,this.setupModel(e),this.renderers.forEach(n=>n.setModel(e)),this.stickyScrollController?.setModel(e),this.focus.set([]),this.selection.set([]),this.anchor.set([]),this.view.splice(0,t.getListRenderCount(t.rootRef)),this.model.refilter(),this.onDidSwapModel.fire()}getModel(){return this.model}navigate(e){return new SR(this.view,this.model,e)}dispose(){Tt(this.disposables),this.stickyScrollController?.dispose(),this.view.dispose(),this.modelDisposables.dispose()}},SR=class{constructor(e,t,n){this.view=e;this.model=t;n?this.index=this.model.getListIndex(n):this.index=-1}index;current(){return this.index<0||this.index>=this.view.length?null:this.view.element(this.index).element}previous(){return this.index--,this.current()}next(){return this.index++,this.current()}first(){return this.index=0,this.current()}last(){return this.index=this.view.length-1,this.current()}};var rc=class{constructor(e,t={}){this.user=e;this.model=new RE(e,null,t),this.onDidSpliceModel=this.model.onDidSpliceModel,this.onDidSpliceRenderedNodes=this.model.onDidSpliceRenderedNodes,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,t.sorter&&(this.sorter={compare(n,i){return t.sorter.compare(n.element,i.element)}}),this.identityProvider=t.identityProvider}rootRef=null;model;nodes=new Map;nodesByIdentity=new Map;identityProvider;sorter;onDidSpliceModel;onDidSpliceRenderedNodes;onDidChangeCollapseState;onDidChangeRenderNodeCount;get size(){return this.nodes.size}setChildren(e,t=Je.empty(),n={}){let i=this.getElementLocation(e);this._setChildren(i,this.preserveCollapseState(t),n)}_setChildren(e,t=Je.empty(),n){let i=new Set,r=new Set,s=l=>{if(l.element===null)return;let d=l;if(i.add(d.element),this.nodes.set(d.element,d),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();r.add(c),this.nodesByIdentity.set(c,d)}n.onDidCreateNode?.(d)},a=l=>{if(l.element===null)return;let d=l;if(i.has(d.element)||this.nodes.delete(d.element),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();r.has(c)||this.nodesByIdentity.delete(c)}n.onDidDeleteNode?.(d)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...n,onDidCreateNode:s,onDidDeleteNode:a})}preserveCollapseState(e=Je.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),Je.map(e,t=>{let n=this.nodes.get(t.element);if(!n&&this.identityProvider){let s=this.identityProvider.getId(t.element).toString();n=this.nodesByIdentity.get(s)}if(!n){let s;return typeof t.collapsed>"u"?s=void 0:t.collapsed===1||t.collapsed===3?s=!0:t.collapsed===0||t.collapsed===2?s=!1:s=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:s}}let i=typeof t.collapsible=="boolean"?t.collapsible:n.collapsible,r;return typeof t.collapsed>"u"||t.collapsed===3||t.collapsed===2?r=n.collapsed:t.collapsed===1?r=!0:t.collapsed===0?r=!1:r=!!t.collapsed,{...t,collapsible:i,collapsed:r,children:this.preserveCollapseState(t.children)}})}rerender(e){let t=this.getElementLocation(e);this.model.rerender(t)}resort(e=null,t=!0){if(!this.sorter)return;let n=this.getElementLocation(e),i=this.model.getNode(n);this._setChildren(n,this.resortChildren(i,t),{})}resortChildren(e,t,n=!0){let i=[...e.children];return(t||n)&&(i=i.sort(this.sorter.compare.bind(this.sorter))),Je.map(i,r=>({element:r.element,collapsible:r.collapsible,collapsed:r.collapsed,children:this.resortChildren(r,t,!1)}))}getFirstElementChild(e=null){let t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}getLastElementAncestor(e=null){let t=this.getElementLocation(e);return this.model.getLastElementAncestor(t)}has(e){return this.nodes.has(e)}getListIndex(e){let t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){let t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){let t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){let n=this.getElementLocation(e);return this.model.setCollapsible(n,t)}isCollapsed(e){let t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,n){let i=this.getElementLocation(e);return this.model.setCollapsed(i,t,n)}expandTo(e){let t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);let t=this.nodes.get(e);if(!t)throw new sn(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new sn(this.user,"Invalid getParentNodeLocation call");let t=this.nodes.get(e);if(!t)throw new sn(this.user,`Tree element not found: ${e}`);let n=this.model.getNodeLocation(t),i=this.model.getParentNodeLocation(n);return this.model.getNode(i).element}getElementLocation(e){if(e===null)return[];let t=this.nodes.get(e);if(!t)throw new sn(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}};function NE(o){let e=[o.element],t=o.incompressible||!1;return{element:{elements:e,incompressible:t},children:Je.map(Je.from(o.children),NE),collapsible:o.collapsible,collapsed:o.collapsed}}function AE(o){let e=[o.element],t=o.incompressible||!1,n,i;for(;[i,n]=Je.consume(Je.from(o.children),2),!(i.length!==1||i[0].incompressible);)o=i[0],e.push(o.element);return{element:{elements:e,incompressible:t},children:Je.map(Je.concat(i,n),AE),collapsible:o.collapsible,collapsed:o.collapsed}}function ER(o,e=0){let t;return e<o.element.elements.length-1?t=[ER(o,e+1)]:t=Je.map(Je.from(o.children),n=>ER(n,0)),e===0&&o.element.incompressible?{element:o.element.elements[e],children:t,incompressible:!0,collapsible:o.collapsible,collapsed:o.collapsed}:{element:o.element.elements[e],children:t,collapsible:o.collapsible,collapsed:o.collapsed}}function rH(o){return ER(o,0)}function sH(o,e,t){return o.element===e?{...o,children:t}:{...o,children:Je.map(Je.from(o.children),n=>sH(n,e,t))}}var g6=o=>({getId(e){return e.elements.map(t=>o.getId(t).toString()).join("\0")}}),TR=class{constructor(e,t={}){this.user=e;this.model=new rc(e,t),this.enabled=typeof t.compressionEnabled>"u"?!0:t.compressionEnabled,this.identityProvider=t.identityProvider}rootRef=null;get onDidSpliceRenderedNodes(){return this.model.onDidSpliceRenderedNodes}get onDidSpliceModel(){return this.model.onDidSpliceModel}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}model;nodes=new Map;enabled;identityProvider;get size(){return this.nodes.size}setChildren(e,t=Je.empty(),n){let i=n.diffIdentityProvider&&g6(n.diffIdentityProvider);if(e===null){let f=Je.map(t,this.enabled?AE:NE);this._setChildren(null,f,{diffIdentityProvider:i,diffDepth:1/0});return}let r=this.nodes.get(e);if(!r)throw new sn(this.user,"Unknown compressed tree node");let s=this.model.getNode(r),a=this.model.getParentNodeLocation(r),l=this.model.getNode(a),d=rH(s),c=sH(d,e,t),u=(this.enabled?AE:NE)(c),p=n.diffIdentityProvider?(f,g)=>n.diffIdentityProvider.getId(f)===n.diffIdentityProvider.getId(g):void 0;if(Ut(u.element.elements,s.element.elements,p)){this._setChildren(r,u.children||Je.empty(),{diffIdentityProvider:i,diffDepth:1});return}let h=l.children.map(f=>f===s?u:f);this._setChildren(l.element,h,{diffIdentityProvider:i,diffDepth:s.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;let n=this.model.getNode().children,i=Je.map(n,rH),r=Je.map(i,e?AE:NE);this._setChildren(null,r,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,n){let i=new Set,r=a=>{for(let l of a.element.elements)i.add(l),this.nodes.set(l,a.element)},s=a=>{for(let l of a.element.elements)i.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...n,onDidCreateNode:r,onDidDeleteNode:s})}has(e){return this.nodes.has(e)}getListIndex(e){let t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){let t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();let t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){let t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){let t=this.getCompressedNode(e),n=this.model.getParentNodeLocation(t);return n===null?null:n.elements[n.elements.length-1]}getFirstElementChild(e){let t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}getLastElementAncestor(e){let t=typeof e>"u"?void 0:this.getCompressedNode(e);return this.model.getLastElementAncestor(t)}isCollapsible(e){let t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){let n=this.getCompressedNode(e);return this.model.setCollapsible(n,t)}isCollapsed(e){let t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,n){let i=this.getCompressedNode(e);return this.model.setCollapsed(i,t,n)}expandTo(e){let t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){let t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}resort(e=null,t=!0){let n=this.getCompressedNode(e);this.model.resort(n,t)}getCompressedNode(e){if(e===null)return null;let t=this.nodes.get(e);if(!t)throw new sn(this.user,`Tree element not found: ${e}`);return t}},f6=o=>o[o.length-1],wR=class o{constructor(e,t){this.unwrapper=e;this.node=t}get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new o(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}};function b6(o,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(o(t))}},sorter:e.sorter&&{compare(t,n){return e.sorter.compare(t.elements[0],n.elements[0])}},filter:e.filter&&{filter(t,n){return e.filter.filter(o(t),n)}}}}var PE=class{rootRef=null;get onDidSpliceModel(){return j.map(this.model.onDidSpliceModel,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(n=>this.nodeMapper.map(n)),deletedNodes:t.map(n=>this.nodeMapper.map(n))}))}get onDidSpliceRenderedNodes(){return j.map(this.model.onDidSpliceRenderedNodes,({start:e,deleteCount:t,elements:n})=>({start:e,deleteCount:t,elements:n.map(i=>this.nodeMapper.map(i))}))}get onDidChangeCollapseState(){return j.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return j.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}elementMapper;nodeMapper;model;constructor(e,t={}){this.elementMapper=t.elementMapper||f6;let n=i=>this.elementMapper(i.elements);this.nodeMapper=new Nu(i=>new wR(n,i)),this.model=new TR(e,b6(n,t))}setChildren(e,t=Je.empty(),n={}){this.model.setChildren(e,t,n)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){let t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}getLastElementAncestor(e){let t=this.model.getLastElementAncestor(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,n){return this.model.setCollapsed(e,t,n)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}resort(e=null,t=!0){return this.model.resort(e,t)}getCompressedTreeNode(e=null){return this.model.getNode(e)}};var Pu=class extends cm{constructor(t,n,i,r,s={}){super(t,n,i,r,s);this.user=t}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(t,n=Je.empty(),i){this.model.setChildren(t,n,i)}rerender(t){if(t===void 0){this.view.rerender();return}this.model.rerender(t)}updateElementHeight(t,n){let i=this.model.getListIndex(t);if(i===-1)throw new sn(this.user,"updateElementHeight failed - index not found");this.view.updateElementHeight(i,n)}resort(t,n=!0){this.model.resort(t,n)}hasElement(t){return this.model.has(t)}createModel(t,n){return new rc(t,n)}},FE=class{constructor(e,t,n){this._compressedTreeNodeProvider=e;this.stickyScrollDelegate=t;this.renderer=n;this.templateId=n.templateId,n.onDidChangeTwistieState&&(this.onDidChangeTwistieState=n.onDidChangeTwistieState)}templateId;onDidChangeTwistieState;get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){let r=this.stickyScrollDelegate.getCompressedNode(e);r||(r=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),r.element.elements.length===1?(n.compressedTreeNode=void 0,this.renderer.renderElement(e,t,n.data,i)):(n.compressedTreeNode=r,this.renderer.renderCompressedElements(r,t,n.data,i))}disposeElement(e,t,n,i){n.compressedTreeNode?this.renderer.disposeCompressedElements?.(n.compressedTreeNode,t,n.data,i):this.renderer.disposeElement?.(e,t,n.data,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}};P([me],FE.prototype,"compressedTreeNodeProvider",1);var xR=class{constructor(e){this.modelProvider=e}compressedStickyNodes=new Map;getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,n){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let i=0;i<e.length;i++){let r=e[i],s=r.position+r.height;if(i+1<e.length&&s+e[i+1].height>n||i>=t-1&&t<e.length){let l=e.slice(0,i),d=e.slice(i),c=this.compressStickyNodes(d);return[...l,c]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");let t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];let n=[];for(let d=0;d<e.length;d++){let c=e[d],u=t.getCompressedTreeNode(c.node.element);if(u.element){if(d!==0&&u.element.incompressible)break;n.push(...u.element.elements)}}if(n.length<2)return e[0];let i=e[e.length-1],r={elements:n,incompressible:!1},s={...i.node,children:[],element:r},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:i.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,s),l}};function v6(o,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let n;try{n=o().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return n.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(n.element.elements)}}}}var um=class extends Pu{constructor(e,t,n,i,r={}){let s=()=>this,a=new xR(()=>this.model),l=i.map(d=>new FE(s,a,d));super(e,t,n,l,{...v6(s,r),stickyScrollDelegate:a})}setChildren(e,t=Je.empty(),n){this.model.setChildren(e,t,n)}createModel(e,t){return new PE(e,t)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}};function _R(o){return{...o,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function DR(o,e){return e.parent?e.parent===o?!0:DR(o,e.parent):!1}function y6(o,e){return o===e||DR(o,e)||DR(e,o)}var kR=class o{constructor(e){this.node=e}get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new o(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},RR=class{constructor(e,t,n){this.renderer=e;this.nodeMapper=t;this.onDidChangeTwistieState=n;this.templateId=e.templateId}templateId;renderedNodes=new Map;renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){this.renderer.renderElement(this.nodeMapper.map(e),t,n.templateData,i)}renderTwistie(e,t){return e.slow?(t.classList.add(...Be.asClassNameArray(ae.treeItemLoading)),!0):(t.classList.remove(...Be.asClassNameArray(ae.treeItemLoading)),!1)}disposeElement(e,t,n,i){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,n.templateData,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}};function aH(o){return{browserEvent:o.browserEvent,elements:o.elements.map(e=>e.element)}}function BE(o){return{browserEvent:o.browserEvent,element:o.element&&o.element.element,target:o.target}}function I6(o){return{browserEvent:o.browserEvent,element:o.element&&o.element.element,anchor:o.anchor,isStickyScroll:o.isStickyScroll}}var MR=class extends Bl{constructor(t){super(t.elements.map(n=>n.element));this.data=t}set context(t){this.data.context=t}get context(){return this.data.context}};function LR(o){return o instanceof Bl?new MR(o):o}var OR=class{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(n=>n.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(LR(e),t)}onDragOver(e,t,n,i,r,s=!0){return this.dnd.onDragOver(LR(e),t&&t.element,n,i,r)}drop(e,t,n,i,r){this.dnd.drop(LR(e),t&&t.element,n,i,r)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.dnd.dispose()}};function lH(o){return o&&{...o,collapseByDefault:!0,identityProvider:o.identityProvider&&{getId(e){return o.identityProvider.getId(e.element)}},dnd:o.dnd&&new OR(o.dnd),multipleSelectionController:o.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return o.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return o.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:o.accessibilityProvider&&{...o.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:o.accessibilityProvider.getRole?e=>o.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:o.accessibilityProvider.isChecked?e=>!!o.accessibilityProvider?.isChecked(e.element):void 0,getAriaLabel(e){return o.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return o.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:o.accessibilityProvider.getWidgetRole?()=>o.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:o.accessibilityProvider.getAriaLevel&&(e=>o.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:o.accessibilityProvider.getActiveDescendantId&&(e=>o.accessibilityProvider.getActiveDescendantId(e.element))},filter:o.filter&&{filter(e,t){return o.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:o.keyboardNavigationLabelProvider&&{...o.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return o.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof o.expandOnlyOnTwistieClick>"u"?void 0:typeof o.expandOnlyOnTwistieClick!="function"?o.expandOnlyOnTwistieClick:e=>o.expandOnlyOnTwistieClick(e.element),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof o.defaultFindVisibility=="number"?o.defaultFindVisibility:typeof o.defaultFindVisibility>"u"?2:o.defaultFindVisibility(e.element)}}function NR(o,e){e(o),o.children.forEach(t=>NR(t,e))}var Wb=class{constructor(e,t,n,i,r,s={}){this.user=e;this.dataSource=r;this.identityProvider=s.identityProvider,this.autoExpandSingleChildren=typeof s.autoExpandSingleChildren>"u"?!1:s.autoExpandSingleChildren,this.sorter=s.sorter,this.getDefaultCollapseState=a=>s.collapseByDefault?s.collapseByDefault(a)?3:2:void 0,this.tree=this.createTree(e,t,n,i,s),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=_R({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}tree;root;nodes=new Map;sorter;getDefaultCollapseState;subTreeRefreshPromises=new Map;refreshPromises=new Map;identityProvider;autoExpandSingleChildren;_onDidRender=new k;_onDidChangeNodeSlowState=new k;nodeMapper=new Nu(e=>new kR(e));disposables=new ne;get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return j.map(this.tree.onDidChangeFocus,aH)}get onDidChangeSelection(){return j.map(this.tree.onDidChangeSelection,aH)}get onKeyDown(){return this.tree.onKeyDown}get onMouseClick(){return j.map(this.tree.onMouseClick,BE)}get onMouseDblClick(){return j.map(this.tree.onMouseDblClick,BE)}get onContextMenu(){return j.map(this.tree.onContextMenu,I6)}get onTap(){return j.map(this.tree.onTap,BE)}get onPointer(){return j.map(this.tree.onPointer,BE)}get onDidFocus(){return this.tree.onDidFocus}get onDidBlur(){return this.tree.onDidBlur}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidUpdateOptions(){return this.tree.onDidUpdateOptions}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get findMode(){return this.tree.findMode}set findMode(e){this.tree.findMode=e}onDidChangeFindMode;get findMatchType(){return this.tree.findMatchType}set findMatchType(e){this.tree.findMatchType=e}onDidChangeFindMatchType;get expandOnlyOnTwistieClick(){if(typeof this.tree.expandOnlyOnTwistieClick=="boolean")return this.tree.expandOnlyOnTwistieClick;let e=this.tree.expandOnlyOnTwistieClick;return t=>e(this.nodes.get(t===this.root.element?null:t)||null)}get onDidDispose(){return this.tree.onDidDispose}createTree(e,t,n,i,r){let s=new dm(n),a=i.map(d=>new RR(d,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=lH(r)||{};return new Pu(e,t,s,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}get options(){return this.tree.options}getHTMLElement(){return this.tree.getHTMLElement()}get contentHeight(){return this.tree.contentHeight}get contentWidth(){return this.tree.contentWidth}get onDidChangeContentHeight(){return this.tree.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.tree.onDidChangeContentWidth}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollLeft(){return this.tree.scrollLeft}set scrollLeft(e){this.tree.scrollLeft=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}get lastVisibleElement(){return this.tree.lastVisibleElement.element}get ariaLabel(){return this.tree.ariaLabel}set ariaLabel(e){this.tree.ariaLabel=e}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.refreshPromises.forEach(i=>i.cancel()),this.refreshPromises.clear(),this.root.element=e;let n=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,n),n&&(this.tree.setFocus(n.focus),this.tree.setSelection(n.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}async updateChildren(e=this.root.element,t=!0,n=!1,i){await this._updateChildren(e,t,n,void 0,i)}async _updateChildren(e=this.root.element,t=!0,n=!1,i,r){if(typeof this.root.element>"u")throw new sn(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await j.toPromise(this._onDidRender.event));let s=this.getDataNode(e);if(await this.refreshAndRenderNode(s,t,i,r),n)try{this.tree.rerender(s)}catch{}}resort(e=this.root.element,t=!0){this.tree.resort(this.getDataNode(e),t)}hasNode(e){return e===this.root.element||this.nodes.has(e)}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}let t=this.getDataNode(e);this.tree.rerender(t)}updateElementHeight(e,t){let n=this.getDataNode(e);this.tree.updateElementHeight(n,t)}updateWidth(e){let t=this.getDataNode(e);this.tree.updateWidth(t)}getNode(e=this.root.element){let t=this.getDataNode(e),n=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(n)}collapse(e,t=!1){let n=this.getDataNode(e);return this.tree.collapse(n===this.root?null:n,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new sn(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await j.toPromise(this._onDidRender.event));let n=this.getDataNode(e);if(this.tree.hasElement(n)&&!this.tree.isCollapsible(n)||(n.refreshPromise&&(await this.root.refreshPromise,await j.toPromise(this._onDidRender.event)),n!==this.root&&!n.refreshPromise&&!this.tree.isCollapsed(n)))return!1;let i=this.tree.expand(n===this.root?null:n,t);return n.refreshPromise&&(await this.root.refreshPromise,await j.toPromise(this._onDidRender.event)),i}toggleCollapsed(e,t=!1){return this.tree.toggleCollapsed(this.getDataNode(e),t)}expandAll(){this.tree.expandAll()}async expandTo(e){if(!this.dataSource.getParent)throw new Error("Can't expand to element without getParent method");let t=[];for(;!this.hasNode(e);)e=this.dataSource.getParent(e),e!==this.root.element&&t.push(e);for(let n of Je.reverse(t))await this.expand(n);this.tree.expandTo(this.getDataNode(e))}collapseAll(){this.tree.collapseAll()}isCollapsible(e){return this.tree.isCollapsible(this.getDataNode(e))}isCollapsed(e){return this.tree.isCollapsed(this.getDataNode(e))}triggerTypeNavigation(){this.tree.triggerTypeNavigation()}openFind(){this.tree.openFind()}closeFind(){this.tree.closeFind()}refilter(){this.tree.refilter()}setAnchor(e){this.tree.setAnchor(typeof e>"u"?void 0:this.getDataNode(e))}getAnchor(){return this.tree.getAnchor()?.element}setSelection(e,t){let n=e.map(i=>this.getDataNode(i));this.tree.setSelection(n,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){let n=e.map(i=>this.getDataNode(i));this.tree.setFocus(n,t)}focusNext(e=1,t=!1,n){this.tree.focusNext(e,t,n)}focusPrevious(e=1,t=!1,n){this.tree.focusPrevious(e,t,n)}focusNextPage(e){return this.tree.focusNextPage(e)}focusPreviousPage(e){return this.tree.focusPreviousPage(e)}focusLast(e){this.tree.focusLast(e)}focusFirst(e){this.tree.focusFirst(e)}getFocus(){return this.tree.getFocus().map(t=>t.element)}getStickyScrollFocus(){return this.tree.getStickyScrollFocus().map(t=>t.element)}getFocusedPart(){return this.tree.getFocusedPart()}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getRelativeTop(e){return this.tree.getRelativeTop(this.getDataNode(e))}getParentElement(e){let t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){let t=this.getDataNode(e),n=this.tree.getFirstElementChild(t===this.root?null:t);return n&&n.element}getDataNode(e){let t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new sn(this.user,`Data tree node not found: ${e}`);return t}async refreshAndRenderNode(e,t,n,i){await this.refreshNode(e,t,n),!this.disposables.isDisposed&&this.render(e,n,i)}async refreshNode(e,t,n){let i;if(this.subTreeRefreshPromises.forEach((r,s)=>{!i&&y6(s,e)&&(i=r.then(()=>this.refreshNode(e,t,n)))}),i)return i;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,n);return}return this.doRefreshSubTree(e,t,n)}async doRefreshSubTree(e,t,n){let i;e.refreshPromise=new Promise(r=>i=r),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{let r=await this.doRefreshNode(e,t,n);e.stale=!1,await Ao.settled(r.map(s=>this.doRefreshSubTree(s,t,n)))}finally{i()}}async doRefreshNode(e,t,n){e.hasChildren=!!this.dataSource.hasChildren(e.element);let i;if(!e.hasChildren)i=Promise.resolve(Je.empty());else{let r=this.doGetChildren(e);if(pL(r))i=Promise.resolve(r);else{let s=wi(800);s.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),i=r.finally(()=>s.cancel())}}try{let r=await i;return this.setChildren(e,r,t,n)}catch(r){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),ny(r))return[];throw r}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;let n=this.dataSource.getChildren(e.element);return pL(n)?this.processChildren(n):(t=eu(async()=>this.processChildren(await n)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(je))}setChildren(e,t,n,i){let r=[...t];if(e.children.length===0&&r.length===0)return[];let s=new Map,a=new Map;for(let c of e.children)s.set(c.element,c),this.identityProvider&&a.set(c.id,{node:c,collapsed:this.tree.hasElement(c)&&this.tree.isCollapsed(c)});let l=[],d=r.map(c=>{let u=!!this.dataSource.hasChildren(c);if(!this.identityProvider){let g=_R({element:c,parent:e,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(c)});return u&&g.defaultCollapseState===2&&l.push(g),g}let p=this.identityProvider.getId(c).toString(),h=a.get(p);if(h){let g=h.node;return s.delete(g.element),this.nodes.delete(g.element),this.nodes.set(c,g),g.element=c,g.hasChildren=u,n?h.collapsed?(g.children.forEach(b=>NR(b,v=>this.nodes.delete(v.element))),g.children.splice(0,g.children.length),g.stale=!0):l.push(g):u&&!h.collapsed&&l.push(g),g}let f=_R({element:c,parent:e,id:p,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(c)});return i&&i.viewState.focus&&i.viewState.focus.indexOf(p)>-1&&i.focus.push(f),i&&i.viewState.selection&&i.viewState.selection.indexOf(p)>-1&&i.selection.push(f),(i&&i.viewState.expanded&&i.viewState.expanded.indexOf(p)>-1||u&&f.defaultCollapseState===2)&&l.push(f),f});for(let c of s.values())NR(c,u=>this.nodes.delete(u.element));for(let c of d)this.nodes.set(c.element,c);return e.children.splice(0,e.children.length,...d),e!==this.root&&this.autoExpandSingleChildren&&d.length===1&&l.length===0&&(d[0].forceExpanded=!0,l.push(d[0])),l}render(e,t,n){let i=e.children.map(s=>this.asTreeElement(s,t)),r=n&&{...n,diffIdentityProvider:n.diffIdentityProvider&&{getId(s){return n.diffIdentityProvider.getId(s.element)}}};this.tree.setChildren(e===this.root?null:e,i,r),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let n;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?n=!1:e.forceExpanded?(n=!1,e.forceExpanded=!1):n=e.defaultCollapseState,{element:e,children:e.hasChildren?Je.map(e.children,i=>this.asTreeElement(i,t)):[],collapsible:e.hasChildren,collapsed:n}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}getViewState(){if(!this.identityProvider)throw new sn(this.user,"Can't get tree view state without an identity provider");let e=a=>this.identityProvider.getId(a).toString(),t=this.getFocus().map(e),n=this.getSelection().map(e),i=[],r=this.tree.getNode(),s=[r];for(;s.length>0;){let a=s.pop();a!==r&&a.collapsible&&!a.collapsed&&i.push(e(a.element.element)),s.push(...a.children)}return{focus:t,selection:n,expanded:i,scrollTop:this.scrollTop}}dispose(){this.disposables.dispose(),this.tree.dispose()}},AR=class o{constructor(e){this.node=e}get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new o(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},PR=class{constructor(e,t,n,i){this.renderer=e;this.nodeMapper=t;this.compressibleNodeMapperProvider=n;this.onDidChangeTwistieState=i;this.templateId=e.templateId}templateId;renderedNodes=new Map;disposables=[];renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){this.renderer.renderElement(this.nodeMapper.map(e),t,n.templateData,i)}renderCompressedElements(e,t,n,i){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,n.templateData,i)}renderTwistie(e,t){return e.slow?(t.classList.add(...Be.asClassNameArray(ae.treeItemLoading)),!0):(t.classList.remove(...Be.asClassNameArray(ae.treeItemLoading)),!1)}disposeElement(e,t,n,i){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,n.templateData,i)}disposeCompressedElements(e,t,n,i){this.renderer.disposeCompressedElements?.(this.compressibleNodeMapperProvider().map(e),t,n.templateData,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=Tt(this.disposables)}};function C6(o){let e=o&&lH(o);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return o.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(n=>n.element))}}}}var WE=class extends Wb{constructor(t,n,i,r,s,a,l={}){super(t,n,i,s,a,l);this.compressionDelegate=r;this.filter=l.filter}compressibleNodeMapper=new Nu(t=>new AR(t));filter;createTree(t,n,i,r,s){let a=new dm(i),l=r.map(c=>new PR(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),d=C6(s)||{};return new um(t,n,a,l,d)}asTreeElement(t,n){return{incompressible:this.compressionDelegate.isIncompressible(t.element),...super.asTreeElement(t,n)}}updateOptions(t={}){this.tree.updateOptions(t)}getViewState(){if(!this.identityProvider)throw new sn(this.user,"Can't get tree view state without an identity provider");let t=l=>this.identityProvider.getId(l).toString(),n=this.getFocus().map(t),i=this.getSelection().map(t),r=[],s=this.tree.getCompressedTreeNode(),a=[s];for(;a.length>0;){let l=a.pop();if(l!==s&&l.collapsible&&!l.collapsed)for(let d of l.element.elements)r.push(t(d.element));a.push(...l.children)}return{focus:n,selection:i,expanded:r,scrollTop:this.scrollTop}}render(t,n,i){if(!this.identityProvider)return super.render(t,n);let r=f=>this.identityProvider.getId(f).toString(),s=f=>{let g=new Set;for(let b of f){let v=this.tree.getCompressedTreeNode(b===this.root?null:b);if(v.element)for(let I of v.element.elements)g.add(r(I.element))}return g},a=s(this.tree.getSelection()),l=s(this.tree.getFocus());super.render(t,n,i);let d=this.getSelection(),c=!1,u=this.getFocus(),p=!1,h=f=>{let g=f.element;if(g)for(let b=0;b<g.elements.length;b++){let v=r(g.elements[b].element),I=g.elements[g.elements.length-1].element;a.has(v)&&d.indexOf(I)===-1&&(d.push(I),c=!0),l.has(v)&&u.indexOf(I)===-1&&(u.push(I),p=!0)}f.children.forEach(h)};h(this.tree.getCompressedTreeNode(t===this.root?null:t)),c&&this.setSelection(d),p&&this.setFocus(u)}processChildren(t){return this.filter&&(t=Je.filter(t,n=>{let i=this.filter.filter(n,1),r=S6(i);if(r===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return r===1})),super.processChildren(t)}};function S6(o){return typeof o=="boolean"?o?1:0:Fb(o)?Au(o.visibility):Au(o)}var VE=class extends cm{constructor(t,n,i,r,s,a={}){super(t,n,i,r,a);this.user=t;this.dataSource=s;this.identityProvider=a.identityProvider}input;identityProvider;nodesByIdentity=new Map;getInput(){return this.input}setInput(t,n){if(n&&!this.identityProvider)throw new sn(this.user,"Can't restore tree view state without an identity provider");if(this.input=t,!t){this.nodesByIdentity.clear(),this.model.setChildren(null,Je.empty());return}if(!n){this._refresh(t);return}let i=[],r=[],s=l=>{let d=this.identityProvider.getId(l).toString();return!n.expanded[d]},a=l=>{let d=this.identityProvider.getId(l.element).toString();n.focus.has(d)&&i.push(l.element),n.selection.has(d)&&r.push(l.element)};this._refresh(t,s,a),this.setFocus(i),this.setSelection(r),n&&typeof n.scrollTop=="number"&&(this.scrollTop=n.scrollTop)}updateChildren(t=this.input){if(typeof this.input>"u")throw new sn(this.user,"Tree input not set");let n;this.identityProvider&&(n=i=>{let r=this.identityProvider.getId(i).toString(),s=this.nodesByIdentity.get(r);if(s)return s.collapsed}),this._refresh(t,n)}resort(t=this.input,n=!0){this.model.resort(t===this.input?null:t,n)}refresh(t){if(t===void 0){this.view.rerender();return}this.model.rerender(t)}_refresh(t,n,i){let r;if(this.identityProvider){let s=new Set,a=i;i=l=>{let d=this.identityProvider.getId(l.element).toString();s.add(d),this.nodesByIdentity.set(d,l),a?.(l)},r=l=>{let d=this.identityProvider.getId(l.element).toString();s.has(d)||this.nodesByIdentity.delete(d)}}this.model.setChildren(t===this.input?null:t,this.iterate(t,n).elements,{onDidCreateNode:i,onDidDeleteNode:r})}iterate(t,n){let i=[...this.dataSource.getChildren(t)];return{elements:Je.map(i,s=>{let{elements:a,size:l}=this.iterate(s,n),d=this.dataSource.hasChildren?this.dataSource.hasChildren(s):void 0,c=l===0?void 0:n&&n(s);return{element:s,children:a,collapsible:d,collapsed:c}}),size:i.length}}createModel(t,n){return new rc(t,n)}};var gtt=new $("isMac",Fe,m("isMac","Whether the operating system is macOS")),ftt=new $("isLinux",Wt,m("isLinux","Whether the operating system is Linux")),btt=new $("isWindows",pt,m("isWindows","Whether the operating system is Windows")),vtt=new $("isWeb",Zi,m("isWeb","Whether the platform is a web browser")),ytt=new $("isMacNative",Fe&&!Zi,m("isMacNative","Whether the operating system is macOS on a non-browser platform")),Itt=new $("isIOS",qr,m("isIOS","Whether the operating system is iOS")),Ctt=new $("isMobile",qv,m("isMobile","Whether the platform is a mobile web browser")),Stt=new $("isDevelopment",!1,!0),Ett=new $("productQualityType","",m("productQualityType","Quality type of VS Code")),FR="inputFocus",Ttt=new $(FR,!1,m("inputFocus","Whether keyboard focus is inside an input box"));var HE=Q("contextViewService"),Hl=Q("contextMenuService");var BR=class extends Oo{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new k);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(e,t){super(),this._element=dt(e,Ke(".monaco-dropdown")),this._label=dt(this._element,Ke(".dropdown-label"));let n=t.labelRenderer;n||(n=r=>(r.textContent=t.label||"",null));for(let r of[he.CLICK,he.MOUSE_DOWN,wt.Tap])this._register(q(this.element,r,s=>rt.stop(s,!0)));for(let r of[he.MOUSE_DOWN,wt.Tap])this._register(q(this._label,r,s=>{_S(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(q(this._label,he.KEY_UP,r=>{let s=new gt(r);(s.equals(3)||s.equals(10))&&(rt.stop(r,!0),this.visible?this.hide():this.show())}));let i=n(this._label);i&&this._register(i),this._register(Nn.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(e){this._label&&(!this.hover&&e!==""?this.hover=this._register(_o().setupManagedHover(An("mouse"),this._label,e)):this.hover&&this.hover.update(e))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(e,t){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},UE=class extends BR{constructor(t,n){super(t,n);this._options=n;this.actions=n.actions||[]}_menuOptions;_actions=[];set menuOptions(t){this._menuOptions=t}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(t){this._actions=t}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(t,n)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(t,n):void 0,getKeyBinding:t=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(t):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var $it={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:V.white.toString(),buttonForeground:V.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0};var pm=class{modifierLabels;constructor(e,t,n=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=n}toLabel(e,t,n){if(t.length===0)return null;let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=n(a);if(l===null)return null;i[r]=T6(a,l,this.modifierLabels[e])}return i.join(" ")}},WR=new pm({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:m({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:m({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:m({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:m({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),Jit=new pm({ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:m({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),eot=new pm({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),tot=new pm({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function T6(o,e,t){if(e===null)return"";let n=[];return o.ctrlKey&&n.push(t.ctrlKey),o.shiftKey&&n.push(t.shiftKey),o.altKey&&n.push(t.altKey),o.metaKey&&n.push(t.metaKey),e!==""&&n.push(e),n.join(t.separator)}function w6(o,e){let t={...e};for(let n in o){let i=o[n];t[n]=i!==void 0?de(i):void 0}return t}var bst={keybindingLabelBackground:de(OB),keybindingLabelForeground:de(NB),keybindingLabelBorder:de(AB),keybindingLabelBottomBorder:de(PB),keybindingLabelShadow:de(ph)};var vst={buttonForeground:de(W0),buttonSeparator:de(yB),buttonBackground:de(hh),buttonHoverBackground:de(IB),buttonSecondaryForeground:de(SB),buttonSecondaryBackground:de(fC),buttonSecondaryHoverBackground:de(EB),buttonBorder:de(CB)};var yst={progressBarBackground:de(FF)};var x6={inputActiveOptionBorder:de(P0),inputActiveOptionForeground:de(B0),inputActiveOptionBackground:de(F0)},Ist={activeForeground:de(mh),activeBackground:de(TB),activeBorder:de(wB),inactiveForeground:de(xB),inactiveBackground:de(_B),inactiveBorder:de(LB),inactiveHoverBackground:de(DB)};var Cst={checkboxBackground:de(kB),checkboxBorder:de(MB),checkboxForeground:de(RB)};var Sst={dialogBackground:de(_i),dialogForeground:de(wa),dialogShadow:de(ph),dialogBorder:de(Ee),errorIconForeground:de(tB),warningIconForeground:de(nB),infoIconForeground:de(iB),textLinkForeground:de(cC)};var _6={inputBackground:de(aB),inputForeground:de(lB),inputBorder:de(gh),inputValidationInfoBorder:de(uB),inputValidationInfoBackground:de(dB),inputValidationInfoForeground:de(cB),inputValidationWarningBorder:de(mB),inputValidationWarningBackground:de(pB),inputValidationWarningForeground:de(hB),inputValidationErrorBorder:de(bB),inputValidationErrorBackground:de(gB),inputValidationErrorForeground:de(fB)};var cH={listFilterWidgetBackground:de($B),listFilterWidgetOutline:de(YB),listFilterWidgetNoMatchesOutline:de(ZB),listFilterWidgetShadow:de(QB),inputBoxStyles:_6,toggleStyles:x6},Est={badgeBackground:de(sh),badgeForeground:de(PF),badgeBorder:de(Ee)};var Tst={breadcrumbsBackground:de(XF),breadcrumbsForeground:de(QF),breadcrumbsHoverForeground:de(O0),breadcrumbsFocusForeground:de(O0),breadcrumbsFocusAndSelectionForeground:de(JF)};var hm={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:de(FB),listFocusForeground:de(BB),listFocusOutline:de(WB),listActiveSelectionBackground:de(Vo),listActiveSelectionForeground:de(xa),listActiveSelectionIconForeground:de(vC),listFocusAndSelectionOutline:de(VB),listFocusAndSelectionBackground:de(Vo),listFocusAndSelectionForeground:de(xa),listInactiveSelectionBackground:de(HB),listInactiveSelectionIconForeground:de(zB),listInactiveSelectionForeground:de(UB),listInactiveFocusBackground:de(KB),listInactiveFocusOutline:de(GB),listHoverBackground:de(V0),listHoverForeground:de(H0),listDropOverBackground:de(jB),listDropBetweenBackground:de(qB),listSelectionOutline:de(Ot),listHoverOutline:de(Ot),treeIndentGuidesStroke:de(bh),treeInactiveIndentGuidesStroke:de(XB),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:de(Bd),tableColumnsBorder:de(JB),tableOddRowsBackgroundColor:de(e2)};function Vb(o){return w6(o,hm)}var uH={selectBackground:de(fh),selectListBackground:de(vB),selectForeground:de(zf),decoratorRightForeground:de(d2),selectBorder:de(Kf),focusBorder:de(to),listFocusBackground:de(p2),listInactiveSelectionIconForeground:de(u2),listFocusForeground:de(c2),listFocusOutline:MF(Ot,V.transparent.toString()),listHoverBackground:de(V0),listHoverForeground:de(H0),listHoverOutline:de(Ot),selectListBorder:de(M0),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var wst={shadowColor:de(ph),borderColor:de(t2),foregroundColor:de(n2),backgroundColor:de(i2),selectionForegroundColor:de(o2),selectionBackgroundColor:de(r2),selectionBorderColor:de(s2),separatorColor:de(a2),scrollbarShadow:de(Bd),scrollbarSliderBackground:de(uC),scrollbarSliderHoverBackground:de(pC),scrollbarSliderActiveBackground:de(hC)};var Ka=Q("listService");var Hb=new $("listScrollAtBoundary","none"),jat=Ct.or(Hb.isEqualTo("top"),Hb.isEqualTo("both")),qat=Ct.or(Hb.isEqualTo("bottom"),Hb.isEqualTo("both")),pH=new $("listFocus",!0),hH=new $("treestickyScrollFocused",!1),oT=new $("listSupportsMultiselect",!0),$at=Ct.and(pH,Ct.not(FR),hH.negate()),zR=new $("listHasSelectionOrFocus",!1),KR=new $("listDoubleSelection",!1),GR=new $("listMultiSelection",!1),rT=new $("listSelectionNavigation",!1),L6=new $("listSupportsFind",!0),D6=new $("treeElementCanCollapse",!1),k6=new $("treeElementHasParent",!1),R6=new $("treeElementCanExpand",!1),M6=new $("treeElementHasChild",!1),O6=new $("treeFindOpen",!1),mH="listTypeNavigationMode",gH="listAutomaticKeyboardNavigation";function sT(o,e){let t=o.createScoped(e.getHTMLElement());return pH.bindTo(t),t}function aT(o,e){let t=Hb.bindTo(o),n=()=>{let i=e.scrollTop===0,r=e.scrollHeight-e.renderHeight-e.scrollTop<1;i&&r?t.set("both"):i?t.set("top"):r?t.set("bottom"):t.set("none")};return n(),e.onDidScroll(n)}var Fu="workbench.list.multiSelectModifier",QE="workbench.list.openMode",Hr="workbench.list.horizontalScrolling",jR="workbench.list.defaultFindMode",qR="workbench.list.typeNavigationMode",XE="workbench.list.keyboardNavigation",qs="workbench.list.scrollByPage",$R="workbench.list.defaultFindMatchType",Ub="workbench.tree.indent",JE="workbench.tree.renderIndentGuides",$s="workbench.list.smoothScrolling",Ha="workbench.list.mouseWheelScrollSensitivity",Ua="workbench.list.fastScrollSensitivity",eT="workbench.tree.expandMode",tT="workbench.tree.enableStickyScroll",nT="workbench.tree.stickyScrollMaxItemCount";function za(o){return o.getValue(Fu)==="alt"}var VR=class extends F{constructor(t){super();this.configurationService=t;this.useAltAsMultipleSelectionModifier=za(t),this.registerListeners()}useAltAsMultipleSelectionModifier;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(Fu)&&(this.useAltAsMultipleSelectionModifier=za(this.configurationService))}))}isSelectionSingleChangeEvent(t){return this.useAltAsMultipleSelectionModifier?t.browserEvent.altKey:V1(t)}isSelectionRangeChangeEvent(t){return H1(t)}};function lT(o,e){let t=o.get(ut),n=o.get(Qn),i=new ne;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(s){return n.mightProducePrintableCharacter(s)}},smoothScrolling:!!t.getValue($s),mouseWheelScrollSensitivity:t.getValue(Ha),fastScrollSensitivity:t.getValue(Ua),multipleSelectionController:e.multipleSelectionController??i.add(new VR(t)),keyboardNavigationEventFilter:N6(n),scrollByPage:!!t.getValue(qs)},i]}var zE=class extends Jn{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,n,i,r,s,a,l,d){let c=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(Hr),[u,p]=d.invokeFunction(lT,r);super(e,t,n,i,{keyboardSupport:!1,...u,horizontalScrolling:c}),this.disposables.add(p),this.contextKeyService=sT(s,this),this.disposables.add(aT(this.contextKeyService,this)),this.listSupportsMultiSelect=oT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),rT.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=zR.bindTo(this.contextKeyService),this.listDoubleSelection=KR.bindTo(this.contextKeyService),this.listMultiSelection=GR.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=za(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let f=this.getSelection(),g=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(f.length>0||g.length>0),this.listMultiSelection.set(f.length>1),this.listDoubleSelection.set(f.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let f=this.getSelection(),g=this.getFocus();this.listHasSelectionOrFocus.set(f.length>0||g.length>0)})),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(Fu)&&(this._useAltAsMultipleSelectionModifier=za(l));let g={};if(f.affectsConfiguration(Hr)&&this.horizontalScrolling===void 0){let b=!!l.getValue(Hr);g={...g,horizontalScrolling:b}}if(f.affectsConfiguration(qs)){let b=!!l.getValue(qs);g={...g,scrollByPage:b}}if(f.affectsConfiguration($s)){let b=!!l.getValue($s);g={...g,smoothScrolling:b}}if(f.affectsConfiguration(Ha)){let b=l.getValue(Ha);g={...g,mouseWheelScrollSensitivity:b}}if(f.affectsConfiguration(Ua)){let b=l.getValue(Ua);g={...g,fastScrollSensitivity:b}}Object.keys(g).length>0&&this.updateOptions(g)})),this.navigator=new iT(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Vb(e):hm)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}};zE=P([_(5,St),_(6,Ka),_(7,ut),_(8,Qe)],zE);var KE=class extends hE{contextKeyService;disposables;listSupportsMultiSelect;_useAltAsMultipleSelectionModifier;horizontalScrolling;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,n,i,r,s,a,l,d){let c=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(Hr),[u,p]=d.invokeFunction(lT,r);super(e,t,n,i,{keyboardSupport:!1,...u,horizontalScrolling:c}),this.disposables=new ne,this.disposables.add(p),this.contextKeyService=sT(s,this),this.disposables.add(aT(this.contextKeyService,this.widget)),this.horizontalScrolling=r.horizontalScrolling,this.listSupportsMultiSelect=oT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),rT.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this._useAltAsMultipleSelectionModifier=za(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(Fu)&&(this._useAltAsMultipleSelectionModifier=za(l));let g={};if(f.affectsConfiguration(Hr)&&this.horizontalScrolling===void 0){let b=!!l.getValue(Hr);g={...g,horizontalScrolling:b}}if(f.affectsConfiguration(qs)){let b=!!l.getValue(qs);g={...g,scrollByPage:b}}if(f.affectsConfiguration($s)){let b=!!l.getValue($s);g={...g,smoothScrolling:b}}if(f.affectsConfiguration(Ha)){let b=l.getValue(Ha);g={...g,mouseWheelScrollSensitivity:b}}if(f.affectsConfiguration(Ua)){let b=l.getValue(Ua);g={...g,fastScrollSensitivity:b}}Object.keys(g).length>0&&this.updateOptions(g)})),this.navigator=new iT(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Vb(e):hm)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};KE=P([_(5,St),_(6,Ka),_(7,ut),_(8,Qe)],KE);var GE=class extends fE{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,n,i,r,s,a,l,d,c){let u=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!d.getValue(Hr),[p,h]=c.invokeFunction(lT,s);super(e,t,n,i,r,{keyboardSupport:!1,...p,horizontalScrolling:u}),this.disposables.add(h),this.contextKeyService=sT(a,this),this.disposables.add(aT(this.contextKeyService,this)),this.listSupportsMultiSelect=oT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),rT.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this.listHasSelectionOrFocus=zR.bindTo(this.contextKeyService),this.listDoubleSelection=KR.bindTo(this.contextKeyService),this.listMultiSelection=GR.bindTo(this.contextKeyService),this.horizontalScrolling=s.horizontalScrolling,this._useAltAsMultipleSelectionModifier=za(d),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(s.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let g=this.getSelection(),b=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(g.length>0||b.length>0),this.listMultiSelection.set(g.length>1),this.listDoubleSelection.set(g.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let g=this.getSelection(),b=this.getFocus();this.listHasSelectionOrFocus.set(g.length>0||b.length>0)})),this.disposables.add(d.onDidChangeConfiguration(g=>{g.affectsConfiguration(Fu)&&(this._useAltAsMultipleSelectionModifier=za(d));let b={};if(g.affectsConfiguration(Hr)&&this.horizontalScrolling===void 0){let v=!!d.getValue(Hr);b={...b,horizontalScrolling:v}}if(g.affectsConfiguration(qs)){let v=!!d.getValue(qs);b={...b,scrollByPage:v}}if(g.affectsConfiguration($s)){let v=!!d.getValue($s);b={...b,smoothScrolling:v}}if(g.affectsConfiguration(Ha)){let v=d.getValue(Ha);b={...b,mouseWheelScrollSensitivity:v}}if(g.affectsConfiguration(Ua)){let v=d.getValue(Ua);b={...b,fastScrollSensitivity:v}}Object.keys(b).length>0&&this.updateOptions(b)})),this.navigator=new HR(this,{configurationService:d,...s}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Vb(e):hm)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};GE=P([_(6,St),_(7,Ka),_(8,ut),_(9,Qe)],GE);var zb=class extends F{constructor(t,n){super();this.widget=t;this._register(j.filter(this.widget.onDidChangeSelection,i=>ss(i.browserEvent))(i=>this.onSelectionFromKeyboard(i))),this._register(this.widget.onPointer(i=>this.onPointer(i.element,i.browserEvent))),this._register(this.widget.onMouseDblClick(i=>this.onMouseDblClick(i.element,i.browserEvent))),typeof n?.openOnSingleClick!="boolean"&&n?.configurationService?(this.openOnSingleClick=n?.configurationService.getValue(QE)!=="doubleClick",this._register(n?.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(QE)&&(this.openOnSingleClick=n?.configurationService.getValue(QE)!=="doubleClick")}))):this.openOnSingleClick=n?.openOnSingleClick??!0}openOnSingleClick;_onDidOpen=this._register(new k);onDidOpen=this._onDidOpen.event;onSelectionFromKeyboard(t){if(t.elements.length!==1)return;let n=t.browserEvent,i=typeof n.preserveFocus=="boolean"?n.preserveFocus:!0,r=typeof n.pinned=="boolean"?n.pinned:!i;this._open(this.getSelectedElement(),i,r,!1,t.browserEvent)}onPointer(t,n){if(!this.openOnSingleClick||n.detail===2)return;let r=n.button===1,s=!0,a=r,l=n.ctrlKey||n.metaKey||n.altKey;this._open(t,s,a,l,n)}onMouseDblClick(t,n){if(!n)return;let i=n.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&n.offsetX<16)return;let s=!1,a=!0,l=n.ctrlKey||n.metaKey||n.altKey;this._open(t,s,a,l,n)}_open(t,n,i,r,s){t&&this._onDidOpen.fire({editorOptions:{preserveFocus:n,pinned:i,revealIfVisible:!0},sideBySide:r,element:t,browserEvent:s})}},iT=class extends zb{widget;constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}},HR=class extends zb{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}},UR=class extends zb{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}};function N6(o){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;let n=o.softDispatch(t,t.target);return n.kind===1?(e=!0,!1):(e=!1,n.kind===0)}}var jE=class extends Pu{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d){let{options:c,getTypeNavigationMode:u,disposable:p}=s.invokeFunction(Kb,r);super(e,t,n,i,c),this.disposables.add(p),this.internals=new Ul(this,r,u,r.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};jE=P([_(5,Qe),_(6,St),_(7,Ka),_(8,ut)],jE);var qE=class extends um{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d){let{options:c,getTypeNavigationMode:u,disposable:p}=s.invokeFunction(Kb,r);super(e,t,n,i,c),this.disposables.add(p),this.internals=new Ul(this,r,u,r.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};qE=P([_(5,Qe),_(6,St),_(7,Ka),_(8,ut)],qE);var $E=class extends VE{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d,c){let{options:u,getTypeNavigationMode:p,disposable:h}=a.invokeFunction(Kb,s);super(e,t,n,i,r,u),this.disposables.add(h),this.internals=new Ul(this,s,p,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};$E=P([_(6,Qe),_(7,St),_(8,Ka),_(9,ut)],$E);var YE=class extends Wb{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d,c){let{options:u,getTypeNavigationMode:p,disposable:h}=a.invokeFunction(Kb,s);super(e,t,n,i,r,u),this.disposables.add(h),this.internals=new Ul(this,s,p,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};YE=P([_(6,Qe),_(7,St),_(8,Ka),_(9,ut)],YE);var ZE=class extends WE{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,n,i,r,s,a,l,d,c,u){let{options:p,getTypeNavigationMode:h,disposable:f}=l.invokeFunction(Kb,a);super(e,t,n,i,r,s,p),this.disposables.add(f),this.internals=new Ul(this,a,h,a.overrideStyles,d,c,u),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};ZE=P([_(7,Qe),_(8,St),_(9,Ka),_(10,ut)],ZE);function fH(o){let e=o.getValue(jR);if(e==="highlight")return 0;if(e==="filter")return 1;let t=o.getValue(XE);if(t==="simple"||t==="highlight")return 0;if(t==="filter")return 1}function bH(o){let e=o.getValue($R);if(e==="fuzzy")return 0;if(e==="contiguous")return 1}function Kb(o,e){let t=o.get(ut),n=o.get(HE),i=o.get(St),r=o.get(Qe),s=()=>{let p=i.getContextKeyValue(mH);if(p==="automatic")return 0;if(p==="trigger")return 1;if(i.getContextKeyValue(gH)===!1)return 1;let f=t.getValue(qR);if(f==="automatic")return 0;if(f==="trigger")return 1},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(Hr),[l,d]=r.invokeFunction(lT,e),c=e.paddingBottom,u=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(JE);return{getTypeNavigationMode:s,disposable:d,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(Ub)=="number"?t.getValue(Ub):void 0,renderIndentGuides:u,smoothScrolling:!!t.getValue($s),defaultFindMode:fH(t),defaultFindMatchType:bH(t),horizontalScrolling:a,scrollByPage:!!t.getValue(qs),paddingBottom:c,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(eT)==="doubleClick",contextViewProvider:n,findWidgetStyles:cH,enableStickyScroll:!!t.getValue(tT),stickyScrollMaxItemCount:Number(t.getValue(nT))}}}var Ul=class{constructor(e,t,n,i,r,s,a){this.tree=e;this.contextKeyService=sT(r,e),this.disposables.push(aT(this.contextKeyService,e)),this.listSupportsMultiSelect=oT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),rT.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=L6.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=zR.bindTo(this.contextKeyService),this.hasDoubleSelection=KR.bindTo(this.contextKeyService),this.hasMultiSelection=GR.bindTo(this.contextKeyService),this.treeElementCanCollapse=D6.bindTo(this.contextKeyService),this.treeElementHasParent=k6.bindTo(this.contextKeyService),this.treeElementCanExpand=R6.bindTo(this.contextKeyService),this.treeElementHasChild=M6.bindTo(this.contextKeyService),this.treeFindOpen=O6.bindTo(this.contextKeyService),this.treeStickyScrollFocused=hH.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=za(a),this.updateStyleOverrides(i);let d=()=>{let u=e.getFocus()[0];if(!u)return;let p=e.getNode(u);this.treeElementCanCollapse.set(p.collapsible&&!p.collapsed),this.treeElementHasParent.set(!!e.getParentElement(u)),this.treeElementCanExpand.set(p.collapsible&&p.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(u))},c=new Set;c.add(mH),c.add(gH),this.disposables.push(this.contextKeyService,s.register(e),e.onDidChangeSelection(()=>{let u=e.getSelection(),p=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(u.length>0||p.length>0),this.hasMultiSelection.set(u.length>1),this.hasDoubleSelection.set(u.length===2)})}),e.onDidChangeFocus(()=>{let u=e.getSelection(),p=e.getFocus();this.hasSelectionOrFocus.set(u.length>0||p.length>0),d()}),e.onDidChangeCollapseState(d),e.onDidChangeModel(d),e.onDidChangeFindOpenState(u=>this.treeFindOpen.set(u)),e.onDidChangeStickyScrollFocused(u=>this.treeStickyScrollFocused.set(u)),a.onDidChangeConfiguration(u=>{let p={};if(u.affectsConfiguration(Fu)&&(this._useAltAsMultipleSelectionModifier=za(a)),u.affectsConfiguration(Ub)){let h=a.getValue(Ub);p={...p,indent:h}}if(u.affectsConfiguration(JE)&&t.renderIndentGuides===void 0){let h=a.getValue(JE);p={...p,renderIndentGuides:h}}if(u.affectsConfiguration($s)){let h=!!a.getValue($s);p={...p,smoothScrolling:h}}if(u.affectsConfiguration(jR)||u.affectsConfiguration(XE)){let h=fH(a);p={...p,defaultFindMode:h}}if(u.affectsConfiguration(qR)||u.affectsConfiguration(XE)){let h=n();p={...p,typeNavigationMode:h}}if(u.affectsConfiguration($R)){let h=bH(a);p={...p,defaultFindMatchType:h}}if(u.affectsConfiguration(Hr)&&t.horizontalScrolling===void 0){let h=!!a.getValue(Hr);p={...p,horizontalScrolling:h}}if(u.affectsConfiguration(qs)){let h=!!a.getValue(qs);p={...p,scrollByPage:h}}if(u.affectsConfiguration(eT)&&t.expandOnlyOnTwistieClick===void 0&&(p={...p,expandOnlyOnTwistieClick:a.getValue(eT)==="doubleClick"}),u.affectsConfiguration(tT)){let h=a.getValue(tT);p={...p,enableStickyScroll:h}}if(u.affectsConfiguration(nT)){let h=Math.max(1,a.getValue(nT));p={...p,stickyScrollMaxItemCount:h}}if(u.affectsConfiguration(Ha)){let h=a.getValue(Ha);p={...p,mouseWheelScrollSensitivity:h}}if(u.affectsConfiguration(Ua)){let h=a.getValue(Ua);p={...p,fastScrollSensitivity:h}}Object.keys(p).length>0&&e.updateOptions(p)}),this.contextKeyService.onDidChangeContext(u=>{u.affectsSome(c)&&e.updateOptions({typeNavigationMode:n()})})),this.navigator=new UR(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}contextKeyService;listSupportsMultiSelect;listSupportFindWidget;hasSelectionOrFocus;hasDoubleSelection;hasMultiSelection;treeElementCanCollapse;treeElementHasParent;treeElementCanExpand;treeElementHasChild;treeFindOpen;treeStickyScrollFocused;_useAltAsMultipleSelectionModifier;disposables=[];navigator;get onDidOpen(){return this.navigator.onDidOpen}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?Vb(e):hm)}dispose(){this.disposables=Tt(this.disposables)}};Ul=P([_(4,St),_(5,Ka),_(6,ut)],Ul);var A6=lt.as(Qr.Configuration);A6.registerConfiguration({id:"workbench",order:7,title:m("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[Fu]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[m("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),m("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:m({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[QE]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:m({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Hr]:{type:"boolean",default:!1,description:m("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[qs]:{type:"boolean",default:!1,description:m("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[Ub]:{type:"number",default:8,minimum:4,maximum:40,description:m("tree indent setting","Controls tree indentation in pixels.")},[JE]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:m("render tree indent guides","Controls whether the tree should render indent guides.")},[$s]:{type:"boolean",default:!1,description:m("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[Ha]:{type:"number",default:1,markdownDescription:m("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[Ua]:{type:"number",default:5,markdownDescription:m("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[jR]:{type:"string",enum:["highlight","filter"],enumDescriptions:[m("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),m("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:m("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[XE]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[m("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),m("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),m("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:m("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:m("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[$R]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[m("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),m("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:m("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[eT]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:m("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[tT]:{type:"boolean",default:!0,description:m("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[nT]:{type:"number",minimum:1,default:7,markdownDescription:m("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[qR]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:m("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});var YR=Q("openerService");var P6={Quickaccess:"workbench.contributions.quickaccess"},ZR=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,n)=>n.prefix.length-t.prefix.length),pe(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return Ro([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(n=>e.startsWith(n.prefix))||void 0||this.defaultProvider}clear(){let e=[...this.providers],t=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=e,this.defaultProvider=t}}};lt.add(P6.Quickaccess,new ZR);var vH=new Gn(()=>{let o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:o,collatorIsNumeric:o.resolvedOptions().numeric}}),Elt=new Gn(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),Tlt=new Gn(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));function F6(o,e,t=!1){let n=o||"",i=e||"",r=vH.value.collator.compare(n,i);return vH.value.collatorIsNumeric&&r===0&&n!==i?n<i?-1:1:r}function dT(o,e,t){let n=o.toLowerCase(),i=e.toLowerCase(),r=B6(o,e,t);if(r)return r;let s=n.endsWith(t),a=i.endsWith(t);if(s!==a)return s?-1:1;let l=F6(n,i);return l!==0?l:n.localeCompare(i)}function B6(o,e,t){let n=o.toLowerCase(),i=e.toLowerCase(),r=n.startsWith(t),s=i.startsWith(t);if(r!==s)return r?-1:1;if(r&&s){if(n.length<i.length)return-1;if(n.length>i.length)return 1}return 0}var uT=0,yH=[uT,[]];function IH(o,e,t,n){if(!o||!e)return yH;let i=o.length,r=e.length;if(i<r)return yH;let s=o.toLowerCase();return W6(e,t,r,o,s,i,n)}function W6(o,e,t,n,i,r,s){let a=[],l=[];for(let p=0;p<t;p++){let h=p*r,f=h-r,g=p>0,b=o[p],v=e[p];for(let I=0;I<r;I++){let T=I>0,S=h+I,C=S-1,w=f+I-1,x=T?a[C]:0,D=g&&T?a[w]:0,O=g&&T?l[w]:0,H;!D&&g?H=0:H=V6(b,v,n,i,I,O),H&&D+H>=x&&(s||g||i.startsWith(e,I))?(l[S]=O+1,a[S]=D+H):(l[S]=uT,a[S]=x)}}let d=[],c=t-1,u=r-1;for(;c>=0&&u>=0;){let p=c*r+u;l[p]===uT||(d.push(u),c--),u--}return[a[t*r-1],d.reverse()]}function V6(o,e,t,n,i,r){let s=0;if(!H6(e,n[i]))return s;if(s+=1,r>0&&(s+=r*5),o===t[i]&&(s+=1),i===0)s+=8;else{let a=U6(t.charCodeAt(i-1));a?s+=a:Mp(t.charCodeAt(i))&&r===0&&(s+=2)}return s}function H6(o,e){return o===e?!0:o==="/"||o==="\\"?e==="/"||e==="\\":!1}function U6(o){switch(o){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}var pT=Object.freeze({score:0}),cT=1<<18,QR=1<<17,XR=65536;function z6(o,e,t,n){let i=n.values?n.values:[n];return is({[n.normalized]:{values:i.map(s=>({value:s.normalized,expectContiguousMatch:s.expectContiguousMatch})),label:o,description:e,allowNonContiguousMatches:t}})}function hT(o,e,t,n,i){if(!o||!e.normalized)return pT;let r=n.getItemLabel(o);if(!r)return pT;let s=n.getItemDescription(o),a=z6(r,s,t,e),l=i[a];if(l)return l;let d=K6(r,s,n.getItemPath(o),e,t);return i[a]=d,d}function K6(o,e,t,n,i){let r=!t||!n.containsPathSeparator;return t&&(Wt?n.pathNormalized===t:Lr(n.pathNormalized,t))?{score:cT,labelMatch:[{start:0,end:o.length}],descriptionMatch:e?[{start:0,end:e.length}]:void 0}:n.values&&n.values.length>1?G6(o,e,t,n.values,r,i):xH(o,e,t,n,r,i)}function G6(o,e,t,n,i,r){let s=0,a=[],l=[];for(let d of n){let{score:c,labelMatch:u,descriptionMatch:p}=xH(o,e,t,d,i,r);if(c===uT)return pT;s+=c,u&&a.push(...u),p&&l.push(...p)}return{score:s,labelMatch:SH(a),descriptionMatch:SH(l)}}function xH(o,e,t,n,i,r){if(i||!e){let[s,a]=IH(o,n.normalized,n.normalizedLowercase,r&&!n.expectContiguousMatch);if(s){let l=Uc(n.normalized,o),d;if(l){d=QR;let c=Math.round(n.normalized.length/o.length*100);d+=c}else d=XR;return{score:d+s,labelMatch:l||CH(a)}}}if(e){let s=e;t&&(s=`${e}${si}`);let a=s.length,l=`${s}${o}`,[d,c]=IH(l,n.normalized,n.normalizedLowercase,r&&!n.expectContiguousMatch);if(d){let u=CH(c),p=[],h=[];return u.forEach(f=>{f.start<a&&f.end>a?(p.push({start:0,end:f.end-a}),h.push({start:f.start,end:a})):f.start>=a?p.push({start:f.start-a,end:f.end-a}):h.push(f)}),{score:d,labelMatch:p,descriptionMatch:h}}}return pT}function CH(o){let e=[];if(!o)return e;let t;for(let n of o)t&&t.end===n?t.end+=1:(t={start:n,end:n+1},e.push(t));return e}function SH(o){let e=o.sort((i,r)=>i.start-r.start),t=[],n;for(let i of e)!n||!j6(n,i)?(n=i,t.push(i)):(n.start=Math.min(n.start,i.start),n.end=Math.max(n.end,i.end));return t}function j6(o,e){return!(o.end<e.start||e.end<o.start)}function _H(o,e,t,n,i,r){let s=hT(o,t,n,i,r),a=hT(e,t,n,i,r),l=s.score,d=a.score;if((l===cT||d===cT)&&l!==d)return l===cT?-1:1;if(l>XR||d>XR){if(l!==d)return l>d?-1:1;if(l<QR&&d<QR){let b=q6(s.labelMatch,a.labelMatch);if(b!==0)return b}let f=i.getItemLabel(o)||"",g=i.getItemLabel(e)||"";if(f.length!==g.length)return f.length-g.length}if(l!==d)return l>d?-1:1;let c=Array.isArray(s.labelMatch)&&s.labelMatch.length>0,u=Array.isArray(a.labelMatch)&&a.labelMatch.length>0;if(c&&!u)return-1;if(u&&!c)return 1;let p=EH(o,s,i),h=EH(e,a,i);return p&&h&&p!==h?h>p?-1:1:$6(o,e,t,i)}function EH(o,e,t){let n=-1,i=-1;if(e.descriptionMatch&&e.descriptionMatch.length?n=e.descriptionMatch[0].start:e.labelMatch&&e.labelMatch.length&&(n=e.labelMatch[0].start),e.labelMatch&&e.labelMatch.length){if(i=e.labelMatch[e.labelMatch.length-1].end,e.descriptionMatch&&e.descriptionMatch.length){let r=t.getItemDescription(o);r&&(i+=r.length)}}else e.descriptionMatch&&e.descriptionMatch.length&&(i=e.descriptionMatch[e.descriptionMatch.length-1].end);return i-n}function q6(o,e){if(!o&&!e||(!o||!o.length)&&(!e||!e.length))return 0;if(!e||!e.length)return-1;if(!o||!o.length)return 1;let t=o[0].start,i=o[o.length-1].end-t,r=e[0].start,a=e[e.length-1].end-r;return i===a?0:a<i?1:-1}function $6(o,e,t,n){let i=n.getItemLabel(o)||"",r=n.getItemLabel(e)||"",s=n.getItemDescription(o),a=n.getItemDescription(e),l=i.length+(s?s.length:0),d=r.length+(a?a.length:0);if(l!==d)return l-d;let c=n.getItemPath(o),u=n.getItemPath(e);return c&&u&&c.length!==u.length?c.length-u.length:i!==r?dT(i,r,t.normalized):s&&a&&s!==a?dT(s,a,t.normalized):c&&u&&c!==u?dT(c,u,t.normalized):0}function TH(o){return o.startsWith('"')&&o.endsWith('"')}var Y6=" ";function LH(o){typeof o!="string"&&(o="");let e=o.toLowerCase(),{pathNormalized:t,normalized:n,normalizedLowercase:i}=wH(o),r=t.indexOf(si)>=0,s=TH(o),a,l=o.split(Y6);if(l.length>1)for(let d of l){let c=TH(d),{pathNormalized:u,normalized:p,normalizedLowercase:h}=wH(d);p&&(a||(a=[]),a.push({original:d,originalLowercase:d.toLowerCase(),pathNormalized:u,normalized:p,normalizedLowercase:h,expectContiguousMatch:c}))}return{original:o,originalLowercase:e,pathNormalized:t,normalized:n,normalizedLowercase:i,values:a,containsPathSeparator:r,expectContiguousMatch:s}}function wH(o){let e;pt?e=o.replace(/\//g,si):e=o.replace(/\\/g,si);let t=kA(e).replace(/\s|"/g,"");return{pathNormalized:e,normalized:t,normalizedLowercase:t.toLowerCase()}}var JR=class{constructor(e){this.options=e}getItemLabel(e){return e.label}getItemDescription(e){if(!this.options?.skipDescription)return e.description}getItemPath(e){if(!this.options?.skipPath)return e.resource?.scheme===xe.file?e.resource.fsPath:e.resource?.path}},eM=new JR,Gb=Q("quickInputService");function tM(o){let e=o;return Array.isArray(e.items)}function DH(o){let e=o;return!!e.picks&&e.additionalPicks instanceof Promise}var mT=class extends F{constructor(t,n){super();this.prefix=t;this.options=n}provide(t,n,i){let r=new ne;t.canAcceptInBackground=!!this.options?.canAcceptInBackground,t.matchOnLabel=t.matchOnDescription=t.matchOnDetail=t.sortByLabel=!1;let s,a=r.add(new on),l=async()=>{let c=a.value=new ne;s?.dispose(!0),t.busy=!1,s=new Rn(n);let u=s.token,p=t.value.substring(this.prefix.length);this.options?.shouldSkipTrimPickFilter||(p=p.trim());let h=this._getPicks(p,c,u,i),f=(b,v)=>{let I,T;if(tM(b)?(I=b.items,T=b.active):I=b,I.length===0){if(v)return!1;(p.length>0||t.hideInput)&&this.options?.noResultsPick&&(Hc(this.options.noResultsPick)?I=[this.options.noResultsPick(p)]:I=[this.options.noResultsPick])}return t.items=I,T&&(t.activeItems=[T]),!0},g=async b=>{let v=!1,I=!1;await Promise.all([(async()=>{typeof b.mergeDelay=="number"&&(await wi(b.mergeDelay),u.isCancellationRequested)||I||(v=f(b.picks,!0))})(),(async()=>{t.busy=!0;try{let T=await b.additionalPicks;if(u.isCancellationRequested)return;let S,C;tM(b.picks)?(S=b.picks.items,C=b.picks.active):S=b.picks;let w,x;if(tM(T)?(w=T.items,x=T.active):w=T,w.length>0||!v){let D;if(!C&&!x){let O=t.activeItems[0];O&&S.indexOf(O)!==-1&&(D=O)}f({items:[...S,...w],active:C||x||D})}}finally{u.isCancellationRequested||(t.busy=!1),I=!0}})()])};if(h!==null)if(DH(h))await g(h);else if(!(h instanceof Promise))f(h);else{t.busy=!0;try{let b=await h;if(u.isCancellationRequested)return;DH(b)?await g(b):f(b)}finally{u.isCancellationRequested||(t.busy=!1)}}};r.add(t.onDidChangeValue(()=>l())),l(),r.add(t.onDidAccept(c=>{if(i?.handleAccept){c.inBackground||t.hide(),i.handleAccept?.(t.activeItems[0]);return}let[u]=t.selectedItems;typeof u?.accept=="function"&&(c.inBackground||t.hide(),u.accept(t.keyMods,c))}));let d=async(c,u)=>{if(typeof u.trigger!="function")return;let p=u.buttons?.indexOf(c)??-1;if(p>=0){let h=u.trigger(p,t.keyMods),f=typeof h=="number"?h:await h;if(n.isCancellationRequested)return;switch(f){case 0:break;case 1:t.hide();break;case 2:l();break;case 3:{let g=t.items.indexOf(u);if(g!==-1){let b=t.items.slice(),v=b.splice(g,1),I=t.activeItems.filter(S=>S!==v[0]),T=t.keepScrollPosition;t.keepScrollPosition=!0,t.items=b,I&&(t.activeItems=I),t.keepScrollPosition=T}break}}}};return r.add(t.onDidTriggerItemButton(({button:c,item:u})=>d(c,u))),r.add(t.onDidTriggerSeparatorButton(({button:c,separator:u})=>d(c,u))),r}};var Z6=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function fT(o,e,t,n,i){if(Be.isThemeIcon(i))return[`codicon-${i.id}`,"predefined-file-icon"];if(te.isUri(i))return[];let r=n===2?["rootfolder-icon"]:n===1?["folder-icon"]:["file-icon"];if(t){let s;if(t.scheme===xe.data)s=Np.parseMetaData(t).get(Np.META_DATA_LABEL);else{let a=t.path.match(Z6);a?(s=gT(a[2].toLowerCase()),a[1]&&r.push(`${gT(a[1].toLowerCase())}-name-dir-icon`)):s=gT(t.authority.toLowerCase())}if(n===2)r.push(`${s}-root-name-folder-icon`);else if(n===1)r.push(`${s}-name-folder-icon`);else{if(s){if(r.push(`${s}-name-file-icon`),r.push("name-file-icon"),s.length<=255){let l=s.split(".");for(let d=1;d<l.length;d++)r.push(`${l.slice(d).join(".")}-ext-file-icon`)}r.push("ext-file-icon")}let a=Q6(o,e,t);a&&r.push(`${gT(a)}-lang-file-icon`)}}return r}function Q6(o,e,t){if(!t)return null;let n=null;if(t.scheme===xe.data){let r=Np.parseMetaData(t).get(Np.META_DATA_MIME);r&&(n=e.getLanguageIdByMimeType(r))}else{let i=o.getModel(t);i&&(n=i.getLanguageId())}return n&&n!==Ds?n:e.guessLanguageIdByFilepathOrFirstLine(t)}function gT(o){return o.replace(/[\s]/g,"/")}var Bu=class extends mT{constructor(t,n,i,r,s){super(t,{canAcceptInBackground:!0,noResultsPick:{label:m("noViewResults","No matching editors"),groupId:-1}});this.editorGroupService=n;this.editorService=i;this.modelService=r;this.languageService=s}pickState=new class{scorerCache=Object.create(null);isQuickNavigating=void 0;reset(t){t||(this.scorerCache=Object.create(null)),this.isQuickNavigating=t}};provide(t,n){return this.pickState.reset(!!t.quickNavigate),super.provide(t,n)}_getPicks(t){let n=LH(t),i=this.doGetEditorPickItems().filter(s=>{if(!n.normalized)return!0;let a=hT(s,n,!0,eM,this.pickState.scorerCache);return a.score?(s.highlights={label:a.labelMatch,description:a.descriptionMatch},!0):!1});if(n.normalized){let s=this.editorGroupService.getGroups(2).map(a=>a.id);i.sort((a,l)=>a.groupId!==l.groupId?s.indexOf(a.groupId)-s.indexOf(l.groupId):_H(a,l,n,!0,eM,this.pickState.scorerCache))}let r=[];if(this.editorGroupService.count>1){let s;for(let a of i){if(typeof s!="number"||s!==a.groupId){let l=this.editorGroupService.getGroup(a.groupId);l&&r.push({type:"separator",label:l.label}),s=a.groupId}r.push(a)}}else r.push(...i);return r}doGetEditorPickItems(){let t=this.doGetEditors(),n=new Map;for(let{groupId:i}of t)if(!n.has(i)){let r=this.editorGroupService.getGroup(i);r&&n.set(i,r.ariaLabel)}return this.doGetEditors().map(({editor:i,groupId:r})=>{let s=Nr.getOriginalUri(i,{supportSideBySide:1}),a=i.isDirty()&&!i.isSaving(),l=i.getDescription(),d=l?`${i.getName()} ${l}`:i.getName();return{groupId:r,resource:s,label:i.getName(),ariaLabel:n.size>1?a?m("entryAriaLabelWithGroupDirty","{0}, unsaved changes, {1}",d,n.get(r)):m("entryAriaLabelWithGroup","{0}, {1}",d,n.get(r)):a?m("entryAriaLabelDirty","{0}, unsaved changes",d):d,description:l,iconClasses:fT(this.modelService,this.languageService,s,void 0,i.getIcon()).concat(i.getLabelExtraClasses()),italic:!this.editorGroupService.getGroup(r)?.isPinned(i),buttons:[{iconClass:a?"dirty-editor "+Be.asClassName(ae.closeDirty):Be.asClassName(ae.close),tooltip:m("closeEditor","Close Editor"),alwaysVisible:a}],trigger:async()=>{let c=this.editorGroupService.getGroup(r);return c&&(await c.closeEditor(i,{preserveFocus:!0}),!c.contains(i))?3:0},accept:(c,u)=>this.editorGroupService.getGroup(r)?.openEditor(i,{preserveFocus:u.inBackground})}})}};Bu=P([_(1,cr),_(2,Vt),_(3,ar),_(4,$n)],Bu);var Wu=class extends Bu{static PREFIX="edt active ";constructor(e,t,n,i){super(Wu.PREFIX,e,t,n,i)}doGetEditors(){let e=this.editorGroupService.activeGroup;return e.getEditors(0).map(t=>({editor:t,groupId:e.id}))}};Wu=P([_(0,cr),_(1,Vt),_(2,ar),_(3,$n)],Wu);var mm=class extends Bu{static PREFIX="edt ";constructor(e,t,n,i){super(mm.PREFIX,e,t,n,i)}doGetEditors(){let e=[];for(let t of this.editorGroupService.getGroups(2))for(let n of t.getEditors(1))e.push({editor:n,groupId:t.id});return e}};mm=P([_(0,cr),_(1,Vt),_(2,ar),_(3,$n)],mm);var gm=class extends Bu{static PREFIX="edt mru ";constructor(e,t,n,i){super(gm.PREFIX,e,t,n,i)}doGetEditors(){let e=[];for(let t of this.editorService.getEditors(0))e.push(t);return e}};gm=P([_(0,cr),_(1,Vt),_(2,ar),_(3,$n)],gm);var X6="__$__isNewStorageMarker",bT="__$__targetStorageMarker",uo=Q("storageService");function J6(o){let e=o.get(bT);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}var RH=class o extends F{constructor(t={flushInterval:o.DEFAULT_FLUSH_INTERVAL}){super();this.options=t}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new Ac);_onDidChangeTarget=this._register(new Ac);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new k);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new ln(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new on);onDidChangeValue(t,n,i){return j.filter(this._onDidChangeValue.event,r=>r.scope===t&&(n===void 0||r.key===n),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Dd(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){Tt([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{Zn("code/willInitStorage");try{await this.doInitialize()}finally{Zn("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(t,n){let{key:i,external:r}=n;if(i===bT){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:i,target:this.getKeyTargets(t)[i],external:r})}emitWillSaveState(t){this._onWillSaveState.fire({reason:t})}get(t,n,i){return this.getStorage(n)?.get(t,i)}getBoolean(t,n,i){return this.getStorage(n)?.getBoolean(t,i)}getNumber(t,n,i){return this.getStorage(n)?.getNumber(t,i)}getObject(t,n,i){return this.getStorage(n)?.getObject(t,i)}storeAll(t,n){this.withPausedEmitters(()=>{for(let i of t)this.store(i.key,i.value,i.scope,i.target,n)})}store(t,n,i,r,s=!1){if(zi(n)){this.remove(t,i,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(t,i,r),this.getStorage(i)?.set(t,n,s)})}remove(t,n,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(t,n,void 0),this.getStorage(n)?.delete(t,i)})}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(t,n){let i=[],r=this.getKeyTargets(t);for(let s of Object.keys(r))r[s]===n&&i.push(s);return i}updateKeyTarget(t,n,i,r=!1){let s=this.getKeyTargets(n);typeof i=="number"?s[t]!==i&&(s[t]=i,this.getStorage(n)?.set(bT,JSON.stringify(s),r)):typeof s[t]=="number"&&(delete s[t],this.getStorage(n)?.set(bT,JSON.stringify(s),r))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){let n=this.getStorage(t);return n?J6(n):Object.create(null)}isNew(t){return this.getBoolean(X6,t)===!0}async flush(t=0){this._onWillSaveState.fire({reason:t});let n=this.getStorage(-1),i=this.getStorage(0),r=this.getStorage(1);switch(t){case 0:await Ao.settled([n?.whenFlushed()??Promise.resolve(),i?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case 1:await Ao.settled([n?.flush(0)??Promise.resolve(),i?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){let t=this.getStorage(-1)?.items??new Map,n=this.getStorage(0)?.items??new Map,i=this.getStorage(1)?.items??new Map;return eK(t,n,i,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(t){return await this.flush(),this.getStorage(t)?.optimize()}async switch(t,n){return this.emitWillSaveState(0),vW(t)?this.switchToProfile(t,n):this.switchToWorkspace(t,n)}canSwitchProfile(t,n){return!(t.id===n.id||MH(n)&&MH(t))}switchData(t,n,i){this.withPausedEmitters(()=>{let r=new Set;for(let[s,a]of t)r.add(s),n.get(s)!==a&&this.emitDidChangeValue(i,{key:s,external:!0});for(let[s]of n.items)r.has(s)||this.emitDidChangeValue(i,{key:s,external:!0})})}};function MH(o){return o.isDefault||!!o.useDefaultFlags?.globalState}async function eK(o,e,t,n,i,r){let s=g=>{try{return JSON.parse(g)}catch{return g}},a=new Map,l=new Map;o.forEach((g,b)=>{a.set(b,g),l.set(b,s(g))});let d=new Map,c=new Map;e.forEach((g,b)=>{d.set(b,g),c.set(b,s(g))});let u=new Map,p=new Map;t.forEach((g,b)=>{u.set(b,g),p.set(b,s(g))}),console.group(n!==i?`Storage: Application (path: ${n})`:`Storage: Application & Profile (path: ${n}, default profile)`);let h=[];if(a.forEach((g,b)=>{h.push({key:b,value:g})}),console.table(h),console.groupEnd(),console.log(l),n!==i){console.group(`Storage: Profile (path: ${i}, profile specific)`);let g=[];d.forEach((b,v)=>{g.push({key:v,value:b})}),console.table(g),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${r})`);let f=[];u.forEach((g,b)=>{f.push({key:b,value:g})}),console.table(f),console.groupEnd(),console.log(p)}var vT=class o{constructor(e,t){this.storageService=t;this.id=o.COMMON_PREFIX+e}static applicationMementos=new Map;static profileMementos=new Map;static workspaceMementos=new Map;static COMMON_PREFIX="memento/";id;getMemento(e,t){switch(e){case 1:{let n=o.workspaceMementos.get(this.id);return n||(n=new jb(this.id,e,t,this.storageService),o.workspaceMementos.set(this.id,n)),n.getMemento()}case 0:{let n=o.profileMementos.get(this.id);return n||(n=new jb(this.id,e,t,this.storageService),o.profileMementos.set(this.id,n)),n.getMemento()}case-1:{let n=o.applicationMementos.get(this.id);return n||(n=new jb(this.id,e,t,this.storageService),o.applicationMementos.set(this.id,n)),n.getMemento()}}}onDidChangeValue(e,t){return this.storageService.onDidChangeValue(e,this.id,t)}saveMemento(){o.workspaceMementos.get(this.id)?.save(),o.profileMementos.get(this.id)?.save(),o.applicationMementos.get(this.id)?.save()}reloadMemento(e){let t;switch(e){case-1:t=o.applicationMementos.get(this.id);break;case 0:t=o.profileMementos.get(this.id);break;case 1:t=o.workspaceMementos.get(this.id);break}t?.reload()}static clear(e){switch(e){case 1:o.workspaceMementos.clear();break;case 0:o.profileMementos.clear();break;case-1:o.applicationMementos.clear();break}}},jb=class{constructor(e,t,n,i){this.id=e;this.scope=t;this.target=n;this.storageService=i;this.mementoObj=this.doLoad()}mementoObj;doLoad(){try{return this.storageService.getObject(this.id,this.scope,{})}catch(e){je(`[memento]: failed to parse contents: ${e} (id: ${this.id}, scope: ${this.scope}, contents: ${this.storageService.get(this.id,this.scope)})`)}return{}}getMemento(){return this.mementoObj}reload(){for(let e of Object.getOwnPropertyNames(this.mementoObj))delete this.mementoObj[e];Object.assign(this.mementoObj,this.doLoad())}save(){Vc(this.mementoObj)?this.storageService.remove(this.id,this.scope):this.storageService.store(this.id,this.mementoObj,this.scope,this.target)}};var qb=class extends lC{constructor(t,n,i){super(n);this.id=t;this.memento=new vT(this.id,i),this._register(i.onWillSaveState(()=>{this.saveState(),this.memento.saveMemento()}))}memento;getId(){return this.id}getMemento(t,n){return this.memento.getMemento(t,n)}reloadMemento(t){return this.memento.reloadMemento(t)}onDidChangeMementoValue(t,n){return this.memento.onDidChangeValue(t,n)}saveState(){}};var IT=class extends qb{constructor(t,n,i,r){super(t,i,r);this.telemetryService=n}_onTitleAreaUpdate=this._register(new k);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidFocus;get onDidFocus(){return this._onDidFocus||(this._onDidFocus=this.registerFocusTrackEvents().onDidFocus),this._onDidFocus.event}_onDidBlur;get onDidBlur(){return this._onDidBlur||(this._onDidBlur=this.registerFocusTrackEvents().onDidBlur),this._onDidBlur.event}_hasFocus=!1;hasFocus(){return this._hasFocus}registerFocusTrackEvents(){let t=pn(this.getContainer()),n=this._register(Ol(t)),i=this._onDidFocus=this._register(new k);this._register(n.onDidFocus(()=>{this._hasFocus=!0,i.fire()}));let r=this._onDidBlur=this._register(new k);return this._register(n.onDidBlur(()=>{this._hasFocus=!1,r.fire()})),{onDidFocus:i,onDidBlur:r}}actionRunner;visible=!1;parent;getTitle(){}create(t){this.parent=t}getContainer(){return this.parent}setVisible(t){this.visible!==!!t&&(this.visible=t)}focus(){}getMenuIds(){return[]}getActions(){return[]}getSecondaryActions(){return[]}getContextMenuActions(){return[]}getActionViewItem(t,n){}getActionsContext(){return null}getActionRunner(){return this.actionRunner||(this.actionRunner=this._register(new Oo)),this.actionRunner}updateTitleArea(){this._onTitleAreaUpdate.fire()}isVisible(){return this.visible}getControl(){}};var lpt={separatorBorder:V.transparent};var nK;(i=>{i.Distribute={type:"distribute"},i.Split={type:"split"},i.Auto={type:"auto"};function n(r){return{type:"invisible",cachedVisibleSize:r}}i.Invisible=n})(nK||={});async function NH(o){let e=navigator.usb;if(!e)return;let t=await e.requestDevice({filters:o?.filters??[]});if(t)return{deviceClass:t.deviceClass,deviceProtocol:t.deviceProtocol,deviceSubclass:t.deviceSubclass,deviceVersionMajor:t.deviceVersionMajor,deviceVersionMinor:t.deviceVersionMinor,deviceVersionSubminor:t.deviceVersionSubminor,manufacturerName:t.manufacturerName,productId:t.productId,productName:t.productName,serialNumber:t.serialNumber,usbVersionMajor:t.usbVersionMajor,usbVersionMinor:t.usbVersionMinor,usbVersionSubminor:t.usbVersionSubminor,vendorId:t.vendorId}}async function AH(o){let e=navigator.serial;if(!e)return;let t=await e.requestPort({filters:o?.filters??[]});if(!t)return;let n=t.getInfo();return{usbVendorId:n.usbVendorId,usbProductId:n.usbProductId}}async function PH(o){let e=navigator.hid;if(!e)return;let t=await e.requestDevice({filters:o?.filters??[]});if(!t.length)return;let n=t[0];return{opened:n.opened,vendorId:n.vendorId,productId:n.productId,productName:n.productName,collections:n.collections}}var zl=kr;var iK=60,oK=iK*60,nM=oK*24,Hpt=nM*7,Upt=nM*30,zpt=nM*365;function FH(o){return o.getFullYear()+"-"+String(o.getMonth()+1).padStart(2,"0")+"-"+String(o.getDate()).padStart(2,"0")+"T"+String(o.getHours()).padStart(2,"0")+":"+String(o.getMinutes()).padStart(2,"0")+":"+String(o.getSeconds()).padStart(2,"0")+"."+(o.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var $b=/^([^.]+\..+)[:=](.+)$/,jt=class{constructor(e,t,n){this._args=e;this.paths=t;this.productService=n}get appRoot(){return Xv(ha.asFileUri("").fsPath)}get userHome(){return te.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return te.file(Er(this.userDataPath,"User"))}get tmpDir(){return te.file(this.paths.tmpDir)}get cacheHome(){return te.file(this.userDataPath)}get stateResource(){return It(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:xe.vscodeUserData})}get userDataSyncHome(){return It(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let e=FH(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=Er(this.userDataPath,"logs",e)}return te.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return It(te.file(Er(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return It(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return It(this.appSettingsHome,"History")}get keyboardLayoutResource(){return It(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let e=gs.VSCODE_PORTABLE;return e?te.file(Er(e,"argv.json")):It(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return te.file(Er(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let e=this.args["builtin-extensions-dir"];return e?fp(e):ad(Er(ha.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let e=this.args["extensions-download-dir"];return e?te.file(fp(e)):te.file(Er(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let e=this.args["extensions-dir"];if(e)return fp(e);let t=gs.VSCODE_EXTENSIONS;if(t)return t;let n=gs.VSCODE_PORTABLE;return n?Er(n,"extensions"):It(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let e=this.args.extensionDevelopmentPath;if(Array.isArray(e))return e.map(t=>/^[^:/?#]+?:\/\//.test(t)?te.parse(t):te.file(ad(t)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(e=>e==="ui"||e==="workspace"||e==="web"?e:"workspace")}get extensionTestsLocationURI(){let e=this.args.extensionTestsPath;if(e)return/^[^:/?#]+?:\/\//.test(e)?te.parse(e):te.file(ad(e))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let e=this.args["disable-extension"];if(e){if(typeof e=="string")return[e];if(Array.isArray(e)&&e.length>0)return e}return!1}get debugExtensionHost(){return rK(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!gs.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(e=>!$b.test(e))}get extensionLogLevel(){let e=[];for(let t of this.args.log||[]){let n=$b.exec(t);n&&n[1]&&n[2]&&e.push([n[1],n[2]])}return e.length?e:void 0}get serviceMachineIdResource(){return It(te.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let e=gs.VSCODE_PORTABLE;return e?te.file(Er(e,"policy.json")):It(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(e){this.args.continueOn=e}get args(){return this._args}};P([me],jt.prototype,"appRoot",1),P([me],jt.prototype,"userHome",1),P([me],jt.prototype,"userDataPath",1),P([me],jt.prototype,"appSettingsHome",1),P([me],jt.prototype,"tmpDir",1),P([me],jt.prototype,"cacheHome",1),P([me],jt.prototype,"stateResource",1),P([me],jt.prototype,"userRoamingDataHome",1),P([me],jt.prototype,"userDataSyncHome",1),P([me],jt.prototype,"sync",1),P([me],jt.prototype,"machineSettingsResource",1),P([me],jt.prototype,"workspaceStorageHome",1),P([me],jt.prototype,"localHistoryHome",1),P([me],jt.prototype,"keyboardLayoutResource",1),P([me],jt.prototype,"argvResource",1),P([me],jt.prototype,"isExtensionDevelopment",1),P([me],jt.prototype,"untitledWorkspacesHome",1),P([me],jt.prototype,"builtinExtensionsPath",1),P([me],jt.prototype,"extensionsPath",1),P([me],jt.prototype,"extensionDevelopmentLocationURI",1),P([me],jt.prototype,"extensionDevelopmentKind",1),P([me],jt.prototype,"extensionTestsLocationURI",1),P([me],jt.prototype,"debugExtensionHost",1),P([me],jt.prototype,"logLevel",1),P([me],jt.prototype,"extensionLogLevel",1),P([me],jt.prototype,"serviceMachineIdResource",1),P([me],jt.prototype,"disableTelemetry",1),P([me],jt.prototype,"disableWorkspaceTrust",1),P([me],jt.prototype,"useInMemorySecretStorage",1),P([me],jt.prototype,"policyFile",1);function rK(o,e){return sK(o["inspect-extensions"],o["inspect-brk-extensions"],5870,e,o.debugId,o.extensionEnvironment)}function sK(o,e,t,n,i,r){let a=Number(e||o)||(n?null:t),l=a?!!e:!1,d;if(r)try{d=JSON.parse(r)}catch{}return{port:a,break:l,debugId:i,env:d}}var BH=kr,ht=class{constructor(e,t,n,i){this.workspaceId=e;this.logsHome=t;this.options=n;this.productService=i;if(n.workspaceProvider&&Array.isArray(n.workspaceProvider.payload))try{this.payload=new Map(n.workspaceProvider.payload)}catch(r){je(r)}}get remoteAuthority(){return this.options.remoteAuthority}get expectsResolverExtension(){return!!this.options.remoteAuthority?.includes("+")&&!this.options.webSocketFactory}get isBuilt(){return!!this.productService.commit}get logLevel(){let e=this.payload?.get("logLevel");return e?e.split(",").find(t=>!$b.test(t)):this.options.developmentOptions?.logLevel!==void 0?eS(this.options.developmentOptions?.logLevel):void 0}get extensionLogLevel(){let e=this.payload?.get("logLevel");if(e){let t=[];for(let n of e.split(",")){let i=$b.exec(n);i&&i[1]&&i[2]&&t.push([i[1],i[2]])}return t.length?t:void 0}return this.options.developmentOptions?.extensionLogLevel!==void 0?this.options.developmentOptions?.extensionLogLevel.map(([t,n])=>[t,eS(n)]):void 0}get profDurationMarkers(){let e=this.payload?.get("profDurationMarkers");if(e){let t=[];for(let n of e.split(","))t.push(n);return t.length===2?t:void 0}}get windowLogsPath(){return this.logsHome}get logFile(){return It(this.windowLogsPath,"window.log")}get userRoamingDataHome(){return te.file("/User").with({scheme:xe.vscodeUserData})}get argvResource(){return It(this.userRoamingDataHome,"argv.json")}get cacheHome(){return It(this.userRoamingDataHome,"caches")}get workspaceStorageHome(){return It(this.userRoamingDataHome,"workspaceStorage")}get localHistoryHome(){return It(this.userRoamingDataHome,"History")}get stateResource(){return It(this.userRoamingDataHome,"State","storage.json")}get userDataSyncHome(){return It(this.userRoamingDataHome,"sync",this.workspaceId)}get sync(){}get keyboardLayoutResource(){return It(this.userRoamingDataHome,"keyboardLayout.json")}get untitledWorkspacesHome(){return It(this.userRoamingDataHome,"Workspaces")}get serviceMachineIdResource(){return It(this.userRoamingDataHome,"machineid")}get extHostLogsPath(){return It(this.logsHome,"exthost")}get extHostTelemetryLogFile(){return It(this.extHostLogsPath,"extensionTelemetry.log")}extensionHostDebugEnvironment=void 0;get debugExtensionHost(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.params}get isExtensionDevelopment(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.isExtensionDevelopment}get extensionDevelopmentLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentLocationURI}get extensionDevelopmentLocationKind(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentKind}get extensionTestsLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionTestsLocationURI}get extensionEnabledProposedApi(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionEnabledProposedApi}get debugRenderer(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.debugRenderer}get enableSmokeTestDriver(){return this.options.developmentOptions?.enableSmokeTestDriver}get disableExtensions(){return this.payload?.get("disableExtensions")==="true"}get enableExtensions(){return this.options.enabledExtensions}get webviewExternalEndpoint(){let e=this.options.webviewEndpoint||this.productService.webviewContentExternalBaseUrlTemplate||"https://{{uuid}}.vscode-cdn.net/{{quality}}/{{commit}}/out/vs/workbench/contrib/webview/browser/pre/",t=this.payload?.get("webviewExternalEndpointCommit");return e.replace("{{commit}}",t??this.productService.commit??"ef65ac1ba57f57f2a3961bfe94aa20481caca4c6").replace("{{quality}}",(t?"insider":this.productService.quality)??"insider")}get extensionTelemetryLogResource(){return It(this.logsHome,"extensionTelemetry.log")}get disableTelemetry(){return!1}get verbose(){return this.payload?.get("verbose")==="true"}get logExtensionHostCommunication(){return this.payload?.get("logExtensionHostCommunication")==="true"}get skipReleaseNotes(){return this.payload?.get("skipReleaseNotes")==="true"}get skipWelcome(){return this.payload?.get("skipWelcome")==="true"}get disableWorkspaceTrust(){return!this.options.enableWorkspaceTrust}get profile(){return this.payload?.get("profile")}editSessionId=this.options.editSessionId;payload;resolveExtensionHostDebugEnvironment(){let e={params:{port:null,break:!1},debugRenderer:!1,isExtensionDevelopment:!1,extensionDevelopmentLocationURI:void 0,extensionDevelopmentKind:void 0};if(this.payload)for(let[n,i]of this.payload)switch(n){case"extensionDevelopmentPath":e.extensionDevelopmentLocationURI||(e.extensionDevelopmentLocationURI=[]),e.extensionDevelopmentLocationURI.push(te.parse(i)),e.isExtensionDevelopment=!0;break;case"extensionDevelopmentKind":e.extensionDevelopmentKind=[i];break;case"extensionTestsPath":e.extensionTestsLocationURI=te.parse(i);break;case"debugRenderer":e.debugRenderer=i==="true";break;case"debugId":e.params.debugId=i;break;case"inspect-brk-extensions":e.params.port=parseInt(i),e.params.break=!0;break;case"inspect-extensions":e.params.port=parseInt(i);break;case"enableProposedApi":e.extensionEnabledProposedApi=[];break}let t=this.options.developmentOptions;return t&&!e.isExtensionDevelopment&&(t.extensions?.length&&(e.extensionDevelopmentLocationURI=t.extensions.map(n=>te.revive(n)),e.isExtensionDevelopment=!0),t.extensionTestsPath&&(e.extensionTestsLocationURI=te.revive(t.extensionTestsPath))),e}get filesToOpenOrCreate(){if(this.payload){let e=this.payload.get("openFile");if(e){let t=te.parse(e);if(this.payload.has("gotoLineMode")){let n=aP(t.path);return[{fileUri:t.with({path:n.path}),options:{selection:qn(n.line)?void 0:{startLineNumber:n.line,startColumn:n.column||1}}}]}return[{fileUri:t}]}}}get filesToDiff(){if(this.payload){let e=this.payload.get("diffFilePrimary"),t=this.payload.get("diffFileSecondary");if(e&&t)return[{fileUri:te.parse(t)},{fileUri:te.parse(e)}]}}get filesToMerge(){if(this.payload){let e=this.payload.get("mergeFile1"),t=this.payload.get("mergeFile2"),n=this.payload.get("mergeFileBase"),i=this.payload.get("mergeFileResult");if(e&&t&&n&&i)return[{fileUri:te.parse(e)},{fileUri:te.parse(t)},{fileUri:te.parse(n)},{fileUri:te.parse(i)}]}}};P([me],ht.prototype,"remoteAuthority",1),P([me],ht.prototype,"expectsResolverExtension",1),P([me],ht.prototype,"isBuilt",1),P([me],ht.prototype,"logLevel",1),P([me],ht.prototype,"windowLogsPath",1),P([me],ht.prototype,"logFile",1),P([me],ht.prototype,"userRoamingDataHome",1),P([me],ht.prototype,"argvResource",1),P([me],ht.prototype,"cacheHome",1),P([me],ht.prototype,"workspaceStorageHome",1),P([me],ht.prototype,"localHistoryHome",1),P([me],ht.prototype,"stateResource",1),P([me],ht.prototype,"userDataSyncHome",1),P([me],ht.prototype,"sync",1),P([me],ht.prototype,"keyboardLayoutResource",1),P([me],ht.prototype,"untitledWorkspacesHome",1),P([me],ht.prototype,"serviceMachineIdResource",1),P([me],ht.prototype,"extHostLogsPath",1),P([me],ht.prototype,"extHostTelemetryLogFile",1),P([me],ht.prototype,"debugExtensionHost",1),P([me],ht.prototype,"isExtensionDevelopment",1),P([me],ht.prototype,"extensionDevelopmentLocationURI",1),P([me],ht.prototype,"extensionDevelopmentLocationKind",1),P([me],ht.prototype,"extensionTestsLocationURI",1),P([me],ht.prototype,"extensionEnabledProposedApi",1),P([me],ht.prototype,"debugRenderer",1),P([me],ht.prototype,"enableSmokeTestDriver",1),P([me],ht.prototype,"disableExtensions",1),P([me],ht.prototype,"enableExtensions",1),P([me],ht.prototype,"webviewExternalEndpoint",1),P([me],ht.prototype,"extensionTelemetryLogResource",1),P([me],ht.prototype,"disableTelemetry",1),P([me],ht.prototype,"verbose",1),P([me],ht.prototype,"logExtensionHostCommunication",1),P([me],ht.prototype,"skipReleaseNotes",1),P([me],ht.prototype,"skipWelcome",1),P([me],ht.prototype,"disableWorkspaceTrust",1),P([me],ht.prototype,"profile",1),P([me],ht.prototype,"filesToOpenOrCreate",1),P([me],ht.prototype,"filesToDiff",1),P([me],ht.prototype,"filesToMerge",1);var WH=Q("layoutService");var ST=WH;function CT(o){switch(o){case 0:return"left";case 1:return"right";case 2:return"bottom";case 3:return"top";default:return"bottom"}}var Nmt={[CT(0)]:0,[CT(1)]:1,[CT(2)]:2,[CT(3)]:3};function iM(o){switch(o){case 0:return"always";case 1:return"never";case 2:return"preserve";default:return"preserve"}}var Amt={[iM(0)]:0,[iM(1)]:1,[iM(2)]:2};var sc=Q("lifecycleService");function VH(o){switch(o){case 1:return"Starting";case 2:return"Ready";case 3:return"Restored";case 4:return"Eventually"}}var Ga=class extends F{constructor(t,n){super();this.logService=t;this.storageService=n;this._startupKind=this.resolveStartupKind(),this._register(this.storageService.onWillSaveState(i=>{i.reason===1&&this.storageService.store(Ga.LAST_SHUTDOWN_REASON_KEY,this.shutdownReason,1,1)}))}static LAST_SHUTDOWN_REASON_KEY="lifecyle.lastShutdownReason";_onBeforeShutdown=this._register(new k);onBeforeShutdown=this._onBeforeShutdown.event;_onWillShutdown=this._register(new k);onWillShutdown=this._onWillShutdown.event;_onDidShutdown=this._register(new k);onDidShutdown=this._onDidShutdown.event;_onBeforeShutdownError=this._register(new k);onBeforeShutdownError=this._onBeforeShutdownError.event;_onShutdownVeto=this._register(new k);onShutdownVeto=this._onShutdownVeto.event;_startupKind;get startupKind(){return this._startupKind}_phase=1;get phase(){return this._phase}phaseWhen=new Map;shutdownReason;resolveStartupKind(){let t=this.doResolveStartupKind()??1;return this.logService.trace(`[lifecycle] starting up (startup kind: ${t})`),t}doResolveStartupKind(){let t=this.storageService.getNumber(Ga.LAST_SHUTDOWN_REASON_KEY,1);this.storageService.remove(Ga.LAST_SHUTDOWN_REASON_KEY,1);let n;switch(t){case 3:n=3;break;case 4:n=4;break}return n}set phase(t){if(t<this.phase)throw new Error("Lifecycle cannot go backwards");if(this._phase===t)return;this.logService.trace(`lifecycle: phase changed (value: ${t})`),this._phase=t,Zn(`code/LifecyclePhase/${VH(t)}`);let n=this.phaseWhen.get(this._phase);n&&(n.open(),this.phaseWhen.delete(this._phase))}async when(t){if(t<=this._phase)return;let n=this.phaseWhen.get(t);n||(n=new qp,this.phaseWhen.set(t,n)),await n.wait()}};Ga=P([_(0,gi),_(1,uo)],Ga);var Yb=class extends Ga{beforeUnloadListener=void 0;unloadListener=void 0;ignoreBeforeUnload=!1;didUnload=!1;constructor(e,t){super(e,t),this.registerListeners()}registerListeners(){this.beforeUnloadListener=q(Oe,he.BEFORE_UNLOAD,e=>this.onBeforeUnload(e)),this.unloadListener=q(Oe,he.PAGE_HIDE,()=>this.onUnload())}onBeforeUnload(e){this.ignoreBeforeUnload?(this.logService.info("[lifecycle] onBeforeUnload triggered but ignored once"),this.ignoreBeforeUnload=!1):(this.logService.info("[lifecycle] onBeforeUnload triggered and handled with veto support"),this.doShutdown(()=>this.vetoBeforeUnload(e)))}vetoBeforeUnload(e){e.preventDefault(),e.returnValue=m("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}withExpectedShutdown(e,t){if(typeof e=="number")return this.shutdownReason=e,this.storageService.flush(1);this.ignoreBeforeUnload=!0;try{t?.()}finally{this.ignoreBeforeUnload=!1}}async shutdown(){this.logService.info("[lifecycle] shutdown triggered"),this.beforeUnloadListener?.dispose(),this.unloadListener?.dispose(),await this.storageService.flush(1),this.doShutdown()}doShutdown(e){let t=this.logService;this.storageService.flush(1);let n=!1;function i(r,s){typeof e=="function"&&(r instanceof Promise&&(t.error(`[lifecycle] Long running operations before shutdown are unsupported in the web (id: ${s})`),n=!0),r===!0&&(t.info(`[lifecycle]: Unload was prevented (id: ${s})`),n=!0))}return this._onBeforeShutdown.fire({reason:2,veto(r,s){i(r,s)},finalVeto(r,s){i(r(),s)}}),n&&typeof e=="function"?e():this.onUnload()}onUnload(){if(this.didUnload)return;this.didUnload=!0,this._register(q(Oe,he.PAGE_SHOW,t=>this.onLoadAfterUnload(t)));let e=this.logService;this._onWillShutdown.fire({reason:2,joiners:()=>[],token:en.None,join(t,n){e.error(`[lifecycle] Long running operations during shutdown are unsupported in the web (id: ${n.id})`)},force:()=>{}}),this._onDidShutdown.fire()}onLoadAfterUnload(e){e.persisted&&this.withExpectedShutdown({disableShutdownHandling:!0},()=>Oe.location.reload())}doResolveStartupKind(){let e=super.doResolveStartupKind();return typeof e!="number"&&performance.getEntriesByType("navigation").at(0)?.type==="reload"&&(e=3),e}};Yb=P([_(0,gi),_(1,uo)],Yb);ji(sc,Yb,0);var fm=Q("hostService");var dK=m("open","open"),cK=m("close","close"),uK=m("find","find"),ET={open:dK,close:cK,find:uK};async function zH(o,e){let t=[];return await KH(o,t,e.logsHome,e.logsHome),t}async function KH(o,e,t,n){let i=await o.resolve(t);for(let{resource:r,isDirectory:s}of i.children||[])if(s)await KH(o,e,r,n);else{let a=(await o.readFile(r)).value.toString();if(a){let l=By(n,r);l&&e.push({relativePath:l,contents:a})}}}var GH=Q("editorPaneService");var TT;(e=>e.Workbench="workbench.contributions.kind")(TT||={});var Kl=(i=>(i[i.BlockStartup=1]="BlockStartup",i[i.BlockRestore=2]="BlockRestore",i[i.AfterRestored=3]="AfterRestored",i[i.Eventually=4]="Eventually",i))(Kl||{});function jH(o){let e=o;return!!e&&typeof e.editorTypeId=="string"}function pK(o){switch(o){case 3:return Kl.AfterRestored;case 4:return Kl.Eventually}}function qH(o){switch(o){case Kl.BlockStartup:return 1;case Kl.BlockRestore:return 2;case Kl.AfterRestored:return 3;case Kl.Eventually:return 4}}var Vu=class o extends F{static INSTANCE=new o;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new ne);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new Ld;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(e,t,n){let i={id:e,ctor:t};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof n=="number"&&this.lifecycleService.phase>=n||typeof e=="string"&&jH(n)&&this.editorPaneService.didInstantiateEditorPane(n.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,i,typeof n=="number"?qH(n):this.lifecycleService.phase):(typeof n=="number"&&H_(this.contributionsByPhase,qH(n),[]).push(i),typeof e=="string"&&(this.contributionsById.has(e)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${e}'`):this.contributionsById.set(e,i),jH(n)&&H_(this.contributionsByEditor,n.editorTypeId,[]).push(i)))}registerWorkbenchContribution(e,t){this.registerWorkbenchContribution2(void 0,e,pK(t))}getWorkbenchContribution(e){if(this.instancesById.has(e))return this.instancesById.get(e);let t=this.instantiationService,n=this.lifecycleService,i=this.logService,r=this.environmentService;if(!t||!n||!i||!r)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): cannot be called before registry started`);let s=this.contributionsById.get(e);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution with that identifier is unknown.`);n.phase<3&&i.warn(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(t,i,r,s,n.phase);let a=this.instancesById.get(e);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): failed to create contribution.`);return a}start(e){let t=this.instantiationService=e.get(Qe),n=this.lifecycleService=e.get(sc),i=this.logService=e.get(gi),r=this.environmentService=e.get(kr),s=this.editorPaneService=e.get(GH);this._register(n.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(t,n,i,r,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,t,n,i,r);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,t,n,i,r)))}onEditor(e,t,n,i,r){let s=this.contributionsByEditor.get(e);if(s){this.contributionsByEditor.delete(e);for(let a of s)this.safeCreateContribution(t,i,r,a,n.phase)}}instantiateByPhase(e,t,n,i,r){t.phase>=r?this.doInstantiateByPhase(e,n,i,r):t.when(r).then(()=>this.doInstantiateByPhase(e,n,i,r))}async doInstantiateByPhase(e,t,n,i){let r=this.contributionsByPhase.get(i);if(r)switch(this.contributionsByPhase.delete(i),i){case 1:case 2:{Zn(`code/willCreateWorkbenchContributions/${i}`);for(let s of r)this.safeCreateContribution(e,t,n,s,i);Zn(`code/didCreateWorkbenchContributions/${i}`);break}case 3:case 4:{i===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(r,e,t,n,i);break}}}doInstantiateWhenIdle(e,t,n,i,r){Zn(`code/willCreateWorkbenchContributions/${r}`);let s=0,a=r===4?3e3:500,l=d=>{for(;s<e.length;){let c=e[s++];if(this.safeCreateContribution(t,n,i,c,r),d.timeRemaining()<1){Dd(l,a);break}}s===e.length&&(Zn(`code/didCreateWorkbenchContributions/${r}`),r===3&&this.pendingRestoredContributions.complete())};Dd(l,a)}safeCreateContribution(e,t,n,i,r){if(typeof i.id=="string"&&this.instancesById.has(i.id))return;let s=Date.now();try{typeof i.id=="string"&&Zn(`code/willCreateWorkbenchContribution/${r}/${i.id}`);let a=e.createInstance(i.ctor);typeof i.id=="string"&&(this.instancesById.set(i.id,a),this.contributionsById.delete(i.id)),iA(a)&&this.instanceDisposables.add(a)}catch(a){t.error(`Unable to create workbench contribution '${i.id??i.ctor.name}'.`,a)}finally{typeof i.id=="string"&&Zn(`code/didCreateWorkbenchContribution/${r}/${i.id}`)}if(typeof i.id=="string"||!n.isBuilt){let a=Date.now()-s;if(a>(r<3?o.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:o.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&t.warn(`Creation of workbench contribution '${i.id??i.ctor.name}' took ${a}ms.`),typeof i.id=="string"){let l=this.timingsByPhase.get(r);l||(l=[],this.timingsByPhase.set(r,l)),l.push([i.id,a])}}}},$H=Vu.INSTANCE.registerWorkbenchContribution2.bind(Vu.INSTANCE),sft=Vu.INSTANCE.getWorkbenchContribution.bind(Vu.INSTANCE);lt.add(TT.Workbench,Vu.INSTANCE);var Zb=class{constructor(e,t,n,i){this.fileService=e;this.environmentService=t;this.lifecycleService=n;this.logService=i}async getLogs(){return zH(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(3),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await lt.as(TT.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(e,t){let n=Oe.document.querySelector(e);if(!n)return Promise.reject(new Error(`Element not found: ${e}`));let i=n;i.value=t;let r=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(r)}async isActiveElement(e){if(Oe.document.querySelector(e)!==Oe.document.activeElement){let n=[],i=Oe.document.activeElement;for(;i;){let r=i.tagName,s=i.id?`#${i.id}`:"",a=Ro(i.className.split(/\s+/g).map(l=>l.trim())).map(l=>`.${l}`).join("");n.unshift(`${r}${s}${a}`),i=i.parentElement}throw new Error(`Active element not found. Current active element is '${n.join(" > ")}'. Looking for ${e}`)}return!0}async getElements(e,t){let n=Oe.document.querySelectorAll(e),i=[];for(let r=0;r<n.length;r++){let s=n.item(r);i.push(this.serializeElement(s,t))}return i}serializeElement(e,t){let n=Object.create(null);for(let a=0;a<e.attributes.length;a++){let l=e.attributes.item(a);l&&(n[l.name]=l.value)}let i=[];if(t)for(let a=0;a<e.children.length;a++){let l=e.children.item(a);l&&i.push(this.serializeElement(l,!0))}let{left:r,top:s}=vb(e);return{tagName:e.tagName,className:e.className,textContent:e.textContent||"",attributes:n,children:i,left:r,top:s}}async getElementXY(e,t,n){let i=typeof t=="number"&&typeof n=="number"?{x:t,y:n}:void 0;return this._getElementXY(e,i)}async typeInEditor(e,t){let n=Oe.document.querySelector(e);if(!n)throw new Error(`Editor not found: ${e}`);let i=n,r=i.selectionStart,s=r+t.length,a=i.value,l=a.substr(0,r)+t+a.substr(r);i.value=l,i.setSelectionRange(s,s);let d=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(d)}async getTerminalBuffer(e){let t=Oe.document.querySelector(e);if(!t)throw new Error(`Terminal not found: ${e}`);let n=t.xterm;if(!n)throw new Error(`Xterm not found: ${e}`);let i=[];for(let r=0;r<n.buffer.active.length;r++)i.push(n.buffer.active.getLine(r).translateToString(!0));return i}async writeInTerminal(e,t){let n=Oe.document.querySelector(e);if(!n)throw new Error(`Element not found: ${e}`);let i=n.xterm;if(!i)throw new Error(`Xterm not found: ${e}`);i.input(t)}getLocaleInfo(){return Promise.resolve({language:jr,locale:kN})}getLocalizedStrings(){return Promise.resolve({open:ET.open,close:ET.close,find:ET.find})}async _getElementXY(e,t){let n=Oe.document.querySelector(e);if(!n)return Promise.reject(new Error(`Element not found: ${e}`));let{left:i,top:r}=vb(n),{width:s,height:a}=yu(n),l,d;return t?(l=i+t.x,d=r+t.y):(l=i+s/2,d=r+a/2),l=Math.round(l),d=Math.round(d),{x:l,y:d}}async exitApplication(){}};Zb=P([_(0,Mn),_(1,kr),_(2,sc),_(3,gi)],Zb);function YH(o){Object.assign(Oe,{driver:o.createInstance(Zb)})}var Ur=class extends F{constructor(t,n={getWindowsCount:SS,getWindows:fb},i,r){super();this.hostService=i;this.environmentService=r;this.enableWindowFocusOnElementFocus(t),this.enableMultiWindowAwareTimeout(t,n),this.registerFullScreenListeners(t.vscodeWindowId)}static TIMEOUT_HANDLES=Number.MIN_SAFE_INTEGER;static TIMEOUT_DISPOSABLES=new Map;enableWindowFocusOnElementFocus(t){let n=t.HTMLElement.prototype.focus,i=this;t.HTMLElement.prototype.focus=function(r){i.onElementFocus(Ce(this)),n.apply(this,[r])}}onElementFocus(t){let n=$d();n!==t&&n.document.hasFocus()&&(t.focus(),!this.environmentService.extensionTestsLocationURI&&!t.document.hasFocus()&&this.hostService.focus(t))}enableMultiWindowAwareTimeout(t,n={getWindowsCount:SS,getWindows:fb}){let i=t.setTimeout;Object.defineProperty(t,"vscodeOriginalSetTimeout",{get:()=>i});let r=t.clearTimeout;Object.defineProperty(t,"vscodeOriginalClearTimeout",{get:()=>r}),t.setTimeout=function(s,a=0,...l){if(n.getWindowsCount()===1||typeof s=="string"||a===0)return i.apply(this,[s,a,...l]);let d=new Set,c=Ur.TIMEOUT_HANDLES++;Ur.TIMEOUT_DISPOSABLES.set(c,d);let u=vs(s,()=>{Tt(d),Ur.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:p,disposables:h}of n.getWindows()){if(qk(p)&&p.document.visibilityState==="hidden")continue;let f=!1,g=p.vscodeOriginalSetTimeout.apply(this,[(...v)=>{f||u(...v)},a,...l]),b=pe(()=>{f=!0,p.vscodeOriginalClearTimeout(g),d.delete(b)});h.add(b),d.add(b)}return c},t.clearTimeout=function(s){let a=typeof s=="number"?Ur.TIMEOUT_DISPOSABLES.get(s):void 0;a?(Tt(a),Ur.TIMEOUT_DISPOSABLES.delete(s)):r.apply(this,[s])}}registerFullScreenListeners(t){this._register(this.hostService.onDidChangeFullScreen(({windowId:n,fullscreen:i})=>{if(n===t){let r=vu(t);r&&WW(i,r.window)}}))}static async confirmOnShutdown(t,n){let i=t.get(Dl),r=t.get(ut),s=n===2?Fe?m("quitMessageMac","Are you sure you want to quit?"):m("quitMessage","Are you sure you want to exit?"):m("closeWindowMessage","Are you sure you want to close the window?"),a=n===2?Fe?m({key:"quitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Quit"):m({key:"exitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Exit"):m({key:"closeWindowButtonLabel",comment:["&& denotes a mnemonic"]},"&&Close Window"),l=await i.confirm({message:s,primaryButton:a,checkbox:{label:m("doNotAskAgain","Do not ask me again")}});return l.confirmed&&l.checkboxChecked&&await r.updateValue("window.confirmBeforeClose","never"),l.confirmed}};Ur=P([_(2,fm),_(3,zl)],Ur);var wT=class extends Ur{constructor(t,n,i,r,s,a,l,d,c){super(Oe,void 0,c,a);this.openerService=t;this.lifecycleService=n;this.dialogService=i;this.labelService=r;this.productService=s;this.browserEnvironmentService=a;this.layoutService=l;this.instantiationService=d;this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let t=qr&&Oe.visualViewport?Oe.visualViewport:Oe;this._register(q(t,he.RESIZE,()=>{this.layoutService.layout(),qr&&Oe.scrollTo(0,0)})),this._register(q(this.layoutService.mainContainer,he.WHEEL,n=>n.preventDefault(),{passive:!1})),this._register(q(this.layoutService.mainContainer,he.CONTEXT_MENU,n=>rt.stop(n,!0))),this._register(q(this.layoutService.mainContainer,he.DROP,n=>rt.stop(n,!0)))}onWillShutdown(){j.toPromise(j.any(j.once(new Ne(Oe.document.body,he.KEY_DOWN,!0).event),j.once(new Ne(Oe.document.body,he.MOUSE_DOWN,!0).event))).then(async()=>{await wi(3e3),await this.dialogService.prompt({type:ui.Error,message:m("shutdownError","An unexpected error occurred that requires a reload of this page."),detail:m("shutdownErrorDetail","The workbench was unexpectedly disposed while running."),buttons:[{label:m({key:"reload",comment:["&& denotes a mnemonic"]},"&&Reload"),run:()=>Oe.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&YH(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async t=>{let n=!1;if(this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes){for(let i of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(t.startsWith(i)){n=!0;break}}if($g(t,xe.http)||$g(t,xe.https))Ko?yV(t,!n)||await this.dialogService.prompt({type:ui.Warning,message:m("unableToOpenExternal","The browser interrupted the opening of a new tab or window. Press 'Open' to open it anyway."),detail:t,buttons:[{label:m({key:"open",comment:["&& denotes a mnemonic"]},"&&Open"),run:()=>n?u1(t):c1(t)},{label:m({key:"learnMore",comment:["&& denotes a mnemonic"]},"&&Learn More"),run:()=>this.openerService.open(te.parse("https://aka.ms/allow-vscode-popup"))}],cancelButton:!0}):n?u1(t):c1(t);else{let i=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>Oe.location.href=t)};i();let r=async()=>{let{downloadUrl:s}=this.productService,a,l=[{label:m({key:"openExternalDialogButtonRetry.v2",comment:["&& denotes a mnemonic"]},"&&Try Again"),run:()=>i()}];s!==void 0?(a=m("openExternalDialogDetail.v2",`We launched {0} on your computer.

If {1} did not launch, try again or install it below.`,this.productService.nameLong,this.productService.nameLong),l.push({label:m({key:"openExternalDialogButtonInstall.v3",comment:["&& denotes a mnemonic"]},"&&Install"),run:async()=>{await this.openerService.open(te.parse(s)),r()}})):a=m("openExternalDialogDetailNoInstall",`We launched {0} on your computer.

If {1} did not launch, try again below.`,this.productService.nameLong,this.productService.nameLong),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:ui.Info,message:m("openExternalDialogTitle","All done. You can close this tab now."),detail:a,buttons:l,cancelButton:!0}))};$g(t,this.productService.urlProtocol)&&await r()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:xe.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){ir.registerCommand("workbench.experimental.requestUsbDevice",async(t,n)=>NH(n)),ir.registerCommand("workbench.experimental.requestSerialPort",async(t,n)=>AH(n)),ir.registerCommand("workbench.experimental.requestHidDevice",async(t,n)=>PH(n))}};wT=P([_(0,YR),_(1,sc),_(2,Dl),_(3,du),_(4,mW),_(5,BH),_(6,ST),_(7,Qe),_(8,fm)],wT);var hK=Q("auxiliaryWindowService");var Qb=class extends Ur{constructor(t,n,i,r,s,a){super(t,void 0,s,a);this.window=t;this.container=n;this.configurationService=r;this.whenStylesHaveLoaded=i.wait().then(()=>{}),this.registerListeners()}_onWillLayout=this._register(new k);onWillLayout=this._onWillLayout.event;_onDidLayout=this._register(new k);onDidLayout=this._onDidLayout.event;_onBeforeUnload=this._register(new k);onBeforeUnload=this._onBeforeUnload.event;_onUnload=this._register(new k);onUnload=this._onUnload.event;_onWillDispose=this._register(new k);onWillDispose=this._onWillDispose.event;whenStylesHaveLoaded;registerListeners(){this._register(q(this.window,he.BEFORE_UNLOAD,t=>this.handleBeforeUnload(t))),this._register(q(this.window,he.UNLOAD,()=>this.handleUnload())),this._register(q(this.window,"unhandledrejection",t=>{je(t.reason),t.preventDefault()})),this._register(q(this.window,he.RESIZE,()=>this.layout())),this._register(q(this.container,he.SCROLL,()=>this.container.scrollTop=0)),Zi?(this._register(q(this.container,he.DROP,t=>rt.stop(t,!0))),this._register(q(this.container,he.WHEEL,t=>t.preventDefault(),{passive:!1})),this._register(q(this.container,he.CONTEXT_MENU,t=>rt.stop(t,!0)))):(this._register(q(this.window.document.body,he.DRAG_OVER,t=>rt.stop(t))),this._register(q(this.window.document.body,he.DROP,t=>rt.stop(t))))}handleBeforeUnload(t){let n;if(this._onBeforeUnload.fire({veto(s){s&&(n=s)}}),n){this.handleVetoBeforeClose(t,n);return}let i=this.configurationService.getValue("window.confirmBeforeClose");(i==="always"||i==="keyboardOnly"&&Vh.getInstance().isModifierPressed)&&this.confirmBeforeClose(t)}handleVetoBeforeClose(t,n){this.preventUnload(t)}preventUnload(t){t.preventDefault(),t.returnValue=m("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(t){this.preventUnload(t)}handleUnload(){this._onUnload.fire()}layout(){let t=yu(this.window.document.body,this.container);this._onWillLayout.fire(t),this._onDidLayout.fire(t)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:FW(this.window)}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};Qb=P([_(3,ut),_(4,fm),_(5,zl)],Qb);var Gl=class extends F{constructor(t,n,i,r,s,a){super();this.layoutService=t;this.dialogService=n;this.configurationService=i;this.telemetryService=r;this.hostService=s;this.environmentService=a}static DEFAULT_SIZE={width:800,height:600};static WINDOW_IDS=jd(Oe)+1;_onDidOpenAuxiliaryWindow=this._register(new k);onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event;windows=new Map;async open(t){Zn("code/auxiliaryWindow/willOpen");let n=await this.openWindow(t);if(!n)throw new Error(m("unableToOpenWindowError","Unable to open a new window."));let i=await this.resolveWindowId(n);uS(n,i);let r=new ne,{container:s,stylesLoaded:a}=this.createContainer(n,r,t),l=this.createAuxiliaryWindow(n,s,a),d=new ne;this.windows.set(n.vscodeWindowId,l),d.add(pe(()=>this.windows.delete(n.vscodeWindowId)));let c=new ne;return j.once(l.onWillDispose)(()=>{n.close(),r.dispose(),d.dispose(),c.dispose()}),d.add(oV(n)),this._onDidOpenAuxiliaryWindow.fire({window:l,disposables:c}),Zn("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!!t?.bounds}),l}createAuxiliaryWindow(t,n,i){return new Qb(t,n,i,this.configurationService,this.hostService,this.environmentService)}async openWindow(t){let n=$d(),i={x:n.screenX,y:n.screenY,width:n.outerWidth,height:n.outerHeight},r=Math.max(t?.bounds?.width??Gl.DEFAULT_SIZE.width,_k.WIDTH),s=Math.max(t?.bounds?.height??Gl.DEFAULT_SIZE.height,_k.HEIGHT),a={x:t?.bounds?.x??Math.max(i.x+i.width/2-r/2,0),y:t?.bounds?.y??Math.max(i.y+i.height/2-s/2,0),width:r,height:s};!t?.bounds&&a.x===i.x&&a.y===i.y&&(a={...a,x:a.x+30,y:a.y+30});let l=Ro(["popup=yes",`left=${a.x}`,`top=${a.y}`,`width=${a.width}`,`height=${a.height}`,t?.nativeTitlebar?"window-native-titlebar=yes":void 0,t?.disableFullscreen?"window-disable-fullscreen=yes":void 0,t?.mode===0?"window-maximized=yes":void 0,t?.mode===2?"window-fullscreen=yes":void 0]),d=Oe.open(Yv?"":"about:blank",void 0,l.join(","));return!d&&Zi?(await this.dialogService.prompt({type:ui.Warning,message:m("unableToOpenWindow","The browser interrupted the opening of a new window. Press 'Retry' to try again."),detail:m("unableToOpenWindowDetail","To avoid this problem in the future, please ensure to allow popups for this website."),buttons:[{label:m({key:"retry",comment:["&& denotes a mnemonic"]},"&&Retry"),run:()=>this.openWindow(t)}],cancelButton:!0})).result:d?.window}async resolveWindowId(t){return Gl.WINDOW_IDS++}createContainer(t,n,i){t.document.createElement=function(){throw new Error('Not allowed to create elements in child window JavaScript context. Always use the main window so that "xyz instanceof HTMLElement" continues to work.')},this.applyMeta(t);let{stylesLoaded:r}=this.applyCSS(t,n),s=this.applyHTML(t,n);return{stylesLoaded:r,container:s}}applyMeta(t){for(let i of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let r=Oe.document.querySelector(i);if(r){let s=pV(t.document.head);if(LS(r,s),i==='meta[http-equiv="Content-Security-Policy"]'){let a=s.getAttribute("content");a&&s.setAttribute("content",a.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let n=Oe.document.querySelector('link[rel="icon"]');if(n){let i=hV(t.document.head);LS(n,i)}}applyCSS(t,n){Zn("code/auxiliaryWindow/willApplyCSS");let i=new Map,r=new qp;r.wait().then(()=>Zn("code/auxiliaryWindow/didLoadCSSStyles"));let s=n.add(new ne),a=0;function l(){--a===0&&(s.dispose(),r.open())}function d(c){if(dV(c))return;let u=t.document.head.appendChild(c.cloneNode(!0));c.tagName.toLowerCase()==="link"&&(a++,s.add(q(u,"load",l)),s.add(q(u,"error",l))),i.set(c,u)}a++;try{for(let c of Oe.document.head.querySelectorAll('link[rel="stylesheet"], style'))d(c)}finally{l()}return n.add(cV(t)),n.add(xS.observe(Oe.document.head,n,{childList:!0,subtree:!0})(c=>{for(let u of c)if(!(u.type!=="childList"||u.target.nodeName.toLowerCase()==="title"||u.target.nodeName.toLowerCase()==="script"||u.target.nodeName.toLowerCase()==="meta")){for(let p of u.addedNodes)if(On(p)&&(p.tagName.toLowerCase()==="style"||p.tagName.toLowerCase()==="link"))d(p);else if(p.nodeType===Node.TEXT_NODE&&p.parentNode){let h=i.get(p.parentNode);h&&(h.textContent=p.textContent)}for(let p of u.removedNodes){let h=i.get(p);h&&(h.parentNode?.removeChild(h),i.delete(p))}}})),Zn("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:r}}applyHTML(t,n){Zn("code/auxiliaryWindow/willApplyHTML");let i=document.createElement("div");return i.setAttribute("role","application"),aV(i,0,0,0,0,"relative"),i.style.display="flex",i.style.height="100%",i.style.flexDirection="column",t.document.body.append(i),n.add(DS(Oe.document.documentElement,t.document.documentElement)),n.add(DS(Oe.document.body,t.document.body)),n.add(DS(this.layoutService.mainContainer,i,["class"])),Zn("code/auxiliaryWindow/didApplyHTML"),i}getWindow(t){return this.windows.get(t)}};Gl=P([_(0,ST),_(1,Dl),_(2,ut),_(3,Li),_(4,fm),_(5,zl)],Gl);ji(hK,Gl,1);var ac=new oo(220,70),rM=new oo(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);var xT=class o extends IT{constructor(t,n,i,r,s){super(t,i,r,s);this.group=n}onDidChangeSizeConstraints=j.None;_onDidChangeControl=this._register(new k);onDidChangeControl=this._onDidChangeControl.event;static EDITOR_MEMENTOS=new Map;get minimumWidth(){return ac.width}get maximumWidth(){return rM.width}get minimumHeight(){return ac.height}get maximumHeight(){return rM.height}_input;get input(){return this._input}_options;get options(){return this._options}get window(){return vu(this.group.windowId,!0).window}get scopedContextKeyService(){}create(t){super.create(t),this.createEditor(t)}async setInput(t,n,i,r){this._input=t,this._options=n}clearInput(){this._input=void 0,this._options=void 0}setOptions(t){this._options=t}setVisible(t){super.setVisible(t),this.setEditorVisible(t)}setEditorVisible(t){}setBoundarySashes(t){}getEditorMemento(t,n,i,r=10){let s=`${this.getId()}${i}`,a=o.EDITOR_MEMENTOS.get(s);return a||(a=this._register(new sM(this.getId(),i,this.getMemento(1,1),r,t,n)),o.EDITOR_MEMENTOS.set(s,a)),a}getViewState(){}saveState(){for(let[,t]of o.EDITOR_MEMENTOS)t.id===this.getId()&&t.saveState();super.saveState()}dispose(){this._input=void 0,this._options=void 0,super.dispose()}},sM=class o extends F{constructor(t,n,i,r,s,a){super();this.id=t;this.key=n;this.memento=i;this.limit=r;this.editorGroupService=s;this.configurationService=a;this.updateConfiguration(void 0),this.registerListeners()}static SHARED_EDITOR_STATE=-1;cache;cleanedUp=!1;editorDisposables;shareEditorState=!1;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.updateConfiguration(t)))}updateConfiguration(t){(!t||t.affectsConfiguration(void 0,"workbench.editor.sharedViewState"))&&(this.shareEditorState=this.configurationService.getValue(void 0,"workbench.editor.sharedViewState")===!0)}saveEditorState(t,n,i){let r=this.doGetResource(n);if(!r||!t)return;let s=this.doLoad(),a=s.get(r.toString());a||(a=Object.create(null),s.set(r.toString(),a)),a[t.id]=i,this.shareEditorState&&(a[o.SHARED_EDITOR_STATE]=i),hi(n)&&this.clearEditorStateOnDispose(r,n)}loadEditorState(t,n){let i=this.doGetResource(n);if(!i||!t)return;let s=this.doLoad().get(i.toString());if(s){let a=s[t.id];if(a)return a;if(this.shareEditorState)return s[o.SHARED_EDITOR_STATE]}}clearEditorState(t,n){hi(t)&&this.editorDisposables?.delete(t);let i=this.doGetResource(t);if(i){let r=this.doLoad();if(n){let s=r.get(i.toString());s&&(delete s[n.id],Vc(s)&&r.delete(i.toString()))}else r.delete(i.toString())}}clearEditorStateOnDispose(t,n){this.editorDisposables||(this.editorDisposables=new Map),this.editorDisposables.has(n)||this.editorDisposables.set(n,j.once(n.onWillDispose)(()=>{this.clearEditorState(t),this.editorDisposables?.delete(n)}))}moveEditorState(t,n,i){let r=this.doLoad(),s=[...r.keys()];for(let a of s){let l=te.parse(a);if(!i.isEqualOrParent(l,t))continue;let d;if(Qi(t,l))d=n;else{let u=sP(l.path,t.path);d=It(n,l.path.substr(u+t.path.length+1))}let c=r.get(a,0);c&&(r.delete(a),r.set(d.toString(),c))}}doGetResource(t){return hi(t)?t.resource:t}doLoad(){if(!this.cache){this.cache=new Qo(this.limit);let t=this.memento[this.key];Array.isArray(t)&&this.cache.fromJSON(t)}return this.cache}saveState(){let t=this.doLoad();this.cleanedUp||(this.cleanUp(),this.cleanedUp=!0),this.memento[this.key]=t.toJSON()}cleanUp(){let t=this.doLoad(),n=[...t.entries()];for(let[i,r]of n)for(let s of Object.keys(r)){let a=Number(s);a===o.SHARED_EDITOR_STATE&&this.shareEditorState||this.editorGroupService.getGroup(a)||(delete r[a],Vc(r)&&t.delete(i))}}};var ZH=class o{constructor(e,t,n){this.ctor=e;this.typeId=t;this.name=n}static instantiatedEditorPanes=new Set;static didInstantiateEditorPane(e){return o.instantiatedEditorPanes.has(e)}static _onWillInstantiateEditorPane=new k;static onWillInstantiateEditorPane=o._onWillInstantiateEditorPane.event;static create(e,t,n){return new o(e,t,n)}instantiate(e,t){o._onWillInstantiateEditorPane.fire({typeId:this.typeId});let n=e.createInstance(this.ctor,t);return o.instantiatedEditorPanes.add(this.typeId),n}describes(e){return e.getId()===this.typeId}},aM=class{mapEditorPanesToEditors=new Map;registerEditorPane(e,t){return this.mapEditorPanesToEditors.set(e,t),pe(()=>{this.mapEditorPanesToEditors.delete(e)})}getEditorPane(e){let t=this.findEditorPaneDescriptors(e);if(t.length!==0)return t.length===1?t[0]:e.prefersEditorPane(t)}findEditorPaneDescriptors(e,t){let n=[];for(let i of this.mapEditorPanesToEditors.keys()){let r=this.mapEditorPanesToEditors.get(i)||[];for(let s of r){let a=s.ctor;if(!t&&e.constructor===a){n.push(i);break}else if(t&&e instanceof a){n.push(i);break}}}return!t&&n.length===0?this.findEditorPaneDescriptors(e,!0):n}getEditorPaneByType(e){return Je.find(this.mapEditorPanesToEditors.keys(),t=>t.typeId===e)}getEditorPanes(){return Array.from(this.mapEditorPanesToEditors.keys())}getEditors(){let e=[];for(let t of this.mapEditorPanesToEditors.keys()){let n=this.mapEditorPanesToEditors.get(t);n&&e.push(...n.map(i=>i.ctor))}return e}};lt.add(Bs.EditorPane,new aM);function QH(o,e,t,n){let i=o.getAriaLabel();return t&&!t.isPinned(o)&&(i=m("preview","{0}, preview",i)),t?.isSticky(e??o)&&(i=m("pinned","{0}, pinned",i)),t&&typeof n=="number"&&n>1&&(i=`${i}, ${t.ariaLabel}`),i}var sU=E("tab.activeBackground",ns,m("tabActiveBackground","Active tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),uIt=E("tab.unfocusedActiveBackground",sU,m("tabUnfocusedActiveBackground","Active tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),mK=E("tab.inactiveBackground",{dark:"#2D2D2D",light:"#ECECEC",hcDark:null,hcLight:null},m("tabInactiveBackground","Inactive tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),pIt=E("tab.unfocusedInactiveBackground",mK,m("tabUnfocusedInactiveBackground","Inactive tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Hu=E("tab.activeForeground",{dark:V.white,light:"#333333",hcDark:V.white,hcLight:"#292929"},m("tabActiveForeground","Active tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),XH=E("tab.inactiveForeground",{dark:ye(Hu,.5),light:ye(Hu,.7),hcDark:V.white,hcLight:"#292929"},m("tabInactiveForeground","Inactive tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),hIt=E("tab.unfocusedActiveForeground",{dark:ye(Hu,.5),light:ye(Hu,.7),hcDark:V.white,hcLight:"#292929"},m("tabUnfocusedActiveForeground","Active tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),mIt=E("tab.unfocusedInactiveForeground",{dark:ye(XH,.5),light:ye(XH,.5),hcDark:V.white,hcLight:"#292929"},m("tabUnfocusedInactiveForeground","Inactive tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),JH=E("tab.hoverBackground",null,m("tabHoverBackground","Tab background color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),gIt=E("tab.unfocusedHoverBackground",{dark:ye(JH,.5),light:ye(JH,.7),hcDark:null,hcLight:null},m("tabUnfocusedHoverBackground","Tab background color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),eU=E("tab.hoverForeground",null,m("tabHoverForeground","Tab foreground color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),fIt=E("tab.unfocusedHoverForeground",{dark:ye(eU,.5),light:ye(eU,.5),hcDark:null,hcLight:null},m("tabUnfocusedHoverForeground","Tab foreground color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),bIt=E("tab.border",{dark:"#252526",light:"#F3F3F3",hcDark:Ee,hcLight:Ee},m("tabBorder","Border to separate tabs from each other. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),vIt=E("tab.lastPinnedBorder",{dark:bh,light:bh,hcDark:Ee,hcLight:Ee},m("lastPinnedTabBorder","Border to separate pinned tabs from other tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),tU=E("tab.activeBorder",null,m("tabActiveBorder","Border on the bottom of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),yIt=E("tab.unfocusedActiveBorder",{dark:ye(tU,.5),light:ye(tU,.7),hcDark:null,hcLight:null},m("tabActiveUnfocusedBorder","Border on the bottom of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),lM=E("tab.activeBorderTop",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},m("tabActiveBorderTop","Border to the top of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),IIt=E("tab.unfocusedActiveBorderTop",{dark:ye(lM,.5),light:ye(lM,.7),hcDark:null,hcLight:"#B5200D"},m("tabActiveUnfocusedBorderTop","Border to the top of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),CIt=E("tab.selectedBorderTop",lM,m("tabSelectedBorderTop","Border to the top of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),SIt=E("tab.selectedBackground",sU,m("tabSelectedBackground","Background of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),EIt=E("tab.selectedForeground",Hu,m("tabSelectedForeground","Foreground of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),nU=E("tab.hoverBorder",null,m("tabHoverBorder","Border to highlight tabs when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),TIt=E("tab.unfocusedHoverBorder",{dark:ye(nU,.5),light:ye(nU,.7),hcDark:null,hcLight:Ee},m("tabUnfocusedHoverBorder","Border to highlight tabs in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),wIt=E("tab.dragAndDropBorder",{dark:Hu,light:Hu,hcDark:Ot,hcLight:Ot},m("tabDragAndDropBorder","Border between tabs to indicate that a tab can be inserted between two tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),LT=E("tab.activeModifiedBorder",{dark:"#3399CC",light:"#33AAEE",hcDark:null,hcLight:Ee},m("tabActiveModifiedBorder","Border on the top of modified active tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),iU=E("tab.inactiveModifiedBorder",{dark:ye(LT,.5),light:ye(LT,.5),hcDark:V.white,hcLight:Ee},m("tabInactiveModifiedBorder","Border on the top of modified inactive tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),xIt=E("tab.unfocusedActiveModifiedBorder",{dark:ye(LT,.5),light:ye(LT,.7),hcDark:V.white,hcLight:Ee},m("unfocusedActiveModifiedBorder","Border on the top of modified active tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),_It=E("tab.unfocusedInactiveModifiedBorder",{dark:ye(iU,.5),light:ye(iU,.5),hcDark:V.white,hcLight:Ee},m("unfocusedINactiveModifiedBorder","Border on the top of modified inactive tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),LIt=E("editorPane.background",ns,m("editorPaneBackground","Background color of the editor pane visible on the left and right side of the centered editor layout.")),DIt=E("editorGroup.emptyBackground",null,m("editorGroupEmptyBackground","Background color of an empty editor group. Editor groups are the containers of editors.")),kIt=E("editorGroup.focusedEmptyBorder",{dark:null,light:null,hcDark:to,hcLight:to},m("editorGroupFocusedEmptyBorder","Border color of an empty editor group that is focused. Editor groups are the containers of editors.")),RIt=E("editorGroupHeader.tabsBackground",{dark:"#252526",light:"#F3F3F3",hcDark:null,hcLight:null},m("tabsContainerBackground","Background color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),MIt=E("editorGroupHeader.tabsBorder",null,m("tabsContainerBorder","Border color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),OIt=E("editorGroupHeader.noTabsBackground",ns,m("editorGroupHeaderBackground",'Background color of the editor group title header when (`"workbench.editor.showTabs": "single"`). Editor groups are the containers of editors.')),NIt=E("editorGroupHeader.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("editorTitleContainerBorder","Border color of the editor group title header. Editor groups are the containers of editors.")),aU=E("editorGroup.border",{dark:"#444444",light:"#E7E7E7",hcDark:Ee,hcLight:Ee},m("editorGroupBorder","Color to separate multiple editor groups from each other. Editor groups are the containers of editors.")),lU=E("editorGroup.dropBackground",{dark:V.fromHex("#53595D").transparent(.5),light:V.fromHex("#2677CB").transparent(.18),hcDark:null,hcLight:V.fromHex("#0F4A85").transparent(.5)},m("editorDragAndDropBackground","Background color when dragging editors around. The color should have transparency so that the editor contents can still shine through.")),AIt=E("editorGroup.dropIntoPromptForeground",wa,m("editorDropIntoPromptForeground","Foreground color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),PIt=E("editorGroup.dropIntoPromptBackground",_i,m("editorDropIntoPromptBackground","Background color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),FIt=E("editorGroup.dropIntoPromptBorder",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("editorDropIntoPromptBorder","Border color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),dU=E("sideBySideEditor.horizontalBorder",aU,m("sideBySideEditor.horizontalBorder","Color to separate two editors from each other when shown side by side in an editor group from top to bottom.")),cU=E("sideBySideEditor.verticalBorder",aU,m("sideBySideEditor.verticalBorder","Color to separate two editors from each other when shown side by side in an editor group from left to right.")),gK=E("panel.background",ns,m("panelBackground","Panel background color. Panels are shown below the editor area and contain views like output and integrated terminal.")),fK=E("panel.border",{dark:V.fromHex("#808080").transparent(.35),light:V.fromHex("#808080").transparent(.35),hcDark:Ee,hcLight:Ee},m("panelBorder","Panel border color to separate the panel from the editor. Panels are shown below the editor area and contain views like output and integrated terminal.")),Xb=E("panelTitle.activeForeground",{dark:"#E7E7E7",light:"#424242",hcDark:V.white,hcLight:Ta},m("panelActiveTitleForeground","Title color for the active panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),BIt=E("panelTitle.inactiveForeground",{dark:ye(Xb,.6),light:ye(Xb,.75),hcDark:V.white,hcLight:Ta},m("panelInactiveTitleForeground","Title color for the inactive panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),WIt=E("panelTitle.activeBorder",{dark:Xb,light:Xb,hcDark:Ee,hcLight:"#B5200D"},m("panelActiveTitleBorder","Border color for the active panel title. Panels are shown below the editor area and contain views like output and integrated terminal.")),VIt=E("panelInput.border",{dark:gh,light:V.fromHex("#ddd"),hcDark:gh,hcLight:gh},m("panelInputBorder","Input box border for inputs in the panel.")),HIt=E("panel.dropBorder",Xb,m("panelDragAndDropBorder","Drag and drop feedback color for the panel titles. Panels are shown below the editor area and contain views like output and integrated terminal.")),UIt=E("panelSection.dropBackground",lU,m("panelSectionDragAndDropBackground","Drag and drop feedback color for the panel sections. The color should have transparency so that the panel sections can still shine through. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),zIt=E("panelSectionHeader.background",{dark:V.fromHex("#808080").transparent(.2),light:V.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},m("panelSectionHeaderBackground","Panel section header background color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),KIt=E("panelSectionHeader.foreground",null,m("panelSectionHeaderForeground","Panel section header foreground color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),GIt=E("panelSectionHeader.border",Ee,m("panelSectionHeaderBorder","Panel section header border color used when multiple views are stacked vertically in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),jIt=E("panelSection.border",fK,m("panelSectionBorder","Panel section border color used when multiple views are stacked horizontally in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),qIt=E("panelStickyScroll.background",gK,m("panelStickyScrollBackground","Background color of sticky scroll in the panel.")),$It=E("panelStickyScroll.border",null,m("panelStickyScrollBorder","Border color of sticky scroll in the panel.")),YIt=E("panelStickyScroll.shadow",Bd,m("panelStickyScrollShadow","Shadow color of sticky scroll in the panel.")),bK=E("outputView.background",null,m("outputViewBackground","Output view background color."));E("outputViewStickyScroll.background",bK,m("outputViewStickyScrollBackground","Output view sticky scroll background color."));var ZIt=E("banner.background",{dark:Vo,light:eo(Vo,.3),hcDark:Vo,hcLight:Vo},m("banner.background","Banner background color. The banner is shown under the title bar of the window.")),QIt=E("banner.foreground",xa,m("banner.foreground","Banner foreground color. The banner is shown under the title bar of the window.")),XIt=E("banner.iconForeground",lr,m("banner.iconForeground","Banner icon color. The banner is shown under the title bar of the window.")),lc=E("statusBar.foreground",{dark:"#FFFFFF",light:"#FFFFFF",hcDark:"#FFFFFF",hcLight:Ta},m("statusBarForeground","Status bar foreground color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),JIt=E("statusBar.noFolderForeground",lc,m("statusBarNoFolderForeground","Status bar foreground color when no folder is opened. The status bar is shown in the bottom of the window.")),eCt=E("statusBar.background",{dark:"#007ACC",light:"#007ACC",hcDark:null,hcLight:null},m("statusBarBackground","Status bar background color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),tCt=E("statusBar.noFolderBackground",{dark:"#68217A",light:"#68217A",hcDark:null,hcLight:null},m("statusBarNoFolderBackground","Status bar background color when no folder is opened. The status bar is shown in the bottom of the window.")),vK=E("statusBar.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("statusBarBorder","Status bar border color separating to the sidebar and editor. The status bar is shown in the bottom of the window.")),nCt=E("statusBar.focusBorder",{dark:lc,light:lc,hcDark:null,hcLight:lc},m("statusBarFocusBorder","Status bar border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),iCt=E("statusBar.noFolderBorder",vK,m("statusBarNoFolderBorder","Status bar border color separating to the sidebar and editor when no folder is opened. The status bar is shown in the bottom of the window.")),oCt=E("statusBarItem.activeBackground",{dark:V.white.transparent(.18),light:V.white.transparent(.18),hcDark:V.white.transparent(.18),hcLight:V.black.transparent(.18)},m("statusBarItemActiveBackground","Status bar item background color when clicking. The status bar is shown in the bottom of the window.")),rCt=E("statusBarItem.focusBorder",{dark:lc,light:lc,hcDark:null,hcLight:Ot},m("statusBarItemFocusBorder","Status bar item border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),dc=E("statusBarItem.hoverBackground",{dark:V.white.transparent(.12),light:V.white.transparent(.12),hcDark:V.white.transparent(.12),hcLight:V.black.transparent(.12)},m("statusBarItemHoverBackground","Status bar item background color when hovering. The status bar is shown in the bottom of the window.")),ev=E("statusBarItem.hoverForeground",lc,m("statusBarItemHoverForeground","Status bar item foreground color when hovering. The status bar is shown in the bottom of the window.")),sCt=E("statusBarItem.compactHoverBackground",{dark:V.white.transparent(.2),light:V.white.transparent(.2),hcDark:V.white.transparent(.2),hcLight:V.black.transparent(.2)},m("statusBarItemCompactHoverBackground","Status bar item background color when hovering an item that contains two hovers. The status bar is shown in the bottom of the window.")),aCt=E("statusBarItem.prominentForeground",lc,m("statusBarProminentItemForeground","Status bar prominent items foreground color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),lCt=E("statusBarItem.prominentBackground",V.black.transparent(.5),m("statusBarProminentItemBackground","Status bar prominent items background color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),dCt=E("statusBarItem.prominentHoverForeground",ev,m("statusBarProminentItemHoverForeground","Status bar prominent items foreground color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),cCt=E("statusBarItem.prominentHoverBackground",{dark:V.black.transparent(.3),light:V.black.transparent(.3),hcDark:V.black.transparent(.3),hcLight:null},m("statusBarProminentItemHoverBackground","Status bar prominent items background color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),uCt=E("statusBarItem.errorBackground",{dark:eo(L0,.4),light:eo(L0,.4),hcDark:null,hcLight:"#B5200D"},m("statusBarErrorItemBackground","Status bar error items background color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),pCt=E("statusBarItem.errorForeground",V.white,m("statusBarErrorItemForeground","Status bar error items foreground color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),hCt=E("statusBarItem.errorHoverForeground",ev,m("statusBarErrorItemHoverForeground","Status bar error items foreground color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),mCt=E("statusBarItem.errorHoverBackground",dc,m("statusBarErrorItemHoverBackground","Status bar error items background color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),gCt=E("statusBarItem.warningBackground",{dark:eo(So,.4),light:eo(So,.4),hcDark:null,hcLight:"#895503"},m("statusBarWarningItemBackground","Status bar warning items background color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),fCt=E("statusBarItem.warningForeground",V.white,m("statusBarWarningItemForeground","Status bar warning items foreground color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),bCt=E("statusBarItem.warningHoverForeground",ev,m("statusBarWarningItemHoverForeground","Status bar warning items foreground color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),vCt=E("statusBarItem.warningHoverBackground",dc,m("statusBarWarningItemHoverBackground","Status bar warning items background color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),yCt=E("activityBar.background",{dark:"#333333",light:"#2C2C2C",hcDark:"#000000",hcLight:"#FFFFFF"},m("activityBarBackground","Activity bar background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),bm=E("activityBar.foreground",{dark:V.white,light:V.white,hcDark:V.white,hcLight:Ta},m("activityBarForeground","Activity bar item foreground color when it is active. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ICt=E("activityBar.inactiveForeground",{dark:ye(bm,.4),light:ye(bm,.4),hcDark:V.white,hcLight:Ta},m("activityBarInActiveForeground","Activity bar item foreground color when it is inactive. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),CCt=E("activityBar.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("activityBarBorder","Activity bar border color separating to the side bar. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),SCt=E("activityBar.activeBorder",{dark:bm,light:bm,hcDark:Ee,hcLight:Ee},m("activityBarActiveBorder","Activity bar border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ECt=E("activityBar.activeFocusBorder",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},m("activityBarActiveFocusBorder","Activity bar focus border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),TCt=E("activityBar.activeBackground",null,m("activityBarActiveBackground","Activity bar background color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),wCt=E("activityBar.dropBorder",{dark:bm,light:bm,hcDark:null,hcLight:null},m("activityBarDragAndDropBorder","Drag and drop feedback color for the activity bar items. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),uU=E("activityBarBadge.background",{dark:"#007ACC",light:"#007ACC",hcDark:"#000000",hcLight:"#0F4A85"},m("activityBarBadgeBackground","Activity notification badge background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),pU=E("activityBarBadge.foreground",V.white,m("activityBarBadgeForeground","Activity notification badge foreground color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),Jb=E("activityBarTop.foreground",{dark:"#E7E7E7",light:"#424242",hcDark:V.white,hcLight:Ta},m("activityBarTop","Active foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),xCt=E("activityBarTop.activeBorder",{dark:Jb,light:Jb,hcDark:Ee,hcLight:"#B5200D"},m("activityBarTopActiveFocusBorder","Focus border color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),_Ct=E("activityBarTop.activeBackground",null,m("activityBarTopActiveBackground","Background color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),LCt=E("activityBarTop.inactiveForeground",{dark:ye(Jb,.6),light:ye(Jb,.75),hcDark:V.white,hcLight:Ta},m("activityBarTopInActiveForeground","Inactive foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),DCt=E("activityBarTop.dropBorder",Jb,m("activityBarTopDragAndDropBorder","Drag and drop feedback color for the items in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),kCt=E("activityBarTop.background",null,m("activityBarTopBackground","Background color of the activity bar when set to top / bottom.")),RCt=E("profileBadge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:V.white,hcLight:V.black},m("profileBadgeBackground","Profile badge background color. The profile badge shows on top of the settings gear icon in the activity bar.")),MCt=E("profileBadge.foreground",{dark:V.white,light:"#333333",hcDark:V.black,hcLight:V.white},m("profileBadgeForeground","Profile badge foreground color. The profile badge shows on top of the settings gear icon in the activity bar.")),OCt=E("statusBarItem.remoteBackground",uU,m("statusBarItemHostBackground","Background color for the remote indicator on the status bar.")),yK=E("statusBarItem.remoteForeground",pU,m("statusBarItemHostForeground","Foreground color for the remote indicator on the status bar.")),NCt=E("statusBarItem.remoteHoverForeground",ev,m("statusBarRemoteItemHoverForeground","Foreground color for the remote indicator on the status bar when hovering.")),ACt=E("statusBarItem.remoteHoverBackground",{dark:dc,light:dc,hcDark:dc,hcLight:null},m("statusBarRemoteItemHoverBackground","Background color for the remote indicator on the status bar when hovering.")),PCt=E("statusBarItem.offlineBackground","#6c1717",m("statusBarItemOfflineBackground","Status bar item background color when the workbench is offline.")),FCt=E("statusBarItem.offlineForeground",yK,m("statusBarItemOfflineForeground","Status bar item foreground color when the workbench is offline.")),BCt=E("statusBarItem.offlineHoverForeground",ev,m("statusBarOfflineItemHoverForeground","Status bar item foreground hover color when the workbench is offline.")),WCt=E("statusBarItem.offlineHoverBackground",{dark:dc,light:dc,hcDark:dc,hcLight:null},m("statusBarOfflineItemHoverBackground","Status bar item background hover color when the workbench is offline.")),VCt=E("extensionBadge.remoteBackground",uU,m("extensionBadge.remoteBackground","Background color for the remote badge in the extensions view.")),HCt=E("extensionBadge.remoteForeground",pU,m("extensionBadge.remoteForeground","Foreground color for the remote badge in the extensions view.")),hU=E("sideBar.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},m("sideBarBackground","Side bar background color. The side bar is the container for views like explorer and search.")),mU=E("sideBar.foreground",null,m("sideBarForeground","Side bar foreground color. The side bar is the container for views like explorer and search.")),UCt=E("sideBar.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("sideBarBorder","Side bar border color on the side separating to the editor. The side bar is the container for views like explorer and search.")),zCt=E("sideBarTitle.background",hU,m("sideBarTitleBackground","Side bar title background color. The side bar is the container for views like explorer and search.")),KCt=E("sideBarTitle.foreground",mU,m("sideBarTitleForeground","Side bar title foreground color. The side bar is the container for views like explorer and search.")),GCt=E("sideBar.dropBackground",lU,m("sideBarDragAndDropBackground","Drag and drop feedback color for the side bar sections. The color should have transparency so that the side bar sections can still shine through. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),jCt=E("sideBarSectionHeader.background",{dark:V.fromHex("#808080").transparent(.2),light:V.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},m("sideBarSectionHeaderBackground","Side bar section header background color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),qCt=E("sideBarSectionHeader.foreground",mU,m("sideBarSectionHeaderForeground","Side bar section header foreground color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),IK=E("sideBarSectionHeader.border",Ee,m("sideBarSectionHeaderBorder","Side bar section header border color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),$Ct=E("sideBarActivityBarTop.border",IK,m("sideBarActivityBarTopBorder","Border color between the activity bar at the top/bottom and the views.")),YCt=E("sideBarStickyScroll.background",hU,m("sideBarStickyScrollBackground","Background color of sticky scroll in the side bar.")),ZCt=E("sideBarStickyScroll.border",null,m("sideBarStickyScrollBorder","Border color of sticky scroll in the side bar.")),QCt=E("sideBarStickyScroll.shadow",Bd,m("sideBarStickyScrollShadow","Shadow color of sticky scroll in the side bar.")),ja=E("titleBar.activeForeground",{dark:"#CCCCCC",light:"#333333",hcDark:"#FFFFFF",hcLight:"#292929"},m("titleBarActiveForeground","Title bar foreground when the window is active.")),gU=E("titleBar.inactiveForeground",{dark:ye(ja,.6),light:ye(ja,.6),hcDark:null,hcLight:"#292929"},m("titleBarInactiveForeground","Title bar foreground when the window is inactive.")),oU=E("titleBar.activeBackground",{dark:"#3C3C3C",light:"#DDDDDD",hcDark:"#000000",hcLight:"#FFFFFF"},m("titleBarActiveBackground","Title bar background when the window is active.")),XCt=E("titleBar.inactiveBackground",{dark:ye(oU,.6),light:ye(oU,.6),hcDark:null,hcLight:null},m("titleBarInactiveBackground","Title bar background when the window is inactive.")),JCt=E("titleBar.border",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("titleBarBorder","Title bar border color.")),CK=E("menubar.selectionForeground",ja,m("menubarSelectionForeground","Foreground color of the selected menu item in the menubar.")),rU=E("menubar.selectionBackground",{dark:Hf,light:Hf,hcDark:null,hcLight:null},m("menubarSelectionBackground","Background color of the selected menu item in the menubar.")),eSt=E("menubar.selectionBorder",{dark:null,light:null,hcDark:Ot,hcLight:Ot},m("menubarSelectionBorder","Border color of the selected menu item in the menubar.")),tSt=E("commandCenter.foreground",ja,m("commandCenter-foreground","Foreground color of the command center"),!1),nSt=E("commandCenter.activeForeground",CK,m("commandCenter-activeForeground","Active foreground color of the command center"),!1),iSt=E("commandCenter.inactiveForeground",gU,m("commandCenter-inactiveForeground","Foreground color of the command center when the window is inactive"),!1),oSt=E("commandCenter.background",{dark:V.white.transparent(.05),hcDark:null,light:V.black.transparent(.05),hcLight:null},m("commandCenter-background","Background color of the command center"),!1),rSt=E("commandCenter.activeBackground",{dark:V.white.transparent(.08),hcDark:rU,light:V.black.transparent(.08),hcLight:rU},m("commandCenter-activeBackground","Active background color of the command center"),!1),sSt=E("commandCenter.border",{dark:ye(ja,.2),hcDark:Ee,light:ye(ja,.2),hcLight:Ee},m("commandCenter-border","Border color of the command center"),!1),aSt=E("commandCenter.activeBorder",{dark:ye(ja,.3),hcDark:ja,light:ye(ja,.3),hcLight:ja},m("commandCenter-activeBorder","Active border color of the command center"),!1),lSt=E("commandCenter.inactiveBorder",ye(gU,.25),m("commandCenter-inactiveBorder","Border color of the command center when the window is inactive"),!1),dSt=E("notificationCenter.border",{dark:Uf,light:Uf,hcDark:Ee,hcLight:Ee},m("notificationCenterBorder","Notifications center border color. Notifications slide in from the bottom right of the window.")),cSt=E("notificationToast.border",{dark:Uf,light:Uf,hcDark:Ee,hcLight:Ee},m("notificationToastBorder","Notification toast border color. Notifications slide in from the bottom right of the window.")),uSt=E("notifications.foreground",wa,m("notificationsForeground","Notifications foreground color. Notifications slide in from the bottom right of the window.")),_T=E("notifications.background",_i,m("notificationsBackground","Notifications background color. Notifications slide in from the bottom right of the window.")),pSt=E("notificationLink.foreground",cC,m("notificationsLink","Notification links foreground color. Notifications slide in from the bottom right of the window.")),hSt=E("notificationCenterHeader.foreground",null,m("notificationCenterHeaderForeground","Notifications center header foreground color. Notifications slide in from the bottom right of the window.")),SK=E("notificationCenterHeader.background",{dark:Co(_T,.3),light:eo(_T,.05),hcDark:_T,hcLight:_T},m("notificationCenterHeaderBackground","Notifications center header background color. Notifications slide in from the bottom right of the window.")),mSt=E("notifications.border",SK,m("notificationsBorder","Notifications border color separating from other notifications in the notifications center. Notifications slide in from the bottom right of the window.")),gSt=E("notificationsErrorIcon.foreground",ru,m("notificationsErrorIconForeground","The color used for the icon of error notifications. Notifications slide in from the bottom right of the window.")),fSt=E("notificationsWarningIcon.foreground",So,m("notificationsWarningIconForeground","The color used for the icon of warning notifications. Notifications slide in from the bottom right of the window.")),bSt=E("notificationsInfoIcon.foreground",lr,m("notificationsInfoIconForeground","The color used for the icon of info notifications. Notifications slide in from the bottom right of the window.")),vSt=E("window.activeBorder",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("windowActiveBorder","The color used for the border of the window when it is active. Only supported in the macOS and Linux desktop client when using the custom title bar.")),ySt=E("window.inactiveBorder",{dark:null,light:null,hcDark:Ee,hcLight:Ee},m("windowInactiveBorder","The color used for the border of the window when it is inactive. Only supported in the macOS and Linux desktop client when using the custom title bar."));var cc=class extends xT{constructor(t,n,i,r,s,a,l,d,c,u){super(t,n,r,d,a);this.instantiationService=s;this.textResourceConfigurationService=l;this.editorService=c;this.editorGroupService=u;this.viewState=this.getEditorMemento(u,l,i,100)}viewState;groupListener=this._register(new on);editorViewStateDisposables;setEditorVisible(t){this.groupListener.value=this.group.onWillCloseEditor(n=>this.onWillCloseEditor(n)),super.setEditorVisible(t)}onWillCloseEditor(t){let n=t.editor;n===this.input&&this.updateEditorViewState(n)}clearInput(){this.updateEditorViewState(this.input),super.clearInput()}saveState(){this.updateEditorViewState(this.input),super.saveState()}updateEditorViewState(t){if(!t||!this.tracksEditorViewState(t))return;let n=this.toEditorViewStateResource(t);n&&(this.tracksDisposedEditorViewState()||(this.editorViewStateDisposables||(this.editorViewStateDisposables=new Map),this.editorViewStateDisposables.has(t)||this.editorViewStateDisposables.set(t,j.once(t.onWillDispose)(()=>{this.clearEditorViewState(n,this.group),this.editorViewStateDisposables?.delete(t)}))),t.isDisposed()&&!this.tracksDisposedEditorViewState()||!this.shouldRestoreEditorViewState(t)&&!this.group.contains(t)?this.clearEditorViewState(n,this.group):t.isDisposed()||this.saveEditorViewState(n))}shouldRestoreEditorViewState(t,n){return n?.newInGroup?this.textResourceConfigurationService.getValue(Nr.getOriginalUri(t,{supportSideBySide:1}),"workbench.editor.restoreViewState")!==!1:!0}getViewState(){let t=this.input;if(!t||!this.tracksEditorViewState(t))return;let n=this.toEditorViewStateResource(t);if(n)return this.computeEditorViewState(n)}saveEditorViewState(t){let n=this.computeEditorViewState(t);n&&this.viewState.saveEditorState(this.group,t,n)}loadEditorViewState(t,n){if(!t||!this.tracksEditorViewState(t)||!this.shouldRestoreEditorViewState(t,n))return;let i=this.toEditorViewStateResource(t);if(i)return this.viewState.loadEditorState(this.group,i)}moveEditorViewState(t,n,i){return this.viewState.moveEditorState(t,n,i)}clearEditorViewState(t,n){this.viewState.clearEditorState(t,n)}dispose(){if(super.dispose(),this.editorViewStateDisposables){for(let[,t]of this.editorViewStateDisposables)t.dispose();this.editorViewStateDisposables=void 0}}tracksDisposedEditorViewState(){return!1}};cc=P([_(3,Li),_(4,Qe),_(5,uo),_(6,Mr),_(7,Wo),_(8,Vt),_(9,cr)],cc);function TK(o){let e=o;return typeof e?.primary=="object"&&typeof e.secondary=="object"}var Ys=class extends cc{constructor(t,n,i,r,s,a,l,d,c){super(Ys.ID,t,Ys.VIEW_STATE_PREFERENCE_KEY,n,i,s,l,r,d,c);this.configurationService=a;this.registerListeners()}static ID=NW;static SIDE_BY_SIDE_LAYOUT_SETTING="workbench.editor.splitInGroupLayout";static VIEW_STATE_PREFERENCE_KEY="sideBySideEditorViewState";get minimumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.minimumWidth:0}get maximumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.minimumHeight:0}get maximumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}get minimumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumWidth:0}get maximumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumHeight:0}get maximumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}set minimumWidth(t){}set maximumWidth(t){}set minimumHeight(t){}set maximumHeight(t){}get minimumWidth(){return this.minimumPrimaryWidth+this.minimumSecondaryWidth}get maximumWidth(){return this.maximumPrimaryWidth+this.maximumSecondaryWidth}get minimumHeight(){return this.minimumPrimaryHeight+this.minimumSecondaryHeight}get maximumHeight(){return this.maximumPrimaryHeight+this.maximumSecondaryHeight}_boundarySashes;onDidCreateEditors=this._register(new k);_onDidChangeSizeConstraints=this._register(new Yr);onDidChangeSizeConstraints=j.any(this.onDidCreateEditors.event,this._onDidChangeSizeConstraints.event);_onDidChangeSelection=this._register(new k);onDidChangeSelection=this._onDidChangeSelection.event;primaryEditorPane=void 0;secondaryEditorPane=void 0;primaryEditorContainer;secondaryEditorContainer;splitview;splitviewDisposables=this._register(new ne);editorDisposables=this._register(new ne);orientation=this.configurationService.getValue(Ys.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1;dimension=new oo(0,0);lastFocusedSide=void 0;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t.affectsConfiguration(Ys.SIDE_BY_SIDE_LAYOUT_SETTING)&&(this.orientation=this.configurationService.getValue(Ys.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1,this.splitview&&this.recreateSplitview())}recreateSplitview(){let t=pn(this.getContainer()),n=this.getSplitViewRatio();this.splitview&&(this.splitview.el.remove(),this.splitviewDisposables.clear()),this.createSplitView(t,n),this.layout(this.dimension)}getSplitViewRatio(){let t;if(this.splitview){let n=this.splitview.getViewSize(0),i=this.splitview.getViewSize(1);if(Math.abs(n-i)>1){let r=this.splitview.orientation===1?this.dimension.width:this.dimension.height;t=n/r}}return t}createEditor(t){t.classList.add("side-by-side-editor"),this.secondaryEditorContainer=Ke(".side-by-side-editor-container.editor-instance"),this.primaryEditorContainer=Ke(".side-by-side-editor-container.editor-instance"),this.createSplitView(t)}createSplitView(t,n){this.splitview=this.splitviewDisposables.add(new Mu(t,{orientation:this.orientation})),this.splitviewDisposables.add(this.splitview.onDidSashReset(()=>this.splitview?.distributeViewSizes())),this.orientation===1?this.splitview.orthogonalEndSash=this._boundarySashes?.bottom:(this.splitview.orthogonalStartSash=this._boundarySashes?.left,this.splitview.orthogonalEndSash=this._boundarySashes?.right);let i=nc.Distribute,r=nc.Distribute;if(n){let l=this.splitview.orientation===1?this.dimension.width:this.dimension.height;i=Math.round(l*n),r=l-i,this.splitview.layout(this.orientation===1?this.dimension.width:this.dimension.height)}let s=pn(this.secondaryEditorContainer);this.splitview.addView({element:s,layout:l=>this.layoutPane(this.secondaryEditorPane,l),minimumSize:this.orientation===1?ac.width:ac.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:j.None},i);let a=pn(this.primaryEditorContainer);this.splitview.addView({element:a,layout:l=>this.layoutPane(this.primaryEditorPane,l),minimumSize:this.orientation===1?ac.width:ac.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:j.None},r),this.updateStyles()}getTitle(){return this.input?this.input.getName():m("sideBySideEditor","Side by Side Editor")}async setInput(t,n,i,r){let s=this.input;await super.setInput(t,n,i,r),(!s||!t.matches(s))&&(s&&this.disposeEditors(),this.createEditors(t));let{primary:a,secondary:l,viewState:d}=this.loadViewState(t,n,i);if(this.lastFocusedSide=d?.focus,typeof d?.ratio=="number"&&this.splitview){let c=this.splitview.orientation===1?this.dimension.width:this.dimension.height;this.splitview.resizeView(0,Math.round(c*d.ratio))}else this.splitview?.distributeViewSizes();await Promise.all([this.secondaryEditorPane?.setInput(t.secondary,l,i,r),this.primaryEditorPane?.setInput(t.primary,a,i,r)]),typeof n?.target=="number"&&(this.lastFocusedSide=n.target)}loadViewState(t,n,i){let r=TK(n?.viewState)?n?.viewState:this.loadEditorViewState(t,i),s=Object.create(null),a;return n?.target===2?a={...n}:s={...n},s.viewState=r?.primary,r?.secondary&&(a?a.viewState=r?.secondary:a={viewState:r.secondary}),{primary:s,secondary:a,viewState:r}}createEditors(t){this.secondaryEditorPane=this.doCreateEditor(t.secondary,pn(this.secondaryEditorContainer)),this.primaryEditorPane=this.doCreateEditor(t.primary,pn(this.primaryEditorContainer)),this.layout(this.dimension),this._onDidChangeSizeConstraints.input=j.any(j.map(this.secondaryEditorPane.onDidChangeSizeConstraints,()=>{}),j.map(this.primaryEditorPane.onDidChangeSizeConstraints,()=>{})),this.onDidCreateEditors.fire(void 0),this.editorDisposables.add(this.primaryEditorPane.onDidFocus(()=>this.onDidFocusChange(1))),this.editorDisposables.add(this.secondaryEditorPane.onDidFocus(()=>this.onDidFocusChange(2)))}doCreateEditor(t,n){let i=lt.as(Bs.EditorPane).getEditorPane(t);if(!i)throw new Error("No editor pane descriptor for editor found");let r=i.instantiate(this.instantiationService,this.group);return r.create(n),r.setVisible(this.isVisible()),jk(r)&&this.editorDisposables.add(r.onDidChangeSelection(s=>this._onDidChangeSelection.fire(s))),this.editorDisposables.add(r),r}onDidFocusChange(t){this.lastFocusedSide=t,this._onDidChangeControl.fire()}getSelection(){let t=this.getLastFocusedEditorPane();if(jk(t)){let n=t.getSelection();if(n)return new dM(n,t===this.primaryEditorPane?1:2)}}setOptions(t){super.setOptions(t),typeof t?.target=="number"&&(this.lastFocusedSide=t.target),this.getLastFocusedEditorPane()?.setOptions(t)}setEditorVisible(t){this.primaryEditorPane?.setVisible(t),this.secondaryEditorPane?.setVisible(t),super.setEditorVisible(t)}clearInput(){super.clearInput(),this.primaryEditorPane?.clearInput(),this.secondaryEditorPane?.clearInput(),this.disposeEditors()}focus(){super.focus(),this.getLastFocusedEditorPane()?.focus()}getLastFocusedEditorPane(){return this.lastFocusedSide===2?this.secondaryEditorPane:this.primaryEditorPane}layout(t){this.dimension=t,pn(this.splitview).layout(this.orientation===1?t.width:t.height)}setBoundarySashes(t){this._boundarySashes=t,this.splitview&&(this.splitview.orthogonalEndSash=t.bottom)}layoutPane(t,n){t?.layout(this.orientation===1?new oo(n,this.dimension.height):new oo(this.dimension.width,n))}getControl(){return this.getLastFocusedEditorPane()?.getControl()}getPrimaryEditorPane(){return this.primaryEditorPane}getSecondaryEditorPane(){return this.secondaryEditorPane}tracksEditorViewState(t){return t instanceof mi}computeEditorViewState(t){if(!this.input||!Qi(t,this.toEditorViewStateResource(this.input)))return;let n=this.primaryEditorPane?.getViewState(),i=this.secondaryEditorPane?.getViewState();if(!(!n||!i))return{primary:n,secondary:i,focus:this.lastFocusedSide,ratio:this.getSplitViewRatio()}}toEditorViewStateResource(t){let n,i;if(t instanceof mi&&(n=t.primary.resource,i=t.secondary.resource),!(!i||!n))return te.from({scheme:"sideBySide",path:`${zh(i.toString())}${zh(n.toString())}`})}updateStyles(){super.updateStyles(),this.primaryEditorContainer&&(this.orientation===1?(this.primaryEditorContainer.style.borderLeftWidth="1px",this.primaryEditorContainer.style.borderLeftStyle="solid",this.primaryEditorContainer.style.borderLeftColor=this.getColor(cU)??"",this.primaryEditorContainer.style.borderTopWidth="0"):(this.primaryEditorContainer.style.borderTopWidth="1px",this.primaryEditorContainer.style.borderTopStyle="solid",this.primaryEditorContainer.style.borderTopColor=this.getColor(dU)??"",this.primaryEditorContainer.style.borderLeftWidth="0"))}dispose(){this.disposeEditors(),super.dispose()}disposeEditors(){this.editorDisposables.clear(),this.secondaryEditorPane=void 0,this.primaryEditorPane=void 0,this.lastFocusedSide=void 0,this.secondaryEditorContainer&&fi(this.secondaryEditorContainer),this.primaryEditorContainer&&fi(this.primaryEditorContainer)}};Ys=P([_(1,Li),_(2,Qe),_(3,Wo),_(4,uo),_(5,ut),_(6,Mr),_(7,Vt),_(8,cr)],Ys);var dM=class o{constructor(e,t){this.selection=e;this.side=t}compare(e){return e instanceof o?this.side!==e.side?3:this.selection.compare(e.selection):3}restore(e){let t={...e,target:this.side};return this.selection.restore(t)}};var uc=class extends cc{constructor(t,n,i,r,s,a,l,d,c,u){super(t,n,uc.VIEW_STATE_PREFERENCE_KEY,i,r,s,a,l,d,c);this.fileService=u;this._register(this.textResourceConfigurationService.onDidChangeConfiguration(p=>this.handleConfigurationChangeEvent(p))),this._register(j.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{let p=this.computeAriaLabel();this.editorContainer?.setAttribute("aria-label",p),this.updateEditorControlOptions({ariaLabel:p})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(p=>this.onDidChangeFileSystemProvider(p.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(p=>this.onDidChangeFileSystemProvider(p.scheme)))}static VIEW_STATE_PREFERENCE_KEY="textEditorViewState";_onDidChangeSelection=this._register(new k);onDidChangeSelection=this._onDidChangeSelection.event;_onDidChangeScroll=this._register(new k);onDidChangeScroll=this._onDidChangeScroll.event;editorContainer;hasPendingConfigurationChange;lastAppliedEditorOptions;inputListener=this._register(new on);handleConfigurationChangeEvent(t){let n=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(t,n)&&(this.isVisible()?this.updateEditorConfiguration(n):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(t,n){return t.affectsConfiguration(n,"editor")||t.affectsConfiguration(n,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.updateEditorConfiguration(),this.hasPendingConfigurationChange=!1)}computeConfiguration(t){let n=bn(t.editor)?Sd(t.editor):Object.create(null);return Object.assign(n,this.getConfigurationOverrides(t)),n.ariaLabel=this.computeAriaLabel(),n}computeAriaLabel(){return this.input?QH(this.input,void 0,this.group,this.editorGroupService.count):m("editor","Editor")}onDidChangeFileSystemProvider(t){this.input&&this.getActiveResource()?.scheme===t&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(t){this.input===t&&this.updateReadonly(t)}updateReadonly(t){this.updateEditorControlOptions({...this.getReadonlyConfiguration(t.isReadonly())})}getReadonlyConfiguration(t){return{readOnly:!!t,readOnlyMessage:typeof t!="boolean"?t:void 0}}getConfigurationOverrides(t){return{overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0,...this.getReadonlyConfiguration(this.input?.isReadonly()),renderValidationDecorations:t.problems?.visibility!==!1?"on":"off"}}createEditor(t){this.editorContainer=t,this.createEditorControl(t,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let t=this.getMainControl();t&&(this._register(t.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeCursorPosition(n=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(n)}))),this._register(t.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:3}))),this._register(t.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(t){switch(t.source){case"api":return 1;case"code.navigation":return 4;case"code.jump":return 5;default:return 2}}getSelection(){let t=this.getMainControl();if(t){let n=t.getSelection();if(n)return new cM(n)}}async setInput(t,n,i,r){await super.setInput(t,n,i,r),this.inputListener.value=t.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(t)),this.updateEditorConfiguration(),pn(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let t=this.getMainControl();if(!t)throw new Error("Control has not yet been initialized");return{scrollTop:t.getScrollTop()-t.getTopForLineNumber(1),scrollLeft:t.getScrollLeft()}}setScrollPosition(t){let n=this.getMainControl();if(!n)throw new Error("Control has not yet been initialized");n.setScrollTop(t.scrollTop),t.scrollLeft&&n.setScrollLeft(t.scrollLeft)}setEditorVisible(t){t&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(t)}toEditorViewStateResource(t){return t.resource}updateEditorConfiguration(t=this.getActiveResource()){let n;if(t&&(n=this.textResourceConfigurationService.getValue(t)),!n)return;let i=this.computeConfiguration(n),r=i;this.lastAppliedEditorOptions&&(r=hP(this.lastAppliedEditorOptions,r)),Object.keys(r).length>0&&(this.lastAppliedEditorOptions=i,this.updateEditorControlOptions(r))}getActiveResource(){let t=this.getMainControl();if(t){let n=t.getModel();if(n)return n.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}};uc=P([_(2,Li),_(3,Qe),_(4,uo),_(5,Mr),_(6,Wo),_(7,Vt),_(8,cr),_(9,Mn)],uc);var cM=class o{constructor(e){this.textSelection=e}static TEXT_EDITOR_SELECTION_THRESHOLD=10;compare(e){if(!(e instanceof o))return 3;let t=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),n=Math.min(e.textSelection.selectionStartLineNumber,e.textSelection.positionLineNumber);return t===n?1:Math.abs(t-n)<o.TEXT_EDITOR_SELECTION_THRESHOLD?2:3}restore(e){return{...e,selection:this.textSelection,selectionRevealType:1}}log(){return`line: ${this.textSelection.startLineNumber}-${this.textSelection.endLineNumber}, col:  ${this.textSelection.startColumn}-${this.textSelection.endColumn}`}};function uM(o,e,t){let n=!1,i=_K(o);if(pb(i)&&(e.restoreViewState(i),n=!0),o.selection){let r={startLineNumber:o.selection.startLineNumber,startColumn:o.selection.startColumn,endLineNumber:o.selection.endLineNumber??o.selection.startLineNumber,endColumn:o.selection.endColumn??o.selection.startColumn};e.setSelection(r,o.selectionSource??"code.navigation"),o.selectionRevealType===2?e.revealRangeNearTop(r,t):o.selectionRevealType===3?e.revealRangeNearTopIfOutsideViewport(r,t):o.selectionRevealType===1?e.revealRangeInCenterIfOutsideViewport(r,t):e.revealRangeInCenter(r,t),n=!0}return n}function _K(o){if(!o.selection||!o.viewState)return o.viewState;let e=o.viewState;if(e.modified)return e.modified.cursorState=[],e;let t=o.viewState;return t.cursorState&&(t.cursorState=[]),t}var vm=class extends Pd{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}constructor(e,t){super(),this._originalModel=e,this._modifiedModel=t}async resolve(){await Promise.all([this._originalModel?.resolve(),this._modifiedModel?.resolve()])}isResolved(){return!!(this._originalModel?.isResolved()&&this._modifiedModel?.isResolved())}dispose(){super.dispose()}};var ym=class extends vm{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}_textDiffEditorModel=void 0;get textDiffEditorModel(){return this._textDiffEditorModel}constructor(e,t){super(e,t),this._originalModel=e,this._modifiedModel=t,this.updateTextDiffEditorModel()}async resolve(){await super.resolve(),this.updateTextDiffEditorModel()}updateTextDiffEditorModel(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this._textDiffEditorModel?(this._textDiffEditorModel.original=this.originalModel.textEditorModel,this._textDiffEditorModel.modified=this.modifiedModel.textEditorModel):this._textDiffEditorModel={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this._textDiffEditorModel}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this._textDiffEditorModel=void 0,super.dispose()}};var qo=class extends mi{constructor(t,n,i,r,s,a){super(t,n,i,r,a);this.original=i;this.modified=r;this.forceOpenAsBinary=s}static ID="workbench.editors.diffEditorInput";get typeId(){return qo.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let t=super.capabilities;return this.labels.forceDescription&&(t|=64),t}cachedModel=void 0;labels=this.computeLabels();computeLabels(){let t,n=!1;if(this.preferredName)t=this.preferredName;else{let u=this.original.getName(),p=this.modified.getName();t=m("sideBySideLabels","{0} \u2194 {1}",u,p),n=u===p}let i,r,s;if(this.preferredDescription)i=this.preferredDescription,r=this.preferredDescription,s=this.preferredDescription;else{i=this.computeLabel(this.original.getDescription(0),this.modified.getDescription(0)),s=this.computeLabel(this.original.getDescription(2),this.modified.getDescription(2));let u=this.original.getDescription(1),p=this.modified.getDescription(1);if(typeof u=="string"&&typeof p=="string"&&(u||p)){let[h,f]=hW([u,p]);r=this.computeLabel(h,f)}}let a=this.computeLabel(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),l=this.computeLabel(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),d=this.computeLabel(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 "),c=this.getPreferredTitle();return c&&(a=`${c} (${a})`,l=`${c} (${l})`,d=`${c} (${d})`),{name:t,shortDescription:i,mediumDescription:r,longDescription:s,forceDescription:n,shortTitle:a,mediumTitle:l,longTitle:d}}computeLabel(t,n,i=" - "){if(!(!t||!n))return t===n?n:`${t}${i}${n}`}getName(){return this.labels.name}getDescription(t=1){switch(t){case 0:return this.labels.shortDescription;case 2:return this.labels.longDescription;case 1:default:return this.labels.mediumDescription}}getTitle(t){switch(t){case 0:return this.labels.shortTitle;case 2:return this.labels.longTitle;default:case 1:return this.labels.mediumTitle}}async resolve(){let t=await this.createModel();return this.cachedModel?.dispose(),this.cachedModel=t,this.cachedModel}prefersEditorPane(t){return this.forceOpenAsBinary?t.find(n=>n.typeId===AW):t.find(n=>n.typeId===cS)}async createModel(){let[t,n]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return n instanceof Ns&&t instanceof Ns?new ym(t,n):new vm(l0(t)?t:void 0,l0(n)?n:void 0)}toUntyped(t){let n=super.toUntyped(t);if(n)return{...n,modified:n.primary,original:n.secondary}}matches(t){return this===t?!0:t instanceof qo?this.modified.matches(t.modified)&&this.original.matches(t.original)&&t.forceOpenAsBinary===this.forceOpenAsBinary:Fs(t)?this.modified.matches(t.modified)&&this.original.matches(t.original):!1}dispose(){this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=void 0),super.dispose()}};qo=P([_(5,Vt)],qo);var qa=Q("codeEditorService");var Uu=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let t of e){let n=t.kbExpr;this.precondition&&(n?n=Ct.and(n,this.precondition):n=this.precondition);let i={id:this.id,weight:t.weight,args:t.args,when:n,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Na.registerKeybindingRule(i)}}ir.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){Ar.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}},tv=class extends Uu{_implementations=[];addImplementation(e,t,n,i){return this._implementations.push({priority:e,name:t,implementation:n,when:i}),this._implementations.sort((r,s)=>s.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===n){this._implementations.splice(r,1);return}}}}runCommand(e,t){let n=e.get(gi),i=e.get(St);n.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let r of this._implementations){if(r.when){let a=i.getContext(xo());if(!r.when.evaluate(a))continue}let s=r.implementation(e,t);if(s)return n.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof s=="boolean"?void 0:s}n.trace(`The Command '${this.id}' was not handled by any implementation.`)}},DT=class extends Uu{constructor(t,n){super(n);this.command=t}runCommand(t,n){return this.command.runCommand(t,n)}},nv=class o extends Uu{static bindToContribution(e){return class extends o{_callback;constructor(n){super(n),this._callback=n.handler}runEditorCommand(n,i,r){let s=e(i);s&&this._callback(s,r)}}}static runEditorCommand(e,t,n,i){let r=e.get(qa),s=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(St).contextMatchesRules(n??void 0))return i(a,s,t)})}runCommand(e,t){return o.runEditorCommand(e,t,this.precondition,(n,i,r)=>this.runEditorCommand(n,i,r))}};function Ge(o){return $a.INSTANCE.registerEditorCommand(o),o}function fU(o,e,t){$a.INSTANCE.registerEditorContribution(o,e,t)}var zu;(r=>{function o(s){return $a.INSTANCE.getEditorCommand(s)}r.getEditorCommand=o;function e(){return $a.INSTANCE.getEditorActions()}r.getEditorActions=e;function t(){return $a.INSTANCE.getEditorContributions()}r.getEditorContributions=t;function n(s){return $a.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}r.getSomeEditorContributions=n;function i(){return $a.INSTANCE.getDiffEditorContributions()}r.getDiffEditorContributions=i})(zu||={});var LK={EditorCommonContributions:"editor.contributions"},$a=class o{static INSTANCE=new o;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(e,t,n){this.editorContributions.push({id:e,ctor:t,instantiation:n})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(e,t){this.diffEditorContributions.push({id:e,ctor:t})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};lt.add(LK.EditorCommonContributions,$a.INSTANCE);function iv(o){return o.register(),o}var hM=iv(new tv({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:Gt.MenubarEditMenu,group:"1_do",title:m({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:Gt.CommandPalette,group:"",title:m("undo","Undo"),order:1}]}));iv(new DT(hM,{id:"default:undo",precondition:void 0}));var mM=iv(new tv({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:Gt.MenubarEditMenu,group:"1_do",title:m({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:Gt.CommandPalette,group:"",title:m("redo","Redo"),order:1}]}));iv(new DT(mM,{id:"default:redo",precondition:void 0}));var bU=iv(new tv({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:Gt.MenubarSelectionMenu,group:"1_basic",title:m({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:Gt.CommandPalette,group:"",title:m("selectAll","Select All"),order:1}]}));var kT=class o{constructor(e,t,n,i,r){this._initialScrollTop=e;this._initialContentHeight=t;this._visiblePosition=n;this._visiblePositionScrollDelta=i;this._cursorPosition=r}static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new o(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,n=0,i=e.getVisibleRanges();if(i.length>0){t=i[0].getStartPosition();let r=e.getTopForPosition(t.lineNumber,t.column);n=e.getScrollTop()-r}return new o(e.getScrollTop(),e.getContentHeight(),t,n,e.getPosition())}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){let t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;let t=e.getPosition();if(!this._cursorPosition||!t)return;let n=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+n,1)}};var vU=Q("markerDecorationsService");var Im=class{static ID="editor.contrib.markerDecorations";constructor(e,t){}dispose(){}};Im=P([_(1,vU)],Im);fU(Im.ID,Im,0);var jl;(x=>{let o={total:0,min:Number.MAX_VALUE,max:0},e={...o},t={...o},n={...o},i=0,r;(K=>(K[K.Before=0]="Before",K[K.InProgress=1]="InProgress",K[K.Finished=2]="Finished"))(r||={});let s={keydown:0,input:0,render:0};function a(){v(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}x.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,b()}x.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(u)}x.onInput=c;function u(){s.input===1&&(performance.mark("input/end"),s.input=2)}function p(){v()}x.onKeyUp=p;function h(){v()}x.onSelectionChange=h;function f(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(g),b())}x.onRenderStart=f;function g(){s.render===1&&(performance.mark("render/end"),s.render=2)}function b(){setTimeout(v)}function v(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),I("keydown",o),I("input",e),I("render",t),I("inputlatency",n),i++,T())}function I(D,O){let H=performance.getEntriesByName(D)[0].duration;O.total+=H,O.min=Math.min(O.min,H),O.max=Math.max(O.max,H)}function T(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function S(){if(i===0)return;let D={keydown:C(o),input:C(e),render:C(t),total:C(n),sampleCount:i};return w(o),w(e),w(t),w(n),i=0,D}x.getAndClearMeasurements=S;function C(D){return{average:D.total/i,max:D.max,min:D.min}}function w(D){D.total=0,D.min=Number.MAX_VALUE,D.max=0}})(jl||={});var pc=class{constructor(e,t){this.x=e;this.y=t}_pageCoordinatesBrand=void 0;toClientCoordinates(e){return new ov(this.x-e.scrollX,this.y-e.scrollY)}},ov=class{constructor(e,t){this.clientX=e;this.clientY=t}_clientCoordinatesBrand=void 0;toPageCoordinates(e){return new pc(this.clientX+e.scrollX,this.clientY+e.scrollY)}},gM=class{constructor(e,t,n,i){this.x=e;this.y=t;this.width=n;this.height=i}_editorPagePositionBrand=void 0},fM=class{constructor(e,t){this.x=e;this.y=t}_positionRelativeToEditorBrand=void 0};function NT(o){let e=ro(o);return new gM(e.left,e.top,e.width,e.height)}function AT(o,e,t){let n=e.width/o.offsetWidth,i=e.height/o.offsetHeight,r=(t.x-e.x)/n,s=(t.y-e.y)/i;return new fM(r,s)}var ds=class extends qi{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(e,t,n){super(Ce(n),e),this.isFromPointerCapture=t,this.pos=new pc(this.posx,this.posy),this.editorPos=NT(n),this.relativePos=AT(n,this.editorPos,this.pos)}},RT=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new ds(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return q(e,"contextmenu",n=>{t(this._create(n))})}onMouseUp(e,t){return q(e,"mouseup",n=>{t(this._create(n))})}onMouseDown(e,t){return q(e,he.MOUSE_DOWN,n=>{t(this._create(n))})}onPointerDown(e,t){return q(e,he.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onMouseLeave(e,t){return q(e,he.MOUSE_LEAVE,n=>{t(this._create(n))})}onMouseMove(e,t){return q(e,"mousemove",n=>t(this._create(n)))}},MT=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new ds(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return q(e,"pointerup",n=>{t(this._create(n))})}onPointerDown(e,t){return q(e,he.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onPointerLeave(e,t){return q(e,he.POINTER_LEAVE,n=>{t(this._create(n))})}onPointerMove(e,t){return q(e,"pointermove",n=>t(this._create(n)))}},OT=class extends F{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new Ba),this._keydownListener=null}startMonitoring(e,t,n,i,r){this._keydownListener=hn(e.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,n,s=>{i(new ds(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),r(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var PT=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(e,t,n,i){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=n,this._model=i,this.visibleRange=new M(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var bM=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let n=this._viewLayout.getCurrentViewport();this.scrollTop=n.top,this.scrollLeft=n.left,this.viewportWidth=n.width,this.viewportHeight=n.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},FT=class extends bM{_renderingContextBrand=void 0;_viewLines;constructor(e,t,n){super(e,t),this._viewLines=n}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}},BT=class{constructor(e,t,n,i){this.outsideRenderedLine=e;this.lineNumber=t;this.ranges=n;this.continuesOnNextLine=i}static firstLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber<t.lineNumber)&&(t=n);return t}static lastLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber>t.lineNumber)&&(t=n);return t}},Cm=class o{_horizontalRangeBrand=void 0;left;width;static from(e){let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=new o(r.left,r.width)}return t}constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}},Zs=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}},WT=class{outsideRenderedLine;left;originalLeft;constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}},rv=class{constructor(e,t){this.outsideRenderedLine=e;this.ranges=t}};var VT=class{configuration;viewModel;viewLayout;theme;constructor(e,t,n){this.configuration=e,this.theme=new PS(t),this.viewModel=n,this.viewLayout=n.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}};var qt=class extends ls{_context;constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var ei=class{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let n=[],i=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(n[i++]=this.read(e)),e=e.parentElement;let r=new Uint8Array(i);for(let s=0;s<i;s++)r[s]=n[i-s-1];return r}};function hc(o,e){let t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(o,e)}catch(n){je(n);return}try{return globalThis.trustedTypes?.createPolicy(o,e)}catch(n){je(n);return}}var sv=class{constructor(e){this._lineFactory=e;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new $e("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;let n=this.getStartLineNumber(),i=this.getEndLineNumber();if(t<n){let l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>i)return null;let r=0,s=0;for(let l=n;l<=i;l++){let d=l-this._rendLineNumberStart;e<=l&&l<=t&&(s===0?(r=d,s=1):s++)}if(e<n){let l=0;t<n?l=t-e+1:l=n-e,this._rendLineNumberStart-=l}return this._lines.splice(r,s)}onLinesChanged(e,t){let n=e+t-1;if(this.getCount()===0)return!1;let i=this.getStartLineNumber(),r=this.getEndLineNumber(),s=!1;for(let a=e;a<=n;a++)a>=i&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;let n=t-e+1,i=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=i)return this._rendLineNumberStart+=n,null;if(e>r)return null;if(n+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);let s=[];for(let u=0;u<n;u++)s[u]=this._lineFactory.createLine();let a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-n),c=this._lines.slice(this._lines.length-n,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(e){if(this.getCount()===0)return!1;let t=this.getStartLineNumber(),n=this.getEndLineNumber(),i=!1;for(let r=0,s=e.length;r<s;r++){let a=e[r];if(a.toLineNumber<t||a.fromLineNumber>n)continue;let l=Math.max(t,a.fromLineNumber),d=Math.min(n,a.toLineNumber);for(let c=l;c<=d;c++){let u=c-this._rendLineNumberStart;this._lines[u].onTokensChanged(),i=!0}}return i}},Sm=class{constructor(e){this._lineFactory=e}domNode=this._createDomNode();_linesCollection=new sv(this._lineFactory);_createDomNode(){let e=We(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(147)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),n=new vM(this.domNode.domNode,this._lineFactory,e),i={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=n.render(i,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}},vM=class o{constructor(e,t,n){this._domNode=e;this._lineFactory=t;this._viewportData=n}static _ttPolicy=hc("editorViewLayer",{createHTML:e=>e});render(e,t,n,i){let r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||n<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=n-t+1,r.lines=[];for(let s=t;s<=n;s++)r.lines[s-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,i),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(n-r.rendLineNumberStart,r.linesLength-1),i,t),r.rendLineNumberStart>t){let s=t,a=Math.min(n,r.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart<t){let s=Math.min(r.linesLength,t-r.rendLineNumberStart);s>0&&(this._removeLinesBefore(r,s),r.linesLength-=s)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<n){let s=r.rendLineNumberStart+r.linesLength,a=n;s<=a&&(this._insertLinesAfter(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart+r.linesLength-1>n){let s=Math.max(0,n-r.rendLineNumberStart+1),l=r.linesLength-1-s+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,i),r}_renderUntouchedLines(e,t,n,i,r){let s=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=n;l++){let d=s+l;a[l].layoutLine(d,i[d-r],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let n=0;n<t;n++)e.lines[n].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){let n=e.linesLength-t;for(let i=0;i<t;i++)e.lines[n+i].getDomNode()?.remove();e.lines.splice(n,t)}_finishRenderingNewLines(e,t,n,i){o._ttPolicy&&(n=o._ttPolicy.createHTML(n));let r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=n:r.insertAdjacentHTML("afterend",n);let s=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){let l=e.lines[a];i[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,n){let i=document.createElement("div");o._ttPolicy&&(t=o._ttPolicy.createHTML(t)),i.innerHTML=t;for(let r=0;r<e.linesLength;r++){let s=e.lines[r];if(n[r]){let a=i.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new va(1e5);_finishRendering(e,t,n){let i=o._sb,r=e.linesLength,s=e.lines,a=e.rendLineNumberStart,l=[];{i.reset();let d=!1;for(let c=0;c<r;c++){let u=s[c];l[c]=!1,!(u.getDomNode()||!u.renderLine(c+a,n[c],this._viewportData.lineHeight,this._viewportData,i))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,i.build(),l)}{i.reset();let d=!1,c=[];for(let u=0;u<r;u++){let p=s[u];c[u]=!1,!(l[u]||!p.renderLine(u+a,n[u],this._viewportData.lineHeight,this._viewportData,i))&&(c[u]=!0,d=!0)}d&&this._finishRenderingInvalidLines(e,i.build(),c)}}};var Em=class{constructor(e,t){this._domNode=e;this.endNode=t}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var Ku=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,n,i,r){let s=this._createRange();try{return s.setStart(e,t),s.setEnd(n,i),s.getClientRects()}catch{return null}finally{this._detachRange(s,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Zs.compare);let t=[],n=0,i=e[0];for(let r=1,s=e.length;r<s;r++){let a=e[r];i.left+i.width+.9>=a.left?i.width=Math.max(i.width,a.left+a.width-i.left):(t[n++]=i,i=a)}return t[n++]=i,t}static _createHorizontalRangesFromClientRects(e,t,n){if(!e||e.length===0)return null;let i=[];for(let r=0,s=e.length;r<s;r++){let a=e[r];i[r]=new Zs(Math.max(0,(a.left-t)/n),a.width/n)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,n,i,r,s){let l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),i=Math.min(l,Math.max(0,i)),t===i&&n===r&&n===0&&!e.children[t].firstChild){let p=e.children[t].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(p,s.clientRectDeltaLeft,s.clientRectScale)}t!==i&&i>0&&r===0&&(i--,r=1073741824);let d=e.children[t].firstChild,c=e.children[i].firstChild;if((!d||!c)&&(!d&&n===0&&t>0&&(d=e.children[t-1].firstChild,n=1073741824),!c&&r===0&&i>0&&(c=e.children[i-1].firstChild,r=1073741824)),!d||!c)return null;n=Math.min(d.textContent.length,Math.max(0,n)),r=Math.min(c.textContent.length,Math.max(0,r));let u=this._readClientRects(d,n,c,r,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,s.clientRectDeltaLeft,s.clientRectScale)}};var wn=class{constructor(e,t,n,i){this.endIndex=e;this.type=t;this.metadata=n;this.containsRTL=i}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var cs=class o{constructor(e,t,n,i){this.startColumn=e;this.endColumn=t;this.className=n;this.type=i}_lineDecorationBrand=void 0;static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!o._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,n){if(e.length===0)return e;let i=t+1,r=n+1,s=n-t,a=[],l=0;for(let d of e)d.endColumn<=i||d.startColumn>=r||(a[l++]=new o(Math.max(1,d.startColumn-i+1),Math.min(s+1,d.endColumn-i+1),d.className,d.type));return a}static filter(e,t,n,i){if(e.length===0)return[];let r=[],s=0;for(let a=0,l=e.length;a<l;a++){let d=e[a],c=d.range;if(c.endLineNumber<t||c.startLineNumber>t||c.isEmpty()&&(d.type===0||d.type===3))continue;let u=c.startLineNumber===t?c.startColumn:n,p=c.endLineNumber===t?c.endColumn:i;r[s++]=new o(u,p,d.inlineClassName,d.type)}return r}static _typeCompare(e,t){let n=[2,0,1,3];return n[e]-n[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;let n=o._typeCompare(e.type,t.type);return n!==0?n:e.className!==t.className?e.className<t.className?-1:1:0}},HT=class{startOffset;endOffset;className;metadata;constructor(e,t,n,i){this.startOffset=e,this.endOffset=t,this.className=n,this.metadata=i}},yM=class o{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let n=0,i=e.length;n<i;n++)t|=e[n];return t}consumeLowerThan(e,t,n){for(;this.count>0&&this.stopOffsets[0]<e;){let i=0;for(;i+1<this.count&&this.stopOffsets[i]===this.stopOffsets[i+1];)i++;n.push(new HT(t,this.stopOffsets[i],this.classNames.join(" "),o._metadata(this.metadata))),t=this.stopOffsets[i]+1,this.stopOffsets.splice(0,i+1),this.classNames.splice(0,i+1),this.metadata.splice(0,i+1),this.count-=i+1}return this.count>0&&t<e&&(n.push(new HT(t,e-1,this.classNames.join(" "),o._metadata(this.metadata))),t=e),t}insert(e,t,n){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(n);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t),this.metadata.splice(i,0,n);break}this.count++}},UT=class{static normalize(e,t){if(t.length===0)return[];let n=[],i=new yM,r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.startColumn,c=l.endColumn,u=l.className,p=l.type===1?2:l.type===2?4:0;if(d>1){let g=e.charCodeAt(d-2);rn(g)&&d--}if(c>1){let g=e.charCodeAt(c-2);rn(g)&&c--}let h=d-1,f=c-2;r=i.consumeLowerThan(h,r,n),i.count===0&&(r=h),i.insert(f,u,p)}return i.consumeLowerThan(1073741824,r,n),n}};var Tm=class{startOffset;endOffset;constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}},mc=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(e,t,n,i,r,s,a,l,d,c,u,p,h,f,g,b,v,I,T){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.continuesWithWrappedLine=i,this.isBasicASCII=r,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(cs.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=p,this.stopRenderingLineAfter=g,this.renderWhitespace=b==="all"?4:b==="boundary"?1:b==="selection"?2:b==="trailing"?3:0,this.renderControlCharacters=v,this.fontLigatures=I,this.selectionsOnLine=T&&T.sort((w,x)=>w.startOffset<x.startOffset?-1:1);let S=Math.abs(f-p),C=Math.abs(h-p);S<C?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=h,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&cs.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}};var av=class{constructor(e,t){this.partIndex=e;this.charIndex=t}},lv=class o{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}length;_data;_horizontalOffset;constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,n,i){let r=(t<<16|n<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=i}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){let t=this.charOffsetToPartData(e-1),n=o.getPartIndex(t),i=o.getCharIndex(t);return new av(n,i)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,n){if(this.length===0)return 0;let i=(e<<16|n<<0)>>>0,r=0,s=this.length-1;for(;r+1<s;){let g=r+s>>>1,b=this._data[g];if(b===i)return g;b>i?s=g:r=g}if(r===s)return r;let a=this._data[r],l=this._data[s];if(a===i)return r;if(l===i)return s;let d=o.getPartIndex(a),c=o.getCharIndex(a),u=o.getPartIndex(l),p;d!==u?p=t:p=o.getCharIndex(l);let h=n-c,f=p-n;return h<=f?r:s}inflate(){let e=[];for(let t=0;t<this.length;t++){let n=this._data[t],i=o.getPartIndex(n),r=o.getCharIndex(n),s=this._horizontalOffset[t];e.push([i,r,s])}return e}};var dv=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(e,t,n){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=n}};function cv(o,e){if(o.lineContent.length===0){if(o.lineDecorations.length>0){e.appendString("<span>");let t=0,n=0,i=0;for(let s of o.lineDecorations)(s.type===1||s.type===2)&&(e.appendString('<span class="'),e.appendString(s.className),e.appendString('"></span>'),s.type===1&&(i|=1,t++),s.type===2&&(i|=2,n++));e.appendString("</span>");let r=new lv(1,t+n);return r.setColumnInfo(1,t,0,0),new dv(r,!1,i)}return e.appendString("<span><span></span></span>"),new dv(new lv(0,0),!1,0)}return FK(RK(o),e)}var IM=class{constructor(e,t,n,i){this.characterMapping=e;this.html=t;this.containsRTL=n;this.containsForeignElements=i}};function yU(o){let e=new va(1e4),t=cv(o,e);return new IM(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}var CM=class{constructor(e,t,n,i,r,s,a,l,d,c,u,p,h,f,g,b){this.fontIsMonospace=e;this.canUseHalfwidthRightwardsArrow=t;this.lineContent=n;this.len=i;this.isOverflowing=r;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=u;this.containsRTL=p;this.spaceWidth=h;this.renderSpaceCharCode=f;this.renderWhitespace=g;this.renderControlCharacters=b}};function RK(o){let e=o.lineContent,t,n,i;o.stopRenderingLineAfter!==-1&&o.stopRenderingLineAfter<e.length?(t=!0,n=e.length-o.stopRenderingLineAfter,i=o.stopRenderingLineAfter):(t=!1,n=0,i=e.length);let r=MK(e,o.containsRTL,o.lineTokens,o.fauxIndentLength,i);o.renderControlCharacters&&!o.isBasicASCII&&(r=NK(e,r)),(o.renderWhitespace===4||o.renderWhitespace===1||o.renderWhitespace===2&&o.selectionsOnLine||o.renderWhitespace===3&&!o.continuesWithWrappedLine)&&(r=AK(o,e,i,r));let s=0;if(o.lineDecorations.length>0){for(let a=0,l=o.lineDecorations.length;a<l;a++){let d=o.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}r=PK(e,i,r,o.lineDecorations)}return o.containsRTL||(r=OK(e,r,!o.isBasicASCII||o.fontLigatures)),new CM(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,e,i,t,n,r,s,o.fauxIndentLength,o.tabSize,o.startVisibleColumn,o.containsRTL,o.spaceWidth,o.renderSpaceCharCode,o.renderWhitespace,o.renderControlCharacters)}function MK(o,e,t,n,i){let r=[],s=0;n>0&&(r[s++]=new wn(n,"",0,!1));let a=n;for(let l=0,d=t.getCount();l<d;l++){let c=t.getEndOffset(l);if(c<=n)continue;let u=t.getClassName(l);if(c>=i){let h=e?ml(o.substring(a,i)):!1;r[s++]=new wn(i,u,0,h);break}let p=e?ml(o.substring(a,c)):!1;r[s++]=new wn(c,u,0,p),a=c}return r}function OK(o,e,t){let n=0,i=[],r=0;if(t)for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex;if(n+50<d){let c=l.type,u=l.metadata,p=l.containsRTL,h=-1,f=n;for(let g=n;g<d;g++)o.charCodeAt(g)===32&&(h=g),h!==-1&&g-f>=50&&(i[r++]=new wn(h+1,c,u,p),f=h+1,h=-1);f!==d&&(i[r++]=new wn(d,c,u,p))}else i[r++]=l;n=d}else for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex,c=d-n;if(c>50){let u=l.type,p=l.metadata,h=l.containsRTL,f=Math.ceil(c/50);for(let g=1;g<f;g++){let b=n+g*50;i[r++]=new wn(b,u,p,h)}i[r++]=new wn(d,u,p,h)}else i[r++]=l;n=d}return i}function IU(o){return o<32?o!==9:o===127||o>=8234&&o<=8238||o>=8294&&o<=8297||o>=8206&&o<=8207||o===1564}function NK(o,e){let t=[],n=new wn(0,"",0,!1),i=0;for(let r of e){let s=r.endIndex;for(;i<s;i++){let a=o.charCodeAt(i);IU(a)&&(i>n.endIndex&&(n=new wn(i,r.type,r.metadata,r.containsRTL),t.push(n)),n=new wn(i+1,"mtkcontrol",r.metadata,!1),t.push(n))}i>n.endIndex&&(n=new wn(s,r.type,r.metadata,r.containsRTL),t.push(n))}return t}function AK(o,e,t,n){let i=o.continuesWithWrappedLine,r=o.fauxIndentLength,s=o.tabSize,a=o.startVisibleColumn,l=o.useMonospaceOptimizations,d=o.selectionsOnLine,c=o.renderWhitespace===1,u=o.renderWhitespace===3,p=o.renderSpaceWidth!==o.spaceWidth,h=[],f=0,g=0,b=n[g].type,v=n[g].containsRTL,I=n[g].endIndex,T=n.length,S=!1,C=fn(e),w;C===-1?(S=!0,C=t,w=t):w=_r(e);let x=!1,D=0,O=d&&d[D],H=a%s;for(let z=r;z<t;z++){let ie=e.charCodeAt(z);O&&z>=O.endOffset&&(D++,O=d&&d[D]);let Se;if(z<C||z>w)Se=!0;else if(ie===9)Se=!0;else if(ie===32)if(c)if(x)Se=!0;else{let J=z+1<t?e.charCodeAt(z+1):0;Se=J===32||J===9}else Se=!0;else Se=!1;if(Se&&d&&(Se=!!O&&O.startOffset<=z&&O.endOffset>z),Se&&u&&(Se=S||z>w),Se&&v&&z>=C&&z<=w&&(Se=!1),x){if(!Se||!l&&H>=s){if(p){let J=f>0?h[f-1].endIndex:r;for(let X=J+1;X<=z;X++)h[f++]=new wn(X,"mtkw",1,!1)}else h[f++]=new wn(z,"mtkw",1,!1);H=H%s}}else(z===I||Se&&z>r)&&(h[f++]=new wn(z,b,0,v),H=H%s);for(ie===9?H=s:Dr(ie)?H+=2:H++,x=Se;z===I&&(g++,g<T);)b=n[g].type,v=n[g].containsRTL,I=n[g].endIndex}let K=!1;if(x)if(i&&c){let z=t>0?e.charCodeAt(t-1):0,ie=t>1?e.charCodeAt(t-2):0;z===32&&ie!==32&&ie!==9||(K=!0)}else K=!0;if(K)if(p){let z=f>0?h[f-1].endIndex:r;for(let ie=z+1;ie<=t;ie++)h[f++]=new wn(ie,"mtkw",1,!1)}else h[f++]=new wn(t,"mtkw",1,!1);else h[f++]=new wn(t,b,0,v);return h}function PK(o,e,t,n){n.sort(cs.compare);let i=UT.normalize(o,n),r=i.length,s=0,a=[],l=0,d=0;for(let u=0,p=t.length;u<p;u++){let h=t[u],f=h.endIndex,g=h.type,b=h.metadata,v=h.containsRTL;for(;s<r&&i[s].startOffset<f;){let I=i[s];if(I.startOffset>d&&(d=I.startOffset,a[l++]=new wn(d,g,b,v)),I.endOffset+1<=f)d=I.endOffset+1,a[l++]=new wn(d,g+" "+I.className,b|I.metadata,v),s++;else{d=f,a[l++]=new wn(d,g+" "+I.className,b|I.metadata,v);break}}f>d&&(d=f,a[l++]=new wn(d,g,b,v))}let c=t[t.length-1].endIndex;if(s<r&&i[s].startOffset===c)for(;s<r&&i[s].startOffset===c;){let u=i[s];a[l++]=new wn(d,u.className,u.metadata,!1),s++}return a}function FK(o,e){let t=o.fontIsMonospace,n=o.canUseHalfwidthRightwardsArrow,i=o.containsForeignElements,r=o.lineContent,s=o.len,a=o.isOverflowing,l=o.overflowingCharCount,d=o.parts,c=o.fauxIndentLength,u=o.tabSize,p=o.startVisibleColumn,h=o.containsRTL,f=o.spaceWidth,g=o.renderSpaceCharCode,b=o.renderWhitespace,v=o.renderControlCharacters,I=new lv(s+1,d.length),T=!1,S=0,C=p,w=0,x=0,D=0;h?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let O=0,H=d.length;O<H;O++){let K=d[O],z=K.endIndex,ie=K.type,Se=K.containsRTL,J=b!==0&&K.isWhitespace(),X=J&&!t&&(ie==="mtkw"||!i),le=S===z&&K.isPseudoAfter();if(w=0,e.appendString("<span "),Se&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(X?"mtkz":ie),e.appendASCIICharCode(34),J){let re=0;{let ee=S,Te=C;for(;ee<z;ee++){let Ze=(r.charCodeAt(ee)===9?u-Te%u:1)|0;re+=Ze,ee>=c&&(Te+=Ze)}}for(X&&(e.appendString(' style="width:'),e.appendString(String(f*re)),e.appendString('px"')),e.appendASCIICharCode(62);S<z;S++){I.setColumnInfo(S+1,O-D,w,x),D=0;let ee=r.charCodeAt(S),Te,ce;if(ee===9){Te=u-C%u|0,ce=Te,!n||ce>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let Ze=2;Ze<=ce;Ze++)e.appendCharCode(160)}else Te=2,ce=1,e.appendCharCode(g),e.appendCharCode(8204);w+=Te,x+=ce,S>=c&&(C+=ce)}}else for(e.appendASCIICharCode(62);S<z;S++){I.setColumnInfo(S+1,O-D,w,x),D=0;let re=r.charCodeAt(S),ee=1,Te=1;switch(re){case 9:ee=u-C%u,Te=ee;for(let ce=1;ce<=ee;ce++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:v?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Dr(re)&&Te++,v&&re<32?e.appendCharCode(9216+re):v&&re===127?e.appendCharCode(9249):v&&IU(re)?(e.appendString("[U+"),e.appendString(BK(re)),e.appendString("]"),ee=8,Te=ee):e.appendCharCode(re)}w+=ee,x+=Te,S>=c&&(C+=Te)}le?D++:D=0,S>=s&&!T&&K.isPseudoAfter()&&(T=!0,I.setColumnInfo(S+1,O,w,x)),e.appendString("</span>")}return T||I.setColumnInfo(s+1,d.length-1,w,x),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(m("showMore","Show more ({0})",WK(l))),e.appendString("</span>")),e.appendString("</span>"),new dv(I,h,i)}function BK(o){return o.toString(16).toUpperCase().padStart(4,"0")}function WK(o){return o<1024?m("overflow.chars","{0} chars",o):o<1024*1024?`${(o/1024).toFixed(1)} KB`:`${(o/1024/1024).toFixed(1)} MB`}var VK=function(){return aa?!0:!(Wt||Vn||Ko)}(),xm=!0,uv=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(e,t){this.themeType=t;let n=e.options,i=n.get(51);n.get(39)==="off"?this.renderWhitespace=n.get(101):this.renderWhitespace="none",this.renderControlCharacters=n.get(96),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.useMonospaceOptimizations=i.isMonospace&&!n.get(33),this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=n.get(68),this.stopRenderingLineAfter=n.get(119),this.fontLigatures=n.get(52)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}},Qs=class o{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=We(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return Fd(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,n,i,r){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=i.getViewLineRenderingData(e),a=this._options,l=cs.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn),d=null;if(Fd(a.themeType)||this._options.renderWhitespace==="selection"){let h=i.selections;for(let f of h){if(f.endLineNumber<e||f.startLineNumber>e)continue;let g=f.startLineNumber===e?f.startColumn:s.minColumn,b=f.endLineNumber===e?f.endColumn:s.maxColumn;g<b&&(Fd(a.themeType)&&l.push(new cs(g,b,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new Tm(g-1,b-1))))}}let c=new mc(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==ws.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;" class="'),r.appendString(o.CLASS_NAME),r.appendString('">');let u=cv(c,r);r.appendString("</div>");let p=null;return xm&&VK&&s.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(p=new wm(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),p||(p=CU(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=p,!0}layoutLine(e,t,n){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(n))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof wm:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof wm?this._renderedViewLine.monospaceAssumptionsAreValid():xm}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof wm&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,n,i){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),n=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,n));let r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&n>r+1)return new rv(!0,[new Zs(this.getWidth(i),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&n>r+1&&(n=r+1);let s=this._renderedViewLine.getVisibleRangesForRange(e,t,n,i);return s&&s.length>0?new rv(!1,s):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};var wm=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(e,t,n){this.domNode=e,this.input=t;let i=Math.floor(t.lineContent.length/300);if(i>0){this._keyColumnPixelOffsetCache=new Float32Array(i);for(let r=0;r<i;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=n,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){let t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return xm;if(this.input.lineContent.length<300){let e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),xm=!1)}return xm}toSlowRenderedLine(){return CU(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,n,i){let r=this._getColumnPixelOffset(e,t,i),s=this._getColumnPixelOffset(e,n,i);return[new Zs(r,s-r)]}_getColumnPixelOffset(e,t,n){if(t<=300){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let i=Math.floor((t-1)/300)-1,r=(i+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[i],s===-1&&(s=this._actualReadPixelOffset(e,r,n),this._keyColumnPixelOffsetCache[i]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return s+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,n){if(!this.domNode)return-1;let i=this._characterMapping.getDomPosition(t),r=Ku.readHorizontalRanges(this._getReadingTarget(this.domNode),i.partIndex,i.charIndex,i.partIndex,i.charIndex,n);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return SU(this._characterMapping,e,t)}},KT=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(e,t,n,i,r){if(this.domNode=e,this.input=t,this._characterMapping=n,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!i||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,n,i){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let r=this._readPixelOffset(this.domNode,e,t,i);if(r===-1)return null;let s=this._readPixelOffset(this.domNode,e,n,i);return s===-1?null:[new Zs(r,s-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,n,i)}_readVisibleRangesForRange(e,t,n,i,r){if(n===i){let s=this._readPixelOffset(e,t,n,r);return s===-1?null:[new Zs(s,0)]}else return this._readRawVisibleRangesForRange(e,n,i,r)}_readPixelOffset(e,t,n,i){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(i);let r=this._getReadingTarget(e);return r.firstChild?(i.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let r=this._pixelOffsetCache[n];if(r!==-1)return r;let s=this._actualReadPixelOffset(e,t,n,i);return this._pixelOffsetCache[n]=s,s}return this._actualReadPixelOffset(e,t,n,i)}_actualReadPixelOffset(e,t,n,i){if(this._characterMapping.length===0){let l=Ku.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,i);return!l||l.length===0?-1:l[0].left}if(n===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(i);let r=this._characterMapping.getDomPosition(n),s=Ku.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,i);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(n),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(e,t,n,i){if(t===1&&n===this._characterMapping.length)return[new Zs(0,this.getWidth(i))];let r=this._characterMapping.getDomPosition(t),s=this._characterMapping.getDomPosition(n);return Ku.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,s.partIndex,s.charIndex,i)}getColumnOfNodeOffset(e,t){return SU(this._characterMapping,e,t)}},SM=class extends KT{_readVisibleRangesForRange(e,t,n,i,r){let s=super._readVisibleRangesForRange(e,t,n,i,r);if(!s||s.length===0||n===i||n===1&&i===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(e,t,i,r);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},CU=function(){return Hs?HK:UK}();function HK(o,e,t,n,i){return new SM(o,e,t,n,i)}function UK(o,e,t,n,i){return new KT(o,e,t,n,i)}function SU(o,e,t){let n=e.textContent.length,i=-1;for(;e;)e=e.previousSibling,i++;return o.getColumn(new av(i,t),n)}var ql="monaco-mouse-cursor-text";var GT=class{constructor(e,t,n,i,r,s,a){this.top=e;this.left=t;this.paddingLeft=n;this.width=i;this.height=r;this.textContent=s;this.textContentClassName=a}};var pv=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(e,t){this._context=e;let n=this._context.configuration.options,i=n.get(51);this._cursorStyle=n.get(28),this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(n.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=We(document.createElement("div")),this._domNode.setClassName(`cursor ${ql}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),tn(this._domNode,i),this._domNode.setDisplay("none"),this._position=new A(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(51);return this._cursorStyle=t.get(28),this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),tn(this._domNode,n),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){let{lineNumber:e,column:t}=this._position,n=this._context.viewModel.getLineContent(e),[i,r]=_y(n,t-1);return[new A(e,i+1),n.substring(i,r)]}_prepareRender(e){let t="",n="",[i,r]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let p=e.visibleRangeForPosition(i);if(!p||p.outsideRenderedLine)return null;let h=Ce(this._domNode.domNode),f;this._cursorStyle===1?(f=d1(h,this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=r,n=this._getTokenClassName(i))):f=d1(h,1);let g=p.left,b=0;f>=2&&g>=1&&(b=1,g-=b);let v=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta;return new GT(v,g,b,f,this._lineHeight,t,n)}let s=e.linesVisibleRangesForRange(new M(i.lineNumber,i.column,i.lineNumber,i.column+r.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=r==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(t=r,n=this._getTokenClassName(i));let c=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,u=2),new GT(c,l.left,0,d,u,t,n)}_getTokenClassName(e){let t=this._context.viewModel.getViewLineData(e.lineNumber),n=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(n)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${ql} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var Gu=class o{static whitespaceVisibleColumn(e,t,n){let i=e.length,r=0,s=-1,a=-1;for(let l=0;l<i;l++){if(l===t)return[s,a,r];switch(r%n===0&&(s=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=Ft.nextRenderTabStop(r,n);break;default:return[-1,-1,-1]}}return t===i?[s,a,r]:[-1,-1,-1]}static atomicPosition(e,t,n,i){let r=e.length,[s,a,l]=o.whitespaceVisibleColumn(e,t,n);if(l===-1)return-1;let d;switch(i){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%n===0)return t;d=l%n<=n/2;break}if(d){if(s===-1)return-1;let p=a;for(let h=s;h<r;++h){if(p===a+n)return s;switch(e.charCodeAt(h)){case 32:p+=1;break;case 9:p=Ft.nextRenderTabStop(p,n);break;default:return-1}}return p===a+n?s:-1}let c=Ft.nextRenderTabStop(l,n),u=l;for(let p=t;p<r;p++){if(u===c)return p;switch(e.charCodeAt(p)){case 32:u+=1;break;case 9:u=Ft.nextRenderTabStop(u,n);break;default:return-1}}return u===c?r:-1}};var Ya=class{constructor(e=null){this.hitTarget=e}type=0},jT=class{constructor(e,t,n){this.position=e;this.spanNode=t;this.injectedText=n}type=1;get hitTarget(){return this.spanNode}},_m;(e=>{function o(t,n,i){let r=t.getPositionFromDOMInfo(n,i);return r?new jT(r,n,null):new Ya(n)}e.createFromDOMInfo=o})(_m||={});var qT=class{constructor(e,t){this.lastViewCursorsRenderData=e;this.lastTextareaPosition=t}},ti=class{static _deduceRage(e,t=null){return!t&&e?new M(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,n){return{type:0,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,n,i,r,s){return{type:e,element:t,mouseColumn:n,position:i,range:r,detail:s}}static createViewZone(e,t,n,i,r){return{type:e,element:t,mouseColumn:n,position:i,range:this._deduceRage(i),detail:r}}static createContentText(e,t,n,i,r){return{type:6,element:e,mouseColumn:t,position:n,range:this._deduceRage(n,i),detail:r}}static createContentEmpty(e,t,n,i){return{type:7,element:e,mouseColumn:t,position:n,range:this._deduceRage(n),detail:i}}static createContentWidget(e,t,n){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createScrollbar(e,t,n){return{type:11,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createOverlayWidget(e,t,n){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createOutsideEditor(e,t,n,i){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:n,outsideDistance:i}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}},Ri=class{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}},Lm=class o{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(e,t,n){this.viewModel=e.viewModel;let i=e.configuration.options;this.layoutInfo=i.get(147),this.viewDomNode=t.viewDomNode,this.lineHeight=i.get(68),this.stickyTabStops=i.get(118),this.typicalHalfwidthCharacterWidth=i.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=n,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return o.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){let n=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(n){let i=n.verticalOffset+n.height/2,r=e.viewModel.getLineCount(),s=null,a,l=null;return n.afterLineNumber!==r&&(l=new A(n.afterLineNumber+1,1)),n.afterLineNumber>0&&(s=new A(n.afterLineNumber,e.viewModel.getLineMaxColumn(n.afterLineNumber))),l===null?a=s:s===null?a=l:t<i?a=s:a=l,{viewZoneId:n.id,afterLineNumber:n.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let i=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(i);return{range:new M(i,r,i,r),isAfterLines:!0}}let t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.viewModel.getLineMaxColumn(t);return{range:new M(t,1,t,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return o._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,n){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===n)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},TM=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(e,t,n,i){this.editorPos=t,this.pos=n,this.relativePos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Dm._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}},wM=class extends TM{_ctx;_eventTarget;hitTestResult=new Gn(()=>Dm.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=ei.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,n,i,r){super(e,t,n,i),this._ctx=e,this._eventTarget=r;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?Ft.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return ti.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return ti.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,n,i){return ti.createMargin(e,this.target,this._getMouseColumn(t),t,n,i)}fulfillViewZone(e,t,n){return ti.createViewZone(e,this.target,this._getMouseColumn(t),t,n)}fulfillContentText(e,t,n){return ti.createContentText(this.target,this._getMouseColumn(e),e,t,n)}fulfillContentEmpty(e,t){return ti.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return ti.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return ti.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return ti.createOverlayWidget(this.target,this._getMouseColumn(),e)}},EU={isAfterLines:!0};function EM(o){return{isAfterLines:!1,horizontalDistanceToText:o}}var Dm=class o{_context;_viewHelper;constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,n=ei.collect(t,this._viewHelper.viewDomNode);return!!(Ri.isChildOfContentWidgets(n)||Ri.isChildOfOverflowingContentWidgets(n)||Ri.isChildOfOverlayWidgets(n)||Ri.isChildOfOverflowingOverlayWidgets(n))}createMouseTarget(e,t,n,i,r){let s=new Lm(this._context,this._viewHelper,e),a=new wM(s,t,n,i,r);try{let l=o._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=o._snapToSoftTabBoundary(l.position,s.viewModel),c=M.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();let n=t,i=null;return!Ri.isChildOfOverflowGuard(t.targetPath)&&!Ri.isChildOfOverflowingContentWidgets(t.targetPath)&&!Ri.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(i=i||t.fulfillUnknown()),i=i||o._hitTestContentWidget(e,n),i=i||o._hitTestOverlayWidget(e,n),i=i||o._hitTestMinimap(e,n),i=i||o._hitTestScrollbarSlider(e,n),i=i||o._hitTestViewZone(e,n),i=i||o._hitTestMargin(e,n),i=i||o._hitTestViewCursor(e,n),i=i||o._hitTestTextArea(e,n),i=i||o._hitTestViewLines(e,n),i=i||o._hitTestScrollbar(e,n),i||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(Ri.isChildOfContentWidgets(t.targetPath)||Ri.isChildOfOverflowingContentWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillContentWidget(n):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(Ri.isChildOfOverlayWidgets(t.targetPath)||Ri.isChildOfOverflowingOverlayWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillOverlayWidget(n):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){let n=e.lastRenderData.lastViewCursorsRenderData;for(let i of n)if(t.target===i.domNode)return t.fulfillContentText(i.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){let n=e.lastRenderData.lastViewCursorsRenderData,i=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(let s of n){if(i<s.contentLeft||i>s.contentLeft+s.width)continue;let a=e.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=r&&r<=a+s.height)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){let n=e.getZoneAtCoord(t.mouseVerticalOffset);if(n){let i=t.isInContentArea?8:5;return t.fulfillViewZone(i,n.position,n)}return null}static _hitTestTextArea(e,t){return Ri.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){let n=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),i=n.range.getStartPosition(),r=Math.abs(t.relativePos.x),s={isAfterLines:n.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){let a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(n.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,i,n.range,s)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,i,n.range,s):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,i,n.range,s))}return null}static _hitTestViewLines(e,t){if(!Ri.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new A(1,1),EU);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){let i=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(i);return t.fulfillContentEmpty(new A(i,r),EU)}if(Ri.isStrictChildOfViewLines(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(i)===0){let s=e.getLineWidth(i),a=EM(t.mouseContentHorizontalOffset-s);return t.fulfillContentEmpty(new A(i,1),a)}let r=e.getLineWidth(i);if(t.mouseContentHorizontalOffset>=r){let s=EM(t.mouseContentHorizontalOffset-r),a=new A(i,e.viewModel.getLineMaxColumn(i));return t.fulfillContentEmpty(a,s)}}let n=t.hitTestResult.value;return n.type===1?o.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(Ri.isChildOfMinimap(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new A(n,i))}return null}static _hitTestScrollbarSlider(e,t){if(Ri.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){let n=t.target.className;if(n&&/\b(slider|scrollbar)\b/.test(n)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new A(i,r))}}return null}static _hitTestScrollbar(e,t){if(Ri.isChildOfScrollableElement(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new A(n,i))}return null}getMouseColumn(e){let t=this._context.configuration.options,n=t.get(147),i=this._context.viewLayout.getCurrentScrollLeft()+e.x-n.contentLeft;return o._getMouseColumn(i,t.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,n,i,r){let s=i.lineNumber,a=i.column,l=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>l){let v=EM(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(i,v)}let d=e.visibleRangeForPosition(s,a);if(!d)return t.fulfillUnknown(i);let c=d.left;if(Math.abs(t.mouseContentHorizontalOffset-c)<1)return t.fulfillContentText(i,null,{mightBeForeignElement:!!r,injectedText:r});let u=[];if(u.push({offset:d.left,column:a}),a>1){let v=e.visibleRangeForPosition(s,a-1);v&&u.push({offset:v.left,column:a-1})}let p=e.viewModel.getLineMaxColumn(s);if(a<p){let v=e.visibleRangeForPosition(s,a+1);v&&u.push({offset:v.left,column:a+1})}u.sort((v,I)=>v.offset-I.offset);let h=t.pos.toClientCoordinates(Ce(e.viewDomNode)),f=n.getBoundingClientRect(),g=f.left<=h.clientX&&h.clientX<=f.right,b=null;for(let v=1;v<u.length;v++){let I=u[v-1],T=u[v];if(I.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=T.offset){b=new M(s,I.column,s,T.column);let S=Math.abs(I.offset-t.mouseContentHorizontalOffset),C=Math.abs(T.offset-t.mouseContentHorizontalOffset);i=S<C?new A(s,I.column):new A(s,T.column);break}}return t.fulfillContentText(i,b,{mightBeForeignElement:!g||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.getVerticalOffsetForLineNumber(n),r=i+e.lineHeight;if(!(n===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){let a=Math.floor((i+r)/2),l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);let d=new pc(t.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(e,d.toClientCoordinates(Ce(e.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(Ce(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let n=qd(e.viewDomNode),i;if(n?typeof n.caretRangeFromPoint>"u"?i=GK(n,t.clientX,t.clientY):i=n.caretRangeFromPoint(t.clientX,t.clientY):i=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!i||!i.startContainer)return new Ya;let r=i.startContainer;if(r.nodeType===r.TEXT_NODE){let s=r.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Qs.CLASS_NAME?_m.createFromDOMInfo(e,s,i.startOffset):new Ya(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){let s=r.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Qs.CLASS_NAME?_m.createFromDOMInfo(e,r,r.textContent.length):new Ya(r)}return new Ya}static _doHitTestWithCaretPositionFromPoint(e,t){let n=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(n.offsetNode.nodeType===n.offsetNode.TEXT_NODE){let i=n.offsetNode.parentNode,r=i?i.parentNode:null,s=r?r.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===Qs.CLASS_NAME?_m.createFromDOMInfo(e,n.offsetNode.parentNode,n.offset):new Ya(n.offsetNode.parentNode)}if(n.offsetNode.nodeType===n.offsetNode.ELEMENT_NODE){let i=n.offsetNode.parentNode,r=i&&i.nodeType===i.ELEMENT_NODE?i.className:null,s=i?i.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(r===Qs.CLASS_NAME){let l=n.offsetNode.childNodes[Math.min(n.offset,n.offsetNode.childNodes.length-1)];if(l)return _m.createFromDOMInfo(e,l,0)}else if(a===Qs.CLASS_NAME)return _m.createFromDOMInfo(e,n.offsetNode,0)}return new Ya(n.offsetNode)}static _snapToSoftTabBoundary(e,t){let n=t.getLineContent(e.lineNumber),{tabSize:i}=t.model.getOptions(),r=Gu.atomicPosition(n,e.column-1,i,2);return r!==-1?new A(e.lineNumber,r+1):e}static doHitTest(e,t){let n=new Ya;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?n=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(n=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(Ce(e.viewDomNode)))),n.type===1){let i=e.viewModel.getInjectedTextAt(n.position),r=e.viewModel.normalizePosition(n.position,2);(i||!r.equals(n.position))&&(n=new jT(r,n.spanNode,i))}return n}};function GK(o,e,t){let n=document.createRange(),i=o.elementFromPoint(e,t);if(i!==null){for(;i&&i.firstChild&&i.firstChild.nodeType!==i.firstChild.TEXT_NODE&&i.lastChild&&i.lastChild.firstChild;)i=i.lastChild;let r=i.getBoundingClientRect(),s=Ce(i),a=s.getComputedStyle(i,null).getPropertyValue("font-style"),l=s.getComputedStyle(i,null).getPropertyValue("font-variant"),d=s.getComputedStyle(i,null).getPropertyValue("font-weight"),c=s.getComputedStyle(i,null).getPropertyValue("font-size"),u=s.getComputedStyle(i,null).getPropertyValue("line-height"),p=s.getComputedStyle(i,null).getPropertyValue("font-family"),h=`${a} ${l} ${d} ${c}/${u} ${p}`,f=i.innerText,g=r.left,b=0,v;if(e>r.left+r.width)b=f.length;else{let I=xM.getInstance();for(let T=0;T<f.length+1;T++){if(v=I.getCharWidth(f.charAt(T),h)/2,g+=v,e<g){b=T;break}g+=v}}n.setStart(i.firstChild,b),n.setEnd(i.firstChild,b)}return n}var xM=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){let n=e+t;if(this._cache[n])return this._cache[n];let i=this._canvas.getContext("2d");i.font=t;let s=i.measureText(e).width;return this._cache[n]=s,s}};var gc=class o{static columnSelect(e,t,n,i,r,s){let a=Math.abs(r-n)+1,l=n>r,d=i>s,c=i<s,u=[];for(let p=0;p<a;p++){let h=n+(l?-p:p),f=e.columnFromVisibleColumn(t,h,i),g=e.columnFromVisibleColumn(t,h,s),b=e.visibleColumnFromColumn(t,new A(h,f)),v=e.visibleColumnFromColumn(t,new A(h,g));c&&(b>s||v<i)||d&&(v>i||b<s)||u.push(new Ln(new M(h,f,h,f),0,0,new A(h,g),0))}if(u.length===0)for(let p=0;p<a;p++){let h=n+(l?-p:p),f=t.getLineMaxColumn(h);u.push(new Ln(new M(h,f,h,f),0,0,new A(h,f),0))}return{viewStates:u,reversed:l,fromLineNumber:n,fromVisualColumn:i,toLineNumber:r,toVisualColumn:s}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,o.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let i=0,r=Math.min(n.fromViewLineNumber,n.toViewLineNumber),s=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let l=r;l<=s;l++){let d=t.getLineMaxColumn(l),c=e.visibleColumnFromColumn(t,new A(l,d));i=Math.max(i,c)}let a=n.toViewVisualColumn;return a<i&&a++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,a)}static columnSelectUp(e,t,n,i){let r=i?e.pageSize:1,s=Math.max(1,n.toViewLineNumber-r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){let r=i?e.pageSize:1,s=Math.min(t.getLineCount(),n.toViewLineNumber+r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}};var Mi=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return qe.fromPositions(i.getEndPosition())}};var qu=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return qe.fromPositions(i.getStartPosition())}},$u=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(e,t,n,i,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=i,this._lineNumberDeltaOffset=n,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return qe.fromPositions(i.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},ZT=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(e,t,n,i=!1){this._range=e,this._text=t,this._initialSelection=n,this._forceMoveMarkers=i,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};var hv=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(e,t,n){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}},dn=class o{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-aL(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){let n=t.lineNumber-1;return new A(n,e.getLineMaxColumn(n))}else return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){let i=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),s=Gu.atomicPosition(r,t.column-1,n,0);if(s!==-1&&s+1>=i)return new A(t.lineNumber,s+1)}return this.leftPosition(e,t)}static left(e,t,n){let i=e.stickyTabStops?o.leftPositionAtomicSoftTabs(t,n,e.tabSize):o.leftPosition(t,n);return new hv(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.startLineNumber,a=n.selection.startColumn;else{let l=n.position.delta(void 0,-(r-1)),d=t.normalizePosition(o.clipPositionColumn(l,t),0),c=o.left(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static clipPositionColumn(e,t){return new A(e.lineNumber,o.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n=n+Gg(e.getLineContent(t),n-1):t<e.getLineCount()&&(t=t+1,n=e.getLineMinColumn(t)),new A(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,r){if(n<e.getLineIndentColumn(t)){let s=e.getLineContent(t),a=Gu.atomicPosition(s,n-1,i,1);if(a!==-1)return new A(t,a+1)}return this.rightPosition(e,t,n)}static right(e,t,n){let i=e.stickyTabStops?o.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):o.rightPosition(t,n.lineNumber,n.column);return new hv(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.endLineNumber,a=n.selection.endColumn;else{let l=n.position.delta(void 0,r-1),d=t.normalizePosition(o.clipPositionColumn(l,t),1),c=o.right(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static vertical(e,t,n,i,r,s,a,l){let d=Ft.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+r,c=t.getLineCount(),u=n===1&&i===1,p=n===c&&i===t.getLineMaxColumn(n),h=s<n?u:p;if(n=s,n<1?(n=1,a?i=t.getLineMinColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):n>c?(n=c,a?i=t.getLineMaxColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):i=e.columnFromVisibleColumn(t,n,d),h?r=0:r=d-Ft.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),l!==void 0){let f=new A(n,i),g=t.normalizePosition(f,l);r=r+(i-g.column),n=g.lineNumber,i=g.column}return new hv(n,i,r)}static down(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n+s,a,4)}static moveDown(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.endLineNumber,a=n.selection.endColumn):(s=n.position.lineNumber,a=n.position.column);let l=0,d;do if(d=o.down(e,t,s+l,a,n.leftoverVisibleColumns,r,!0),t.normalizePosition(new A(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<t.getLineCount());return n.move(i,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(e,t,n){let i=n.selection,r=o.down(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.down(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new Ln(new M(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new A(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n-s,a,3)}static moveUp(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.startLineNumber,a=n.selection.startColumn):(s=n.position.lineNumber,a=n.position.column);let l=o.up(e,t,s,a,n.leftoverVisibleColumns,r,!0);return n.move(i,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,n){let i=n.selection,r=o.up(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.up(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new Ln(new M(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new A(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,n,i){let r=n.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return n.move(i,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,n,i){let r=t.getLineCount(),s=n.position.lineNumber;for(;s<r&&this._isBlankLine(t,s);)s++;for(;s<r&&!this._isBlankLine(t,s);)s++;return n.move(i,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,n,i){let r=n.position.lineNumber,s=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||s,l;return n.position.column===a?l=s:l=a,n.move(i,r,l,0)}static moveToEndOfLine(e,t,n,i,r){let s=n.position.lineNumber,a=t.getLineMaxColumn(s);return n.move(i,s,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let r=t.getLineCount(),s=t.getLineMaxColumn(r);return n.move(i,r,s,0)}};var $l=class o{static deleteRight(e,t,n,i){let r=[],s=e!==3;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d;if(c.isEmpty()){let u=d.getPosition(),p=dn.right(t,n,u);c=new M(p.lineNumber,p.column,u.lineNumber,u.column)}if(c.isEmpty()){r[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),r[a]=new Mi(c,"")}return[s,r]}static isAutoClosingPairDelete(e,t,n,i,r,s,a){if(t==="never"&&n==="never"||e==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],u=c.getPosition();if(!c.isEmpty())return!1;let p=r.getLineContent(u.lineNumber);if(u.column<2||u.column>=p.length+1)return!1;let h=p.charAt(u.column-2),f=i.get(h);if(!f)return!1;if(js(h)){if(n==="never")return!1}else if(t==="never")return!1;let g=p.charAt(u.column-1),b=!1;for(let v of f)v.open===h&&v.close===g&&(b=!0);if(!b)return!1;if(e==="auto"){let v=!1;for(let I=0,T=a.length;I<T;I++){let S=a[I];if(u.lineNumber===S.startLineNumber&&u.column===S.startColumn){v=!0;break}}if(!v)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].getPosition(),l=new M(a.lineNumber,a.column-1,a.lineNumber,a.column+1);i[r]=new Mi(l,"")}return[!0,i]}static deleteLeft(e,t,n,i,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,r))return this._runAutoClosingPairDelete(t,n,i);let s=[],a=e!==2;for(let l=0,d=i.length;l<d;l++){let c=o.getDeleteRange(i[l],n,t);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new Mi(c,"")}return[a,s]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;let i=e.getPosition();if(n.useTabStops&&i.column>1){let r=t.getLineContent(i.lineNumber),s=fn(r),a=s===-1?r.length+1:s+1;if(i.column<=a){let l=n.visibleColumnFromColumn(t,i),d=Ft.prevIndentTabStop(l,n.indentSize),c=n.columnFromVisibleColumn(t,i.lineNumber,d);return new M(i.lineNumber,c,i.lineNumber,i.column)}}return M.fromPositions(o.getPositionAfterDeleteLeft(i,t),i)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){let n=NA(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}else if(e.lineNumber>1){let n=e.lineNumber-1;return new A(n,t.getLineMaxColumn(n))}else return e}static cut(e,t,n){let i=[],r=null;n.sort((s,a)=>A.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=n.length;s<a;s++){let l=n[s];if(l.isEmpty())if(e.emptySelectionClipboard){let d=l.getPosition(),c,u,p,h;d.lineNumber<t.getLineCount()?(c=d.lineNumber,u=1,p=d.lineNumber+1,h=1):d.lineNumber>1&&r?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,u=t.getLineMaxColumn(d.lineNumber-1),p=d.lineNumber,h=t.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,u=1,p=d.lineNumber,h=t.getLineMaxColumn(d.lineNumber));let f=new M(c,u,p,h);r=f,f.isEmpty()?i[s]=null:i[s]=new Mi(f,"")}else i[s]=null;else i[s]=new Mi(l,"")}return new Hn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var km=class o{static _createWord(e,t,n,i,r){return{start:i,end:r,wordType:t,nextCharClass:n}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0,r=t.findPrevIntlWordBeforeOrAtOffset(e,n.column-2);for(let s=n.column-2;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return this._createIntlWord(r,l);if(l===0){if(i===2)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=1}else if(l===2){if(i===1)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=2}else if(l===1&&i!==0)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1))}return i!==0?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let r=t.findNextIntlWordAtOrAfterOffset(e,i),s=e.length;for(let a=i;a<s;a++){let l=e.charCodeAt(a),d=t.get(l);if(r&&a===r.index+r.segment.length||d===1||n===1&&d===2||n===2&&d===0)return a}return s}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,r=e.length,s=t.findNextIntlWordAtOrAfterOffset(e,n.column-1);for(let a=n.column-1;a<r;a++){let l=e.charCodeAt(a),d=t.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(i===2)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=1}else if(d===2){if(i===1)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=2}else if(d===1&&i!==0)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a)}return i!==0?this._createWord(e,i,1,this._findStartOfWord(e,t,i,r-1),r):null}static _findStartOfWord(e,t,n,i){let r=t.findPrevIntlWordBeforeOrAtOffset(e,i);for(let s=i;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return s;if(l===1||n===1&&l===2||n===2&&l===0)return s+1}return 0}static moveWordLeft(e,t,n,i,r){let s=n.lineNumber,a=n.column;a===1&&s>1&&(s=s-1,a=t.getLineMaxColumn(s));let l=o._findPreviousWordOnLine(e,t,new A(s,a));if(i===0)return new A(s,l?l.start+1:1);if(i===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findPreviousWordOnLine(e,t,new A(s,l.start+1))),new A(s,l?l.start+1:1);if(i===3){for(;l&&l.wordType===2;)l=o._findPreviousWordOnLine(e,t,new A(s,l.start+1));return new A(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=o._findPreviousWordOnLine(e,t,new A(s,l.start+1))),new A(s,l?l.end+1:1)}static _moveWordPartLeft(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===1)return n>1?new A(n-1,e.getLineMaxColumn(n-1)):t;let r=e.getLineContent(n);for(let s=t.column-1;s>1;s--){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a===95&&l!==95)return new A(n,s);if(a===45&&l!==45)return new A(n,s);if((Fc(a)||Ug(a))&&pa(l))return new A(n,s);if(pa(a)&&pa(l)&&s+1<i){let d=r.charCodeAt(s);if(Fc(d)||Ug(d))return new A(n,s)}}return new A(n,1)}static moveWordRight(e,t,n,i){let r=n.lineNumber,s=n.column,a=!1;s===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,s=1);let l=o._findNextWordOnLine(e,t,new A(r,s));if(i===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findNextWordOnLine(e,t,new A(r,l.end+1))),l?s=l.end+1:s=t.getLineMaxColumn(r);else if(i===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=o._findNextWordOnLine(e,t,new A(r,l.end+1));l?s=l.start+1:s=t.getLineMaxColumn(r)}else l&&!a&&s>=l.start+1&&(l=o._findNextWordOnLine(e,t,new A(r,l.end+1))),l?s=l.start+1:s=t.getLineMaxColumn(r);return new A(r,s)}static _moveWordPartRight(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===i)return n<e.getLineCount()?new A(n+1,1):t;let r=e.getLineContent(n);for(let s=t.column+1;s<i;s++){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a!==95&&l===95)return new A(n,s);if(a!==45&&l===45)return new A(n,s);if((Fc(a)||Ug(a))&&pa(l))return new A(n,s);if(pa(a)&&pa(l)&&s+1<i){let d=r.charCodeAt(s);if(Fc(d)||Ug(d))return new A(n,s)}}return new A(n,i)}static _deleteWordLeftWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-2,r=_r(n,i);return r+1<i?new M(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;if($l.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){let u=e.selection.getPosition();return new M(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}let a=new A(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let u=this._deleteWordLeftWhitespace(i,a);if(u)return u}let c=o._findPreviousWordOnLine(n,i,a);return t===0?c?d=c.start+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=o._findPreviousWordOnLine(n,i,new A(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l))),new M(l,d,a.lineNumber,a.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;let i=new A(n.positionLineNumber,n.positionColumn),r=this._deleteInsideWordWhitespace(t,i);return r||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){let n=e.charCodeAt(t);return n===32||n===9}static _deleteInsideWordWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=n.length;if(i===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,r))return null;let s=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,s))return null;for(;r>0&&this._charAtIsWhitespace(n,r-1);)r--;for(;s+1<i&&this._charAtIsWhitespace(n,s+1);)s++;return new M(t.lineNumber,r+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){let i=t.getLineContent(n.lineNumber),r=i.length;if(r===0)return n.lineNumber>1?new M(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new M(n.lineNumber,1,n.lineNumber+1,1):new M(n.lineNumber,1,n.lineNumber,1);let s=u=>u.start+1<=n.column&&n.column<=u.end+1,a=(u,p)=>(u=Math.min(u,n.column),p=Math.max(p,n.column),new M(n.lineNumber,u,n.lineNumber,p)),l=u=>{let p=u.start+1,h=u.end+1,f=!1;for(;h-1<r&&this._charAtIsWhitespace(i,h-1);)f=!0,h++;if(!f)for(;p>1&&this._charAtIsWhitespace(i,p-2);)p--;return a(p,h)},d=o._findPreviousWordOnLine(e,t,n);if(d&&s(d))return l(d);let c=o._findNextWordOnLine(e,t,n);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartLeft(e,n);return new M(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let r=e.charAt(i);if(r!==" "&&r!=="	")return i}return n}static _deleteWordRightWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-1,r=this._findFirstNonWhitespaceChar(n,i);return i+1<r?new M(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;let a=new A(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column,c=i.getLineCount(),u=i.getLineMaxColumn(l);if(l===c&&d===u)return null;if(s){let h=this._deleteWordRightWhitespace(i,a);if(h)return h}let p=o._findNextWordOnLine(n,i,a);return t===2?p?d=p.end+1:d<u||l===c?d=u:(l++,p=o._findNextWordOnLine(n,i,new A(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l)):(p&&d>=p.start+1&&(p=o._findNextWordOnLine(n,i,new A(l,p.end+1))),p?d=p.start+1:d<u||l===c?d=u:(l++,p=o._findNextWordOnLine(n,i,new A(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l))),new M(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartRight(e,n);return new M(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){let i=new M(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n,i){let r=ya(t,n),s=o._findPreviousWordOnLine(r,e,i);if(s&&s.wordType===1&&s.start<=i.column-1&&i.column-1<=s.end)return o._createWordAtPosition(e,i.lineNumber,s);let a=o._findNextWordOnLine(r,e,i);return a&&a.wordType===1&&a.start<=i.column-1&&i.column-1<=a.end?o._createWordAtPosition(e,i.lineNumber,a):null}static word(e,t,n,i,r){let s=ya(e.wordSeparators,e.wordSegmenterLocales),a=o._findPreviousWordOnLine(s,t,r),l=o._findNextWordOnLine(s,t,r);if(!i){let h,f;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end?(h=a.start+1,f=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end?(h=l.start+1,f=l.end+1):(a?h=a.end+1:h=1,l?f=l.start+1:f=t.getLineMaxColumn(r.lineNumber)),new Ln(new M(r.lineNumber,h,r.lineNumber,f),1,0,new A(r.lineNumber,f),0)}let d,c;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(d=l.start+1,c=l.end+1):(d=r.column,c=r.column);let u=r.lineNumber,p;if(n.selectionStart.containsPosition(r))p=n.selectionStart.endColumn;else if(r.isBeforeOrEqual(n.selectionStart.getStartPosition())){p=d;let h=new A(u,p);n.selectionStart.containsPosition(h)&&(p=n.selectionStart.endColumn)}else{p=c;let h=new A(u,p);n.selectionStart.containsPosition(h)&&(p=n.selectionStart.startColumn)}return n.move(!0,u,p,0)}};var ni=class{static addCursorDown(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ye(l.modelState,l.viewState),n?i[r++]=Ye.fromModelState(dn.translateDown(e.cursorConfig,e.model,l.modelState)):i[r++]=Ye.fromViewState(dn.translateDown(e.cursorConfig,e,l.viewState))}return i}static addCursorUp(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ye(l.modelState,l.viewState),n?i[r++]=Ye.fromModelState(dn.translateUp(e.cursorConfig,e.model,l.modelState)):i[r++]=Ye.fromViewState(dn.translateUp(e.cursorConfig,e,l.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=this._moveToLineStart(e,a,n)}return i}static _moveToLineStart(e,t,n){let i=t.viewState.position.column,r=t.modelState.position.column,s=i===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!s&&!(i===l)?this._moveToLineStartByView(e,t,n):this._moveToLineStartByModel(e,t,n)}static _moveToLineStartByView(e,t,n){return Ye.fromViewState(dn.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return Ye.fromModelState(dn.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=this._moveToLineEnd(e,l,n,i)}return r}static _moveToLineEnd(e,t,n,i){let r=t.viewState.position,s=e.getLineMaxColumn(r.lineNumber),a=r.column===s,l=t.modelState.position,d=e.model.getLineMaxColumn(l.lineNumber),c=s-r.column===d-l.column;return a||c?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return Ye.fromViewState(dn.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return Ye.fromModelState(dn.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=s.modelState.selection.startLineNumber,l=e.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=e.model.getLineMaxColumn(l):(d++,c=1),n[i]=Ye.fromModelState(new Ln(new M(a,1,a,1),0,0,new A(d,c),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ye.fromModelState(dn.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ye.fromModelState(dn.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static selectAll(e,t){let n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return Ye.fromModelState(new Ln(new M(1,1,1,1),0,0,new A(n,i),0))}static line(e,t,n,i,r){let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new A(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);if(!n){let d=e.model.getLineCount(),c=s.lineNumber+1,u=1;return c>d&&(c=d,u=e.model.getLineMaxColumn(c)),Ye.fromModelState(new Ln(new M(s.lineNumber,1,c,u),2,0,new A(c,u),0))}let l=t.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return Ye.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=e.getLineCount(),c=a.lineNumber+1,u=1;return c>d&&(c=d,u=e.getLineMaxColumn(c)),Ye.fromViewState(t.viewState.move(!0,c,u,0))}else{let d=t.modelState.selectionStart.getEndPosition();return Ye.fromModelState(t.modelState.move(!0,d.lineNumber,d.column,0))}}static word(e,t,n,i){let r=e.model.validatePosition(i);return Ye.fromModelState(km.word(e.cursorConfig,e.model,t.modelState,n,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new Ye(t.modelState,t.viewState);let n=t.viewState.position.lineNumber,i=t.viewState.position.column;return Ye.fromViewState(new Ln(new M(n,i,n,i),0,0,new A(n,i),0))}static moveTo(e,t,n,i,r){if(n){if(t.modelState.selectionStartKind===1)return this.word(e,t,n,i);if(t.modelState.selectionStartKind===2)return this.line(e,t,n,i,r)}let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new A(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);return Ye.fromViewState(t.viewState.move(n,a.lineNumber,a.column,0))}static simpleMove(e,t,n,i,r,s){switch(n){case He.Direction.Left:return s===He.Unit.HalfLine?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,r);case He.Direction.Right:return s===He.Unit.HalfLine?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,r);case He.Direction.Up:return s===He.Unit.WrappedLine?this._moveUpByViewLines(e,t,i,r):this._moveUpByModelLines(e,t,i,r);case He.Direction.Down:return s===He.Unit.WrappedLine?this._moveDownByViewLines(e,t,i,r):this._moveDownByModelLines(e,t,i,r);case He.Direction.PrevBlankLine:return s===He.Unit.WrappedLine?t.map(a=>Ye.fromViewState(dn.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ye.fromModelState(dn.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,i)));case He.Direction.NextBlankLine:return s===He.Unit.WrappedLine?t.map(a=>Ye.fromViewState(dn.moveToNextBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ye.fromModelState(dn.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,i)));case He.Direction.WrappedLineStart:return this._moveToViewMinColumn(e,t,i);case He.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case He.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(e,t,i);case He.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(e,t,i);case He.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,r){let s=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(n){case He.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case He.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case He.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case He.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=t.length;d<c;d++){let u=t[d];l[d]=this.findPositionInViewportIfOutside(e,u,s,i)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let r=t.viewState.position.lineNumber;if(n.startLineNumber<=r&&r<=n.endLineNumber-1)return new Ye(t.modelState,t.viewState);{let s;r>n.endLineNumber-1?s=n.endLineNumber-1:r<n.startLineNumber?s=n.startLineNumber:s=r;let a=dn.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,s,!1);return Ye.fromViewState(t.viewState.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map(r=>Ye.fromViewState(dn.moveLeft(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineLeft(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ye.fromViewState(dn.moveLeft(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveRight(e,t,n,i){return t.map(r=>Ye.fromViewState(dn.moveRight(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineRight(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ye.fromViewState(dn.moveRight(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveDownByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ye.fromViewState(dn.moveDown(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveDownByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ye.fromModelState(dn.moveDown(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveUpByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ye.fromViewState(dn.moveUp(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveUpByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ye.fromModelState(dn.moveUp(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveToViewPosition(e,t,n,i,r){return Ye.fromViewState(t.viewState.move(n,i,r,0))}static _moveToModelPosition(e,t,n,i,r){return Ye.fromModelState(t.modelState.move(n,i,r,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMinColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineFirstNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMaxColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineLastNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}},He;(a=>{let o=function(l){if(!bn(l))return!1;let d=l;return!(!En(d.to)||!qn(d.select)&&!Ry(d.select)||!qn(d.by)&&!En(d.by)||!qn(d.value)&&!Ui(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function i(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=i;let r;(x=>(x[x.Left=0]="Left",x[x.Right=1]="Right",x[x.Up=2]="Up",x[x.Down=3]="Down",x[x.PrevBlankLine=4]="PrevBlankLine",x[x.NextBlankLine=5]="NextBlankLine",x[x.WrappedLineStart=6]="WrappedLineStart",x[x.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",x[x.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",x[x.WrappedLineEnd=9]="WrappedLineEnd",x[x.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",x[x.ViewPortTop=11]="ViewPortTop",x[x.ViewPortCenter=12]="ViewPortCenter",x[x.ViewPortBottom=13]="ViewPortBottom",x[x.ViewPortIfOutside=14]="ViewPortIfOutside"))(r=a.Direction||={});let s;(h=>(h[h.None=0]="None",h[h.Line=1]="Line",h[h.WrappedLine=2]="WrappedLine",h[h.Character=3]="Character",h[h.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(He||={});function jK(o,e,t){let n=o.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let i,r=-1;for(i=e-1;i>=1;i--){if(o.tokenization.getLanguageIdAtPosition(i,0)!==n)return r;let s=o.getLineContent(i);if(t.shouldIgnore(i)||/^\s+$/.test(s)||s===""){r=i;continue}return i}}return-1}function mv(o,e,t,n=!0,i){if(o<4)return null;let r=i.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;let s=new XT(e,r,i);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=jK(e,t,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=e.getLineContent(a);return{indentation:jn(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=e.getLineContent(a);return{indentation:jn(l),action:null,line:a}}else{if(a===1)return{indentation:jn(e.getLineContent(a)),action:null,line:a};let l=a-1,d=r.getIndentMetadata(e.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(u)){c=u;break}return{indentation:jn(e.getLineContent(c+1)),action:null,line:c+1}}if(n)return{indentation:jn(e.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:jn(e.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let u=0;for(let p=c-1;p>0;p--)if(!s.shouldIndentNextLine(c)){u=p;break}return{indentation:jn(e.getLineContent(u+1)),action:null,line:u+1}}else if(s.shouldDecrease(c))return{indentation:jn(e.getLineContent(c)),action:null,line:c}}return{indentation:jn(e.getLineContent(1)),action:null,line:1}}}function wU(o,e,t,n,i){if(o<4)return null;let r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=i.getLanguageConfiguration(r).indentRulesSupport;if(!s)return null;e.tokenization.forceTokenization(t.startLineNumber);let l=new Yu(e,i).getProcessedTokenContextAroundRange(t),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,u=jn(c.getLineContent()),p=qK(e,t.startLineNumber,c),h=JT(e,t.getStartPosition()),f=e.getLineContent(t.startLineNumber),g=jn(f),b=mv(o,p,t.startLineNumber+1,void 0,i);if(!b){let I=h?g:u;return{beforeEnter:I,afterEnter:I}}let v=h?g:b.indentation;return b.action===1&&(v=n.shiftIndent(v)),s.shouldDecrease(d.getLineContent())&&(v=n.unshiftIndent(v)),{beforeEnter:h?g:u,afterEnter:v}}function xU(o,e,t,n,i,r){let s=o.autoIndent;if(s<4||JT(e,t.getStartPosition()))return null;let l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),d=r.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let u=new Yu(e,r).getProcessedTokenContextAroundRange(t),p=u.beforeRangeProcessedTokens.getLineContent(),h=u.afterRangeProcessedTokens.getLineContent(),f=p+h,g=p+n+h;if(!d.shouldDecrease(f)&&d.shouldDecrease(g)){let v=mv(s,e,t.startLineNumber,!1,r);if(!v)return null;let I=v.indentation;return v.action!==1&&(I=i.unshiftIndent(I)),I}let b=t.startLineNumber-1;if(b>0){let v=e.getLineContent(b);if(d.shouldIndentNextLine(v)&&d.shouldIncrease(g)){let T=mv(s,e,t.startLineNumber,!1,r)?.indentation;if(T!==void 0){let S=e.getLineContent(t.startLineNumber),C=jn(S),x=i.shiftIndent(T)===C,D=/^\s*$/.test(f),O=o.autoClosingPairs.autoClosingPairsOpenByEnd.get(n),K=O&&O.length>0&&D;if(x&&K)return T}}}return null}function qK(o,e,t){return{tokenization:{getLineTokens:i=>i===e?t:o.tokenization.getLineTokens(i),getLanguageId:()=>o.getLanguageId(),getLanguageIdAtPosition:(i,r)=>o.getLanguageIdAtPosition(i,r)},getLineContent:i=>i===e?t.getLineContent():o.getLineContent(i)}}var XT=class{_indentRulesSupport;_indentationLineProcessor;constructor(e,t,n){this._indentRulesSupport=t,this._indentationLineProcessor=new ew(e,n)}shouldIncrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(n)}shouldDecrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(n)}shouldIgnore(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(n)}shouldIndentNextLine(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(n)}},Yu=class{model;indentationLineProcessor;constructor(e,t){this.model=e,this.indentationLineProcessor=new ew(e,t)}getProcessedTokenContextAroundRange(e){let t=this._getProcessedTokensBeforeRange(e),n=this._getProcessedTokensAfterRange(e),i=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:n,previousLineProcessedTokens:i}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);let t=this.model.tokenization.getLineTokens(e.startLineNumber),n=Ea(t,e.startColumn-1),i;if(JT(this.model,e.getStartPosition())){let s=e.startColumn-1-n.firstCharOffset,a=n.firstCharOffset,l=a+s;i=t.sliceAndInflate(a,l,0)}else{let s=e.startColumn-1;i=t.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(i)}_getProcessedTokensAfterRange(e){let t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);let n=this.model.tokenization.getLineTokens(t.lineNumber),i=Ea(n,t.column-1),r=t.column-1-i.firstCharOffset,s=i.firstCharOffset+r,a=i.firstCharOffset+i.getLineLength(),l=n.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){let t=h=>{this.model.tokenization.forceTokenization(h);let f=this.model.tokenization.getLineTokens(h),g=this.model.getLineMaxColumn(h)-1;return Ea(f,g)};this.model.tokenization.forceTokenization(e.startLineNumber);let n=this.model.tokenization.getLineTokens(e.startLineNumber),i=Ea(n,e.startColumn-1),r=vn.createEmpty("",i.languageIdCodec),s=e.startLineNumber-1;if(s===0||!(i.firstCharOffset===0))return r;let d=t(s);if(!(i.languageId===d.languageId))return r;let u=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}},ew=class{constructor(e,t){this.model=e;this.languageConfigurationService=t}getProcessedLine(e,t){let n=(s,a)=>{let l=jn(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(e);let i=this.model.tokenization.getLineTokens(e),r=this.getProcessedTokens(i).getLineContent();return t!==void 0&&(r=n(r,t)),r}getProcessedTokens(e){let t=l=>l===2||l===3||l===1,n=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew.getBracketRegExp({global:!0}),s=[];return e.forEach(l=>{let d=e.getStandardTokenType(l),c=e.getTokenText(l);t(d)&&(c=c.replace(r,""));let u=e.getMetadata(l);s.push({text:c,metadata:u})}),vn.createFromTextAndMetadata(s,e.languageIdCodec)}};function JT(o,e){o.tokenization.forceTokenization(e.lineNumber);let t=o.tokenization.getLineTokens(e.lineNumber),n=Ea(t,e.column-1),i=n.firstCharOffset===0,r=t.getLanguageId(0)===n.languageId;return!i&&!r}function gv(o,e,t,n){e.tokenization.forceTokenization(t.startLineNumber);let i=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(i);if(!r)return null;let a=new Yu(e,n).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),u=r.onEnter(o,l,d,c);if(!u)return null;let p=u.indentAction,h=u.appendText,f=u.removeText||0;h?p===1&&(h="	"+h):p===1||p===2?h="	":h="";let g=FI(e,t.startLineNumber,t.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:p,appendText:h,removeText:f,indentation:g}}var _M=Object.create(null);function Zu(o,e){if(e<=0)return"";_M[o]||(_M[o]=["",o]);let t=_M[o];for(let n=t.length;n<=e;n++)t[n]=t[n-1]+o;return t[e]}var br=class{constructor(e,t,n){this._languageConfigurationService=n;this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,n,i,r){let s=Ft.visibleColumnFromColumn(e,t,n);if(r){let a=Zu(" ",i),d=Ft.prevIndentTabStop(s,i)/i;return Zu(a,d)}else{let a="	",d=Ft.prevRenderTabStop(s,n)/n;return Zu(a,d)}}static shiftIndent(e,t,n,i,r){let s=Ft.visibleColumnFromColumn(e,t,n);if(r){let a=Zu(" ",i),d=Ft.nextIndentTabStop(s,i)/i;return Zu(a,d)}else{let a="	",d=Ft.nextRenderTabStop(s,n)/n;return Zu(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(e,t,n){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,n):e.addEditOperation(t,n)}getEditOperations(e,t){let n=this._selection.startLineNumber,i=this._selection.endLineNumber;this._selection.endColumn===1&&n!==i&&(i=i-1);let{tabSize:r,indentSize:s,insertSpaces:a}=this._opts,l=n===i;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let u=n;u<=i;u++,d=c){c=0;let p=e.getLineContent(u),h=fn(p);if(this._opts.isUnshift&&(p.length===0||h===0)||!l&&!this._opts.isUnshift&&p.length===0)continue;if(h===-1&&(h=p.length),u>1&&Ft.visibleColumnFromColumn(p,h+1,r)%s!==0&&e.tokenization.isCheapToTokenize(u-1)){let b=gv(this._opts.autoIndent,e,new M(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(b){if(c=d,b.appendText)for(let v=0,I=b.appendText.length;v<I&&c<s&&b.appendText.charCodeAt(v)===32;v++)c++;b.removeText&&(c=Math.max(0,c-b.removeText));for(let v=0;v<c&&!(h===0||p.charCodeAt(h-1)!==32);v++)h--}}if(this._opts.isUnshift&&h===0)continue;let f;this._opts.isUnshift?f=br.unshiftIndent(p,h+1,r,s,a):f=br.shiftIndent(p,h+1,r,s,a),this._addEditOperation(t,new M(u,1,u,h+1),f),u===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=h+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(n)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?Zu(" ",s):"	";for(let c=n;c<=i;c++){let u=e.getLineContent(c),p=fn(u);if(!(this._opts.isUnshift&&(u.length===0||p===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(p===-1&&(p=u.length),!(this._opts.isUnshift&&p===0)))if(this._opts.isUnshift){p=Math.min(p,s);for(let h=0;h<p;h++)if(u.charCodeAt(h)===9){p=h+1;break}this._addEditOperation(t,new M(c,1,c,p+1),"")}else this._addEditOperation(t,new M(c,1,c,1),d),c===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let i=t.getInverseEditOperations()[0];return new qe(i.range.endLineNumber,i.range.endColumn,i.range.endLineNumber,i.range.endColumn)}let n=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let i=this._selection.startColumn;return n.startColumn<=i?n:n.getDirection()===0?new qe(n.startLineNumber,i,n.endLineNumber,n.endColumn):new qe(n.endLineNumber,n.endColumn,n.startLineNumber,i)}return n}};br=P([_(2,Cl)],br);var tw=class{_range;_charBeforeSelection;_charAfterSelection;constructor(e,t,n){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=n}getEditOperations(e,t){t.addTrackedEditOperation(new M(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new M(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let n=t.getInverseEditOperations(),i=n[0].range,r=n[1].range;return new qe(i.endLineNumber,i.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}},nw=class{constructor(e,t,n){this._position=e;this._text=t;this._charAfter=n}getEditOperations(e,t){t.addTrackedEditOperation(new M(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return new qe(i.endLineNumber,i.startColumn,i.endLineNumber,i.endColumn-this._charAfter.length)}};var iw=class{static getEdits(e,t,n,i,r){if(!r&&this._isAutoIndentType(e,t,n)){let s=[];for(let l of n){let d=this._findActualIndentationForSelection(e,t,l,i);if(d===null)return;s.push({selection:l,indentation:d})}let a=Rm.getAutoClosingPairClose(e,t,n,i,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,s,i,a)}}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let i=0,r=n.length;i<r;i++)if(!t.tokenization.isCheapToTokenize(n[i].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,n,i){let r=xU(e,t,n,i,{shiftIndent:a=>fv(e,a),unshiftIndent:a=>Nm(e,a)},e.languageConfigurationService);if(r===null)return null;let s=FI(t,n.startLineNumber,n.startColumn);return r===e.normalizeIndentation(s)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,n,i,r){let s=n.map(({selection:l,indentation:d})=>{if(r!==null){let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!1);return new DM(c,l,i,r)}else{let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!0);return Qu(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new Hn(4,s,a)}static _getEditFromIndentationAndSelection(e,t,n,i,r,s=!0){let a=i.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a),d=e.normalizeIndentation(n);if(l!==0){let u=t.getLineContent(a);d+=u.substring(l-1,i.startColumn-1)}return d+=s?r:"",{range:new M(a,1,i.endLineNumber,i.endColumn),text:d}}},ow=class{static getEdits(e,t,n,i,r,s){if(DU(t,n,i,r,s))return this._runAutoClosingOvertype(e,i,s)}static _runAutoClosingOvertype(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let l=t[r].getPosition(),d=new M(l.lineNumber,l.column,l.lineNumber,l.column+1);i[r]=new Mi(d,n)}return new Hn(4,i,{shouldPushStackElementBefore:hw(e,4),shouldPushStackElementAfter:!1})}},rw=class{static getEdits(e,t,n,i,r){if(DU(e,t,n,i,r)){let s=n.map(a=>new Mi(new M(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new Hn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},Rm=class{static getEdits(e,t,n,i,r,s){if(!s){let a=this.getAutoClosingPairClose(e,t,n,i,r);if(a!==null)return this._runAutoClosingOpenCharType(n,i,r,a)}}static _runAutoClosingOpenCharType(e,t,n,i){let r=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];r[s]=new LM(l,t,!n,i)}return new Hn(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,n,i,r){for(let f of n)if(!f.isEmpty())return null;let s=n.map(f=>{let g=f.getPosition();return r?{lineNumber:g.lineNumber,beforeColumn:g.column-i.length,afterColumn:g.column}:{lineNumber:g.lineNumber,beforeColumn:g.column,afterColumn:g.column}}),a=this._findAutoClosingPairOpen(e,t,s.map(f=>new A(f.lineNumber,f.beforeColumn)),i);if(!a)return null;let l,d;if(js(i)?(l=e.autoClosingQuotes,d=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,d=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,d=e.shouldAutoCloseBefore.bracket),l==="never")return null;let u=this._findContainedAutoClosingPair(e,a),p=u?u.close:"",h=!0;for(let f of s){let{lineNumber:g,beforeColumn:b,afterColumn:v}=f,I=t.getLineContent(g),T=I.substring(0,b-1),S=I.substring(v-1);if(S.startsWith(p)||(h=!1),S.length>0){let D=S.charAt(0);if(!this._isBeforeClosingBrace(e,S)&&!d(D))return null}if(a.open.length===1&&(i==="'"||i==='"')&&l!=="always"){let D=ya(e.wordSeparators,[]);if(T.length>0){let O=T.charCodeAt(T.length-1);if(D.get(O)===0)return null}}if(!t.tokenization.isCheapToTokenize(g))return null;t.tokenization.forceTokenization(g);let C=t.tokenization.getLineTokens(g),w=Ea(C,b-1);if(!a.shouldAutoClose(w,b-w.firstCharOffset))return null;let x=a.findNeutralCharacter();if(x){let D=t.tokenization.getTokenTypeIfInsertingCharacter(g,b,x);if(!a.isOK(D))return null}}return h?a.close.substring(0,a.close.length-p.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;let n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[],r=null;for(let s of i)s.open!==t.open&&t.open.includes(s.open)&&t.close.endsWith(s.close)&&(!r||s.open.length>r.open.length)&&(r=s);return r}static _findAutoClosingPairOpen(e,t,n,i){let r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!r)return null;let s=null;for(let a of r)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of n)if(t.getValueInRange(new M(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+i!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(e,t){let n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],s=i.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!s&&a}},sw=class{static getEdits(e,t,n,i,r){if(!r&&this._isSurroundSelectionType(e,t,n,i))return this._runSurroundSelectionType(e,n,i)}static _runSurroundSelectionType(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=e.surroundingPairs[n];i[r]=new tw(a,n,l)}return new Hn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,n,i){if(!RM(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;let r=js(i);for(let s of n){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=t.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,u=l===s.endLineNumber?s.endColumn-1:d.length,p=d.substring(c,u);if(/[^ \t]/.test(p)){a=!1;break}}if(a)return!1;if(r&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=t.getValueInRange(s);if(js(l))return!1}}return!0}},aw=class{static getEdits(e,t,n,i,r,s){if(!s&&this._isTypeInterceptorElectricChar(t,n,i)){let a=this._typeInterceptorElectricChar(e,t,n,i[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,n){return!!(n.length===1&&t.tokenization.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,i,r){if(!t.electricChars.hasOwnProperty(r)||!i.isEmpty())return null;let s=i.getPosition();n.tokenization.forceTokenization(s.lineNumber);let a=n.tokenization.getLineTokens(s.lineNumber),l;try{l=t.onElectricCharacter(r,a,s.column)}catch(d){return je(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,c=n.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let u=n.getLineContent(c.startLineNumber),p=jn(u),h=t.normalizeIndentation(p),f=n.getLineContent(s.lineNumber),g=n.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,b=f.substring(g-1,s.column-1),v=h+b+r,I=new M(s.lineNumber,1,s.lineNumber,s.column),T=new Mi(I,v);return new Hn(kM(v,e),[T],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},lw=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new Mi(t[s],n);let r=kM(n,e);return new Hn(r,i,{shouldPushStackElementBefore:hw(e,r),shouldPushStackElementAfter:!1})}},Mm=class{static getEdits(e,t,n,i,r){if(!r&&i===`
`){let s=[];for(let a=0,l=n.length;a<l;a++)s[a]=this._enter(e,t,!1,n[a]);return new Hn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,n,i){if(e.autoIndent===0)return Qu(i,`
`,n);if(!t.tokenization.isCheapToTokenize(i.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(i.startLineNumber),d=jn(l).substring(0,i.startColumn-1);return Qu(i,`
`+e.normalizeIndentation(d),n)}let r=gv(e.autoIndent,t,i,e.languageConfigurationService);if(r){if(r.indentAction===0)return Qu(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===1)return Qu(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===2){let l=e.normalizeIndentation(r.indentation),d=e.normalizeIndentation(r.indentation+r.appendText),c=`
`+d+`
`+l;return n?new qu(i,c,!0):new $u(i,c,-1,d.length-l.length,!0)}else if(r.indentAction===3){let l=Nm(e,r.indentation);return Qu(i,`
`+e.normalizeIndentation(l+r.appendText),n)}}let s=t.getLineContent(i.startLineNumber),a=jn(s).substring(0,i.startColumn-1);if(e.autoIndent>=4){let l=wU(e.autoIndent,t,i,{unshiftIndent:d=>Nm(e,d),shiftIndent:d=>fv(e,d),normalizeIndentation:d=>e.normalizeIndentation(d)},e.languageConfigurationService);if(l){let d=e.visibleColumnFromColumn(t,i.getEndPosition()),c=i.endColumn,u=t.getLineContent(i.endLineNumber),p=fn(u);if(p>=0?i=i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,p+1)):i=i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new qu(i,`
`+e.normalizeIndentation(l.afterEnter),!0);{let h=0;return c<=p+1&&(e.insertSpaces||(d=Math.ceil(d/e.indentSize)),h=Math.min(d+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new $u(i,`
`+e.normalizeIndentation(l.afterEnter),0,h,!0)}}}return Qu(i,`
`+e.normalizeIndentation(a),n)}static lineInsertBefore(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber;if(a===1)i[r]=new qu(new M(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new M(a,l,a,l))}}return i}static lineInsertAfter(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber,l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new M(a,l,a,l))}return i}static lineBreakInsert(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=this._enter(e,t,!0,n[r]);return i}},dw=class{static getEdits(e,t,n,i,r,s){let a=this._distributePasteToCursors(e,n,i,r,s);return a?(n=n.sort(M.compareRangesUsingStarts),this._distributedPaste(e,t,n,a)):this._simplePaste(e,t,n,i,r)}static _distributePasteToCursors(e,t,n,i,r){if(i||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){n.charCodeAt(n.length-1)===10&&(n=n.substring(0,n.length-1)),n.charCodeAt(n.length-1)===13&&(n=n.substring(0,n.length-1));let s=Hg(n);if(s.length===t.length)return s}return null}static _distributedPaste(e,t,n,i){let r=[];for(let s=0,a=n.length;s<a;s++)r[s]=new Mi(n[s],i[s]);return new Hn(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,r){let s=[];for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.getPosition();if(r&&!d.isEmpty()&&(r=!1),r&&i.indexOf(`
`)!==i.length-1&&(r=!1),r){let u=new M(c.lineNumber,1,c.lineNumber,1);s[a]=new ZT(u,i,d,!0)}else s[a]=new Mi(d,i)}return new Hn(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},cw=class{static getEdits(e,t,n,i,r,s,a,l){let d=i.map(c=>this._compositionType(n,c,r,s,a,l));return new Hn(4,d,{shouldPushStackElementBefore:hw(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,r,s){if(!t.isEmpty())return null;let a=t.getPosition(),l=Math.max(1,a.column-i),d=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),c=new M(a.lineNumber,l,a.lineNumber,d);return e.getValueInRange(c)===n&&s===0?null:new $u(c,n,0,s)}},uw=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new Mi(t[s],n);let r=kM(n,e);return new Hn(r,i,{shouldPushStackElementBefore:hw(e,r),shouldPushStackElementAfter:!1})}},pw=class{static getCommands(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(e,t,a.startLineNumber);d=d||"	";let c=e.normalizeIndentation(d);if(!l.startsWith(c)){i[r]=new Mi(new M(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}i[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){i[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}i[r]=new br(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return i}static _goodIndentForLine(e,t,n){let i=null,r="",s=mv(e.autoIndent,t,n,!1,e.languageConfigurationService);if(s)i=s.action,r=s.indentation;else if(n>1){let a;for(a=n-1;a>=1;a--){let c=t.getLineContent(a);if(_r(c)>=0)break}if(a<1)return null;let l=t.getLineMaxColumn(a),d=gv(e.autoIndent,t,new M(a,l,a,l),e.languageConfigurationService);d&&(r=d.indentation+d.appendText)}return i&&(i===1&&(r=fv(e,r)),i===3&&(r=Nm(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,n,i){let r="",s=n.getStartPosition();if(e.insertSpaces){let a=e.visibleColumnFromColumn(t,s),l=e.indentSize,d=l-a%l;for(let c=0;c<d;c++)r+=" "}else r="	";return new Mi(n,r,i)}},Om=class extends $u{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(e,t,n,i,r,s){super(e,t,n,i),this._openCharacter=r,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,n){return this.closeCharacterRange=new M(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new M(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,n)}},LM=class extends Om{constructor(e,t,n,i){let r=(n?t:"")+i,s=0,a=-i.length;super(e,r,s,a,t,i)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,i,t)}},DM=class extends Om{_autoIndentationEdit;_autoClosingEdit;constructor(e,t,n,i){let r=n+i,s=0,a=n.length;super(t,r,s,a,n,i),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){let n=t.getInverseEditOperations();if(n.length!==2)throw new Error("There should be two inverse edit operations!");let i=n[0].range,r=n[1].range,s=i.plusRange(r);return this._computeCursorStateWithRange(e,s,t)}};function kM(o,e){return o===" "?e===5||e===6?6:5:4}function hw(o,e){return LU(o)&&!LU(e)?!0:o===5?!1:_U(o)!==_U(e)}function _U(o){return o===6||o===5?"space":o}function LU(o){return o===4||o===5||o===6}function DU(o,e,t,n,i){if(o.autoClosingOvertype==="never"||!o.autoClosingPairs.autoClosingPairsCloseSingleChar.has(i))return!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(!a.isEmpty())return!1;let l=a.getPosition(),d=e.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==i)return!1;let u=js(i);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&u)return!1;if(o.autoClosingOvertype==="auto"){let h=!1;for(let f=0,g=n.length;f<g;f++){let b=n[f];if(l.lineNumber===b.startLineNumber&&l.column===b.startColumn){h=!0;break}}if(!h)return!1}}return!0}function Qu(o,e,t){return t?new qu(o,e,!0):new Mi(o,e,!0)}function fv(o,e,t){return t=t||1,br.shiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function Nm(o,e,t){return t=t||1,br.unshiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function RM(o,e){return js(e)?o.autoSurround==="quotes"||o.autoSurround==="languageDefined":o.autoSurround==="brackets"||o.autoSurround==="languageDefined"}var Xs=class{static indent(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new br(n[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static outdent(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new br(n[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static shiftIndent(e,t,n){return fv(e,t,n)}static unshiftIndent(e,t,n){return Nm(e,t,n)}static paste(e,t,n,i,r,s){return dw.getEdits(e,t,n,i,r,s)}static tab(e,t,n){return pw.getCommands(e,t,n)}static compositionType(e,t,n,i,r,s,a,l){return cw.getEdits(e,t,n,i,r,s,a,l)}static compositionEndWithInterceptors(e,t,n,i,r,s){if(!i)return null;let a=null;for(let p of i)if(a===null)a=p.insertedText;else if(a!==p.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let p of i)if(p.deletedText.length!==0){d=!0;break}if(d){if(!RM(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;let p=js(l);for(let g of i)if(g.deletedSelectionStart!==0||g.deletedSelectionEnd!==g.deletedText.length||/^[ \t]+$/.test(g.deletedText)||p&&js(g.deletedText))return null;let h=[];for(let g of r){if(!g.isEmpty())return null;h.push(g.getPosition())}if(h.length!==i.length)return null;let f=[];for(let g=0,b=h.length;g<b;g++)f.push(new nw(h[g],i[g].deletedText,t.surroundingPairs[l]));return new Hn(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=rw.getEdits(t,n,r,s,l);if(c!==void 0)return c;let u=Rm.getEdits(t,n,r,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(e,t,n,i,r,s,a){let l=Mm.getEdits(n,i,r,a,e);if(l!==void 0)return l;let d=iw.getEdits(n,i,r,a,e);if(d!==void 0)return d;let c=ow.getEdits(t,n,i,r,s,a);if(c!==void 0)return c;let u=Rm.getEdits(n,i,r,a,!1,e);if(u!==void 0)return u;let p=sw.getEdits(n,i,r,a,e);if(p!==void 0)return p;let h=aw.getEdits(t,n,i,r,a,e);return h!==void 0?h:lw.getEdits(t,r,a)}static typeWithoutInterceptors(e,t,n,i,r){return uw.getEdits(e,i,r)}},mw=class{constructor(e,t,n,i,r,s){this.deletedText=e;this.deletedSelectionStart=t;this.deletedSelectionEnd=n;this.insertedText=i;this.insertedSelectionStart=r;this.insertedSelectionEnd=s}};var ct=0,Jt=class extends nv{runEditorCommand(e,t,n){let i=t._getViewModel();i&&this.runCoreEditorCommand(i,n||{})}},Oi;(a=>{let o=function(l){if(!bn(l))return!1;let d=l;return!(!En(d.to)||!qn(d.by)&&!En(d.by)||!qn(d.value)&&!Ui(d.value)||!qn(d.revealCursor)&&!Ry(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function i(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let u=Math.floor(l.value||1),p=!!l.revealCursor;return{direction:d,unit:c,value:u,revealCursor:p,select:!!l.select}}a.parse=i;let r;(p=>(p[p.Up=1]="Up",p[p.Right=2]="Right",p[p.Down=3]="Down",p[p.Left=4]="Left"))(r=a.Direction||={});let s;(f=>(f[f.Line=1]="Line",f[f.WrappedLine=2]="WrappedLine",f[f.Page=3]="Page",f[f.HalfPage=4]="HalfPage",f[f.Editor=5]="Editor",f[f.Column=6]="Column"))(s=a.Unit||={})})(Oi||={});var bv;(n=>{let o=function(i){if(!bn(i))return!1;let r=i;return!(!Ui(r.lineNumber)&&!En(r.lineNumber)||!qn(r.at)&&!En(r.at))};n.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:o,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(bv||={});var vv=class{constructor(e){e.addImplementation(1e4,"code-editor",(t,n)=>{let i=t.get(qa).getFocusedCodeEditor();return i&&i.hasTextFocus()?this._runEditorCommand(t,i,n):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,n)=>{let i=xo();return i&&as(i)?(this.runDOMCommand(i),!0):!1}),e.addImplementation(0,"generic-dom",(t,n)=>{let i=t.get(qa).getActiveCodeEditor();return i?(i.focus(),this._runEditorCommand(t,i,n)):!1})}_runEditorCommand(e,t,n){let i=this.runEditorCommand(e,t,n);return i||!0}};var Un;(ve=>{class o extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){if(!se.position)return;B.model.pushStackElement(),B.setCursorStates(se.source,3,[ni.moveTo(B,B.getPrimaryCursorState(),this._inSelectionMode,se.position,se.viewPosition)])&&se.revealType!==2&&B.revealAllCursors(se.source,!0,!0)}}ve.MoveTo=Ge(new o({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),ve.MoveToSelect=Ge(new o({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class n extends Jt{runCoreEditorCommand(B,se){B.model.pushStackElement();let fe=this._getColumnSelectResult(B,B.getPrimaryCursorState(),B.getCursorColumnSelectData(),se);fe!==null&&(B.setCursorStates(se.source,3,fe.viewStates.map(tt=>Ye.fromViewState(tt))),B.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:fe.fromLineNumber,fromViewVisualColumn:fe.fromVisualColumn,toViewLineNumber:fe.toLineNumber,toViewVisualColumn:fe.toVisualColumn}),fe.reversed?B.revealTopMostCursor(se.source):B.revealBottomMostCursor(se.source))}}ve.ColumnSelect=Ge(new class extends n{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(ue,B,se,fe){if(typeof fe.position>"u"||typeof fe.viewPosition>"u"||typeof fe.mouseColumn>"u")return null;let tt=ue.model.validatePosition(fe.position),kt=ue.coordinatesConverter.validateViewPosition(new A(fe.viewPosition.lineNumber,fe.viewPosition.column),tt),ri=fe.doColumnSelect?se.fromViewLineNumber:kt.lineNumber,Pi=fe.doColumnSelect?se.fromViewVisualColumn:fe.mouseColumn-1;return gc.columnSelect(ue.cursorConfig,ue,ri,Pi,kt.lineNumber,fe.mouseColumn-1)}}),ve.CursorColumnSelectLeft=Ge(new class extends n{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(ue,B,se,fe){return gc.columnSelectLeft(ue.cursorConfig,ue,se)}}),ve.CursorColumnSelectRight=Ge(new class extends n{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(ue,B,se,fe){return gc.columnSelectRight(ue.cursorConfig,ue,se)}});class a extends n{_isPaged;constructor(B){super(B),this._isPaged=B.isPaged}_getColumnSelectResult(B,se,fe,tt){return gc.columnSelectUp(B.cursorConfig,B,fe,this._isPaged)}}ve.CursorColumnSelectUp=Ge(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3600,linux:{primary:0}}})),ve.CursorColumnSelectPageUp=Ge(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends n{_isPaged;constructor(B){super(B),this._isPaged=B.isPaged}_getColumnSelectResult(B,se,fe,tt){return gc.columnSelectDown(B.cursorConfig,B,fe,this._isPaged)}}ve.CursorColumnSelectDown=Ge(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3602,linux:{primary:0}}})),ve.CursorColumnSelectPageDown=Ge(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3596,linux:{primary:0}}}));class h extends Jt{constructor(){super({id:"cursorMove",precondition:void 0,metadata:He.metadata})}runCoreEditorCommand(B,se){let fe=He.parse(se);fe&&this._runCursorMove(B,se.source,fe)}_runCursorMove(B,se,fe){B.model.pushStackElement(),B.setCursorStates(se,3,h._move(B,B.getCursorStates(),fe)),B.revealAllCursors(se,!0)}static _move(B,se,fe){let tt=fe.select,kt=fe.value;switch(fe.direction){case He.Direction.Left:case He.Direction.Right:case He.Direction.Up:case He.Direction.Down:case He.Direction.PrevBlankLine:case He.Direction.NextBlankLine:case He.Direction.WrappedLineStart:case He.Direction.WrappedLineFirstNonWhitespaceCharacter:case He.Direction.WrappedLineColumnCenter:case He.Direction.WrappedLineEnd:case He.Direction.WrappedLineLastNonWhitespaceCharacter:return ni.simpleMove(B,se,fe.direction,tt,kt,fe.unit);case He.Direction.ViewPortTop:case He.Direction.ViewPortBottom:case He.Direction.ViewPortCenter:case He.Direction.ViewPortIfOutside:return ni.viewportMove(B,se,fe.direction,tt,kt);default:return null}}}ve.CursorMoveImpl=h,ve.CursorMove=Ge(new h);let g;(B=>B[B.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(g||={});class b extends Jt{_staticArgs;constructor(B){super(B),this._staticArgs=B.args}runCoreEditorCommand(B,se){let fe=this._staticArgs;this._staticArgs.value===-1&&(fe={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:se.pageSize||B.cursorConfig.pageSize}),B.model.pushStackElement(),B.setCursorStates(se.source,3,ni.simpleMove(B,B.getCursorStates(),fe.direction,fe.select,fe.value,fe.unit)),B.revealAllCursors(se.source,!0)}}ve.CursorLeft=Ge(new b({args:{direction:He.Direction.Left,unit:He.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),ve.CursorLeftSelect=Ge(new b({args:{direction:He.Direction.Left,unit:He.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1039}})),ve.CursorRight=Ge(new b({args:{direction:He.Direction.Right,unit:He.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),ve.CursorRightSelect=Ge(new b({args:{direction:He.Direction.Right,unit:He.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1041}})),ve.CursorUp=Ge(new b({args:{direction:He.Direction.Up,unit:He.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),ve.CursorUpSelect=Ge(new b({args:{direction:He.Direction.Up,unit:He.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),ve.CursorPageUp=Ge(new b({args:{direction:He.Direction.Up,unit:He.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:11}})),ve.CursorPageUpSelect=Ge(new b({args:{direction:He.Direction.Up,unit:He.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1035}})),ve.CursorDown=Ge(new b({args:{direction:He.Direction.Down,unit:He.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),ve.CursorDownSelect=Ge(new b({args:{direction:He.Direction.Down,unit:He.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),ve.CursorPageDown=Ge(new b({args:{direction:He.Direction.Down,unit:He.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:12}})),ve.CursorPageDownSelect=Ge(new b({args:{direction:He.Direction.Down,unit:He.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1036}})),ve.CreateCursor=Ge(new class extends Jt{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(ue,B){if(!B.position)return;let se;B.wholeLine?se=ni.line(ue,ue.getPrimaryCursorState(),!1,B.position,B.viewPosition):se=ni.moveTo(ue,ue.getPrimaryCursorState(),!1,B.position,B.viewPosition);let fe=ue.getCursorStates();if(fe.length>1){let tt=se.modelState?se.modelState.position:null,kt=se.viewState?se.viewState.position:null;for(let ri=0,Pi=fe.length;ri<Pi;ri++){let ze=fe[ri];if(!(tt&&!ze.modelState.selection.containsPosition(tt))&&!(kt&&!ze.viewState.selection.containsPosition(kt))){fe.splice(ri,1),ue.model.pushStackElement(),ue.setCursorStates(B.source,3,fe);return}}}fe.push(se),ue.model.pushStackElement(),ue.setCursorStates(B.source,3,fe)}}),ve.LastCursorMoveToSelect=Ge(new class extends Jt{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(ue,B){if(!B.position)return;let se=ue.getLastAddedCursorIndex(),fe=ue.getCursorStates(),tt=fe.slice(0);tt[se]=ni.moveTo(ue,fe[se],!0,B.position,B.viewPosition),ue.model.pushStackElement(),ue.setCursorStates(B.source,3,tt)}});class J extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){B.model.pushStackElement(),B.setCursorStates(se.source,3,ni.moveToBeginningOfLine(B,B.getCursorStates(),this._inSelectionMode)),B.revealAllCursors(se.source,!0)}}ve.CursorHome=Ge(new J({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),ve.CursorHomeSelect=Ge(new J({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class re extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){B.model.pushStackElement(),B.setCursorStates(se.source,3,this._exec(B.getCursorStates())),B.revealAllCursors(se.source,!0)}_exec(B){let se=[];for(let fe=0,tt=B.length;fe<tt;fe++){let kt=B[fe],ri=kt.modelState.position.lineNumber;se[fe]=Ye.fromModelState(kt.modelState.move(this._inSelectionMode,ri,1,0))}return se}}ve.CursorLineStart=Ge(new re({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:287}}})),ve.CursorLineStartSelect=Ge(new re({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:1311}}}));class ce extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){B.model.pushStackElement(),B.setCursorStates(se.source,3,ni.moveToEndOfLine(B,B.getCursorStates(),this._inSelectionMode,se.sticky||!1)),B.revealAllCursors(se.source,!0)}}ve.CursorEnd=Ge(new ce({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ct,kbExpr:ge.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:m("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),ve.CursorEndSelect=Ge(new ce({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ct,kbExpr:ge.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:m("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class _e extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){B.model.pushStackElement(),B.setCursorStates(se.source,3,this._exec(B,B.getCursorStates())),B.revealAllCursors(se.source,!0)}_exec(B,se){let fe=[];for(let tt=0,kt=se.length;tt<kt;tt++){let ri=se[tt],Pi=ri.modelState.position.lineNumber,ze=B.model.getLineMaxColumn(Pi);fe[tt]=Ye.fromModelState(ri.modelState.move(this._inSelectionMode,Pi,ze,0))}return fe}}ve.CursorLineEnd=Ge(new _e({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:291}}})),ve.CursorLineEndSelect=Ge(new _e({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:1315}}}));class Pn extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){B.model.pushStackElement(),B.setCursorStates(se.source,3,ni.moveToBeginningOfBuffer(B,B.getCursorStates(),this._inSelectionMode)),B.revealAllCursors(se.source,!0)}}ve.CursorTop=Ge(new Pn({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2062,mac:{primary:2064}}})),ve.CursorTopSelect=Ge(new Pn({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3086,mac:{primary:3088}}}));class At extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){B.model.pushStackElement(),B.setCursorStates(se.source,3,ni.moveToEndOfBuffer(B,B.getCursorStates(),this._inSelectionMode)),B.revealAllCursors(se.source,!0)}}ve.CursorBottom=Ge(new At({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2061,mac:{primary:2066}}})),ve.CursorBottomSelect=Ge(new At({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:3085,mac:{primary:3090}}}));class Jl extends Jt{constructor(){super({id:"editorScroll",precondition:void 0,metadata:Oi.metadata})}determineScrollMethod(B){let se=[6],fe=[1,2,3,4,5,6],tt=[4,2],kt=[1,3];return se.includes(B.unit)&&tt.includes(B.direction)?this._runHorizontalEditorScroll.bind(this):fe.includes(B.unit)&&kt.includes(B.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(B,se){let fe=Oi.parse(se);if(!fe)return;let tt=this.determineScrollMethod(fe);tt&&tt(B,se.source,fe)}_runVerticalEditorScroll(B,se,fe){let tt=this._computeDesiredScrollTop(B,fe);if(fe.revealCursor){let kt=B.getCompletelyVisibleViewRangeAtScrollTop(tt);B.setCursorStates(se,3,[ni.findPositionInViewportIfOutside(B,B.getPrimaryCursorState(),kt,fe.select)])}B.viewLayout.setScrollPosition({scrollTop:tt},0)}_computeDesiredScrollTop(B,se){if(se.unit===1){let kt=B.viewLayout.getFutureViewport(),ri=B.getCompletelyVisibleViewRangeAtScrollTop(kt.top),Pi=B.coordinatesConverter.convertViewRangeToModelRange(ri),ze;se.direction===1?ze=Math.max(1,Pi.startLineNumber-se.value):ze=Math.min(B.model.getLineCount(),Pi.startLineNumber+se.value);let L=B.coordinatesConverter.convertModelPositionToViewPosition(new A(ze,1));return B.viewLayout.getVerticalOffsetForLineNumber(L.lineNumber)}if(se.unit===5){let kt=0;return se.direction===3&&(kt=B.model.getLineCount()-B.cursorConfig.pageSize),B.viewLayout.getVerticalOffsetForLineNumber(kt)}let fe;se.unit===3?fe=B.cursorConfig.pageSize*se.value:se.unit===4?fe=Math.round(B.cursorConfig.pageSize/2)*se.value:fe=se.value;let tt=(se.direction===1?-1:1)*fe;return B.viewLayout.getCurrentScrollTop()+tt*B.cursorConfig.lineHeight}_runHorizontalEditorScroll(B,se,fe){let tt=this._computeDesiredScrollLeft(B,fe);B.viewLayout.setScrollPosition({scrollLeft:tt},0)}_computeDesiredScrollLeft(B,se){let fe=(se.direction===4?-1:1)*se.value;return B.viewLayout.getCurrentScrollLeft()+fe*B.cursorConfig.typicalHalfwidthCharacterWidth}}ve.EditorScrollImpl=Jl,ve.EditorScroll=Ge(new Jl),ve.ScrollLineUp=Ge(new class extends Jt{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(ue,B){ve.EditorScroll.runCoreEditorCommand(ue,{to:Oi.RawDirection.Up,by:Oi.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollPageUp=Ge(new class extends Jt{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(ue,B){ve.EditorScroll.runCoreEditorCommand(ue,{to:Oi.RawDirection.Up,by:Oi.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollEditorTop=Ge(new class extends Jt{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus}})}runCoreEditorCommand(ue,B){ve.EditorScroll.runCoreEditorCommand(ue,{to:Oi.RawDirection.Up,by:Oi.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollLineDown=Ge(new class extends Jt{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(ue,B){ve.EditorScroll.runCoreEditorCommand(ue,{to:Oi.RawDirection.Down,by:Oi.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollPageDown=Ge(new class extends Jt{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(ue,B){ve.EditorScroll.runCoreEditorCommand(ue,{to:Oi.RawDirection.Down,by:Oi.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollEditorBottom=Ge(new class extends Jt{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus}})}runCoreEditorCommand(ue,B){ve.EditorScroll.runCoreEditorCommand(ue,{to:Oi.RawDirection.Down,by:Oi.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollLeft=Ge(new class extends Jt{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus}})}runCoreEditorCommand(ue,B){ve.EditorScroll.runCoreEditorCommand(ue,{to:Oi.RawDirection.Left,by:Oi.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:B.source})}}),ve.ScrollRight=Ge(new class extends Jt{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus}})}runCoreEditorCommand(ue,B){ve.EditorScroll.runCoreEditorCommand(ue,{to:Oi.RawDirection.Right,by:Oi.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:B.source})}});class Gr extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){se.position&&(B.model.pushStackElement(),B.setCursorStates(se.source,3,[ni.word(B,B.getPrimaryCursorState(),this._inSelectionMode,se.position)]),se.revealType!==2&&B.revealAllCursors(se.source,!0,!0))}}ve.WordSelect=Ge(new Gr({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),ve.WordSelectDrag=Ge(new Gr({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),ve.LastCursorWordSelect=Ge(new class extends Jt{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(ue,B){if(!B.position)return;let se=ue.getLastAddedCursorIndex(),fe=ue.getCursorStates(),tt=fe.slice(0),kt=fe[se];tt[se]=ni.word(ue,kt,kt.modelState.hasSelection(),B.position),ue.model.pushStackElement(),ue.setCursorStates(B.source,3,tt)}});class na extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){se.position&&(B.model.pushStackElement(),B.setCursorStates(se.source,3,[ni.line(B,B.getPrimaryCursorState(),this._inSelectionMode,se.position,se.viewPosition)]),se.revealType!==2&&B.revealAllCursors(se.source,!1,!0))}}ve.LineSelect=Ge(new na({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),ve.LineSelectDrag=Ge(new na({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class Ir extends Jt{_inSelectionMode;constructor(B){super(B),this._inSelectionMode=B.inSelectionMode}runCoreEditorCommand(B,se){if(!se.position)return;let fe=B.getLastAddedCursorIndex(),tt=B.getCursorStates(),kt=tt.slice(0);kt[fe]=ni.line(B,tt[fe],this._inSelectionMode,se.position,se.viewPosition),B.model.pushStackElement(),B.setCursorStates(se.source,3,kt)}}ve.LastCursorLineSelect=Ge(new Ir({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),ve.LastCursorLineSelectDrag=Ge(new Ir({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),ve.CancelSelection=Ge(new class extends Jt{constructor(){super({id:"cancelSelection",precondition:ge.hasNonEmptySelection,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(ue,B){ue.model.pushStackElement(),ue.setCursorStates(B.source,3,[ni.cancelSelection(ue,ue.getPrimaryCursorState())]),ue.revealAllCursors(B.source,!0)}}),ve.RemoveSecondaryCursors=Ge(new class extends Jt{constructor(){super({id:"removeSecondaryCursors",precondition:ge.hasMultipleSelections,kbOpts:{weight:ct+1,kbExpr:ge.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(ue,B){ue.model.pushStackElement(),ue.setCursorStates(B.source,3,[ue.getPrimaryCursorState()]),ue.revealAllCursors(B.source,!0),kb(m("removedCursor","Removed secondary cursors"))}}),ve.RevealLine=Ge(new class extends Jt{constructor(){super({id:"revealLine",precondition:void 0,metadata:bv.metadata})}runCoreEditorCommand(ue,B){let se=B,fe=se.lineNumber||0,tt=typeof fe=="number"?fe+1:parseInt(fe)+1;tt<1&&(tt=1);let kt=ue.model.getLineCount();tt>kt&&(tt=kt);let ri=new M(tt,1,tt,ue.model.getLineMaxColumn(tt)),Pi=0;if(se.at)switch(se.at){case bv.RawAtArgument.Top:Pi=3;break;case bv.RawAtArgument.Center:Pi=1;break;case bv.RawAtArgument.Bottom:Pi=4;break;default:break}let ze=ue.coordinatesConverter.convertModelRangeToViewRange(ri);ue.revealRange(B.source,!1,ze,Pi,0)}}),ve.SelectAll=new class extends vv{constructor(){super(bU)}runDOMCommand(ue){Vn&&(ue.focus(),ue.select()),ue.ownerDocument.execCommand("selectAll")}runEditorCommand(ue,B,se){let fe=B._getViewModel();fe&&this.runCoreEditorCommand(fe,se)}runCoreEditorCommand(ue,B){ue.model.pushStackElement(),ue.setCursorStates("keyboard",3,[ni.selectAll(ue,ue.getPrimaryCursorState())])}},ve.SetSelection=Ge(new class extends Jt{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(ue,B){B.selection&&(ue.model.pushStackElement(),ue.setCursorStates(B.source,3,[Ye.fromModelSelection(B.selection)]))}})})(Un||={});var YK=Ct.and(ge.textInputFocus,ge.columnSelection);function Pm(o,e){Na.registerKeybindingRule({id:o,primary:e,when:YK,weight:ct+1})}Pm(Un.CursorColumnSelectLeft.id,1039);Pm(Un.CursorColumnSelectRight.id,1041);Pm(Un.CursorColumnSelectUp.id,1040);Pm(Un.CursorColumnSelectPageUp.id,1035);Pm(Un.CursorColumnSelectDown.id,1042);Pm(Un.CursorColumnSelectPageDown.id,1036);function kU(o){return o.register(),o}var ZK;(l=>{class o extends nv{runEditorCommand(c,u,p){let h=u._getViewModel();h&&this.runCoreEditingCommand(u,h,p||{})}}l.CoreEditingCommand=o,l.LineBreakInsert=Ge(new class extends o{constructor(){super({id:"lineBreakInsert",precondition:ge.writable,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Mm.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection)))}}),l.Outdent=Ge(new class extends o{constructor(){super({id:"outdent",precondition:ge.writable,kbOpts:{weight:ct,kbExpr:Ct.and(ge.editorTextFocus,ge.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Xs.outdent(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.Tab=Ge(new class extends o{constructor(){super({id:"tab",precondition:ge.writable,kbOpts:{weight:ct,kbExpr:Ct.and(ge.editorTextFocus,ge.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Xs.tab(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=Ge(new class extends o{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,u){let[p,h]=$l.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection),c.getCursorAutoClosedCharacters());p&&d.pushUndoStop(),d.executeCommands(this.id,h),c.setPrevEditOperationType(2)}}),l.DeleteRight=Ge(new class extends o{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:ct,kbExpr:ge.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,u){let[p,h]=$l.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection));p&&d.pushUndoStop(),d.executeCommands(this.id,h),c.setPrevEditOperationType(3)}}),l.Undo=new class extends vv{constructor(){super(hM)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends vv{constructor(){super(mM)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})(ZK||={});var gw=class extends Uu{_handlerId;constructor(e,t,n){super({id:e,precondition:void 0,metadata:n}),this._handlerId=t}runCommand(e,t){let n=e.get(qa).getFocusedCodeEditor();n&&n.trigger("keyboard",this._handlerId,t)}};function Ju(o,e){kU(new gw("default:"+o,o)),kU(new gw(o,o,e))}Ju("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Ju("replacePreviousChar");Ju("compositionType");Ju("compositionStart");Ju("compositionEnd");Ju("paste");Ju("cut");var Fm=class o{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(e){this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return o.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){let n={...e};return n.position&&(n.position=t.convertViewPositionToModelPosition(n.position)),n.range&&(n.range=t.convertViewRangeToModelRange(n.range)),(n.type===5||n.type===8)&&(n.detail=this.convertViewToModelViewZoneData(n.detail,t)),n}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new A(e.afterLineNumber,1)).lineNumber}}};var fw=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(e,t,n,i){this.configuration=e,this.viewModel=t,this.userInputEvents=n,this.commandDelegate=i}paste(e,t,n,i){this.commandDelegate.paste(e,t,n,i)}type(e){this.commandDelegate.type(e)}compositionType(e,t,n,i){this.commandDelegate.compositionType(e,t,n,i)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Un.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){let t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new A(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){let t=this.configuration.options,n=Wt&&t.get(109),i=t.get(22);e.middleButton&&!n?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):i?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Un.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Un.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,n){e=this._validateViewColumn(e),Un.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:n})}_createCursor(e,t){e=this._validateViewColumn(e),Un.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Un.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Un.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Un.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Un.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Un.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Un.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Un.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Un.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Un.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}};var Bm=class extends ls{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(e,t,n){super(),this._context=e,this.viewController=t,this.viewHelper=n,this.mouseTargetFactory=new Dm(this._context,n),this._mouseDownOperation=this._register(new MM(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let i=new RT(this.viewHelper.viewDomNode);this._register(i.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(i.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=q(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new ds(a,!1,this.viewHelper.viewDomNode))}))})),this._register(i.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(i.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let r=0;this._register(i.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{r=a})),this._register(q(this.viewHelper.viewDomNode,he.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(i.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let e=Lb.INSTANCE,t=0,n=ga.getZoomLevel(),i=!1,r=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Pr(l);if(e.acceptStandardWheelEvent(d),e.isPhysicalMouseWheel()){if(a(l)){let c=ga.getZoomLevel(),u=d.deltaY>0?1:-1;ga.setZoomLevel(c+u),d.preventDefault(),d.stopPropagation()}}else Date.now()-t>50&&(n=ga.getZoomLevel(),i=a(l),r=0),t=Date.now(),r+=d.deltaY,i&&(ga.setZoomLevel(n+r/5),d.preventDefault(),d.stopPropagation())};this._register(q(this.viewHelper.viewDomNode,he.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return Fe?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(147)){let t=this._context.configuration.options.get(147).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){let i=new ov(e,t).toPageCoordinates(Ce(this.viewHelper.viewDomNode)),r=NT(this.viewHelper.viewDomNode);if(i.y<r.y||i.y>r.y+r.height||i.x<r.x||i.x>r.x+r.width)return null;let s=AT(this.viewHelper.viewDomNode,r,i);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,i,s,null)}_createMouseTarget(e,t){let n=e.target;if(!this.viewHelper.viewDomNode.contains(n)){let i=qd(this.viewHelper.viewDomNode);i&&(n=i.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?n:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){let n=this._createMouseTarget(e,!0),i=n.type===6||n.type===7,r=n.type===2||n.type===3||n.type===4,s=n.type===3,a=this._context.configuration.options.get(111),l=n.type===8||n.type===5,d=n.type===9,c=e.leftButton||e.middleButton;Fe&&e.leftButton&&e.ctrlKey&&(c=!1);let u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(i||s&&a))u(),this._mouseDownOperation.start(n.type,e,t);else if(r)e.preventDefault();else if(l){let p=n.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(p.viewZoneId)&&(u(),this._mouseDownOperation.start(n.type,e,t),e.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(n.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:n})}_onMouseWheel(e){this.viewController.emitMouseWheel(e)}},MM=class extends F{constructor(t,n,i,r,s,a){super();this._context=t;this._viewController=n;this._viewHelper=i;this._mouseTargetFactory=r;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new OT(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new OM(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new AM,this._currentSelection=new qe(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);let n=this._findMousePosition(t,!1);n&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:n}):n.type===13&&(n.outsidePosition==="above"||n.outsidePosition==="below")?this._topBottomDragScrolling.start(n,t):(this._topBottomDragScrolling.stop(),this._dispatchMouse(n,!0,1)))}start(t,n,i){this._lastMouseEvent=n,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(n),this._mouseState.setModifiers(n);let r=this._findMousePosition(n,!0);if(!r||!r.position)return;this._mouseState.trySetCount(n.detail,r.position),n.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&n.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&r.type===6&&r.position&&this._currentSelection.containsPosition(r.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);ss(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(r,n.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){let n=t.editorPos,i=this._context.viewModel,r=this._context.viewLayout,s=this._getMouseColumn(t);if(t.posy<n.y){let l=n.y-t.posy,d=Math.max(r.getCurrentScrollTop()-l,0),c=Lm.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return ti.createOutsideEditor(s,p,"above",l)}let u=r.getLineNumberAtVerticalOffset(d);return ti.createOutsideEditor(s,new A(u,1),"above",l)}if(t.posy>n.y+n.height){let l=t.posy-n.y-n.height,d=r.getCurrentScrollTop()+t.relativePos.y,c=Lm.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return ti.createOutsideEditor(s,p,"below",l)}let u=r.getLineNumberAtVerticalOffset(d);return ti.createOutsideEditor(s,new A(u,i.getLineMaxColumn(u)),"below",l)}let a=r.getLineNumberAtVerticalOffset(r.getCurrentScrollTop()+t.relativePos.y);if(t.posx<n.x){let l=n.x-t.posx;return ti.createOutsideEditor(s,new A(a,1),"left",l)}if(t.posx>n.x+n.width){let l=t.posx-n.x-n.width;return ti.createOutsideEditor(s,new A(a,i.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(t,n){let i=this._getPositionOutsideEditor(t);if(i)return i;let r=this._createMouseTarget(t,n);if(!r.position)return null;if(r.type===8||r.type===5){let a=this._helpPositionJumpOverViewZone(r.detail);if(a)return ti.createViewZone(r.type,r.element,r.mouseColumn,a,r.detail)}return r}_helpPositionJumpOverViewZone(t){let n=new A(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=t.positionBefore,r=t.positionAfter;return i&&r?i.isBefore(n)?i:r:null}_dispatchMouse(t,n,i){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:n,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}},OM=class extends F{constructor(t,n,i,r){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(t,n){this._operation?this._operation.setPosition(t,n):this._operation=new NM(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,n)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},NM=class extends F{constructor(t,n,i,r,s,a){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=Xn(Ce(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,n){this._position=t,this._mouseEvent=n}_tick(){let t=Date.now(),n=t-this._lastTime;return this._lastTime=t,n}_getScrollSpeed(){let t=this._context.configuration.options.get(68),n=this._context.configuration.options.get(147).height/t,i=this._position.outsideDistance/t;return i<=1.5?Math.max(30,n*(1+i)):i<=3?Math.max(60,n*(2+i)):Math.max(200,n*(7+i))}_execute(){let t=this._context.configuration.options.get(68),n=this._getScrollSpeed(),i=this._tick(),r=n*(i/1e3)*t,s=this._position.outsidePosition==="above"?-r:r;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=NT(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(147).horizontalScrollbarHeight,p=new pc(this._mouseEvent.pos.x,c.y+c.height-u-.1),h=AT(this._viewHelper.viewDomNode,c,p);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,p,h,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=ti.createOutsideEditor(this._position.mouseColumn,new A(l,1),"above",this._position.outsideDistance):d=ti.createOutsideEditor(this._position.mouseColumn,new A(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=Xn(Ce(d.element),()=>this._execute())}},AM=class o{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let n=new Date().getTime();n-this._lastSetMouseDownCountTime>o.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=n,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};function bw(o,e,t,n){let i=o.getPlainTextToCopy(e,t,pt),r=o.model.getEOL(),s=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(i)?i:null,l=Array.isArray(i)?i.join(r):i,d,c=null;if(XK.forceCopyWithSyntaxHighlighting||n&&l.length<65536){let p=o.getRichTextToCopy(e,t);p&&(d=p.html,c=p.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var ep=class o{static INSTANCE=new o;_lastState;constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}},XK={forceCopyWithSyntaxHighlighting:!1};var Wm=class o{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){let n=e*t,i=n+1,r=n+t;return new M(i,1,r+1,1)}static fromEditorSelection(e,t,n,i){let s=o._getPageOfLine(t.startLineNumber,n),a=o._getRangeForPage(s,n),l=o._getPageOfLine(t.endLineNumber,n),d=o._getRangeForPage(l,n),c=a.intersectRanges(new M(1,1,t.startLineNumber,t.startColumn));if(i&&e.getValueLengthInRange(c,1)>500){let v=e.modifyPosition(c.getEndPosition(),-500);c=M.fromPositions(v,c.getEndPosition())}let u=e.getValueInRange(c,1),p=e.getLineCount(),h=e.getLineMaxColumn(p),f=d.intersectRanges(new M(t.endLineNumber,t.endColumn,p,h));if(i&&e.getValueLengthInRange(f,1)>500){let v=e.modifyPosition(f.getStartPosition(),500);f=M.fromPositions(f.getStartPosition(),v)}let g=e.getValueInRange(f,1),b;if(s===l||s+1===l)b=e.getValueInRange(t,1);else{let v=a.intersectRanges(t),I=d.intersectRanges(t);b=e.getValueInRange(v,1)+"\u2026"+e.getValueInRange(I,1)}return i&&b.length>2*500&&(b=b.substring(0,500)+"\u2026"+b.substring(b.length-500,b.length)),{value:u+b+g,selection:t,selectionStart:u.length,selectionEnd:u.length+b.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function yv(o,e){if(o.get(2)===1){let n=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),i=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),r=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=m("accessibilityModeOff","The editor is not accessible at this time.");return n?m("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,n):i?m("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,i):r?m("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,r):s}return o.get(4)}function Iv(o){let e=0,t=-1;do{if(t=o.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var $o=!1,ii=class o{constructor(e,t,n,i,r){this.value=e;this.selectionStart=t;this.selectionEnd=n;this.selection=i;this.newlineCountBeforeSelection=r}static EMPTY=new o("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){let n=e.getValue(),i=e.getSelectionStart(),r=e.getSelectionEnd(),s;if(t){let a=n.substring(0,i),l=t.value.substring(0,t.selectionStart);a===l&&(s=t.newlineCountBeforeSelection)}return new o(n,i,r,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new o(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,n){$o&&console.log(`writeToTextArea ${e}: ${this.toString()}`),t.setValue(e,this.value),n&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){let i=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,i,-1)}if(e>=this.selectionEnd){let i=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,1)}let t=this.value.substring(this.selectionStart,e);if(t.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);let n=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,-1)}_finishDeduceEditorPosition(e,t,n){let i=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)i++;return[e,n*t.length,i]}static deduceInput(e,t,n){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};$o&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`));let i=Math.min(zg(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(Kg(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd),s=e.value.substring(i,e.value.length-r),a=t.value.substring(i,t.value.length-r),l=e.selectionStart-i,d=e.selectionEnd-i,c=t.selectionStart-i,u=t.selectionEnd-i;if($o&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${u}`)),c===u){let h=e.selectionStart-i;return $o&&console.log(`REMOVE PREVIOUS: ${h} chars`),{text:a,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}let p=d-l;return{text:a,replacePrevCharCnt:p,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if($o&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`)),e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};let n=Math.min(zg(e.value,t.value),e.selectionEnd),i=Math.min(Kg(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(n,e.value.length-i),s=t.value.substring(n,t.value.length-i),a=e.selectionStart-n,l=e.selectionEnd-n,d=t.selectionStart-n,c=t.selectionEnd-n;return $o&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${r}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:r.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(e){return new o(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};var yw;(e=>e.Tap="-monaco-textarea-synthetic-tap")(yw||={});var PM=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";let t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}},Vm=class extends F{constructor(t,n,i,r,s,a){super();this._host=t;this._textArea=n;this._OS=i;this._browser=r;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new ln(()=>this._onCut.fire(),0)),this._textAreaState=ii.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(j.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new ln(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new gt(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new gt(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{$o&&console.log("[compositionstart]",d);let c=new PM;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){$o&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{$o&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let p=ii.readFromTextArea(this._textArea,this._textAreaState),h=ii.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(h),this._onCompositionUpdate.fire(d);return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=ii.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{$o&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let p=ii.readFromTextArea(this._textArea,this._textAreaState),h=ii.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(h),this._onCompositionEnd.fire();return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=ii.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if($o&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=ii.readFromTextArea(this._textArea,this._textAreaState),u=ii.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(rn(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&this._onType.fire(u))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,u]=RU.getTextData(d.clipboardData);c&&(u=u||ep.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new ln(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new k);onFocus=this._onFocus.event;_onBlur=this._register(new k);onBlur=this._onBlur.event;_onKeyDown=this._register(new k);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new k);onKeyUp=this._onKeyUp.event;_onCut=this._register(new k);onCut=this._onCut.event;_onPaste=this._register(new k);onPaste=this._onPaste.event;_onType=this._register(new k);onType=this._onType.event;_onCompositionStart=this._register(new k);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new k);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new k);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new k);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new on);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=ii.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let t=0;return q(this._textArea.ownerDocument,"selectionchange",n=>{if(jl.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let i=Date.now(),r=i-t;if(t=i,r<5)return;let s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(c[0],c[1],c[2]),p=this._textAreaState.deduceEditorPosition(d),h=this._host.deduceModelPosition(p[0],p[1],p[2]),f=new qe(u.lineNumber,u.column,h.lineNumber,h.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,n){this._hasFocus||(n=n.collapseSelection()),n.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=n}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){let n=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:n.isFromEmptySelection,multicursorText:n.multicursorText,mode:n.mode};ep.INSTANCE.set(this._browser.isFirefox?n.text.replace(/\r\n/g,`
`):n.text,i),t.preventDefault(),t.clipboardData&&RU.setTextData(t.clipboardData,n.text,n.html,i)}};Vm=P([_(4,vo),_(5,gi)],Vm);var RU={getTextData(o){let e=o.getData(iu.text),t=null,n=o.getData("vscode-editor-data");if(typeof n=="string")try{t=JSON.parse(n),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&o.files.length>0?[Array.prototype.slice.call(o.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(o,e,t,n){o.setData(iu.text,e),typeof t=="string"&&o.setData("text/html",t),o.setData("vscode-editor-data",JSON.stringify(n))}},vw=class extends F{constructor(t){super();this._actual=t;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>jl.onKeyDown())),this._register(this.onBeforeInput(()=>jl.onBeforeInput())),this._register(this.onInput(()=>jl.onInput())),this._register(this.onKeyUp(()=>jl.onKeyUp())),this._register(q(this._actual,yw.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new Ne(this._actual,"keydown")).event;onKeyPress=this._register(new Ne(this._actual,"keypress")).event;onKeyUp=this._register(new Ne(this._actual,"keyup")).event;onCompositionStart=this._register(new Ne(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new Ne(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new Ne(this._actual,"compositionend")).event;onBeforeInput=this._register(new Ne(this._actual,"beforeinput")).event;onInput=this._register(new Ne(this._actual,"input")).event;onCut=this._register(new Ne(this._actual,"cut")).event;onCopy=this._register(new Ne(this._actual,"copy")).event;onPaste=this._register(new Ne(this._actual,"paste")).event;onFocus=this._register(new Ne(this._actual,"focus")).event;onBlur=this._register(new Ne(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new k);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let t=qd(this._actual);return t?t.activeElement===this._actual:this._actual.isConnected?xo()===this._actual:!1}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,n){let i=this._actual;i.value!==n&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=n)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,n,i){let r=this._actual,s=null,a=qd(r);a?s=a.activeElement:s=xo();let l=Ce(s),d=s===r,c=r.selectionStart,u=r.selectionEnd;if(d&&c===n&&u===i){Vn&&l.parent!==l&&r.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),r.setSelectionRange(n,i),Vn&&l.parent!==l&&r.focus();return}try{let p=fV(r);this.setIgnoreSelectionChangeTime("setSelectionRange"),r.focus(),r.setSelectionRange(n,i),bV(r,p)}catch{}}};var FM=class extends Bm{_lastPointerType;constructor(e,t,n){super(e,t,n),this._register(Nn.addTarget(this.viewHelper.linesContentDomNode)),this._register(q(this.viewHelper.linesContentDomNode,wt.Tap,r=>this.onTap(r))),this._register(q(this.viewHelper.linesContentDomNode,wt.Change,r=>this.onChange(r))),this._register(q(this.viewHelper.linesContentDomNode,wt.Contextmenu,r=>this._onContextMenu(new ds(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(q(this.viewHelper.linesContentDomNode,"pointerdown",r=>{let s=r.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let i=new MT(this.viewHelper.viewDomNode);this._register(i.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(i.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(i.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(i.onPointerDown(this.viewHelper.viewDomNode,(r,s)=>this._onMouseDown(r,s)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){let n=this._createMouseTarget(new ds(e,!1,this.viewHelper.viewDomNode),!1);n.position&&this.viewController.dispatchMouse({position:n.position,mouseColumn:n.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:n.type===6&&n.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}},BM=class extends Bm{constructor(e,t,n){super(e,t,n),this._register(Nn.addTarget(this.viewHelper.linesContentDomNode)),this._register(q(this.viewHelper.linesContentDomNode,wt.Tap,i=>this.onTap(i))),this._register(q(this.viewHelper.linesContentDomNode,wt.Change,i=>this.onChange(i))),this._register(q(this.viewHelper.linesContentDomNode,wt.Contextmenu,i=>this._onContextMenu(new ds(i,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();let t=this._createMouseTarget(new ds(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){let n=document.createEvent("CustomEvent");n.initEvent(yw.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(n),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}},Iw=class extends F{handler;constructor(e,t,n){super(),(qr||NN&&qv)&&mS.pointerEvents?this.handler=this._register(new FM(e,t,n)):Oe.TouchEvent?this.handler=this._register(new BM(e,t,n)):this.handler=this._register(new Bm(e,t,n))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}};var Lo=class extends ls{};var Cw=class extends qt{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(e){super(e),this._visibleLines=new Sm({createLine:()=>new WM(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let n=this._context.configuration.options.get(51);tn(this.domNode,n),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);let n=this._context.configuration.options.get(51);return tn(this.domNode,n),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(n=>n.shouldRender());for(let n=0,i=t.length;n<i;n++){let r=t[n];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}},WM=class{_dynamicOverlays;_domNode;_renderedContent;constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=We(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,n,i,r){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(i.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;">'),r.appendString(s),r.appendString("</div>"),!0)}layoutLine(e,t,n){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(n))}},Sw=class extends Cw{_contentWidth;constructor(e){super(e);let n=this._context.configuration.options.get(147);this._contentWidth=n.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._contentWidth=n.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}},Ew=class extends Cw{_contentLeft;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._contentLeft=n.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),tn(this.domNode,t.get(51))}onConfigurationChanged(e){let t=this._context.configuration.options;tn(this.domNode,t.get(51));let n=t.get(147);return this._contentLeft=n.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);let t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}};var Tw=class extends qt{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(e){super(e),this.domNode=We(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1,n=this._context.configuration.options.get(147),i=n.contentWidth-n.verticalScrollbarWidth;this.contentWidth!==i&&(this.contentWidth=i,e=!0);let r=n.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0,n=e.getDecorationsInViewport();for(let i of n){if(!i.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=We(document.createElement("div")),this.domNode.appendChild(r));let s,a;i.options.blockIsAfterEnd?(s=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0)):(s=e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!0),a=i.range.isEmpty()&&!i.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0));let[l,d,c,u]=i.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+i.options.blockClassName),r.setLeft(this.contentLeft-u),r.setWidth(this.contentWidth+u+d),r.setTop(s-e.scrollTop-l),r.setHeight(a-s+l+c),t++}for(let i=t;i<this.blocks.length;i++)this.blocks[i].domNode.remove();this.blocks.length=t}};var ww=class extends qt{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=We(document.createElement("div")),ei.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=We(document.createElement("div")),ei.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){let e=Object.keys(this._widgets);for(let t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){let t=new HM(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,n,i,r){this._widgets[e.getId()].setPosition(t,n,i,r),this.setShouldRender()}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let n=this._widgets[t];delete this._widgets[t];let i=n.domNode.domNode;i.remove(),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onBeforeRender(e)}prepareRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].prepareRender(e)}render(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].render(e)}},HM=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new tp(null,null);_secondaryAnchor=new tp(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(e,t,n){this._context=e,this._viewDomNode=t,this._actual=n,this.domNode=We(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let i=this._context.configuration.options,r=i.get(147);this._fixedOverflowWidgets=i.get(43),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=i.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){let t=this._context.configuration.options;if(this._lineHeight=t.get(68),e.hasChanged(147)){let n=t.get(147);this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,n){this._affinity=e,this._primaryAnchor=i(t,this._context.viewModel,this._affinity),this._secondaryAnchor=i(n,this._context.viewModel,this._affinity);function i(r,s,a){if(!r)return new tp(null,null);let l=s.model.validatePosition(r);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new tp(r,d)}return new tp(r,null)}}_getMaxWidth(){let e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,n,i){this._setPosition(i,e,t),this._preference=n,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,n,i){let r=e.top,s=r,a=e.top+e.height,l=i.viewportHeight-a,d=r-n,c=s>=n,u=a,p=l>=n,h=e.left;return h+t>i.scrollLeft+i.viewportWidth&&(h=i.scrollLeft+i.viewportWidth-t),h<i.scrollLeft&&(h=i.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:p,belowTop:u,left:h}}_layoutHorizontalSegmentInPage(e,t,n,i){let a=Math.max(15,t.left-i),l=Math.min(t.left+t.width+i,e.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,u=t.left+n-(c?.scrollX??0);if(u+i>l){let p=u-(l-i);u-=p,n-=p}if(u<a){let p=u-a;u-=p,n-=p}return[n,u]}_layoutBoxInPage(e,t,n,i){let r=e.top-n,s=e.top+e.height,a=ro(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+r-(d?.scrollY??0),u=a.top+s-(d?.scrollY??0),p=yu(l.body),[h,f]=this._layoutHorizontalSegmentInPage(p,a,e.left-i.scrollLeft+this._contentLeft,t),g=22,b=22,v=c>=g,I=u+n<=p.height-b;return this._fixedOverflowWidgets?{fitsAbove:v,aboveTop:Math.max(c,g),fitsBelow:I,belowTop:u,left:f}:{fitsAbove:v,aboveTop:r,fitsBelow:I,belowTop:s,left:h}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new np(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){let t=r(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),n=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,i=r(n,this._affinity,this._lineHeight);return{primary:t,secondary:i};function r(s,a,l){if(!s)return null;let d=e.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,u=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.scrollTop;return new xw(u,c,l)}}_reduceAnchorCoordinates(e,t,n){if(!t)return e;let i=this._context.configuration.options.get(51),r=t.left;return r<e.left?r=Math.max(r,e.left-n+i.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+n-i.typicalFullwidthCharacterWidth),new xw(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;let{primary:t,secondary:n}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=VM(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let i=this._reduceAnchorCoordinates(t,n,this._cachedDomNodeOffsetWidth),r;this.allowEditorOverflow?r=this._layoutBoxInPage(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!r)return null;if(s===2||r.fitsAbove)return{kind:"inViewport",coordinate:new np(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(s===2||r.fitsBelow)return{kind:"inViewport",coordinate:new np(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new np(i.top,i.left)),position:0}:{kind:"inViewport",coordinate:new np(i.top,i.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&VM(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&VM(this._actual.afterRender,this._actual,this._renderData.position)}},tp=class{constructor(e,t){this.modelPosition=e;this.viewPosition=t}},np=class{constructor(e,t){this.top=e;this.left=t}_coordinateBrand=void 0},xw=class{constructor(e,t,n){this.top=e;this.left=t;this.height=n}_anchorCoordinateBrand=void 0};function VM(o,e,...t){try{return o.call(e,...t)}catch{return null}}var _w=class extends Lo{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(e){super(),this._context=e;let t=this._context.configuration.options,n=t.get(147);this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new qe(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1,t=new Set;for(let r of this._selections)t.add(r.positionLineNumber);let n=Array.from(t);n.sort((r,s)=>r-s),Ut(this._cursorLineNumbers,n)||(this._cursorLineNumbers=n,e=!0);let i=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=[];for(let s=t;s<=n;s++){let a=s-t;i[a]=""}if(this._wordWrap){let s=this._renderOne(e,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new A(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new A(d,1)).lineNumber,u=l.convertModelPositionToViewPosition(new A(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,p=Math.max(c,t),h=Math.min(u,n);for(let f=p;f<=h;f++){let g=f-t;i[g]=s}}}let r=this._renderOne(e,!0);for(let s of this._cursorLineNumbers){if(s<t||s>n)continue;let a=s-t;i[a]=r}this._renderData=i}render(e,t){if(!this._renderData)return"";let n=t-e;return n>=this._renderData.length?"":this._renderData[n]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},Lw=class extends _w{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},Dw=class extends _w{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};Io((o,e)=>{let t=o.getColor(U0);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||o.defines(z0)){let n=o.getColor(z0);n&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${n}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${n}; }`),Fd(o.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var kw=class extends Lo{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let l=0,d=t.length;l<d;l++){let c=t[l];c.options.className&&(n[i++]=c)}n=n.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,u=d.options.className;return c<u?-1:c>u?1:M.compareRangesUsingStarts(l.range,d.range)});let r=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=s;l++){let d=l-r;a[d]=""}this._renderWholeLineDecorations(e,n,a),this._renderNormalDecorations(e,n,a),this._renderResult=a}_renderWholeLineDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){let l=t[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,i),u=Math.min(l.range.endLineNumber,r);for(let p=c;p<=u;p++){let h=p-i;n[h]+=d}}}_renderNormalDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=null,s=!1,a=null,l=!1;for(let d=0,c=t.length;d<c;d++){let u=t[d];if(u.options.isWholeLine)continue;let p=u.options.className,h=!!u.options.showIfCollapsed,f=u.range;if(h&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new M(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),r===p&&s===h&&M.areIntersectingOrTouching(a,f)){a=M.plusRange(a,f);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n),r=p,s=h,a=f,l=u.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n)}_renderNormalDecoration(e,t,n,i,r,s,a){let l=e.linesVisibleRangesForRange(t,n==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let u=l[d];if(u.outsideRenderedLine)continue;let p=u.lineNumber-s;if(r&&u.ranges.length===1){let h=u.ranges[0];if(h.width<this._typicalHalfwidthCharacterWidth){let f=Math.round(h.left+h.width/2),g=Math.max(0,Math.round(f-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new Cm(g,this._typicalHalfwidthCharacterWidth)}}for(let h=0,f=u.ranges.length;h<f;h++){let g=i&&u.continuesOnNextLine&&f===1,b=u.ranges[h],v='<div class="cdr '+n+'" style="left:'+String(b.left)+"px;width:"+(g?"100%;":String(b.width)+"px;")+'"></div>';a[p]+=v}}}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};var Rw=class extends qt{scrollbar;scrollbarDomNode;constructor(e,t,n,i){super(e);let r=this._context.configuration.options,s=r.get(105),a=r.get(76),l=r.get(41),d=r.get(108),c={listenOnDomNode:n.domNode,className:"editor-scrollable "+Wf(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new Jd(t.domNode,c,this._context.viewLayout.getScrollable())),ei.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=We(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let u=(p,h,f)=>{let g={};if(h){let b=p.scrollTop;b&&(g.scrollTop=this._context.viewLayout.getCurrentScrollTop()+b,p.scrollTop=0)}if(f){let b=p.scrollLeft;b&&(g.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+b,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(g,1)};this._register(q(n.domNode,"scroll",p=>u(n.domNode,!0,!0))),this._register(q(t.domNode,"scroll",p=>u(t.domNode,!0,!1))),this._register(q(i.domNode,"scroll",p=>u(i.domNode,!0,!1))),this._register(q(this.scrollbarDomNode.domNode,"scroll",p=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let e=this._context.configuration.options,t=e.get(147);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(74).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(105)||e.hasChanged(76)||e.hasChanged(41)){let t=this._context.configuration.options,n=t.get(105),i=t.get(76),r=t.get(41),s=t.get(108),a={vertical:n.vertical,horizontal:n.horizontal,verticalScrollbarSize:n.verticalScrollbarSize,horizontalScrollbarSize:n.horizontalScrollbarSize,scrollByPage:n.scrollByPage,handleMouseWheel:n.handleMouseWheel,mouseWheelScrollSensitivity:i,fastScrollSensitivity:r,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return e.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+Wf(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}};var ip=class{constructor(e,t,n,i,r){this.startLineNumber=e;this.endLineNumber=t;this.className=n;this.tooltip=i;this.zIndex=r??0}_decorationToRenderBrand=void 0;zIndex},UM=class{constructor(e,t,n){this.className=e;this.zIndex=t;this.tooltip=n}},zM=class{decorations=[];add(e){this.decorations.push(e)}getDecorations(){return this.decorations}},Hm=class extends Lo{_render(e,t,n){let i=[];for(let a=e;a<=t;a++){let l=a-e;i[l]=new zM}if(n.length===0)return i;n.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,s=0;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.className,u=d.zIndex,p=Math.max(d.startLineNumber,e)-e,h=Math.min(d.endLineNumber,t)-e;r===c?(p=Math.max(s+1,p),s=Math.max(s,h)):(r=c,s=h);for(let f=p;f<=s;f++)i[f].add(new UM(c,u,d.tooltip))}return i}},Mw=class extends qt{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(e){super(e),this._context=e;let t=this._context.configuration.options,n=t.get(147);this.domNode=We(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){let t=We(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let n=this._widgets[e.getId()];return n.preference.lane===t.lane&&n.preference.zIndex===t.zIndex&&M.equalsRange(n.preference.range,t.range)?!1:(n.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId();if(this._widgets[t]){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(let s of r){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,n),d=Math.min(s.range.endLineNumber,i),c=s.options.glyphMargin?.position??2,u=s.options.zIndex??0;for(let p=l;p<=d;p++){let h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(p,0)),f=this._context.viewModel.glyphLanes.getLanesAtLine(h.lineNumber).indexOf(c);t.push(new KM(p,f,u,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let r of Object.values(this._widgets)){let s=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(M.lift(s));if(!a||!l||l<n||a>i)continue;let d=Math.max(a,n),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(d,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(r.preference.lane);t.push(new GM(d,u,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){let t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((n,i)=>n.lineNumber===i.lineNumber?n.laneIndex===i.laneIndex?n.zIndex===i.zIndex?i.type===n.type?n.type===0&&i.type===0?n.className<i.className?-1:1:0:i.type-n.type:i.zIndex-n.zIndex:n.laneIndex-i.laneIndex:n.lineNumber-i.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let i of Object.values(this._widgets))i.renderInfo=null;let t=new Wi(this._collectSortedGlyphRenderRequests(e)),n=[];for(;t.length>0;){let i=t.peek();if(!i)break;let r=t.takeWhile(a=>a.lineNumber===i.lineNumber&&a.laneIndex===i.laneIndex);if(!r||r.length===0)break;let s=r[0];if(s.type===0){let a=[];for(let l of r){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}n.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=n}render(e){if(!this._glyphMargin){for(let n of Object.values(this._widgets))n.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let n of Object.values(this._widgets))if(!n.renderInfo)n.domNode.setDisplay("none");else{let i=e.viewportData.relativeVerticalOffset[n.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+n.renderInfo.laneIndex*this._lineHeight;n.domNode.setDisplay("block"),n.domNode.setTop(i),n.domNode.setLeft(r),n.domNode.setWidth(t),n.domNode.setHeight(this._lineHeight)}for(let n=0;n<this._decorationGlyphsToRender.length;n++){let i=this._decorationGlyphsToRender[n],r=e.viewportData.relativeVerticalOffset[i.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+i.laneIndex*this._lineHeight,a;n<this._managedDomNodes.length?a=this._managedDomNodes[n]:(a=We(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+i.combinedClassName),a.setPosition("absolute"),a.setTop(r),a.setLeft(s),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var KM=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.className=i}type=0;accept(e){return new jM(this.lineNumber,this.laneIndex,e)}},GM=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.widget=i}type=1},jM=class{constructor(e,t,n){this.lineNumber=e;this.laneIndex=t;this.combinedClassName=n}};var Ow=class extends Lo{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(e){super(),this._context=e,this._primaryPosition=null;let t=this._context.configuration.options,n=t.get(148),i=t.get(51);this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(148),i=t.get(51);return this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){let n=e.selections[0].getPosition();return this._primaryPosition?.equals(n)?!1:(this._primaryPosition=n,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=e.scrollWidth,r=this._primaryPosition,s=this.getGuidesByLine(t,Math.min(n+1,this._context.viewModel.getLineCount()),r),a=[];for(let l=t;l<=n;l++){let d=l-t,c=s[d],u="",p=e.visibleRangeForPosition(new A(l,1))?.left??0;for(let h of c){let f=h.column===-1?p+(h.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new A(l,h.column)).left;if(f>i||this._maxIndentLeft>0&&f>this._maxIndentLeft)break;let g=h.horizontalLine?h.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=h.horizontalLine?(e.visibleRangeForPosition(new A(l,h.horizontalLine.endColumn))?.left??f+this._spaceWidth)-f:this._spaceWidth;u+=`<div class="core-guide ${h.className} ${g}" style="left:${f}px;width:${b}px"></div>`}a[d]=u}this._renderResult=a}getGuidesByLine(e,t,n){let i=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,n,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&n){let u=this._context.viewModel.getActiveIndentGuide(n.lineNumber,e,t);s=u.startLineNumber,a=u.endLineNumber,l=u.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let u=e;u<=t;u++){let p=new Array;c.push(p);let h=i?i[u-e]:[],f=new Wi(h),g=r?r[u-e]:0;for(let b=1;b<=g;b++){let v=(b-1)*d+1,I=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||h.length===0)&&s<=u&&u<=a&&b===l;p.push(...f.takeWhile(S=>S.visibleColumn<v)||[]);let T=f.peek();(!T||T.visibleColumn!==v||T.horizontalLine)&&p.push(new es(v,-1,`core-guide-indent lvl-${(b-1)%30}`+(I?" indent-active":""),null,-1,-1))}p.push(...f.takeWhile(b=>!0)||[])}return c}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};function Um(o){if(!(o&&o.isTransparent()))return o}Io((o,e)=>{let t=[{bracketColor:EC,guideColor:O2,guideColorActive:W2},{bracketColor:TC,guideColor:N2,guideColorActive:V2},{bracketColor:wC,guideColor:A2,guideColorActive:H2},{bracketColor:xC,guideColor:P2,guideColorActive:U2},{bracketColor:_C,guideColor:F2,guideColorActive:z2},{bracketColor:LC,guideColor:B2,guideColorActive:K2}],n=new Gf,i=[{indentColor:f2,indentColorActive:S2},{indentColor:b2,indentColorActive:E2},{indentColor:v2,indentColorActive:T2},{indentColor:y2,indentColorActive:w2},{indentColor:I2,indentColorActive:x2},{indentColor:C2,indentColorActive:_2}],r=t.map(a=>{let l=o.getColor(a.bracketColor),d=o.getColor(a.guideColor),c=o.getColor(a.guideColorActive),u=Um(Um(d)??l?.transparent(.3)),p=Um(Um(c)??l);if(!(!u||!p))return{guideColor:u,guideColorActive:p}}).filter(gl),s=i.map(a=>{let l=o.getColor(a.indentColor),d=o.getColor(a.indentColorActive),c=Um(l),u=Um(d);if(!(!c||!u))return{indentColor:c,indentColorActive:u}}).filter(gl);if(r.length>0){for(let a=0;a<30;a++){let l=r[a%r.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${n.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${n.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${n.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var zm=class o extends Lo{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new A(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let e=this._context.configuration.options;this._lineHeight=e.get(68);let t=e.get(69);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(97);let n=e.get(147);this._lineNumbersLeft=n.lineNumbersLeft,this._lineNumbersWidth=n.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){let t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let n=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,n=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(n=!0),n}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){let t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(e,1));if(t.column!==1)return"";let n=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n);if(this._renderLineNumbers===2){let i=Math.abs(this._lastCursorModelPosition.lineNumber-n);return i===0?'<span class="relative-current-line-number">'+n+"</span>":String(i)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===n||n%10===0)return String(n);let i=this._context.viewModel.getLineCount();return n===i?String(n):""}return String(n)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}let t=Wt?this._lineHeight%2===0?" lh-even":" lh-odd":"",n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(d=>!!d.options.lineNumberClassName);r.sort((d,c)=>M.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=n;d<=i;d++){let c=d-n,u=this._getLineRenderLineNumber(d),p="";for(;s<r.length&&r[s].range.endLineNumber<d;)s++;for(let h=s;h<r.length;h++){let{range:f,options:g}=r[h];f.startLineNumber<=d&&(p+=" "+g.lineNumberClassName)}if(!u&&!p){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeLineNumber&&(p+=" active-line-number"),l[c]=`<div class="${o.CLASS_NAME}${t}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};Io((o,e)=>{let t=o.getColor(g2),n=o.getColor(L2);n?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${n}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});var qM=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new M(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}},$M=class{constructor(e,t,n,i,r,s,a){this.minimalReveal=e;this.lineNumber=t;this.startColumn=n;this.endColumn=i;this.startScrollTop=r;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=t,this.maxLineNumber=t}type="range";minLineNumber;maxLineNumber},YM=class{constructor(e,t,n,i,r){this.minimalReveal=e;this.selections=t;this.startScrollTop=n;this.stopScrollTop=i;this.scrollType=r;let s=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,d=t.length;l<d;l++){let c=t[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},Nw=class o extends qt{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(e,t){super(e);let n=this._context.configuration,i=this._context.configuration.options,r=i.get(51),s=i.get(148);this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=i.get(102),this._cursorSurroundingLines=i.get(29),this._cursorSurroundingLinesStyle=i.get(30),this._canUseLayerHinting=!i.get(32),this._viewLineOptions=new uv(n,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Sm({createLine:()=>new Qs(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,ei.write(this.domNode,8),this.domNode.setClassName(`view-lines ${ql}`),tn(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new ln(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new ln(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new qM,this._horizontalRevealRequest=null,this._stickyScrollEnabled=i.get(117).enabled,this._maxNumberStickyLines=i.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(148)&&(this._maxLineWidth=0);let t=this._context.configuration.options,n=t.get(51),i=t.get(148);return this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.isViewportWrapping,this._revealHorizontalRightPadding=t.get(102),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(117).enabled,this._maxNumberStickyLines=t.get(117).maxLineCount,tn(this.domNode,n),this._onOptionsMaybeChanged(),e.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let e=this._context.configuration,t=new uv(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=!1;for(let r=t;r<=n;r++)i=this._visibleLines.getVisibleLine(r).onSelectionChanged()||i;return i}onDecorationsChanged(e){{let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){let t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let n=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?n={scrollTop:n.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new $M(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new YM(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;let r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-n.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(n,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){let t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),n=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>n)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){let n=this._getViewLineDomNode(e);if(n===null)return null;let i=this._getLineNumberFor(n);if(i===-1||i<1||i>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(i)===1)return new A(i,1);let r=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(i<r||i>s)return null;let a=this._visibleLines.getVisibleLine(i).getColumnOfNodeOffset(e,t),l=this._context.viewModel.getLineMinColumn(i);return a<l&&(a=l),new A(i,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Qs.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){let r=this._visibleLines.getVisibleLine(i);if(e===r.getDomNode())return i}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();if(e<t||e>n)return-1;let i=new Em(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;let n=e.endLineNumber,i=M.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!i)return null;let r=[],s=0,a=new Em(this.domNode.domNode,this._textRangeRestingSpot),l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(i.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=i.startLineNumber;u<=i.endLineNumber;u++){if(u<d||u>c)continue;let p=u===i.startLineNumber?i.startColumn:1,h=u!==i.endLineNumber,f=h?this._context.viewModel.getLineMaxColumn(u):i.endColumn,g=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,p,f,a);if(g){if(t&&u<n){let b=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(u+1,1)).lineNumber,b!==l&&(g.ranges[g.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[s++]=new BT(g.outsideRenderedLine,u,Cm.from(g.ranges),h)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:r}_visibleRangesForLineRange(e,t,n){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;let i=new Em(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,n,i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}visibleRangeForPosition(e){let t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new WT(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=1,r=!0;for(let s=t;s<=n;s++){let a=this._visibleLines.getVisibleLine(s);if(e&&!a.getWidthIsFast()){r=!1;continue}i=Math.max(i,a.getWidth(null))}return r&&t===1&&n===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(i),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1,n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++){let s=this._visibleLines.getVisibleLine(r);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let n=this._horizontalRevealRequest;if(e.startLineNumber<=n.minLineNumber&&n.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let i=this._computeScrollLeftToReveal(n);i&&(this._isViewportWrapping||this._ensureMaxLineWidth(i.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:i.scrollLeft},n.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Wt&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,n,i,r,s){let a=e.top,l=e.height,d=a+l,c,u,p;if(r&&r.length>0){let v=r[0].startLineNumber,I=r[0].endLineNumber;for(let T=1,S=r.length;T<S;T++){let C=r[T];v=Math.min(v,C.startLineNumber),I=Math.max(I,C.endLineNumber)}c=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(v),p=this._context.viewLayout.getVerticalOffsetForLineNumber(I)+this._lineHeight}else if(i)c=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),p=this._context.viewLayout.getVerticalOffsetForLineNumber(i.endLineNumber)+this._lineHeight;else return-1;let h=(t==="mouse"||n)&&this._cursorSurroundingLinesStyle==="default",f=0,g=0;if(h)n||(f=this._lineHeight);else{let v=l/this._lineHeight,I=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),T=Math.min(v/2,I);f=T*this._lineHeight,g=Math.max(0,T-1)*this._lineHeight}n||(s===0||s===4)&&(g+=this._lineHeight),u-=f,p+=g;let b;if(p-u>l){if(!c)return-1;b=u}else if(s===5||s===6)if(s===6&&a<=u&&p<=d)b=a;else{let v=Math.max(5*this._lineHeight,l*.2),I=u-v,T=p-l;b=Math.max(T,I)}else if(s===1||s===2)if(s===2&&a<=u&&p<=d)b=a;else{let v=(u+p)/2;b=Math.max(0,v-l/2)}else b=this._computeMinimumScrolling(a,d,u,p,s===3,s===4);return b}_computeScrollLeftToReveal(e){let t=this._context.viewLayout.getCurrentViewport(),n=this._context.configuration.options.get(147),i=t.left,r=i+t.width-n.verticalScrollbarWidth,s=1073741824,a=0;if(e.type==="range"){let d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let u of c.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(s=Math.max(0,s-o.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(i,r,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,n,i,r,s){e=e|0,t=t|0,n=n|0,i=i|0,r=!!r,s=!!s;let a=t-e;if(i-n<a){if(r)return n;if(s)return Math.max(0,i-a);if(n<e)return n;if(i>t)return Math.max(0,i-a)}else return n;return e}};var Aw=class extends Hm{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(e){super(),this._context=e;let n=this._context.configuration.options.get(147);this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(n[i++]=new ip(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(n[i++]=new ip(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+s+'px;"></div>',l=[];for(let d=t;d<=n;d++){let c=d-t,u=i[c].getDecorations(),p="";for(let h of u){let f='<div class="cldr '+h.className;h.tooltip!==null&&(f+='" title="'+h.tooltip),f+=a,p+=f}l[c]=p}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Km=class o extends qt{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._domNode=We(document.createElement("div")),this._domNode.setClassName(o.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=We(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(o.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);let n=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(n),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(n)}};var Pw=class extends Hm{_context;_renderResult;constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.marginClassName,d=a.options.zIndex;l&&(n[i++]=new ip(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=[];for(let s=t;s<=n;s++){let a=s-t,l=i[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';r[a]=d}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Js=class o{_rgba8Brand=void 0;static Empty=new o(0,0,0,0);r;g;b;a;constructor(e,t,n,i){this.r=o._clamp(e),this.g=o._clamp(t),this.b=o._clamp(n),this.a=o._clamp(i)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};var MU=(()=>{let o=[];for(let e=32;e<=126;e++)o.push(e);return o.push(65533),o})(),OU=(o,e)=>(o-=32,o<0||o>96?e<=2?(o+96)%96:95:o);var Cv=class o{constructor(e,t){this.scale=t;this.charDataNormal=o.soften(e,12/15),this.charDataLight=o.soften(e,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(e,t){let n=new Uint8ClampedArray(e.length);for(let i=0,r=e.length;i<r;i++)n[i]=Pc(e[i]*t);return n}renderChar(e,t,n,i,r,s,a,l,d,c,u){let p=1*this.scale,h=2*this.scale,f=u?1:h;if(t+p>e.width||n+f>e.height){console.warn("bad render request outside image data");return}let g=c?this.charDataLight:this.charDataNormal,b=OU(i,d),v=e.width*4,I=a.r,T=a.g,S=a.b,C=r.r-I,w=r.g-T,x=r.b-S,D=Math.max(s,l),O=e.data,H=b*p*h,K=n*v+t*4;for(let z=0;z<f;z++){let ie=K;for(let Se=0;Se<p;Se++){let J=g[H++]/255*(s/255);O[ie++]=I+C*J,O[ie++]=T+w*J,O[ie++]=S+x*J,O[ie++]=D}K+=v}}blockRenderChar(e,t,n,i,r,s,a,l){let d=1*this.scale,c=2*this.scale,u=l?1:c;if(t+d>e.width||n+u>e.height){console.warn("bad render request outside image data");return}let p=e.width*4,h=.5*(r/255),f=s.r,g=s.g,b=s.b,v=i.r-f,I=i.g-g,T=i.b-b,S=f+v*h,C=g+I*h,w=b+T*h,x=Math.max(r,a),D=e.data,O=n*p+t*4;for(let H=0;H<u;H++){let K=O;for(let z=0;z<d;z++)D[K++]=S,D[K++]=C,D[K++]=w,D[K++]=x;O+=p}}};var Gm=class o extends F{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=dd(new o)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new k;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(or.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let e=or.getColorMap();if(!e){this._colors=[Js.Empty],this._backgroundIsLight=!0;return}this._colors=[Js.Empty];for(let n=1;n<e.length;n++){let i=e[n].rgba;this._colors[n]=new Js(i.r,i.g,i.b,Math.round(i.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};var AU={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},PU=o=>{let e=new Uint8ClampedArray(o.length/2);for(let t=0;t<o.length;t+=2)e[t>>1]=AU[o[t]]<<4|AU[o[t+1]]&15;return e},ZM={1:vs(()=>PU("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:vs(()=>PU("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var Fw=class o{static lastCreated;static lastFontFamily;static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let n;return ZM[e]?n=new Cv(ZM[e](),e):n=o.createFromSampleData(o.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=n,n}static createSampleData(e){let t=document.createElement("canvas"),n=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",n.fillStyle="#ffffff",n.font=`bold 16px ${e}`,n.textBaseline="middle";let i=0;for(let r of MU)n.fillText(String.fromCharCode(r),i,16/2),i+=10;return n.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){let n=16*10*4*96;if(e.length!==n)throw new Error("Unexpected source in MinimapCharRenderer");let i=o._downsample(e,t);return new Cv(i,t)}static _downsampleChar(e,t,n,i,r){let s=1*r,a=2*r,l=i,d=0;for(let c=0;c<a;c++){let u=c/a*16,p=(c+1)/a*16;for(let h=0;h<s;h++){let f=h/s*10,g=(h+1)/s*10,b=0,v=0;for(let T=u;T<p;T++){let S=t+Math.floor(T)*3840,C=1-(T-Math.floor(T));for(let w=f;w<g;w++){let x=1-(w-Math.floor(w)),D=S+Math.floor(w)*4,O=x*C;v+=O,b+=e[D]*e[D+3]/255*O}}let I=b/v;d=Math.max(d,I),n[l++]=Pc(I)}}return d}static _downsample(e,t){let n=2*t*1*t,i=n*96,r=new Uint8ClampedArray(i),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(e,a,r,s,t)),s+=n,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<i;c++)r[c]*=d}return r}};var FU=pt?'"Segoe WPC", "Segoe UI", sans-serif':Fe?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var eG=140,tG=2,Bw=class o{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(e,t,n){let i=e.options,r=i.get(145),s=i.get(147),a=s.minimap,l=i.get(51),d=i.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=i.get(107),this.paddingTop=i.get(85).top,this.paddingBottom=i.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=i.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=FU,this.sectionHeaderFontSize=d.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=o._getSectionHeaderColor(t,n.getColor(1)),this.charRenderer=vs(()=>Fw.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=n.getColor(2),this.backgroundColor=o._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=o._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){let n=e.getColor(rB);return n?new Js(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}static _getMinimapForegroundOpacity(e){let t=e.getColor(sB);return t?Js._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){let n=e.getColor(Ta);return n?new Js(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}},QM=class o{constructor(e,t,n,i,r,s,a,l,d){this.scrollTop=e;this.scrollHeight=t;this.sliderNeeded=n;this._computedSliderRatio=i;this.sliderTop=r;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumber,e.endLineNumber);return t>n?null:[t,n]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,n,i,r,s,a,l,d,c,u){let p=e.pixelRatio,h=e.minimapLineHeight,f=Math.floor(e.canvasInnerHeight/h),g=e.lineHeight;if(e.minimapHeightIsEditorHeight){let w=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(w+=Math.max(0,r-e.lineHeight-e.paddingBottom));let x=Math.max(1,Math.floor(r*r/w)),D=Math.max(0,e.minimapHeight-x),O=D/(c-r),H=d*O,K=D>0,z=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),ie=Math.floor(e.paddingTop/e.lineHeight);return new o(d,c,K,O,H,x,ie,1,Math.min(a,z))}let b;if(s&&n!==a){let w=n-t+1;b=Math.floor(w*h/p)}else{let w=r/g;b=Math.floor(w*h/p)}let v=Math.floor(e.paddingTop/g),I=Math.floor(e.paddingBottom/g);if(e.scrollBeyondLastLine){let w=r/g;I=Math.max(I,w-1)}let T;if(I>0){let w=r/g;T=(v+a+I-w-1)*h/p}else T=Math.max(0,(v+a)*h/p-b);T=Math.min(e.minimapHeight-b,T);let S=T/(c-r),C=d*S;if(f>=v+a+I){let w=T>0;return new o(d,c,w,S,C,b,v,1,a)}else{let w;t>1?w=t+v:w=Math.max(1,d/g);let x,D=Math.max(1,Math.floor(w-C*p/h));D<v?(x=v-D+1,D=1):(x=0,D=Math.max(1,D-v)),u&&u.scrollHeight===c&&(u.scrollTop>d&&(D=Math.min(D,u.startLineNumber),x=Math.max(x,u.topPaddingLineCount)),u.scrollTop<d&&(D=Math.max(D,u.startLineNumber),x=Math.min(x,u.topPaddingLineCount)));let O=Math.min(a,D-x+f-1),H=(d-i)/g,K;return d>=e.paddingTop?K=(t-D+x+H)*h/p:K=d/e.paddingTop*(x+H)*h/p,new o(d,c,!0,S,K,b,x,D,O)}}},Ww=class o{static INVALID=new o(-1);dy;constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},Vw=class{renderedLayout;_imageData;_renderedLines;constructor(e,t,n){this.renderedLayout=e,this._imageData=t,this._renderedLines=new sv({createLine:()=>Ww.INVALID}),this._renderedLines._set(e.startLineNumber,n)}linesEquals(e){if(!this.scrollEquals(e))return!1;let n=this._renderedLines._get().lines;for(let i=0,r=n.length;i<r;i++)if(n[i].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){let e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}},XM=class o{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(e,t,n,i){this._backgroundFillData=o._createBackgroundFillData(t,n,i),this._buffers=[e.createImageData(t,n),e.createImageData(t,n)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,n){let i=n.r,r=n.g,s=n.b,a=n.a,l=new Uint8ClampedArray(e*t*4),d=0;for(let c=0;c<t;c++)for(let u=0;u<e;u++)l[d]=i,l[d+1]=r,l[d+2]=s,l[d+3]=a,d+=4;return l}},Hw=class o{constructor(e,t){this.samplingRatio=e;this.minimapLines=t}static compute(e,t,n){if(e.renderMinimap===0||!e.isSampling)return[null,[]];let{minimapLineCount:i}=gf.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/i,s=r/2;if(!n||n.minimapLines.length===0){let b=[];if(b[0]=1,i>1){for(let v=0,I=i-1;v<I;v++)b[v]=Math.round(v*r+s);b[i-1]=t}return[new o(r,b),[]]}let a=n.minimapLines,l=a.length,d=[],c=0,u=0,p=1,h=10,f=[],g=null;for(let b=0;b<i;b++){let v=Math.max(p,Math.round(b*r)),I=Math.max(v,Math.round((b+1)*r));for(;c<l&&a[c]<v;){if(f.length<h){let S=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:S,deleteToLineNumber:S},f.push(g)),u--}c++}let T;if(c<l&&a[c]<=I)T=a[c],c++;else if(b===0?T=1:b+1===i?T=t:T=Math.round(b*r+s),f.length<h){let S=c+1+u;g&&g.type==="inserted"&&g._i===b-1?g.insertToLineNumber++:(g={type:"inserted",_i:b,insertFromLineNumber:S,insertToLineNumber:S},f.push(g)),u++}d[b]=T,p=T}if(f.length<h)for(;c<l;){let b=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:b,deleteToLineNumber:b},f.push(g)),u--,c++}else f=[{type:"flush"}];return[new o(r,d),f]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e)-1;for(;n>0&&this.minimapLines[n-1]>=e;)n--;let i=this.modelLineToMinimapLine(t)-1;for(;i+1<this.minimapLines.length&&this.minimapLines[i+1]<=t;)i++;if(n===i){let r=this.minimapLines[n];if(r<e||r>t)return null}return[n+1,i+1]}decorationLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e),i=this.modelLineToMinimapLine(t);return e!==t&&i===n&&(i===this.minimapLines.length?n>1&&n--:i++),[n,i]}onLinesDeleted(e){let t=e.toLineNumber-e.fromLineNumber+1,n=this.minimapLines.length,i=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),n=Math.min(n,r),i=Math.max(i,r)):this.minimapLines[r]-=t;return[n,i]}onLinesInserted(e){let t=e.toLineNumber-e.fromLineNumber+1;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<e.fromLineNumber);n--)this.minimapLines[n]+=t}},Uw=class extends qt{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new Qo(10,1.5);_actual;constructor(e){super(e),this.tokensColorTracker=Gm.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Bw(this._context.configuration,this._context.theme,this.tokensColorTracker);let[t]=Hw.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new JM(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let e=new Bw(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){let t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){let[t,n]=this._samplingState.onLinesDeleted(e);return t<=n&&this._actual.onLinesChanged(t+1,n-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(let n of e.ranges){let i=this._samplingState.modelLineRangeToMinimapLineRange(n.fromLineNumber,n.toLineNumber);i&&t.push({fromLineNumber:i[0],toLineNumber:i[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),n=this._samplingState.modelLineToMinimapLine(n));let i={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:n,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(i)}_recreateLineSampling(){this._minimapSelections=null;let e=!!this._samplingState,[t,n]=Hw.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(let i of n)switch(i.type){case"deleted":this._actual.onLinesDeleted(i.deleteFromLineNumber,i.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(i.insertFromLineNumber,i.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,n){if(this._samplingState){let i=[];for(let r=0,s=t-e+1;r<s;r++)n[r]?i[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):i[r]=null;return i}return this._context.viewModel.getMinimapLinesRenderingData(e,t,n).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let e of this._selections){let[t,n]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new qe(t,e.startColumn,n,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let n=this._getMinimapDecorationsInViewport(e,t).filter(i=>!i.options.minimap?.sectionHeaderStyle);if(this._samplingState){let i=[];for(let r of n){if(!r.options.minimap)continue;let s=r.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);i.push(new em(new M(a,s.startColumn,l,s.endColumn),r.options))}return i}return n}getSectionHeaderDecorationsInViewport(e,t){let n=this.options.minimapLineHeight,r=this.options.sectionHeaderFontSize/n;return e=Math.floor(Math.max(1,e-r)),this._getMinimapDecorationsInViewport(e,t).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let n;if(this._samplingState){let i=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];n=new M(i,1,r,this._context.viewModel.getLineMaxColumn(r))}else n=new M(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(n)}getSectionHeaderText(e,t){let n=e.options.minimap?.sectionHeaderText;if(!n)return null;let i=this._sectionHeaderCache.get(n);if(i)return i;let r=t(n);return this._sectionHeaderCache.set(n,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new M(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}},JM=class o extends F{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(e,t){super(),this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(A0),this._domNode=We(document.createElement("div")),ei.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=We(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=We(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=We(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=We(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=We(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=hn(this._domNode.domNode,he.POINTER_DOWN,n=>{if(n.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(n.button===0&&this._lastRenderData){let d=ro(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(n,c,this._lastRenderData.renderedLayout)}return}let r=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*n.offsetY,l=Math.floor(s/r)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new Ba,this._sliderPointerDownListener=hn(this._slider.domNode,he.POINTER_DOWN,n=>{n.preventDefault(),n.stopPropagation(),n.button===0&&this._lastRenderData&&this._startSliderDragging(n,n.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Nn.addTarget(this._domNode.domNode),this._sliderTouchStartListener=q(this._domNode.domNode,wt.Start,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(n))},{passive:!1}),this._sliderTouchMoveListener=q(this._domNode.domNode,wt.Change,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(n)},{passive:!1}),this._sliderTouchEndListener=hn(this._domNode.domNode,wt.End,n=>{n.preventDefault(),n.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,n){if(!e.target||!(e.target instanceof Element))return;let i=e.pageX;this._slider.toggleClassName("active",!0);let r=(s,a)=>{let l=ro(this._domNode.domNode),d=Math.min(Math.abs(a-i),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(pt&&d>eG){this._model.setScrollTop(n.scrollTop);return}let c=s-t;this._model.setScrollTop(n.getDesiredScrollTopFromDelta(c))};e.pageY!==t&&r(e.pageY,i),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>r(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){let t=this._domNode.domNode.getBoundingClientRect().top,n=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(n)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new XM(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(A0),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let n=QM.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(n.sliderNeeded?"block":"none"),this._slider.setTop(n.sliderTop),this._slider.setHeight(n.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(n.sliderHeight),this.renderDecorations(n),this._lastRenderData=this.renderLines(n)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;let t=this._model.getSelections();t.sort(M.compareRangesUsingStarts);let n=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);n.sort((p,h)=>(p.options.zIndex||0)-(h.options.zIndex||0));let{canvasInnerWidth:i,canvasInnerHeight:r}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,i,r);let c=new zw(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(d,t,c,e,s),this._renderDecorationsLineHighlights(d,n,c,e,s);let u=new zw(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(d,t,u,e,s,l,a,i),this._renderDecorationsHighlights(d,n,u,e,s,l,a,i),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,n,i,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of t){let d=i.intersectWithViewport(l);if(!d)continue;let[c,u]=d;for(let f=c;f<=u;f++)n.set(f,!0);let p=i.getYForLineNumber(c,r),h=i.getYForLineNumber(u,r);a>=p||(a>s&&e.fillRect(xs,s,e.canvas.width,a-s),s=p),a=h}a>s&&e.fillRect(xs,s,e.canvas.width,a-s)}_renderDecorationsLineHighlights(e,t,n,i,r){let s=new Map;for(let a=t.length-1;a>=0;a--){let l=t[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=i.intersectWithViewport(l.range);if(!c)continue;let[u,p]=c,h=d.getColor(this._theme.value);if(!h||h.isTransparent())continue;let f=s.get(h.toString());f||(f=h.transparent(.5).toString(),s.set(h.toString(),f)),e.fillStyle=f;for(let g=u;g<=p;g++){if(n.has(g))continue;n.set(g,!0);let b=i.getYForLineNumber(u,r);e.fillRect(xs,b,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,n,i,r,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of t){let c=i.intersectWithViewport(d);if(!c)continue;let[u,p]=c;for(let h=u;h<=p;h++)this.renderDecorationOnLine(e,n,d,this._selectionColor,i,h,r,r,s,a,l)}}_renderDecorationsHighlights(e,t,n,i,r,s,a,l){for(let d of t){let c=d.options.minimap;if(!c)continue;let u=i.intersectWithViewport(d.range);if(!u)continue;let[p,h]=u,f=c.getColor(this._theme.value);if(!(!f||f.isTransparent()))for(let g=p;g<=h;g++)switch(c.position){case 1:this.renderDecorationOnLine(e,n,d.range,f,i,g,r,r,s,a,l);continue;case 2:{let b=i.getYForLineNumber(g,r);this.renderDecoration(e,f,2,b,tG,r);continue}}}}renderDecorationOnLine(e,t,n,i,r,s,a,l,d,c,u){let p=r.getYForLineNumber(s,l);if(p+a<0||p>this._model.options.canvasInnerHeight)return;let{startLineNumber:h,endLineNumber:f}=n,g=h===s?n.startColumn:1,b=f===s?n.endColumn:this._model.getLineMaxColumn(s),v=this.getXOffsetForPosition(t,s,g,d,c,u),I=this.getXOffsetForPosition(t,s,b,d,c,u);this.renderDecoration(e,i,v,p,I-v,a)}getXOffsetForPosition(e,t,n,i,r,s){if(n===1)return xs;if((n-1)*r>=s)return s;let l=e.get(t);if(!l){let d=this._model.getLineContent(t);l=[xs];let c=xs;for(let u=1;u<d.length+1;u++){let p=d.charCodeAt(u-1),h=p===9?i*r:Dr(p)?2*r:r,f=c+h;if(f>=s){l[u]=s;break}l[u]=f,c=f}e.set(t,l)}return n-1<l.length?l[n-1]:s}renderDecoration(e,t,n,i,r,s){e.fillStyle=t&&t.toString()||"",e.fillRect(n,i,r,s)}_renderSectionHeaders(e){let t=this._model.options.minimapLineHeight,n=this._model.options.sectionHeaderFontSize,i=this._model.options.sectionHeaderLetterSpacing,r=n*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,u=c,p=this._decorationsCanvas.domNode.getContext("2d");p.letterSpacing=i+"px",p.font="500 "+n+"px "+this._model.options.sectionHeaderFontFamily,p.strokeStyle=u,p.lineWidth=.2;let h=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);h.sort((g,b)=>g.range.startLineNumber-b.range.startLineNumber);let f=o._fitSectionHeader.bind(null,p,s-xs);for(let g of h){let b=e.getYForLineNumber(g.range.startLineNumber,t)+n,v=b-n,I=v+2,T=this._model.getSectionHeaderText(g,f);o._renderSectionLabel(p,T,g.options.minimap?.sectionHeaderStyle===2,l,c,s,v,r,b,I)}}static _fitSectionHeader(e,t,n){if(!n)return n;let i="\u2026",r=e.measureText(n).width,s=e.measureText(i).width;if(r<=t||r<=s)return n;let a=n.length,l=r/n.length,d=Math.floor((t-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(n[c-1]);)--c;return n.substring(0,c)+i+n.substring(a-(d-c))}static _renderSectionLabel(e,t,n,i,r,s,a,l,d,c){t&&(e.fillStyle=i,e.fillRect(0,a,s,l),e.fillStyle=r,e.fillText(t,xs,d)),n&&(e.beginPath(),e.moveTo(0,c),e.lineTo(s,c),e.closePath(),e.stroke())}renderLines(e){let t=e.startLineNumber,n=e.endLineNumber,i=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){let J=this._lastRenderData._get();return new Vw(e,J.imageData,J.lines)}let r=this._getBuffer();if(!r)return null;let[s,a,l]=o._renderUntouchedLines(r,e.topPaddingLineCount,t,n,i,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(t,n,l),c=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,p=this._model.options.backgroundColor,h=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,g=f.backgroundIsLight(),b=this._model.options.renderMinimap,v=this._model.options.charRenderer(),I=this._model.options.fontScale,T=this._model.options.minimapCharWidth,C=(b===1?2:3)*I,w=i>C?Math.floor((i-C)/2):0,x=p.a/255,D=new Js(Math.round((p.r-u.r)*x+u.r),Math.round((p.g-u.g)*x+u.g),Math.round((p.b-u.b)*x+u.b),255),O=e.topPaddingLineCount*i,H=[];for(let J=0,X=n-t+1;J<X;J++)l[J]&&o._renderLine(r,D,p.a,g,b,T,f,h,v,O,w,c,d[J],I,i),H[J]=new Ww(O),O+=i;let K=s===-1?0:s,ie=(a===-1?r.height:a)-K;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,K,r.width,ie),new Vw(e,r,H)}static _renderUntouchedLines(e,t,n,i,r,s){let a=[];if(!s){for(let O=0,H=i-n+1;O<H;O++)a[O]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,u=l.lines,p=u.length,h=e.width,f=e.data,g=(i-n+1)*r*h*4,b=-1,v=-1,I=-1,T=-1,S=-1,C=-1,w=t*r;for(let O=n;O<=i;O++){let H=O-n,K=O-c,z=K>=0&&K<p?u[K].dy:-1;if(z===-1){a[H]=!0,w+=r;continue}let ie=z*h*4,Se=(z+r)*h*4,J=w*h*4,X=(w+r)*h*4;T===ie&&C===J?(T=Se,C=X):(I!==-1&&(f.set(d.subarray(I,T),S),b===-1&&I===0&&I===S&&(b=T),v===-1&&T===g&&I===S&&(v=I)),I=ie,T=Se,S=J,C=X),a[H]=!1,w+=r}I!==-1&&(f.set(d.subarray(I,T),S),b===-1&&I===0&&I===S&&(b=T),v===-1&&T===g&&I===S&&(v=I));let x=b===-1?-1:b/(h*4),D=v===-1?-1:v/(h*4);return[x,D,a]}static _renderLine(e,t,n,i,r,s,a,l,d,c,u,p,h,f,g){let b=h.content,v=h.tokens,I=e.width-s,T=g===1,S=xs,C=0,w=0;for(let x=0,D=v.getCount();x<D;x++){let O=v.getEndOffset(x),H=v.getForeground(x),K=a.getColor(H);for(;C<O;C++){if(S>I)return;let z=b.charCodeAt(C);if(z===9){let ie=p-(C+w)%p;w+=ie-1,S+=ie*s}else if(z===32)S+=s;else{let ie=Dr(z)?2:1;for(let Se=0;Se<ie;Se++)if(r===2?d.blockRenderChar(e,S,c+u,K,l,t,n,T):d.renderChar(e,S,c+u,z,K,l,t,n,f,i,T),S+=s,S>I)return}}}}},zw=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(e,t,n){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=n,this._values=[];for(let i=0,r=this._endLineNumber-this._startLineNumber+1;i<r;i++)this._values[i]=n}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}};var Kw=class extends qt{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(e,t){super(e),this._viewDomNode=t;let i=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=We(document.createElement("div")),ei.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=We(document.createElement("div")),ei.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,!0}addWidget(e){let t=We(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){let n=this._widgets[e.getId()],i=t?t.preference:null,r=t?.stackOridinal;return n.preference===i&&n.stack===r?(this._updateMaxMinWidth(),!1):(n.preference=i,n.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0,t=Object.keys(this._widgets);for(let n=0,i=t.length;n<i;n++){let r=t[n],a=this._widgets[r].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){let n=e.domNode;if(e.preference===null){n.setTop("");return}let i=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){let r=n.domNode.clientHeight;n.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else n.setTop(0);e.stack!==void 0?(n.setTop(t[e.preference]),t[e.preference]+=n.domNode.clientWidth):n.setRight(i)}else if(e.preference===2)n.domNode.style.right="50%",e.stack!==void 0?(n.setTop(t[2]),t[2]+=n.domNode.clientHeight):n.setTop(0);else{let{top:r,left:s}=e.preference;if(this._context.configuration.options.get(43)&&e.widget.allowEditorOverflow){let l=this._viewDomNodeRect;n.setTop(r+l.top),n.setLeft(s+l.left),n.setPosition("fixed")}else n.setTop(r),n.setLeft(s),n.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=ro(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);let t=Object.keys(this._widgets),n=Array.from({length:3},()=>0);t.sort((i,r)=>(this._widgets[i].stack||0)-(this._widgets[r].stack||0));for(let i=0,r=t.length;i<r;i++){let s=t[i];this._renderWidget(this._widgets[s],n)}}};var eO=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(e,t){let n=e.options;this.lineHeight=n.get(68),this.pixelRatio=n.get(145),this.overviewRulerLanes=n.get(84),this.renderBorder=n.get(83);let i=t.getColor(D2);this.borderColor=i?i.toString():null,this.hideCursor=n.get(60);let r=t.getColor(vh);this.cursorColorSingle=r?r.transparent(.7).toString():null;let s=t.getColor(IC);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=t.getColor(CC);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;let l=n.get(74),d=l.enabled,c=l.side,u=t.getColor(k2),p=or.getDefaultBackground();u?this.backgroundColor=u:d&&c==="right"?this.backgroundColor=p:this.backgroundColor=null;let f=n.get(147).overviewRuler;this.top=f.top,this.right=f.right,this.domWidth=f.width,this.domHeight=f.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[g,b]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=g,this.w=b}_initLanes(e,t,n){let i=t-e;if(n>=3){let r=Math.floor(i/3),s=Math.floor(i/3),a=i-r-s,l=e,d=l+r,c=l+r+a;return[[0,l,d,l,c,l,d,l],[0,r,a,r+a,s,r+a+s,a+s,r+a+s]]}else if(n===2){let r=Math.floor(i/2),s=i-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,s,r+s,r+s,r+s]]}else{let r=e,s=i;return[[0,r,r,r,r,r,r,r],[0,s,s,s,s,s,s,s]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&V.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}};var Gw=class extends qt{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(e){super(e),this._domNode=We(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=or.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new A(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){let t=new eO(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,n=e.selections.length;t<n;t++){let i=this._settings.cursorColorSingle;n>1&&(i=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:i})}return this._cursorPositions.sort((t,n)=>A.compare(t.position,n.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){let e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?V.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}let t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Du.compareByRenderingProps),this._actualShouldRender===1&&!Du.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!Ut(this._renderedCursorPositions,this._cursorPositions,(f,g)=>f.position.lineNumber===g.position.lineNumber&&f.color===g.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let n=this._settings.canvasWidth,i=this._settings.canvasHeight,r=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=i/a,d=6*this._settings.pixelRatio|0,c=d/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=V.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):(u.clearRect(0,0,n,i),u.fillStyle=V.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):u.clearRect(0,0,n,i);let p=this._settings.x,h=this._settings.w;for(let f of t){let g=f.color,b=f.data;u.fillStyle=g;let v=0,I=0,T=0;for(let S=0,C=b.length/3;S<C;S++){let w=b[3*S],x=b[3*S+1],D=b[3*S+2],O=s.getVerticalOffsetForLineNumber(x)*l|0,H=(s.getVerticalOffsetForLineNumber(D)+r)*l|0;if(H-O<d){let z=(O+H)/2|0;z<c?z=c:z+c>i&&(z=i-c),O=z-c,H=z+c}O>T+1||w!==v?(S!==0&&u.fillRect(p[v],I,h[v],T-I),v=w,I=O,T=H):H>T&&(T=H)}u.fillRect(p[v],I,h[v],T-I)}if(!this._settings.hideCursor){let f=2*this._settings.pixelRatio|0,g=f/2|0,b=this._settings.x[7],v=this._settings.w[7],I=-100,T=-100,S=null;for(let C=0,w=this._cursorPositions.length;C<w;C++){let x=this._cursorPositions[C].color;if(!x)continue;let D=this._cursorPositions[C].position,O=s.getVerticalOffsetForLineNumber(D.lineNumber)*l|0;O<g?O=g:O+g>i&&(O=i-g);let H=O-g,K=H+f;H>T+1||x!==S?(C!==0&&S&&u.fillRect(b,I,v,T-I),I=H,T=K):K>T&&(T=K),S=x,u.fillStyle=x}S&&u.fillRect(b,I,v,T-I)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,i),u.moveTo(1,0),u.lineTo(n,0),u.stroke())}};var jw=class extends ls{_context;_domNode;_zoneManager;constructor(e,t){super(),this._context=e;let n=this._context.configuration.options;this._domNode=We(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new QS(i=>this._context.viewLayout.getVerticalOffsetForLineNumber(i)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(n.get(68)),this._zoneManager.setPixelRatio(n.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return e.hasChanged(68)&&(this._zoneManager.setLineHeight(t.get(68)),this._render()),e.hasChanged(145)&&(this._zoneManager.setPixelRatio(t.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),n=this._zoneManager.resolveColorZones(),i=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),n.length>0&&this._renderOneLane(r,n,i,e),!0}_renderOneLane(e,t,n,i){let r=0,s=0,a=0;for(let l of t){let d=l.colorId,c=l.from,u=l.to;d!==r?(e.fillRect(0,s,i,a-s),r=d,e.fillStyle=n[r],s=c,a=u):a>=c?a=Math.max(a,u):(e.fillRect(0,s,i,a-s),s=c,a=u)}e.fillRect(0,s,i,a-s)}};var qw=class extends qt{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(e){super(e),this.domNode=We(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let t=this._context.configuration.options;this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){let e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){let{tabSize:i}=this._context.viewModel.model.getOptions(),r=i,s=t-e;for(;s>0;){let a=We(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let n=e-t;for(;n>0;){let i=this._renderedRulers.pop();this.domNode.removeChild(i),n--}}render(e){this._ensureRulersCount();for(let t=0,n=this._rulers.length;t<n;t++){let i=this._renderedRulers[t],r=this._rulers[t];i.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}};var $w=class extends qt{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let n=this._context.configuration.options.get(105);this._useShadows=n.useShadows,this._domNode=We(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let t=this._context.configuration.options.get(147);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){let n=this._context.configuration.options.get(105);return this._useShadows=n.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var tO=class{left;width;startStyle;endStyle;constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}},nO=class{lineNumber;ranges;constructor(e,t){this.lineNumber=e,this.ranges=t}};function nG(o){return new tO(o)}function iG(o){return new nO(o.lineNumber,o.ranges.map(nG))}var Zw=class o extends Lo{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,n=e.length;t<n;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,n){let i=this._typicalHalfwidthCharacterWidth/4,r=null,s=null;if(n&&n.length>0&&t.length>0){let a=t[0].lineNumber;if(a===e.startLineNumber)for(let d=0;!r&&d<n.length;d++)n[d].lineNumber===a&&(r=n[d].ranges[0]);let l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let d=n.length-1;!s&&d>=0;d--)n[d].lineNumber===l&&(s=n[d].ranges[0]);r&&!r.startStyle&&(r=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=t.length;a<l;a++){let d=t[a].ranges[0],c=d.left,u=d.left+d.width,p={top:0,bottom:0},h={top:0,bottom:0};if(a>0){let f=t[a-1].ranges[0].left,g=t[a-1].ranges[0].left+t[a-1].ranges[0].width;Yw(c-f)<i?p.top=2:c>f&&(p.top=1),Yw(u-g)<i?h.top=2:f<u&&u<g&&(h.top=1)}else r&&(p.top=r.startStyle.top,h.top=r.endStyle.top);if(a+1<l){let f=t[a+1].ranges[0].left,g=t[a+1].ranges[0].left+t[a+1].ranges[0].width;Yw(c-f)<i?p.bottom=2:f<c&&c<g&&(p.bottom=1),Yw(u-g)<i?h.bottom=2:u<g&&(h.bottom=1)}else s&&(p.bottom=s.startStyle.bottom,h.bottom=s.endStyle.bottom);d.startStyle=p,d.endStyle=h}}_getVisibleRangesWithStyle(e,t,n){let r=(t.linesVisibleRangesForRange(e,!0)||[]).map(iG);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,n),r}_createSelectionPiece(e,t,n,i,r){return'<div class="cslr '+n+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+i.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,n,i){if(i.length===0)return;let r=!!i[0].ranges[0].startStyle,s=i[0].lineNumber,a=i[i.length-1].lineNumber;for(let l=0,d=i.length;l<d;l++){let c=i[l],u=c.lineNumber,p=u-t,h=n&&u===s?1:0,f=n&&u!==s&&u===a?1:0,g="",b="";for(let v=0,I=c.ranges.length;v<I;v++){let T=c.ranges[v];if(r){let C=T.startStyle,w=T.endStyle;if(C.top===1||C.bottom===1){g+=this._createSelectionPiece(h,f,o.SELECTION_CLASS_NAME,T.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH);let x=o.EDITOR_BACKGROUND_CLASS_NAME;C.top===1&&(x+=" "+o.SELECTION_TOP_RIGHT),C.bottom===1&&(x+=" "+o.SELECTION_BOTTOM_RIGHT),g+=this._createSelectionPiece(h,f,x,T.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH)}if(w.top===1||w.bottom===1){g+=this._createSelectionPiece(h,f,o.SELECTION_CLASS_NAME,T.left+T.width,o.ROUNDED_PIECE_WIDTH);let x=o.EDITOR_BACKGROUND_CLASS_NAME;w.top===1&&(x+=" "+o.SELECTION_TOP_LEFT),w.bottom===1&&(x+=" "+o.SELECTION_BOTTOM_LEFT),g+=this._createSelectionPiece(h,f,x,T.left+T.width,o.ROUNDED_PIECE_WIDTH)}}let S=o.SELECTION_CLASS_NAME;if(r){let C=T.startStyle,w=T.endStyle;C.top===0&&(S+=" "+o.SELECTION_TOP_LEFT),C.bottom===0&&(S+=" "+o.SELECTION_BOTTOM_LEFT),w.top===0&&(S+=" "+o.SELECTION_TOP_RIGHT),w.bottom===0&&(S+=" "+o.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(h,f,S,T.left,T.width)}e[p][0]+=g,e[p][1]+=b}}_previousFrameVisibleRangesWithStyle=[];prepareRender(e){let t=[],n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let s=n;s<=i;s++){let a=s-n;t[a]=["",""]}let r=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){r[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[s]);r[s]=d,this._actualRenderOneSelection(t,n,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([s,a])=>s+a)}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};Io((o,e)=>{let t=o.getColor(KF);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function Yw(o){return o<0?-o:o}var Qw=class o extends qt{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(e){super(e);let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new pv(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=We(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Ls,this._cursorFlatBlinkInterval=new Wh,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let n=0,i=this._secondaryCursors.length;n<i;n++)this._secondaryCursors[n].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,n){let i=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&n!==3;if(this._primaryCursor.setPlurality(t.length?1:0),this._primaryCursor.onCursorPositionChanged(e,i),this._updateBlinking(),this._secondaryCursors.length<t.length){let r=t.length-this._secondaryCursors.length;for(let s=0;s<r;s++){let a=new pv(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){let r=this._secondaryCursors.length-t.length;for(let s=0;s<r;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],i)}onCursorStateChanged(e){let t=[];for(let i=0,r=e.selections.length;i<r;i++)t[i]=e.selections[i].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);let n=e.selections[0].isEmpty();return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=n=>{for(let i=0,r=e.ranges.length;i<r;i++)if(e.ranges[i].fromLineNumber<=n.lineNumber&&n.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(let n of this._secondaryCursors)if(t(n.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let e=this._getCursorBlinking(),t=e===0,n=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!n&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},o.BLINK_INTERVAL,Ce(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},o.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case 1:e+=" cursor-line-style";break;case 2:e+=" cursor-block-style";break;case 3:e+=" cursor-underline-style";break;case 4:e+=" cursor-line-thin-style";break;case 5:e+=" cursor-block-outline-style";break;case 6:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,n=this._secondaryCursors.length;t<n;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],n=0,i=this._primaryCursor.render(e);i&&(t[n++]=i);for(let r=0,s=this._secondaryCursors.length;r<s;r++){let a=this._secondaryCursors[r].render(e);a&&(t[n++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};Io((o,e)=>{let t=[{class:".cursor",foreground:vh,background:yC},{class:".cursor-primary",foreground:IC,background:h2},{class:".cursor-secondary",foreground:CC,background:m2}];for(let n of t){let i=o.getColor(n.foreground);if(i){let r=o.getColor(n.background);r||(r=i.opposite()),e.addRule(`.monaco-editor .cursors-layer ${n.class} { background-color: ${i}; border-color: ${i}; color: ${r}; }`),Fd(o.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${n.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});var iO=()=>{throw new Error("Invalid change accessor")},Xw=class extends qt{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this.domNode=We(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=We(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=this._context.viewLayout.getWhitespaces(),t=new Map;for(let i of e)t.set(i.id,i);let n=!1;return this._context.viewModel.changeWhitespace(i=>{let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let u=t.get(l);u&&(u.afterLineNumber!==c.afterViewLineNumber||u.height!==c.heightInPx)&&(i.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),n=!0)}}),n}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,e.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new A(s,this._context.viewModel.model.getLineMaxColumn(s))}let n;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});let i=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(n);return{isInHiddenArea:!r,afterViewLineNumber:i.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(n=>{let i={addZone:r=>(t=!0,this._addZone(n,r)),removeZone:r=>{r&&(t=this._removeZone(n,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(n,r)||t)}};oG(e,i),i.addZone=iO,i.removeZone=iO,i.layoutZone=iO}),t}_addZone(e,t){let n=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(n.afterViewLineNumber,this._getZoneOrdinal(t),n.heightInPx,n.minWidthInPx),delegate:t,isInHiddenArea:n.isInHiddenArea,isVisible:!1,domNode:We(t.domNode),marginDomNode:t.marginDomNode?We(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,n.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t];return delete this._zones[t],e.removeWhitespace(n.whitespaceId),n.domNode.removeAttribute("monaco-visible-view-zone"),n.domNode.removeAttribute("monaco-view-zone"),n.domNode.domNode.remove(),n.marginDomNode&&(n.marginDomNode.removeAttribute("monaco-visible-view-zone"),n.marginDomNode.removeAttribute("monaco-view-zone"),n.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t],i=this._computeWhitespaceProps(n.delegate);return n.isInHiddenArea=i.isInHiddenArea,e.changeOneWhitespace(n.whitespaceId,i.afterViewLineNumber,i.heightInPx),this._safeCallOnComputedHeight(n.delegate,i.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(n){je(n)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(n){je(n)}}prepareRender(e){}render(e){let t=e.viewportData.whitespaceViewportData,n={},i=!1;for(let s of t)this._zones[s.id].isInHiddenArea||(n[s.id]=s,i=!0);let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=0,u=0,p="none";n.hasOwnProperty(l)?(c=n[l].verticalOffset-e.bigNumbersDelta,u=n[l].height,p="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(n[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(u),d.domNode.setDisplay(p),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(u),d.marginDomNode.setDisplay(p))}i&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function oG(o,e){try{return o(e)}catch(t){je(t)}}var Jw=class extends Lo{_context;_options;_selection;_renderResult;constructor(e){super(),this._context=e,this._options=new ex(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=new ex(this._context.configuration);return this._options.equals(t)?e.hasChanged(147):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber-t+1,r=new Array(i);for(let a=0;a<i;a++)r[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,r);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){let l=a-e.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let u=this._selection;for(let p of u){if(p.endLineNumber<a||p.startLineNumber>a)continue;let h=p.startLineNumber===a?p.startColumn:d.minColumn,f=p.endLineNumber===a?p.endColumn:d.maxColumn;h<f&&(c||(c=[]),c.push(new Tm(h-1,f-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,c,d)}}_applyRenderWhitespace(e,t,n,i){if(this._options.renderWhitespace==="selection"&&!n||this._options.renderWhitespace==="trailing"&&i.continuesWithWrappedLine)return"";let r=this._context.theme.getColor(SC),s=this._options.renderWithSVG,a=i.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=i.continuesWithWrappedLine,c=i.minColumn-1,u=this._options.renderWhitespace==="boundary",p=this._options.renderWhitespace==="trailing",h=this._options.lineHeight,f=this._options.middotWidth,g=this._options.wsmiddotWidth,b=this._options.spaceWidth,v=Math.abs(g-b),I=Math.abs(f-b),T=v<I?11825:183,S=this._options.canUseHalfwidthRightwardsArrow,C="",w=!1,x=fn(a),D;x===-1?(w=!0,x=l,D=l):D=_r(a);let O=0,H=n&&n[O],K=0;for(let z=c;z<l;z++){let ie=a.charCodeAt(z);if(H&&z>=H.endOffset&&(O++,H=n&&n[O]),ie!==9&&ie!==32||p&&!w&&z<=D)continue;if(u&&z>=x&&z<=D&&ie===32){let J=z-1>=0?a.charCodeAt(z-1):0,X=z+1<l?a.charCodeAt(z+1):0;if(J!==32&&X!==32)continue}if(u&&d&&z===l-1){let J=z-1>=0?a.charCodeAt(z-1):0;if(ie===32&&J!==32&&J!==9)continue}if(n&&(!H||H.startOffset>z||H.endOffset<=z))continue;let Se=e.visibleRangeForPosition(new A(t,z+1));Se&&(s?(K=Math.max(K,Se.left),ie===9?C+=this._renderArrow(h,b,Se.left):C+=`<circle cx="${(Se.left+b/2).toFixed(2)}" cy="${(h/2).toFixed(2)}" r="${(b/7).toFixed(2)}" />`):ie===9?C+=`<div class="mwh" style="left:${Se.left}px;height:${h}px;">${S?"\uFFEB":"\u2192"}</div>`:C+=`<div class="mwh" style="left:${Se.left}px;height:${h}px;">${String.fromCharCode(T)}</div>`)}return s?(K=Math.round(K+b),`<svg style="bottom:0;position:absolute;width:${K}px;height:${h}px" viewBox="0 0 ${K} ${h}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+C+"</svg>"):C}_renderArrow(e,t,n){let i=t/7,r=t,s=e/2,a=n,l={x:0,y:i/2},d={x:100/125*r,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},u={x:c.x+.1*d.x,y:c.y+.1*d.x},p={x:u.x+.35*d.x,y:u.y-.35*d.x},h={x:p.x,y:-p.y},f={x:u.x,y:-u.y},g={x:c.x,y:-c.y},b={x:d.x,y:-d.y},v={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,u,p,h,f,g,b,v].map(S=>`${(a+S.x).toFixed(2)} ${(s+S.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}},ex=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(e){let t=e.options,n=t.get(51),i=t.get(39);i==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):i==="svg"?(this.renderWhitespace=t.get(101),this.renderWithSVG=!0):(this.renderWhitespace=t.get(101),this.renderWithSVG=!1),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(68),this.stopRenderingLineAfter=t.get(119)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}};var jm=class extends qt{};var oO=class{_onDidChange=new k;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},rO=new oO;var aO=class{constructor(e,t,n,i,r){this._context=e;this.modelLineNumber=t;this.distanceToModelLineStart=n;this.widthOfHiddenLineTextBefore=i;this.distanceToModelLineEnd=r}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(e){let t=new A(this.modelLineNumber,this.distanceToModelLineStart+1),n=new A(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},sO=Vn,qm=class extends jm{constructor(t,n,i,r,s){super(t);this._keybindingService=r;this._instantiationService=s;this._viewController=n,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new qe(1,1,1,1)],this._modelSelections=[new qe(1,1,1,1)],this._lastRenderPosition=null,this.textArea=We(document.createElement("textarea")),ei.write(this.textArea,7),this.textArea.setClassName(`inputarea ${ql}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",yv(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",m("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=We(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:h=>this._context.viewModel.getLineMaxColumn(h),getValueInRange:(h,f)=>this._context.viewModel.getValueInRange(h,f),getValueLengthInRange:(h,f)=>this._context.viewModel.getValueLengthInRange(h,f),modifyPosition:(h,f)=>this._context.viewModel.modifyPosition(h,f)},u={getDataToCopy:()=>bw(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let f=this._selections[0];if(Fe&&f.isEmpty()){let b=f.getStartPosition(),v=this._getWordBeforePosition(b);if(v.length===0&&(v=this._getCharacterBeforePosition(b)),v.length>0)return new ii(v,v.length,v.length,M.fromPositions(b),0)}if(Fe&&!f.isEmpty()&&c.getValueLengthInRange(f,0)<500){let b=c.getValueInRange(f,0);return new ii(b,0,b.length,f,0)}if(Ko&&!f.isEmpty()){let b="vscode-placeholder";return new ii(b,0,b.length,null,void 0)}return ii.EMPTY}if($k){let f=this._selections[0];if(f.isEmpty()){let g=f.getStartPosition(),[b,v]=this._getAndroidWordAtPosition(g);if(b.length>0)return new ii(b,v,v,M.fromPositions(g),0)}return ii.EMPTY}let h=Wm.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return ii.fromScreenReaderContentState(h)},deduceModelPosition:(h,f,g)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(h,f,g)},p=this._register(new vw(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(Vm,u,p,$r,{isAndroid:$k,isChrome:Kd,isFirefox:Vn,isSafari:Ko})),this._register(this._textAreaInput.onKeyDown(h=>{this._viewController.emitKeyDown(h)})),this._register(this._textAreaInput.onKeyUp(h=>{this._viewController.emitKeyUp(h)})),this._register(this._textAreaInput.onPaste(h=>{let f=!1,g=null,b=null;h.metadata&&(f=this._emptySelectionClipboard&&!!h.metadata.isFromEmptySelection,g=typeof h.metadata.multicursorText<"u"?h.metadata.multicursorText:null,b=h.metadata.mode),this._viewController.paste(h.text,f,g,b)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(h=>{h.replacePrevCharCnt||h.replaceNextCharCnt||h.positionDelta?($o&&console.log(` => compositionType: <<${h.text}>>, ${h.replacePrevCharCnt}, ${h.replaceNextCharCnt}, ${h.positionDelta}`),this._viewController.compositionType(h.text,h.replacePrevCharCnt,h.replaceNextCharCnt,h.positionDelta)):($o&&console.log(` => type: <<${h.text}>>`),this._viewController.type(h.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(h=>{this._viewController.setSelection(h)})),this._register(this._textAreaInput.onCompositionStart(h=>{let f=this.textArea.domNode,g=this._modelSelections[0],{distanceToModelLineStart:b,widthOfHiddenTextBefore:v}=(()=>{let T=f.value.substring(0,Math.min(f.selectionStart,f.selectionEnd)),S=T.lastIndexOf(`
`),C=T.substring(S+1),w=C.lastIndexOf("	"),x=C.length-w-1,D=g.getStartPosition(),O=Math.min(D.column-1,x),H=D.column-1-O,K=C.substring(0,C.length-O),{tabSize:z}=this._context.viewModel.model.getOptions(),ie=rG(this.textArea.domNode.ownerDocument,K,this._fontInfo,z);return{distanceToModelLineStart:H,widthOfHiddenTextBefore:ie}})(),{distanceToModelLineEnd:I}=(()=>{let T=f.value.substring(Math.max(f.selectionStart,f.selectionEnd)),S=T.indexOf(`
`),C=S===-1?T:T.substring(0,S),w=C.indexOf("	"),x=w===-1?C.length:C.length-w-1,D=g.getEndPosition(),O=Math.min(this._context.viewModel.model.getLineMaxColumn(D.lineNumber)-D.column,x);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(D.lineNumber)-D.column-O}})();this._context.viewModel.revealRange("keyboard",!0,M.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new aO(this._context,g.startLineNumber,b,v,I),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${ql} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(h=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${ql}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(rO.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(t){t.appendChild(this.textArea),t.appendChild(this.textAreaCover)}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(t){let n='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(t.lineNumber),r=ya(n,[]),s=!0,a=t.column,l=!0,d=t.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let u=i.charCodeAt(a-2);r.get(u)!==0?s=!1:a--}if(l&&d>i.length&&(l=!1),l){let u=i.charCodeAt(d-1);r.get(u)!==0?l=!1:d++}c++}return[i.substring(a-1,d-1),t.column-a]}_getWordBeforePosition(t){let n=this._context.viewModel.getLineContent(t.lineNumber),i=ya(this._context.configuration.options.get(133),[]),r=t.column,s=0;for(;r>1;){let a=n.charCodeAt(r-2);if(i.get(a)!==0||s>50)return n.substring(r-1,t.column-1);s++,r--}return n.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){let i=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!rn(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);let n=t.get(3);this._accessibilitySupport===2&&n===Zr.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=n;let r=t.get(147).wrappingColumn;if(r!==-1&&this._accessibilitySupport!==1){let s=t.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(r*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=sO?0:1}onConfigurationChanged(t){let n=this._context.configuration.options,i=n.get(147);this._setAccessibilityOptions(n),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=n.get(51),this._lineHeight=n.get(68),this._emptySelectionClipboard=n.get(38),this._copyWithSyntaxHighlighting=n.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:r}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${r*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",yv(n,this._keybindingService)),this.textArea.setAttribute("aria-required",n.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(n.get(126))),(t.hasChanged(34)||t.hasChanged(93))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){let t=this._context.configuration.options;!rO.enabled||t.get(34)&&t.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new A(1,1);_primaryCursorVisibleRange=null;prepareRender(t){this._primaryCursorPosition=new A(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let i=this._visibleTextArea.visibleTextareaStart,r=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&i&&r&&r.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=Iv(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+i.left-this._scrollLeft,p=r.left-i.left+1;if(u<this._contentLeft){let I=this._contentLeft-u;u+=I,c+=I,p-=I}p>this._contentWidth&&(p=this._contentWidth);let h=this._context.viewModel.getViewLineData(s.lineNumber),f=h.tokens.findTokenIndexAtOffset(s.column-1),g=h.tokens.findTokenIndexAtOffset(a.column-1),b=f===g,v=this._visibleTextArea.definePresentation(b?h.tokens.getPresentation(f):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:u,width:p,height:this._lineHeight,useCover:!1,color:(or.getColorMap()||[])[v.foreground],italic:v.italic,bold:v.bold,underline:v.underline,strikethrough:v.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let n=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(n<0||n>this._contentHeight){this._renderAtTopLeft();return}if(Fe||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??Iv(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:sO?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:sO?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;let n=this.textArea,i=this.textAreaCover;tn(n,this._fontInfo),n.setTop(t.top),n.setLeft(t.left),n.setWidth(t.width),n.setHeight(t.height),n.setColor(t.color?V.Format.CSS.formatHex(t.color):""),n.setFontStyle(t.italic?"italic":""),t.bold&&n.setFontWeight("bold"),n.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),i.setTop(t.useCover?t.top:0),i.setLeft(t.useCover?t.left:0),i.setWidth(t.useCover?t.width:0),i.setHeight(t.useCover?t.height:0);let r=this._context.configuration.options;r.get(58)?i.setClassName("monaco-editor-background textAreaCover "+Km.OUTER_CLASS_NAME):r.get(69).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+zm.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};qm=P([_(3,Qn),_(4,Qe)],qm);function rG(o,e,t,n){if(e.length===0)return 0;let i=o.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";let r=o.createElement("span");tn(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${n*t.spaceWidth}px`,r.append(e),i.appendChild(r),o.body.appendChild(i);let s=r.offsetWidth;return i.remove(),s}var tx=Q("clipboardService");var nx=class extends F{constructor(t,n){super();this._domNode=t;this._onFocusChange=n;this._register(q(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(q(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(t){this._isFocused!==t&&(this._isFocused=t,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function $m(o,e,t,n){return o.addEventListener(e,t,n),{dispose(){o.removeEventListener(e,t)}}}var Ym=class{constructor(e,t,n){this._domNode=e;this._context=t;this._keybindingService=n;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new qe(1,1,1,1);_screenReaderContentState;onConfigurationChanged(e){this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let e=this._context.configuration.options,t=e.get(147);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._fontInfo=e.get(51),this._lineHeight=e.get(68),this._accessibilitySupport=e.get(2),this._accessibilityPageSize=e.get(3)}_updateDomAttributes(){let e=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",yv(e,this._keybindingService));let t=this._context.viewModel.model.getOptions().tabSize,n=e.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${t*n}px`}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new qe(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent()}render(e){if(!this._screenReaderContentState)return;tn(this._domNode,this._fontInfo);let t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),n=this._context.viewLayout.getCurrentScrollTop(),i=t-n;this._domNode.setTop(i),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let r=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=Iv(r);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let e=this._accessibilitySupport===1?1:this._accessibilityPageSize,t={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:n=>this._context.viewModel.getLineMaxColumn(n),getValueInRange:(n,i)=>this._context.viewModel.getValueInRange(n,i),getValueLengthInRange:(n,i)=>this._context.viewModel.getValueLengthInRange(n,i),modifyPosition:(n,i)=>this._context.viewModel.modifyPosition(n,i)};return Wm.fromEditorSelection(t,this._primarySelection,e,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(e,t){let i=$d().document.getSelection();if(!i)return;let r=this._domNode.domNode.firstChild;if(!r)return;let s=$d().document.activeElement,a=new globalThis.Range;a.setStart(r,e),a.setEnd(r,t),i.removeAllRanges(),i.addRange(a),On(s)&&s.focus()}};Ym=P([_(2,Qn)],Ym);var Zm=class extends jm{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new qe(1,1,1,1);_textStartPositionWithinEditor=new A(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(e,t,n,i){super(e),this.domNode=new Cu(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new nx(this.domNode.domNode,r=>this._context.viewModel.setHasFocus(r))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=n.createInstance(Ym,this.domNode,e),this._register(q(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(i))),this._register(q(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(i),t.cut()})),this._register(q(this.domNode.domNode,"keyup",r=>t.emitKeyUp(new gt(r)))),this._register(q(this.domNode.domNode,"keydown",async r=>{let s=new gt(r);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(t,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),t.emitKeyDown(s)})),this._register($m(this._editContext,"textformatupdate",r=>this._handleTextFormatUpdate(r))),this._register($m(this._editContext,"characterboundsupdate",r=>this._updateCharacterBounds())),this._register($m(this._editContext,"textupdate",r=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=M.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(t,r),this._screenReaderSupport.writeScreenReaderContent()})),this._register($m(this._editContext,"compositionstart",r=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=M.fromPositions(s,s);this._compositionRangeWithinEditor=a,t.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register($m(this._editContext,"compositionend",r=>{this._compositionRangeWithinEditor=void 0,t.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(e){e.appendChild(this.domNode),this._parent=e.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._renderingContext=e,this._screenReaderSupport.prepareRender(e),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new qe(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(126)))}_updateEditContext(){let e=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._textStartPositionWithinEditor=e.textStartPositionWithinEditor}_emitTypeEvent(e,t){if(!this._editContext)return;let n=this._context.viewModel.model,i=n.getOffsetAt(this._textStartPositionWithinEditor),r=n.getOffsetAt(this._primarySelection.getEndPosition()),s=n.getOffsetAt(this._primarySelection.getStartPosition()),a=r-i,l=s-i,d=0,c=0;t.updateRangeEnd>a&&(d=t.updateRangeEnd-a),t.updateRangeStart<l&&(c=l-t.updateRangeStart);let u="";l<t.updateRangeStart&&(u+=this._editContext.text.substring(l,t.updateRangeStart)),u+=t.text,a>t.updateRangeEnd&&(u+=this._editContext.text.substring(t.updateRangeEnd,a));let p={text:u,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(e,p);let h=l-c+u.length;this._updateCursorStatesAfterType(h,t.selectionStart,t.selectionEnd)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_updateCursorStatesAfterType(e,t,n){let i=t-e,r=n-e,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,u=d.column;return new qe(c,u+i,c,u+r)}).map(d=>Ye.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let e=this._primarySelection.startColumn-1,t=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?t+=this._primarySelection.endColumn-1:t+=this._context.viewModel.model.getLineMaxColumn(a);let n=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),i=new M(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,n),r=this._context.viewModel.model.getValueInRange(i,0),s=i.getStartPosition();return{text:r,selectionStartOffset:e,selectionEndOffset:t,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(e){if(!this._editContext)return;let t=e.getTextFormats(),n=this._textStartPositionWithinEditor,i=[];t.forEach(r=>{let s=this._context.viewModel.model,a=s.getOffsetAt(n),l=s.getPositionAt(a+r.rangeStart),d=s.getPositionAt(a+r.rangeEnd),c=M.fromPositions(l,d),u=["edit-context-format-decoration",`underline-style-${r.underlineStyle.toLowerCase()}`,`underline-thickness-${r.underlineThickness.toLowerCase()}`];i.push({range:c,options:{description:"textFormatDecoration",inlineClassName:u.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,i)}_updateSelectionAndControlBounds(){if(!this._parent)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=i.top+r-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*t,d=i.left+n,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let h=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];h.length>0&&(d+=Math.min(...h.map(f=>Math.min(...f.ranges.map(g=>g.left)))))}c=e.get(51).typicalHalfwidthCharacterWidth/2}else c=i.width-n;let u=new DOMRect(d,a,c,l),p=u;this._editContext.updateControlBounds(p),this._editContext.updateSelectionBounds(u)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(r.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=i.top+s-a,d=[];if(this._renderingContext){let f=this._renderingContext.linesVisibleRangesForRange(r,!0)??[];for(let g of f)for(let b of g.ranges)d.push(new DOMRect(i.left+n+b.left,l,b.width,t))}let c=this._context.viewModel.model,u=c.getOffsetAt(this._textStartPositionWithinEditor),h=c.getOffsetAt(r.getStartPosition())-u;this._editContext.updateCharacterBounds(h,d)}_ensureClipboardGetsEditorSelection(e){let t=this._context.configuration.options,n=t.get(38),i=t.get(25),r=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=bw(this._context.viewModel,r,n,i),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};ep.INSTANCE.set(Vn?s.text.replace(/\r\n/g,`
`):s.text,a),e.writeText(s.text)}};Zm=P([_(2,Qe),_(3,tx)],Zm);var Qm=class extends ls{constructor(t,n,i,r,s,a,l){super();this._instantiationService=l;this._selections=[new qe(1,1,1,1)],this._renderAnimationFrame=null;let d=new fw(n,r,s,t);this._context=new VT(n,i,r),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(Zm,this._context,d):this._instantiationService.createInstance(qm,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=We(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=We(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=We(document.createElement("div")),ei.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new Rw(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new Nw(this._context,this._linesContent),this._viewZones=new Xw(this._context),this._viewParts.push(this._viewZones);let u=new Gw(this._context);this._viewParts.push(u);let p=new $w(this._context);this._viewParts.push(p);let h=new Sw(this._context);this._viewParts.push(h),h.addDynamicOverlay(new Lw(this._context)),h.addDynamicOverlay(new Zw(this._context)),h.addDynamicOverlay(new Ow(this._context)),h.addDynamicOverlay(new kw(this._context)),h.addDynamicOverlay(new Jw(this._context));let f=new Ew(this._context);this._viewParts.push(f),f.addDynamicOverlay(new Dw(this._context)),f.addDynamicOverlay(new Pw(this._context)),f.addDynamicOverlay(new Aw(this._context)),f.addDynamicOverlay(new zm(this._context)),this._glyphMarginWidgets=new Mw(this._context),this._viewParts.push(this._glyphMarginWidgets);let g=new Km(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(f.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new ww(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new Qw(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new Kw(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let b=new qw(this._context);this._viewParts.push(b);let v=new Tw(this._context);this._viewParts.push(v);let I=new Uw(this._context);if(this._viewParts.push(I),u){let T=this._scrollbar.getOverviewRulerLayoutInfo();T.parent.insertBefore(u.getDomNode(),T.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(I.getDomNode()),this._overflowGuardContainer.appendChild(v.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new Iw(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let t=this._context.viewModel.model,n=this._context.viewModel.glyphLanes,i=[],r=0;i=i.concat(t.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return r=Math.max(r,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=t.validateRange(s.preference.range);return r=Math.max(r,a.endLineNumber),{range:a,lane:s.preference.lane}})),i.sort((s,a)=>M.compareRangesUsingStarts(s.range,a.range)),n.reset(r);for(let s of i)n.push(s.lane,s.range,s.persist);return n}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._editContext.domNode.domNode.dispatchEvent(t)},getLastRenderData:()=>{let t=this._viewCursors.getLastRenderData()||[],n=this._editContext.getLastRenderData();return new qT(t,n)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,n)),visibleRangeForPosition:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new A(t,n))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){let n=this._context.configuration.options.get(147);this.domNode.setWidth(n.width),this.domNode.setHeight(n.height),this._overflowGuardContainer.setWidth(n.width),this._overflowGuardContainer.setHeight(n.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let t=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+Wf(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new $e;if(this._renderAnimationFrame===null){let t=this._createCoordinatedRendering();this._renderAnimationFrame=lO.INSTANCE.scheduleCoordinatedRendering({window:Ce(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new $e;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new $e;return t.renderText()},prepareRender:(n,i)=>{if(this._store.isDisposed)throw new $e;return t.prepareRender(n,i)},render:(n,i)=>{if(this._store.isDisposed)throw new $e;return t.render(n,i)}})}}_flushAccumulatedAndRenderNow(){let t=this._createCoordinatedRendering();fc(()=>t.prepareRenderText());let n=fc(()=>t.renderText());if(n){let[i,r]=n;fc(()=>t.prepareRender(i,r)),fc(()=>t.render(i,r))}}_getViewPartsToRender(){let t=[],n=0;for(let i of this._viewParts)i.shouldRender()&&(t[n++]=i);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}jl.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;let n=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(n.startLineNumber,n.endLineNumber,n.centeredLineNumber);let i=new PT(this._selections,n,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new FT(this._context.viewLayout,i,this._viewLines)]},prepareRender:(t,n)=>{for(let i of t)i.prepareRender(n)},render:(t,n)=>{for(let i of t)i.render(n),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,n){let i=this._context.viewModel.model.validatePosition({lineNumber:t,column:n}),r=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new A(r.lineNumber,r.column));return s?s.left:-1}getTargetAtClientPoint(t,n){let i=this._pointerHandler.getTargetAtClientPoint(t,n);return i?Fm.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new jw(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,n){if(n){this._viewLines.forceShouldRender();for(let i of this._viewParts)i.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._editContext.writeScreenReaderContent(t)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(t){this._editContext.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){this._contentWidgets.setWidgetPosition(t.widget,t.position?.position??null,t.position?.secondaryPosition??null,t.position?.preference??null,t.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){this._overlayWidgets.setWidgetPosition(t.widget,t.position)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){let n=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,n)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};Qm=P([_(6,Qe)],Qm);function fc(o){try{return o()}catch(e){return je(e),null}}var lO=class o{static INSTANCE=new o;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{let t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(let[n,i]of this._animationFrameRunners)i.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){let t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,r1(e,t,100))}}_onRenderScheduled(){let e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let n of e)fc(()=>n.prepareRenderText());let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=fc(()=>r.renderText())}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;fc(()=>r.prepareRender(a,l))}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;fc(()=>r.render(a,l))}}};var aG=hc("domLineBreaksComputer",{createHTML:o=>o}),ix=class o{constructor(e){this.targetWindow=e}static create(e){return new o(new WeakRef(e))}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>lG(pn(this.targetWindow.deref()),s,e,t,n,i,r,a)}}};function lG(o,e,t,n,i,r,s,a){function l(O){let H=a[O];if(H){let K=Bo.applyInjectedText(e[O],H),z=H.map(Se=>Se.options),ie=H.map(Se=>Se.column-1);return new Nl(ie,z,[K.length],[],0)}else return null}if(i===-1){let O=[];for(let H=0,K=e.length;H<K;H++)O[H]=l(H);return O}let d=Math.round(i*t.typicalHalfwidthCharacterWidth),c=r===3?2:r===2?1:0,u=Math.round(n*c),p=Math.ceil(t.spaceWidth*u),h=document.createElement("div");tn(h,t);let f=new va(1e4),g=[],b=[],v=[],I=[],T=[];for(let O=0;O<e.length;O++){let H=Bo.applyInjectedText(e[O],a[O]),K=0,z=0,ie=d;if(r!==0)if(K=fn(H),K===-1)K=0;else{for(let le=0;le<K;le++){let re=H.charCodeAt(le)===9?n-z%n:1;z+=re}let X=Math.ceil(t.spaceWidth*z);X+t.typicalFullwidthCharacterWidth>d?(K=0,z=0):ie=d-X}let Se=H.substr(K),J=dG(Se,z,n,ie,f,p);g[O]=K,b[O]=z,v[O]=Se,I[O]=J[0],T[O]=J[1]}let S=f.build(),C=aG?.createHTML(S)??S;h.innerHTML=C,h.style.position="absolute",h.style.top="10000",s==="keepAll"?(h.style.wordBreak="keep-all",h.style.overflowWrap="anywhere"):(h.style.wordBreak="inherit",h.style.overflowWrap="break-word"),o.document.body.appendChild(h);let w=document.createRange(),x=Array.prototype.slice.call(h.children,0),D=[];for(let O=0;O<e.length;O++){let H=x[O],K=cG(w,H,v[O],I[O]);if(K===null){D[O]=l(O);continue}let z=g[O],ie=b[O]+u,Se=T[O],J=[];for(let ee=0,Te=K.length;ee<Te;ee++)J[ee]=Se[K[ee]];if(z!==0)for(let ee=0,Te=K.length;ee<Te;ee++)K[ee]+=z;let X,le,re=a[O];re?(X=re.map(ee=>ee.options),le=re.map(ee=>ee.column-1)):(X=null,le=null),D[O]=new Nl(le,X,K,J,ie)}return h.remove(),D}function dG(o,e,t,n,i,r){if(r!==0){let p=String(r);i.appendString('<div style="text-indent: -'),i.appendString(p),i.appendString("px; padding-left: "),i.appendString(p),i.appendString("px; box-sizing: border-box; width:")}else i.appendString('<div style="width:');i.appendString(String(n)),i.appendString('px;">');let s=o.length,a=e,l=0,d=[],c=[],u=0<s?o.charCodeAt(0):0;i.appendString("<span>");for(let p=0;p<s;p++){p!==0&&p%16384===0&&i.appendString("</span><span>"),d[p]=l,c[p]=a;let h=u;u=p+1<s?o.charCodeAt(p+1):0;let f=1,g=1;switch(h){case 9:f=t-a%t,g=f;for(let b=1;b<=f;b++)b<f?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 32:u===32?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 60:i.appendString("&lt;");break;case 62:i.appendString("&gt;");break;case 38:i.appendString("&amp;");break;case 0:i.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:i.appendCharCode(65533);break;default:Dr(h)&&g++,h<32?i.appendCharCode(9216+h):i.appendCharCode(h)}l+=f,a+=g}return i.appendString("</span>"),d[o.length]=l,c[o.length]=a,i.appendString("</div>"),[d,c]}function cG(o,e,t,n){if(t.length<=1)return null;let i=Array.prototype.slice.call(e.children,0),r=[];try{cO(o,i,n,0,null,t.length-1,null,r)}catch(s){return console.log(s),null}return r.length===0?null:(r.push(t.length),r)}function cO(o,e,t,n,i,r,s,a){if(n===r||(i=i||dO(o,e,t[n],t[n+1]),s=s||dO(o,e,t[r],t[r+1]),Math.abs(i[0].top-s[0].top)<=.1))return;if(n+1===r){a.push(r);return}let l=n+(r-n)/2|0,d=dO(o,e,t[l],t[l+1]);cO(o,e,t,n,i,l,d,a),cO(o,e,t,l,d,r,s,a)}function dO(o,e,t,n){return o.setStart(e[t/16384|0].firstChild,t%16384),o.setEnd(e[n/16384|0].firstChild,n%16384),o.getClientRects()}var ox=class extends F{_editor=null;_instantiationService=null;_instances=this._register(new wr);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,n){this._editor=e,this._instantiationService=n;for(let i of t){if(this._pending.has(i.id)){je(new Error(`Cannot have two contributions with the same id ${i.id}`));continue}this._pending.set(i.id,i)}this._instantiateSome(0),this._register(bb(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(bb(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(bb(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let e={};for(let[t,n]of this._instances)typeof n.saveViewState=="function"&&(e[t]=n.saveViewState());return e}restoreViewState(e){for(let[t,n]of this._instances)typeof n.restoreViewState=="function"&&n.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}set(e,t){this._instances.set(e,t)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return bb(Ce(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;let t=this._findPendingContributionsByInstantiation(e);for(let n of t)this._instantiateById(n.id)}_findPendingContributionsByInstantiation(e){let t=[];for(let[,n]of this._pending)n.instantiation===e&&t.push(n);return t}_instantiateById(e){let t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let n=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,n),typeof n.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(n){je(n)}}}};var rx=class{constructor(e,t,n,i,r,s,a){this.id=e;this.label=t;this.alias=n;this.metadata=i;this._precondition=r;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}};var BU=Q("ILanguageFeaturesService");var sx=class o{static create(e){return new o(e.get(136),e.get(135))}classifier;constructor(e,t){this.classifier=new uO(e,t)}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[],l=[];return{addRequest:(d,c,u)=>{s.push(d),a.push(c),l.push(u)},finalize:()=>{let d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,c=[];for(let u=0,p=s.length;u<p;u++){let h=a[u],f=l[u];f&&!f.injectionOptions&&!h?c[u]=uG(this.classifier,f,s[u],t,n,d,i,r):c[u]=pG(this.classifier,s[u],h,t,n,d,i,r)}return pO.length=0,hO.length=0,c}}}};var uO=class extends Kp{constructor(e,t){super(0);for(let n=0;n<e.length;n++)this.set(e.charCodeAt(n),1);for(let n=0;n<t.length;n++)this.set(t.charCodeAt(n),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}},pO=[],hO=[];function uG(o,e,t,n,i,r,s,a){if(i===-1)return null;let l=t.length;if(l<=1)return null;let d=a==="keepAll",c=e.breakOffsets,u=e.breakOffsetsVisibleColumn,p=VU(t,n,i,r,s),h=i-p,f=pO,g=hO,b=0,v=0,I=0,T=i,S=c.length,C=0;if(C>=0){let w=Math.abs(u[C]-T);for(;C+1<S;){let x=Math.abs(u[C+1]-T);if(x>=w)break;w=x,C++}}for(;C<S;){let w=C<0?0:c[C],x=C<0?0:u[C];v>w&&(w=v,x=I);let D=0,O=0,H=0,K=0;if(x<=T){let ie=x,Se=w===0?0:t.charCodeAt(w-1),J=w===0?0:o.get(Se),X=!0;for(let le=w;le<l;le++){let re=le,ee=t.charCodeAt(le),Te,ce;if(rn(ee)?(le++,Te=0,ce=2):(Te=o.get(ee),ce=Sv(ee,ie,n,r)),re>v&&mO(Se,J,ee,Te,d)&&(D=re,O=ie),ie+=ce,ie>T){re>v?(H=re,K=ie-ce):(H=le+1,K=ie),ie-O>h&&(D=0),X=!1;break}Se=ee,J=Te}if(X){b>0&&(f[b]=c[c.length-1],g[b]=u[c.length-1],b++);break}}if(D===0){let ie=x,Se=t.charCodeAt(w),J=o.get(Se),X=!1;for(let le=w-1;le>=v;le--){let re=le+1,ee=t.charCodeAt(le);if(ee===9){X=!0;break}let Te,ce;if(bd(ee)?(le--,Te=0,ce=2):(Te=o.get(ee),ce=Dr(ee)?r:1),ie<=T){if(H===0&&(H=re,K=ie),ie<=T-h)break;if(mO(ee,Te,Se,J,d)){D=re,O=ie;break}}ie-=ce,Se=ee,J=Te}if(D!==0){let le=h-(K-O);if(le<=n){let re=t.charCodeAt(H),ee;rn(re)?ee=2:ee=Sv(re,K,n,r),le-ee<0&&(D=0)}}if(X){C--;continue}}if(D===0&&(D=H,O=K),D<=v){let ie=t.charCodeAt(v);rn(ie)?(D=v+2,O=I+2):(D=v+1,O=I+Sv(ie,I,n,r))}for(v=D,f[b]=D,I=O,g[b]=O,b++,T=O+h;C<0||C<S&&u[C]<O;)C++;let z=Math.abs(u[C]-T);for(;C+1<S;){let ie=Math.abs(u[C+1]-T);if(ie>=z)break;z=ie,C++}}return b===0?null:(f.length=b,g.length=b,pO=e.breakOffsets,hO=e.breakOffsetsVisibleColumn,e.breakOffsets=f,e.breakOffsetsVisibleColumn=g,e.wrappedTextIndentLength=p,e)}function pG(o,e,t,n,i,r,s,a){let l=Bo.applyInjectedText(e,t),d,c;if(t&&t.length>0?(d=t.map(O=>O.options),c=t.map(O=>O.column-1)):(d=null,c=null),i===-1)return d?new Nl(c,d,[l.length],[],0):null;let u=l.length;if(u<=1)return d?new Nl(c,d,[l.length],[],0):null;let p=a==="keepAll",h=VU(l,n,i,r,s),f=i-h,g=[],b=[],v=0,I=0,T=0,S=i,C=l.charCodeAt(0),w=o.get(C),x=Sv(C,0,n,r),D=1;rn(C)&&(x+=1,C=l.charCodeAt(1),w=o.get(C),D++);for(let O=D;O<u;O++){let H=O,K=l.charCodeAt(O),z,ie;rn(K)?(O++,z=0,ie=2):(z=o.get(K),ie=Sv(K,x,n,r)),mO(C,w,K,z,p)&&(I=H,T=x),x+=ie,x>S&&((I===0||x-T>f)&&(I=H,T=x-ie),g[v]=I,b[v]=T,v++,S=T+f,I=0),C=K,w=z}return v===0&&(!t||t.length===0)?null:(g[v]=u,b[v]=x,new Nl(c,d,g,b,h))}function Sv(o,e,t,n){return o===9?t-e%t:Dr(o)||o<32?n:1}function WU(o,e){return e-o%e}function mO(o,e,t,n,i){return t!==32&&(e===2&&n!==2||e!==1&&n===1||!i&&e===3&&n!==2||!i&&n===3&&e!==1)}function VU(o,e,t,n,i){let r=0;if(i!==0){let s=fn(o);if(s!==-1){for(let l=0;l<s;l++){let d=o.charCodeAt(l)===9?WU(r,e):1;r+=d}let a=i===3?2:i===2?1:0;for(let l=0;l<a;l++){let d=WU(r,e);r+=d}r+n>t&&(r=0)}}return r}var Ev=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(e,t,n,i){this.model=e,this.viewModel=t,this.coordinatesConverter=n,this.cursorConfig=i}};var Tv=class o{modelState;viewState;_selTrackedRange;_trackSelection;constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new Ln(new M(1,1,1,1),0,0,new A(1,1),0),new Ln(new M(1,1,1,1),0,0,new A(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new Ye(this.modelState,this.viewState)}readSelectionFromMarkers(e){let t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?qe.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):qe.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}static _validatePositionWithCache(e,t,n,i){return t.equals(n)?i:e.normalizePosition(t,2)}static _validateViewState(e,t){let n=t.position,i=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),s=e.normalizePosition(n,2),a=this._validatePositionWithCache(e,i,n,s),l=this._validatePositionWithCache(e,r,i,a);return n.equals(s)&&i.equals(a)&&r.equals(l)?t:new Ln(M.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+i.column-a.column,s,t.leftoverVisibleColumns+n.column-s.column)}_setState(e,t,n){if(n&&(n=o._validateViewState(e.viewModel,n)),t){let i=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(i)?t.selectionStartLeftoverVisibleColumns:0,s=e.model.validatePosition(t.position),a=t.position.equals(s)?t.leftoverVisibleColumns:0;t=new Ln(i,t.selectionStartKind,r,s,a)}else{if(!n)return;let i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new Ln(i,n.selectionStartKind,n.selectionStartLeftoverVisibleColumns,r,n.leftoverVisibleColumns)}if(n){let i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new Ln(i,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{let i=e.coordinatesConverter.convertModelPositionToViewPosition(new A(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new A(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),s=new M(i.lineNumber,i.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new Ln(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}};var wv=class{context;cursors;lastAddedCursorIndex;constructor(e){this.context=e,this.cursors=[new Tv(e)],this.lastAddedCursorIndex=0}dispose(){for(let e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(let e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(let e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(let e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return GN(this.cursors,mo(e=>e.viewState.position,A.compare)).viewState.position}getBottomMostViewPosition(){return KN(this.cursors,mo(e=>e.viewState.position,A.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(Ye.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){let t=this.cursors.length-1,n=e.length;if(t<n){let i=n-t;for(let r=0;r<i;r++)this._addSecondaryCursor()}else if(t>n){let i=t-n;for(let r=0;r<i;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<n;i++)this.cursors[i+1].setState(this.context,e[i].modelState,e[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new Tv(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;let e=this.cursors.slice(0),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort(mo(n=>n.selection,M.compareRangesUsingStarts));for(let n=0;n<t.length-1;n++){let i=t[n],r=t[n+1],s=i.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=i.index<r.index?n:n+1,c=i.index<r.index?n+1:n,u=t[c].index,p=t[d].index,h=t[c].selection,f=t[d].selection;if(!h.equalsSelection(f)){let g=h.plusRange(f),b=h.selectionStartLineNumber===h.startLineNumber&&h.selectionStartColumn===h.startColumn,v=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,I;u===this.lastAddedCursorIndex?(I=b,this.lastAddedCursorIndex=p):I=v;let T;I?T=new qe(g.startLineNumber,g.startColumn,g.endLineNumber,g.endColumn):T=new qe(g.endLineNumber,g.endColumn,g.startLineNumber,g.startColumn),t[d].selection=T;let S=Ye.fromModelSelection(T);e[p].setState(this.context,S.modelState,S.viewState)}for(let g of t)g.index>u&&g.index--;e.splice(u,1),t.splice(c,1),this._removeSecondaryCursor(u-1),n--}}}};var ax=class extends F{_onEvent=this._register(new k);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,n=this._outgoingEvents.length;t<n;t++){let i=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(i){this._outgoingEvents[t]=i;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,n=this._eventHandlers.length;t<n;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new gO),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(let n of e)this._addOutgoingEvent(n);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let e=this._viewEventQueue;this._viewEventQueue=null;let t=this._eventHandlers.slice(0);for(let n of t)n.handleEvents(e)}}},gO=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}};var lx=class o{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(e,t,n,i){this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=n,this.contentHeight=i,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}},dx=class o{kind=1;oldHasFocus;hasFocus;constructor(e,t){this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldHasFocus,e.hasFocus)}},cx=class o{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e,t,n,i,r,s,a,l){this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=n,this._oldScrollTop=i,this.scrollWidth=r,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}},ux=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},px=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},hx=class o{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(e,t,n,i,r,s,a){this.oldSelections=e,this.selections=t,this.oldModelVersionId=n,this.modelVersionId=i,this.source=r,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return o._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}},mx=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},gx=class{constructor(e){this.event=e}kind=7;isNoOp(){return!1}attemptToMerge(e){return null}},fx=class{constructor(e){this.event=e}kind=8;isNoOp(){return!1}attemptToMerge(e){return null}},bx=class{constructor(e){this.event=e}kind=9;isNoOp(){return!1}attemptToMerge(e){return null}},vx=class{constructor(e){this.event=e}kind=10;isNoOp(){return!1}attemptToMerge(e){return null}},yx=class{constructor(e){this.event=e}kind=11;isNoOp(){return!1}attemptToMerge(e){return null}},Ix=class{constructor(e){this.event=e}kind=12;isNoOp(){return!1}attemptToMerge(e){return null}};var Cx=class extends F{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new Ev(this._model,this._viewModel,this._coordinatesConverter,i),this._cursors=new wv(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=Tt(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new Ev(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){let n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let r=!1,s=this.context.cursorConfig.multiCursorLimit;i!==null&&i.length>s&&(i=i.slice(0,s),r=!0);let a=xv.from(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,n,i,r,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=M.fromPositions(a[0],a[0]),e.emitViewEvent(new Pl(t,n,l,d,i,r,s))}revealPrimary(e,t,n,i,r,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new Pl(t,n,null,l,i,r,s))}saveState(){let e=[],t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){let r=t[n];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),n.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,Ye.fromModelSelections(n)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof Jp){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let n=t.rawContentChangedEvent;if(this._knownModelVersionId=n.versionId,this._isHandling)return;let i=n.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new wv(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&n.resultingSelection&&n.resultingSelection.length>0){let r=Ye.fromModelSelections(n.resultingSelection);this.setStates(e,"modelChange",n.isUndoing?5:n.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{let r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,Ye.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t,n,i){this.setStates(e,t,i,Ye.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let a=0,l=e.length;a<l;a++)n.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});let r=this._model.deltaDecorations([],n),s=this._model.deltaDecorations([],i);this._autoClosedActions.push(new Sx(this._model,r,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();let t=fO.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let r=0;r<e.commands.length;r++){let s=e.commands[r];s instanceof Om&&s.enclosingRange&&s.closeCharacterRange&&(n.push(s.closeCharacterRange),i.push(s.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,r){let s=xv.from(this._model,this);if(s.equals(i))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new VS(l,a,n)),!i||i.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(i.cursorState[c].modelState))){let d=i?i.cursorState.map(u=>u.modelState.selection):null,c=i?i.modelVersionId:0;e.emitOutgoingEvent(new hx(d,a,c,s.modelVersionId,t||"keyboard",n,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];if(!r.text||r.text.indexOf(`
`)>=0)return null;let s=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=r.text.length-s[2].length-1,u=r.text.lastIndexOf(d,c-1);if(u===-1)return null;t.push([u,c])}return t}executeEdits(e,t,n,i){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(n)),r&&(n[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),n,d=>{if(r)for(let u=0,p=r.length;u<p;u++){let[h,f]=r[u],g=d[u],b=g.range.startLineNumber,v=g.range.startColumn-1+h,I=g.range.startColumn-1+f;s.push(new M(b,I+1,b,I+2)),a.push(new M(b,v+1,b,I+2))}let c=i(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(e,t,n,i=0){if(this.context.cursorConfig.readOnly)return;let r=xv.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(s){je(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,i,r,!1)&&this.revealAll(t,n,!1,0,!0,0)}getAutoClosedCharacters(){return Sx.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new vO(this._model,this.getSelections())}endComposition(e,t){let n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Xs.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,n){this._executeEdit(()=>{if(n==="keyboard"){let i=t.length,r=0;for(;r<i;){let s=Gg(t,r),a=t.substr(r,s);this._executeEditOperation(Xs.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),r+=s}}else this._executeEditOperation(Xs.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,n)}compositionType(e,t,n,i,r,s){if(t.length===0&&n===0&&i===0){if(r!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new qe(d.lineNumber,d.column+r,d.lineNumber,d.column+r)});this.setSelections(e,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Xs.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,r))},e,s)}paste(e,t,n,i,r){this._executeEdit(()=>{this._executeEditOperation(Xs.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation($l.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,n){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new Hn(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}executeCommands(e,t,n){this._executeEdit(()=>{this._executeEditOperation(new Hn(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}},xv=class o{constructor(e,t){this.modelVersionId=e;this.cursorState=t}static from(e,t){return new o(e.getVersionId(),t.getCursorStates())}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}},Sx=class{static getAllAutoClosedCharacters(e){let t=[];for(let n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){let n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let n=0;n<this._autoClosedEnclosingDecorations.length;n++){let i=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[n]);if(i&&(t.push(i),i.startLineNumber!==i.endLineNumber))return!1}t.sort(M.compareRangesUsingStarts),e.sort(M.compareRangesUsingStarts);for(let n=0;n<e.length;n++)if(n>=t.length||!t[n].strictContainsRange(e[n]))return!1;return!0}},fO=class{static executeCommands(e,t,n){let i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(i,n);for(let s=0,a=i.trackedRanges.length;s<a;s++)i.model._setTrackedRange(i.trackedRanges[s],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;let n=this._getEditOperations(e,t);if(n.operations.length===0)return null;let i=n.operations,r=this._getLoserCursorMap(i);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=i.length;d<c;d++)r.hasOwnProperty(i[d].identifier.major.toString())||s.push(i[d]);n.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,s,d=>{let c=[];for(let h=0;h<e.selectionsBefore.length;h++)c[h]=[];for(let h of d)h.identifier&&c[h.identifier.major].push(h);let u=(h,f)=>h.identifier.minor-f.identifier.minor,p=[];for(let h=0;h<e.selectionsBefore.length;h++)c[h].length>0?(c[h].sort(u),p[h]=t[h].computeCursorState(e.model,{getInverseEditOperations:()=>c[h],getTrackedSelection:f=>{let g=parseInt(f,10),b=e.model._getTrackedRange(e.trackedRanges[g]);return e.trackedRangesDirection[g]===0?new qe(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):new qe(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn)}})):p[h]=e.selectionsBefore[h];return p});a||(a=e.selectionsBefore);let l=[];for(let d in r)r.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(a){let l=this._getEditOperationsFromCommand(e,r,a);n=n.concat(l.operations),i=i||l.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let i=[],r=0,s=(u,p,h=!1)=>{M.isEmpty(u)&&p===""||i.push({identifier:{major:t,minor:r++},range:u,text:p,forceMoveMarkers:h,isAutoWhitespaceEdit:n.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(u,p,h)=>{a=!0,s(u,p,h)},trackSelection:(u,p)=>{let h=qe.liftSelection(u),f;if(h.isEmpty())if(typeof p=="boolean")p?f=2:f=3;else{let v=e.model.getLineMaxColumn(h.startLineNumber);h.startColumn===v?f=2:f=3}else f=1;let g=e.trackedRanges.length,b=e.model._setTrackedRange(null,h,f);return e.trackedRanges[g]=b,e.trackedRangesDirection[g]=h.getDirection(),g.toString()}};try{n.getEditOperations(e.model,c)}catch(u){return je(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:i,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((n,i)=>-M.compareRangesUsingEnds(n.range,i.range));let t={};for(let n=1;n<e.length;n++){let i=e[n-1],r=e[n];if(M.getStartPosition(i.range).isBefore(M.getEndPosition(r.range))){let s;i.identifier.major>r.identifier.major?s=i.identifier.major:s=r.identifier.major,t[s.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===s&&(e.splice(a,1),a<n&&n--,a--);n>0&&n--}}return t}},bO=class{constructor(e,t,n){this.text=e;this.startSelection=t;this.endSelection=n}},vO=class o{_original;static _capture(e,t){let n=[];for(let i of t){if(i.startLineNumber!==i.endLineNumber)return null;n.push(new bO(e.getLineContent(i.startLineNumber),i.startColumn-1,i.endColumn-1))}return n}constructor(e,t){this._original=o._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;let n=o._capture(e,t);if(!n||this._original.length!==n.length)return null;let i=[];for(let r=0,s=this._original.length;r<s;r++)i.push(o._deduceOutcome(this._original[r],n[r]));return i}static _deduceOutcome(e,t){let n=Math.min(e.startSelection,t.startSelection,zg(e.text,t.text)),i=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,Kg(e.text,t.text)),r=e.text.substring(n,e.text.length-i),s=t.text.substring(n,t.text.length-i);return new mw(r,e.startSelection-n,e.endSelection-n,s,t.startSelection-n,t.endSelection-n)}};function HU(o,e,t,n,i,r,s){let a="<div>",l=n,d=0,c=!0;for(let u=0,p=e.getCount();u<p;u++){let h=e.getEndOffset(u);if(h<=n)continue;let f="";for(;l<h&&l<i;l++){let g=o.charCodeAt(l);switch(g){case 9:{let b=r-(l+d)%r;for(d+=b-1;b>0;)s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0),b--;break}case 60:f+="&lt;",c=!1;break;case 62:f+="&gt;",c=!1;break;case 38:f+="&amp;",c=!1;break;case 0:f+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:f+="\uFFFD",c=!1;break;case 13:f+="&#8203",c=!1;break;case 32:s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0);break;default:f+=String.fromCharCode(g),c=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${f}</span>`,h>i||l>=i)break}return a+="</div>",a}var yO=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;let t=this._inserts,n=this._changes,i=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,n,i)}},IO=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(e,t,n,i,r){this.id=e,this.afterLineNumber=t,this.ordinal=n,this.height=i,this.minWidth=r,this.prefixSum=0}},Ex=class o{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(e,t,n,i){this._instanceId=Dy(++o.INSTANCE_COUNT),this._pendingChanges=new yO,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=n,this._paddingBottom=i}static findInsertionIndex(e,t,n){let i=0,r=e.length;for(;i<r;){let s=i+r>>>1;t===e[s].afterLineNumber?n<e[s].ordinal?r=s:i=s+1:t<e[s].afterLineNumber?r=s:i=s+1}return i}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(i,r,s,a)=>{t=!0,i=i|0,r=r|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new IO(l,i,r,s,a)),l},changeOneWhitespace:(i,r,s)=>{t=!0,r=r|0,s=s|0,this._pendingChanges.change({id:i,newAfterLineNumber:r,newHeight:s})},removeWhitespace:i=>{t=!0,this._pendingChanges.remove({id:i})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,n){if((e.length>0||n.length>0)&&(this._minWidth=-1),e.length+t.length+n.length<=1){for(let l of e)this._insertWhitespace(l);for(let l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of n){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let i=new Set;for(let l of n)i.add(l.id);let r=new Map;for(let l of t)r.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!i.has(c.id)){if(r.has(c.id)){let u=r.get(c.id);c.afterLineNumber=u.newAfterLineNumber,c.height=u.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(e));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){let t=o.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){let t=this._arr;for(let n=0,i=t.length;n<i;n++)if(t[n].id===e)return n;return-1}_changeOneWhitespace(e,t,n){let i=this._findWhitespaceIndex(e);if(i!==-1&&(this._arr[i].height!==n&&(this._arr[i].height=n,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,i-1)),this._arr[i].afterLineNumber!==t)){let r=this._arr[i];this._removeWhitespace(i),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&r<=t?this._arr[n].afterLineNumber=e-1:r>t&&(this._arr[n].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&(this._arr[n].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let n=t;n<=e;n++)this._arr[n].prefixSum=this._arr[n-1].prefixSum+this._arr[n].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;let t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;let t=this._arr,n=0,i=t.length-1;for(;n<=i;){let s=(i-n|0)/2|0,a=n+s|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;n=a+1|0}else i=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;let n=this._findLastWhitespaceBeforeLineNumber(e)+1;return n<this._arr.length?n:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n;e>1?n=this._lineHeight*(e-1):n=0;let i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return n+i+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n=this._lineHeight*e,i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return n+i+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,n=this._arr.length;t<n;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;let t=this._lineCount|0,n=this._lineHeight,i=1,r=t;for(;i<r;){let s=(i+r)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(e>=a+n)i=s+1;else{if(e>=a)return s;r=s}}return i>t?t:i}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this._lineHeight,i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,r=this.getVerticalOffsetForLineNumber(i)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(i)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let u=r,p=u,h=5e5,f=0;r>=h&&(f=Math.floor(r/h)*h,f=Math.floor(f/n)*n,p-=f);let g=[],b=e+(t-e)/2,v=-1;for(let C=i;C<=s;C++){if(v===-1){let w=u,x=u+n;(w<=b&&b<x||w>b)&&(v=C)}for(u+=n,g[C-i]=p,p+=n;c===C;)p+=d,u+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){s=C;break}}v===-1&&(v=s);let I=this.getVerticalOffsetForLineNumber(s)|0,T=i,S=s;return T<S&&r<e&&T++,T<S&&I+n>t&&S--,{bigNumbersDelta:f,startLineNumber:i,endLineNumber:s,relativeVerticalOffset:g,centeredLineNumber:v,completelyVisibleStartLineNumber:T,completelyVisibleEndLineNumber:S,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;let t=this.getAfterLineNumberForWhitespaceIndex(e),n;t>=1?n=this._lineHeight*t:n=0;let i;return e>0?i=this.getWhitespacesAccumulatedHeight(e-1):i=0,n+i+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,n=this.getWhitespacesCount()-1;if(n<0)return-1;let i=this.getVerticalOffsetForWhitespaceIndex(n),r=this.getHeightForWhitespaceIndex(n);if(e>=i+r)return-1;for(;t<n;){let s=Math.floor((t+n)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(e>=a+l)t=s+1;else{if(e>=a)return s;n=s}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;let n=this.getVerticalOffsetForWhitespaceIndex(t);if(n>e)return null;let i=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),s=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:s,verticalOffset:n,height:i}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),i=this.getWhitespacesCount()-1;if(n<0)return[];let r=[];for(let s=n;s<=i;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};var mG=125,op=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(e,t,n,i){e=e|0,t=t|0,n=n|0,i=i|0,e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),i<0&&(i=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=n,this.contentHeight=i,this.scrollHeight=Math.max(n,i)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}},CO=class extends F{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new k);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(e,t){super(),this._dimensions=new op(0,0,0,0),this._scrollable=this._register(new Es({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;let t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);let n=t.contentWidth!==e.contentWidth,i=t.contentHeight!==e.contentHeight;(n||i)&&this._onDidContentSizeChange.fire(new lx(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},Tx=class extends F{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(e,t,n){super(),this._configuration=e;let i=this._configuration.options,r=i.get(147),s=i.get(85);this._linesLayout=new Ex(t,i.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new CO(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new op(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?mG:0)}onConfigurationChanged(e){let t=this._configuration.options;if(e.hasChanged(68)&&this._linesLayout.setLineHeight(t.get(68)),e.hasChanged(85)){let n=t.get(85);this._linesLayout.setPadding(n.top,n.bottom)}if(e.hasChanged(147)){let n=t.get(147),i=n.contentWidth,r=n.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new op(i,s.contentWidth,r,this._getContentHeight(i,r,a)))}else this._updateHeight();e.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){let i=this._configuration.options.get(105);return i.horizontal===2||e>=t?0:i.horizontalScrollbarSize}_getContentHeight(e,t,n){let i=this._configuration.options,r=this._linesLayout.getLinesTotalHeight();return i.get(107)?r+=Math.max(0,t-i.get(68)-i.get(85).bottom):i.get(105).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,n)),r}_updateHeight(){let e=this._scrollable.getScrollDimensions(),t=e.width,n=e.height,i=e.contentWidth;this._scrollable.setScrollDimensions(new op(t,e.contentWidth,n,this._getContentHeight(t,n,i)))}getCurrentViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new xb(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new xb(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){let e=this._configuration.options,t=this._maxLineWidth,n=e.get(148),i=e.get(51),r=e.get(147);if(n.isViewportWrapping){let s=e.get(74);return t>r.contentWidth+i.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?t+r.verticalScrollbarWidth:t}else{let s=e.get(106)*i.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+s+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){let e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new op(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){let e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,n=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),i=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(n);return{scrollTop:t,scrollTopWithoutViewZones:t-i,scrollLeft:e.scrollLeft}}changeWhitespace(e){let t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){let t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){let n=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:n.scrollLeft+e,scrollTop:n.scrollTop+t})}};function _x(o,e){return o===null?e?wx.INSTANCE:xx.INSTANCE:new EO(o,e)}var EO=class{_projectionData;_isVisible;constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,n){this._assertVisible();let i=n>0?this._projectionData.breakOffsets[n-1]:0,r=this._projectionData.breakOffsets[n],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new Bo(0,0,d+1,this._projectionData.injectionOptions[c],0));s=Bo.applyInjectedText(e.getLineContent(t),a).substring(i,r)}else s=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:r+1});return n>0&&(s=UU(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(e,t,n){return this._assertVisible(),this._projectionData.getLineLength(n)}getViewLineMinColumn(e,t,n){return this._assertVisible(),this._projectionData.getMinOutputOffset(n)+1}getViewLineMaxColumn(e,t,n){return this._assertVisible(),this._projectionData.getMaxOutputOffset(n)+1}getViewLineData(e,t,n){let i=new Array;return this.getViewLinesData(e,t,n,1,0,[!0],i),i[0]}getViewLinesData(e,t,n,i,r,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,u=null;if(d){u=[];let h=0,f=0;for(let g=0;g<l.getOutputLineCount();g++){let b=new Array;u[g]=b;let v=g>0?l.breakOffsets[g-1]:0,I=l.breakOffsets[g];for(;f<d.length;){let T=c[f].content.length,S=d[f]+h,C=S+T;if(S>I)break;if(v<C){let w=c[f];if(w.inlineClassName){let x=g>0?l.wrappedTextIndentLength:0,D=x+Math.max(S-v,0),O=x+Math.min(C-v,I-v);D!==O&&b.push(new YS(D,O,w.inlineClassName,w.inlineClassNameAffectsLetterSpacing))}}if(C<=I)h+=T,f++;else break}}}let p;if(d){let h=[];for(let f=0;f<d.length;f++){let g=d[f],b=c[f].tokens;b?b.forEach((v,I)=>{h.push({offset:g,text:v.substring(c[f].content),tokenMetadata:I.metadata})}):h.push({offset:g,text:c[f].content,tokenMetadata:vn.defaultTokenMetadata})}p=e.tokenization.getLineTokens(t).withInserted(h)}else p=e.tokenization.getLineTokens(t);for(let h=n;h<n+i;h++){let f=r+h-n;if(!s[f]){a[f]=null;continue}a[f]=this._getViewLineData(p,u?u[h]:null,h)}}_getViewLineData(e,t,n){this._assertVisible();let i=this._projectionData,r=n>0?i.wrappedTextIndentLength:0,s=n>0?i.breakOffsets[n-1]:0,a=i.breakOffsets[n],l=e.sliceAndInflate(s,a,r),d=l.getLineContent();n>0&&(d=UU(i.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(n)+1,u=d.length+1,p=n+1<this.getViewLineCount(),h=n===0?0:i.breakOffsetsVisibleColumn[n-1];return new Lu(d,p,c,u,h,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,n=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,n).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();let n=this._projectionData.translateToOutputPosition(t-1);return e+n.outputLineIndex}normalizePosition(e,t,n){let i=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,n).toPosition(i)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},wx=class o{static INSTANCE=new o;constructor(){}isVisible(){return!0}setVisible(e){return e?this:xx.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,n){return e.getLineContent(t)}getViewLineLength(e,t,n){return e.getLineLength(t)}getViewLineMinColumn(e,t,n){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,n){return e.getLineMaxColumn(t)}getViewLineData(e,t,n){let i=e.tokenization.getLineTokens(t),r=i.getLineContent();return new Lu(r,!1,1,r.length+1,0,i.inflate(),null)}getViewLinesData(e,t,n,i,r,s,a){if(!s[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new A(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,n){return t}getInjectedTextAt(e,t){return null}},xx=class o{static INSTANCE=new o;constructor(){}isVisible(){return!1}setVisible(e){return e?wx.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,n){throw new Error("Not supported")}getViewLineLength(e,t,n){throw new Error("Not supported")}getViewLineMinColumn(e,t,n){throw new Error("Not supported")}getViewLineMaxColumn(e,t,n){throw new Error("Not supported")}getViewLineData(e,t,n){throw new Error("Not supported")}getViewLinesData(e,t,n,i,r,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,n){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}},SO=[""];function UU(o){if(o>=SO.length)for(let e=1;e<=o;e++)SO[e]=gG(e);return SO[o]}function gG(o){return new Array(o+1).join(" ")}var Lx=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();let t=this._indexBySum[e],n=t>0?this._prefixSum[t-1]:0;return new TO(t,e-n)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=la(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){let n=this._values[e],i=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=i+n;for(let r=0;r<n;r++)this._indexBySum[i+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}},TO=class{constructor(e,t){this.index=e;this.remainder=t;this.index=e,this.remainder=t}_prefixSumIndexOfResultBrand=void 0};var Dx=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(e,t,n,i,r,s,a,l,d,c){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=n,this._monospaceLineBreaksComputerFactory=i,this.fontInfo=r,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new wO(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let n=this.model.getLinesContent(),i=this.model.getInjectedTextDecorations(this._editorId),r=n.length,s=this.createLineBreaksComputer(),a=new Wi(Bo.fromDecorations(i));for(let g=0;g<r;g++){let b=a.takeWhile(v=>v.lineNumber===g+1);s.addRequest(n[g],b,t?t[g]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(g=>this.model.getDecorationRange(g)).sort(M.compareRangesUsingStarts),u=1,p=0,h=-1,f=h+1<c.length?p+1:r+2;for(let g=0;g<r;g++){let b=g+1;b===f&&(h++,u=c[h].startLineNumber,p=c[h].endLineNumber,f=h+1<c.length?p+1:r+2);let v=b>=u&&b<=p,I=_x(l[g],!v);d[g]=I.getViewLineCount(),this.modelLineProjections[g]=I}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new Lx(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){let t=e.map(p=>this.model.validateRange(p)),n=fG(t),i=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(M.compareRangesUsingStarts);if(n.length===i.length){let p=!1;for(let h=0;h<n.length;h++)if(!n[h].equalsRange(i[h])){p=!0;break}if(!p)return!1}let r=n.map(p=>({range:p,options:yn.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);let s=n,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,u=!1;for(let p=0;p<this.modelLineProjections.length;p++){let h=p+1;h===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let f=!1;if(h>=a&&h<=l?this.modelLineProjections[p].isVisible()&&(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!1),f=!0):(u=!0,this.modelLineProjections[p].isVisible()||(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!0),f=!0)),f){let g=this.modelLineProjections[p].getViewLineCount();this.projectedModelLineLineCounts.setValue(p,g)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,n,i,r){let s=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===n,d=this.wrappingIndent===i,c=this.wordBreak===r;if(s&&a&&l&&d&&c)return!1;let u=s&&a&&!l&&d&&c;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=n,this.wrappingIndent=i,this.wordBreak=r;let p=null;if(u){p=[];for(let h=0,f=this.modelLineProjections.length;h<f;h++)p[h]=this.modelLineProjections[h].getProjectionData()}return this._constructLines(!1,p),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,n){if(!e||e<=this._validModelVersionId)return null;let i=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections.splice(t-1,n-t+1),this.projectedModelLineLineCounts.removeValues(t-1,n-t+1),new Qh(i,r)}onModelLinesInserted(e,t,n,i){if(!e||e<=this._validModelVersionId)return null;let r=t>2&&!this.modelLineProjections[t-2].isVisible(),s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,a=0,l=[],d=[];for(let c=0,u=i.length;c<u;c++){let p=_x(i[c],!r);l.push(p);let h=p.getViewLineCount();a+=h,d[c]=h}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,d),new Xh(s,s+a-1)}onModelLineChanged(e,t,n){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let i=t-1,r=this.modelLineProjections[i].getViewLineCount(),s=this.modelLineProjections[i].isVisible(),a=_x(n,s);this.modelLineProjections[i]=a;let l=this.modelLineProjections[i].getViewLineCount(),d=!1,c=0,u=-1,p=0,h=-1,f=0,g=-1;r>l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1,f=u+1,g=f+(r-l)-1,d=!0):r<l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+r-1,p=u+1,h=p+(l-r)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1),this.projectedModelLineLineCounts.setValue(i,l);let b=c<=u?new wb(c,u-c+1):null,v=p<=h?new Xh(p,h):null,I=f<=g?new Qh(f,g):null;return[d,b,v,I]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;let t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),n=this._toValidViewLineNumber(n);let i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(n,this.getViewLineMinColumn(n)),a=this.model.guides.getActiveIndentGuide(i.lineNumber,r.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.projectedModelLineLineCounts.getIndexOf(e-1),n=t.index,i=t.remainder;return new kx(n+1,i)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new A(e.modelLineNumber,i)}getModelEndPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new A(e.modelLineNumber,i)}getViewLineInfosGroupedByModelRanges(e,t){let n=this.getViewLineInfo(e),i=this.getViewLineInfo(t),r=new Array,s=this.getModelStartPositionOfViewLine(n),a=new Array;for(let l=n.modelLineNumber;l<=i.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===n.modelLineNumber?n.modelLineWrappedLineIdx:0,u=l===i.modelLineNumber?i.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let p=c;p<u;p++)a.push(new kx(l,p))}if(!d.isVisible()&&s){let c=new A(l-1,this.model.getLineMaxColumn(l-1)+1),u=M.fromPositions(s,c);r.push(new Rx(u,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new A(l,1))}if(s){let l=M.fromPositions(s,this.getModelEndPositionOfViewLine(i));r.push(new Rx(l,a))}return r}getViewLinesBracketGuides(e,t,n,i){let r=n?this.convertViewPositionToModelPosition(n.lineNumber,n.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(e,t)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,i);for(let c of a.viewLines){let p=d[c.modelLineNumber-l].map(h=>{if(h.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,h.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||h.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,h.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!h.horizontalLine)return h;let f=-1;if(h.column!==-1){let v=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,h.column);if(v.lineNumber===c.modelLineWrappedLineIdx)f=v.column;else if(v.lineNumber<c.modelLineWrappedLineIdx)f=this.getMinColumnOfViewLine(c);else if(v.lineNumber>c.modelLineWrappedLineIdx)return}let g=this.convertModelPositionToViewPosition(c.modelLineNumber,h.horizontalLine.endColumn),b=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,h.horizontalLine.endColumn);return b.lineNumber===c.modelLineWrappedLineIdx?new es(h.visibleColumn,f,h.className,new Sl(h.horizontalLine.top,g.column),-1,-1):b.lineNumber<c.modelLineWrappedLineIdx||h.visibleColumn!==-1?void 0:new es(h.visibleColumn,f,h.className,new Sl(h.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(p.filter(h=>!!h))}}return s}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),i=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t)),r=[],s=[],a=[],l=n.lineNumber-1,d=i.lineNumber-1,c=null;for(let f=l;f<=d;f++){let g=this.modelLineProjections[f];if(g.isVisible()){let b=g.getViewLineNumberOfModelPosition(0,f===l?n.column:1),v=g.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),I=v-b+1,T=0;I>1&&g.getViewLineMinColumn(this.model,f+1,v)===1&&(T=b===0?1:2),s.push(I),a.push(T),c===null&&(c=new A(f+1,0))}else c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,f)),c=null)}c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,i.lineNumber)),c=null);let u=t-e+1,p=new Array(u),h=0;for(let f=0,g=r.length;f<g;f++){let b=r[f],v=Math.min(u-h,s[f]),I=a[f],T;I===2?T=0:I===1?T=1:T=v;for(let S=0;S<v;S++)S===T&&(b=0),p[h++]=b}return p}getViewLineContent(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=e,s=i.index,a=i.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let u=this.modelLineProjections[d];if(!u.isVisible())continue;let p=d===s?a:0,h=u.getViewLineCount()-p,f=!1;if(r+h>t&&(f=!0,h=t-r+1),u.getViewLinesData(this.model,d+1,p,h,r-e,n,l),r+=h,f)break}return l}validateViewPosition(e,t,n){e=this._toValidViewLineNumber(e);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=i.index,s=i.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,s),d=a.getViewLineMaxColumn(this.model,r+1,s);t<l&&(t=l),t>d&&(t=d);let c=a.getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new A(r+1,c)).equals(n)?new A(e,t):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}validateViewRange(e,t){let n=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),i=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new M(n.lineNumber,n.column,i.lineNumber,i.column)}convertViewPositionToModelPosition(e,t){let n=this.getViewLineInfo(e),i=this.modelLineProjections[n.modelLineNumber-1].getModelColumnOfViewPosition(n.modelLineWrappedLineIdx,t);return this.model.validatePosition(new A(n.modelLineNumber,i))}convertViewRangeToModelRange(e){let t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new M(t.lineNumber,t.column,n.lineNumber,n.column)}convertModelPositionToViewPosition(e,t,n=2,i=!1,r=!1){let s=this.model.validatePosition(new A(e,t)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(r)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new A(i?0:1,1);let u=1+this.projectedModelLineLineCounts.getPrefixSum(d),p;return c?r?p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,1,n):p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(d+1),n):p=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,n),p}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return M.fromPositions(n)}else{let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),i=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new M(n.lineNumber,n.column,i.lineNumber,i.column)}}getViewLineNumberOfModelPosition(e,t){let n=e-1;if(this.modelLineProjections[n].isVisible()){let r=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(r,t)}for(;n>0&&!this.modelLineProjections[n].isVisible();)n--;if(n===0&&!this.modelLineProjections[n].isVisible())return 1;let i=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(i,this.model.getLineMaxColumn(n+1))}getDecorationsInRange(e,t,n,i,r){let s=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-s.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new M(s.lineNumber,1,a.lineNumber,a.column),t,n,i,r);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,u=null;for(let g=d;g<=c;g++)if(this.modelLineProjections[g].isVisible())u===null&&(u=new A(g+1,g===d?s.column:1));else if(u!==null){let v=this.model.getLineMaxColumn(g);l=l.concat(this.model.getDecorationsInRange(new M(u.lineNumber,u.column,g,v),t,n,i)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new M(u.lineNumber,u.column,a.lineNumber,a.column),t,n,i)),u=null),l.sort((g,b)=>{let v=M.compareRangesUsingStarts(g.range,b.range);return v===0?g.id<b.id?-1:g.id>b.id?1:0:v});let p=[],h=0,f=null;for(let g of l){let b=g.id;f!==b&&(f=b,p[h++]=g)}return p}getInjectedTextAt(e){let t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){let n=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[n.modelLineNumber-1].normalizePosition(n.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){let t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}};function fG(o){if(o.length===0)return[];let e=o.slice();e.sort(M.compareRangesUsingStarts);let t=[],n=e[0].startLineNumber,i=e[0].endLineNumber;for(let r=1,s=e.length;r<s;r++){let a=e[r];a.startLineNumber>i+1?(t.push(new M(n,1,i,1)),n=a.startLineNumber,i=a.endLineNumber):a.endLineNumber>i&&(i=a.endLineNumber)}return t.push(new M(n,1,i,1)),t}var kx=class{constructor(e,t){this.modelLineNumber=e;this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},Rx=class{constructor(e,t){this.modelRange=e;this.viewLines=t}},wO=class{_lines;constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,n,i){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,n,i)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}};var Mx=class{model;constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new xO(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,n,i){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,n,i)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,n){return new Qh(t,n)}onModelLinesInserted(e,t,n,i){return new Xh(t,n)}onModelLineChanged(e,t,n){return[!1,new wb(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,n){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,n){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){let n=t-e+1,i=new Array(n);for(let r=0;r<n;r++)i[r]=0;return i}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.tokenization.getLineTokens(e),n=t.getLineContent();return new Lu(n,!1,1,n.length+1,0,t.inflate(),null)}getViewLinesData(e,t,n){let i=this.model.getLineCount();e=Math.min(Math.max(1,e),i),t=Math.min(Math.max(1,t),i);let r=[];for(let s=e;s<=t;s++){let a=s-e;r[a]=n[a]?this.getViewLineData(s):null}return r}getDecorationsInRange(e,t,n,i,r){return this.model.getDecorationsInRange(e,t,n,i,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}},xO=class{_lines;constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){let t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}modelRangeIsVisible(e){let t=this._lines.model.getLineCount();return!(e.startLineNumber<1||e.startLineNumber>t||e.endLineNumber<1||e.endLineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}};var Ox=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(e,t,n,i,r){this.editorId=e,this.model=t,this.configuration=n,this._linesCollection=i,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){let t=e.id,n=this._decorationsCache[t];if(!n){let i=e.range,r=e.options,s;if(r.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new A(i.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new A(i.endLineNumber,this.model.getLineMaxColumn(i.endLineNumber)),1);s=new M(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(i,1);n=new em(s,r),this._decorationsCache[t]=n}return n}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,n=!1){let i=new M(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(i,t,n).inlineDecorations[0]}_getDecorationsInRange(e,t,n){let i=this._linesCollection.getDecorationsInRange(e,this.editorId,Xc(this.configuration.options),t,n),r=e.startLineNumber,s=e.endLineNumber,a=[],l=0,d=[];for(let c=r;c<=s;c++)d[c-r]=[];for(let c=0,u=i.length;c<u;c++){let p=i[c],h=p.options;if(!bG(this.model,p))continue;let f=this._getOrCreateViewModelDecoration(p),g=f.range;if(a[l++]=f,h.inlineClassName){let b=new Fl(g,h.inlineClassName,h.inlineClassNameAffectsLetterSpacing?3:0),v=Math.max(r,g.startLineNumber),I=Math.min(s,g.endLineNumber);for(let T=v;T<=I;T++)d[T-r].push(b)}if(h.beforeContentClassName&&r<=g.startLineNumber&&g.startLineNumber<=s){let b=new Fl(new M(g.startLineNumber,g.startColumn,g.startLineNumber,g.startColumn),h.beforeContentClassName,1);d[g.startLineNumber-r].push(b)}if(h.afterContentClassName&&r<=g.endLineNumber&&g.endLineNumber<=s){let b=new Fl(new M(g.endLineNumber,g.endColumn,g.endLineNumber,g.endColumn),h.afterContentClassName,2);d[g.endLineNumber-r].push(b)}}return{decorations:a,inlineDecorations:d}}};function bG(o,e){return!(e.options.hideInCommentTokens&&vG(o,e)||e.options.hideInStringTokens&&yG(o,e))}function vG(o,e){return zU(o,e.range,t=>t===1)}function yG(o,e){return zU(o,e.range,t=>t===2)}function zU(o,e,t){for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let i=o.tokenization.getLineTokens(n),r=n===e.startLineNumber,s=n===e.endLineNumber,a=r?i.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<i.getCount()&&!(s&&i.getStartOffset(a)>e.endColumn-1);){if(!t(i.getStandardTokenType(a)))return!1;a++}}return!0}var rp=3,Nx=class{lanes;persist=0;_requiredLanes=1;constructor(e){this.lanes=new Uint8Array(Math.ceil((e+1)*rp/8))}reset(e){let t=Math.ceil((e+1)*rp/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,n){n&&(this.persist|=1<<e-1);for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let r=rp*i+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(i))}}getLanesAtLine(e){let t=[],n=rp*e;for(let i=0;i<rp;i++)(this.persist&1<<i||this.lanes[n>>>3]&1<<n%8)&&t.push(i+1),n++;return t.length?t:[2]}countAtLine(e){let t=rp*e,n=0;for(let i=0;i<rp;i++)(this.persist&1<<i||this.lanes[t>>>3]&1<<t%8)&&n++,t++;return n}};var IG=!0,Ax=class extends F{constructor(t,n,i,r,s,a,l,d,c,u){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=u;if(this._editorId=t,this._configuration=n,this.model=i,this._eventDispatcher=new ax,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Al(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new ln(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=_O.create(this.model),this.glyphLanes=new Nx(0),IG&&this.model.isTooLargeForTokenization())this._lines=new Mx(this.model);else{let p=this._configuration.options,h=p.get(51),f=p.get(141),g=p.get(148),b=p.get(140),v=p.get(131);this._lines=new Dx(this._editorId,this.model,r,s,h,this.model.getOptions().tabSize,f,g.wrappingColumn,b,v)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new Cx(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new Tx(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(p=>{p.scrollTopChanged&&this._handleVisibleLinesChanged(),p.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new zS(p)),this._eventDispatcher.emitOutgoingEvent(new cx(p.oldScrollWidth,p.oldScrollLeft,p.oldScrollHeight,p.oldScrollTop,p.scrollWidth,p.scrollLeft,p.scrollHeight,p.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(p=>{this._eventDispatcher.emitOutgoingEvent(p)})),this._decorations=new Ox(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(p=>{try{let h=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(h,p)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(Gm.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new jS)})),this._register(this._themeService.onDidColorThemeChange(p=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new KS(p))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let t=this.viewLayout.getLinesViewportData(),n=new M(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(n)}visibleLinesStabilized(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new HS(t)),this._eventDispatcher.emitOutgoingEvent(new dx(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new FS)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new BS)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let t=new A(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),n=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new Px(n,this._viewportStart.startLineDelta)}return new Px(null,0)}_onConfigurationChanged(t,n){let i=this._captureStableViewport(),r=this._configuration.options,s=r.get(51),a=r.get(141),l=r.get(148),d=r.get(140),c=r.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(t.emitViewEvent(new xu),t.emitViewEvent(new _u),t.emitViewEvent(new Pa(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),n.hasChanged(93)&&(this._decorations.reset(),t.emitViewEvent(new Pa(null))),n.hasChanged(100)&&(this._decorations.reset(),t.emitViewEvent(new Pa(null))),t.emitViewEvent(new WS(n)),this.viewLayout.onConfigurationChanged(n),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Al.shouldRecreate(n)&&(this.cursorConfig=new Al(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(t=>{try{let i=this._eventDispatcher.beginEmitViewEvents(),r=!1,s=!1,a=t instanceof Nd?t.rawContentChangedEvent.changes:t.changes,l=t instanceof Nd?t.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let p of a)switch(p.changeType){case 4:{for(let h=0;h<p.detail.length;h++){let f=p.detail[h],g=p.injectedTexts[h];g&&(g=g.filter(b=>!b.ownerId||b.ownerId===this._editorId)),d.addRequest(f,g,null)}break}case 2:{let h=null;p.injectedText&&(h=p.injectedText.filter(f=>!f.ownerId||f.ownerId===this._editorId)),d.addRequest(p.detail,h,null);break}}let c=d.finalize(),u=new Wi(c);for(let p of a)switch(p.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new xu),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),r=!0;break}case 3:{let h=this._lines.onModelLinesDeleted(l,p.fromLineNumber,p.toLineNumber);h!==null&&(i.emitViewEvent(h),this.viewLayout.onLinesDeleted(h.fromLineNumber,h.toLineNumber)),r=!0;break}case 4:{let h=u.takeCount(p.detail.length),f=this._lines.onModelLinesInserted(l,p.fromLineNumber,p.toLineNumber,h);f!==null&&(i.emitViewEvent(f),this.viewLayout.onLinesInserted(f.fromLineNumber,f.toLineNumber)),r=!0;break}case 2:{let h=u.dequeue(),[f,g,b,v]=this._lines.onModelLineChanged(l,p.lineNumber,h);s=f,g&&i.emitViewEvent(g),b&&(i.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),v&&(i.emitViewEvent(v),this.viewLayout.onLinesDeleted(v.fromLineNumber,v.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!r&&s&&(i.emitViewEvent(new _u),i.emitViewEvent(new Pa(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){let i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){let r=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let i=this._eventDispatcher.beginEmitViewEvents();t instanceof Nd&&i.emitOutgoingEvent(new vx(t.contentChangedEvent)),this._cursor.onModelContentChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(t=>{let n=[];for(let i=0,r=t.ranges.length;i<r;i++){let s=t.ranges[i],a=this.coordinatesConverter.convertModelPositionToViewPosition(new A(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new A(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;n[i]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new GS(n)),this._eventDispatcher.emitOutgoingEvent(new Ix(t))})),this._register(this.model.onDidChangeLanguageConfiguration(t=>{this._eventDispatcher.emitSingleViewEvent(new US),this.cursorConfig=new Al(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new bx(t))})),this._register(this.model.onDidChangeLanguage(t=>{this.cursorConfig=new Al(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new fx(t))})),this._register(this.model.onDidChangeOptions(t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new xu),n.emitViewEvent(new _u),n.emitViewEvent(new Pa(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Al(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new yx(t))})),this._register(this.model.onDidChangeDecorations(t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Pa(t)),this._eventDispatcher.emitOutgoingEvent(new gx(t))}))}hiddenAreasModel=new DO;previousHiddenAreas=[];setHiddenAreas(t,n){this.hiddenAreasModel.setHiddenAreas(n,t);let i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;let r=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(i),s&&(a.emitViewEvent(new xu),a.emitViewEvent(new _u),a.emitViewEvent(new Pa(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=r.viewportStartModelPosition?.lineNumber;l&&i.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||r.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new px)}getVisibleRangesPlusViewportAboveBelow(){let t=this._configuration.options.get(147),n=this._configuration.options.get(68),i=Math.max(20,Math.round(t.height/n)),r=this.viewLayout.getLinesViewportData(),s=Math.max(1,r.completelyVisibleStartLineNumber-i),a=Math.min(this.getLineCount(),r.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new M(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){let n=this.coordinatesConverter.convertViewRangeToModelRange(t),i=this._lines.getHiddenAreas();if(i.length===0)return[n];let r=[],s=0,a=n.startLineNumber,l=n.startColumn,d=n.endLineNumber,c=n.endColumn;for(let u=0,p=i.length;u<p;u++){let h=i[u].startLineNumber,f=i[u].endLineNumber;f<a||h>d||(a<h&&(r[s++]=new M(a,l,h-1,this.model.getLineMaxColumn(h-1))),a=f+1,l=1)}return(a<d||a===d&&l<c)&&(r[s++]=new M(a,l,d,c)),r}getCompletelyVisibleViewRange(){let t=this.viewLayout.getLinesViewportData(),n=t.completelyVisibleStartLineNumber,i=t.completelyVisibleEndLineNumber;return new M(n,this.getLineMinColumn(n),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(t){let n=this.viewLayout.getLinesViewportDataAtScrollTop(t),i=n.completelyVisibleStartLineNumber,r=n.completelyVisibleEndLineNumber;return new M(i,this.getLineMinColumn(i),r,this.getLineMaxColumn(r))}saveState(){let t=this.viewLayout.saveState(),n=t.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(n),r=this.coordinatesConverter.convertViewPositionToModelPosition(new A(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-n;return{scrollLeft:t.scrollLeft,firstPosition:r,firstPositionDeltaTop:s}}reduceRestoreState(t){if(typeof t.firstPosition>"u")return this._reduceRestoreStateCompatibility(t);let n=this.model.validatePosition(t.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(n),r=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:r}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,n,i){this._viewportStart.update(this,t)}getActiveIndentGuide(t,n,i){return this._lines.getActiveIndentGuide(t,n,i)}getLinesIndentGuides(t,n){return this._lines.getViewLinesIndentGuides(t,n)}getBracketGuidesInRangeByLine(t,n,i,r){return this._lines.getViewLinesBracketGuides(t,n,i,r)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){let n=fn(this.getLineContent(t));return n===-1?0:n+1}getLineLastNonWhitespaceColumn(t){let n=_r(this.getLineContent(t));return n===-1?0:n+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,n){let r=this._decorations.getDecorationsViewportData(t).inlineDecorations[n-t.startLineNumber];return this._getViewLineRenderingData(n,r)}getViewLineRenderingData(t){let n=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,n)}_getViewLineRenderingData(t,n){let i=this.model.mightContainRTL(),r=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(t);return a.inlineDecorations&&(n=[...n,...a.inlineDecorations.map(l=>l.toInlineDecoration(t))]),new Fa(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,i,r,a.tokens,n,s,a.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,n,i){let r=this._lines.getViewLinesData(t,n,i);return new $S(this.getTabSize(),r)}getAllOverviewRulerDecorations(t){let n=this.model.getOverviewRulerDecorations(this._editorId,Xc(this._configuration.options)),i=new LO;for(let r of n){let s=r.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(t.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.startLineNumber,r.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.endLineNumber,r.range.endColumn);i.accept(d,s.zIndex,c,u,l)}return i.asArray}_invalidateDecorationsColorCache(){let t=this.model.getOverviewRulerDecorations();for(let n of t)n.options.overviewRuler?.invalidateCachedColor(),n.options.minimap?.invalidateCachedColor()}getValueInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(i,n)}getValueLengthInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(i,n)}modifyPosition(t,n){let i=this.coordinatesConverter.convertViewPositionToModelPosition(t),r=this.model.modifyPosition(i,n);return this.coordinatesConverter.convertModelPositionToViewPosition(r)}deduceModelPositionRelativeToViewPosition(t,n,i){let r=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(n<0?n-=i:n+=i);let a=this.model.getOffsetAt(r)+n;return this.model.getPositionAt(a)}getPlainTextToCopy(t,n,i){let r=i?`\r
`:this.model.getEOL();t=t.slice(0),t.sort(M.compareRangesUsingStarts);let s=!1,a=!1;for(let d of t)d.isEmpty()?s=!0:a=!0;if(!a){if(!n)return"";let d=t.map(u=>u.startLineNumber),c="";for(let u=0;u<d.length;u++)u>0&&d[u-1]===d[u]||(c+=this.model.getLineContent(d[u])+r);return c}if(s&&n){let d=[],c=0;for(let u of t){let p=u.startLineNumber;u.isEmpty()?p!==c&&d.push(this.model.getLineContent(p)):d.push(this.model.getValueInRange(u,i?2:0)),c=p}return d.length===1?d[0]:d}let l=[];for(let d of t)d.isEmpty()||l.push(this.model.getValueInRange(d,i?2:0));return l.length===1?l[0]:l}getRichTextToCopy(t,n){let i=this.model.getLanguageId();if(i===Ds||t.length!==1)return null;let r=t[0];if(r.isEmpty()){if(!n)return null;let u=r.startLineNumber;r=new M(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===No.fontFamily,c;return d?c=No.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${No.fontFamily}`),{mode:i,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(r,a)+"</div>"}}_getHTMLToCopy(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn,l=this.getTabSize(),d="";for(let c=i;c<=s;c++){let u=this.model.tokenization.getLineTokens(c),p=u.getLineContent(),h=c===i?r-1:0,f=c===s?a-1:p.length;p===""?d+="<br>":d+=HU(p,u.inflate(),n,h,f,l,pt)}return d}_getColorMap(){let t=or.getColorMap(),n=["#000000"];if(t)for(let i=1,r=t.length;i<r;i++)n[i]=V.Format.CSS.formatHex(t[i]);return n}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,n,i){return this._withViewEventsCollector(r=>this._cursor.setStates(r,t,n,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,n,i=0){this._withViewEventsCollector(r=>this._cursor.setSelections(r,t,n,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector(n=>this._cursor.restoreState(n,t))}_executeCursorEdit(t){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new mx);return}this._withViewEventsCollector(t)}executeEdits(t,n,i){this._executeCursorEdit(r=>this._cursor.executeEdits(r,t,n,i))}startComposition(){this._executeCursorEdit(t=>this._cursor.startComposition(t))}endComposition(t){this._executeCursorEdit(n=>this._cursor.endComposition(n,t))}type(t,n){this._executeCursorEdit(i=>this._cursor.type(i,t,n))}compositionType(t,n,i,r,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,t,n,i,r,s))}paste(t,n,i,r){this._executeCursorEdit(s=>this._cursor.paste(s,t,n,i,r))}cut(t){this._executeCursorEdit(n=>this._cursor.cut(n,t))}executeCommand(t,n){this._executeCursorEdit(i=>this._cursor.executeCommand(i,t,n))}executeCommands(t,n){this._executeCursorEdit(i=>this._cursor.executeCommands(i,t,n))}revealAllCursors(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealAll(r,t,i,0,n,0))}revealPrimaryCursor(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealPrimary(r,t,i,0,n,0))}revealTopMostCursor(t){let n=this._cursor.getTopMostViewPosition(),i=new M(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new Pl(t,!1,i,null,0,!0,0)))}revealBottomMostCursor(t){let n=this._cursor.getBottomMostViewPosition(),i=new M(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new Pl(t,!1,i,null,0,!0,0)))}revealRange(t,n,i,r,s){this._withViewEventsCollector(a=>a.emitViewEvent(new Pl(t,!1,i,null,r,n,s)))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new qS),this._eventDispatcher.emitOutgoingEvent(new ux))}_withViewEventsCollector(t){return this._transactionalTarget.batchChanges(()=>{try{let n=this._eventDispatcher.beginEmitViewEvents();return t(n)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(t){this._withViewEventsCollector(()=>{t()})}normalizePosition(t,n){return this._lines.normalizePosition(t,n)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}},_O=class o{constructor(e,t,n,i,r){this._model=e;this._viewLineNumber=t;this._isValid=n;this._modelTrackedRange=i;this._startLineDelta=r}static create(e){let t=e._setTrackedRange(null,new M(1,1,1,1),1);return new o(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){let n=e.coordinatesConverter.convertViewPositionToModelPosition(new A(t,e.getLineMinColumn(t))),i=e.model._setTrackedRange(this._modelTrackedRange,new M(n.lineNumber,n.column,n.lineNumber,n.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),s=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=i,this._startLineDelta=s-r}invalidate(){this._isValid=!1}},LO=class{_asMap=Object.create(null);asArray=[];accept(e,t,n,i,r){let s=this._asMap[e];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===r&&d+1>=n){i>d&&(a[a.length-1]=i);return}a.push(r,n,i)}else{let a=new Du(e,t,[r,n,i]);this._asMap[e]=a,this.asArray.push(a)}}},DO=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(e,t){let n=this.hiddenAreas.get(e);n&&KU(n,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let e=Array.from(this.hiddenAreas.values()).reduce((t,n)=>CG(t,n),[]);return KU(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}};function CG(o,e){let t=[],n=0,i=0;for(;n<o.length&&i<e.length;){let r=o[n],s=e[i];if(r.endLineNumber<s.startLineNumber-1)t.push(o[n++]);else if(s.endLineNumber<r.startLineNumber-1)t.push(e[i++]);else{let a=Math.min(r.startLineNumber,s.startLineNumber),l=Math.max(r.endLineNumber,s.endLineNumber);t.push(new M(a,1,l,1)),n++,i++}}for(;n<o.length;)t.push(o[n++]);for(;i<e.length;)t.push(e[i++]);return t}function KU(o,e){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].equalsRange(e[t]))return!1;return!0}var Px=class{constructor(e,t){this.viewportStartModelPosition=e;this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;let n=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),i=t.getVerticalOffsetForLineNumber(n.lineNumber);t.setScrollPosition({scrollTop:i+this.startLineDelta},1)}};var us=class extends F{constructor(t,n,i,r,s,a,l,d,c,u,p,h){super();this.languageConfigurationService=p;s.willCreateCodeEditor();let f={...n};this._domElement=t,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++SG,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?Gt.SimpleEditorContext:Gt.EditorContext),f,u)),this._register(this._configuration.onDidChange(v=>{this._onDidChangeConfiguration.fire(v);let I=this._configuration.options;if(v.hasChanged(147)){let T=I.get(147);this._onDidLayoutChange.fire(T)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new MO(this,this._contextKeyService)),this._register(new OO(this,this._contextKeyService,h)),this._instantiationService=this._register(r.createChild(new Rp([St,this._contextKeyService]))),this._modelData=null,this._focusTracker=new NO(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let g;Array.isArray(i.contributions)?g=i.contributions:g=zu.getEditorContributions(),this._contributions.initialize(this,g,this._instantiationService);for(let v of zu.getEditorActions()){if(this._actions.has(v.id)){je(new Error(`Cannot have two actions with the same id ${v.id}`));continue}let I=new rx(v.id,v.label,v.alias,v.metadata,v.precondition??void 0,T=>this._instantiationService.invokeFunction(S=>Promise.resolve(v.runEditorCommand(S,this,T))),this._contextKeyService);this._actions.set(I.id,I)}let b=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new CS(this._domElement,{onDragOver:v=>{if(!b())return;let I=this.getTargetAtClientPoint(v.clientX,v.clientY);I?.position&&this.showDropIndicatorAt(I.position)},onDrop:async v=>{if(!b()||(this.removeDropIndicator(),!v.dataTransfer))return;let I=this.getTargetAtClientPoint(v.clientX,v.clientY);I?.position&&this._onDropIntoEditor.fire({position:I.position,event:v})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=yn.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=wA();_contributions=this._register(new ox);_onDidDispose=this._register(new k);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new k({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new bi(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new Fx({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new Fx({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new bi(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new bi(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new bi(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new bi(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new bi(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new bi(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new bi(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new bi(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new bi(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new bi(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new bi(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new bi(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new bi(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new bi(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new bi(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new bi(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new bi(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new k({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new k);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new k);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(t){this._modelData?.view.writeScreenReaderContent(t)}_createConfiguration(t,n,i,r){return new $h(t,n,i,this._domElement,r)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return Af.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?km.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),t):null}getValue(t=null){if(!this._modelData)return"";let n=!!(t&&t.preserveBOM),i=0;return t&&t.lineEnding&&t.lineEnding===`
`?i=1:t&&t.lineEnding&&t.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,n)}setValue(t){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(t)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){try{this._beginUpdate();let n=t;if(this._modelData===null&&n===null||this._modelData&&this._modelData.model===n)return;let i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:n?.uri||null};this._onWillChangeModel.fire(i);let r=this.hasTextFocus(),s=this._detachModel();this._attachModel(n),r&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let t in this._decorationTypeSubtypes){let n=this._decorationTypeSubtypes[t];for(let i in n)this._removeDecorationType(t+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,n,i,r){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,r)}getTopForLineNumber(t,n=!1){return this._modelData?us._getVerticalOffsetForPosition(this._modelData,t,1,n):-1}getTopForPosition(t,n){return this._modelData?us._getVerticalOffsetForPosition(this._modelData,t,n,!1):-1}static _getVerticalOffsetForPosition(t,n,i,r=!1){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,r)}getBottomForLineNumber(t,n=!1){if(!this._modelData)return-1;let i=this._modelData.model.getLineMaxColumn(t);return us._getVerticalOffsetAfterPosition(this._modelData,t,i,n)}setHiddenAreas(t,n){this._modelData?.viewModel.setHiddenAreas(t.map(i=>M.lift(i)),n)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Ft.visibleColumnFromColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)+1}getStatusbarColumn(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Ft.toStatusbarColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,n="api"){if(this._modelData){if(!A.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,n,i,r){if(!this._modelData)return;if(!M.isIRange(t))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(t),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,a,n,r)}revealLine(t,n=0){this._revealLine(t,0,n)}revealLineInCenter(t,n=0){this._revealLine(t,1,n)}revealLineInCenterIfOutsideViewport(t,n=0){this._revealLine(t,2,n)}revealLineNearTop(t,n=0){this._revealLine(t,5,n)}_revealLine(t,n,i){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new M(t,1,t,1),n,!1,i)}revealPosition(t,n=0){this._revealPosition(t,0,!0,n)}revealPositionInCenter(t,n=0){this._revealPosition(t,1,!0,n)}revealPositionInCenterIfOutsideViewport(t,n=0){this._revealPosition(t,2,!0,n)}revealPositionNearTop(t,n=0){this._revealPosition(t,5,!0,n)}_revealPosition(t,n,i,r){if(!A.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new M(t.lineNumber,t.column,t.lineNumber,t.column),n,i,r)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,n="api"){let i=qe.isISelection(t),r=M.isIRange(t);if(!i&&!r)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(t,n);else if(r){let s={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(s,n)}}_setSelectionImpl(t,n){if(!this._modelData)return;let i=new qe(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(n,[i])}revealLines(t,n,i=0){this._revealLines(t,n,0,i)}revealLinesInCenter(t,n,i=0){this._revealLines(t,n,1,i)}revealLinesInCenterIfOutsideViewport(t,n,i=0){this._revealLines(t,n,2,i)}revealLinesNearTop(t,n,i=0){this._revealLines(t,n,5,i)}_revealLines(t,n,i,r){if(typeof t!="number"||typeof n!="number")throw new Error("Invalid arguments");this._sendRevealRange(new M(t,1,n,1),i,!1,r)}revealRange(t,n=0,i=!1,r=!0){this._revealRange(t,i?1:0,r,n)}revealRangeInCenter(t,n=0){this._revealRange(t,1,!0,n)}revealRangeInCenterIfOutsideViewport(t,n=0){this._revealRange(t,2,!0,n)}revealRangeNearTop(t,n=0){this._revealRange(t,5,!0,n)}revealRangeNearTopIfOutsideViewport(t,n=0){this._revealRange(t,6,!0,n)}revealRangeAtTop(t,n=0){this._revealRange(t,3,!0,n)}_revealRange(t,n,i,r){if(!M.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(M.lift(t),n,i,r)}setSelections(t,n="api",i=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let r=0,s=t.length;r<s;r++)if(!qe.isISelection(t[r]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,t,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},n)}}setScrollTop(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},n)}}setScrollPosition(t,n=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,n)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let t=this._contributions.saveViewState(),n=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:n,viewState:i,contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;let n=t;if(n&&n.cursorState&&n.viewState){let i=n.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(n.contributionsState||{});let r=this._modelData.viewModel.reduceRestoreState(n.viewState);this._modelData.view.restoreState(r)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter(n=>n.isSupported()),t}getAction(t){return this._actions.get(t)||null}trigger(t,n,i){i=i||{};try{switch(this._beginUpdate(),n){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(t);return;case"type":{let s=i;this._type(t,s.text||"");return}case"replacePreviousChar":{let s=i;this._compositionType(t,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=i;this._compositionType(t,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=i;this._paste(t,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(t);return}let r=this.getAction(n);if(r){Promise.resolve(r.run(i)).then(void 0,je);return}if(!this._modelData||this._triggerEditorCommand(t,n,i))return;this._triggerCommand(n,i)}finally{this._endUpdate()}}_triggerCommand(t,n){this._commandService.executeCommand(t,n)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,n){!this._modelData||n.length===0||(t==="keyboard"&&this._onWillType.fire(n),this._modelData.viewModel.type(n,t),t==="keyboard"&&this._onDidType.fire(n))}_compositionType(t,n,i,r,s){this._modelData&&this._modelData.viewModel.compositionType(n,i,r,s,t)}_paste(t,n,i,r,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(n,i,r,t);let c=l.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new M(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,n,i){let r=zu.getEditorCommand(n);return r?(i=i||{},i.source=t,this._instantiationService.invokeFunction(s=>{Promise.resolve(r.runEditorCommand(s,this,i)).then(void 0,je)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(t,n,i){if(!this._modelData||this._configuration.options.get(93))return!1;let r;return i?Array.isArray(i)?r=()=>i:r=i:r=()=>null,this._modelData.viewModel.executeEdits(t,n,r),!0}executeCommand(t,n){this._modelData&&this._modelData.viewModel.executeCommand(n,t)}executeCommands(t,n){this._modelData&&this._modelData.viewModel.executeCommands(n,t)}createDecorationsCollection(t){return new AO(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,Xc(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,Xc(this._configuration.options)):null}deltaDecorations(t,n){return this._modelData?t.length===0&&n.length===0?t:this._modelData.model.deltaDecorations(t,n,this._id):[]}removeDecorations(t){!this._modelData||t.length===0||this._modelData.model.changeDecorations(n=>{n.deltaDecorations(t,[])})}setDecorationsByType(t,n,i){let r={},s=this._decorationTypeSubtypes[n]||{};this._decorationTypeSubtypes[n]=r;let a=[];for(let d of i){let c=n;if(d.renderOptions){let p=is(d.renderOptions).toString(16);c=n+"-"+p,!s[p]&&!r[p]&&this._registerDecorationType(t,c,d.renderOptions,n),r[p]=!0}let u=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(u.hoverMessage=d.hoverMessage),a.push({range:d.range,options:u})}for(let d in s)r[d]||this._removeDecorationType(n+"-"+d);let l=this._decorationTypeKeysToIds[n]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[n]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(t,n){let i=this._decorationTypeSubtypes[t]||{};for(let l in i)this._removeDecorationType(t+"-"+l);this._decorationTypeSubtypes[t]={};let r=yn.createDynamic(this._resolveDecorationOptions(t,!1)),s=new Array(n.length);for(let l=0,d=n.length;l<d;l++)s[l]={range:n[l],options:r};let a=this._decorationTypeKeysToIds[t]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[t]=l.deltaDecorations(a,s))}removeDecorationsByType(t){let n=this._decorationTypeKeysToIds[t];n&&this.changeDecorations(i=>i.deltaDecorations(n,[])),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(t)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,n=!1){this._configuration.observeContainer(t),n||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){let n={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(n)}layoutContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];delete this._contentWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(t){let n={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(n)}layoutOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];delete this._overlayWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(t){let n={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(n)}layoutGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];delete this._glyphMarginWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(t)}getTargetAtClientPoint(t,n){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(t,n)}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;let n=this._modelData.model.validatePosition(t),i=this._configuration.options,r=i.get(147),s=us._getVerticalOffsetForPosition(this._modelData,n.lineNumber,n.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(n.lineNumber,n.column)+r.glyphMarginWidth+r.lineNumbersWidth+r.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:i.get(68)}}getOffsetForColumn(t,n){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(t,n)}render(t=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,t)})}setAriaOptions(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(t)}applyFontInfo(t){tn(t,this._configuration.options.get(51))}setBanner(t,n){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=t,this._configuration.setReservedHeight(t?n:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t){this._modelData=null;return}let n=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());let i=t.onBeforeAttached(),r=new Ax(this._id,this._configuration,t,ix.create(Ce(this._domElement)),sx.create(this._configuration.options),l=>Xn(Ce(this._domElement),l),this.languageConfigurationService,this._themeService,i,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});n.push(t.onWillDispose(()=>this.setModel(null))),n.push(r.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let p=this.getOption(81),h=m("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",p);this._notificationService.prompt(rS.Warning,h,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:m("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let p=0,h=l.selections.length;p<h;p++)d[p]=l.selections[p].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let u={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(r);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addContentWidget(this._contentWidgets[u])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addOverlayWidget(this._overlayWidgets[u])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[u])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new RO(t,r,s,a,n,i)}_createView(t){let n;this.isSimpleWidget?n={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:n={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let i=new Fm(t.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new Qm(n,this._configuration,this._themeService.getColorTheme(),t,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let t=this._modelData.model,n=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),n&&this._domElement.contains(n)&&n.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),t}_registerDecorationType(t,n,i,r){this._codeEditorService.registerDecorationType(t,n,i,r,this)}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}_resolveDecorationOptions(t,n){return this._codeEditorService.resolveDecorationOptions(t,n)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){let n=[{range:new M(t.lineNumber,t.column,t.lineNumber,t.column),options:us.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(n),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,n){this._contextKeyService.createKey(t,n)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};us=P([_(3,Qe),_(4,qa),_(5,Gi),_(6,St),_(7,Wo),_(8,mu),_(9,vo),_(10,Cl),_(11,BU)],us);var SG=0,RO=class{constructor(e,t,n,i,r,s){this.model=e;this.viewModel=t;this.view=n;this.hasRealView=i;this.listenersToRemove=r;this.attachedView=s}dispose(){Tt(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var Fx=class extends F{constructor(t){super();this._emitterOptions=t;this._value=0}_onDidChangeToTrue=this._register(new k(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new k(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(t){let n=t?2:1;this._value!==n&&(this._value=n,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},bi=class extends k{constructor(t,n){super({deliveryQueue:n});this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}},MO=class extends F{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=ge.editorSimpleInput.bindTo(t),this._editorFocus=ge.focus.bindTo(t),this._textInputFocus=ge.textInputFocus.bindTo(t),this._editorTextFocus=ge.editorTextFocus.bindTo(t),this._tabMovesFocus=ge.tabMovesFocus.bindTo(t),this._editorReadonly=ge.readOnly.bindTo(t),this._inDiffEditor=ge.inDiffEditor.bindTo(t),this._editorColumnSelection=ge.columnSelection.bindTo(t),this._hasMultipleSelections=ge.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=ge.hasNonEmptySelection.bindTo(t),this._canUndo=ge.canUndo.bindTo(t),this._canRedo=ge.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(qh.onDidChangeTabFocus(n=>this._tabMovesFocus.set(n))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let e=this._editor.getOptions();this._tabMovesFocus.set(qh.getTabFocusMode()),this._editorReadonly.set(e.get(93)),this._inDiffEditor.set(e.get(62)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){let e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}},OO=class extends F{constructor(t,n,i){super();this._editor=t;this._contextKeyService=n;this._languageFeaturesService=i;this._langId=ge.languageId.bindTo(n),this._hasCompletionItemProvider=ge.hasCompletionItemProvider.bindTo(n),this._hasCodeActionsProvider=ge.hasCodeActionsProvider.bindTo(n),this._hasCodeLensProvider=ge.hasCodeLensProvider.bindTo(n),this._hasDefinitionProvider=ge.hasDefinitionProvider.bindTo(n),this._hasDeclarationProvider=ge.hasDeclarationProvider.bindTo(n),this._hasImplementationProvider=ge.hasImplementationProvider.bindTo(n),this._hasTypeDefinitionProvider=ge.hasTypeDefinitionProvider.bindTo(n),this._hasHoverProvider=ge.hasHoverProvider.bindTo(n),this._hasDocumentHighlightProvider=ge.hasDocumentHighlightProvider.bindTo(n),this._hasDocumentSymbolProvider=ge.hasDocumentSymbolProvider.bindTo(n),this._hasReferenceProvider=ge.hasReferenceProvider.bindTo(n),this._hasRenameProvider=ge.hasRenameProvider.bindTo(n),this._hasSignatureHelpProvider=ge.hasSignatureHelpProvider.bindTo(n),this._hasInlayHintsProvider=ge.hasInlayHintsProvider.bindTo(n),this._hasDocumentFormattingProvider=ge.hasDocumentFormattingProvider.bindTo(n),this._hasDocumentSelectionFormattingProvider=ge.hasDocumentSelectionFormattingProvider.bindTo(n),this._hasMultipleDocumentFormattingProvider=ge.hasMultipleDocumentFormattingProvider.bindTo(n),this._hasMultipleDocumentSelectionFormattingProvider=ge.hasMultipleDocumentSelectionFormattingProvider.bindTo(n),this._isInEmbeddedEditor=ge.isInEmbeddedEditor.bindTo(n);let r=()=>this._update();this._register(t.onDidChangeModel(r)),this._register(t.onDidChangeModelLanguage(r)),this._register(i.completionProvider.onDidChange(r)),this._register(i.codeActionProvider.onDidChange(r)),this._register(i.codeLensProvider.onDidChange(r)),this._register(i.definitionProvider.onDidChange(r)),this._register(i.declarationProvider.onDidChange(r)),this._register(i.implementationProvider.onDidChange(r)),this._register(i.typeDefinitionProvider.onDidChange(r)),this._register(i.hoverProvider.onDidChange(r)),this._register(i.documentHighlightProvider.onDidChange(r)),this._register(i.documentSymbolProvider.onDidChange(r)),this._register(i.referenceProvider.onDidChange(r)),this._register(i.renameProvider.onDidChange(r)),this._register(i.documentFormattingEditProvider.onDidChange(r)),this._register(i.documentRangeFormattingEditProvider.onDidChange(r)),this._register(i.signatureHelpProvider.onDidChange(r)),this._register(i.inlayHintsProvider.onDidChange(r)),r()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let t=this._editor.getModel();if(!t){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===xe.walkThroughSnippet||t.uri.scheme===xe.vscodeChatCodeBlock)})}},NO=class extends F{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new k);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(e,t){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Ol(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(Ol(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},AO=class{constructor(e,t){this._editor=e;Array.isArray(t)&&t.length>0&&this.set(t)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(e,t,n){return this._editor.onDidChangeModelDecorations(i=>{this._isChangingDecorations||e.call(t,i)},n)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];let e=this._editor.getModel(),t=[];for(let n of this._decorationIds){let i=e.getDecorationRange(n);i&&t.push(i)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(n=>{t=n.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}},EG=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),TG=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function kO(o){return EG+encodeURIComponent(o.toString())+TG}var wG=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),xG=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function _G(o){return wG+encodeURIComponent(o.toString())+xG}Io((o,e)=>{let t=o.getColor(ru);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${kO(t)}") repeat-x bottom left; }`);let n=o.getColor(So);n&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${kO(n)}") repeat-x bottom left; }`);let i=o.getColor(lr);i&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${kO(i)}") repeat-x bottom left; }`);let r=o.getColor(zF);r&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${_G(r)}") no-repeat bottom left; }`);let s=o.getColor(R2);s&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});function GU(o,e,t,n){if(o.length===0)return e;if(e.length===0)return o;let i=[],r=0,s=0;for(;r<o.length&&s<e.length;){let a=o[r],l=e[s],d=t(a),c=t(l);d<c?(i.push(a),r++):d>c?(i.push(l),s++):(i.push(n(a,l)),r++,s++)}for(;r<o.length;)i.push(o[r]),r++;for(;s<e.length;)i.push(e[s]),s++;return i}function Xm(o,e){let t=new ne,n=o.createDecorationsCollection();return t.add(ul({debugName:()=>`Apply decorations from ${e.debugName}`},i=>{let r=e.read(i);n.set(r)})),t.add({dispose:()=>{n.clear()}}),t}function lp(o,e){return o.appendChild(e),pe(()=>{e.remove()})}function jU(o,e){return o.prepend(e),pe(()=>{e.remove()})}var Bx=class extends F{elementSizeObserver;_width;get width(){return this._width}_height;get height(){return this._height}_automaticLayout=!1;get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this.elementSizeObserver=this._register(new Gh(e,t)),this._width=st(this,this.elementSizeObserver.getWidth()),this._height=st(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(n=>Yt(i=>{this._width.set(this.elementSizeObserver.getWidth(),i),this._height.set(this.elementSizeObserver.getHeight(),i)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}};function BO(o,e,t){let n=e.get(),i=n,r=n,s=st("animatedValue",n),a=-1,l=300,d;t.add(cd({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(u,p)=>(u.didChange(e)&&(p.animate=p.animate||u.change),!0)},(u,p)=>{d!==void 0&&(o.cancelAnimationFrame(d),d=void 0),i=r,n=e.read(u),a=Date.now()-(p.animate?0:l),c()}));function c(){let u=Date.now()-a;r=Math.floor(LG(u,i,n-i,l)),u<l?d=o.requestAnimationFrame(c):r=n,s.set(r,void 0)}return s}function LG(o,e,t,n){return o===n?e+t:t*(-Math.pow(2,-10*o/n)+1)+e}var sp=class extends F{constructor(e,t,n){super(),this._register(new PO(e,n)),this._register(Kr(n,{height:t.actualHeight,top:t.actualTop}))}},Za=class{constructor(e,t){this._afterLineNumber=e;this.heightInPx=t}domNode=document.createElement("div");_actualTop=st(this,void 0);_actualHeight=st(this,void 0);actualTop=this._actualTop;actualHeight=this._actualHeight;showInHiddenAreas=!0;get afterLineNumber(){return this._afterLineNumber.get()}onChange=this._afterLineNumber;onDomNodeTop=e=>{this._actualTop.set(e,void 0)};onComputedHeight=e=>{this._actualHeight.set(e,void 0)}},PO=class o{constructor(e,t){this._editor=e;this._domElement=t;this._editor.addOverlayWidget(this._overlayWidget)}static _counter=0;_overlayWidgetId=`managedOverlayWidget-${o._counter++}`;_overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null};dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};function Kr(o,e){return ot(t=>{for(let[n,i]of Object.entries(e))i&&typeof i=="object"&&"read"in i&&(i=i.read(t)),typeof i=="number"&&(i=`${i}px`),n=n.replace(/[A-Z]/g,r=>"-"+r.toLowerCase()),o.style[n]=i})}function Jm(o,e,t,n){let i=new ne,r=[];return i.add(yi((s,a)=>{let l=e.read(s),d=new Map,c=new Map;t&&t(!0),o.changeViewZones(u=>{for(let p of r)u.removeZone(p),n?.delete(p);r.length=0;for(let p of l){let h=u.addZone(p);p.setZoneId&&p.setZoneId(h),r.push(h),n?.add(h),d.set(p,h)}}),t&&t(!1),a.add(cd({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(u,p){let h=c.get(u.changedObservable);return h!==void 0&&p.zoneIds.push(h),!0}},(u,p)=>{for(let h of l)h.onChange&&(c.set(h.onChange,d.get(h)),h.onChange.read(u));t&&t(!0),o.changeViewZones(h=>{for(let f of p.zoneIds)h.layoutZone(f)}),t&&t(!1)}))})),i.add({dispose(){t&&t(!0),o.changeViewZones(s=>{for(let a of r)s.removeZone(a)}),n?.clear(),t&&t(!1)}}),i}function WO(o,e){let t=xc(e,i=>i.original.startLineNumber<=o.lineNumber);if(!t)return M.fromPositions(o);if(t.original.endLineNumberExclusive<=o.lineNumber){let i=o.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return M.fromPositions(new A(i,o.column))}if(!t.innerChanges)return M.fromPositions(new A(t.modified.startLineNumber,1));let n=xc(t.innerChanges,i=>i.originalRange.getStartPosition().isBeforeOrEqual(o));if(!n){let i=o.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return M.fromPositions(new A(i,o.column))}if(n.originalRange.containsPosition(o))return n.modifiedRange;{let i=DG(n.originalRange.getEndPosition(),o);return M.fromPositions(i.addToPosition(n.modifiedRange.getEndPosition()))}}function DG(o,e){return o.lineNumber===e.lineNumber?new Fo(0,e.column-o.column):new Fo(e.lineNumber-o.lineNumber,e.column-1)}function qU(o,e){let t;return o.filter(n=>{let i=e(n,t);return t=n,i})}var ap=class{static create(e,t=void 0){return new _v(e,e,t)}static createWithDisposable(e,t,n=void 0){let i=new ne;return i.add(t),i.add(e),new _v(e,i,n)}static createOfNonDisposable(e,t,n=void 0){return new _v(e,t,n)}},_v=class extends ap{constructor(t,n,i){super();this.object=t;this._disposable=n;this._debugOwner=i;i&&this._addOwner(i)}_refCount=1;_isDisposed=!1;_owners=[];_addOwner(t){t&&this._owners.push(t)}createNewRef(t){return this._refCount++,t&&this._addOwner(t),new FO(this,t)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(t){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),t){let n=this._owners.indexOf(t);n!==-1&&this._owners.splice(n,1)}}},FO=class extends ap{constructor(t,n){super();this._base=t;this._debugOwner=n}_isDisposed=!1;get object(){return this._base.object}createNewRef(t){return this._base.createNewRef(t)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}};function $U(o,e,t){return pA({debugName:()=>`Configuration Key "${o}"`},n=>t.onDidChangeConfiguration(i=>{i.affectsConfiguration(o)&&n(i)}),()=>t.getValue(o)??e)}function Qa(o,e,t){let n=o.bindTo(e);return ul({debugName:()=>`Set Context Key "${o.key}"`},i=>{n.set(t(i))})}var Vx=Q("accessibilitySignalService"),$Yt=Symbol("AcknowledgeDocCommentsToken"),Wx=class extends F{constructor(t,n,i){super();this.configurationService=t;this.accessibilityService=n;this.telemetryService=i}_serviceBrand;sounds=new Map;screenReaderAttached=Dt(this,this.accessibilityService.onDidChangeScreenReaderOptimized,()=>this.accessibilityService.isScreenReaderOptimized());sentTelemetry=new Set;getEnabledState(t,n,i){return new hy(this._signalEnabledState.get({signal:t,userGesture:n,modality:i}))}async playSignal(t,n={}){let i=n.modality==="announcement"||n.modality===void 0,r=t.announcementMessage;i&&this.isAnnouncementEnabled(t,n.userGesture)&&r&&this.accessibilityService.status(r),(n.modality==="sound"||n.modality===void 0)&&this.isSoundEnabled(t,n.userGesture)&&(this.sendSignalTelemetry(t,n.source),await this.playSound(t.sound.getSound(),n.allowManyInParallel))}async playSignals(t){for(let s of t)this.sendSignalTelemetry("signal"in s?s.signal:s,"source"in s?s.source:void 0);let n=t.map(s=>"signal"in s?s.signal:s),i=n.filter(s=>this.isAnnouncementEnabled(s)).map(s=>s.announcementMessage);i.length&&this.accessibilityService.status(i.join(", "));let r=new Set(n.filter(s=>this.isSoundEnabled(s)).map(s=>s.sound.getSound()));await Promise.all(Array.from(r).map(s=>this.playSound(s,!0)))}sendSignalTelemetry(t,n){let i=this.accessibilityService.isScreenReaderOptimized(),r=t.name+(n?`::${n}`:"")+(i?"{screenReaderOptimized}":"");this.sentTelemetry.has(r)||this.getVolumeInPercent()===0||(this.sentTelemetry.add(r),this.telemetryService.publicLog2("signal.played",{signal:t.name,source:n??"",isScreenReaderOptimized:i}))}getVolumeInPercent(){let t=this.configurationService.getValue("accessibility.signalOptions.volume");return typeof t!="number"?50:Math.max(Math.min(t,100),0)}playingSounds=new Set;async playSound(t,n=!1){if(!n&&this.playingSounds.has(t))return;this.playingSounds.add(t);let i=ha.asBrowserUri(`vs/platform/accessibilitySignal/browser/media/${t.fileName}`).toString(!0);try{let r=this.sounds.get(i);if(r)r.volume=this.getVolumeInPercent()/100,r.currentTime=0,await r.play();else{let s=await kG(i,this.getVolumeInPercent()/100);this.sounds.set(i,s)}}catch(r){r.message.includes("play() can only be initiated by a user gesture")||console.error("Error while playing sound",r)}finally{this.playingSounds.delete(t)}}playSignalLoop(t,n){let i=!0,r=()=>{i&&this.playSignal(t,{allowManyInParallel:!0}).finally(()=>{setTimeout(()=>{i&&r()},n)})};return r(),pe(()=>i=!1)}_signalConfigValue=new md(t=>$U(t.settingsKey,{sound:"off",announcement:"off"},this.configurationService));_signalEnabledState=new md({getCacheKey:sA},t=>Me(n=>{let i=this._signalConfigValue.get(t.signal).read(n);return!!((t.modality==="sound"||t.modality===void 0)&&YU(i.sound,()=>this.screenReaderAttached.read(n),t.userGesture)||(t.modality==="announcement"||t.modality===void 0)&&YU(i.announcement,()=>this.screenReaderAttached.read(n),t.userGesture))}).recomputeInitiallyAndOnChange(this._store));isAnnouncementEnabled(t,n){return t.announcementMessage?this._signalEnabledState.get({signal:t,userGesture:!!n,modality:"announcement"}).get():!1}isSoundEnabled(t,n){return this._signalEnabledState.get({signal:t,userGesture:!!n,modality:"sound"}).get()}onSoundEnabledChanged(t){return this.getEnabledState(t,!1).onDidChange}getDelayMs(t,n,i){if(!this.configurationService.getValue("accessibility.signalOptions.debouncePositionChanges"))return 0;let r;return t.name===vr.errorAtPosition.name&&i==="positional"?r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.errorAtPosition"):t.name===vr.warningAtPosition.name&&i==="positional"?r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.warningAtPosition"):r=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.general"),n==="sound"?r.sound:r.announcement}};Wx=P([_(0,ut),_(1,vo),_(2,Li)],Wx);function YU(o,e,t){return o==="on"||o==="always"||o==="auto"&&e()||o==="userGesture"&&t}function kG(o,e){return new Promise((t,n)=>{let i=new Audio(o);i.volume=e,i.addEventListener("ended",()=>{t(i)}),i.addEventListener("error",r=>{n(r.error)}),i.play().catch(r=>{n(r)})})}var Ht=class o{constructor(e){this.fileName=e}static register(e){return new o(e.fileName)}static error=o.register({fileName:"error.mp3"});static warning=o.register({fileName:"warning.mp3"});static success=o.register({fileName:"success.mp3"});static foldedArea=o.register({fileName:"foldedAreas.mp3"});static break=o.register({fileName:"break.mp3"});static quickFixes=o.register({fileName:"quickFixes.mp3"});static taskCompleted=o.register({fileName:"taskCompleted.mp3"});static taskFailed=o.register({fileName:"taskFailed.mp3"});static terminalBell=o.register({fileName:"terminalBell.mp3"});static diffLineInserted=o.register({fileName:"diffLineInserted.mp3"});static diffLineDeleted=o.register({fileName:"diffLineDeleted.mp3"});static diffLineModified=o.register({fileName:"diffLineModified.mp3"});static chatRequestSent=o.register({fileName:"chatRequestSent.mp3"});static chatResponseReceived1=o.register({fileName:"chatResponseReceived1.mp3"});static chatResponseReceived2=o.register({fileName:"chatResponseReceived2.mp3"});static chatResponseReceived3=o.register({fileName:"chatResponseReceived3.mp3"});static chatResponseReceived4=o.register({fileName:"chatResponseReceived4.mp3"});static clear=o.register({fileName:"clear.mp3"});static save=o.register({fileName:"save.mp3"});static format=o.register({fileName:"format.mp3"});static voiceRecordingStarted=o.register({fileName:"voiceRecordingStarted.mp3"});static voiceRecordingStopped=o.register({fileName:"voiceRecordingStopped.mp3"});static progress=o.register({fileName:"progress.mp3"})},VO=class{constructor(e){this.randomOneOf=e}getSound(e=!1){if(e||this.randomOneOf.length===1)return this.randomOneOf[0];{let t=Math.floor(Math.random()*this.randomOneOf.length);return this.randomOneOf[t]}}},vr=class o{constructor(e,t,n,i,r,s){this.sound=e;this.name=t;this.legacySoundSettingsKey=n;this.settingsKey=i;this.legacyAnnouncementSettingsKey=r;this.announcementMessage=s}static _signals=new Set;static register(e){let t=new VO("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),n=new o(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage);return o._signals.add(n),n}static get allAccessibilitySignals(){return[...this._signals]}static errorAtPosition=o.register({name:m("accessibilitySignals.positionHasError.name","Error at Position"),sound:Ht.error,announcementMessage:m("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"});static warningAtPosition=o.register({name:m("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:Ht.warning,announcementMessage:m("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"});static errorOnLine=o.register({name:m("accessibilitySignals.lineHasError.name","Error on Line"),sound:Ht.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:m("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"});static warningOnLine=o.register({name:m("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:Ht.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:m("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"});static foldedArea=o.register({name:m("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:Ht.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:m("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"});static break=o.register({name:m("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:Ht.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:m("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"});static inlineSuggestion=o.register({name:m("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:Ht.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"});static terminalQuickFix=o.register({name:m("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:Ht.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:m("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"});static onDebugBreak=o.register({name:m("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:Ht.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:m("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"});static noInlayHints=o.register({name:m("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:Ht.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:m("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"});static taskCompleted=o.register({name:m("accessibilitySignals.taskCompleted","Task Completed"),sound:Ht.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:m("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"});static taskFailed=o.register({name:m("accessibilitySignals.taskFailed","Task Failed"),sound:Ht.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:m("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"});static terminalCommandFailed=o.register({name:m("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:Ht.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:m("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"});static terminalCommandSucceeded=o.register({name:m("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:Ht.success,announcementMessage:m("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"});static terminalBell=o.register({name:m("accessibilitySignals.terminalBell","Terminal Bell"),sound:Ht.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:m("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"});static notebookCellCompleted=o.register({name:m("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:Ht.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:m("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"});static notebookCellFailed=o.register({name:m("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:Ht.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:m("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"});static diffLineInserted=o.register({name:m("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:Ht.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"});static diffLineDeleted=o.register({name:m("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:Ht.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"});static diffLineModified=o.register({name:m("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:Ht.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"});static chatRequestSent=o.register({name:m("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:Ht.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:m("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"});static chatResponseReceived=o.register({name:m("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[Ht.chatResponseReceived1,Ht.chatResponseReceived2,Ht.chatResponseReceived3,Ht.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"});static progress=o.register({name:m("accessibilitySignals.progress","Progress"),sound:Ht.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:m("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"});static clear=o.register({name:m("accessibilitySignals.clear","Clear"),sound:Ht.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:m("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"});static save=o.register({name:m("accessibilitySignals.save","Save"),sound:Ht.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:m("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"});static format=o.register({name:m("accessibilitySignals.format","Format"),sound:Ht.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:m("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"});static voiceRecordingStarted=o.register({name:m("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:Ht.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"});static voiceRecordingStopped=o.register({name:m("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:Ht.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"})};function dp(o){return HO.get(o)}var HO=class o extends F{constructor(t){super();this.editor=t;this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(n=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,n)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(n=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,n),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(n=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,n),this._forceUpdate()}finally{this._endUpdate()}}))}static _map=new Map;static get(t){let n=o._map.get(t);if(!n){n=new o(t),o._map.set(t,n);let i=t.onDidDispose(()=>{let r=o._map.get(t);r&&(o._map.delete(t),r.dispose(),i.dispose())})}return n}_updateCounter=0;_currentTransaction=void 0;_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new pd(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){let t=this._currentTransaction;this._currentTransaction=void 0,t.finish()}}forceUpdate(t){this._beginUpdate();try{return this._forceUpdate(),t?t(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}_model=st(this,this.editor.getModel());model=this._model;isReadonly=Dt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(93));_versionId=fy({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null);versionId=this._versionId;_selections=fy({owner:this,equalsFn:ly(z_(qe.selectionsEqual)),lazy:!0},this.editor.getSelections()??null);selections=this._selections;positions=ca({owner:this,equalsFn:ly(z_(A.equals))},t=>this.selections.read(t)?.map(n=>n.getStartPosition())??null);isFocused=Dt(this,t=>{let n=this.editor.onDidFocusEditorWidget(t),i=this.editor.onDidBlurEditorWidget(t);return{dispose(){n.dispose(),i.dispose()}}},()=>this.editor.hasWidgetFocus());value=Cp(this,t=>(this.versionId.read(t),this.model.read(t)?.getValue()??""),(t,n)=>{let i=this.model.get();i!==null&&t!==i.getValue()&&i.setValue(t)});valueIsEmpty=Me(this,t=>(this.versionId.read(t),this.editor.getModel()?.getValueLength()===0));cursorSelection=ca({owner:this,equalsFn:ly(qe.selectionsEqual)},t=>this.selections.read(t)?.[0]??null);cursorPosition=ca({owner:this,equalsFn:A.equals},t=>this.selections.read(t)?.[0]?.getPosition()??null);onDidType=Oc(this);scrollTop=Dt(this.editor.onDidScrollChange,()=>this.editor.getScrollTop());scrollLeft=Dt(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft());layoutInfo=Dt(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo());layoutInfoContentLeft=this.layoutInfo.map(t=>t.contentLeft);layoutInfoDecorationsLeft=this.layoutInfo.map(t=>t.decorationsLeft);contentWidth=Dt(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth());getOption(t){return Dt(this,n=>this.editor.onDidChangeConfiguration(i=>{i.hasChanged(t)&&n(void 0)}),()=>this.editor.getOption(t))}setDecorations(t){let n=new ne,i=this.editor.createDecorationsCollection();return n.add(ul({owner:this,debugName:()=>`Apply decorations from ${t.debugName}`},r=>{let s=t.read(r);i.set(s)})),n.add({dispose:()=>{i.clear()}}),n}_overlayWidgetCounter=0;createOverlayWidget(t){let n="observableOverlayWidget"+this._overlayWidgetCounter++,i={getDomNode:()=>t.domNode,getPosition:()=>t.position.get(),getId:()=>n,allowEditorOverflow:t.allowEditorOverflow,getMinContentWidthInPx:()=>t.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);let r=ot(s=>{t.position.read(s),t.minContentWidthInPx.read(s),this.editor.layoutOverlayWidget(i)});return pe(()=>{r.dispose(),this.editor.removeOverlayWidget(i)})}};var jZt=new RegExp("\\bMARK:\\s*(.*)$","d");var ZU=Q("editorWorkerService");var UO=Q("diffProviderFactoryService"),Lv=class{constructor(e){this.instantiationService=e}_serviceBrand;createDiffProvider(e){return this.instantiationService.createInstance(ea,e)}};Lv=P([_(0,Qe)],Lv);ji(UO,Lv,1);var ea=class{constructor(e,t,n){this.editorWorkerService=t;this.telemetryService=n;this.setOptions(e)}onDidChangeEventEmitter=new k;onDidChange=this.onDidChangeEventEmitter.event;diffAlgorithm="advanced";diffAlgorithmOnDidChangeSubscription=void 0;static diffCache=new Map;dispose(){this.diffAlgorithmOnDidChangeSubscription?.dispose()}async computeDiff(e,t,n,i){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,n,i);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new mr(new De(1,2),new De(1,t.getLineCount()+1),[new so(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};let r=JSON.stringify([e.uri.toString(),t.uri.toString()]),s=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(n)]),a=ea.diffCache.get(r);if(a&&a.context===s)return a.result;let l=Ss.create(),d=await this.editorWorkerService.computeDiff(e.uri,t.uri,n,this.diffAlgorithm),c=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:c,timedOut:d?.quitEarly??!0,detectedMoves:n.computeMoves?d?.moves.length??0:-1}),i.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!d)throw new Error("no diff result available");return ea.diffCache.size>10&&ea.diffCache.delete(ea.diffCache.keys().next().value),ea.diffCache.set(r,{result:d,context:s}),d}setOptions(e){let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription?.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}};ea=P([_(1,ZU),_(2,Li)],ea);function Ux(){return gs&&!!gs.VSCODE_DEV}function zO(o){if(Ux()){let e=RG();return e.add(o),{dispose(){e.delete(o)}}}else return{dispose(){}}}function RG(){Hx||(Hx=new Set);let o=globalThis;return o.$hotReload_applyNewExports||(o.$hotReload_applyNewExports=e=>{let t={config:{mode:void 0},...e},n=[];for(let i of Hx){let r=i(t);r&&n.push(r)}if(n.length>0)return i=>{let r=!1;for(let s of n)s(i)&&(r=!0);return r}}),Hx}var Hx;Ux()&&zO(({oldExports:o,newSrc:e,config:t})=>{if(t.mode==="patch-prototype")return n=>{for(let i in n){let r=n[i];if(console.log(`[hot-reload] Patching prototype methods of '${i}'`,{exportedItem:r}),typeof r=="function"&&r.prototype){let s=o[i];if(s){for(let a of Object.getOwnPropertyNames(r.prototype)){let l=Object.getOwnPropertyDescriptor(r.prototype,a),d=Object.getOwnPropertyDescriptor(s.prototype,a);l?.value?.toString()!==d?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${i}.${a}'`),Object.defineProperty(s.prototype,a,l)}n[i]=s}}}return!0}});function ps(o,e){return MG([o],e),o}function MG(o,e){Ux()&&Ii("reload",n=>zO(({oldExports:i})=>{if([...Object.values(i)].some(r=>o.includes(r)))return r=>(n(void 0),!0)})).read(e)}var Ja=class o{constructor(e,t){this.diffs=e;this.hitTimeout=t}static trivial(e,t){return new o([new In(ke.ofLength(e.length),ke.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new o([new In(ke.ofLength(e.length),ke.ofLength(t.length))],!0)}},In=class o{constructor(e,t){this.seq1Range=e;this.seq2Range=t}static invert(e,t){let n=[];return ry(e,(i,r)=>{n.push(o.fromOffsetPairs(i?i.getEndExclusives():Xa.zero,r?r.getStarts():new Xa(t,(i?i.seq2Range.endExclusive-i.seq1Range.endExclusive:0)+t)))}),n}static fromOffsetPairs(e,t){return new o(new ke(e.offset1,t.offset1),new ke(e.offset2,t.offset2))}static assertSorted(e){let t;for(let n of e){if(t&&!(t.seq1Range.endExclusive<=n.seq1Range.start&&t.seq2Range.endExclusive<=n.seq2Range.start))throw new $e("Sequence diffs must be sorted");t=n}}swap(){return new o(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new o(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new o(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new o(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new o(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersectsOrTouches(e){return this.seq1Range.intersectsOrTouches(e.seq1Range)||this.seq2Range.intersectsOrTouches(e.seq2Range)}intersect(e){let t=this.seq1Range.intersect(e.seq1Range),n=this.seq2Range.intersect(e.seq2Range);if(!(!t||!n))return new o(t,n)}getStarts(){return new Xa(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new Xa(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}},Xa=class o{constructor(e,t){this.offset1=e;this.offset2=t}static zero=new o(0,0);static max=new o(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new o(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}},bc=class o{static instance=new o;isValid(){return!0}},zx=class{constructor(e){this.timeout=e;if(e<=0)throw new $e("timeout must be positive")}startTime=Date.now();valid=!0;isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}disable(){this.timeout=Number.MAX_SAFE_INTEGER,this.isValid=()=>!0,this.valid=!0}};var eg=class{constructor(e,t){this.width=e;this.height=t;this.array=new Array(e*t)}array=[];get(e,t){return this.array[e+t*this.width]}set(e,t,n){this.array[e+t*this.width]=n}};function kv(o){return o===32||o===9}var Dv=class o{constructor(e,t,n){this.range=e;this.lines=t;this.source=n;let i=0;for(let r=e.startLineNumber-1;r<e.endLineNumberExclusive-1;r++){let s=t[r];for(let l=0;l<s.length;l++){i++;let d=s[l],c=o.getKey(d);this.histogram[c]=(this.histogram[c]||0)+1}i++;let a=o.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=i}static chrKeys=new Map;static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}totalCount;histogram=[];computeSimilarity(e){let t=0,n=Math.max(this.histogram.length,e.histogram.length);for(let i=0;i<n;i++)t+=Math.abs((this.histogram[i]??0)-(e.histogram[i]??0));return 1-t/(this.totalCount+e.totalCount)}};var Kx=class{compute(e,t,n=bc.instance,i){if(e.length===0||t.length===0)return Ja.trivial(e,t);let r=new eg(e.length,t.length),s=new eg(e.length,t.length),a=new eg(e.length,t.length);for(let f=0;f<e.length;f++)for(let g=0;g<t.length;g++){if(!n.isValid())return Ja.trivialTimedOut(e,t);let b=f===0?0:r.get(f-1,g),v=g===0?0:r.get(f,g-1),I;e.getElement(f)===t.getElement(g)?(f===0||g===0?I=0:I=r.get(f-1,g-1),f>0&&g>0&&s.get(f-1,g-1)===3&&(I+=a.get(f-1,g-1)),I+=i?i(f,g):1):I=-1;let T=Math.max(b,v,I);if(T===I){let S=f>0&&g>0?a.get(f-1,g-1):0;a.set(f,g,S+1),s.set(f,g,3)}else T===b?(a.set(f,g,0),s.set(f,g,1)):T===v&&(a.set(f,g,0),s.set(f,g,2));r.set(f,g,T)}let l=[],d=e.length,c=t.length;function u(f,g){(f+1!==d||g+1!==c)&&l.push(new In(new ke(f+1,d),new ke(g+1,c))),d=f,c=g}let p=e.length-1,h=t.length-1;for(;p>=0&&h>=0;)s.get(p,h)===3?(u(p,h),p--,h--):s.get(p,h)===1?p--:h--;return u(-1,-1),l.reverse(),new Ja(l,!1)}};var tg=class{compute(e,t,n=bc.instance){if(e.length===0||t.length===0)return Ja.trivial(e,t);let i=e,r=t;function s(g,b){for(;g<i.length&&b<r.length&&i.getElement(g)===r.getElement(b);)g++,b++;return g}let a=0,l=new KO;l.set(0,s(0,0));let d=new GO;d.set(0,l.get(0)===0?null:new Gx(null,0,0,l.get(0)));let c=0;e:for(;;){if(a++,!n.isValid())return Ja.trivialTimedOut(i,r);let g=-Math.min(a,r.length+a%2),b=Math.min(a,i.length+a%2);for(c=g;c<=b;c+=2){let v=0,I=c===b?-1:l.get(c+1),T=c===g?-1:l.get(c-1)+1;v++;let S=Math.min(Math.max(I,T),i.length),C=S-c;if(v++,S>i.length||C>r.length)continue;let w=s(S,C);l.set(c,w);let x=S===I?d.get(c+1):d.get(c-1);if(d.set(c,w!==S?new Gx(x,S,C,w-S):x),l.get(c)===i.length&&l.get(c)-c===r.length)break e}}let u=d.get(c),p=[],h=i.length,f=r.length;for(;;){let g=u?u.x+u.length:0,b=u?u.y+u.length:0;if((g!==h||b!==f)&&p.push(new In(new ke(g,h),new ke(b,f))),!u)break;h=u.x,f=u.y,u=u.prev}return p.reverse(),new Ja(p,!1)}},Gx=class{constructor(e,t,n,i){this.prev=e;this.x=t;this.y=n;this.length=i}},KO=class{positiveArr=new Int32Array(10);negativeArr=new Int32Array(10);get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){let n=this.negativeArr;this.negativeArr=new Int32Array(n.length*2),this.negativeArr.set(n)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){let n=this.positiveArr;this.positiveArr=new Int32Array(n.length*2),this.positiveArr.set(n)}this.positiveArr[e]=t}}},GO=class{positiveArr=[];negativeArr=[];get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}};var vc=class{constructor(e,t,n){this.lines=e;this.range=t;this.considerWhitespaceChanges=n;this.firstElementOffsetByLineIdx.push(0);for(let i=this.range.startLineNumber;i<=this.range.endLineNumber;i++){let r=e[i-1],s=0;i===this.range.startLineNumber&&this.range.startColumn>1&&(s=this.range.startColumn-1,r=r.substring(s)),this.lineStartOffsets.push(s);let a=0;if(!n){let d=r.trimStart();a=r.length-d.length,r=d.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);let l=i===this.range.endLineNumber?Math.min(this.range.endColumn-1-s-a,r.length):r.length;for(let d=0;d<l;d++)this.elements.push(r.charCodeAt(d));i<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}elements=[];firstElementOffsetByLineIdx=[];lineStartOffsets=[];trimmedWsLengthsByLineIdx=[];toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new ke(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){let t=XU(e>0?this.elements[e-1]:-1),n=XU(e<this.elements.length?this.elements[e]:-1);if(t===7&&n===8)return 0;if(t===8)return 150;let i=0;return t!==n&&(i+=10,t===0&&n===1&&(i+=1)),i+=QU(t),i+=QU(n),i}translateOffset(e,t="right"){let n=ll(this.firstElementOffsetByLineIdx,r=>r<=e),i=e-this.firstElementOffsetByLineIdx[n];return new A(this.range.startLineNumber+n,1+this.lineStartOffsets[n]+i+(i===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[n]))}translateRange(e){let t=this.translateOffset(e.start,"right"),n=this.translateOffset(e.endExclusive,"left");return n.isBefore(t)?M.fromPositions(n,n):M.fromPositions(t,n)}findWordContaining(e){if(e<0||e>=this.elements.length||!jO(this.elements[e]))return;let t=e;for(;t>0&&jO(this.elements[t-1]);)t--;let n=e;for(;n<this.elements.length&&jO(this.elements[n]);)n++;return new ke(t,n)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){let t=al(this.firstElementOffsetByLineIdx,i=>i<=e.start)??0,n=zN(this.firstElementOffsetByLineIdx,i=>e.endExclusive<=i)??this.elements.length;return new ke(t,n)}};function jO(o){return o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57}var OG={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function QU(o){return OG[o]}function XU(o){return o===10?8:o===13?7:kv(o)?6:o>=97&&o<=122?0:o>=65&&o<=90?1:o>=48&&o<=57?2:o===-1?3:o===44||o===59?5:4}function e5(o,e,t,n,i,r){let{moves:s,excludedChanges:a}=AG(o,e,t,r);if(!r.isValid())return[];let l=o.filter(c=>!a.has(c)),d=PG(l,n,i,e,t,r);return Mg(s,d),s=FG(s),s=s.filter(c=>{let u=c.original.toOffsetRange().slice(e).map(h=>h.trim());return u.join(`
`).length>=15&&NG(u,h=>h.length>=2)>=2}),s=BG(o,s),s}function NG(o,e){let t=0;for(let n of o)e(n)&&t++;return t}function AG(o,e,t,n){let i=[],r=o.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new Dv(l.original,e,l)),s=new Set(o.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new Dv(l.modified,t,l))),a=new Set;for(let l of r){let d=-1,c;for(let u of s){let p=l.computeSimilarity(u);p>d&&(d=p,c=u)}if(d>.9&&c&&(s.delete(c),i.push(new Yi(l.range,c.range)),a.add(l.source),a.add(c.source)),!n.isValid())return{moves:i,excludedChanges:a}}return{moves:i,excludedChanges:a}}function PG(o,e,t,n,i,r){let s=[],a=new Dc;for(let p of o)for(let h=p.original.startLineNumber;h<p.original.endLineNumberExclusive-2;h++){let f=`${e[h-1]}:${e[h+1-1]}:${e[h+2-1]}`;a.add(f,{range:new De(h,h+3)})}let l=[];o.sort(mo(p=>p.modified.startLineNumber,da));for(let p of o){let h=[];for(let f=p.modified.startLineNumber;f<p.modified.endLineNumberExclusive-2;f++){let g=`${t[f-1]}:${t[f+1-1]}:${t[f+2-1]}`,b=new De(f,f+3),v=[];a.forEach(g,({range:I})=>{for(let S of h)if(S.originalLineRange.endLineNumberExclusive+1===I.endLineNumberExclusive&&S.modifiedLineRange.endLineNumberExclusive+1===b.endLineNumberExclusive){S.originalLineRange=new De(S.originalLineRange.startLineNumber,I.endLineNumberExclusive),S.modifiedLineRange=new De(S.modifiedLineRange.startLineNumber,b.endLineNumberExclusive),v.push(S);return}let T={modifiedLineRange:b,originalLineRange:I};l.push(T),v.push(T)}),h=v}if(!r.isValid())return[]}l.sort(tA(mo(p=>p.modifiedLineRange.length,da)));let d=new Rr,c=new Rr;for(let p of l){let h=p.modifiedLineRange.startLineNumber-p.originalLineRange.startLineNumber,f=d.subtractFrom(p.modifiedLineRange),g=c.subtractFrom(p.originalLineRange).getWithDelta(h),b=f.getIntersection(g);for(let v of b.ranges){if(v.length<3)continue;let I=v,T=v.delta(-h);s.push(new Yi(T,I)),d.addRange(I),c.addRange(T)}}s.sort(mo(p=>p.original.startLineNumber,da));let u=new Dg(o);for(let p=0;p<s.length;p++){let h=s[p],f=u.findLastMonotonous(w=>w.original.startLineNumber<=h.original.startLineNumber),g=al(o,w=>w.modified.startLineNumber<=h.modified.startLineNumber),b=Math.max(h.original.startLineNumber-f.original.startLineNumber,h.modified.startLineNumber-g.modified.startLineNumber),v=u.findLastMonotonous(w=>w.original.startLineNumber<h.original.endLineNumberExclusive),I=al(o,w=>w.modified.startLineNumber<h.modified.endLineNumberExclusive),T=Math.max(v.original.endLineNumberExclusive-h.original.endLineNumberExclusive,I.modified.endLineNumberExclusive-h.modified.endLineNumberExclusive),S;for(S=0;S<b;S++){let w=h.original.startLineNumber-S-1,x=h.modified.startLineNumber-S-1;if(w>n.length||x>i.length||d.contains(x)||c.contains(w)||!JU(n[w-1],i[x-1],r))break}S>0&&(c.addRange(new De(h.original.startLineNumber-S,h.original.startLineNumber)),d.addRange(new De(h.modified.startLineNumber-S,h.modified.startLineNumber)));let C;for(C=0;C<T;C++){let w=h.original.endLineNumberExclusive+C,x=h.modified.endLineNumberExclusive+C;if(w>n.length||x>i.length||d.contains(x)||c.contains(w)||!JU(n[w-1],i[x-1],r))break}C>0&&(c.addRange(new De(h.original.endLineNumberExclusive,h.original.endLineNumberExclusive+C)),d.addRange(new De(h.modified.endLineNumberExclusive,h.modified.endLineNumberExclusive+C))),(S>0||C>0)&&(s[p]=new Yi(new De(h.original.startLineNumber-S,h.original.endLineNumberExclusive+C),new De(h.modified.startLineNumber-S,h.modified.endLineNumberExclusive+C)))}return s}function JU(o,e,t){if(o.trim()===e.trim())return!0;if(o.length>300&&e.length>300)return!1;let i=new tg().compute(new vc([o],new M(1,1,1,o.length),!1),new vc([e],new M(1,1,1,e.length),!1),t),r=0,s=In.invert(i.diffs,o.length);for(let c of s)c.seq1Range.forEach(u=>{kv(o.charCodeAt(u))||r++});function a(c){let u=0;for(let p=0;p<o.length;p++)kv(c.charCodeAt(p))||u++;return u}let l=a(o.length>e.length?o:e);return r/l>.6&&l>10}function FG(o){if(o.length===0)return o;o.sort(mo(t=>t.original.startLineNumber,da));let e=[o[0]];for(let t=1;t<o.length;t++){let n=e[e.length-1],i=o[t],r=i.original.startLineNumber-n.original.endLineNumberExclusive,s=i.modified.startLineNumber-n.modified.endLineNumberExclusive;if(r>=0&&s>=0&&r+s<=2){e[e.length-1]=n.join(i);continue}e.push(i)}return e}function BG(o,e){let t=new Dg(o);return e=e.filter(n=>{let i=t.findLastMonotonous(a=>a.original.startLineNumber<n.original.endLineNumberExclusive)||new Yi(new De(1,1),new De(1,1)),r=al(o,a=>a.modified.startLineNumber<n.modified.endLineNumberExclusive);return i!==r}),e}var Rv=class{constructor(e,t){this.trimmedHash=e;this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){let t=e===0?0:t5(this.lines[e-1]),n=e===this.lines.length?0:t5(this.lines[e]);return 1e3-(t+n)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}};function t5(o){let e=0;for(;e<o.length&&(o.charCodeAt(e)===32||o.charCodeAt(e)===9);)e++;return e}function Mv(o,e,t){let n=t;return n=n5(o,e,n),n=n5(o,e,n),n=WG(o,e,n),n}function n5(o,e,t){if(t.length===0)return t;let n=[];n.push(t[0]);for(let r=1;r<t.length;r++){let s=n[n.length-1],a=t[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=a.seq1Range.start-s.seq1Range.endExclusive,d;for(d=1;d<=l&&!(o.getElement(a.seq1Range.start-d)!==o.getElement(a.seq1Range.endExclusive-d)||e.getElement(a.seq2Range.start-d)!==e.getElement(a.seq2Range.endExclusive-d));d++);if(d--,d===l){n[n.length-1]=new In(new ke(s.seq1Range.start,a.seq1Range.endExclusive-l),new ke(s.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-d)}n.push(a)}let i=[];for(let r=0;r<n.length-1;r++){let s=n[r+1],a=n[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=s.seq1Range.start-a.seq1Range.endExclusive,d;for(d=0;d<l&&!(!o.isStronglyEqual(a.seq1Range.start+d,a.seq1Range.endExclusive+d)||!e.isStronglyEqual(a.seq2Range.start+d,a.seq2Range.endExclusive+d));d++);if(d===l){n[r+1]=new In(new ke(a.seq1Range.start+l,s.seq1Range.endExclusive),new ke(a.seq2Range.start+l,s.seq2Range.endExclusive));continue}d>0&&(a=a.delta(d))}i.push(a)}return n.length>0&&i.push(n[n.length-1]),i}function WG(o,e,t){if(!o.getBoundaryScore||!e.getBoundaryScore)return t;for(let n=0;n<t.length;n++){let i=n>0?t[n-1]:void 0,r=t[n],s=n+1<t.length?t[n+1]:void 0,a=new ke(i?i.seq1Range.endExclusive+1:0,s?s.seq1Range.start-1:o.length),l=new ke(i?i.seq2Range.endExclusive+1:0,s?s.seq2Range.start-1:e.length);r.seq1Range.isEmpty?t[n]=i5(r,o,e,a,l):r.seq2Range.isEmpty&&(t[n]=i5(r.swap(),e,o,l,a).swap())}return t}function i5(o,e,t,n,i){let s=1;for(;o.seq1Range.start-s>=n.start&&o.seq2Range.start-s>=i.start&&t.isStronglyEqual(o.seq2Range.start-s,o.seq2Range.endExclusive-s)&&s<100;)s++;s--;let a=0;for(;o.seq1Range.start+a<n.endExclusive&&o.seq2Range.endExclusive+a<i.endExclusive&&t.isStronglyEqual(o.seq2Range.start+a,o.seq2Range.endExclusive+a)&&a<100;)a++;if(s===0&&a===0)return o;let l=0,d=-1;for(let c=-s;c<=a;c++){let u=o.seq2Range.start+c,p=o.seq2Range.endExclusive+c,h=o.seq1Range.start+c,f=e.getBoundaryScore(h)+t.getBoundaryScore(u)+t.getBoundaryScore(p);f>d&&(d=f,l=c)}return o.delta(l)}function o5(o,e,t){let n=[];for(let i of t){let r=n[n.length-1];if(!r){n.push(i);continue}i.seq1Range.start-r.seq1Range.endExclusive<=2||i.seq2Range.start-r.seq2Range.endExclusive<=2?n[n.length-1]=new In(r.seq1Range.join(i.seq1Range),r.seq2Range.join(i.seq2Range)):n.push(i)}return n}function r5(o,e,t){let n=In.invert(t,o.length),i=[],r=new Xa(0,0);function s(l,d){if(l.offset1<r.offset1||l.offset2<r.offset2)return;let c=o.findWordContaining(l.offset1),u=e.findWordContaining(l.offset2);if(!c||!u)return;let p=new In(c,u),h=p.intersect(d),f=h.seq1Range.length,g=h.seq2Range.length;for(;n.length>0;){let b=n[0];if(!(b.seq1Range.intersects(p.seq1Range)||b.seq2Range.intersects(p.seq2Range)))break;let I=o.findWordContaining(b.seq1Range.start),T=e.findWordContaining(b.seq2Range.start),S=new In(I,T),C=S.intersect(b);if(f+=C.seq1Range.length,g+=C.seq2Range.length,p=p.join(S),p.seq1Range.endExclusive>=b.seq1Range.endExclusive)n.shift();else break}f+g<(p.seq1Range.length+p.seq2Range.length)*2/3&&i.push(p),r=p.getEndExclusives()}for(;n.length>0;){let l=n.shift();l.seq1Range.isEmpty||(s(l.getStarts(),l),s(l.getEndExclusives().delta(-1),l))}return VG(t,i)}function VG(o,e){let t=[];for(;o.length>0||e.length>0;){let n=o[0],i=e[0],r;n&&(!i||n.seq1Range.start<i.seq1Range.start)?r=o.shift():r=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=r.seq1Range.start?t[t.length-1]=t[t.length-1].join(r):t.push(r)}return t}function s5(o,e,t){let n=t;if(n.length===0)return n;let i=0,r;do{r=!1;let a=[n[0]];for(let l=1;l<n.length;l++){let u=function(h,f){let g=new ke(c.seq1Range.endExclusive,d.seq1Range.start);return o.getText(g).replace(/\s/g,"").length<=4&&(h.seq1Range.length+h.seq2Range.length>5||f.seq1Range.length+f.seq2Range.length>5)};var s=u;let d=n[l],c=a[a.length-1];u(c,d)?(r=!0,a[a.length-1]=a[a.length-1].join(d)):a.push(d)}n=a}while(i++<10&&r);return n}function a5(o,e,t){let n=t;if(n.length===0)return n;let i=0,r;do{r=!1;let l=[n[0]];for(let d=1;d<n.length;d++){let p=function(f,g){let b=new ke(u.seq1Range.endExclusive,c.seq1Range.start);if(o.countLinesIn(b)>5||b.length>500)return!1;let I=o.getText(b).trim();if(I.length>20||I.split(/\r\n|\r|\n/).length>1)return!1;let T=o.countLinesIn(f.seq1Range),S=f.seq1Range.length,C=e.countLinesIn(f.seq2Range),w=f.seq2Range.length,x=o.countLinesIn(g.seq1Range),D=g.seq1Range.length,O=e.countLinesIn(g.seq2Range),H=g.seq2Range.length,K=2*40+50;function z(ie){return Math.min(ie,K)}return Math.pow(Math.pow(z(T*40+S),1.5)+Math.pow(z(C*40+w),1.5),1.5)+Math.pow(Math.pow(z(x*40+D),1.5)+Math.pow(z(O*40+H),1.5),1.5)>(K**1.5)**1.5*1.3};var a=p;let c=n[d],u=l[l.length-1];p(u,c)?(r=!0,l[l.length-1]=l[l.length-1].join(c)):l.push(c)}n=l}while(i++<10&&r);let s=[];return QN(n,(l,d,c)=>{let u=d;function p(I){return I.length>0&&I.trim().length<=3&&d.seq1Range.length+d.seq2Range.length>100}let h=o.extendToFullLines(d.seq1Range),f=o.getText(new ke(h.start,d.seq1Range.start));p(f)&&(u=u.deltaStart(-f.length));let g=o.getText(new ke(d.seq1Range.endExclusive,h.endExclusive));p(g)&&(u=u.deltaEnd(g.length));let b=In.fromOffsetPairs(l?l.getEndExclusives():Xa.zero,c?c.getStarts():Xa.max),v=u.intersect(b);s.length>0&&v.getStarts().equals(s[s.length-1].getEndExclusives())?s[s.length-1]=s[s.length-1].join(v):s.push(v)}),s}var jx=class{dynamicProgrammingDiffing=new Kx;myersDiffingAlgorithm=new tg;computeDiff(e,t,n){if(e.length<=1&&Ut(e,t,(C,w)=>C===w))return new Tu([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new Tu([new mr(new De(1,e.length+1),new De(1,t.length+1),[new so(new M(1,1,e.length,e[e.length-1].length+1),new M(1,1,t.length,t[t.length-1].length+1))])],[],!1);let i=n.maxComputationTimeMs===0?bc.instance:new zx(n.maxComputationTimeMs),r=!n.ignoreTrimWhitespace,s=new Map;function a(C){let w=s.get(C);return w===void 0&&(w=s.size,s.set(C,w)),w}let l=e.map(C=>a(C.trim())),d=t.map(C=>a(C.trim())),c=new Rv(l,e),u=new Rv(d,t),p=c.length+u.length<1700?this.dynamicProgrammingDiffing.compute(c,u,i,(C,w)=>e[C]===t[w]?t[w].length===0?.1:1+Math.log(1+t[w].length):.99):this.myersDiffingAlgorithm.compute(c,u,i),h=p.diffs,f=p.hitTimeout;h=Mv(c,u,h),h=s5(c,u,h);let g=[],b=C=>{if(r)for(let w=0;w<C;w++){let x=v+w,D=I+w;if(e[x]!==t[D]){let O=this.refineDiff(e,t,new In(new ke(x,x+1),new ke(D,D+1)),i,r);for(let H of O.mappings)g.push(H);O.hitTimeout&&(f=!0)}}},v=0,I=0;for(let C of h){ys(()=>C.seq1Range.start-v===C.seq2Range.start-I);let w=C.seq1Range.start-v;b(w),v=C.seq1Range.endExclusive,I=C.seq2Range.endExclusive;let x=this.refineDiff(e,t,C,i,r);x.hitTimeout&&(f=!0);for(let D of x.mappings)g.push(D)}b(e.length-v);let T=l5(g,e,t),S=[];return n.computeMoves&&(S=this.computeMoves(T,e,t,l,d,i,r)),ys(()=>{function C(x,D){if(x.lineNumber<1||x.lineNumber>D.length)return!1;let O=D[x.lineNumber-1];return!(x.column<1||x.column>O.length+1)}function w(x,D){return!(x.startLineNumber<1||x.startLineNumber>D.length+1||x.endLineNumberExclusive<1||x.endLineNumberExclusive>D.length+1)}for(let x of T){if(!x.innerChanges)return!1;for(let D of x.innerChanges)if(!(C(D.modifiedRange.getStartPosition(),t)&&C(D.modifiedRange.getEndPosition(),t)&&C(D.originalRange.getStartPosition(),e)&&C(D.originalRange.getEndPosition(),e)))return!1;if(!w(x.modified,t)||!w(x.original,e))return!1}return!0}),new Tu(T,S,f)}computeMoves(e,t,n,i,r,s,a){return e5(e,t,n,i,r,s).map(c=>{let u=this.refineDiff(t,n,new In(c.original.toOffsetRange(),c.modified.toOffsetRange()),s,a),p=l5(u.mappings,t,n,!0);return new AS(c,p)})}refineDiff(e,t,n,i,r){let a=UG(n).toRangeMapping2(e,t),l=new vc(e,a.originalRange,r),d=new vc(t,a.modifiedRange,r),c=l.length+d.length<500?this.dynamicProgrammingDiffing.compute(l,d,i):this.myersDiffingAlgorithm.compute(l,d,i),u=!1,p=c.diffs;u&&In.assertSorted(p),p=Mv(l,d,p),u&&In.assertSorted(p),p=r5(l,d,p),u&&In.assertSorted(p),p=o5(l,d,p),u&&In.assertSorted(p),p=a5(l,d,p),u&&In.assertSorted(p);let h=p.map(f=>new so(l.translateRange(f.seq1Range),d.translateRange(f.seq2Range)));return u&&so.assertSorted(h),{mappings:h,hitTimeout:c.hitTimeout}}};function l5(o,e,t,n=!1){let i=[];for(let r of vp(o.map(s=>HG(s,e,t)),(s,a)=>s.original.overlapOrTouch(a.original)||s.modified.overlapOrTouch(a.modified))){let s=r[0],a=r[r.length-1];i.push(new mr(s.original.join(a.original),s.modified.join(a.modified),r.map(l=>l.innerChanges[0])))}return ys(()=>!n&&i.length>0&&(i[0].modified.startLineNumber!==i[0].original.startLineNumber||t.length-i[i.length-1].modified.endLineNumberExclusive!==e.length-i[i.length-1].original.endLineNumberExclusive)?!1:Ag(i,(r,s)=>s.original.startLineNumber-r.original.endLineNumberExclusive===s.modified.startLineNumber-r.modified.endLineNumberExclusive&&r.original.endLineNumberExclusive<s.original.startLineNumber&&r.modified.endLineNumberExclusive<s.modified.startLineNumber)),i}function HG(o,e,t){let n=0,i=0;o.modifiedRange.endColumn===1&&o.originalRange.endColumn===1&&o.originalRange.startLineNumber+n<=o.originalRange.endLineNumber&&o.modifiedRange.startLineNumber+n<=o.modifiedRange.endLineNumber&&(i=-1),o.modifiedRange.startColumn-1>=t[o.modifiedRange.startLineNumber-1].length&&o.originalRange.startColumn-1>=e[o.originalRange.startLineNumber-1].length&&o.originalRange.startLineNumber<=o.originalRange.endLineNumber+i&&o.modifiedRange.startLineNumber<=o.modifiedRange.endLineNumber+i&&(n=1);let r=new De(o.originalRange.startLineNumber+n,o.originalRange.endLineNumber+1+i),s=new De(o.modifiedRange.startLineNumber+n,o.modifiedRange.endLineNumber+1+i);return new mr(r,s,[o])}function UG(o){return new Yi(new De(o.seq1Range.start+1,o.seq1Range.endExclusive+1),new De(o.seq2Range.start+1,o.seq2Range.endExclusive+1))}var SJt=E("diffEditor.move.border","#8b8b8b9c",m("diffEditor.move.border","The border color for text that got moved in the diff editor.")),EJt=E("diffEditor.moveActive.border","#FFA500",m("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor.")),TJt=E("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},m("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets.")),zG=Or("diff-insert",ae.add,m("diffInsertIcon","Line decoration for inserts in the diff editor.")),qO=Or("diff-remove",ae.remove,m("diffRemoveIcon","Line decoration for removals in the diff editor.")),$O=yn.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+Be.asClassName(zG),marginClassName:"gutter-insert"}),YO=yn.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+Be.asClassName(qO),marginClassName:"gutter-delete"}),ZO=yn.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),QO=yn.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),XO=yn.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),d5=yn.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),c5=yn.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),Ov=yn.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),u5=yn.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),p5=yn.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var qx=class extends F{constructor(t,n,i,r,s,a,l,d,c){super();this._getViewZoneId=t;this._marginDomNode=n;this._modifiedEditor=i;this._diff=r;this._editor=s;this._viewLineCounts=a;this._originalTextModel=l;this._contextMenuService=d;this._clipboardService=c;this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Be.asClassName(ae.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";let u=this._modifiedEditor.getOption(68);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${u}px`,this._diffActions.style.lineHeight=`${u}px`,this._marginDomNode.appendChild(this._diffActions);let p=0,h=i.getOption(129)&&!qr,f=(g,b)=>{this._contextMenuService.showContextMenu({domForShadowRoot:h?i.getDomNode()??void 0:void 0,getAnchor:()=>({x:g,y:b}),getActions:()=>{let v=[],I=r.modified.isEmpty;return v.push(new ai("diff.clipboard.copyDeletedContent",I?r.original.length>1?m("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):m("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):r.original.length>1?m("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):m("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{let S=this._originalTextModel.getValueInRange(r.original.toExclusiveRange());await this._clipboardService.writeText(S)})),r.original.length>1&&v.push(new ai("diff.clipboard.copyDeletedLineContent",I?m("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",r.original.startLineNumber+p):m("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",r.original.startLineNumber+p),void 0,!0,async()=>{let S=this._originalTextModel.getLineContent(r.original.startLineNumber+p);S===""&&(S=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(S)})),i.getOption(93)||v.push(new ai("diff.inline.revertChange",m("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),v},autoSelectFirstItem:!0})};this._register(hn(this._diffActions,"mousedown",g=>{if(!g.leftButton)return;let{top:b,height:v}=ro(this._diffActions),I=Math.floor(u/3);g.preventDefault(),f(g.posx,b+v+I)})),this._register(i.onMouseMove(g=>{(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()?(p=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,u),this.visibility=!0):this.visibility=!1})),this._register(i.onMouseDown(g=>{g.event.leftButton&&(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()&&(g.event.preventDefault(),p=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,u),f(g.event.posx,g.event.posy+u))}))}_diffActions;_visibility=!1;get visibility(){return this._visibility}set visibility(t){this._visibility!==t&&(this._visibility=t,this._diffActions.style.visibility=t?"visible":"hidden")}_updateLightBulbPosition(t,n,i){let{top:r}=ro(t),s=n-r,a=Math.floor(s/i),l=a*i;if(this._diffActions.style.top=`${l}px`,this._viewLineCounts){let d=0;for(let c=0;c<this._viewLineCounts.length;c++)if(d+=this._viewLineCounts[c],a<d)return c}return a}};var h5=hc("diffEditorWidget",{createHTML:o=>o});function g5(o,e,t,n){tn(n,e.fontInfo);let i=t.length>0,r=new va(1e4),s=0,a=0,l=[];for(let p=0;p<o.lineTokens.length;p++){let h=p+1,f=o.lineTokens[p],g=o.lineBreakData[p],b=cs.filter(t,h,1,Number.MAX_SAFE_INTEGER);if(g){let v=0;for(let I of g.breakOffsets){let T=f.sliceAndInflate(v,I,0);s=Math.max(s,m5(a,T,cs.extractWrapped(b,v,I),i,o.mightContainNonBasicASCII,o.mightContainRTL,e,r)),a++,v=I}l.push(g.breakOffsets.length)}else l.push(1),s=Math.max(s,m5(a,f,b,i,o.mightContainNonBasicASCII,o.mightContainRTL,e,r)),a++}s+=e.scrollBeyondLastColumn;let d=r.build(),c=h5?h5.createHTML(d):d;n.innerHTML=c;let u=s*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:u,viewLineCounts:l}}var $x=class{constructor(e,t,n,i){this.lineTokens=e;this.lineBreakData=t;this.mightContainNonBasicASCII=n;this.mightContainRTL=i}},Yx=class o{constructor(e,t,n,i,r,s,a,l,d,c,u){this.tabSize=e;this.fontInfo=t;this.disableMonospaceOptimizations=n;this.typicalHalfwidthCharacterWidth=i;this.scrollBeyondLastColumn=r;this.lineHeight=s;this.lineDecorationsWidth=a;this.stopRenderingLineAfter=l;this.renderWhitespace=d;this.renderControlCharacters=c;this.fontLigatures=u}static fromEditor(e){let t=e.getOptions(),n=t.get(51),i=t.get(147);return new o(e.getModel()?.getOptions().tabSize||0,n,t.get(33),n.typicalHalfwidthCharacterWidth,t.get(106),t.get(68),i.decorationsWidth,t.get(119),t.get(101),t.get(96),t.get(52))}};function m5(o,e,t,n,i,r,s,a){a.appendString('<div class="view-line'),n||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(o*s.lineHeight)),a.appendString('px;width:1000000px;">');let l=e.getLineContent(),d=Fa.isBasicASCII(l,i),c=Fa.containsRTL(l,d,r),u=cv(new mc(s.fontInfo.isMonospace&&!s.disableMonospaceOptimizations,s.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,d,c,0,e,t,s.tabSize,0,s.fontInfo.spaceWidth,s.fontInfo.middotWidth,s.fontInfo.wsmiddotWidth,s.stopRenderingLineAfter,s.renderWhitespace,s.renderControlCharacters,s.fontLigatures!==ws.OFF,null),a);return a.appendString("</div>"),u.characterMapping.getHorizontalOffset(u.characterMapping.length)}var ng=class extends F{constructor(t,n,i,r,s,a,l,d,c,u){super();this._targetWindow=t;this._editors=n;this._diffModel=i;this._options=r;this._diffEditorWidget=s;this._canIgnoreViewZoneUpdateEvent=a;this._origViewZonesToIgnore=l;this._modViewZonesToIgnore=d;this._clipboardService=c;this._contextMenuService=u;let p=st("invalidateAlignmentsState",0),h=this._register(new ln(()=>{p.set(p.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(S=>{this._canIgnoreViewZoneUpdateEvent()||h.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(S=>{this._canIgnoreViewZoneUpdateEvent()||h.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(S=>{(S.hasChanged(148)||S.hasChanged(68))&&h.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(S=>{(S.hasChanged(148)||S.hasChanged(68))&&h.schedule()}));let f=this._diffModel.map(S=>S?Dt(this,S.model.original.onDidChangeTokens,()=>S.model.original.tokenization.backgroundTokenizationState===2):void 0).map((S,C)=>S?.read(C)),g=Me(S=>{let C=this._diffModel.read(S),w=C?.diff.read(S);if(!C||!w)return null;p.read(S);let D=this._options.renderSideBySide.read(S);return f5(this._editors.original,this._editors.modified,w.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,D)}),b=Me(S=>{let C=this._diffModel.read(S)?.movedTextToCompare.read(S);if(!C)return null;p.read(S);let w=C.changes.map(x=>new Av(x));return f5(this._editors.original,this._editors.modified,w,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function v(){let S=document.createElement("div");return S.className="diagonal-fill",S}let I=this._register(new ne);this.viewZones=hl(this,(S,C)=>{I.clear();let w=g.read(S)||[],x=[],D=[],O=this._modifiedTopPadding.read(S);O>0&&D.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:O,showInHiddenAreas:!0,suppressMouseDown:!0});let H=this._originalTopPadding.read(S);H>0&&x.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:H,showInHiddenAreas:!0,suppressMouseDown:!0});let K=this._options.renderSideBySide.read(S),z=K?void 0:this._editors.modified._getViewModel()?.createLineBreaksComputer();if(z){let ce=this._editors.original.getModel();for(let Ze of w)if(Ze.diff)for(let Ue=Ze.originalRange.startLineNumber;Ue<Ze.originalRange.endLineNumberExclusive;Ue++){if(Ue>ce.getLineCount())return{orig:x,mod:D};z?.addRequest(ce.getLineContent(Ue),null,null)}}let ie=z?.finalize()??[],Se=0,J=this._editors.modified.getOption(68),X=this._diffModel.read(S)?.movedTextToCompare.read(S),le=this._editors.original.getModel()?.mightContainNonBasicASCII()??!1,re=this._editors.original.getModel()?.mightContainRTL()??!1,ee=Yx.fromEditor(this._editors.modified);for(let ce of w)if(ce.diff&&!K&&(!this._options.useTrueInlineDiffRendering.read(S)||!Nv(ce.diff))){if(!ce.originalRange.isEmpty){f.read(S);let Ue=document.createElement("div");Ue.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");let _e=this._editors.original.getModel();if(ce.originalRange.endLineNumberExclusive-1>_e.getLineCount())return{orig:x,mod:D};let mn=new $x(ce.originalRange.mapToLineArray(At=>_e.tokenization.getLineTokens(At)),ce.originalRange.mapToLineArray(At=>ie[Se++]),le,re),an=[];for(let At of ce.diff.innerChanges||[])an.push(new Fl(At.originalRange.delta(-(ce.diff.original.startLineNumber-1)),Ov.className,0));let Pn=g5(mn,ee,an,Ue),oi=document.createElement("div");if(oi.className="inline-deleted-margin-view-zone",tn(oi,ee.fontInfo),this._options.renderIndicators.read(S))for(let At=0;At<Pn.heightInLines;At++){let Ni=document.createElement("div");Ni.className=`delete-sign ${Be.asClassName(qO)}`,Ni.setAttribute("style",`position:absolute;top:${At*J}px;width:${ee.lineDecorationsWidth}px;height:${J}px;right:0;`),oi.appendChild(Ni)}let hs;I.add(new qx(()=>pn(hs),oi,this._editors.modified,ce.diff,this._diffEditorWidget,Pn.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let At=0;At<Pn.viewLineCounts.length;At++){let Ni=Pn.viewLineCounts[At];Ni>1&&x.push({afterLineNumber:ce.originalRange.startLineNumber+At,domNode:v(),heightInPx:(Ni-1)*J,showInHiddenAreas:!0,suppressMouseDown:!0})}D.push({afterLineNumber:ce.modifiedRange.startLineNumber-1,domNode:Ue,heightInPx:Pn.heightInLines*J,minWidthInPx:Pn.minWidthInPx,marginDomNode:oi,setZoneId(At){hs=At},showInHiddenAreas:!0,suppressMouseDown:!0})}let Ze=document.createElement("div");Ze.className="gutter-delete",x.push({afterLineNumber:ce.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:ce.modifiedHeightInPx,marginDomNode:Ze,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Ze=ce.modifiedHeightInPx-ce.originalHeightInPx;if(Ze>0){if(X?.lineRangeMapping.original.delta(-1).deltaLength(2).contains(ce.originalRange.endLineNumberExclusive-1))continue;x.push({afterLineNumber:ce.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:Ze,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Ue=function(){let mn=document.createElement("div");return mn.className="arrow-revert-change "+Be.asClassName(ae.arrowRight),C.add(q(mn,"mousedown",an=>an.stopPropagation())),C.add(q(mn,"click",an=>{an.stopPropagation(),s.revert(ce.diff)})),Ke("div",{},mn)};var Te=Ue;if(X?.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(ce.modifiedRange.endLineNumberExclusive-1))continue;let _e;ce.diff&&ce.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(S)&&(_e=Ue()),D.push({afterLineNumber:ce.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-Ze,marginDomNode:_e,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(let ce of b.read(S)??[]){if(!X?.lineRangeMapping.original.intersect(ce.originalRange)||!X?.lineRangeMapping.modified.intersect(ce.modifiedRange))continue;let Ze=ce.modifiedHeightInPx-ce.originalHeightInPx;Ze>0?x.push({afterLineNumber:ce.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:Ze,showInHiddenAreas:!0,suppressMouseDown:!0}):D.push({afterLineNumber:ce.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-Ze,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:x,mod:D}});let T=!1;this._register(this._editors.original.onDidScrollChange(S=>{S.scrollLeftChanged&&!T&&(T=!0,this._editors.modified.setScrollLeft(S.scrollLeft),T=!1)})),this._register(this._editors.modified.onDidScrollChange(S=>{S.scrollLeftChanged&&!T&&(T=!0,this._editors.original.setScrollLeft(S.scrollLeft),T=!1)})),this._originalScrollTop=Dt(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=Dt(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(ot(S=>{let C=this._originalScrollTop.read(S)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(S))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(S));C!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(C,1)})),this._register(ot(S=>{let C=this._modifiedScrollTop.read(S)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(S))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(S));C!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(C,1)})),this._register(ot(S=>{let C=this._diffModel.read(S)?.movedTextToCompare.read(S),w=0;if(C){let x=this._editors.original.getTopForLineNumber(C.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();w=this._editors.modified.getTopForLineNumber(C.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-x}w>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(w,void 0)):w<0?(this._modifiedTopPadding.set(-w,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-w,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+w,void 0,!0)}))}_originalTopPadding=st(this,0);_originalScrollTop;_originalScrollOffset=st(this,0);_originalScrollOffsetAnimated=BO(this._targetWindow,this._originalScrollOffset,this._store);_modifiedTopPadding=st(this,0);_modifiedScrollTop;_modifiedScrollOffset=st(this,0);_modifiedScrollOffsetAnimated=BO(this._targetWindow,this._modifiedScrollOffset,this._store);viewZones};ng=P([_(8,tx),_(9,Hl)],ng);function f5(o,e,t,n,i,r){let s=new Wi(b5(o,n)),a=new Wi(b5(e,i)),l=o.getOption(68),d=e.getOption(68),c=[],u=0,p=0;function h(g,b){for(;;){let v=s.peek(),I=a.peek();if(v&&v.lineNumber>=g&&(v=void 0),I&&I.lineNumber>=b&&(I=void 0),!v&&!I)break;let T=v?v.lineNumber-u:Number.MAX_VALUE,S=I?I.lineNumber-p:Number.MAX_VALUE;T<S?(s.dequeue(),I={lineNumber:v.lineNumber-u+p,heightInPx:0}):T>S?(a.dequeue(),v={lineNumber:I.lineNumber-p+u,heightInPx:0}):(s.dequeue(),a.dequeue()),c.push({originalRange:De.ofLength(v.lineNumber,1),modifiedRange:De.ofLength(I.lineNumber,1),originalHeightInPx:l+v.heightInPx,modifiedHeightInPx:d+I.heightInPx,diff:void 0})}}for(let g of t){let S=function(C,w,x=!1){if(C<T||w<I)return;if(v)v=!1;else if(!x&&(C===T||w===I))return;let D=new De(T,C),O=new De(I,w);if(D.isEmpty&&O.isEmpty)return;let H=s.takeWhile(z=>z.lineNumber<C)?.reduce((z,ie)=>z+ie.heightInPx,0)??0,K=a.takeWhile(z=>z.lineNumber<w)?.reduce((z,ie)=>z+ie.heightInPx,0)??0;c.push({originalRange:D,modifiedRange:O,originalHeightInPx:D.length*l+H,modifiedHeightInPx:O.length*d+K,diff:g.lineRangeMapping}),T=C,I=w};var f=S;let b=g.lineRangeMapping;h(b.original.startLineNumber,b.modified.startLineNumber);let v=!0,I=b.modified.startLineNumber,T=b.original.startLineNumber;if(r)for(let C of b.innerChanges||[]){C.originalRange.startColumn>1&&C.modifiedRange.startColumn>1&&S(C.originalRange.startLineNumber,C.modifiedRange.startLineNumber);let w=o.getModel(),x=C.originalRange.endLineNumber<=w.getLineCount()?w.getLineMaxColumn(C.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;C.originalRange.endColumn<x&&S(C.originalRange.endLineNumber,C.modifiedRange.endLineNumber)}S(b.original.endLineNumberExclusive,b.modified.endLineNumberExclusive,!0),u=b.original.endLineNumberExclusive,p=b.modified.endLineNumberExclusive}return h(Number.MAX_VALUE,Number.MAX_VALUE),c}function b5(o,e){let t=[],n=[],i=o.getOption(148).wrappingColumn!==-1,r=o._getViewModel().coordinatesConverter,s=o.getOption(68);if(i)for(let l=1;l<=o.getModel().getLineCount();l++){let d=r.getModelLineViewLineCount(l);d>1&&n.push({lineNumber:l,heightInPx:s*(d-1)})}for(let l of o.getWhitespaces()){if(e.has(l.id))continue;let d=l.afterLineNumber===0?0:r.convertViewPositionToModelPosition(new A(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:d,heightInPx:l.height})}return GU(t,n,l=>l.lineNumber,(l,d)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+d.heightInPx}))}function Nv(o){return o.innerChanges?o.innerChanges.every(e=>v5(e.modifiedRange)&&v5(e.originalRange)||e.originalRange.equalsRange(new M(1,1,1,1))):!1}function v5(o){return o.startLineNumber===o.endLineNumber}var y5={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1};var ig=class{constructor(e,t){this._accessibilityService=t;let n={...e,...I5(e,y5)};this._options=st(this,n)}_options;get editorOptions(){return this._options}_diffEditorWidth=st(this,0);_screenReaderMode=Dt(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized());couldShowInlineViewBecauseOfSize=Me(this,e=>this._options.read(e).renderSideBySide&&this._diffEditorWidth.read(e)<=this._options.read(e).renderSideBySideInlineBreakpoint);renderOverviewRuler=Me(this,e=>this._options.read(e).renderOverviewRuler);renderSideBySide=Me(this,e=>this.compactMode.read(e)&&this.shouldRenderInlineViewInSmartMode.read(e)?!1:this._options.read(e).renderSideBySide&&!(this._options.read(e).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(e)&&!this._screenReaderMode.read(e)));readOnly=Me(this,e=>this._options.read(e).readOnly);shouldRenderOldRevertArrows=Me(this,e=>!(!this._options.read(e).renderMarginRevertIcon||!this.renderSideBySide.read(e)||this.readOnly.read(e)||this.shouldRenderGutterMenu.read(e)));shouldRenderGutterMenu=Me(this,e=>this._options.read(e).renderGutterMenu);renderIndicators=Me(this,e=>this._options.read(e).renderIndicators);enableSplitViewResizing=Me(this,e=>this._options.read(e).enableSplitViewResizing);splitViewDefaultRatio=Me(this,e=>this._options.read(e).splitViewDefaultRatio);ignoreTrimWhitespace=Me(this,e=>this._options.read(e).ignoreTrimWhitespace);maxComputationTimeMs=Me(this,e=>this._options.read(e).maxComputationTime);showMoves=Me(this,e=>this._options.read(e).experimental.showMoves&&this.renderSideBySide.read(e));isInEmbeddedEditor=Me(this,e=>this._options.read(e).isInEmbeddedEditor);diffWordWrap=Me(this,e=>this._options.read(e).diffWordWrap);originalEditable=Me(this,e=>this._options.read(e).originalEditable);diffCodeLens=Me(this,e=>this._options.read(e).diffCodeLens);accessibilityVerbose=Me(this,e=>this._options.read(e).accessibilityVerbose);diffAlgorithm=Me(this,e=>this._options.read(e).diffAlgorithm);showEmptyDecorations=Me(this,e=>this._options.read(e).experimental.showEmptyDecorations);onlyShowAccessibleDiffViewer=Me(this,e=>this._options.read(e).onlyShowAccessibleDiffViewer);compactMode=Me(this,e=>this._options.read(e).compactMode);trueInlineDiffRenderingEnabled=Me(this,e=>this._options.read(e).experimental.useTrueInlineView);useTrueInlineDiffRendering=Me(this,e=>!this.renderSideBySide.read(e)&&this.trueInlineDiffRenderingEnabled.read(e));hideUnchangedRegions=Me(this,e=>this._options.read(e).hideUnchangedRegions.enabled);hideUnchangedRegionsRevealLineCount=Me(this,e=>this._options.read(e).hideUnchangedRegions.revealLineCount);hideUnchangedRegionsContextLineCount=Me(this,e=>this._options.read(e).hideUnchangedRegions.contextLineCount);hideUnchangedRegionsMinimumLineCount=Me(this,e=>this._options.read(e).hideUnchangedRegions.minimumLineCount);updateOptions(e){let t=I5(e,this._options.get()),n={...this._options.get(),...e,...t};this._options.set(n,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}_model=st(this,void 0);setModel(e){this._model.set(e,void 0)}shouldRenderInlineViewInSmartMode=this._model.map(this,e=>gA(this,t=>{let n=e?.diff.read(t);return n?KG(n,this.trueInlineDiffRenderingEnabled.read(t)):void 0})).flatten().map(this,e=>!!e);inlineViewHideOriginalLineNumbers=this.compactMode};ig=P([_(1,vo)],ig);function KG(o,e){return o.mappings.every(t=>GG(t.lineRangeMapping)||jG(t.lineRangeMapping)||e&&Nv(t.lineRangeMapping))}function GG(o){return o.original.length===0}function jG(o){return o.modified.length===0}function I5(o,e){return{enableSplitViewResizing:be(o.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:wP(o.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:be(o.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:be(o.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:wd(o.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:wd(o.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:be(o.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:be(o.renderIndicators,e.renderIndicators),originalEditable:be(o.originalEditable,e.originalEditable),diffCodeLens:be(o.diffCodeLens,e.diffCodeLens),renderOverviewRuler:be(o.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:Zt(o.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:Zt(o.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:be(o.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:be(o.experimental?.showMoves,e.experimental.showMoves),showEmptyDecorations:be(o.experimental?.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:be(o.experimental?.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:be(o.hideUnchangedRegions?.enabled??o.experimental?.collapseUnchangedRegions,e.hideUnchangedRegions.enabled),contextLineCount:wd(o.hideUnchangedRegions?.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:wd(o.hideUnchangedRegions?.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:wd(o.hideUnchangedRegions?.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:be(o.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:be(o.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:wd(o.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:be(o.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:be(o.renderGutterMenu,e.renderGutterMenu),compactMode:be(o.compactMode,e.compactMode)}}var og=class extends F{constructor(t,n,i){super();this.model=t;this._options=n;this._diffProviderFactoryService=i;this._register(pe(()=>this._cancellationTokenSource.cancel()));let r=Oc("contentChangedSignal"),s=this._register(new ln(()=>r.trigger(void 0),200));this._register(ot(l=>{let d=this._unchangedRegions.read(l);if(!d||d.regions.some(g=>g.isDragged.read(l)))return;let c=d.originalDecorationIds.map(g=>t.original.getDecorationRange(g)).map(g=>g?De.fromRangeInclusive(g):void 0),u=d.modifiedDecorationIds.map(g=>t.modified.getDecorationRange(g)).map(g=>g?De.fromRangeInclusive(g):void 0),p=d.regions.map((g,b)=>!c[b]||!u[b]?void 0:new rg(c[b].startLineNumber,u[b].startLineNumber,c[b].length,g.visibleLineCountTop.read(l),g.visibleLineCountBottom.read(l))).filter(gl),h=[],f=!1;for(let g of vp(p,(b,v)=>b.getHiddenModifiedRange(l).endLineNumberExclusive===v.getHiddenModifiedRange(l).startLineNumber))if(g.length>1){f=!0;let b=g.reduce((I,T)=>I+T.lineCount,0),v=new rg(g[0].originalLineNumber,g[0].modifiedLineNumber,b,g[0].visibleLineCountTop.get(),g[g.length-1].visibleLineCountBottom.get());h.push(v)}else h.push(g[0]);if(f){let g=t.original.deltaDecorations(d.originalDecorationIds,h.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=t.modified.deltaDecorations(d.modifiedDecorationIds,h.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));Yt(v=>{this._unchangedRegions.set({regions:h,originalDecorationIds:g,modifiedDecorationIds:b},v)})}}));let a=(l,d,c)=>{let u=rg.fromDiffs(l.changes,t.original.getLineCount(),t.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c)),p,h=this._unchangedRegions.get();if(h){let v=h.originalDecorationIds.map(C=>t.original.getDecorationRange(C)).map(C=>C?De.fromRangeInclusive(C):void 0),I=h.modifiedDecorationIds.map(C=>t.modified.getDecorationRange(C)).map(C=>C?De.fromRangeInclusive(C):void 0),S=qU(h.regions.map((C,w)=>{if(!v[w]||!I[w])return;let x=v[w].length;return new rg(v[w].startLineNumber,I[w].startLineNumber,x,Math.min(C.visibleLineCountTop.get(),x),Math.min(C.visibleLineCountBottom.get(),x-C.visibleLineCountTop.get()))}).filter(gl),(C,w)=>!w||C.modifiedLineNumber>=w.modifiedLineNumber+w.lineCount&&C.originalLineNumber>=w.originalLineNumber+w.lineCount).map(C=>new Yi(C.getHiddenOriginalRange(c),C.getHiddenModifiedRange(c)));S=Yi.clip(S,De.ofLength(1,t.original.getLineCount()),De.ofLength(1,t.modified.getLineCount())),p=Yi.inverse(S,t.original.getLineCount(),t.modified.getLineCount())}let f=[];if(p)for(let v of u){let I=p.filter(T=>T.original.intersectsStrict(v.originalUnchangedRange)&&T.modified.intersectsStrict(v.modifiedUnchangedRange));f.push(...v.setVisibleRanges(I,d))}else f.push(...u);let g=t.original.deltaDecorations(h?.originalDecorationIds||[],f.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=t.modified.deltaDecorations(h?.modifiedDecorationIds||[],f.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:f,originalDecorationIds:g,modifiedDecorationIds:b},d)};this._register(t.modified.onDidChangeContent(l=>{if(this._diff.get()){let c=ts.fromModelContentChanges(l.changes),u=(this._lastDiff,t.original,t.modified,void 0);u&&(this._lastDiff=u,Yt(p=>{this._diff.set(Pv.fromDiffResult(this._lastDiff),p),a(u,p);let h=this.movedTextToCompare.get();this.movedTextToCompare.set(h?this._lastDiff.moves.find(f=>f.lineRangeMapping.modified.intersect(h.lineRangeMapping.modified)):void 0,p)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(t.original.onDidChangeContent(l=>{if(this._diff.get()){let c=ts.fromModelContentChanges(l.changes),u=(this._lastDiff,t.original,t.modified,void 0);u&&(this._lastDiff=u,Yt(p=>{this._diff.set(Pv.fromDiffResult(this._lastDiff),p),a(u,p);let h=this.movedTextToCompare.get();this.movedTextToCompare.set(h?this._lastDiff.moves.find(f=>f.lineRangeMapping.modified.intersect(h.lineRangeMapping.modified)):void 0,p)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(yi(async(l,d)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(l),this._options.hideUnchangedRegionsContextLineCount.read(l),s.cancel(),r.read(l);let c=this._diffProvider.read(l);c.onChangeSignal.read(l),ps(jx,l),ps(Mv,l),this._isDiffUpToDate.set(!1,void 0);let u=[];d.add(t.original.onDidChangeContent(f=>{let g=ts.fromModelContentChanges(f.changes);u=oh(u,g)}));let p=[];d.add(t.modified.onDidChangeContent(f=>{let g=ts.fromModelContentChanges(f.changes);p=oh(p,g)}));let h=await c.diffProvider.computeDiff(t.original,t.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(l),maxComputationTimeMs:this._options.maxComputationTimeMs.read(l),computeMoves:this._options.showMoves.read(l)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||t.original.isDisposed()||t.modified.isDisposed()||(h=qG(h,t.original,t.modified),h=(t.original,t.modified,void 0)??h,h=(t.original,t.modified,void 0)??h,Yt(f=>{a(h,f),this._lastDiff=h;let g=Pv.fromDiffResult(h);this._diff.set(g,f),this._isDiffUpToDate.set(!0,f);let b=this.movedTextToCompare.get();this.movedTextToCompare.set(b?this._lastDiff.moves.find(v=>v.lineRangeMapping.modified.intersect(b.lineRangeMapping.modified)):void 0,f)}))}))}_isDiffUpToDate=st(this,!1);isDiffUpToDate=this._isDiffUpToDate;_lastDiff;_diff=st(this,void 0);diff=this._diff;_unchangedRegions=st(this,void 0);unchangedRegions=Me(this,t=>this._options.hideUnchangedRegions.read(t)?this._unchangedRegions.read(t)?.regions??[]:(Yt(n=>{for(let i of this._unchangedRegions.get()?.regions||[])i.collapseAll(n)}),[]));movedTextToCompare=st(this,void 0);_activeMovedText=st(this,void 0);_hoveredMovedText=st(this,void 0);activeMovedText=Me(this,t=>this.movedTextToCompare.read(t)??this._hoveredMovedText.read(t)??this._activeMovedText.read(t));setActiveMovedText(t){this._activeMovedText.set(t,void 0)}setHoveredMovedText(t){this._hoveredMovedText.set(t,void 0)}_cancellationTokenSource=new Rn;_diffProvider=Me(this,t=>{let n=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(t)}),i=Ii("onDidChange",n.onDidChange);return{diffProvider:n,onChangeSignal:i}});ensureModifiedLineIsVisible(t,n,i){if(this.diff.get()?.mappings.length===0)return;let r=this._unchangedRegions.get()?.regions||[];for(let s of r)if(s.getHiddenModifiedRange(void 0).contains(t)){s.showModifiedLine(t,n,i);return}}ensureOriginalLineIsVisible(t,n,i){if(this.diff.get()?.mappings.length===0)return;let r=this._unchangedRegions.get()?.regions||[];for(let s of r)if(s.getHiddenOriginalRange(void 0).contains(t)){s.showOriginalLine(t,n,i);return}}async waitForDiff(){await X_(this.isDiffUpToDate,t=>t)}serializeState(){return{collapsedRegions:this._unchangedRegions.get()?.regions.map(n=>({range:n.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(t){let n=t.collapsedRegions?.map(r=>De.deserialize(r.range)),i=this._unchangedRegions.get();!i||!n||Yt(r=>{for(let s of i.regions)for(let a of n)if(s.modifiedUnchangedRange.intersect(a)){s.setHiddenModifiedRange(a,r);break}})}};og=P([_(2,UO)],og);function qG(o,e,t){return{changes:o.changes.map(n=>new mr(n.original,n.modified,n.innerChanges?n.innerChanges.map(i=>$G(i,e,t)):void 0)),moves:o.moves,identical:o.identical,quitEarly:o.quitEarly}}function $G(o,e,t){let n=o.originalRange,i=o.modifiedRange;return n.startColumn===1&&i.startColumn===1&&(n.endColumn!==1||i.endColumn!==1)&&n.endColumn===e.getLineMaxColumn(n.endLineNumber)&&i.endColumn===t.getLineMaxColumn(i.endLineNumber)&&n.endLineNumber<e.getLineCount()&&i.endLineNumber<t.getLineCount()&&(n=n.setEndPosition(n.endLineNumber+1,1),i=i.setEndPosition(i.endLineNumber+1,1)),new so(n,i)}var Pv=class o{constructor(e,t,n,i){this.mappings=e;this.movedTexts=t;this.identical=n;this.quitEarly=i}static fromDiffResult(e){return new o(e.changes.map(t=>new Av(t)),e.moves||[],e.identical,e.quitEarly)}},Av=class{constructor(e){this.lineRangeMapping=e}},rg=class o{constructor(e,t,n,i,r){this.originalLineNumber=e;this.modifiedLineNumber=t;this.lineCount=n;let s=Math.max(Math.min(i,this.lineCount),0),a=Math.max(Math.min(r,this.lineCount-i),0);G_(i===s),G_(r===a),this._visibleLineCountTop.set(s,void 0),this._visibleLineCountBottom.set(a,void 0)}static fromDiffs(e,t,n,i,r){let s=mr.inverse(e,t,n),a=[];for(let l of s){let d=l.original.startLineNumber,c=l.modified.startLineNumber,u=l.original.length,p=d===1&&c===1,h=d+u===t+1&&c+u===n+1;(p||h)&&u>=r+i?(p&&!h&&(u-=r),h&&!p&&(d+=r,c+=r,u-=r),a.push(new o(d,c,u,0,0))):u>=r*2+i&&(d+=r,c+=r,u-=r*2,a.push(new o(d,c,u,0,0)))}return a}get originalUnchangedRange(){return De.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return De.ofLength(this.modifiedLineNumber,this.lineCount)}_visibleLineCountTop=st(this,0);visibleLineCountTop=this._visibleLineCountTop;_visibleLineCountBottom=st(this,0);visibleLineCountBottom=this._visibleLineCountBottom;_shouldHideControls=Me(this,e=>this.visibleLineCountTop.read(e)+this.visibleLineCountBottom.read(e)===this.lineCount&&!this.isDragged.read(e));isDragged=st(this,void 0);setVisibleRanges(e,t){let n=[],i=new Rr(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange),r=this.originalLineNumber,s=this.modifiedLineNumber,a=this.modifiedLineNumber+this.lineCount;if(i.ranges.length===0)this.showAll(t),n.push(this);else{let l=0;for(let d of i.ranges){let c=l===i.ranges.length-1;l++;let u=(c?a:d.endLineNumberExclusive)-s,p=new o(r,s,u,0,0);p.setHiddenModifiedRange(d,t),n.push(p),r=p.originalUnchangedRange.endLineNumberExclusive,s=p.modifiedUnchangedRange.endLineNumberExclusive}}return n}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return De.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return De.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){let n=e.startLineNumber-this.modifiedLineNumber,i=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(n,i,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){let n=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,n),t)}showMoreBelow(e=10,t){let n=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,n),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,n){let i=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),r=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&i<r||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+i,n):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+r,n)}showOriginalLine(e,t,n){let i=e-this.originalLineNumber,r=this.originalLineNumber+this.lineCount-e;t===0&&i<r||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+r-i,this.getMaxVisibleLineCountTop()),n):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+i-r,this.getMaxVisibleLineCountBottom()),n)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,n){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,n),this._visibleLineCountBottom.set(t,n)}};var vi=class extends F{constructor(t,n,i,r,s,a,l){super();this._editors=t;this._rootElement=n;this._diffModel=i;this._rootWidth=r;this._rootHeight=s;this._modifiedEditorLayoutInfo=a;this._themeService=l;let d=Dt(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=Me(h=>{let f=d.read(h),g=f.getColor(YF)||(f.getColor(qF)||mC).transparent(2),b=f.getColor(ZF)||(f.getColor($F)||gC).transparent(2);return{insertColor:g,removeColor:b}}),u=We(document.createElement("div"));u.setClassName("diffViewport"),u.setPosition("absolute");let p=vt("div.diffOverview",{style:{position:"absolute",top:"0px",width:vi.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(lp(p,u.domNode)),this._register(hn(p,he.POINTER_DOWN,h=>{this._editors.modified.delegateVerticalScrollbarPointerDown(h)})),this._register(q(p,he.MOUSE_WHEEL,h=>{this._editors.modified.delegateScrollFromMouseWheelEvent(h)},{passive:!1})),this._register(lp(this._rootElement,p)),this._register(yi((h,f)=>{let g=this._diffModel.read(h),b=this._editors.original.createOverviewRuler("original diffOverviewRuler");b&&(f.add(b),f.add(lp(p,b.getDomNode())));let v=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(v&&(f.add(v),f.add(lp(p,v.getDomNode()))),!b||!v)return;let I=Ii("viewZoneChanged",this._editors.original.onDidChangeViewZones),T=Ii("viewZoneChanged",this._editors.modified.onDidChangeViewZones),S=Ii("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),C=Ii("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);f.add(ot(w=>{I.read(w),T.read(w),S.read(w),C.read(w);let x=c.read(w),D=g?.diff.read(w)?.mappings;function O(z,ie,Se){let J=Se._getViewModel();return J?z.filter(X=>X.length>0).map(X=>{let le=J.coordinatesConverter.convertModelPositionToViewPosition(new A(X.startLineNumber,1)),re=J.coordinatesConverter.convertModelPositionToViewPosition(new A(X.endLineNumberExclusive,1)),ee=re.lineNumber-le.lineNumber;return new _b(le.lineNumber,re.lineNumber,ee,ie.toString())}):[]}let H=O((D||[]).map(z=>z.lineRangeMapping.original),x.removeColor,this._editors.original),K=O((D||[]).map(z=>z.lineRangeMapping.modified),x.insertColor,this._editors.modified);b?.setZones(H),v?.setZones(K)})),f.add(ot(w=>{let x=this._rootHeight.read(w),D=this._rootWidth.read(w),O=this._modifiedEditorLayoutInfo.read(w);if(O){let H=vi.ENTIRE_DIFF_OVERVIEW_WIDTH-2*vi.ONE_OVERVIEW_WIDTH;b.setLayout({top:0,height:x,right:H+vi.ONE_OVERVIEW_WIDTH,width:vi.ONE_OVERVIEW_WIDTH}),v.setLayout({top:0,height:x,right:0,width:vi.ONE_OVERVIEW_WIDTH});let K=this._editors.modifiedScrollTop.read(w),z=this._editors.modifiedScrollHeight.read(w),ie=this._editors.modified.getOption(105),Se=new Xd(ie.verticalHasArrows?ie.arrowSize:0,ie.verticalScrollbarSize,0,O.height,z,K);u.setTop(Se.getSliderPosition()),u.setHeight(Se.getSliderSize())}else u.setTop(0),u.setHeight(0);p.style.height=x+"px",p.style.left=D-vi.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",u.setWidth(vi.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}static ONE_OVERVIEW_WIDTH=15;static ENTIRE_DIFF_OVERVIEW_WIDTH=this.ONE_OVERVIEW_WIDTH*2;width=vi.ENTIRE_DIFF_OVERVIEW_WIDTH};vi=P([_(6,Wo)],vi);var sg=class extends F{constructor(t,n,i,r,s,a,l){super();this.originalEditorElement=t;this.modifiedEditorElement=n;this._options=i;this._argCodeEditorWidgetOptions=r;this._createInnerEditor=s;this._instantiationService=a;this._keybindingService=l;this._argCodeEditorWidgetOptions=null,this._register(cd({createEmptyChangeSummary:()=>({}),handleChange:(d,c)=>(d.didChange(i.editorOptions)&&Object.assign(c,d.change.changedOptions),!0)},(d,c)=>{i.editorOptions.read(d),this._options.renderSideBySide.read(d),this.modified.updateOptions(this._adjustOptionsForRightHandSide(d,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(d,c))}))}original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{}));modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{}));_onDidContentSizeChange=this._register(new k);get onDidContentSizeChange(){return this._onDidContentSizeChange.event}modifiedScrollTop=Dt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop());modifiedScrollHeight=Dt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight());modifiedObs=dp(this.modified);originalObs=dp(this.original);modifiedModel=this.modifiedObs.model;modifiedSelections=Dt(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]);modifiedCursor=ca({owner:this,equalsFn:A.equals},t=>this.modifiedSelections.read(t)[0]?.getPosition()??new A(1,1));originalCursor=Dt(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new A(1,1));isOriginalFocused=dp(this.original).isFocused;isModifiedFocused=dp(this.modified).isFocused;isFocused=Me(this,t=>this.isOriginalFocused.read(t)||this.isModifiedFocused.read(t));_createLeftHandSideEditor(t,n){let i=this._adjustOptionsForLeftHandSide(void 0,t),r=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,n);return r.setContextValue("isInDiffLeftEditor",!0),r}_createRightHandSideEditor(t,n){let i=this._adjustOptionsForRightHandSide(void 0,t),r=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,n);return r.setContextValue("isInDiffRightEditor",!0),r}_constructInnerEditor(t,n,i,r){let s=this._createInnerEditor(t,n,i,r);return this._register(s.onDidContentSizeChange(a=>{let l=this.original.getContentWidth()+this.modified.getContentWidth()+vi.ENTIRE_DIFF_OVERVIEW_WIDTH,d=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:d,contentWidth:l,contentHeightChanged:a.contentHeightChanged,contentWidthChanged:a.contentWidthChanged})})),s}_adjustOptionsForLeftHandSide(t,n){let i=this._adjustOptionsForSubEditor(n);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),n.originalAriaLabel&&(i.ariaLabel=n.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(t,n){let i=this._adjustOptionsForSubEditor(n);return n.modifiedAriaLabel&&(i.ariaLabel=n.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=Zr.revealHorizontalRightPadding.defaultValue+vi.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(t){let n={...t,dimension:{height:0,width:0}};return n.inDiffEditor=!0,n.automaticLayout=!1,n.scrollbar={...n.scrollbar||{}},n.folding=!1,n.codeLens=this._options.diffCodeLens.get(),n.fixedOverflowWidgets=!0,n.minimap={...n.minimap||{}},n.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?n.stickyScroll={enabled:!1}:n.stickyScroll=this._options.editorOptions.get().stickyScroll,n}_updateAriaLabel(t){t||(t="");let n=m("diff-aria-navigation-tip"," use {0} to open the accessibility help.",this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel());return this._options.accessibilityVerbose.get()?t+n:t?t.replaceAll(n,""):""}};sg=P([_(5,Qe),_(6,Qn)],sg);var YG=Or("diff-review-insert",ae.add,m("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),ZG=Or("diff-review-remove",ae.remove,m("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),QG=Or("diff-review-close",ae.close,m("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer.")),el=class extends F{constructor(t,n,i,r,s,a,l,d,c){super();this._parentNode=t;this._visible=n;this._setVisible=i;this._canClose=r;this._width=s;this._height=a;this._diffs=l;this._models=d;this._instantiationService=c}static _ttPolicy=hc("diffReview",{createHTML:t=>t});_state=hl(this,(t,n)=>{let i=this._visible.read(t);if(this._parentNode.style.visibility=i?"visible":"hidden",!i)return null;let r=n.add(this._instantiationService.createInstance(Bv,this._diffs,this._models,this._setVisible,this._canClose)),s=n.add(this._instantiationService.createInstance(Wv,this._parentNode,r,this._width,this._height,this._models));return{model:r,view:s}}).recomputeInitiallyAndOnChange(this._store);next(){Yt(t=>{let n=this._visible.get();this._setVisible(!0,t),n&&this._state.get().model.nextGroup(t)})}prev(){Yt(t=>{this._setVisible(!0,t),this._state.get().model.previousGroup(t)})}close(){Yt(t=>{this._setVisible(!1,t)})}};el=P([_(8,Qe)],el);var Bv=class extends F{constructor(t,n,i,r,s){super();this._diffs=t;this._models=n;this._setVisible=i;this.canClose=r;this._accessibilitySignalService=s;this._register(ot(a=>{let l=this._diffs.read(a);if(!l){this._groups.set([],void 0);return}let d=XG(l,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());Yt(c=>{let u=this._models.getModifiedPosition();if(u){let p=d.findIndex(h=>u?.lineNumber<h.range.modified.endLineNumberExclusive);p!==-1&&this._currentGroupIdx.set(p,c)}this._groups.set(d,c)})})),this._register(ot(a=>{let l=this.currentElement.read(a);l?.type===2?this._accessibilitySignalService.playSignal(vr.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):l?.type===3&&this._accessibilitySignalService.playSignal(vr.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(ot(a=>{let l=this.currentElement.read(a);if(l&&l.type!==0){let d=l.modifiedLineNumber??l.diff.modified.startLineNumber;this._models.modifiedSetSelection(M.fromPositions(new A(d,1)))}}))}_groups=st(this,[]);_currentGroupIdx=st(this,0);_currentElementIdx=st(this,0);groups=this._groups;currentGroup=this._currentGroupIdx.map((t,n)=>this._groups.read(n)[t]);currentGroupIndex=this._currentGroupIdx;currentElement=this._currentElementIdx.map((t,n)=>this.currentGroup.read(n)?.lines[t]);_goToGroupDelta(t,n){let i=this.groups.get();!i||i.length<=1||Nc(n,r=>{this._currentGroupIdx.set(ke.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+t),r),this._currentElementIdx.set(0,r)})}nextGroup(t){this._goToGroupDelta(1,t)}previousGroup(t){this._goToGroupDelta(-1,t)}_goToLineDelta(t){let n=this.currentGroup.get();!n||n.lines.length<=1||Yt(i=>{this._currentElementIdx.set(ke.ofLength(n.lines.length).clip(this._currentElementIdx.get()+t),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(t){let n=this.currentGroup.get();if(!n)return;let i=n.lines.indexOf(t);i!==-1&&Yt(r=>{this._currentElementIdx.set(i,r)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);let t=this.currentElement.get();t&&(t.type===2?this._models.originalReveal(M.fromPositions(new A(t.originalLineNumber,1))):this._models.modifiedReveal(t.type!==0?M.fromPositions(new A(t.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};Bv=P([_(4,Vx)],Bv);var Fv=3;function XG(o,e,t){let n=[];for(let i of vp(o,(r,s)=>s.modified.startLineNumber-r.modified.endLineNumberExclusive<2*Fv)){let r=[];r.push(new eN);let s=new De(Math.max(1,i[0].original.startLineNumber-Fv),Math.min(i[i.length-1].original.endLineNumberExclusive+Fv,e+1)),a=new De(Math.max(1,i[0].modified.startLineNumber-Fv),Math.min(i[i.length-1].modified.endLineNumberExclusive+Fv,t+1));ry(i,(c,u)=>{let p=new De(c?c.original.endLineNumberExclusive:s.startLineNumber,u?u.original.startLineNumber:s.endLineNumberExclusive),h=new De(c?c.modified.endLineNumberExclusive:a.startLineNumber,u?u.modified.startLineNumber:a.endLineNumberExclusive);p.forEach(f=>{r.push(new iN(f,h.startLineNumber+(f-p.startLineNumber)))}),u&&(u.original.forEach(f=>{r.push(new tN(u,f))}),u.modified.forEach(f=>{r.push(new nN(u,f))}))});let l=i[0].modified.join(i[i.length-1].modified),d=i[0].original.join(i[i.length-1].original);n.push(new JO(new Yi(l,d),r))}return n}var JO=class{constructor(e,t){this.range=e;this.lines=t}},eN=class{type=0},tN=class{constructor(e,t){this.diff=e;this.originalLineNumber=t}type=2;modifiedLineNumber=void 0},nN=class{constructor(e,t){this.diff=e;this.modifiedLineNumber=t}type=3;originalLineNumber=void 0},iN=class{constructor(e,t){this.originalLineNumber=e;this.modifiedLineNumber=t}type=1},Wv=class extends F{constructor(t,n,i,r,s,a){super();this._element=t;this._model=n;this._width=i;this._height=r;this._models=s;this._languageService=a;this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";let l=document.createElement("div");l.className="diff-review-actions",this._actionBar=this._register(new fr(l)),this._register(ot(d=>{this._actionBar.clear(),this._model.canClose.read(d)&&this._actionBar.push(new ai("diffreview.close",m("label.close","Close"),"close-diff-review "+Be.asClassName(QG),!0,async()=>n.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new ku(this._content,{})),Wr(this.domNode,this._scrollbar.getDomNode(),l),this._register(ot(d=>{this._height.read(d),this._width.read(d),this._scrollbar.scanDomNode()})),this._register(pe(()=>{Wr(this.domNode)})),this._register(Kr(this.domNode,{width:this._width,height:this._height})),this._register(Kr(this._content,{width:this._width,height:this._height})),this._register(yi((d,c)=>{this._model.currentGroup.read(d),this._render(c)})),this._register(hn(this.domNode,"keydown",d=>{(d.equals(18)||d.equals(2066)||d.equals(530))&&(d.preventDefault(),this._model.goToNextLine()),(d.equals(16)||d.equals(2064)||d.equals(528))&&(d.preventDefault(),this._model.goToPreviousLine()),(d.equals(9)||d.equals(2057)||d.equals(521)||d.equals(1033))&&(d.preventDefault(),this._model.close()),(d.equals(10)||d.equals(3))&&(d.preventDefault(),this._model.revealCurrentElementInEditor())}))}domNode;_content;_scrollbar;_actionBar;_render(t){let n=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),r=document.createElement("div");r.className="diff-review-table",r.setAttribute("role","list"),r.setAttribute("aria-label",m("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),tn(r,i.get(51)),Wr(this._content,r);let s=this._models.getOriginalModel(),a=this._models.getModifiedModel();if(!s||!a)return;let l=s.getOptions(),d=a.getOptions(),c=i.get(68),u=this._model.currentGroup.get();for(let p of u?.lines||[]){if(!u)break;let h;if(p.type===0){let g=document.createElement("div");g.className="diff-review-row",g.setAttribute("role","listitem");let b=u.range,v=this._model.currentGroupIndex.get(),I=this._model.groups.get().length,T=x=>x===0?m("no_lines_changed","no lines changed"):x===1?m("one_line_changed","1 line changed"):m("more_lines_changed","{0} lines changed",x),S=T(b.original.length),C=T(b.modified.length);g.setAttribute("aria-label",m({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",v+1,I,b.original.startLineNumber,S,b.modified.startLineNumber,C));let w=document.createElement("div");w.className="diff-review-cell diff-review-summary",w.appendChild(document.createTextNode(`${v+1}/${I}: @@ -${b.original.startLineNumber},${b.original.length} +${b.modified.startLineNumber},${b.modified.length} @@`)),g.appendChild(w),h=g}else h=this._createRow(p,c,this._width.get(),n,s,l,i,a,d);r.appendChild(h);let f=Me(g=>this._model.currentElement.read(g)===p);t.add(ot(g=>{let b=f.read(g);h.tabIndex=b?0:-1,b&&h.focus()})),t.add(q(h,"focus",()=>{this._model.goToLine(p)}))}this._scrollbar.scanDomNode()}_createRow(t,n,i,r,s,a,l,d,c){let u=r.get(147),p=u.glyphMarginWidth+u.lineNumbersWidth,h=l.get(147),f=10+h.glyphMarginWidth+h.lineNumbersWidth,g="diff-review-row",b="",v="diff-review-spacer",I=null;switch(t.type){case 3:g="diff-review-row line-insert",b=" char-insert",I=YG;break;case 2:g="diff-review-row line-delete",b=" char-delete",I=ZG;break}let T=document.createElement("div");T.style.minWidth=i+"px",T.className=g,T.setAttribute("role","listitem"),T.ariaLevel="";let S=document.createElement("div");S.className="diff-review-cell",S.style.height=`${n}px`,T.appendChild(S);let C=document.createElement("span");C.style.width=p+"px",C.style.minWidth=p+"px",C.className="diff-review-line-number"+b,t.originalLineNumber!==void 0?C.appendChild(document.createTextNode(String(t.originalLineNumber))):C.innerText="\xA0",S.appendChild(C);let w=document.createElement("span");w.style.width=f+"px",w.style.minWidth=f+"px",w.style.paddingRight="10px",w.className="diff-review-line-number"+b,t.modifiedLineNumber!==void 0?w.appendChild(document.createTextNode(String(t.modifiedLineNumber))):w.innerText="\xA0",S.appendChild(w);let x=document.createElement("span");if(x.className=v,I){let H=document.createElement("span");H.className=Be.asClassName(I),H.innerText="\xA0\xA0",x.appendChild(H)}else x.innerText="\xA0\xA0";S.appendChild(x);let D;if(t.modifiedLineNumber!==void 0){let H=this._getLineHtml(d,l,c.tabSize,t.modifiedLineNumber,this._languageService.languageIdCodec);el._ttPolicy&&(H=el._ttPolicy.createHTML(H)),S.insertAdjacentHTML("beforeend",H),D=d.getLineContent(t.modifiedLineNumber)}else{let H=this._getLineHtml(s,r,a.tabSize,t.originalLineNumber,this._languageService.languageIdCodec);el._ttPolicy&&(H=el._ttPolicy.createHTML(H)),S.insertAdjacentHTML("beforeend",H),D=s.getLineContent(t.originalLineNumber)}D.length===0&&(D=m("blankLine","blank"));let O="";switch(t.type){case 1:t.originalLineNumber===t.modifiedLineNumber?O=m({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",D,t.originalLineNumber):O=m("equalLine","{0} original line {1} modified line {2}",D,t.originalLineNumber,t.modifiedLineNumber);break;case 3:O=m("insertLine","+ {0} modified line {1}",D,t.modifiedLineNumber);break;case 2:O=m("deleteLine","- {0} original line {1}",D,t.originalLineNumber);break}return T.setAttribute("aria-label",O),T}_getLineHtml(t,n,i,r,s){let a=t.getLineContent(r),l=n.get(51),d=vn.createEmpty(a,s),c=Fa.isBasicASCII(a,t.mightContainNonBasicASCII()),u=Fa.containsRTL(a,c,t.mightContainRTL());return yU(new mc(l.isMonospace&&!n.get(33),l.canUseHalfwidthRightwardsArrow,a,!1,c,u,0,d,[],i,0,l.spaceWidth,l.middotWidth,l.wsmiddotWidth,n.get(119),n.get(101),n.get(96),n.get(52)!==ws.OFF,null)).html}};Wv=P([_(5,$n)],Wv);var Zx=class{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}};var yc=class o extends F{constructor(t,n,i,r,s){super();this._rootElement=t;this._diffModel=n;this._originalEditorLayoutInfo=i;this._modifiedEditorLayoutInfo=r;this._editors=s;this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(pe(()=>this._element.remove())),this._register(ot(u=>{let p=this._originalEditorLayoutInfo.read(u),h=this._modifiedEditorLayoutInfo.read(u);!p||!h||(this._element.style.left=`${p.width-p.verticalScrollbarWidth}px`,this._element.style.height=`${p.height}px`,this._element.style.width=`${p.verticalScrollbarWidth+p.contentLeft-o.movedCodeBlockPadding+this.width.read(u)}px`)})),this._register(Sp(this._state));let a=Me(u=>{let h=this._diffModel.read(u)?.diff.read(u);return h?h.movedTexts.map(f=>({move:f,original:new Za(ud(f.lineRangeMapping.original.startLineNumber-1),18),modified:new Za(ud(f.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(Jm(this._editors.original,a.map(u=>u.map(p=>p.original)))),this._register(Jm(this._editors.modified,a.map(u=>u.map(p=>p.modified)))),this._register(yi((u,p)=>{let h=a.read(u);for(let f of h)p.add(new Qx(this._editors.original,f.original,f.move,"original",this._diffModel.get())),p.add(new Qx(this._editors.modified,f.modified,f.move,"modified",this._diffModel.get()))}));let l=Ii("original.onDidFocusEditorWidget",u=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),d=Ii("modified.onDidFocusEditorWidget",u=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),c="modified";this._register(cd({createEmptyChangeSummary:()=>{},handleChange:(u,p)=>(u.didChange(l)&&(c="original"),u.didChange(d)&&(c="modified"),!0)},u=>{l.read(u),d.read(u);let p=this._diffModel.read(u);if(!p)return;let h=p.diff.read(u),f;if(h&&c==="original"){let g=this._editors.originalCursor.read(u);g&&(f=h.movedTexts.find(b=>b.lineRangeMapping.original.contains(g.lineNumber)))}if(h&&c==="modified"){let g=this._editors.modifiedCursor.read(u);g&&(f=h.movedTexts.find(b=>b.lineRangeMapping.modified.contains(g.lineNumber)))}f!==p.movedTextToCompare.get()&&p.movedTextToCompare.set(void 0,void 0),p.setActiveMovedText(f)}))}static movedCodeBlockPadding=4;_element;_originalScrollTop=Dt(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop());_modifiedScrollTop=Dt(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop());_viewZonesChanged=Ii("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);width=st(this,0);_modifiedViewZonesChangedSignal=Ii("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);_originalViewZonesChangedSignal=Ii("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones);_state=hl(this,(t,n)=>{this._element.replaceChildren();let i=this._diffModel.read(t),r=i?.diff.read(t)?.movedTexts;if(!r||r.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(t);let s=this._originalEditorLayoutInfo.read(t),a=this._modifiedEditorLayoutInfo.read(t);if(!s||!a){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(t),this._originalViewZonesChangedSignal.read(t);let l=r.map(g=>{function b(O,H){let K=H.getTopForLineNumber(O.startLineNumber,!0),z=H.getTopForLineNumber(O.endLineNumberExclusive,!0);return(K+z)/2}let v=b(g.lineRangeMapping.original,this._editors.original),I=this._originalScrollTop.read(t),T=b(g.lineRangeMapping.modified,this._editors.modified),S=this._modifiedScrollTop.read(t),C=v-I,w=T-S,x=Math.min(v,T),D=Math.max(v,T);return{range:new ke(x,D),from:C,to:w,fromWithoutScroll:v,toWithoutScroll:T,move:g}});l.sort(JN(mo(g=>g.fromWithoutScroll>g.toWithoutScroll,eA),mo(g=>g.fromWithoutScroll>g.toWithoutScroll?g.fromWithoutScroll:-g.toWithoutScroll,da)));let d=oN.compute(l.map(g=>g.range)),c=10,u=s.verticalScrollbarWidth,p=(d.getTrackCount()-1)*10+c*2,h=u+p+(a.contentLeft-o.movedCodeBlockPadding),f=0;for(let g of l){let b=d.getTrack(f),v=u+c+b*10,I=15,T=15,S=h,C=a.glyphMarginWidth+a.lineNumbersWidth,w=18,x=document.createElementNS("http://www.w3.org/2000/svg","rect");x.classList.add("arrow-rectangle"),x.setAttribute("x",`${S-C}`),x.setAttribute("y",`${g.to-w/2}`),x.setAttribute("width",`${C}`),x.setAttribute("height",`${w}`),this._element.appendChild(x);let D=document.createElementNS("http://www.w3.org/2000/svg","g"),O=document.createElementNS("http://www.w3.org/2000/svg","path");O.setAttribute("d",`M 0 ${g.from} L ${v} ${g.from} L ${v} ${g.to} L ${S-T} ${g.to}`),O.setAttribute("fill","none"),D.appendChild(O);let H=document.createElementNS("http://www.w3.org/2000/svg","polygon");H.classList.add("arrow"),n.add(ot(K=>{O.classList.toggle("currentMove",g.move===i.activeMovedText.read(K)),H.classList.toggle("currentMove",g.move===i.activeMovedText.read(K))})),H.setAttribute("points",`${S-T},${g.to-I/2} ${S},${g.to} ${S-T},${g.to+I/2}`),D.appendChild(H),this._element.appendChild(D),f++}this.width.set(p,void 0)})},oN=class o{constructor(e,t){this._trackCount=e;this.trackPerLineIdx=t}static compute(e){let t=[],n=[];for(let i of e){let r=t.findIndex(s=>!s.intersectsStrict(i));r===-1&&(t.length>=6?r=jN(t,mo(a=>a.intersectWithRangeLength(i),da)):(r=t.length,t.push(new vI))),t[r].addRange(i),n.push(r)}return new o(t.length,n)}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}},Qx=class extends sp{constructor(t,n,i,r,s){let a=vt("div.diff-hidden-lines-widget");super(t,n,a.root);this._editor=t;this._move=i;this._kind=r;this._diffModel=s;a.root.appendChild(this._nodes.root);let l=Dt(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Kr(this._nodes.root,{paddingRight:l.map(h=>h.verticalScrollbarWidth)}));let d;i.changes.length>0?d=this._kind==="original"?m("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):m("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):d=this._kind==="original"?m("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):m("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);let c=this._register(new fr(this._nodes.actionBar,{highlightToggledItems:!0})),u=new ai("",d,"",!1);c.push(u,{icon:!1,label:!0});let p=new ai("","Compare",Be.asClassName(ae.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(ot(h=>{let f=this._diffModel.movedTextToCompare.read(h)===i;p.checked=f})),c.push(p,{icon:!1,label:!0})}_nodes=vt("div.diff-moved-code-block",{style:{marginRight:"4px"}},[vt("div.text-content@textContent"),vt("div.action-bar@actionBar")])};var Xx=class extends F{constructor(t,n,i,r){super();this._editors=t;this._diffModel=n;this._options=i;this._register(Xm(this._editors.original,this._decorations.map(s=>s?.originalDecorations||[]))),this._register(Xm(this._editors.modified,this._decorations.map(s=>s?.modifiedDecorations||[])))}_decorations=Me(this,t=>{let n=this._diffModel.read(t),i=n?.diff.read(t);if(!i)return null;let r=this._diffModel.read(t).movedTextToCompare.read(t),s=this._options.renderIndicators.read(t),a=this._options.showEmptyDecorations.read(t),l=[],d=[];if(!r)for(let u of i.mappings)if(u.lineRangeMapping.original.isEmpty||l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:s?YO:QO}),u.lineRangeMapping.modified.isEmpty||d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:s?$O:ZO}),u.lineRangeMapping.modified.isEmpty||u.lineRangeMapping.original.isEmpty)u.lineRangeMapping.original.isEmpty||l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:u5}),u.lineRangeMapping.modified.isEmpty||d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:d5});else{let p=this._options.useTrueInlineDiffRendering.read(t)&&Nv(u.lineRangeMapping);for(let h of u.lineRangeMapping.innerChanges||[])if(u.lineRangeMapping.original.contains(h.originalRange.startLineNumber)&&l.push({range:h.originalRange,options:h.originalRange.isEmpty()&&a?p5:Ov}),u.lineRangeMapping.modified.contains(h.modifiedRange.startLineNumber)&&d.push({range:h.modifiedRange,options:h.modifiedRange.isEmpty()&&a&&!p?c5:XO}),p){let f=n.model.original.getValueInRange(h.originalRange);d.push({range:h.modifiedRange,options:{description:"deleted-text",before:{content:f,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(r)for(let u of r.changes){let p=u.original.toInclusiveRange();p&&l.push({range:p,options:s?YO:QO});let h=u.modified.toInclusiveRange();h&&d.push({range:h,options:s?$O:ZO});for(let f of u.innerChanges||[])l.push({range:f.originalRange,options:Ov}),d.push({range:f.modifiedRange,options:XO})}let c=this._diffModel.read(t).activeMovedText.read(t);for(let u of i.movedTexts)l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(u===c?" currentMove":""),blockPadding:[yc.movedCodeBlockPadding,0,yc.movedCodeBlockPadding,yc.movedCodeBlockPadding]}}),d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(u===c?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:l,modifiedDecorations:d}})};var Jx=class{constructor(e,t){this._options=e;this.dimensions=t}sashLeft=Cp(this,e=>{let t=this._sashRatio.read(e)??this._options.splitViewDefaultRatio.read(e);return this._computeSashLeft(t,e)},(e,t)=>{let n=this.dimensions.width.get();this._sashRatio.set(e/n,t)});_sashRatio=st(this,void 0);resetSash(){this._sashRatio.set(void 0,void 0)}_computeSashLeft(e,t){let n=this.dimensions.width.read(t),i=Math.floor(this._options.splitViewDefaultRatio.read(t)*n),r=this._options.enableSplitViewResizing.read(t)?Math.floor(e*n):i,s=100;return n<=s*2?i:r<s?s:r>n-s?n-s:r}},ag=class extends F{constructor(t,n,i,r,s,a){super();this._domNode=t;this._dimensions=n;this._enabled=i;this._boundarySashes=r;this.sashLeft=s;this._resetSash=a;this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(l=>{this.sashLeft.set(this._startSashPosition+(l.currentX-l.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(ot(l=>{let d=this._boundarySashes.read(l);d&&(this._sash.orthogonalEndSash=d.bottom)})),this._register(ot(l=>{let d=this._enabled.read(l);this._sash.state=d?3:0,this.sashLeft.read(l),this._dimensions.height.read(l),this._sash.layout()}))}_sash=this._register(new Iu(this._domNode,{getVerticalSashTop:t=>0,getVerticalSashLeft:t=>this.sashLeft.get(),getVerticalSashHeight:t=>this._dimensions.height.get()},{orientation:0}));_startSashPosition=void 0};var e_=class extends F{constructor(t,n,i){super();this._editor=t;this._domNode=n;this.itemProvider=i;this._domNode.className="gutter monaco-editor";let r=this._domNode.appendChild(vt("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{Yt(a=>{this.domNodeSizeChanged.trigger(a)})});s.observe(this._domNode),this._register(pe(()=>s.disconnect())),this._register(ot(a=>{r.className=this.isScrollTopZero.read(a)?"":"scroll-decoration"})),this._register(ot(a=>this.render(a)))}scrollTop=Dt(this,this._editor.onDidScrollChange,t=>this._editor.getScrollTop());isScrollTopZero=this.scrollTop.map(t=>t===0);modelAttached=Dt(this,this._editor.onDidChangeModel,t=>this._editor.hasModel());editorOnDidChangeViewZones=Ii("onDidChangeViewZones",this._editor.onDidChangeViewZones);editorOnDidContentSizeChange=Ii("onDidContentSizeChange",this._editor.onDidContentSizeChange);domNodeSizeChanged=Oc("domNodeSizeChanged");dispose(){super.dispose(),Wr(this._domNode)}views=new Map;render(t){if(!this.modelAttached.read(t))return;this.domNodeSizeChanged.read(t),this.editorOnDidChangeViewZones.read(t),this.editorOnDidContentSizeChange.read(t);let n=this.scrollTop.read(t),i=this._editor.getVisibleRanges(),r=new Set(this.views.keys()),s=ke.ofStartAndLength(0,this._domNode.clientHeight);if(!s.isEmpty)for(let a of i){let l=new De(a.startLineNumber,a.endLineNumber+1),d=this.itemProvider.getIntersectingGutterItems(l,t);Yt(c=>{for(let u of d){if(!u.range.intersect(l))continue;r.delete(u.id);let p=this.views.get(u.id);if(p)p.item.set(u,c);else{let b=document.createElement("div");this._domNode.appendChild(b);let v=st("item",u),I=this.itemProvider.createView(v,b);p=new rN(v,I,b),this.views.set(u.id,p)}let h=u.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(u.range.startLineNumber,!0)-n:this._editor.getBottomForLineNumber(u.range.startLineNumber-1,!1)-n,g=(u.range.endLineNumberExclusive===1?Math.max(h,this._editor.getTopForLineNumber(u.range.startLineNumber,!1)-n):Math.max(h,this._editor.getBottomForLineNumber(u.range.endLineNumberExclusive-1,!0)-n))-h;p.domNode.style.top=`${h}px`,p.domNode.style.height=`${g}px`,p.gutterItemView.layout(ke.ofStartAndLength(h,g),s)}})}for(let a of r){let l=this.views.get(a);l.gutterItemView.dispose(),l.domNode.remove(),this.views.delete(a)}}},rN=class{constructor(e,t,n){this.item=e;this.gutterItemView=t;this.domNode=n}};var t_=class extends Oo{constructor(t){super();this._getContext=t}runAction(t,n){let i=this._getContext();return super.runAction(t,i)}};var Vv=class extends Tb{constructor(t){super();this._textModel=t}getValueOfRange(t){return this._textModel.getValueInRange(t)}get length(){let t=this._textModel.getLineCount(),n=this._textModel.getLineLength(t);return new Fo(t-1,n)}};var Ic=class extends co{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new k);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(e,t,n,i=Object.create(null)){super(null,e,i),this.menuActionsOrProvider=t,this.contextMenuProvider=n,this.options=i,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;let t=r=>{this.element=dt(r,Ke("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(_o().setupManagedHover(this.options.hoverDelegate??An("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},n=Array.isArray(this.menuActionsOrProvider),i={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:n?this.menuActionsOrProvider:void 0,actionProvider:n?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new UE(e,i)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{this.element?.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){let e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}};var n_=class extends F{options;actionBar;toggleMenuAction;toggleMenuActionViewItem;submenuActionViewItems=[];hasSecondaryActions=!1;element;_onDidChangeDropdownVisibility=this._register(new Vg);onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event;disposables=this._register(new ne);constructor(e,t,n={orientation:0}){super(),n.hoverDelegate=n.hoverDelegate??this._register(Wl()),this.options=n,this.toggleMenuAction=this._register(new lg(()=>this.toggleMenuActionViewItem?.show(),n.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new fr(this.element,{orientation:n.orientation,ariaLabel:n.ariaLabel,actionRunner:n.actionRunner,allowContextMenu:n.allowContextMenu,highlightToggledItems:n.highlightToggledItems,hoverDelegate:n.hoverDelegate,actionViewItemProvider:(i,r)=>{if(i.id===lg.ID)return this.toggleMenuActionViewItem=new Ic(i,i.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Be.asClassNameArray(n.moreIcon??ae.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(n.actionViewItemProvider){let s=n.actionViewItemProvider(i,r);if(s)return s}if(i instanceof bl){let s=new Ic(i,i.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:i.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return s.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(s),this.disposables.add(this._onDidChangeDropdownVisibility.add(s.onDidChangeVisibility)),s}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){this.actionBar.context=e,this.toggleMenuActionViewItem?.setActionContext(e);for(let t of this.submenuActionViewItems)t.setActionContext(e)}getElement(){return this.element}focus(){this.actionBar.focus()}getItemsWidth(){let e=0;for(let t=0;t<this.actionBar.length();t++)e+=this.actionBar.getWidth(t);return e}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}getItemsLength(){return this.actionBar.length()}setAriaLabel(e){this.actionBar.setAriaLabel(e)}setActions(e,t){this.clear();let n=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),n.push(this.toggleMenuAction)),n.forEach(i=>{this.actionBar.push(i,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(i)})})}isEmpty(){return this.actionBar.isEmpty()}getKeybindingLabel(e){return this.options.getKeyBinding?.(e)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}},lg=class o extends ai{static ID="toolbar.toggle.more";_menuActions;toggleDropdownMenu;constructor(e,t){t=t||m("moreActions","More Actions..."),super(o.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};function C5(o,e,t,n,i,r){let s,a,l,d,c;if(Array.isArray(o))c=o,s=e,a=t,l=n,d=i;else{let p=e;c=o.getActions(p),s=t,a=n,l=i,d=r}JG(c,s,!1,typeof a=="string"?p=>p===a:a,l,d)}function JG(o,e,t,n=s=>s==="navigation",i=()=>!1,r=!1){let s,a;Array.isArray(e)?(s=e,a=e):(s=e.primary,a=e.secondary);let l=new Set;for(let[d,c]of o){let u;n(d)?(u=s,u.length>0&&r&&u.push(new Ci)):(u=a,u.length>0&&u.push(new Ci));for(let p of c){t&&(p=p instanceof To&&p.alt?p.alt:p);let h=u.push(p);p instanceof bl&&l.add({group:d,action:p,index:h-1})}}for(let{group:d,action:c,index:u}of l){let p=n(d)?s:a,h=c.actions;i(c,d,p.length)&&p.splice(u,1,...h)}}var dg=class extends oc{constructor(t,n,i,r,s,a,l,d){super(void 0,t,{icon:!!(t.class||t.item.icon),label:!t.class&&!t.item.icon,draggable:n?.draggable,keybinding:n?.keybinding,hoverDelegate:n?.hoverDelegate});this._options=n;this._keybindingService=i;this._notificationService=r;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=Vh.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new on);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(t){t.preventDefault(),t.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(n){this._notificationService.error(n)}}render(t){if(super.render(t),t.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let n=!1,i=()=>{let r=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||n)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&n);r!==this._wantsAltCommand&&(this._wantsAltCommand=r,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(q(t,"mouseleave",r=>{n=!1,i()})),this._register(q(t,"mouseenter",r=>{n=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),n=t&&t.getLabel(),i=this._commandAction.tooltip||this._commandAction.label,r=n?m("titleAndKb","{0} ({1})",i,n):i;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?m("titleAndKb","{0} ({1})",s,l):s;r=m("titleAndKbAndAlt",`{0}
[{1}] {2}`,r,WR.modifierLabels[$r].altKey,d)}return r}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(t){this._itemClassDispose.value=void 0;let{element:n,label:i}=this;if(!n||!i)return;let r=this._commandAction.checked&&YP(t.toggled)&&t.toggled.icon?t.toggled.icon:t.icon;if(r)if(Be.isThemeIcon(r)){let s=Be.asClassNameArray(r);i.classList.add(...s),this._itemClassDispose.value=pe(()=>{i.classList.remove(...s)})}else i.style.backgroundImage=E0(this._themeService.getColorTheme().type)?yb(r.dark):yb(r.light),i.classList.add("icon"),this._itemClassDispose.value=Mo(pe(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};dg=P([_(2,Qn),_(3,mu),_(4,St),_(5,Wo),_(6,Hl),_(7,vo)],dg);var i_=class extends Ic{constructor(t,n,i,r,s){let a={...n,menuAsChild:n?.menuAsChild??!1,classNames:n?.classNames??(Be.isThemeIcon(t.item.icon)?Be.asClassName(t.item.icon):void 0),keybindingProvider:n?.keybindingProvider??(l=>i.lookupKeybinding(l.id))};super(t,{getActions:()=>t.actions},r,a);this._keybindingService=i;this._contextMenuService=r;this._themeService=s}render(t){super.render(t),Dp(this.element),t.classList.add("menu-entry");let n=this._action,{icon:i}=n.item;if(i&&!Be.isThemeIcon(i)){this.element.classList.add("icon");let r=()=>{this.element&&(this.element.style.backgroundImage=E0(this._themeService.getColorTheme().type)?yb(i.dark):yb(i.light))};r(),this._register(this._themeService.onDidColorThemeChange(()=>{r()}))}}};i_=P([_(2,Qn),_(3,Hl),_(4,Wo)],i_);var o_=class extends co{constructor(t,n,i,r,s,a,l,d){super(null,t);this._keybindingService=i;this._notificationService=r;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=n,this._storageKey=`${t.item.submenu.id}_lastActionId`;let c,u=n?.persistLastActionId?d.get(this._storageKey,1):void 0;u&&(c=t.actions.find(h=>u===h.id)),c||(c=t.actions[0]),this._defaultAction=this._instaService.createInstance(dg,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let p={keybindingProvider:h=>this._keybindingService.lookupKeybinding(h.id),...n,menuAsChild:n?.menuAsChild??!0,classNames:n?.classNames??["codicon","codicon-chevron-down"],actionRunner:n?.actionRunner??new Oo};this._dropdown=new Ic(t,t.actions,this._contextMenuService,p),this._register(this._dropdown.actionRunner.onDidRun(h=>{h.action instanceof To&&this.update(h.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(t){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,t.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(dg,t,{keybinding:this._getDefaultActionKeybindingLabel(t)}),this._defaultAction.actionRunner=new class extends Oo{async runAction(n,i){await n.run(void 0)}},this._container&&this._defaultAction.render(l1(this._container,Ke(".action-container")))}_getDefaultActionKeybindingLabel(t){let n;if(this._options?.renderKeybindingWithDefaultActionLabel){let i=this._keybindingService.lookupKeybinding(t.id);i&&(n=`(${i.getLabel()})`)}return n}setActionContext(t){super.setActionContext(t),this._defaultAction.setActionContext(t),this._dropdown.setActionContext(t)}render(t){this._container=t,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let n=Ke(".action-container");this._defaultAction.render(dt(this._container,n)),this._register(q(n,he.KEY_DOWN,r=>{let s=new gt(r);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let i=Ke(".dropdown-action-container");this._dropdown.render(dt(this._container,i)),this._register(q(i,he.KEY_DOWN,r=>{let s=new gt(r);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(t){t?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(t){t?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};o_=P([_(2,Qn),_(3,mu),_(4,Hl),_(5,pu),_(6,Qe),_(7,uo)],o_);var r_=class extends SE{constructor(e,t){super(null,e,e.actions.map(n=>({text:n.id===Ci.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":n.label,isDisabled:!n.enabled})),0,t,uH,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=de(Kf)}runAction(e,t){let n=this.action.actions[t];n&&this.actionRunner.run(n)}};r_=P([_(1,HE)],r_);var s_=class{constructor(e,t,n){this._commandService=e;this._keybindingService=t;this._hiddenStates=new tl(n)}_hiddenStates;createMenu(e,t,n){return new cg(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t)}getMenuActions(e,t,n){let i=new cg(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t),r=i.getActions(n);return i.dispose(),r}getMenuContexts(e){let t=new a_(e,!1);return new Set([...t.structureContextKeys,...t.preconditionContextKeys,...t.toggledContextKeys])}resetHiddenStates(e){this._hiddenStates.reset(e)}};s_=P([_(0,Gi),_(1,Qn),_(2,uo)],s_);var tl=class{constructor(e){this._storageService=e;try{let t=e.get(tl._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,tl._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{let t=e.get(tl._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}static _key="menu.hiddenCommands";_disposables=new ne;_onDidChange=new k;onDidChange=this._onDidChange.event;_ignoreChangeEvent=!1;_data;_hiddenByDefaultCache=new Map;dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,n){this._hiddenByDefaultCache.set(`${e.id}/${t}`,n)}isHidden(e,t){let n=this._isHiddenByDefault(e,t),i=this._data[e.id]?.includes(t)??!1;return n?!i:i}updateHidden(e,t,n){this._isHiddenByDefault(e,t)&&(n=!n);let r=this._data[e.id];if(n)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){let s=r.indexOf(t);s>=0&&YN(r,s),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(let{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;let e=JSON.stringify(this._data);this._storageService.store(tl._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};tl=P([_(0,uo)],tl);var a_=class o{constructor(e,t){this._id=e;this._collectContextKeysForSubmenus=t;this.refresh()}_menuGroups=[];_allMenuIds=new Set;_structureContextKeys=new Set;_preconditionContextKeys=new Set;_toggledContextKeys=new Set;get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();let e=this._sort(Ar.getMenuItems(this._id)),t;for(let n of e){let i=n.group||"";(!t||t[0]!==i)&&(t=[i,[]],this._menuGroups.push(t)),t[1].push(n),this._collectContextKeysAndSubmenuIds(n)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(o._fillInKbExprKeys(e.when,this._structureContextKeys),Oh(e)){if(e.command.precondition&&o._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){let t=e.command.toggled.condition||e.command.toggled;o._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(Ar.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(let n of e.keys())t.add(n)}},Yl=class extends a_{constructor(t,n,i,r,s,a){super(t,i);this._hiddenStates=n;this._commandService=r;this._keybindingService=s;this._contextKeyService=a;this.refresh()}createActionGroups(t){let n=[];for(let i of this._menuGroups){let[r,s]=i,a;for(let l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let d=Oh(l);d&&this._hiddenStates.setDefaultState(this._id,l.command.id,!!l.isHiddenByDefault);let c=ej(this._id,d?l.command:l,this._hiddenStates);if(d){let u=sN(this._commandService,this._keybindingService,l.command.id,l.when);(a??=[]).push(new To(l.command,l.alt,t,c,u,this._contextKeyService,this._commandService))}else{let u=new Yl(l.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(t),p=Ci.join(...u.map(h=>h[1]));p.length>0&&(a??=[]).push(new Ml(l,c,p))}}a&&a.length>0&&n.push([r,a])}return n}_sort(t){return t.sort(Yl._compareMenuItems)}static _compareMenuItems(t,n){let i=t.group,r=n.group;if(i!==r){if(i){if(!r)return-1}else return 1;if(i==="navigation")return-1;if(r==="navigation")return 1;let l=i.localeCompare(r);if(l!==0)return l}let s=t.order||0,a=n.order||0;return s<a?-1:s>a?1:Yl._compareTitles(Oh(t)?t.command.title:t.title,Oh(n)?n.command.title:n.title)}static _compareTitles(t,n){let i=typeof t=="string"?t:t.original,r=typeof n=="string"?n:n.original;return i.localeCompare(r)}};Yl=P([_(3,Gi),_(4,Qn),_(5,St)],Yl);var cg=class{_menuInfo;_disposables=new ne;_onDidChange;onDidChange;constructor(e,t,n,i,r,s){this._menuInfo=new Yl(e,t,n.emitEventsForSubmenuChanges,i,r,s);let a=new ln(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},n.eventDebounceDelay);this._disposables.add(a),this._disposables.add(Ar.onDidChangeMenu(u=>{for(let p of this._menuInfo.allMenuIds)if(u.has(p)){a.schedule();break}}));let l=this._disposables.add(new ne),d=u=>{let p=!1,h=!1,f=!1;for(let g of u)if(p=p||g.isStructuralChange,h=h||g.isEnablementChange,f=f||g.isToggleChange,p&&h&&f)break;return{menu:this,isStructuralChange:p,isEnablementChange:h,isToggleChange:f}},c=()=>{l.add(s.onDidChangeContext(u=>{let p=u.affectsSome(this._menuInfo.structureContextKeys),h=u.affectsSome(this._menuInfo.preconditionContextKeys),f=u.affectsSome(this._menuInfo.toggledContextKeys);(p||h||f)&&this._onDidChange.fire({menu:this,isStructuralChange:p,isEnablementChange:h,isToggleChange:f})})),l.add(t.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new Iy({onWillAddFirstListener:c,onDidRemoveLastListener:l.clear.bind(l),delay:n.eventDebounceDelay,merge:d}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};cg=P([_(3,Gi),_(4,Qn),_(5,St)],cg);function ej(o,e,t){let n=CW(e)?e.submenu.id:e.id,i=typeof e.title=="string"?e.title:e.title.value,r=Si({id:`hide/${o.id}/${n}`,label:m("hide.label","Hide '{0}'",i),run(){t.updateHidden(o,n,!0)}}),s=Si({id:`toggle/${o.id}/${n}`,label:i,get checked(){return!t.isHidden(o,n)},run(){t.updateHidden(o,n,!!this.checked)}});return{hide:r,toggle:s,get isHidden(){return!s.checked}}}function sN(o,e,t,n=void 0,i=!0){return Si({id:`configureKeybinding/${t}`,label:m("configure keybinding","Configure Keybinding"),enabled:i,run(){let s=!!!e.lookupKeybinding(t)&&n?n.serialize():void 0;o.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(s?` +when:${s}`:""))}})}var Hv=class extends n_{constructor(t,n,i,r,s,a,l,d){super(t,s,{getKeyBinding:u=>a.lookupKeybinding(u.id)??void 0,...n,allowContextMenu:!0,skipTelemetry:typeof n?.telemetrySource=="string"});this._options=n;this._menuService=i;this._contextKeyService=r;this._contextMenuService=s;this._keybindingService=a;this._commandService=l;let c=n?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(u=>d.publicLog2("workbenchActionExecuted",{id:u.action.id,from:c})))}_sessionDisposables=this._store.add(new ne);setActions(t,n=[],i){this._sessionDisposables.clear();let r=t.slice(),s=n.slice(),a=[],l=0,d=[],c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let u=0;u<r.length;u++){let p=r[u];!(p instanceof To)&&!(p instanceof Ml)||p.hideActions&&(a.push(p.hideActions.toggle),p.hideActions.toggle.checked&&l++,p.hideActions.isHidden&&(c=!0,r[u]=void 0,this._options?.hiddenItemStrategy!==0&&(d[u]=p)))}if(this._options?.overflowBehavior!==void 0){let u=nA(new Set(this._options.overflowBehavior.exempted),Je.map(r,f=>f?.id)),p=this._options.overflowBehavior.maxItems-u.size,h=0;for(let f=0;f<r.length;f++){let g=r[f];g&&(h++,!u.has(g.id)&&h>=p&&(r[f]=void 0,d[f]=g))}}P_(r),P_(d),super.setActions(r,Ci.join(d,s)),(a.length>0||r.length>0)&&this._sessionDisposables.add(q(this.getElement(),"contextmenu",u=>{let p=new qi(Ce(this.getElement()),u),h=this.getItemAction(p.target);if(!h)return;p.preventDefault(),p.stopPropagation();let f=[];if(h instanceof To&&h.menuKeybinding)f.push(h.menuKeybinding);else if(!(h instanceof Ml||h instanceof lg)){let b=!!this._keybindingService.lookupKeybinding(h.id);f.push(sN(this._commandService,this._keybindingService,h.id,void 0,b))}if(a.length>0){let b=!1;if(l===1&&this._options?.hiddenItemStrategy===0){b=!0;for(let v=0;v<a.length;v++)if(a[v].checked){a[v]=Si({id:h.id,label:h.label,checked:!0,enabled:!1,run(){}});break}}if(!b&&(h instanceof To||h instanceof Ml)){if(!h.hideActions)return;f.push(h.hideActions.hide)}else f.push(Si({id:"label",label:m("hide","Hide"),enabled:!1,run(){}}))}let g=Ci.join(f,a);this._options?.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(g.push(new Ci),g.push(Si({id:"resetThisMenu",label:m("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),g.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>p,getActions:()=>g,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};Hv=P([_(2,pu),_(3,St),_(4,Hl),_(5,Qn),_(6,Gi),_(7,Li)],Hv);var ug=class extends Hv{_onDidChangeMenuItems=this._store.add(new k);onDidChangeMenuItems=this._onDidChangeMenuItems.event;constructor(e,t,n,i,r,s,a,l,d){super(e,{resetMenu:t,...n},i,r,s,a,l,d);let c=this._store.add(i.createMenu(t,r,{emitEventsForSubmenuChanges:!0})),u=()=>{let p=[],h=[];C5(c,n?.menuOptions,{primary:p,secondary:h},n?.toolbarOptions?.primaryGroup,n?.toolbarOptions?.shouldInlineSubmenu,n?.toolbarOptions?.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",p.length===0&&h.length===0),super.setActions(p,h)};this._store.add(c.onDidChange(()=>{u(),this._onDidChangeMenuItems.fire(this)})),u()}setActions(){throw new $e("This toolbar is populated from a menu.")}};ug=P([_(3,pu),_(4,St),_(5,Hl),_(6,Qn),_(7,Gi),_(8,Li)],ug);var tj=Q("hoverService"),pg=class extends F{constructor(t,n,i={},r,s){super();this.placement=t;this.instantHover=n;this.overrideOptions=i;this.configurationService=r;this.hoverService=s;this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}lastHoverHideTime=0;timeLimit=200;_delay;get delay(){return this.isInstantlyHovering()?0:this._delay}hoverDisposables=this._register(new ne);showHover(t,n){let i=typeof this.overrideOptions=="function"?this.overrideOptions(t,n):this.overrideOptions;this.hoverDisposables.clear();let r=On(t.target)?[t.target]:t.target.targetElements;for(let a of r)this.hoverDisposables.add(hn(a,"keydown",l=>{l.equals(9)&&this.hoverService.hideHover()}));let s=On(t.content)?void 0:t.content.toString();return this.hoverService.showHover({...t,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:s,appearance:{...t.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},n)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}setInstantHoverTimeLimit(t){if(!this.instantHover)throw new Error("Instant hover is not enabled");this.timeLimit=t}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};pg=P([_(3,ut),_(4,tj)],pg);var aN=[],l_=35,hg=class extends F{constructor(t,n,i,r,s,a,l,d,c){super();this._diffModel=n;this._editors=i;this._options=r;this._sashLayout=s;this._boundarySashes=a;this._instantiationService=l;this._contextKeyService=d;this._menuService=c;this._register(jU(t,this.elements.root)),this._register(q(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(Kr(this.elements.root,{display:this._hasActions.map(p=>p?"block":"none")})),xr(this,p=>this._showSash.read(p)?new ag(t,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,Cp(this,f=>this._sashLayout.sashLeft.read(f)-l_,(f,g)=>this._sashLayout.sashLeft.set(f+l_,g)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store);let u=Me(this,p=>{let h=this._diffModel.read(p);if(!h)return[];let f=h.diff.read(p);if(!f)return[];let g=this._selectedDiffs.read(p);if(g.length>0){let v=mr.fromRangeMappings(g.flatMap(I=>I.rangeMappings));return[new d_(v,!0,Gt.DiffEditorSelectionToolbar,void 0,h.model.original.uri,h.model.modified.uri)]}let b=this._currentDiff.read(p);return f.mappings.map(v=>new d_(v.lineRangeMapping.withInnerChangesFromLineRanges(),v.lineRangeMapping===b?.lineRangeMapping,Gt.DiffEditorHunkToolbar,void 0,h.model.original.uri,h.model.modified.uri))});this._register(new e_(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(p,h)=>u.read(h),createView:(p,h)=>this._instantiationService.createInstance(Uv,p,h,this)})),this._register(q(this.elements.gutter,he.MOUSE_WHEEL,p=>{this._editors.modified.getOption(105).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(p)},{passive:!1}))}_menu=this._register(this._menuService.createMenu(Gt.DiffEditorHunkToolbar,this._contextKeyService));_actions=Dt(this,this._menu.onDidChange,()=>this._menu.getActions());_hasActions=this._actions.map(t=>t.length>0);_showSash=Me(this,t=>this._options.renderSideBySide.read(t)&&this._hasActions.read(t));width=Me(this,t=>this._hasActions.read(t)?l_:0);elements=vt("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:l_+"px"}},[]);computeStagedValue(t){let n=t.innerChanges??[],i=new Vv(this._editors.modifiedModel.get()),r=new Vv(this._editors.original.getModel());return new NS(n.map(l=>l.toTextEdit(i))).apply(r)}_currentDiff=Me(this,t=>{let n=this._diffModel.read(t);if(!n)return;let i=n.diff.read(t)?.mappings,r=this._editors.modifiedCursor.read(t);if(r)return i?.find(s=>s.lineRangeMapping.modified.contains(r.lineNumber))});_selectedDiffs=Me(this,t=>{let i=this._diffModel.read(t)?.diff.read(t);if(!i)return aN;let r=this._editors.modifiedSelections.read(t);if(r.every(d=>d.isEmpty()))return aN;let s=new Rr(r.map(d=>De.fromRangeInclusive(d))),l=i.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>r.some(u=>M.areIntersecting(c.modifiedRange,u)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?aN:l});layout(t){this.elements.gutter.style.left=t+"px"}};hg=P([_(6,Qe),_(7,St),_(8,pu)],hg);var d_=class{constructor(e,t,n,i,r,s){this.mapping=e;this.showAlways=t;this.menuId=n;this.rangeOverride=i;this.originalUri=r;this.modifiedUri=s}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}},Uv=class extends F{constructor(t,n,i,r){super();this._item=t;let s=this._register(r.createInstance(pg,"element",!0,{position:{hoverPosition:1}}));this._register(lp(n,this._elements.root)),this._register(ot(a=>{let l=this._showAlways.read(a);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",l),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(yi((a,l)=>{this._elements.buttons.replaceChildren();let d=l.add(r.createInstance(ug,this._elements.buttons,this._menuId.read(a),{orientation:1,hoverDelegate:s,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(a)?1:3},hiddenItemStrategy:0,actionRunner:new t_(()=>{let c=this._item.get(),u=c.mapping;return{mapping:u,originalWithModifiedChanges:i.computeStagedValue(u),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));l.add(d.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}_elements=vt("div.gutterItem",{style:{height:"20px",width:"34px"}},[vt("div.background@background",{},[]),vt("div.buttons@buttons",{},[])]);_showAlways=this._item.map(this,t=>t.showAlways);_menuId=this._item.map(this,t=>t.menuId);_isSmall=st(this,!1);_lastItemRange=void 0;_lastViewRange=void 0;layout(t,n){this._lastItemRange=t,this._lastViewRange=n;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&t.length<30,void 0),i=this._elements.buttons.clientHeight;let r=t.length/2-i/2,s=i,a=t.start+r,l=ke.tryCreate(s,n.endExclusive-s-i),d=ke.tryCreate(t.start+s,t.endExclusive-i-s);d&&l&&d.start<d.endExclusive&&(a=l.clip(a),a=d.clip(a)),this._elements.buttons.style.top=`${a-t.start}px`}};Uv=P([_(3,Qe)],Uv);var Zl=class extends F{constructor(t,n,i,r){super();this._editors=t;this._diffModel=n;this._options=i;this._instantiationService=r;this._register(this._editors.original.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();Yt(u=>{for(let p of this._editors.original.getSelections()||[])c?.ensureOriginalLineIsVisible(p.getStartPosition().lineNumber,0,u),c?.ensureOriginalLineIsVisible(p.getEndPosition().lineNumber,0,u)})})),this._register(this._editors.modified.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();Yt(u=>{for(let p of this._editors.modified.getSelections()||[])c?.ensureModifiedLineIsVisible(p.getStartPosition().lineNumber,0,u),c?.ensureModifiedLineIsVisible(p.getEndPosition().lineNumber,0,u)})}));let s=this._diffModel.map((d,c)=>{let u=d?.unchangedRegions.read(c)??[];return u.length===1&&u[0].modifiedLineNumber===1&&u[0].lineCount===this._editors.modifiedModel.read(c)?.getLineCount()?[]:u});this.viewZones=hl(this,(d,c)=>{let u=this._modifiedOutlineSource.read(d);if(!u)return{origViewZones:[],modViewZones:[]};let p=[],h=[],f=this._options.renderSideBySide.read(d),g=this._options.compactMode.read(d),b=s.read(d);for(let v=0;v<b.length;v++){let I=b[v];if(!I.shouldHideControls(d)&&!(g&&(v===0||v===b.length-1)))if(g){{let T=Me(this,C=>I.getHiddenOriginalRange(C).startLineNumber-1),S=new Za(T,12);p.push(S),c.add(new c_(this._editors.original,S,I,!f))}{let T=Me(this,C=>I.getHiddenModifiedRange(C).startLineNumber-1),S=new Za(T,12);h.push(S),c.add(new c_(this._editors.modified,S,I))}}else{{let T=Me(this,C=>I.getHiddenOriginalRange(C).startLineNumber-1),S=new Za(T,24);p.push(S),c.add(new u_(this._editors.original,S,I,I.originalUnchangedRange,!f,u,C=>this._diffModel.get().ensureModifiedLineIsVisible(C,2,void 0),this._options))}{let T=Me(this,C=>I.getHiddenModifiedRange(C).startLineNumber-1),S=new Za(T,24);h.push(S),c.add(new u_(this._editors.modified,S,I,I.modifiedUnchangedRange,!1,u,C=>this._diffModel.get().ensureModifiedLineIsVisible(C,2,void 0),this._options))}}}return{origViewZones:p,modViewZones:h}});let a={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},l={description:"Fold Unchanged",glyphMarginHoverMessage:new Ap(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(m("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+Be.asClassName(ae.fold),zIndex:10001};this._register(Xm(this._editors.original,Me(this,d=>{let c=s.read(d),u=c.map(p=>({range:p.originalUnchangedRange.toInclusiveRange(),options:a}));for(let p of c)p.shouldHideControls(d)&&u.push({range:M.fromPositions(new A(p.originalLineNumber,1)),options:l});return u}))),this._register(Xm(this._editors.modified,Me(this,d=>{let c=s.read(d),u=c.map(p=>({range:p.modifiedUnchangedRange.toInclusiveRange(),options:a}));for(let p of c)p.shouldHideControls(d)&&u.push({range:De.ofLength(p.modifiedLineNumber,1).toInclusiveRange(),options:l});return u}))),this._register(ot(d=>{let c=s.read(d);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(u=>u.getHiddenOriginalRange(d).toInclusiveRange()).filter(gl)),this._editors.modified.setHiddenAreas(c.map(u=>u.getHiddenModifiedRange(d).toInclusiveRange()).filter(gl))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,u=this._diffModel.get();if(!u)return;let p=u.unchangedRegions.get().find(h=>h.modifiedUnchangedRange.includes(c));if(!p)return;p.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,u=this._diffModel.get();if(!u)return;let p=u.unchangedRegions.get().find(h=>h.originalUnchangedRange.includes(c));if(!p)return;p.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}}))}static _breadcrumbsSourceFactory=st(Zl,()=>({dispose(){},getBreadcrumbItems(t,n){return[]}}));static setBreadcrumbsSourceFactory(t){this._breadcrumbsSourceFactory.set(t,void 0)}_modifiedOutlineSource=xr(this,t=>{let n=this._editors.modifiedModel.read(t),i=Zl._breadcrumbsSourceFactory.read(t);return!n||!i?void 0:i(n,this._instantiationService)});viewZones;_isUpdatingHiddenAreas=!1;get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}};Zl=P([_(3,Qe)],Zl);var c_=class extends sp{constructor(t,n,i,r=!1){let s=vt("div.diff-hidden-lines-widget");super(t,n,s.root);this._unchangedRegion=i;this._hide=r;s.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(ot(a=>{if(!this._hide){let l=this._unchangedRegion.getHiddenModifiedRange(a).length,d=m("hiddenLines","{0} hidden lines",l);this._nodes.text.innerText=d}}))}_nodes=vt("div.diff-hidden-lines-compact",[vt("div.line-left",[]),vt("div.text@text",[]),vt("div.line-right",[])])},u_=class extends sp{constructor(t,n,i,r,s,a,l,d){let c=vt("div.diff-hidden-lines-widget");super(t,n,c.root);this._editor=t;this._unchangedRegion=i;this._unchangedRegionRange=r;this._hide=s;this._modifiedOutlineSource=a;this._revealModifiedHiddenLine=l;this._options=d;c.root.appendChild(this._nodes.root),this._hide?Wr(this._nodes.first):this._register(Kr(this._nodes.first,{width:dp(this._editor).layoutInfoContentLeft})),this._register(ot(p=>{let h=this._unchangedRegion.visibleLineCountTop.read(p)+this._unchangedRegion.visibleLineCountBottom.read(p)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!h),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(p)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(p)>0),this._nodes.top.classList.toggle("canMoveBottom",!h);let f=this._unchangedRegion.isDragged.read(p),g=this._editor.getDomNode();g&&(g.classList.toggle("draggingUnchangedRegion",!!f),f==="top"?(g.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(p)>0),g.classList.toggle("canMoveBottom",!h)):f==="bottom"?(g.classList.toggle("canMoveTop",!h),g.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(p)>0)):(g.classList.toggle("canMoveTop",!1),g.classList.toggle("canMoveBottom",!1)))}));let u=this._editor;this._register(q(this._nodes.top,"mousedown",p=>{if(p.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),p.preventDefault();let h=p.clientY,f=!1,g=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);let b=Ce(this._nodes.top),v=q(b,"mousemove",T=>{let C=T.clientY-h;f=f||Math.abs(C)>2;let w=Math.round(C/u.getOption(68)),x=Math.max(0,Math.min(g+w,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(x,void 0)}),I=q(b,"mouseup",T=>{f||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),v.dispose(),I.dispose()})})),this._register(q(this._nodes.bottom,"mousedown",p=>{if(p.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),p.preventDefault();let h=p.clientY,f=!1,g=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);let b=Ce(this._nodes.bottom),v=q(b,"mousemove",T=>{let C=T.clientY-h;f=f||Math.abs(C)>2;let w=Math.round(C/u.getOption(68)),x=Math.max(0,Math.min(g-w,this._unchangedRegion.getMaxVisibleLineCountBottom())),D=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(x,void 0);let O=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(O-D))}),I=q(b,"mouseup",T=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!f){let S=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);let C=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(C-S))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),v.dispose(),I.dispose()})})),this._register(ot(p=>{let h=[];if(!this._hide){let f=i.getHiddenModifiedRange(p).length,g=m("hiddenLines","{0} hidden lines",f),b=Ke("span",{title:m("diff.hiddenLines.expandAll","Double click to unfold")},g);b.addEventListener("dblclick",T=>{T.button===0&&(T.preventDefault(),this._unchangedRegion.showAll(void 0))}),h.push(b);let v=this._unchangedRegion.getHiddenModifiedRange(p),I=this._modifiedOutlineSource.getBreadcrumbItems(v,p);if(I.length>0){h.push(Ke("span",void 0,"\xA0\xA0|\xA0\xA0"));for(let T=0;T<I.length;T++){let S=I[T],C=KD.toIcon(S.kind),w=vt("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[sm(C),"\xA0",S.name,...T===I.length-1?[]:[sm(ae.chevronRight)]]).root;h.push(w),w.onclick=()=>{this._revealModifiedHiddenLine(S.startLineNumber)}}}}Wr(this._nodes.others,...h)}))}_nodes=vt("div.diff-hidden-lines",[vt("div.top@top",{title:m("diff.hiddenLines.top","Click or drag to show more above")}),vt("div.center@content",{style:{display:"flex"}},[vt("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[Ke("a",{title:m("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...Nb("$(unfold)"))]),vt("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),vt("div.bottom@bottom",{title:m("diff.bottom","Click or drag to show more below"),role:"button"})])};var lN=[],p_=class extends F{constructor(t,n,i,r){super();this._editors=t;this._diffModel=n;this._options=i;this._widget=r;this._register(yi((s,a)=>{if(!this._options.shouldRenderOldRevertArrows.read(s))return;let l=this._diffModel.read(s),d=l?.diff.read(s);if(!l||!d||l.movedTextToCompare.read(s))return;let c=[],u=this._selectedDiffs.read(s),p=new Set(u.map(h=>h.mapping));if(u.length>0){let h=this._editors.modifiedSelections.read(s),f=a.add(new h_(h[h.length-1].positionLineNumber,this._widget,u.flatMap(g=>g.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}for(let h of d.mappings)if(!p.has(h)&&!h.lineRangeMapping.modified.isEmpty&&h.lineRangeMapping.innerChanges){let f=a.add(new h_(h.lineRangeMapping.modified.startLineNumber,this._widget,h.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}a.add(pe(()=>{for(let h of c)this._editors.modified.removeGlyphMarginWidget(h)}))}))}_selectedDiffs=Me(this,t=>{let i=this._diffModel.read(t)?.diff.read(t);if(!i)return lN;let r=this._editors.modifiedSelections.read(t);if(r.every(d=>d.isEmpty()))return lN;let s=new Rr(r.map(d=>De.fromRangeInclusive(d))),l=i.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>r.some(u=>M.areIntersecting(c.modifiedRange,u)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?lN:l})},h_=class o extends F{constructor(t,n,i,r){super();this._lineNumber=t;this._widget=n;this._diffs=i;this._revertSelection=r;this._register(q(this._domNode,he.MOUSE_DOWN,s=>{s.button!==2&&(s.stopPropagation(),s.preventDefault())})),this._register(q(this._domNode,he.MOUSE_UP,s=>{s.stopPropagation(),s.preventDefault()})),this._register(q(this._domNode,he.CLICK,s=>{this._diffs instanceof Yi?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),s.stopPropagation(),s.preventDefault()}))}static counter=0;_id=`revertButton${o.counter++}`;getId(){return this._id}_domNode=vt("div.revertButton",{title:this._revertSelection?m("revertSelectedChanges","Revert Selected Changes"):m("revertChange","Revert Change")},[sm(ae.arrowRight)]).root;getDomNode(){return this._domNode}getPosition(){return{lane:3,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};var m_=class o extends F{static idCounter=0;_id=++o.idCounter;_onDidDispose=this._register(new k);onDidDispose=this._onDidDispose.event;getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getStatusbarColumn(e){return this._targetEditor.getStatusbarColumn(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,n=0){this._targetEditor.revealLines(e,t,n)}revealLinesInCenter(e,t,n=0){this._targetEditor.revealLinesInCenter(e,t,n)}revealLinesInCenterIfOutsideViewport(e,t,n=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,n)}revealLinesNearTop(e,t,n=0){this._targetEditor.revealLinesNearTop(e,t,n)}revealRange(e,t=0,n=!1,i=!0){this._targetEditor.revealRange(e,t,n,i)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,n){this._targetEditor.trigger(e,t,n)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};var cp=class extends m_{constructor(t,n,i,r,s,a,l,d){super();this._domElement=t;this._parentContextKeyService=r;this._parentInstantiationService=s;this._accessibilitySignalService=l;this._editorProgressService=d;a.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(pe(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new Bx(this.elements.root,n.dimension)),this._rootSizeObserver.setAutomaticLayout(n.automaticLayout??!1),this._options=this._instantiationService.createInstance(ig,n),this._register(ot(C=>{this._options.setWidth(this._rootSizeObserver.width.read(C))})),this._contextKeyService.createKey(ge.isEmbeddedDiffEditor.key,!1),this._register(Qa(ge.isEmbeddedDiffEditor,this._contextKeyService,C=>this._options.isInEmbeddedEditor.read(C))),this._register(Qa(ge.comparingMovedCode,this._contextKeyService,C=>!!this._diffModel.read(C)?.movedTextToCompare.read(C))),this._register(Qa(ge.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,C=>this._options.couldShowInlineViewBecauseOfSize.read(C))),this._register(Qa(ge.diffEditorInlineMode,this._contextKeyService,C=>!this._options.renderSideBySide.read(C))),this._register(Qa(ge.hasChanges,this._contextKeyService,C=>(this._diffModel.read(C)?.diff.read(C)?.mappings.length??0)>0)),this._editors=this._register(this._instantiationService.createInstance(sg,this.elements.original,this.elements.modified,this._options,i,(C,w,x,D)=>this._createInnerEditor(C,w,x,D))),this._register(Qa(ge.diffEditorOriginalWritable,this._contextKeyService,C=>this._options.originalEditable.read(C))),this._register(Qa(ge.diffEditorModifiedWritable,this._contextKeyService,C=>!this._options.readOnly.read(C))),this._register(Qa(ge.diffEditorOriginalUri,this._contextKeyService,C=>this._diffModel.read(C)?.model.original.uri.toString()??"")),this._register(Qa(ge.diffEditorModifiedUri,this._contextKeyService,C=>this._diffModel.read(C)?.model.modified.uri.toString()??"")),this._overviewRulerPart=xr(this,C=>this._options.renderOverviewRuler.read(C)?this._instantiationService.createInstance(ps(vi,C),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(w=>w.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);let c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((C,w)=>C-(this._overviewRulerPart.read(w)?.width??0))};this._sashLayout=new Jx(this._options,c),this._sash=xr(this,C=>{let w=this._options.renderSideBySide.read(C);return this.elements.root.classList.toggle("side-by-side",w),w?new ag(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);let u=xr(this,C=>this._instantiationService.createInstance(ps(Zl,C),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);xr(this,C=>this._instantiationService.createInstance(ps(Xx,C),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);let p=new Set,h=new Set,f=!1,g=xr(this,C=>this._instantiationService.createInstance(ps(ng,C),Ce(this._domElement),this._editors,this._diffModel,this._options,this,()=>f||u.get().isUpdatingHiddenAreas,p,h)).recomputeInitiallyAndOnChange(this._store),b=Me(this,C=>{let w=g.read(C).viewZones.read(C).orig,x=u.read(C).viewZones.read(C).origViewZones;return w.concat(x)}),v=Me(this,C=>{let w=g.read(C).viewZones.read(C).mod,x=u.read(C).viewZones.read(C).modViewZones;return w.concat(x)});this._register(Jm(this._editors.original,b,C=>{f=C},p));let I;this._register(Jm(this._editors.modified,v,C=>{f=C,f?I=kT.capture(this._editors.modified):(I?.restore(this._editors.modified),I=void 0)},h)),this._accessibleDiffViewer=xr(this,C=>this._instantiationService.createInstance(ps(el,C),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(w,x)=>this._accessibleDiffViewerShouldBeVisible.set(w,x),this._options.onlyShowAccessibleDiffViewer.map(w=>!w),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((w,x)=>w?.diff.read(x)?.mappings.map(D=>D.lineRangeMapping)),new Zx(this._editors))).recomputeInitiallyAndOnChange(this._store);let T=this._accessibleDiffViewerVisible.map(C=>C?"hidden":"visible");this._register(Kr(this.elements.modified,{visibility:T})),this._register(Kr(this.elements.original,{visibility:T})),this._createDiffEditorContributions(),a.addDiffEditor(this),this._gutter=xr(this,C=>this._options.shouldRenderGutterMenu.read(C)?this._instantiationService.createInstance(ps(hg,C),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(Sp(this._layoutInfo)),xr(this,C=>new(ps(yc,C))(this.elements.root,this._diffModel,this._layoutInfo.map(w=>w.originalEditor),this._layoutInfo.map(w=>w.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,C=>{this._movedBlocksLinesPart.set(C,void 0)}),this._register(j.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,C=>this._handleCursorPositionChange(C,!0))),this._register(j.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,C=>this._handleCursorPositionChange(C,!1)));let S=this._diffModel.map(this,(C,w)=>{if(C)return C.diff.read(w)===void 0&&!C.isDiffUpToDate.read(w)});this._register(yi((C,w)=>{if(S.read(C)===!0){let x=this._editorProgressService.show(!0,1e3);w.add(pe(()=>x.done()))}})),this._register(yi((C,w)=>{w.add(new(ps(p_,C))(this._editors,this._diffModel,this._options,this))})),this._register(yi((C,w)=>{let x=this._diffModel.read(C);if(x)for(let D of[x.model.original,x.model.modified])w.add(D.onWillDispose(O=>{je(new $e("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(ot(C=>{this._options.setModel(this._diffModel.read(C))}))}static ENTIRE_DIFF_OVERVIEW_WIDTH=vi.ENTIRE_DIFF_OVERVIEW_WIDTH;elements=vt("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[vt("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),vt("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),vt("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]);_diffModelSrc=this._register(Q_(this,void 0));_diffModel=Me(this,t=>this._diffModelSrc.read(t)?.object);onDidChangeModel=j.fromObservableLight(this._diffModel);get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}_contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement));_instantiationService=this._register(this._parentInstantiationService.createChild(new Rp([St,this._contextKeyService])));_rootSizeObserver;_sashLayout;_sash;_boundarySashes=st(this,void 0);_accessibleDiffViewerShouldBeVisible=st(this,!1);_accessibleDiffViewerVisible=Me(this,t=>this._options.onlyShowAccessibleDiffViewer.read(t)?!0:this._accessibleDiffViewerShouldBeVisible.read(t));_accessibleDiffViewer;_options;_editors;_overviewRulerPart;_movedBlocksLinesPart=st(this,void 0);_gutter;get collapseUnchangedRegions(){return this._options.hideUnchangedRegions.get()}getViewWidth(){return this._rootSizeObserver.width.get()}getContentHeight(){return this._editors.modified.getContentHeight()}_createInnerEditor(t,n,i,r){return t.createInstance(us,n,i,r)}_layoutInfo=Me(this,t=>{let n=this._rootSizeObserver.width.read(t),i=this._rootSizeObserver.height.read(t);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=i+"px";let r=this._sash.read(t),s=this._gutter.read(t),a=s?.width.read(t)??0,l=this._overviewRulerPart.read(t)?.width??0,d,c,u,p,h;if(!!r){let g=r.sashLeft.read(t),b=this._movedBlocksLinesPart.read(t)?.width.read(t)??0;d=0,c=g-a-b,h=g-a,u=g,p=n-u-l}else{h=0;let g=this._options.inlineViewHideOriginalLineNumbers.read(t);d=a,g?c=0:c=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(t)),u=a+c,p=n-u-l}return this.elements.original.style.left=d+"px",this.elements.original.style.width=c+"px",this._editors.original.layout({width:c,height:i},!0),s?.layout(h),this.elements.modified.style.left=u+"px",this.elements.modified.style.width=p+"px",this._editors.modified.layout({width:p,height:i},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}});_createDiffEditorContributions(){let t=zu.getDiffEditorContributions();for(let n of t)try{this._register(this._instantiationService.createInstance(n.ctor,this))}catch(i){je(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return Af.IDiffEditor}onVisible(){this._editors.original.onVisible(),this._editors.modified.onVisible()}onHide(){this._editors.original.onHide(),this._editors.modified.onHide()}layout(t){this._rootSizeObserver.observe(t)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){let t=this._editors.original.saveViewState(),n=this._editors.modified.saveViewState();return{original:t,modified:n,modelState:this._diffModel.get()?.serializeState()}}restoreViewState(t){if(t&&t.original&&t.modified){let n=t;this._editors.original.restoreViewState(n.original),this._editors.modified.restoreViewState(n.modified),n.modelState&&this._diffModel.get()?.restoreSerializedState(n.modelState)}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(t){return this._instantiationService.createInstance(og,t,this._options)}getModel(){return this._diffModel.get()?.model??null}setModel(t){let n=t?"model"in t?ap.create(t).createNewRef(this):ap.create(this.createViewModel(t),this):null;this.setDiffModel(n)}setDiffModel(t,n){let i=this._diffModel.get();!t&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==t?.object&&Nc(n,r=>{let s=t?.object;Dt.batchEventsGlobally(r,()=>{this._editors.original.setModel(s?s.model.original:null),this._editors.modified.setModel(s?s.model.modified:null)});let a=this._diffModelSrc.get()?.createNewRef(this);this._diffModelSrc.set(t?.createNewRef(this),r),setTimeout(()=>{a?.dispose()},0)})}updateOptions(t){this._options.updateOptions(t)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}setBoundarySashes(t){this._boundarySashes.set(t,void 0)}_diffValue=this._diffModel.map((t,n)=>t?.diff.read(n));onDidUpdateDiff=j.fromObservableLight(this._diffValue);get ignoreTrimWhitespace(){return this._options.ignoreTrimWhitespace.get()}get maxComputationTime(){return this._options.maxComputationTimeMs.get()}get renderSideBySide(){return this._options.renderSideBySide.get()}getLineChanges(){let t=this._diffModel.get()?.diff.get();return t?nj(t):null}getDiffComputationResult(){let t=this._diffModel.get()?.diff.get();return t?{changes:this.getLineChanges(),changes2:t.mappings.map(n=>n.lineRangeMapping),identical:t.identical,quitEarly:t.quitEarly}:null}revert(t){let n=this._diffModel.get();!n||!n.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:t.modified.toExclusiveRange(),text:n.model.original.getValueInRange(t.original.toExclusiveRange())}])}revertRangeMappings(t){let n=this._diffModel.get();if(!n||!n.isDiffUpToDate.get())return;let i=t.map(r=>({range:r.modifiedRange,text:n.model.original.getValueInRange(r.originalRange)}));this._editors.modified.executeEdits("diffEditor",i)}_goTo(t){this._editors.modified.setPosition(new A(t.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(t.lineRangeMapping.modified.toExclusiveRange())}goToDiff(t){let n=this._diffModel.get()?.diff.get()?.mappings;if(!n||n.length===0)return;let i=this._editors.modified.getPosition().lineNumber,r;t==="next"?r=n.find(s=>s.lineRangeMapping.modified.startLineNumber>i)??n[0]:r=xc(n,s=>s.lineRangeMapping.modified.startLineNumber<i)??n[n.length-1],this._goTo(r),r.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(vr.diffLineDeleted,{source:"diffEditor.goToDiff"}):r.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(vr.diffLineInserted,{source:"diffEditor.goToDiff"}):r&&this._accessibilitySignalService.playSignal(vr.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){let t=this._diffModel.get();t&&this.waitForDiff().then(()=>{let n=t.diff.get()?.mappings;!n||n.length===0||this._goTo(n[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){let t=this._diffModel.get();t&&await t.waitForDiff()}mapToOtherSide(){let t=this._editors.modified.hasWidgetFocus(),n=t?this._editors.modified:this._editors.original,i=t?this._editors.original:this._editors.modified,r,s=n.getSelection();if(s){let a=this._diffModel.get()?.diff.get()?.mappings.map(l=>t?l.lineRangeMapping.flip():l.lineRangeMapping);if(a){let l=WO(s.getStartPosition(),a),d=WO(s.getEndPosition(),a);r=M.plusRange(l,d)}}return{destination:i,destinationSelection:r}}switchSide(){let{destination:t,destinationSelection:n}=this.mapToOtherSide();t.focus(),n&&t.setSelection(n)}exitCompareMove(){let t=this._diffModel.get();t&&t.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){let t=this._diffModel.get()?.unchangedRegions.get();t&&Yt(n=>{for(let i of t)i.collapseAll(n)})}showAllUnchangedRegions(){let t=this._diffModel.get()?.unchangedRegions.get();t&&Yt(n=>{for(let i of t)i.showAll(n)})}_handleCursorPositionChange(t,n){if(t?.reason===3){let i=this._diffModel.get()?.diff.get()?.mappings.find(r=>n?r.lineRangeMapping.modified.contains(t.position.lineNumber):r.lineRangeMapping.original.contains(t.position.lineNumber));i?.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(vr.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):i?.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(vr.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):i&&this._accessibilitySignalService.playSignal(vr.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};cp=P([_(3,St),_(4,Qe),_(5,qa),_(6,Vx),_(7,_W)],cp);function nj(o){return o.mappings.map(e=>{let t=e.lineRangeMapping,n,i,r,s,a=t.innerChanges;return t.original.isEmpty?(n=t.original.startLineNumber-1,i=0,a=void 0):(n=t.original.startLineNumber,i=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(r=t.modified.startLineNumber-1,s=0,a=void 0):(r=t.modified.startLineNumber,s=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:n,originalEndLineNumber:i,modifiedStartLineNumber:r,modifiedEndLineNumber:s,charChanges:a?.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var Cc=class extends uc{constructor(t,n,i,r,s,a,l,d,c,u){super(Cc.ID,t,n,i,r,s,l,a,d,c);this.preferencesService=u}static ID=cS;diffEditorControl=void 0;inputLifecycleStopWatch=void 0;get scopedContextKeyService(){if(!this.diffEditorControl)return;let t=this.diffEditorControl.getOriginalEditor(),n=this.diffEditorControl.getModifiedEditor();return(t.hasTextFocus()?t:n).invokeWithinContext(i=>i.get(St))}getTitle(){return this.input?this.input.getName():m("textDiffEditor","Text Diff Editor")}createEditorControl(t,n){this.diffEditorControl=this._register(this.instantiationService.createInstance(cp,t,n,{}))}updateEditorControlOptions(t){this.diffEditorControl?.updateOptions(t)}getMainControl(){return this.diffEditorControl?.getModifiedEditor()}_previousViewModel=null;async setInput(t,n,i,r){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),this.inputLifecycleStopWatch=void 0,await super.setInput(t,n,i,r);try{let s=await t.resolve();if(r.isCancellationRequested)return;if(!(s instanceof ym)){this.openAsBinary(t,n);return}let a=pn(this.diffEditorControl),l=s,d=l.textDiffEditorModel?a.createViewModel(l.textDiffEditorModel):null;this._previousViewModel=d,await d?.waitForDiff(),a.setModel(d);let c=!1;pb(n?.viewState)||(c=this.restoreTextDiffEditorViewState(t,n,i,a));let u=!1;n&&(u=uM(n,a,1)),!u&&!c&&a.revealFirstDiff(),a.updateOptions({...this.getReadonlyConfiguration(l.modifiedModel?.isReadonly()),originalEditable:!l.originalModel?.isReadonly()}),a.handleInitialized(),this.inputLifecycleStopWatch=new Ss(!1)}catch(s){await this.handleSetInputError(s,t,n)}}async handleSetInputError(t,n,i){if(this.isFileBinaryError(t))return this.openAsBinary(n,i);if(t.fileOperationResult===7){let r;throw t instanceof QI?r=m("fileTooLargeForHeapErrorWithSize","At least one file is not displayed in the text compare editor because it is very large ({0}).",JI.formatSize(t.size)):r=m("fileTooLargeForHeapErrorWithoutSize","At least one file is not displayed in the text compare editor because it is very large."),PW(this.group,n,i,r,this.preferencesService)}throw t}restoreTextDiffEditorViewState(t,n,i,r){let s=this.loadEditorViewState(t,i);return s?(n?.selection&&s.modified&&(s.modified.cursorState=[]),r.restoreViewState(s),n?.revealIfVisible&&r.revealFirstDiff(),!0):!1}openAsBinary(t,n){let i=t.original,r=t.modified,s=this.instantiationService.createInstance(qo,t.getName(),t.getDescription(),i,r,!0),a=lt.as(Bs.EditorFactory).getFileEditorFactory();a.isFileEditor(i)&&i.setForceOpenAsBinary(),a.isFileEditor(r)&&r.setForceOpenAsBinary(),this.group.replaceEditors([{editor:t,replacement:s,options:{...n,activation:3,pinned:this.group.isPinned(t),sticky:this.group.isSticky(t)}}])}setOptions(t){super.setOptions(t),t&&uM(t,pn(this.diffEditorControl),0)}shouldHandleConfigurationChangeEvent(t,n){return super.shouldHandleConfigurationChangeEvent(t,n)?!0:t.affectsConfiguration(n,"diffEditor")||t.affectsConfiguration(n,"accessibility.verbosity.diffEditor")}computeConfiguration(t){let n=super.computeConfiguration(t);if(bn(t.diffEditor)){let r=Sd(t.diffEditor);r.diffCodeLens=r.codeLens,delete r.codeLens,r.diffWordWrap=r.wordWrap,delete r.wordWrap,Object.assign(n,r)}let i=t.accessibility?.verbosity?.diffEditor??!1;return n.accessibilityVerbose=i,n}getConfigurationOverrides(t){return{...super.getConfigurationOverrides(t),...this.getReadonlyConfiguration(this.input?.isReadonly()),originalEditable:this.input instanceof qo&&!this.input.original.isReadonly(),lineDecorationsWidth:"2ch"}}updateReadonly(t){t instanceof qo?this.diffEditorControl?.updateOptions({...this.getReadonlyConfiguration(t.isReadonly()),originalEditable:!t.original.isReadonly()}):super.updateReadonly(t)}isFileBinaryError(t){return Array.isArray(t)?t.some(i=>this.isFileBinaryError(i)):t.textFileOperationResult===0}clearInput(){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),super.clearInput();let t=this.inputLifecycleStopWatch?.elapsed();this.inputLifecycleStopWatch=void 0,typeof t=="number"&&this.logInputLifecycleTelemetry(t,this.getControl()?.getModel()?.modified?.getLanguageId()),this.diffEditorControl?.setModel(null)}logInputLifecycleTelemetry(t,n){let i=!1;this.diffEditorControl instanceof cp&&(i=this.diffEditorControl.collapseUnchangedRegions),this.telemetryService.publicLog2("diffEditor.editorVisibleTime",{editorVisibleTimeMs:t,languageId:n??"",collapseUnchangedRegions:i})}getControl(){return this.diffEditorControl}focus(){super.focus(),this.diffEditorControl?.focus()}hasFocus(){return this.diffEditorControl?.hasTextFocus()||super.hasFocus()}setEditorVisible(t){super.setEditorVisible(t),t?this.diffEditorControl?.onVisible():this.diffEditorControl?.onHide()}layout(t){this.diffEditorControl?.layout(t)}setBoundarySashes(t){this.diffEditorControl?.setBoundarySashes(t)}tracksEditorViewState(t){return t instanceof qo}computeEditorViewState(t){if(!this.diffEditorControl)return;let n=this.diffEditorControl.getModel();if(!n||!n.modified||!n.original)return;let i=this.toEditorViewStateResource(n);if(i&&Qi(i,t))return this.diffEditorControl.saveViewState()??void 0}toEditorViewStateResource(t){let n,i;if(t instanceof qo?(n=t.original.resource,i=t.modified.resource):hi(t)||(n=t.original.uri,i=t.modified.uri),!(!n||!i))return te.from({scheme:"diff",path:`${zh(n.toString())}${zh(i.toString())}`})}};Cc=P([_(1,Li),_(2,Qe),_(3,uo),_(4,Mr),_(5,Vt),_(6,Wo),_(7,cr),_(8,Mn),_(9,MW)],Cc);function S5(o){switch(o){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function E5(o){switch(o){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function mg(o){let e=0;for(let t=0;;t+=7){let n=o.read(1);if(e|=(n.buffer[0]&127)<<t,!(n.buffer[0]&128))return e}}var ij=Sc(0);function gg(o,e){if(e===0){o.write(ij);return}let t=0;for(let i=e;i!==0;i=i>>>7)t++;let n=_n.alloc(t);for(let i=0;e!==0;i++)n.buffer[i]=e&127,e=e>>>7,e>0&&(n.buffer[i]|=128);o.write(n)}var cN=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},uN=class{buffers=[];get buffer(){return _n.concat(this.buffers)}write(e){this.buffers.push(e)}};function Sc(o){let e=_n.alloc(1);return e.writeUInt8(o,0),e}var up={Undefined:Sc(0),String:Sc(1),Buffer:Sc(2),VSBuffer:Sc(3),Array:Sc(4),Object:Sc(5),Uint:Sc(6)},oj=typeof Buffer<"u";function pN(o,e){if(typeof e>"u")o.write(up.Undefined);else if(typeof e=="string"){let t=_n.fromString(e);o.write(up.String),gg(o,t.byteLength),o.write(t)}else if(oj&&Buffer.isBuffer(e)){let t=_n.wrap(e);o.write(up.Buffer),gg(o,t.byteLength),o.write(t)}else if(e instanceof _n)o.write(up.VSBuffer),gg(o,e.byteLength),o.write(e);else if(Array.isArray(e)){o.write(up.Array),gg(o,e.length);for(let t of e)pN(o,t)}else if(typeof e=="number"&&(e|0)===e)o.write(up.Uint),gg(o,e);else{let t=_n.fromString(JSON.stringify(e));o.write(up.Object),gg(o,t.byteLength),o.write(t)}}function hN(o){switch(o.read(1).readUInt8(0)){case 0:return;case 1:return o.read(mg(o)).toString();case 2:return o.read(mg(o)).buffer;case 3:return o.read(mg(o));case 4:{let t=mg(o),n=[];for(let i=0;i<t;i++)n.push(hN(o));return n}case 5:return JSON.parse(o.read(mg(o)).toString());case 6:return mg(o)}}var dN=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(n=>this.onBuffer(n)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new k;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(n,i,r){return t.isDisposed?Promise.reject(new Bi):t.requestPromise(e,n,i,r)},listen(n,i){return t.isDisposed?j.None:t.requestEvent(e,n,i)}}}requestPromise(e,t,n,i=en.None){let r=this.lastRequestId++,a={id:r,type:100,channelName:e,name:t,arg:n};if(i.isCancellationRequested)return Promise.reject(new Bi);let l;return new Promise((c,u)=>{if(i.isCancellationRequested)return u(new Bi);let p=()=>{let b=v=>{switch(v.type){case 201:this.handlers.delete(r),c(v.data);break;case 202:{this.handlers.delete(r);let I=new Error(v.data.message);I.stack=Array.isArray(v.data.stack)?v.data.stack.join(`
`):v.data.stack,I.name=v.data.name,u(I);break}case 203:this.handlers.delete(r),u(v.data);break}};this.handlers.set(r,b),this.sendRequest(a)},h=null;this.state===1?p():(h=eu(b=>this.whenInitialized()),h.then(()=>{h=null,p()}));let f=()=>{h?(h.cancel(),h=null):this.sendRequest({id:r,type:101}),u(new Bi)},g=i.onCancellationRequested(f);l=Mo(pe(f),g),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(e,t,n){let i=this.lastRequestId++,s={id:i,type:102,channelName:e,name:t,arg:n},a=null,l=new k({onWillAddFirstListener:()=>{a=eu(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:i,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(i,d),l.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${S5(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,S5(e.type));return}}}send(e,t=void 0){let n=new uN;return pN(n,e),pN(n,t),this.sendBuffer(n.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new cN(e),n=hN(t),i=hN(t),r=n[0];switch(r){case 200:return this.logger?.logIncoming(e.byteLength,0,0,E5(r)),this.onResponse({type:n[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,n[1],0,E5(r),i),this.onResponse({type:n[0],id:n[1],data:i})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return j.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),Tt(this.activeRequests.values()),this.activeRequests.clear()}};P([me],dN.prototype,"onDidInitializePromise",1);var rj;(i=>{function o(r,s,a){let l=r,d=a&&a.disableMarshalling,c=new Map;for(let u in l)t(u)&&c.set(u,j.buffer(l[u],!0,void 0,s));return new class{listen(u,p,h){let f=c.get(p);if(f)return f;let g=l[p];if(typeof g=="function"){if(n(p))return g.call(l,h);if(t(p))return c.set(p,j.buffer(l[p],!0,void 0,s)),c.get(p)}throw new dl(`Event not found: ${p}`)}call(u,p,h){let f=l[p];if(typeof f=="function"){if(!d&&Array.isArray(h))for(let b=0;b<h.length;b++)h[b]=am(h[b]);let g=f.apply(l,h);return g instanceof Promise||(g=Promise.resolve(g)),g}throw new dl(`Method not found: ${p}`)}}}i.fromService=o;function e(r,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):n(d)?function(c){return r.listen(d,c)}:t(d)?r.listen(d):async function(...c){let u;s&&!zi(s.context)?u=[s.context,...c]:u=c;let p=await r.call(d,u);return a?p:am(p)};throw new dl(`Property not found: ${String(d)}`)}})}i.toService=e;function t(r){return r[0]==="o"&&r[1]==="n"&&pa(r.charCodeAt(2))}function n(r){return/^onDynamic/.test(r)&&pa(r.charCodeAt(9))}})(rj||={});var sj="diagnosticsService",Phn=Q(sj);var aj;(s=>{s.enableDiagnostics=!1,s.records=[];let t=new WeakMap,n=0;function i(a,l){if(!t.has(a)){let d=String(++n);t.set(a,d)}return t.get(a)}function r(a,l,d,c){}s.traceSocketEvent=r})(aj||={});var emn=Q("remoteAuthorityResolverService");var umn=Q("remoteSocketFactoryService");var lj="signService",mmn=Q(lj);var Gmn=30*1e3;var g_=Q("remoteAgentService"),ugn=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(o){let e=1/0;for(let n=0;n<this.maxSampleCount;n++){let i=await o.getRoundTripTime();if(i===void 0)return;e=Math.min(e,i/2),await wi(this.sampleDelay)}this.average.push(e),this.average.length>this.maxAverageCount&&this.average.shift();let t;return this.initial.length<this.maxInitialCount?this.initial.push(e):t=this.initial.reduce((n,i)=>n+i,0)/this.initial.length,this.lastMeasurement={initial:t,current:e,average:this.average.reduce((n,i)=>n+i,0)/this.average.length,high:typeof t>"u"?!1:e>this.highLatencyMaxThreshold||e>this.highLatencyMinThreshold&&e>t*this.highLatencyMultiple},this.lastMeasurement}};var Fgn=Object.freeze({id:"application",order:100,title:m("applicationConfigurationTitle","Application"),type:"object"}),T5=Object.freeze({id:"workbench",order:7,title:m("workbenchConfigurationTitle","Workbench"),type:"object"}),dj=Object.freeze({id:"security",scope:1,title:m("securityConfigurationTitle","Security"),type:"object",order:7}),Bgn=Object.freeze({id:"problems",title:m("problemsConfigurationTitle","Problems"),type:"object",order:101}),cj=Object.freeze({id:"window",order:8,title:m("windowConfigurationTitle","Window"),type:"object"}),uj={ConfigurationMigration:"base.contributions.configuration.migration"},mN=class{migrations=[];_onDidRegisterConfigurationMigrations=new k;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(e){this.migrations.push(...e)}},y_=new mN;lt.add(uj.ConfigurationMigration,y_);var f_=class extends F{constructor(t,n){super();this.configurationService=t;this.workspaceService=n;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(let r of i.added)await this.migrateConfigurationsForFolder(r,y_.migrations)})),this.migrateConfigurations(y_.migrations),this._register(y_.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(t){await this.migrateConfigurationsForFolder(void 0,t);for(let n of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(n,t)}async migrateConfigurationsForFolder(t,n){await Promise.all([n.map(i=>this.migrateConfigurationsForFolderAndOverride(i,t?.uri))])}async migrateConfigurationsForFolderAndOverride(t,n){let i=this.configurationService.inspect(t.key,{resource:n}),r=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of r){let l=i[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(t,s,l.value,n,void 0);for(let u of c??[])d.push([u,[]])}for(let{identifiers:c,value:u}of l.overrides??[])if(u!==void 0){let p=await this.runMigration(t,s,u,n,c);for(let h of p??[])d.push([h,c])}d.length&&await Promise.allSettled(d.map(async([[c,u],p])=>this.configurationService.updateValue(c,u.value,{resource:n,overrideIdentifiers:p},a)))}}async runMigration(t,n,i,r,s){let a=d=>{let u=this.configurationService.inspect(d,{resource:r})[n];if(u)return s?u.overrides?.find(({identifiers:p})=>Ei(p,s))?.value:u.value},l=await t.migrateFn(i,a);return Array.isArray(l)?l:[[t.key,l]]}};f_=P([_(0,ut),_(1,ba)],f_);var b_=class extends F{constructor(t){super();this.remoteAgentService=t;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new Ld;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!pt&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;lt.as(Qr.Configuration).registerConfiguration({...dj,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:m("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:m("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:m("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};b_=P([_(0,g_)],b_);var zv="window.newWindowProfile",v_=class extends F{constructor(t,n){super();this.userDataProfilesService=t;this.configurationService=n;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(i=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(n.onDidChangeConfiguration(i=>{i.source!==7&&i.affectsConfiguration(zv)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let t=lt.as(Qr.Configuration),n={...cj,properties:{[zv]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(i=>i.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(i=>""),m("active window","Active Window")],description:m("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?t.updateConfigurations({add:[n],remove:[this.configurationNode]}):t.registerConfiguration(n),this.configurationNode=n}setNewWindowProfile(){let t=this.configurationService.getValue(zv);this.newWindowProfile=t?this.userDataProfilesService.profiles.find(n=>n.name===t):void 0}checkAndResetNewWindowProfileConfig(){let t=this.configurationService.getValue(zv);if(!t)return;let n=this.newWindowProfile?this.userDataProfilesService.profiles.find(i=>i.id===this.newWindowProfile.id):void 0;t!==n?.name&&this.configurationService.updateValue(zv,n?.name)}};v_=P([_(0,yW),_(1,ut)],v_);var pj=Q("editorResolverService");var hj=lt.as(Qr.Configuration),mj={...T5,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:m("editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};hj.registerConfiguration(mj);var Bfn=new $("workbenchState",void 0,{type:"string",description:m("workbenchState","The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")}),Wfn=new $("workspaceFolderCount",0,m("workspaceFolderCount","The number of root folders in the workspace")),Vfn=new $("openFolderWorkspaceSupport",!0,!0),Hfn=new $("enterMultiRootWorkspaceSupport",!0,!0),Ufn=new $("emptyWorkspaceSupport",!0,!0),zfn=new $("dirtyWorkingCopies",!1,m("dirtyWorkingCopies","Whether there are any working copies with unsaved changes")),Kfn=new $("remoteName","",m("remoteName","The name of the remote the window is connected to or an empty string if not connected to any remote")),Gfn=new $("virtualWorkspace","",m("virtualWorkspace","The scheme of the current workspace is from a virtual file system or an empty string.")),jfn=new $("temporaryWorkspace",!1,m("temporaryWorkspace","The scheme of the current workspace is from a temporary file system.")),qfn=new $("isFullscreen",!1,m("isFullscreen","Whether the main window is in fullscreen mode")),$fn=new $("isAuxiliaryWindowFocusedContext",!1,m("isAuxiliaryWindowFocusedContext","Whether an auxiliary window is focused")),Yfn=new $("hasWebFileSystemAccess",!1,!0),Zfn=new $("embedderIdentifier",void 0,m("embedderIdentifier","The identifier of the embedder according to the product service, if one is defined")),Qfn=new $("activeEditorIsDirty",!1,m("activeEditorIsDirty","Whether the active editor has unsaved changes")),Xfn=new $("activeEditorIsNotPreview",!1,m("activeEditorIsNotPreview","Whether the active editor is not in preview mode")),Jfn=new $("activeEditorIsFirstInGroup",!1,m("activeEditorIsFirstInGroup","Whether the active editor is the first one in its group")),ebn=new $("activeEditorIsLastInGroup",!1,m("activeEditorIsLastInGroup","Whether the active editor is the last one in its group")),gj=new $("activeEditorIsPinned",!1,m("activeEditorIsPinned","Whether the active editor is pinned")),tbn=new $("activeEditorIsReadonly",!1,m("activeEditorIsReadonly","Whether the active editor is read-only")),fj=new $("activeCompareEditorCanSwap",!1,m("activeCompareEditorCanSwap","Whether the active compare editor can swap sides")),nbn=new $("activeEditorCanToggleReadonly",!0,m("activeEditorCanToggleReadonly","Whether the active editor can toggle between being read-only or writeable")),ibn=new $("activeEditorCanRevert",!1,m("activeEditorCanRevert","Whether the active editor can revert")),bj=new $("activeEditorCanSplitInGroup",!0),w5=new $("activeEditor",null,{type:"string",description:m("activeEditor","The identifier of the active editor")}),obn=new $("activeEditorAvailableEditorIds","",m("activeEditorAvailableEditorIds","The available editor identifiers that are usable for the active editor")),vj=new $("textCompareEditorVisible",!1,m("textCompareEditorVisible","Whether a text compare editor is visible")),x5=new $("textCompareEditorActive",!1,m("textCompareEditorActive","Whether a text compare editor is active")),yj=new $("sideBySideEditorActive",!1,m("sideBySideEditorActive","Whether a side by side editor is active")),rbn=new $("groupEditorsCount",0,m("groupEditorsCount","The number of opened editor groups")),Ij=new $("activeEditorGroupEmpty",!1,m("activeEditorGroupEmpty","Whether the active editor group is empty")),sbn=new $("activeEditorGroupIndex",0,m("activeEditorGroupIndex","The index of the active editor group")),abn=new $("activeEditorGroupLast",!1,m("activeEditorGroupLast","Whether the active editor group is the last group")),Cj=new $("activeEditorGroupLocked",!1,m("activeEditorGroupLocked","Whether the active editor group is locked")),_5=new $("multipleEditorGroups",!1,m("multipleEditorGroups","Whether there are multiple editor groups opened")),lbn=_5.toNegated(),dbn=new $("multipleEditorsSelectedInGroup",!1,m("multipleEditorsSelectedInGroup","Whether multiple editors have been selected in an editor group")),cbn=new $("twoEditorsSelectedInGroup",!1,m("twoEditorsSelectedInGroup","Whether exactly two editors have been selected in an editor group")),ubn=new $("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,m("SelectedEditorsInGroupFileOrUntitledResourceContextKey","Whether all selected editors in a group have a file or untitled resource associated")),Sj=new $("editorPartMultipleEditorGroups",!1,m("editorPartMultipleEditorGroups","Whether there are multiple editor groups opened in an editor part")),pbn=Sj.toNegated(),hbn=new $("editorPartMaximizedEditorGroup",!1,m("editorPartEditorGroupMaximized","Editor Part has a maximized group")),mbn=new $("isAuxiliaryEditorPart",!1,m("isAuxiliaryEditorPart","Editor Part is in an auxiliary window")),gbn=new $("editorIsOpen",!1,m("editorIsOpen","Whether an editor is open")),fbn=new $("inZenMode",!1,m("inZenMode","Whether Zen mode is enabled")),bbn=new $("isCenteredLayout",!1,m("isMainEditorCenteredLayout","Whether centered layout is enabled for the main editor")),vbn=new $("splitEditorsVertically",!1,m("splitEditorsVertically","Whether editors split vertically")),ybn=new $("mainEditorAreaVisible",!0,m("mainEditorAreaVisible","Whether the editor area in the main window is visible")),Ibn=new $("editorTabsVisible",!0,m("editorTabsVisible","Whether editor tabs are visible")),Cbn=new $("sideBarVisible",!1,m("sideBarVisible","Whether the sidebar is visible")),Sbn=new $("sideBarFocus",!1,m("sideBarFocus","Whether the sidebar has keyboard focus")),Ebn=new $("activeViewlet","",m("activeViewlet","The identifier of the active viewlet")),Tbn=new $("statusBarFocused",!1,m("statusBarFocused","Whether the status bar has keyboard focus")),wbn=new $("titleBarStyle",Wt?"native":"custom",m("titleBarStyle","Style of the window title bar")),xbn=new $("titleBarVisible",!1,m("titleBarVisible","Whether the title bar is visible")),_bn=new $("bannerFocused",!1,m("bannerFocused","Whether the banner has keyboard focus")),Lbn=new $("notificationFocus",!0,m("notificationFocus","Whether a notification has keyboard focus")),Dbn=new $("notificationCenterVisible",!1,m("notificationCenterVisible","Whether the notifications center is visible")),kbn=new $("notificationToastsVisible",!1,m("notificationToastsVisible","Whether a notification toast is visible")),Rbn=new $("activeAuxiliary","",m("activeAuxiliary","The identifier of the active auxiliary panel")),Mbn=new $("auxiliaryBarFocus",!1,m("auxiliaryBarFocus","Whether the auxiliary bar has keyboard focus")),Obn=new $("auxiliaryBarVisible",!1,m("auxiliaryBarVisible","Whether the auxiliary bar is visible")),Nbn=new $("activePanel","",m("activePanel","The identifier of the active panel")),Abn=new $("panelFocus",!1,m("panelFocus","Whether the panel has keyboard focus")),Pbn=new $("panelPosition","bottom",m("panelPosition","The position of the panel, always 'bottom'")),Fbn=new $("panelAlignment","center",m("panelAlignment","The alignment of the panel, either 'center', 'left', 'right' or 'justify'")),Bbn=new $("panelVisible",!1,m("panelVisible","Whether the panel is visible")),Wbn=new $("panelMaximized",!1,m("panelMaximized","Whether the panel is maximized")),Vbn=new $("focusedView","",m("focusedView","The identifier of the view that has keyboard focus"));var Do=class{constructor(e,t,n,i){this._contextKeyService=e;this._fileService=t;this._languageService=n;this._modelService=i;this._schemeKey=Do.Scheme.bindTo(this._contextKeyService),this._filenameKey=Do.Filename.bindTo(this._contextKeyService),this._dirnameKey=Do.Dirname.bindTo(this._contextKeyService),this._pathKey=Do.Path.bindTo(this._contextKeyService),this._langIdKey=Do.LangId.bindTo(this._contextKeyService),this._resourceKey=Do.Resource.bindTo(this._contextKeyService),this._extensionKey=Do.Extension.bindTo(this._contextKeyService),this._hasResource=Do.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=Do.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(t.onDidChangeFileSystemProviderRegistrations(()=>{let r=this.get();this._isFileSystemResource.set(!!(r&&t.hasProvider(r)))})),this._disposables.add(i.onModelAdded(r=>{Qi(r.uri,this.get())&&this._setLangId()})),this._disposables.add(i.onModelLanguageChanged(r=>{Qi(r.model.uri,this.get())&&this._setLangId()}))}static Scheme=new $("resourceScheme",void 0,{type:"string",description:m("resourceScheme","The scheme of the resource")});static Filename=new $("resourceFilename",void 0,{type:"string",description:m("resourceFilename","The file name of the resource")});static Dirname=new $("resourceDirname",void 0,{type:"string",description:m("resourceDirname","The folder name the resource is contained in")});static Path=new $("resourcePath",void 0,{type:"string",description:m("resourcePath","The full path of the resource")});static LangId=new $("resourceLangId",void 0,{type:"string",description:m("resourceLangId","The language identifier of the resource")});static Resource=new $("resource",void 0,{type:"URI",description:m("resource","The full value of the resource including scheme and path")});static Extension=new $("resourceExtname",void 0,{type:"string",description:m("resourceExtname","The extension name of the resource")});static HasResource=new $("resourceSet",void 0,{type:"boolean",description:m("resourceSet","Whether a resource is present or not")});static IsFileSystemResource=new $("isFileSystemResource",void 0,{type:"boolean",description:m("isFileSystemResource","Whether the resource is backed by a file system provider")});_disposables=new ne;_value;_resourceKey;_schemeKey;_filenameKey;_dirnameKey;_pathKey;_langIdKey;_extensionKey;_hasResource;_isFileSystemResource;dispose(){this._disposables.dispose()}_setLangId(){let e=this.get();if(!e){this._langIdKey.set(null);return}let t=this._modelService.getModel(e)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(e);this._langIdKey.set(t)}set(e){e=e??void 0,!Qi(this._value,e)&&(this._value=e,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(e?e.toString():null),this._schemeKey.set(e?e.scheme:null),this._filenameKey.set(e?Jo(e):null),this._dirnameKey.set(e?this.uriToPath(Op(e)):null),this._pathKey.set(e?this.uriToPath(e):null),this._setLangId(),this._extensionKey.set(e?Fy(e):null),this._hasResource.set(!!e),this._isFileSystemResource.set(e?this._fileService.hasProvider(e):!1)}))}uriToPath(e){return e.scheme===xe.file?e.fsPath:e.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}};Do=P([_(0,St),_(1,Mn),_(2,$n),_(3,ar)],Do);function L5(o){return o.scheme!==xe.file&&o.scheme!==xe.vscodeRemote}function D5(o){if(o.folders.length)return o.folders.every(e=>L5(e.uri))?o.folders[0].uri:void 0;if(o.configuration&&L5(o.configuration))return o.configuration}function k5(o){return D5(o)?.scheme}function R5(o){return D5(o)?.authority}var Kv=Q("pathService"),fg=class{constructor(e,t,n,i){this.localUserHome=e;this.remoteAgentService=t;this.environmentService=n;this.contextService=i;this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||$r)(),this.resolveUserHome=(async()=>{let r=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=r?.userHome??e})()}resolveOS;resolveUserHome;maybeUnresolvedUserHome;hasValidBasename(e,t,n){return typeof t=="string"||typeof t>"u"?this.resolveOS.then(i=>this.doHasValidBasename(e,i,t)):this.doHasValidBasename(e,t,n)}doHasValidBasename(e,t,n){return e.scheme===xe.file||e.scheme===xe.vscodeRemote?nP(n??Jo(e),t===1):!0}get defaultUriScheme(){return fg.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(e,t){if(e.remoteAuthority)return xe.vscodeRemote;let n=k5(t.getWorkspace());if(n)return n;let i=t.getWorkspace().folders[0];if(i)return i.uri.scheme;let r=t.getWorkspace().configuration;return r?r.scheme:xe.file}userHome(e){return e?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(e=>e===1?Cn:bt)}async fileURI(e){let t="";if(await this.resolveOS===1&&(e=e.replace(/\\/g,"/")),e[0]==="/"&&e[1]==="/"){let i=e.indexOf("/",2);i===-1?(t=e.substring(2),e="/"):(t=e.substring(2,i),e=e.substring(i)||"/")}return te.from({scheme:xe.file,authority:t,path:e,query:"",fragment:""})}};fg=P([_(1,g_),_(2,zl),_(3,ba)],fg);var pp="_workbench.diff";var yr=class o{constructor(e){this.fileService=e}static SCHEMA="vscode-local-history";static toLocalHistoryFileSystem(e){let t={location:e.location.toString(!0),associatedResource:e.associatedResource.toString(!0)};return e.associatedResource.with({scheme:o.SCHEMA,query:JSON.stringify(t)})}static fromLocalHistoryFileSystem(e){let t=JSON.parse(e.query);return{location:te.parse(t.location),associatedResource:te.parse(t.associatedResource)}}static EMPTY_RESOURCE=te.from({scheme:o.SCHEMA,path:"/empty"});static EMPTY={location:o.EMPTY_RESOURCE,associatedResource:o.EMPTY_RESOURCE};get capabilities(){return 2050}mapSchemeToProvider=new Map;async withProvider(e){let t=e.scheme,n=this.mapSchemeToProvider.get(t);if(!n){let i=this.fileService.getProvider(t);i?n=Promise.resolve(i):n=new Promise(r=>{let s=this.fileService.onDidChangeFileSystemProviderRegistrations(a=>{a.added&&a.provider&&a.scheme===t&&(s.dispose(),r(a.provider))})}),this.mapSchemeToProvider.set(t,n)}return n}async stat(e){let t=o.fromLocalHistoryFileSystem(e).location;return Qi(o.EMPTY_RESOURCE,t)?{type:1,ctime:0,mtime:0,size:0}:(await this.withProvider(t)).stat(t)}async readFile(e){let t=o.fromLocalHistoryFileSystem(e).location;if(Qi(o.EMPTY_RESOURCE,t))return _n.fromString("").buffer;let n=await this.withProvider(t);if(mF(n))return n.readFile(t);throw new Error("Unsupported")}onDidChangeCapabilities=j.None;onDidChangeFile=j.None;async writeFile(e,t,n){}async mkdir(e){}async readdir(e){return[]}async rename(e,t,n){}async delete(e,t){}watch(e,t){return F.None}};var gN;function I_(){if(!gN){let o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},e;try{e=new Intl.DateTimeFormat(jr,o)}catch{e=new Intl.DateTimeFormat(void 0,o)}gN={format:t=>e.format(t)}}return gN}var fN="localHistory:item",Ql=Ct.equals("timelineItem",fN),M5=Or("localHistory-icon",ae.circleOutline,m("localHistoryIcon","Icon for a local history entry in the timeline view.")),O5=Or("localHistory-restore",ae.check,m("localHistoryRestore","Icon for restoring contents of a local history entry."));var N5=Q("historyService");var vN=kn("localHistory.category","Local History"),C_=Ct.has("config.workbench.localHistory.enabled"),yN=kn("localHistory.compareWithFile","Compare with File");dr(class extends io{constructor(){super({id:"workbench.action.localHistory.compareWithFile",title:yN,menu:{id:Gt.TimelineItemContext,group:"1_compare",order:1,when:Ql}})}async run(o,e){let t=o.get(Gi),n=o.get(ur),{entry:i}=await Xl(n,e);if(i)return t.executeCommand(pp,...vg(i,i.workingCopy.resource))}});dr(class extends io{constructor(){super({id:"workbench.action.localHistory.compareWithPrevious",title:kn("localHistory.compareWithPrevious","Compare with Previous"),menu:{id:Gt.TimelineItemContext,group:"1_compare",order:2,when:Ql}})}async run(o,e){let t=o.get(Gi),n=o.get(ur),i=o.get(Vt),{entry:r,previous:s}=await Xl(n,e);if(r)return s?t.executeCommand(pp,...vg(s,r)):IN(r,i)}});var bN,A5=new $("localHistoryItemSelectedForCompare",!1,!0);dr(class extends io{constructor(){super({id:"workbench.action.localHistory.selectForCompare",title:kn("localHistory.selectForCompare","Select for Compare"),menu:{id:Gt.TimelineItemContext,group:"2_compare_with",order:2,when:Ql}})}async run(o,e){let t=o.get(ur),n=o.get(St),{entry:i}=await Xl(t,e);i&&(bN=e,A5.bindTo(n).set(!0))}});dr(class extends io{constructor(){super({id:"workbench.action.localHistory.compareWithSelected",title:kn("localHistory.compareWithSelected","Compare with Selected"),menu:{id:Gt.TimelineItemContext,group:"2_compare_with",order:1,when:Ct.and(Ql,A5)}})}async run(o,e){let t=o.get(ur),n=o.get(Gi);if(!bN)return;let i=(await Xl(t,bN)).entry;if(!i)return;let{entry:r}=await Xl(t,e);if(r)return n.executeCommand(pp,...vg(i,r))}});dr(class extends io{constructor(){super({id:"workbench.action.localHistory.open",title:kn("localHistory.open","Show Contents"),menu:{id:Gt.TimelineItemContext,group:"3_contents",order:1,when:Ql}})}async run(o,e){let t=o.get(ur),n=o.get(Vt),{entry:i}=await Xl(t,e);if(i)return IN(i,n)}});var P5=kn("localHistory.restore","Restore Contents");dr(class extends io{constructor(){super({id:"workbench.action.localHistory.restoreViaEditor",title:P5,menu:{id:Gt.EditorTitle,group:"navigation",order:-10,when:Do.Scheme.isEqualTo(yr.SCHEMA)},icon:O5})}async run(o,e){let{associatedResource:t,location:n}=yr.fromLocalHistoryFileSystem(e);return F5(o,{uri:t,handle:Py(n)})}});dr(class extends io{constructor(){super({id:"workbench.action.localHistory.restore",title:P5,menu:{id:Gt.TimelineItemContext,group:"3_contents",order:2,when:Ql}})}async run(o,e){return F5(o,e)}});var wj=Vs.registerSource("localHistoryRestore.source",m("localHistoryRestore.source","File Restored"));async function F5(o,e){let t=o.get(Mn),n=o.get(Dl),i=o.get(Ma),r=o.get(ur),s=o.get(Vt),{entry:a}=await Xl(r,e);if(a){let{confirmed:l}=await n.confirm({type:"warning",message:m("confirmRestoreMessage","Do you want to restore the contents of '{0}'?",Jo(a.workingCopy.resource)),detail:m("confirmRestoreDetail","Restoring will discard any unsaved changes."),primaryButton:m({key:"restoreButtonLabel",comment:["&& denotes a mnemonic"]},"&&Restore")});if(!l)return;let d=i.getAll(a.workingCopy.resource);if(d)for(let c of d)c.isDirty()&&await c.revert({soft:!0});try{await t.cloneFile(a.location,a.workingCopy.resource)}catch(c){await n.error(m("unableToRestore","Unable to restore '{0}'.",Jo(a.workingCopy.resource)),kp(c));return}if(d)for(let c of d)await c.revert({force:!0});await s.openEditor({resource:a.workingCopy.resource}),await r.addEntry({resource:a.workingCopy.resource,source:wj},en.None),await B5(a,s)}}dr(class extends io{constructor(){super({id:"workbench.action.localHistory.restoreViaPicker",title:kn("localHistory.restoreViaPicker","Find Entry to Restore"),f1:!0,category:vN,precondition:C_})}async run(o){let e=o.get(ur),t=o.get(Gb),n=o.get(ar),i=o.get($n),r=o.get(du),s=o.get(Vt),a=o.get(Mn),l=o.get(Gi),d=o.get(N5),c=new ne,u=c.add(t.createQuickPick()),p=new Rn;c.add(u.onDidHide(()=>p.dispose(!0))),u.busy=!0,u.show();let h=new Lc(await e.getAll(p.token)),f=new Lc(Ro(d.getHistory().map(({resource:S})=>S))),g=[];for(let S of f)h.has(S)&&(g.push(S),h.delete(S));g.push(...[...h].sort((S,C)=>S.fsPath<C.fsPath?-1:1)),u.busy=!1,u.placeholder=m("restoreViaPicker.filePlaceholder","Select the file to show local history for"),u.matchOnLabel=!0,u.matchOnDescription=!0,u.items=[...g].map(S=>({resource:S,label:Py(S),description:r.getUriLabel(Op(S),{relative:!0}),iconClasses:fT(n,i,S)})),await j.toPromise(u.onDidAccept),c.dispose();let b=u.selectedItems.at(0)?.resource;if(!b)return;let v=new ne,I=v.add(t.createQuickPick());p=new Rn,v.add(I.onDidHide(()=>p.dispose(!0))),I.busy=!0,I.show();let T=await e.getEntries(b,p.token);I.busy=!1,I.canAcceptInBackground=!0,I.placeholder=m("restoreViaPicker.entryPlaceholder","Select the local history entry to open"),I.matchOnLabel=!0,I.matchOnDescription=!0,I.items=Array.from(T).reverse().map(S=>({entry:S,label:`$(circle-outline) ${Vs.getSourceLabel(S.source)}`,description:bg(S.timestamp)})),v.add(I.onDidAccept(async S=>{S.inBackground||v.dispose();let C=I.selectedItems.at(0);return C?await a.exists(C.entry.workingCopy.resource)?l.executeCommand(pp,...vg(C.entry,C.entry.workingCopy.resource,{preserveFocus:S.inBackground})):IN(C.entry,s,{preserveFocus:S.inBackground}):void 0}))}});Ar.appendMenuItem(Gt.TimelineTitle,{command:{id:"workbench.action.localHistory.restoreViaPicker",title:kn("localHistory.restoreViaPickerMenu","Local History: Find Entry to Restore...")},group:"submenu",order:1,when:C_});dr(class extends io{constructor(){super({id:"workbench.action.localHistory.rename",title:kn("localHistory.rename","Rename"),menu:{id:Gt.TimelineItemContext,group:"5_edit",order:1,when:Ql}})}async run(o,e){let t=o.get(ur),n=o.get(Gb),{entry:i}=await Xl(t,e);if(i){let r=new ne,s=r.add(n.createInputBox());s.title=m("renameLocalHistoryEntryTitle","Rename Local History Entry"),s.ignoreFocusOut=!0,s.placeholder=m("renameLocalHistoryPlaceholder","Enter the new name of the local history entry"),s.value=Vs.getSourceLabel(i.source),s.show(),r.add(s.onDidAccept(()=>{s.value&&t.updateEntry(i,{source:s.value},en.None),r.dispose()}))}}});dr(class extends io{constructor(){super({id:"workbench.action.localHistory.delete",title:kn("localHistory.delete","Delete"),menu:{id:Gt.TimelineItemContext,group:"5_edit",order:2,when:Ql}})}async run(o,e){let t=o.get(ur),n=o.get(Vt),i=o.get(Dl),{entry:r}=await Xl(t,e);if(r){let{confirmed:s}=await i.confirm({type:"warning",message:m("confirmDeleteMessage","Do you want to delete the local history entry of '{0}' from {1}?",r.workingCopy.name,bg(r.timestamp)),detail:m("confirmDeleteDetail","This action is irreversible!"),primaryButton:m({key:"deleteButtonLabel",comment:["&& denotes a mnemonic"]},"&&Delete")});if(!s)return;await t.removeEntry(r,en.None),await B5(r,n)}}});dr(class extends io{constructor(){super({id:"workbench.action.localHistory.deleteAll",title:kn("localHistory.deleteAll","Delete All"),f1:!0,category:vN,precondition:C_})}async run(o){let e=o.get(Dl),t=o.get(ur),{confirmed:n}=await e.confirm({type:"warning",message:m("confirmDeleteAllMessage","Do you want to delete all entries of all files in local history?"),detail:m("confirmDeleteAllDetail","This action is irreversible!"),primaryButton:m({key:"deleteAllButtonLabel",comment:["&& denotes a mnemonic"]},"&&Delete All")});n&&await t.removeAll(en.None)}});dr(class extends io{constructor(){super({id:"workbench.action.localHistory.create",title:kn("localHistory.create","Create Entry"),f1:!0,category:vN,precondition:Ct.and(C_,w5)})}async run(o){let e=o.get(ur),t=o.get(Gb),n=o.get(Vt),i=o.get(du),r=o.get(Kv),s=Nr.getOriginalUri(n.activeEditor,{supportSideBySide:1});if(s?.scheme!==r.defaultUriScheme&&s?.scheme!==xe.vscodeUserData)return;let a=new ne,l=a.add(t.createInputBox());l.title=m("createLocalHistoryEntryTitle","Create Local History Entry"),l.ignoreFocusOut=!0,l.placeholder=m("createLocalHistoryPlaceholder","Enter the new name of the local history entry for '{0}'",i.getUriBasenameLabel(s)),l.show(),a.add(l.onDidAccept(async()=>{let d=l.value;a.dispose(),d&&await e.addEntry({resource:s,source:l.value},en.None)}))}});async function IN(o,e,t){let n=yr.toLocalHistoryFileSystem({location:o.location,associatedResource:o.workingCopy.resource});await e.openEditor({resource:n,label:m("localHistoryEditorLabel","{0} ({1} \u2022 {2})",o.workingCopy.name,Vs.getSourceLabel(o.source),bg(o.timestamp)),options:t})}async function B5(o,e){let t=yr.toLocalHistoryFileSystem({location:o.location,associatedResource:o.workingCopy.resource}),n=e.findEditors(t,{supportSideBySide:4});await e.closeEditors(n,{preserveFocus:!0})}function vg(o,e,t){let n=yr.toLocalHistoryFileSystem({location:o.location,associatedResource:o.workingCopy.resource}),i,r;if(te.isUri(e))r=e,i=m("localHistoryCompareToFileEditorLabel","{0} ({1} \u2022 {2}) \u2194 {3}",o.workingCopy.name,Vs.getSourceLabel(o.source),bg(o.timestamp),o.workingCopy.name);else{let s=e;r=yr.toLocalHistoryFileSystem({location:s.location,associatedResource:s.workingCopy.resource}),i=m("localHistoryCompareToPreviousEditorLabel","{0} ({1} \u2022 {2}) \u2194 {3} ({4} \u2022 {5})",o.workingCopy.name,Vs.getSourceLabel(o.source),bg(o.timestamp),s.workingCopy.name,Vs.getSourceLabel(s.source),bg(s.timestamp))}return[n,r,i,t?[void 0,t]:void 0]}async function Xl(o,e){let t=await o.getEntries(e.uri,en.None),n,i;for(let r=0;r<t.length;r++){let s=t[r];if(s.id===e.handle){n=s,i=t[r-1];break}}return{entry:n,previous:i}}var xj=/\//g;function bg(o){return`${I_().format(o).replace(xj,"-")}`}var _j="timeline",W5=Q(_j);var nl=class extends F{constructor(t,n,i,r,s,a,l){super();this.timelineService=t;this.workingCopyHistoryService=n;this.pathService=i;this.fileService=r;this.environmentService=s;this.configurationService=a;this.contextService=l;this.registerComponents(),this.registerListeners()}static ID="workbench.contrib.localHistoryTimeline";static LOCAL_HISTORY_ENABLED_SETTINGS_KEY="workbench.localHistory.enabled";id="timeline.localHistory";label=m("localHistory","Local History");scheme="*";_onDidChange=this._register(new k);onDidChange=this._onDidChange.event;timelineProviderDisposable=this._register(new on);registerComponents(){this.updateTimelineRegistration(),this._register(this.fileService.registerProvider(yr.SCHEMA,new yr(this.fileService)))}updateTimelineRegistration(){this.configurationService.getValue(nl.LOCAL_HISTORY_ENABLED_SETTINGS_KEY)?this.timelineProviderDisposable.value=this.timelineService.registerTimelineProvider(this):this.timelineProviderDisposable.clear()}registerListeners(){this._register(this.workingCopyHistoryService.onDidAddEntry(t=>this.onDidChangeWorkingCopyHistoryEntry(t.entry))),this._register(this.workingCopyHistoryService.onDidChangeEntry(t=>this.onDidChangeWorkingCopyHistoryEntry(t.entry))),this._register(this.workingCopyHistoryService.onDidReplaceEntry(t=>this.onDidChangeWorkingCopyHistoryEntry(t.entry))),this._register(this.workingCopyHistoryService.onDidRemoveEntry(t=>this.onDidChangeWorkingCopyHistoryEntry(t.entry))),this._register(this.workingCopyHistoryService.onDidRemoveEntries(()=>this.onDidChangeWorkingCopyHistoryEntry(void 0))),this._register(this.workingCopyHistoryService.onDidMoveEntries(()=>this.onDidChangeWorkingCopyHistoryEntry(void 0))),this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(nl.LOCAL_HISTORY_ENABLED_SETTINGS_KEY)&&this.updateTimelineRegistration()}))}onDidChangeWorkingCopyHistoryEntry(t){this._onDidChange.fire({id:this.id,uri:t?.workingCopy.resource,reset:!0})}async provideTimeline(t,n,i){let r=[],s;if(t.scheme===yr.SCHEMA?s=yr.fromLocalHistoryFileSystem(t).associatedResource:t.scheme===this.pathService.defaultUriScheme||t.scheme===xe.vscodeUserData?s=t:this.fileService.hasProvider(t)&&(s=te.from({scheme:this.pathService.defaultUriScheme,authority:this.environmentService.remoteAuthority??R5(this.contextService.getWorkspace()),path:t.path})),s){let a=await this.workingCopyHistoryService.getEntries(s,i);for(let l of a)r.push(this.toTimelineItem(l))}return{source:this.id,items:r}}toTimelineItem(t){return{handle:t.id,label:Vs.getSourceLabel(t.source),tooltip:new Ap(`$(history) ${I_().format(t.timestamp)}

${Vs.getSourceLabel(t.source)}${t.sourceDescription?` (${t.sourceDescription})`:""}`,{supportThemeIcons:!0}),source:this.id,timestamp:t.timestamp,themeIcon:M5,contextValue:fN,command:{id:pp,title:yN.value,arguments:vg(t,t.workingCopy.resource)}}}};nl=P([_(0,W5),_(1,ur),_(2,Kv),_(3,Mn),_(4,zl),_(5,ut),_(6,ba)],nl);$H(nl.ID,nl,Kl.BlockRestore);
