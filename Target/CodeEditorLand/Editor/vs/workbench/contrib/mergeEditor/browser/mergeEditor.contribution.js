var OW=Object.defineProperty;var PW=Object.getOwnPropertyDescriptor;var k=(o,e,t,n)=>{for(var i=n>1?void 0:n?PW(e,t):e,r=o.length-1,s;r>=0;r--)(s=o[r])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&OW(e,t,i),i},E=(o,e)=>(t,n)=>e(t,n,o);function h_(){return globalThis._VSCODE_NLS_MESSAGES}function tg(){return globalThis._VSCODE_NLS_LANGUAGE}var FW=tg()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function yv(o,e){let t;return e.length===0?t=o:t=o.replace(/\{(\d+)\}/g,(n,i)=>{let r=i[0],s=e[r],a=n;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),FW&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function p(o,e,...t){return yv(typeof o=="number"?TM(o,e):e,t)}function TM(o,e){let t=h_()?.[o];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${o} !!!`)}return t}function Tt(o,e,...t){let n;typeof o=="number"?n=TM(o,e):n=e;let i=yv(n,t);return{value:i,original:e===n?i:yv(e,t)}}function Yl(o,e){let t=BW(o,e);if(t!==-1)return o[t]}function BW(o,e,t=o.length-1){for(let n=t;n>=0;n--){let i=o[n];if(e(i))return n}return-1}function p_(o,e){let t=ng(o,e);return t===-1?void 0:o[t]}function ng(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?i=s+1:r=s}return i-1}function Yu(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?r=s:i=s+1}return i}function VW(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>0&&(t=i)}return t}function LM(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>=0&&(t=i)}return t}function DM(o,e){return VW(o,(t,n)=>-e(t,n))}var m_=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?ja.isErrorNoTelemetry(e)?new ja(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},f_=new m_;function Zu(o){f_.onUnexpectedError(o)}function Ne(o){b_(o)||f_.onUnexpectedError(o)}function Xu(o){b_(o)||f_.onUnexpectedExternalError(o)}var g_="Canceled";function b_(o){return o instanceof Ui?!0:o instanceof Error&&o.name===g_&&o.message===g_}var Ui=class extends Error{constructor(){super(g_),this.name=this.message}};function as(o){return o?new Error(`Illegal argument: ${o}`):new Error("Illegal argument")}function RM(o){return o?new Error(`Illegal state: ${o}`):new Error("Illegal state")}var Iv=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}};var ja=class o extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof o)return e;let t=new o;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Te=class o extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,o.prototype)}};function Eo(o,e=0){return o[o.length-(1+e)]}function cn(o){if(o.length===0)throw new Error("Invalid tail call");return[o.slice(0,o.length-1),o[o.length-1]]}function Lt(o,e,t=(n,i)=>n===i){if(o===e)return!0;if(!o||!e||o.length!==e.length)return!1;for(let n=0,i=o.length;n<i;n++)if(!t(o[n],e[n]))return!1;return!0}function kM(o,e){let t=o.length-1;e<t&&(o[e]=o[t]),o.pop()}function MM(o,e,t){return HW(o.length,n=>t(o[n],e))}function HW(o,e){let t=0,n=o-1;for(;t<=n;){let i=(t+n)/2|0,r=e(i);if(r<0)t=i+1;else if(r>0)n=i-1;else return i}return-(t+1)}function vr(o){return o.filter(e=>!!e)}function v_(o){let e=0;for(let t=0;t<o.length;t++)o[t]&&(o[e]=o[t],e+=1);o.length=e}function qa(o,e=t=>t){let t=new Set;return o.filter(n=>{let i=e(n);return t.has(i)?!1:(t.add(i),!0)})}function zi(o,e){let t=typeof e=="number"?o:0;typeof e=="number"?t=o:(t=0,e=o);let n=[];if(t<=e)for(let i=t;i<e;i++)n.push(i);else for(let i=t;i>e;i--)n.push(i);return n}function Cv(o,e){return o.push(e),()=>UW(o,e)}function UW(o,e){let t=o.indexOf(e);if(t>-1)return o.splice(t,1),e}function js(o,e,t){let n=o.slice(0,e),i=o.slice(e);return n.concat(t,i)}function Sv(o,e){let t=o.indexOf(e);t>-1&&(o.splice(t,1),o.unshift(e))}function ig(o,e){let t=o.indexOf(e);t>-1&&(o.splice(t,1),o.push(e))}function y_(o,e){for(let t of e)o.push(t)}var xo;(a=>{function o(l){return l<0}a.isLessThan=o;function e(l){return l<=0}a.isLessThanOrEqual=e;function t(l){return l>0}a.isGreaterThan=t;function n(l){return l===0}a.isNeitherLessOrGreaterThan=n,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(xo||={});function ui(o,e){return(t,n)=>e(o(t),o(n))}function NM(...o){return(e,t)=>{for(let n of o){let i=n(e,t);if(!xo.isNeitherLessOrGreaterThan(i))return i}return xo.neitherLessOrGreaterThan}}var Ya=(o,e)=>o-e;var Li=class{constructor(e){this.items=e}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let n=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,n}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let n=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,n}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},$a=class o{constructor(e){this.iterate=e}static empty=new o(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new o(t=>this.iterate(n=>e(n)?t(n):!0))}map(e){return new o(t=>this.iterate(n=>t(e(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(i=>((n||xo.isGreaterThan(e(i,t)))&&(n=!1,t=i),!0)),t}};function AM(o,e){let t=new Set;for(let n of e)o.has(n)&&t.add(n);return t}var Qu="en",sg=!1,ag=!1,rg=!1,zW=!1,BM=!1,C_=!1,KW=!1,S_=!1,GW=!1,VM=!1,og,xv=Qu,OM=Qu,jW,Za,Xa=globalThis,Ir;typeof Xa.vscode<"u"&&typeof Xa.vscode.process<"u"?Ir=Xa.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Ir=process);var WM=typeof Ir?.versions?.electron=="string",$W=WM&&Ir?.type==="renderer";if(typeof Ir=="object"){sg=Ir.platform==="win32",ag=Ir.platform==="darwin",rg=Ir.platform==="linux",zW=rg&&!!Ir.env.SNAP&&!!Ir.env.SNAP_REVISION,KW=WM,GW=!!Ir.env.CI||!!Ir.env.BUILD_ARTIFACTSTAGINGDIRECTORY,og=Qu,xv=Qu;let o=Ir.env.VSCODE_NLS_CONFIG;if(o)try{let e=JSON.parse(o);og=e.userLocale,OM=e.osLocale,xv=e.resolvedLanguage||Qu,jW=e.languagePack?.translationsConfigFile}catch{}BM=!0}else typeof navigator=="object"&&!$W?(Za=navigator.userAgent,sg=Za.indexOf("Windows")>=0,ag=Za.indexOf("Macintosh")>=0,S_=(Za.indexOf("Macintosh")>=0||Za.indexOf("iPad")>=0||Za.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,rg=Za.indexOf("Linux")>=0,VM=Za?.indexOf("Mobi")>=0,C_=!0,xv=tg()||Qu,og=navigator.language.toLowerCase(),OM=og):console.error("Unable to resolve platform.");var I_=0;ag?I_=1:sg?I_=3:rg&&(I_=2);var ft=sg,Fe=ag,Zt=rg;var Ys=BM;var wo=C_,qW=C_&&typeof Xa.importScripts=="function",HM=qW?Xa.origin:void 0,Zl=S_,UM=VM;var qs=Za,$s=xv,YW;(n=>{function o(){return $s}n.value=o;function e(){return $s.length===2?$s==="en":$s.length>=3?$s[0]==="e"&&$s[1]==="n"&&$s[2]==="-":!1}n.isDefaultVariant=e;function t(){return $s==="en"}n.isDefault=t})(YW||={});var zM=og;var ZW=typeof Xa.postMessage=="function"&&!Xa.importScripts,Ev=(()=>{if(ZW){let o=[];Xa.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=o.length;n<i;n++){let r=o[n];if(r.id===t.data.vscodeScheduleAsyncWork){o.splice(n,1),r.callback();return}}});let e=0;return t=>{let n=++e;o.push({id:n,callback:t}),Xa.postMessage({vscodeScheduleAsyncWork:n},"*")}}return o=>setTimeout(o)})();var Zs=ag||S_?2:sg?1:3,PM=!0,FM=!1;function KM(){if(!FM){FM=!0;let o=new Uint8Array(2);o[0]=1,o[1]=2,PM=new Uint16Array(o.buffer)[0]===513}return PM}var x_=!!(qs&&qs.indexOf("Chrome")>=0),wv=!!(qs&&qs.indexOf("Firefox")>=0),GM=!!(!x_&&qs&&qs.indexOf("Safari")>=0),jM=!!(qs&&qs.indexOf("Edg/")>=0),$M=!!(qs&&qs.indexOf("Android")>=0);var hc,E_=globalThis.vscode;if(typeof E_<"u"&&typeof E_.process<"u"){let o=E_.process;hc={get platform(){return o.platform},get arch(){return o.arch},get env(){return o.env},cwd(){return o.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?hc={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:hc={get platform(){return ft?"win32":Fe?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var lg=hc.cwd,Xl=hc.env,qM=hc.platform,F3=hc.arch;var QW=65,JW=97,eH=90,tH=122,ed=46,Di=47,$o=92,Ql=58,nH=63,_v=class extends Error{code;constructor(e,t,n){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let r=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${r} ${i} of type ${t}`;s+=`. Received type ${typeof n}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function iH(o,e){if(o===null||typeof o!="object")throw new _v(e,"Object",o)}function An(o,e){if(typeof o!="string")throw new _v(e,"string",o)}var qo=qM==="win32";function ut(o){return o===Di||o===$o}function w_(o){return o===Di}function Jl(o){return o>=QW&&o<=eH||o>=JW&&o<=tH}function Tv(o,e,t,n){let i="",r=0,s=-1,a=0,l=0;for(let d=0;d<=o.length;++d){if(d<o.length)l=o.charCodeAt(d);else{if(n(l))break;l=Di}if(n(l)){if(!(s===d-1||a===1))if(a===2){if(i.length<2||r!==2||i.charCodeAt(i.length-1)!==ed||i.charCodeAt(i.length-2)!==ed){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",r=0):(i=i.slice(0,c),r=i.length-1-i.lastIndexOf(t)),s=d,a=0;continue}else if(i.length!==0){i="",r=0,s=d,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",r=2)}else i.length>0?i+=`${t}${o.slice(s+1,d)}`:i=o.slice(s+1,d),r=d-s-1;s=d,a=0}else l===ed&&a!==-1?++a:a=-1}return i}function oH(o){return o?`${o[0]==="."?"":"."}${o}`:""}function YM(o,e){iH(e,"pathObject");let t=e.dir||e.root,n=e.base||`${e.name||""}${oH(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}${o}${n}`:n}var En={resolve(...o){let e="",t="",n=!1;for(let i=o.length-1;i>=-1;i--){let r;if(i>=0){if(r=o[i],An(r,`paths[${i}]`),r.length===0)continue}else e.length===0?r=lg():(r=Xl[`=${e}`]||lg(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===$o)&&(r=`${e}\\`));let s=r.length,a=0,l="",d=!1,c=r.charCodeAt(0);if(s===1)ut(c)&&(a=1,d=!0);else if(ut(c))if(d=!0,ut(r.charCodeAt(1))){let u=2,h=u;for(;u<s&&!ut(r.charCodeAt(u));)u++;if(u<s&&u!==h){let m=r.slice(h,u);for(h=u;u<s&&ut(r.charCodeAt(u));)u++;if(u<s&&u!==h){for(h=u;u<s&&!ut(r.charCodeAt(u));)u++;(u===s||u!==h)&&(l=`\\\\${m}\\${r.slice(h,u)}`,a=u)}}}else a=1;else Jl(c)&&r.charCodeAt(1)===Ql&&(l=r.slice(0,2),a=2,s>2&&ut(r.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,n=d,d&&e.length>0)break}return t=Tv(t,!n,"\\",ut),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(o){An(o,"path");let e=o.length;if(e===0)return".";let t=0,n,i=!1,r=o.charCodeAt(0);if(e===1)return w_(r)?"\\":o;if(ut(r))if(i=!0,ut(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ut(o.charCodeAt(a));)a++;if(a<e&&a!==l){let d=o.slice(l,a);for(l=a;a<e&&ut(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ut(o.charCodeAt(a));)a++;if(a===e)return`\\\\${d}\\${o.slice(l)}\\`;a!==l&&(n=`\\\\${d}\\${o.slice(l,a)}`,t=a)}}}else t=1;else Jl(r)&&o.charCodeAt(1)===Ql&&(n=o.slice(0,2),t=2,e>2&&ut(o.charCodeAt(2))&&(i=!0,t=3));let s=t<e?Tv(o.slice(t),!i,"\\",ut):"";return s.length===0&&!i&&(s="."),s.length>0&&ut(o.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(o){An(o,"path");let e=o.length;if(e===0)return!1;let t=o.charCodeAt(0);return ut(t)||e>2&&Jl(t)&&o.charCodeAt(1)===Ql&&ut(o.charCodeAt(2))},join(...o){if(o.length===0)return".";let e,t;for(let r=0;r<o.length;++r){let s=o[r];An(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&ut(t.charCodeAt(0))){++i;let r=t.length;r>1&&ut(t.charCodeAt(1))&&(++i,r>2&&(ut(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&ut(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return En.normalize(e)},relative(o,e){if(An(o,"from"),An(e,"to"),o===e)return"";let t=En.resolve(o),n=En.resolve(e);if(t===n||(o=t.toLowerCase(),e=n.toLowerCase(),o===e))return"";let i=0;for(;i<o.length&&o.charCodeAt(i)===$o;)i++;let r=o.length;for(;r-1>i&&o.charCodeAt(r-1)===$o;)r--;let s=r-i,a=0;for(;a<e.length&&e.charCodeAt(a)===$o;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===$o;)l--;let d=l-a,c=s<d?s:d,u=-1,h=0;for(;h<c;h++){let g=o.charCodeAt(i+h);if(g!==e.charCodeAt(a+h))break;g===$o&&(u=h)}if(h!==c){if(u===-1)return n}else{if(d>c){if(e.charCodeAt(a+h)===$o)return n.slice(a+h+1);if(h===2)return n.slice(a+h)}s>c&&(o.charCodeAt(i+h)===$o?u=h:h===2&&(u=3)),u===-1&&(u=0)}let m="";for(h=i+u+1;h<=r;++h)(h===r||o.charCodeAt(h)===$o)&&(m+=m.length===0?"..":"\\..");return a+=u,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===$o&&++a,n.slice(a,l))},toNamespacedPath(o){if(typeof o!="string"||o.length===0)return o;let e=En.resolve(o);if(e.length<=2)return o;if(e.charCodeAt(0)===$o){if(e.charCodeAt(1)===$o){let t=e.charCodeAt(2);if(t!==nH&&t!==ed)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Jl(e.charCodeAt(0))&&e.charCodeAt(1)===Ql&&e.charCodeAt(2)===$o)return`\\\\?\\${e}`;return o},dirname(o){An(o,"path");let e=o.length;if(e===0)return".";let t=-1,n=0,i=o.charCodeAt(0);if(e===1)return ut(i)?o:".";if(ut(i)){if(t=n=1,ut(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ut(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&ut(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ut(o.charCodeAt(a));)a++;if(a===e)return o;a!==l&&(t=n=a+1)}}}}else Jl(i)&&o.charCodeAt(1)===Ql&&(t=e>2&&ut(o.charCodeAt(2))?3:2,n=t);let r=-1,s=!0;for(let a=e-1;a>=n;--a)if(ut(o.charCodeAt(a))){if(!s){r=a;break}}else s=!1;if(r===-1){if(t===-1)return".";r=t}return o.slice(0,r)},basename(o,e){e!==void 0&&An(e,"suffix"),An(o,"path");let t=0,n=-1,i=!0,r;if(o.length>=2&&Jl(o.charCodeAt(0))&&o.charCodeAt(1)===Ql&&(t=2),e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=t;--r){let l=o.charCodeAt(r);if(ut(l)){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=t;--r)if(ut(o.charCodeAt(r))){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){An(o,"path");let e=0,t=-1,n=0,i=-1,r=!0,s=0;o.length>=2&&o.charCodeAt(1)===Ql&&Jl(o.charCodeAt(0))&&(e=n=2);for(let a=o.length-1;a>=e;--a){let l=o.charCodeAt(a);if(ut(l)){if(!r){n=a+1;break}continue}i===-1&&(r=!1,i=a+1),l===ed?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":o.slice(t,i)},format:YM.bind(null,"\\"),parse(o){An(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.length,n=0,i=o.charCodeAt(0);if(t===1)return ut(i)?(e.root=e.dir=o,e):(e.base=e.name=o,e);if(ut(i)){if(n=1,ut(o.charCodeAt(1))){let u=2,h=u;for(;u<t&&!ut(o.charCodeAt(u));)u++;if(u<t&&u!==h){for(h=u;u<t&&ut(o.charCodeAt(u));)u++;if(u<t&&u!==h){for(h=u;u<t&&!ut(o.charCodeAt(u));)u++;u===t?n=u:u!==h&&(n=u+1)}}}}else if(Jl(i)&&o.charCodeAt(1)===Ql){if(t<=2)return e.root=e.dir=o,e;if(n=2,ut(o.charCodeAt(2))){if(t===3)return e.root=e.dir=o,e;n=3}}n>0&&(e.root=o.slice(0,n));let r=-1,s=n,a=-1,l=!0,d=o.length-1,c=0;for(;d>=n;--d){if(i=o.charCodeAt(d),ut(i)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),i===ed?r===-1?r=d:c!==1&&(c=1):r!==-1&&(c=-1)}return a!==-1&&(r===-1||c===0||c===1&&r===a-1&&r===s+1?e.base=e.name=o.slice(s,a):(e.name=o.slice(s,r),e.base=o.slice(s,a),e.ext=o.slice(r,a))),s>0&&s!==n?e.dir=o.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},rH=(()=>{if(qo){let o=/\\/g;return()=>{let e=lg().replace(o,"/");return e.slice(e.indexOf("/"))}}return()=>lg()})(),bt={resolve(...o){let e="",t=!1;for(let n=o.length-1;n>=-1&&!t;n--){let i=n>=0?o[n]:rH();An(i,`paths[${n}]`),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===Di)}return e=Tv(e,!t,"/",w_),t?`/${e}`:e.length>0?e:"."},normalize(o){if(An(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===Di,t=o.charCodeAt(o.length-1)===Di;return o=Tv(o,!e,"/",w_),o.length===0?e?"/":t?"./":".":(t&&(o+="/"),e?`/${o}`:o)},isAbsolute(o){return An(o,"path"),o.length>0&&o.charCodeAt(0)===Di},join(...o){if(o.length===0)return".";let e;for(let t=0;t<o.length;++t){let n=o[t];An(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":bt.normalize(e)},relative(o,e){if(An(o,"from"),An(e,"to"),o===e||(o=bt.resolve(o),e=bt.resolve(e),o===e))return"";let t=1,n=o.length,i=n-t,r=1,s=e.length-r,a=i<s?i:s,l=-1,d=0;for(;d<a;d++){let u=o.charCodeAt(t+d);if(u!==e.charCodeAt(r+d))break;u===Di&&(l=d)}if(d===a)if(s>a){if(e.charCodeAt(r+d)===Di)return e.slice(r+d+1);if(d===0)return e.slice(r+d)}else i>a&&(o.charCodeAt(t+d)===Di?l=d:d===0&&(l=0));let c="";for(d=t+l+1;d<=n;++d)(d===n||o.charCodeAt(d)===Di)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(r+l)}`},toNamespacedPath(o){return o},dirname(o){if(An(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===Di,t=-1,n=!0;for(let i=o.length-1;i>=1;--i)if(o.charCodeAt(i)===Di){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":o.slice(0,t)},basename(o,e){e!==void 0&&An(e,"ext"),An(o,"path");let t=0,n=-1,i=!0,r;if(e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=0;--r){let l=o.charCodeAt(r);if(l===Di){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=0;--r)if(o.charCodeAt(r)===Di){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){An(o,"path");let e=-1,t=0,n=-1,i=!0,r=0;for(let s=o.length-1;s>=0;--s){let a=o.charCodeAt(s);if(a===Di){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===ed?e===-1?e=s:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||n===-1||r===0||r===1&&e===n-1&&e===t+1?"":o.slice(e,n)},format:YM.bind(null,"/"),parse(o){An(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.charCodeAt(0)===Di,n;t?(e.root="/",n=1):n=0;let i=-1,r=0,s=-1,a=!0,l=o.length-1,d=0;for(;l>=n;--l){let c=o.charCodeAt(l);if(c===Di){if(!a){r=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===ed?i===-1?i=l:d!==1&&(d=1):i!==-1&&(d=-1)}if(s!==-1){let c=r===0&&t?1:r;i===-1||d===0||d===1&&i===s-1&&i===r+1?e.base=e.name=o.slice(c,s):(e.name=o.slice(c,i),e.base=o.slice(c,s),e.ext=o.slice(i,s))}return r>0?e.dir=o.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};bt.win32=En.win32=En;bt.posix=En.posix=bt;var td=qo?En.normalize:bt.normalize,dg=qo?En.isAbsolute:bt.isAbsolute,Cr=qo?En.join:bt.join,Ju=qo?En.resolve:bt.resolve,ZM=qo?En.relative:bt.relative,eh=qo?En.dirname:bt.dirname,__=qo?En.basename:bt.basename,Lv=qo?En.extname:bt.extname,B3=qo?En.format:bt.format,XM=qo?En.parse:bt.parse,V3=qo?En.toNamespacedPath:bt.toNamespacedPath,_o=qo?En.sep:bt.sep,W3=qo?En.delimiter:bt.delimiter;var aH=/^\w[\w\d+.-]*$/,lH=/^\//,dH=/^\/\//;function cH(o,e){if(!o.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${o.authority}", path: "${o.path}", query: "${o.query}", fragment: "${o.fragment}"}`);if(o.scheme&&!aH.test(o.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(o.path){if(o.authority){if(!lH.test(o.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(dH.test(o.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function uH(o,e){return!o&&!e?"file":o}function hH(o,e){switch(o){case"https":case"http":case"file":e?e[0]!==ls&&(e=ls+e):e=ls;break}return e}var on="",ls="/",pH=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,ne=class o{static isUri(e){return e instanceof o?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,n,i,r,s=!1){typeof e=="object"?(this.scheme=e.scheme||on,this.authority=e.authority||on,this.path=e.path||on,this.query=e.query||on,this.fragment=e.fragment||on):(this.scheme=uH(e,s),this.authority=t||on,this.path=hH(this.scheme,n||on),this.query=i||on,this.fragment=r||on,cH(this,s))}get fsPath(){return cg(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:r,fragment:s}=e;return t===void 0?t=this.scheme:t===null&&(t=on),n===void 0?n=this.authority:n===null&&(n=on),i===void 0?i=this.path:i===null&&(i=on),r===void 0?r=this.query:r===null&&(r=on),s===void 0?s=this.fragment:s===null&&(s=on),t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&s===this.fragment?this:new nd(t,n,i,r,s)}static parse(e,t=!1){let n=pH.exec(e);return n?new nd(n[2]||on,Dv(n[4]||on),Dv(n[5]||on),Dv(n[7]||on),Dv(n[9]||on),t):new nd(on,on,on,on,on)}static file(e){let t=on;if(ft&&(e=e.replace(/\\/g,ls)),e[0]===ls&&e[1]===ls){let n=e.indexOf(ls,2);n===-1?(t=e.substring(2),e=ls):(t=e.substring(2,n),e=e.substring(n)||ls)}return new nd("file",t,e,on,on)}static from(e,t){return new nd(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return ft&&e.scheme==="file"?n=o.file(En.join(cg(e,!0),...t)).path:n=bt.join(e.path,...t),e.with({path:n})}toString(e=!1){return L_(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof o)return e;{let t=new nd(e);return t._formatted=e.external??null,t._fsPath=e._sep===eN?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var eN=ft?1:void 0,nd=class extends ne{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=cg(this,!1)),this._fsPath}toString(e=!1){return e?L_(this,!0):(this._formatted||(this._formatted=L_(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=eN),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},tN={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function QM(o,e,t){let n,i=-1;for(let r=0;r<o.length;r++){let s=o.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47||t&&s===91||t&&s===93||t&&s===58)i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n!==void 0&&(n+=o.charAt(r));else{n===void 0&&(n=o.substr(0,r));let a=tN[s];a!==void 0?(i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n+=a):i===-1&&(i=r)}}return i!==-1&&(n+=encodeURIComponent(o.substring(i))),n!==void 0?n:o}function mH(o){let e;for(let t=0;t<o.length;t++){let n=o.charCodeAt(t);n===35||n===63?(e===void 0&&(e=o.substr(0,t)),e+=tN[n]):e!==void 0&&(e+=o[t])}return e!==void 0?e:o}function cg(o,e){let t;return o.authority&&o.path.length>1&&o.scheme==="file"?t=`//${o.authority}${o.path}`:o.path.charCodeAt(0)===47&&(o.path.charCodeAt(1)>=65&&o.path.charCodeAt(1)<=90||o.path.charCodeAt(1)>=97&&o.path.charCodeAt(1)<=122)&&o.path.charCodeAt(2)===58?e?t=o.path.substr(1):t=o.path[1].toLowerCase()+o.path.substr(2):t=o.path,ft&&(t=t.replace(/\//g,"\\")),t}function L_(o,e){let t=e?mH:QM,n="",{scheme:i,authority:r,path:s,query:a,fragment:l}=o;if(i&&(n+=i,n+=":"),(r||i==="file")&&(n+=ls,n+=ls),r){let d=r.indexOf("@");if(d!==-1){let c=r.substr(0,d);r=r.substr(d+1),d=c.lastIndexOf(":"),d===-1?n+=t(c,!1,!1):(n+=t(c.substr(0,d),!1,!1),n+=":",n+=t(c.substr(d+1),!1,!0)),n+="@"}r=r.toLowerCase(),d=r.lastIndexOf(":"),d===-1?n+=t(r,!1,!0):(n+=t(r.substr(0,d),!1,!0),n+=r.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}n+=t(s,!0,!1)}return a&&(n+="?",n+=t(a,!1,!1)),l&&(n+="#",n+=e?l:QM(l,!1,!1)),n}function nN(o){try{return decodeURIComponent(o)}catch{return o.length>3?o.substr(0,3)+nN(o.substr(3)):o}}var JM=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Dv(o){return o.match(JM)?o.replace(JM,e=>nN(e)):o}function k_(o,e,t){let n=o.get(e);return n===void 0&&(n=t,o.set(e,n)),n}var D_=class{constructor(e,t){this.uri=e;this.value=t}};function gH(o){return Array.isArray(o)}var so=class o{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof o)this.map=new Map(e.map),this.toKey=t??o.defaultToKey;else if(gH(e)){this.map=new Map,this.toKey=t??o.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e??o.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new D_(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[n,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}},Rv=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(e,t){!e||typeof e=="function"?this._map=new so(e):(this._map=new so(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var R_=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.key,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.value,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:[n.key,n.value],done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},kv=class extends R_{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Ri=class extends kv{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}},Mv=class extends kv{constructor(e,t=1){super(e,t)}trim(e){this.trimNew(e)}set(e,t){return this._limit<=this.size&&!this.has(e)&&this.trim(Math.round(this._limit*this._ratio)-1),super.set(e,t),this}};function ds(o,e){let t=this,n=!1,i;return function(){if(n)return i;if(n=!0,e)try{i=o.apply(t,arguments)}finally{e()}else i=o.apply(t,arguments);return i}}var Yo;(S=>{function o(w){return w&&typeof w=="object"&&typeof w[Symbol.iterator]=="function"}S.is=o;let e=Object.freeze([]);function t(){return e}S.empty=t;function*n(w){yield w}S.single=n;function i(w){return o(w)?w:n(w)}S.wrap=i;function r(w){return w||e}S.from=r;function*s(w){for(let R=w.length-1;R>=0;R--)yield w[R]}S.reverse=s;function a(w){return!w||w[Symbol.iterator]().next().done===!0}S.isEmpty=a;function l(w){return w[Symbol.iterator]().next().value}S.first=l;function d(w,R){let M=0;for(let N of w)if(R(N,M++))return!0;return!1}S.some=d;function c(w,R){for(let M of w)if(R(M))return M}S.find=c;function*u(w,R){for(let M of w)R(M)&&(yield M)}S.filter=u;function*h(w,R){let M=0;for(let N of w)yield R(N,M++)}S.map=h;function*m(w,R){let M=0;for(let N of w)yield*R(N,M++)}S.flatMap=m;function*g(...w){for(let R of w)yield*R}S.concat=g;function f(w,R,M){let N=M;for(let A of w)N=R(N,A);return N}S.reduce=f;function*b(w,R,M=w.length){for(R<0&&(R+=w.length),M<0?M+=w.length:M>w.length&&(M=w.length);R<M;R++)yield w[R]}S.slice=b;function y(w,R=Number.POSITIVE_INFINITY){let M=[];if(R===0)return[M,w];let N=w[Symbol.iterator]();for(let A=0;A<R;A++){let P=N.next();if(P.done)return[M,S.empty()];M.push(P.value)}return[M,{[Symbol.iterator](){return N}}]}S.consume=y;async function C(w){let R=[];for await(let M of w)R.push(M);return Promise.resolve(R)}S.asyncToArray=C})(Yo||={});var bH=!1,pc=null;function vH(o){pc=o}if(bH){let o="__is_disposable_tracked__";vH(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[o]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==B.None)try{e[o]=!0}catch{}}markAsDisposed(e){if(e&&e!==B.None)try{e[o]=!0}catch{}}markAsSingleton(e){}})}function mc(o){return pc?.trackDisposable(o),o}function gc(o){pc?.markAsDisposed(o)}function ug(o,e){pc?.setParent(o,e)}function yH(o,e){if(pc)for(let t of o)pc.setParent(t,e)}function id(o){return pc?.markAsSingleton(o),o}function iN(o){return typeof o=="object"&&o!==null&&typeof o.dispose=="function"&&o.dispose.length===0}function Nt(o){if(Yo.is(o)){let e=[];for(let t of o)if(t)try{t.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(o)?[]:o}else if(o)return o.dispose(),o}function Zo(...o){let e=pe(()=>Nt(o));return yH(o,e),e}function pe(o){let e=mc({dispose:ds(()=>{gc(e),o()})});return e}var oe=class o{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){mc(this)}dispose(){this._isDisposed||(gc(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Nt(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return ug(e,this),this._isDisposed?o.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),ug(e,null))}},B=class{static None=Object.freeze({dispose(){}});_store=new oe;constructor(){mc(this),ug(this._store,this)}dispose(){gc(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},rn=class{_value;_isDisposed=!1;constructor(){mc(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&ug(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,gc(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&ug(e,null),e}};var Sr=class{_store=new Map;_isDisposed=!1;constructor(){mc(this)}dispose(){gc(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Nt(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var oN=Object.freeze(function(o,e){let t=setTimeout(o.bind(e),0);return{dispose(){clearTimeout(t)}}}),Xt;(n=>{function o(i){return i===n.None||i===n.Cancelled||i instanceof th?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}n.isCancellationToken=o,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Y.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:oN})})(Xt||={});var th=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?oN:(this._emitter||(this._emitter=new T),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Gr=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new th),this._token}cancel(){this._token?this._token instanceof th&&this._token.cancel():this._token=Xt.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof th&&this._token.dispose():this._token=Xt.None}};var un=class o{static Undefined=new o(void 0);element;next;prev;constructor(e){this.element=e,this.next=o.Undefined,this.prev=o.Undefined}},ki=class{_first=un.Undefined;_last=un.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===un.Undefined}clear(){let e=this._first;for(;e!==un.Undefined;){let t=e.next;e.prev=un.Undefined,e.next=un.Undefined,e=t}this._first=un.Undefined,this._last=un.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new un(e);if(this._first===un.Undefined)this._first=n,this._last=n;else if(t){let r=this._last;this._last=n,n.prev=r,r.next=n}else{let r=this._first;this._first=n,n.next=r,r.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==un.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==un.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==un.Undefined&&e.next!==un.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===un.Undefined&&e.next===un.Undefined?(this._first=un.Undefined,this._last=un.Undefined):e.next===un.Undefined?(this._last=this._last.prev,this._last.next=un.Undefined):e.prev===un.Undefined&&(this._first=this._first.next,this._first.prev=un.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==un.Undefined;)yield e.element,e=e.next}};var cs=(o,e)=>o===e;var hi=class{constructor(e,t,n){this.owner=e;this.debugNameSource=t;this.referenceFn=n}getDebugName(e){return lN(e,this)}},rN=new Map,M_=new WeakMap;function lN(o,e){let t=M_.get(o);if(t)return t;let n=IH(o,e);if(n){let i=rN.get(n)??0;i++,rN.set(n,i);let r=i===1?n:`${n}#${i}`;return M_.set(o,r),r}}function IH(o,e){let t=M_.get(o);if(t)return t;let n=e.owner?SH(e.owner)+".":"",i,r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(i=r(),i!==void 0)return n+i}else return n+r;let s=e.referenceFn;if(s!==void 0&&(i=Nv(s),i!==void 0))return n+i;if(e.owner!==void 0){let a=CH(e.owner,o);if(a!==void 0)return n+a}}function CH(o,e){for(let t in o)if(o[t]===e)return t}var sN=new Map,aN=new WeakMap;function SH(o){let e=aN.get(o);if(e)return e;let t=xH(o),n=sN.get(t)??0;n++,sN.set(t,n);let i=n===1?t:`${t}#${n}`;return aN.set(o,i),i}function xH(o){let e=o.constructor;return e?e.name:"Object"}function Nv(o){let e=o.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}function Av(o,e){if(!o)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function hg(o,e="Unreachable"){throw new Error(e)}function pi(o){if(!o()){debugger;o(),Ne(new Te("Assertion Failed"))}}function us(o,e){let t=0;for(;t<o.length-1;){let n=o[t],i=o[t+1];if(!e(n,i))return!1;t++}return!0}function Wt(o){return new nh(new hi(void 0,void 0,o),o,void 0,void 0)}function od(o,e){return new nh(new hi(o.owner,o.debugName,o.debugReferenceFn??e),e,void 0,void 0)}function N_(o,e){return new nh(new hi(o.owner,o.debugName,o.debugReferenceFn??e),e,o.createEmptyChangeSummary,o.handleChange)}function Qa(o){let e=new oe,t=od({owner:void 0,debugName:void 0,debugReferenceFn:o},n=>{e.clear(),o(n,e)});return pe(()=>{t.dispose(),e.dispose()})}var nh=class{constructor(e,t,n,i){this._debugNameData=e;this._runFn=t;this.createChangeSummary=n;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),Xo()?.handleAutorunCreated(this),this._runIfNeeded(),mc(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),gc(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){Xo()?.handleAutorunTriggered(this);let n=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}catch(i){Zu(i)}}}finally{t||Xo()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}pi(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:i=>i===e},this.changeSummary):!0)&&(this.state=2)}catch(n){Zu(n)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=nh)(Wt||={});function Ct(o,e){return e!==void 0?new ih(new hi(o,void 0,e),e,void 0,void 0,void 0,cs):new ih(new hi(void 0,void 0,o),o,void 0,void 0,void 0,cs)}function oh(o,e){return new ih(new hi(o.owner,o.debugName,o.debugReferenceFn),e,void 0,void 0,o.onLastObserverRemoved,o.equalsFn??cs)}dN(oh);var ih=class extends Xs{constructor(t,n,i,r,s=void 0,a){super();this._debugNameData=t;this._computeFn=n;this.createChangeSummary=i;this._handleChange=r;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),Xo()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let n=this.state!==0,i=this.value;this.state=3;let r=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}r=n&&!this._equalityComparator(i,this.value),Xo()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:r,hadValue:n})}catch(s){Zu(s)}if(r)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let i of this.observers)i.handlePossibleChange(this);if(n)for(let i of this.observers)i.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let i of n)i.endUpdate(this)}pi(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(t,n){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:t,change:n,didChange:s=>s===t},this.changeSummary):!0}catch(s){Zu(s)}let r=this.state===3;if(i&&(this.state===1||r)&&(this.state=2,r))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let n=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),n}addObserver(t){let n=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),n&&t.endUpdate(this)}};function Fv(o){return new A_(o)}var A_=class extends pg{constructor(t){super();this.value=t}get debugName(){return this.toString()}get(){return this.value}addObserver(t){}removeObserver(t){}toString(){return`Const: ${this.value}`}};function xr(...o){let e,t,n;return o.length===3?[e,t,n]=o:[t,n]=o,new Qs(new hi(e,void 0,n),t,n,()=>Qs.globalTransaction,cs)}function cN(o,e,t){return new Qs(new hi(o.owner,o.debugName,o.debugReferenceFn??t),e,t,()=>Qs.globalTransaction,o.equalsFn??cs)}var Qs=class extends Xs{constructor(t,n,i,r,s){super();this._debugNameData=t;this.event=n;this._getValue=i;this._getTransaction=r;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let n=this._getValue(t),i=this.value,r=!this.hasValue||!this._equalityComparator(i,n),s=!1;r&&(this.value=n,this.hasValue&&(s=!0,F_(this._getTransaction(),a=>{Xo()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||Xo()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=Qs;function e(n,i){let r=!1;Qs.globalTransaction===void 0&&(Qs.globalTransaction=n,r=!0);try{i()}finally{r&&(Qs.globalTransaction=void 0)}}t.batchEventsGlobally=e})(xr||={});function Bv(o,e){return new O_(o,e)}var O_=class extends Xs{constructor(t,n){super();this.debugName=t;this.event=n}subscription;onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=()=>{et(t=>{for(let n of this.observers)t.updateObserver(n,this),n.handleChange(this,void 0)},()=>this.debugName)};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}};function rh(o){return typeof o=="string"?new Ov(o):new Ov(void 0,o)}var Ov=class extends Xs{constructor(t,n){super();this._debugName=t;this._owner=n}get debugName(){return new hi(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(t,n){if(!t){et(i=>{this.trigger(i,n)},()=>`Trigger signal ${this.debugName}`);return}for(let i of this.observers)t.updateObserver(i,this),i.handleChange(this,n)}get(){}};function sh(o){let e=new Pv(!1,void 0);return o.addObserver(e),pe(()=>{o.removeObserver(e)})}pN(sh);function uN(o,e){let t=new Pv(!0,e);return o.addObserver(t),e?e(o.get()):o.reportChanges(),pe(()=>{o.removeObserver(t)})}hN(uN);var Pv=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};function P_(o,e){let t,n=rh("derivedObservableWithWritableCache"),i=Ct(o,r=>(n.read(r),t=e(r,t),t));return Object.assign(i,{clearCache:r=>{t=void 0,n.trigger(r)},setCache:(r,s)=>{t=r,n.trigger(s)}})}var mN;function gN(o){mN=o}function Xo(){return mN}var Vv=class{indentation=0;textToConsoleArgs(e){return _H([ah(DH("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[ah(" "),hs(gg(e.oldValue,70),{color:"red",strikeThrough:!0}),ah(" "),hs(gg(e.newValue,60),{color:"green"})]:[ah(" (unchanged)")]:[ah(" "),hs(gg(e.newValue,60),{color:"green"}),ah(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([mg("observable value changed"),hs(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return hs(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleDerivedRecomputed(e,t){let n=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([mg("derived recomputed"),hs(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([mg("observable from event triggered"),hs(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([mg("autorun"),hs(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([mg("transaction"),hs(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function _H(o){let e=new Array,t=[],n="";function i(s){if("length"in s)for(let a of s)a&&i(a);else"text"in s?(n+=`%c${s.text}`,e.push(s.style),s.data&&t.push(...s.data)):"data"in s&&t.push(...s.data)}i(o);let r=[n,...e];return r.push(...t),r}function ah(o){return hs(o,{color:"black"})}function mg(o){return hs(RH(`${o}: `,10),{color:"black",bold:!0})}function hs(o,e={color:"black"}){function t(i){return Object.entries(i).reduce((r,[s,a])=>`${r}${s}:${a};`,"")}let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:o,style:t(n)}}function gg(o,e){switch(typeof o){case"number":return""+o;case"string":return o.length+2<=e?`"${o}"`:`"${o.substr(0,e-7)}"+...`;case"boolean":return o?"true":"false";case"undefined":return"undefined";case"object":return o===null?"null":Array.isArray(o)?TH(o,e):LH(o,e);case"symbol":return o.toString();case"function":return`[[Function${o.name?" "+o.name:""}]]`;default:return""+o}}function TH(o,e){let t="[ ",n=!0;for(let i of o){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${gg(i,e-t.length)}`}return t+=" ]",t}function LH(o,e){let t="{ ",n=!0;for(let[i,r]of Object.entries(o)){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${i}: ${gg(r,e-t.length)}`}return t+=" }",t}function DH(o,e){let t="";for(let n=1;n<=e;n++)t+=o;return t}function RH(o,e){for(;o.length<e;)o+=" ";return o}var fN;function hN(o){fN=o}var bN;function pN(o){bN=o}var B_;function dN(o){B_=o}var pg=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=t===void 0?void 0:e,i=t===void 0?e:t;return B_({owner:n,debugName:()=>{let r=Nv(i);if(r!==void 0)return r;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(a)return`${this.debugName}.${a[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:i},r=>i(this.read(r),r))}flatten(){return B_({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(fN(this,t)),this}keepObserved(e){return e.add(bN(this)),this}get debugValue(){return this.get()}},Xs=class extends pg{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function et(o,e){let t=new fg(o,e);try{o(t)}finally{t.finish()}}function F_(o,e,t){o?e(o):et(e,t)}var fg=class{constructor(e,t){this._fn=e;this._getDebugName=t;Xo()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():Nv(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:n,observable:i}=e[t];n.endUpdate(i)}this.updatingObservers=null,Xo()?.handleEndTransaction()}};function fn(o,e){let t;return typeof o=="string"?t=new hi(void 0,o,void 0):t=new hi(o,void 0,void 0),new Wv(t,e,cs)}var Wv=class extends Xs{constructor(t,n,i){super();this._debugNameData=t;this._equalityComparator=i;this._value=n}_value;get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(t,n,i){if(i===void 0&&this._equalityComparator(this._value,t))return;let r;n||(n=r=new fg(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;this._setValue(t),Xo()?.handleObservableChanged(this,{oldValue:s,newValue:t,change:i,didChange:!0,hadValue:!0});for(let a of this.observers)n.updateObserver(a,this),a.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function bg(o,e,t,n){return e||(e=i=>i!=null),new Promise((i,r)=>{let s=!0,a=!1,l=o.map(c=>({isFinished:e(c),error:t?t(c):!1,state:c})),d=Wt(c=>{let{isFinished:u,error:h,state:m}=l.read(c);(u||h)&&(s?a=!0:d.dispose(),h?r(h===!0?m:h):i(m))});if(n){let c=n.onCancellationRequested(()=>{d.dispose(),c.dispose(),r(new Ui)});if(n.isCancellationRequested){d.dispose(),c.dispose(),r(new Ui);return}}s=!1,a&&d.dispose()})}var kH=!1;kH&&gN(new Vv);var MH=globalThis.performance&&typeof globalThis.performance.now=="function",Ja=class o{_startTime;_stopTime;_now;static create(e){return new o(e)}constructor(e){this._now=MH&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var V_=Symbol("MicrotaskDelay");var NH=!1,vN=!1,AH=!1,Y;(ye=>{ye.None=()=>B.None;function e(q){if(AH){let{onDidAddListener:Q}=q,ce=vg.create(),ie=0;q.onDidAddListener=()=>{++ie===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),ce.print()),Q?.()}}}function t(q,Q){return m(q,()=>{},0,void 0,!0,void 0,Q)}ye.defer=t;function n(q){return(Q,ce=null,ie)=>{let J=!1,Se;return Se=q(xe=>{if(!J)return Se?Se.dispose():J=!0,Q.call(ce,xe)},null,ie),J&&Se.dispose(),Se}}ye.once=n;function i(q,Q){return ye.once(ye.filter(q,Q))}ye.onceIf=i;function r(q,Q,ce){return u((ie,J=null,Se)=>q(xe=>ie.call(J,Q(xe)),null,Se),ce)}ye.map=r;function s(q,Q,ce){return u((ie,J=null,Se)=>q(xe=>{Q(xe),ie.call(J,xe)},null,Se),ce)}ye.forEach=s;function a(q,Q,ce){return u((ie,J=null,Se)=>q(xe=>Q(xe)&&ie.call(J,xe),null,Se),ce)}ye.filter=a;function l(q){return q}ye.signal=l;function d(...q){return(Q,ce=null,ie)=>{let J=Zo(...q.map(Se=>Se(xe=>Q.call(ce,xe))));return h(J,ie)}}ye.any=d;function c(q,Q,ce,ie){let J=ce;return r(q,Se=>(J=Q(J,Se),J),ie)}ye.reduce=c;function u(q,Q){let ce,ie={onWillAddFirstListener(){ce=q(J.fire,J)},onDidRemoveLastListener(){ce?.dispose()}};Q||e(ie);let J=new T(ie);return Q?.add(J),J.event}function h(q,Q){return Q instanceof Array?Q.push(q):Q&&Q.add(q),q}function m(q,Q,ce=100,ie=!1,J=!1,Se,xe){let lt,Ze,Re,ci=0,Kn,So={leakWarningThreshold:Se,onWillAddFirstListener(){lt=q(zl=>{ci++,Ze=Q(Ze,zl),ie&&!Re&&(jo.fire(Ze),Ze=void 0),Kn=()=>{let wi=Ze;Ze=void 0,Re=void 0,(!ie||ci>1)&&jo.fire(wi),ci=0},typeof ce=="number"?(clearTimeout(Re),Re=setTimeout(Kn,ce)):Re===void 0&&(Re=0,queueMicrotask(Kn))})},onWillRemoveListener(){J&&ci>0&&Kn?.()},onDidRemoveLastListener(){Kn=void 0,lt.dispose()}};xe||e(So);let jo=new T(So);return xe?.add(jo),jo.event}ye.debounce=m;function g(q,Q=0,ce){return ye.debounce(q,(ie,J)=>ie?(ie.push(J),ie):[J],Q,void 0,!0,void 0,ce)}ye.accumulate=g;function f(q,Q=(ie,J)=>ie===J,ce){let ie=!0,J;return a(q,Se=>{let xe=ie||!Q(Se,J);return ie=!1,J=Se,xe},ce)}ye.latch=f;function b(q,Q,ce){return[ye.filter(q,Q,ce),ye.filter(q,ie=>!Q(ie),ce)]}ye.split=b;function y(q,Q=!1,ce=[],ie){let J=ce.slice(),Se=q(Ze=>{J?J.push(Ze):lt.fire(Ze)});ie&&ie.add(Se);let xe=()=>{J?.forEach(Ze=>lt.fire(Ze)),J=null},lt=new T({onWillAddFirstListener(){Se||(Se=q(Ze=>lt.fire(Ze)),ie&&ie.add(Se))},onDidAddFirstListener(){J&&(Q?setTimeout(xe):xe())},onDidRemoveLastListener(){Se&&Se.dispose(),Se=null}});return ie&&ie.add(lt),lt.event}ye.buffer=y;function C(q,Q){return(ie,J,Se)=>{let xe=Q(new w);return q(function(lt){let Ze=xe.evaluate(lt);Ze!==S&&ie.call(J,Ze)},void 0,Se)}}ye.chain=C;let S=Symbol("HaltChainable");class w{steps=[];map(Q){return this.steps.push(Q),this}forEach(Q){return this.steps.push(ce=>(Q(ce),ce)),this}filter(Q){return this.steps.push(ce=>Q(ce)?ce:S),this}reduce(Q,ce){let ie=ce;return this.steps.push(J=>(ie=Q(ie,J),ie)),this}latch(Q=(ce,ie)=>ce===ie){let ce=!0,ie;return this.steps.push(J=>{let Se=ce||!Q(J,ie);return ce=!1,ie=J,Se?J:S}),this}evaluate(Q){for(let ce of this.steps)if(Q=ce(Q),Q===S)break;return Q}}function R(q,Q,ce=ie=>ie){let ie=(...lt)=>xe.fire(ce(...lt)),J=()=>q.on(Q,ie),Se=()=>q.removeListener(Q,ie),xe=new T({onWillAddFirstListener:J,onDidRemoveLastListener:Se});return xe.event}ye.fromNodeEventEmitter=R;function M(q,Q,ce=ie=>ie){let ie=(...lt)=>xe.fire(ce(...lt)),J=()=>q.addEventListener(Q,ie),Se=()=>q.removeEventListener(Q,ie),xe=new T({onWillAddFirstListener:J,onDidRemoveLastListener:Se});return xe.event}ye.fromDOMEventEmitter=M;function N(q){return new Promise(Q=>n(q)(Q))}ye.toPromise=N;function A(q){let Q=new T;return q.then(ce=>{Q.fire(ce)},()=>{Q.fire(void 0)}).finally(()=>{Q.dispose()}),Q.event}ye.fromPromise=A;function P(q,Q){return q(ce=>Q.fire(ce))}ye.forward=P;function K(q,Q,ce){return Q(ce),q(ie=>Q(ie))}ye.runAndSubscribe=K;class j{constructor(Q,ce){this._observable=Q;let ie={onWillAddFirstListener:()=>{Q.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{Q.removeObserver(this)}};ce||e(ie),this.emitter=new T(ie),ce&&ce.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(Q){this._counter++}handlePossibleChange(Q){}handleChange(Q,ce){this._hasChanged=!0}endUpdate(Q){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function X(q,Q){return new j(q,Q).emitter.event}ye.fromObservable=X;function le(q){return(Q,ce,ie)=>{let J=0,Se=!1,xe={beginUpdate(){J++},endUpdate(){J--,J===0&&(q.reportChanges(),Se&&(Se=!1,Q.call(ce)))},handlePossibleChange(){},handleChange(){Se=!0}};q.addObserver(xe),q.reportChanges();let lt={dispose(){q.removeObserver(xe)}};return ie instanceof oe?ie.add(lt):Array.isArray(ie)&&ie.push(lt),lt}}ye.fromObservableLight=le})(Y||={});var W_=class o{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${o._idPool++}`,o.all.add(this)}start(e){this._stopWatch=new Ja,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},yN=-1;var H_=class o{constructor(e,t,n=(o._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=n}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let n=this.threshold;if(n<=0||t<n)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[r,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(r);let l=new U_(a,r);this._errorHandler(l)}return()=>{let r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[n,i]of this._stacks)(!e||t<i)&&(e=[n,i],t=i);return e}},vg=class o{constructor(e){this.value=e}static create(){let e=new Error;return new o(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},U_=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},z_=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},OH=0,lh=class{constructor(e){this.value=e}stack;id=OH++},PH=2,IN=(o,e)=>{if(o instanceof lh)e(o);else for(let t=0;t<o.length;t++){let n=o[t];n&&e(n)}},Hv;if(NH){let o=[];setInterval(()=>{o.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(o.join(`
`)),o.length=0)},3e3),Hv=new FinalizationRegistry(e=>{typeof e=="string"&&o.push(e)})}var T=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=yN>0||this._options?.leakWarningThreshold?new H_(e?.onListenerError??Ne,this._options?.leakWarningThreshold??yN):void 0,this._perfMon=this._options?._profName?new W_(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(vN){let e=this._listeners;queueMicrotask(()=>{IN(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new z_(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||Ne)(c),B.None}if(this._disposed)return B.None;t&&(e=e.bind(t));let i=new lh(e),r,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=vg.create(),r=this._leakageMon.check(i.stack,this._size+1)),vN&&(i.stack=s??vg.create()),this._listeners?this._listeners instanceof lh?(this._deliveryQueue??=new Uv,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=pe(()=>{Hv?.unregister(a),r?.(),this._removeListener(i)});if(n instanceof oe?n.add(a):Array.isArray(n)&&n.push(a),Hv){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);Hv.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*PH<=t.length){let r=0;for(let s=0;s<t.length;s++)t[s]?t[r++]=t[s]:i&&(this._deliveryQueue.end--,r<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=r}}_deliver(e,t){if(!e)return;let n=this._options?.onListenerError||Ne;if(!n){e.value(t);return}try{e.value(t)}catch(i){n(i)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof lh)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},CN=()=>new Uv,Uv=class{i=-1;end=0;current;value;enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},dh=class extends T{_asyncDeliveryQueue;async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new ki),IN(this._listeners,i=>this._asyncDeliveryQueue.push([i.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[i,r]=this._asyncDeliveryQueue.shift(),s=[],a={...r,token:t,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");n&&(l=n(l,i)),s.push(l)}};try{i(a)}catch(l){Ne(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&Ne(d.reason)})}}},fc=class extends T{_isPaused=0;_eventQueue=new ki;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}},zv=class extends fc{_delay;_handle;constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}},Kv=class extends T{_queuedEvents=[];_mergeFn;constructor(e){super(e),this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}},yg=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new T({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){let t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),pe(ds(()=>{this.hasListeners&&this.unhook(t);let i=this.events.indexOf(t);this.events.splice(i,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(let e of this.events)e.listener?.dispose();this.events=[]}};var ch=class{data=[];wrapEvent(e,t,n){return(i,r,s)=>e(a=>{let l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>i.call(r,a)):i.call(r,a);return}let d=l;if(!d){i.call(r,t(n,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=n?d.items.reduce(t,n):d.items.reduce(t),i.call(r,d.reducedResult)})},void 0,s)}bufferEvents(e){let t={buffers:new Array};this.data.push(t);let n=e();return this.data.pop(),t.buffers.forEach(i=>i()),n}},Js=class{listening=!1;inputEvent=Y.None;inputEventListener=B.None;emitter=new T({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}});event=this.emitter.event;set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}};var Er=class extends B{_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(e,t="",n="",i=!0,r){super(),this._id=e,this._label=t,this._cssClass=n,this._enabled=i,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}},wr=class extends B{_onWillRun=this._register(new T);onWillRun=this._onWillRun.event;_onDidRun=this._register(new T);onDidRun=this._onDidRun.event;async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let n;try{await this.runAction(e,t)}catch(i){n=i}this._onDidRun.fire({action:e,error:n})}async runAction(e,t){await e.run(t)}},jn=class o{static join(...e){let t=[];for(let n of e)n.length&&(t.length?t=[...t,new o,...n]:t=n);return t}static ID="vs.actions.separator";id=o.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}},el=class{id;label;class;tooltip="";enabled=!0;checked=void 0;_actions;get actions(){return this._actions}constructor(e,t,n,i){this.id=e,this.label=t,this.class=i,this._actions=n}async run(){}};function Ki(o){return{id:o.id,label:o.label,tooltip:o.tooltip??o.label,class:o.class,enabled:o.enabled??!0,checked:o.checked,run:async(...e)=>o.run(...e)}}function sn(o){return typeof o=="string"}function hn(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&!(o instanceof RegExp)&&!(o instanceof Date)}function mi(o){return typeof o=="number"&&!isNaN(o)}function Gv(o){return o===!0||o===!1}function an(o){return typeof o>"u"}function ao(o){return!Mi(o)}function Mi(o){return an(o)||o===null}function tl(o,e){if(!o)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function To(o){if(Mi(o))throw new Error("Assertion Failed: argument is undefined or null");return o}var BH=Object.prototype.hasOwnProperty;function bc(o){if(!hn(o))return!1;for(let e in o)if(BH.call(o,e))return!1;return!0}function Ig(o){return typeof o=="function"}function SN(o,e){let t=Math.min(o.length,e.length);for(let n=0;n<t;n++)VH(o[n],e[n])}function VH(o,e){if(sn(e)){if(typeof o!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Ig(e)){try{if(o instanceof e)return}catch{}if(!Mi(o)&&o.constructor===e||e.length===1&&e.call(void 0,o)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var K_=Object.create(null);function v(o,e){if(sn(e)){let t=K_[e];if(t===void 0)throw new Error(`${o} references an unknown codicon: ${e}`);e=t}return K_[o]=e,{id:o}}function G_(){return K_}var xN={add:v("add",6e4),plus:v("plus",6e4),gistNew:v("gist-new",6e4),repoCreate:v("repo-create",6e4),lightbulb:v("lightbulb",60001),lightBulb:v("light-bulb",60001),repo:v("repo",60002),repoDelete:v("repo-delete",60002),gistFork:v("gist-fork",60003),repoForked:v("repo-forked",60003),gitPullRequest:v("git-pull-request",60004),gitPullRequestAbandoned:v("git-pull-request-abandoned",60004),recordKeys:v("record-keys",60005),keyboard:v("keyboard",60005),tag:v("tag",60006),gitPullRequestLabel:v("git-pull-request-label",60006),tagAdd:v("tag-add",60006),tagRemove:v("tag-remove",60006),person:v("person",60007),personFollow:v("person-follow",60007),personOutline:v("person-outline",60007),personFilled:v("person-filled",60007),gitBranch:v("git-branch",60008),gitBranchCreate:v("git-branch-create",60008),gitBranchDelete:v("git-branch-delete",60008),sourceControl:v("source-control",60008),mirror:v("mirror",60009),mirrorPublic:v("mirror-public",60009),star:v("star",60010),starAdd:v("star-add",60010),starDelete:v("star-delete",60010),starEmpty:v("star-empty",60010),comment:v("comment",60011),commentAdd:v("comment-add",60011),alert:v("alert",60012),warning:v("warning",60012),search:v("search",60013),searchSave:v("search-save",60013),logOut:v("log-out",60014),signOut:v("sign-out",60014),logIn:v("log-in",60015),signIn:v("sign-in",60015),eye:v("eye",60016),eyeUnwatch:v("eye-unwatch",60016),eyeWatch:v("eye-watch",60016),circleFilled:v("circle-filled",60017),primitiveDot:v("primitive-dot",60017),closeDirty:v("close-dirty",60017),debugBreakpoint:v("debug-breakpoint",60017),debugBreakpointDisabled:v("debug-breakpoint-disabled",60017),debugHint:v("debug-hint",60017),terminalDecorationSuccess:v("terminal-decoration-success",60017),primitiveSquare:v("primitive-square",60018),edit:v("edit",60019),pencil:v("pencil",60019),info:v("info",60020),issueOpened:v("issue-opened",60020),gistPrivate:v("gist-private",60021),gitForkPrivate:v("git-fork-private",60021),lock:v("lock",60021),mirrorPrivate:v("mirror-private",60021),close:v("close",60022),removeClose:v("remove-close",60022),x:v("x",60022),repoSync:v("repo-sync",60023),sync:v("sync",60023),clone:v("clone",60024),desktopDownload:v("desktop-download",60024),beaker:v("beaker",60025),microscope:v("microscope",60025),vm:v("vm",60026),deviceDesktop:v("device-desktop",60026),file:v("file",60027),fileText:v("file-text",60027),more:v("more",60028),ellipsis:v("ellipsis",60028),kebabHorizontal:v("kebab-horizontal",60028),mailReply:v("mail-reply",60029),reply:v("reply",60029),organization:v("organization",60030),organizationFilled:v("organization-filled",60030),organizationOutline:v("organization-outline",60030),newFile:v("new-file",60031),fileAdd:v("file-add",60031),newFolder:v("new-folder",60032),fileDirectoryCreate:v("file-directory-create",60032),trash:v("trash",60033),trashcan:v("trashcan",60033),history:v("history",60034),clock:v("clock",60034),folder:v("folder",60035),fileDirectory:v("file-directory",60035),symbolFolder:v("symbol-folder",60035),logoGithub:v("logo-github",60036),markGithub:v("mark-github",60036),github:v("github",60036),terminal:v("terminal",60037),console:v("console",60037),repl:v("repl",60037),zap:v("zap",60038),symbolEvent:v("symbol-event",60038),error:v("error",60039),stop:v("stop",60039),variable:v("variable",60040),symbolVariable:v("symbol-variable",60040),array:v("array",60042),symbolArray:v("symbol-array",60042),symbolModule:v("symbol-module",60043),symbolPackage:v("symbol-package",60043),symbolNamespace:v("symbol-namespace",60043),symbolObject:v("symbol-object",60043),symbolMethod:v("symbol-method",60044),symbolFunction:v("symbol-function",60044),symbolConstructor:v("symbol-constructor",60044),symbolBoolean:v("symbol-boolean",60047),symbolNull:v("symbol-null",60047),symbolNumeric:v("symbol-numeric",60048),symbolNumber:v("symbol-number",60048),symbolStructure:v("symbol-structure",60049),symbolStruct:v("symbol-struct",60049),symbolParameter:v("symbol-parameter",60050),symbolTypeParameter:v("symbol-type-parameter",60050),symbolKey:v("symbol-key",60051),symbolText:v("symbol-text",60051),symbolReference:v("symbol-reference",60052),goToFile:v("go-to-file",60052),symbolEnum:v("symbol-enum",60053),symbolValue:v("symbol-value",60053),symbolRuler:v("symbol-ruler",60054),symbolUnit:v("symbol-unit",60054),activateBreakpoints:v("activate-breakpoints",60055),archive:v("archive",60056),arrowBoth:v("arrow-both",60057),arrowDown:v("arrow-down",60058),arrowLeft:v("arrow-left",60059),arrowRight:v("arrow-right",60060),arrowSmallDown:v("arrow-small-down",60061),arrowSmallLeft:v("arrow-small-left",60062),arrowSmallRight:v("arrow-small-right",60063),arrowSmallUp:v("arrow-small-up",60064),arrowUp:v("arrow-up",60065),bell:v("bell",60066),bold:v("bold",60067),book:v("book",60068),bookmark:v("bookmark",60069),debugBreakpointConditionalUnverified:v("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:v("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:v("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:v("debug-breakpoint-data-unverified",60072),debugBreakpointData:v("debug-breakpoint-data",60073),debugBreakpointDataDisabled:v("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:v("debug-breakpoint-log-unverified",60074),debugBreakpointLog:v("debug-breakpoint-log",60075),debugBreakpointLogDisabled:v("debug-breakpoint-log-disabled",60075),briefcase:v("briefcase",60076),broadcast:v("broadcast",60077),browser:v("browser",60078),bug:v("bug",60079),calendar:v("calendar",60080),caseSensitive:v("case-sensitive",60081),check:v("check",60082),checklist:v("checklist",60083),chevronDown:v("chevron-down",60084),chevronLeft:v("chevron-left",60085),chevronRight:v("chevron-right",60086),chevronUp:v("chevron-up",60087),chromeClose:v("chrome-close",60088),chromeMaximize:v("chrome-maximize",60089),chromeMinimize:v("chrome-minimize",60090),chromeRestore:v("chrome-restore",60091),circleOutline:v("circle-outline",60092),circle:v("circle",60092),debugBreakpointUnverified:v("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:v("terminal-decoration-incomplete",60092),circleSlash:v("circle-slash",60093),circuitBoard:v("circuit-board",60094),clearAll:v("clear-all",60095),clippy:v("clippy",60096),closeAll:v("close-all",60097),cloudDownload:v("cloud-download",60098),cloudUpload:v("cloud-upload",60099),code:v("code",60100),collapseAll:v("collapse-all",60101),colorMode:v("color-mode",60102),commentDiscussion:v("comment-discussion",60103),creditCard:v("credit-card",60105),dash:v("dash",60108),dashboard:v("dashboard",60109),database:v("database",60110),debugContinue:v("debug-continue",60111),debugDisconnect:v("debug-disconnect",60112),debugPause:v("debug-pause",60113),debugRestart:v("debug-restart",60114),debugStart:v("debug-start",60115),debugStepInto:v("debug-step-into",60116),debugStepOut:v("debug-step-out",60117),debugStepOver:v("debug-step-over",60118),debugStop:v("debug-stop",60119),debug:v("debug",60120),deviceCameraVideo:v("device-camera-video",60121),deviceCamera:v("device-camera",60122),deviceMobile:v("device-mobile",60123),diffAdded:v("diff-added",60124),diffIgnored:v("diff-ignored",60125),diffModified:v("diff-modified",60126),diffRemoved:v("diff-removed",60127),diffRenamed:v("diff-renamed",60128),diff:v("diff",60129),diffSidebyside:v("diff-sidebyside",60129),discard:v("discard",60130),editorLayout:v("editor-layout",60131),emptyWindow:v("empty-window",60132),exclude:v("exclude",60133),extensions:v("extensions",60134),eyeClosed:v("eye-closed",60135),fileBinary:v("file-binary",60136),fileCode:v("file-code",60137),fileMedia:v("file-media",60138),filePdf:v("file-pdf",60139),fileSubmodule:v("file-submodule",60140),fileSymlinkDirectory:v("file-symlink-directory",60141),fileSymlinkFile:v("file-symlink-file",60142),fileZip:v("file-zip",60143),files:v("files",60144),filter:v("filter",60145),flame:v("flame",60146),foldDown:v("fold-down",60147),foldUp:v("fold-up",60148),fold:v("fold",60149),folderActive:v("folder-active",60150),folderOpened:v("folder-opened",60151),gear:v("gear",60152),gift:v("gift",60153),gistSecret:v("gist-secret",60154),gist:v("gist",60155),gitCommit:v("git-commit",60156),gitCompare:v("git-compare",60157),compareChanges:v("compare-changes",60157),gitMerge:v("git-merge",60158),githubAction:v("github-action",60159),githubAlt:v("github-alt",60160),globe:v("globe",60161),grabber:v("grabber",60162),graph:v("graph",60163),gripper:v("gripper",60164),heart:v("heart",60165),home:v("home",60166),horizontalRule:v("horizontal-rule",60167),hubot:v("hubot",60168),inbox:v("inbox",60169),issueReopened:v("issue-reopened",60171),issues:v("issues",60172),italic:v("italic",60173),jersey:v("jersey",60174),json:v("json",60175),kebabVertical:v("kebab-vertical",60176),key:v("key",60177),law:v("law",60178),lightbulbAutofix:v("lightbulb-autofix",60179),linkExternal:v("link-external",60180),link:v("link",60181),listOrdered:v("list-ordered",60182),listUnordered:v("list-unordered",60183),liveShare:v("live-share",60184),loading:v("loading",60185),location:v("location",60186),mailRead:v("mail-read",60187),mail:v("mail",60188),markdown:v("markdown",60189),megaphone:v("megaphone",60190),mention:v("mention",60191),milestone:v("milestone",60192),gitPullRequestMilestone:v("git-pull-request-milestone",60192),mortarBoard:v("mortar-board",60193),move:v("move",60194),multipleWindows:v("multiple-windows",60195),mute:v("mute",60196),noNewline:v("no-newline",60197),note:v("note",60198),octoface:v("octoface",60199),openPreview:v("open-preview",60200),package:v("package",60201),paintcan:v("paintcan",60202),pin:v("pin",60203),play:v("play",60204),run:v("run",60204),plug:v("plug",60205),preserveCase:v("preserve-case",60206),preview:v("preview",60207),project:v("project",60208),pulse:v("pulse",60209),question:v("question",60210),quote:v("quote",60211),radioTower:v("radio-tower",60212),reactions:v("reactions",60213),references:v("references",60214),refresh:v("refresh",60215),regex:v("regex",60216),remoteExplorer:v("remote-explorer",60217),remote:v("remote",60218),remove:v("remove",60219),replaceAll:v("replace-all",60220),replace:v("replace",60221),repoClone:v("repo-clone",60222),repoForcePush:v("repo-force-push",60223),repoPull:v("repo-pull",60224),repoPush:v("repo-push",60225),report:v("report",60226),requestChanges:v("request-changes",60227),rocket:v("rocket",60228),rootFolderOpened:v("root-folder-opened",60229),rootFolder:v("root-folder",60230),rss:v("rss",60231),ruby:v("ruby",60232),saveAll:v("save-all",60233),saveAs:v("save-as",60234),save:v("save",60235),screenFull:v("screen-full",60236),screenNormal:v("screen-normal",60237),searchStop:v("search-stop",60238),server:v("server",60240),settingsGear:v("settings-gear",60241),settings:v("settings",60242),shield:v("shield",60243),smiley:v("smiley",60244),sortPrecedence:v("sort-precedence",60245),splitHorizontal:v("split-horizontal",60246),splitVertical:v("split-vertical",60247),squirrel:v("squirrel",60248),starFull:v("star-full",60249),starHalf:v("star-half",60250),symbolClass:v("symbol-class",60251),symbolColor:v("symbol-color",60252),symbolConstant:v("symbol-constant",60253),symbolEnumMember:v("symbol-enum-member",60254),symbolField:v("symbol-field",60255),symbolFile:v("symbol-file",60256),symbolInterface:v("symbol-interface",60257),symbolKeyword:v("symbol-keyword",60258),symbolMisc:v("symbol-misc",60259),symbolOperator:v("symbol-operator",60260),symbolProperty:v("symbol-property",60261),wrench:v("wrench",60261),wrenchSubaction:v("wrench-subaction",60261),symbolSnippet:v("symbol-snippet",60262),tasklist:v("tasklist",60263),telescope:v("telescope",60264),textSize:v("text-size",60265),threeBars:v("three-bars",60266),thumbsdown:v("thumbsdown",60267),thumbsup:v("thumbsup",60268),tools:v("tools",60269),triangleDown:v("triangle-down",60270),triangleLeft:v("triangle-left",60271),triangleRight:v("triangle-right",60272),triangleUp:v("triangle-up",60273),twitter:v("twitter",60274),unfold:v("unfold",60275),unlock:v("unlock",60276),unmute:v("unmute",60277),unverified:v("unverified",60278),verified:v("verified",60279),versions:v("versions",60280),vmActive:v("vm-active",60281),vmOutline:v("vm-outline",60282),vmRunning:v("vm-running",60283),watch:v("watch",60284),whitespace:v("whitespace",60285),wholeWord:v("whole-word",60286),window:v("window",60287),wordWrap:v("word-wrap",60288),zoomIn:v("zoom-in",60289),zoomOut:v("zoom-out",60290),listFilter:v("list-filter",60291),listFlat:v("list-flat",60292),listSelection:v("list-selection",60293),selection:v("selection",60293),listTree:v("list-tree",60294),debugBreakpointFunctionUnverified:v("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:v("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:v("debug-breakpoint-function-disabled",60296),debugStackframeActive:v("debug-stackframe-active",60297),circleSmallFilled:v("circle-small-filled",60298),debugStackframeDot:v("debug-stackframe-dot",60298),terminalDecorationMark:v("terminal-decoration-mark",60298),debugStackframe:v("debug-stackframe",60299),debugStackframeFocused:v("debug-stackframe-focused",60299),debugBreakpointUnsupported:v("debug-breakpoint-unsupported",60300),symbolString:v("symbol-string",60301),debugReverseContinue:v("debug-reverse-continue",60302),debugStepBack:v("debug-step-back",60303),debugRestartFrame:v("debug-restart-frame",60304),debugAlt:v("debug-alt",60305),callIncoming:v("call-incoming",60306),callOutgoing:v("call-outgoing",60307),menu:v("menu",60308),expandAll:v("expand-all",60309),feedback:v("feedback",60310),gitPullRequestReviewer:v("git-pull-request-reviewer",60310),groupByRefType:v("group-by-ref-type",60311),ungroupByRefType:v("ungroup-by-ref-type",60312),account:v("account",60313),gitPullRequestAssignee:v("git-pull-request-assignee",60313),bellDot:v("bell-dot",60314),debugConsole:v("debug-console",60315),library:v("library",60316),output:v("output",60317),runAll:v("run-all",60318),syncIgnored:v("sync-ignored",60319),pinned:v("pinned",60320),githubInverted:v("github-inverted",60321),serverProcess:v("server-process",60322),serverEnvironment:v("server-environment",60323),pass:v("pass",60324),issueClosed:v("issue-closed",60324),stopCircle:v("stop-circle",60325),playCircle:v("play-circle",60326),record:v("record",60327),debugAltSmall:v("debug-alt-small",60328),vmConnect:v("vm-connect",60329),cloud:v("cloud",60330),merge:v("merge",60331),export:v("export",60332),graphLeft:v("graph-left",60333),magnet:v("magnet",60334),notebook:v("notebook",60335),redo:v("redo",60336),checkAll:v("check-all",60337),pinnedDirty:v("pinned-dirty",60338),passFilled:v("pass-filled",60339),circleLargeFilled:v("circle-large-filled",60340),circleLarge:v("circle-large",60341),circleLargeOutline:v("circle-large-outline",60341),combine:v("combine",60342),gather:v("gather",60342),table:v("table",60343),variableGroup:v("variable-group",60344),typeHierarchy:v("type-hierarchy",60345),typeHierarchySub:v("type-hierarchy-sub",60346),typeHierarchySuper:v("type-hierarchy-super",60347),gitPullRequestCreate:v("git-pull-request-create",60348),runAbove:v("run-above",60349),runBelow:v("run-below",60350),notebookTemplate:v("notebook-template",60351),debugRerun:v("debug-rerun",60352),workspaceTrusted:v("workspace-trusted",60353),workspaceUntrusted:v("workspace-untrusted",60354),workspaceUnknown:v("workspace-unknown",60355),terminalCmd:v("terminal-cmd",60356),terminalDebian:v("terminal-debian",60357),terminalLinux:v("terminal-linux",60358),terminalPowershell:v("terminal-powershell",60359),terminalTmux:v("terminal-tmux",60360),terminalUbuntu:v("terminal-ubuntu",60361),terminalBash:v("terminal-bash",60362),arrowSwap:v("arrow-swap",60363),copy:v("copy",60364),personAdd:v("person-add",60365),filterFilled:v("filter-filled",60366),wand:v("wand",60367),debugLineByLine:v("debug-line-by-line",60368),inspect:v("inspect",60369),layers:v("layers",60370),layersDot:v("layers-dot",60371),layersActive:v("layers-active",60372),compass:v("compass",60373),compassDot:v("compass-dot",60374),compassActive:v("compass-active",60375),azure:v("azure",60376),issueDraft:v("issue-draft",60377),gitPullRequestClosed:v("git-pull-request-closed",60378),gitPullRequestDraft:v("git-pull-request-draft",60379),debugAll:v("debug-all",60380),debugCoverage:v("debug-coverage",60381),runErrors:v("run-errors",60382),folderLibrary:v("folder-library",60383),debugContinueSmall:v("debug-continue-small",60384),beakerStop:v("beaker-stop",60385),graphLine:v("graph-line",60386),graphScatter:v("graph-scatter",60387),pieChart:v("pie-chart",60388),bracket:v("bracket",60175),bracketDot:v("bracket-dot",60389),bracketError:v("bracket-error",60390),lockSmall:v("lock-small",60391),azureDevops:v("azure-devops",60392),verifiedFilled:v("verified-filled",60393),newline:v("newline",60394),layout:v("layout",60395),layoutActivitybarLeft:v("layout-activitybar-left",60396),layoutActivitybarRight:v("layout-activitybar-right",60397),layoutPanelLeft:v("layout-panel-left",60398),layoutPanelCenter:v("layout-panel-center",60399),layoutPanelJustify:v("layout-panel-justify",60400),layoutPanelRight:v("layout-panel-right",60401),layoutPanel:v("layout-panel",60402),layoutSidebarLeft:v("layout-sidebar-left",60403),layoutSidebarRight:v("layout-sidebar-right",60404),layoutStatusbar:v("layout-statusbar",60405),layoutMenubar:v("layout-menubar",60406),layoutCentered:v("layout-centered",60407),target:v("target",60408),indent:v("indent",60409),recordSmall:v("record-small",60410),errorSmall:v("error-small",60411),terminalDecorationError:v("terminal-decoration-error",60411),arrowCircleDown:v("arrow-circle-down",60412),arrowCircleLeft:v("arrow-circle-left",60413),arrowCircleRight:v("arrow-circle-right",60414),arrowCircleUp:v("arrow-circle-up",60415),layoutSidebarRightOff:v("layout-sidebar-right-off",60416),layoutPanelOff:v("layout-panel-off",60417),layoutSidebarLeftOff:v("layout-sidebar-left-off",60418),blank:v("blank",60419),heartFilled:v("heart-filled",60420),map:v("map",60421),mapHorizontal:v("map-horizontal",60421),foldHorizontal:v("fold-horizontal",60421),mapFilled:v("map-filled",60422),mapHorizontalFilled:v("map-horizontal-filled",60422),foldHorizontalFilled:v("fold-horizontal-filled",60422),circleSmall:v("circle-small",60423),bellSlash:v("bell-slash",60424),bellSlashDot:v("bell-slash-dot",60425),commentUnresolved:v("comment-unresolved",60426),gitPullRequestGoToChanges:v("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:v("git-pull-request-new-changes",60428),searchFuzzy:v("search-fuzzy",60429),commentDraft:v("comment-draft",60430),send:v("send",60431),sparkle:v("sparkle",60432),insert:v("insert",60433),mic:v("mic",60434),thumbsdownFilled:v("thumbsdown-filled",60435),thumbsupFilled:v("thumbsup-filled",60436),coffee:v("coffee",60437),snake:v("snake",60438),game:v("game",60439),vr:v("vr",60440),chip:v("chip",60441),piano:v("piano",60442),music:v("music",60443),micFilled:v("mic-filled",60444),repoFetch:v("repo-fetch",60445),copilot:v("copilot",60446),lightbulbSparkle:v("lightbulb-sparkle",60447),robot:v("robot",60448),sparkleFilled:v("sparkle-filled",60449),diffSingle:v("diff-single",60450),diffMultiple:v("diff-multiple",60451),surroundWith:v("surround-with",60452),share:v("share",60453),gitStash:v("git-stash",60454),gitStashApply:v("git-stash-apply",60455),gitStashPop:v("git-stash-pop",60456),vscode:v("vscode",60457),vscodeInsiders:v("vscode-insiders",60458),codeOss:v("code-oss",60459),runCoverage:v("run-coverage",60460),runAllCoverage:v("run-all-coverage",60461),coverage:v("coverage",60462),githubProject:v("github-project",60463),mapVertical:v("map-vertical",60464),foldVertical:v("fold-vertical",60464),mapVerticalFilled:v("map-vertical-filled",60465),foldVerticalFilled:v("fold-vertical-filled",60465),goToSearch:v("go-to-search",60466),percentage:v("percentage",60467),sortPercentage:v("sort-percentage",60467),attach:v("attach",60468)};var WH={dialogError:v("dialog-error","error"),dialogWarning:v("dialog-warning","warning"),dialogInfo:v("dialog-info","info"),dialogClose:v("dialog-close","close"),treeItemExpanded:v("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:v("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:v("tree-filter-on-type-off","list-selection"),treeFilterClear:v("tree-filter-clear","close"),treeItemLoading:v("tree-item-loading","loading"),menuSelection:v("menu-selection","check"),menuSubmenu:v("menu-submenu","chevron-right"),menuBarMore:v("menubar-more","more"),scrollbarButtonLeft:v("scrollbar-button-left","triangle-left"),scrollbarButtonRight:v("scrollbar-button-right","triangle-right"),scrollbarButtonUp:v("scrollbar-button-up","triangle-up"),scrollbarButtonDown:v("scrollbar-button-down","triangle-down"),toolBarMore:v("toolbar-more","more"),quickInputBack:v("quick-input-back","arrow-left"),dropDownButton:v("drop-down-button",60084),symbolCustomColor:v("symbol-customcolor",60252),exportIcon:v("export",60332),workspaceUnspecified:v("workspace-unspecified",60355),newLine:v("newline",60394),thumbsDownFilled:v("thumbsdown-filled",60435),thumbsUpFilled:v("thumbsup-filled",60436),gitFetch:v("git-fetch",60445),lightbulbSparkleAutofix:v("lightbulb-sparkle-autofix",60447),debugBreakpointPending:v("debug-breakpoint-pending",60377)},ue={...xN,...WH};var EN;(e=>{function o(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=o})(EN||={});var Xe;(f=>{f.iconNameSegment="[A-Za-z0-9]+",f.iconNameExpression="[A-Za-z0-9-]+",f.iconModifierExpression="~[A-Za-z]+",f.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${f.iconNameExpression})(${f.iconModifierExpression})?$`);function r(b){let y=i.exec(b.id);if(!y)return r(ue.error);let[,C,S]=y,w=["codicon","codicon-"+C];return S&&w.push("codicon-modifier-"+S.substring(1)),w}f.asClassNameArray=r;function s(b){return r(b).join(" ")}f.asClassName=s;function a(b){return"."+r(b).join(".")}f.asCSSSelector=a;function l(b){return b&&typeof b=="object"&&typeof b.id=="string"&&(typeof b.color>"u"||EN.isThemeColor(b.color))}f.isThemeIcon=l;let d=new RegExp(`^\\$\\((${f.iconNameExpression}(?:${f.iconModifierExpression})?)\\)$`);function c(b){let y=d.exec(b);if(!y)return;let[,C]=y;return{id:C}}f.fromString=c;function u(b){return{id:b}}f.fromId=u;function h(b,y){let C=b.id,S=C.lastIndexOf("~");return S!==-1&&(C=C.substring(0,S)),y&&(C=`${C}~${y}`),{id:C}}f.modify=h;function m(b){let y=b.id.lastIndexOf("~");if(y!==-1)return b.id.substring(y+1)}f.getModifier=m;function g(b,y){return b.id===y.id&&b.color?.id===y.color?.id}f.isEqual=g})(Xe||={});function wN(o){return o}var jv=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=wN):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},Cg=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=wN):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let n=this._fn(e);return this._map.set(e,n),this._map2.set(t,n),n}};var $n=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function vc(o){return o<0?0:o>255?255:o|0}function TN(o){return!o||typeof o!="string"?!0:o.trim().length===0}function LN(o){return o.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function uh(o){return o.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Gi(o){return o.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function qv(o,e){if(!o||!e)return o;let t=e.length;if(t===0||o.length===0)return o;let n=0;for(;o.indexOf(e,n)===n;)n=n+t;return o.substring(n)}function Yv(o,e,t={}){if(!o)throw new Error("Cannot create regex from empty string");e||(o=Gi(o)),t.wholeWord&&(/\B/.test(o.charAt(0))||(o="\\b"+o),/\B/.test(o.charAt(o.length-1))||(o=o+"\\b"));let n="";return t.global&&(n+="g"),t.matchCase||(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),new RegExp(o,n)}function Sc(o){return o.split(/\r\n|\r|\n/)}function ln(o){for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function qn(o,e=0,t=o.length){for(let n=e;n<t;n++){let i=o.charCodeAt(n);if(i!==32&&i!==9)return o.substring(e,n)}return o.substring(e,t)}function _r(o,e=o.length-1){for(let t=e;t>=0;t--){let n=o.charCodeAt(t);if(n!==32&&n!==9)return t}return-1}function q_(o,e){return o<e?-1:o>e?1:0}function DN(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l<d)return-1;if(l>d)return 1}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function Y_(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l===d)continue;if(l>=128||d>=128)return DN(o.toLowerCase(),e.toLowerCase(),t,n,i,r);yc(l)&&(l-=32),yc(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function Sg(o){return o>=48&&o<=57}function yc(o){return o>=97&&o<=122}function na(o){return o>=65&&o<=90}function jr(o,e){return o.length===e.length&&Y_(o,e)===0}function rd(o,e){let t=e.length;return e.length>o.length?!1:Y_(o,e,0,t)===0}function xg(o,e){let t=Math.min(o.length,e.length),n;for(n=0;n<t;n++)if(o.charCodeAt(n)!==e.charCodeAt(n))return n;return t}function Eg(o,e){let t=Math.min(o.length,e.length),n,i=o.length-1,r=e.length-1;for(n=0;n<t;n++)if(o.charCodeAt(i-n)!==e.charCodeAt(r-n))return n;return t}function qt(o){return 55296<=o&&o<=56319}function sd(o){return 56320<=o&&o<=57343}function Zv(o,e){return(o-55296<<10)+(e-56320)+65536}function hh(o,e,t){let n=o.charCodeAt(t);if(qt(n)&&t+1<e){let i=o.charCodeAt(t+1);if(sd(i))return Zv(n,i)}return n}function HH(o,e){let t=o.charCodeAt(e-1);if(sd(t)&&e>1){let n=o.charCodeAt(e-2);if(qt(n))return Zv(n,t)}return t}var Ic=class{_str;_len;_offset;get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=HH(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){let e=hh(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},Cc=class{_iterator;get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new Ic(e,t)}nextGraphemeLength(){let e=$v.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let r=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(_N(i,s)){t.setOffset(r);break}i=s}return t.offset-n}prevGraphemeLength(){let e=$v.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let r=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(_N(s,i)){t.setOffset(r);break}i=s}return n-t.offset}eol(){return this._iterator.eol()}};function wg(o,e){return new Cc(o,e).nextGraphemeLength()}function Z_(o,e){return new Cc(o,e).prevGraphemeLength()}function Xv(o,e){e>0&&sd(o.charCodeAt(e))&&e--;let t=e+wg(o,e);return[t-Z_(o,t),t]}var j_;function UH(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function nl(o){return j_||(j_=UH()),j_.test(o)}var zH=/^[\t\n\r\x20-\x7E]*$/;function _g(o){return zH.test(o)}var X_=/[\u2028\u2029]/;function Qv(o){return X_.test(o)}function Tr(o){return o>=11904&&o<=55215||o>=63744&&o<=64255||o>=65281&&o<=65374}function Tg(o){return o>=127462&&o<=127487||o===8986||o===8987||o===9200||o===9203||o>=9728&&o<=10175||o===11088||o===11093||o>=127744&&o<=128591||o>=128640&&o<=128764||o>=128992&&o<=129008||o>=129280&&o<=129535||o>=129648&&o<=129782}var RN=String.fromCharCode(65279);function kN(o){return!!(o&&o.length>0&&o.charCodeAt(0)===65279)}function Jv(o){let e=26;return o=o%(2*e),o<e?String.fromCharCode(97+o):String.fromCharCode(65+o-e)}function _N(o,e){return o===0?e!==5&&e!==7:o===2&&e===3?!1:o===4||o===2||o===3||e===4||e===2||e===3?!0:!(o===8&&(e===8||e===9||e===11||e===12)||(o===11||o===9)&&(e===9||e===10)||(o===12||o===10)&&e===10||e===5||e===13||e===7||o===1||o===13&&e===14||o===6&&e===6)}var $v=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_data;constructor(){this._data=KH()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,n=t.length/3,i=1;for(;i<=n;)if(e<t[3*i])i=2*i;else if(e>t[3*i+1])i=2*i+1;else return t[3*i+2];return 0}};function KH(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function MN(o,e){if(o===0)return 0;let t=GH(o,e);if(t!==void 0)return t;let n=new Ic(e,o);return n.prevCodePoint(),n.offset}function GH(o,e){let t=new Ic(e,o),n=t.prevCodePoint();for(;jH(n)||n===65039||n===8419;){if(t.offset===0)return;n=t.prevCodePoint()}if(!Tg(n))return;let i=t.offset;return i>0&&t.prevCodePoint()===8205&&(i=t.offset),i}function jH(o){return 127995<=o&&o<=127999}var NN="\xA0",$_=class o{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new $n(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new jv({getCacheKey:JSON.stringify},e=>{function t(c){let u=new Map;for(let h=0;h<c.length;h+=2)u.set(c[h],c[h+1]);return u}function n(c,u){let h=new Map(c);for(let[m,g]of u)h.set(m,g);return h}function i(c,u){if(!c)return u;let h=new Map;for(let[m,g]of c)u.has(m)&&h.set(m,g);return h}let r=this.ambiguousCharacterData.value,s=e.filter(c=>!c.startsWith("_")&&c in r);s.length===0&&(s=["_default"]);let a;for(let c of s){let u=t(r[c]);a=i(a,u)}let l=t(r._common),d=n(l,a);return new o(d)});static getInstance(e){return o.cache.get(Array.from(e))}static _locales=new $n(()=>Object.keys(o.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return o._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let n=e.codePointAt(t);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};function Q_(...o){switch(o.length){case 1:return p("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",o[0]);case 2:return p("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",o[0],o[1]);case 3:return p("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",o[0],o[1],o[2]);default:return}}var $H=p("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),qH=p("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),ad=class o{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw RM(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(Q_("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(Q_("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(Q_("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,n=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),n=o._keywords.get(t);n?this._addToken(n):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error($H);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,n=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(qH);return}let r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!n){e++;break}else r===91?n=!0:r===92?t=!0:r===93&&(n=!1);e++}for(;e<this._input.length&&o._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var xc=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}};var ey=class{_entries=new Map;constructor(...e){for(let[t,n]of e)this.set(t,n)}set(e,t){let n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var ld;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function n(r){return r[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=n})(ld||={});var nt=Z("instantiationService");function YH(o,e,t){e[ld.DI_TARGET]===e?e[ld.DI_DEPENDENCIES].push({id:o,index:t}):(e[ld.DI_DEPENDENCIES]=[{id:o,index:t}],e[ld.DI_TARGET]=e)}function Z(o){if(ld.serviceIds.has(o))return ld.serviceIds.get(o);let e=function(t,n,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");YH(e,t,i)};return e.toString=()=>o,ld.serviceIds.set(o,e),e}var gi=new Map;gi.set("false",!1);gi.set("true",!0);gi.set("isMac",Fe);gi.set("isLinux",Zt);gi.set("isWindows",ft);gi.set("isWeb",wo);gi.set("isMacNative",Fe&&!wo);gi.set("isEdge",jM);gi.set("isFirefox",wv);gi.set("isChrome",x_);gi.set("isSafari",GM);var ZH=Object.prototype.hasOwnProperty;var XH={regexParsingWithErrorRecovery:!0},QH=p("contextkey.parser.error.emptyString","Empty context key expression"),JH=p("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),e4=p("contextkey.parser.error.noInAfterNot","'in' after 'not'."),AN=p("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),t4=p("contextkey.parser.error.unexpectedToken","Unexpected token"),n4=p("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),i4=p("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),o4=p("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),J_=class o{constructor(e=XH){this._config=e}static _parseError=new Error;_scanner=new ad;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:QH,offset:0,lexeme:"",additionalInfo:JH});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let n=this._peek(),i=n.type===17?n4:void 0;throw this._parsingErrors.push({message:t4,offset:n.offset,lexeme:ad.getLexeme(n),additionalInfo:i}),o._parseError}return t}catch(t){if(t!==o._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:ht.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:ht.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),ji.INSTANCE;case 12:return this._advance(),lo.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,AN),t?.negate()}case 17:return this._advance(),wc.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),ht.true();case 12:return this._advance(),ht.false();case 0:{this._advance();let t=this._expr();return this._consume(1,AN),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let r=i.lexeme,s=r.lastIndexOf("/"),a=s===r.length-1?void 0:this._removeFlagsGY(r.substring(s+1)),l;try{l=new RegExp(r.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",i)}return Og.create(t,l)}switch(i.type){case 10:case 19:{let r=[i.lexeme];this._advance();let s=this._peek(),a=0;for(let h=0;h<i.lexeme.length;h++)i.lexeme.charCodeAt(h)===40?a++:i.lexeme.charCodeAt(h)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let h=0;h<s.lexeme.length;h++)s.lexeme.charCodeAt(h)===40?a++:i.lexeme.charCodeAt(h)===41&&a--}if(a<0)break;r.push(ad.getLexeme(s)),this._advance(),s=this._peek()}let l=r.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),u;try{u=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",i)}return ht.regex(t,u)}case 18:{let r=i.lexeme;this._advance();let s=null;if(!TN(r)){let a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){let d=r.slice(a+1,l),c=r[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return Og.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,e4);let i=this._value();return ht.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return ht.equals(t,i);switch(i){case"true":return ht.has(t);case"false":return ht.not(t);default:return ht.equals(t,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return ht.notEquals(t,i);switch(i){case"true":return ht.not(t);case"false":return ht.has(t);default:return ht.notEquals(t,i)}}case 5:return this._advance(),Ng.create(t,this._value());case 6:return this._advance(),Ag.create(t,this._value());case 7:return this._advance(),kg.create(t,this._value());case 8:return this._advance(),Mg.create(t,this._value());case 13:return this._advance(),ht.in(t,this._value());default:return ht.has(t)}}case 20:throw this._parsingErrors.push({message:i4,offset:e.offset,lexeme:"",additionalInfo:o4}),o._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){let i=p("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,ad.getLexeme(t)),r=t.offset,s=ad.getLexeme(t);return this._parsingErrors.push({message:i,offset:r,lexeme:s,additionalInfo:n}),o._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},ht=class{static false(){return ji.INSTANCE}static true(){return lo.INSTANCE}static has(e){return Ec.create(e)}static equals(e,t){return Dg.create(e,t)}static notEquals(e,t){return Rg.create(e,t)}static regex(e,t){return Og.create(e,t)}static in(e,t){return ty.create(e,t)}static notIn(e,t){return ny.create(e,t)}static not(e){return wc.create(e)}static and(...e){return iy.create(e,null,!0)}static or(...e){return Pg.create(e,null,!0)}static greater(e,t){return kg.create(e,t)}static greaterEquals(e,t){return Mg.create(e,t)}static smaller(e,t){return Ng.create(e,t)}static smallerEquals(e,t){return Ag.create(e,t)}static _parser=new J_({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function Lg(o,e){return o.cmp(e)}var ji=class o{static INSTANCE=new o;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return lo.INSTANCE}},lo=class o{static INSTANCE=new o;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return ji.INSTANCE}},Ec=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=gi.get(e);return typeof n=="boolean"?n?lo.INSTANCE:ji.INSTANCE:new o(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:FN(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=gi.get(this.key);return typeof e=="boolean"?e?lo.INSTANCE:ji.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=wc.create(this.key,this)),this.negated}},Dg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?Ec.create(e,n):wc.create(e,n);let i=gi.get(e);return typeof i=="boolean"?t===(i?"true":"false")?lo.INSTANCE:ji.INSTANCE:new o(e,t,n)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:_c(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=gi.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?lo.INSTANCE:ji.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Rg.create(this.key,this.value,this)),this.negated}},ty=class o{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new o(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:_c(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n=="string"&&typeof t=="object"&&t!==null?ZH.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=ny.create(this.key,this.valueKey)),this.negated}},ny=class o{constructor(e,t){this.key=e;this.valueKey=t;this._negated=ty.create(e,t)}static create(e,t){return new o(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},Rg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?wc.create(e,n):Ec.create(e,n);let i=gi.get(e);return typeof i=="boolean"?t===(i?"true":"false")?ji.INSTANCE:lo.INSTANCE:new o(e,t,n)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:_c(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=gi.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?ji.INSTANCE:lo.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Dg.create(this.key,this.value,this)),this.negated}},wc=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=gi.get(e);return typeof n=="boolean"?n?ji.INSTANCE:lo.INSTANCE:new o(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:FN(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=gi.get(this.key);return typeof e=="boolean"?e?ji.INSTANCE:lo.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=Ec.create(this.key,this)),this.negated}};function oy(o,e){if(typeof o=="string"){let t=parseFloat(o);isNaN(t)||(o=t)}return typeof o=="string"||typeof o=="number"?e(o):ji.INSTANCE}var kg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return oy(t,i=>new o(e,i,n))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:_c(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=Ag.create(this.key,this.value,this)),this.negated}},Mg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return oy(t,i=>new o(e,i,n))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:_c(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Ng.create(this.key,this.value,this)),this.negated}},Ng=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return oy(t,i=>new o(e,i,n))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:_c(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=Mg.create(this.key,this.value,this)),this.negated}},Ag=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return oy(t,i=>new o(e,i,n))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:_c(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=kg.create(this.key,this.value,this)),this.negated}},Og=class o{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new o(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=eT.create(this)),this.negated}},eT=class o{constructor(e){this._actual=e}static create(e){return new o(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new o(this._actual.map(e))}negate(){return this._actual}};function PN(o){let e=null;for(let t=0,n=o.length;t<n;t++){let i=o[t].substituteConstants();if(o[t]!==i&&e===null){e=[];for(let r=0;r<t;r++)e[r]=o[r]}e!==null&&(e[t]=i)}return e===null?o:e}var iy=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=Lg(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=PN(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,n){let i=[],r=!1;for(let s of e)if(s){if(s.type===1){r=!0;continue}if(s.type===0)return ji.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&r)return lo.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(Lg);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){let s=i[i.length-1];if(s.type!==9)break;i.pop();let a=i.pop(),l=i.length===0,d=Pg.create(s.expr.map(c=>o.create([c,a],null,n)),null,l);d&&(i.push(d),i.sort(Lg))}if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return ji.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=Pg.create(e,this,!0)}return this.negated}},Pg=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=Lg(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=PN(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,n){let i=[],r=!1;if(e){for(let s=0,a=e.length;s<a;s++){let l=e[s];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return lo.INSTANCE;if(l.type===9){i=i.concat(l.expr);continue}i.push(l)}}if(i.length===0&&r)return ji.INSTANCE;i.sort(Lg)}if(i.length!==0){if(i.length===1)return i[0];for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return lo.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),n=e.shift(),i=[];for(let r of ON(t))for(let s of ON(n))i.push(iy.create([r,s],null,!1));e.unshift(o.create(i,null,!1))}this.negated=o.create(e,this,!0)}return this.negated}},De=class o extends Ec{static _info=[];static all(){return o._info.values()}_defaultValue;constructor(e,t,n){super(e,null),this._defaultValue=t,typeof n=="object"?o._info.push({...n,key:e}):n!==!0&&o._info.push({key:e,description:n,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return Dg.create(this.key,e)}notEqualsTo(e){return Rg.create(this.key,e)}},Qt=Z("contextKeyService");function FN(o,e){return o<e?-1:o>e?1:0}function _c(o,e,t,n){return o<t?-1:o>t?1:e<n?-1:e>n?1:0}function ON(o){return o.type===9?o.expr:[o]}var e$=Object.freeze({View:Tt("view","View"),Help:Tt("help","Help"),Test:Tt("test","Test"),File:Tt("file","File"),Preferences:Tt("preferences","Preferences"),Developer:Tt({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});function BN(o){let e=!1,t=new Map,n=new Map;if(r4(o,c=>{if(o===c)return!0;let u=JSON.stringify(c);if(u.length<30)return!0;let h=t.get(u);if(!h){let m={schemas:[c]};return t.set(u,m),n.set(c,m),!0}return h.schemas.push(c),n.set(c,h),e=!0,!1}),t.clear(),!e)return JSON.stringify(o);let r="$defs";for(;o.hasOwnProperty(r);)r+="_";let s=[];function a(c){return JSON.stringify(c,(u,h)=>{if(h!==c){let m=n.get(h);if(m&&m.schemas.length>1)return m.id||(m.id=`_${s.length}`,s.push(m.schemas[0])),{$ref:`#/${r}/${m.id}`}}return h})}let l=a(o),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${r}":{${d.join(",")}}}`:l}function ph(o){return typeof o=="object"&&o!==null}function r4(o,e){if(!o||typeof o!="object")return;let t=(...l)=>{for(let d of l)ph(d)&&s.push(d)},n=(...l)=>{for(let d of l)if(ph(d))for(let c in d){let u=d[c];ph(u)&&s.push(u)}},i=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)ph(c)&&s.push(c)},r=l=>{if(Array.isArray(l))for(let d of l)ph(d)&&s.push(d);else ph(l)&&s.push(l)},s=[o],a=s.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),i(a.anyOf,a.allOf,a.oneOf,a.prefixItems),r(a.items)),a=s.pop()}var Lo=Z("commandService"),$i=new class{_commands=new Map;_onDidRegisterCommand=new T;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(o,e){if(!o)throw new Error("invalid command");if(typeof o=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:o,handler:e})}if(o.metadata&&Array.isArray(o.metadata.args)){let s=[];for(let l of o.metadata.args)s.push(l.constraint);let a=o.handler;o.handler=function(l,...d){return SN(d,s),a(l,...d)}}let{id:t}=o,n=this._commands.get(t);n||(n=new ki,this._commands.set(t,n));let i=n.unshift(o),r=pe(()=>{i(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(o,e){return $i.registerCommand(o,(t,...n)=>t.get(Lo).executeCommand(e,...n))}getCommand(o){let e=this._commands.get(o);if(!(!e||e.isEmpty()))return Yo.first(e)}getCommands(){let o=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&o.set(e,t)}return o}};$i.registerCommand("noop",()=>{});function VN(o){return o?o.condition!==void 0:!1}var Fg=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},ry=new Fg,tT=new Fg,nT=new Fg,oT=new Array(230),s4={},a4=[],l4=Object.create(null),d4=Object.create(null);var WN=[],iT=[];for(let o=0;o<=193;o++)WN[o]=-1;for(let o=0;o<=132;o++)iT[o]=-1;(function(){let o="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",o,o],[1,1,"Hyper",0,o,0,o,o,o],[1,2,"Super",0,o,0,o,o,o],[1,3,"Fn",0,o,0,o,o,o],[1,4,"FnLock",0,o,0,o,o,o],[1,5,"Suspend",0,o,0,o,o,o],[1,6,"Resume",0,o,0,o,o,o],[1,7,"Turbo",0,o,0,o,o,o],[1,8,"Sleep",0,o,0,"VK_SLEEP",o,o],[1,9,"WakeUp",0,o,0,o,o,o],[0,10,"KeyA",31,"A",65,"VK_A",o,o],[0,11,"KeyB",32,"B",66,"VK_B",o,o],[0,12,"KeyC",33,"C",67,"VK_C",o,o],[0,13,"KeyD",34,"D",68,"VK_D",o,o],[0,14,"KeyE",35,"E",69,"VK_E",o,o],[0,15,"KeyF",36,"F",70,"VK_F",o,o],[0,16,"KeyG",37,"G",71,"VK_G",o,o],[0,17,"KeyH",38,"H",72,"VK_H",o,o],[0,18,"KeyI",39,"I",73,"VK_I",o,o],[0,19,"KeyJ",40,"J",74,"VK_J",o,o],[0,20,"KeyK",41,"K",75,"VK_K",o,o],[0,21,"KeyL",42,"L",76,"VK_L",o,o],[0,22,"KeyM",43,"M",77,"VK_M",o,o],[0,23,"KeyN",44,"N",78,"VK_N",o,o],[0,24,"KeyO",45,"O",79,"VK_O",o,o],[0,25,"KeyP",46,"P",80,"VK_P",o,o],[0,26,"KeyQ",47,"Q",81,"VK_Q",o,o],[0,27,"KeyR",48,"R",82,"VK_R",o,o],[0,28,"KeyS",49,"S",83,"VK_S",o,o],[0,29,"KeyT",50,"T",84,"VK_T",o,o],[0,30,"KeyU",51,"U",85,"VK_U",o,o],[0,31,"KeyV",52,"V",86,"VK_V",o,o],[0,32,"KeyW",53,"W",87,"VK_W",o,o],[0,33,"KeyX",54,"X",88,"VK_X",o,o],[0,34,"KeyY",55,"Y",89,"VK_Y",o,o],[0,35,"KeyZ",56,"Z",90,"VK_Z",o,o],[0,36,"Digit1",22,"1",49,"VK_1",o,o],[0,37,"Digit2",23,"2",50,"VK_2",o,o],[0,38,"Digit3",24,"3",51,"VK_3",o,o],[0,39,"Digit4",25,"4",52,"VK_4",o,o],[0,40,"Digit5",26,"5",53,"VK_5",o,o],[0,41,"Digit6",27,"6",54,"VK_6",o,o],[0,42,"Digit7",28,"7",55,"VK_7",o,o],[0,43,"Digit8",29,"8",56,"VK_8",o,o],[0,44,"Digit9",30,"9",57,"VK_9",o,o],[0,45,"Digit0",21,"0",48,"VK_0",o,o],[1,46,"Enter",3,"Enter",13,"VK_RETURN",o,o],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",o,o],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",o,o],[1,49,"Tab",2,"Tab",9,"VK_TAB",o,o],[1,50,"Space",10,"Space",32,"VK_SPACE",o,o],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,o,0,o,o,o],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",o,o],[1,64,"F1",59,"F1",112,"VK_F1",o,o],[1,65,"F2",60,"F2",113,"VK_F2",o,o],[1,66,"F3",61,"F3",114,"VK_F3",o,o],[1,67,"F4",62,"F4",115,"VK_F4",o,o],[1,68,"F5",63,"F5",116,"VK_F5",o,o],[1,69,"F6",64,"F6",117,"VK_F6",o,o],[1,70,"F7",65,"F7",118,"VK_F7",o,o],[1,71,"F8",66,"F8",119,"VK_F8",o,o],[1,72,"F9",67,"F9",120,"VK_F9",o,o],[1,73,"F10",68,"F10",121,"VK_F10",o,o],[1,74,"F11",69,"F11",122,"VK_F11",o,o],[1,75,"F12",70,"F12",123,"VK_F12",o,o],[1,76,"PrintScreen",0,o,0,o,o,o],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",o,o],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",o,o],[1,79,"Insert",19,"Insert",45,"VK_INSERT",o,o],[1,80,"Home",14,"Home",36,"VK_HOME",o,o],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",o,o],[1,82,"Delete",20,"Delete",46,"VK_DELETE",o,o],[1,83,"End",13,"End",35,"VK_END",o,o],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",o,o],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",o],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",o],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",o],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",o],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",o,o],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",o,o],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",o,o],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",o,o],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",o,o],[1,94,"NumpadEnter",3,o,0,o,o,o],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",o,o],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",o,o],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",o,o],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",o,o],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",o,o],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",o,o],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",o,o],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",o,o],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",o,o],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",o,o],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",o,o],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",o,o],[1,107,"ContextMenu",58,"ContextMenu",93,o,o,o],[1,108,"Power",0,o,0,o,o,o],[1,109,"NumpadEqual",0,o,0,o,o,o],[1,110,"F13",71,"F13",124,"VK_F13",o,o],[1,111,"F14",72,"F14",125,"VK_F14",o,o],[1,112,"F15",73,"F15",126,"VK_F15",o,o],[1,113,"F16",74,"F16",127,"VK_F16",o,o],[1,114,"F17",75,"F17",128,"VK_F17",o,o],[1,115,"F18",76,"F18",129,"VK_F18",o,o],[1,116,"F19",77,"F19",130,"VK_F19",o,o],[1,117,"F20",78,"F20",131,"VK_F20",o,o],[1,118,"F21",79,"F21",132,"VK_F21",o,o],[1,119,"F22",80,"F22",133,"VK_F22",o,o],[1,120,"F23",81,"F23",134,"VK_F23",o,o],[1,121,"F24",82,"F24",135,"VK_F24",o,o],[1,122,"Open",0,o,0,o,o,o],[1,123,"Help",0,o,0,o,o,o],[1,124,"Select",0,o,0,o,o,o],[1,125,"Again",0,o,0,o,o,o],[1,126,"Undo",0,o,0,o,o,o],[1,127,"Cut",0,o,0,o,o,o],[1,128,"Copy",0,o,0,o,o,o],[1,129,"Paste",0,o,0,o,o,o],[1,130,"Find",0,o,0,o,o,o],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",o,o],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",o,o],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",o,o],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",o,o],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",o,o],[1,136,"KanaMode",0,o,0,o,o,o],[0,137,"IntlYen",0,o,0,o,o,o],[1,138,"Convert",0,o,0,o,o,o],[1,139,"NonConvert",0,o,0,o,o,o],[1,140,"Lang1",0,o,0,o,o,o],[1,141,"Lang2",0,o,0,o,o,o],[1,142,"Lang3",0,o,0,o,o,o],[1,143,"Lang4",0,o,0,o,o,o],[1,144,"Lang5",0,o,0,o,o,o],[1,145,"Abort",0,o,0,o,o,o],[1,146,"Props",0,o,0,o,o,o],[1,147,"NumpadParenLeft",0,o,0,o,o,o],[1,148,"NumpadParenRight",0,o,0,o,o,o],[1,149,"NumpadBackspace",0,o,0,o,o,o],[1,150,"NumpadMemoryStore",0,o,0,o,o,o],[1,151,"NumpadMemoryRecall",0,o,0,o,o,o],[1,152,"NumpadMemoryClear",0,o,0,o,o,o],[1,153,"NumpadMemoryAdd",0,o,0,o,o,o],[1,154,"NumpadMemorySubtract",0,o,0,o,o,o],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",o,o],[1,156,"NumpadClearEntry",0,o,0,o,o,o],[1,0,o,5,"Ctrl",17,"VK_CONTROL",o,o],[1,0,o,4,"Shift",16,"VK_SHIFT",o,o],[1,0,o,6,"Alt",18,"VK_MENU",o,o],[1,0,o,57,"Meta",91,"VK_COMMAND",o,o],[1,157,"ControlLeft",5,o,0,"VK_LCONTROL",o,o],[1,158,"ShiftLeft",4,o,0,"VK_LSHIFT",o,o],[1,159,"AltLeft",6,o,0,"VK_LMENU",o,o],[1,160,"MetaLeft",57,o,0,"VK_LWIN",o,o],[1,161,"ControlRight",5,o,0,"VK_RCONTROL",o,o],[1,162,"ShiftRight",4,o,0,"VK_RSHIFT",o,o],[1,163,"AltRight",6,o,0,"VK_RMENU",o,o],[1,164,"MetaRight",57,o,0,"VK_RWIN",o,o],[1,165,"BrightnessUp",0,o,0,o,o,o],[1,166,"BrightnessDown",0,o,0,o,o,o],[1,167,"MediaPlay",0,o,0,o,o,o],[1,168,"MediaRecord",0,o,0,o,o,o],[1,169,"MediaFastForward",0,o,0,o,o,o],[1,170,"MediaRewind",0,o,0,o,o,o],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",o,o],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",o,o],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",o,o],[1,174,"Eject",0,o,0,o,o,o],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",o,o],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",o,o],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",o,o],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",o,o],[1,179,"LaunchApp1",0,o,0,"VK_MEDIA_LAUNCH_APP1",o,o],[1,180,"SelectTask",0,o,0,o,o,o],[1,181,"LaunchScreenSaver",0,o,0,o,o,o],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",o,o],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",o,o],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",o,o],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",o,o],[1,186,"BrowserStop",0,o,0,"VK_BROWSER_STOP",o,o],[1,187,"BrowserRefresh",0,o,0,"VK_BROWSER_REFRESH",o,o],[1,188,"BrowserFavorites",0,o,0,"VK_BROWSER_FAVORITES",o,o],[1,189,"ZoomToggle",0,o,0,o,o,o],[1,190,"MailReply",0,o,0,o,o,o],[1,191,"MailForward",0,o,0,o,o,o],[1,192,"MailSend",0,o,0,o,o,o],[1,0,o,114,"KeyInComposition",229,o,o,o],[1,0,o,116,"ABNT_C2",194,"VK_ABNT_C2",o,o],[1,0,o,96,"OEM_8",223,"VK_OEM_8",o,o],[1,0,o,0,o,0,"VK_KANA",o,o],[1,0,o,0,o,0,"VK_HANGUL",o,o],[1,0,o,0,o,0,"VK_JUNJA",o,o],[1,0,o,0,o,0,"VK_FINAL",o,o],[1,0,o,0,o,0,"VK_HANJA",o,o],[1,0,o,0,o,0,"VK_KANJI",o,o],[1,0,o,0,o,0,"VK_CONVERT",o,o],[1,0,o,0,o,0,"VK_NONCONVERT",o,o],[1,0,o,0,o,0,"VK_ACCEPT",o,o],[1,0,o,0,o,0,"VK_MODECHANGE",o,o],[1,0,o,0,o,0,"VK_SELECT",o,o],[1,0,o,0,o,0,"VK_PRINT",o,o],[1,0,o,0,o,0,"VK_EXECUTE",o,o],[1,0,o,0,o,0,"VK_SNAPSHOT",o,o],[1,0,o,0,o,0,"VK_HELP",o,o],[1,0,o,0,o,0,"VK_APPS",o,o],[1,0,o,0,o,0,"VK_PROCESSKEY",o,o],[1,0,o,0,o,0,"VK_PACKET",o,o],[1,0,o,0,o,0,"VK_DBE_SBCSCHAR",o,o],[1,0,o,0,o,0,"VK_DBE_DBCSCHAR",o,o],[1,0,o,0,o,0,"VK_ATTN",o,o],[1,0,o,0,o,0,"VK_CRSEL",o,o],[1,0,o,0,o,0,"VK_EXSEL",o,o],[1,0,o,0,o,0,"VK_EREOF",o,o],[1,0,o,0,o,0,"VK_PLAY",o,o],[1,0,o,0,o,0,"VK_ZOOM",o,o],[1,0,o,0,o,0,"VK_NONAME",o,o],[1,0,o,0,o,0,"VK_PA1",o,o],[1,0,o,0,o,0,"VK_OEM_CLEAR",o,o]],t=[],n=[];for(let i of e){let[r,s,a,l,d,c,u,h,m]=i;if(n[s]||(n[s]=!0,a4[s]=a,l4[a]=s,d4[a.toLowerCase()]=s,r&&(WN[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(iT[l]=s))),!t[l]){if(t[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);ry.define(l,d),tT.define(l,h||d),nT.define(l,m||h||d)}c&&(oT[c]=l),u&&(s4[u]=l)}iT[3]=46})();var Bg;(s=>{function o(a){return ry.keyCodeToStr(a)}s.toString=o;function e(a){return ry.strToKeyCode(a)}s.fromString=e;function t(a){return tT.keyCodeToStr(a)}s.toUserSettingsUS=t;function n(a){return nT.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function i(a){return tT.strToKeyCode(a)||nT.strToKeyCode(a)}s.fromUserSettings=i;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return ry.keyCodeToStr(a)}s.toElectronAccelerator=r})(Bg||={});function Do(o,e){let t=(e&65535)<<16>>>0;return(o|t)>>>0}function rT(o,e){if(typeof o=="number"){if(o===0)return null;let t=(o&65535)>>>0,n=(o&4294901760)>>>16;return n!==0?new mh([sy(t,e),sy(n,e)]):new mh([sy(t,e)])}else{let t=[];for(let n=0;n<o.length;n++)t.push(sy(o[n],e));return new mh(t)}}function sy(o,e){let t=!!(o&2048),n=!!(o&256),i=e===2?n:t,r=!!(o&1024),s=!!(o&512),a=e===2?t:n,l=o&255;return new Vg(i,r,s,a,l)}var Vg=class o{constructor(e,t,n,i,r){this.ctrlKey=e;this.shiftKey=t;this.altKey=n;this.metaKey=i;this.keyCode=r}equals(e){return e instanceof o&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",t=this.shiftKey?"1":"0",n=this.altKey?"1":"0",i=this.metaKey?"1":"0";return`K${e}${t}${n}${i}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new mh([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var mh=class{chords;constructor(e){if(e.length===0)throw as("chords");this.chords=e}getHashCode(){let e="";for(let t=0,n=this.chords.length;t<n;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};var sT=class{data=new Map;add(e,t){Av(sn(e)),Av(hn(t)),Av(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},Je=new sT;var aT=class o{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new ki,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Zs===1){if(e&&e.win)return e.win}else if(Zs===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){let t=o.bindToCurrentPlatform(e),n=new oe;if(t&&t.primary){let i=rT(t.primary,Zs);i&&n.add(this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let i=0,r=t.secondary.length;i<r;i++){let s=t.secondary[i],a=rT(s,Zs);a&&n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-i-1,e.when))}return n}setExtensionKeybindings(e){let t=[],n=0;for(let i of e)i.keybinding&&(t[n++]={keybinding:i.keybinding,command:i.id,commandArgs:i.args,when:i.when,weight1:i.weight,weight2:0,extensionId:i.extensionId||null,isBuiltinExtension:i.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return Zo(this.registerKeybindingRule(e),$i.registerCommand(e))}_registerDefaultKeybinding(e,t,n,i,r,s){let a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:s,weight1:i,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,pe(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(u4)),this._cachedMergedKeybindings.slice(0)}},dd=new aT,c4={EditorModes:"platform.keybindingsRegistry"};Je.add(c4.EditorModes,dd);function u4(o,e){if(o.weight1!==e.weight1)return o.weight1-e.weight1;if(o.command&&e.command){if(o.command<e.command)return-1;if(o.command>e.command)return 1}return o.weight2-e.weight2}function gh(o){return o.command!==void 0}function HN(o){return o.submenu!==void 0}var ot=class o{static _instances=new Map;static CommandPalette=new o("CommandPalette");static DebugBreakpointsContext=new o("DebugBreakpointsContext");static DebugCallStackContext=new o("DebugCallStackContext");static DebugConsoleContext=new o("DebugConsoleContext");static DebugVariablesContext=new o("DebugVariablesContext");static NotebookVariablesContext=new o("NotebookVariablesContext");static DebugHoverContext=new o("DebugHoverContext");static DebugWatchContext=new o("DebugWatchContext");static DebugToolBar=new o("DebugToolBar");static DebugToolBarStop=new o("DebugToolBarStop");static DebugCallStackToolbar=new o("DebugCallStackToolbar");static DebugCreateConfiguration=new o("DebugCreateConfiguration");static EditorContext=new o("EditorContext");static SimpleEditorContext=new o("SimpleEditorContext");static EditorContent=new o("EditorContent");static EditorLineNumberContext=new o("EditorLineNumberContext");static EditorContextCopy=new o("EditorContextCopy");static EditorContextPeek=new o("EditorContextPeek");static EditorContextShare=new o("EditorContextShare");static EditorTitle=new o("EditorTitle");static EditorTitleRun=new o("EditorTitleRun");static EditorTitleContext=new o("EditorTitleContext");static EditorTitleContextShare=new o("EditorTitleContextShare");static EmptyEditorGroup=new o("EmptyEditorGroup");static EmptyEditorGroupContext=new o("EmptyEditorGroupContext");static EditorTabsBarContext=new o("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new o("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new o("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new o("EditorActionsPositionSubmenu");static ExplorerContext=new o("ExplorerContext");static ExplorerContextShare=new o("ExplorerContextShare");static ExtensionContext=new o("ExtensionContext");static ExtensionEditorContextMenu=new o("ExtensionEditorContextMenu");static GlobalActivity=new o("GlobalActivity");static CommandCenter=new o("CommandCenter");static CommandCenterCenter=new o("CommandCenterCenter");static LayoutControlMenuSubmenu=new o("LayoutControlMenuSubmenu");static LayoutControlMenu=new o("LayoutControlMenu");static MenubarMainMenu=new o("MenubarMainMenu");static MenubarAppearanceMenu=new o("MenubarAppearanceMenu");static MenubarDebugMenu=new o("MenubarDebugMenu");static MenubarEditMenu=new o("MenubarEditMenu");static MenubarCopy=new o("MenubarCopy");static MenubarFileMenu=new o("MenubarFileMenu");static MenubarGoMenu=new o("MenubarGoMenu");static MenubarHelpMenu=new o("MenubarHelpMenu");static MenubarLayoutMenu=new o("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new o("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new o("PanelAlignmentMenu");static PanelPositionMenu=new o("PanelPositionMenu");static ActivityBarPositionMenu=new o("ActivityBarPositionMenu");static MenubarPreferencesMenu=new o("MenubarPreferencesMenu");static MenubarRecentMenu=new o("MenubarRecentMenu");static MenubarSelectionMenu=new o("MenubarSelectionMenu");static MenubarShare=new o("MenubarShare");static MenubarSwitchEditorMenu=new o("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new o("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new o("MenubarTerminalMenu");static MenubarViewMenu=new o("MenubarViewMenu");static MenubarHomeMenu=new o("MenubarHomeMenu");static OpenEditorsContext=new o("OpenEditorsContext");static OpenEditorsContextShare=new o("OpenEditorsContextShare");static ProblemsPanelContext=new o("ProblemsPanelContext");static SCMInputBox=new o("SCMInputBox");static SCMChangesContext=new o("SCMChangesContext");static SCMChangeContext=new o("SCMChangeContext");static SCMResourceContext=new o("SCMResourceContext");static SCMResourceContextShare=new o("SCMResourceContextShare");static SCMResourceFolderContext=new o("SCMResourceFolderContext");static SCMResourceGroupContext=new o("SCMResourceGroupContext");static SCMSourceControl=new o("SCMSourceControl");static SCMSourceControlInline=new o("SCMSourceControlInline");static SCMSourceControlTitle=new o("SCMSourceControlTitle");static SCMHistoryTitle=new o("SCMHistoryTitle");static SCMTitle=new o("SCMTitle");static SearchContext=new o("SearchContext");static SearchActionMenu=new o("SearchActionContext");static StatusBarWindowIndicatorMenu=new o("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new o("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new o("StickyScrollContext");static TestItem=new o("TestItem");static TestItemGutter=new o("TestItemGutter");static TestProfilesContext=new o("TestProfilesContext");static TestMessageContext=new o("TestMessageContext");static TestMessageContent=new o("TestMessageContent");static TestPeekElement=new o("TestPeekElement");static TestPeekTitle=new o("TestPeekTitle");static TestCallStack=new o("TestCallStack");static TouchBarContext=new o("TouchBarContext");static TitleBarContext=new o("TitleBarContext");static TitleBarTitleContext=new o("TitleBarTitleContext");static TunnelContext=new o("TunnelContext");static TunnelPrivacy=new o("TunnelPrivacy");static TunnelProtocol=new o("TunnelProtocol");static TunnelPortInline=new o("TunnelInline");static TunnelTitle=new o("TunnelTitle");static TunnelLocalAddressInline=new o("TunnelLocalAddressInline");static TunnelOriginInline=new o("TunnelOriginInline");static ViewItemContext=new o("ViewItemContext");static ViewContainerTitle=new o("ViewContainerTitle");static ViewContainerTitleContext=new o("ViewContainerTitleContext");static ViewTitle=new o("ViewTitle");static ViewTitleContext=new o("ViewTitleContext");static CommentEditorActions=new o("CommentEditorActions");static CommentThreadTitle=new o("CommentThreadTitle");static CommentThreadActions=new o("CommentThreadActions");static CommentThreadAdditionalActions=new o("CommentThreadAdditionalActions");static CommentThreadTitleContext=new o("CommentThreadTitleContext");static CommentThreadCommentContext=new o("CommentThreadCommentContext");static CommentTitle=new o("CommentTitle");static CommentActions=new o("CommentActions");static CommentsViewThreadActions=new o("CommentsViewThreadActions");static InteractiveToolbar=new o("InteractiveToolbar");static InteractiveCellTitle=new o("InteractiveCellTitle");static InteractiveCellDelete=new o("InteractiveCellDelete");static InteractiveCellExecute=new o("InteractiveCellExecute");static InteractiveInputExecute=new o("InteractiveInputExecute");static InteractiveInputConfig=new o("InteractiveInputConfig");static ReplInputExecute=new o("ReplInputExecute");static IssueReporter=new o("IssueReporter");static NotebookToolbar=new o("NotebookToolbar");static NotebookStickyScrollContext=new o("NotebookStickyScrollContext");static NotebookCellTitle=new o("NotebookCellTitle");static NotebookCellDelete=new o("NotebookCellDelete");static NotebookCellInsert=new o("NotebookCellInsert");static NotebookCellBetween=new o("NotebookCellBetween");static NotebookCellListTop=new o("NotebookCellTop");static NotebookCellExecute=new o("NotebookCellExecute");static NotebookCellExecuteGoTo=new o("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new o("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new o("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new o("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new o("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new o("NotebookOutputToolbar");static NotebookOutlineFilter=new o("NotebookOutlineFilter");static NotebookOutlineActionMenu=new o("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new o("NotebookEditorLayoutConfigure");static NotebookKernelSource=new o("NotebookKernelSource");static BulkEditTitle=new o("BulkEditTitle");static BulkEditContext=new o("BulkEditContext");static TimelineItemContext=new o("TimelineItemContext");static TimelineTitle=new o("TimelineTitle");static TimelineTitleContext=new o("TimelineTitleContext");static TimelineFilterSubMenu=new o("TimelineFilterSubMenu");static AccountsContext=new o("AccountsContext");static SidebarTitle=new o("SidebarTitle");static PanelTitle=new o("PanelTitle");static AuxiliaryBarTitle=new o("AuxiliaryBarTitle");static AuxiliaryBarHeader=new o("AuxiliaryBarHeader");static TerminalInstanceContext=new o("TerminalInstanceContext");static TerminalEditorInstanceContext=new o("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new o("TerminalNewDropdownContext");static TerminalTabContext=new o("TerminalTabContext");static TerminalTabEmptyAreaContext=new o("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new o("TerminalStickyScrollContext");static WebviewContext=new o("WebviewContext");static InlineCompletionsActions=new o("InlineCompletionsActions");static InlineEditsActions=new o("InlineEditsActions");static InlineEditActions=new o("InlineEditActions");static NewFile=new o("NewFile");static MergeInput1Toolbar=new o("MergeToolbar1Toolbar");static MergeInput2Toolbar=new o("MergeToolbar2Toolbar");static MergeBaseToolbar=new o("MergeBaseToolbar");static MergeInputResultToolbar=new o("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new o("InlineSuggestionToolbar");static InlineEditToolbar=new o("InlineEditToolbar");static ChatContext=new o("ChatContext");static ChatCodeBlock=new o("ChatCodeblock");static ChatCompareBlock=new o("ChatCompareBlock");static ChatMessageTitle=new o("ChatMessageTitle");static ChatExecute=new o("ChatExecute");static ChatExecuteSecondary=new o("ChatExecuteSecondary");static ChatInputSide=new o("ChatInputSide");static AccessibleView=new o("AccessibleView");static MultiDiffEditorFileToolbar=new o("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new o("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new o("DiffEditorSelectionToolbar");static for(e){return o._instances.get(e)??new o(e)}id;constructor(e){if(o._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);o._instances.set(e,this),this.id=e}},Hg=Z("menuService"),Tc=class o{constructor(e){this.id=e;this.has=t=>t===e}static _all=new Map;static for(e){let t=this._all.get(e);return t||(t=new o(e),this._all.set(e,t)),t}static merge(e){let t=new Set;for(let n of e)n instanceof o&&t.add(n.id);return t}has},Qo=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new Kv({merge:Tc.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(o){return this._commands.set(o.id,o),this._onDidChangeMenu.fire(Tc.for(ot.CommandPalette)),pe(()=>{this._commands.delete(o.id)&&this._onDidChangeMenu.fire(Tc.for(ot.CommandPalette))})}getCommand(o){return this._commands.get(o)}getCommands(){let o=new Map;return this._commands.forEach((e,t)=>o.set(t,e)),o}appendMenuItem(o,e){let t=this._menuItems.get(o);t||(t=new ki,this._menuItems.set(o,t));let n=t.push(e);return this._onDidChangeMenu.fire(Tc.for(o)),pe(()=>{n(),this._onDidChangeMenu.fire(Tc.for(o))})}appendMenuItems(o){let e=new oe;for(let{id:t,item:n}of o)e.add(this.appendMenuItem(t,n));return e}getMenuItems(o){let e;return this._menuItems.has(o)?e=[...this._menuItems.get(o)]:e=[],o===ot.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(o){let e=new Set;for(let t of o)gh(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,n)=>{e.has(n)||o.push({command:t})})}},il=class extends el{constructor(t,n,i){super(`submenuitem.${t.submenu.id}`,typeof t.title=="string"?t.title:t.title.value,i,"submenu");this.item=t;this.hideActions=n}},co=class{constructor(e,t,n,i,r,s,a){this.hideActions=i;this.menuKeybinding=r;this._commandService=a;this.id=e.id,this.label=co.label(e,n),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||s.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){let d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&Xe.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=Xe.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new co(t,void 0,n,i,void 0,s,a):void 0,this._options=n,this.class=l&&Xe.asClassName(l)}static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};co=k([E(5,Qt),E(6,Lo)],co);var Ni=class{constructor(e){this.desc=e}};function bn(o){let e=[],t=new o,{f1:n,menu:i,keybinding:r,...s}=t.desc;if($i.getCommand(s.id))throw new Error(`Cannot register two commands with the same id: ${s.id}`);if(e.push($i.registerCommand({id:s.id,handler:(a,...l)=>t.run(a,...l),metadata:s.metadata})),Array.isArray(i))for(let a of i)e.push(Qo.appendMenuItem(a.id,{command:{...s,precondition:a.precondition===null?void 0:s.precondition},...a}));else i&&e.push(Qo.appendMenuItem(i.id,{command:{...s,precondition:i.precondition===null?void 0:s.precondition},...i}));if(n&&(e.push(Qo.appendMenuItem(ot.CommandPalette,{command:s,when:s.precondition})),e.push(Qo.addCommand(s))),Array.isArray(r))for(let a of r)e.push(dd.registerKeybindingRule({...a,id:s.id,when:s.precondition?ht.and(s.precondition,a.when):a.when}));else r&&e.push(dd.registerKeybindingRule({...r,id:s.id,when:s.precondition?ht.and(s.precondition,r.when):r.when}));return{dispose(){Nt(e)}}}function cd(o){return o===47||o===92}function ly(o){return o.replace(/[\\/]/g,bt.sep)}function zN(o){return o.indexOf("/")===-1&&(o=ly(o)),/^[a-zA-Z]:(\/|$)/.test(o)&&(o="/"+o),o}function lT(o,e=bt.sep){if(!o)return"";let t=o.length,n=o.charCodeAt(0);if(cd(n)){if(cd(o.charCodeAt(1))&&!cd(o.charCodeAt(2))){let r=3,s=r;for(;r<t&&!cd(o.charCodeAt(r));r++);if(s!==r&&!cd(o.charCodeAt(r+1))){for(r+=1;r<t;r++)if(cd(o.charCodeAt(r)))return o.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(KN(n)&&o.charCodeAt(1)===58)return cd(o.charCodeAt(2))?o.slice(0,2)+e:o.slice(0,2);let i=o.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(cd(o.charCodeAt(i)))return o.slice(0,i+1)}return""}function Ug(o,e,t,n=_o){if(o===e)return!0;if(!o||!e||e.length>o.length)return!1;if(t){if(!rd(o,e))return!1;if(e.length===o.length)return!0;let r=e.length;return e.charAt(e.length-1)===n&&r--,o.charAt(r)===n}return e.charAt(e.length-1)!==n&&(e+=n),o.indexOf(e)===0}function KN(o){return o>=65&&o<=90||o>=97&&o<=122}function GN(o,e=ft){return e?KN(o.charCodeAt(0))&&o.charCodeAt(1)===58:!1}function jN(o,e=ft){return GN(o,e)?o[0]:void 0}function $N(o,e,t){return e.length>o.length?-1:o===e?0:(t&&(o=o.toLowerCase(),e=e.toLowerCase()),o.indexOf(e))}function qN(o){let e=o.split(":"),t,n,i;for(let r of e){let s=Number(r);mi(s)?n===void 0?n=s:i===void 0&&(i=s):t=t?[t,r].join(":"):r}if(!t)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:t,line:n!==void 0?n:void 0,column:i!==void 0?i:n!==void 0?1:void 0}}var Ae;(Re=>(Re.inMemory="inmemory",Re.vscode="vscode",Re.internal="private",Re.walkThrough="walkThrough",Re.walkThroughSnippet="walkThroughSnippet",Re.http="http",Re.https="https",Re.file="file",Re.mailto="mailto",Re.untitled="untitled",Re.data="data",Re.command="command",Re.vscodeRemote="vscode-remote",Re.vscodeRemoteResource="vscode-remote-resource",Re.vscodeManagedRemoteResource="vscode-managed-remote-resource",Re.vscodeUserData="vscode-userdata",Re.vscodeCustomEditor="vscode-custom-editor",Re.vscodeNotebookCell="vscode-notebook-cell",Re.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Re.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",Re.vscodeNotebookCellOutput="vscode-notebook-cell-output",Re.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",Re.vscodeNotebookMetadata="vscode-notebook-metadata",Re.vscodeInteractiveInput="vscode-interactive-input",Re.vscodeSettings="vscode-settings",Re.vscodeWorkspaceTrust="vscode-workspace-trust",Re.vscodeTerminal="vscode-terminal",Re.vscodeChatCodeBlock="vscode-chat-code-block",Re.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",Re.vscodeChatSesssion="vscode-chat-editor",Re.webviewPanel="webview-panel",Re.vscodeWebview="vscode-webview",Re.extension="extension",Re.vscodeFileResource="vscode-file",Re.tmp="tmp",Re.vsls="vsls",Re.vscodeSourceControl="vscode-scm",Re.commentsInput="comment",Re.codeSetting="code-setting",Re.outputChannel="output"))(Ae||={});function fh(o,e){return ne.isUri(o)?jr(o.scheme,e):rd(o,e+":")}var p4="tkn",dT=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=m4(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return bt.join(this._serverRootPath,Ae.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Ne(a),e}let t=e.authority,n=this._hosts[t];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let i=this._ports[t],r=this._connectionTokens[t],s=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(s+=`&${p4}=${encodeURIComponent(r)}`),ne.from({scheme:wo?this._preferredWebSchema:Ae.vscodeRemoteResource,authority:`${n}:${i}`,path:this._remoteResourcesPath,query:s})}},dy=new dT;function m4(o,e){return bt.join(e??"/",`${o.quality??"oss"}-${o.commit??"dev"}`)}var uT="vscode-app",cT=class o{static FALLBACK_AUTHORITY=uT;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===Ae.vscodeRemote?dy.rewrite(e):e.scheme===Ae.file&&(Ys||HM===`${Ae.vscodeFileResource}://${o.FALLBACK_AUTHORITY}`)?e.with({scheme:Ae.vscodeFileResource,authority:e.authority||o.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===Ae.vscodeFileResource?e.with({scheme:Ae.file,authority:e.authority!==o.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(ne.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n))return ne.joinPath(ne.parse(n,!0),e);let i=Cr(n,e);return ne.file(i)}return ne.parse(t.toUrl(e))}},ud=new cT,g4;(r=>{let o=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(o.get("3"));let t="vscode-coi";function n(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:ne.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(t);if(l)return o.get(l)}r.getHeadersFromQuery=n;function i(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(t,d):s[t]=d}r.addSearchParam=i})(g4||={});function ol(o){return cg(o,!0)}var zg=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:q_(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===Ae.file)return Ug(ol(e),ol(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if(YN(e.authority,t.authority))return Ug(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return ne.joinPath(e,...t)}basenameOrAuthority(e){return uo(e)||e.authority}basename(e){return bt.basename(e.path)}extname(e){return bt.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Ae.file?t=ne.file(eh(ol(e))).path:(t=bt.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Ae.file?t=ne.file(td(ol(e))).path:t=bt.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!YN(e.authority,t.authority))return;if(e.scheme===Ae.file){let r=ZM(ol(e),ol(t));return ft?ly(r):r}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(let s=Math.min(n.length,i.length);r<s&&!(n.charCodeAt(r)!==i.charCodeAt(r)&&n.charAt(r).toLowerCase()!==i.charAt(r).toLowerCase());r++);n=i.substr(0,r)+n.substr(r)}return bt.relative(n,i)}resolvePath(e,t){if(e.scheme===Ae.file){let n=ne.file(Ju(ol(e),t));return e.with({authority:n.authority,path:n.path})}return t=zN(t),e.with({path:bt.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&jr(e,t)}hasTrailingPathSeparator(e,t=_o){if(e.scheme===Ae.file){let n=ol(e);return n.length>lT(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=_o){return ZN(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=_o){let n=!1;if(e.scheme===Ae.file){let i=ol(e);n=i!==void 0&&i.length===lT(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!ZN(e,t)?e.with({path:e.path+"/"}):e}},Dt=new zg(()=>!1),f4=new zg(o=>o.scheme===Ae.file?!Zt:!0),b4=new zg(o=>!0),_n=Dt.isEqual.bind(Dt),Uq=Dt.isEqualOrParent.bind(Dt),zq=Dt.getComparisonKey.bind(Dt),v4=Dt.basenameOrAuthority.bind(Dt),uo=Dt.basename.bind(Dt),y4=Dt.extname.bind(Dt),hd=Dt.dirname.bind(Dt),mt=Dt.joinPath.bind(Dt),Kq=Dt.normalizePath.bind(Dt),bh=Dt.relativePath.bind(Dt),hT=Dt.resolvePath.bind(Dt),Gq=Dt.isAbsolutePath.bind(Dt),YN=Dt.isEqualAuthority.bind(Dt),ZN=Dt.hasTrailingPathSeparator.bind(Dt),jq=Dt.removeTrailingPathSeparator.bind(Dt),$q=Dt.addTrailingPathSeparator.bind(Dt);var I4;(r=>{r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[u,h]=c.split(":");u&&h&&a.set(u,h)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(r.META_DATA_MIME,d),a}r.parseMetaData=i})(I4||={});var Ro=Z("environmentService"),Qq=Ro;var pd=Z("contextService");function uy(o){let e=o;return typeof e?.id=="string"&&ne.isUri(e.uri)}function hy(o){let e=o;return typeof e?.id=="string"&&ne.isUri(e.configPath)}var XN="code-workspace",hY=`.${XN}`,pY=[{name:p("codeWorkspace","Code Workspace"),extensions:[XN]}];var rt=Z("configurationService");function QN(o){return o.applicationValue!==void 0||o.userValue!==void 0||o.userLocalValue!==void 0||o.userRemoteValue!==void 0||o.workspaceValue!==void 0||o.workspaceFolderValue!==void 0}function JN(o){return o.replace(/[\[\]]/g,"")}var Lc={JSONContribution:"base.contributions.json"};function S4(o){return o.length>0&&o.charAt(o.length-1)==="#"?o.substring(0,o.length-1):o}var pT=class{schemasById;_onDidChangeSchema=new T;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(e,t){this.schemasById[S4(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?BN(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}},x4=new pT;Je.add(Lc.JSONContribution,x4);var AY=Z("policy");var $r={Configuration:"base.contributions.configuration"};var py={properties:{},patternProperties:{}},my={properties:{},patternProperties:{}},gy={properties:{},patternProperties:{}},fy={properties:{},patternProperties:{}},by={properties:{},patternProperties:{}},Kg={properties:{},patternProperties:{}},Dc="vscode://schemas/settings/resourceLanguage";var vy=Je.as(Lc.JSONContribution),mT=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new T;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new T;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:p("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},vy.registerSchema(Dc,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){let n=new Set;this.doRegisterConfigurations(e,t,n),vy.registerSchema(Dc,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),vy.registerSchema(Dc,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),vy.registerSchema(Dc,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let n=[];for(let{overrides:i,source:r}of e)for(let s in i){t.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=i[s];if(a.configurationDefaultOverrides.push({value:l,source:r}),vh.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,r),n.push(...E4(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let n of e){let i=this.registeredConfigurationDefaults.indexOf(n);i!==-1&&this.registeredConfigurationDefaults.splice(i,1)}for(let{overrides:n,source:i}of e)for(let r in n){let s=this.configurationDefaultsOverrides.get(r);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>i?l.source?.id===i.id:l.value===n[r]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(r),vh.test(r)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(r,d.value,d.source,l);l&&!bc(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(r,l,i)):(this.configurationDefaultsOverrides.delete(r),delete this.configurationProperties[r],delete this.defaultLanguageConfigurationOverridesNode.properties[r])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(r,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}t.add(r)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){let i={type:"object",default:t.value,description:p("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",JN(e)),$ref:Dc,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=i,this.defaultLanguageConfigurationOverridesNode.properties[e]=i}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,i){let r=i?.value||{},s=i?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(t)){let l=t[a];if(hn(l)&&(an(r[a])||hn(r[a]))){if(r[a]={...r[a]??{},...l},n)for(let c in l)s.set(`${a}.${c}`,n)}else r[a]=l,n?s.set(a,n):s.delete(a)}return{value:r,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,i){let r=this.configurationProperties[e],s=i?.value??r?.defaultDefaultValue,a=n;if(hn(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(an(s)||hn(s)))){if(a=i?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in t)n&&a.set(`${e}.${d}`,n);t={...hn(s)?s:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1,n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(i=>{this.validateAndRegisterProperties(i,t,i.extensionInfo,i.restrictedProperties,void 0,n),this.configurationContributors.push(i),this.registerJSONConfiguration(i)})}doDeregisterConfigurations(e,t){let n=i=>{if(i.properties)for(let r in i.properties){t.add(r);let s=this.configurationProperties[r];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[r],this.removeFromSchema(r,i.properties[r])}i.allOf?.forEach(r=>n(r))};for(let i of e){n(i);let r=this.configurationContributors.indexOf(i);r!==-1&&this.configurationContributors.splice(r,1)}}validateAndRegisterProperties(e,t=!0,n,i,r=3,s){r=Mi(e.scope)?r:e.scope;let a=e.properties;if(a)for(let d in a){let c=a[d];if(t&&_4(d,c)){delete a[d];continue}if(c.source=n,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),vh.test(d)?c.scope=void 0:(c.scope=Mi(c.scope)?r:c.scope,c.restricted=Mi(c.restricted)?!!i?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=e.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,t,n,i,r,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=n=>{let i=n.properties;if(i)for(let s in i)this.updateSchema(s,i[s]);n.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(py.properties[e]=t,t.scope){case 1:my.properties[e]=t;break;case 2:gy.properties[e]=t;break;case 6:fy.properties[e]=t;break;case 3:by.properties[e]=t;break;case 4:Kg.properties[e]=t;break;case 5:Kg.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete py.properties[e],t.scope){case 1:delete my.properties[e];break;case 2:delete gy.properties[e];break;case 6:delete fy.properties[e];break;case 3:delete by.properties[e];break;case 4:case 5:delete Kg.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,n={type:"object",description:p("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:p("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:Dc};this.updatePropertyDefaultValue(t,n),py.properties[t]=n,my.properties[t]=n,gy.properties[t]=n,fy.properties[t]=n,by.properties[t]=n,Kg.properties[t]=n}}registerOverridePropertyPatternKey(){let e={type:"object",description:p("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:p("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:Dc};py.patternProperties[Rc]=e,my.patternProperties[Rc]=e,gy.patternProperties[Rc]=e,fy.patternProperties[Rc]=e,by.patternProperties[Rc]=e,Kg.patternProperties[Rc]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,i,r;n&&(!t.disallowConfigurationDefault||!n.source)&&(i=n.value,r=n.source),an(i)&&(i=t.defaultDefaultValue,r=void 0),an(i)&&(i=w4(t.type)),t.default=i,t.defaultValueSource=r}},tA="\\[([^\\]]+)\\]",eA=new RegExp(tA,"g"),Rc=`^(${tA})+$`,vh=new RegExp(Rc);function E4(o){let e=[];if(vh.test(o)){let t=eA.exec(o);for(;t?.length;){let n=t[1].trim();n&&e.push(n),t=eA.exec(o)}}return qa(e)}function w4(o){switch(Array.isArray(o)?o[0]:o){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var yy=new mT;Je.add($r.Configuration,yy);function _4(o,e){return o.trim()?vh.test(o)?p("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",o):yy.getConfigurationProperties()[o]!==void 0?p("config.property.duplicate","Cannot register '{0}'. This property is already registered.",o):e.policy?.name&&yy.getPolicyConfigurations().get(e.policy?.name)!==void 0?p("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",o,e.policy?.name,yy.getPolicyConfigurations().get(e.policy?.name)):null:p("config.property.empty","Cannot register an empty property")}var ZY=new Uint32Array(10);var XY=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),QY=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),JY=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),eZ=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function iA(...o){return function(e,t){for(let n=0,i=o.length;n<i;n++){let r=o[n](e,t);if(r)return r}return null}}var aZ=oA.bind(void 0,!1),yh=oA.bind(void 0,!0);function oA(o,e,t){if(!t||t.length<e.length)return null;let n;return o?n=rd(t,e):n=t.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}function T4(o,e){let t=e.toLowerCase().indexOf(o.toLowerCase());return t===-1?null:[{start:t,end:t+o.length}]}function L4(o,e){return fT(o.toLowerCase(),e.toLowerCase(),0,0)}function fT(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]===e[n]){let i=null;return(i=fT(o,e,t+1,n+1))?sA({start:n,end:n+1},i):null}return fT(o,e,t,n+1)}function IT(o){return 97<=o&&o<=122}function jg(o){return 65<=o&&o<=90}function CT(o){return 48<=o&&o<=57}function D4(o){return o===32||o===9||o===10||o===13}var R4=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(o=>R4.add(o.charCodeAt(0)));function rA(o){return IT(o)||jg(o)||CT(o)}function sA(o,e){return e.length===0?e=[o]:o.end===e[0].start?e[0].start=o.start:e.unshift(o),e}function aA(o,e){for(let t=e;t<o.length;t++){let n=o.charCodeAt(t);if(jg(n)||CT(n)||t>0&&!rA(o.charCodeAt(t-1)))return t}return o.length}function bT(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]!==e[n].toLowerCase())return null;{let i=null,r=n+1;for(i=bT(o,e,t+1,n+1);!i&&(r=aA(e,r))<e.length;)i=bT(o,e,t+1,r),r++;return i===null?null:sA({start:n,end:n+1},i)}}function k4(o){let e=0,t=0,n=0,i=0,r=0;for(let c=0;c<o.length;c++)r=o.charCodeAt(c),jg(r)&&e++,IT(r)&&t++,rA(r)&&n++,CT(r)&&i++;let s=e/o.length,a=t/o.length,l=n/o.length,d=i/o.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function M4(o){let{upperPercent:e,lowerPercent:t}=o;return t===0&&e>.6}function N4(o){let{upperPercent:e,lowerPercent:t,alphaPercent:n,numericPercent:i}=o;return t>.2&&e<.8&&n>.6&&i<.2}function A4(o){let e=0,t=0,n=0,i=0;for(let r=0;r<o.length;r++)n=o.charCodeAt(r),jg(n)&&e++,IT(n)&&t++,D4(n)&&i++;return(e===0||t===0)&&i===0?o.length<=30:e<=5}function lA(o,e){if(!e||(e=e.trim(),e.length===0)||!A4(o))return null;e.length>60&&(e=e.substring(0,60));let t=k4(e);if(!N4(t)){if(!M4(t))return null;e=e.toLowerCase()}let n=null,i=0;for(o=o.toLowerCase();i<e.length&&(n=bT(o,e,0,i))===null;)i=aA(e,i+1);return n}var lZ=iA(yh,lA,T4),dZ=iA(yh,lA,L4),cZ=new Ri(1e4);function dA(o,e){let t=xT(o,o.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?cA(t):null}function cA(o){if(typeof o>"u")return[];let e=[],t=o[1];for(let n=o.length-1;n>1;n--){let i=o[n]+t,r=e[e.length-1];r&&r.end===i?r.end=i+1:e.push({start:i,end:i+1})}return e}var gd=128;function ST(){let o=[],e=[];for(let t=0;t<=gd;t++)e[t]=0;for(let t=0;t<=gd;t++)o.push(e.slice(0));return o}function uA(o){let e=[];for(let t=0;t<=o;t++)e[t]=0;return e}var hA=uA(2*gd),vT=uA(2*gd),ia=ST(),md=ST(),Gg=ST(),O4=!1;function gT(o,e,t,n,i){function r(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${n.split("").map(a=>r(a,3)).join("|")}
`;for(let a=0;a<=t;a++)a===0?s+=" |":s+=`${e[a-1]}|`,s+=o[a].slice(0,i+1).map(l=>r(l.toString(),3)).join("|")+`
`;return s}function P4(o,e,t,n){o=o.substr(e),t=t.substr(n),console.log(gT(md,o,o.length,t,t.length)),console.log(gT(Gg,o,o.length,t,t.length)),console.log(gT(ia,o,o.length,t,t.length))}function Iy(o,e){if(e<0||e>=o.length)return!1;let t=o.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!Tg(t)}}function nA(o,e){if(e<0||e>=o.length)return!1;switch(o.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function Cy(o,e,t){return e[o]!==t[o]}function F4(o,e,t,n,i,r,s=!1){for(;e<t&&i<r;)o[e]===n[i]&&(s&&(hA[e]=i),e+=1),i+=1;return e===t}var pA;(t=>{t.Default=[-100,0];function e(n){return!n||n.length===2&&n[0]===-100&&n[1]===0}t.isDefault=e})(pA||={});var yT=class{constructor(e,t){this.firstMatchCanBeWeak=e;this.boostFullMatch=t}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function xT(o,e,t,n,i,r,s=yT.default){let a=o.length>gd?gd:o.length,l=n.length>gd?gd:n.length;if(t>=a||r>=l||a-t>l-r||!F4(e,t,a,i,r,l,!0))return;B4(a,l,t,r,e,i);let d=1,c=1,u=t,h=r,m=[!1];for(d=1,u=t;u<a;d++,u++){let C=hA[u],S=vT[u],w=u+1<a?vT[u+1]:l;for(c=C-r+1,h=C;h<w;c++,h++){let R=Number.MIN_SAFE_INTEGER,M=!1;h<=S&&(R=V4(o,e,u,t,n,i,h,l,r,ia[d-1][c-1]===0,m));let N=0;R!==Number.MAX_SAFE_INTEGER&&(M=!0,N=R+md[d-1][c-1]);let A=h>C,P=A?md[d][c-1]+(ia[d][c-1]>0?-5:0):0,K=h>C+1&&ia[d][c-1]>0,j=K?md[d][c-2]+(ia[d][c-2]>0?-5:0):0;if(K&&(!A||j>=P)&&(!M||j>=N))md[d][c]=j,Gg[d][c]=3,ia[d][c]=0;else if(A&&(!M||P>=N))md[d][c]=P,Gg[d][c]=2,ia[d][c]=0;else if(M)md[d][c]=N,Gg[d][c]=1,ia[d][c]=ia[d-1][c-1]+1;else throw new Error("not possible")}}if(O4&&P4(o,t,n,r),!m[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let g=[md[d][c],r],f=0,b=0;for(;d>=1;){let C=c;do{let S=Gg[d][C];if(S===3)C=C-2;else if(S===2)C=C-1;else break}while(C>=1);f>1&&e[t+d-1]===i[r+c-1]&&!Cy(C+r-1,n,i)&&f+1>ia[d][C]&&(C=c),C===c?f++:f=1,b||(b=C),d--,c=C-1,g.push(c)}l-r===a&&s.boostFullMatch&&(g[0]+=2);let y=b-a;return g[0]-=y,g}function B4(o,e,t,n,i,r){let s=o-1,a=e-1;for(;s>=t&&a>=n;)i[s]===r[a]&&(vT[s]=a,s--),a--}function V4(o,e,t,n,i,r,s,a,l,d,c){if(e[t]!==r[s])return Number.MIN_SAFE_INTEGER;let u=1,h=!1;return s===t-n?u=o[t]===i[s]?7:5:Cy(s,i,r)&&(s===0||!Cy(s-1,i,r))?(u=o[t]===i[s]?7:5,h=!0):Iy(r,s)&&(s===0||!Iy(r,s-1))?u=5:(Iy(r,s-1)||nA(r,s-1))&&(u=5,h=!0),u>1&&t===n&&(c[0]=!0),h||(h=Cy(s,i,r)||Iy(r,s-1)||nA(r,s-1)),t===n?s>l&&(u-=h?3:5):d?u+=h?2:0:u+=h?0:1,s+1===a&&(u-=h?3:5),u}var ET=new RegExp(`\\$\\(${Xe.iconNameExpression}(?:${Xe.iconModifierExpression})?\\)`,"g"),bZ=new RegExp(`(\\\\)?${ET.source}`,"g");var W4=new RegExp(`\\\\${ET.source}`,"g");function mA(o){return o.replace(W4,e=>`\\${e}`)}var vZ=new RegExp(`(\\s)?(\\\\)?${ET.source}(\\s)?`,"g");var yZ=new RegExp(`\\$\\(${Xe.iconNameCharacter}+\\)`,"g");function $g(o){return o.replace(/"/g,"&quot;")}function Sy(o){return o&&o.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function gA(o){let e=[],t=o.split("|").map(i=>i.trim());o=t[0];let n=t[1];if(n){let i=/height=(\d+)/.exec(n),r=/width=(\d+)/.exec(n),s=i?i[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&e.push(`width="${a}"`),d&&e.push(`height="${s}"`)}return{href:o,dimensions:e}}function Ih(o){if(!o||typeof o!="object"||o instanceof RegExp)return o;let e=Array.isArray(o)?[]:{};return Object.entries(o).forEach(([t,n])=>{e[t]=n&&typeof n=="object"?Ih(n):n}),e}var H4=Object.prototype.hasOwnProperty;function fA(o,e){return wT(o,e,new Set)}function wT(o,e,t){if(Mi(o))return o;let n=e(o);if(typeof n<"u")return n;if(Array.isArray(o)){let i=[];for(let r of o)i.push(wT(r,e,t));return i}if(hn(o)){if(t.has(o))throw new Error("Cannot clone recursive data-structure");t.add(o);let i={};for(let r in o)H4.call(o,r)&&(i[r]=wT(o[r],e,t));return t.delete(o),i}return o}function Ai(o,e){if(o===e)return!0;if(o==null||e===null||e===void 0||typeof o!=typeof e||typeof o!="object"||Array.isArray(o)!==Array.isArray(e))return!1;let t,n;if(Array.isArray(o)){if(o.length!==e.length)return!1;for(t=0;t<o.length;t++)if(!Ai(o[t],e[t]))return!1}else{let i=[];for(n in o)i.push(n);i.sort();let r=[];for(n in e)r.push(n);if(r.sort(),!Ai(i,r))return!1;for(t=0;t<i.length;t++)if(!Ai(o[i[t]],e[i[t]]))return!1}return!0}function bA(o,e){let t=Object.create(null);return!o||!e||Object.keys(e).forEach(i=>{let r=o[i],s=e[i];Ai(r,s)||(t[i]=s)}),t}var TT=class o{constructor(e,t,n,i,r,s,a){this._forceIntegerValues=e;this._forceIntegerValues&&(t=t|0,n=n|0,i=i|0,r=r|0,s=s|0,a=a|0),this.rawScrollLeft=i,this.rawScrollTop=a,t<0&&(t=0),i+t>n&&(i=n-t),i<0&&(i=0),r<0&&(r=0),a+r>s&&(a=s-r),a<0&&(a=0),this.width=t,this.scrollWidth=n,this.scrollLeft=i,this.height=r,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new o(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new o(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){let n=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:i,scrollLeftChanged:r,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},rl=class extends B{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new T);onScroll=this._onScroll.event;constructor(e){super(),this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new TT(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let n=this._state.withScrollDimensions(e,t);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let n=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;t?i=new Ey(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):i=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{let n=this._state.withScrollPosition(e);this._smoothScrolling=Ey.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let n=this._state;n.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(n,t)))}},xy=class{scrollLeft;scrollTop;isDone;constructor(e,t,n){this.scrollLeft=e,this.scrollTop=t,this.isDone=n}};function _T(o,e){let t=e-o;return function(n){return o+t*K4(n)}}function U4(o,e,t){return function(n){return n<t?o(n/t):e((n-t)/(1-t))}}var Ey=class o{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(e,t,n,i){this.from=e,this.to=t,this.duration=i,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,n){if(Math.abs(e-t)>2.5*n){let r,s;return e<t?(r=e+.75*n,s=t-.75*n):(r=e-.75*n,s=t+.75*n),U4(_T(e,r),_T(s,t),.33)}return _T(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let t=(e-this.startTime)/this.duration;if(t<1){let n=this.scrollLeft(t),i=this.scrollTop(t);return new xy(n,i,!1)}return new xy(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,n){return o.start(e,t,n)}static start(e,t,n){n=n+10;let i=Date.now()-10;return new o(e,t,i,n)}};function z4(o){return Math.pow(o,3)}function K4(o){return 1-z4(1-o)}var oa=new class{_zoomLevel=0;_onDidChangeZoomLevel=new T;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(o){o=Math.min(Math.max(-5,o),20),this._zoomLevel!==o&&(this._zoomLevel=o,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var G4=Fe?1.5:1.35,LT=8,qg=class o{_bareFontInfoBrand=void 0;static createFromValidatedSettings(e,t,n){let i=e.get(50),r=e.get(54),s=e.get(53),a=e.get(52),l=e.get(55),d=e.get(68),c=e.get(65);return o._create(i,r,s,a,l,d,c,t,n)}static createFromRawSettings(e,t,n=!1){let i=ra.fontFamily.validate(e.fontFamily),r=ra.fontWeight.validate(e.fontWeight),s=ra.fontSize.validate(e.fontSize),a=ra.fontLigatures2.validate(e.fontLigatures),l=ra.fontVariations.validate(e.fontVariations),d=ra.lineHeight.validate(e.lineHeight),c=ra.letterSpacing.validate(e.letterSpacing);return o._create(i,r,s,a,l,d,c,t,n)}static _create(e,t,n,i,r,s,a,l,d){s===0?s=G4*n:s<LT&&(s=s*n),s=Math.round(s),s<LT&&(s=LT);let c=1+(d?0:oa.getZoomLevel()*.1);return n*=c,s*=c,r===Sh.TRANSLATE&&(t==="normal"||t==="bold"?r=Sh.OFF:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new o({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:n,fontFeatureSettings:i,fontVariationSettings:r,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(e){this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let e=fi.fontFamily,t=o._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}},DT=2,Ch=class extends qg{_editorStylingBrand=void 0;version=DT;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}};var sa={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var RT="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function j4(o=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of RT)o.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var wy=j4();function Yg(o){let e=wy;if(o&&o instanceof RegExp)if(o.global)e=o;else{let t="g";o.ignoreCase&&(t+="i"),o.multiline&&(t+="m"),o.unicode&&(t+="u"),e=new RegExp(o.source,t)}return e.lastIndex=0,e}var yA=new ki;yA.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Zg(o,e,t,n,i){if(e=Yg(e),i||(i=Yo.first(yA)),t.length>i.maxLen){let d=o-i.maxLen/2;return d<0?d=0:n+=d,t=t.substring(d,o+i.maxLen/2),Zg(o,e,t,n,i)}let r=Date.now(),s=o-1-n,a=-1,l=null;for(let d=1;!(Date.now()-r>=i.timeBudget);d++){let c=s-i.windowSize*d;e.lastIndex=Math.max(0,c);let u=$4(e,t,s,a);if(!u&&l||(l=u,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return e.lastIndex=0,d}return null}function $4(o,e,t,n){let i;for(;i=o.exec(e);){let r=i.index||0;if(r<=t&&o.lastIndex>=t)return i;if(n>0&&r>n)return null}return null}var Jo=Z("accessibilityService");var JZ=new De("accessibilityModeEnabled",!1);var gs=8,_y=class{_values;constructor(e){this._values=e}hasChanged(e){return this._values[e]}},Xg=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},Et=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return Ly(e,t)}compute(e,t,n){return n}},Eh=class{constructor(e,t){this.newValue=e;this.didChange=t}};function Ly(o,e){if(typeof o!="object"||typeof e!="object"||!o||!e)return new Eh(e,o!==e);if(Array.isArray(o)||Array.isArray(e)){let n=Array.isArray(o)&&Array.isArray(e)&&Lt(o,e);return new Eh(e,!n)}let t=!1;for(let n in e)if(e.hasOwnProperty(n)){let i=Ly(o[n],e[n]);i.didChange&&(o[n]=i.newValue,t=!0)}return new Eh(o,t)}var Mc=class{id;name;defaultValue;schema=void 0;constructor(e){this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return Ly(e,t)}validate(e){return this.defaultValue}},fd=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return Ly(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,n){return n}};function Ee(o,e){return typeof o>"u"?e:o==="false"?!1:!!o}var qe=class extends fd{constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="boolean",i.default=n),super(e,t,n,i)}validate(e){return Ee(e,this.defaultValue)}};function q4(o,e,t,n){if(typeof o>"u")return e;let i=parseInt(o,10);return isNaN(i)?e:(i=Math.max(t,i),i=Math.min(n,i),i|0)}var St=class o extends fd{static clampedInt(e,t,n,i){return q4(e,t,n,i)}minimum;maximum;constructor(e,t,n,i,r,s=void 0){typeof s<"u"&&(s.type="integer",s.default=n,s.minimum=i,s.maximum=r),super(e,t,n,s),this.minimum=i,this.maximum=r}validate(e){return o.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}};var qr=class o extends fd{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;let n=parseFloat(e);return isNaN(n)?t:n}validationFn;constructor(e,t,n,i,r){typeof r<"u"&&(r.type="number",r.default=n),super(e,t,n,r),this.validationFn=i}validate(e){return this.validationFn(o.float(e,this.defaultValue))}},Oi=class o extends fd{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="string",i.default=n),super(e,t,n,i)}validate(e){return o.string(e,this.defaultValue)}};function Jt(o,e,t,n){return typeof o!="string"?e:n&&o in n?n[o]:t.indexOf(o)===-1?e:o}var At=class extends fd{_allowedValues;constructor(e,t,n,i,r=void 0){typeof r<"u"&&(r.type="string",r.enum=i,r.default=n),super(e,t,n,r),this._allowedValues=i}validate(e){return Jt(e,this.defaultValue,this._allowedValues)}},xh=class extends Et{_allowedValues;_convert;constructor(e,t,n,i,r,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=i),super(e,t,n,a),this._allowedValues=r,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function Y4(o){switch(o){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var kT=class extends Et{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[p("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),p("accessibilitySupport.on","Optimize for usage with a Screen Reader."),p("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:p("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,n){return n===0?e.accessibilitySupport:n}},MT=class extends Et{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:p("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:p("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertSpace:Ee(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Ee(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function Z4(o){switch(o){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function X4(o){switch(o){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var NT=class extends Mc{constructor(){super(144)}compute(e,t,n){let i=["monaco-editor"];return t.get(40)&&i.push(t.get(40)),e.extraEditorClassName&&i.push(e.extraEditorClassName),t.get(75)==="default"?i.push("mouse-default"):t.get(75)==="copy"&&i.push("mouse-copy"),t.get(113)&&i.push("showUnused"),t.get(142)&&i.push("showDeprecated"),i.join(" ")}},AT=class extends qe{constructor(){super(38,"emptySelectionClipboard",!0,{description:p("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}},OT=class extends Et{constructor(){let e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:p("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[p("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),p("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),p("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:p("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[p("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),p("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),p("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:p("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:p("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Fe},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:p("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:p("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{cursorMoveOnType:Ee(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":Jt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":Jt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Ee(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Ee(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Ee(t.loop,this.defaultValue.loop)}}},Nc=class o extends Et{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",o.OFF,{anyOf:[{type:"boolean",description:p("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:p("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:p("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?o.OFF:e==="true"?o.ON:e:e?o.ON:o.OFF}},Sh=class o extends Et{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",o.OFF,{anyOf:[{type:"boolean",description:p("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:p("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:p("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?o.OFF:e==="true"?o.TRANSLATE:e:e?o.TRANSLATE:o.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}},PT=class extends Mc{constructor(){super(51)}compute(e,t,n){return e.fontInfo}},FT=class extends fd{constructor(){super(53,"fontSize",fi.fontSize,{type:"number",minimum:6,maximum:100,default:fi.fontSize,description:p("fontSize","Controls the font size in pixels.")})}validate(e){let t=qr.float(e,this.defaultValue);return t===0?fi.fontSize:qr.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}},BT=class o extends Et{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",fi.fontWeight,{anyOf:[{type:"number",minimum:o.MINIMUM_VALUE,maximum:o.MAXIMUM_VALUE,errorMessage:p("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:o.SUGGESTION_VALUES}],default:fi.fontWeight,description:p("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(St.clampedInt(e,fi.fontWeight,o.MINIMUM_VALUE,o.MAXIMUM_VALUE))}},VT=class extends Et{constructor(){let e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[p("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),p("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),p("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:p("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:p("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:p("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:p("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:p("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:p("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:p("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:p("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:p("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:p("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:p("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{multiple:Jt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??Jt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??Jt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??Jt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??Jt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??Jt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??Jt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Oi.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Oi.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Oi.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Oi.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Oi.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Oi.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},WT=class extends Et{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:p("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:p("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:p("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:p("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:p("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),delay:St.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Ee(t.sticky,this.defaultValue.sticky),hidingDelay:St.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Ee(t.above,this.defaultValue.above)}}};var Qg=class o extends Mc{constructor(){super(147)}compute(e,t,n){return o.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight),i=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(i=Math.max(i,t-1));let r=(n+e.viewLineCount+i)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:i,desiredRatio:r,minimapLineCount:s}}static _computeMinimapLayout(e,t){let n=e.outerWidth,i=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};let s=t.stableMinimapLayoutInput,a=s&&e.outerHeight===s.outerHeight&&e.lineHeight===s.lineHeight&&e.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&e.pixelRatio===s.pixelRatio&&e.scrollBeyondLastLine===s.scrollBeyondLastLine&&e.paddingTop===s.paddingTop&&e.paddingBottom===s.paddingBottom&&e.minimap.enabled===s.minimap.enabled&&e.minimap.side===s.minimap.side&&e.minimap.size===s.minimap.size&&e.minimap.showSlider===s.minimap.showSlider&&e.minimap.renderCharacters===s.minimap.renderCharacters&&e.minimap.maxColumn===s.minimap.maxColumn&&e.minimap.scale===s.minimap.scale&&e.verticalScrollbarWidth===s.verticalScrollbarWidth&&e.isViewportWrapping===s.isViewportWrapping,l=e.lineHeight,d=e.typicalHalfwidthCharacterWidth,c=e.scrollBeyondLastLine,u=e.minimap.renderCharacters,h=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale,m=e.minimap.maxColumn,g=e.minimap.size,f=e.minimap.side,b=e.verticalScrollbarWidth,y=e.viewLineCount,C=e.remainingWidth,S=e.isViewportWrapping,w=u?2:3,R=Math.floor(r*i),M=R/r,N=!1,A=!1,P=w*h,K=h/r,j=1;if(g==="fill"||g==="fit"){let{typicalViewportLineCount:ie,extraLinesBeforeFirstLine:J,extraLinesBeyondLastLine:Se,desiredRatio:xe,minimapLineCount:lt}=o.computeContainedMinimapLineCount({viewLineCount:y,scrollBeyondLastLine:c,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:i,lineHeight:l,pixelRatio:r});if(y/lt>1)N=!0,A=!0,h=1,P=1,K=h/r;else{let Re=!1,ci=h+1;if(g==="fit"){let Kn=Math.ceil((J+y+Se)*P);S&&a&&C<=t.stableFitRemainingWidth?(Re=!0,ci=t.stableFitMaxMinimapScale):Re=Kn>R}if(g==="fill"||Re){N=!0;let Kn=h;P=Math.min(l*r,Math.max(1,Math.floor(1/xe))),S&&a&&C<=t.stableFitRemainingWidth&&(ci=t.stableFitMaxMinimapScale),h=Math.min(ci,Math.max(1,Math.floor(P/w))),h>Kn&&(j=Math.min(2,h/Kn)),K=h/r/j,R=Math.ceil(Math.max(ie,J+y+Se)*P),S?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=C,t.stableFitMaxMinimapScale=h):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}let X=Math.floor(m*K),le=Math.min(X,Math.max(0,Math.floor((C-b-2)*K/(d+K)))+gs),ye=Math.floor(r*le),q=ye/r;ye=Math.floor(ye*j);let Q=u?1:2,ce=f==="left"?0:n-le-b;return{renderMinimap:Q,minimapLeft:ce,minimapWidth:le,minimapHeightIsEditorHeight:N,minimapIsSampling:A,minimapScale:h,minimapLineHeight:P,minimapCanvasInnerWidth:ye,minimapCanvasInnerHeight:R,minimapCanvasOuterWidth:q,minimapCanvasOuterHeight:M}}static computeLayout(e,t){let n=t.outerWidth|0,i=t.outerHeight|0,r=t.lineHeight|0,s=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,d=t.pixelRatio,c=t.viewLineCount,u=e.get(139),h=u==="inherit"?e.get(138):u,m=h==="inherit"?e.get(134):h,g=e.get(137),f=t.isDominatedByLongLines,b=e.get(58),y=e.get(69).renderType!==0,C=e.get(70),S=e.get(107),w=e.get(85),R=e.get(74),M=e.get(105),N=M.verticalScrollbarSize,A=M.verticalHasArrows,P=M.arrowSize,K=M.horizontalScrollbarSize,j=e.get(44),X=e.get(112)!=="never",le=e.get(67);j&&X&&(le+=16);let ye=0;if(y){let jo=Math.max(s,C);ye=Math.round(jo*l)}let q=0;b&&(q=r*t.glyphMarginDecorationLaneCount);let Q=0,ce=Q+q,ie=ce+ye,J=ie+le,Se=n-q-ye-le,xe=!1,lt=!1,Ze=-1;h==="inherit"&&f?(xe=!0,lt=!0):m==="on"||m==="bounded"?lt=!0:m==="wordWrapColumn"&&(Ze=g);let Re=o._computeMinimapLayout({outerWidth:n,outerHeight:i,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:S,paddingTop:w.top,paddingBottom:w.bottom,minimap:R,verticalScrollbarWidth:N,viewLineCount:c,remainingWidth:Se,isViewportWrapping:lt},t.memory||new Xg);Re.renderMinimap!==0&&Re.minimapLeft===0&&(Q+=Re.minimapWidth,ce+=Re.minimapWidth,ie+=Re.minimapWidth,J+=Re.minimapWidth);let ci=Se-Re.minimapWidth,Kn=Math.max(1,Math.floor((ci-N-2)/a)),So=A?P:0;return lt&&(Ze=Math.max(1,Kn),m==="bounded"&&(Ze=Math.min(Ze,g))),{width:n,height:i,glyphMarginLeft:Q,glyphMarginWidth:q,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:ce,lineNumbersWidth:ye,decorationsLeft:ie,decorationsWidth:le,contentLeft:J,contentWidth:ci,minimap:Re,viewportColumn:Kn,isWordWrapMinified:xe,isViewportWrapping:lt,wrappingColumn:Ze,verticalScrollbarWidth:N,horizontalScrollbarHeight:K,overviewRuler:{top:So,width:N,height:i-2*So,right:0}}}},HT=class extends Et{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[p("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),p("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:p("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return Jt(e,"simple",["simple","advanced"])}compute(e,t,n){return t.get(2)===2?"advanced":n}};var UT=class extends Et{constructor(){let e={enabled:"onCode"};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:e.enabled,enumDescriptions:[p("editor.lightbulb.enabled.off","Disable the code action menu."),p("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),p("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:p("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Jt(e.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},zT=class extends Et{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:p("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:p("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:p("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:p("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),maxLineCount:St.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:Jt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Ee(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},KT=class extends Et{constructor(){let e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:p("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[p("editor.inlayHints.on","Inlay hints are enabled"),p("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Fe?"Ctrl+Option":"Ctrl+Alt"),p("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Fe?"Ctrl+Option":"Ctrl+Alt"),p("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:p("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:p("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:p("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:p("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:Jt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:St.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Oi.string(t.fontFamily,this.defaultValue.fontFamily),padding:Ee(t.padding,this.defaultValue.padding),maximumLength:St.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},GT=class extends Et{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):St.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?St.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}},jT=class extends qr{constructor(){super(68,"lineHeight",fi.lineHeight,e=>qr.clamp(e,0,150),{markdownDescription:p("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,n){return e.fontInfo.lineHeight}},$T=class extends Et{constructor(){let e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:p("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:p("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[p("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),p("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),p("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:p("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:p("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:p("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:p("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:p("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:p("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:p("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:p("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:p("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:p("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),autohide:Ee(t.autohide,this.defaultValue.autohide),size:Jt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:Jt(t.side,this.defaultValue.side,["right","left"]),showSlider:Jt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Ee(t.renderCharacters,this.defaultValue.renderCharacters),scale:St.clampedInt(t.scale,1,1,3),maxColumn:St.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:Ee(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:Ee(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:qr.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:qr.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function Q4(o){return o==="ctrlCmd"?Fe?"metaKey":"ctrlKey":"altKey"}var qT=class extends Et{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:p("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:p("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{top:St.clampedInt(t.top,0,0,1e3),bottom:St.clampedInt(t.bottom,0,0,1e3)}}},YT=class extends Et{constructor(){let e={enabled:!0,cycle:!0};super(87,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:p("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:p("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),cycle:Ee(t.cycle,this.defaultValue.cycle)}}},ZT=class extends Mc{constructor(){super(145)}compute(e,t,n){return e.pixelRatio}},XT=class extends Et{constructor(){super(89,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},QT=class extends Et{defaultValue;constructor(){let e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[p("on","Quick suggestions show inside the suggest widget"),p("inline","Quick suggestions show as ghost text"),p("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:p("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:p("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:p("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:p("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){let d=e?"on":"off";return{comments:d,strings:d,other:d}}if(!e||typeof e!="object")return this.defaultValue;let{other:t,comments:n,strings:i}=e,r=["on","inline","off"],s,a,l;return typeof t=="boolean"?s=t?"on":"off":s=Jt(t,this.defaultValue.other,r),typeof n=="boolean"?a=n?"on":"off":a=Jt(n,this.defaultValue.comments,r),typeof i=="boolean"?l=i?"on":"off":l=Jt(i,this.defaultValue.strings,r),{other:s,comments:a,strings:l}}};var JT=class extends Et{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[p("lineNumbers.off","Line numbers are not rendered."),p("lineNumbers.on","Line numbers are rendered as absolute number."),p("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),p("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:p("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,n=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:n}}};function Ac(o){let e=o.get(100);return e==="editable"?o.get(93):e!=="on"}var eL=class extends Et{constructor(){let e=[],t={type:"number",description:p("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:p("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:p("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="number")t.push({column:St.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n=="object"){let i=n;t.push({column:St.clampedInt(i.column,0,0,1e4),color:i.color})}return t.sort((n,i)=>n.column-i.column),t}return this.defaultValue}},tL=class extends Et{constructor(){super(94,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function IA(o,e){if(typeof o!="string")return e;switch(o){case"hidden":return 2;case"visible":return 3;default:return 1}}var nL=class extends Et{constructor(){let e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[p("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),p("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),p("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:p("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[p("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),p("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),p("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:p("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:p("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:p("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:p("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:p("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e,n=St.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),i=St.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:St.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:IA(t.vertical,this.defaultValue.vertical),horizontal:IA(t.horizontal,this.defaultValue.horizontal),useShadows:Ee(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Ee(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Ee(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Ee(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Ee(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:St.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:i,verticalSliderSize:St.clampedInt(t.verticalSliderSize,i,0,1e3),scrollByPage:Ee(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Ee(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},ps="inUntrustedWorkspace",kc={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},iL=class extends Et{constructor(){let e={nonBasicASCII:ps,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:ps,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",e,{[kc.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ps],default:e.nonBasicASCII,description:p("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[kc.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:p("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[kc.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:p("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[kc.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ps],default:e.includeComments,description:p("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[kc.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ps],default:e.includeStrings,description:p("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[kc.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:p("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[kc.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:p("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&(Ai(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&(Ai(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));let i=super.applyUpdate(e,t);return n?new Eh(i.newValue,!0):i}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{nonBasicASCII:wh(t.nonBasicASCII,ps,[!0,!1,ps]),invisibleCharacters:Ee(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Ee(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:wh(t.includeComments,ps,[!0,!1,ps]),includeStrings:wh(t.includeStrings,ps,[!0,!1,ps]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;let n={};for(let[i,r]of Object.entries(e))r===!0&&(n[i]=!0);return n}},oL=class extends Et{constructor(){let e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:p("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[p("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),p("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),p("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:p("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:p("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:p("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:p("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),mode:Jt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:Jt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Ee(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Ee(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Oi.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:Ee(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},rL=class extends Et{constructor(){let e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:p("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[p("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),p("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),p("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:p("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:p("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),showToolbar:Jt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:Oi.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:Ee(t.keepOnBlur,this.defaultValue.keepOnBlur)}}},sL=class extends Et{constructor(){let e={enabled:sa.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:sa.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:p("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Ee(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},aL=class extends Et{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[p("editor.guides.bracketPairs.true","Enables bracket pair guides."),p("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),p("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:p("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[p("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),p("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),p("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:p("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:p("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:p("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[p("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),p("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),p("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:p("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{bracketPairs:wh(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:wh(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Ee(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Ee(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:wh(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function wh(o,e,t){let n=t.indexOf(o);return n===-1?e:t[n]}var lL=class extends Et{constructor(){let e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[p("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),p("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:p("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:p("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:p("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:p("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[p("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),p("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),p("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),p("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:p("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:p("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:p("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:p("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:p("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:p("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:p("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:p("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertMode:Jt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Ee(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Ee(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Ee(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Ee(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:Jt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Ee(t.showIcons,this.defaultValue.showIcons),showStatusBar:Ee(t.showStatusBar,this.defaultValue.showStatusBar),preview:Ee(t.preview,this.defaultValue.preview),previewMode:Jt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Ee(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Ee(t.showMethods,this.defaultValue.showMethods),showFunctions:Ee(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Ee(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Ee(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Ee(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Ee(t.showFields,this.defaultValue.showFields),showVariables:Ee(t.showVariables,this.defaultValue.showVariables),showClasses:Ee(t.showClasses,this.defaultValue.showClasses),showStructs:Ee(t.showStructs,this.defaultValue.showStructs),showInterfaces:Ee(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Ee(t.showModules,this.defaultValue.showModules),showProperties:Ee(t.showProperties,this.defaultValue.showProperties),showEvents:Ee(t.showEvents,this.defaultValue.showEvents),showOperators:Ee(t.showOperators,this.defaultValue.showOperators),showUnits:Ee(t.showUnits,this.defaultValue.showUnits),showValues:Ee(t.showValues,this.defaultValue.showValues),showConstants:Ee(t.showConstants,this.defaultValue.showConstants),showEnums:Ee(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Ee(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Ee(t.showKeywords,this.defaultValue.showKeywords),showWords:Ee(t.showWords,this.defaultValue.showWords),showColors:Ee(t.showColors,this.defaultValue.showColors),showFiles:Ee(t.showFiles,this.defaultValue.showFiles),showReferences:Ee(t.showReferences,this.defaultValue.showReferences),showFolders:Ee(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Ee(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Ee(t.showSnippets,this.defaultValue.showSnippets),showUsers:Ee(t.showUsers,this.defaultValue.showUsers),showIssues:Ee(t.showIssues,this.defaultValue.showIssues)}}},dL=class extends Et{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:p("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:p("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Ee(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Ee(e.selectSubwords,this.defaultValue.selectSubwords)}}},cL=class extends Et{constructor(){let e=[];super(132,"wordSegmenterLocales",e,{anyOf:[{description:p("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:p("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="string")try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}};var uL=class extends Et{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[p("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),p("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),p("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),p("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:p("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,n){return t.get(2)===2?0:n}},hL=class extends Mc{constructor(){super(148)}compute(e,t,n){let i=t.get(147);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:i.isWordWrapMinified,isViewportWrapping:i.isViewportWrapping,wrappingColumn:i.wrappingColumn}}},pL=class extends Et{constructor(){let e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:p("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[p("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),p("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),showDropSelector:Jt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},mL=class extends Et{constructor(){let e={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:p("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[p("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),p("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:Ee(t.enabled,this.defaultValue.enabled),showPasteSelector:Jt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},J4="Consolas, 'Courier New', monospace",e5="Menlo, Monaco, 'Courier New', monospace",t5="'Droid Sans Mono', 'monospace', monospace",fi={fontFamily:Fe?e5:Zt?t5:J4,fontWeight:"normal",fontSize:Fe?12:14,lineHeight:0,letterSpacing:0},_h=[];function G(o){return _h[o.id]=o,o}var ra={acceptSuggestionOnCommitCharacter:G(new qe(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:p("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:G(new At(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",p("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:p("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:G(new kT),accessibilityPageSize:G(new St(3,"accessibilityPageSize",10,1,1073741824,{description:p("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:G(new Oi(4,"ariaLabel",p("editorViewAccessibleLabel","Editor content"))),ariaRequired:G(new qe(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:G(new qe(8,"screenReaderAnnounceInlineSuggestion",!0,{description:p("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:G(new At(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),p("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:p("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:G(new At(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),p("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:p("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:G(new At(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",p("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:p("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:G(new At(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",p("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:p("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:G(new At(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),p("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:p("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:G(new xh(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],Y4,{enumDescriptions:[p("editor.autoIndent.none","The editor will not insert indentation automatically."),p("editor.autoIndent.keep","The editor will keep the current line's indentation."),p("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),p("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),p("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:p("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:G(new qe(13,"automaticLayout",!1)),autoSurround:G(new At(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[p("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),p("editor.autoSurround.quotes","Surround with quotes but not brackets."),p("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:p("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:G(new sL),bracketPairGuides:G(new aL),stickyTabStops:G(new qe(118,"stickyTabStops",!1,{description:p("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:G(new qe(17,"codeLens",!0,{description:p("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:G(new Oi(18,"codeLensFontFamily","",{description:p("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:G(new St(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:p("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:G(new qe(20,"colorDecorators",!0,{description:p("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:G(new At(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[p("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),p("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),p("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:p("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:G(new St(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:p("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:G(new qe(22,"columnSelection",!1,{description:p("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:G(new MT),contextmenu:G(new qe(24,"contextmenu",!0)),copyWithSyntaxHighlighting:G(new qe(25,"copyWithSyntaxHighlighting",!0,{description:p("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:G(new xh(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],Z4,{description:p("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:G(new At(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[p("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),p("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),p("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:p("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:G(new xh(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],X4,{description:p("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:G(new St(29,"cursorSurroundingLines",0,0,1073741824,{description:p("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:G(new At(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[p("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),p("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:p("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:G(new St(31,"cursorWidth",0,0,1073741824,{markdownDescription:p("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:G(new qe(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:G(new qe(33,"disableMonospaceOptimizations",!1)),domReadOnly:G(new qe(34,"domReadOnly",!1)),dragAndDrop:G(new qe(35,"dragAndDrop",!0,{description:p("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:G(new AT),dropIntoEditor:G(new pL),experimentalEditContextEnabled:G(new qe(37,"experimentalEditContextEnabled",!1,{description:p("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:G(new zT),experimentalWhitespaceRendering:G(new At(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[p("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),p("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),p("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:p("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:G(new Oi(40,"extraEditorClassName","")),fastScrollSensitivity:G(new qr(41,"fastScrollSensitivity",5,o=>o<=0?5:o,{markdownDescription:p("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:G(new OT),fixedOverflowWidgets:G(new qe(43,"fixedOverflowWidgets",!1)),folding:G(new qe(44,"folding",!0,{description:p("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:G(new At(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[p("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),p("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:p("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:G(new qe(46,"foldingHighlight",!0,{description:p("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:G(new qe(47,"foldingImportsByDefault",!1,{description:p("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:G(new St(48,"foldingMaximumRegions",5e3,10,65e3,{description:p("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:G(new qe(49,"unfoldOnClickAfterEndOfLine",!1,{description:p("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:G(new Oi(50,"fontFamily",fi.fontFamily,{description:p("fontFamily","Controls the font family.")})),fontInfo:G(new PT),fontLigatures2:G(new Nc),fontSize:G(new FT),fontWeight:G(new BT),fontVariations:G(new Sh),formatOnPaste:G(new qe(56,"formatOnPaste",!1,{description:p("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:G(new qe(57,"formatOnType",!1,{description:p("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:G(new qe(58,"glyphMargin",!0,{description:p("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:G(new VT),hideCursorInOverviewRuler:G(new qe(60,"hideCursorInOverviewRuler",!1,{description:p("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:G(new WT),inDiffEditor:G(new qe(62,"inDiffEditor",!1)),letterSpacing:G(new qr(65,"letterSpacing",fi.letterSpacing,o=>qr.clamp(o,-5,20),{description:p("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:G(new UT),lineDecorationsWidth:G(new GT),lineHeight:G(new jT),lineNumbers:G(new JT),lineNumbersMinChars:G(new St(70,"lineNumbersMinChars",5,1,300)),linkedEditing:G(new qe(71,"linkedEditing",!1,{description:p("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:G(new qe(72,"links",!0,{description:p("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:G(new At(73,"matchBrackets","always",["always","near","never"],{description:p("matchBrackets","Highlight matching brackets.")})),minimap:G(new $T),mouseStyle:G(new At(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:G(new qr(76,"mouseWheelScrollSensitivity",1,o=>o===0?1:o,{markdownDescription:p("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:G(new qe(77,"mouseWheelZoom",!1,{markdownDescription:Fe?p("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):p("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:G(new qe(78,"multiCursorMergeOverlapping",!0,{description:p("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:G(new xh(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],Q4,{markdownEnumDescriptions:[p("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),p("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:p({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:G(new At(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[p("multiCursorPaste.spread","Each cursor pastes a single line of the text."),p("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:p("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:G(new St(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:p("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:G(new At(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[p("occurrencesHighlight.off","Does not highlight occurrences."),p("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),p("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:p("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:G(new qe(83,"overviewRulerBorder",!0,{description:p("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:G(new St(84,"overviewRulerLanes",3,0,3)),padding:G(new qT),pasteAs:G(new mL),parameterHints:G(new YT),peekWidgetDefaultFocus:G(new At(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[p("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),p("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:p("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:G(new XT),definitionLinkOpensInPeek:G(new qe(90,"definitionLinkOpensInPeek",!1,{description:p("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:G(new QT),quickSuggestionsDelay:G(new St(92,"quickSuggestionsDelay",10,0,1073741824,{description:p("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:G(new qe(93,"readOnly",!1)),readOnlyMessage:G(new tL),renameOnType:G(new qe(95,"renameOnType",!1,{description:p("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:p("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:G(new qe(96,"renderControlCharacters",!0,{description:p("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:G(new At(97,"renderFinalNewline",Zt?"dimmed":"on",["off","on","dimmed"],{description:p("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:G(new At(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",p("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:p("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:G(new qe(99,"renderLineHighlightOnlyWhenFocus",!1,{description:p("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:G(new At(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:G(new At(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",p("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),p("renderWhitespace.selection","Render whitespace characters only on selected text."),p("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:p("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:G(new St(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:G(new qe(103,"roundedSelection",!0,{description:p("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:G(new eL),scrollbar:G(new nL),scrollBeyondLastColumn:G(new St(106,"scrollBeyondLastColumn",4,0,1073741824,{description:p("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:G(new qe(107,"scrollBeyondLastLine",!0,{description:p("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:G(new qe(108,"scrollPredominantAxis",!0,{description:p("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:G(new qe(109,"selectionClipboard",!0,{description:p("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:Zt})),selectionHighlight:G(new qe(110,"selectionHighlight",!0,{description:p("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:G(new qe(111,"selectOnLineNumbers",!0)),showFoldingControls:G(new At(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[p("showFoldingControls.always","Always show the folding controls."),p("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),p("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:p("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:G(new qe(113,"showUnused",!0,{description:p("showUnused","Controls fading out of unused code.")})),showDeprecated:G(new qe(142,"showDeprecated",!0,{description:p("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:G(new KT),snippetSuggestions:G(new At(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[p("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),p("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),p("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),p("snippetSuggestions.none","Do not show snippet suggestions.")],description:p("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:G(new dL),smoothScrolling:G(new qe(116,"smoothScrolling",!1,{description:p("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:G(new St(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:G(new lL),inlineSuggest:G(new oL),inlineEdit:G(new rL),inlineCompletionsAccessibilityVerbose:G(new qe(151,"inlineCompletionsAccessibilityVerbose",!1,{description:p("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:G(new St(121,"suggestFontSize",0,0,1e3,{markdownDescription:p("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:G(new St(122,"suggestLineHeight",0,0,1e3,{markdownDescription:p("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:G(new qe(123,"suggestOnTriggerCharacters",!0,{description:p("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:G(new At(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[p("suggestSelection.first","Always select the first suggestion."),p("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),p("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:p("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:G(new At(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[p("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),p("tabCompletion.off","Disable tab completions."),p("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:p("tabCompletion","Enables tab completions.")})),tabIndex:G(new St(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:G(new iL),unusualLineTerminators:G(new At(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[p("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),p("unusualLineTerminators.off","Unusual line terminators are ignored."),p("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:p("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:G(new qe(129,"useShadowDOM",!0)),useTabStops:G(new qe(130,"useTabStops",!0,{description:p("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:G(new At(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[p("wordBreak.normal","Use the default line break rule."),p("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:p("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:G(new cL),wordSeparators:G(new Oi(133,"wordSeparators",RT,{description:p("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:G(new At(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[p("wordWrap.off","Lines will never wrap."),p("wordWrap.on","Lines will wrap at the viewport width."),p({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),p({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:p({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:G(new Oi(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:G(new Oi(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:G(new St(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:p({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:G(new At(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:G(new At(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:G(new NT),defaultColorDecorators:G(new qe(149,"defaultColorDecorators",!1,{markdownDescription:p("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:G(new ZT),tabFocusMode:G(new qe(146,"tabFocusMode",!1,{markdownDescription:p("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:G(new Qg),wrappingInfo:G(new hL),wrappingIndent:G(new uL),wrappingStrategy:G(new HT)};var V=class o{lineNumber;column;constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new o(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return o.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return o.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return o.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let n=e.lineNumber|0,i=t.lineNumber|0;if(n===i){let r=e.column|0,s=t.column|0;return r-s}return n-i}clone(){return new o(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new o(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var L=class o{startLineNumber;startColumn;endLineNumber;endColumn;constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return o.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return o.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return o.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return o.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return o.plusRange(this,e)}static plusRange(e,t){let n,i,r,s;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,s=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,s=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,s=e.endColumn),new o(n,i,r,s)}intersectRanges(e){return o.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,s=e.endColumn,a=t.startLineNumber,l=t.startColumn,d=t.endLineNumber,c=t.endColumn;return n<a?(n=a,i=l):n===a&&(i=Math.max(i,l)),r>d?(r=d,s=c):r===d&&(s=Math.min(s,c)),n>r||n===r&&i>s?null:new o(n,i,r,s)}equalsRange(e){return o.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return o.getEndPosition(this)}static getEndPosition(e){return new V(e.endLineNumber,e.endColumn)}getStartPosition(){return o.getStartPosition(this)}static getStartPosition(e){return new V(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new o(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new o(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return o.collapseToStart(this)}static collapseToStart(e){return new o(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return o.collapseToEnd(this)}static collapseToEnd(e){return new o(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new o(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let r=e.startLineNumber|0,s=t.startLineNumber|0;if(r===s){let a=e.startColumn|0,l=t.startColumn|0;if(a===l){let d=e.endLineNumber|0,c=t.endLineNumber|0;if(d===c){let u=e.endColumn|0,h=t.endColumn|0;return u-h}return d-c}return a-l}return r-s}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var Ue=class o extends L{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return o.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new o(this.startLineNumber,this.startColumn,e,t):new o(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new V(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new V(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new o(e,t,this.endLineNumber,this.endColumn):new o(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new o(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new o(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,n,i,r){return r===0?new o(e,t,n,i):new o(n,i,e,t)}};function fL(o,e){return new gL(o,e)}var gL=class{constructor(e,t){this.reducer=e;this.options=t}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?Ne(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let n;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){let i=n.indexOf(t);i>=0&&n.splice(i,1)}}flowData(){if(this.buffer.data.length>0){let e=this.reducer(this.buffer.data);this.emitData(e),this.buffer.data.length=0;let t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(n=>n())}}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function bL(o,e,t){o.on("error",n=>{t?.isCancellationRequested||e.onError(n)}),o.on("end",()=>{t?.isCancellationRequested||e.onEnd()}),o.on("data",n=>{t?.isCancellationRequested||e.onData(n)})}function CA(o,e){let t=fL(e);return t.end(o),t}function SA(o){let e=!1;return{read:()=>e?null:(e=!0,o)}}var Dy=typeof Buffer<"u",i5=new $n(()=>new Uint8Array(256)),vL,yL,vn=class o{static alloc(e){return Dy?new o(Buffer.allocUnsafe(e)):new o(new Uint8Array(e))}static wrap(e){return Dy&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new o(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&Dy?new o(Buffer.from(e)):(vL||(vL=new TextEncoder),new o(vL.encode(e)))}static fromByteArray(e){let t=o.alloc(e.length);for(let n=0,i=e.length;n<i;n++)t.buffer[n]=e[n];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].byteLength}let n=o.alloc(t),i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];n.set(a,i),i+=a.byteLength}return n}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=o.alloc(this.byteLength);return e.set(this),e}toString(){return Dy?this.buffer.toString():(yL||(yL=new TextDecoder),yL.decode(this.buffer))}slice(e,t){return new o(this.buffer.subarray(e,t))}set(e,t){if(e instanceof o)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return ii(this.buffer,e)}writeUInt32BE(e,t){oi(this.buffer,e,t)}readUInt32LE(e){return r5(this.buffer,e)}writeUInt32LE(e,t){s5(this.buffer,e,t)}readUInt8(e){return Ry(this.buffer,e)}writeUInt8(e,t){ky(this.buffer,e,t)}indexOf(e,t=0){return o5(this.buffer,e instanceof o?e.buffer:e,t)}};function o5(o,e,t=0){let n=e.byteLength,i=o.byteLength;if(n===0)return 0;if(n===1)return o.indexOf(e[0]);if(n>i-t)return-1;let r=i5.value;r.fill(e.length);for(let d=0;d<e.length;d++)r[e[d]]=e.length-d-1;let s=t+e.length-1,a=s,l=-1;for(;s<i;)if(o[s]===e[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(e.length-a,r[o[s]]),a=e.length-1;return l}function xA(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0}function EA(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255}function ii(o,e){return o[e]*2**24+o[e+1]*2**16+o[e+2]*2**8+o[e+3]}function oi(o,e,t){o[t+3]=e,e=e>>>8,o[t+2]=e,e=e>>>8,o[t+1]=e,e=e>>>8,o[t]=e}function r5(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0|o[e+2]<<16>>>0|o[e+3]<<24>>>0}function s5(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255,e=e>>>8,o[t+2]=e&255,e=e>>>8,o[t+3]=e&255}function Ry(o,e){return o[e]}function ky(o,e,t){o[t]=e}function wA(o){return SA(o)}function _A(o){return CA(o,e=>vn.concat(e))}var CL;function TA(){return CL||(CL=new TextDecoder("UTF-16LE")),CL}var SL;function a5(){return SL||(SL=new TextDecoder("UTF-16BE")),SL}var xL;function EL(){return xL||(xL=KM()?TA():a5()),xL}function LA(o,e,t){let n=new Uint16Array(o.buffer,e,t);return t>0&&(n[0]===65279||n[0]===65534)?l5(o,e,t):TA().decode(n)}function l5(o,e,t){let n=[],i=0;for(let r=0;r<t;r++){let s=xA(o,e);e+=2,n[i++]=String.fromCharCode(s)}return n.join("")}var Oc=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return EL().decode(e)}_flushBuffer(){let e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){let t=this._capacity-this._bufferLength;t<=1&&(t===0||qt(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){let t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}};function My(o){return o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var er=class o{constructor(e,t,n,i){this.oldPosition=e;this.oldText=t;this.newPosition=n;this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${My(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${My(this.oldText)}")`:`(replace@${this.oldPosition} "${My(this.oldText)}" with "${My(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){let i=t.length;oi(e,i,n),n+=4;for(let r=0;r<i;r++)EA(e,t.charCodeAt(r),n),n+=2;return n}static _readString(e,t){let n=ii(e,t);return t+=4,LA(e,t,n)}writeSize(){return 8+o._writeStringSize(this.oldText)+o._writeStringSize(this.newText)}write(e,t){return oi(e,this.oldPosition,t),t+=4,oi(e,this.newPosition,t),t+=4,t=o._writeString(e,this.oldText,t),t=o._writeString(e,this.newText,t),t}static read(e,t,n){let i=ii(e,t);t+=4;let r=ii(e,t);t+=4;let s=o._readString(e,t);t+=o._writeStringSize(s);let a=o._readString(e,t);return t+=o._writeStringSize(a),n.push(new o(i,s,r,a)),t}};function DA(o,e){return o===null||o.length===0?e:new wL(o,e).compress()}var wL=class o{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(n===null){this._acceptCurr(i),i=this._getCurr(++t);continue}if(i===null){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){let[d,c]=o._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(d),i=c;continue}if(n.newPosition<i.oldPosition){let[d,c]=o._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(d),n=c;continue}let a,l;if(i.oldEnd===n.newEnd)a=n,l=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){let[d,c]=o._splitPrev(n,i.oldLength);a=d,l=i,n=c,i=this._getCurr(++t)}else{let[d,c]=o._splitCurr(i,n.newLength);a=n,l=d,n=this._getPrev(++e),i=c}this._result[this._resultLen++]=new er(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let r=o._merge(this._result);return o._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=o._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=o._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new er(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new er(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){let n=e.newText.substr(0,t),i=e.newText.substr(t);return[new er(e.oldPosition,e.oldText,e.newPosition,n),new er(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){let n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new er(e.oldPosition,n,e.newPosition,e.newText),new er(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],n=0,i=e[0];for(let r=1;r<e.length;r++){let s=e[r];i.oldEnd===s.oldPosition?i=new er(i.oldPosition,i.oldText+s.oldText,i.newPosition,i.newText+s.newText):(t[n++]=i,i=s)}return t[n++]=i,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],n=0;for(let i=0;i<e.length;i++){let r=e[i];r.oldText!==r.newText&&(t[n++]=r)}return t}};var Th=class o{_asciiMap;_map;_defaultValue;constructor(e){let t=vc(e);this._defaultValue=t,this._asciiMap=o._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let n=vc(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var _L=class extends Th{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(e,t){super(0),this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let n=0,i=e.length;n<i;n++)this.set(e.charCodeAt(n),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(let i of this._getIntlSegmenterWordsOnLine(e)){if(i.index>t)break;n=i}return n}findNextIntlWordAtOrAfterOffset(e,t){for(let n of this._getIntlSegmenterWordsOnLine(e))if(!(n.index<t))return n;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}},RA=new Ri(10);function aa(o,e){let t=`${o}/${e.join(",")}`,n=RA.get(t);return n||(n=new _L(o,e),RA.set(t,n)),n}function vd(o,e){let t=Math.pow(10,e);return Math.round(o*t)/t}var ze=class{_rgbaBrand=void 0;r;g;b;a;constructor(e,t,n,i=1){this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,n))|0,this.a=vd(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}},bd=class o{_hslaBrand=void 0;h;s;l;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=vd(Math.max(Math.min(1,t),0),3),this.l=vd(Math.max(Math.min(1,n),0),3),this.a=vd(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=e.a,s=Math.max(t,n,i),a=Math.min(t,n,i),l=0,d=0,c=(a+s)/2,u=s-a;if(u>0){switch(d=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),s){case t:l=(n-i)/u+(n<i?6:0);break;case n:l=(i-t)/u+2;break;case i:l=(t-n)/u+4;break}l*=60,l=Math.round(l)}return new o(l,d,c,r)}static _hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}static toRGBA(e){let t=e.h/360,{s:n,l:i,a:r}=e,s,a,l;if(n===0)s=a=l=i;else{let d=i<.5?i*(1+n):i+n-i*n,c=2*i-d;s=o._hue2rgb(c,d,t+1/3),a=o._hue2rgb(c,d,t),l=o._hue2rgb(c,d,t-1/3)}return new ze(Math.round(s*255),Math.round(a*255),Math.round(l*255),r)}},Lh=class o{_hsvaBrand=void 0;h;s;v;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=vd(Math.max(Math.min(1,t),0),3),this.v=vd(Math.max(Math.min(1,n),0),3),this.a=vd(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),a=r-s,l=r===0?0:a/r,d;return a===0?d=0:r===t?d=((n-i)/a%6+6)%6:r===n?d=(i-t)/a+2:d=(t-n)/a+4,new o(Math.round(d*60),l,r,e.a)}static toRGBA(e){let{h:t,s:n,v:i,a:r}=e,s=i*n,a=s*(1-Math.abs(t/60%2-1)),l=i-s,[d,c,u]=[0,0,0];return t<60?(d=s,c=a):t<120?(d=a,c=s):t<180?(c=s,u=a):t<240?(c=a,u=s):t<300?(d=a,u=s):t<=360&&(d=s,u=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),u=Math.round((u+l)*255),new ze(d,c,u,r)}},W=class o{static fromHex(e){return o.Format.CSS.parseHex(e)||o.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:bd.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:Lh.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof ze)this.rgba=e;else if(e instanceof bd)this._hsla=e,this.rgba=bd.toRGBA(e);else if(e instanceof Lh)this._hsva=e,this.rgba=Lh.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&ze.equals(this.rgba,e.rgba)&&bd.equals(this.hsla,e.hsla)&&Lh.equals(this.hsva,e.hsva)}getRelativeLuminance(){let e=o._relativeLuminanceForComponent(this.rgba.r),t=o._relativeLuminanceForComponent(this.rgba.g),n=o._relativeLuminanceForComponent(this.rgba.b),i=.2126*e+.7152*t+.0722*n;return vd(i,4)}static _relativeLuminanceForComponent(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n}isDarkerThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t<n}lighten(e){return new o(new bd(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new o(new bd(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new ze(t,n,i,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new o(new ze(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){let t=e.rgba,n=this.rgba.a,i=t.a,r=n+i*(1-n);if(r<1e-6)return o.transparent;let s=this.rgba.r*n/r+t.r*i*(1-n)/r,a=this.rgba.g*n/r+t.g*i*(1-n)/r,l=this.rgba.b*n/r+t.b*i*(1-n)/r;return new o(new ze(s,a,l,r))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new ze(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-n),e.rgba.b-r*(e.rgba.b-i),1))}flatten(...e){let t=e.reduceRight((n,i)=>o._flatten(i,n));return o._flatten(this,t)}static _flatten(e,t){let n=1-e.rgba.a;return new o(new ze(n*t.rgba.r+e.rgba.a*e.rgba.r,n*t.rgba.g+e.rgba.a*e.rgba.g,n*t.rgba.b+e.rgba.a*e.rgba.b))}_toString;toString(){return this._toString||(this._toString=o.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,n){if(e.isLighterThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(r-i)/r,e.lighten(n)}static getDarkerColor(e,t,n){if(e.isDarkerThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(i-r)/i,e.darken(n)}static white=new o(new ze(255,255,255,1));static black=new o(new ze(0,0,0,1));static red=new o(new ze(255,0,0,1));static blue=new o(new ze(0,0,255,1));static green=new o(new ze(0,255,0,1));static cyan=new o(new ze(0,255,255,1));static lightgrey=new o(new ze(211,211,211,1));static transparent=new o(new ze(0,0,0,0))};(e=>{let o;(n=>{let t;(g=>{function i(f){return f.rgba.a===1?`rgb(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b})`:e.Format.CSS.formatRGBA(f)}g.formatRGB=i;function r(f){return`rgba(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b}, ${+f.rgba.a.toFixed(2)})`}g.formatRGBA=r;function s(f){return f.hsla.a===1?`hsl(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%)`:e.Format.CSS.formatHSLA(f)}g.formatHSL=s;function a(f){return`hsla(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%, ${f.hsla.a.toFixed(2)})`}g.formatHSLA=a;function l(f){let b=f.toString(16);return b.length!==2?"0"+b:b}function d(f){return`#${l(f.rgba.r)}${l(f.rgba.g)}${l(f.rgba.b)}`}g.formatHex=d;function c(f,b=!1){return b&&f.rgba.a===1?e.Format.CSS.formatHex(f):`#${l(f.rgba.r)}${l(f.rgba.g)}${l(f.rgba.b)}${l(Math.round(f.rgba.a*255))}`}g.formatHexA=c;function u(f){return f.isOpaque()?e.Format.CSS.formatHex(f):e.Format.CSS.formatRGBA(f)}g.format=u;function h(f){let b=f.length;if(b===0||f.charCodeAt(0)!==35)return null;if(b===7){let y=16*m(f.charCodeAt(1))+m(f.charCodeAt(2)),C=16*m(f.charCodeAt(3))+m(f.charCodeAt(4)),S=16*m(f.charCodeAt(5))+m(f.charCodeAt(6));return new e(new ze(y,C,S,1))}if(b===9){let y=16*m(f.charCodeAt(1))+m(f.charCodeAt(2)),C=16*m(f.charCodeAt(3))+m(f.charCodeAt(4)),S=16*m(f.charCodeAt(5))+m(f.charCodeAt(6)),w=16*m(f.charCodeAt(7))+m(f.charCodeAt(8));return new e(new ze(y,C,S,w/255))}if(b===4){let y=m(f.charCodeAt(1)),C=m(f.charCodeAt(2)),S=m(f.charCodeAt(3));return new e(new ze(16*y+y,16*C+C,16*S+S))}if(b===5){let y=m(f.charCodeAt(1)),C=m(f.charCodeAt(2)),S=m(f.charCodeAt(3)),w=m(f.charCodeAt(4));return new e(new ze(16*y+y,16*C+C,16*S+S,(16*w+w)/255))}return null}g.parseHex=h;function m(f){switch(f){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(t=n.CSS||={})})(o=e.Format||={})})(W||={});var Pc=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let o;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?o=crypto.getRandomValues.bind(crypto):o=function(n){for(let i=0;i<n.length;i++)n[i]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),t=[];for(let n=0;n<256;n++)t.push(n.toString(16).padStart(2,"0"));return function(){o(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=0,r="";return r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r}}();var c5=Object.freeze({create:o=>qa(o.map(e=>e.toString())).join(`\r
`),split:o=>o.split(`\r
`),parse:o=>c5.split(o).filter(e=>!e.startsWith("#"))});var kA=class o{constructor(e){this.value=e}static sep=".";static None=new o("@@none@@");static Empty=new o("");equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+o.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new o((this.value?[this.value,...e]:e).join(o.sep))}};var tr=class{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let n="mtk"+this.getForeground(e),i=this.getFontStyle(e);return i&1&&(n+=" mtki"),i&2&&(n+=" mtkb"),i&4&&(n+=" mtku"),i&8&&(n+=" mtks"),n}static getInlineStyleFromMetadata(e,t){let n=this.getForeground(e),i=this.getFontStyle(e),r=`color: ${t[n]};`;i&1&&(r+="font-style: italic;"),i&2&&(r+="font-weight: bold;");let s="";return i&4&&(s+=" underline"),i&8&&(s+=" line-through"),s&&(r+=`text-decoration:${s};`),r}static getPresentationFromMetadata(e){let t=this.getForeground(e),n=this.getFontStyle(e);return{foreground:t,italic:!!(n&1),bold:!!(n&2),underline:!!(n&4),strikethrough:!!(n&8)}}};function Py(o){return!!o&&typeof o.then=="function"}function la(o){let e=new Gr,t=o(e.token),n=new Promise((i,r)=>{let s=e.token.onCancellationRequested(()=>{s.dispose(),r(new Ui)});Promise.resolve(t).then(a=>{s.dispose(),e.dispose(),i(a)},a=>{s.dispose(),e.dispose(),r(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,r){return n.then(i,r)}catch(i){return this.then(void 0,i)}finally(i){return n.finally(i)}}}function tf(o,e,t){return new Promise((n,i)=>{let r=e.onCancellationRequested(()=>{r.dispose(),n(t)});o.then(n,i).finally(()=>r.dispose())})}function NA(){let o,e;return{promise:new Promise((n,i)=>{o=n,e=i}),resolve:o,reject:e}}var TL=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(t,t).then(n)})}return new Promise((t,n)=>{this.queuedPromise.then(t,n)})}return this.activePromise=e(),new Promise((t,n)=>{this.activePromise.then(i=>{this.activePromise=null,t(i)},i=>{this.activePromise=null,n(i)})})}dispose(){this.isDisposed=!0}};var u5=(o,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},o);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},h5=o=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,o())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},fs=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,r)=>{this.doResolve=i,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===V_?h5(n):u5(t,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new Ui),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},Jg=class{delayer;throttler;constructor(e){this.delayer=new fs(e),this.throttler=new TL}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},Rh=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function nr(o,e){return e?new Promise((t,n)=>{let i=setTimeout(()=>{r.dispose(),t()},o),r=e.onCancellationRequested(()=>{clearTimeout(i),r.dispose(),n(new Ui)})}):la(t=>nr(o,t))}function kh(o,e=0,t){let n=setTimeout(()=>{o(),t&&i.dispose()},e),i=pe(()=>{clearTimeout(n),t?.deleteAndLeak(i)});return t?.add(i),i}var bs=class{_token;_isDisposed=!1;constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new Te("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new Te("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},Ny=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new Te("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let i=n.setInterval(()=>{e()},t);this.disposable=pe(()=>{n.clearInterval(i),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},Yt=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var Id,Dh;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Dh=(o,e)=>{Ev(()=>{if(t)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Dh=(o,e,t)=>{let n=o.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),i=!1;return{dispose(){i||(i=!0,o.cancelIdleCallback(n))}}},Id=o=>Dh(globalThis,o)})();var Ay=class{_executor;_handle;_didRun=!1;_value;_error;constructor(e,t){this._executor=()=>{try{this._value=t()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=Dh(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},ef=class extends Ay{constructor(e){super(globalThis,e)}};var Oy=class{_running;_queued;isRunning(e){return typeof e=="number"?this._running?.taskId===e:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(e,t,n){return this._running={taskId:e,cancel:()=>n?.(),promise:t},t.then(()=>this.doneRunning(e),()=>this.doneRunning(e)),t}doneRunning(e){this._running&&e===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let e=this._queued;this._queued=void 0,e.run().then(e.promiseResolve,e.promiseReject)}}queue(e){if(this._queued)this._queued.run=e;else{let{promise:t,resolve:n,reject:i}=NA();this._queued={run:e,promise:t,promiseResolve:n,promiseReject:i}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var yd=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new Ui)}},Lr;(t=>{async function o(n){let i,r=await Promise.all(n.map(s=>s.then(a=>a,a=>{i||(i=a)})));if(typeof i<"u")throw i;return r}t.settled=o;function e(n){return new Promise(async(i,r)=>{try{await n(i,r)}catch(s){r(s)}})}t.withAsyncBody=e})(Lr||={});var MA=class o{static fromArray(e){return new o(t=>{t.emitMany(e)})}static fromPromise(e){return new o(async t=>{t.emitMany(await e)})}static fromPromises(e){return new o(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new o(async t=>{await Promise.all(e.map(async n=>{for await(let i of n)t.emitOne(i)}))})}static EMPTY=o.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new T,queueMicrotask(async()=>{let n={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(n)),this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await Y.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new o(async n=>{for await(let i of e)n.emitOne(t(i))})}map(e){return o.map(this,e)}static filter(e,t){return new o(async n=>{for await(let i of e)t(i)&&n.emitOne(i)})}filter(e){return o.filter(this,e)}static coalesce(e){return o.filter(e,t=>!!t)}coalesce(){return o.coalesce(this)}static async toPromise(e){let t=[];for await(let n of e)t.push(n);return t}toPromise(){return o.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var Fy="**",AA="/",By="[/\\\\]",Vy="[^/\\\\]",p5=/\//g;function OA(o,e){switch(o){case 0:return"";case 1:return`${Vy}*?`;default:return`(?:${By}|${Vy}+${By}${e?`|${By}${Vy}+`:""})*?`}}function PA(o,e){if(!o)return[];let t=[],n=!1,i=!1,r="";for(let s of o){switch(s){case e:if(!n&&!i){t.push(r),r="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":i=!0;break;case"]":i=!1;break}r+=s}return r&&t.push(r),t}function HA(o){if(!o)return"";let e="",t=PA(o,AA);if(t.every(n=>n===Fy))e=".*";else{let n=!1;t.forEach((i,r)=>{if(i===Fy){if(n)return;e+=OA(2,r===t.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of i){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let u;c==="-"?u=c:(c==="^"||c==="!")&&!d?u="^":c===AA?u="":u=Gi(c),d+=u;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let h=`(?:${PA(a,",").map(m=>HA(m)).join("|")})`;e+=h,s=!1,a="";break}case"]":{e+="["+d+"]",l=!1,d="";break}case"?":e+=Vy;continue;case"*":e+=OA(1);continue;default:e+=Gi(c)}}r<t.length-1&&(t[r+1]!==Fy||r+2<t.length)&&(e+=By)}n=i===Fy})}return e}var m5=/^\*\*\/\*\.[\w\.-]+$/,g5=/^\*\*\/([\w\.-]+)\/?$/,f5=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,b5=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,v5=/^\*\*((\/[\w\.-]+)+)\/?$/,y5=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,FA=new Ri(1e4),BA=function(){return!1},da=function(){return null};function DL(o,e){if(!o)return da;let t;typeof o!="string"?t=o.pattern:t=o,t=t.trim();let n=`${t}_${!!e.trimForExclusions}`,i=FA.get(n);if(i)return VA(i,o);let r;return m5.test(t)?i=I5(t.substr(4),t):(r=g5.exec(LL(t,e)))?i=C5(r[1],t):(e.trimForExclusions?b5:f5).test(t)?i=S5(t,e):(r=v5.exec(LL(t,e)))?i=WA(r[1].substr(1),t,!0):(r=y5.exec(LL(t,e)))?i=WA(r[1],t,!1):i=x5(t),FA.set(n,i),VA(i,o)}function VA(o,e){if(typeof e=="string")return o;let t=function(n,i){return Ug(n,e.base,!Zt)?o(qv(n.substr(e.base.length),_o),i):null};return t.allBasenames=o.allBasenames,t.allPaths=o.allPaths,t.basenames=o.basenames,t.patterns=o.patterns,t}function LL(o,e){return e.trimForExclusions&&o.endsWith("/**")?o.substr(0,o.length-2):o}function I5(o,e){return function(t,n){return typeof t=="string"&&t.endsWith(o)?e:null}}function C5(o,e){let t=`/${o}`,n=`\\${o}`,i=function(s,a){return typeof s!="string"?null:a?a===o?e:null:s===o||s.endsWith(t)||s.endsWith(n)?e:null},r=[o];return i.basenames=r,i.patterns=[e],i.allBasenames=r,i}function S5(o,e){let t=UA(o.slice(1,-1).split(",").map(a=>DL(a,e)).filter(a=>a!==da),o),n=t.length;if(!n)return da;if(n===1)return t[0];let i=function(a,l){for(let d=0,c=t.length;d<c;d++)if(t[d](a,l))return o;return null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function WA(o,e,t){let n=_o===bt.sep,i=n?o:o.replace(p5,_o),r=_o+i,s=bt.sep+o,a;return t?a=function(l,d){return typeof l=="string"&&(l===i||l.endsWith(r)||!n&&(l===o||l.endsWith(s)))?e:null}:a=function(l,d){return typeof l=="string"&&(l===i||!n&&l===o)?e:null},a.allPaths=[(t?"*/":"./")+o],a}function x5(o){try{let e=new RegExp(`^${HA(o)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?o:null}}catch{return da}}function nf(o,e={}){if(!o)return BA;if(typeof o=="string"||E5(o)){let t=DL(o,e);if(t===da)return BA;let n=function(i,r){return!!t(i,r)};return t.allBasenames&&(n.allBasenames=t.allBasenames),t.allPaths&&(n.allPaths=t.allPaths),n}return w5(o,e)}function E5(o){let e=o;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function w5(o,e){let t=UA(Object.getOwnPropertyNames(o).map(a=>_5(a,o[a],e)).filter(a=>a!==da)),n=t.length;if(!n)return da;if(!t.some(a=>!!a.requiresSiblings)){if(n===1)return t[0];let a=function(c,u){let h;for(let m=0,g=t.length;m<g;m++){let f=t[m](c,u);if(typeof f=="string")return f;Py(f)&&(h||(h=[]),h.push(f))}return h?(async()=>{for(let m of h){let g=await m;if(typeof g=="string")return g}return null})():null},l=t.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=t.reduce((c,u)=>u.allPaths?c.concat(u.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let i=function(a,l,d){let c,u;for(let h=0,m=t.length;h<m;h++){let g=t[h];g.requiresSiblings&&d&&(l||(l=__(a)),c||(c=l.substr(0,l.length-Lv(a).length)));let f=g(a,l,c,d);if(typeof f=="string")return f;Py(f)&&(u||(u=[]),u.push(f))}return u?(async()=>{for(let h of u){let m=await h;if(typeof m=="string")return m}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function _5(o,e,t){if(e===!1)return da;let n=DL(o,t);if(n===da)return da;if(typeof e=="boolean")return n;if(e){let i=e.when;if(typeof i=="string"){let r=(s,a,l,d)=>{if(!d||!n(s,a))return null;let c=i.replace("$(basename)",()=>l),u=d(c);return Py(u)?u.then(h=>h?o:null):u?o:null};return r.requiresSiblings=!0,r}}return n}function UA(o,e){let t=o.filter(a=>!!a.basenames);if(t.length<2)return o;let n=t.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),i;if(e){i=[];for(let a=0,l=n.length;a<l;a++)i.push(e)}else i=t.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let r=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let u=a.charCodeAt(c-1);if(u===47||u===92)break}l=a.substr(c)}let d=n.indexOf(l);return d!==-1?i[d]:null};r.basenames=n,r.patterns=i,r.allBasenames=n;let s=o.filter(a=>!a.basenames);return s.push(r),s}var of=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new T;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),pe(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let n=new RL(this,e,t);return this._factories.set(e,n),pe(()=>{let i=this._factories.get(e);!i||i!==n||(this._factories.delete(e),i.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;let n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},RL=class extends B{constructor(t,n,i){super();this._registry=t;this._languageId=n;this._factory=i}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}};function qi(o){let e=0,t=0,n=0,i=0;for(let r=0,s=o.length;r<s;r++){let a=o.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<s&&o.charCodeAt(r+1)===10?(i|=2,r++):i|=3,n=r+1):a===10&&(i|=1,e===0&&(t=r),e++,n=r+1)}return e===0&&(t=o.length),[e,t,o.length-n,i]}var Ht=class o{constructor(e,t){this.start=e;this.endExclusive=t;if(e>t)throw new Te(`Invalid range: ${this.toString()}`)}static addRange(e,t){let n=0;for(;n<t.length&&t[n].endExclusive<e.start;)n++;let i=n;for(;i<t.length&&t[i].start<=e.endExclusive;)i++;if(n===i)t.splice(n,0,e);else{let r=Math.min(e.start,t[n].start),s=Math.max(e.endExclusive,t[i-1].endExclusive);t.splice(n,i-n,new o(r,s))}}static tryCreate(e,t){if(!(e>t))return new o(e,t)}static ofLength(e){return new o(0,e)}static ofStartAndLength(e,t){return new o(e,e+t)}static emptyAt(e){return new o(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new o(this.start+e,this.endExclusive+e)}deltaStart(e){return new o(this.start+e,this.endExclusive)}deltaEnd(e){return new o(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new o(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(t<=n)return new o(t,n)}intersectionLength(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-t)}intersects(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<n}intersectsOrTouches(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Te(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Te(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let n=this.start;n<this.endExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}};var kL=class o{constructor(e){this._tokenInfo=e}static create(e){return new o(e)}forEach(e){let t=0;for(let n of this._tokenInfo){let i=new Ht(t,t+n.length);e(i,n),t+=n.length}}slice(e){let t=[],n=0;for(let i of this._tokenInfo){let r=n,s=r+i.length;if(s>e.start){if(r>=e.endExclusive)break;let a=Math.max(0,e.start-r),l=Math.max(0,s-e.endExclusive);t.push(new Wy(i.length-a-l,i.metadata))}n+=i.length}return o.create(t)}},Wy=class{constructor(e,t){this.length=e;this.metadata=t}},Hy=class{_tokens=[];add(e,t){this._tokens.push(new Wy(e,t))}build(){return kL.create(this._tokens)}};var yn=class o{static createEmpty(e,t){let n=o.defaultTokenMetadata,i=new Uint32Array(2);return i[0]=e.length,i[1]=n,new o(i,e,t)}static createFromTextAndMetadata(e,t){let n=0,i="",r=new Array;for(let{text:s,metadata:a}of e)r.push(n+s.length,a),n+=s.length,i+=s;return new o(new Uint32Array(r),i,t)}static convertToEndOffset(e,t){let i=(e.length>>>1)-1;for(let r=0;r<i;r++)e[r<<1]=e[r+1<<1];e[i<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){let r=n+Math.floor((i-n)/2),s=e[r<<1];if(s===t)return r+1;s<t?n=r+1:s>t&&(i=r)}return n}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(e,t,n){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=n}equals(e){return e instanceof o?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,n){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let i=t<<1,r=i+(n<<1);for(let s=i;s<r;s++)if(this._tokens[s]!==e._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let t=this._tokens[(e<<1)+1],n=tr.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(n)}getStandardTokenType(e){let t=this._tokens[(e<<1)+1];return tr.getTokenType(t)}getForeground(e){let t=this._tokens[(e<<1)+1];return tr.getForeground(t)}getClassName(e){let t=this._tokens[(e<<1)+1];return tr.getClassNameFromMetadata(t)}getInlineStyle(e,t){let n=this._tokens[(e<<1)+1];return tr.getInlineStyleFromMetadata(n,t)}getPresentation(e){let t=this._tokens[(e<<1)+1];return tr.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return o.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new ML(this,e,t,n)}withInserted(e){if(e.length===0)return this;let t=0,n=0,i="",r=new Array,s=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=n<e.length?e[n]:null;if(a!==-1&&(l===null||a<=l.offset)){i+=this._text.substring(s,a);let d=this._tokens[(t<<1)+1];r.push(i.length,d),t++,s=a}else if(l){if(l.offset>s){i+=this._text.substring(s,l.offset);let d=this._tokens[(t<<1)+1];r.push(i.length,d),s=l.offset}i+=l.text,r.push(i.length,l.tokenMetadata),n++}else break}return new o(new Uint32Array(r),i,this.languageIdCodec)}getTokensInRange(e){let t=new Hy,n=this.findTokenIndexAtOffset(e.start),i=this.findTokenIndexAtOffset(e.endExclusive);for(let r=n;r<=i;r++){let a=new Ht(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(r))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),n=this.getEndOffset(e);return this._text.substring(t,n)}forEach(e){let t=this.getCount();for(let n=0;n<t;n++)e(n)}},ML=class o{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,s=e.getCount();r<s&&!(e.getStartOffset(r)>=n);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof o?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,n=this._source.getStartOffset(t),i=this._source.getEndOffset(t),r=this._source.getTokenText(t);return n<this._startOffset&&(r=r.substring(this._startOffset-n)),i>this._endOffset&&(r=r.substring(0,r.length-(i-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}};var ca=new Uint32Array(0).buffer,ri=class o{static deleteBeginning(e,t){return e===null||e===ca?e:o.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===ca)return e;let n=ua(e),i=n[n.length-2];return o.delete(e,t,i)}static delete(e,t,n){if(e===null||e===ca||t===n)return e;let i=ua(e),r=i.length>>>1;if(t===0&&i[i.length-2]===n)return ca;let s=yn.findIndexInTokensArray(i,t),a=s>0?i[s-1<<1]:0,l=i[s<<1];if(n<l){let m=n-t;for(let g=s;g<r;g++)i[g<<1]-=m;return e}let d,c;a!==t?(i[s<<1]=t,d=s+1<<1,c=t):(d=s<<1,c=a);let u=n-t;for(let m=s+1;m<r;m++){let g=i[m<<1]-u;g>c&&(i[d++]=g,i[d++]=i[(m<<1)+1],c=g)}if(d===i.length)return e;let h=new Uint32Array(d);return h.set(i.subarray(0,d),0),h.buffer}static append(e,t){if(t===ca)return e;if(e===ca)return t;if(e===null)return e;if(t===null)return null;let n=ua(e),i=ua(t),r=i.length>>>1,s=new Uint32Array(n.length+i.length);s.set(n,0);let a=n.length,l=n[n.length-2];for(let d=0;d<r;d++)s[a++]=i[d<<1]+l,s[a++]=i[(d<<1)+1];return s.buffer}static insert(e,t,n){if(e===null||e===ca)return e;let i=ua(e),r=i.length>>>1,s=yn.findIndexInTokensArray(i,t);s>0&&i[s-1<<1]===t&&s--;for(let a=s;a<r;a++)i[a<<1]+=n;return e}};function ua(o){return o instanceof Uint32Array?o:new Uint32Array(o)}var Yi=class o{static fromRange(e){return new o(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new o(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(e.startLineNumber,t.startLineNumber),new o(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new o(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new Uy(e[0].slice());for(let n=1;n<e.length;n++)t=t.getUnion(new Uy(e[n].slice()));return t.ranges}static join(e){if(e.length===0)throw new Te("lineRanges cannot be empty");let t=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let i=1;i<e.length;i++)t=Math.min(t,e[i].startLineNumber),n=Math.max(n,e[i].endLineNumberExclusive);return new o(t,n)}static ofLength(e,t){return new o(e,e+t)}static deserialize(e){return new o(e[0],e[1])}startLineNumber;endLineNumberExclusive;constructor(e,t){if(e>t)throw new Te(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new o(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new o(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new o(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=n)return new o(t,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new L(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new L(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new Ht(this.startLineNumber-1,this.endLineNumberExclusive-1)}},Uy=class o{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=Yu(this._normalizedRanges,i=>i.endLineNumberExclusive>=e.startLineNumber),n=ng(this._normalizedRanges,i=>i.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)this._normalizedRanges.splice(t,0,e);else if(t===n-1){let i=this._normalizedRanges[t];this._normalizedRanges[t]=i.join(e)}else{let i=this._normalizedRanges[t].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(t,n-t,i)}}contains(e){let t=p_(this._normalizedRanges,n=>n.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=p_(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],n=0,i=0,r=null;for(;n<this._normalizedRanges.length||i<e._normalizedRanges.length;){let s=null;if(n<this._normalizedRanges.length&&i<e._normalizedRanges.length){let a=this._normalizedRanges[n],l=e._normalizedRanges[i];a.startLineNumber<l.startLineNumber?(s=a,n++):(s=l,i++)}else n<this._normalizedRanges.length?(s=this._normalizedRanges[n],n++):(s=e._normalizedRanges[i],i++);r===null?r=s:r.endLineNumberExclusive>=s.startLineNumber?r=new Yi(r.startLineNumber,Math.max(r.endLineNumberExclusive,s.endLineNumberExclusive)):(t.push(r),r=s)}return r!==null&&t.push(r),new o(t)}subtractFrom(e){let t=Yu(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),n=ng(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)return new o([e]);let i=[],r=e.startLineNumber;for(let s=t;s<n;s++){let a=this._normalizedRanges[s];a.startLineNumber>r&&i.push(new Yi(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&i.push(new Yi(r,e.endLineNumberExclusive)),new o(i)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],n=0,i=0;for(;n<this._normalizedRanges.length&&i<e._normalizedRanges.length;){let r=this._normalizedRanges[n],s=e._normalizedRanges[i],a=r.intersect(s);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<s.endLineNumberExclusive?n++:i++}return new o(t)}getWithDelta(e){return new o(this._normalizedRanges.map(t=>t.delta(e)))}};var rf=class o{static deserialize(e,t,n){let i=new Uint32Array(e.buffer),r=ii(e,t);t+=4;let s=ii(e,t);t+=4;let a=[];for(let l=0;l<s;l++){let d=ii(e,t);t+=4,a.push(i.subarray(t/4,t/4+d/4)),t+=d}return n.push(new o(r,a)),t}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new Yi(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e=0;e+=4,e+=4;for(let t=0;t<this._tokens.length;t++){let n=this._tokens[t];if(!(n instanceof Uint32Array))throw new Error("Not supported!");e+=4,e+=n.byteLength}return e}serialize(e,t){oi(e,this._startLineNumber,t),t+=4,oi(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++){let i=this._tokens[n];if(!(i instanceof Uint32Array))throw new Error("Not supported!");oi(e,i.byteLength,t),t+=4,e.set(new Uint8Array(i.buffer),t),t+=i.byteLength}return t}applyEdit(e,t){let[n,i]=qi(t);this._acceptDeleteRange(e),this._acceptInsertText(new V(e.startLineNumber,e.startColumn),n,i)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let i=n-t;this._startLineNumber-=i;return}if(!(t>=this._tokens.length)){if(t<0&&n>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===n){this._tokens[t]=ri.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=ri.deleteEnding(this._tokens[t],e.startColumn-1),n<this._tokens.length){let i=ri.deleteBeginning(this._tokens[n],e.endColumn-1);this._tokens[t]=ri.append(this._tokens[t],i),this._tokens.splice(t+1,n-t)}else this._tokens[t]=ri.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else{let i=-t;this._startLineNumber-=i,this._tokens[n]=ri.deleteBeginning(this._tokens[n],e.endColumn-1),this._tokens=this._tokens.slice(n)}}}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-this._startLineNumber;if(i<0){this._startLineNumber+=t;return}if(!(i>=this._tokens.length)){if(t===0){this._tokens[i]=ri.insert(this._tokens[i],e.column-1,n);return}this._tokens[i]=ri.deleteEnding(this._tokens[i],e.column-1),this._tokens[i]=ri.insert(this._tokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._tokens=js(this._tokens,e,n)}};var zy=(i=>(i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i))(zy||{});(a=>{let o="error",e="warning",t="warn",n="info",i="ignore";function r(l){return l?jr(o,l)?3:jr(e,l)||jr(t,l)?2:jr(n,l)?1:0:0}a.fromValue=r;function s(l){switch(l){case 3:return o;case 2:return e;case 1:return n;default:return i}}a.toString=s})(zy||={});var On=zy;var HJ=Z("IBuiltinExtensionsScannerService");var sf=(i=>(i[i.Hint=1]="Hint",i[i.Info=2]="Info",i[i.Warning=4]="Warning",i[i.Error=8]="Error",i))(sf||{});(r=>{function o(s,a){return a-s}r.compare=o;let e=Object.create(null);e[8]=p("sev.error","Error"),e[4]=p("sev.warning","Warning"),e[2]=p("sev.info","Info");function t(s){return e[s]||""}r.toString=t;function n(s){switch(s){case On.Error:return 8;case On.Warning:return 4;case On.Info:return 2;case On.Ignore:return 1}}r.fromSeverity=n;function i(s){switch(s){case 8:return On.Error;case 4:return On.Warning;case 2:return On.Info;case 1:return On.Ignore}}r.toSeverity=i})(sf||={});var D5;(n=>{let o="";function e(i){return t(i,!0)}n.makeKey=e;function t(i,r){let s=[o];return i.source?s.push(i.source.replace("\xA6","\\\xA6")):s.push(o),i.code?typeof i.code=="string"?s.push(i.code.replace("\xA6","\\\xA6")):s.push(i.code.value.replace("\xA6","\\\xA6")):s.push(o),i.severity!==void 0&&i.severity!==null?s.push(sf.toString(i.severity)):s.push(o),i.message&&r?s.push(i.message.replace("\xA6","\\\xA6")):s.push(o),i.startLineNumber!==void 0&&i.startLineNumber!==null?s.push(i.startLineNumber.toString()):s.push(o),i.startColumn!==void 0&&i.startColumn!==null?s.push(i.startColumn.toString()):s.push(o),i.endLineNumber!==void 0&&i.endLineNumber!==null?s.push(i.endLineNumber.toString()):s.push(o),i.endColumn!==void 0&&i.endColumn!==null?s.push(i.endColumn.toString()):s.push(o),s.push(o),s.join("\xA6")}n.makeKeyOptionalMessage=t})(D5||={});var KA=Z("markerService");var Ky=class{constructor(e,t){this.tokens=e;this.endState=t}_encodedTokenizationResultBrand=void 0};var R5;(i=>{let o=new Map;o.set(0,ue.symbolMethod),o.set(1,ue.symbolFunction),o.set(2,ue.symbolConstructor),o.set(3,ue.symbolField),o.set(4,ue.symbolVariable),o.set(5,ue.symbolClass),o.set(6,ue.symbolStruct),o.set(7,ue.symbolInterface),o.set(8,ue.symbolModule),o.set(9,ue.symbolProperty),o.set(10,ue.symbolEvent),o.set(11,ue.symbolOperator),o.set(12,ue.symbolUnit),o.set(13,ue.symbolValue),o.set(15,ue.symbolEnum),o.set(14,ue.symbolConstant),o.set(15,ue.symbolEnum),o.set(16,ue.symbolEnumMember),o.set(17,ue.symbolKeyword),o.set(27,ue.symbolSnippet),o.set(18,ue.symbolText),o.set(19,ue.symbolColor),o.set(20,ue.symbolFile),o.set(21,ue.symbolReference),o.set(22,ue.symbolCustomColor),o.set(23,ue.symbolFolder),o.set(24,ue.symbolTypeParameter),o.set(25,ue.account),o.set(26,ue.issues);function e(r){let s=o.get(r);return s||(console.info("No codicon found for CompletionItemKind "+r),s=ue.symbolProperty),s}i.toIcon=e;let t=new Map;t.set("method",0),t.set("function",1),t.set("constructor",2),t.set("field",3),t.set("variable",4),t.set("class",5),t.set("struct",6),t.set("interface",7),t.set("module",8),t.set("property",9),t.set("event",10),t.set("operator",11),t.set("unit",12),t.set("value",13),t.set("constant",14),t.set("enum",15),t.set("enum-member",16),t.set("enumMember",16),t.set("keyword",17),t.set("snippet",27),t.set("text",18),t.set("color",19),t.set("file",20),t.set("reference",21),t.set("customcolor",22),t.set("folder",23),t.set("type-parameter",24),t.set("typeParameter",24),t.set("account",25),t.set("issue",26);function n(r,s){let a=t.get(r);return typeof a>"u"&&!s&&(a=9),a}i.fromString=n})(R5||={});var Hee={17:p("Array","array"),16:p("Boolean","boolean"),4:p("Class","class"),13:p("Constant","constant"),8:p("Constructor","constructor"),9:p("Enum","enumeration"),21:p("EnumMember","enumeration member"),23:p("Event","event"),7:p("Field","field"),0:p("File","file"),11:p("Function","function"),10:p("Interface","interface"),19:p("Key","key"),5:p("Method","method"),1:p("Module","module"),2:p("Namespace","namespace"),20:p("Null","null"),15:p("Number","number"),18:p("Object","object"),24:p("Operator","operator"),3:p("Package","package"),6:p("Property","property"),14:p("String","string"),22:p("Struct","struct"),25:p("TypeParameter","type parameter"),12:p("Variable","variable")};var k5;(t=>{let o=new Map;o.set(0,ue.symbolFile),o.set(1,ue.symbolModule),o.set(2,ue.symbolNamespace),o.set(3,ue.symbolPackage),o.set(4,ue.symbolClass),o.set(5,ue.symbolMethod),o.set(6,ue.symbolProperty),o.set(7,ue.symbolField),o.set(8,ue.symbolConstructor),o.set(9,ue.symbolEnum),o.set(10,ue.symbolInterface),o.set(11,ue.symbolFunction),o.set(12,ue.symbolVariable),o.set(13,ue.symbolConstant),o.set(14,ue.symbolString),o.set(15,ue.symbolNumber),o.set(16,ue.symbolBoolean),o.set(17,ue.symbolArray),o.set(18,ue.symbolObject),o.set(19,ue.symbolKey),o.set(20,ue.symbolNull),o.set(21,ue.symbolEnumMember),o.set(22,ue.symbolStruct),o.set(23,ue.symbolEvent),o.set(24,ue.symbolOperator),o.set(25,ue.symbolTypeParameter);function e(n){let i=o.get(n);return i||(console.info("No codicon found for SymbolKind "+n),i=ue.symbolProperty),i}t.toIcon=e})(k5||={});var Cd=class o{constructor(e){this.value=e}static Comment=new o("comment");static Imports=new o("imports");static Region=new o("region");static fromValue(e){switch(e){case"comment":return o.Comment;case"imports":return o.Imports;case"region":return o.Region}return new o(e)}};var M5;(e=>{function o(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}e.is=o})(M5||={});var ir=new of,af=new of;var ho=Z("languageService");function ha(o,e){let t=o.getCount(),n=o.findTokenIndexAtOffset(e),i=o.getLanguageId(n),r=n;for(;r+1<t&&o.getLanguageId(r+1)===i;)r++;let s=n;for(;s>0&&o.getLanguageId(s-1)===i;)s--;return new AL(o,i,s,r+1,o.getStartOffset(s),o.getEndOffset(r))}var AL=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(e,t,n,i,r,s){this._actual=e,this.languageId=t,this._firstTokenIndex=n,this._lastTokenIndex=i,this.firstCharOffset=r,this._lastCharOffset=s,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},GA=(e=>(e[e.value=3]="value",e))(GA||{});function Yr(o){return(o&GA.value)!==0}var Mh=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(e){if(this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,n=e.notIn.length;t<n;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;let n=e.findTokenIndexAtOffset(t-2),i=e.getStandardTokenType(n);return this.isOK(i)}_findNeutralCharacterInRange(e,t){for(let n=e;n<=t;n++){let i=String.fromCharCode(n);if(!this.open.includes(i)&&!this.close.includes(i))return i}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},Gy=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let t of e)lf(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),lf(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),lf(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),lf(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&lf(this.autoClosingPairsCloseSingleChar,t.close,t)}};function lf(o,e,t){o.has(e)?o.get(e).push(t):o.set(e,[t])}var OL=class o{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(e,t,n,i,r,s){this.languageId=e,this.index=t,this.open=n,this.close=i,this.forwardRegex=r,this.reversedRegex=s,this._openSet=o._toSet(this.open),this._closeSet=o._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){let t=new Set;for(let n of e)t.add(n);return t}};function N5(o){let e=o.length;o=o.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let t=[];for(let s=0;s<e;s++)t[s]=s;let n=(s,a)=>{let[l,d]=s,[c,u]=a;return l===c||l===u||d===c||d===u},i=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<e;c++)t[c]===d&&(t[c]=l)};for(let s=0;s<e;s++){let a=o[s];for(let l=s+1;l<e;l++){let d=o[l];n(a,d)&&i(t[s],t[l])}}let r=[];for(let s=0;s<e;s++){let a=[],l=[];for(let d=0;d<e;d++)if(t[d]===s){let[c,u]=o[d];a.push(c),l.push(u)}a.length>0&&r.push({open:a,close:l})}return r}var jy=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(e,t){let n=N5(t);this.brackets=n.map((i,r)=>new OL(e,r,i.open,i.close,A5(i.open,i.close,n,r),O5(i.open,i.close,n,r))),this.forwardRegex=P5(this.brackets),this.reversedRegex=F5(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let i of this.brackets){for(let r of i.open)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(let r of i.close)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}};function jA(o,e,t,n){for(let i=0,r=e.length;i<r;i++){if(i===t)continue;let s=e[i];for(let a of s.open)a.indexOf(o)>=0&&n.push(a);for(let a of s.close)a.indexOf(o)>=0&&n.push(a)}}function $A(o,e){return o.length-e.length}function $y(o){if(o.length<=1)return o;let e=[],t=new Set;for(let n of o)t.has(n)||(e.push(n),t.add(n));return e}function A5(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)jA(i[r],t,n,i);return i=$y(i),i.sort($A),i.reverse(),Nh(i)}function O5(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)jA(i[r],t,n,i);return i=$y(i),i.sort($A),i.reverse(),Nh(i.map(PL))}function P5(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=$y(e),Nh(e)}function F5(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=$y(e),Nh(e.map(PL))}function B5(o){let e=/^[\w ]+$/.test(o);return o=Gi(o),e?`\\b${o}\\b`:o}function Nh(o,e){let t=`(${o.map(B5).join(")|(")})`;return Yv(t,!0,e)}var PL=function(){function o(n){let i=new Uint16Array(n.length),r=0;for(let s=n.length-1;s>=0;s--)i[r++]=n.charCodeAt(s);return EL().decode(i)}let e=null,t=null;return function(i){return e!==i&&(e=i,t=o(e)),t}}(),po=class{static _findPrevBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=n.length-(r.index||0),a=r[0].length,l=i+s;return new L(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,n,i,r){let a=PL(n).substring(n.length-r,n.length-i);return this._findPrevBracketInText(e,t,a,i)}static findNextBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=r.index||0,a=r[0].length;if(a===0)return null;let l=i+s;return new L(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,n,i,r){let s=n.substring(i,r);return this.findNextBracketInText(e,t,s,i)}};var qy=class{constructor(e,t){this.languageId=e;let n=t.brackets?qA(t.brackets):[],i=new Cg(a=>{let l=new Set;return{info:new FL(this,a,l),closing:l}}),r=new Cg(a=>{let l=new Set,d=new Set;return{info:new BL(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of n){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=t.colorizedBracketPairs?qA(t.colorizedBracketPairs):n.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...i.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){let t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return Nh(t,e)}};function qA(o){return o.filter(([e,t])=>e!==""&&t!=="")}var Yy=class{constructor(e,t){this.config=e;this.bracketText=t}get languageId(){return this.config.languageId}},FL=class extends Yy{constructor(t,n,i){super(t,n);this.openedBrackets=i}isOpeningBracket=!0},BL=class extends Yy{constructor(t,n,i,r){super(t,n);this.openingBrackets=i;this.openingColorizedBrackets=r}isOpeningBracket=!1;closes(t){return t.config!==this.config?!1:this.openingBrackets.has(t)}closesColorized(t){return t.config!==this.config?!1:this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}};var Rt=class o{static _nextVisibleColumn(e,t,n){return e===9?o.nextRenderTabStop(t,n):Tr(e)||Tg(e)?t+2:t+1}static visibleColumnFromColumn(e,t,n){let i=Math.min(t-1,e.length),r=e.substring(0,i),s=new Cc(r),a=0;for(;!s.eol();){let l=hh(r,i,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,n)}return a}static toStatusbarColumn(e,t,n){let i=e.substring(0,Math.min(t-1,e.length)),r=new Ic(i),s=0;for(;!r.eol();)r.nextCodePoint()===9?s=o.nextRenderTabStop(s,n):s=s+1;return s+1}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;let i=e.length,r=new Cc(e),s=0,a=1;for(;!r.eol();){let l=hh(e,i,r.offset);r.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,n),c=r.offset+1;if(d>=t){let u=t-s;return d-t<u?c:a}s=d,a=c}return i+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}};var Dr=class o{constructor(e,t){this.lineCount=e;this.columnCount=t}static zero=new o(0,0);static lengthDiffNonNegative(e,t){return t.isLessThan(e)?o.zero:e.lineCount===t.lineCount?new o(0,t.columnCount-e.columnCount):new o(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new o(0,t.column-e.column):new o(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return o.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,n=0;for(let i of e)i===`
`?(t++,n=0):n++;return new o(t,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new o(this.lineCount,this.columnCount+e.columnCount):new o(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new L(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new L(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new L(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new V(e.lineNumber,e.column+this.columnCount):new V(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};function YA(o,e,t,n){return o!==t?Ut(t-o,n):Ut(0,n-e)}var Yn=0;function Ah(o){return o===0}var or=2**26;function Ut(o,e){return o*or+e}function Zi(o){let e=o,t=Math.floor(e/or),n=e-t*or;return new Dr(t,n)}function ZA(o){return Math.floor(o/or)}function Ot(o,e){let t=o+e;return e>=or&&(t=t-o%or),t}function XA(o,e){return o.reduce((t,n)=>Ot(t,e(n)),Yn)}function VL(o,e){return o===e}function Bc(o,e){let t=o,n=e;if(n-t<=0)return Yn;let r=Math.floor(t/or),s=Math.floor(n/or),a=n-s*or;if(r===s){let l=t-r*or;return Ut(0,a-l)}else return Ut(s-r,a)}function al(o,e){return o<e}function Sd(o,e){return o<=e}function Oh(o,e){return o>=e}function xd(o){return Ut(o.lineNumber-1,o.column-1)}function Ed(o,e){let t=o,n=Math.floor(t/or),i=t-n*or,r=e,s=Math.floor(r/or),a=r-s*or;return new L(n+1,i+1,s+1,a+1)}function QA(o){let e=Sc(o);return Ut(e.length-1,e[e.length-1].length)}var Zy=[],bi=class o{constructor(e,t){this.items=e;this.additionalItems=t}static cache=new Array(129);static create(e,t){if(e<=128&&t.length===0){let n=o.cache[e];return n||(n=new o(e,t),o.cache[e]=n),n}return new o(e,t)}static empty=o.create(0,Zy);static getEmpty(){return this.empty}add(e,t){let n=t.getKey(e),i=n>>5;if(i===0){let s=1<<n|this.items;return s===this.items?this:o.create(s,this.additionalItems)}i--;let r=this.additionalItems.slice(0);for(;r.length<i;)r.push(0);return r[i]|=1<<(n&31),o.create(this.items,r)}has(e,t){let n=t.getKey(e),i=n>>5;return i===0?(this.items&1<<n)!==0:(i--,((this.additionalItems[i]||0)&1<<(n&31))!==0)}merge(e){let t=this.items|e.items;if(this.additionalItems===Zy&&e.additionalItems===Zy)return t===this.items?this:t===e.items?e:o.create(t,Zy);let n=[];for(let i=0;i<Math.max(this.additionalItems.length,e.additionalItems.length);i++){let r=this.additionalItems[i]||0,s=e.additionalItems[i]||0;n.push(r|s)}return o.create(t,n)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}equals(e){if(this.items!==e.items||this.additionalItems.length!==e.additionalItems.length)return!1;for(let t=0;t<this.additionalItems.length;t++)if(this.additionalItems[t]!==e.additionalItems[t])return!1;return!0}},WL={getKey(o){return o}},Xy=class{items=new Map;getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}reverseLookup(e){return[...this.items].find(([t,n])=>n===e)?.[0]}reverseLookupSet(e){let t=[];for(let[n]of this.items)e.has(n,this)&&t.push(n);return t}keys(){return this.items.keys()}};var Qy=class o{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new Mh(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new Mh({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){let t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new Mh({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var Jy=class{_richEditBrackets;constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(let t of this._richEditBrackets.brackets)for(let n of t.close){let i=n.charAt(n.length-1);e.push(i)}return qa(e)}onElectricCharacter(e,t,n){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let i=t.findTokenIndexAtOffset(n-1);if(Yr(t.getStandardTokenType(i)))return null;let r=this._richEditBrackets.reversedRegex,s=t.getLineContent().substring(0,n-1)+e,a=po.findPrevBracketInRange(r,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function eI(o){return o.global&&(o.lastIndex=0),!0}var tI=class{_indentationRules;constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&eI(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&eI(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&eI(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&eI(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}};var nI=class o{_brackets;_regExpRules;constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{let n=o._createOpenBracketRegExp(t[0]),i=o._createCloseBracketRegExp(t[1]);n&&i&&this._brackets.push({open:t[0],openRegExp:n,close:t[1],closeRegExp:i})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,n,i){if(e>=3)for(let r=0,s=this._regExpRules.length;r<s;r++){let a=this._regExpRules[r];if([{reg:a.beforeText,text:n},{reg:a.afterText,text:i},{reg:a.previousLineText,text:t}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(e>=2&&n.length>0&&i.length>0)for(let r=0,s=this._brackets.length;r<s;r++){let a=this._brackets[r];if(a.openRegExp.test(n)&&a.closeRegExp.test(i))return{indentAction:2}}if(e>=2&&n.length>0){for(let r=0,s=this._brackets.length;r<s;r++)if(this._brackets[r].openRegExp.test(n))return{indentAction:1}}return null}static _createOpenBracketRegExp(e){let t=Gi(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",o._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Gi(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,o._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return Ne(t),null}}};var V5=[];function Pn(o,e,t){e instanceof xc||(e=new xc(e,[],!!t)),V5.push([o,e])}var Vc=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});var W5={ModesRegistry:"editor.modesRegistry"},UL=class{_languages;_onDidChangeLanguages=new T;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}},eO=new UL;Je.add(W5.ModesRegistry,eO);var ll="plaintext",H5=".txt";eO.registerLanguage({id:ll,extensions:[H5],aliases:[p("plainText.alias","Plain Text"),"text"],mimetypes:[Vc.text]});Je.as($r.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var cf=class{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}},Rr=Z("languageConfigurationService"),df=class extends B{constructor(t,n){super();this.configurationService=t;this.languageService=n;let i=new Set(Object.values(zL));this._register(this.configurationService.onDidChangeConfiguration(r=>{let s=r.change.keys.some(l=>i.has(l)),a=r.change.overrides.filter(([l,d])=>d.some(c=>i.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new cf(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new cf(l)))})),this._register(this._registry.onDidChange(r=>{this.configurations.delete(r.languageId),this.onDidChangeEmitter.fire(new cf(r.languageId))}))}_serviceBrand;_registry=this._register(new GL);onDidChangeEmitter=this._register(new T);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(t,n,i){return this._registry.register(t,n,i)}getLanguageConfiguration(t){let n=this.configurations.get(t);return n||(n=U5(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,n)),n}};df=k([E(0,rt),E(1,ho)],df);function U5(o,e,t,n){let i=e.getLanguageConfiguration(o);if(!i){if(!n.isRegisteredLanguageId(o))return new Ph(o,{});i=new Ph(o,{})}let r=z5(i.languageId,t),s=nO([i.underlyingConfig,r]);return new Ph(i.languageId,s)}var zL={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function z5(o,e){let t=e.getValue(zL.brackets,{overrideIdentifier:o}),n=e.getValue(zL.colorizedBracketPairs,{overrideIdentifier:o});return{brackets:tO(t),colorizedBracketPairs:tO(n)}}function tO(o){if(Array.isArray(o))return o.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function rI(o,e,t){let n=o.getLineContent(e),i=qn(n);return i.length>t-1&&(i=i.substring(0,t-1)),i}var KL=class{constructor(e){this.languageId=e;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(e,t){let n=new iI(e,t,++this._order);return this._entries.push(n),this._resolved=null,pe(()=>{for(let i=0;i<this._entries.length;i++)if(this._entries[i]===n){this._entries.splice(i,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let e=this._resolve();e&&(this._resolved=new Ph(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(iI.cmp),nO(this._entries.map(e=>e.configuration)))}};function nO(o){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let t of o)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}var iI=class{constructor(e,t,n){this.configuration=e;this.priority=t;this.order=n}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}},oI=class{constructor(e){this.languageId=e}},GL=class extends B{_entries=new Map;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(ll,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,n=0){let i=this._entries.get(e);i||(i=new KL(e),this._entries.set(e,i));let r=i.register(t,n);return this._onDidChange.fire(new oI(e)),pe(()=>{r.dispose(),this._onDidChange.fire(new oI(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}},Ph=class o{constructor(e,t){this.languageId=e;this.underlyingConfig=t;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new nI(this.underlyingConfig):null,this.comments=o._handleComments(this.underlyingConfig),this.characterPair=new Qy(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||wy,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new tI(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new qy(e,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return Yg(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new jy(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new Jy(this.brackets)),this._electricCharacter}onEnter(e,t,n,i){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,n,i):null}getAutoClosingPairs(){return new Gy(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){let t=e.comments;if(!t)return null;let n={};if(t.lineComment&&(n.lineCommentToken=t.lineComment),t.blockComment){let[i,r]=t.blockComment;n.blockCommentStartToken=i,n.blockCommentEndToken=r}return n}};Pn(Rr,df,1);var jL=class o{constructor(e){this.map=e}static createFromLanguage(e,t){function n(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}let i=new Map;for(let r of e.bracketsNew.openingBrackets){let s=Ut(0,r.bracketText.length),a=n(r),l=bi.getEmpty().add(a,WL);i.set(r.bracketText,new vs(s,1,a,l,uf.create(s,r,l)))}for(let r of e.bracketsNew.closingBrackets){let s=Ut(0,r.bracketText.length),a=bi.getEmpty(),l=r.getOpeningBrackets();for(let d of l)a=a.add(n(d),WL);i.set(r.bracketText,new vs(s,2,n(l[0]),a,uf.create(s,r,a)))}return new o(i)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>K5(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(let[t,n]of this.map)if(n.kind===2&&n.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}};function K5(o){let e=Gi(o);return/^[\w ]+/.test(o)&&(e=`\\b${e}`),/[\w ]+$/.test(o)&&(e=`${e}\\b`),e}var sI=class{constructor(e,t){this.denseKeyProvider=e;this.getLanguageConfiguration=t}languageIdToBracketTokens=new Map;didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=jL.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}getToken(e,t){return this.getSingleLanguageBracketTokens(t).getToken(e)}};var vs=class{constructor(e,t,n,i,r){this.length=e;this.kind=t;this.bracketId=n;this.bracketIds=i;this.astNode=r}},aI=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new $L(this.textModel,this.bracketTokens);_offset=Yn;get offset(){return this._offset}get length(){return Ut(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(e){this.didPeek=!1,this._offset=Ot(this._offset,e);let t=Zi(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}didPeek=!1;peeked=null;read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=Ot(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},$L=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let e=this.lineIdx,t=this.lineCharOffset,n=0;for(;;){let r=this.lineTokens,s=r.getCount(),a=null;if(this.lineTokenOffset<s){let l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=tr.getTokenType(l)===0,c=tr.containsBalancedBrackets(l),u=r.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<u){let h=r.getLanguageId(this.lineTokenOffset),m=this.line.substring(this.lineCharOffset,u),g=this.bracketTokens.getSingleLanguageBracketTokens(h),f=g.regExpGlobal;if(f){f.lastIndex=0;let b=f.exec(m);b&&(a=g.getToken(b[0]),a&&(this.lineCharOffset+=b.index))}}if(n+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n+=33,n>1e3))break;if(n>1500)break}let i=YA(e,t,this.lineIdx,this.lineCharOffset);return new vs(i,0,-1,bi.getEmpty(),new ys(i))}},lI=class{constructor(e,t){this.text=e;let n=t.getRegExpStr(),i=n?new RegExp(n+`|
`,"gi"):null,r=[],s,a=0,l=0,d=0,c=0,u=[];for(let g=0;g<60;g++)u.push(new vs(Ut(0,g),0,-1,bi.getEmpty(),new ys(Ut(0,g))));let h=[];for(let g=0;g<60;g++)h.push(new vs(Ut(1,g),0,-1,bi.getEmpty(),new ys(Ut(1,g))));if(i)for(i.lastIndex=0;(s=i.exec(e))!==null;){let g=s.index,f=s[0];if(f===`
`)a++,l=g+1;else{if(d!==g){let b;if(c===a){let y=g-d;if(y<u.length)b=u[y];else{let C=Ut(0,y);b=new vs(C,0,-1,bi.getEmpty(),new ys(C))}}else{let y=a-c,C=g-l;if(y===1&&C<h.length)b=h[C];else{let S=Ut(y,C);b=new vs(S,0,-1,bi.getEmpty(),new ys(S))}}r.push(b)}r.push(t.getToken(f)),d=g+f.length,c=a}}let m=e.length;if(d!==m){let g=c===a?Ut(0,m-d):Ut(a-c,m-l);r.push(new vs(g,0,-1,bi.getEmpty(),new ys(g)))}this.length=Ut(a,m-l),this.tokens=r}_offset=Yn;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new Iv}getText(){return this.text}};var hf=class{_length;get length(){return this._length}constructor(e){this._length=e}},pf=class o extends hf{constructor(t,n,i,r,s){super(t);this.openingBracket=n;this.child=i;this.closingBracket=r;this.missingOpeningBracketIds=s}static create(t,n,i){let r=t.length;return n&&(r=Ot(r,n.length)),i&&(r=Ot(r,i.length)),new o(r,t,n,i,n?n.missingOpeningBracketIds:bi.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}canBeReused(t){return!(this.closingBracket===null||t.intersects(this.missingOpeningBracketIds))}flattenLists(){return o.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new o(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,n){return this.child?this.child.computeMinIndentation(Ot(t,this.openingBracket.length),n):Number.MAX_SAFE_INTEGER}},rr=class o extends hf{constructor(t,n,i){super(t);this.listHeight=n;this._missingOpeningBracketIds=i}static create23(t,n,i,r=!1){let s=t.length,a=t.missingOpeningBracketIds;if(t.listHeight!==n.listHeight)throw new Error("Invalid list heights");if(s=Ot(s,n.length),a=a.merge(n.missingOpeningBracketIds),i){if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=Ot(s,i.length),a=a.merge(i.missingOpeningBracketIds)}return r?new qL(s,t.listHeight+1,t,n,i,a):new mf(s,t.listHeight+1,t,n,i,a)}static create(t,n=!1){if(t.length===0)return this.getEmpty();{let i=t[0].length,r=t[0].missingOpeningBracketIds;for(let s=1;s<t.length;s++)i=Ot(i,t[s].length),r=r.merge(t[s].missingOpeningBracketIds);return n?new dI(i,t[0].listHeight+1,t,r):new gf(i,t[0].listHeight+1,t,r)}}static getEmpty(){return new dI(Yn,0,[],bi.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let t=this.childrenLength;if(t===0)return;let n=this.getChild(t-1),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(t-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let n=this.getChild(0),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(0,i),i}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let n=this;for(;n.kind===4;){let i=n.childrenLength;if(i===0)throw new Te;n=n.getChild(i-1)}return n.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();let t=this.childrenLength,n=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let r=1;r<t;r++){let s=this.getChild(r);n=Ot(n,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=n,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}flattenLists(){let t=[];for(let n of this.children){let i=n.flattenLists();i.kind===4?t.push(...i.children):t.push(i)}return o.create(t)}computeMinIndentation(t,n){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,r=t;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(i=Math.min(i,a.computeMinIndentation(r,n)),r=Ot(r,a.length))}return this.cachedMinIndentation=i,i}},mf=class o extends rr{constructor(t,n,i,r,s,a){super(t,n,a);this._item1=i;this._item2=r;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,n){switch(t){case 0:this._item1=n;return;case 1:this._item2=n;return;case 2:this._item3=n;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new o(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}},qL=class extends mf{toMutable(){return new mf(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},gf=class o extends rr{constructor(t,n,i,r){super(t,n,r);this._children=i}get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,n){this._children[t]=n}get children(){return this._children}deepClone(){let t=new Array(this._children.length);for(let n=0;n<this._children.length;n++)t[n]=this._children[n].deepClone();return new o(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}},dI=class extends gf{toMutable(){return new gf(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},j5=[],ff=class extends hf{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return j5}flattenLists(){return this}deepClone(){return this}},ys=class extends ff{get kind(){return 0}get missingOpeningBracketIds(){return bi.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){let n=Zi(e),i=(n.columnCount===0?n.lineCount:n.lineCount+1)+1,r=ZA(Ot(e,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=i;a<=r;a++){let l=t.getLineFirstNonWhitespaceColumn(a),d=t.getLineContent(a);if(l===0)continue;let c=Rt.visibleColumnFromColumn(d,l,t.getOptions().tabSize);s=Math.min(s,c)}return s}},uf=class o extends ff{constructor(t,n,i){super(t);this.bracketInfo=n;this.bracketIds=i}static create(t,n,i){return new o(t,n,i)}get kind(){return 1}get missingOpeningBracketIds(){return bi.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,n){return Number.MAX_SAFE_INTEGER}},cI=class extends ff{get kind(){return 3}missingOpeningBracketIds;constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}};var bf=class{constructor(e,t,n,i){this.range=e;this.nestingLevel=t;this.nestingLevelOfEqualBracketType=n;this.isInvalid=i}},YL=class{constructor(e,t,n,i,r,s){this.range=e;this.openingBracketRange=t;this.closingBracketRange=n;this.nestingLevel=i;this.nestingLevelOfEqualBracketType=r;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},uI=class extends YL{constructor(t,n,i,r,s,a,l){super(t,n,i,r,s,a);this.minVisibleColumnIndentation=l}};var hI=class{changeType=1},ko=class o{constructor(e,t,n,i,r){this.ownerId=e;this.lineNumber=t;this.column=n;this.options=i;this.order=r}static applyInjectedText(e,t){if(!t||t.length===0)return e;let n="",i=0;for(let r of t)n+=e.substring(i,r.column-1),i=r.column-1,n+=r.options.content;return n+=e.substring(i),n}static fromDecorations(e){let t=[];for(let n of e)n.options.before&&n.options.before.content.length>0&&t.push(new o(n.ownerId,n.range.startLineNumber,n.range.startColumn,n.options.before,0)),n.options.after&&n.options.after.content.length>0&&t.push(new o(n.ownerId,n.range.endLineNumber,n.range.endColumn,n.options.after,1));return t.sort((n,i)=>n.lineNumber===i.lineNumber?n.column===i.column?n.order-i.order:n.column-i.column:n.lineNumber-i.lineNumber),t}withText(e){return new o(this.ownerId,this.lineNumber,this.column,{...this.options,content:e},this.order)}},vf=class{changeType=2;lineNumber;detail;injectedText;constructor(e,t,n){this.lineNumber=e,this.detail=t,this.injectedText=n}},pI=class{changeType=3;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},mI=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(e,t,n,i){this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}},gI=class{changeType=5},Wc=class o{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.versionId,r=e.isUndoing||t.isUndoing,s=e.isRedoing||t.isRedoing;return new o(n,i,r,s)}},Fh=class{changes;constructor(e){this.changes=e}},wd=class o{constructor(e,t){this.rawContentChangedEvent=e;this.contentChangedEvent=t}merge(e){let t=Wc.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=o._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new o(t,n)}static _mergeChangeEvents(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.eol,r=t.versionId,s=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,d=e.isEolChange&&t.isEolChange;return{changes:n,eol:i,isEolChange:d,versionId:r,isUndoing:s,isRedoing:a,isFlush:l}}};var Zr=class{constructor(e,t,n,i,r,s){this.visibleColumn=e;this.column=t;this.className=n;this.horizontalLine=i;this.forWrappedLinesAfterColumn=r;this.forWrappedLinesBeforeOrAtColumn=s;if(e!==-1==(t!==-1))throw new Error}},dl=class{constructor(e,t){this.top=e;this.endColumn=t}};var fI=class o{constructor(e){this.edits=e;let t=-1;for(let n of e){if(!(n.replaceRange.start>=t))throw new Te(`Edits must be disjoint and sorted. Found ${n} after ${t}`);t=n.replaceRange.endExclusive}}static empty=new o([]);static fromJson(e){return new o(e.map(Is.fromJson))}static replace(e,t){return new o([new Is(e,t)])}static insert(e,t){return o.replace(Ht.emptyAt(e),t)}normalize(){let e=[],t;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(t&&t.replaceRange.endExclusive===n.replaceRange.start?t=new Is(t.replaceRange.join(n.replaceRange),t.newText+n.newText):(t&&e.push(t),t=n));return t&&e.push(t),new o(e)}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],n=0;for(let i of this.edits)t.push(e.substring(n,i.replaceRange.start)),t.push(i.newText),n=i.replaceRange.endExclusive;return t.push(e.substring(n)),t.join("")}compose(e){return q5(this,e)}inverse(e){let t=[],n=0;for(let i of this.edits)t.push(new Is(Ht.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e.substring(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new o(t)}getNewTextRanges(){let e=[],t=0;for(let n of this.edits)e.push(Ht.ofStartAndLength(n.replaceRange.start+t,n.newText.length)),t+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],n=0,i=0,r=0;for(;i<this.edits.length||n<e.edits.length;){let s=e.edits[n],a=this.edits[i];if(a)s?a.replaceRange.intersects(s.replaceRange)?i++:a.replaceRange.start<s.replaceRange.start?(t.push(new Is(a.replaceRange.delta(r),a.newText)),i++):(n++,r+=s.newText.length-s.replaceRange.length):(t.push(new Is(a.replaceRange.delta(r),a.newText)),i++);else break}return new o(t)}applyToOffset(e){let t=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+t;t+=n.newText.length-n.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new Ht(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let t=0;for(let n of this.edits){let i=n.newText.length;if(n.replaceRange.start<=e-t){if(e-t<n.replaceRange.start+i)return n.replaceRange.start;t+=i-n.replaceRange.length}else break}return e-t}},Is=class o{constructor(e,t){this.replaceRange=e;this.newText=t}static fromJson(e){return new o(Ht.ofStartAndLength(e.pos,e.len),e.txt)}static insert(e,t){return new o(Ht.emptyAt(e),t)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function q5(o,e){if(o=o.normalize(),e=e.normalize(),o.isEmpty)return e;if(e.isEmpty)return o;let t=[...o.edits],n=[],i=0;for(let r of e.edits){for(;;){let d=t[0];if(!d||d.replaceRange.start+i+d.newText.length>=r.replaceRange.start)break;t.shift(),n.push(d),i+=d.newText.length-d.replaceRange.length}let s=i,a,l;for(;;){let d=t[0];if(!d||d.replaceRange.start+i>r.replaceRange.endExclusive)break;a||(a=d),l=d,t.shift(),i+=d.newText.length-d.replaceRange.length}if(!a)n.push(new Is(r.replaceRange.delta(-i),r.newText));else{let d="",c=r.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let u=l.replaceRange.endExclusive+i-r.replaceRange.endExclusive;if(u>0){let g=new Is(Ht.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-u));t.unshift(g),i-=g.newText.length-g.replaceRange.length}let h=d+r.newText,m=new Ht(Math.min(a.replaceRange.start,r.replaceRange.start-s),r.replaceRange.endExclusive-i);n.push(new Is(m,h))}}for(;;){let r=t.shift();if(!r)break;n.push(r)}return new fI(n).normalize()}var vI=Z("undoRedoService");var bI=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o},iO=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o};var Bh=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&Ai(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}},_d=class{_findMatchBrand=void 0;range;matches;constructor(e,t){this.range=e,this.matches=t}};function oO(o){return o&&typeof o.read=="function"}var Vh=class{constructor(e,t,n,i,r,s){this.identifier=e;this.range=t;this.text=n;this.forceMoveMarkers=i;this.isAutoWhitespaceEdit=r;this._isTracked=s}},yI=class{regex;wordSeparators;simpleSearch;constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}},II=class{constructor(e,t,n){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=n}};var ZL={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var dn=Z("fileService");function rO(o){return!!(o.capabilities&2048)}var QL=class o extends Error{constructor(t,n){super(t);this.code=n}static create(t,n){let i=new o(t.toString(),n);return Z5(i,n),i}};function Z5(o,e){return o.name=e?`${e} (FileSystemError)`:"FileSystemError",o}function X5(o){if(!o)return"Unknown";if(o instanceof QL)return o.code;let e=/^(.+) \(FileSystemError\)$/.exec(o.name);if(!e)return"Unknown";switch(e[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function sO(o){if(o instanceof yf)return o.fileOperationResult;switch(X5(o)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var yf=class extends Error{constructor(t,n,i){super(t);this.fileOperationResult=n;this.options=i}};var CI=class extends yf{constructor(t,n,i){super(t,2,i);this.stat=n}};var Cs={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},Wh={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"};var aO="files.readonlyInclude",lO="files.readonlyExclude";var If="";var Td=class o{static KB=1024;static MB=o.KB*o.KB;static GB=o.MB*o.KB;static TB=o.GB*o.KB;static formatSize(e){return mi(e)||(e=0),e<o.KB?p("sizeB","{0}B",e.toFixed(0)):e<o.MB?p("sizeKB","{0}KB",(e/o.KB).toFixed(2)):e<o.GB?p("sizeMB","{0}MB",(e/o.MB).toFixed(2)):e<o.TB?p("sizeGB","{0}GB",(e/o.GB).toFixed(2)):p("sizeTB","{0}TB",(e/o.TB).toFixed(2))}};function dO(o){let e=typeof o=="string"||o?.scheme===Ae.vscodeRemote;return typeof o!="string"&&o?.scheme===Ae.file?1024*Td.MB:e?10*Td.MB:wo?50*Td.MB:1024*Td.MB}var Hh=Z("textModelService");var cO="";var Ss=class extends B{_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var kr=Z("modelService");var Uh=Z("ILanguageDetectionService"),JL="languageDetection";var ma=class extends Ss{constructor(t,n,i,r,s){super();this.modelService=t;this.languageService=n;this.languageDetectionService=i;this.accessibilityService=r;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new rn);autoDetectLanguageThrottler=this._register(new Jg(ma.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(t){let n=this.modelService.getModel(t);if(!n)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.textEditorModelHandle=t,this.registerModelDisposeListener(n)}registerModelDisposeListener(t){this.modelDisposeListener.value=t.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(t,n){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(t,n)}setLanguageIdInternal(t,n){this.isResolved()&&(!t||t===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(t),n))}installModelListeners(t){let n=this._register(t.onDidChangeLanguage(i=>{i.source!==JL&&(this._hasLanguageSetExplicitly=!0,n.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??ll))return;let t=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),n=this.getLanguageId();if(t&&t!==n&&!this.isDisposed()){this.setLanguageIdInternal(t,JL);let i=this.languageService.getLanguageName(t);this.accessibilityService.alert(p("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",i??t))}}createTextEditorModel(t,n,i){let r=this.getFirstLineText(t),s=this.getOrCreateLanguage(n,this.languageService,i,r);return this.doCreateTextEditorModel(t,s,n)}doCreateTextEditorModel(t,n,i){let r=i&&this.modelService.getModel(i);return r?this.updateTextEditorModel(t,n.languageId):(r=this.modelService.createModel(t,n,i),this.createdEditorModel=!0,this.registerModelDisposeListener(r)),this.textEditorModelHandle=r.uri,r}getFirstLineText(t){let n=t;return typeof n.getFirstLineText=="function"?n.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(t,n,i,r){return!i||i===ll?n.createByFilepathOrFirstLine(t??null,r):n.createById(i)}updateTextEditorModel(t,n){this.isResolved()&&(t&&this.modelService.updateModel(this.textEditorModel,t),n&&n!==ll&&this.textEditorModel.getLanguageId()!==n&&this.textEditorModel.setLanguage(this.languageService.createById(n)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};ma=k([E(0,kr),E(1,ho),E(2,Uh),E(3,Jo)],ma);var SI=Z("workingCopyBackupService");var Xi=Z("textResourceConfigurationService"),Rle=Z("textResourcePropertiesService");function Q5(o,e,t){let n=0;for(let r=0;r<o.length;r++)o.charAt(r)==="	"?n=Rt.nextIndentTabStop(n,e):n++;let i="";if(!t){let r=Math.floor(n/e);n=n%e;for(let s=0;s<r;s++)i+="	"}for(let r=0;r<n;r++)i+=" ";return i}function xI(o,e,t){let n=ln(o);return n===-1&&(n=o.length),Q5(o.substring(0,n),e,t)+o.substring(n)}var Hc=class o{constructor(e,t,n){this.startOffset=e;this.endOffset=t;this.newLength=n}static fromModelContentChanges(e){return e.map(n=>{let i=L.lift(n.range);return new o(xd(i.getStartPosition()),xd(i.getEndPosition()),QA(n.text))}).reverse()}toString(){return`[${Zi(this.startOffset)}...${Zi(this.endOffset)}) -> ${Zi(this.newLength)}`}},EI=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(e){this.edits=e.map(t=>eD.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);let t=this.edits[this.nextEditIdx],n=t?this.translateOldToCur(t.offsetObj):null;return n===null?null:Bc(e,n)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Ut(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Ut(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){let t=Zi(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Ut(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Ut(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){let t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if(Sd(n,e)){this.nextEditIdx++;let i=Zi(n),r=Zi(this.translateOldToCur(t.endOffsetBeforeObj)),s=i.lineCount-r.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=i.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}},eD=class o{static from(e){return new o(e.startOffset,e.endOffset,e.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(e,t,n){this.endOffsetBeforeObj=Zi(t),this.endOffsetAfterObj=Zi(Ot(e,n)),this.offsetObj=Zi(e)}};function pO(o){if(o.length===0)return null;if(o.length===1)return o[0];let e=0;function t(){if(e>=o.length)return null;let s=e,a=o[s].listHeight;for(e++;e<o.length&&o[e].listHeight===a;)e++;return e-s>=2?nD(s===0&&e===o.length?o:o.slice(s,e),!1):o[s]}let n=t(),i=t();if(!i)return n;for(let s=t();s;s=t())uO(n,i)<=uO(i,s)?(n=tD(n,i),i=s):i=tD(i,s);return tD(n,i)}function nD(o,e=!1){if(o.length===0)return null;if(o.length===1)return o[0];let t=o.length;for(;t>3;){let n=t>>1;for(let i=0;i<n;i++){let r=i<<1;o[i]=rr.create23(o[r],o[r+1],r+3===t?o[r+2]:null,e)}t=n}return rr.create23(o[0],o[1],t>=3?o[2]:null,e)}function uO(o,e){return Math.abs(o.listHeight-e.listHeight)}function tD(o,e){return o.listHeight===e.listHeight?rr.create23(o,e,null,!1):o.listHeight>e.listHeight?J5(o,e):eU(e,o)}function J5(o,e){o=o.toMutable();let t=o,n=[],i;for(;;){if(e.listHeight===t.listHeight){i=e;break}if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeLastElementMutable()}for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=rr.create23(s.unappendChild(),i,null,!1):(s.appendChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?rr.create23(o,i,null,!1):o}function eU(o,e){o=o.toMutable();let t=o,n=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeFirstElementMutable()}let i=e;for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=rr.create23(i,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?rr.create23(i,o,null,!1):o}var wI=class{nextNodes;offsets;idxs;lastOffset=Yn;constructor(e){this.nextNodes=[e],this.offsets=[Yn],this.idxs=[]}readLongestNodeAt(e,t){if(al(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){let n=Cf(this.nextNodes);if(!n)return;let i=Cf(this.offsets);if(al(e,i))return;if(al(i,e))if(Ot(i,n.length)<=e)this.nextNodeAfterCurrent();else{let r=iD(n);r!==-1?(this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(n))return this.nextNodeAfterCurrent(),n;{let r=iD(n);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){let e=Cf(this.offsets),t=Cf(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let n=Cf(this.nextNodes),i=iD(n,this.idxs[this.idxs.length-1]);if(i!==-1){this.nextNodes.push(n.getChild(i)),this.offsets.push(Ot(e,t.length)),this.idxs[this.idxs.length-1]=i;break}else this.idxs.pop()}}};function iD(o,e=-1){for(;;){if(e++,e>=o.childrenLength)return-1;if(o.getChild(e))return e}}function Cf(o){return o.length>0?o[o.length-1]:void 0}function rD(o,e,t,n){return new oD(o,e,t,n).parseDocument()}var oD=class{constructor(e,t,n,i){this.tokenizer=e;this.createImmutableLists=i;if(n&&i)throw new Error("Not supported");this.oldNodeReader=n?new wI(n):void 0,this.positionMapper=new EI(t)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(bi.getEmpty(),0);return e||(e=rr.getEmpty()),e}parseList(e,t){let n=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||n.push(r)}return this.oldNodeReader?pO(n):nD(n,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){let t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!Ah(t)){let n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),i=>t!==null&&!al(i.length,t)?!1:i.canBeReused(e));if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}}parseChild(e,t){this._itemsConstructed++;let n=this.tokenizer.read();switch(n.kind){case 2:return new cI(n.bracketIds,n.length);case 0:return n.astNode;case 1:{if(t>300)return new ys(n.length);let i=e.merge(n.bracketIds),r=this.parseList(i,t+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===n.bracketId||s.bracketIds.intersects(n.bracketIds))?(this.tokenizer.read(),pf.create(n.astNode,r,s.astNode)):pf.create(n.astNode,r,null)}default:throw new Error("unexpected")}}};function sD(o,e){if(o.length===0)return e;if(e.length===0)return o;let t=new Li(mO(o)),n=mO(e);n.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let i=t.dequeue();function r(d){if(d===void 0){let u=t.takeWhile(h=>!0)||[];return i&&u.unshift(i),u}let c=[];for(;i&&!Ah(d);){let[u,h]=i.splitAt(d);c.push(u),d=Bc(u.lengthAfter,d),i=h??t.dequeue()}return Ah(d)||c.push(new Sf(!1,d,d)),c}let s=[];function a(d,c,u){if(s.length>0&&VL(s[s.length-1].endOffset,d)){let h=s[s.length-1];s[s.length-1]=new Hc(h.startOffset,c,Ot(h.newLength,u))}else s.push({startOffset:d,endOffset:c,newLength:u})}let l=Yn;for(let d of n){let c=r(d.lengthBefore);if(d.modified){let u=XA(c,m=>m.lengthBefore),h=Ot(l,u);a(l,h,d.lengthAfter),l=h}else for(let u of c){let h=l;l=Ot(l,u.lengthBefore),u.modified&&a(h,l,u.lengthAfter)}}return s}var Sf=class o{constructor(e,t,n){this.modified=e;this.lengthBefore=t;this.lengthAfter=n}splitAt(e){let t=Bc(e,this.lengthAfter);return VL(t,Yn)?[this,void 0]:this.modified?[new o(this.modified,this.lengthBefore,e),new o(this.modified,Yn,t)]:[new o(this.modified,e,e),new o(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${Zi(this.lengthBefore)} -> ${Zi(this.lengthAfter)}`}};function mO(o){let e=[],t=Yn;for(let n of o){let i=Bc(t,n.startOffset);Ah(i)||e.push(new Sf(!1,i,i));let r=Bc(n.startOffset,n.endOffset);e.push(new Sf(!0,r,n.newLength)),t=n.endOffset}return e}var _I=class extends B{constructor(t,n){super();this.textModel=t;this.getLanguageConfiguration=n;if(t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),r=new lI(this.textModel.getValue(),i);this.initialAstWithoutTokens=rD(r,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new T;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new Xy;brackets=new sI(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(t){return this.brackets.didLanguageChange(t)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){let n=t.map(i=>new Hc(Ut(i.fromLineNumber-1,0),Ut(i.toLineNumber,0),Ut(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(n,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){let n=Hc.fromModelContentChanges(t.changes);this.handleEdits(n,!1)}handleEdits(t,n){let i=sD(this.queuedTextEdits,t);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!n&&(this.queuedTextEditsForInitialAstWithoutTokens=sD(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,n,i){let s=n,a=new aI(this.textModel,this.brackets);return rD(a,t,s,i)}getBracketsInRange(t,n){this.flushQueue();let i=Ut(t.startLineNumber-1,t.startColumn-1),r=Ut(t.endLineNumber-1,t.endColumn-1);return new $a(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;aD(a,Yn,a.length,i,r,s,0,0,new Map,n)})}getBracketPairsInRange(t,n){this.flushQueue();let i=xd(t.getStartPosition()),r=xd(t.getEndPosition());return new $a(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new lD(s,n,this.textModel);dD(a,Yn,a.length,i,r,l,0,new Map)})}getFirstBracketAfter(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return bO(n,Yn,n.length,xd(t))}getFirstBracketBefore(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return fO(n,Yn,n.length,xd(t))}};function fO(o,e,t,n){if(o.kind===4||o.kind===2){let i=[];for(let r of o.children)t=Ot(e,r.length),i.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=i.length-1;r>=0;r--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=i[r];if(al(s,n)){let l=fO(o.children[r],s,a,n);if(l)return l}}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=Ed(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function bO(o,e,t,n){if(o.kind===4||o.kind===2){for(let i of o.children){if(t=Ot(e,i.length),al(n,t)){let r=bO(i,e,t,n);if(r)return r}e=t}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=Ed(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function aD(o,e,t,n,i,r,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(o.kind){case 4:{let u=o.childrenLength;for(let h=0;h<u;h++){let m=o.getChild(h);if(m){if(t=Ot(e,m.length),Sd(e,i)&&Oh(t,n)){if(Oh(t,i)){o=m;continue e}if(!aD(m,e,t,n,i,r,s,0,l,d))return!1}e=t}}return!0}case 2:{let u=!d||!o.closingBracket||o.closingBracket.bracketInfo.closesColorized(o.openingBracket.bracketInfo),h=0;if(l){let g=l.get(o.openingBracket.text);g===void 0&&(g=0),h=g,u&&(g++,l.set(o.openingBracket.text,g))}let m=o.childrenLength;for(let g=0;g<m;g++){let f=o.getChild(g);if(f){if(t=Ot(e,f.length),Sd(e,i)&&Oh(t,n)){if(Oh(t,i)&&f.kind!==1){o=f,u?(s++,a=h+1):a=h;continue e}if((u||f.kind!==1||!o.closingBracket)&&!aD(f,e,t,n,i,r,u?s+1:s,u?h+1:h,l,d,!o.closingBracket))return!1}e=t}}return l?.set(o.openingBracket.text,h),!0}case 3:{let u=Ed(e,t);return r(new bf(u,s-1,0,!0))}case 1:{let u=Ed(e,t);return r(new bf(u,s-1,a-1,c))}case 0:return!0}}var lD=class{constructor(e,t,n){this.push=e;this.includeMinIndentation=t;this.textModel=n}};function dD(o,e,t,n,i,r,s,a){if(s>200)return!0;let l=!0;if(o.kind===2){let d=0;if(a){let h=a.get(o.openingBracket.text);h===void 0&&(h=0),d=h,h++,a.set(o.openingBracket.text,h)}let c=Ot(e,o.openingBracket.length),u=-1;if(r.includeMinIndentation&&(u=o.computeMinIndentation(e,r.textModel)),l=r.push(new uI(Ed(e,t),Ed(e,c),o.closingBracket?Ed(Ot(c,o.child?.length||Yn),t):void 0,s,d,o,u)),e=c,l&&o.child){let h=o.child;if(t=Ot(e,h.length),Sd(e,i)&&Oh(t,n)&&(l=dD(h,e,t,n,i,r,s+1,a),!l))return!1}a?.set(o.openingBracket.text,d)}else{let d=e;for(let c of o.children){let u=d;if(d=Ot(d,c.length),Sd(u,i)&&Sd(n,d)&&(l=dD(c,u,d,n,i,r,s,a),!l))return!1}}return l}var LI=class extends B{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}bracketPairsTree=this._register(new rn);onDidChangeEmitter=new T;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(t){(!t.languageId||this.bracketPairsTree.value?.object.didLanguageChange(t.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){this.bracketPairsTree.value?.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){this.bracketPairsTree.value?.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let t=new oe;this.bracketPairsTree.value=tU(t.add(new _I(this.textModel,n=>this.languageConfigurationService.getLanguageConfiguration(n))),t),t.add(this.bracketPairsTree.value.object.onDidChange(n=>this.onDidChangeEmitter.fire(n))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!1)||$a.empty}getBracketPairsInRangeWithMinIndentation(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!0)||$a.empty}getBracketsInRange(t,n=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(t,n)||$a.empty}findMatchingBracketUp(t,n,i){let r=this.textModel.validatePosition(n),s=this.textModel.getLanguageIdAtPosition(r.lineNumber,r.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(t);if(!a)return null;let l=this.getBracketPairsInRange(L.fromPositions(n,n)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=t.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?TI(this._findMatchingBracketUp(d,r,cD(i))):null}}matchBracket(t,n){if(this.canBuildAST){let i=this.getBracketPairsInRange(L.fromPositions(t,t)).filter(r=>r.closingBracketRange!==void 0&&(r.openingBracketRange.containsPosition(t)||r.closingBracketRange.containsPosition(t))).findLastMaxBy(ui(r=>r.openingBracketRange.containsPosition(t)?r.openingBracketRange:r.closingBracketRange,L.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{let i=cD(n);return this._matchBracket(this.textModel.validatePosition(t),i)}}_establishBracketSearchOffsets(t,n,i,r){let s=n.getCount(),a=n.getLanguageId(r),l=Math.max(0,t.column-1-i.maxBracketLength);for(let c=r-1;c>=0;c--){let u=n.getEndOffset(c);if(u<=l)break;if(Yr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){l=u;break}}let d=Math.min(n.getLineContent().length,t.column-1+i.maxBracketLength);for(let c=r+1;c<s;c++){let u=n.getStartOffset(c);if(u>=d)break;if(Yr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){d=u;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(t,n){let i=t.lineNumber,r=this.textModel.tokenization.getLineTokens(i),s=this.textModel.getLineContent(i),a=r.findTokenIndexAtOffset(t.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(a)).brackets;if(l&&!Yr(r.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(t,r,l,a),u=null;for(;;){let h=po.findNextBracketInRange(l.forwardRegex,i,s,d,c);if(!h)break;if(h.startColumn<=t.column&&t.column<=h.endColumn){let m=s.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),g=this._matchFoundBracket(h,l.textIsBracket[m],l.textIsOpenBracket[m],n);if(g){if(g instanceof cl)return null;u=g}}d=h.endColumn-1}if(u)return u}if(a>0&&r.getStartOffset(a)===t.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(d)).brackets;if(c&&!Yr(r.getStandardTokenType(d))){let{searchStartOffset:u,searchEndOffset:h}=this._establishBracketSearchOffsets(t,r,c,d),m=po.findPrevBracketInRange(c.reversedRegex,i,s,u,h);if(m&&m.startColumn<=t.column&&t.column<=m.endColumn){let g=s.substring(m.startColumn-1,m.endColumn-1).toLowerCase(),f=this._matchFoundBracket(m,c.textIsBracket[g],c.textIsOpenBracket[g],n);if(f)return f instanceof cl?null:f}}}return null}_matchFoundBracket(t,n,i,r){if(!n)return null;let s=i?this._findMatchingBracketDown(n,t.getEndPosition(),r):this._findMatchingBracketUp(n,t.getStartPosition(),r);return s?s instanceof cl?s:[t,s]:null}_findMatchingBracketUp(t,n,i){let r=t.languageId,s=t.reversedRegex,a=-1,l=0,d=(c,u,h,m)=>{for(;;){if(i&&++l%100===0&&!i())return cl.INSTANCE;let g=po.findPrevBracketInRange(s,c,u,h,m);if(!g)break;let f=u.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(t.isOpen(f)?a++:t.isClose(f)&&a--,a===0)return g;m=g.startColumn-1}return null};for(let c=n.lineNumber;c>=1;c--){let u=this.textModel.tokenization.getLineTokens(c),h=u.getCount(),m=this.textModel.getLineContent(c),g=h-1,f=m.length,b=m.length;c===n.lineNumber&&(g=u.findTokenIndexAtOffset(n.column-1),f=n.column-1,b=n.column-1);let y=!0;for(;g>=0;g--){let C=u.getLanguageId(g)===r&&!Yr(u.getStandardTokenType(g));if(C)y?f=u.getStartOffset(g):(f=u.getStartOffset(g),b=u.getEndOffset(g));else if(y&&f!==b){let S=d(c,m,f,b);if(S)return S}y=C}if(y&&f!==b){let C=d(c,m,f,b);if(C)return C}}return null}_findMatchingBracketDown(t,n,i){let r=t.languageId,s=t.forwardRegex,a=1,l=0,d=(u,h,m,g)=>{for(;;){if(i&&++l%100===0&&!i())return cl.INSTANCE;let f=po.findNextBracketInRange(s,u,h,m,g);if(!f)break;let b=h.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(t.isOpen(b)?a++:t.isClose(b)&&a--,a===0)return f;m=f.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=n.lineNumber;u<=c;u++){let h=this.textModel.tokenization.getLineTokens(u),m=h.getCount(),g=this.textModel.getLineContent(u),f=0,b=0,y=0;u===n.lineNumber&&(f=h.findTokenIndexAtOffset(n.column-1),b=n.column-1,y=n.column-1);let C=!0;for(;f<m;f++){let S=h.getLanguageId(f)===r&&!Yr(h.getStandardTokenType(f));if(S)C||(b=h.getStartOffset(f)),y=h.getEndOffset(f);else if(C&&b!==y){let w=d(u,g,b,y);if(w)return w}C=S}if(C&&b!==y){let S=d(u,g,b,y);if(S)return S}}return null}findPrevBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(n)||null;let i=null,r=null,s=null;for(let a=n.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),u=d-1,h=c.length,m=c.length;if(a===n.lineNumber){u=l.findTokenIndexAtOffset(n.column-1),h=n.column-1,m=n.column-1;let f=l.getLanguageId(u);i!==f&&(i=f,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let g=!0;for(;u>=0;u--){let f=l.getLanguageId(u);if(i!==f){if(r&&s&&g&&h!==m){let y=po.findPrevBracketInRange(r.reversedRegex,a,c,h,m);if(y)return this._toFoundBracket(s,y);g=!1}i=f,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}let b=!!r&&!Yr(l.getStandardTokenType(u));if(b)g?h=l.getStartOffset(u):(h=l.getStartOffset(u),m=l.getEndOffset(u));else if(s&&r&&g&&h!==m){let y=po.findPrevBracketInRange(r.reversedRegex,a,c,h,m);if(y)return this._toFoundBracket(s,y)}g=b}if(s&&r&&g&&h!==m){let f=po.findPrevBracketInRange(r.reversedRegex,a,c,h,m);if(f)return this._toFoundBracket(s,f)}}return null}findNextBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(n)||null;let i=this.textModel.getLineCount(),r=null,s=null,a=null;for(let l=n.lineNumber;l<=i;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),u=this.textModel.getLineContent(l),h=0,m=0,g=0;if(l===n.lineNumber){h=d.findTokenIndexAtOffset(n.column-1),m=n.column-1,g=n.column-1;let b=d.getLanguageId(h);r!==b&&(r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew)}let f=!0;for(;h<c;h++){let b=d.getLanguageId(h);if(r!==b){if(a&&s&&f&&m!==g){let C=po.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(C)return this._toFoundBracket(a,C);f=!1}r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew}let y=!!s&&!Yr(d.getStandardTokenType(h));if(y)f||(m=d.getStartOffset(h)),g=d.getEndOffset(h);else if(a&&s&&f&&m!==g){let C=po.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(C)return this._toFoundBracket(a,C)}f=y}if(a&&s&&f&&m!==g){let b=po.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(b)return this._toFoundBracket(a,b)}}return null}findEnclosingBrackets(t,n){let i=this.textModel.validatePosition(t);if(this.canBuildAST){let g=L.fromPositions(i),f=this.getBracketPairsInRange(L.fromPositions(i,i)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(g));return f?[f.openingBracketRange,f.closingBracketRange]:null}let r=cD(n),s=this.textModel.getLineCount(),a=new Map,l=[],d=(g,f)=>{if(!a.has(g)){let b=[];for(let y=0,C=f?f.brackets.length:0;y<C;y++)b[y]=0;a.set(g,b)}l=a.get(g)},c=0,u=(g,f,b,y,C)=>{for(;;){if(r&&++c%100===0&&!r())return cl.INSTANCE;let S=po.findNextBracketInRange(g.forwardRegex,f,b,y,C);if(!S)break;let w=b.substring(S.startColumn-1,S.endColumn-1).toLowerCase(),R=g.textIsBracket[w];if(R&&(R.isOpen(w)?l[R.index]++:R.isClose(w)&&l[R.index]--,l[R.index]===-1))return this._matchFoundBracket(S,R,!1,r);y=S.endColumn-1}return null},h=null,m=null;for(let g=i.lineNumber;g<=s;g++){let f=this.textModel.tokenization.getLineTokens(g),b=f.getCount(),y=this.textModel.getLineContent(g),C=0,S=0,w=0;if(g===i.lineNumber){C=f.findTokenIndexAtOffset(i.column-1),S=i.column-1,w=i.column-1;let M=f.getLanguageId(C);h!==M&&(h=M,m=this.languageConfigurationService.getLanguageConfiguration(h).brackets,d(h,m))}let R=!0;for(;C<b;C++){let M=f.getLanguageId(C);if(h!==M){if(m&&R&&S!==w){let A=u(m,g,y,S,w);if(A)return TI(A);R=!1}h=M,m=this.languageConfigurationService.getLanguageConfiguration(h).brackets,d(h,m)}let N=!!m&&!Yr(f.getStandardTokenType(C));if(N)R||(S=f.getStartOffset(C)),w=f.getEndOffset(C);else if(m&&R&&S!==w){let A=u(m,g,y,S,w);if(A)return TI(A)}R=N}if(m&&R&&S!==w){let M=u(m,g,y,S,w);if(M)return TI(M)}}return null}_toFoundBracket(t,n){if(!n)return null;let i=this.textModel.getValueInRange(n);i=i.toLowerCase();let r=t.getBracketInfo(i);return r?{range:n,bracketInfo:r}:null}};function tU(o,e){return{object:o,dispose:()=>e?.dispose()}}function cD(o){if(typeof o>"u")return()=>!0;{let e=Date.now();return()=>Date.now()-e<=o}}var cl=class o{static INSTANCE=new o;_searchCanceledBrand=void 0;constructor(){}};function TI(o){return o instanceof cl?null:o}var nU={IconContribution:"base.contributions.icons"},iU;(e=>{function o(t,n){let i=t.defaults;for(;Xe.isThemeIcon(i);){let r=zh.getIcon(i.id);if(!r)return;i=r.defaults}return i}e.getDefinition=o})(iU||={});var oU;(t=>{function o(n){return{weight:n.weight,style:n.style,src:n.src.map(i=>({format:i.format,location:i.location.toString()}))}}t.toJSONObject=o;function e(n){let i=r=>sn(r)?r:void 0;if(n&&Array.isArray(n.src)&&n.src.every(r=>sn(r.format)&&sn(r.location)))return{weight:i(n.weight),style:i(n.style),src:n.src.map(r=>({format:r.format,location:ne.parse(r.location)}))}}t.fromJSONObject=e})(oU||={});var uD=class{_onDidChange=new T;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:p("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:p("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${Xe.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,i){let r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;let l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=n),this._onDidChange.fire()}return r}let s={id:e,description:n,defaults:t,deprecationMessage:i};this.iconsById[e]=s;let a={$ref:"#/definitions/icons"};return i&&(a.deprecationMessage=i),n&&(a.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(r,s)=>r.id.localeCompare(s.id),t=r=>{for(;Xe.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let i=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(let r of i.filter(s=>!!s.description).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|${Xe.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(let r of i.filter(s=>!Xe.isThemeIcon(s.defaults)).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|`);return n.join(`
`)}},zh=new uD;Je.add(nU.IconContribution,zh);function Ld(o,e,t,n){return zh.registerIcon(o,e,t,n)}function rU(){let o=G_();for(let e in o){let t="\\"+o[e].toString(16);zh.registerIcon(e,{fontCharacter:t})}}rU();var yO="vscode://schemas/icons",IO=Je.as(Lc.JSONContribution);IO.registerSchema(yO,zh.getIconSchema());var vO=new Yt(()=>IO.notifySchemaChanged(yO),200);zh.onDidChange(()=>{vO.isScheduled()||vO.schedule()});var Yce=Ld("widget-close",ue.close,p("widgetClose","Icon for the close action in widgets.")),Zce=Ld("goto-previous-location",ue.arrowUp,p("previousChangeIcon","Icon for goto previous editor location.")),Xce=Ld("goto-next-location",ue.arrowDown,p("nextChangeIcon","Icon for goto next editor location.")),Qce=Xe.modify(ue.sync,"spin"),Jce=Xe.modify(ue.loading,"spin");function Dd(o){return o==="hcDark"||o==="hcLight"}function hD(o){return o==="dark"||o==="hcDark"}var xs=Z("themeService");function CO(o){return{id:o}}var vue=ue.file,yue=ue.folder;function xf(o){switch(o){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var aU={ThemingContribution:"base.contributions.theming"},pD=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new T}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),pe(()=>{let t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},SO=new pD;Je.add(aU.ThemingContribution,SO);function mo(o){return SO.onColorThemeChange(o)}var DI=class extends B{constructor(t){super();this.themeService=t;this.theme=t.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(n=>this.onThemeChange(n)))}theme;onThemeChange(t){this.theme=t,this.updateStyles()}updateStyles(){}getColor(t,n){let i=this.theme.getColor(t);return i&&n&&(i=n(i,this.theme)),i?i.toString():null}};function EO(o){return`--vscode-${o.replace(/\./g,"-")}`}function se(o){return`var(${EO(o)})`}function wO(o,e){return`var(${EO(o)}, ${e})`}function lU(o){return o!==null&&typeof o=="object"&&"light"in o&&"dark"in o}var dU={ColorContribution:"base.contributions.colors"},cU="default",mD=class{_onDidChangeSchema=new T;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(e){for(let t of Object.keys(this.colorsById)){let n=e.getColor(t);n&&(this.colorSchema.properties[t].oneOf[0].defaultSnippets[0].body=`\${1:${n.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(e,t,n,i=!1,r){let s={id:e,description:n,defaults:t,needsTransparency:i,deprecationMessage:r};this.colorsById[e]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),i&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=p("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:n,oneOf:[a,{type:"string",const:cU,description:p("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(n),this._onDidChangeSchema.fire(),e}deregisterColor(e){delete this.colorsById[e],delete this.colorSchema.properties[e];let t=this.colorReferenceSchema.enum.indexOf(e);t!==-1&&(this.colorReferenceSchema.enum.splice(t,1),this.colorReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let n=this.colorsById[e];if(n?.defaults){let i=lU(n.defaults)?n.defaults[t.type]:n.defaults;return Es(i,t)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let e=(t,n)=>{let i=t.indexOf(".")===-1?0:1,r=n.indexOf(".")===-1?0:1;return i!==r?i-r:t.localeCompare(n)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}},RI=new mD;Je.add(dU.ColorContribution,RI);function I(o,e,t,n,i){return RI.registerColor(o,e,t,n,i)}function uU(o,e){switch(o.op){case 0:return Es(o.value,e)?.darken(o.factor);case 1:return Es(o.value,e)?.lighten(o.factor);case 2:return Es(o.value,e)?.transparent(o.factor);case 3:{let t=Es(o.background,e);return t?Es(o.value,e)?.makeOpaque(t):Es(o.value,e)}case 4:for(let t of o.values){let n=Es(t,e);if(n)return n}return;case 6:return Es(e.defines(o.if)?o.then:o.else,e);case 5:{let t=Es(o.value,e);if(!t)return;let n=Es(o.background,e);return n?t.isDarkerThan(n)?W.getLighterColor(t,n,o.factor).transparent(o.transparency):W.getDarkerColor(t,n,o.factor).transparent(o.transparency):t.transparent(o.factor*o.transparency)}default:throw hg(o)}}function Qi(o,e){return{op:0,value:o,factor:e}}function go(o,e){return{op:1,value:o,factor:e}}function de(o,e){return{op:2,value:o,factor:e}}function gD(...o){return{op:4,values:o}}function _O(o,e,t){return{op:6,if:o,then:e,else:t}}function fD(o,e,t,n){return{op:5,value:o,background:e,factor:t,transparency:n}}function Es(o,e){if(o!==null){if(typeof o=="string")return o[0]==="#"?W.fromHex(o):e.getColor(o);if(o instanceof W)return o;if(typeof o=="object")return uU(o,e)}}var TO="vscode://schemas/workbench-colors",LO=Je.as(Lc.JSONContribution);LO.registerSchema(TO,RI.getColorSchema());var xO=new Yt(()=>LO.notifySchemaChanged(TO),200);RI.onDidChangeSchema(()=>{xO.isScheduled()||xO.schedule()});var dt=I("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},p("foreground","Overall foreground color. This color is only used if not overridden by a component.")),Pue=I("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},p("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),bD=I("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},p("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),Fue=I("descriptionForeground",{light:"#717171",dark:de(dt,.7),hcDark:de(dt,.7),hcLight:de(dt,.7)},p("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),Uc=I("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},p("iconForeground","The default color for icons in the workbench.")),vi=I("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},p("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),ve=I("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},p("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),wt=I("contrastActiveBorder",{light:null,dark:null,hcDark:vi,hcLight:vi},p("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),Bue=I("selection.background",null,p("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),kI=I("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},p("textLinkForeground","Foreground color for links in text.")),Vue=I("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},p("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),Wue=I("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:W.black,hcLight:"#292929"},p("textSeparatorForeground","Color for text separators.")),Hue=I("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},p("textPreformatForeground","Foreground color for preformatted text segments.")),Uue=I("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},p("textPreformatBackground","Background color for preformatted text segments.")),zue=I("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},p("textBlockQuoteBackground","Background color for block quotes in text.")),Kue=I("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:W.white,hcLight:"#292929"},p("textBlockQuoteBorder","Border color for block quotes in text.")),Gue=I("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:W.black,hcLight:"#F2F2F2"},p("textCodeBlockBackground","Background color for code blocks in text."));var Zue=I("sash.hoverBorder",vi,p("sashActiveBorder","Border color of active sashes.")),Kh=I("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:W.black,hcLight:"#0F4A85"},p("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),DO=I("badge.foreground",{dark:W.white,light:"#333",hcDark:W.white,hcLight:W.white},p("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),Rd=I("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},p("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),MI=I("scrollbarSlider.background",{dark:W.fromHex("#797979").transparent(.4),light:W.fromHex("#646464").transparent(.4),hcDark:de(ve,.6),hcLight:de(ve,.4)},p("scrollbarSliderBackground","Scrollbar slider background color.")),NI=I("scrollbarSlider.hoverBackground",{dark:W.fromHex("#646464").transparent(.7),light:W.fromHex("#646464").transparent(.7),hcDark:de(ve,.8),hcLight:de(ve,.8)},p("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),AI=I("scrollbarSlider.activeBackground",{dark:W.fromHex("#BFBFBF").transparent(.4),light:W.fromHex("#000000").transparent(.6),hcDark:ve,hcLight:ve},p("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),RO=I("progressBar.background",{dark:W.fromHex("#0E70C0"),light:W.fromHex("#0E70C0"),hcDark:ve,hcLight:ve},p("progressBarBackground","Background color of the progress bar that can show for long running operations."));var Xr=I("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:W.black,hcLight:W.white},p("editorBackground","Editor background color.")),ga=I("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:W.white,hcLight:dt},p("editorForeground","Editor default foreground color.")),nhe=I("editorStickyScroll.background",Xr,p("editorStickyScrollBackground","Background color of sticky scroll in the editor")),ihe=I("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:W.fromHex("#0F4A85").transparent(.1)},p("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),ohe=I("editorStickyScroll.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("editorStickyScrollBorder","Border color of sticky scroll in the editor")),rhe=I("editorStickyScroll.shadow",Rd,p("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),yi=I("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:W.white},p("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),fa=I("editorWidget.foreground",dt,p("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),Tf=I("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:ve,hcLight:ve},p("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),she=I("editorWidget.resizeBorder",null,p("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),ahe=I("editorError.background",null,p("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),zc=I("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},p("editorError.foreground","Foreground color of error squigglies in the editor.")),lhe=I("editorError.border",{dark:null,light:null,hcDark:W.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},p("errorBorder","If set, color of double underlines for errors in the editor.")),FO=I("editorWarning.background",null,p("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),fo=I("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},p("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),$h=I("editorWarning.border",{dark:null,light:null,hcDark:W.fromHex("#FFCC00").transparent(.8),hcLight:W.fromHex("#FFCC00").transparent(.8)},p("warningBorder","If set, color of double underlines for warnings in the editor.")),dhe=I("editorInfo.background",null,p("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),sr=I("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},p("editorInfo.foreground","Foreground color of info squigglies in the editor.")),qh=I("editorInfo.border",{dark:null,light:null,hcDark:W.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},p("infoBorder","If set, color of double underlines for infos in the editor.")),BO=I("editorHint.foreground",{dark:W.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},p("editorHint.foreground","Foreground color of hint squigglies in the editor.")),che=I("editorHint.border",{dark:null,light:null,hcDark:W.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},p("hintBorder","If set, color of double underlines for hints in the editor.")),uhe=I("editorLink.activeForeground",{dark:"#4E94CE",light:W.blue,hcDark:W.cyan,hcLight:"#292929"},p("activeLinkForeground","Color of active links.")),ul=I("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},p("editorSelectionBackground","Color of the editor selection.")),VO=I("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:W.white},p("editorSelectionForeground","Color of the selected text for high contrast.")),hhe=I("editor.inactiveSelectionBackground",{light:de(ul,.5),dark:de(ul,.5),hcDark:de(ul,.7),hcLight:de(ul,.5)},p("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),phe=I("editor.selectionHighlightBackground",{light:fD(ul,Xr,.3,.6),dark:fD(ul,Xr,.3,.6),hcDark:null,hcLight:null},p("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),mhe=I("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:wt,hcLight:wt},p("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),ghe=I("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},p("editorFindMatch","Color of the current search match.")),fhe=I("editor.findMatchForeground",null,p("editorFindMatchForeground","Text color of the current search match.")),ws=I("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},p("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),bhe=I("editor.findMatchHighlightForeground",null,p("findMatchHighlightForeground","Foreground color of the other search matches."),!0),vhe=I("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},p("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),yhe=I("editor.findMatchBorder",{light:null,dark:null,hcDark:wt,hcLight:wt},p("editorFindMatchBorder","Border color of the current search match.")),kd=I("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:wt,hcLight:wt},p("findMatchHighlightBorder","Border color of the other search matches.")),Ihe=I("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:de(wt,.4),hcLight:de(wt,.4)},p("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Che=I("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},p("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),kO=I("editorHoverWidget.background",yi,p("hoverBackground","Background color of the editor hover.")),She=I("editorHoverWidget.foreground",fa,p("hoverForeground","Foreground color of the editor hover.")),xhe=I("editorHoverWidget.border",Tf,p("hoverBorder","Border color of the editor hover.")),Ehe=I("editorHoverWidget.statusBarBackground",{dark:go(kO,.2),light:Qi(kO,.05),hcDark:yi,hcLight:yi},p("statusBarBackground","Background color of the editor hover status bar.")),WO=I("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:W.white,hcLight:W.black},p("editorInlayHintForeground","Foreground color of inline hints")),HO=I("editorInlayHint.background",{dark:de(Kh,.1),light:de(Kh,.1),hcDark:de(W.white,.1),hcLight:de(Kh,.1)},p("editorInlayHintBackground","Background color of inline hints")),whe=I("editorInlayHint.typeForeground",WO,p("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),_he=I("editorInlayHint.typeBackground",HO,p("editorInlayHintBackgroundTypes","Background color of inline hints for types")),The=I("editorInlayHint.parameterForeground",WO,p("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),Lhe=I("editorInlayHint.parameterBackground",HO,p("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),hU=I("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},p("editorLightBulbForeground","The color used for the lightbulb actions icon.")),Dhe=I("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),Rhe=I("editorLightBulbAi.foreground",hU,p("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),khe=I("editor.snippetTabstopHighlightBackground",{dark:new W(new ze(124,124,124,.3)),light:new W(new ze(10,50,100,.2)),hcDark:new W(new ze(124,124,124,.3)),hcLight:new W(new ze(10,50,100,.2))},p("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),Mhe=I("editor.snippetTabstopHighlightBorder",null,p("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),Nhe=I("editor.snippetFinalTabstopHighlightBackground",null,p("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),Ahe=I("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new W(new ze(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},p("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),MO=new W(new ze(155,185,85,.2)),NO=new W(new ze(255,0,0,.2)),Ohe=I("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},p("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Phe=I("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},p("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Fhe=I("diffEditor.insertedLineBackground",{dark:MO,light:MO,hcDark:null,hcLight:null},p("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Bhe=I("diffEditor.removedLineBackground",{dark:NO,light:NO,hcDark:null,hcLight:null},p("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Vhe=I("diffEditorGutter.insertedLineBackground",null,p("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),Whe=I("diffEditorGutter.removedLineBackground",null,p("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),Hhe=I("diffEditorOverview.insertedForeground",null,p("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),Uhe=I("diffEditorOverview.removedForeground",null,p("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),zhe=I("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},p("diffEditorInsertedOutline","Outline color for the text that got inserted.")),Khe=I("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},p("diffEditorRemovedOutline","Outline color for text that got removed.")),Ghe=I("diffEditor.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("diffEditorBorder","Border color between the two text editors.")),jhe=I("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},p("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),$he=I("diffEditor.unchangedRegionBackground","sideBar.background",p("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),qhe=I("diffEditor.unchangedRegionForeground","foreground",p("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),Yhe=I("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},p("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),Yh=I("widget.shadow",{dark:de(W.black,.36),light:de(W.black,.16),hcDark:null,hcLight:null},p("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Lf=I("widget.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("widgetBorder","Border color of widgets such as find/replace inside the editor.")),Ef=I("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},p("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),Zhe=I("toolbar.hoverOutline",{dark:null,light:null,hcDark:wt,hcLight:wt},p("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),Xhe=I("toolbar.activeBackground",{dark:go(Ef,.1),light:Qi(Ef,.1),hcDark:null,hcLight:null},p("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),UO=I("breadcrumb.foreground",de(dt,.8),p("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),zO=I("breadcrumb.background",Xr,p("breadcrumbsBackground","Background color of breadcrumb items.")),yD=I("breadcrumb.focusForeground",{light:Qi(dt,.2),dark:go(dt,.1),hcDark:go(dt,.1),hcLight:go(dt,.1)},p("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),KO=I("breadcrumb.activeSelectionForeground",{light:Qi(dt,.2),dark:go(dt,.1),hcDark:go(dt,.1),hcLight:go(dt,.1)},p("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),Qhe=I("breadcrumbPicker.background",yi,p("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),GO=.5,AO=W.fromHex("#40C8AE").transparent(GO),OO=W.fromHex("#40A6FF").transparent(GO),PO=W.fromHex("#606060").transparent(.4),ID=.4,Gh=1,wf=I("merge.currentHeaderBackground",{dark:AO,light:AO,hcDark:null,hcLight:null},p("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),Jhe=I("merge.currentContentBackground",de(wf,ID),p("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),_f=I("merge.incomingHeaderBackground",{dark:OO,light:OO,hcDark:null,hcLight:null},p("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),epe=I("merge.incomingContentBackground",de(_f,ID),p("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),vD=I("merge.commonHeaderBackground",{dark:PO,light:PO,hcDark:null,hcLight:null},p("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),tpe=I("merge.commonContentBackground",de(vD,ID),p("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),jh=I("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},p("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),npe=I("editorOverviewRuler.currentContentForeground",{dark:de(wf,Gh),light:de(wf,Gh),hcDark:jh,hcLight:jh},p("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),ipe=I("editorOverviewRuler.incomingContentForeground",{dark:de(_f,Gh),light:de(_f,Gh),hcDark:jh,hcLight:jh},p("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),ope=I("editorOverviewRuler.commonContentForeground",{dark:de(vD,Gh),light:de(vD,Gh),hcDark:jh,hcLight:jh},p("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),rpe=I("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},p("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),spe=I("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",p("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),jO=I("problemsErrorIcon.foreground",zc,p("problemsErrorIconForeground","The color used for the problems error icon.")),$O=I("problemsWarningIcon.foreground",fo,p("problemsWarningIconForeground","The color used for the problems warning icon.")),qO=I("problemsInfoIcon.foreground",sr,p("problemsInfoIconForeground","The color used for the problems info icon."));var YO=I("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},p("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),hpe=I("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},p("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),CD=I("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},p("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),ppe=I("minimap.infoHighlight",{dark:sr,light:sr,hcDark:qh,hcLight:qh},p("minimapInfo","Minimap marker color for infos.")),mpe=I("minimap.warningHighlight",{dark:fo,light:fo,hcDark:$h,hcLight:$h},p("overviewRuleWarning","Minimap marker color for warnings.")),gpe=I("minimap.errorHighlight",{dark:new W(new ze(255,18,18,.7)),light:new W(new ze(255,18,18,.7)),hcDark:new W(new ze(255,50,50,1)),hcLight:"#B5200D"},p("minimapError","Minimap marker color for errors.")),ZO=I("minimap.background",null,p("minimapBackground","Minimap background color.")),XO=I("minimap.foregroundOpacity",W.fromHex("#000f"),p("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),fpe=I("minimapSlider.background",de(MI,.5),p("minimapSliderBackground","Minimap slider background color.")),bpe=I("minimapSlider.hoverBackground",de(NI,.5),p("minimapSliderHoverBackground","Minimap slider background color when hovering.")),vpe=I("minimapSlider.activeBackground",de(AI,.5),p("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var Epe=I("charts.foreground",dt,p("chartsForeground","The foreground color used in charts.")),wpe=I("charts.lines",de(dt,.5),p("chartsLines","The color used for horizontal lines in charts.")),_pe=I("charts.red",zc,p("chartsRed","The red color used in chart visualizations.")),Tpe=I("charts.blue",sr,p("chartsBlue","The blue color used in chart visualizations.")),Lpe=I("charts.yellow",fo,p("chartsYellow","The yellow color used in chart visualizations.")),Dpe=I("charts.orange",YO,p("chartsOrange","The orange color used in chart visualizations.")),Rpe=I("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},p("chartsGreen","The green color used in chart visualizations.")),kpe=I("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("chartsPurple","The purple color used in chart visualizations."));var Df=I("input.background",{dark:"#3C3C3C",light:W.white,hcDark:W.black,hcLight:W.white},p("inputBoxBackground","Input box background.")),Rf=I("input.foreground",dt,p("inputBoxForeground","Input box foreground.")),hl=I("input.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("inputBoxBorder","Input box border.")),SD=I("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:ve,hcLight:ve},p("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),pU=I("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},p("inputOption.hoverBackground","Background color of activated options in input fields.")),xD=I("inputOption.activeBackground",{dark:de(vi,.4),light:de(vi,.2),hcDark:W.transparent,hcLight:W.transparent},p("inputOption.activeBackground","Background hover color of options in input fields.")),ED=I("inputOption.activeForeground",{dark:W.white,light:W.black,hcDark:dt,hcLight:dt},p("inputOption.activeForeground","Foreground color of activated options in input fields.")),Fpe=I("input.placeholderForeground",{light:de(dt,.5),dark:de(dt,.5),hcDark:de(dt,.7),hcLight:de(dt,.7)},p("inputPlaceholderForeground","Input box foreground color for placeholder text.")),QO=I("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:W.black,hcLight:W.white},p("inputValidationInfoBackground","Input validation background color for information severity.")),JO=I("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:dt},p("inputValidationInfoForeground","Input validation foreground color for information severity.")),eP=I("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:ve,hcLight:ve},p("inputValidationInfoBorder","Input validation border color for information severity.")),tP=I("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:W.black,hcLight:W.white},p("inputValidationWarningBackground","Input validation background color for warning severity.")),nP=I("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:dt},p("inputValidationWarningForeground","Input validation foreground color for warning severity.")),iP=I("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:ve,hcLight:ve},p("inputValidationWarningBorder","Input validation border color for warning severity.")),oP=I("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:W.black,hcLight:W.white},p("inputValidationErrorBackground","Input validation background color for error severity.")),rP=I("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:dt},p("inputValidationErrorForeground","Input validation foreground color for error severity.")),sP=I("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:ve,hcLight:ve},p("inputValidationErrorBorder","Input validation border color for error severity.")),Md=I("dropdown.background",{dark:"#3C3C3C",light:W.white,hcDark:W.black,hcLight:W.white},p("dropdownBackground","Dropdown background.")),aP=I("dropdown.listBackground",{dark:null,light:null,hcDark:W.black,hcLight:W.white},p("dropdownListBackground","Dropdown list background.")),Kc=I("dropdown.foreground",{dark:"#F0F0F0",light:dt,hcDark:W.white,hcLight:dt},p("dropdownForeground","Dropdown foreground.")),Gc=I("dropdown.border",{dark:Md,light:"#CECECE",hcDark:ve,hcLight:ve},p("dropdownBorder","Dropdown border.")),wD=I("button.foreground",W.white,p("buttonForeground","Button foreground color.")),lP=I("button.separator",de(wD,.4),p("buttonSeparator","Button separator color.")),Zh=I("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},p("buttonBackground","Button background color.")),dP=I("button.hoverBackground",{dark:go(Zh,.2),light:Qi(Zh,.2),hcDark:Zh,hcLight:Zh},p("buttonHoverBackground","Button background color when hovering.")),cP=I("button.border",ve,p("buttonBorder","Button border color.")),uP=I("button.secondaryForeground",{dark:W.white,light:W.white,hcDark:W.white,hcLight:dt},p("buttonSecondaryForeground","Secondary button foreground color.")),OI=I("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:W.white},p("buttonSecondaryBackground","Secondary button background color.")),hP=I("button.secondaryHoverBackground",{dark:go(OI,.2),light:Qi(OI,.2),hcDark:null,hcLight:null},p("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),Xh=I("radio.activeForeground",ED,p("radioActiveForeground","Foreground color of active radio option.")),pP=I("radio.activeBackground",xD,p("radioBackground","Background color of active radio option.")),mP=I("radio.activeBorder",SD,p("radioActiveBorder","Border color of the active radio option.")),gP=I("radio.inactiveForeground",null,p("radioInactiveForeground","Foreground color of inactive radio option.")),fP=I("radio.inactiveBackground",null,p("radioInactiveBackground","Background color of inactive radio option.")),bP=I("radio.inactiveBorder",{light:de(Xh,.2),dark:de(Xh,.2),hcDark:de(Xh,.4),hcLight:de(Xh,.2)},p("radioInactiveBorder","Border color of the inactive radio option.")),vP=I("radio.inactiveHoverBackground",pU,p("radioHoverBackground","Background color of inactive active radio option when hovering.")),PI=I("checkbox.background",Md,p("checkbox.background","Background color of checkbox widget.")),Bpe=I("checkbox.selectBackground",yi,p("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),FI=I("checkbox.foreground",Kc,p("checkbox.foreground","Foreground color of checkbox widget.")),BI=I("checkbox.border",Gc,p("checkbox.border","Border color of checkbox widget.")),Vpe=I("checkbox.selectBorder",Uc,p("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),yP=I("keybindingLabel.background",{dark:new W(new ze(128,128,128,.17)),light:new W(new ze(221,221,221,.4)),hcDark:W.transparent,hcLight:W.transparent},p("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),IP=I("keybindingLabel.foreground",{dark:W.fromHex("#CCCCCC"),light:W.fromHex("#555555"),hcDark:W.white,hcLight:dt},p("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),CP=I("keybindingLabel.border",{dark:new W(new ze(51,51,51,.6)),light:new W(new ze(204,204,204,.4)),hcDark:new W(new ze(111,195,223)),hcLight:ve},p("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),SP=I("keybindingLabel.bottomBorder",{dark:new W(new ze(68,68,68,.6)),light:new W(new ze(187,187,187,.4)),hcDark:new W(new ze(111,195,223)),hcLight:dt},p("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var xP=I("list.focusBackground",null,p("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),EP=I("list.focusForeground",null,p("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),wP=I("list.focusOutline",{dark:vi,light:vi,hcDark:wt,hcLight:wt},p("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),_P=I("list.focusAndSelectionOutline",null,p("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),Mo=I("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:W.fromHex("#0F4A85").transparent(.1)},p("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),ba=I("list.activeSelectionForeground",{dark:W.white,light:W.white,hcDark:null,hcLight:null},p("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),WI=I("list.activeSelectionIconForeground",null,p("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),TP=I("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:W.fromHex("#0F4A85").transparent(.1)},p("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),LP=I("list.inactiveSelectionForeground",null,p("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),DP=I("list.inactiveSelectionIconForeground",null,p("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),RP=I("list.inactiveFocusBackground",null,p("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),kP=I("list.inactiveFocusOutline",null,p("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Nd=I("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:W.white.transparent(.1),hcLight:W.fromHex("#0F4A85").transparent(.1)},p("listHoverBackground","List/Tree background when hovering over items using the mouse.")),_D=I("list.hoverForeground",null,p("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),MP=I("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},p("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),NP=I("list.dropBetweenBackground",{dark:Uc,light:Uc,hcDark:null,hcLight:null},p("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),VI=I("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:vi,hcLight:vi},p("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),Gpe=I("list.focusHighlightForeground",{dark:VI,light:_O(Mo,VI,"#BBE7FF"),hcDark:VI,hcLight:VI},p("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),jpe=I("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},p("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),$pe=I("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},p("listErrorForeground","Foreground color of list items containing errors.")),qpe=I("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},p("listWarningForeground","Foreground color of list items containing warnings.")),AP=I("listFilterWidget.background",{light:Qi(yi,0),dark:go(yi,0),hcDark:yi,hcLight:yi},p("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),OP=I("listFilterWidget.outline",{dark:W.transparent,light:W.transparent,hcDark:"#f38518",hcLight:"#007ACC"},p("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),PP=I("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:ve,hcLight:ve},p("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),FP=I("listFilterWidget.shadow",Yh,p("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),Ype=I("list.filterMatchBackground",{dark:ws,light:ws,hcDark:null,hcLight:null},p("listFilterMatchHighlight","Background color of the filtered match.")),Zpe=I("list.filterMatchBorder",{dark:kd,light:kd,hcDark:ve,hcLight:wt},p("listFilterMatchHighlightBorder","Border color of the filtered match.")),Xpe=I("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},p("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),Qh=I("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},p("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),BP=I("tree.inactiveIndentGuidesStroke",de(Qh,.4),p("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),VP=I("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},p("tableColumnsBorder","Table border color between columns.")),WP=I("tree.tableOddRowsBackground",{dark:de(dt,.04),light:de(dt,.04),hcDark:null,hcLight:null},p("tableOddRowsBackgroundColor","Background color for odd table rows.")),Qpe=I("editorActionList.background",yi,p("editorActionListBackground","Action List background color.")),Jpe=I("editorActionList.foreground",fa,p("editorActionListForeground","Action List foreground color.")),eme=I("editorActionList.focusForeground",ba,p("editorActionListFocusForeground","Action List foreground color for the focused item.")),tme=I("editorActionList.focusBackground",Mo,p("editorActionListFocusBackground","Action List background color for the focused item."));var HP=I("menu.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("menuBorder","Border color of menus.")),UP=I("menu.foreground",Kc,p("menuForeground","Foreground color of menu items.")),zP=I("menu.background",Md,p("menuBackground","Background color of menu items.")),KP=I("menu.selectionForeground",ba,p("menuSelectionForeground","Foreground color of the selected menu item in menus.")),GP=I("menu.selectionBackground",Mo,p("menuSelectionBackground","Background color of the selected menu item in menus.")),jP=I("menu.selectionBorder",{dark:null,light:null,hcDark:wt,hcLight:wt},p("menuSelectionBorder","Border color of the selected menu item in menus.")),$P=I("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:ve,hcLight:ve},p("menuSeparatorBackground","Color of a separator menu item in menus."));var hme=I("quickInput.background",yi,p("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),pme=I("quickInput.foreground",fa,p("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),mme=I("quickInputTitle.background",{dark:new W(new ze(255,255,255,.105)),light:new W(new ze(0,0,0,.06)),hcDark:"#000000",hcLight:W.white},p("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),YP=I("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:W.white,hcLight:"#0F4A85"},p("pickerGroupForeground","Quick picker color for grouping labels.")),gme=I("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:W.white,hcLight:"#0F4A85"},p("pickerGroupBorder","Quick picker color for grouping borders.")),qP=I("quickInput.list.focusBackground",null,"",void 0,p("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),ZP=I("quickInputList.focusForeground",ba,p("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),XP=I("quickInputList.focusIconForeground",WI,p("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),QP=I("quickInputList.focusBackground",{dark:gD(qP,Mo),light:gD(qP,Mo),hcDark:null,hcLight:null},p("quickInput.listFocusBackground","Quick picker background color for the focused item."));var Ime=I("search.resultsInfoForeground",{light:dt,dark:de(dt,.65),hcDark:dt,hcLight:dt},p("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),Cme=I("searchEditor.findMatchBackground",{light:de(ws,.66),dark:de(ws,.66),hcDark:ws,hcLight:ws},p("searchEditor.queryMatch","Color of the Search Editor query matches.")),Sme=I("searchEditor.findMatchBorder",{light:de(kd,.66),dark:de(kd,.66),hcDark:kd,hcLight:kd},p("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var TD=I("editor.lineHighlightBackground",null,p("lineHighlight","Background color for the highlight of line at the cursor position.")),LD=I("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:ve},p("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),Vme=I("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},p("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),Wme=I("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:wt,hcLight:wt},p("rangeHighlightBorder","Background color of the border around highlighted ranges.")),Hme=I("editor.symbolHighlightBackground",{dark:ws,light:ws,hcDark:null,hcLight:null},p("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),Ume=I("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:wt,hcLight:wt},p("symbolHighlightBorder","Background color of the border around highlighted symbols.")),Jh=I("editorCursor.foreground",{dark:"#AEAFAD",light:W.black,hcDark:W.white,hcLight:"#0F4A85"},p("caret","Color of the editor cursor.")),HI=I("editorCursor.background",null,p("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),UI=I("editorMultiCursor.primary.foreground",Jh,p("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),JP=I("editorMultiCursor.primary.background",HI,p("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),zI=I("editorMultiCursor.secondary.foreground",Jh,p("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),eF=I("editorMultiCursor.secondary.background",HI,p("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),KI=I("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},p("editorWhitespaces","Color of whitespace characters in the editor.")),tF=I("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:W.white,hcLight:"#292929"},p("editorLineNumbers","Color of editor line numbers.")),mU=I("editorIndentGuide.background",KI,p("editorIndentGuides","Color of the editor indentation guides."),!1,p("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),gU=I("editorIndentGuide.activeBackground",KI,p("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,p("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),nF=I("editorIndentGuide.background1",mU,p("editorIndentGuides1","Color of the editor indentation guides (1).")),iF=I("editorIndentGuide.background2","#00000000",p("editorIndentGuides2","Color of the editor indentation guides (2).")),oF=I("editorIndentGuide.background3","#00000000",p("editorIndentGuides3","Color of the editor indentation guides (3).")),rF=I("editorIndentGuide.background4","#00000000",p("editorIndentGuides4","Color of the editor indentation guides (4).")),sF=I("editorIndentGuide.background5","#00000000",p("editorIndentGuides5","Color of the editor indentation guides (5).")),aF=I("editorIndentGuide.background6","#00000000",p("editorIndentGuides6","Color of the editor indentation guides (6).")),lF=I("editorIndentGuide.activeBackground1",gU,p("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),dF=I("editorIndentGuide.activeBackground2","#00000000",p("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),cF=I("editorIndentGuide.activeBackground3","#00000000",p("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),uF=I("editorIndentGuide.activeBackground4","#00000000",p("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),hF=I("editorIndentGuide.activeBackground5","#00000000",p("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),pF=I("editorIndentGuide.activeBackground6","#00000000",p("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),fU=I("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:wt,hcLight:wt},p("editorActiveLineNumber","Color of editor active line number"),!1,p("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),zme=I("editorLineNumber.activeForeground",fU,p("editorActiveLineNumber","Color of editor active line number")),mF=I("editorLineNumber.dimmedForeground",null,p("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),Kme=I("editorRuler.foreground",{dark:"#5A5A5A",light:W.lightgrey,hcDark:W.white,hcLight:"#292929"},p("editorRuler","Color of the editor rulers.")),Gme=I("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},p("editorCodeLensForeground","Foreground color of editor CodeLens")),jme=I("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},p("editorBracketMatchBackground","Background color behind matching brackets")),$me=I("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:ve,hcLight:ve},p("editorBracketMatchBorder","Color for matching brackets boxes")),gF=I("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},p("editorOverviewRulerBorder","Color of the overview ruler border.")),fF=I("editorOverviewRuler.background",null,p("editorOverviewRulerBackground","Background color of the editor overview ruler.")),qme=I("editorGutter.background",Xr,p("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),Yme=I("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:W.fromHex("#fff").transparent(.8),hcLight:ve},p("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),bF=I("editorUnnecessaryCode.opacity",{dark:W.fromHex("#000a"),light:W.fromHex("#0007"),hcDark:null,hcLight:null},p("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),Zme=I("editorGhostText.border",{dark:null,light:null,hcDark:W.fromHex("#fff").transparent(.8),hcLight:W.fromHex("#292929").transparent(.8)},p("editorGhostTextBorder","Border color of ghost text in the editor.")),Xme=I("editorGhostText.foreground",{dark:W.fromHex("#ffffff56"),light:W.fromHex("#0007"),hcDark:null,hcLight:null},p("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),Qme=I("editorGhostText.background",null,p("editorGhostTextBackground","Background color of the ghost text in the editor.")),bU=new W(new ze(0,122,204,.6)),Jme=I("editorOverviewRuler.rangeHighlightForeground",bU,p("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),ege=I("editorOverviewRuler.errorForeground",{dark:new W(new ze(255,18,18,.7)),light:new W(new ze(255,18,18,.7)),hcDark:new W(new ze(255,50,50,1)),hcLight:"#B5200D"},p("overviewRuleError","Overview ruler marker color for errors.")),tge=I("editorOverviewRuler.warningForeground",{dark:fo,light:fo,hcDark:$h,hcLight:$h},p("overviewRuleWarning","Overview ruler marker color for warnings.")),nge=I("editorOverviewRuler.infoForeground",{dark:sr,light:sr,hcDark:qh,hcLight:qh},p("overviewRuleInfo","Overview ruler marker color for infos.")),GI=I("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},p("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),jI=I("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},p("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),$I=I("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},p("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),qI=I("editorBracketHighlight.foreground4","#00000000",p("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),YI=I("editorBracketHighlight.foreground5","#00000000",p("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),ZI=I("editorBracketHighlight.foreground6","#00000000",p("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),vF=I("editorBracketHighlight.unexpectedBracket.foreground",{dark:new W(new ze(255,18,18,.8)),light:new W(new ze(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},p("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),yF=I("editorBracketPairGuide.background1","#00000000",p("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),IF=I("editorBracketPairGuide.background2","#00000000",p("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),CF=I("editorBracketPairGuide.background3","#00000000",p("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),SF=I("editorBracketPairGuide.background4","#00000000",p("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),xF=I("editorBracketPairGuide.background5","#00000000",p("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),EF=I("editorBracketPairGuide.background6","#00000000",p("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),wF=I("editorBracketPairGuide.activeBackground1","#00000000",p("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),_F=I("editorBracketPairGuide.activeBackground2","#00000000",p("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),TF=I("editorBracketPairGuide.activeBackground3","#00000000",p("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),LF=I("editorBracketPairGuide.activeBackground4","#00000000",p("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),DF=I("editorBracketPairGuide.activeBackground5","#00000000",p("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),RF=I("editorBracketPairGuide.activeBackground6","#00000000",p("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),ige=I("editorUnicodeHighlight.border",fo,p("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),oge=I("editorUnicodeHighlight.background",FO,p("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));mo((o,e)=>{let t=o.getColor(Xr),n=o.getColor(TD),i=n&&!n.isTransparent()?n:t;i&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${i}; }`)});var XI=class extends B{constructor(t){super();this.textModel=t;this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange(n=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new QI;onDidChangeEmitter=new T;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,n,i,r){return r?[]:n===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(t,n){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new L(1,1,this.textModel.getLineCount(),1),t,n):[]}},QI=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}};mo((o,e)=>{let t=[GI,jI,$I,qI,YI,ZI],n=new QI;e.addRule(`.monaco-editor .${n.unexpectedClosingBracketClassName} { color: ${o.getColor(vF)}; }`);let i=t.map(r=>o.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){let s=i[r%i.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(r)} { color: ${s}; }`)}});function ep(o){return o.toString()}var No=class o{constructor(e,t,n,i,r,s,a){this.beforeVersionId=e;this.afterVersionId=t;this.beforeEOL=n;this.afterEOL=i;this.beforeCursorState=r;this.afterCursorState=s;this.changes=a}static create(e,t){let n=e.getAlternativeVersionId(),i=kD(e);return new o(n,n,i,i,t,t,[])}append(e,t,n,i,r){t.length>0&&(this.changes=DA(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,n){if(oi(e,t?t.length:0,n),n+=4,t)for(let i of t)oi(e,i.selectionStartLineNumber,n),n+=4,oi(e,i.selectionStartColumn,n),n+=4,oi(e,i.positionLineNumber,n),n+=4,oi(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){let i=ii(e,t);t+=4;for(let r=0;r<i;r++){let s=ii(e,t);t+=4;let a=ii(e,t);t+=4;let l=ii(e,t);t+=4;let d=ii(e,t);t+=4,n.push(new Ue(s,a,l,d))}return t}serialize(){let e=10+o._writeSelectionsSize(this.beforeCursorState)+o._writeSelectionsSize(this.afterCursorState)+4;for(let i of this.changes)e+=i.writeSize();let t=new Uint8Array(e),n=0;oi(t,this.beforeVersionId,n),n+=4,oi(t,this.afterVersionId,n),n+=4,ky(t,this.beforeEOL,n),n+=1,ky(t,this.afterEOL,n),n+=1,n=o._writeSelections(t,this.beforeCursorState,n),n=o._writeSelections(t,this.afterCursorState,n),oi(t,this.changes.length,n),n+=4;for(let i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){let t=new Uint8Array(e),n=0,i=ii(t,n);n+=4;let r=ii(t,n);n+=4;let s=Ry(t,n);n+=1;let a=Ry(t,n);n+=1;let l=[];n=o._readSelections(t,n,l);let d=[];n=o._readSelections(t,n,d);let c=ii(t,n);n+=4;let u=[];for(let h=0;h<c;h++)n=er.read(t,n,u);return new o(i,r,s,a,l,d,u)}},JI=class{constructor(e,t,n,i){this.label=e;this.code=t;this.model=n,this._data=No.create(n,i)}model;_data;get type(){return 0}get resource(){return ne.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof No?this._data:No.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(ne.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof No}append(e,t,n,i,r){this._data instanceof No&&this._data.append(e,t,n,i,r)}close(){this._data instanceof No&&(this._data=this._data.serialize())}open(){this._data instanceof No||(this._data=No.deserialize(this._data))}undo(){if(ne.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof No&&(this._data=this._data.serialize());let e=No.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(ne.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof No&&(this._data=this._data.serialize());let e=No.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof No&&(this._data=this._data.serialize()),this._data.byteLength+168}},RD=class{constructor(e,t,n){this.label=e;this.code=t;this._isOpen=!0,this._editStackElementsArr=n.slice(0),this._editStackElementsMap=new Map;for(let i of this._editStackElementsArr){let r=ep(i.resource);this._editStackElementsMap.set(r,i)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(e=>e.resource)}setDelegate(e){this._delegate=e}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let e=[];for(let t of this._editStackElementsArr)ne.isUri(t.model)&&e.push(t.model);return e}matchesResource(e){let t=ep(e);return this._editStackElementsMap.has(t)}setModel(e){let t=ep(ne.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;let t=ep(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,n,i,r){let s=ep(e.uri);this._editStackElementsMap.get(s).append(e,t,n,i,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let e of this._editStackElementsArr)e.undo()}redo(){for(let e of this._editStackElementsArr)e.redo()}heapSize(e){let t=ep(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(let t of this._editStackElementsArr)e.push(`${uo(t.resource)}: ${t}`);return`{${e.join(", ")}}`}};function kD(o){return o.getEOL()===`
`?0:1}function DD(o){return o?o instanceof JI||o instanceof RD:!1}var eC=class o{_model;_undoRedoService;constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);DD(e)&&e.close()}popStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);DD(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){let n=this._undoRedoService.getLastElement(this._model.uri);if(DD(n)&&n.canAppend(this._model))return n;let i=new JI(p("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(i,t),i}pushEOL(e){let t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],kD(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n,i){let r=this._getOrCreateEditStackElement(e,i),s=this._model.applyEdits(t,!0),a=o._computeCursorState(n,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),r.append(this._model,l.map(d=>d.textChange),kD(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(n){return Ne(n),null}}};var tp=class extends B{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function kf(o,e){let t=0,n=0,i=o.length;for(;n<i;){let r=o.charCodeAt(n);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;n++}return n===i?-1:t}var tC=class extends tp{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return kf(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,n,i){this.assertNotDisposed();let r=this.textModel.getLineCount();if(t<1||t>r)throw new Te("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,u=-1,h=A=>{if(l!==-1&&(l===-2||l>A-1)){l=-1,d=-1;for(let P=A-2;P>=0;P--){let K=this._computeIndentLevel(P);if(K>=0){l=P,d=K;break}}}if(c===-2){c=-1,u=-1;for(let P=A;P<r;P++){let K=this._computeIndentLevel(P);if(K>=0){c=P,u=K;break}}}},m=-2,g=-1,f=-2,b=-1,y=A=>{if(m===-2){m=-1,g=-1;for(let P=A-2;P>=0;P--){let K=this._computeIndentLevel(P);if(K>=0){m=P,g=K;break}}}if(f!==-1&&(f===-2||f<A-1)){f=-1,b=-1;for(let P=A;P<r;P++){let K=this._computeIndentLevel(P);if(K>=0){f=P,b=K;break}}}},C=0,S=!0,w=0,R=!0,M=0,N=0;for(let A=0;S||R;A++){let P=t-A,K=t+A;A>1&&(P<1||P<n)&&(S=!1),A>1&&(K>r||K>i)&&(R=!1),A>5e4&&(S=!1,R=!1);let j=-1;if(S&&P>=1){let le=this._computeIndentLevel(P-1);le>=0?(c=P-1,u=le,j=Math.ceil(le/this.textModel.getOptions().indentSize)):(h(P),j=this._getIndentLevelForWhitespaceLine(a,d,u))}let X=-1;if(R&&K<=r){let le=this._computeIndentLevel(K-1);le>=0?(m=K-1,g=le,X=Math.ceil(le/this.textModel.getOptions().indentSize)):(y(K),X=this._getIndentLevelForWhitespaceLine(a,g,b))}if(A===0){N=j;continue}if(A===1){if(K<=r&&X>=0&&N+1===X){S=!1,C=K,w=K,M=X;continue}if(P>=1&&j>=0&&j-1===N){R=!1,C=P,w=P,M=j;continue}if(C=t,w=t,M=N,M===0)return{startLineNumber:C,endLineNumber:w,indent:M}}S&&(j>=M?C=P:S=!1),R&&(X>=M?w=K:R=!1)}return{startLineNumber:C,endLineNumber:w,indent:M}}getLinesBracketGuides(t,n,i,r){let s=[];for(let h=t;h<=n;h++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new L(t,1,n,this.textModel.getLineMaxColumn(n))).toArray(),d;if(i&&l.length>0){let h=(t<=i.lineNumber&&i.lineNumber<=n?l:this.textModel.bracketPairs.getBracketPairsInRange(L.fromPositions(i)).toArray()).filter(m=>L.strictContainsPosition(m.range,i));d=Yl(h,m=>a||m.range.startLineNumber!==m.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new Mf;for(let h of l){if(!h.closingBracketRange)continue;let m=d&&h.range.equalsRange(d);if(!m&&!r.includeInactive)continue;let g=u.getInlineClassName(h.nestingLevel,h.nestingLevelOfEqualBracketType,c)+(r.highlightActive&&m?" "+u.activeClassName:""),f=h.openingBracketRange.getStartPosition(),b=h.closingBracketRange.getStartPosition(),y=r.horizontalGuides===2||r.horizontalGuides===1&&m;if(h.range.startLineNumber===h.range.endLineNumber){a&&y&&s[h.range.startLineNumber-t].push(new Zr(-1,h.openingBracketRange.getEndPosition().column,g,new dl(!1,b.column),-1,-1));continue}let C=this.getVisibleColumnFromPosition(b),S=this.getVisibleColumnFromPosition(h.openingBracketRange.getStartPosition()),w=Math.min(S,C,h.minVisibleColumnIndentation+1),R=!1;ln(this.textModel.getLineContent(h.closingBracketRange.startLineNumber))<h.closingBracketRange.startColumn-1&&(R=!0);let A=Math.max(f.lineNumber,t),P=Math.min(b.lineNumber,n),K=R?1:0;for(let j=A;j<P+K;j++)s[j-t].push(new Zr(w,-1,g,null,j===f.lineNumber?f.column:-1,j===b.lineNumber?b.column:-1));y&&(f.lineNumber>=t&&S>w&&s[f.lineNumber-t].push(new Zr(w,-1,g,new dl(!1,f.column),-1,-1)),b.lineNumber<=n&&C>w&&s[b.lineNumber-t].push(new Zr(w,-1,g,new dl(!R,b.column),-1,-1)))}for(let h of s)h.sort((m,g)=>m.visibleColumn-g.visibleColumn);return s}getVisibleColumnFromPosition(t){return Rt.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,n){this.assertNotDisposed();let i=this.textModel.getLineCount();if(t<1||t>i)throw new Error("Illegal value for startLineNumber");if(n<1||n>i)throw new Error("Illegal value for endLineNumber");let r=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(n-t+1),d=-2,c=-1,u=-2,h=-1;for(let m=t;m<=n;m++){let g=m-t,f=this._computeIndentLevel(m-1);if(f>=0){d=m-1,c=f,l[g]=Math.ceil(f/r.indentSize);continue}if(d===-2){d=-1,c=-1;for(let b=m-2;b>=0;b--){let y=this._computeIndentLevel(b);if(y>=0){d=b,c=y;break}}}if(u!==-1&&(u===-2||u<m-1)){u=-1,h=-1;for(let b=m;b<i;b++){let y=this._computeIndentLevel(b);if(y>=0){u=b,h=y;break}}}l[g]=this._getIndentLevelForWhitespaceLine(a,c,h)}return l}_getIndentLevelForWhitespaceLine(t,n,i){let r=this.textModel.getOptions();return n===-1||i===-1?0:n<i?1+Math.floor(n/r.indentSize):n===i||t?Math.ceil(i/r.indentSize):1+Math.floor(i/r.indentSize)}},Mf=class{activeClassName="indent-active";getInlineClassName(e,t,n){return this.getInlineClassNameOfLevel(n?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}};var MD=class{spacesDiff=0;looksLikeAlignment=!1};function CU(o,e,t,n,i){i.spacesDiff=0,i.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<n;r++){let h=o.charCodeAt(r),m=t.charCodeAt(r);if(h!==m)break}let s=0,a=0;for(let h=r;h<e;h++)o.charCodeAt(h)===32?s++:a++;let l=0,d=0;for(let h=r;h<n;h++)t.charCodeAt(h)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),u=Math.abs(s-l);if(c===0){i.spacesDiff=u,u>0&&0<=l-1&&l-1<o.length&&l<t.length&&t.charCodeAt(l)!==32&&o.charCodeAt(l-1)===32&&o.charCodeAt(o.length-1)===44&&(i.looksLikeAlignment=!0);return}if(u%c===0){i.spacesDiff=u/c;return}}function ND(o,e,t){let n=Math.min(o.getLineCount(),1e4),i=0,r=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],u=new MD;for(let g=1;g<=n;g++){let f=o.getLineLength(g),b=o.getLineContent(g),y=f<=65536,C=!1,S=0,w=0,R=0;for(let N=0,A=f;N<A;N++){let P=y?b.charCodeAt(N):o.getLineCharCode(g,N);if(P===9)R++;else if(P===32)w++;else{C=!0,S=N;break}}if(!C||(R>0?i++:w>1&&r++,CU(s,a,b,S,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;let M=u.spacesDiff;M<=d&&c[M]++,s=b,a=S}let h=t;i!==r&&(h=i<r);let m=e;if(h){let g=h?0:.1*n;l.forEach(f=>{let b=c[f];b>g&&(g=b,m=f)}),m===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(m=2)}return{insertSpaces:h,tabSize:m}}function bo(o){return(o.metadata&1)>>>0}function kt(o,e){o.metadata=o.metadata&254|e<<0}function si(o){return(o.metadata&2)>>>1===1}function _t(o,e){o.metadata=o.metadata&253|(e?1:0)<<1}function BF(o){return(o.metadata&4)>>>2===1}function kF(o,e){o.metadata=o.metadata&251|(e?1:0)<<2}function VF(o){return(o.metadata&64)>>>6===1}function MF(o,e){o.metadata=o.metadata&191|(e?1:0)<<6}function SU(o){return(o.metadata&24)>>>3}function NF(o,e){o.metadata=o.metadata&231|e<<3}function xU(o){return(o.metadata&32)>>>5===1}function AF(o,e){o.metadata=o.metadata&223|(e?1:0)<<5}var Of=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,kt(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,kF(this,!1),MF(this,!1),NF(this,1),AF(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,_t(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;kF(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),MF(this,this.options.glyphMarginClassName!==null),NF(this,this.options.stickiness),AF(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}},Ge=new Of(null,0,0);Ge.parent=Ge;Ge.left=Ge;Ge.right=Ge;kt(Ge,0);var ip=class{root;requestNormalizeDelta;constructor(){this.root=Ge,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,r,s){return this.root===Ge?[]:RU(this,e,t,n,i,r,s)}search(e,t,n,i){return this.root===Ge?[]:OF(this,e,t,n,i)}collectNodesFromOwner(e){return LU(this,e)}collectNodesPostOrder(){return DU(this)}insert(e){PF(this,e),this._normalizeDeltaIfNecessary()}delete(e){FF(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){let n=e,i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;let r=n.start+i,s=n.end+i;n.setCachedOffsets(r,s,t)}acceptReplace(e,t,n,i){let r=_U(this,e,e+t);for(let s=0,a=r.length;s<a;s++){let l=r[s];FF(this,l)}this._normalizeDeltaIfNecessary(),TU(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let s=0,a=r.length;s<a;s++){let l=r[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,wU(l,e,e+t,n,i),l.maxEnd=l.end,PF(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return OF(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,EU(this))}};function EU(o){let e=o.root,t=0;for(;e!==Ge;){if(e.left!==Ge&&!si(e.left)){e=e.left;continue}if(e.right!==Ge&&!si(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,pl(e),_t(e,!0),_t(e.left,!1),_t(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}_t(o.root,!1)}function np(o,e,t,n){return o<t?!0:o>t||n===1?!1:n===2?!0:e}function wU(o,e,t,n,i){let r=SU(o),s=r===0||r===2,a=r===1||r===2,l=t-e,d=n,c=Math.min(l,d),u=o.start,h=!1,m=o.end,g=!1;e<=u&&m<=t&&xU(o)&&(o.start=e,h=!0,o.end=e,g=!0);{let b=i?1:l>0?2:0;!h&&np(u,s,e,b)&&(h=!0),!g&&np(m,a,e,b)&&(g=!0)}if(c>0&&!i){let b=l>d?2:0;!h&&np(u,s,e+c,b)&&(h=!0),!g&&np(m,a,e+c,b)&&(g=!0)}{let b=i?1:0;!h&&np(u,s,t,b)&&(o.start=e+d,h=!0),!g&&np(m,a,t,b)&&(o.end=e+d,g=!0)}let f=d-l;h||(o.start=Math.max(0,u+f)),g||(o.end=Math.max(0,m+f)),o.start>o.end&&(o.end=o.start)}function _U(o,e,t){let n=o.root,i=0,r=0,s=0,a=0,l=[],d=0;for(;n!==Ge;){if(si(n)){_t(n.left,!1),_t(n.right,!1),n===n.parent.right&&(i-=n.parent.delta),n=n.parent;continue}if(!si(n.left)){if(r=i+n.maxEnd,r<e){_t(n,!0);continue}if(n.left!==Ge){n=n.left;continue}}if(s=i+n.start,s>t){_t(n,!0);continue}if(a=i+n.end,a>=e&&(n.setCachedOffsets(s,a,0),l[d++]=n),_t(n,!0),n.right!==Ge&&!si(n.right)){i+=n.delta,n=n.right;continue}}return _t(o.root,!1),l}function TU(o,e,t,n){let i=o.root,r=0,s=0,a=0,l=n-(t-e);for(;i!==Ge;){if(si(i)){_t(i.left,!1),_t(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),pl(i),i=i.parent;continue}if(!si(i.left)){if(s=r+i.maxEnd,s<e){_t(i,!0);continue}if(i.left!==Ge){i=i.left;continue}}if(a=r+i.start,a>t){i.start+=l,i.end+=l,i.delta+=l,(i.delta<-1073741824||i.delta>1073741824)&&(o.requestNormalizeDelta=!0),_t(i,!0);continue}if(_t(i,!0),i.right!==Ge&&!si(i.right)){r+=i.delta,i=i.right;continue}}_t(o.root,!1)}function LU(o,e){let t=o.root,n=[],i=0;for(;t!==Ge;){if(si(t)){_t(t.left,!1),_t(t.right,!1),t=t.parent;continue}if(t.left!==Ge&&!si(t.left)){t=t.left;continue}if(t.ownerId===e&&(n[i++]=t),_t(t,!0),t.right!==Ge&&!si(t.right)){t=t.right;continue}}return _t(o.root,!1),n}function DU(o){let e=o.root,t=[],n=0;for(;e!==Ge;){if(si(e)){_t(e.left,!1),_t(e.right,!1),e=e.parent;continue}if(e.left!==Ge&&!si(e.left)){e=e.left;continue}if(e.right!==Ge&&!si(e.right)){e=e.right;continue}t[n++]=e,_t(e,!0)}return _t(o.root,!1),t}function OF(o,e,t,n,i){let r=o.root,s=0,a=0,l=0,d=[],c=0;for(;r!==Ge;){if(si(r)){_t(r.left,!1),_t(r.right,!1),r===r.parent.right&&(s-=r.parent.delta),r=r.parent;continue}if(r.left!==Ge&&!si(r.left)){r=r.left;continue}a=s+r.start,l=s+r.end,r.setCachedOffsets(a,l,n);let u=!0;if(e&&r.ownerId&&r.ownerId!==e&&(u=!1),t&&BF(r)&&(u=!1),i&&!VF(r)&&(u=!1),u&&(d[c++]=r),_t(r,!0),r.right!==Ge&&!si(r.right)){s+=r.delta,r=r.right;continue}}return _t(o.root,!1),d}function RU(o,e,t,n,i,r,s){let a=o.root,l=0,d=0,c=0,u=0,h=[],m=0;for(;a!==Ge;){if(si(a)){_t(a.left,!1),_t(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!si(a.left)){if(d=l+a.maxEnd,d<e){_t(a,!0);continue}if(a.left!==Ge){a=a.left;continue}}if(c=l+a.start,c>t){_t(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(c,u,r);let g=!0;n&&a.ownerId&&a.ownerId!==n&&(g=!1),i&&BF(a)&&(g=!1),s&&!VF(a)&&(g=!1),g&&(h[m++]=a)}if(_t(a,!0),a.right!==Ge&&!si(a.right)){l+=a.delta,a=a.right;continue}}return _t(o.root,!1),h}function PF(o,e){if(o.root===Ge)return e.parent=Ge,e.left=Ge,e.right=Ge,kt(e,0),o.root=e,o.root;kU(o,e),Ad(e.parent);let t=e;for(;t!==o.root&&bo(t.parent)===1;)if(t.parent===t.parent.parent.left){let n=t.parent.parent.right;bo(n)===1?(kt(t.parent,0),kt(n,0),kt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,Nf(o,t)),kt(t.parent,0),kt(t.parent.parent,1),Af(o,t.parent.parent))}else{let n=t.parent.parent.left;bo(n)===1?(kt(t.parent,0),kt(n,0),kt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,Af(o,t)),kt(t.parent,0),kt(t.parent.parent,1),Nf(o,t.parent.parent))}return kt(o.root,0),e}function kU(o,e){let t=0,n=o.root,i=e.start,r=e.end;for(;;)if(NU(i,r,n.start+t,n.end+t)<0)if(n.left===Ge){e.start-=t,e.end-=t,e.maxEnd-=t,n.left=e;break}else n=n.left;else if(n.right===Ge){e.start-=t+n.delta,e.end-=t+n.delta,e.maxEnd-=t+n.delta,n.right=e;break}else t+=n.delta,n=n.right;e.parent=n,e.left=Ge,e.right=Ge,kt(e,1)}function FF(o,e){let t,n;if(e.left===Ge?(t=e.right,n=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Ge?(t=e.left,n=e):(n=MU(e.right),t=n.right,t.start+=n.delta,t.end+=n.delta,t.delta+=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),n.start+=e.delta,n.end+=e.delta,n.delta=e.delta,(n.delta<-1073741824||n.delta>1073741824)&&(o.requestNormalizeDelta=!0)),n===o.root){o.root=t,kt(t,0),e.detach(),AD(),pl(t),o.root.parent=Ge;return}let i=bo(n)===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?t.parent=n.parent:(n.parent===e?t.parent=n:t.parent=n.parent,n.left=e.left,n.right=e.right,n.parent=e.parent,kt(n,bo(e)),e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Ge&&(n.left.parent=n),n.right!==Ge&&(n.right.parent=n)),e.detach(),i){Ad(t.parent),n!==e&&(Ad(n),Ad(n.parent)),AD();return}Ad(t),Ad(t.parent),n!==e&&(Ad(n),Ad(n.parent));let r;for(;t!==o.root&&bo(t)===0;)t===t.parent.left?(r=t.parent.right,bo(r)===1&&(kt(r,0),kt(t.parent,1),Nf(o,t.parent),r=t.parent.right),bo(r.left)===0&&bo(r.right)===0?(kt(r,1),t=t.parent):(bo(r.right)===0&&(kt(r.left,0),kt(r,1),Af(o,r),r=t.parent.right),kt(r,bo(t.parent)),kt(t.parent,0),kt(r.right,0),Nf(o,t.parent),t=o.root)):(r=t.parent.left,bo(r)===1&&(kt(r,0),kt(t.parent,1),Af(o,t.parent),r=t.parent.left),bo(r.left)===0&&bo(r.right)===0?(kt(r,1),t=t.parent):(bo(r.left)===0&&(kt(r.right,0),kt(r,1),Nf(o,r),r=t.parent.left),kt(r,bo(t.parent)),kt(t.parent,0),kt(r.left,0),Af(o,t.parent),t=o.root));kt(t,0),AD()}function MU(o){for(;o.left!==Ge;)o=o.left;return o}function AD(){Ge.parent=Ge,Ge.delta=0,Ge.start=0,Ge.end=0}function Nf(o,e){let t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Ge&&(t.left.parent=e),t.parent=e.parent,e.parent===Ge?o.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,pl(e),pl(t)}function Af(o,e){let t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(o.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Ge&&(t.right.parent=e),t.parent=e.parent,e.parent===Ge?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,pl(e),pl(t)}function WF(o){let e=o.end;if(o.left!==Ge){let t=o.left.maxEnd;t>e&&(e=t)}if(o.right!==Ge){let t=o.right.maxEnd+o.delta;t>e&&(e=t)}return e}function pl(o){o.maxEnd=WF(o)}function Ad(o){for(;o!==Ge;){let e=WF(o);if(o.maxEnd===e)return;o.maxEnd=e,o=o.parent}}function NU(o,e,t,n){return o===t?e-n:o-t}var op=class{parent;left;right;color;piece;size_left;lf_left;constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Me)return nC(this.right);let e=this;for(;e.parent!==Me&&e.parent.left!==e;)e=e.parent;return e.parent===Me?Me:e.parent}prev(){if(this.left!==Me)return PD(this.left);let e=this;for(;e.parent!==Me&&e.parent.right!==e;)e=e.parent;return e.parent===Me?Me:e.parent}detach(){this.parent=null,this.left=null,this.right=null}};var Me=new op(null,0);Me.parent=Me;Me.left=Me;Me.right=Me;Me.color=0;function nC(o){for(;o.left!==Me;)o=o.left;return o}function PD(o){for(;o.right!==Me;)o=o.right;return o}function FD(o){return o===Me?0:o.size_left+o.piece.length+FD(o.right)}function BD(o){return o===Me?0:o.lf_left+o.piece.lineFeedCnt+BD(o.right)}function OD(){Me.parent=Me}function Bf(o,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Me&&(t.left.parent=e),t.parent=e.parent,e.parent===Me?o.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Vf(o,e){let t=e.left;e.left=t.right,t.right!==Me&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Me?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Wf(o,e){let t,n;if(e.left===Me?(n=e,t=n.right):e.right===Me?(n=e,t=n.left):(n=nC(e.right),t=n.right),n===o.root){o.root=t,t.color=0,e.detach(),OD(),o.root.parent=Me;return}let i=n.color===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?(t.parent=n.parent,Ff(o,t)):(n.parent===e?t.parent=n:t.parent=n.parent,Ff(o,t),n.left=e.left,n.right=e.right,n.parent=e.parent,n.color=e.color,e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Me&&(n.left.parent=n),n.right!==Me&&(n.right.parent=n),n.size_left=e.size_left,n.lf_left=e.lf_left,Ff(o,n)),e.detach(),t.parent.left===t){let s=FD(t),a=BD(t);if(s!==t.parent.size_left||a!==t.parent.lf_left){let l=s-t.parent.size_left,d=a-t.parent.lf_left;t.parent.size_left=s,t.parent.lf_left=a,va(o,t.parent,l,d)}}if(Ff(o,t.parent),i){OD();return}let r;for(;t!==o.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,Bf(o,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,Vf(o,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,Bf(o,t.parent),t=o.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,Vf(o,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,Bf(o,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,Vf(o,t.parent),t=o.root));t.color=0,OD()}function VD(o,e){for(Ff(o,e);e!==o.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,Bf(o,e)),e.parent.color=0,e.parent.parent.color=1,Vf(o,e.parent.parent))}else{let t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Vf(o,e)),e.parent.color=0,e.parent.parent.color=1,Bf(o,e.parent.parent))}o.root.color=0}function va(o,e,t,n){for(;e!==o.root&&e!==Me;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}function Ff(o,e){let t=0,n=0;if(e!==o.root){for(;e!==o.root&&e===e.parent.right;)e=e.parent;if(e!==o.root)for(e=e.parent,t=FD(e.left)-e.size_left,n=BD(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=n;e!==o.root&&(t!==0||n!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}}var AU=999,gl=class{searchString;isRegex;matchCase;wordSeparators;constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=OU(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=Yv(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new yI(t,this.wordSeparators?aa(this.wordSeparators,[]):null,n?this.searchString:null)}};function OU(o){if(!o||o.length===0)return!1;for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n===10)return!0;if(n===92){if(e++,e>=t)break;let i=o.charCodeAt(e);if(i===110||i===114||i===87)return!0}}return!1}function Od(o,e,t){if(!t)return new _d(o,null);let n=[];for(let i=0,r=e.length;i<r;i++)n[i]=e[i];return new _d(o,n)}var iC=class{_lineFeedsOffsets;constructor(e){let t=[],n=0;for(let i=0,r=e.length;i<r;i++)e.charCodeAt(i)===10&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){let t=this._lineFeedsOffsets,n=0,i=t.length-1;if(i===-1||e<=t[0])return 0;for(;n<i;){let r=n+((i-n)/2>>0);t[r]>=e?i=r-1:t[r+1]>=e?(n=r,i=r):n=r+1}return n+1}},jc=class{static findMatches(e,t,n,i,r){let s=t.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(e,n,new ml(s.wordSeparators,s.regex),i,r):this._doFindMatchesLineByLine(e,n,s,i,r):[]}static _getMultilineMatchRange(e,t,n,i,r,s){let a,l=0;i?(l=i.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let d;if(i){let m=i.findLineFeedCountBeforeOffset(r+s.length)-l;d=a+s.length+m}else d=a+s.length;let c=e.getPositionAt(a),u=e.getPositionAt(d);return new L(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,n,i,r){let s=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new iC(a):null,d=[],c=0,u;for(n.reset(0);u=n.next(a);)if(d[c++]=Od(this._getMultilineMatchRange(e,s,a,l,u.index,u[0]),u,i),c>=r)return d;return d}static _doFindMatchesLineByLine(e,t,n,i,r){let s=[],a=0;if(t.startLineNumber===t.endLineNumber){let d=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(n,d,t.startLineNumber,t.startColumn-1,a,s,i,r),s}let l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(n,l,t.startLineNumber,t.startColumn-1,a,s,i,r);for(let d=t.startLineNumber+1;d<t.endLineNumber&&a<r;d++)a=this._findMatchesInLine(n,e.getLineContent(d),d,0,a,s,i,r);if(a<r){let d=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(n,d,t.endLineNumber,0,a,s,i,r)}return s}static _findMatchesInLine(e,t,n,i,r,s,a,l){let d=e.wordSeparators;if(!a&&e.simpleSearch){let h=e.simpleSearch,m=h.length,g=t.length,f=-m;for(;(f=t.indexOf(h,f+m))!==-1;)if((!d||oC(d,t,g,f,m))&&(s[r++]=new _d(new L(n,f+1+i,n,f+1+m+i),null),r>=l))return r;return r}let c=new ml(e.wordSeparators,e.regex),u;c.reset(0);do if(u=c.next(t),u&&(s[r++]=Od(new L(n,u.index+1+i,n,u.index+1+u[0].length+i),u,a),r>=l))return r;while(u);return r}static findNextMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new ml(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,n,s,i):this._doFindNextMatchLineByLine(e,n,s,i)}static _doFindNextMatchMultiline(e,t,n,i){let r=new V(t.lineNumber,1),s=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new L(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),d=e.getEOL()===`\r
`?new iC(l):null;n.reset(t.column-1);let c=n.next(l);return c?Od(this._getMultilineMatchRange(e,s,l,d,c.index,c[0]),c,i):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new V(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s),l=this._findFirstMatchInLine(n,a,s,t.column,i);if(l)return l;for(let d=1;d<=r;d++){let c=(s+d-1)%r,u=e.getLineContent(c+1),h=this._findFirstMatchInLine(n,u,c+1,1,i);if(h)return h}return null}static _findFirstMatchInLine(e,t,n,i,r){e.reset(i-1);let s=e.next(t);return s?Od(new L(n,s.index+1,n,s.index+1+s[0].length),s,r):null}static findPreviousMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new ml(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,n,s,i):this._doFindPreviousMatchLineByLine(e,n,s,i)}static _doFindPreviousMatchMultiline(e,t,n,i){let r=this._doFindMatchesMultiline(e,new L(1,1,t.lineNumber,t.column),n,i,10*AU);if(r.length>0)return r[r.length-1];let s=e.getLineCount();return t.lineNumber!==s||t.column!==e.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(e,new V(s,e.getLineMaxColumn(s)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s).substring(0,t.column-1),l=this._findLastMatchInLine(n,a,s,i);if(l)return l;for(let d=1;d<=r;d++){let c=(r+s-d-1)%r,u=e.getLineContent(c+1),h=this._findLastMatchInLine(n,u,c+1,i);if(h)return h}return null}static _findLastMatchInLine(e,t,n,i){let r=null,s;for(e.reset(0);s=e.next(t);)r=Od(new L(n,s.index+1,n,s.index+1+s[0].length),s,i);return r}};function PU(o,e,t,n,i){if(n===0)return!0;let r=e.charCodeAt(n-1);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n);if(o.get(s)!==0)return!0}return!1}function FU(o,e,t,n,i){if(n+i===t)return!0;let r=e.charCodeAt(n+i);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n+i-1);if(o.get(s)!==0)return!0}return!1}function oC(o,e,t,n,i){return PU(o,e,t,n,i)&&FU(o,e,t,n,i)}var ml=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;let i=n.index,r=n[0].length;if(i===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){hh(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=i,this._prevMatchLength=r,!this._wordSeparators||oC(this._wordSeparators,e,t,i,r))return n}while(n);return null}};var fl=65535;function HF(o){let e;return o[o.length-1]<65536?e=new Uint16Array(o.length):e=new Uint32Array(o.length),e.set(o,0),e}var HD=class{constructor(e,t,n,i,r){this.lineStarts=e;this.cr=t;this.lf=n;this.crlf=i;this.isBasicASCII=r}};function ya(o,e=!0){let t=[0],n=1;for(let i=0,r=o.length;i<r;i++){let s=o.charCodeAt(i);s===13?i+1<r&&o.charCodeAt(i+1)===10?(t[n++]=i+2,i++):t[n++]=i+1:s===10&&(t[n++]=i+1)}return e?HF(t):t}function UF(o,e){o.length=0,o[0]=0;let t=1,n=0,i=0,r=0,s=!0;for(let l=0,d=e.length;l<d;l++){let c=e.charCodeAt(l);c===13?l+1<d&&e.charCodeAt(l+1)===10?(r++,o[t++]=l+2,l++):(n++,o[t++]=l+1):c===10?(i++,o[t++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new HD(HF(o),n,i,r,s);return o.length=0,a}var Ji=class{bufferIndex;start;end;length;lineFeedCnt;constructor(e,t,n,i,r){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=r}},Ia=class{buffer;lineStarts;constructor(e,t){this.buffer=e,this.lineStarts=t}},UD=class{_pieces;_index;_tree;_BOM;constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Me&&e.iterate(e.root,n=>(n!==Me&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},zD=class{_limit;_cache;constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let r=n[i];if(r.node.parent===null||r.nodeStartOffset>=e){n[i]=null,t=!0;continue}}if(t){let i=[];for(let r of n)r!==null&&i.push(r);this._cache=i}}},rC=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new Ia("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Me,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let r=0,s=e.length;r<s;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=ya(e[r].buffer));let a=new Ji(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),i=this.rbInsertRight(i,a)}this._searchCache=new zD(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=fl,n=t-Math.floor(t/3),i=n*2,r="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=n||s+c<i)return r+=d,s+=c,!0;let u=r.replace(/\r\n|\r|\n/g,e);return a.push(new Ia(u,ya(u))),r=d,s=c,!0}),s>0){let l=r.replace(/\r\n|\r|\n/g,e);a.push(new Ia(l,ya(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new UD(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,i=>{if(i===Me)return!0;let r=this.getNodeContent(i),s=r.length,a=e.nodeAt(t),l=e.nodeAt(t+s),d=e.getValueInRange2(a,l);return t+=s,r===d})}getOffsetAt(e,t){let n=0,i=this.root;for(;i!==Me;)if(i.left!==Me&&i.lf_left+1>=e)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;let r=this.getAccumulatedValue(i,e-i.lf_left-2);return n+=r+t-1}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;for(;t!==Me;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let r=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+r.index,r.index===0){let s=this.getOffsetAt(n+1,1),a=i-s;return new V(n+1,a+1)}return new V(n+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===Me){let r=this.getOffsetAt(n+1,1),s=i-e-r;return new V(n+1,s+1)}else t=t.right;return new V(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(n,i);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+e.remainder,d+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),s=i.substring(r+e.remainder,r+n.piece.length);for(n=n.next();n!==Me;){let a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){s+=a.substring(l,l+t.remainder);break}else s+=a.substr(l,n.piece.length);n=n.next()}return s}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,r=>{if(r===Me)return!0;let s=r.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line,h=d[c]+s.start.column;if(i&&(l.charCodeAt(h)===10&&(h++,a--),e[t++]=n,n="",i=!1,a===0))return!0;if(c===u)return!this._EOLNormalized&&l.charCodeAt(h+a-1)===13?(i=!0,n+=l.substr(h,a-1)):n+=l.substr(h,a),!0;n+=this._EOLNormalized?l.substring(h,Math.max(h,d[c+1]-this._EOLLength)):l.substring(h,d[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let m=c+1;m<u;m++)n=this._EOLNormalized?l.substring(d[m],d[m+1]-this._EOLLength):l.substring(d[m],d[m+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return!this._EOLNormalized&&l.charCodeAt(d[u]+s.end.column-1)===13?(i=!0,s.end.column===0?t--:n=l.substr(d[u],s.end.column-1)):n=l.substr(d[u],s.end.column),!0}),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}else{let t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let n=t.node.next();if(!n||n===Me)return"";let i=this._buffers[n.piece.bufferIndex],r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.buffer.substring(r,r+n.piece.length)}else{let n=this._buffers[t.node.piece.bufferIndex],i=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=i+t.remainder,s=i+t.node.piece.length;return n.buffer.substring(r,s)}}findMatchesInNode(e,t,n,i,r,s,a,l,d,c,u){let h=this._buffers[e.piece.bufferIndex],m=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),g=this.offsetInBuffer(e.piece.bufferIndex,r),f=this.offsetInBuffer(e.piece.bufferIndex,s),b,y={line:0,column:0},C,S;t._wordSeparators?(C=h.buffer.substring(g,f),S=w=>w+g,t.reset(0)):(C=h.buffer,S=w=>w,t.reset(g));do if(b=t.next(C),b){if(S(b.index)>=f)return c;this.positionInBuffer(e,S(b.index)-m,y);let w=this.getLineFeedCnt(e.piece.bufferIndex,r,y),R=y.line===r.line?y.column-r.column+i:y.column+1,M=R+b[0].length;if(u[c++]=Od(new L(n+w,R,n+w,M),b,l),S(b.index)+b[0].length>=f||c>=d)return c}while(b);return c}findMatchesLineByLine(e,t,n,i){let r=[],s=0,a=new ml(t.wordSeparators,t.regex),l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let d=this.nodeAt2(e.endLineNumber,e.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,c,u,t,n,i,s,r),r;let h=e.startLineNumber,m=l.node;for(;m!==d.node;){let f=this.getLineFeedCnt(m.piece.bufferIndex,c,m.piece.end);if(f>=1){let y=this._buffers[m.piece.bufferIndex].lineStarts,C=this.offsetInBuffer(m.piece.bufferIndex,m.piece.start),S=y[c.line+f],w=h===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(m,a,h,w,c,this.positionInBuffer(m,S-C),t,n,i,s,r),s>=i)return r;h+=f}let b=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){let y=this.getLineContent(h).substring(b,e.endColumn-1);return s=this._findMatchesInLine(t,a,y,e.endLineNumber,b,s,r,n,i),r}if(s=this._findMatchesInLine(t,a,this.getLineContent(h).substr(b),h,b,s,r,n,i),s>=i)return r;h++,l=this.nodeAt2(h,1),m=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(h===e.endLineNumber){let f=h===e.startLineNumber?e.startColumn-1:0,b=this.getLineContent(h).substring(f,e.endColumn-1);return s=this._findMatchesInLine(t,a,b,e.endLineNumber,f,s,r,n,i),r}let g=h===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(d.node,a,h,g,c,u,t,n,i,s,r),r}_findMatchesInLine(e,t,n,i,r,s,a,l,d){let c=e.wordSeparators;if(!l&&e.simpleSearch){let h=e.simpleSearch,m=h.length,g=n.length,f=-m;for(;(f=n.indexOf(h,f+m))!==-1;)if((!c||oC(c,n,g,f,m))&&(a[s++]=new _d(new L(i,f+1+r,i,f+1+m+r),null),s>=d))return s;return s}let u;t.reset(0);do if(u=t.next(n),u&&(a[s++]=Od(new L(i,u.index+1+r,i,u.index+1+u[0].length+r),u,l),s>=d))return s;while(u);return s}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Me){let{node:i,remainder:r,nodeStartOffset:s}=this.nodeAt(e),a=i.piece,l=a.bufferIndex,d=this.positionInBuffer(i,r);if(i.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===e&&t.length<fl){this.appendToNode(i,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(s+i.piece.length>e){let c=[],u=new Ji(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(i,r)===10){let f={line:u.start.line+1,column:0};u=new Ji(u.bufferIndex,f,u.end,this.getLineFeedCnt(u.bufferIndex,f,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(i,r-1)===13){let f=this.positionInBuffer(i,r-1);this.deleteNodeTail(i,f),t="\r"+t,i.piece.length===0&&c.push(i)}else this.deleteNodeTail(i,d);else this.deleteNodeTail(i,d);let h=this.createNewPieces(t);u.length>0&&this.rbInsertRight(i,u);let m=i;for(let g=0;g<h.length;g++)m=this.rbInsertRight(m,h[g]);this.deleteNodes(c)}else this.insertContentToNodeRight(t,i)}else{let i=this.createNewPieces(t),r=this.rbInsertLeft(null,i[0]);for(let s=1;s<i.length;s++)r=this.rbInsertRight(r,i[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Me)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),r=n.node,s=i.node;if(r===s){let h=this.positionInBuffer(r,n.remainder),m=this.positionInBuffer(r,i.remainder);if(n.nodeStartOffset===e){if(t===r.piece.length){let g=r.next();Wf(this,r),this.validateCRLFWithPrevNode(g),this.computeBufferMetadata();return}this.deleteNodeHead(r,m),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,h),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,h,m),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);let d=this.positionInBuffer(s,i.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=r.next();for(let h=c;h!==Me&&h!==s;h=h.next())a.push(h);let u=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let s=t.piece,a={line:s.start.line+1,column:0},l=new Ji(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);t.piece=l,e+=`
`,va(this,t,-1,-1),t.piece.length===0&&n.push(t)}let i=this.createNewPieces(e),r=this.rbInsertLeft(t,i[i.length-1]);for(let s=i.length-2;s>=0;s--)r=this.rbInsertLeft(r,i[s]);this.validateCRLFWithPrevNode(r),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),r=i;for(let s=1;s<n.length;s++)r=this.rbInsertRight(r,n[s]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,r=e.piece.bufferIndex,s=this._buffers[r].lineStarts,l=s[i.start.line]+i.start.column+t,d=i.start.line,c=i.end.line,u=0,h=0,m=0;for(;d<=c&&(u=d+(c-d)/2|0,m=s[u],u!==c);)if(h=s[u+1],l<m)c=u-1;else if(l>=h)d=u+1;else break;return n?(n.line=u,n.column=l-m,null):{line:u,column:l-m}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let r=i[n.line+1],s=i[n.line]+n.column;if(r>s+1)return n.line-t.line;let a=s-1;return this._buffers[e].buffer.charCodeAt(a)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Wf(this,e[t])}createNewPieces(e){if(e.length>fl){let c=[];for(;e.length>fl;){let h=e.charCodeAt(fl-1),m;h===13||h>=55296&&h<=56319?(m=e.substring(0,fl-1),e=e.substring(fl-1)):(m=e.substring(0,fl),e=e.substring(fl));let g=ya(m);c.push(new Ji(this._buffers.length,{line:0,column:0},{line:g.length-1,column:m.length-g[g.length-1]},g.length-1,m.length)),this._buffers.push(new Ia(m,g))}let u=ya(e);return c.push(new Ji(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new Ia(e,u)),c}let t=this._buffers[0].buffer.length,n=ya(e,!1),i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let c=0;c<n.length;c++)n[c]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let c=0;c<n.length;c++)n[c]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}let r=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new Ji(0,i,l,this.getLineFeedCnt(0,i,l),r-t);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,i="",r=this._searchCache.get2(e);if(r){n=r.node;let s=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e)i=a.substring(l+s,l+n.piece.length);else{let d=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return a.substring(l+s,l+d-t)}}else{let s=0,a=e;for(;n!==Me;)if(n.left!==Me&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this.getAccumulatedValue(n,e-n.lf_left-1),c=this._buffers[n.piece.bufferIndex].buffer,u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:s,nodeStartLineNumber:a-(e-1-n.lf_left)}),c.substring(u+l,u+d-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this._buffers[n.piece.bufferIndex].buffer,c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=d.substring(c+l,c+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==Me;){let s=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(n,0),l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=s.substring(l,l+a-t),i}else{let a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=s.substr(a,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==Me;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),r=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let s=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(s!==r)return{index:s,remainder:0}}return{index:r,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,r=n.start.line+t+1;return r>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[r]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.end),s=t,a=this.offsetInBuffer(n.bufferIndex,s),l=this.getLineFeedCnt(n.bufferIndex,n.start,s),d=l-i,c=a-r,u=n.length+c;e.piece=new Ji(n.bufferIndex,n.start,s,l,u),va(this,e,c,d)}deleteNodeHead(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.start),s=t,a=this.getLineFeedCnt(n.bufferIndex,s,n.end),l=this.offsetInBuffer(n.bufferIndex,s),d=a-i,c=r-l,u=n.length+c;e.piece=new Ji(n.bufferIndex,s,n.end,a,u),va(this,e,c,d)}shrinkNode(e,t,n){let i=e.piece,r=i.start,s=i.end,a=i.length,l=i.lineFeedCnt,d=t,c=this.getLineFeedCnt(i.bufferIndex,i.start,d),u=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,r);e.piece=new Ji(i.bufferIndex,i.start,d,c,u),va(this,e,u-a,c-l);let h=new Ji(i.bufferIndex,n,s,this.getLineFeedCnt(i.bufferIndex,n,s),this.offsetInBuffer(i.bufferIndex,s)-this.offsetInBuffer(i.bufferIndex,n)),m=this.rbInsertRight(e,h);this.validateCRLFWithPrevNode(m)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let r=ya(t,!1);for(let m=0;m<r.length;m++)r[m]+=i;if(n){let m=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-m}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=e.piece.length+t.length,c=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),h=u-c;e.piece=new Ji(e.piece.bufferIndex,e.piece.start,l,u,d),this._lastChangeBufferPos=l,va(this,e,t.length,h)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;for(;t!==Me;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){i+=t.size_left;let r={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,i=0;for(;n!==Me;)if(n.left!==Me&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2),s=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(r+t-1,s),nodeStartOffset:i}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+t-1<=n.piece.length)return{node:n,remainder:r+t-1,nodeStartOffset:i};t-=n.piece.length-r;break}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==Me;){if(n.piece.lineFeedCnt>0){let r=this.getAccumulatedValue(n,0),s=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,r),nodeStartOffset:s}}else if(n.piece.length>=t-1){let r=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:r}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Me||e.piece.lineFeedCnt===0)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,r=n[i]+t.start.column;return i===n.length-1||n[i+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Me||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n=[],i=this._buffers[e.piece.bufferIndex].lineStarts,r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:i[e.piece.end.line]-i[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};let s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Ji(e.piece.bufferIndex,e.piece.start,r,a,s),va(this,e,-1,-1),e.piece.length===0&&n.push(e);let l={line:t.piece.start.line+1,column:0},d=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Ji(t.piece.bufferIndex,l,t.piece.end,c,d),va(this,t,-1,-1),t.piece.length===0&&n.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let h=0;h<n.length;h++)Wf(this,n[h])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)Wf(this,n);else{let i=n.piece,r={line:i.start.line+1,column:0},s=i.length-1,a=this.getLineFeedCnt(i.bufferIndex,r,i.end);n.piece=new Ji(i.bufferIndex,r,i.end,a,s),va(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Me)return t(Me);let n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Me)return"";let t=this._buffers[e.piece.bufferIndex],n=e.piece,i=this.offsetInBuffer(n.bufferIndex,n.start),r=this.offsetInBuffer(n.bufferIndex,n.end);return t.buffer.substring(i,r)}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,i)}rbInsertRight(e,t){let n=new op(t,1);if(n.left=Me,n.right=Me,n.parent=Me,n.size_left=0,n.lf_left=0,this.root===Me)this.root=n,n.color=0;else if(e.right===Me)e.right=n,n.parent=e;else{let r=nC(e.right);r.left=n,n.parent=r}return VD(this,n),n}rbInsertLeft(e,t){let n=new op(t,1);if(n.left=Me,n.right=Me,n.parent=Me,n.size_left=0,n.lf_left=0,this.root===Me)this.root=n,n.color=0;else if(e.left===Me)e.left=n,n.parent=e;else{let i=PD(e.left);i.right=n,n.parent=i}return VD(this,n),n}getContentOfSubTree(e){let t="";return this.iterate(e,n=>(t+=this.getNodeContent(n),!0)),t}};var rp=class o extends B{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;constructor(e,t,n,i,r,s,a){super(),this._BOM=t,this._mightContainNonBasicASCII=!s,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._pieceTree=new rC(e,n,a)}equals(e){return!(e instanceof o)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t,i=this.getPositionAt(e),r=this.getPositionAt(n);return new L(i.lineNumber,i.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";let n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),i=this.getOffsetAt(e.endLineNumber,e.endColumn),r=0,s=this._getEndOfLine(t),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=e.endLineNumber-e.startLineNumber;r=l*d}return i-n+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0,i=e.startLineNumber,r=e.endLineNumber;for(let s=i;s<=r;s++){let a=this.getLineContent(s),l=s===i?e.startColumn-1:0,d=s===r?e.endColumn-1:a.length;for(let c=l;c<d;c++)qt(a.charCodeAt(c))?(n=n+1,c=c+1):n=n+1}return n+=this._getEndOfLine(t).length*(r-i),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=ln(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=_r(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let f=0;f<e.length;f++){let b=e[f];a&&b._isTracked&&(a=!1);let y=b.range;if(b.text){let M=!0;s||(M=!_g(b.text),s=M),!i&&M&&(i=nl(b.text)),!r&&M&&(r=Qv(b.text))}let C="",S=0,w=0,R=0;if(b.text){let M;[S,w,R,M]=qi(b.text);let N=this.getEOL(),A=N===`\r
`?2:1;M===0||M===A?C=b.text:C=b.text.replace(/\r\n|\r|\n/g,N)}l[f]={sortIndex:f,identifier:b.identifier||null,range:y,rangeOffset:this.getOffsetAt(y.startLineNumber,y.startColumn),rangeLength:this.getValueLengthInRange(y),text:C,eolCount:S,firstLineLength:w,lastLineLength:R,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(o._sortOpsAscending);let d=!1;for(let f=0,b=l.length-1;f<b;f++){let y=l[f].range.getEndPosition(),C=l[f+1].range.getStartPosition();if(C.isBeforeOrEqual(y)){if(C.isBefore(y))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=n||t?o._getInverseEditRanges(l):[],u=[];if(t)for(let f=0;f<l.length;f++){let b=l[f],y=c[f];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let C=y.startLineNumber;C<=y.endLineNumber;C++){let S="";C===y.startLineNumber&&(S=this.getLineContent(b.range.startLineNumber),ln(S)!==-1)||u.push({lineNumber:C,oldContent:S})}}let h=null;if(n){let f=0;h=[];for(let b=0;b<l.length;b++){let y=l[b],C=c[b],S=this.getValueInRange(y.range),w=y.rangeOffset+f;f+=y.text.length-S.length,h[b]={sortIndex:y.sortIndex,identifier:y.identifier,range:C,text:S,textChange:new er(y.rangeOffset,S,w,y.text)}}d||h.sort((b,y)=>b.sortIndex-y.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=s;let m=this._doApplyEdits(l),g=null;if(t&&u.length>0){u.sort((f,b)=>b.lineNumber-f.lineNumber),g=[];for(let f=0,b=u.length;f<b;f++){let y=u[f].lineNumber;if(f>0&&u[f-1].lineNumber===y)continue;let C=u[f].oldContent,S=this.getLineContent(y);S.length===0||S===C||ln(S)!==-1||g.push(y)}}return this._onDidChangeContent.fire(),new II(h,m,g)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,n=e[0].range,i=e[e.length-1].range,r=new L(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn),s=n.startLineNumber,a=n.startColumn,l=[];for(let m=0,g=e.length;m<g;m++){let f=e[m],b=f.range;t=t||f.forceMoveMarkers,l.push(this.getValueInRange(new L(s,a,b.startLineNumber,b.startColumn))),f.text.length>0&&l.push(f.text),s=b.endLineNumber,a=b.endColumn}let d=l.join(""),[c,u,h]=qi(d);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:d,eolCount:c,firstLineLength:u,lastLineLength:h,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(o._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n],r=i.range.startLineNumber,s=i.range.startColumn,a=i.range.endLineNumber,l=i.range.endColumn;if(r===a&&s===l&&i.text.length===0)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);let d=new L(r,s,a,l);t.push({range:d,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let n=e.startLineNumber,i=e.startColumn,[r,s,a]=qi(t),l;if(t.length>0){let d=r+1;d===1?l=new L(n,i,n,i+s):l=new L(n,i,n+d-1,a+1)}else l=new L(n,i,n,i);return l}static _getInverseEditRanges(e){let t=[],n=0,i=0,r=null;for(let s=0,a=e.length;s<a;s++){let l=e[s],d,c;r?r.range.endLineNumber===l.range.startLineNumber?(d=n,c=i+(l.range.startColumn-r.range.endColumn)):(d=n+(l.range.startLineNumber-r.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let u;if(l.text.length>0){let h=l.eolCount+1;h===1?u=new L(d,c,d,c+l.firstLineLength):u=new L(d,c,d+h-1,l.lastLineLength+1)}else u=new L(d,c,d,c);n=u.endLineNumber,i=u.endColumn,t.push(u),r=l}return t}static _sortOpsAscending(e,t){let n=L.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=L.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}};var KD=class{constructor(e,t,n,i,r,s,a,l,d){this._chunks=e;this._bom=t;this._cr=n;this._lf=i;this._crlf=r;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(e){let t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,s=n.length;r<s;r++){let a=n[r].buffer.replace(/\r\n|\r|\n/g,t),l=ya(a);n[r]=new Ia(a,l)}let i=new rp(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},sp=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&kN(e)&&(this.BOM=RN,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=UF(this._tmpLineStarts,e);this.chunks.push(new Ia(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=nl(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Qv(e)))}finish(e=!0){return this._finish(),new KD(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=ya(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}};var zF=new class{clone(){return this}equals(o){return this===o}};function GD(o,e){let t=new Uint32Array(2);return t[0]=0,t[1]=(o<<0|0|0|32768|2<<24)>>>0,new Ky(t,e===null?zF:e)}var sC=class{constructor(e){this._default=e}_store=[];get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,n){if(e>=this._store.length)return;if(t===0){this.insert(e,n);return}else if(n===0){this.delete(e,t);return}let i=this._store.slice(0,e),r=this._store.slice(e+t),s=VU(n,this._default);this._store=i.concat(s,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;let n=[];for(let i=0;i<t;i++)n[i]=this._default;this._store=js(this._store,e,n)}};function VU(o,e){let t=[];for(let n=0;n<o;n++)t[n]=e;return t}var qc=class{static deserialize(e){let t=0,n=ii(e,t);t+=4;let i=[];for(let r=0;r<n;r++)t=rf.deserialize(e,t,i);return i}_tokens;constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let n=this._tokens[this._tokens.length-1];if(n.endLineNumber+1===e){n.appendLineTokens(t);return}}this._tokens.push(new rf(e,[t]))}finalize(){return this._tokens}serialize(){let e=this._serializeSize(),t=new Uint8Array(e);return this._serialize(t),t}_serializeSize(){let e=0;e+=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;oi(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++)t=this._tokens[n].serialize(e,t)}};var jD=class{constructor(e,t){this.tokenizationSupport=t;this.store=new lp(e)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},aC=class extends jD{constructor(t,n,i,r){super(t,n);this._textModel=i;this._languageIdCodec=r}updateTokensUntilLine(t,n){let i=this._textModel.getLanguageId();for(;;){let r=this.getFirstInvalidLine();if(!r||r.lineNumber>n)break;let s=this._textModel.getLineContent(r.lineNumber),a=ap(this._languageIdCodec,i,this.tokenizationSupport,s,!0,r.startState);t.add(r.lineNumber,a.tokens),this.store.setEndState(r.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(t,n){let i=this.getStartState(t.lineNumber);if(!i)return 0;let r=this._textModel.getLanguageId(),s=this._textModel.getLineContent(t.lineNumber),a=s.substring(0,t.column-1)+n+s.substring(t.column-1),l=ap(this._languageIdCodec,r,this.tokenizationSupport,a,!0,i),d=new yn(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(t.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(t,n){let i=this.getStartState(t);if(!i)return{mainLineTokens:null,additionalLines:null};let r=this._textModel.getLineContent(t),s=n.lineEdit.apply(r),a=this._textModel.getLanguageIdAtPosition(t,0),l=ap(this._languageIdCodec,a,this.tokenizationSupport,s,!0,i),d=null;if(n.additionalLines){d=[];let u=l.endState;for(let h of n.additionalLines){let m=ap(this._languageIdCodec,a,this.tokenizationSupport,h,!0,u);d.push(new yn(m.tokens,h,this._languageIdCodec)),u=m.endState}}return{mainLineTokens:new yn(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n}isCheapToTokenize(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n||t===n&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,n,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,i),{heuristicTokens:!1};let r=this.guessStartState(n),s=this._textModel.getLanguageId();for(let a=n;a<=i;a++){let l=this._textModel.getLineContent(a),d=ap(this._languageIdCodec,s,this.tokenizationSupport,l,!0,r);t.add(a,d.tokens),r=d.endState}return{heuristicTokens:!0}}guessStartState(t){let n=this._textModel.getLineFirstNonWhitespaceColumn(t),i=[],r=null;for(let l=t-1;n>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<n&&(i.push(this._textModel.getLineContent(l)),n=d,r=this.getStartState(l),r))break}r||(r=this.tokenizationSupport.getInitialState()),i.reverse();let s=this._textModel.getLanguageId(),a=r;for(let l of i)a=ap(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},lp=class{constructor(e){this.lineCount=e;this._invalidEndStatesLineNumbers.addRange(new Ht(1,e+1))}_tokenizationStateStore=new $D;_invalidEndStatesLineNumbers=new qD;getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new Te("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let n=this._tokenizationStateStore.setEndState(e,t);return n&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Ht(e+1,e+2)),n}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new Ht(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[n]=qi(t.text);this.acceptChange(new Yi(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new Ht(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;let n=this.getStartState(t,e);if(!n)throw new Te("Start state must be defined");return{lineNumber:t,startState:n}}},$D=class{_lineEndStates=new sC(null);getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let n=this._lineEndStates.get(e);return n&&n.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let n=e.length;t>0&&n>0&&(n--,t--),this._lineEndStates.replace(e.startLineNumber,n,t)}acceptChanges(e){for(let t of e){let[n]=qi(t.text);this.acceptChange(new Yi(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}},qD=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new Ht(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(n=>n.contains(e));if(t!==-1){let n=this._ranges[t];n.start===e?n.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new Ht(e+1,n.endExclusive):n.endExclusive===e+1?this._ranges[t]=new Ht(n.start,e):this._ranges.splice(t,1,new Ht(n.start,e),new Ht(e+1,n.endExclusive))}}addRange(e){Ht.addRange(e,this._ranges)}addRangeAndResize(e,t){let n=0;for(;!(n>=this._ranges.length||e.start<=this._ranges[n].endExclusive);)n++;let i=n;for(;!(i>=this._ranges.length||e.endExclusive<this._ranges[i].start);)i++;let r=t-e.length;for(let s=i;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(r);if(n===i){let s=new Ht(e.start,e.start+t);s.isEmpty||this._ranges.splice(n,0,s)}else{let s=Math.min(e.start,this._ranges[n].start),a=Math.max(e.endExclusive,this._ranges[i-1].endExclusive),l=new Ht(s,a+r);l.isEmpty?this._ranges.splice(n,i-n):this._ranges.splice(n,i-n,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}};function ap(o,e,t,n,i,r){let s=null;if(t)try{s=t.tokenizeEncoded(n,i,r.clone())}catch(a){Ne(a)}return s||(s=GD(o.encodeLanguageId(e),r)),yn.convertToEndOffset(s.tokens,n.length),s}var lC=class{constructor(e,t){this._tokenizerWithStateStore=e;this._backgroundTokenStore=t}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Id(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),n=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?Ev(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new qc,n=Ja.create(!1);do if(n.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Yi(e,t))}};var dC=class{_onDidChangeVisibleRanges=new T;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let e=new YD(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}},YD=class{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){let n=e.map(i=>new Yi(i.startLineNumber,i.endLineNumber+1));this.handleStateChange({visibleLineRanges:n,stabilized:t})}},cC=class extends B{constructor(t){super();this._refreshTokens=t}runner=this._register(new Yt(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){Lt(this._computedLineRanges,this._lineRanges,(t,n)=>t.equals(n))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},dp=class extends B{constructor(t,n,i){super();this._languageIdCodec=t;this._textModel=n;this.getLanguageId=i}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new T);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new T);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}};var KF=Z("treeSitterParserService");var Hf=class extends dp{constructor(t,n,i,r){super(n,i,r);this._treeSitterService=t;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let t=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==t)&&(this._lastLanguageId=t,this._tokenizationSupport=af.get(t))}getLineTokens(t){let n=this._textModel.getLineContent(t);if(this._tokenizationSupport){let i=this._tokenizationSupport.tokenizeEncoded(t,this._textModel);if(i)return new yn(i,n,this._languageIdCodec)}return yn.createEmpty(n,this._languageIdCodec)}resetTokenization(t=!0){t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(t){t.isFlush&&this.resetTokenization(!1)}forceTokenization(t){}hasAccurateTokensForLine(t){return!0}isCheapToTokenize(t){return!0}getTokenTypeIfInsertingCharacter(t,n,i){return 0}tokenizeLineWithEdit(t,n){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var Uf=class o{_lineTokens;_len;_languageIdCodec;constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),i!==null&&i!==ca)return new yn(ua(i),n,this._languageIdCodec);let r=new Uint32Array(2);return r[0]=n.length,r[1]=GF(this._languageIdCodec.encodeLanguageId(e)),new yn(r,n,this._languageIdCodec)}static _massageTokens(e,t,n){let i=n?ua(n):null;if(t===0){let r=!1;if(i&&i.length>1&&(r=tr.getLanguageId(i[1])!==e),!r)return ca}if(!i||i.length===0){let r=new Uint32Array(2);return r[0]=t,r[1]=GF(e),r.buffer}return i[i.length-2]=t,i.byteOffset===0&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=js(this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,r){let s=o._massageTokens(this._languageIdCodec.encodeLanguageId(e),n,i);this._ensureLine(t);let a=this._lineTokens[t];return this._lineTokens[t]=s,r?!o._equals(a,s):!1}static _equals(e,t){if(!e||!t)return!e&&!t;let n=ua(e),i=ua(t);if(n.length!==i.length)return!1;for(let r=0,s=n.length;r<s;r++)if(n[r]!==i[r])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new V(e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){let t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=ri.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=ri.deleteEnding(this._lineTokens[t],e.startColumn-1);let n=e.endLineNumber-1,i=null;n<this._len&&(i=ri.deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=ri.append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-1;if(!(i>=this._len)){if(t===0){this._lineTokens[i]=ri.insert(this._lineTokens[i],e.column-1,n);return}this._lineTokens[i]=ri.deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=ri.insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&n.push({fromLineNumber:a,toLineNumber:l})}return{changes:n}}};function GF(o){return(o<<0|0|0|32768|2<<24|1024)>>>0}var uC=class o{_pieces;_isComplete;_languageIdCodec;constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){let r=t[0].getRange(),s=t[t.length-1].getRange();if(!r||!s)return e;n=e.plusRange(r).plusRange(s)}let i=null;for(let r=0,s=this._pieces.length;r<s;r++){let a=this._pieces[r];if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};break}if(a.removeTokens(n),a.isEmpty()){this._pieces.splice(r,1),r--,s--;continue}if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};continue}let[l,d]=a.split(n);if(l.isEmpty()){i=i||{index:r};continue}d.isEmpty()||(this._pieces.splice(r,1,l,d),r++,s++,i=i||{index:r})}return i=i||{index:this._pieces.length},t.length>0&&(this._pieces=js(this._pieces,i.index,t)),n}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;let n=this._pieces;if(n.length===0)return t;let i=o._findFirstPieceWithLine(n,e),r=n[i].getLineTokens(e);if(!r)return t;let s=t.getCount(),a=r.getCount(),l=0,d=[],c=0,u=0,h=(m,g)=>{m!==u&&(u=m,d[c++]=m,d[c++]=g)};for(let m=0;m<a;m++){let g=r.getStartCharacter(m),f=r.getEndCharacter(m),b=r.getMetadata(m),y=((b&1?2048:0)|(b&2?4096:0)|(b&4?8192:0)|(b&8?16384:0)|(b&16?16744448:0)|(b&32?4278190080:0))>>>0,C=~y>>>0;for(;l<s&&t.getEndOffset(l)<=g;)h(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<s&&t.getStartOffset(l)<g&&h(g,t.getMetadata(l));l<s&&t.getEndOffset(l)<f;)h(t.getEndOffset(l),t.getMetadata(l)&C|b&y),l++;if(l<s)h(f,t.getMetadata(l)&C|b&y),t.getEndOffset(l)===f&&l++;else{let S=Math.min(Math.max(0,l-1),s-1);h(f,t.getMetadata(S)&C|b&y)}}for(;l<s;)h(t.getEndOffset(l),t.getMetadata(l)),l++;return new yn(new Uint32Array(d),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;for(;n<i;){let r=n+Math.floor((i-n)/2);if(e[r].endLineNumber<t)n=r+1;else if(e[r].startLineNumber>t)i=r-1;else{for(;r>n&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return n}acceptEdit(e,t,n,i,r){for(let s of this._pieces)s.acceptEdit(e,t,n,i,r)}};var bl=class extends tp{constructor(t,n,i,r,s,a,l){super();this._textModel=t;this._bracketPairsTextModelPart=n;this._languageId=i;this._attachedViews=r;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(Y.filter(af.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new uC(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new T);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new T);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new T);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new oe);createGrammarTokens(){return this._register(new hC(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new Hf(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(t){let n=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=t?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),n&&this._tokens.resetTokenization()}createPreferredTokenProvider(){af.get(this._languageId)?this._tokens instanceof Hf||this.createTokens(!0):this._tokens instanceof hC||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(t){t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(let n of t.changes){let[i,r,s]=qi(n.text);this._semanticTokens.acceptEdit(n.range,i,r,s,n.text.length>0?n.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(t)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);let n=this._tokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,n)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new Te("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this._tokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this._tokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this._tokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this._tokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,n,i){return this._tokens.getTokenTypeIfInsertingCharacter(t,n,i)}tokenizeLineWithEdit(t,n){return this._tokens.tokenizeLineWithEdit(t,n)}setSemanticTokens(t,n){this._semanticTokens.set(t,n),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,n){if(this.hasCompleteSemanticTokens())return;let i=this._textModel.validateRange(this._semanticTokens.setPartial(t,n));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();let n=this._textModel.validatePosition(t),i=this._textModel.getLineContent(n.lineNumber),r=this.getLineTokens(n.lineNumber),s=r.findTokenIndexAtOffset(n.column-1),[a,l]=bl._findLanguageBoundaries(r,s),d=Zg(n.column,this.getLanguageConfiguration(r.getLanguageId(s)).getWordDefinition(),i.substring(a,l),a);if(d&&d.startColumn<=t.column&&t.column<=d.endColumn)return d;if(s>0&&a===n.column-1){let[c,u]=bl._findLanguageBoundaries(r,s-1),h=Zg(n.column,this.getLanguageConfiguration(r.getLanguageId(s-1)).getWordDefinition(),i.substring(c,u),c);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn)return h}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,n){let i=t.getLanguageId(n),r=0;for(let a=n;a>=0&&t.getLanguageId(a)===i;a--)r=t.getStartOffset(a);let s=t.getLineContent().length;for(let a=n,l=t.getCount();a<l&&t.getLanguageId(a)===i;a++)s=t.getEndOffset(a);return[r,s]}getWordUntilPosition(t){let n=this.getWordAtPosition(t);return n?{word:n.word.substr(0,t.column-n.startColumn),startColumn:n.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,n){let i=this._textModel.validatePosition(new V(t,n)),r=this.getLineTokens(i.lineNumber);return r.getLanguageId(r.findTokenIndexAtOffset(i.column-1))}setLanguageId(t,n="api"){if(this._languageId===t)return;let i={oldLanguage:this._languageId,newLanguage:t,source:n};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};bl=k([E(4,ho),E(5,Rr),E(6,KF)],bl);var hC=class extends dp{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new rn);_tokens=new Uf(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new rn);_attachedViewStates=this._register(new Sr);constructor(e,t,n,i){super(e,t,n),this._register(ir.onDidChange(r=>{let s=this.getLanguageId();r.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(i.onDidChangeVisibleRanges(({view:r,state:s})=>{if(s){let a=this._attachedViewStates.get(r);a||(a=new cC(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(r)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new lp(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let r=ir.get(this.getLanguageId());if(!r)return[null,null];let s;try{s=r.getInitialState()}catch(a){return Ne(a),[null,null]}return[r,s]},[n,i]=t();if(n&&i?this._tokenizer=new aC(this._textModel.getLineCount(),n,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let r={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};n&&n.createBackgroundTokenizer&&!n.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,r)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new lC(this._tokenizer,r),this._defaultBackgroundTokenizer.handleChanges()),n?.backgroundTokenizerShouldOnlyVerifyTokens&&n.createBackgroundTokenizer?(this._debugBackgroundTokens=new Uf(this._languageIdCodec),this._debugBackgroundStates=new lp(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(let t of e.changes){let[n,i]=qi(t.text);this._tokens.acceptEdit(t.range,n,i),this._debugBackgroundTokens?.acceptEdit(t.range,n,i)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){let{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){let e=Yi.joinMany([...this._attachedViewStates].map(([t,n])=>n.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(let t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);let n=new qc,{heuristicTokens:i}=this._tokenizer.tokenizeHeuristically(n,e,t),r=this.setTokens(n.finalize());if(i)for(let s of r.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){let t=new qc;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){let t=this._textModel.getLineContent(e),n=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){let i=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!n.equals(i)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return n}getTokenTypeIfInsertingCharacter(e,t,n){if(!this._tokenizer)return 0;let i=this._textModel.validatePosition(new V(e,t));return this.forceTokenization(i.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLineWithEdit(e,t)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function Kf(o){let e=new sp;return e.acceptChunk(o),e.finish()}function YF(o){return new Promise((e,t)=>{let n=new sp,i=!1;bL(o,{onData:r=>{n.acceptChunk(typeof r=="string"?r:r.toString())},onError:r=>{i||(i=!0,t(r))},onEnd:()=>{i||(i=!0,e(n.finish()))}})})}function WU(o){let e=new sp,t;for(;typeof(t=o.read())=="string";)e.acceptChunk(t);return e.finish()}function jF(o,e){let t;return typeof o=="string"?t=Kf(o):oO(o)?t=WU(o):t=o,t.create(e)}var pC=0,HU=999,UU=1e4,XD=class{_source;_eos;constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;do{let i=this._source.read();if(i===null)return this._eos=!0,t===0?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=64*1024)return e.join("")}while(!0)}},zf=()=>{throw new Error("Invalid change accessor")};var Sa=class extends B{constructor(t,n,i,r=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;pC++,this.id="$model"+pC,this.isForSimpleWidget=i.isForSimpleWidget,typeof r>"u"||r===null?this._associatedResource=ne.parse("inmemory://model/"+pC):this._associatedResource=r,this._attachedEditorCount=0;let{textBuffer:c,disposable:u}=jF(t,i.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=Sa.resolveOptions(this._buffer,i);let h=typeof n=="string"?n:n.languageId;typeof n!="string"&&(this._languageSelectionListener.value=n.onDidChange(()=>this._setLanguage(n.languageId))),this._bracketPairs=this._register(new LI(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new tC(this,this._languageConfigurationService)),this._decorationProvider=this._register(new XI(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(bl,this,this._bracketPairs,h,this._attachedViews);let m=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new L(1,1,m,this._buffer.getLineLength(m)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=g>Sa.LARGE_FILE_SIZE_THRESHOLD||m>Sa.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>Sa.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=g>Sa._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=Jv(pC),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new gC,this._commandManager=new eC(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(h),this._register(this._languageConfigurationService.onDidChange(f=>{this._bracketPairs.handleLanguageConfigurationServiceChange(f),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(f)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:sa.tabSize,indentSize:sa.indentSize,insertSpaces:sa.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:sa.trimAutoWhitespace,largeFileOptimizations:sa.largeFileOptimizations,bracketPairColorizationOptions:sa.bracketPairColorizationOptions};static resolveOptions(t,n){if(n.detectIndentation){let i=ND(t,n.tabSize,n.insertSpaces);return new Bh({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:n.trimAutoWhitespace,defaultEOL:n.defaultEOL,bracketPairColorizationOptions:n.bracketPairColorizationOptions})}return new Bh(n)}_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new t1(t=>this.handleBeforeFireDecorationsChangedEvent(t)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new T);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new T);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new T);_eventEmitter=this._register(new n1);onDidChangeContent(t){return this._eventEmitter.slowEvent(n=>t(n.contentChangedEvent))}onDidChangeContentOrInjectedText(t){return Zo(this._eventEmitter.fastEvent(n=>t(n)),this._onDidChangeInjectedText.event(n=>t(n)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new rn);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new dC;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let t=new rp([],"",`
`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=B.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new Te("Model is disposed!")}equalsTextBuffer(t){return this._assertNotDisposed(),this._buffer.equals(t)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(t,n){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(n),this._bracketPairs.handleDidChangeContent(n),this._eventEmitter.fire(new wd(t,n)))}setValue(t){if(this._assertNotDisposed(),t==null)throw as();let{textBuffer:n,disposable:i}=jF(t,this._options.defaultEOL);this._setValueFromTextBuffer(n,i)}_createContentChanged2(t,n,i,r,s,a,l,d){return{changes:[{range:t,rangeOffset:n,rangeLength:i,text:r}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(t,n){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=n,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new gC,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new Wc([new hI],this._versionId,!1,!1),this._createContentChanged2(new L(1,1,s,a),0,r,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();let n=t===1?`\r
`:`
`;if(this._buffer.getEOL()===n)return;let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(n),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new Wc([new gI],this._versionId,!1,!1),this._createContentChanged2(new L(1,1,s,a),0,r,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let t=this.getVersionId(),n=this._decorationsTree.collectNodesPostOrder();for(let i=0,r=n.length;i<r;i++){let s=n[i],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=t,s.start=d-l,s.end=c-l,pl(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,n=0,i=this._buffer.getLineCount();for(let r=1;r<=i;r++){let s=this._buffer.getLineLength(r);s>=UU?n+=s:t+=s}return n>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();let n=typeof t.tabSize<"u"?t.tabSize:this._options.tabSize,i=typeof t.indentSize<"u"?t.indentSize:this._options.originalIndentSize,r=typeof t.insertSpaces<"u"?t.insertSpaces:this._options.insertSpaces,s=typeof t.trimAutoWhitespace<"u"?t.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof t.bracketColorizationOptions<"u"?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new Bh({tabSize:n,indentSize:i,insertSpaces:r,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(t,n){this._assertNotDisposed();let i=ND(this._buffer,n,t);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),xI(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){let n=this.findMatches(X_.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,n.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();let n=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(n.lineNumber,n.column)}getPositionAt(t){this._assertNotDisposed();let n=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(n)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,n=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Te("Operation would exceed heap memory limits");let i=this.getFullModelRange(),r=this.getValueInRange(i,t);return n?this._buffer.getBOM()+r:r}createSnapshot(t=!1){return new XD(this._buffer.createSnapshot(t))}getValueLength(t,n=!1){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i,t);return n?this._buffer.getBOM().length+r:r}getValueInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),n)}getValueLengthInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),n)}getCharacterCountInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),n)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Te("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Te("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Te("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Te("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Te("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Te("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){let n=this._buffer.getLineCount(),i=t.startLineNumber,r=t.startColumn,s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=Math.floor(typeof r=="number"&&!isNaN(r)?r:1);if(s<1)s=1,a=1;else if(s>n)s=n,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let h=this.getLineMaxColumn(s);a>=h&&(a=h)}let l=t.endLineNumber,d=t.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),u=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,u=1;else if(c>n)c=n,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{let h=this.getLineMaxColumn(c);u>=h&&(u=h)}return i===s&&r===a&&l===c&&d===u&&t instanceof L&&!(t instanceof Ue)?t:new L(s,a,c,u)}_isValidPosition(t,n,i){if(typeof t!="number"||typeof n!="number"||isNaN(t)||isNaN(n)||t<1||n<1||(t|0)!==t||(n|0)!==n)return!1;let r=this._buffer.getLineCount();if(t>r)return!1;if(n===1)return!0;let s=this.getLineMaxColumn(t);if(n>s)return!1;if(i===1){let a=this._buffer.getLineCharCode(t,n-2);if(qt(a))return!1}return!0}_validatePosition(t,n,i){let r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=this._buffer.getLineCount();if(r<1)return new V(1,1);if(r>a)return new V(a,this.getLineMaxColumn(a));if(s<=1)return new V(r,1);let l=this.getLineMaxColumn(r);if(s>=l)return new V(r,l);if(i===1){let d=this._buffer.getLineCharCode(r,s-2);if(qt(d))return new V(r,s-1)}return new V(r,s)}validatePosition(t){let n=1;return this._assertNotDisposed(),t instanceof V&&this._isValidPosition(t.lineNumber,t.column,n)?t:this._validatePosition(t.lineNumber,t.column,n)}_isValidRange(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn;if(!this._isValidPosition(i,r,0)||!this._isValidPosition(s,a,0))return!1;if(n===1){let l=r>1?this._buffer.getLineCharCode(i,r-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=qt(l),u=qt(d);return!c&&!u}return!0}validateRange(t){let n=1;if(this._assertNotDisposed(),t instanceof L&&!(t instanceof Ue)&&this._isValidRange(t,n))return t;let i=this._validatePosition(t.startLineNumber,t.startColumn,0),r=this._validatePosition(t.endLineNumber,t.endColumn,0),s=i.lineNumber,a=i.column,l=r.lineNumber,d=r.column;if(n===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,u=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,h=qt(c),m=qt(u);return!h&&!m?new L(s,a,l,d):s===l&&a===d?new L(s,a-1,l,d-1):h&&m?new L(s,a-1,l,d+1):h?new L(s,a-1,l,d):new L(s,a,l,d+1)}return new L(s,a,l,d)}modifyPosition(t,n){this._assertNotDisposed();let i=this.getOffsetAt(t)+n;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();let t=this.getLineCount();return new L(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,n,i,r){return this._buffer.findMatchesLineByLine(t,n,i,r)}findMatches(t,n,i,r,s,a,l=HU){this._assertNotDisposed();let d=null;n!==null&&(Array.isArray(n)||(n=[n]),n.every(h=>L.isIRange(h))&&(d=n.map(h=>this.validateRange(h)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((h,m)=>h.startLineNumber-m.startLineNumber||h.startColumn-m.startColumn);let c=[];c.push(d.reduce((h,m)=>L.areIntersecting(h,m)?h.plusRange(m):(c.push(h),m)));let u;if(!i&&t.indexOf(`
`)<0){let m=new gl(t,i,r,s).parseSearchRequest();if(!m)return[];u=g=>this.findMatchesLineByLine(g,m,a,l)}else u=h=>jc.findMatches(this,new gl(t,i,r,s),h,a,l);return c.map(u).reduce((h,m)=>h.concat(m),[])}findNextMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);if(!i&&t.indexOf(`
`)<0){let c=new gl(t,i,r,s).parseSearchRequest();if(!c)return null;let u=this.getLineCount(),h=new L(l.lineNumber,l.column,u,this.getLineMaxColumn(u)),m=this.findMatchesLineByLine(h,c,a,1);return jc.findNextMatch(this,new gl(t,i,r,s),l,a),m.length>0||(h=new L(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),m=this.findMatchesLineByLine(h,c,a,1),m.length>0)?m[0]:null}return jc.findNextMatch(this,new gl(t,i,r,s),l,a)}findPreviousMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);return jc.findPreviousMatch(this,new gl(t,i,r,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`
`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof Vh?t:new Vh(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){let n=[];for(let i=0,r=t.length;i<r;i++)n[i]=this._validateEditOperation(t[i]);return n}pushEditOperations(t,n,i,r){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(n),i,r)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,n,i,r){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=n.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(t)for(let l=0,d=t.length;l<d;l++){let c=t[l],u=!1;for(let h=0,m=s.length;h<m;h++){let g=s[h].range,f=g.startLineNumber>c.endLineNumber,b=c.startLineNumber>g.endLineNumber;if(!f&&!b){u=!0;break}}if(!u){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],u=this.getLineMaxColumn(c),h=!0;for(let m=0,g=s.length;m<g;m++){let f=s[m].range,b=s[m].text;if(!(c<f.startLineNumber||c>f.endLineNumber)&&!(c===f.startLineNumber&&f.startColumn===u&&f.isEmpty()&&b&&b.length>0&&b.charAt(0)===`
`)&&!(c===f.startLineNumber&&f.startColumn===1&&f.isEmpty()&&b&&b.length>0&&b.charAt(b.length-1)===`
`)){h=!1;break}}if(h){let m=new L(c,1,c,u);n.push(new Vh(null,m,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,n,i,r)}_applyUndo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new L(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,n,!0,!1,i,r)}_applyRedo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new L(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,n,!1,!0,i,r)}_applyUndoRedoEdits(t,n,i,r,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=r,this.applyEdits(t,!1),this.setEOL(n),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,n=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let i=this._validateEditOperations(t);return this._doApplyEdits(i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,n){let i=this._buffer.getLineCount(),r=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,n),s=this._buffer.getLineCount(),a=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,u=a.length;c<u;c++){let h=a[c];this._decorationsTree.acceptReplace(h.rangeOffset,h.rangeLength,h.text.length,h.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=i;for(let c=0,u=a.length;c<u;c++){let h=a[c],[m]=qi(h.text);this._onDidChangeDecorations.fire();let g=h.range.startLineNumber,f=h.range.endLineNumber,b=f-g,y=m,C=Math.min(b,y),S=y-b,w=s-d-S+g,R=w,M=w+y,N=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new V(R,1)),this.getOffsetAt(new V(M,this.getLineMaxColumn(M))),0),A=ko.fromDecorations(N),P=new Li(A);for(let K=C;K>=0;K--){let j=g+K,X=w+K;P.takeFromEndWhile(ye=>ye.lineNumber>X);let le=P.takeFromEndWhile(ye=>ye.lineNumber===X);l.push(new vf(j,this.getLineContent(X),le))}if(C<b){let K=g+C;l.push(new pI(K+1,f))}if(C<y){let K=new Li(A),j=g+C,X=y-C,le=s-d-X+j+1,ye=[],q=[];for(let Q=0;Q<X;Q++){let ce=le+Q;q[Q]=this.getLineContent(ce),K.takeWhile(ie=>ie.lineNumber<ce),ye[Q]=K.takeWhile(ie=>ie.lineNumber===ce)}l.push(new mI(j+1,g+y,q,ye))}d+=S}this._emitContentChangedEvent(new Wc(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;let i=Array.from(t).map(r=>new vf(r,this.getLineContent(r),this._getInjectedTextInLine(r)));this._onDidChangeInjectedText.fire(new Fh(i))}changeDecorations(t,n=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(n,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,n){let i={addDecoration:(s,a)=>this._deltaDecorationsImpl(t,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,qF(a))},removeDecoration:s=>{this._deltaDecorationsImpl(t,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(t,s,a)},r=null;try{r=n(i)}catch(s){Ne(s)}return i.addDecoration=zf,i.changeDecoration=zf,i.changeDecorationOptions=zf,i.removeDecoration=zf,i.deltaDecorations=zf,r}deltaDecorations(t,n,i=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&n.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Ne(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,t,n)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,n,i){let r=t?this._decorations[t]:null;if(!r)return n?this._deltaDecorationsImpl(0,[],[{range:n,options:$F[i]}],!0)[0]:null;if(!n)return this._decorationsTree.delete(r),delete this._decorations[r.id],null;let s=this._validateRangeRelaxedNoAllocations(n),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(r),r.reset(this.getVersionId(),a,l,s),r.setOptions($F[i]),this._decorationsTree.insert(r),r.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;let n=this._decorationsTree.collectNodesFromOwner(t);for(let i=0,r=n.length;i<r;i++){let s=n[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(t){let n=this._decorations[t];return n?n.options:null}getDecorationRange(t){let n=this._decorations[t];return n?this._decorationsTree.getNodeRange(this,n):null}getLineDecorations(t,n=0,i=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,n,i)}getLinesDecorations(t,n,i=0,r=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,t)),d=Math.min(a,Math.max(1,n)),c=this.getLineMaxColumn(d),u=new L(l,1,d,c),h=this._getDecorationsInRange(u,i,r,s);return y_(h,this._decorationProvider.getDecorationsInRange(u,i,r)),h}getDecorationsInRange(t,n=0,i=!1,r=!1,s=!1){let a=this.validateRange(t),l=this._getDecorationsInRange(a,n,i,s);return y_(l,this._decorationProvider.getDecorationsInRange(a,n,i,r)),l}getOverviewRulerDecorations(t=0,n=!1){return this._decorationsTree.getAll(this,t,n,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){let n=this._buffer.getOffsetAt(t,1),i=n+this._buffer.getLineLength(t),r=this._decorationsTree.getInjectedTextInInterval(this,n,i,0);return ko.fromDecorations(r).filter(s=>s.lineNumber===t)}getAllDecorations(t=0,n=!1){let i=this._decorationsTree.getAll(this,t,n,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(t,n)),i}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,n,i,r){let s=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),a=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,n,i,r)}getRangeAt(t,n){return this._buffer.getRangeAt(t,n-t)}_changeDecorationImpl(t,n){let i=this._decorations[t];if(!i)return;if(i.options.after){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let r=this._validateRangeRelaxedNoAllocations(n),s=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,a,r),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber)}_changeDecorationOptionsImpl(t,n){let i=this._decorations[t];if(!i)return;let r=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(n.overviewRuler&&n.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(n),i.options.after||n.after){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(i.options.before||n.before){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=r!==s,l=KU(n)!==mC(i);a||l?(this._decorationsTree.delete(i),i.setOptions(n),this._decorationsTree.insert(i)):i.setOptions(n)}_deltaDecorationsImpl(t,n,i,r=!1){let s=this.getVersionId(),a=n.length,l=0,d=i.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let u=new Array(d);for(;l<a||c<d;){let h=null;if(l<a){do h=this._decorations[n[l++]];while(!h&&l<a);if(h){if(h.options.after){let m=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.endLineNumber)}if(h.options.before){let m=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.startLineNumber)}this._decorationsTree.delete(h),r||this._onDidChangeDecorations.checkAffectedAndFire(h.options)}}if(c<d){if(!h){let C=++this._lastDecorationId,S=`${this._instanceId};${C}`;h=new Of(S,0,0),this._decorations[S]=h}let m=i[c],g=this._validateRangeRelaxedNoAllocations(m.range),f=qF(m.options),b=this._buffer.getOffsetAt(g.startLineNumber,g.startColumn),y=this._buffer.getOffsetAt(g.endLineNumber,g.endColumn);h.ownerId=t,h.reset(s,b,y,g),h.setOptions(f),h.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.endLineNumber),h.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.startLineNumber),r||this._onDidChangeDecorations.checkAffectedAndFire(f),this._decorationsTree.insert(h),u[c]=h.id,c++}else h&&delete this._decorations[h.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,n){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,n)):(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId,n)),this._setLanguage(t.languageId,n))}_setLanguage(t,n){this.tokenization.setLanguageId(t,n),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,n){return this.tokenization.getLanguageIdAtPosition(t,n)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,n){return t}getLineIndentColumn(t){return zU(this.getLineContent(t))+1}};Sa=k([E(4,vI),E(5,ho),E(6,Rr),E(7,nt)],Sa);function zU(o){let e=0;for(let t of o)if(t===" "||t==="	")e++;else break;return e}function ZD(o){return!!(o.options.overviewRuler&&o.options.overviewRuler.color)}function KU(o){return!!o.after||!!o.before}function mC(o){return!!o.options.after||!!o.options.before}var gC=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new ip,this._decorationsTree1=new ip,this._injectedTextDecorationsTree=new ip}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(let n of t)n.range===null&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,r,s){let a=e.getVersionId(),l=this._intervalSearch(t,n,i,r,a,s);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,n,i,r,s){let a=this._decorationsTree0.intervalSearch(e,t,n,i,r,s),l=this._decorationsTree1.intervalSearch(e,t,n,i,r,s),d=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,r,s);return a.concat(l).concat(d)}getInjectedTextInInterval(e,t,n,i){let r=e.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,r,!1);return this._ensureNodesHaveRanges(e,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){let n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n,!1);return this._ensureNodesHaveRanges(e,i).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAll(e,t,n,i,r){let s=e.getVersionId(),a=this._search(t,n,i,s,r);return this._ensureNodesHaveRanges(e,a)}_search(e,t,n,i,r){if(n)return this._decorationsTree1.search(e,t,i,r);{let s=this._decorationsTree0.search(e,t,i,r),a=this._decorationsTree1.search(e,t,i,r),l=this._injectedTextDecorationsTree.search(e,t,i,r);return s.concat(a).concat(l)}}collectNodesFromOwner(e){let t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){let e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){mC(e)?this._injectedTextDecorationsTree.insert(e):ZD(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){mC(e)?this._injectedTextDecorationsTree.delete(e):ZD(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){let n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){mC(e)?this._injectedTextDecorationsTree.resolveNode(e,t):ZD(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}};function Ca(o){return o.replace(/[^a-z0-9\-_]/gi," ")}var fC=class{color;darkColor;constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}},QD=class extends fC{position;_resolvedColor;constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:2}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}},JD=class{position;persistLane;constructor(e){this.position=e?.position??2,this.persistLane=e?.persistLane}},e1=class extends fC{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?W.fromHex(e):t.getColor(e.id)}},bC=class o{static from(e){return e instanceof o?e:new o(e)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}},Gt=class o{static EMPTY;static register(e){return new o(e)}static createDynamic(e){return new o(e)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?Ca(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?Ca(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new QD(e.overviewRuler):null,this.minimap=e.minimap?new e1(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new JD(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?Ca(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?Ca(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?Ca(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?LN(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?Ca(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?Ca(e.marginClassName):null,this.inlineClassName=e.inlineClassName?Ca(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?Ca(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?Ca(e.afterContentClassName):null,this.after=e.after?bC.from(e.after):null,this.before=e.before?bC.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}};Gt.EMPTY=Gt.register({description:"empty"});var $F=[Gt.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),Gt.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),Gt.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),Gt.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function qF(o){return o instanceof Gt?o:Gt.createDynamic(o)}var t1=class extends B{constructor(t){super();this.handleBeforeFire=t;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new T);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){this._affectsMinimap||=!!t.minimap?.position,this._affectsOverviewRuler||=!!t.overviewRuler?.color,this._affectsGlyphMargin||=!!t.glyphMarginClassName,this._affectsLineNumber||=!!t.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}},n1=class extends B{_fastEmitter=this._register(new T);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new T);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;let t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}};var Pd=Z("workingCopyService"),r1=class extends B{_onDidRegister=this._register(new T);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new T);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new T);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new so;mapWorkingCopyToListeners=this._register(new Sr);registerWorkingCopy(e){let t=this.mapResourceToWorkingCopies.get(e.resource);if(t?.has(e.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${e.resource.toString()} and type ${e.typeId}.`);this._workingCopies.add(e),t||(t=new Map,this.mapResourceToWorkingCopies.set(e.resource,t)),t.set(e.typeId,e);let n=new oe;return n.add(e.onDidChangeContent(()=>this._onDidChangeContent.fire(e))),n.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),n.add(e.onDidSave(i=>this._onDidSave.fire({workingCopy:e,...i}))),this.mapWorkingCopyToListeners.set(e,n),this._onDidRegister.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e),pe(()=>{this.unregisterWorkingCopy(e),this._onDidUnregister.fire(e)})}unregisterWorkingCopy(e){this._workingCopies.delete(e);let t=this.mapResourceToWorkingCopies.get(e.resource);t?.delete(e.typeId)&&t.size===0&&this.mapResourceToWorkingCopies.delete(e.resource),e.isDirty()&&this._onDidChangeDirty.fire(e),this.mapWorkingCopyToListeners.deleteAndDispose(e)}has(e){return ne.isUri(e)?this.mapResourceToWorkingCopies.has(e):this.mapResourceToWorkingCopies.get(e.resource)?.has(e.typeId)??!1}get(e){return this.mapResourceToWorkingCopies.get(e.resource)?.get(e.typeId)}getAll(e){let t=this.mapResourceToWorkingCopies.get(e);if(t)return Array.from(t.values())}get hasDirty(){for(let e of this._workingCopies)if(e.isDirty())return!0;return!1}get dirtyCount(){let e=0;for(let t of this._workingCopies)t.isDirty()&&e++;return e}get dirtyWorkingCopies(){return this.workingCopies.filter(e=>e.isDirty())}get modifiedCount(){let e=0;for(let t of this._workingCopies)t.isModified()&&e++;return e}get modifiedWorkingCopies(){return this.workingCopies.filter(e=>e.isModified())}isDirty(e,t){let n=this.mapResourceToWorkingCopies.get(e);if(n){if(typeof t=="string")return n.get(t)?.isDirty()??!1;for(let[,i]of n)if(i.isDirty())return!0}return!1}};Pn(Pd,r1,1);var Mr=Z("labelService");var Ao=Z("telemetryService"),gSe=Z("customEndpointTelemetryService");var ZF=Z("productService");var xa=Z("dialogService");var s1=Z("fileDialogService");var _s=class extends Gf{_onDidChangeDirty=this._register(new T);_onDidChangeLabel=this._register(new T);_onDidChangeCapabilities=this._register(new T);_onWillDispose=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(Pi(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:_n(this.resource,vl.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var ar=class extends _s{constructor(t,n,i,r,s){super();this.preferredName=t;this.preferredDescription=n;this.secondary=i;this.primary=r;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return ar.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(Y.once(Y.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let t=this.getPreferredName();return t||(this.hasIdenticalSides?this.primary.getName():p("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(t){let n=this.getPreferredDescription();return n||(this.hasIdenticalSides?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.preferredDescription}getTitle(t){let n;this.hasIdenticalSides?n=this.primary.getTitle(t)??this.getName():n=super.getTitle(t);let i=this.getPreferredTitle();return i&&(n=`${i} (${n})`),n}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,n){let i=await this.primary.save(t,n);return this.saveResultToEditor(i)}async saveAs(t,n){let i=await this.primary.saveAs(t,n);return this.saveResultToEditor(i)}saveResultToEditor(t){if(!t||!this.hasIdenticalSides)return t;if(this.primary.matches(t))return this;if(t instanceof _s)return new ar(this.preferredName,this.preferredDescription,t,t,this.editorService);if(!yl(t)&&!cp(t)&&!Fd(t)&&!Ea(t))return{primary:t,secondary:t,label:this.preferredName,description:this.preferredDescription}}revert(t,n){return this.primary.revert(t,n)}async rename(t,n){if(!this.hasIdenticalSides)return;let i=await this.primary.rename(t,n);if(i){if(Pi(i.editor))return{editor:new ar(this.preferredName,this.preferredDescription,i.editor,i.editor,this.editorService),options:{...i.options,viewState:vC(this,t,this.editorService)}};if(yC(i.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:i.editor,secondary:i.editor,options:{...i.options,viewState:vC(this,t,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){let n=this.primary.toUntyped(t),i=this.secondary.toUntyped(t);if(n&&i&&!yl(n)&&!yl(i)&&!cp(n)&&!cp(i)&&!Fd(n)&&!Fd(i)&&!Ea(n)&&!Ea(i)){let r={label:this.preferredName,description:this.preferredDescription,primary:n,secondary:i};return typeof t?.preserveViewState=="number"&&(r.options={viewState:vC(this,t.preserveViewState,this.editorService)}),r}}matches(t){return this===t?!0:l1(t)||yl(t)?!1:t instanceof ar?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):Fd(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};ar=k([E(4,st)],ar);var d1={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function $U(o){let e=o;return!!(e&&typeof e=="object"&&Array.isArray(e.editors)&&Array.isArray(e.mru))}var _a=class extends B{constructor(t,n,i){super();this.instantiationService=n;this.configurationService=i;$U(t)?this._id=this.deserialize(t):this._id=_a.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new T({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t&&!t.affectsConfiguration("workbench.editor.openPositioning")&&!t.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(t,n){let i=t===0?this.mru.slice(0):this.editors.slice(0);return n?.excludeSticky?t===0?i.filter(r=>!this.isSticky(r)):i.slice(this.sticky+1):i}getEditorByIndex(t){return this.editors[t]}get activeEditor(){return this.active}isActive(t){return this.matches(this.active,t)}get previewEditor(){return this.preview}openEditor(t,n){let i=n?.sticky||typeof n?.index=="number"&&this.isSticky(n.index),r=n?.pinned||n?.sticky,s=!!n?.transient,a=n?.active||!this.activeEditor||!r&&this.preview===this.activeEditor,l=this.findEditor(t,n);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),r&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),n&&typeof n.index=="number"&&this.moveEditor(d,n.index),i&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=t,c=this.indexOf(this.active),u;if(n&&typeof n.index=="number"?u=n.index:this.editorOpenPositioning===d1.FIRST?(u=0,!i&&this.isSticky(u)&&(u=this.sticky+1)):this.editorOpenPositioning===d1.LAST?u=this.editors.length:(this.editorOpenPositioning===d1.LEFT?c===0||!this.editors.length?u=0:u=c:u=c+1,!i&&this.isSticky(u)&&(u=this.sticky+1)),i&&(this.sticky++,this.isSticky(u)||(u=this.sticky)),(r||!this.preview)&&this.splice(u,!1,d),s&&this.doSetTransient(d,u,!0),!r){if(this.preview){let m=this.indexOf(this.preview);u>m&&u--,this.replaceEditor(this.preview,d,u,!a)}this.preview=d}this.registerEditorListeners(d);let h={kind:5,editor:d,editorIndex:u};return this._onDidModelChange.fire(h),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(t){let n=new oe;this.editorListeners.add(n),n.add(Y.once(t.onWillDispose)(()=>{let i=this.editors.indexOf(t);if(i>=0){let r={kind:15,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}})),n.add(t.onDidChangeDirty(()=>{let i={kind:14,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeLabel(()=>{let i={kind:9,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeCapabilities(()=>{let i={kind:10,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(this.onDidModelChange(i=>{i.kind===6&&i.editor?.matches(t)&&(Nt(n),this.editorListeners.delete(n))}))}replaceEditor(t,n,i,r=!0){let s=this.doCloseEditor(t,1,r);if(this.splice(i,!1,n),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(t,n=0,i=!0){let r=this.doCloseEditor(t,n,i);if(r){let s={kind:6,...r};return this._onDidModelChange.fire(s),r}}doCloseEditor(t,n,i){let r=this.indexOf(t);if(r===-1)return;let s=this.editors[r],a=this.isSticky(r),l=this.active===s;if(i&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:r===this.editors.length-1?d=this.editors[r-1]:d=this.editors[r+1];let c=this.selection.filter(u=>u!==s&&u!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(r,!0),{editor:s,sticky:a,editorIndex:r,context:n}}moveEditor(t,n){n>=this.editors.length?n=this.editors.length-1:n<0&&(n=0);let i=this.indexOf(t);if(i<0||n===i)return;let r=this.editors[i],s=this.sticky;this.isSticky(i)&&n>this.sticky?this.sticky--:!this.isSticky(i)&&n<=this.sticky&&this.sticky++,this.editors.splice(i,1),this.editors.splice(n,0,r);let a={kind:7,editor:r,oldEditorIndex:i,editorIndex:n};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:r,editorIndex:n};this._onDidModelChange.fire(l)}return r}setActive(t){let n;return t?n=this.setEditorActive(t):this.setGroupActive(),n}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doSetSelection(i,r,[]),i}get selectedEditors(){return this.editors.filter(t=>this.doIsSelected(t))}isSelected(t){let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.doIsSelected(n)}doIsSelected(t){return this.selection.includes(t)}setSelection(t,n){let i=this.findEditor(t);if(!i)return;let[r,s]=i,a=new Set;for(let l of n){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==r&&a.add(c)}this.doSetSelection(r,s,Array.from(a))}doSetSelection(t,n,i){let r=this.activeEditor,s=this.selection,a;t?a=[t,...i]:a=[],this.selection=a;let l=t&&typeof n=="number"&&r!==t;if(l){let d=this.indexOf(t,this.mru);this.mru.splice(d,1),this.mru.unshift(t);let c={kind:8,editor:t,editorIndex:n};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(t){this._onDidModelChange.fire({kind:1})}setLabel(t){this._onDidModelChange.fire({kind:2})}pin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doPin(i,r),i}doPin(t,n){if(this.isPinned(t))return;this.setTransient(t,!1),this.preview=null;let i={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(i)}unpin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnpin(i,r),i}doUnpin(t,n){if(!this.isPinned(t))return;let i=this.preview;this.preview=t;let r={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(r),i&&this.closeEditor(i,3)}isPinned(t){let n;return typeof t=="number"?n=this.editors[t]:n=t,!this.matches(this.preview,n)}stick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doStick(i,r),i}doStick(t,n){if(this.isSticky(n))return;this.pin(t);let i=this.sticky+1;this.moveEditor(t,i),this.sticky++;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}unstick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnstick(i,r),i}doUnstick(t,n){if(!this.isSticky(n))return;let i=this.sticky;this.moveEditor(t,i),this.sticky--;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}isSticky(t){if(this.sticky<0)return!1;let n;return typeof t=="number"?n=t:n=this.indexOf(t),n<0?!1:n<=this.sticky}setTransient(t,n){if(!n&&this.transient.size===0)return;let i=this.findEditor(t);if(!i)return;let[r,s]=i;return this.doSetTransient(r,s,n),r}doSetTransient(t,n,i){if(i){if(this.transient.has(t))return;this.transient.add(t)}else{if(!this.transient.has(t))return;this.transient.delete(t)}let r={kind:12,editor:t,editorIndex:n};this._onDidModelChange.fire(r)}isTransient(t){if(this.transient.size===0)return!1;let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.transient.has(n)}splice(t,n,i){let r=this.editors[t];if(n&&this.isSticky(t)&&this.sticky--,i?this.editors.splice(t,n?1:0,i):this.editors.splice(t,n?1:0),!n&&i)this.mru.length===0?this.mru.push(i):this.mru.splice(1,0,i);else{let s=this.indexOf(r,this.mru);n&&!i?this.mru.splice(s,1):n&&i&&this.mru.splice(s,1,i)}}indexOf(t,n=this.editors,i){let r=-1;if(!t)return r;for(let s=0;s<n.length;s++){let a=n[s];if(this.matches(a,t,i))if(i?.supportSideBySide&&a instanceof ar&&!(t instanceof ar))r=s;else{r=s;break}}return r}findEditor(t,n){let i=this.indexOf(t,this.editors,n);if(i!==-1)return[this.editors[i],i]}isFirst(t,n=this.editors){return this.matches(n[0],t)}isLast(t,n=this.editors){return this.matches(n[n.length-1],t)}contains(t,n){return this.indexOf(t,this.editors,n)!==-1}matches(t,n,i){if(!t||!n)return!1;if(i?.supportSideBySide&&t instanceof ar&&!(n instanceof ar))switch(i.supportSideBySide){case 4:if(this.matches(t.primary,n,i)||this.matches(t.secondary,n,i))return!0;break;case 3:if(this.matches(t.primary,n,i)&&this.matches(t.secondary,n,i))return!0;break}let r=t===n;return i?.strictEquals?r:r||t.matches(n)}get isLocked(){return this.locked}lock(t){this.isLocked!==t&&(this.locked=t,this._onDidModelChange.fire({kind:3}))}clone(){let t=this.instantiationService.createInstance(_a,void 0);t.editors=this.editors.slice(0),t.mru=this.mru.slice(0),t.preview=this.preview,t.selection=this.selection.slice(0),t.sticky=this.sticky;for(let n of t.editors)t.registerEditorListeners(n);return t}serialize(){let t=Je.as(wa.EditorFactory),n=[],i=[],r,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,u=t.getEditorSerializer(d);if(u){let h=u.canSerialize(d)?u.serialize(d):void 0;typeof h=="string"?(c=!0,i.push({id:d.typeId,value:h}),n.push(d),this.preview===d&&(r=n.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,n)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:i,mru:a,preview:r,sticky:s>=0?s:void 0}}deserialize(t){let n=Je.as(wa.EditorFactory);return typeof t.id=="number"?(this._id=t.id,_a.IDS=Math.max(t.id+1,_a.IDS)):this._id=_a.IDS++,t.locked&&(this.locked=!0),this.editors=vr(t.editors.map((i,r)=>{let s,a=n.getEditorSerializer(i.id);if(a){let l=a.deserialize(this.instantiationService,i.value);l instanceof _s&&(s=l,this.registerEditorListeners(s))}return!s&&typeof t.sticky=="number"&&r<=t.sticky&&t.sticky--,s})),this.mru=vr(t.mru.map(i=>this.editors[i])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof t.preview=="number"&&(this.preview=this.editors[t.preview]),typeof t.sticky=="number"&&(this.sticky=t.sticky),this._id}dispose(){Nt(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};_a=k([E(1,nt),E(2,rt)],_a);var jf={exports:{}};(function(){function e(r){let s=[];typeof r=="number"&&s.push("code/timeOrigin",r);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(r){performance.mark(r)},getMarks(){let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(r+a.startTime)});return s}};if(typeof process=="object"){let r=performance?.timeOrigin;return e(r)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function n(r){return r.MonacoPerformanceMarks||(r.MonacoPerformanceMarks=t()),r.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof jf=="object"&&typeof jf.exports=="object"?jf.exports=n(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=n(i))})();var Zn=jf.exports.mark,dEe=jf.exports.getMarks;function u1(o,e){return e&&(o.stack||o.stacktrace)?p("stackTrace.format","{0}: {1}",QF(o),XF(o.stack)||XF(o.stacktrace)):QF(o)}function XF(o){return Array.isArray(o)?o.join(`
`):o}function QF(o){return o.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${o.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof o.code=="string"&&typeof o.errno=="number"&&typeof o.syscall=="string"?p("nodeExceptionMessage","A system error occurred ({0})",o.message):o.message||p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function IC(o=null,e=!1){if(!o)return p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(o)){let t=vr(o),n=IC(t[0],e);return t.length>1?p("error.moreErrors","{0} ({1} errors in total)",n,t.length):n}if(sn(o))return o;if(o.detail){let t=o.detail;if(t.error)return u1(t.error,e);if(t.exception)return u1(t.exception,e)}return o.stack?u1(o,e):o.message?o.message:p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function h1(o){let e=o;return e instanceof Error&&Array.isArray(e.actions)}function Oo(o){return qf(o,0)}function qf(o,e){switch(typeof o){case"object":return o===null?Il(349,e):Array.isArray(o)?QU(o,e):JU(o,e);case"string":return m1(o,e);case"boolean":return XU(o,e);case"number":return Il(o,e);case"undefined":return Il(937,e);default:return Il(617,e)}}function Il(o,e){return(e<<5)-e+o|0}function XU(o,e){return Il(o?433:863,e)}function m1(o,e){e=Il(149417,e);for(let t=0,n=o.length;t<n;t++)e=Il(o.charCodeAt(t),e);return e}function QU(o,e){return e=Il(104579,e),o.reduce((t,n)=>qf(n,t),e)}function JU(o,e){return e=Il(181387,e),Object.keys(o).sort().reduce((t,n)=>(t=m1(n,t),qf(o[n],t)),e)}function p1(o,e,t=32){let n=t-e,i=~((1<<n)-1);return(o<<e|(i&o)>>>n)>>>0}function JF(o,e=0,t=o.byteLength,n=0){for(let i=0;i<t;i++)o[e+i]=n}function ez(o,e,t="0"){for(;o.length<e;)o=t+o;return o}function $f(o,e=32){return o instanceof ArrayBuffer?Array.from(new Uint8Array(o)).map(t=>t.toString(16).padStart(2,"0")).join(""):ez((o>>>0).toString(16),e/4)}var eB=class o{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let n=this._buff,i=this._buffLen,r=this._leftoverHighSurrogate,s,a;for(r!==0?(s=r,a=-1,r=0):(s=e.charCodeAt(0),a=0);;){let l=s;if(qt(s))if(a+1<t){let d=e.charCodeAt(a+1);sd(d)?(a++,l=Zv(s,d)):l=65533}else{r=s;break}else sd(s)&&(l=65533);if(i=this._push(n,i,l),a++,a<t)s=e.charCodeAt(a);else break}this._buffLen=i,this._leftoverHighSurrogate=r}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(n&1984)>>>6,e[t++]=128|(n&63)>>>0):n<65536?(e[t++]=224|(n&61440)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0):(e[t++]=240|(n&1835008)>>>18,e[t++]=128|(n&258048)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),$f(this._h0)+$f(this._h1)+$f(this._h2)+$f(this._h3)+$f(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,JF(this._buff,this._buffLen),this._buffLen>56&&(this._step(),JF(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=o._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,p1(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let n=this._h0,i=this._h1,r=this._h2,s=this._h3,a=this._h4,l,d,c;for(let u=0;u<80;u++)u<20?(l=i&r|~i&s,d=1518500249):u<40?(l=i^r^s,d=1859775393):u<60?(l=i&r|i&s|r&s,d=2400959708):(l=i^r^s,d=3395469782),c=p1(n,5)+l+a+d+e.getUint32(u*4,!1)&4294967295,a=s,s=r,r=p1(i,30),i=n,n=c;this._h0=this._h0+n&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};var Fn=Z("logService"),PEe=Z("loggerService");function CC(o){switch(o){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var FEe=new De("logLevel",CC(3));var Yc=Z("IUriIdentityService");function nB(o){let e=o;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&ne.isUri(e.location)&&ne.isUri(e.globalStorageHome)&&ne.isUri(e.settingsResource)&&ne.isUri(e.keybindingsResource)&&ne.isUri(e.tasksResource)&&ne.isUri(e.snippetsHome)&&ne.isUri(e.extensionsResource))}var iB=Z("IUserDataProfilesService");function SC(o,e,t,n,i,r){return{id:o,name:e,location:t,isDefault:!1,shortName:i?.shortName,icon:i?.icon,globalStorageHome:r&&i?.useDefaultFlags?.globalState?r.globalStorageHome:mt(t,"globalStorage"),settingsResource:r&&i?.useDefaultFlags?.settings?r.settingsResource:mt(t,"settings.json"),keybindingsResource:r&&i?.useDefaultFlags?.keybindings?r.keybindingsResource:mt(t,"keybindings.json"),tasksResource:r&&i?.useDefaultFlags?.tasks?r.tasksResource:mt(t,"tasks.json"),snippetsHome:r&&i?.useDefaultFlags?.snippets?r.snippetsHome:mt(t,"snippets"),extensionsResource:r&&i?.useDefaultFlags?.extensions?r.extensionsResource:mt(t,"extensions.json"),cacheHome:mt(n,o),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient}}var xC=class extends B{constructor(t,n,i,r){super();this.environmentService=t;this.fileService=n;this.uriIdentityService=i;this.logService=r;this.profilesHome=mt(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=mt(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new T);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new T);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new T);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new T);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new so,workspaces:new so,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(t){this.enabled!==t&&(this._profilesObject=void 0,this.enabled=t)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let t=this.createDefaultProfile(),n=[t];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!sn(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}n.push(SC(uo(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.logService.error(s)}let i=new so,r=new Map;if(n.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=ne.parse(a),c=n.find(u=>u.id===l);c&&i.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=n.find(c=>c.id===l);d&&r.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:n,workspaces:i,emptyWindows:r}}return this._profilesObject}createDefaultProfile(){let t=SC("__default__profile__",p("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){let n="Temp",i=new RegExp(`${Gi(n)}\\s(\\d+)`),r=0;for(let a of this.profiles){let l=i.exec(a.name),d=l?parseInt(l[1]):0;r=d>r?d:r}let s=`${n} ${r+1}`;return this.createProfile(Oo(Pc()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,n,i){return this.createProfile(Oo(Pc()).toString(16),t,n,i)}async createProfile(t,n,i,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(t,n,i);return r&&await this.setProfileForWorkspace(r,s),s}async doCreateProfile(t,n,i){if(!sn(n)||!n)throw new Error("Name of the profile is mandatory and must be of type `string`");let r=this.profileCreationPromises.get(n);return r||(r=(async()=>{try{if(this.profiles.find(d=>d.name===n||d.id===t))throw new Error(`Profile with ${n} name already exists`);let a=SC(t,n,mt(this.profilesHome,t),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await Lr.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(n)}})(),this.profileCreationPromises.set(n,r)),r}async updateProfile(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);return i=SC(i.id,n.name??i.name,i.location,this.profilesCacheHome,{shortName:n.shortName??i.shortName,icon:n.icon===null?void 0:n.icon??i.icon,transient:n.transient??i.isTransient,useDefaultFlags:n.useDefaultFlags??i.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[i]),i}async removeProfile(t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(t.isDefault)throw new Error("Cannot remove default profile");let n=this.profiles.find(r=>r.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);let i=[];this._onWillRemoveProfile.fire({profile:n,join(r){i.push(r)}});try{await Promise.allSettled(i)}catch(r){this.logService.error(r)}for(let r of[...this.profilesObject.emptyWindows.keys()])n.id===this.profilesObject.emptyWindows.get(r)?.id&&this.profilesObject.emptyWindows.delete(r);for(let r of[...this.profilesObject.workspaces.keys()])n.id===this.profilesObject.workspaces.get(r)?.id&&this.profilesObject.workspaces.delete(r);this.updateStoredProfileAssociations(),this.updateProfiles([],[n],[]);try{await this.fileService.del(n.cacheHome,{recursive:!0})}catch(r){sO(r)!==1&&this.logService.error(r)}}async setProfileForWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===n.id);if(!i)throw new Error(`Profile '${n.name}' does not exist`);this.updateWorkspaceAssociation(t,i)}unsetWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(t,void 0,n)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(n=>n.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,n.resource))).map(n=>this.fileService.del(n.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let t=this.transientProfilesObject.profiles.filter(n=>!this.isProfileAssociatedToWorkspace(n));await Promise.allSettled(t.map(n=>this.removeProfile(n)))}getProfileForWorkspace(t){let n=this.getWorkspace(t),i=ne.isUri(n)?this.profilesObject.workspaces.get(n):this.profilesObject.emptyWindows.get(n);return i||(uy(t)?this.transientProfilesObject.folders.get(t.uri):hy(t)?this.transientProfilesObject.workspaces.get(t.configPath):this.transientProfilesObject.emptyWindows.get(t.id))}getWorkspace(t){return uy(t)?t.uri:hy(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!([...this.profilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.profilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.folders.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location)))}updateProfiles(t,n,i){let r=[...this.profiles,...t],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of r){if(l.isDefault||n.some(c=>l.id===c.id))continue;l=i.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,u]of this.transientProfilesObject.emptyWindows.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,u]of this.transientProfilesObject.workspaces.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,u]of this.transientProfilesObject.folders.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(t,n,i)}triggerProfilesChanges(t,n,i){this._onDidChangeProfiles.fire({added:t,removed:n,updated:i,all:this.profiles})}updateWorkspaceAssociation(t,n,i){if(i=n?.isTransient?!0:i,i)uy(t)?(this.transientProfilesObject.folders.delete(t.uri),n&&this.transientProfilesObject.folders.set(t.uri,n)):hy(t)?(this.transientProfilesObject.workspaces.delete(t.configPath),n&&this.transientProfilesObject.workspaces.set(t.configPath,n)):(this.transientProfilesObject.emptyWindows.delete(t.id),n&&this.transientProfilesObject.emptyWindows.set(t.id,n));else{this.updateWorkspaceAssociation(t,void 0,!0);let r=this.getWorkspace(t);ne.isUri(r)?(this.profilesObject.workspaces.delete(r),n&&this.profilesObject.workspaces.set(r,n)):(this.profilesObject.emptyWindows.delete(r),n&&this.profilesObject.emptyWindows.set(r,n)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let t={};for(let[i,r]of this.profilesObject.workspaces.entries())t[i.toString()]=r.id;let n={};for(let[i,r]of this.profilesObject.emptyWindows.entries())n[i.toString()]=r.id;this.saveStoredProfileAssociations({workspaces:t,emptyWindows:n}),this._profilesObject=void 0}migrateStoredProfileAssociations(t){let n={},i=this.createDefaultProfile();if(t.workspaces)for(let[s,a]of Object.entries(t.workspaces)){let l=ne.parse(a);n[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}let r={};if(t.emptyWindows)for(let[s,a]of Object.entries(t.emptyWindows)){let l=ne.parse(a);r[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:n,emptyWindows:r}}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};xC=k([E(0,Ro),E(1,dn),E(2,Yc),E(3,Fn)],xC);var g1={WIDTH:400,WIDTH_WITH_VERTICAL_PANEL:600,HEIGHT:270};var up=Z("editorGroupsService");var st=Z("editorService");var f1=class{constructor(e,t,n){this.id=e;this.dependencies=t;this.callback=n}};var oB=class o{static INSTANCE=new o;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(e,t,n)=>{typeof e!="string"&&(n=t,t=e,e=null),(typeof t!="object"||!Array.isArray(t))&&(n=t,t=null),this._defineCalls.push(new f1(e,t,n))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){if(e.startsWith(window.location.origin)||e.startsWith(`${Ae.vscodeFileResource}://${uT}`))return e;throw new Error(`[trusted_script_src] Invalid script url: ${e}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){return e}}))}async load(e){if(this._initialize(),this._state===3)return new Promise(s=>{let a=Pc();console.log(`[amdX] Using external define("${a}", ["${e}"])`),globalThis.define(a,[e],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}let n={},i=[],r=[];if(Array.isArray(t.dependencies))for(let s of t.dependencies)s==="exports"?i.push(n):r.push(s);if(r.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${r.join(", ")}`);return typeof t.callback=="function"?t.callback(...i)??n:t.callback}_rendererLoadScript(e){return new Promise((t,n)=>{let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("type","text/javascript");let r=()=>{i.removeEventListener("load",s),i.removeEventListener("error",a)},s=l=>{r(),t(this._defineCalls.pop())},a=l=>{r(),n(l)};i.addEventListener("load",s),i.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),i.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(i)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{let t=(await import("fs")).default,n=(await import("vm")).default,i=(await import("module")).default,r=ne.parse(e).fsPath,s=t.readFileSync(r).toString(),a=i.wrap(s.replace(/^#!.*/,""));return new n.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};var v1="utf8";var YTe=512*8,ZTe=512*128;var b1={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},XTe=(()=>{let o={};for(let e in b1)b1[e].guessableName&&(o[e]=b1[e]);return o})();var Ts=class extends ma{constructor(t,n,i,r,s,a,l,d,c,u,h,m,g,f,b){super(l,a,f,b);this.resource=t;this.hasAssociatedFilePath=n;this.initialValue=i;this.preferredLanguageId=r;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=u;this.textFileService=h;this.labelService=m;this.editorService=g;this._register(this.workingCopyService.registerWorkingCopy(this)),r&&this.setLanguageId(r),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new T);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new T);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new T);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new T);onDidRevert=this._onDidRevert.event;typeId=cO;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(t=>this.onConfigurationChange(t,!0)))}onConfigurationChange(t,n){if(!t||t.affectsConfiguration(this.resource,"files.encoding")){let i=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==i&&typeof i=="string"&&(this.configuredEncoding=i,n&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!t||t.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let i=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==i&&(i==="content"||i==="name")&&(this.configuredLabelFormat=i,n&&this._onDidChangeName.fire())}}setLanguageId(t,n){let i=t===Ts.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:t;this.preferredLanguageId=i,i&&super.setLanguageId(i,n)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(t){let n=this.getEncoding();this.preferredEncoding=t,n!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(t){this.dirty!==t&&(this.dirty=t,this._onDidChangeDirty.fire())}async save(t){let n=await this.textFileService.save(this.resource,t);return n&&this._onDidSave.fire({reason:t?.reason,source:t?.source}),!!n}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(Kf(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(t){let n;return this.isResolved()?n=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:v1}):typeof this.initialValue=="string"&&(n=wA(vn.fromString(this.initialValue))),{content:n}}ignoreDirtyOnModelContentChange=!1;async resolve(){let t=!1,n=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let r,s=await this.workingCopyBackupService.resolve(this);s?(r=s.value,n=!0):r=_A(vn.fromString(this.initialValue||""));let a=await YF(await this.textFileService.getDecodedStream(this.resource,r,{encoding:v1}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),t=!0}let i=To(this.textEditorModel);return this.installModelListeners(i),t&&((n||this.initialValue)&&this.updateNameFromFirstLine(i),this.setDirty(this.hasAssociatedFilePath||!!n||!!this.initialValue),(n||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n))),this._register(t.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(t)}onModelContentChanged(t,n){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&t.getLineCount()===1&&t.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),n.changes.some(i=>(i.range.startLineNumber===1||i.range.endLineNumber===1)&&i.range.startColumn<=Ts.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(t),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(t){if(this.hasAssociatedFilePath)return;let n,i=t.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:Ts.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");i=i.substr(0,Xv(i,Ts.FIRST_LINE_NAME_MAX_LENGTH)[0]),i&&Yg().exec(i)&&(n=i),n!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=n,this._onDidChangeName.fire())}isReadonly(){return!1}};Ts=k([E(5,ho),E(6,kr),E(7,SI),E(8,Xi),E(9,Pd),E(10,Ta),E(11,Mr),E(12,st),E(13,Uh),E(14,Jo)],Ts);var nz=Z("untitledTextEditorService"),Zc=class extends B{constructor(t,n){super();this.instantiationService=t;this.configurationService=n}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new T);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new T);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new T);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new so;get(t){return this.mapResourceToModel.get(t)}getValue(t){return this.get(t)?.textEditorModel?.getValue()}async resolve(t){let n=this.doCreateOrGet(t);return await n.resolve(),n}create(t){return this.doCreateOrGet(t)}doCreateOrGet(t=Object.create(null)){let n=this.massageOptions(t);return n.untitledResource&&this.mapResourceToModel.has(n.untitledResource)?this.mapResourceToModel.get(n.untitledResource):this.doCreate(n)}massageOptions(t){let n=Object.create(null);if(t.associatedResource?(n.untitledResource=ne.from({scheme:Ae.untitled,authority:t.associatedResource.authority,fragment:t.associatedResource.fragment,path:t.associatedResource.path,query:t.associatedResource.query}),n.associatedResource=t.associatedResource):t.untitledResource?.scheme===Ae.untitled&&(n.untitledResource=t.untitledResource),t.languageId)n.languageId=t.languageId;else if(!n.associatedResource){let i=this.configurationService.getValue();i.files?.defaultLanguage&&(n.languageId=i.files.defaultLanguage)}return n.encoding=t.encoding,n.initialValue=t.initialValue,n}doCreate(t){let n=t.untitledResource;if(!n){let r=1;do n=ne.from({scheme:Ae.untitled,path:`Untitled-${r}`}),r++;while(this.mapResourceToModel.has(n))}let i=this._register(this.instantiationService.createInstance(Ts,n,!!t.associatedResource,t.initialValue,t.languageId,t.encoding));return this.registerModel(i),i}registerModel(t){let n=new oe;n.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),n.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire(t))),n.add(t.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(t))),n.add(t.onWillDispose(()=>this._onWillDispose.fire(t))),Y.once(t.onWillDispose)(()=>{this.mapResourceToModel.delete(t.resource),n.dispose()}),this.mapResourceToModel.set(t.resource,t),this._onDidCreate.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t)}isUntitledWithAssociatedResource(t){return t.scheme===Ae.untitled&&t.path.length>1&&!Zc.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(t.path)}canDispose(t){return t.isDisposed()?!0:this.doCanDispose(t)}async doCanDispose(t){return t.isDirty()?(await Y.toPromise(t.onDidChangeDirty),this.canDispose(t)):!0}};Zc=k([E(0,nt),E(1,rt)],Zc);Pn(nz,Zc,1);var EC=On,eo=Z("notificationService");var y1=Z("progressService");var yDe=Object.freeze({total(){},worked(){},done(){}}),sB=class{constructor(e){this.callback=e}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(e){this._value=e,this.callback(this._value)}};var wC=class extends B{deferred=new yd;reporter;lastStep;constructor(e,t){super(),t.withProgress(e,n=>(this.reporter=n,this.lastStep&&n.report(this.lastStep),this.deferred.p)),this._register(pe(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};wC=k([E(1,y1)],wC);var IDe=Z("editorProgressService");var hp=class extends B{constructor(t,n){super();this.logService=t;this.configurationService=n}participants=new ki;addFileOperationParticipant(t){let n=this.participants.push(t);return pe(()=>n())}async participate(t,n,i,r){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(t,n,i,s,r)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};hp=k([E(0,Fn),E(1,rt)],hp);var Po=class extends B{constructor(t,n,i,r){super();this.getExpression=t;this.shouldUpdate=n;this.contextService=i;this.configurationService=r;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new T);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{this.shouldUpdate(t)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(t){let n=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!Ai(c.expression,d.expression))&&(n=!0,this.mapFolderToParsedExpression.set(l,nf(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(n=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let i=new Rv(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==Po.NO_FOLDER&&(i.has(ne.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),n=!0));let r=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(Po.NO_FOLDER);r?(!s||!Ai(s.expression,r.expression))&&(n=!0,this.mapFolderToParsedExpression.set(Po.NO_FOLDER,nf(r.expression)),this.mapFolderToConfiguredExpression.set(Po.NO_FOLDER,r)):s&&(n=!0,this.mapFolderToParsedExpression.delete(Po.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(Po.NO_FOLDER)),t&&n&&this._onExpressionChange.fire()}doGetExpression(t){let n=this.getExpression(t);if(!n)return;let i=Object.keys(n);if(i.length===0)return;let r=!1,s=Object.create(null);for(let a of i){r||(r=dg(a));let l=a,d=jN(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=n[a]}return{expression:s,hasAbsolutePath:r}}matches(t,n){if(this.mapFolderToParsedExpression.size===0)return!1;let i=this.contextService.getWorkspaceFolder(t),r,s;if(i&&this.mapFolderToParsedExpression.has(i.uri.toString())?(r=this.mapFolderToParsedExpression.get(i.uri.toString()),s=this.mapFolderToConfiguredExpression.get(i.uri.toString())):(r=this.mapFolderToParsedExpression.get(Po.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(Po.NO_FOLDER)),!r)return!1;let a;return i?a=bh(i.uri,t):a=this.uriToPath(t),typeof a=="string"&&r(a,void 0,n)?!0:a!==this.uriToPath(t)&&s?.hasAbsolutePath?!!r(this.uriToPath(t),void 0,n):!1}uriToPath(t){return t.scheme===Ae.file?t.fsPath:t.path}};Po=k([E(2,pd),E(3,rt)],Po);var iz=new De("autoSaveAfterShortDelayContext",!1,!0);var La=Z("filesConfigurationService"),Fo=class extends B{constructor(t,n,i,r,s,a,l,d){super();this.contextKeyService=t;this.configurationService=n;this.contextService=i;this.environmentService=r;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=n.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||Wh.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=wo?Cs.AFTER_DELAY:Cs.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:p("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:p({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:p({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:p({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:p("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new T);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new T);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new T);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new T);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new Ri(1e3);autoSaveDisabledOverrides=new so;autoSaveAfterShortDelayContext=iz.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new ef(()=>this.createReadonlyMatcher(aO)));readonlyExcludeMatcher=this._register(new ef(()=>this.createReadonlyMatcher(lO)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new so(t=>this.uriIdentityService.extUri.getComparisonKey(t));createReadonlyMatcher(t){let n=this._register(new Po(i=>this.configurationService.getValue(t,{resource:i}),i=>i.affectsConfiguration(t),this.contextService,this.configurationService));return this._register(n.onExpressionChange(()=>this._onDidChangeReadonly.fire())),n}isReadonly(t,n){let i=this.fileService.getProvider(t.scheme);if(i&&rO(i))return i.readOnlyMessage??Fo.READONLY_MESSAGES.providerReadonly;let r=this.sessionReadonlyOverrides.get(t);return typeof r=="boolean"?r===!0?Fo.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(t,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(t,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(t)?this.readonlyExcludeMatcher.value.matches(t)?!1:Fo.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&n?.locked?Fo.READONLY_MESSAGES.fileLocked:n?.readonly?Fo.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(t,n){if(n==="toggle"){let i;try{i=await this.fileService.resolve(t,{resolveMetadata:!0})}catch{}n=!this.isReadonly(t,i)}n==="reset"?this.sessionReadonlyOverrides.delete(t):this.sessionReadonlyOverrides.set(t,n),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(t,n){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,t.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),n&&this._onDidChangeAutoSaveConfiguration.fire();let i=t?.files?.associations;Ai(this.currentFilesAssociationConfiguration,i)||(this.currentFilesAssociationConfiguration=i,n&&this._onDidChangeFilesAssociation.fire());let r=t?.files?.hotExit;r===Wh.OFF||r===Wh.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=r:this.currentHotExitConfiguration=Wh.ON_EXIT;let s=!!t?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,n&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(t){let n=this.toResource(t);if(n){let i=this.autoSaveConfigurationCache.get(n);return i||(i=this.computeAutoSaveConfiguration(n,this.textResourceConfigurationService.getValue(n,"files")),this.autoSaveConfigurationCache.set(n,i)),i}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(t,n){let i,r,s,a,l,d;switch(n?.autoSave??Fo.DEFAULT_AUTO_SAVE_MODE){case Cs.AFTER_DELAY:{i="afterDelay",r=typeof n?.autoSaveDelay=="number"&&n.autoSaveDelay>=0?n.autoSaveDelay:Fo.DEFAULT_AUTO_SAVE_DELAY,d=r<=Fo.DEFAULT_AUTO_SAVE_DELAY;break}case Cs.ON_FOCUS_CHANGE:i="onFocusChange";break;case Cs.ON_WINDOW_CHANGE:i="onWindowChange";break}return n?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,t&&!this.contextService.isInsideWorkspace(t)&&(l=!0,d=void 0)),n?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:i,autoSaveDelay:r,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(t){return t instanceof _s?vl.getOriginalUri(t,{supportSideBySide:1}):t}hasShortAutoSaveDelay(t){let n=this.toResource(t);return this.getAutoSaveConfiguration(n).isShortAutoSaveDelay?!n||!this.autoSaveDisabledOverrides.has(n):!1}getAutoSaveMode(t,n){let i=this.toResource(t);if(i&&this.autoSaveDisabledOverrides.has(i))return{mode:0,reason:4};let r=this.getAutoSaveConfiguration(i);if(typeof r.autoSave>"u")return{mode:0,reason:1};if(typeof n=="number"&&(r.autoSave==="afterDelay"&&n!==2||r.autoSave==="onFocusChange"&&n!==3&&n!==4||r.autoSave==="onWindowChange"&&n!==4))return{mode:0,reason:1};if(i){if(r.autoSaveWorkspaceFilesOnly&&r.isOutOfWorkspace)return{mode:0,reason:2};if(r.autoSaveWhenNoErrors&&this.markerService.read({resource:i,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(r.autoSave){case"afterDelay":return typeof r.autoSaveDelay=="number"&&r.autoSaveDelay<=Fo.DEFAULT_AUTO_SAVE_DELAY?{mode:r.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let t=this.configurationService.getValue("files.autoSave"),n;return[Cs.AFTER_DELAY,Cs.ON_FOCUS_CHANGE,Cs.ON_WINDOW_CHANGE].some(i=>i===t)?n=Cs.OFF:n=Cs.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",n)}disableAutoSave(t){let n=this.toResource(t);if(!n)return B.None;let i=this.autoSaveDisabledOverrides.get(n)??0;return this.autoSaveDisabledOverrides.set(n,i+1),i===0&&this._onDidChangeAutoSaveDisabled.fire(n),pe(()=>{let r=this.autoSaveDisabledOverrides.get(n)??0;r<=1?(this.autoSaveDisabledOverrides.delete(n),this._onDidChangeAutoSaveDisabled.fire(n)):this.autoSaveDisabledOverrides.set(n,r-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==Wh.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(t,n){return this.configurationService.getValue("files.saveConflictResolution",{resource:t,overrideIdentifier:n})!=="overwriteFileOnDisk"}};Fo=k([E(0,Qt),E(1,rt),E(2,pd),E(3,Ro),E(4,Yc),E(5,dn),E(6,KA),E(7,Xi)],Fo);Pn(La,Fo,0);var I1=Z("workingCopyEditorService"),Yf=class extends B{constructor(t){super();this.editorService=t}_onDidRegisterHandler=this._register(new T);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(t){return this.handlers.add(t),this._onDidRegisterHandler.fire(t),pe(()=>this.handlers.delete(t))}findEditor(t){for(let n of this.editorService.getEditors(0))if(this.isOpen(t,n.editor))return n}isOpen(t,n){for(let i of this.handlers)if(i.isOpen(t,n))return!0;return!1}};Yf=k([E(0,st)],Yf);Pn(I1,Yf,1);var aB=Z("elevatedFileService");var pp=class extends B{constructor(t,n){super();this.resource=t;this.fileService=n;this._register(this.fileService.onDidFilesChange(i=>this.onDidFilesChange(i)))}_onDidChangeOrphaned=this._register(new T);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(t){let n=!1,i;if(this.orphaned?t.contains(this.resource,1)&&(i=!1,n=!0):t.contains(this.resource,2)&&(i=!0,n=!0),n&&this.orphaned!==i){let r=!1;i&&(await nr(100,Xt.None),this.isDisposed()?r=!0:r=!await this.fileService.exists(this.resource)),this.orphaned!==r&&!this.isDisposed()&&this.setOrphaned(r)}}setOrphaned(t){this.orphaned!==t&&(this.orphaned=t,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};pp=k([E(1,dn)],pp);var Xc=class extends pp{constructor(t,n,i,r,s,a,l,d,c,u,h,m,g,f,b,y){super(n,a);this.typeId=t;this.name=i;this.modelFactory=r;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=u;this.notificationService=m;this.workingCopyEditorService=g;this.editorService=f;this.elevatedFileService=b;this.progressService=y;this._register(h.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new T);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new T);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new T);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new T);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new T);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(t){if(!this.isResolved())return;let n=this.dirty;this.doSetDirty(t),t!==n&&this._onDidChangeDirty.fire()}doSetDirty(t){let n=this.dirty,i=this.inConflictMode,r=this.inErrorMode,s=this.savedVersionId;return t?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=n,this.inConflictMode=i,this.inErrorMode=r,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(t){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!t?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(t)}async doResolve(t){if(t?.contents)return this.resolveFromBuffer(t.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(t)}async resolveFromBuffer(t){this.trace("resolveFromBuffer()");let n,i,r,s;try{let a=await this.fileService.stat(this.resource);n=a.mtime,i=a.ctime,r=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){n=Date.now(),i=Date.now(),r=0,s=If,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:n,ctime:i,size:r,etag:s,value:t,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let t=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):t?(await this.doResolveFromBackup(t),!0):!1}async doResolveFromBackup(t){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:t.meta?t.meta.mtime:Date.now(),ctime:t.meta?t.meta.ctime:Date.now(),size:t.meta?t.meta.size:0,etag:t.meta?t.meta.etag:If,value:t.value,readonly:!1,locked:!1},!0),t.meta&&t.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(t){this.trace("resolveFromFile()");let n=t?.forceReadFromFile,i;n?i=If:this.lastResolvedFileStat&&(i=this.lastResolvedFileStat.etag);let r=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:i,limits:t?.limits});if(this.setOrphaned(!1),r!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof CI&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!n)return;throw s}}async resolveFromContent(t,n){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:t.name,mtime:t.mtime,ctime:t.ctime,size:t.size,etag:t.etag,readonly:t.readonly,locked:t.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(t.value):await this.doCreateModel(t.value),this.setDirty(!!n),this._onDidResolve.fire()}async doCreateModel(t){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,t,Xt.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(t){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(t,Xt.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n.isUndoing||n.isRedoing))),this._register(t.onWillDispose(()=>this.dispose()))}onModelContentChanged(t,n){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),n&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(t.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let i=this.dirty;this.setDirty(!1),i&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(t){let n;this.lastResolvedFileStat&&(n={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let i;return this.isResolved()&&(i=await tf(this.model.snapshot(2,t),t)),{meta:n,content:i}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new Oy;ignoreSaveFromSaveParticipants=!1;async save(t=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(t.reason===2||t.reason===3||t.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(t),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(t){typeof t.reason!="number"&&(t.reason=1);let n=this.versionId;if(this.trace(`doSave(${n}) - enter with versionId ${n}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${n}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(n))return this.trace(`doSave(${n}) - exit - found a running save for versionId ${n}`),this.saveSequentializer.running;if(!t.force&&!this.dirty){this.trace(`doSave(${n}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${n}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(t));this.isResolved()&&this.model.pushStackElement();let i=new Gr;return this.progressService.withProgress({title:p("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},r=>this.doSaveSequential(n,t,r,i),()=>{i.cancel()}).finally(()=>{i.dispose()})}doSaveSequential(t,n,i,r){return this.saveSequentializer.run(t,(async()=>{if(this.isResolved()&&!n.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(n.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<Xc.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await nr(Xc.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!r.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:n.reason??1,savedFrom:n.from},i,r.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${t}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(r.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;t=this.versionId,this.inErrorMode=!1,i.report({message:p("saveTextFile","Writing into file...")}),this.trace(`doSave(${t}) - before write()`);let s=To(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(t,(async()=>{try{let l={mtime:s.mtime,etag:n.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?If:s.etag,unlock:n.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,r.token)}catch(c){if(r.token.isCancellationRequested)return;throw c}else{let c=await tf(a.model.snapshot(1,r.token),r.token);if(r.token.isCancellationRequested)return;r.dispose(),n?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,To(c),l):d=await this.fileService.writeFile(s.resource,To(c),l)}this.handleSaveSuccess(d,t,n)}catch(l){this.handleSaveError(l,t,n)}})(),()=>r.cancel())})(),()=>r.cancel())}handleSaveSuccess(t,n,i){this.updateLastResolvedFileStat(t),n===this.versionId?(this.trace(`handleSaveSuccess(${n}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${n}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:i.reason,stat:t,source:i.source})}handleSaveError(t,n,i){if((i.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${n}) - exit - resulted in a save error: ${t.toString()}`,this.resource.toString(),this.typeId]),i.ignoreErrorHandler)throw t;this.setDirty(!0),this.inErrorMode=!0,t.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(t,i),this._onDidSaveError.fire()}doHandleSaveError(t,n){let i=t,r=[],s;if(i.fileOperationResult===3)s=p("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),r.push(Ki({id:"fileWorkingCopy.overwrite",label:p("overwrite","Overwrite"),run:()=>this.save({...n,ignoreModifiedSince:!0,reason:1})})),r.push(Ki({id:"fileWorkingCopy.revert",label:p("revert","Revert"),run:()=>this.revert()}));else{let d=i.fileOperationResult===5,c=d&&i.options?.unlock,u=i.fileOperationResult===6,h=this.elevatedFileService.isSupported(this.resource);h1(t)&&r.push(...t.actions),h&&(u||c)?r.push(Ki({id:"fileWorkingCopy.saveElevated",label:c?ft?p("overwriteElevated","Overwrite as Admin..."):p("overwriteElevatedSudo","Overwrite as Sudo..."):ft?p("saveElevated","Retry as Admin..."):p("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...n,writeElevated:!0,writeUnlock:c,reason:1})}})):d?r.push(Ki({id:"fileWorkingCopy.unlock",label:p("overwrite","Overwrite"),run:()=>this.save({...n,writeUnlock:!0,reason:1})})):r.push(Ki({id:"fileWorkingCopy.retry",label:p("retry","Retry"),run:()=>this.save({...n,reason:1})})),r.push(Ki({id:"fileWorkingCopy.saveAs",label:p("saveAs","Save As..."),run:async()=>{let m=this.workingCopyEditorService.findEditor(this);m&&((await this.editorService.save(m,{saveAs:!0,reason:1})).success||this.doHandleSaveError(t,n))}})),r.push(Ki({id:"fileWorkingCopy.revert",label:p("revert","Revert"),run:()=>this.revert()})),d?c&&h?s=ft?p("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):p("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=p("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):h&&u?s=ft?p("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):p("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=p({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,IC(t,!1))}let a=this.notificationService.notify({id:`${Oo(this.resource.toString())}`,severity:EC.Error,message:s,actions:{primary:r}}),l=this._register(Y.once(Y.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(Y.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(t){let n=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=t.mtime?this.lastResolvedFileStat=t:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:t.readonly,locked:t.locked}:this.lastResolvedFileStat=t,this.isReadonly()!==n&&this._onDidChangeReadonly.fire()}async revert(t){if(!this.isResolved()||!this.dirty&&!t?.force)return;this.trace("revert()");let n=this.dirty,i=this.doSetDirty(!1);if(!t?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw i(),s}this._onDidRevert.fire(),n&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(t){switch(t){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(t){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(t){this.logService.trace(`[stored file working copy] ${t}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};Xc=k([E(5,dn),E(6,Fn),E(7,C1),E(8,La),E(9,SI),E(10,Pd),E(11,eo),E(12,I1),E(13,st),E(14,aB),E(15,y1)],Xc);var mp=class extends B{constructor(t){super();this.logService=t}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(t){let n=Cv(this.saveParticipants,t);return pe(()=>n())}async participate(t,n,i,r){t.model?.pushStackElement();for(let s of this.saveParticipants){if(r.isCancellationRequested||t.isDisposed())break;try{let a=s.participate(t,n,i,r);await tf(a,r)}catch(a){this.logService.warn(a)}}t.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};mp=k([E(0,Fn)],mp);var C1=Z("workingCopyFileService"),Zf=class extends B{constructor(t,n,i,r){super();this.fileService=t;this.workingCopyService=n;this.instantiationService=i;this.uriIdentityService=r;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new dh);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new dh);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new dh);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(t,n,i){return this.doCreateFileOrFolder(t,!0,n,i)}createFolder(t,n,i){return this.doCreateFileOrFolder(t,!1,n,i)}async doCreateFileOrFolder(t,n,i,r){if(t.length===0)return[];if(n){let c=(await Lr.settled(t.map(u=>this.fileService.canCreateFile(u.resource,{overwrite:u.overwrite})))).find(u=>u instanceof Error);if(c instanceof Error)throw c}let s=t.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,r,i);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,Xt.None);let l;try{n?l=await Lr.settled(t.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await Lr.settled(t.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,Xt.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,Xt.None),l}async move(t,n,i){return this.doMoveOrCopy(t,!0,n,i)}async copy(t,n,i){return this.doMoveOrCopy(t,!1,n,i)}async doMoveOrCopy(t,n,i,r){let s=[];for(let{file:{source:d,target:c},overwrite:u}of t){let h=await(n?this.fileService.canMove(d,c,u):this.fileService.canCopy(d,c,u));if(h instanceof Error)throw h}let a=t.map(d=>d.file);await this.runFileOperationParticipants(a,n?2:3,r,i);let l={correlationId:this.correlationIds++,operation:n?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,Xt.None);try{for(let{file:{source:d,target:c},overwrite:u}of t){if(!this.uriIdentityService.extUri.isEqual(d,c)){let h=n?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await Lr.settled(h.map(m=>m.revert({soft:!0})))}n?s.push(await this.fileService.move(d,c,u)):s.push(await this.fileService.copy(d,c,u))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,Xt.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,Xt.None),s}async delete(t,n,i){for(let a of t){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let r=t.map(a=>({target:a.resource}));await this.runFileOperationParticipants(r,1,i,n);let s={correlationId:this.correlationIds++,operation:1,files:r};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,Xt.None);for(let a of t){let l=this.getDirty(a.resource);await Lr.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of t)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,Xt.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,Xt.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(hp));addFileOperationParticipant(t){return this.fileOperationParticipants.addFileOperationParticipant(t)}runFileOperationParticipants(t,n,i,r){return this.fileOperationParticipants.participate(t,n,i,r)}saveParticipants=this._register(this.instantiationService.createInstance(mp));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(t){return this.saveParticipants.addSaveParticipant(t)}runSaveParticipants(t,n,i,r){return this.saveParticipants.participate(t,n,i,r)}workingCopyProviders=[];registerWorkingCopyProvider(t){let n=Cv(this.workingCopyProviders,t);return pe(n)}getDirty(t){let n=new Set;for(let i of this.workingCopyProviders)for(let r of i(t))r.isDirty()&&n.add(r);return Array.from(n)}};Zf=k([E(0,dn),E(1,Pd),E(2,nt),E(3,Yc)],Zf);Pn(C1,Zf,1);var Ta=Z("textFileService");var rz;(e=>e.DEFAULT={allowTrailingComma:!0})(rz||={});var to=Z("keybindingService");var S1=".vscode",sz="settings",SNe=`${S1}/${sz}.json`;var xNe=[1],ENe=[2,3,4,5,6],az=[3,4,5],wNe=[1,...az],_Ne=[2,3,4,5,6],lz=[3,4,5,6],dz=[4,5,6],_C="tasks",lB="launch",cB=Object.create(null);cB[_C]=`${S1}/${_C}.json`;cB[lB]=`${S1}/${lB}.json`;var cz=Object.create(null);cz[_C]=`${_C}.json`;var TNe=rt;var x1=class extends Ss{_currentResultGroups=new Map;updateResultGroup(e,t){return t?this._currentResultGroups.set(e,t):this._currentResultGroups.delete(e),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let e=new Set;[...this._currentResultGroups.keys()].sort((t,n)=>this._currentResultGroups.get(t).order-this._currentResultGroups.get(n).order).forEach(t=>{let n=this._currentResultGroups.get(t);n.result.filterMatches=n.result.filterMatches.filter(i=>!e.has(i.setting.key)),n.result.filterMatches.forEach(i=>e.add(i.setting.key))})}filterSettings(e,t,n){let i=this.filterGroups,r=[];for(let s of i){let a=t(s);for(let l of s.sections)for(let d of l.settings){let c=n(d,s);(a||c)&&r.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return r}getPreference(e){for(let t of this.settingsGroups)for(let n of t.sections)for(let i of n.settings)if(e===i.key)return i}collectMetadata(e){let t=Object.create(null),n=!1;return e.forEach(i=>{i.result.metadata&&(t[i.id]=i.result.metadata,n=!0)}),n?t:null}get filterGroups(){return this.settingsGroups}};var TC=class extends x1{constructor(t,n){super();this._defaultSettings=t;this._register(n.onDidChangeConfiguration(i=>{i.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(Je.as($r.Configuration).onDidSchemaChange(i=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new T);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let t=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...t,...this.additionalGroups]}setAdditionalGroups(t){this.additionalGroups=t}findValueMatches(t,n){return[]}update(){throw new Error("Not supported")}};TC=k([E(1,rt)],TC);function hz(o){return"// "+p("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+o.getDefaultKeybindingsContent()}var LC=class{constructor(e,t){this._uri=e;this.keybindingService=t}_content;get uri(){return this._uri}get content(){return this._content||(this._content=hz(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};LC=k([E(1,to)],LC);var mOe=Z("preferencesService");var wa={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},Cl={id:"default",displayName:p("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:p("builtinProviderDisplayName","Built-in")};function vC(o,e,t){for(let n of t.visibleEditorPanes)if(n.group.id===e&&o.matches(n.input))return n.getViewState()}function yC(o){if(Pi(o))return!1;let e=o;return ne.isUri(e?.resource)}function yl(o){if(Pi(o))return!1;let e=o;return e?.original!==void 0&&e.modified!==void 0}function cp(o){if(Pi(o))return!1;let e=o;return!e||e.resources&&!Array.isArray(e.resources)?!1:!!e.resources||!!e.multiDiffSource}function Fd(o){if(Pi(o)||yl(o))return!1;let e=o;return e?.primary!==void 0&&e.secondary!==void 0}function Ea(o){if(Pi(o))return!1;let e=o;return ne.isUri(e?.base?.resource)&&ne.isUri(e?.input1?.resource)&&ne.isUri(e?.input2?.resource)&&ne.isUri(e?.result?.resource)}var E1=class{mapIdToSaveSource=new Map;registerSource(e,t){let n=this.mapIdToSaveSource.get(e);return n||(n={source:e,label:t},this.mapIdToSaveSource.set(e,n)),n.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},uB=new E1;var Gf=class extends B{};function Pi(o){return o instanceof Gf}function pz(o){let e=o;return ne.isUri(e?.preferredResource)}function mz(o){let e=o;return Pi(e?.primary)&&Pi(e?.secondary)}function l1(o){let e=o;return Pi(e?.modified)&&Pi(e?.original)}var w1=class{getOriginalUri(e,t){if(!e)return;if(Ea(e))return vl.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getOriginalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getOriginalUri(i,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(yl(e)||cp(e)||Fd(e)||Ea(e))return;let n=pz(e)?e.preferredResource:e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}getSideEditors(e){return mz(e)||Fd(e)?{primary:e.primary,secondary:e.secondary}:l1(e)||yl(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(Ea(e))return vl.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getCanonicalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getCanonicalUri(i,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(yl(e)||cp(e)||Fd(e)||Ea(e))return;let n=e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(n=>e.scheme===n))return e}else if(t===e.scheme)return e}};var vl=new w1;var _1=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(e){let t=this.instantiationService=e.get(nt);for(let[n,i]of this.editorSerializerConstructors)this.createEditorSerializer(n,i,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){let i=n.createInstance(t);this.editorSerializerInstances.set(e,i)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return To(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),pe(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};Je.add(wa.EditorFactory,new _1);function T1(o){let e=o;if(!e)return!1;let t=e;if(t.modified)return T1(t.modified);let n=e;return!!(n.contributionsState&&n.viewState&&Array.isArray(n.cursorState))}function Xf(o){let e=JSON.parse(o);return e=gp(e),e}function gp(o,e=0){if(!o||e>200)return o;if(typeof o=="object"){switch(o.$mid){case 1:return ne.revive(o);case 2:return new RegExp(o.source,o.flags);case 17:return new Date(o.source)}if(o instanceof vn||o instanceof Uint8Array)return o;if(Array.isArray(o))for(let t=0;t<o.length;++t)o[t]=gp(o[t],e+1);else for(let t in o)Object.hasOwnProperty.call(o,t)&&(o[t]=gp(o[t],e+1))}return o}var gz="__$__isNewStorageMarker",DC="__$__targetStorageMarker",In=Z("storageService");function fz(o){let e=o.get(DC);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}var hB=class o extends B{constructor(t={flushInterval:o.DEFAULT_FLUSH_INTERVAL}){super();this.options=t}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new fc);_onDidChangeTarget=this._register(new fc);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new T);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new Yt(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new rn);onDidChangeValue(t,n,i){return Y.filter(this._onDidChangeValue.event,r=>r.scope===t&&(n===void 0||r.key===n),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Id(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){Nt([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{Zn("code/willInitStorage");try{await this.doInitialize()}finally{Zn("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(t,n){let{key:i,external:r}=n;if(i===DC){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:i,target:this.getKeyTargets(t)[i],external:r})}emitWillSaveState(t){this._onWillSaveState.fire({reason:t})}get(t,n,i){return this.getStorage(n)?.get(t,i)}getBoolean(t,n,i){return this.getStorage(n)?.getBoolean(t,i)}getNumber(t,n,i){return this.getStorage(n)?.getNumber(t,i)}getObject(t,n,i){return this.getStorage(n)?.getObject(t,i)}storeAll(t,n){this.withPausedEmitters(()=>{for(let i of t)this.store(i.key,i.value,i.scope,i.target,n)})}store(t,n,i,r,s=!1){if(Mi(n)){this.remove(t,i,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(t,i,r),this.getStorage(i)?.set(t,n,s)})}remove(t,n,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(t,n,void 0),this.getStorage(n)?.delete(t,i)})}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(t,n){let i=[],r=this.getKeyTargets(t);for(let s of Object.keys(r))r[s]===n&&i.push(s);return i}updateKeyTarget(t,n,i,r=!1){let s=this.getKeyTargets(n);typeof i=="number"?s[t]!==i&&(s[t]=i,this.getStorage(n)?.set(DC,JSON.stringify(s),r)):typeof s[t]=="number"&&(delete s[t],this.getStorage(n)?.set(DC,JSON.stringify(s),r))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){let n=this.getStorage(t);return n?fz(n):Object.create(null)}isNew(t){return this.getBoolean(gz,t)===!0}async flush(t=0){this._onWillSaveState.fire({reason:t});let n=this.getStorage(-1),i=this.getStorage(0),r=this.getStorage(1);switch(t){case 0:await Lr.settled([n?.whenFlushed()??Promise.resolve(),i?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case 1:await Lr.settled([n?.flush(0)??Promise.resolve(),i?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){let t=this.getStorage(-1)?.items??new Map,n=this.getStorage(0)?.items??new Map,i=this.getStorage(1)?.items??new Map;return bz(t,n,i,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(t){return await this.flush(),this.getStorage(t)?.optimize()}async switch(t,n){return this.emitWillSaveState(0),nB(t)?this.switchToProfile(t,n):this.switchToWorkspace(t,n)}canSwitchProfile(t,n){return!(t.id===n.id||pB(n)&&pB(t))}switchData(t,n,i){this.withPausedEmitters(()=>{let r=new Set;for(let[s,a]of t)r.add(s),n.get(s)!==a&&this.emitDidChangeValue(i,{key:s,external:!0});for(let[s]of n.items)r.has(s)||this.emitDidChangeValue(i,{key:s,external:!0})})}};function pB(o){return o.isDefault||!!o.useDefaultFlags?.globalState}async function bz(o,e,t,n,i,r){let s=f=>{try{return JSON.parse(f)}catch{return f}},a=new Map,l=new Map;o.forEach((f,b)=>{a.set(b,f),l.set(b,s(f))});let d=new Map,c=new Map;e.forEach((f,b)=>{d.set(b,f),c.set(b,s(f))});let u=new Map,h=new Map;t.forEach((f,b)=>{u.set(b,f),h.set(b,s(f))}),console.group(n!==i?`Storage: Application (path: ${n})`:`Storage: Application & Profile (path: ${n}, default profile)`);let m=[];if(a.forEach((f,b)=>{m.push({key:b,value:f})}),console.table(m),console.groupEnd(),console.log(l),n!==i){console.group(`Storage: Profile (path: ${i}, profile specific)`);let f=[];d.forEach((b,y)=>{f.push({key:y,value:b})}),console.table(f),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${r})`);let g=[];u.forEach((f,b)=>{g.push({key:b,value:f})}),console.table(g),console.groupEnd(),console.log(h)}var RC=class o{constructor(e,t){this.storageService=t;this.id=o.COMMON_PREFIX+e}static applicationMementos=new Map;static profileMementos=new Map;static workspaceMementos=new Map;static COMMON_PREFIX="memento/";id;getMemento(e,t){switch(e){case 1:{let n=o.workspaceMementos.get(this.id);return n||(n=new Qf(this.id,e,t,this.storageService),o.workspaceMementos.set(this.id,n)),n.getMemento()}case 0:{let n=o.profileMementos.get(this.id);return n||(n=new Qf(this.id,e,t,this.storageService),o.profileMementos.set(this.id,n)),n.getMemento()}case-1:{let n=o.applicationMementos.get(this.id);return n||(n=new Qf(this.id,e,t,this.storageService),o.applicationMementos.set(this.id,n)),n.getMemento()}}}onDidChangeValue(e,t){return this.storageService.onDidChangeValue(e,this.id,t)}saveMemento(){o.workspaceMementos.get(this.id)?.save(),o.profileMementos.get(this.id)?.save(),o.applicationMementos.get(this.id)?.save()}reloadMemento(e){let t;switch(e){case-1:t=o.applicationMementos.get(this.id);break;case 0:t=o.profileMementos.get(this.id);break;case 1:t=o.workspaceMementos.get(this.id);break}t?.reload()}static clear(e){switch(e){case 1:o.workspaceMementos.clear();break;case 0:o.profileMementos.clear();break;case-1:o.applicationMementos.clear();break}}},Qf=class{constructor(e,t,n,i){this.id=e;this.scope=t;this.target=n;this.storageService=i;this.mementoObj=this.doLoad()}mementoObj;doLoad(){try{return this.storageService.getObject(this.id,this.scope,{})}catch(e){Ne(`[memento]: failed to parse contents: ${e} (id: ${this.id}, scope: ${this.scope}, contents: ${this.storageService.get(this.id,this.scope)})`)}return{}}getMemento(){return this.mementoObj}reload(){for(let e of Object.getOwnPropertyNames(this.mementoObj))delete this.mementoObj[e];Object.assign(this.mementoObj,this.doLoad())}save(){bc(this.mementoObj)?this.storageService.remove(this.id,this.scope):this.storageService.store(this.id,this.mementoObj,this.scope,this.target)}};var Jf=class extends DI{constructor(t,n,i){super(n);this.id=t;this.memento=new RC(this.id,i),this._register(i.onWillSaveState(()=>{this.saveState(),this.memento.saveMemento()}))}memento;getId(){return this.id}getMemento(t,n){return this.memento.getMemento(t,n)}reloadMemento(t){return this.memento.reloadMemento(t)}onDidChangeMementoValue(t,n){return this.memento.onDidChangeValue(t,n)}saveState(){}};function kC(o,e){let t=o;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}var _e=window;function L1(o){return o===_e?!1:typeof o?.vscodeWindowId=="number"}var Qc=class o{static INSTANCE=new o;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new T;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,t){if(this.getZoomLevel(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(n,e),this._onDidChangeZoomLevel.fire(n)}mapWindowIdToZoomFactor=new Map;getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}_onDidChangeFullscreen=new T;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(e,t){if(this.isFullscreen(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToFullScreen.set(n,e),this._onDidChangeFullscreen.fire(n)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};function vz(o,e,t){typeof e=="string"&&(e=o.matchMedia(e)),e.addEventListener("change",t)}function mB(o){return Qc.INSTANCE.getZoomLevel(o)}var DFe=Qc.INSTANCE.onDidChangeZoomLevel;function gB(o){return Qc.INSTANCE.getZoomFactor(o)}function fB(o,e){Qc.INSTANCE.setFullscreen(o,e)}var RFe=Qc.INSTANCE.onDidChangeFullscreen,fp=navigator.userAgent,Bn=fp.indexOf("Firefox")>=0,Ls=fp.indexOf("AppleWebKit")>=0,Bd=fp.indexOf("Chrome")>=0,Bo=!Bd&&fp.indexOf("Safari")>=0,bB=!Bd&&!Bo&&Ls,kFe=fp.indexOf("Electron/")>=0,D1=fp.indexOf("Android")>=0,MC=!1;if(typeof _e.matchMedia=="function"){let o=_e.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=_e.matchMedia("(display-mode: fullscreen)");MC=o.matches,vz(_e,o,({matches:t})=>{MC&&e.matches||(MC=t)})}function vB(){return MC}var NC={clipboard:{writeText:Ys||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:Ys||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:Ys||vB()?0:navigator.keyboard||Bo?1:2,touch:"ontouchstart"in _e||navigator.maxTouchPoints>0,pointerEvents:_e.PointerEvent&&("ontouchstart"in _e||navigator.maxTouchPoints>0)};function yz(o){if(o.charCode){let t=String.fromCharCode(o.charCode).toUpperCase();return Bg.fromString(t)}let e=o.keyCode;if(e===3)return 7;if(Bn)switch(e){case 59:return 85;case 60:if(Zt)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Fe)return 57;break}else if(Ls){if(Fe&&e===93)return 57;if(!Fe&&e===92)return 57}return oT[e]||0}var Iz=Fe?256:2048,Cz=512,Sz=1024,xz=Fe?2048:256;var vt=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(e){let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=yz(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=Iz),this.altKey&&(t|=Cz),this.shiftKey&&(t|=Sz),this.metaKey&&(t|=xz),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new Vg(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}};var yB=new WeakMap;function Ez(o){if(!o.parent||o.parent===o)return null;try{let e=o.location,t=o.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return o.parent}var AC=class{static getSameOriginWindowChain(e){let t=yB.get(e);if(!t){t=[],yB.set(e,t);let n=e,i;do i=Ez(n),i?t.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):t.push({window:new WeakRef(n),iframeElement:null}),n=i;while(n)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let n=0,i=0,r=this.getSameOriginWindowChain(e);for(let s of r){let a=s.window.deref();if(n+=a?.scrollY??0,i+=a?.scrollX??0,a===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();n+=l.top,i+=l.left}return{top:n,left:i}}};var Fi=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=AC.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Nr=class{browserEvent;deltaY;deltaX;target;constructor(e,t=0,n=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=n,this.deltaX=t;let i=!1;if(Bd){let r=navigator.userAgent.match(/Chrome\/(\d+)/);i=(r?parseInt(r[1]):123)<=122}if(e){let r=e,s=e,a=e.view?.devicePixelRatio||1;if(typeof r.wheelDeltaY<"u")i?this.deltaY=r.wheelDeltaY/(120*a):this.deltaY=r.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Bn&&!Fe?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof r.wheelDeltaX<"u")Bo&&ft?this.deltaX=-(r.wheelDeltaX/120):i?this.deltaX=r.wheelDeltaX/(120*a):this.deltaX=r.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Bn&&!Fe?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(i?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var{entries:TB,setPrototypeOf:IB,isFrozen:wz,getPrototypeOf:_z,getOwnPropertyDescriptor:Tz}=Object,{freeze:Vo,seal:Rs,create:Lz}=Object,{apply:O1,construct:P1}=typeof Reflect<"u"&&Reflect;O1||(O1=function(e,t,n){return e.apply(t,n)});Vo||(Vo=function(e){return e});Rs||(Rs=function(e){return e});P1||(P1=function(e,t){return new e(...t)});var Dz=Qr(Array.prototype.forEach),CB=Qr(Array.prototype.pop),eb=Qr(Array.prototype.push),FC=Qr(String.prototype.toLowerCase),R1=Qr(String.prototype.toString),Rz=Qr(String.prototype.match),Ds=Qr(String.prototype.replace),kz=Qr(String.prototype.indexOf),Mz=Qr(String.prototype.trim),Ar=Qr(RegExp.prototype.test),tb=Nz(TypeError);function Qr(o){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return O1(o,e,n)}}function Nz(o){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return P1(o,t)}}function gt(o,e,t){var n;t=(n=t)!==null&&n!==void 0?n:FC,IB&&IB(o,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){let s=t(r);s!==r&&(wz(e)||(e[i]=s),r=s)}o[r]=!0}return o}function vp(o){let e=Lz(null);for(let[t,n]of TB(o))e[t]=n;return e}function OC(o,e){for(;o!==null;){let n=Tz(o,e);if(n){if(n.get)return Qr(n.get);if(typeof n.value=="function")return Qr(n.value)}o=_z(o)}function t(n){return console.warn("fallback value for",n),null}return t}var SB=Vo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),k1=Vo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),M1=Vo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Az=Vo(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),N1=Vo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Oz=Vo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),xB=Vo(["#text"]),EB=Vo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),A1=Vo(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),wB=Vo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),PC=Vo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Pz=Rs(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Fz=Rs(/<%[\w\W]*|[\w\W]*%>/gm),Bz=Rs(/\${[\w\W]*}/gm),Vz=Rs(/^data-[\-\w.\u00B7-\uFFFF]/),Wz=Rs(/^aria-[\-\w]+$/),LB=Rs(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Hz=Rs(/^(?:\w+script|data):/i),Uz=Rs(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DB=Rs(/^html$/i),_B=Object.freeze({__proto__:null,MUSTACHE_EXPR:Pz,ERB_EXPR:Fz,TMPLIT_EXPR:Bz,DATA_ATTR:Vz,ARIA_ATTR:Wz,IS_ALLOWED_URI:LB,IS_SCRIPT_OR_DATA:Hz,ATTR_WHITESPACE:Uz,DOCTYPE_NAME:DB}),zz=()=>typeof window>"u"?null:window,Kz=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));let r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function RB(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zz(),e=ke=>RB(ke);if(e.version="3.0.5",e.removed=[],!o||!o.document||o.document.nodeType!==9)return e.isSupported=!1,e;let t=o.document,n=t.currentScript,{document:i}=o,{DocumentFragment:r,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:u,DOMParser:h,trustedTypes:m}=o,g=l.prototype,f=OC(g,"cloneNode"),b=OC(g,"nextSibling"),y=OC(g,"childNodes"),C=OC(g,"parentNode");if(typeof s=="function"){let ke=i.createElement("template");ke.content&&ke.content.ownerDocument&&(i=ke.content.ownerDocument)}let S,w="",{implementation:R,createNodeIterator:M,createDocumentFragment:N,getElementsByTagName:A}=i,{importNode:P}=t,K={};e.isSupported=typeof TB=="function"&&typeof C=="function"&&R&&R.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:j,ERB_EXPR:X,TMPLIT_EXPR:le,DATA_ATTR:ye,ARIA_ATTR:q,IS_SCRIPT_OR_DATA:Q,ATTR_WHITESPACE:ce}=_B,{IS_ALLOWED_URI:ie}=_B,J=null,Se=gt({},[...SB,...k1,...M1,...N1,...xB]),xe=null,lt=gt({},[...EB,...A1,...wB,...PC]),Ze=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Re=null,ci=null,Kn=!0,So=!0,jo=!1,zl=!0,wi=!1,rs=!1,cc=!1,Kl=!1,_i=!1,Gl=!1,jl=!1,$u=!0,qu=!1,Pe="user-content-",Ka=!0,$l=!1,Hs={},Kr=null,Qm=gt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),uc=null,Jm=gt({},["audio","video","img","source","image","track"]),Us=null,eg=gt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),zs="http://www.w3.org/1998/Math/MathML",fr="http://www.w3.org/2000/svg",Mn="http://www.w3.org/1999/xhtml",br=Mn,Ga=!1,oo=null,ql=gt({},[zs,fr,Mn],R1),ss,Ks=["application/xhtml+xml","text/html"],fe="text/html",re,O=null,te=i.createElement("form"),ge=function(U){return U instanceof RegExp||U instanceof Function},$e=function(U){if(!(O&&O===U)){if((!U||typeof U!="object")&&(U={}),U=vp(U),ss=Ks.indexOf(U.PARSER_MEDIA_TYPE)===-1?ss=fe:ss=U.PARSER_MEDIA_TYPE,re=ss==="application/xhtml+xml"?R1:FC,J="ALLOWED_TAGS"in U?gt({},U.ALLOWED_TAGS,re):Se,xe="ALLOWED_ATTR"in U?gt({},U.ALLOWED_ATTR,re):lt,oo="ALLOWED_NAMESPACES"in U?gt({},U.ALLOWED_NAMESPACES,R1):ql,Us="ADD_URI_SAFE_ATTR"in U?gt(vp(eg),U.ADD_URI_SAFE_ATTR,re):eg,uc="ADD_DATA_URI_TAGS"in U?gt(vp(Jm),U.ADD_DATA_URI_TAGS,re):Jm,Kr="FORBID_CONTENTS"in U?gt({},U.FORBID_CONTENTS,re):Qm,Re="FORBID_TAGS"in U?gt({},U.FORBID_TAGS,re):{},ci="FORBID_ATTR"in U?gt({},U.FORBID_ATTR,re):{},Hs="USE_PROFILES"in U?U.USE_PROFILES:!1,Kn=U.ALLOW_ARIA_ATTR!==!1,So=U.ALLOW_DATA_ATTR!==!1,jo=U.ALLOW_UNKNOWN_PROTOCOLS||!1,zl=U.ALLOW_SELF_CLOSE_IN_ATTR!==!1,wi=U.SAFE_FOR_TEMPLATES||!1,rs=U.WHOLE_DOCUMENT||!1,_i=U.RETURN_DOM||!1,Gl=U.RETURN_DOM_FRAGMENT||!1,jl=U.RETURN_TRUSTED_TYPE||!1,Kl=U.FORCE_BODY||!1,$u=U.SANITIZE_DOM!==!1,qu=U.SANITIZE_NAMED_PROPS||!1,Ka=U.KEEP_CONTENT!==!1,$l=U.IN_PLACE||!1,ie=U.ALLOWED_URI_REGEXP||LB,br=U.NAMESPACE||Mn,Ze=U.CUSTOM_ELEMENT_HANDLING||{},U.CUSTOM_ELEMENT_HANDLING&&ge(U.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ze.tagNameCheck=U.CUSTOM_ELEMENT_HANDLING.tagNameCheck),U.CUSTOM_ELEMENT_HANDLING&&ge(U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ze.attributeNameCheck=U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),U.CUSTOM_ELEMENT_HANDLING&&typeof U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ze.allowCustomizedBuiltInElements=U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),wi&&(So=!1),Gl&&(_i=!0),Hs&&(J=gt({},[...xB]),xe=[],Hs.html===!0&&(gt(J,SB),gt(xe,EB)),Hs.svg===!0&&(gt(J,k1),gt(xe,A1),gt(xe,PC)),Hs.svgFilters===!0&&(gt(J,M1),gt(xe,A1),gt(xe,PC)),Hs.mathMl===!0&&(gt(J,N1),gt(xe,wB),gt(xe,PC))),U.ADD_TAGS&&(J===Se&&(J=vp(J)),gt(J,U.ADD_TAGS,re)),U.ADD_ATTR&&(xe===lt&&(xe=vp(xe)),gt(xe,U.ADD_ATTR,re)),U.ADD_URI_SAFE_ATTR&&gt(Us,U.ADD_URI_SAFE_ATTR,re),U.FORBID_CONTENTS&&(Kr===Qm&&(Kr=vp(Kr)),gt(Kr,U.FORBID_CONTENTS,re)),Ka&&(J["#text"]=!0),rs&&gt(J,["html","head","body"]),J.table&&(gt(J,["tbody"]),delete Re.tbody),U.TRUSTED_TYPES_POLICY){if(typeof U.TRUSTED_TYPES_POLICY.createHTML!="function")throw tb('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof U.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw tb('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=U.TRUSTED_TYPES_POLICY,w=S.createHTML("")}else S===void 0&&(S=Kz(m,n)),S!==null&&typeof w=="string"&&(w=S.createHTML(""));Vo&&Vo(U),O=U}},xt=gt({},["mi","mo","mn","ms","mtext"]),ni=gt({},["foreignobject","desc","title","annotation-xml"]),Ti=gt({},["title","style","font","a","script"]),We=gt({},k1);gt(We,M1),gt(We,Az);let x=gt({},N1);gt(x,Oz);let _=function(U){let be=C(U);(!be||!be.tagName)&&(be={namespaceURI:br,tagName:"template"});let Le=FC(U.tagName),Vt=FC(be.tagName);return oo[U.namespaceURI]?U.namespaceURI===fr?be.namespaceURI===Mn?Le==="svg":be.namespaceURI===zs?Le==="svg"&&(Vt==="annotation-xml"||xt[Vt]):!!We[Le]:U.namespaceURI===zs?be.namespaceURI===Mn?Le==="math":be.namespaceURI===fr?Le==="math"&&ni[Vt]:!!x[Le]:U.namespaceURI===Mn?be.namespaceURI===fr&&!ni[Vt]||be.namespaceURI===zs&&!xt[Vt]?!1:!x[Le]&&(Ti[Le]||!We[Le]):!!(ss==="application/xhtml+xml"&&oo[U.namespaceURI]):!1},D=function(U){eb(e.removed,{element:U});try{U.parentNode.removeChild(U)}catch{U.remove()}},F=function(U,be){try{eb(e.removed,{attribute:be.getAttributeNode(U),from:be})}catch{eb(e.removed,{attribute:null,from:be})}if(be.removeAttribute(U),U==="is"&&!xe[U])if(_i||Gl)try{D(be)}catch{}else try{be.setAttribute(U,"")}catch{}},H=function(U){let be,Le;if(Kl)U="<remove></remove>"+U;else{let ro=Rz(U,/^[\r\n\t ]+/);Le=ro&&ro[0]}ss==="application/xhtml+xml"&&br===Mn&&(U='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+U+"</body></html>");let Vt=S?S.createHTML(U):U;if(br===Mn)try{be=new h().parseFromString(Vt,ss)}catch{}if(!be||!be.documentElement){be=R.createDocument(br,"template",null);try{be.documentElement.innerHTML=Ga?w:Vt}catch{}}let Gn=be.body||be.documentElement;return U&&Le&&Gn.insertBefore(i.createTextNode(Le),Gn.childNodes[0]||null),br===Mn?A.call(be,rs?"html":"body")[0]:rs?be.documentElement:Gn},$=function(U){return M.call(U.ownerDocument||U,U,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},ee=function(U){return U instanceof u&&(typeof U.nodeName!="string"||typeof U.textContent!="string"||typeof U.removeChild!="function"||!(U.attributes instanceof c)||typeof U.removeAttribute!="function"||typeof U.setAttribute!="function"||typeof U.namespaceURI!="string"||typeof U.insertBefore!="function"||typeof U.hasChildNodes!="function")},Ie=function(U){return typeof a=="object"?U instanceof a:U&&typeof U=="object"&&typeof U.nodeType=="number"&&typeof U.nodeName=="string"},we=function(U,be,Le){K[U]&&Dz(K[U],Vt=>{Vt.call(e,be,Le,O)})},Ye=function(U){let be;if(we("beforeSanitizeElements",U,null),ee(U))return D(U),!0;let Le=re(U.nodeName);if(we("uponSanitizeElement",U,{tagName:Le,allowedTags:J}),U.hasChildNodes()&&!Ie(U.firstElementChild)&&(!Ie(U.content)||!Ie(U.content.firstElementChild))&&Ar(/<[/\w]/g,U.innerHTML)&&Ar(/<[/\w]/g,U.textContent))return D(U),!0;if(!J[Le]||Re[Le]){if(!Re[Le]&&$t(Le)&&(Ze.tagNameCheck instanceof RegExp&&Ar(Ze.tagNameCheck,Le)||Ze.tagNameCheck instanceof Function&&Ze.tagNameCheck(Le)))return!1;if(Ka&&!Kr[Le]){let Vt=C(U)||U.parentNode,Gn=y(U)||U.childNodes;if(Gn&&Vt){let ro=Gn.length;for(let xn=ro-1;xn>=0;--xn)Vt.insertBefore(f(Gn[xn],!0),b(U))}}return D(U),!0}return U instanceof l&&!_(U)||(Le==="noscript"||Le==="noembed"||Le==="noframes")&&Ar(/<\/no(script|embed|frames)/i,U.innerHTML)?(D(U),!0):(wi&&U.nodeType===3&&(be=U.textContent,be=Ds(be,j," "),be=Ds(be,X," "),be=Ds(be,le," "),U.textContent!==be&&(eb(e.removed,{element:U.cloneNode()}),U.textContent=be)),we("afterSanitizeElements",U,null),!1)},It=function(U,be,Le){if($u&&(be==="id"||be==="name")&&(Le in i||Le in te))return!1;if(!(So&&!ci[be]&&Ar(ye,be))){if(!(Kn&&Ar(q,be))){if(!xe[be]||ci[be]){if(!($t(U)&&(Ze.tagNameCheck instanceof RegExp&&Ar(Ze.tagNameCheck,U)||Ze.tagNameCheck instanceof Function&&Ze.tagNameCheck(U))&&(Ze.attributeNameCheck instanceof RegExp&&Ar(Ze.attributeNameCheck,be)||Ze.attributeNameCheck instanceof Function&&Ze.attributeNameCheck(be))||be==="is"&&Ze.allowCustomizedBuiltInElements&&(Ze.tagNameCheck instanceof RegExp&&Ar(Ze.tagNameCheck,Le)||Ze.tagNameCheck instanceof Function&&Ze.tagNameCheck(Le))))return!1}else if(!Us[be]){if(!Ar(ie,Ds(Le,ce,""))){if(!((be==="src"||be==="xlink:href"||be==="href")&&U!=="script"&&kz(Le,"data:")===0&&uc[U])){if(!(jo&&!Ar(Q,Ds(Le,ce,"")))){if(Le)return!1}}}}}}return!0},$t=function(U){return U.indexOf("-")>0},Nn=function(U){let be,Le,Vt,Gn;we("beforeSanitizeAttributes",U,null);let{attributes:ro}=U;if(!ro)return;let xn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(Gn=ro.length;Gn--;){be=ro[Gn];let{name:Gs,namespaceURI:u_}=be;if(Le=Gs==="value"?be.value:Mz(be.value),Vt=re(Gs),xn.attrName=Vt,xn.attrValue=Le,xn.keepAttr=!0,xn.forceKeepAttr=void 0,we("uponSanitizeAttribute",U,xn),Le=xn.attrValue,xn.forceKeepAttr||(F(Gs,U),!xn.keepAttr))continue;if(!zl&&Ar(/\/>/i,Le)){F(Gs,U);continue}wi&&(Le=Ds(Le,j," "),Le=Ds(Le,X," "),Le=Ds(Le,le," "));let _M=re(U.nodeName);if(It(_M,Vt,Le)){if(qu&&(Vt==="id"||Vt==="name")&&(F(Gs,U),Le=Pe+Le),S&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!u_)switch(m.getAttributeType(_M,Vt)){case"TrustedHTML":{Le=S.createHTML(Le);break}case"TrustedScriptURL":{Le=S.createScriptURL(Le);break}}try{u_?U.setAttributeNS(u_,Gs,Le):U.setAttribute(Gs,Le),CB(e.removed)}catch{}}}we("afterSanitizeAttributes",U,null)},nn=function ke(U){let be,Le=$(U);for(we("beforeSanitizeShadowDOM",U,null);be=Le.nextNode();)we("uponSanitizeShadowNode",be,null),!Ye(be)&&(be.content instanceof r&&ke(be.content),Nn(be));we("afterSanitizeShadowDOM",U,null)};return e.sanitize=function(ke){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be,Le,Vt,Gn;if(Ga=!ke,Ga&&(ke="<!-->"),typeof ke!="string"&&!Ie(ke))if(typeof ke.toString=="function"){if(ke=ke.toString(),typeof ke!="string")throw tb("dirty is not a string, aborting")}else throw tb("toString is not a function");if(!e.isSupported)return ke;if(cc||$e(U),e.removed=[],typeof ke=="string"&&($l=!1),$l){if(ke.nodeName){let Gs=re(ke.nodeName);if(!J[Gs]||Re[Gs])throw tb("root node is forbidden and cannot be sanitized in-place")}}else if(ke instanceof a)be=H("<!---->"),Le=be.ownerDocument.importNode(ke,!0),Le.nodeType===1&&Le.nodeName==="BODY"||Le.nodeName==="HTML"?be=Le:be.appendChild(Le);else{if(!_i&&!wi&&!rs&&ke.indexOf("<")===-1)return S&&jl?S.createHTML(ke):ke;if(be=H(ke),!be)return _i?null:jl?w:""}be&&Kl&&D(be.firstChild);let ro=$($l?ke:be);for(;Vt=ro.nextNode();)Ye(Vt)||(Vt.content instanceof r&&nn(Vt.content),Nn(Vt));if($l)return ke;if(_i){if(Gl)for(Gn=N.call(be.ownerDocument);be.firstChild;)Gn.appendChild(be.firstChild);else Gn=be;return(xe.shadowroot||xe.shadowrootmode)&&(Gn=P.call(t,Gn,!0)),Gn}let xn=rs?be.outerHTML:be.innerHTML;return rs&&J["!doctype"]&&be.ownerDocument&&be.ownerDocument.doctype&&be.ownerDocument.doctype.name&&Ar(DB,be.ownerDocument.doctype.name)&&(xn="<!DOCTYPE "+be.ownerDocument.doctype.name+`>
`+xn),wi&&(xn=Ds(xn,j," "),xn=Ds(xn,X," "),xn=Ds(xn,le," ")),S&&jl?S.createHTML(xn):xn},e.setConfig=function(ke){$e(ke),cc=!0},e.clearConfig=function(){O=null,cc=!1},e.isValidAttribute=function(ke,U,be){O||$e({});let Le=re(ke),Vt=re(U);return It(Le,Vt,be)},e.addHook=function(ke,U){typeof U=="function"&&(K[ke]=K[ke]||[],eb(K[ke],U))},e.removeHook=function(ke){if(K[ke])return CB(K[ke])},e.removeHooks=function(ke){K[ke]&&(K[ke]=[])},e.removeAllHooks=function(){K={}},e}var Da=RB();var WFe=Da.version,HFe=Da.isSupported,BC=Da.sanitize,UFe=Da.setConfig,zFe=Da.clearConfig,KFe=Da.isValidAttribute,VC=Da.addHook,WC=Da.removeHook,GFe=Da.removeHooks,jFe=Da.removeAllHooks;function Vn(o,e,t){return Math.min(Math.max(o,e),t)}function MB(o,e){return(e+o%e)%e}var nb=class{_n=1;_val=0;update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}},HC=class{_n=0;_val=0;_values=[];_index=0;_sum=0;constructor(e){this._values=new Array(e),this._values.fill(0,0,e)}update(e){let t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}};var{registerWindow:PB,getWindow:Ce,getDocument:hBe,getWindows:ob,getWindowsCount:zC,getWindowId:Wd,getWindowById:Jc,hasWindow:pBe,onDidRegisterWindow:rb,onWillUnregisterWindow:mBe,onDidUnregisterWindow:FB}=function(){let o=new Map;kC(_e,1);let e={window:_e,disposables:new oe};o.set(_e.vscodeWindowId,e);let t=new T,n=new T,i=new T;function r(s,a){return(typeof s=="number"?o.get(s):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:i.event,onDidUnregisterWindow:n.event,registerWindow(s){if(o.has(s.vscodeWindowId))return B.None;let a=new oe,l={window:s,disposables:a.add(new oe)};return o.set(s.vscodeWindowId,l),a.add(pe(()=>{o.delete(s.vscodeWindowId),n.fire(s)})),a.add(z(s,me.BEFORE_UNLOAD,()=>{i.fire(s)})),t.fire(l),a},getWindows(){return o.values()},getWindowsCount(){return o.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return o.has(s)},getWindowById:r,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:_e},getDocument(s){return Ce(s).document}}}();function dr(o){for(;o.firstChild;)o.firstChild.remove()}var F1=class{_handler;_node;_type;_options;constructor(e,t,n,i){this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function z(o,e,t,n){return new F1(o,e,t,n)}function Gz(o,e){return function(t){return e(new Fi(o,t))}}function jz(o){return function(e){return o(new vt(e))}}var Bi=function(e,t,n,i){let r=n;return t==="click"||t==="mousedown"||t==="contextmenu"?r=Gz(Ce(e),n):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=jz(n)),z(e,t,r,i)};function eu(o,e,t){return Dh(o,e,t)}var V1,Ii;var yp=class extends Ny{defaultTarget;constructor(e){super(),this.defaultTarget=e&&Ce(e)}cancelAndSet(e,t,n){return super.cancelAndSet(e,t,n??this.defaultTarget)}},ib=class{_runner;priority;_canceled;constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Ne(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let o=new Map,e=new Map,t=new Map,n=new Map,i=r=>{t.set(r,!1);let s=o.get(r)??[];for(e.set(r,s),o.set(r,[]),n.set(r,!0);s.length>0;)s.sort(ib.sort),s.shift().execute();n.set(r,!1)};Ii=(r,s,a=0)=>{let l=Wd(r),d=new ib(s,a),c=o.get(l);return c||(c=[],o.set(l,c)),c.push(d),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>i(l))),d},V1=(r,s,a)=>{let l=Wd(r);if(n.get(l)){let d=new ib(s,a),c=e.get(l);return c||(c=[],e.set(l,c)),c.push(d),d}else return Ii(r,s,a)}})();function BB(o){return Ce(o).getComputedStyle(o,null)}function tu(o,e){let t=Ce(o),n=t.document;if(o!==n.body)return new Or(o.clientWidth,o.clientHeight);if(Zl&&t?.visualViewport)return new Or(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new Or(t.innerWidth,t.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new Or(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new Or(n.documentElement.clientWidth,n.documentElement.clientHeight);if(e)return tu(e);throw new Error("Unable to figure out browser width and height")}var lr=class o{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,n){let i=BB(e),r=i?i.getPropertyValue(t):"0";return o.convertToPixels(e,r)}static getBorderLeftWidth(e){return o.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return o.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return o.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return o.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return o.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return o.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return o.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return o.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return o.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return o.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return o.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return o.getDimension(e,"margin-bottom","marginBottom")}},Or=class o{constructor(e,t){this.width=e;this.height=t}static None=new o(0,0);with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new o(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof o?e:new o(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};function sb(o){let e=o.offsetParent,t=o.offsetTop,n=o.offsetLeft;for(;(o=o.parentNode)!==null&&o!==o.ownerDocument.body&&o!==o.ownerDocument.documentElement;){t-=o.scrollTop;let i=HB(o)?null:BB(o);i&&(n-=i.direction!=="rtl"?o.scrollLeft:-o.scrollLeft),o===e&&(n+=lr.getBorderLeftWidth(o),t+=lr.getBorderTopWidth(o),t+=o.offsetTop,n+=o.offsetLeft,e=o.offsetParent)}return{left:n,top:t}}function VB(o,e,t,n,i,r="absolute"){typeof e=="number"&&(o.style.top=`${e}px`),typeof t=="number"&&(o.style.right=`${t}px`),typeof n=="number"&&(o.style.bottom=`${n}px`),typeof i=="number"&&(o.style.left=`${i}px`),o.style.position=r}function cr(o){let e=o.getBoundingClientRect(),t=Ce(o);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function KC(o){let e=lr.getMarginLeft(o)+lr.getMarginRight(o);return o.offsetWidth+e}function GC(o){let e=lr.getBorderLeftWidth(o)+lr.getBorderRightWidth(o),t=lr.getPaddingLeft(o)+lr.getPaddingRight(o);return o.offsetWidth-e-t}function WB(o){let e=lr.getBorderTopWidth(o)+lr.getBorderBottomWidth(o),t=lr.getPaddingTop(o)+lr.getPaddingBottom(o);return o.offsetHeight-e-t}function Jr(o,e){return!!e?.contains(o)}function HB(o){return o&&!!o.host&&!!o.mode}function jC(o){return!!xl(o)}function xl(o){for(;o.parentNode;){if(o===o.ownerDocument?.body)return null;o=o.parentNode}return HB(o)?o:null}function Wo(){let o=W1().activeElement;for(;o?.shadowRoot;)o=o.shadowRoot.activeElement;return o}function nu(o){return Wo()===o}function W1(){return zC()<=1?_e.document:Array.from(ob()).map(({window:e})=>e.document).find(e=>e.hasFocus())??_e.document}function Hd(){return W1().defaultView?.window??_e}var H1=new Map;function UB(o){return H1.has(o)}function es(o=_e.document.head,e,t){let n=document.createElement("style");if(n.type="text/css",n.media="screen",e?.(n),o.appendChild(n),t&&t.add(pe(()=>n.remove())),o===_e.document.head){let i=new Set;H1.set(n,i);for(let{window:r,disposables:s}of ob()){if(r===_e)continue;let a=s.add(KB(n,i,r));t?.add(a)}}return n}function zB(o){let e=new oe;for(let[t,n]of H1)e.add(KB(t,n,o));return e}function KB(o,e,t){let n=new oe,i=o.cloneNode(!0);t.document.head.appendChild(i),n.add(pe(()=>i.remove()));for(let r of $z(o))i.sheet?.insertRule(r.cssText,i.sheet?.cssRules.length);return n.add($C.observe(o,n,{childList:!0})(()=>{i.textContent=o.textContent})),e.add(i),n.add(pe(()=>e.delete(i))),n}var $C=new class{mutationObservers=new Map;observe(o,e,t){let n=this.mutationObservers.get(o);n||(n=new Map,this.mutationObservers.set(o,n));let i=Oo(t),r=n.get(i);if(r)r.users+=1;else{let s=new T,a=new MutationObserver(d=>s.fire(d));a.observe(o,t);let l=r={users:1,observer:a,onDidMutate:s.event};e.add(pe(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),n?.delete(i),n?.size===0&&this.mutationObservers.delete(o))})),n.set(i,r)}return r.onDidMutate}};function GB(o=_e.document.head){return $B("meta",o)}function jB(o=_e.document.head){return $B("link",o)}function $B(o,e=_e.document.head){let t=document.createElement(o);return e.appendChild(t),t}function $z(o){return o?.sheet?.rules?o.sheet.rules:o?.sheet?.cssRules?o.sheet.cssRules:[]}function ai(o){return o instanceof HTMLElement||o instanceof Ce(o).HTMLElement}function qB(o){return o instanceof SVGElement||o instanceof Ce(o).SVGElement}function qC(o){return o instanceof MouseEvent||o instanceof Ce(o).MouseEvent}function U1(o){return o instanceof KeyboardEvent||o instanceof Ce(o).KeyboardEvent}var me={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Ls?"webkitAnimationStart":"animationstart",ANIMATION_END:Ls?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Ls?"webkitAnimationIteration":"animationiteration"};var Qe={stop:(o,e)=>(o.preventDefault(),e&&o.stopPropagation(),o)};function YB(o){let e=[];for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)e[t]=o.scrollTop,o=o.parentNode;return e}function ZB(o,e){for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)o.scrollTop!==e[t]&&(o.scrollTop=e[t]),o=o.parentNode}var B1=class o extends B{_onDidFocus=this._register(new T);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new T);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(e){if(ai(e)){let t=xl(e),n=t?t.activeElement:e.ownerDocument.activeElement;return Jr(n,e)}else{let t=e;return Jr(t.document.activeElement,t.document)}}constructor(e){super();let t=o.hasFocusWithin(e),n=!1,i=()=>{n=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(n=!0,(ai(e)?Ce(e):e).setTimeout(()=>{n&&(n=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{o.hasFocusWithin(e)!==t&&(t?r():i())},this._register(z(e,me.FOCUS,i,!0)),this._register(z(e,me.BLUR,r,!0)),ai(e)&&(this._register(z(e,me.FOCUS_IN,()=>this._refreshStateHandler())),this._register(z(e,me.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function El(o){return new B1(o)}function zt(o,...e){if(o.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function z1(o,e){return o.insertBefore(e,o.firstChild),e}function Tn(o,...e){o.innerText="",zt(o,...e)}var qz=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function XB(o,e,t,...n){let i=qz.exec(e);if(!i)throw new Error("Bad use of emmet");let r=i[1]||"div",s;return o!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(o,r):s=document.createElement(r),i[3]&&(s.id=i[3]),i[4]&&(s.className=i[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...n),s}function je(o,e,...t){return XB("http://www.w3.org/1999/xhtml",o,e,...t)}je.SVG=function(o,e,...t){return XB("http://www.w3.org/2000/svg",o,e,...t)};function K1(o,e){let t=o.devicePixelRatio*e;return Math.max(1,Math.floor(t))/o.devicePixelRatio}function G1(o){_e.open(o,"_blank","noopener")}var NB=780,AB=640;function j1(o){let e=Math.floor(_e.screenLeft+_e.innerWidth/2-NB/2),t=Math.floor(_e.screenTop+_e.innerHeight/2-AB/2);_e.open(o,"_blank",`width=${NB},height=${AB},top=${t},left=${e}`)}function QB(o,e=!0){let t=_e.open();return t?(e&&(t.opener=null),t.location.href=o,!0):!1}function JB(o,e){let t=()=>{e(),n=Ii(o,t)},n=Ii(o,t);return pe(()=>n.dispose())}dy.setPreferredWebSchema(/^https:/.test(_e.location.href)?"https":"http");function ab(o){return o?`url('${ud.uriToBrowserUri(o).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function wl(o,e){if(o!==void 0){let t=o.match(/^\s*var\((.+)\)$/);if(t){let n=t[1].split(",",2);return n.length===2&&(e=wl(n[1].trim(),e)),`var(${n[0]}, ${e})`}return o}return e}function e2(o,e=!1){let t=document.createElement("a");return VC("afterSanitizeAttributes",n=>{for(let i of["href","src"])if(n.hasAttribute(i)){let r=n.getAttribute(i);if(i==="href"&&r.startsWith("#"))continue;if(t.href=r,!o.includes(t.protocol.replace(/:$/,""))){if(e&&i==="src"&&t.href.startsWith("data:"))continue;n.removeAttribute(i)}}}),pe(()=>{WC("afterSanitizeAttributes")})}var gBe=[Ae.http,Ae.https,Ae.command],t2=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),fBe=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});var Ip=class o extends T{_subscriptions=new oe;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(Y.runAndSubscribe(rb,({window:e,disposables:t})=>this.registerListeners(e,t),{window:_e,disposables:this._subscriptions}))}registerListeners(e,t){t.add(z(e,"keydown",n=>{if(n.defaultPrevented)return;let i=new vt(n);if(!(i.keyCode===6&&n.repeat)){if(n.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(n.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(n.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(n.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(i.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=n,this.fire(this._keyStatus))}},!0)),t.add(z(e,"keyup",n=>{n.defaultPrevented||(!n.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!n.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!n.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!n.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=n,this.fire(this._keyStatus)))},!0)),t.add(z(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(z(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(z(e.document.body,"mousemove",n=>{n.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(z(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return o.instance||(o.instance=new o),o.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var UC=class extends B{constructor(t,n){super();this.element=t;this.callbacks=n;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(z(this.element,me.DRAG_START,t=>{this.callbacks.onDragStart?.(t)})),this.callbacks.onDrag&&this._register(z(this.element,me.DRAG,t=>{this.callbacks.onDrag?.(t)})),this._register(z(this.element,me.DRAG_ENTER,t=>{this.counter++,this.dragStartTime=t.timeStamp,this.callbacks.onDragEnter?.(t)})),this._register(z(this.element,me.DRAG_OVER,t=>{t.preventDefault(),this.callbacks.onDragOver?.(t,t.timeStamp-this.dragStartTime)})),this._register(z(this.element,me.DRAG_LEAVE,t=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(t))})),this._register(z(this.element,me.DRAG_END,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(t)})),this._register(z(this.element,me.DROP,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(t)}))}},Yz=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function pn(o,...e){let t,n;Array.isArray(e[0])?(t={},n=e[0]):(t=e[0]||{},n=e[1]);let i=Yz.exec(o);if(!i||!i.groups)throw new Error("Bad use of h");let r=i.groups.tag||"div",s=document.createElement(r);i.groups.id&&(s.id=i.groups.id);let a=[];if(i.groups.class)for(let d of i.groups.class.split("."))d!==""&&a.push(d);if(t.className!==void 0)for(let d of t.className.split("."))d!==""&&a.push(d);a.length>0&&(s.className=a.join(" "));let l={};if(i.groups.name&&(l[i.groups.name]=s),n)for(let d of n)ai(d)?s.appendChild(d):typeof d=="string"?s.append(d):"root"in d&&(Object.assign(l,d),s.appendChild(d.root));for(let[d,c]of Object.entries(t))if(d!=="className")if(d==="style")for(let[u,h]of Object.entries(c))s.style.setProperty(OB(u),typeof h=="number"?h+"px":""+h);else d==="tabIndex"?s.tabIndex=c:s.setAttribute(OB(d),c.toString());return l.root=s,l}function OB(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function YC(o,e,t){for(let{name:n,value:i}of o.attributes)(!t||t.includes(n))&&e.setAttribute(n,i)}function Zz(o,e,t){let n=o.getAttribute(t);n?e.setAttribute(t,n):e.removeAttribute(t)}function ZC(o,e,t){YC(o,e,t);let n=new oe;return n.add($C.observe(o,n,{attributes:!0,attributeFilter:t})(i=>{for(let r of i)r.type==="attributes"&&r.attributeName&&Zz(o,e,r.attributeName)})),n}function Ra(o){return o.tagName.toLowerCase()==="input"||o.tagName.toLowerCase()==="textarea"||ai(o)&&!!o.editContext}var XC={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Vc.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};function he(o,e,t){let n=null,i=null;if(typeof t.value=="function"?(n="value",i=t.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(n="get",i=t.get),!i)throw new Error("not supported");let r=`$memoize$${e}`;t[n]=function(...s){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,s)}),this[r]}}var yt;(r=>(r.Tap="-monaco-gesturetap",r.Change="-monaco-gesturechange",r.Start="-monaco-gesturestart",r.End="-monaco-gesturesend",r.Contextmenu="-monaco-gesturecontextmenu"))(yt||={});var Vi=class Vi extends B{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new ki;ignoreTargets=new ki;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Y.runAndSubscribe(rb,({window:e,disposables:t})=>{t.add(z(e.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),t.add(z(e.document,"touchend",n=>this.onTouchEnd(e,n))),t.add(z(e.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:_e,disposables:this._store}))}static addTarget(e){if(!Vi.isTouchDevice())return B.None;Vi.INSTANCE||(Vi.INSTANCE=id(new Vi));let t=Vi.INSTANCE.targets.push(e);return pe(t)}static ignoreTarget(e){if(!Vi.isTouchDevice())return B.None;Vi.INSTANCE||(Vi.INSTANCE=id(new Vi));let t=Vi.INSTANCE.ignoreTargets.push(e);return pe(t)}static isTouchDevice(){return"ontouchstart"in _e||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,i=e.targetTouches.length;n<i;n++){let r=e.targetTouches.item(n);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};let s=this.newGestureEvent(yt.Start,r.target);s.pageX=r.pageX,s.pageY=r.pageY,this.dispatchEvent(s)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){let n=Date.now(),i=Object.keys(this.activeTouches).length;for(let r=0,s=t.changedTouches.length;r<s;r++){let a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<Vi.HOLD_DELAY&&Math.abs(l.initialPageX-Eo(l.rollingPageX))<30&&Math.abs(l.initialPageY-Eo(l.rollingPageY))<30){let c=this.newGestureEvent(yt.Tap,l.initialTarget);c.pageX=Eo(l.rollingPageX),c.pageY=Eo(l.rollingPageY),this.dispatchEvent(c)}else if(d>=Vi.HOLD_DELAY&&Math.abs(l.initialPageX-Eo(l.rollingPageX))<30&&Math.abs(l.initialPageY-Eo(l.rollingPageY))<30){let c=this.newGestureEvent(yt.Contextmenu,l.initialTarget);c.pageX=Eo(l.rollingPageX),c.pageY=Eo(l.rollingPageY),this.dispatchEvent(c)}else if(i===1){let c=Eo(l.rollingPageX),u=Eo(l.rollingPageY),h=Eo(l.rollingTimestamps)-l.rollingTimestamps[0],m=c-l.rollingPageX[0],g=u-l.rollingPageY[0],f=[...this.targets].filter(b=>l.initialTarget instanceof Node&&b.contains(l.initialTarget));this.inertia(e,f,n,Math.abs(m)/h,m>0?1:-1,c,Math.abs(g)/h,g>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(yt.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let n=document.createEvent("CustomEvent");return n.initEvent(e,!1,!0),n.initialTarget=t,n.tapCount=0,n}dispatchEvent(e){if(e.type===yt.Tap){let t=new Date().getTime(),n=0;t-this._lastSetTapCountTime>Vi.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=t,e.tapCount=n}else(e.type===yt.Change||e.type===yt.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(e.initialTarget))return;let t=[];for(let n of this.targets)if(n.contains(e.initialTarget)){let i=0,r=e.initialTarget;for(;r&&r!==n;)i++,r=r.parentElement;t.push([i,n])}t.sort((n,i)=>n[0]-i[0]);for(let[n,i]of t)i.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,n,i,r,s,a,l,d){this.handle=Ii(e,()=>{let c=Date.now(),u=c-n,h=0,m=0,g=!0;i+=Vi.SCROLL_FRICTION*u,a+=Vi.SCROLL_FRICTION*u,i>0&&(g=!1,h=r*i*u),a>0&&(g=!1,m=l*a*u);let f=this.newGestureEvent(yt.Change);f.translationX=h,f.translationY=m,t.forEach(b=>b.dispatchEvent(f)),g||this.inertia(e,t,c,i,r,s+h,a,l,d+m)})}onTouchMove(e){let t=Date.now();for(let n=0,i=e.changedTouches.length;n<i;n++){let r=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}let s=this.activeTouches[r.identifier],a=this.newGestureEvent(yt.Change,s.initialTarget);a.translationX=r.pageX-Eo(s.rollingPageX),a.translationY=r.pageY-Eo(s.rollingPageY),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(r.pageX),s.rollingPageY.push(r.pageY),s.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};k([he],Vi,"isTouchDevice",1);var Ln=Vi;var no;(i=>{function o(r,s){if(r.start>=s.end||s.start>=r.end)return{start:0,end:0};let a=Math.max(r.start,s.start),l=Math.min(r.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}i.intersect=o;function e(r){return r.end-r.start<=0}i.isEmpty=e;function t(r,s){return!e(o(r,s))}i.intersects=t;function n(r,s){let a=[],l={start:r.start,end:Math.min(s.start,r.end)},d={start:Math.max(s.end,r.start),end:r.end};return e(l)||a.push(l),e(d)||a.push(d),a}i.relativeComplement=n})(no||={});var iu=class{constructor(e){this.domNode=e}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(e){let t=ur(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=ur(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=ur(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=ur(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=ur(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=ur(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=ur(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=ur(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=ur(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=ur(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=ur(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=ur(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=ur(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=ur(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function ur(o){return typeof o=="number"?`${o}px`:o}function Be(o){return new iu(o)}var ka=class{_hooks=new oe;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,e&&n&&n(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,n,i,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=i,this._onStopCallback=r;let s=e;try{e.setPointerCapture(t),this._hooks.add(pe(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=Ce(e)}this._hooks.add(z(s,me.POINTER_MOVE,a=>{if(a.buttons!==n){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(z(s,me.POINTER_UP,a=>this.stopMonitoring(!0)))}};var Ho=class extends B{onclick(e,t){this._register(z(e,me.CLICK,n=>t(new Fi(Ce(e),n))))}onmousedown(e,t){this._register(z(e,me.MOUSE_DOWN,n=>t(new Fi(Ce(e),n))))}onmouseover(e,t){this._register(z(e,me.MOUSE_OVER,n=>t(new Fi(Ce(e),n))))}onmouseleave(e,t){this._register(z(e,me.MOUSE_LEAVE,n=>t(new Fi(Ce(e),n))))}onkeydown(e,t){this._register(z(e,me.KEY_DOWN,n=>t(new vt(n))))}onkeyup(e,t){this._register(z(e,me.KEY_UP,n=>t(new vt(n))))}oninput(e,t){this._register(z(e,me.INPUT,t))}onblur(e,t){this._register(z(e,me.BLUR,t))}onfocus(e,t){this._register(z(e,me.FOCUS,t))}onchange(e,t){this._register(z(e,me.CHANGE,t))}ignoreGesture(e){return Ln.ignoreTarget(e)}};var Ud=11,QC=class extends Ho{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Xe.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=Ud+"px",this.domNode.style.height=Ud+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new ka),this._register(Bi(this.bgDomNode,me.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(Bi(this.domNode,me.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new yp),this._pointerdownScheduleRepeatTimer=this._register(new bs)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Ce(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}};var Cp=class o{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(e,t,n,i,r,s){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(e),this._visibleSize=i,this._scrollSize=r,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new o(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){let t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,n,i,r){let s=Math.max(0,n-e),a=Math.max(0,s-2*t),l=i>0&&i>n;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(n*a/i))),c=(a-d)/(i-n),u=r*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){let e=o._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize,n=this._scrollPosition;return t<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}};var JC=class extends B{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(e,t,n){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new bs)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}};var Qz=140,Sp=class extends Ho{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new JC(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new ka),this._shouldRender=!0,this.domNode=Be(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(z(this.domNode.domNode,me.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new QC(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,n,i){this.slider=Be(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof n=="number"&&this.slider.setWidth(n),typeof i=="number"&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(z(this.slider.domNode,me.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,n=t+this._scrollbarState.getSliderPosition(),i=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);n<=r&&r<=i?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,n;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,n=e.offsetY;else{let r=cr(this.domNode.domNode);t=e.pageX-r.left,n=e.pageY-r.top}let i=this._pointerDownRelativePosition(t,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),n=this._sliderOrthogonalPointerPosition(e),i=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{let s=this._sliderOrthogonalPointerPosition(r),a=Math.abs(s-n);if(ft&&a>Qz){this._setDesiredScrollPositionNow(i.getScrollPosition());return}let d=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(i.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var eS=class extends Sp{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Cp(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,i.width,i.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){let s=(t.arrowSize-Ud)/2,a=(t.horizontalScrollbarSize-Ud)/2;this._createArrow({className:"scra",icon:ue.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Nr(null,1,0))}),this._createArrow({className:"scra",icon:ue.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Nr(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}};var tS=class extends Sp{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Cp(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,i.height,i.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){let s=(t.arrowSize-Ud)/2,a=(t.verticalScrollbarSize-Ud)/2;this._createArrow({className:"scra",icon:ue.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Nr(null,0,1))}),this._createArrow({className:"scra",icon:ue.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Nr(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}};var Jz=500,o2=50,r2=!0,$1=class{timestamp;deltaX;deltaY;score;constructor(e,t,n){this.timestamp=e,this.deltaX=t,this.deltaY=n,this.score=0}},lb=class o{static INSTANCE=new o;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,n=1,i=this._rear;do{let r=i===this._front?e:Math.pow(2,-n);if(e-=r,t+=this._memory[i].score*r,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(Bd){let t=Ce(e.browserEvent),n=gB(t);this.accept(Date.now(),e.deltaX*n,e.deltaY*n)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,n){let i=null,r=new $1(e,t,n);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(i=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,i)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(n+=.25),t){let i=Math.abs(e.deltaX),r=Math.abs(e.deltaY),s=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(i,s),1),d=Math.max(Math.min(r,a),1),c=Math.max(i,s),u=Math.max(r,a);c%l===0&&u%d===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}},q1=class extends Ho{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new T);onScroll=this._onScroll.event;_onWillScroll=this._register(new T);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(e,t,n){super(),e.style.overflow="hidden",this._options=e7(t),this._scrollable=n,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));let i={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new tS(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new eS(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Be(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Be(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Be(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new bs),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=Nt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Fe&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Nr(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Nt(this._mouseWheelToDispose),e)){let n=i=>{this._onMouseWheel(new Nr(i))};this._mouseWheelToDispose.push(z(this._listenOnDomNode,me.MOUSE_WHEEL,n,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=lb.INSTANCE;r2&&t.acceptStandardWheelEvent(e);let n=!1;if(e.deltaY||e.deltaX){let r=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+r===0?s=r=0:Math.abs(r)>=Math.abs(s)?s=0:r=0),this._options.flipAxes&&([r,s]=[s,r]);let a=!Fe&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=r,r=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(r){let c=o2*r,u=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,u)}if(s){let c=o2*s,u=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,u)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(r2&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),n=!0)}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,n=e.scrollLeft>0,i=n?" left":"",r=t?" top":"",s=n||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${r}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),Jz)}};var zd=class extends q1{constructor(e,t,n){super(e,t,n)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};function e7(o){let e={lazyRender:typeof o.lazyRender<"u"?o.lazyRender:!1,className:typeof o.className<"u"?o.className:"",useShadows:typeof o.useShadows<"u"?o.useShadows:!0,handleMouseWheel:typeof o.handleMouseWheel<"u"?o.handleMouseWheel:!0,flipAxes:typeof o.flipAxes<"u"?o.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof o.consumeMouseWheelIfScrollbarIsNeeded<"u"?o.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof o.alwaysConsumeMouseWheel<"u"?o.alwaysConsumeMouseWheel:!1,scrollYToX:typeof o.scrollYToX<"u"?o.scrollYToX:!1,mouseWheelScrollSensitivity:typeof o.mouseWheelScrollSensitivity<"u"?o.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof o.fastScrollSensitivity<"u"?o.fastScrollSensitivity:5,scrollPredominantAxis:typeof o.scrollPredominantAxis<"u"?o.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof o.mouseWheelSmoothScroll<"u"?o.mouseWheelSmoothScroll:!0,arrowSize:typeof o.arrowSize<"u"?o.arrowSize:11,listenOnDomNode:typeof o.listenOnDomNode<"u"?o.listenOnDomNode:null,horizontal:typeof o.horizontal<"u"?o.horizontal:1,horizontalScrollbarSize:typeof o.horizontalScrollbarSize<"u"?o.horizontalScrollbarSize:10,horizontalSliderSize:typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:0,horizontalHasArrows:typeof o.horizontalHasArrows<"u"?o.horizontalHasArrows:!1,vertical:typeof o.vertical<"u"?o.vertical:1,verticalScrollbarSize:typeof o.verticalScrollbarSize<"u"?o.verticalScrollbarSize:10,verticalHasArrows:typeof o.verticalHasArrows<"u"?o.verticalHasArrows:!1,verticalSliderSize:typeof o.verticalSliderSize<"u"?o.verticalSliderSize:0,scrollByPage:typeof o.scrollByPage<"u"?o.scrollByPage:!1};return e.horizontalSliderSize=typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof o.verticalSliderSize<"u"?o.verticalSliderSize:e.verticalScrollbarSize,Fe&&(e.className+=" mac"),e}var t7=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),Y1=t7,n7=new $n(()=>Y1("mouse",!1)),i7=new $n(()=>Y1("element",!1));function Uo(o){return o==="element"?i7.value:n7.value}function ou(){return Y1("element",!0)}function a2(o){let e=o.inline?"span":"div",t=document.createElement(e);return o.className&&(t.className=o.className),t}var Oe=class{emitter;get event(){return this.emitter.event}constructor(e,t,n){let i=r=>this.emitter.fire(r);this.emitter=new T({onWillAddFirstListener:()=>e.addEventListener(t,i,n),onDidRemoveLastListener:()=>e.removeEventListener(t,i,n)})}dispose(){this.emitter.dispose()}};var l2=2e4,u2,Z1,d2,X1,c2;function db(o){u2&&(Z1.textContent!==o?(dr(d2),nS(Z1,o)):(dr(Z1),nS(d2,o)))}function Q1(o){u2&&(X1.textContent!==o?(dr(c2),nS(X1,o)):(dr(X1),nS(c2,o)))}function nS(o,e){dr(o),e.length>l2&&(e=e.substr(0,l2)),o.textContent=e,o.style.visibility="hidden",o.style.visibility="visible"}var iS=class{constructor(e){this.spliceables=e}splice(e,t,n){this.spliceables.forEach(i=>i.splice(e,t,n))}};function h2(o,e){let t=[];for(let n of e){if(o.start>=n.range.end)continue;if(o.end<n.range.start)break;let i=no.intersect(o,n.range);no.isEmpty(i)||t.push({range:i,size:n.size})}return t}function rS({start:o,end:e},t){return{start:o+t,end:e+t}}function r7(o){let e=[],t=null;for(let n of o){let i=n.range.start,r=n.range.end,s=n.size;if(t&&s===t.size){t.range.end=r;continue}t={range:{start:i,end:r},size:s},e.push(t)}return e}function s7(...o){return r7(o.reduce((e,t)=>e.concat(t),[]))}var oS=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,n=[]){let i=n.length-t,r=h2({start:0,end:e},this.groups),s=h2({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:rS(l.range,i),size:l.size})),a=n.map((l,d)=>({range:{start:e+d,end:e+d+1},size:l.size}));this.groups=s7(r,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,n=this._paddingTop;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r*i.size;if(e<s)return t+Math.floor((e-n)/i.size);t+=r,n=s}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,n=0;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r;if(e<s)return this._paddingTop+t+(e-n)*i.size;t+=r*i.size,n=s}return-1}};var sS=class{constructor(e){this.renderers=e}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(e){let t=this.getTemplateCache(e).pop(),n=!1;if(t)n=this.transactionNodesPendingRemoval.has(t.domNode),n&&this.transactionNodesPendingRemoval.delete(t.domNode);else{let i=je(".monaco-list-row"),s=this.getRenderer(e).renderTemplate(i);t={domNode:i,templateId:e,templateData:s}}return{row:t,isReusingConnectedDomNode:n}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(let t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){let{domNode:t,templateId:n}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(n).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(let n of e)this.getRenderer(t).disposeTemplate(n.templateData),n.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){let t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}};var ru={CurrentDragAndDropData:void 0};var Ma={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(o){return[o]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},aS=class{elements;_context;get context(){return this._context}set context(e){this._context=e}constructor(e){this.elements=e}update(){}getData(){return this.elements}},J1=class{elements;constructor(e){this.elements=e}update(){}getData(){return this.elements}},e0=class{types;files;constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){let n=e.files.item(t);n&&(n.size||n.type)&&this.files.push(n)}}}getData(){return{types:this.types,files:this.files}}};function a7(o,e){return Array.isArray(o)&&Array.isArray(e)?Lt(o,e):o===e}var t0=class{getSetSize;getPosInSet;getRole;isChecked;constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,n,i)=>i,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,n)=>n+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}},hr=class hr{constructor(e,t,n,i=Ma){this.virtualDelegate=t;if(i.horizontalScrolling&&i.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(i.paddingTop??0);for(let s of n)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new sS(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof i.mouseSupport=="boolean"?i.mouseSupport:!0),this._horizontalScrolling=i.horizontalScrolling??Ma.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof i.paddingBottom>"u"?0:i.paddingBottom,this.accessibilityProvider=new t0(i.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(i.transformOptimization??Ma.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Ln.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new rl({forceIntegerValues:!0,smoothScrollDuration:i.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>Ii(Ce(this.domNode),s)})),this.scrollableElement=this.disposables.add(new zd(this.rowsContainer,{alwaysConsumeMouseWheel:i.alwaysConsumeMouseWheel??Ma.alwaysConsumeMouseWheel,horizontal:1,vertical:i.verticalScrollMode??Ma.verticalScrollMode,useShadows:i.useShadows??Ma.useShadows,mouseWheelScrollSensitivity:i.mouseWheelScrollSensitivity,fastScrollSensitivity:i.fastScrollSensitivity,scrollByPage:i.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(z(this.rowsContainer,yt.Change,s=>this.onTouchChange(s))),this.disposables.add(z(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(z(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(z(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(z(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(z(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=i.setRowLineHeight??Ma.setRowLineHeight,this.setRowHeight=i.setRowHeight??Ma.setRowHeight,this.supportDynamicHeights=i.supportDynamicHeights??Ma.supportDynamicHeights,this.dnd=i.dnd??this.disposables.add(Ma.dnd),this.layout(i.initialSize?.height,i.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++hr.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new fs(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=B.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=B.None;onDragLeaveTimeout=B.None;disposables=new oe;_onDidChangeContentHeight=new T;_onDidChangeContentWidth=new T;onDidChangeContentHeight=Y.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=Y.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:GC(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),i=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(n,Math.max(0,this.lastRenderTop+i),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(e){this.scrollableElement.delegateScrollFromMouseWheelEvent(e)}delegateVerticalScrollbarPointerDown(e){this.scrollableElement.delegateVerticalScrollbarPointerDown(e)}updateElementHeight(e,t,n){if(e<0||e>=this.items.length)return;let i=this.items[e].size;if(typeof t>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[e].lastDynamicHeightWidth=void 0,t=i+this.probeDynamicHeight(e)}if(i===t)return;let r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;e<r.start||n!==null&&n>e&&n<r.end?s=t-i:s=0,this.rangeMap.splice(e,1,[{size:t}]),this.items[e].size=t,this.render(r,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(e){return new oS(e)}splice(e,t,n=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,n)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,n=[]){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},s=no.intersect(i,r),a=new Map;for(let R=s.end-1;R>=s.start;R--){let M=this.items[R];if(M.dragStartDisposable.dispose(),M.checkedDisposable.dispose(),M.row){let N=a.get(M.templateId);N||(N=[],a.set(M.templateId,N));let A=this.renderers.get(M.templateId);A&&A.disposeElement&&A.disposeElement(M.element,R,M.row.templateData,M.size),N.unshift(M.row)}M.row=null,M.stale=!0}let l={start:e+t,end:this.items.length},d=no.intersect(l,i),c=no.relativeComplement(l,i),u=n.map(R=>({id:String(this.itemId++),element:R,templateId:this.virtualDelegate.getTemplateId(R),size:this.virtualDelegate.getHeight(R),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(R),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:B.None,checkedDisposable:B.None,stale:!1})),h;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),h=this.items,this.items=u):(this.rangeMap.splice(e,t,u),h=this.items.splice(e,t,...u));let m=n.length-t,g=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),f=rS(d,m),b=no.intersect(g,f);for(let R=b.start;R<b.end;R++)this.updateItemInDOM(this.items[R],R);let y=no.relativeComplement(f,g);for(let R of y)for(let M=R.start;M<R.end;M++)this.removeItemFromDOM(M);let C=c.map(R=>rS(R,m)),w=[{start:e,end:e+n.length},...C].map(R=>no.intersect(g,R)).reverse();for(let R of w)for(let M=R.end-1;M>=R.start;M--){let N=this.items[M],P=a.get(N.templateId)?.pop();this.insertItemInDOM(M,P)}for(let R of a.values())for(let M of R)this.cache.release(M);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),h.map(R=>R.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Ii(Ce(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(let t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(e){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let t=this.items[e];this.measureItemWidth(t),typeof t.width<"u"&&t.width>this.scrollWidth&&(this.scrollWidth=t.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let e=this.firstVisibleIndex,t=this.rangeMap.positionAt(e),n=this.rangeMap.positionAt(e+1);return n!==-1&&(n-t)/2+t<this.scrollTop?e+1:e}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){let t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let n={height:typeof e=="number"?e:WB(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,n.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(n),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:GC(this.domNode)})}render(e,t,n,i,r,s=!1){let a=this.getRenderRange(t,n),l=no.relativeComplement(a,e).reverse(),d=no.relativeComplement(e,a);if(s){let c=no.intersect(e,a);for(let u=c.start;u<c.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(let c of d)for(let u=c.start;u<c.end;u++)this.removeItemFromDOM(u);for(let c of l)for(let u=c.end-1;u>=c.start;u--)this.insertItemInDOM(u)}),i!==void 0&&(this.rowsContainer.style.left=`-${i}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=n}insertItemInDOM(e,t){let n=this.items[e];if(!n.row)if(t)n.row=t,n.stale=!0;else{let l=this.cache.alloc(n.templateId);n.row=l.row,n.stale||=l.isReusingConnectedDomNode}let i=this.accessibilityProvider.getRole(n.element)||"listitem";n.row.domNode.setAttribute("role",i);let r=this.accessibilityProvider.isChecked(n.element);if(typeof r=="boolean")n.row.domNode.setAttribute("aria-checked",String(!!r));else if(r){let l=d=>n.row.domNode.setAttribute("aria-checked",String(!!d));l(r.value),n.checkedDisposable=r.onDidChange(()=>l(r.value))}if(n.stale||!n.row.domNode.parentElement){let l=this.items.at(e+1)?.row?.domNode??null;(n.row.domNode.parentElement!==this.rowsContainer||n.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(n.row.domNode,l),n.stale=!1}this.updateItemInDOM(n,e);let s=this.renderers.get(n.templateId);if(!s)throw new Error(`No renderer found for template id ${n.templateId}`);s?.renderElement(n.element,e,n.row.templateData,n.size);let a=this.dnd.getDragURI(n.element);n.dragStartDisposable.dispose(),n.row.domNode.draggable=!!a,a&&(n.dragStartDisposable=z(n.row.domNode,"dragstart",l=>this.onDragStart(n.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(n),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=GC(e.row.domNode);let t=Ce(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){let t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let n=this.renderers.get(t.templateId);n&&n.disposeElement&&n.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:e})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return Y.map(this.disposables.add(new Oe(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return Y.map(this.disposables.add(new Oe(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return Y.filter(Y.map(this.disposables.add(new Oe(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseUp(){return Y.map(this.disposables.add(new Oe(this.domNode,"mouseup")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDown(){return Y.map(this.disposables.add(new Oe(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return Y.map(this.disposables.add(new Oe(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMove(){return Y.map(this.disposables.add(new Oe(this.domNode,"mousemove")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return Y.map(this.disposables.add(new Oe(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return Y.any(Y.map(this.disposables.add(new Oe(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),Y.map(this.disposables.add(new Oe(this.domNode,yt.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return Y.map(this.disposables.add(new Oe(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return Y.map(this.disposables.add(new Oe(this.rowsContainer,yt.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toTouchEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toGestureEvent(e){let t=this.getItemIndexFromEventTarget(e.initialTarget||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toDragEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:i,sector:r}}onScroll(e){try{let t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,n){if(!n.dataTransfer)return;let i=this.dnd.getDragElements(e);if(n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setData(XC.TEXT,t),n.dataTransfer.setDragImage){let r;this.dnd.getDragLabel&&(r=this.dnd.getDragLabel(i,n)),typeof r>"u"&&(r=String(i.length));let s=je(".monaco-drag-image");s.textContent=r,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),n.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new aS(i),ru.CurrentDragAndDropData=new J1(i),this.dnd.onDragStart?.(this.currentDragData,n)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),ru.CurrentDragAndDropData&&ru.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(ru.CurrentDragAndDropData)this.currentDragData=ru.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new e0}let t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let n;typeof t!="boolean"&&t.feedback?n=t.feedback:typeof e.index>"u"?n=[-1]:n=[e.index],n=qa(n).filter(r=>r>=-1&&r<this.length).sort((r,s)=>r-s),n=n[0]===-1?[-1]:n;let i=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(a7(this.currentDragFeedback,n)&&this.currentDragFeedbackPosition===i)return!0;if(this.currentDragFeedback=n,this.currentDragFeedbackPosition=i,this.currentDragFeedbackDisposable.dispose(),n[0]===-1)this.domNode.classList.add(i),this.rowsContainer.classList.add(i),this.currentDragFeedbackDisposable=pe(()=>{this.domNode.classList.remove(i),this.rowsContainer.classList.remove(i)});else{if(n.length>1&&i!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");i==="drop-target-after"&&n[0]<this.length-1&&(n[0]+=1,i="drop-target-before");for(let r of n){let s=this.items[r];s.dropTarget=!0,s.row?.domNode.classList.add(i)}this.currentDragFeedbackDisposable=pe(()=>{for(let r of n){let s=this.items[r];s.dropTarget=!1,s.row?.domNode.classList.remove(i)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=kh(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;let t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,ru.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,ru.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=B.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){let t=sb(this.domNode).top;this.dragOverAnimationDisposable=JB(Ce(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=kh(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;let t=this.dragOverMouseY-e,n=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>n&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-n))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;let n=e.offsetY/this.items[t].size,i=Math.floor(n/.25);return Vn(i,0,3)}getItemIndexFromEventTarget(e){let t=this.scrollableElement.getDomNode(),n=e;for(;(ai(n)||qB(n))&&n!==this.rowsContainer&&t.contains(n);){let i=n.getAttribute("data-index");if(i){let r=Number(i);if(!isNaN(r))return r}n=n.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,n){let i=this.getRenderRange(e,t),r,s;e===this.elementTop(i.start)?(r=i.start,s=0):i.end-i.start>1&&(r=i.start+1,s=this.elementTop(r)-e);let a=0;for(;;){let l=this.getRenderRange(e,t),d=!1;for(let c=l.start;c<l.end;c++){let u=this.probeDynamicHeight(c);u!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=u,d=d||u!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=no.relativeComplement(i,l);for(let h of c)for(let m=h.start;m<h.end;m++)this.items[m].row&&this.removeItemFromDOM(m);let u=no.relativeComplement(l,i).reverse();for(let h of u)for(let m=h.end-1;m>=h.start;m--)this.insertItemInDOM(m);for(let h=l.start;h<l.end;h++)this.items[h].row&&this.updateItemInDOM(this.items[h],h);if(typeof r=="number"){let h=this.scrollable.getFutureScrollPosition().scrollTop-e,m=this.elementTop(r)-s+h;this.setScrollTop(m,n)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){let t=this.items[e];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(t.element);if(s!==null){let a=t.size;return t.size=s,t.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;let n=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!Jr(t.row.domNode,Ce(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-n;let{row:i}=this.cache.alloc(t.templateId);i.domNode.style.height="",this.rowsContainer.appendChild(i.domNode);let r=this.renderers.get(t.templateId);if(!r)throw new Te("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,i.templateData,void 0),t.size=i.domNode.offsetHeight,r.disposeElement?.(t.element,e,i.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,i.domNode.remove(),this.cache.release(i),t.size-n}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(let e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};k([he],hr.prototype,"onMouseClick",1),k([he],hr.prototype,"onMouseDblClick",1),k([he],hr.prototype,"onMouseMiddleClick",1),k([he],hr.prototype,"onMouseUp",1),k([he],hr.prototype,"onMouseDown",1),k([he],hr.prototype,"onMouseOver",1),k([he],hr.prototype,"onMouseMove",1),k([he],hr.prototype,"onMouseOut",1),k([he],hr.prototype,"onContextMenu",1),k([he],hr.prototype,"onTouchStart",1),k([he],hr.prototype,"onTap",1);var lS=hr;var Na=class extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}};var n0=class{constructor(e){this.trait=e}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,n){let i=this.renderedElements.findIndex(r=>r.templateData===n);if(i>=0){let r=this.renderedElements[i];this.trait.unrender(n),r.index=t}else{let r={index:t,templateData:n};this.renderedElements.push(r)}this.trait.renderIndex(t,n)}splice(e,t,n){let i=[];for(let r of this.renderedElements)r.index<e?i.push(r):r.index>=e+t&&i.push({index:r.index+n-t,templateData:r.templateData});this.renderedElements=i}renderIndexes(e){for(let{index:t,templateData:n}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,n)}disposeTemplate(e){let t=this.renderedElements.findIndex(n=>n.templateData===e);t<0||this.renderedElements.splice(t,1)}},xp=class{constructor(e){this._trait=e}indexes=[];sortedIndexes=[];_onChange=new T;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new n0(this)}splice(e,t,n){let i=n.length-t,r=e+t,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)s.push(this.sortedIndexes[a++]);for(let l=0;l<n.length;l++)n[l]&&s.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)s.push(this.sortedIndexes[a++]+i);this.renderer.splice(e,t,n.length),this._set(s,s)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(m2),t)}_set(e,t,n){let i=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;let s=a0(r,e);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:e,browserEvent:n}),i}get(){return this.indexes}contains(e){return MM(this.sortedIndexes,e,m2)>=0}dispose(){Nt(this._onChange)}};k([he],xp.prototype,"renderer",1);var i0=class extends xp{constructor(t){super("selected");this.setAriaSelected=t}renderIndex(t,n){super.renderIndex(t,n),this.setAriaSelected&&(this.contains(t)?n.setAttribute("aria-selected","true"):n.setAttribute("aria-selected","false"))}},ub=class{constructor(e,t,n){this.trait=e;this.view=t;this.identityProvider=n}splice(e,t,n){if(!this.identityProvider)return this.trait.splice(e,t,new Array(n.length).fill(!1));let i=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(i.length===0)return this.trait.splice(e,t,new Array(n.length).fill(!1));let r=new Set(i),s=n.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,s)}};function g2(o,e){return o.classList.contains(e)?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:g2(o.parentElement,e)}function cb(o){return g2(o,"monaco-editor")}var dS=class{constructor(e,t,n){this.list=e;this.view=t;this.multipleSelectionSupport=n.multipleSelectionSupport,this.disposables.add(this.onKeyDown(i=>{switch(i.keyCode){case 3:return this.onEnter(i);case 16:return this.onUpArrow(i);case 18:return this.onDownArrow(i);case 11:return this.onPageUpArrow(i);case 12:return this.onPageDownArrow(i);case 9:return this.onEscape(i);case 31:this.multipleSelectionSupport&&(Fe?i.metaKey:i.ctrlKey)&&this.onCtrlA(i)}}))}disposables=new oe;multipleSelectionDisposables=new oe;multipleSelectionSupport;get onKeyDown(){return Y.chain(this.disposables.add(new Oe(this.view.domNode,"keydown")).event,e=>e.filter(t=>!Ra(t.target)).map(t=>new vt(t)))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(zi(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};k([he],dS.prototype,"onKeyDown",1);var c7=new class{mightProducePrintableCharacter(o){return o.ctrlKey||o.metaKey||o.altKey?!1:o.keyCode>=31&&o.keyCode<=56||o.keyCode>=21&&o.keyCode<=30||o.keyCode>=98&&o.keyCode<=107||o.keyCode>=85&&o.keyCode<=95}},o0=class{constructor(e,t,n,i,r){this.list=e;this.view=t;this.keyboardNavigationLabelProvider=n;this.keyboardNavigationEventFilter=i;this.delegate=r;this.updateOptions(e.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new oe;disposables=new oe;updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let e=!1,t=Y.chain(this.enabledDisposables.add(new Oe(this.view.domNode,"keydown")).event,r=>r.filter(s=>!Ra(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new vt(s)).filter(s=>e||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>Qe.stop(s,!0)).map(s=>s.browserEvent.key)),n=Y.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);Y.reduce(Y.any(t,n),(r,s)=>s===null?null:(r||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),n(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),n(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){let t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?db(t):t&&db(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=0,this.triggered=!1;return}let t=this.list.getFocus(),n=t.length>0?t[0]:0,i=this.state===0?1:0;this.state=1;for(let r=0;r<this.list.length;r++){let s=(n+r+i)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(yh(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}let d=dA(e,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||yh(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},r0=class{constructor(e,t){this.list=e;this.view=t;let n=Y.chain(this.disposables.add(new Oe(t.domNode,"keydown")).event,r=>r.filter(s=>!Ra(s.target)).map(s=>new vt(s)));Y.chain(n,r=>r.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new oe;onTab(e){if(e.target!==this.view.domNode)return;let t=this.list.getFocus();if(t.length===0)return;let n=this.view.domElement(t[0]);if(!n)return;let i=n.querySelector("[tabIndex]");if(!i||!ai(i)||i.tabIndex===-1)return;let r=Ce(i).getComputedStyle(i);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),i.focus())}dispose(){this.disposables.dispose()}};function u7(o){return Fe?o.browserEvent.metaKey:o.browserEvent.ctrlKey}function h7(o){return o.browserEvent.shiftKey}function p7(o){return qC(o)&&o.button===2}var p2={isSelectionSingleChangeEvent:u7,isSelectionRangeChangeEvent:h7},cS=class{constructor(e){this.list=e;e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||p2),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Ln.addTarget(e.getHTMLElement()))),Y.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new oe;_onPointer=new T;onPointer=this._onPointer.event;updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||p2))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){cb(e.browserEvent.target)||Wo()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(Ra(e.browserEvent.target)||cb(e.browserEvent.target))return;let t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||Ra(e.browserEvent.target)||cb(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),p7(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(Ra(e.browserEvent.target)||cb(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){let t=e.index,n=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof n>"u"&&(n=this.list.getFocus()[0]??t,this.list.setAnchor(n));let i=Math.min(n,t),r=Math.max(n,t),s=zi(i,r+1),a=this.list.getSelection(),l=g7(a0(a,[n]),n);if(l.length===0)return;let d=a0(s,f7(a,l));this.list.setSelection(d,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){let i=this.list.getSelection(),r=i.filter(s=>s!==t);this.list.setFocus([t]),this.list.setAnchor(t),i.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}},s0=class{constructor(e,t){this.styleElement=e;this.selectorSuffix=t}style(e){let t=this.selectorSuffix&&`.${this.selectorSuffix}`,n=[];e.listBackground&&n.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&n.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(n.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&n.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);let i=wl(e.listFocusAndSelectionOutline,wl(e.listSelectionOutline,e.listFocusOutline??""));i&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${i}; outline-offset: -1px;}`),e.listFocusOutline&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);let r=wl(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&n.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&n.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&n.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&n.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&n.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&n.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&n.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=n.join(`
`)}},f2={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:W.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:W.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:W.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},m7={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function g7(o,e){let t=o.indexOf(e);if(t===-1)return[];let n=[],i=t-1;for(;i>=0&&o[i]===e-(t-i);)n.push(o[i--]);for(n.reverse(),i=t;i<o.length&&o[i]===e+(i-t);)n.push(o[i++]);return n}function a0(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){t.push(o[n]),n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):t.push(e[i++]);return t}function f7(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):i++;return t}var m2=(o,e)=>o-e,l0=class{constructor(e,t){this._templateId=e;this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,n,i){let r=0;for(let s of this.renderers)s.renderElement(e,t,n[r++],i)}disposeElement(e,t,n,i){let r=0;for(let s of this.renderers)s.disposeElement?.(e,t,n[r],i),r+=1}disposeTemplate(e){let t=0;for(let n of this.renderers)n.disposeTemplate(e[t++])}},d0=class{constructor(e){this.accessibilityProvider=e}templateId="a18n";renderTemplate(e){return{container:e,disposables:new oe}}renderElement(e,t,n){let i=this.accessibilityProvider.getAriaLabel(e),r=i&&typeof i!="string"?i:Fv(i);n.disposables.add(Wt(a=>{this.setAriaLabel(a.readObservable(r),n.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof s=="number"?n.container.setAttribute("aria-level",`${s}`):n.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,n,i){n.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}},c0=class{constructor(e,t){this.list=e;this.dnd=t}getDragElements(e){let t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,n,i,r){return this.dnd.onDragOver(e,t,n,i,r)}onDragLeave(e,t,n,i){this.dnd.onDragLeave?.(e,t,n,i)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,n,i,r){this.dnd.drop(e,t,n,i,r)}dispose(){this.dnd.dispose()}},Pr=class{constructor(e,t,n,i,r=m7){this.user=e;this._options=r;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new i0(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new d0(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),i=i.map(d=>new l0(d.templateId,[...a,d]));let l={...r,dnd:r.dnd&&new c0(this,r.dnd)};if(this.view=this.createListView(t,n,i,l),this.view.domNode.setAttribute("role",s),r.styleController)this.styleController=r.styleController(this.view.domId);else{let d=es(this.view.domNode);this.styleController=new s0(d,this.view.domId)}if(this.spliceable=new iS([new ub(this.focus,this.view,r.identityProvider),new ub(this.selection,this.view,r.identityProvider),new ub(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new r0(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new dS(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){let d=r.keyboardNavigationDelegate||c7;this.typeNavigationController=new o0(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new xp("focused");selection;anchor=new xp("anchor");eventBufferer=new ch;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new oe;get onDidChangeFocus(){return Y.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return Y.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1,t=Y.chain(this.disposables.add(new Oe(this.view.domNode,"keydown")).event,r=>r.map(s=>new vt(s)).filter(s=>e=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>Qe.stop(s,!0)).filter(()=>!1)),n=Y.chain(this.disposables.add(new Oe(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(s=>new vt(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>Qe.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),i=Y.chain(this.view.onContextMenu,r=>r.filter(s=>!e).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new Fi(Ce(this.view.domNode),l),browserEvent:l})));return Y.any(t,n,i)}get onKeyDown(){return this.disposables.add(new Oe(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new Oe(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new Oe(this.view.domNode,"keypress")).event}get onDidFocus(){return Y.signal(this.disposables.add(new Oe(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return Y.signal(this.disposables.add(new Oe(this.view.domNode,"blur",!0)).event)}_onDidDispose=new T;onDidDispose=this._onDidDispose.event;createListView(e,t,n,i){return new lS(e,t,n,i)}createMouseController(e){return new cS(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,n=[]){if(e<0||e>this.view.length)throw new Na(this.user,`Invalid start index: ${e}`);if(t<0)throw new Na(this.user,`Invalid delete count: ${t}`);t===0&&n.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,n))}updateWidth(e){this.view.updateWidth(e)}updateElementHeight(e,t){this.view.updateElementHeight(e,t,null)}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(e){this.view.setScrollLeft(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(e,t){for(let n of e)if(n<0||n>=this.length)throw new Na(this.user,`Invalid index ${n}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new Na(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(let n of e)if(n<0||n>=this.length)throw new Na(this.user,`Invalid index ${n}`);this.focus.set(e,t)}focusNext(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findNextIndex(r.length>0?r[0]+e:0,t,i);s>-1&&this.setFocus([s],n)}focusPrevious(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findPreviousIndex(r.length>0?r[0]-e:0,t,i);s>-1&&this.setFocus([s],n)}async focusNextPage(e,t){let n=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);n=n===0?0:n-1;let i=this.getFocus()[0];if(i!==n&&(i===void 0||n>i)){let r=this.findPreviousIndex(n,!1,t);r>-1&&i!==r?this.setFocus([r],e):this.setFocus([n],e)}else{let r=this.view.getScrollTop(),s=r+this.view.renderHeight;n>i&&(s-=this.view.elementHeight(n)),this.view.setScrollTop(s),this.view.getScrollTop()!==r&&(this.setFocus([]),await nr(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,n=()=>0){let i,r=n(),s=this.view.getScrollTop()+r;s===0?i=this.view.indexAt(s):i=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==i&&(a===void 0||a>=i)){let l=this.findNextIndex(i,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([i],e)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-r),this.view.getScrollTop()+n()!==l&&(this.setFocus([]),await nr(0),await this.focusPreviousPage(e,t,n))}}focusLast(e,t){if(this.length===0)return;let n=this.findPreviousIndex(this.length-1,!1,t);n>-1&&this.setFocus([n],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,n){if(this.length===0)return;let i=this.findNextIndex(e,!1,n);i>-1&&this.setFocus([i],t)}findNextIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!n||n(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!n||n(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,n=0){if(e<0||e>=this.length)throw new Na(this.user,`Invalid index ${e}`);let i=this.view.getScrollTop(),r=this.view.elementTop(e),s=this.view.elementHeight(e);if(mi(t)){let a=s-this.view.renderHeight+n;this.view.setScrollTop(a*Vn(t,0,1)+r-n)}else{let a=r+s,l=i+this.view.renderHeight;r<i+n&&a>=l||(r<i+n||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(r-n):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new Na(this.user,`Invalid index ${e}`);let n=this.view.getScrollTop(),i=this.view.elementTop(e),r=this.view.elementHeight(e);if(i<n+t||i+r>n+this.view.renderHeight)return null;let s=r-this.view.renderHeight+t;return Math.abs((n+t-i)/s)}isDOMFocused(){return nu(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(n=>this.view.element(n)),browserEvent:t}}_onFocusChange(){let e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};k([he],Pr.prototype,"onDidChangeFocus",1),k([he],Pr.prototype,"onDidChangeSelection",1),k([he],Pr.prototype,"onContextMenu",1),k([he],Pr.prototype,"onKeyDown",1),k([he],Pr.prototype,"onKeyUp",1),k([he],Pr.prototype,"onKeyPress",1),k([he],Pr.prototype,"onDidFocus",1),k([he],Pr.prototype,"onDidBlur",1);var b7=new RegExp(`(\\\\)?\\$\\((${Xe.iconNameExpression}(?:${Xe.iconModifierExpression})?)\\)`,"g");function vo(o){let e=new Array,t,n=0,i=0;for(;(t=b7.exec(o))!==null;){i=t.index||0,n<i&&e.push(o.substring(n,i)),n=(t.index||0)+t[0].length;let[,r,s]=t;e.push(r?`$(${s})`:v7({id:s}))}return n<o.length&&e.push(o.substring(n)),e}function v7(o){let e=je("span");return e.classList.add(...Xe.asClassNameArray(o)),e}var u0=class{_prefix;_lastId;constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},h0=new u0("id#");var Ci={};(function(){function o(e,t){t(Ci)}o.amd=!0,function(e,t){typeof o=="function"&&o.amd?o(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){"use strict";function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function n(We){e.defaults=We}let i=/[&<>"']/,r=new RegExp(i.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=We=>l[We];function c(We,x){if(x){if(i.test(We))return We.replace(r,d)}else if(s.test(We))return We.replace(a,d);return We}let u=/(^|[^\[])\^/g;function h(We,x){let _=typeof We=="string"?We:We.source;x=x||"";let D={replace:(F,H)=>{let $=typeof H=="string"?H:H.source;return $=$.replace(u,"$1"),_=_.replace(F,$),D},getRegex:()=>new RegExp(_,x)};return D}function m(We){try{We=encodeURI(We).replace(/%25/g,"%")}catch{return null}return We}let g={exec:()=>null};function f(We,x){let _=We.replace(/\|/g,(H,$,ee)=>{let Ie=!1,we=$;for(;--we>=0&&ee[we]==="\\";)Ie=!Ie;return Ie?"|":" |"}),D=_.split(/ \|/),F=0;if(D[0].trim()||D.shift(),D.length>0&&!D[D.length-1].trim()&&D.pop(),x)if(D.length>x)D.splice(x);else for(;D.length<x;)D.push("");for(;F<D.length;F++)D[F]=D[F].trim().replace(/\\\|/g,"|");return D}function b(We,x,_){let D=We.length;if(D===0)return"";let F=0;for(;F<D;){let H=We.charAt(D-F-1);if(H===x&&!_)F++;else if(H!==x&&_)F++;else break}return We.slice(0,D-F)}function y(We,x){if(We.indexOf(x[1])===-1)return-1;let _=0;for(let D=0;D<We.length;D++)if(We[D]==="\\")D++;else if(We[D]===x[0])_++;else if(We[D]===x[1]&&(_--,_<0))return D;return-1}function C(We,x,_,D){let F=x.href,H=x.title?c(x.title):null,$=We[1].replace(/\\([\[\]])/g,"$1");if(We[0].charAt(0)!=="!"){D.state.inLink=!0;let ee={type:"link",raw:_,href:F,title:H,text:$,tokens:D.inlineTokens($)};return D.state.inLink=!1,ee}return{type:"image",raw:_,href:F,title:H,text:c($)}}function S(We,x){let _=We.match(/^(\s+)(?:```)/);if(_===null)return x;let D=_[1];return x.split(`
`).map(F=>{let H=F.match(/^\s+/);if(H===null)return F;let[$]=H;return $.length>=D.length?F.slice(D.length):F}).join(`
`)}class w{options;rules;lexer;constructor(x){this.options=x||e.defaults}space(x){let _=this.rules.block.newline.exec(x);if(_&&_[0].length>0)return{type:"space",raw:_[0]}}code(x){let _=this.rules.block.code.exec(x);if(_){let D=_[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:_[0],codeBlockStyle:"indented",text:this.options.pedantic?D:b(D,`
`)}}}fences(x){let _=this.rules.block.fences.exec(x);if(_){let D=_[0],F=S(D,_[3]||"");return{type:"code",raw:D,lang:_[2]?_[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):_[2],text:F}}}heading(x){let _=this.rules.block.heading.exec(x);if(_){let D=_[2].trim();if(/#$/.test(D)){let F=b(D,"#");(this.options.pedantic||!F||/ $/.test(F))&&(D=F.trim())}return{type:"heading",raw:_[0],depth:_[1].length,text:D,tokens:this.lexer.inline(D)}}}hr(x){let _=this.rules.block.hr.exec(x);if(_)return{type:"hr",raw:b(_[0],`
`)}}blockquote(x){let _=this.rules.block.blockquote.exec(x);if(_){let D=b(_[0],`
`).split(`
`),F="",H="",$=[];for(;D.length>0;){let ee=!1,Ie=[],we;for(we=0;we<D.length;we++)if(/^ {0,3}>/.test(D[we]))Ie.push(D[we]),ee=!0;else if(!ee)Ie.push(D[we]);else break;D=D.slice(we);let Ye=Ie.join(`
`),It=Ye.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");F=F?`${F}
${Ye}`:Ye,H=H?`${H}
${It}`:It;let $t=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(It,$,!0),this.lexer.state.top=$t,D.length===0)break;let Nn=$[$.length-1];if(Nn?.type==="code")break;if(Nn?.type==="blockquote"){let nn=Nn,ke=nn.raw+`
`+D.join(`
`),U=this.blockquote(ke);$[$.length-1]=U,F=F.substring(0,F.length-nn.raw.length)+U.raw,H=H.substring(0,H.length-nn.text.length)+U.text;break}else if(Nn?.type==="list"){let nn=Nn,ke=nn.raw+`
`+D.join(`
`),U=this.list(ke);$[$.length-1]=U,F=F.substring(0,F.length-Nn.raw.length)+U.raw,H=H.substring(0,H.length-nn.raw.length)+U.raw,D=ke.substring($[$.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:F,tokens:$,text:H}}}list(x){let _=this.rules.block.list.exec(x);if(_){let D=_[1].trim(),F=D.length>1,H={type:"list",raw:"",ordered:F,start:F?+D.slice(0,-1):"",loose:!1,items:[]};D=F?`\\d{1,9}\\${D.slice(-1)}`:`\\${D}`,this.options.pedantic&&(D=F?D:"[*+-]");let $=new RegExp(`^( {0,3}${D})((?:[	 ][^\\n]*)?(?:\\n|$))`),ee=!1;for(;x;){let Ie=!1,we="",Ye="";if(!(_=$.exec(x))||this.rules.block.hr.test(x))break;we=_[0],x=x.substring(we.length);let It=_[2].split(`
`,1)[0].replace(/^\t+/,be=>" ".repeat(3*be.length)),$t=x.split(`
`,1)[0],Nn=!It.trim(),nn=0;if(this.options.pedantic?(nn=2,Ye=It.trimStart()):Nn?nn=_[1].length+1:(nn=_[2].search(/[^ ]/),nn=nn>4?1:nn,Ye=It.slice(nn),nn+=_[1].length),Nn&&/^ *$/.test($t)&&(we+=$t+`
`,x=x.substring($t.length+1),Ie=!0),!Ie){let be=new RegExp(`^ {0,${Math.min(3,nn-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Le=new RegExp(`^ {0,${Math.min(3,nn-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Vt=new RegExp(`^ {0,${Math.min(3,nn-1)}}(?:\`\`\`|~~~)`),Gn=new RegExp(`^ {0,${Math.min(3,nn-1)}}#`);for(;x;){let ro=x.split(`
`,1)[0];if($t=ro,this.options.pedantic&&($t=$t.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Vt.test($t)||Gn.test($t)||be.test($t)||Le.test(x))break;if($t.search(/[^ ]/)>=nn||!$t.trim())Ye+=`
`+$t.slice(nn);else{if(Nn||It.search(/[^ ]/)>=4||Vt.test(It)||Gn.test(It)||Le.test(It))break;Ye+=`
`+$t}!Nn&&!$t.trim()&&(Nn=!0),we+=ro+`
`,x=x.substring(ro.length+1),It=$t.slice(nn)}}H.loose||(ee?H.loose=!0:/\n *\n *$/.test(we)&&(ee=!0));let ke=null,U;this.options.gfm&&(ke=/^\[[ xX]\] /.exec(Ye),ke&&(U=ke[0]!=="[ ] ",Ye=Ye.replace(/^\[[ xX]\] +/,""))),H.items.push({type:"list_item",raw:we,task:!!ke,checked:U,loose:!1,text:Ye,tokens:[]}),H.raw+=we}H.items[H.items.length-1].raw=H.items[H.items.length-1].raw.trimEnd(),H.items[H.items.length-1].text=H.items[H.items.length-1].text.trimEnd(),H.raw=H.raw.trimEnd();for(let Ie=0;Ie<H.items.length;Ie++)if(this.lexer.state.top=!1,H.items[Ie].tokens=this.lexer.blockTokens(H.items[Ie].text,[]),!H.loose){let we=H.items[Ie].tokens.filter(It=>It.type==="space"),Ye=we.length>0&&we.some(It=>/\n.*\n/.test(It.raw));H.loose=Ye}if(H.loose)for(let Ie=0;Ie<H.items.length;Ie++)H.items[Ie].loose=!0;return H}}html(x){let _=this.rules.block.html.exec(x);if(_)return{type:"html",block:!0,raw:_[0],pre:_[1]==="pre"||_[1]==="script"||_[1]==="style",text:_[0]}}def(x){let _=this.rules.block.def.exec(x);if(_){let D=_[1].toLowerCase().replace(/\s+/g," "),F=_[2]?_[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",H=_[3]?_[3].substring(1,_[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):_[3];return{type:"def",tag:D,raw:_[0],href:F,title:H}}}table(x){let _=this.rules.block.table.exec(x);if(!_||!/[:|]/.test(_[2]))return;let D=f(_[1]),F=_[2].replace(/^\||\| *$/g,"").split("|"),H=_[3]&&_[3].trim()?_[3].replace(/\n[ \t]*$/,"").split(`
`):[],$={type:"table",raw:_[0],header:[],align:[],rows:[]};if(D.length===F.length){for(let ee of F)/^ *-+: *$/.test(ee)?$.align.push("right"):/^ *:-+: *$/.test(ee)?$.align.push("center"):/^ *:-+ *$/.test(ee)?$.align.push("left"):$.align.push(null);for(let ee=0;ee<D.length;ee++)$.header.push({text:D[ee],tokens:this.lexer.inline(D[ee]),header:!0,align:$.align[ee]});for(let ee of H)$.rows.push(f(ee,$.header.length).map((Ie,we)=>({text:Ie,tokens:this.lexer.inline(Ie),header:!1,align:$.align[we]})));return $}}lheading(x){let _=this.rules.block.lheading.exec(x);if(_)return{type:"heading",raw:_[0],depth:_[2].charAt(0)==="="?1:2,text:_[1],tokens:this.lexer.inline(_[1])}}paragraph(x){let _=this.rules.block.paragraph.exec(x);if(_){let D=_[1].charAt(_[1].length-1)===`
`?_[1].slice(0,-1):_[1];return{type:"paragraph",raw:_[0],text:D,tokens:this.lexer.inline(D)}}}text(x){let _=this.rules.block.text.exec(x);if(_)return{type:"text",raw:_[0],text:_[0],tokens:this.lexer.inline(_[0])}}escape(x){let _=this.rules.inline.escape.exec(x);if(_)return{type:"escape",raw:_[0],text:c(_[1])}}tag(x){let _=this.rules.inline.tag.exec(x);if(_)return!this.lexer.state.inLink&&/^<a /i.test(_[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(_[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(_[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(_[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:_[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:_[0]}}link(x){let _=this.rules.inline.link.exec(x);if(_){let D=_[2].trim();if(!this.options.pedantic&&/^</.test(D)){if(!/>$/.test(D))return;let $=b(D.slice(0,-1),"\\");if((D.length-$.length)%2===0)return}else{let $=y(_[2],"()");if($>-1){let Ie=(_[0].indexOf("!")===0?5:4)+_[1].length+$;_[2]=_[2].substring(0,$),_[0]=_[0].substring(0,Ie).trim(),_[3]=""}}let F=_[2],H="";if(this.options.pedantic){let $=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(F);$&&(F=$[1],H=$[3])}else H=_[3]?_[3].slice(1,-1):"";return F=F.trim(),/^</.test(F)&&(this.options.pedantic&&!/>$/.test(D)?F=F.slice(1):F=F.slice(1,-1)),C(_,{href:F&&F.replace(this.rules.inline.anyPunctuation,"$1"),title:H&&H.replace(this.rules.inline.anyPunctuation,"$1")},_[0],this.lexer)}}reflink(x,_){let D;if((D=this.rules.inline.reflink.exec(x))||(D=this.rules.inline.nolink.exec(x))){let F=(D[2]||D[1]).replace(/\s+/g," "),H=_[F.toLowerCase()];if(!H){let $=D[0].charAt(0);return{type:"text",raw:$,text:$}}return C(D,H,D[0],this.lexer)}}emStrong(x,_,D=""){let F=this.rules.inline.emStrongLDelim.exec(x);if(!F||F[3]&&D.match(/[\p{L}\p{N}]/u))return;if(!(F[1]||F[2]||"")||!D||this.rules.inline.punctuation.exec(D)){let $=[...F[0]].length-1,ee,Ie,we=$,Ye=0,It=F[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(It.lastIndex=0,_=_.slice(-1*x.length+$);(F=It.exec(_))!=null;){if(ee=F[1]||F[2]||F[3]||F[4]||F[5]||F[6],!ee)continue;if(Ie=[...ee].length,F[3]||F[4]){we+=Ie;continue}else if((F[5]||F[6])&&$%3&&!(($+Ie)%3)){Ye+=Ie;continue}if(we-=Ie,we>0)continue;Ie=Math.min(Ie,Ie+we+Ye);let $t=[...F[0]][0].length,Nn=x.slice(0,$+F.index+$t+Ie);if(Math.min($,Ie)%2){let ke=Nn.slice(1,-1);return{type:"em",raw:Nn,text:ke,tokens:this.lexer.inlineTokens(ke)}}let nn=Nn.slice(2,-2);return{type:"strong",raw:Nn,text:nn,tokens:this.lexer.inlineTokens(nn)}}}}codespan(x){let _=this.rules.inline.code.exec(x);if(_){let D=_[2].replace(/\n/g," "),F=/[^ ]/.test(D),H=/^ /.test(D)&&/ $/.test(D);return F&&H&&(D=D.substring(1,D.length-1)),D=c(D,!0),{type:"codespan",raw:_[0],text:D}}}br(x){let _=this.rules.inline.br.exec(x);if(_)return{type:"br",raw:_[0]}}del(x){let _=this.rules.inline.del.exec(x);if(_)return{type:"del",raw:_[0],text:_[2],tokens:this.lexer.inlineTokens(_[2])}}autolink(x){let _=this.rules.inline.autolink.exec(x);if(_){let D,F;return _[2]==="@"?(D=c(_[1]),F="mailto:"+D):(D=c(_[1]),F=D),{type:"link",raw:_[0],text:D,href:F,tokens:[{type:"text",raw:D,text:D}]}}}url(x){let _;if(_=this.rules.inline.url.exec(x)){let D,F;if(_[2]==="@")D=c(_[0]),F="mailto:"+D;else{let H;do H=_[0],_[0]=this.rules.inline._backpedal.exec(_[0])?.[0]??"";while(H!==_[0]);D=c(_[0]),_[1]==="www."?F="http://"+_[0]:F=_[0]}return{type:"link",raw:_[0],text:D,href:F,tokens:[{type:"text",raw:D,text:D}]}}}inlineText(x){let _=this.rules.inline.text.exec(x);if(_){let D;return this.lexer.state.inRawBlock?D=_[0]:D=c(_[0]),{type:"text",raw:_[0],text:D}}}}let R=/^(?: *(?:\n|$))+/,M=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,N=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,A=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,P=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,K=/(?:[*+-]|\d{1,9}[.)])/,j=h(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,K).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),X=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,le=/^[^\n]+/,ye=/(?!\s*\])(?:\\.|[^\[\]\\])+/,q=h(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",ye).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Q=h(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,K).getRegex(),ce="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ie=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,J=h("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ie).replace("tag",ce).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Se=h(X).replace("hr",A).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ce).getRegex(),lt={blockquote:h(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Se).getRegex(),code:M,def:q,fences:N,heading:P,hr:A,html:J,lheading:j,list:Q,newline:R,paragraph:Se,table:g,text:le},Ze=h("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",A).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ce).getRegex(),Re={...lt,table:Ze,paragraph:h(X).replace("hr",A).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ze).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ce).getRegex()},ci={...lt,html:h(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ie).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:g,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:h(X).replace("hr",A).replace("heading",` *#{1,6} *[^
]`).replace("lheading",j).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Kn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,So=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,jo=/^( {2,}|\\)\n(?!\s*$)/,zl=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,wi="\\p{P}\\p{S}",rs=h(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,wi).getRegex(),cc=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Kl=h(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,wi).getRegex(),_i=h("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,wi).getRegex(),Gl=h("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,wi).getRegex(),jl=h(/\\([punct])/,"gu").replace(/punct/g,wi).getRegex(),$u=h(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),qu=h(ie).replace("(?:-->|$)","-->").getRegex(),Pe=h("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",qu).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ka=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,$l=h(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Ka).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Hs=h(/^!?\[(label)\]\[(ref)\]/).replace("label",Ka).replace("ref",ye).getRegex(),Kr=h(/^!?\[(ref)\](?:\[\])?/).replace("ref",ye).getRegex(),Qm=h("reflink|nolink(?!\\()","g").replace("reflink",Hs).replace("nolink",Kr).getRegex(),uc={_backpedal:g,anyPunctuation:jl,autolink:$u,blockSkip:cc,br:jo,code:So,del:g,emStrongLDelim:Kl,emStrongRDelimAst:_i,emStrongRDelimUnd:Gl,escape:Kn,link:$l,nolink:Kr,punctuation:rs,reflink:Hs,reflinkSearch:Qm,tag:Pe,text:zl,url:g},Jm={...uc,link:h(/^!?\[(label)\]\((.*?)\)/).replace("label",Ka).getRegex(),reflink:h(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ka).getRegex()},Us={...uc,escape:h(Kn).replace("])","~|])").getRegex(),url:h(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},eg={...Us,br:h(jo).replace("{2,}","*").getRegex(),text:h(Us.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},zs={normal:lt,gfm:Re,pedantic:ci},fr={normal:uc,gfm:Us,breaks:eg,pedantic:Jm};class Mn{tokens;options;state;tokenizer;inlineQueue;constructor(x){this.tokens=[],this.tokens.links=Object.create(null),this.options=x||e.defaults,this.options.tokenizer=this.options.tokenizer||new w,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let _={block:zs.normal,inline:fr.normal};this.options.pedantic?(_.block=zs.pedantic,_.inline=fr.pedantic):this.options.gfm&&(_.block=zs.gfm,this.options.breaks?_.inline=fr.breaks:_.inline=fr.gfm),this.tokenizer.rules=_}static get rules(){return{block:zs,inline:fr}}static lex(x,_){return new Mn(_).lex(x)}static lexInline(x,_){return new Mn(_).inlineTokens(x)}lex(x){x=x.replace(/\r\n|\r/g,`
`),this.blockTokens(x,this.tokens);for(let _=0;_<this.inlineQueue.length;_++){let D=this.inlineQueue[_];this.inlineTokens(D.src,D.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(x,_=[],D=!1){this.options.pedantic?x=x.replace(/\t/g,"    ").replace(/^ +$/gm,""):x=x.replace(/^( *)(\t+)/gm,(ee,Ie,we)=>Ie+"    ".repeat(we.length));let F,H,$;for(;x;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(ee=>(F=ee.call({lexer:this},x,_))?(x=x.substring(F.raw.length),_.push(F),!0):!1))){if(F=this.tokenizer.space(x)){x=x.substring(F.raw.length),F.raw.length===1&&_.length>0?_[_.length-1].raw+=`
`:_.push(F);continue}if(F=this.tokenizer.code(x)){x=x.substring(F.raw.length),H=_[_.length-1],H&&(H.type==="paragraph"||H.type==="text")?(H.raw+=`
`+F.raw,H.text+=`
`+F.text,this.inlineQueue[this.inlineQueue.length-1].src=H.text):_.push(F);continue}if(F=this.tokenizer.fences(x)){x=x.substring(F.raw.length),_.push(F);continue}if(F=this.tokenizer.heading(x)){x=x.substring(F.raw.length),_.push(F);continue}if(F=this.tokenizer.hr(x)){x=x.substring(F.raw.length),_.push(F);continue}if(F=this.tokenizer.blockquote(x)){x=x.substring(F.raw.length),_.push(F);continue}if(F=this.tokenizer.list(x)){x=x.substring(F.raw.length),_.push(F);continue}if(F=this.tokenizer.html(x)){x=x.substring(F.raw.length),_.push(F);continue}if(F=this.tokenizer.def(x)){x=x.substring(F.raw.length),H=_[_.length-1],H&&(H.type==="paragraph"||H.type==="text")?(H.raw+=`
`+F.raw,H.text+=`
`+F.raw,this.inlineQueue[this.inlineQueue.length-1].src=H.text):this.tokens.links[F.tag]||(this.tokens.links[F.tag]={href:F.href,title:F.title});continue}if(F=this.tokenizer.table(x)){x=x.substring(F.raw.length),_.push(F);continue}if(F=this.tokenizer.lheading(x)){x=x.substring(F.raw.length),_.push(F);continue}if($=x,this.options.extensions&&this.options.extensions.startBlock){let ee=1/0,Ie=x.slice(1),we;this.options.extensions.startBlock.forEach(Ye=>{we=Ye.call({lexer:this},Ie),typeof we=="number"&&we>=0&&(ee=Math.min(ee,we))}),ee<1/0&&ee>=0&&($=x.substring(0,ee+1))}if(this.state.top&&(F=this.tokenizer.paragraph($))){H=_[_.length-1],D&&H?.type==="paragraph"?(H.raw+=`
`+F.raw,H.text+=`
`+F.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=H.text):_.push(F),D=$.length!==x.length,x=x.substring(F.raw.length);continue}if(F=this.tokenizer.text(x)){x=x.substring(F.raw.length),H=_[_.length-1],H&&H.type==="text"?(H.raw+=`
`+F.raw,H.text+=`
`+F.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=H.text):_.push(F);continue}if(x){let ee="Infinite loop on byte: "+x.charCodeAt(0);if(this.options.silent){console.error(ee);break}else throw new Error(ee)}}return this.state.top=!0,_}inline(x,_=[]){return this.inlineQueue.push({src:x,tokens:_}),_}inlineTokens(x,_=[]){let D,F,H,$=x,ee,Ie,we;if(this.tokens.links){let Ye=Object.keys(this.tokens.links);if(Ye.length>0)for(;(ee=this.tokenizer.rules.inline.reflinkSearch.exec($))!=null;)Ye.includes(ee[0].slice(ee[0].lastIndexOf("[")+1,-1))&&($=$.slice(0,ee.index)+"["+"a".repeat(ee[0].length-2)+"]"+$.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(ee=this.tokenizer.rules.inline.blockSkip.exec($))!=null;)$=$.slice(0,ee.index)+"["+"a".repeat(ee[0].length-2)+"]"+$.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(ee=this.tokenizer.rules.inline.anyPunctuation.exec($))!=null;)$=$.slice(0,ee.index)+"++"+$.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;x;)if(Ie||(we=""),Ie=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(Ye=>(D=Ye.call({lexer:this},x,_))?(x=x.substring(D.raw.length),_.push(D),!0):!1))){if(D=this.tokenizer.escape(x)){x=x.substring(D.raw.length),_.push(D);continue}if(D=this.tokenizer.tag(x)){x=x.substring(D.raw.length),F=_[_.length-1],F&&D.type==="text"&&F.type==="text"?(F.raw+=D.raw,F.text+=D.text):_.push(D);continue}if(D=this.tokenizer.link(x)){x=x.substring(D.raw.length),_.push(D);continue}if(D=this.tokenizer.reflink(x,this.tokens.links)){x=x.substring(D.raw.length),F=_[_.length-1],F&&D.type==="text"&&F.type==="text"?(F.raw+=D.raw,F.text+=D.text):_.push(D);continue}if(D=this.tokenizer.emStrong(x,$,we)){x=x.substring(D.raw.length),_.push(D);continue}if(D=this.tokenizer.codespan(x)){x=x.substring(D.raw.length),_.push(D);continue}if(D=this.tokenizer.br(x)){x=x.substring(D.raw.length),_.push(D);continue}if(D=this.tokenizer.del(x)){x=x.substring(D.raw.length),_.push(D);continue}if(D=this.tokenizer.autolink(x)){x=x.substring(D.raw.length),_.push(D);continue}if(!this.state.inLink&&(D=this.tokenizer.url(x))){x=x.substring(D.raw.length),_.push(D);continue}if(H=x,this.options.extensions&&this.options.extensions.startInline){let Ye=1/0,It=x.slice(1),$t;this.options.extensions.startInline.forEach(Nn=>{$t=Nn.call({lexer:this},It),typeof $t=="number"&&$t>=0&&(Ye=Math.min(Ye,$t))}),Ye<1/0&&Ye>=0&&(H=x.substring(0,Ye+1))}if(D=this.tokenizer.inlineText(H)){x=x.substring(D.raw.length),D.raw.slice(-1)!=="_"&&(we=D.raw.slice(-1)),Ie=!0,F=_[_.length-1],F&&F.type==="text"?(F.raw+=D.raw,F.text+=D.text):_.push(D);continue}if(x){let Ye="Infinite loop on byte: "+x.charCodeAt(0);if(this.options.silent){console.error(Ye);break}else throw new Error(Ye)}}return _}}class br{options;parser;constructor(x){this.options=x||e.defaults}space(x){return""}code({text:x,lang:_,escaped:D}){let F=(_||"").match(/^\S*/)?.[0],H=x.replace(/\n$/,"")+`
`;return F?'<pre><code class="language-'+c(F)+'">'+(D?H:c(H,!0))+`</code></pre>
`:"<pre><code>"+(D?H:c(H,!0))+`</code></pre>
`}blockquote({tokens:x}){return`<blockquote>
${this.parser.parse(x)}</blockquote>
`}html({text:x}){return x}heading({tokens:x,depth:_}){return`<h${_}>${this.parser.parseInline(x)}</h${_}>
`}hr(x){return`<hr>
`}list(x){let _=x.ordered,D=x.start,F="";for(let ee=0;ee<x.items.length;ee++){let Ie=x.items[ee];F+=this.listitem(Ie)}let H=_?"ol":"ul",$=_&&D!==1?' start="'+D+'"':"";return"<"+H+$+`>
`+F+"</"+H+`>
`}listitem(x){let _="";if(x.task){let D=this.checkbox({checked:!!x.checked});x.loose?x.tokens.length>0&&x.tokens[0].type==="paragraph"?(x.tokens[0].text=D+" "+x.tokens[0].text,x.tokens[0].tokens&&x.tokens[0].tokens.length>0&&x.tokens[0].tokens[0].type==="text"&&(x.tokens[0].tokens[0].text=D+" "+x.tokens[0].tokens[0].text)):x.tokens.unshift({type:"text",raw:D+" ",text:D+" "}):_+=D+" "}return _+=this.parser.parse(x.tokens,!!x.loose),`<li>${_}</li>
`}checkbox({checked:x}){return"<input "+(x?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:x}){return`<p>${this.parser.parseInline(x)}</p>
`}table(x){let _="",D="";for(let H=0;H<x.header.length;H++)D+=this.tablecell(x.header[H]);_+=this.tablerow({text:D});let F="";for(let H=0;H<x.rows.length;H++){let $=x.rows[H];D="";for(let ee=0;ee<$.length;ee++)D+=this.tablecell($[ee]);F+=this.tablerow({text:D})}return F&&(F=`<tbody>${F}</tbody>`),`<table>
<thead>
`+_+`</thead>
`+F+`</table>
`}tablerow({text:x}){return`<tr>
${x}</tr>
`}tablecell(x){let _=this.parser.parseInline(x.tokens),D=x.header?"th":"td";return(x.align?`<${D} align="${x.align}">`:`<${D}>`)+_+`</${D}>
`}strong({tokens:x}){return`<strong>${this.parser.parseInline(x)}</strong>`}em({tokens:x}){return`<em>${this.parser.parseInline(x)}</em>`}codespan({text:x}){return`<code>${x}</code>`}br(x){return"<br>"}del({tokens:x}){return`<del>${this.parser.parseInline(x)}</del>`}link({href:x,title:_,tokens:D}){let F=this.parser.parseInline(D),H=m(x);if(H===null)return F;x=H;let $='<a href="'+x+'"';return _&&($+=' title="'+_+'"'),$+=">"+F+"</a>",$}image({href:x,title:_,text:D}){let F=m(x);if(F===null)return D;x=F;let H=`<img src="${x}" alt="${D}"`;return _&&(H+=` title="${_}"`),H+=">",H}text(x){return"tokens"in x&&x.tokens?this.parser.parseInline(x.tokens):x.text}}class Ga{strong({text:x}){return x}em({text:x}){return x}codespan({text:x}){return x}del({text:x}){return x}html({text:x}){return x}text({text:x}){return x}link({text:x}){return""+x}image({text:x}){return""+x}br(){return""}}class oo{options;renderer;textRenderer;constructor(x){this.options=x||e.defaults,this.options.renderer=this.options.renderer||new br,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Ga}static parse(x,_){return new oo(_).parse(x)}static parseInline(x,_){return new oo(_).parseInline(x)}parse(x,_=!0){let D="";for(let F=0;F<x.length;F++){let H=x[F];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[H.type]){let ee=H,Ie=this.options.extensions.renderers[ee.type].call({parser:this},ee);if(Ie!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(ee.type)){D+=Ie||"";continue}}let $=H;switch($.type){case"space":{D+=this.renderer.space($);continue}case"hr":{D+=this.renderer.hr($);continue}case"heading":{D+=this.renderer.heading($);continue}case"code":{D+=this.renderer.code($);continue}case"table":{D+=this.renderer.table($);continue}case"blockquote":{D+=this.renderer.blockquote($);continue}case"list":{D+=this.renderer.list($);continue}case"html":{D+=this.renderer.html($);continue}case"paragraph":{D+=this.renderer.paragraph($);continue}case"text":{let ee=$,Ie=this.renderer.text(ee);for(;F+1<x.length&&x[F+1].type==="text";)ee=x[++F],Ie+=`
`+this.renderer.text(ee);_?D+=this.renderer.paragraph({type:"paragraph",raw:Ie,text:Ie,tokens:[{type:"text",raw:Ie,text:Ie}]}):D+=Ie;continue}default:{let ee='Token with "'+$.type+'" type was not found.';if(this.options.silent)return console.error(ee),"";throw new Error(ee)}}}return D}parseInline(x,_){_=_||this.renderer;let D="";for(let F=0;F<x.length;F++){let H=x[F];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[H.type]){let ee=this.options.extensions.renderers[H.type].call({parser:this},H);if(ee!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(H.type)){D+=ee||"";continue}}let $=H;switch($.type){case"escape":{D+=_.text($);break}case"html":{D+=_.html($);break}case"link":{D+=_.link($);break}case"image":{D+=_.image($);break}case"strong":{D+=_.strong($);break}case"em":{D+=_.em($);break}case"codespan":{D+=_.codespan($);break}case"br":{D+=_.br($);break}case"del":{D+=_.del($);break}case"text":{D+=_.text($);break}default:{let ee='Token with "'+$.type+'" type was not found.';if(this.options.silent)return console.error(ee),"";throw new Error(ee)}}}return D}}class ql{options;constructor(x){this.options=x||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(x){return x}postprocess(x){return x}processAllTokens(x){return x}}class ss{defaults=t();options=this.setOptions;parse=this.parseMarkdown(Mn.lex,oo.parse);parseInline=this.parseMarkdown(Mn.lexInline,oo.parseInline);Parser=oo;Renderer=br;TextRenderer=Ga;Lexer=Mn;Tokenizer=w;Hooks=ql;constructor(...x){this.use(...x)}walkTokens(x,_){let D=[];for(let F of x)switch(D=D.concat(_.call(this,F)),F.type){case"table":{let H=F;for(let $ of H.header)D=D.concat(this.walkTokens($.tokens,_));for(let $ of H.rows)for(let ee of $)D=D.concat(this.walkTokens(ee.tokens,_));break}case"list":{let H=F;D=D.concat(this.walkTokens(H.items,_));break}default:{let H=F;this.defaults.extensions?.childTokens?.[H.type]?this.defaults.extensions.childTokens[H.type].forEach($=>{let ee=H[$].flat(1/0);D=D.concat(this.walkTokens(ee,_))}):H.tokens&&(D=D.concat(this.walkTokens(H.tokens,_)))}}return D}use(...x){let _=this.defaults.extensions||{renderers:{},childTokens:{}};return x.forEach(D=>{let F={...D};if(F.async=this.defaults.async||F.async||!1,D.extensions&&(D.extensions.forEach(H=>{if(!H.name)throw new Error("extension name required");if("renderer"in H){let $=_.renderers[H.name];$?_.renderers[H.name]=function(...ee){let Ie=H.renderer.apply(this,ee);return Ie===!1&&(Ie=$.apply(this,ee)),Ie}:_.renderers[H.name]=H.renderer}if("tokenizer"in H){if(!H.level||H.level!=="block"&&H.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let $=_[H.level];$?$.unshift(H.tokenizer):_[H.level]=[H.tokenizer],H.start&&(H.level==="block"?_.startBlock?_.startBlock.push(H.start):_.startBlock=[H.start]:H.level==="inline"&&(_.startInline?_.startInline.push(H.start):_.startInline=[H.start]))}"childTokens"in H&&H.childTokens&&(_.childTokens[H.name]=H.childTokens)}),F.extensions=_),D.renderer){let H=this.defaults.renderer||new br(this.defaults);for(let $ in D.renderer){if(!($ in H))throw new Error(`renderer '${$}' does not exist`);if(["options","parser"].includes($))continue;let ee=$,Ie=D.renderer[ee],we=H[ee];H[ee]=(...Ye)=>{let It=Ie.apply(H,Ye);return It===!1&&(It=we.apply(H,Ye)),It||""}}F.renderer=H}if(D.tokenizer){let H=this.defaults.tokenizer||new w(this.defaults);for(let $ in D.tokenizer){if(!($ in H))throw new Error(`tokenizer '${$}' does not exist`);if(["options","rules","lexer"].includes($))continue;let ee=$,Ie=D.tokenizer[ee],we=H[ee];H[ee]=(...Ye)=>{let It=Ie.apply(H,Ye);return It===!1&&(It=we.apply(H,Ye)),It}}F.tokenizer=H}if(D.hooks){let H=this.defaults.hooks||new ql;for(let $ in D.hooks){if(!($ in H))throw new Error(`hook '${$}' does not exist`);if($==="options")continue;let ee=$,Ie=D.hooks[ee],we=H[ee];ql.passThroughHooks.has($)?H[ee]=Ye=>{if(this.defaults.async)return Promise.resolve(Ie.call(H,Ye)).then($t=>we.call(H,$t));let It=Ie.call(H,Ye);return we.call(H,It)}:H[ee]=(...Ye)=>{let It=Ie.apply(H,Ye);return It===!1&&(It=we.apply(H,Ye)),It}}F.hooks=H}if(D.walkTokens){let H=this.defaults.walkTokens,$=D.walkTokens;F.walkTokens=function(ee){let Ie=[];return Ie.push($.call(this,ee)),H&&(Ie=Ie.concat(H.call(this,ee))),Ie}}this.defaults={...this.defaults,...F}}),this}setOptions(x){return this.defaults={...this.defaults,...x},this}lexer(x,_){return Mn.lex(x,_??this.defaults)}parser(x,_){return oo.parse(x,_??this.defaults)}parseMarkdown(x,_){return(F,H)=>{let $={...H},ee={...this.defaults,...$},Ie=this.onError(!!ee.silent,!!ee.async);if(this.defaults.async===!0&&$.async===!1)return Ie(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof F>"u"||F===null)return Ie(new Error("marked(): input parameter is undefined or null"));if(typeof F!="string")return Ie(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(F)+", string expected"));if(ee.hooks&&(ee.hooks.options=ee),ee.async)return Promise.resolve(ee.hooks?ee.hooks.preprocess(F):F).then(we=>x(we,ee)).then(we=>ee.hooks?ee.hooks.processAllTokens(we):we).then(we=>ee.walkTokens?Promise.all(this.walkTokens(we,ee.walkTokens)).then(()=>we):we).then(we=>_(we,ee)).then(we=>ee.hooks?ee.hooks.postprocess(we):we).catch(Ie);try{ee.hooks&&(F=ee.hooks.preprocess(F));let we=x(F,ee);ee.hooks&&(we=ee.hooks.processAllTokens(we)),ee.walkTokens&&this.walkTokens(we,ee.walkTokens);let Ye=_(we,ee);return ee.hooks&&(Ye=ee.hooks.postprocess(Ye)),Ye}catch(we){return Ie(we)}}}onError(x,_){return D=>{if(D.message+=`
Please report this to https://github.com/markedjs/marked.`,x){let F="<p>An error occurred:</p><pre>"+c(D.message+"",!0)+"</pre>";return _?Promise.resolve(F):F}if(_)return Promise.reject(D);throw D}}}let Ks=new ss;function fe(We,x){return Ks.parse(We,x)}fe.options=fe.setOptions=function(We){return Ks.setOptions(We),fe.defaults=Ks.defaults,n(fe.defaults),fe},fe.getDefaults=t,fe.defaults=e.defaults,fe.use=function(...We){return Ks.use(...We),fe.defaults=Ks.defaults,n(fe.defaults),fe},fe.walkTokens=function(We,x){return Ks.walkTokens(We,x)},fe.parseInline=Ks.parseInline,fe.Parser=oo,fe.parser=oo.parse,fe.Renderer=br,fe.TextRenderer=Ga,fe.Lexer=Mn,fe.lexer=Mn.lex,fe.Tokenizer=w,fe.Hooks=ql,fe.parse=fe;let re=fe.options,O=fe.setOptions,te=fe.use,ge=fe.walkTokens,$e=fe.parseInline,xt=fe,ni=oo.parse,Ti=Mn.lex;e.Hooks=ql,e.Lexer=Mn,e.Marked=ss,e.Parser=oo,e.Renderer=br,e.TextRenderer=Ga,e.Tokenizer=w,e.getDefaults=t,e.lexer=Ti,e.marked=fe,e.options=re,e.parse=xt,e.parseInline=$e,e.parser=ni,e.setOptions=O,e.use=te,e.walkTokens=ge})})();var U4e=Ci.Hooks||exports.Hooks,z4e=Ci.Lexer||exports.Lexer,K4e=Ci.Marked||exports.Marked,G4e=Ci.Parser||exports.Parser,p0=Ci.Renderer||exports.Renderer,j4e=Ci.TextRenderer||exports.TextRenderer,$4e=Ci.Tokenizer||exports.Tokenizer,b2=Ci.defaults||exports.defaults,q4e=Ci.getDefaults||exports.getDefaults,hb=Ci.lexer||exports.lexer,Y4e=Ci.marked||exports.marked,Z4e=Ci.options||exports.options,v2=Ci.parse||exports.parse,X4e=Ci.parseInline||exports.parseInline,y2=Ci.parser||exports.parser,Q4e=Ci.setOptions||exports.setOptions,J4e=Ci.use||exports.use,e5e=Ci.walkTokens||exports.walkTokens;var m0=Object.freeze({image:({href:o,title:e,text:t})=>{let n=[],i=[];return o&&({href:o,dimensions:n}=gA(o),i.push(`src="${$g(o)}"`)),t&&i.push(`alt="${$g(t)}"`),e&&i.push(`title="${$g(e)}"`),n.length&&(i=i.concat(n)),"<img "+i.join(" ")+">"},paragraph({tokens:o}){return`<p>${this.parser.parseInline(o)}</p>`},link({href:o,title:e,tokens:t}){let n=this.parser.parseInline(t);return typeof o!="string"?"":(o===n&&(n=Sy(n)),e=typeof e=="string"?$g(Sy(e)):"",o=Sy(o),o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${o}" title="${e||o}" draggable="false">${n}</a>`)}});function f0(o,e={},t={}){let n=new oe,i=!1,r=a2(e),s=function(f){let b;try{b=Xf(decodeURIComponent(f))}catch{}return b?(b=fA(b,y=>{if(o.uris&&o.uris[y])return ne.revive(o.uris[y])}),encodeURIComponent(JSON.stringify(b))):f},a=function(f,b){let y=o.uris&&o.uris[f],C=ne.revive(y);return b?f.startsWith(Ae.data+":")?f:(C||(C=ne.parse(f)),ud.uriToBrowserUri(C).toString(!0)):!C||ne.parse(f).toString()===C.toString()?f:(C.query&&(C=C.with({query:s(C.query)})),C.toString())},l=new p0;l.image=m0.image,l.link=m0.link,l.paragraph=m0.paragraph;let d=[],c=[];if(e.codeBlockRendererSync?l.code=({text:f,lang:b})=>{let y=h0.nextId(),C=e.codeBlockRendererSync(I2(b),f);return c.push([y,C]),`<div class="code" data-code="${y}">${uh(f)}</div>`}:e.codeBlockRenderer&&(l.code=({text:f,lang:b})=>{let y=h0.nextId(),C=e.codeBlockRenderer(I2(b),f);return d.push(C.then(S=>[y,S])),`<div class="code" data-code="${y}">${uh(f)}</div>`}),e.actionHandler){let f=function(C){let S=C.target.closest("a[data-href]");if(ai(S))try{let w=S.dataset.href;w&&(o.baseUri&&(w=g0(ne.from(o.baseUri),w)),e.actionHandler.callback(w,C))}catch(w){Ne(w)}finally{C.preventDefault()}},b=e.actionHandler.disposables.add(new Oe(r,"click")),y=e.actionHandler.disposables.add(new Oe(r,"auxclick"));e.actionHandler.disposables.add(Y.any(b.event,y.event)(C=>{let S=new Fi(Ce(r),C);!S.leftButton&&!S.middleButton||f(S)})),e.actionHandler.disposables.add(z(r,"keydown",C=>{let S=new vt(C);!S.equals(10)&&!S.equals(3)||f(S)}))}o.supportHtml||(l.html=({text:f})=>e.sanitizerOptions?.replaceWithPlaintext?uh(f):(o.isTrusted?f.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?f:""),t.renderer=l;let u=o.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}\u2026`),o.supportThemeIcons&&(u=mA(u));let h;if(e.fillInIncompleteTokens){let f={...b2,...t},b=hb(u,f),y=T7(b);h=y2(y,f)}else h=v2(u,{...t,async:!1});o.supportThemeIcons&&(h=vo(h).map(b=>typeof b=="string"?b:b.outerHTML).join(""));let g=new DOMParser().parseFromString(C2({isTrusted:o.isTrusted,...e.sanitizerOptions},h),"text/html");if(g.body.querySelectorAll("img, audio, video, source").forEach(f=>{let b=f.getAttribute("src");if(b){let y=b;try{o.baseUri&&(y=g0(ne.from(o.baseUri),y))}catch{}if(f.setAttribute("src",a(y,!0)),e.remoteImageIsAllowed){let C=ne.parse(y);C.scheme!==Ae.file&&C.scheme!==Ae.data&&!e.remoteImageIsAllowed(C)&&f.replaceWith(je("",void 0,f.outerHTML))}}}),g.body.querySelectorAll("a").forEach(f=>{let b=f.getAttribute("href");if(f.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!o.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))f.replaceWith(...f.childNodes);else{let y=a(b,!1);o.baseUri&&(y=g0(ne.from(o.baseUri),b)),f.dataset.href=y}}),r.innerHTML=C2({isTrusted:o.isTrusted,...e.sanitizerOptions},g.body.innerHTML),d.length>0)Promise.all(d).then(f=>{if(i)return;let b=new Map(f),y=r.querySelectorAll("div[data-code]");for(let C of y){let S=b.get(C.dataset.code??"");S&&Tn(C,S)}e.asyncRenderCallback?.()});else if(c.length>0){let f=new Map(c),b=r.querySelectorAll("div[data-code]");for(let y of b){let C=f.get(y.dataset.code??"");C&&Tn(y,C)}}if(e.asyncRenderCallback)for(let f of r.getElementsByTagName("img")){let b=n.add(z(f,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}return{element:r,dispose:()=>{i=!0,n.dispose()}}}function I2(o){if(!o)return"";let e=o.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:o}function g0(o,e){return/^\w[\w\d+.-]*:/.test(e)?e:o.path.endsWith("/")?hT(o,e).toString():hT(hd(o),e).toString()}var I7=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function C2(o,e){let{config:t,allowedSchemes:n}=S7(o),i=new oe;i.add(S2("uponSanitizeAttribute",(r,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(r.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(r.tagName==="INPUT"&&r.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),i.add(S2("uponSanitizeElement",(r,s)=>{if(s.tagName==="input"&&(r.attributes.getNamedItem("type")?.value==="checkbox"?r.setAttribute("disabled",""):o.replaceWithPlaintext||r.remove()),o.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&r.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${r.textContent}-->`;else{let h=I7.includes(s.tagName),m=r.attributes.length?" "+Array.from(r.attributes).map(g=>`${g.name}="${g.value}"`).join(" "):"";a=`<${s.tagName}${m}>`,h||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=r.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let u=l?r.parentElement.ownerDocument.createTextNode(l):void 0;for(;r.firstChild;)d.appendChild(r.firstChild);u&&d.appendChild(u),r.parentElement.replaceChild(d,r)}})),i.add(e2(n));try{return BC(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{i.dispose()}}var C7=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function S7(o){let e=[Ae.http,Ae.https,Ae.mailto,Ae.data,Ae.file,Ae.vscodeFileResource,Ae.vscodeRemote,Ae.vscodeRemoteResource];return o.isTrusted&&e.push(Ae.command),{config:{ALLOWED_TAGS:o.allowedTags??[...t2],ALLOWED_ATTR:C7,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function x2(){let o=new p0;return o.code=({text:e})=>e,o.blockquote=({text:e})=>e+`
`,o.html=e=>"",o.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.hr=()=>"",o.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},o.listitem=({text:e})=>e+`
`,o.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.table=function({header:e,rows:t}){return e.map(n=>this.tablecell(n)).join(" ")+`
`+t.map(n=>n.map(i=>this.tablecell(i)).join(" ")).join(`
`)+`
`},o.tablerow=({text:e})=>e,o.tablecell=function({tokens:e}){return this.parser.parseInline(e)},o.strong=({text:e})=>e,o.em=({text:e})=>e,o.codespan=({text:e})=>e,o.br=e=>`
`,o.del=({text:e})=>e,o.image=e=>"",o.text=({text:e})=>e,o.link=({text:e})=>e,o}var E5e=new $n(o=>x2()),w5e=new $n(()=>{let o=x2();return o.code=({text:e})=>`
\`\`\`
${e}
\`\`\`
`,o});function uS(o){let e="";return o.forEach(t=>{e+=t.raw}),e}function E2(o){if(o.tokens)for(let e=o.tokens.length-1;e>=0;e--){let t=o.tokens[e];if(t.type==="text"){let n=t.raw.split(`
`),i=n[n.length-1];if(i.includes("`"))return D7(o);if(i.includes("**"))return O7(o);if(i.match(/\*\w/))return R7(o);if(i.match(/(^|\s)__\w/))return P7(o);if(i.match(/(^|\s)_\w/))return k7(o);if(x7(i)||E7(i)&&o.tokens.slice(0,e).some(r=>r.type==="text"&&r.raw.match(/\[[^\]]*$/))){let r=o.tokens.slice(e+1);return r[0]?.type==="link"&&r[1]?.type==="text"&&r[1].raw.match(/^ *"[^"]*$/)||i.match(/^[^"]* +"[^"]*$/)?N7(o):M7(o)}else if(i.match(/(^|\s)\[\w*/))return A7(o)}}}function x7(o){return!!o.match(/(^|\s)\[.*\]\(\w*/)}function E7(o){return!!o.match(/^[^\[]*\]\([^\)]*$/)}function w7(o){let e=o.items[o.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,n;if(t?.type==="text"&&!("inRawBlock"in e)&&(n=E2(t)),!n||n.type!=="paragraph")return;let i=uS(o.items.slice(0,-1)),r=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!r)return;let s=r+uS(e.tokens.slice(0,-1))+n.raw,a=hb(i+s)[0];if(a.type==="list")return a}var _7=3;function T7(o){for(let e=0;e<_7;e++){let t=L7(o);if(t)o=t;else break}return o}function L7(o){let e,t;for(e=0;e<o.length;e++){let n=o[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=F7(o.slice(e));break}if(e===o.length-1&&n.type==="list"){let i=w7(n);if(i){t=[i];break}}if(e===o.length-1&&n.type==="paragraph"){let i=E2(n);if(i){t=[i];break}}}if(t){let n=[...o.slice(0,e),...t];return n.links=o.links,n}return null}function D7(o){return Kd(o,"`")}function R7(o){return Kd(o,"*")}function k7(o){return Kd(o,"_")}function M7(o){return Kd(o,")")}function N7(o){return Kd(o,'")')}function A7(o){return Kd(o,"](https://microsoft.com)")}function O7(o){return Kd(o,"**")}function P7(o){return Kd(o,"__")}function Kd(o,e){let t=uS(Array.isArray(o)?o:[o]);return hb(t+e)[0]}function F7(o){let e=uS(o),t=e.split(`
`),n,i=!1;for(let r=0;r<t.length;r++){let s=t[r].trim();if(typeof n>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(n=a.length)}else if(typeof n=="number")if(s.match(/^\s*\|/)){if(r!==t.length-1)return;i=!0}else return}if(typeof n=="number"&&n>0){let r=i?t.slice(0,-1).join(`
`):e,s=!!r.match(/\|\s*$/),a=r+(s?"":"|")+`
|${" --- |".repeat(n)}`;return hb(a)}}function S2(o,e){return VC(o,e),pe(()=>WC(o))}var B7={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function Fr(){return B7}var su=je,w2="selectOption.entry.template",b0=class{get templateId(){return w2}renderTemplate(e){let t=Object.create(null);return t.root=e,t.text=zt(e,su(".option-text")),t.detail=zt(e,su(".option-detail")),t.decoratorRight=zt(e,su(".option-decorator-right")),t}renderElement(e,t,n){let i=n,r=e.text,s=e.detail,a=e.decoratorRight,l=e.isDisabled;i.text.textContent=r,i.detail.textContent=s||"",i.decoratorRight.innerText=a||"",l?i.root.classList.add("option-disabled"):i.root.classList.remove("option-disabled")}disposeTemplate(e){}},hS=class o extends B{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(e,t,n,i,r){super(),this._isVisible=!1,this.styles=i,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=o.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new T,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(n),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(Fr().setupManagedHover(Uo("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return w2}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=je(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=zt(this.selectDropDownContainer,su(".select-box-details-pane"));let t=zt(this.selectDropDownContainer,su(".select-box-dropdown-container-width-control")),n=zt(t,su(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",zt(n,this.widthControlElement),this._dropDownPosition=0,this.styleElement=es(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(z(this.selectDropDownContainer,me.DRAG_START,i=>{Qe.stop(i,!0)}))}registerListeners(){this._register(Bi(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(z(this.selectElement,me.CLICK,t=>{Qe.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(z(this.selectElement,me.MOUSE_DOWN,t=>{Qe.stop(t)}));let e;this._register(z(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(z(this.selectElement,"touchend",t=>{Qe.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(z(this.selectElement,me.KEY_DOWN,t=>{let n=new vt(t),i=!1;Fe?(n.keyCode===18||n.keyCode===16||n.keyCode===10||n.keyCode===3)&&(i=!0):(n.keyCode===18&&n.altKey||n.keyCode===16&&n.altKey||n.keyCode===10||n.keyCode===3)&&(i=!0),i&&(this.showSelectDropDown(),Qe.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){Lt(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled)),typeof n.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setEnabled(e){this.selectElement.disabled=!e}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){let e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",n=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=n}styleList(){let e=this.styles.selectBackground??"",t=wl(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;let n=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=n,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,n)=>{this.updateDetail(n),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let t=Ce(this.selectElement),n=cr(this.selectElement),i=Ce(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(i.getPropertyValue("--dropdown-padding-top"))+parseFloat(i.getPropertyValue("--dropdown-padding-bottom")),s=t.innerHeight-n.top-n.height-(this.selectBoxOptions.minBottomMargin||0),a=n.top-o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let h=this._hasDetails?this._cachedMaxDetailsHeight:0,m=u+r+h,g=Math.floor((s-r-h)/this.getHeight()),f=Math.floor((a-r-h)/this.getHeight());if(e)return n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||g<1&&f<1?!1:(g<o.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&f>g&&this.options.length>g?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&g<1||this._dropDownPosition===1&&f<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&g+f<1)return this.hideSelectDropDown(!0),!1;m>s&&(u=g*this.getHeight())}else m>a&&(u=f*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let n=0,i=0;this.options.forEach((r,s)=>{let a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,d=r.text.length+a+l;d>i&&(n=s,i=d)}),e.textContent=this.options[n].text+(this.options[n].decoratorRight?this.options[n].decoratorRight+" ":""),t=KC(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=zt(e,su(".select-box-dropdown-list-container")),this.listRenderer=new b0,this.selectList=this._register(new Pr("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:i=>{let r=i.text;return i.detail&&(r+=`. ${i.detail}`),i.decoratorRight&&(r+=`. ${i.decoratorRight}`),i.description&&(r+=`. ${i.description}`),r},getWidgetAriaLabel:()=>p({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Fe?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let t=this._register(new Oe(this.selectDropDownListContainer,"keydown")),n=Y.chain(t.event,i=>i.filter(()=>this.selectList.length>0).map(r=>new vt(r)));this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(Y.chain(n,i=>i.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(z(this.selectList.getHTMLElement(),me.POINTER_UP,i=>this.onPointerUp(i))),this._register(this.selectList.onMouseOver(i=>typeof i.index<"u"&&this.selectList.setFocus([i.index]))),this._register(this.selectList.onDidChangeFocus(i=>this.onListFocus(i))),this._register(z(this.selectDropDownContainer,me.FOCUS_OUT,i=>{!this._isVisible||Jr(i.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;Qe.stop(e);let t=e.target;if(!t||t.classList.contains("slider"))return;let n=t.closest(".monaco-list-row");if(!n)return;let i=Number(n.getAttribute("data-index")),r=n.classList.contains("option-disabled");i>=0&&i<this.options.length&&!r&&(this.selected=i,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){let n=r=>{for(let s=0;s<r.childNodes.length;s++){let a=r.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():n(a)}},i=f0({value:e,supportThemeIcons:!0},{actionHandler:t});return i.element.classList.add("select-box-description-markdown"),n(i.element),i.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";let t=this.options[e],n=t?.description??"",i=t?.descriptionIsMarkdown??!1;if(n){if(i){let r=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(n,r))}else this.selectionDetailsPane.innerText=n;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){Qe.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){Qe.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){Qe.stop(e,!0);let t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(Qe.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){Qe.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){Qe.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){Qe.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){Qe.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){let t=Bg.toString(e.keyCode),n=-1;for(let i=0;i<this.options.length-1;i++)if(n=(i+this.selected+1)%this.options.length,this.options[n].text.charAt(0).toUpperCase()===t&&!this.options[n].isDisabled){this.select(n),this.selectList.setFocus([n]),this.selectList.reveal(this.selectList.getFocus()[0]),Qe.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var pS=class extends B{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(e,t,n,i){super(),this.selectBoxOptions=i||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new T),this.styles=n,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Ln.addTarget(this.selectElement)),[yt.Tap].forEach(e=>{this._register(z(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(Bi(this.selectElement,"click",e=>{Qe.stop(e,!0)})),this._register(Bi(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(Bi(this.selectElement,"keydown",e=>{let t=!1;Fe?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!Lt(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",e)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(e){this.selectElement.disabled=!e}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(e){this.styles=e,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}};var PUe={...f2,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},mS=class extends Ho{selectBoxDelegate;constructor(e,t,n,i,r){super(),Fe&&!r?.useCustomDrawn?this.selectBoxDelegate=new pS(e,t,i,r):this.selectBoxDelegate=new hS(e,t,n,i,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}setAriaLabel(e){this.selectBoxDelegate.setAriaLabel(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}setEnabled(e){this.selectBoxDelegate.setEnabled(e)}render(e){this.selectBoxDelegate.render(e)}};var Ep=class extends Ho{_onChange=this._register(new T);onChange=this._onChange.event;_onKeyDown=this._register(new T);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(e){super(),this._opts=e,this._checked=this._opts.isChecked;let t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Xe.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(Fr().setupManagedHover(e.hoverDelegate??Uo("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,n=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),n.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,n=>{if(n.keyCode===10||n.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),n.preventDefault(),n.stopPropagation();return}this._onKeyDown.fire(n)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...Xe.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...Xe.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(e){this._hover.update(e),this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var io=class extends B{constructor(t,n,i={}){super();this.options=i;this._context=t||this,this._action=n,n instanceof Er&&this._register(n.onDidChange(r=>{this.element&&this.handleActionChangeEvent(r)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(t){t.enabled!==void 0&&this.updateEnabled(),t.checked!==void 0&&this.updateChecked(),t.class!==void 0&&this.updateClass(),t.label!==void 0&&(this.updateLabel(),this.updateTooltip()),t.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new wr)),this._actionRunner}set actionRunner(t){this._actionRunner=t}isEnabled(){return this._action.enabled}setActionContext(t){this._context=t}render(t){let n=this.element=t;this._register(Ln.addTarget(t));let i=this.options&&this.options.draggable;i&&(t.draggable=!0,Bn&&this._register(z(t,me.DRAG_START,r=>r.dataTransfer?.setData(XC.TEXT,this._action.label)))),this._register(z(n,yt.Tap,r=>this.onClick(r,!0))),this._register(z(n,me.MOUSE_DOWN,r=>{i||Qe.stop(r,!0),this._action.enabled&&r.button===0&&n.classList.add("active")})),Fe&&this._register(z(n,me.CONTEXT_MENU,r=>{r.button===0&&r.ctrlKey===!0&&this.onClick(r)})),this._register(z(n,me.CLICK,r=>{Qe.stop(r,!0),this.options&&this.options.isMenu||this.onClick(r)})),this._register(z(n,me.DBLCLICK,r=>{Qe.stop(r,!0)})),[me.MOUSE_UP,me.MOUSE_OUT].forEach(r=>{this._register(z(n,r,s=>{Qe.stop(s),n.classList.remove("active")}))})}onClick(t,n=!1){Qe.stop(t,!0);let i=Mi(this._context)?this.options?.useEventAsContext?t:{preserveFocus:n}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(t){this.element&&(this.element.tabIndex=t?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let t=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=t;else if(!this.customHover&&t!==""){let n=this.options.hoverDelegate??Uo("element");this.customHover=this._store.add(Fr().setupManagedHover(n,this.element,t))}else this.customHover&&this.customHover.update(t)}updateAriaLabel(){if(this.element){let t=this.getTooltip()??"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},Gd=class extends io{label;options;cssClass;constructor(e,t,n){super(e,t,n),this.options=n,this.options.icon=n.icon!==void 0?n.icon:!1,this.options.label=n.label!==void 0?n.label:!0,this.cssClass=""}render(e){super.render(e),tl(this.element);let t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){let n=document.createElement("span");n.classList.add("keybinding"),n.textContent=this.options.keybinding,this.element.appendChild(n)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===jn.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=p({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},gS=class extends io{selectBox;constructor(e,t,n,i,r,s,a){super(e,t),this.selectBox=new mS(n,i,r,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(e,t){this.selectBox.setOptions(e,t)}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}};var Aa=class extends B{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new oe);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new Sr);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new T);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new T({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new T);onDidRun=this._onDidRun.event;_onWillRun=this._register(new T);onWillRun=this._onWillRun.event;constructor(e,t={}){super(),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(ou()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new wr,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(r=>this._onDidRun.fire(r))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(r=>this._onWillRun.fire(r))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let n,i;switch(this._orientation){case 0:n=[15],i=[17];break;case 1:n=[16],i=[18],this.domNode.className+=" vertical";break}this._register(z(this.domNode,me.KEY_DOWN,r=>{let s=new vt(r),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusPrevious():i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof io&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(z(this.domNode,me.KEY_UP,r=>{let s=new vt(r);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(El(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Wo()===this.domNode||!Jr(Wo(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(e){e?this.actionsList.setAttribute("aria-label",e):this.actionsList.removeAttribute("aria-label")}setFocusable(e){if(this.focusable=e,this.focusable){let t=this.viewItems.find(n=>n instanceof io&&n.isEnabled());t instanceof io&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof io&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(n=>{t=t||e.equals(n)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){let t=this.actionsList.children[e];if(Jr(Wo(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}hasAction(e){return this.viewItems.findIndex(t=>t.action.id===e.id)!==-1}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(ai(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){let n=Array.isArray(e)?e:[e],i=mi(t.index)?t.index:null;n.forEach(r=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new Gd(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,z(s,me.CONTEXT_MENU,d=>{Qe.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof io&&this.viewItems.length===0&&a.setFocusable(!0),i===null||i<0||i>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[i]),this.viewItems.splice(i,0,a),i++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}getHeight(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientHeight}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),Nt(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=Nt(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),dr(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,n;if(e===void 0?t=!0:typeof e=="number"?n=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){let i=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=i===-1?void 0:i,this.updateFocus(void 0,void 0,!0)}else n!==void 0&&(this.focusedItem=n),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let n=this.focusedItem,i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=n,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==n&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===jn.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let t=this.focusedItem,n;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}n=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===jn.ID));return this.updateFocus(!0),!0}updateFocus(e,t,n=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let i=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(i){let r=!0;Ig(i.focus)||(r=!1),this.options.focusOnlyEnabledItems&&Ig(i.isEnabled)&&!i.isEnabled()&&(r=!1),i.action.id===jn.ID&&(r=!1),r?(n||this.previouslyFocusedItem!==this.focusedItem)&&(i.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),r&&i.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;let t=this.viewItems[this.focusedItem];if(t instanceof io){let n=t._context===null||t._context===void 0?e:t._context;this.run(t._action,n)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=Nt(this.viewItems),this.getContainer().remove(),super.dispose()}};var V7=!1;var W7=4,H7=new T;var U7=300,z7=new T;var pb=class{constructor(e){this.el=e}disposables=new oe;get onPointerMove(){return this.disposables.add(new Oe(Ce(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Oe(Ce(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};k([he],pb.prototype,"onPointerMove",1),k([he],pb.prototype,"onPointerUp",1);var mb=class{constructor(e){this.el=e}disposables=new oe;get onPointerMove(){return this.disposables.add(new Oe(this.el,yt.Change)).event}get onPointerUp(){return this.disposables.add(new Oe(this.el,yt.End)).event}dispose(){this.disposables.dispose()}};k([he],mb.prototype,"onPointerMove",1),k([he],mb.prototype,"onPointerUp",1);var wp=class{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};k([he],wp.prototype,"onPointerMove",1),k([he],wp.prototype,"onPointerUp",1);var _2="pointer-events-disabled",gb=class o extends B{el;layoutProvider;orientation;size;hoverDelay=U7;hoverDelayer=this._register(new fs(this.hoverDelay));_state=3;onDidEnablementChange=this._register(new T);_onDidStart=this._register(new T);_onDidChange=this._register(new T);_onDidReset=this._register(new T);_onDidEnd=this._register(new T);orthogonalStartSashDisposables=this._register(new oe);_orthogonalStartSash;orthogonalStartDragHandleDisposables=this._register(new oe);_orthogonalStartDragHandle;orthogonalEndSashDisposables=this._register(new oe);_orthogonalEndSash;orthogonalEndDragHandleDisposables=this._register(new oe);_orthogonalEndDragHandle;get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}onDidStart=this._onDidStart.event;onDidChange=this._onDidChange.event;onDidReset=this._onDidReset.event;onDidEnd=this._onDidEnd.event;linkedSash=void 0;set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){let t=n=>{this.orthogonalStartDragHandleDisposables.clear(),n!==0&&(this._orthogonalStartDragHandle=zt(this.el,je(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(pe(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new Oe(this._orthogonalStartDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new Oe(this._orthogonalStartDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){let t=n=>{this.orthogonalEndDragHandleDisposables.clear(),n!==0&&(this._orthogonalEndDragHandle=zt(this.el,je(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(pe(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new Oe(this._orthogonalEndDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new Oe(this._orthogonalEndDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,n){super(),this.el=zt(e,je(".monaco-sash")),n.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${n.orthogonalEdge}`),Fe&&this.el.classList.add("mac");let i=this._register(new Oe(this.el,"mousedown")).event;this._register(i(u=>this.onPointerStart(u,new pb(e)),this));let r=this._register(new Oe(this.el,"dblclick")).event;this._register(r(this.onPointerDoublePress,this));let s=this._register(new Oe(this.el,"mouseenter")).event;this._register(s(()=>o.onMouseEnter(this)));let a=this._register(new Oe(this.el,"mouseleave")).event;this._register(a(()=>o.onMouseLeave(this))),this._register(Ln.addTarget(this.el));let l=this._register(new Oe(this.el,yt.Start)).event;this._register(l(u=>this.onPointerStart(u,new mb(this.el)),this));let d=this._register(new Oe(this.el,yt.Tap)).event,c;this._register(d(u=>{if(c){clearTimeout(c),c=void 0,this.onPointerDoublePress(u);return}clearTimeout(c),c=setTimeout(()=>c=void 0,250)},this)),typeof n.size=="number"?(this.size=n.size,n.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=W7,this._register(H7.event(u=>{this.size=u,this.layout()}))),this._register(z7.event(u=>this.hoverDelay=u)),this.layoutProvider=t,this.orthogonalStartSash=n.orthogonalStartSash,this.orthogonalEndSash=n.orthogonalEndSash,this.orientation=n.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",V7),this.layout()}onPointerStart(e,t){Qe.stop(e);let n=!1;if(!e.__orthogonalSashEvent){let g=this.getOrthogonalSash(e);g&&(n=!0,e.__orthogonalSashEvent=!0,g.onPointerStart(e,new wp(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new wp(t))),!this.state)return;let i=this.el.ownerDocument.getElementsByTagName("iframe");for(let g of i)g.classList.add(_2);let r=e.pageX,s=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:s,currentY:s,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);let d=es(this.el),c=()=>{let g="";n?g="all-scroll":this.orientation===1?this.state===1?g="s-resize":this.state===2?g="n-resize":g=Fe?"row-resize":"ns-resize":this.state===1?g="e-resize":this.state===2?g="w-resize":g=Fe?"col-resize":"ew-resize",d.textContent=`* { cursor: ${g} !important; }`},u=new oe;c(),n||this.onDidEnablementChange.event(c,null,u);let h=g=>{Qe.stop(g,!1);let f={startX:r,currentX:g.pageX,startY:s,currentY:g.pageY,altKey:a};this._onDidChange.fire(f)},m=g=>{Qe.stop(g,!1),d.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(let f of i)f.classList.remove(_2)};t.onPointerMove(h,null,u),t.onPointerUp(m,null,u),u.add(t)}onPointerDoublePress(e){let t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&o.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&o.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){o.onMouseLeave(this)}layout(){if(this.orientation===0){let e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{let e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){let t=e.initialTarget??e.target;if(!(!t||!ai(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}};var fS=class extends Jf{constructor(t,n,i,r){super(t,i,r);this.telemetryService=n}_onTitleAreaUpdate=this._register(new T);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidFocus;get onDidFocus(){return this._onDidFocus||(this._onDidFocus=this.registerFocusTrackEvents().onDidFocus),this._onDidFocus.event}_onDidBlur;get onDidBlur(){return this._onDidBlur||(this._onDidBlur=this.registerFocusTrackEvents().onDidBlur),this._onDidBlur.event}_hasFocus=!1;hasFocus(){return this._hasFocus}registerFocusTrackEvents(){let t=To(this.getContainer()),n=this._register(El(t)),i=this._onDidFocus=this._register(new T);this._register(n.onDidFocus(()=>{this._hasFocus=!0,i.fire()}));let r=this._onDidBlur=this._register(new T);return this._register(n.onDidBlur(()=>{this._hasFocus=!1,r.fire()})),{onDidFocus:i,onDidBlur:r}}actionRunner;visible=!1;parent;getTitle(){}create(t){this.parent=t}getContainer(){return this.parent}setVisible(t){this.visible!==!!t&&(this.visible=t)}focus(){}getMenuIds(){return[]}getActions(){return[]}getSecondaryActions(){return[]}getContextMenuActions(){return[]}getActionViewItem(t,n){}getActionsContext(){return null}getActionRunner(){return this.actionRunner||(this.actionRunner=this._register(new wr)),this.actionRunner}updateTitleArea(){this._onTitleAreaUpdate.fire()}isVisible(){return this.visible}getControl(){}};var K7={separatorBorder:W.transparent};var bS=class{constructor(e,t,n,i){this.container=e;this.view=t;this.disposable=i;typeof n=="number"?(this._size=n,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=n.cachedVisibleSize)}_size;set size(e){this._size=e}get size(){return this._size}_cachedVisibleSize=void 0;get cachedVisibleSize(){return this._cachedVisibleSize}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){if(e!==this.visible){e?(this.size=Vn(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{this.view.setVisible?.(e)}catch(n){console.error("Splitview: Failed to set visible view"),console.error(n)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(n){console.error("Splitview: Failed to layout view"),console.error(n)}}dispose(){this.disposable.dispose()}},v0=class extends bS{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}},y0=class extends bS{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}};var pr;(i=>{i.Distribute={type:"distribute"};function e(r){return{type:"split",index:r}}i.Split=e;function t(r){return{type:"auto",index:r}}i.Auto=t;function n(r){return{type:"invisible",cachedVisibleSize:r}}i.Invisible=n})(pr||={});var fb=class extends B{orientation;el;sashContainer;viewContainer;scrollable;scrollableElement;size=0;layoutContext;_contentSize=0;proportions=void 0;viewItems=[];sashItems=[];sashDragState;state=0;inverseAltBehavior;proportionalLayout;getSashOrthogonalSize;_onDidSashChange=this._register(new T);_onDidSashReset=this._register(new T);_orthogonalStartSash;_orthogonalEndSash;_startSnappingEnabled=!0;_endSnappingEnabled=!0;get contentSize(){return this._contentSize}onDidSashChange=this._onDidSashChange.event;onDidSashReset=this._onDidSashReset.event;onDidScroll;get length(){return this.viewItems.length}get minimumSize(){return this.viewItems.reduce((e,t)=>e+t.minimumSize,0)}get maximumSize(){return this.length===0?Number.POSITIVE_INFINITY:this.viewItems.reduce((e,t)=>e+t.maximumSize,0)}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(let t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(let t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}get sashes(){return this.sashItems.map(e=>e.sash)}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=zt(this.el,je(".sash-container")),this.viewContainer=je(".split-view-container"),this.scrollable=this._register(new rl({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:i=>Ii(Ce(this.el),i)})),this.scrollableElement=this._register(new zd(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));let n=this._register(new Oe(this.viewContainer,"scroll")).event;this._register(n(i=>{let r=this.scrollableElement.getScrollPosition(),s=Math.abs(this.viewContainer.scrollLeft-r.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-r.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(s!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:s,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(i=>{i.scrollTopChanged&&(this.viewContainer.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this.viewContainer.scrollLeft=i.scrollLeft)})),zt(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||K7),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((i,r)=>{let s=an(i.visible)||i.visible?i.size:{type:"invisible",cachedVisibleSize:i.size},a=i.view;this.doAddView(a,s,r,!0)}),this._contentSize=this.viewItems.reduce((i,r)=>i+r.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,n=this.viewItems.length,i){this.doAddView(e,t,n,i)}removeView(e,t){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{t?.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index});let n=t?.type==="split"?this.viewItems[t.index]:void 0,i=this.viewItems.splice(e,1)[0];if(n&&(n.size+=i.size),this.viewItems.length>=1){let s=Math.max(e-1,0);this.sashItems.splice(s,1)[0].disposable.dispose()}this.relayout(),t?.type==="distribute"&&this.distributeViewSizes();let r=i.view;return i.dispose(),r}finally{this.state=0}}removeAllViews(){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let e=this.viewItems.splice(0,this.viewItems.length);for(let n of e)n.dispose();let t=this.sashItems.splice(0,this.sashItems.length);for(let n of t)n.disposable.dispose();return this.relayout(),e.map(n=>n.view)}finally{this.state=0}}moveView(e,t){if(this.state!==0)throw new Error("Cant modify splitview");let n=this.getViewCachedVisibleSize(e),i=typeof n>"u"?this.getViewSize(e):pr.Invisible(n),r=this.removeView(e);this.addView(r,i,t)}swapViews(e,t){if(this.state!==0)throw new Error("Cant modify splitview");if(e>t)return this.swapViews(t,e);let n=this.getViewSize(e),i=this.getViewSize(t),r=this.removeView(t),s=this.removeView(e);this.addView(r,n,e),this.addView(s,i,t)}isViewVisible(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].visible}setViewVisible(e,t){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");this.viewItems[e].setVisible(t),this.distributeEmptySpace(e),this.layoutViews(),this.saveProportions()}getViewCachedVisibleSize(e){if(e<0||e>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[e].cachedVisibleSize}layout(e,t){let n=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let i=0;for(let r=0;r<this.viewItems.length;r++){let s=this.viewItems[r],a=this.proportions[r];typeof a=="number"?i+=a:e-=s.size}for(let r=0;r<this.viewItems.length;r++){let s=this.viewItems[r],a=this.proportions[r];typeof a=="number"&&i>0&&(s.size=Vn(Math.round(a*e/i),s.minimumSize,s.maximumSize))}}else{let i=zi(this.viewItems.length),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-n,void 0,r,s)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:n}){for(let a of this.viewItems)a.enabled=!1;let i=this.sashItems.findIndex(a=>a.sash===e),r=Zo(z(this.el.ownerDocument.body,"keydown",a=>s(this.sashDragState.current,a.altKey)),z(this.el.ownerDocument.body,"keyup",()=>s(this.sashDragState.current,!1))),s=(a,l)=>{let d=this.viewItems.map(g=>g.size),c=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(i===this.sashItems.length-1){let f=this.viewItems[i];c=(f.minimumSize-f.size)/2,u=(f.maximumSize-f.size)/2}else{let f=this.viewItems[i+1];c=(f.size-f.maximumSize)/2,u=(f.size-f.minimumSize)/2}let h,m;if(!l){let g=zi(i,-1),f=zi(i+1,this.viewItems.length),b=g.reduce((A,P)=>A+(this.viewItems[P].minimumSize-d[P]),0),y=g.reduce((A,P)=>A+(this.viewItems[P].viewMaximumSize-d[P]),0),C=f.length===0?Number.POSITIVE_INFINITY:f.reduce((A,P)=>A+(d[P]-this.viewItems[P].minimumSize),0),S=f.length===0?Number.NEGATIVE_INFINITY:f.reduce((A,P)=>A+(d[P]-this.viewItems[P].viewMaximumSize),0),w=Math.max(b,S),R=Math.min(C,y),M=this.findFirstSnapIndex(g),N=this.findFirstSnapIndex(f);if(typeof M=="number"){let A=this.viewItems[M],P=Math.floor(A.viewMinimumSize/2);h={index:M,limitDelta:A.visible?w-P:w+P,size:A.size}}if(typeof N=="number"){let A=this.viewItems[N],P=Math.floor(A.viewMinimumSize/2);m={index:N,limitDelta:A.visible?R+P:R-P,size:A.size}}}this.sashDragState={start:a,current:a,index:i,sizes:d,minDelta:c,maxDelta:u,alt:l,snapBefore:h,snapAfter:m,disposable:r}};s(t,n)}onSashChange({current:e}){let{index:t,start:n,sizes:i,alt:r,minDelta:s,maxDelta:a,snapBefore:l,snapAfter:d}=this.sashDragState;this.sashDragState.current=e;let c=e-n,u=this.resize(t,c,i,void 0,void 0,s,a,l,d);if(r){let h=t===this.sashItems.length-1,m=this.viewItems.map(S=>S.size),g=h?t:t+1,f=this.viewItems[g],b=f.size-f.maximumSize,y=f.size-f.minimumSize,C=h?t-1:t+1;this.resize(C,-u,m,void 0,void 0,b,y)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(let t of this.viewItems)t.enabled=!0}onViewChange(e,t){let n=this.viewItems.indexOf(e);n<0||n>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=Vn(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&n>0?(this.resize(n-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([n],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let n=zi(this.viewItems.length).filter(a=>a!==e),i=[...n.filter(a=>this.viewItems[a].priority===1),e],r=n.filter(a=>this.viewItems[a].priority===2),s=this.viewItems[e];t=Math.round(t),t=Vn(t,s.minimumSize,Math.min(s.maximumSize,this.size)),s.size=t,this.relayout(i,r)}finally{this.state=0}}}isViewExpanded(e){if(e<0||e>=this.viewItems.length)return!1;for(let t of this.viewItems)if(t!==this.viewItems[e]&&t.size>t.minimumSize)return!1;return!0}distributeViewSizes(){let e=[],t=0;for(let a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);let n=Math.floor(t/e.length);for(let a of e)a.size=Vn(n,a.minimumSize,a.maximumSize);let i=zi(this.viewItems.length),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);this.relayout(r,s)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,n=this.viewItems.length,i){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let r=je(".split-view-view");n===this.viewItems.length?this.viewContainer.appendChild(r):this.viewContainer.insertBefore(r,this.viewContainer.children.item(n));let s=e.onDidChange(h=>this.onViewChange(c,h)),a=pe(()=>r.remove()),l=Zo(s,a),d;typeof t=="number"?d=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?d=this.getViewSize(t.index)/2:t.type==="invisible"?d={cachedVisibleSize:t.cachedVisibleSize}:d=e.minimumSize);let c=this.orientation===0?new v0(r,e,d,l):new y0(r,e,d,l);if(this.viewItems.splice(n,0,c),this.viewItems.length>1){let h={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},m=this.orientation===0?new gb(this.sashContainer,{getHorizontalSashTop:A=>this.getSashPosition(A),getHorizontalSashWidth:this.getSashOrthogonalSize},{...h,orientation:1}):new gb(this.sashContainer,{getVerticalSashLeft:A=>this.getSashPosition(A),getVerticalSashHeight:this.getSashOrthogonalSize},{...h,orientation:0}),g=this.orientation===0?A=>({sash:m,start:A.startY,current:A.currentY,alt:A.altKey}):A=>({sash:m,start:A.startX,current:A.currentX,alt:A.altKey}),b=Y.map(m.onDidStart,g)(this.onSashStart,this),C=Y.map(m.onDidChange,g)(this.onSashChange,this),w=Y.map(m.onDidEnd,()=>this.sashItems.findIndex(A=>A.sash===m))(this.onSashEnd,this),R=m.onDidReset(()=>{let A=this.sashItems.findIndex(le=>le.sash===m),P=zi(A,-1),K=zi(A+1,this.viewItems.length),j=this.findFirstSnapIndex(P),X=this.findFirstSnapIndex(K);typeof j=="number"&&!this.viewItems[j].visible||typeof X=="number"&&!this.viewItems[X].visible||this._onDidSashReset.fire(A)}),M=Zo(b,C,w,R,m),N={sash:m,disposable:M};this.sashItems.splice(n-1,0,N)}r.appendChild(e.element);let u;typeof t!="number"&&t.type==="split"&&(u=[t.index]),i||this.relayout([n],u),!i&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=0}}relayout(e,t){let n=this.viewItems.reduce((i,r)=>i+r.size,0);this.resize(this.viewItems.length-1,this.size-n,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,n=this.viewItems.map(c=>c.size),i,r,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,d){if(e<0||e>=this.viewItems.length)return 0;let c=zi(e,-1),u=zi(e+1,this.viewItems.length);if(r)for(let N of r)Sv(c,N),Sv(u,N);if(i)for(let N of i)ig(c,N),ig(u,N);let h=c.map(N=>this.viewItems[N]),m=c.map(N=>n[N]),g=u.map(N=>this.viewItems[N]),f=u.map(N=>n[N]),b=c.reduce((N,A)=>N+(this.viewItems[A].minimumSize-n[A]),0),y=c.reduce((N,A)=>N+(this.viewItems[A].maximumSize-n[A]),0),C=u.length===0?Number.POSITIVE_INFINITY:u.reduce((N,A)=>N+(n[A]-this.viewItems[A].minimumSize),0),S=u.length===0?Number.NEGATIVE_INFINITY:u.reduce((N,A)=>N+(n[A]-this.viewItems[A].maximumSize),0),w=Math.max(b,S,s),R=Math.min(C,y,a),M=!1;if(l){let N=this.viewItems[l.index],A=t>=l.limitDelta;M=A!==N.visible,N.setVisible(A,l.size)}if(!M&&d){let N=this.viewItems[d.index],A=t<d.limitDelta;M=A!==N.visible,N.setVisible(A,d.size)}if(M)return this.resize(e,t,n,i,r,s,a);t=Vn(t,w,R);for(let N=0,A=t;N<h.length;N++){let P=h[N],K=Vn(m[N]+A,P.minimumSize,P.maximumSize),j=K-m[N];A-=j,P.size=K}for(let N=0,A=t;N<g.length;N++){let P=g[N],K=Vn(f[N]-A,P.minimumSize,P.maximumSize),j=K-f[N];A+=j,P.size=K}return t}distributeEmptySpace(e){let t=this.viewItems.reduce((a,l)=>a+l.size,0),n=this.size-t,i=zi(this.viewItems.length-1,-1),r=i.filter(a=>this.viewItems[a].priority===1),s=i.filter(a=>this.viewItems[a].priority===2);for(let a of s)Sv(i,a);for(let a of r)ig(i,a);typeof e=="number"&&ig(i,e);for(let a=0;n!==0&&a<i.length;a++){let l=this.viewItems[i[a]],d=Vn(l.size+n,l.minimumSize,l.maximumSize),c=d-l.size;n-=c,l.size=d}}layoutViews(){this._contentSize=this.viewItems.reduce((t,n)=>t+n.size,0);let e=0;for(let t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1,t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;let n=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),i=[...this.viewItems].reverse();e=!1;let r=i.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;let s=i.map(l=>e=l.maximumSize-l.size>0||e).reverse(),a=0;for(let l=0;l<this.sashItems.length;l++){let{sash:d}=this.sashItems[l],c=this.viewItems[l];a+=c.size;let u=!(t[l]&&s[l+1]),h=!(n[l]&&r[l+1]);if(u&&h){let m=zi(l,-1),g=zi(l+1,this.viewItems.length),f=this.findFirstSnapIndex(m),b=this.findFirstSnapIndex(g),y=typeof f=="number"&&!this.viewItems[f].visible,C=typeof b=="number"&&!this.viewItems[b].visible;y&&r[l]&&(a>0||this.startSnappingEnabled)?d.state=1:C&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?d.state=2:d.state=0}else u&&!h?d.state=1:!u&&h?d.state=2:d.state=3}}getSashPosition(e){let t=0;for(let n=0;n<this.sashItems.length;n++)if(t+=this.viewItems[n].size,this.sashItems[n].sash===e)return t;return 0}findFirstSnapIndex(e){for(let t of e){let n=this.viewItems[t];if(n.visible&&n.snap)return t}for(let t of e){let n=this.viewItems[t];if(n.visible&&n.maximumSize-n.minimumSize>0)return;if(!n.visible&&n.snap)return t}}areViewsDistributed(){let e,t;for(let n of this.viewItems)if(e=e===void 0?n.size:Math.min(e,n.size),t=t===void 0?n.size:Math.max(t,n.size),t-e>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),Nt(this.viewItems),this.viewItems=[],this.sashItems.forEach(e=>e.disposable.dispose()),this.sashItems=[],super.dispose()}};var G7={separatorBorder:W.transparent};function Ms(o){return o===0?1:0}var I0=class{constructor(e){this.isLayoutEnabled=e}};function j7(o,e){return e===1?{left:o.start,right:o.end,top:o.orthogonalStart,bottom:o.orthogonalEnd}:{top:o.start,bottom:o.end,left:o.orthogonalStart,right:o.orthogonalEnd}}function $7(o,e){return e===1?{start:o.left,end:o.right,orthogonalStart:o.top,orthogonalEnd:o.bottom}:{start:o.top,end:o.bottom,orthogonalStart:o.left,orthogonalEnd:o.right}}function ks(o,e){if(Math.abs(o)>e)throw new Error("Invalid index");return MB(o,e+1)}var Dn=class o{constructor(e,t,n,i,r=0,s=0,a=!1,l){this.orientation=e;this.layoutController=t;this.splitviewProportionalLayout=i;if(this._styles=n,this._size=r,this._orthogonalSize=s,this.element=je(".monaco-grid-branch-node"),!l)this.splitview=new fb(this.element,{orientation:e,styles:n,proportionalLayout:i}),this.splitview.layout(r,{orthogonalSize:s,absoluteOffset:0,absoluteOrthogonalOffset:0,absoluteSize:r,absoluteOrthogonalSize:s});else{let c={views:l.map(h=>({view:h.node,size:h.node.size,visible:h.visible!==!1})),size:this.orthogonalSize},u={proportionalLayout:i,orientation:e,styles:n};this.children=l.map(h=>h.node),this.splitview=new fb(this.element,{...u,descriptor:c}),this.children.forEach((h,m)=>{let g=m===0,f=m===this.children.length;h.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:g?this.boundarySashes.start:this.splitview.sashes[m-1],orthogonalEnd:f?this.boundarySashes.end:this.splitview.sashes[m]}})}let d=Y.map(this.splitview.onDidSashReset,c=>[c]);this.splitviewSashResetDisposable=d(this._onDidSashReset.fire,this._onDidSashReset),this.updateChildrenEvents()}element;children=[];splitview;_size;get size(){return this._size}_orthogonalSize;get orthogonalSize(){return this._orthogonalSize}_absoluteOffset=0;get absoluteOffset(){return this._absoluteOffset}_absoluteOrthogonalOffset=0;get absoluteOrthogonalOffset(){return this._absoluteOrthogonalOffset}absoluteOrthogonalSize=0;_styles;get styles(){return this._styles}get width(){return this.orientation===1?this.size:this.orthogonalSize}get height(){return this.orientation===1?this.orthogonalSize:this.size}get top(){return this.orientation===1?this._absoluteOffset:this._absoluteOrthogonalOffset}get left(){return this.orientation===1?this._absoluteOrthogonalOffset:this._absoluteOffset}get minimumSize(){return this.children.length===0?0:Math.max(...this.children.map((e,t)=>this.splitview.isViewVisible(t)?e.minimumOrthogonalSize:0))}get maximumSize(){return Math.min(...this.children.map((e,t)=>this.splitview.isViewVisible(t)?e.maximumOrthogonalSize:Number.POSITIVE_INFINITY))}get priority(){if(this.children.length===0)return 0;let e=this.children.map(t=>typeof t.priority>"u"?0:t.priority);return e.some(t=>t===2)?2:e.some(t=>t===1)?1:0}get proportionalLayout(){return this.children.length===0?!0:this.children.every(e=>e.proportionalLayout)}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get minimumWidth(){return this.orientation===1?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===1?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===1?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===1?this.maximumSize:this.maximumOrthogonalSize}_onDidChange=new T;onDidChange=this._onDidChange.event;_onDidVisibilityChange=new T;onDidVisibilityChange=this._onDidVisibilityChange.event;childrenVisibilityChangeDisposable=new oe;_onDidScroll=new T;onDidScrollDisposable=B.None;onDidScroll=this._onDidScroll.event;childrenChangeDisposable=B.None;_onDidSashReset=new T;onDidSashReset=this._onDidSashReset.event;splitviewSashResetDisposable=B.None;childrenSashResetDisposable=B.None;_boundarySashes={};get boundarySashes(){return this._boundarySashes}set boundarySashes(e){if(!(this._boundarySashes.start===e.start&&this._boundarySashes.end===e.end&&this._boundarySashes.orthogonalStart===e.orthogonalStart&&this._boundarySashes.orthogonalEnd===e.orthogonalEnd)){this._boundarySashes=e,this.splitview.orthogonalStartSash=e.orthogonalStart,this.splitview.orthogonalEndSash=e.orthogonalEnd;for(let t=0;t<this.children.length;t++){let n=this.children[t],i=t===0,r=t===this.children.length-1;n.boundarySashes={start:e.orthogonalStart,end:e.orthogonalEnd,orthogonalStart:i?e.start:n.boundarySashes.orthogonalStart,orthogonalEnd:r?e.end:n.boundarySashes.orthogonalEnd}}}}_edgeSnapping=!1;get edgeSnapping(){return this._edgeSnapping}set edgeSnapping(e){if(this._edgeSnapping!==e){this._edgeSnapping=e;for(let t of this.children)t instanceof o&&(t.edgeSnapping=e);this.updateSplitviewEdgeSnappingEnablement()}}style(e){this._styles=e,this.splitview.style(e);for(let t of this.children)t instanceof o&&t.style(e)}layout(e,t,n){if(this.layoutController.isLayoutEnabled){if(typeof n>"u")throw new Error("Invalid state");this._size=n.orthogonalSize,this._orthogonalSize=e,this._absoluteOffset=n.absoluteOffset+t,this._absoluteOrthogonalOffset=n.absoluteOrthogonalOffset,this.absoluteOrthogonalSize=n.absoluteOrthogonalSize,this.splitview.layout(n.orthogonalSize,{orthogonalSize:e,absoluteOffset:this._absoluteOrthogonalOffset,absoluteOrthogonalOffset:this._absoluteOffset,absoluteSize:n.absoluteOrthogonalSize,absoluteOrthogonalSize:n.absoluteSize}),this.updateSplitviewEdgeSnappingEnablement()}}setVisible(e){for(let t of this.children)t.setVisible(e)}addChild(e,t,n,i){n=ks(n,this.children.length),this.splitview.addView(e,t,n,i),this.children.splice(n,0,e),this.updateBoundarySashes(),this.onDidChildrenChange()}removeChild(e,t){e=ks(e,this.children.length);let n=this.splitview.removeView(e,t);return this.children.splice(e,1),this.updateBoundarySashes(),this.onDidChildrenChange(),n}removeAllChildren(){let e=this.splitview.removeAllViews();return this.children.splice(0,this.children.length),this.updateBoundarySashes(),this.onDidChildrenChange(),e}moveChild(e,t){e=ks(e,this.children.length),t=ks(t,this.children.length),e!==t&&(e<t&&(t-=1),this.splitview.moveView(e,t),this.children.splice(t,0,this.children.splice(e,1)[0]),this.updateBoundarySashes(),this.onDidChildrenChange())}swapChildren(e,t){e=ks(e,this.children.length),t=ks(t,this.children.length),e!==t&&(this.splitview.swapViews(e,t),[this.children[e].boundarySashes,this.children[t].boundarySashes]=[this.children[e].boundarySashes,this.children[t].boundarySashes],[this.children[e],this.children[t]]=[this.children[t],this.children[e]],this.onDidChildrenChange())}resizeChild(e,t){e=ks(e,this.children.length),this.splitview.resizeView(e,t)}isChildExpanded(e){return this.splitview.isViewExpanded(e)}distributeViewSizes(e=!1){if(this.splitview.distributeViewSizes(),e)for(let t of this.children)t instanceof o&&t.distributeViewSizes(!0)}getChildSize(e){return e=ks(e,this.children.length),this.splitview.getViewSize(e)}isChildVisible(e){return e=ks(e,this.children.length),this.splitview.isViewVisible(e)}setChildVisible(e,t){if(e=ks(e,this.children.length),this.splitview.isViewVisible(e)===t)return;let n=this.splitview.contentSize===0;this.splitview.setViewVisible(e,t);let i=this.splitview.contentSize===0;(t&&n||!t&&i)&&this._onDidVisibilityChange.fire(t)}getChildCachedVisibleSize(e){return e=ks(e,this.children.length),this.splitview.getViewCachedVisibleSize(e)}updateBoundarySashes(){for(let e=0;e<this.children.length;e++)this.children[e].boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:e===0?this.boundarySashes.start:this.splitview.sashes[e-1],orthogonalEnd:e===this.children.length-1?this.boundarySashes.end:this.splitview.sashes[e]}}onDidChildrenChange(){this.updateChildrenEvents(),this._onDidChange.fire(void 0)}updateChildrenEvents(){let e=Y.map(Y.any(...this.children.map(i=>i.onDidChange)),()=>{});this.childrenChangeDisposable.dispose(),this.childrenChangeDisposable=e(this._onDidChange.fire,this._onDidChange);let t=Y.any(...this.children.map((i,r)=>Y.map(i.onDidSashReset,s=>[r,...s])));this.childrenSashResetDisposable.dispose(),this.childrenSashResetDisposable=t(this._onDidSashReset.fire,this._onDidSashReset);let n=Y.any(Y.signal(this.splitview.onDidScroll),...this.children.map(i=>i.onDidScroll));this.onDidScrollDisposable.dispose(),this.onDidScrollDisposable=n(this._onDidScroll.fire,this._onDidScroll),this.childrenVisibilityChangeDisposable.clear(),this.children.forEach((i,r)=>{i instanceof o&&this.childrenVisibilityChangeDisposable.add(i.onDidVisibilityChange(s=>{this.setChildVisible(r,s)}))})}trySet2x2(e){if(this.children.length!==2||e.children.length!==2)return B.None;if(this.getChildSize(0)!==e.getChildSize(0))return B.None;let[t,n]=this.children,[i,r]=e.children;if(!(t instanceof Rn)||!(n instanceof Rn))return B.None;if(!(i instanceof Rn)||!(r instanceof Rn))return B.None;this.orientation===0?(n.linkedWidthNode=i.linkedHeightNode=t,t.linkedWidthNode=r.linkedHeightNode=n,r.linkedWidthNode=t.linkedHeightNode=i,i.linkedWidthNode=n.linkedHeightNode=r):(i.linkedWidthNode=n.linkedHeightNode=t,r.linkedWidthNode=t.linkedHeightNode=n,t.linkedWidthNode=r.linkedHeightNode=i,n.linkedWidthNode=i.linkedHeightNode=r);let s=this.splitview.sashes[0],a=e.splitview.sashes[0];return s.linkedSash=a,a.linkedSash=s,this._onDidChange.fire(void 0),e._onDidChange.fire(void 0),pe(()=>{s.linkedSash=a.linkedSash=void 0,t.linkedHeightNode=t.linkedWidthNode=void 0,n.linkedHeightNode=n.linkedWidthNode=void 0,i.linkedHeightNode=i.linkedWidthNode=void 0,r.linkedHeightNode=r.linkedWidthNode=void 0})}updateSplitviewEdgeSnappingEnablement(){this.splitview.startSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset>0,this.splitview.endSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset+this._size<this.absoluteOrthogonalSize}dispose(){for(let e of this.children)e.dispose();this._onDidChange.dispose(),this._onDidSashReset.dispose(),this._onDidVisibilityChange.dispose(),this.childrenVisibilityChangeDisposable.dispose(),this.splitviewSashResetDisposable.dispose(),this.childrenSashResetDisposable.dispose(),this.childrenChangeDisposable.dispose(),this.onDidScrollDisposable.dispose(),this.splitview.dispose()}};function q7(o){let[e,t]=Y.split(o.onDidChange,an);return Y.any(t,Y.map(Y.latch(Y.map(e,n=>[o.minimumWidth,o.maximumWidth,o.minimumHeight,o.maximumHeight]),Lt),n=>{}))}var Rn=class{constructor(e,t,n,i,r=0){this.view=e;this.orientation=t;this.layoutController=n;this._orthogonalSize=i,this._size=r;let s=q7(e);this._onDidViewChange=Y.map(s,a=>a&&(this.orientation===0?a.width:a.height),this.disposables),this.onDidChange=Y.any(this._onDidViewChange,this._onDidSetLinkedNode.event,this._onDidLinkedWidthNodeChange.event,this._onDidLinkedHeightNodeChange.event)}_size=0;get size(){return this._size}_orthogonalSize;get orthogonalSize(){return this._orthogonalSize}absoluteOffset=0;absoluteOrthogonalOffset=0;onDidScroll=Y.None;onDidSashReset=Y.None;_onDidLinkedWidthNodeChange=new Js;_linkedWidthNode=void 0;get linkedWidthNode(){return this._linkedWidthNode}set linkedWidthNode(e){this._onDidLinkedWidthNodeChange.input=e?e._onDidViewChange:Y.None,this._linkedWidthNode=e,this._onDidSetLinkedNode.fire(void 0)}_onDidLinkedHeightNodeChange=new Js;_linkedHeightNode=void 0;get linkedHeightNode(){return this._linkedHeightNode}set linkedHeightNode(e){this._onDidLinkedHeightNodeChange.input=e?e._onDidViewChange:Y.None,this._linkedHeightNode=e,this._onDidSetLinkedNode.fire(void 0)}_onDidSetLinkedNode=new T;_onDidViewChange;onDidChange;disposables=new oe;get width(){return this.orientation===1?this.orthogonalSize:this.size}get height(){return this.orientation===1?this.size:this.orthogonalSize}get top(){return this.orientation===1?this.absoluteOffset:this.absoluteOrthogonalOffset}get left(){return this.orientation===1?this.absoluteOrthogonalOffset:this.absoluteOffset}get element(){return this.view.element}get minimumWidth(){return this.linkedWidthNode?Math.max(this.linkedWidthNode.view.minimumWidth,this.view.minimumWidth):this.view.minimumWidth}get maximumWidth(){return this.linkedWidthNode?Math.min(this.linkedWidthNode.view.maximumWidth,this.view.maximumWidth):this.view.maximumWidth}get minimumHeight(){return this.linkedHeightNode?Math.max(this.linkedHeightNode.view.minimumHeight,this.view.minimumHeight):this.view.minimumHeight}get maximumHeight(){return this.linkedHeightNode?Math.min(this.linkedHeightNode.view.maximumHeight,this.view.maximumHeight):this.view.maximumHeight}get minimumSize(){return this.orientation===1?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===1?this.maximumHeight:this.maximumWidth}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return this.view.snap}get minimumOrthogonalSize(){return this.orientation===1?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===1?this.maximumWidth:this.maximumHeight}_boundarySashes={};get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.view.setBoundarySashes?.(j7(e,this.orientation))}layout(e,t,n){if(this.layoutController.isLayoutEnabled){if(typeof n>"u")throw new Error("Invalid state");this._size=e,this._orthogonalSize=n.orthogonalSize,this.absoluteOffset=n.absoluteOffset+t,this.absoluteOrthogonalOffset=n.absoluteOrthogonalOffset,this._layout(this.width,this.height,this.top,this.left)}}cachedWidth=0;cachedHeight=0;cachedTop=0;cachedLeft=0;_layout(e,t,n,i){this.cachedWidth===e&&this.cachedHeight===t&&this.cachedTop===n&&this.cachedLeft===i||(this.cachedWidth=e,this.cachedHeight=t,this.cachedTop=n,this.cachedLeft=i,this.view.layout(e,t,n,i))}setVisible(e){this.view.setVisible?.(e)}dispose(){this.disposables.dispose()}};function L2(o,e,t){if(o instanceof Dn){let n=new Dn(Ms(o.orientation),o.layoutController,o.styles,o.splitviewProportionalLayout,e,t,o.edgeSnapping),i=0;for(let r=o.children.length-1;r>=0;r--){let s=o.children[r],a=s instanceof Dn?s.orthogonalSize:s.size,l=o.size===0?0:Math.round(e*a/o.size);i+=l,r===0&&(l+=e-i),n.addChild(L2(s,t,l),l,0,!0)}return o.dispose(),n}else{let n=new Rn(o.view,Ms(o.orientation),o.layoutController,t);return o.dispose(),n}}var au=class o{element;styles;proportionalLayout;_root;onDidSashResetRelay=new Js;_onDidScroll=new Js;_onDidChange=new Js;_boundarySashes={};layoutController;disposable2x2=B.None;get root(){return this._root}set root(e){let t=this._root;t&&(t.element.remove(),t.dispose()),this._root=e,this.element.appendChild(e.element),this.onDidSashResetRelay.input=e.onDidSashReset,this._onDidChange.input=Y.map(e.onDidChange,()=>{}),this._onDidScroll.input=e.onDidScroll}onDidSashReset=this.onDidSashResetRelay.event;onDidScroll=this._onDidScroll.event;onDidChange=this._onDidChange.event;get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get orientation(){return this._root.orientation}get boundarySashes(){return this._boundarySashes}set orientation(e){if(this._root.orientation===e)return;let{size:t,orthogonalSize:n,absoluteOffset:i,absoluteOrthogonalOffset:r}=this._root;this.root=L2(this._root,n,t),this.root.layout(t,0,{orthogonalSize:n,absoluteOffset:r,absoluteOrthogonalOffset:i,absoluteSize:t,absoluteOrthogonalSize:n}),this.boundarySashes=this.boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.root.boundarySashes=$7(e,this.orientation)}set edgeSnapping(e){this.root.edgeSnapping=e}maximizedNode=void 0;_onDidChangeViewMaximized=new T;onDidChangeViewMaximized=this._onDidChangeViewMaximized.event;constructor(e={}){this.element=je(".monaco-grid-view"),this.styles=e.styles||G7,this.proportionalLayout=typeof e.proportionalLayout<"u"?!!e.proportionalLayout:!0,this.layoutController=new I0(!1),this.root=new Dn(0,this.layoutController,this.styles,this.proportionalLayout)}style(e){this.styles=e,this.root.style(e)}layout(e,t,n=0,i=0){this.layoutController.isLayoutEnabled=!0;let[r,s,a,l]=this.root.orientation===1?[t,e,n,i]:[e,t,i,n];this.root.layout(r,0,{orthogonalSize:s,absoluteOffset:a,absoluteOrthogonalOffset:l,absoluteSize:r,absoluteOrthogonalSize:s})}addView(e,t,n){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=B.None;let[i,r]=cn(n),[s,a]=this.getNode(i);if(a instanceof Dn){let l=new Rn(e,Ms(a.orientation),this.layoutController,a.orthogonalSize);try{a.addChild(l,t,r)}catch(d){throw l.dispose(),d}}else{let[,l]=cn(s),[,d]=cn(i),c=0,u=l.getChildCachedVisibleSize(d);typeof u=="number"&&(c=pr.Invisible(u)),l.removeChild(d).dispose();let m=new Dn(a.orientation,a.layoutController,this.styles,this.proportionalLayout,a.size,a.orthogonalSize,l.edgeSnapping);l.addChild(m,a.size,d);let g=new Rn(a.view,l.orientation,this.layoutController,a.size);m.addChild(g,c,0),typeof t!="number"&&t.type==="split"&&(t=pr.Split(0));let f=new Rn(e,l.orientation,this.layoutController,a.size);m.addChild(f,t,r)}this.trySet2x2()}removeView(e,t){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=B.None;let[n,i]=cn(e),[r,s]=this.getNode(n);if(!(s instanceof Dn))throw new Error("Invalid location");let a=s.children[i];if(!(a instanceof Rn))throw new Error("Invalid location");if(s.removeChild(i,t),a.dispose(),s.children.length===0)throw new Error("Invalid grid state");if(s.children.length>1)return this.trySet2x2(),a.view;if(r.length===0){let m=s.children[0];return m instanceof Rn||(s.removeChild(0),s.dispose(),this.root=m,this.boundarySashes=this.boundarySashes,this.trySet2x2()),a.view}let[,l]=cn(r),[,d]=cn(n),c=s.isChildVisible(0),u=s.removeChild(0),h=l.children.map((m,g)=>l.getChildSize(g));if(l.removeChild(d,t),s.dispose(),u instanceof Dn){h.splice(d,1,...u.children.map(g=>g.size));let m=u.removeAllChildren();for(let g=0;g<m.length;g++)l.addChild(m[g],m[g].size,d+g)}else{let m=new Rn(u.view,Ms(u.orientation),this.layoutController,u.size),g=c?u.orthogonalSize:pr.Invisible(u.orthogonalSize);l.addChild(m,g,d)}u.dispose();for(let m=0;m<h.length;m++)l.resizeChild(m,h[m]);return this.trySet2x2(),a.view}moveView(e,t,n){this.hasMaximizedView()&&this.exitMaximizedView();let[,i]=this.getNode(e);if(!(i instanceof Dn))throw new Error("Invalid location");i.moveChild(t,n),this.trySet2x2()}swapViews(e,t){this.hasMaximizedView()&&this.exitMaximizedView();let[n,i]=cn(e),[,r]=this.getNode(n);if(!(r instanceof Dn))throw new Error("Invalid from location");let s=r.getChildSize(i),a=r.children[i];if(!(a instanceof Rn))throw new Error("Invalid from location");let[l,d]=cn(t),[,c]=this.getNode(l);if(!(c instanceof Dn))throw new Error("Invalid to location");let u=c.getChildSize(d),h=c.children[d];if(!(h instanceof Rn))throw new Error("Invalid to location");r===c?r.swapChildren(i,d):(r.removeChild(i),c.removeChild(d),r.addChild(h,s,i),c.addChild(a,u,d)),this.trySet2x2()}resizeView(e,t){this.hasMaximizedView()&&this.exitMaximizedView();let[n,i]=cn(e),[r,s]=this.getNode(n);if(!(s instanceof Dn))throw new Error("Invalid location");if(!t.width&&!t.height)return;let[a,l]=s.orientation===1?[t.width,t.height]:[t.height,t.width];if(typeof l=="number"&&r.length>0){let[,d]=cn(r),[,c]=cn(n);d.resizeChild(c,l)}typeof a=="number"&&s.resizeChild(i,a),this.trySet2x2()}getViewSize(e){if(!e)return{width:this.root.width,height:this.root.height};let[,t]=this.getNode(e);return{width:t.width,height:t.height}}getViewCachedVisibleSize(e){let[t,n]=cn(e),[,i]=this.getNode(t);if(!(i instanceof Dn))throw new Error("Invalid location");return i.getChildCachedVisibleSize(n)}expandView(e){this.hasMaximizedView()&&this.exitMaximizedView();let[t,n]=this.getNode(e);if(!(n instanceof Rn))throw new Error("Invalid location");for(let i=0;i<t.length;i++)t[i].resizeChild(e[i],Number.POSITIVE_INFINITY)}isViewExpanded(e){if(this.hasMaximizedView())return!1;let[t,n]=this.getNode(e);if(!(n instanceof Rn))throw new Error("Invalid location");for(let i=0;i<t.length;i++)if(!t[i].isChildExpanded(e[i]))return!1;return!0}maximizeView(e){let[,t]=this.getNode(e);if(!(t instanceof Rn))throw new Error("Location is not a LeafNode");if(this.maximizedNode===t)return;this.hasMaximizedView()&&this.exitMaximizedView();function n(i,r){for(let s=0;s<i.children.length;s++){let a=i.children[s];a instanceof Rn?a!==r&&i.setChildVisible(s,!1):n(a,r)}}n(this.root,t),this.maximizedNode=t,this._onDidChangeViewMaximized.fire(!0)}exitMaximizedView(){if(!this.maximizedNode)return;this.maximizedNode=void 0;function e(t){for(let n=t.children.length-1;n>=0;n--){let i=t.children[n];i instanceof Rn?t.setChildVisible(n,!0):e(i)}}e(this.root),this._onDidChangeViewMaximized.fire(!1)}hasMaximizedView(){return this.maximizedNode!==void 0}isViewMaximized(e){let[,t]=this.getNode(e);if(!(t instanceof Rn))throw new Error("Location is not a LeafNode");return t===this.maximizedNode}distributeViewSizes(e){if(this.hasMaximizedView()&&this.exitMaximizedView(),!e){this.root.distributeViewSizes(!0);return}let[,t]=this.getNode(e);if(!(t instanceof Dn))throw new Error("Invalid location");t.distributeViewSizes(),this.trySet2x2()}isViewVisible(e){let[t,n]=cn(e),[,i]=this.getNode(t);if(!(i instanceof Dn))throw new Error("Invalid from location");return i.isChildVisible(n)}setViewVisible(e,t){if(this.hasMaximizedView()){this.exitMaximizedView();return}let[n,i]=cn(e),[,r]=this.getNode(n);if(!(r instanceof Dn))throw new Error("Invalid from location");r.setChildVisible(i,t)}getView(e){let t=e?this.getNode(e)[1]:this._root;return this._getViews(t,this.orientation)}static deserialize(e,t,n={}){if(typeof e.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof e.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof e.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");if(e.root?.type!=="branch")throw new Error("Invalid JSON: 'root' property must have 'type' value of branch.");let i=e.orientation,r=e.height,s=new o(n);return s._deserialize(e.root,i,t,r),s}_deserialize(e,t,n,i){this.root=this._deserializeNode(e,t,n,i)}_deserializeNode(e,t,n,i){let r;if(e.type==="branch"){let a=e.data.map(l=>({node:this._deserializeNode(l,Ms(t),n,e.size),visible:l.visible}));r=new Dn(t,this.layoutController,this.styles,this.proportionalLayout,e.size,i,void 0,a)}else r=new Rn(n.fromJSON(e.data),t,this.layoutController,i,e.size),e.maximized&&!this.maximizedNode&&(this.maximizedNode=r,this._onDidChangeViewMaximized.fire(!0));return r}_getViews(e,t,n){let i={top:e.top,left:e.left,width:e.width,height:e.height};if(e instanceof Rn)return{view:e.view,box:i,cachedVisibleSize:n,maximized:this.maximizedNode===e};let r=[];for(let s=0;s<e.children.length;s++){let a=e.children[s],l=e.getChildCachedVisibleSize(s);r.push(this._getViews(a,Ms(t),l))}return{children:r,box:i}}getNode(e,t=this.root,n=[]){if(e.length===0)return[n,t];if(!(t instanceof Dn))throw new Error("Invalid location");let[i,...r]=e;if(i<0||i>=t.children.length)throw new Error("Invalid location");let s=t.children[i];return n.push(t),this.getNode(r,s,n)}trySet2x2(){if(this.disposable2x2.dispose(),this.disposable2x2=B.None,this.root.children.length!==2)return;let[e,t]=this.root.children;!(e instanceof Dn)||!(t instanceof Dn)||(this.disposable2x2=e.trySet2x2(t))}getViewMap(e,t){t||(t=this.root),t instanceof Dn?t.children.forEach(n=>this.getViewMap(e,n)):e.set(t.view,t.element)}dispose(){this.onDidSashResetRelay.dispose(),this.root.dispose(),this.element.remove()}};function Y7(o){switch(o){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}}function yS(o){return!!o.children}function R2(o,e){if(e.length===0)return o;if(!yS(o))throw new Error("Invalid location");let[t,...n]=e;return R2(o.children[t],n)}function Z7(o,e){return!(o.start>=e.end||e.start>=o.end)}function k2(o,e){let t=x0(e),n=e===0?o.top:e===3?o.left+o.width:e===1?o.top+o.height:o.left,i={start:t===1?o.top:o.left,end:t===1?o.top+o.height:o.left+o.width};return{offset:n,range:i}}function X7(o,e,t){let n=[];function i(r,s,a){if(yS(r))for(let l of r.children)i(l,s,a);else{let{offset:l,range:d}=k2(r.box,s);l===a.offset&&Z7(d,a.range)&&n.push(r)}}return i(o,e,t),n}function C0(o,e){return e.length%2===0?Ms(o):o}function x0(o){return o===0||o===1?0:1}function D2(o,e,t){let n=C0(o,e),i=x0(t);if(n===i){let[r,s]=cn(e);return(t===3||t===1)&&(s+=1),[...r,s]}else{let r=t===3||t===1?1:0;return[...e,r]}}function Q7(o){let e=o.parentElement;if(!e)throw new Error("Invalid grid element");let t=e.firstElementChild,n=0;for(;t!==o&&t!==e.lastElementChild&&t;)t=t.nextElementSibling,n++;return n}function M2(o){let e=o.parentElement;if(!e)throw new Error("Invalid grid element");if(/\bmonaco-grid-view\b/.test(e.className))return[];let t=Q7(e),n=e.parentElement.parentElement.parentElement.parentElement;return[...M2(n),t]}var N2;(i=>{i.Distribute={type:"distribute"},i.Split={type:"split"},i.Auto={type:"auto"};function n(r){return{type:"invisible",cachedVisibleSize:r}}i.Invisible=n})(N2||={});var S0=class extends B{gridview;views=new Map;get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumWidth(){return this.gridview.minimumWidth}get minimumHeight(){return this.gridview.minimumHeight}get maximumWidth(){return this.gridview.maximumWidth}get maximumHeight(){return this.gridview.maximumHeight}onDidChange;onDidScroll;get boundarySashes(){return this.gridview.boundarySashes}set boundarySashes(e){this.gridview.boundarySashes=e}set edgeSnapping(e){this.gridview.edgeSnapping=e}get element(){return this.gridview.element}didLayout=!1;onDidChangeViewMaximized;constructor(e,t={}){super(),e instanceof au?(this.gridview=e,this.gridview.getViewMap(this.views)):this.gridview=new au(t),this._register(this.gridview),this._register(this.gridview.onDidSashReset(this.onDidSashReset,this)),e instanceof au||this._addView(e,0,[0]),this.onDidChange=this.gridview.onDidChange,this.onDidScroll=this.gridview.onDidScroll,this.onDidChangeViewMaximized=this.gridview.onDidChangeViewMaximized}style(e){this.gridview.style(e)}layout(e,t,n=0,i=0){this.gridview.layout(e,t,n,i),this.didLayout=!0}addView(e,t,n,i){if(this.views.has(e))throw new Error("Can't add same view twice");let r=x0(i);this.views.size===1&&this.orientation!==r&&(this.orientation=r);let s=this.getViewLocation(n),a=D2(this.gridview.orientation,s,i),l;if(typeof t=="number")l=t;else if(t.type==="split"){let[,d]=cn(s);l=pr.Split(d)}else if(t.type==="distribute")l=pr.Distribute;else if(t.type==="auto"){let[,d]=cn(s);l=pr.Auto(d)}else l=t;this._addView(e,l,a)}addViewAt(e,t,n){if(this.views.has(e))throw new Error("Can't add same view twice");let i;typeof t=="number"?i=t:t.type==="distribute"?i=pr.Distribute:i=t,this._addView(e,i,n)}_addView(e,t,n){this.views.set(e,e.element),this.gridview.addView(e,t,n)}removeView(e,t){if(this.views.size===1)throw new Error("Can't remove last view");let n=this.getViewLocation(e),i;if(t?.type==="distribute")i=pr.Distribute;else if(t?.type==="auto"){let r=n[n.length-1];i=pr.Auto(r===0?1:r-1)}this.gridview.removeView(n,i),this.views.delete(e)}moveView(e,t,n,i){let r=this.getViewLocation(e),[s,a]=cn(r),l=this.getViewLocation(n),d=D2(this.gridview.orientation,l,i),[c,u]=cn(d);Lt(s,c)?this.gridview.moveView(s,a,u):(this.removeView(e,typeof t=="number"?void 0:t),this.addView(e,t,n,i))}moveViewTo(e,t){let n=this.getViewLocation(e),[i,r]=cn(n),[s,a]=cn(t);if(Lt(i,s))this.gridview.moveView(i,r,a);else{let l=this.getViewSize(e),d=C0(this.gridview.orientation,n),c=this.getViewCachedVisibleSize(e),u=typeof c>"u"?d===1?l.width:l.height:N2.Invisible(c);this.removeView(e),this.addViewAt(e,u,t)}}swapViews(e,t){let n=this.getViewLocation(e),i=this.getViewLocation(t);return this.gridview.swapViews(n,i)}resizeView(e,t){let n=this.getViewLocation(e);return this.gridview.resizeView(n,t)}isViewExpanded(e){let t=this.getViewLocation(e);return this.gridview.isViewExpanded(t)}isViewMaximized(e){let t=this.getViewLocation(e);return this.gridview.isViewMaximized(t)}hasMaximizedView(){return this.gridview.hasMaximizedView()}getViewSize(e){if(!e)return this.gridview.getViewSize();let t=this.getViewLocation(e);return this.gridview.getViewSize(t)}getViewCachedVisibleSize(e){let t=this.getViewLocation(e);return this.gridview.getViewCachedVisibleSize(t)}maximizeView(e){if(this.views.size<2)throw new Error("At least two views are required to maximize a view");let t=this.getViewLocation(e);this.gridview.maximizeView(t)}exitMaximizedView(){this.gridview.exitMaximizedView()}expandView(e){let t=this.getViewLocation(e);this.gridview.expandView(t)}distributeViewSizes(){this.gridview.distributeViewSizes()}isViewVisible(e){let t=this.getViewLocation(e);return this.gridview.isViewVisible(t)}setViewVisible(e,t){let n=this.getViewLocation(e);this.gridview.setViewVisible(n,t)}getViews(){return this.gridview.getView()}getNeighborViews(e,t,n=!1){if(!this.didLayout)throw new Error("Can't call getNeighborViews before first layout");let i=this.getViewLocation(e),r=this.getViews(),s=R2(r,i),a=k2(s.box,t);return n&&(t===0&&s.box.top===0?a={offset:r.box.top+r.box.height,range:a.range}:t===3&&s.box.left+s.box.width===r.box.width?a={offset:0,range:a.range}:t===1&&s.box.top+s.box.height===r.box.height?a={offset:0,range:a.range}:t===2&&s.box.left===0&&(a={offset:r.box.left+r.box.width,range:a.range})),X7(r,Y7(t),a).map(l=>l.view)}getViewLocation(e){let t=this.views.get(e);if(!t)throw new Error("View not found");return M2(t)}onDidSashReset(e){let t=r=>{let s=this.gridview.getView(r);if(yS(s))return!1;let a=C0(this.orientation,r),l=a===1?s.view.preferredWidth:s.view.preferredHeight;if(typeof l!="number")return!1;let d=a===1?{width:Math.round(l)}:{height:Math.round(l)};return this.gridview.resizeView(r,d),!0};if(t(e))return;let[n,i]=cn(e);t([...n,i+1])||this.gridview.distributeViewSizes(n)}},vS=class o extends S0{static serializeNode(e,t){let n=t===0?e.box.width:e.box.height;if(!yS(e)){let r={type:"leaf",data:e.view.toJSON(),size:n};return typeof e.cachedVisibleSize=="number"?(r.size=e.cachedVisibleSize,r.visible=!1):e.maximized&&(r.maximized=!0),r}let i=e.children.map(r=>o.serializeNode(r,Ms(t)));return i.some(r=>r.visible!==!1)?{type:"branch",data:i,size:n}:{type:"branch",data:i,size:n,visible:!1}}static deserialize(e,t,n={}){if(typeof e.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof e.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof e.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");let i=au.deserialize(e,t,n);return new o(i,n)}static from(e,t={}){return o.deserialize(J7(e),{fromJSON:n=>n},t)}initialLayoutContext=!0;serialize(){return{root:o.serializeNode(this.getViews(),this.orientation),orientation:this.orientation,width:this.width,height:this.height}}layout(e,t,n=0,i=0){super.layout(e,t,n,i),this.initialLayoutContext&&(this.initialLayoutContext=!1,this.gridview.trySet2x2())}};function A2(o){return!!o.groups}function O2(o,e){if(!e&&o.groups&&o.groups.length<=1&&(o.groups=void 0),!A2(o))return;let t=0,n=0;for(let a of o.groups)O2(a,!1),a.size&&(t+=a.size,n++);let i=n>0?t:1,r=o.groups.length-n,s=i/r;for(let a of o.groups)a.size||(a.size=s)}function P2(o){return A2(o)?{type:"branch",data:o.groups.map(e=>P2(e)),size:o.size}:{type:"leaf",data:o.data,size:o.size}}function F2(o,e){if(o.type==="branch"){let t=o.data.map(n=>F2(n,Ms(e)));if(e===0){let n=o.size||(t.length===0?void 0:Math.max(...t.map(r=>r.width||0))),i=t.length===0?void 0:t.reduce((r,s)=>r+(s.height||0),0);return{width:n,height:i}}else{let n=t.length===0?void 0:t.reduce((r,s)=>r+(s.width||0),0),i=o.size||(t.length===0?void 0:Math.max(...t.map(r=>r.height||0)));return{width:n,height:i}}}else{let t=e===0?o.size:void 0,n=e===0?void 0:o.size;return{width:t,height:n}}}function J7(o){O2(o,!0);let e=P2(o),{width:t,height:n}=F2(e,o.orientation);return{root:e,orientation:o.orientation,width:t||1,height:n||1}}async function B2(o){let e=navigator.usb;if(!e)return;let t=await e.requestDevice({filters:o?.filters??[]});if(t)return{deviceClass:t.deviceClass,deviceProtocol:t.deviceProtocol,deviceSubclass:t.deviceSubclass,deviceVersionMajor:t.deviceVersionMajor,deviceVersionMinor:t.deviceVersionMinor,deviceVersionSubminor:t.deviceVersionSubminor,manufacturerName:t.manufacturerName,productId:t.productId,productName:t.productName,serialNumber:t.serialNumber,usbVersionMajor:t.usbVersionMajor,usbVersionMinor:t.usbVersionMinor,usbVersionSubminor:t.usbVersionSubminor,vendorId:t.vendorId}}async function V2(o){let e=navigator.serial;if(!e)return;let t=await e.requestPort({filters:o?.filters??[]});if(!t)return;let n=t.getInfo();return{usbVendorId:n.usbVendorId,usbProductId:n.usbProductId}}async function W2(o){let e=navigator.hid;if(!e)return;let t=await e.requestDevice({filters:o?.filters??[]});if(!t.length)return;let n=t[0];return{opened:n.opened,vendorId:n.vendorId,productId:n.productId,productName:n.productName,collections:n.collections}}var IS=Z("openerService");var bb=Ro;var e9=60,t9=e9*60,E0=t9*24,m8e=E0*7,g8e=E0*30,f8e=E0*365;function H2(o){return o.getFullYear()+"-"+String(o.getMonth()+1).padStart(2,"0")+"-"+String(o.getDate()).padStart(2,"0")+"T"+String(o.getHours()).padStart(2,"0")+":"+String(o.getMinutes()).padStart(2,"0")+":"+String(o.getSeconds()).padStart(2,"0")+"."+(o.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var vb=/^([^.]+\..+)[:=](.+)$/,Ft=class{constructor(e,t,n){this._args=e;this.paths=t;this.productService=n}get appRoot(){return eh(ud.asFileUri("").fsPath)}get userHome(){return ne.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return ne.file(Cr(this.userDataPath,"User"))}get tmpDir(){return ne.file(this.paths.tmpDir)}get cacheHome(){return ne.file(this.userDataPath)}get stateResource(){return mt(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:Ae.vscodeUserData})}get userDataSyncHome(){return mt(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let e=H2(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=Cr(this.userDataPath,"logs",e)}return ne.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return mt(ne.file(Cr(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return mt(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return mt(this.appSettingsHome,"History")}get keyboardLayoutResource(){return mt(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let e=Xl.VSCODE_PORTABLE;return e?ne.file(Cr(e,"argv.json")):mt(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return ne.file(Cr(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let e=this.args["builtin-extensions-dir"];return e?Ju(e):td(Cr(ud.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let e=this.args["extensions-download-dir"];return e?ne.file(Ju(e)):ne.file(Cr(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let e=this.args["extensions-dir"];if(e)return Ju(e);let t=Xl.VSCODE_EXTENSIONS;if(t)return t;let n=Xl.VSCODE_PORTABLE;return n?Cr(n,"extensions"):mt(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let e=this.args.extensionDevelopmentPath;if(Array.isArray(e))return e.map(t=>/^[^:/?#]+?:\/\//.test(t)?ne.parse(t):ne.file(td(t)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(e=>e==="ui"||e==="workspace"||e==="web"?e:"workspace")}get extensionTestsLocationURI(){let e=this.args.extensionTestsPath;if(e)return/^[^:/?#]+?:\/\//.test(e)?ne.parse(e):ne.file(td(e))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let e=this.args["disable-extension"];if(e){if(typeof e=="string")return[e];if(Array.isArray(e)&&e.length>0)return e}return!1}get debugExtensionHost(){return n9(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!Xl.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(e=>!vb.test(e))}get extensionLogLevel(){let e=[];for(let t of this.args.log||[]){let n=vb.exec(t);n&&n[1]&&n[2]&&e.push([n[1],n[2]])}return e.length?e:void 0}get serviceMachineIdResource(){return mt(ne.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let e=Xl.VSCODE_PORTABLE;return e?ne.file(Cr(e,"policy.json")):mt(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(e){this.args.continueOn=e}get args(){return this._args}};k([he],Ft.prototype,"appRoot",1),k([he],Ft.prototype,"userHome",1),k([he],Ft.prototype,"userDataPath",1),k([he],Ft.prototype,"appSettingsHome",1),k([he],Ft.prototype,"tmpDir",1),k([he],Ft.prototype,"cacheHome",1),k([he],Ft.prototype,"stateResource",1),k([he],Ft.prototype,"userRoamingDataHome",1),k([he],Ft.prototype,"userDataSyncHome",1),k([he],Ft.prototype,"sync",1),k([he],Ft.prototype,"machineSettingsResource",1),k([he],Ft.prototype,"workspaceStorageHome",1),k([he],Ft.prototype,"localHistoryHome",1),k([he],Ft.prototype,"keyboardLayoutResource",1),k([he],Ft.prototype,"argvResource",1),k([he],Ft.prototype,"isExtensionDevelopment",1),k([he],Ft.prototype,"untitledWorkspacesHome",1),k([he],Ft.prototype,"builtinExtensionsPath",1),k([he],Ft.prototype,"extensionsPath",1),k([he],Ft.prototype,"extensionDevelopmentLocationURI",1),k([he],Ft.prototype,"extensionDevelopmentKind",1),k([he],Ft.prototype,"extensionTestsLocationURI",1),k([he],Ft.prototype,"debugExtensionHost",1),k([he],Ft.prototype,"logLevel",1),k([he],Ft.prototype,"extensionLogLevel",1),k([he],Ft.prototype,"serviceMachineIdResource",1),k([he],Ft.prototype,"disableTelemetry",1),k([he],Ft.prototype,"disableWorkspaceTrust",1),k([he],Ft.prototype,"useInMemorySecretStorage",1),k([he],Ft.prototype,"policyFile",1);function n9(o,e){return i9(o["inspect-extensions"],o["inspect-brk-extensions"],5870,e,o.debugId,o.extensionEnvironment)}function i9(o,e,t,n,i,r){let a=Number(e||o)||(n?null:t),l=a?!!e:!1,d;if(r)try{d=JSON.parse(r)}catch{}return{port:a,break:l,debugId:i,env:d}}var U2=Ro,at=class{constructor(e,t,n,i){this.workspaceId=e;this.logsHome=t;this.options=n;this.productService=i;if(n.workspaceProvider&&Array.isArray(n.workspaceProvider.payload))try{this.payload=new Map(n.workspaceProvider.payload)}catch(r){Ne(r)}}get remoteAuthority(){return this.options.remoteAuthority}get expectsResolverExtension(){return!!this.options.remoteAuthority?.includes("+")&&!this.options.webSocketFactory}get isBuilt(){return!!this.productService.commit}get logLevel(){let e=this.payload?.get("logLevel");return e?e.split(",").find(t=>!vb.test(t)):this.options.developmentOptions?.logLevel!==void 0?CC(this.options.developmentOptions?.logLevel):void 0}get extensionLogLevel(){let e=this.payload?.get("logLevel");if(e){let t=[];for(let n of e.split(",")){let i=vb.exec(n);i&&i[1]&&i[2]&&t.push([i[1],i[2]])}return t.length?t:void 0}return this.options.developmentOptions?.extensionLogLevel!==void 0?this.options.developmentOptions?.extensionLogLevel.map(([t,n])=>[t,CC(n)]):void 0}get profDurationMarkers(){let e=this.payload?.get("profDurationMarkers");if(e){let t=[];for(let n of e.split(","))t.push(n);return t.length===2?t:void 0}}get windowLogsPath(){return this.logsHome}get logFile(){return mt(this.windowLogsPath,"window.log")}get userRoamingDataHome(){return ne.file("/User").with({scheme:Ae.vscodeUserData})}get argvResource(){return mt(this.userRoamingDataHome,"argv.json")}get cacheHome(){return mt(this.userRoamingDataHome,"caches")}get workspaceStorageHome(){return mt(this.userRoamingDataHome,"workspaceStorage")}get localHistoryHome(){return mt(this.userRoamingDataHome,"History")}get stateResource(){return mt(this.userRoamingDataHome,"State","storage.json")}get userDataSyncHome(){return mt(this.userRoamingDataHome,"sync",this.workspaceId)}get sync(){}get keyboardLayoutResource(){return mt(this.userRoamingDataHome,"keyboardLayout.json")}get untitledWorkspacesHome(){return mt(this.userRoamingDataHome,"Workspaces")}get serviceMachineIdResource(){return mt(this.userRoamingDataHome,"machineid")}get extHostLogsPath(){return mt(this.logsHome,"exthost")}get extHostTelemetryLogFile(){return mt(this.extHostLogsPath,"extensionTelemetry.log")}extensionHostDebugEnvironment=void 0;get debugExtensionHost(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.params}get isExtensionDevelopment(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.isExtensionDevelopment}get extensionDevelopmentLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentLocationURI}get extensionDevelopmentLocationKind(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentKind}get extensionTestsLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionTestsLocationURI}get extensionEnabledProposedApi(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionEnabledProposedApi}get debugRenderer(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.debugRenderer}get enableSmokeTestDriver(){return this.options.developmentOptions?.enableSmokeTestDriver}get disableExtensions(){return this.payload?.get("disableExtensions")==="true"}get enableExtensions(){return this.options.enabledExtensions}get webviewExternalEndpoint(){let e=this.options.webviewEndpoint||this.productService.webviewContentExternalBaseUrlTemplate||"https://{{uuid}}.vscode-cdn.net/{{quality}}/{{commit}}/out/vs/workbench/contrib/webview/browser/pre/",t=this.payload?.get("webviewExternalEndpointCommit");return e.replace("{{commit}}",t??this.productService.commit??"ef65ac1ba57f57f2a3961bfe94aa20481caca4c6").replace("{{quality}}",(t?"insider":this.productService.quality)??"insider")}get extensionTelemetryLogResource(){return mt(this.logsHome,"extensionTelemetry.log")}get disableTelemetry(){return!1}get verbose(){return this.payload?.get("verbose")==="true"}get logExtensionHostCommunication(){return this.payload?.get("logExtensionHostCommunication")==="true"}get skipReleaseNotes(){return this.payload?.get("skipReleaseNotes")==="true"}get skipWelcome(){return this.payload?.get("skipWelcome")==="true"}get disableWorkspaceTrust(){return!this.options.enableWorkspaceTrust}get profile(){return this.payload?.get("profile")}editSessionId=this.options.editSessionId;payload;resolveExtensionHostDebugEnvironment(){let e={params:{port:null,break:!1},debugRenderer:!1,isExtensionDevelopment:!1,extensionDevelopmentLocationURI:void 0,extensionDevelopmentKind:void 0};if(this.payload)for(let[n,i]of this.payload)switch(n){case"extensionDevelopmentPath":e.extensionDevelopmentLocationURI||(e.extensionDevelopmentLocationURI=[]),e.extensionDevelopmentLocationURI.push(ne.parse(i)),e.isExtensionDevelopment=!0;break;case"extensionDevelopmentKind":e.extensionDevelopmentKind=[i];break;case"extensionTestsPath":e.extensionTestsLocationURI=ne.parse(i);break;case"debugRenderer":e.debugRenderer=i==="true";break;case"debugId":e.params.debugId=i;break;case"inspect-brk-extensions":e.params.port=parseInt(i),e.params.break=!0;break;case"inspect-extensions":e.params.port=parseInt(i);break;case"enableProposedApi":e.extensionEnabledProposedApi=[];break}let t=this.options.developmentOptions;return t&&!e.isExtensionDevelopment&&(t.extensions?.length&&(e.extensionDevelopmentLocationURI=t.extensions.map(n=>ne.revive(n)),e.isExtensionDevelopment=!0),t.extensionTestsPath&&(e.extensionTestsLocationURI=ne.revive(t.extensionTestsPath))),e}get filesToOpenOrCreate(){if(this.payload){let e=this.payload.get("openFile");if(e){let t=ne.parse(e);if(this.payload.has("gotoLineMode")){let n=qN(t.path);return[{fileUri:t.with({path:n.path}),options:{selection:an(n.line)?void 0:{startLineNumber:n.line,startColumn:n.column||1}}}]}return[{fileUri:t}]}}}get filesToDiff(){if(this.payload){let e=this.payload.get("diffFilePrimary"),t=this.payload.get("diffFileSecondary");if(e&&t)return[{fileUri:ne.parse(t)},{fileUri:ne.parse(e)}]}}get filesToMerge(){if(this.payload){let e=this.payload.get("mergeFile1"),t=this.payload.get("mergeFile2"),n=this.payload.get("mergeFileBase"),i=this.payload.get("mergeFileResult");if(e&&t&&n&&i)return[{fileUri:ne.parse(e)},{fileUri:ne.parse(t)},{fileUri:ne.parse(n)},{fileUri:ne.parse(i)}]}}};k([he],at.prototype,"remoteAuthority",1),k([he],at.prototype,"expectsResolverExtension",1),k([he],at.prototype,"isBuilt",1),k([he],at.prototype,"logLevel",1),k([he],at.prototype,"windowLogsPath",1),k([he],at.prototype,"logFile",1),k([he],at.prototype,"userRoamingDataHome",1),k([he],at.prototype,"argvResource",1),k([he],at.prototype,"cacheHome",1),k([he],at.prototype,"workspaceStorageHome",1),k([he],at.prototype,"localHistoryHome",1),k([he],at.prototype,"stateResource",1),k([he],at.prototype,"userDataSyncHome",1),k([he],at.prototype,"sync",1),k([he],at.prototype,"keyboardLayoutResource",1),k([he],at.prototype,"untitledWorkspacesHome",1),k([he],at.prototype,"serviceMachineIdResource",1),k([he],at.prototype,"extHostLogsPath",1),k([he],at.prototype,"extHostTelemetryLogFile",1),k([he],at.prototype,"debugExtensionHost",1),k([he],at.prototype,"isExtensionDevelopment",1),k([he],at.prototype,"extensionDevelopmentLocationURI",1),k([he],at.prototype,"extensionDevelopmentLocationKind",1),k([he],at.prototype,"extensionTestsLocationURI",1),k([he],at.prototype,"extensionEnabledProposedApi",1),k([he],at.prototype,"debugRenderer",1),k([he],at.prototype,"enableSmokeTestDriver",1),k([he],at.prototype,"disableExtensions",1),k([he],at.prototype,"enableExtensions",1),k([he],at.prototype,"webviewExternalEndpoint",1),k([he],at.prototype,"extensionTelemetryLogResource",1),k([he],at.prototype,"disableTelemetry",1),k([he],at.prototype,"verbose",1),k([he],at.prototype,"logExtensionHostCommunication",1),k([he],at.prototype,"skipReleaseNotes",1),k([he],at.prototype,"skipWelcome",1),k([he],at.prototype,"disableWorkspaceTrust",1),k([he],at.prototype,"profile",1),k([he],at.prototype,"filesToOpenOrCreate",1),k([he],at.prototype,"filesToDiff",1),k([he],at.prototype,"filesToMerge",1);var z2=Z("layoutService");var SS=z2;function CS(o){switch(o){case 0:return"left";case 1:return"right";case 2:return"bottom";case 3:return"top";default:return"bottom"}}var a6e={[CS(0)]:0,[CS(1)]:1,[CS(2)]:2,[CS(3)]:3};function w0(o){switch(o){case 0:return"always";case 1:return"never";case 2:return"preserve";default:return"preserve"}}var l6e={[w0(0)]:0,[w0(1)]:1,[w0(2)]:2};var jd=Z("lifecycleService");function K2(o){switch(o){case 1:return"Starting";case 2:return"Ready";case 3:return"Restored";case 4:return"Eventually"}}var Oa=class extends B{constructor(t,n){super();this.logService=t;this.storageService=n;this._startupKind=this.resolveStartupKind(),this._register(this.storageService.onWillSaveState(i=>{i.reason===1&&this.storageService.store(Oa.LAST_SHUTDOWN_REASON_KEY,this.shutdownReason,1,1)}))}static LAST_SHUTDOWN_REASON_KEY="lifecyle.lastShutdownReason";_onBeforeShutdown=this._register(new T);onBeforeShutdown=this._onBeforeShutdown.event;_onWillShutdown=this._register(new T);onWillShutdown=this._onWillShutdown.event;_onDidShutdown=this._register(new T);onDidShutdown=this._onDidShutdown.event;_onBeforeShutdownError=this._register(new T);onBeforeShutdownError=this._onBeforeShutdownError.event;_onShutdownVeto=this._register(new T);onShutdownVeto=this._onShutdownVeto.event;_startupKind;get startupKind(){return this._startupKind}_phase=1;get phase(){return this._phase}phaseWhen=new Map;shutdownReason;resolveStartupKind(){let t=this.doResolveStartupKind()??1;return this.logService.trace(`[lifecycle] starting up (startup kind: ${t})`),t}doResolveStartupKind(){let t=this.storageService.getNumber(Oa.LAST_SHUTDOWN_REASON_KEY,1);this.storageService.remove(Oa.LAST_SHUTDOWN_REASON_KEY,1);let n;switch(t){case 3:n=3;break;case 4:n=4;break}return n}set phase(t){if(t<this.phase)throw new Error("Lifecycle cannot go backwards");if(this._phase===t)return;this.logService.trace(`lifecycle: phase changed (value: ${t})`),this._phase=t,Zn(`code/LifecyclePhase/${K2(t)}`);let n=this.phaseWhen.get(this._phase);n&&(n.open(),this.phaseWhen.delete(this._phase))}async when(t){if(t<=this._phase)return;let n=this.phaseWhen.get(t);n||(n=new Rh,this.phaseWhen.set(t,n)),await n.wait()}};Oa=k([E(0,Fn),E(1,In)],Oa);var yb=class extends Oa{beforeUnloadListener=void 0;unloadListener=void 0;ignoreBeforeUnload=!1;didUnload=!1;constructor(e,t){super(e,t),this.registerListeners()}registerListeners(){this.beforeUnloadListener=z(_e,me.BEFORE_UNLOAD,e=>this.onBeforeUnload(e)),this.unloadListener=z(_e,me.PAGE_HIDE,()=>this.onUnload())}onBeforeUnload(e){this.ignoreBeforeUnload?(this.logService.info("[lifecycle] onBeforeUnload triggered but ignored once"),this.ignoreBeforeUnload=!1):(this.logService.info("[lifecycle] onBeforeUnload triggered and handled with veto support"),this.doShutdown(()=>this.vetoBeforeUnload(e)))}vetoBeforeUnload(e){e.preventDefault(),e.returnValue=p("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}withExpectedShutdown(e,t){if(typeof e=="number")return this.shutdownReason=e,this.storageService.flush(1);this.ignoreBeforeUnload=!0;try{t?.()}finally{this.ignoreBeforeUnload=!1}}async shutdown(){this.logService.info("[lifecycle] shutdown triggered"),this.beforeUnloadListener?.dispose(),this.unloadListener?.dispose(),await this.storageService.flush(1),this.doShutdown()}doShutdown(e){let t=this.logService;this.storageService.flush(1);let n=!1;function i(r,s){typeof e=="function"&&(r instanceof Promise&&(t.error(`[lifecycle] Long running operations before shutdown are unsupported in the web (id: ${s})`),n=!0),r===!0&&(t.info(`[lifecycle]: Unload was prevented (id: ${s})`),n=!0))}return this._onBeforeShutdown.fire({reason:2,veto(r,s){i(r,s)},finalVeto(r,s){i(r(),s)}}),n&&typeof e=="function"?e():this.onUnload()}onUnload(){if(this.didUnload)return;this.didUnload=!0,this._register(z(_e,me.PAGE_SHOW,t=>this.onLoadAfterUnload(t)));let e=this.logService;this._onWillShutdown.fire({reason:2,joiners:()=>[],token:Xt.None,join(t,n){e.error(`[lifecycle] Long running operations during shutdown are unsupported in the web (id: ${n.id})`)},force:()=>{}}),this._onDidShutdown.fire()}onLoadAfterUnload(e){e.persisted&&this.withExpectedShutdown({disableShutdownHandling:!0},()=>_e.location.reload())}doResolveStartupKind(){let e=super.doResolveStartupKind();return typeof e!="number"&&performance.getEntriesByType("navigation").at(0)?.type==="reload"&&(e=3),e}};yb=k([E(0,Fn),E(1,In)],yb);Pn(jd,yb,0);var Tp=Z("hostService");var r9=p("open","open"),s9=p("close","close"),a9=p("find","find"),xS={open:r9,close:s9,find:a9};async function $2(o,e){let t=[];return await q2(o,t,e.logsHome,e.logsHome),t}async function q2(o,e,t,n){let i=await o.resolve(t);for(let{resource:r,isDirectory:s}of i.children||[])if(s)await q2(o,e,r,n);else{let a=(await o.readFile(r)).value.toString();if(a){let l=bh(n,r);l&&e.push({relativePath:l,contents:a})}}}var Y2=Z("editorPaneService");var Lp;(e=>e.Workbench="workbench.contributions.kind")(Lp||={});var Ns=(i=>(i[i.BlockStartup=1]="BlockStartup",i[i.BlockRestore=2]="BlockRestore",i[i.AfterRestored=3]="AfterRestored",i[i.Eventually=4]="Eventually",i))(Ns||{});function Z2(o){let e=o;return!!e&&typeof e.editorTypeId=="string"}function l9(o){switch(o){case 3:return Ns.AfterRestored;case 4:return Ns.Eventually}}function X2(o){switch(o){case Ns.BlockStartup:return 1;case Ns.BlockRestore:return 2;case Ns.AfterRestored:return 3;case Ns.Eventually:return 4}}var du=class o extends B{static INSTANCE=new o;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new oe);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new yd;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(e,t,n){let i={id:e,ctor:t};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof n=="number"&&this.lifecycleService.phase>=n||typeof e=="string"&&Z2(n)&&this.editorPaneService.didInstantiateEditorPane(n.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,i,typeof n=="number"?X2(n):this.lifecycleService.phase):(typeof n=="number"&&k_(this.contributionsByPhase,X2(n),[]).push(i),typeof e=="string"&&(this.contributionsById.has(e)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${e}'`):this.contributionsById.set(e,i),Z2(n)&&k_(this.contributionsByEditor,n.editorTypeId,[]).push(i)))}registerWorkbenchContribution(e,t){this.registerWorkbenchContribution2(void 0,e,l9(t))}getWorkbenchContribution(e){if(this.instancesById.has(e))return this.instancesById.get(e);let t=this.instantiationService,n=this.lifecycleService,i=this.logService,r=this.environmentService;if(!t||!n||!i||!r)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): cannot be called before registry started`);let s=this.contributionsById.get(e);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution with that identifier is unknown.`);n.phase<3&&i.warn(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(t,i,r,s,n.phase);let a=this.instancesById.get(e);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): failed to create contribution.`);return a}start(e){let t=this.instantiationService=e.get(nt),n=this.lifecycleService=e.get(jd),i=this.logService=e.get(Fn),r=this.environmentService=e.get(Ro),s=this.editorPaneService=e.get(Y2);this._register(n.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(t,n,i,r,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,t,n,i,r);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,t,n,i,r)))}onEditor(e,t,n,i,r){let s=this.contributionsByEditor.get(e);if(s){this.contributionsByEditor.delete(e);for(let a of s)this.safeCreateContribution(t,i,r,a,n.phase)}}instantiateByPhase(e,t,n,i,r){t.phase>=r?this.doInstantiateByPhase(e,n,i,r):t.when(r).then(()=>this.doInstantiateByPhase(e,n,i,r))}async doInstantiateByPhase(e,t,n,i){let r=this.contributionsByPhase.get(i);if(r)switch(this.contributionsByPhase.delete(i),i){case 1:case 2:{Zn(`code/willCreateWorkbenchContributions/${i}`);for(let s of r)this.safeCreateContribution(e,t,n,s,i);Zn(`code/didCreateWorkbenchContributions/${i}`);break}case 3:case 4:{i===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(r,e,t,n,i);break}}}doInstantiateWhenIdle(e,t,n,i,r){Zn(`code/willCreateWorkbenchContributions/${r}`);let s=0,a=r===4?3e3:500,l=d=>{for(;s<e.length;){let c=e[s++];if(this.safeCreateContribution(t,n,i,c,r),d.timeRemaining()<1){Id(l,a);break}}s===e.length&&(Zn(`code/didCreateWorkbenchContributions/${r}`),r===3&&this.pendingRestoredContributions.complete())};Id(l,a)}safeCreateContribution(e,t,n,i,r){if(typeof i.id=="string"&&this.instancesById.has(i.id))return;let s=Date.now();try{typeof i.id=="string"&&Zn(`code/willCreateWorkbenchContribution/${r}/${i.id}`);let a=e.createInstance(i.ctor);typeof i.id=="string"&&(this.instancesById.set(i.id,a),this.contributionsById.delete(i.id)),iN(a)&&this.instanceDisposables.add(a)}catch(a){t.error(`Unable to create workbench contribution '${i.id??i.ctor.name}'.`,a)}finally{typeof i.id=="string"&&Zn(`code/didCreateWorkbenchContribution/${r}/${i.id}`)}if(typeof i.id=="string"||!n.isBuilt){let a=Date.now()-s;if(a>(r<3?o.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:o.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&t.warn(`Creation of workbench contribution '${i.id??i.ctor.name}' took ${a}ms.`),typeof i.id=="string"){let l=this.timingsByPhase.get(r);l||(l=[],this.timingsByPhase.set(r,l)),l.push([i.id,a])}}}},ES=du.INSTANCE.registerWorkbenchContribution2.bind(du.INSTANCE),NKe=du.INSTANCE.getWorkbenchContribution.bind(du.INSTANCE);Je.add(Lp.Workbench,du.INSTANCE);var Ib=class{constructor(e,t,n,i){this.fileService=e;this.environmentService=t;this.lifecycleService=n;this.logService=i}async getLogs(){return $2(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(3),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await Je.as(Lp.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(e,t){let n=_e.document.querySelector(e);if(!n)return Promise.reject(new Error(`Element not found: ${e}`));let i=n;i.value=t;let r=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(r)}async isActiveElement(e){if(_e.document.querySelector(e)!==_e.document.activeElement){let n=[],i=_e.document.activeElement;for(;i;){let r=i.tagName,s=i.id?`#${i.id}`:"",a=vr(i.className.split(/\s+/g).map(l=>l.trim())).map(l=>`.${l}`).join("");n.unshift(`${r}${s}${a}`),i=i.parentElement}throw new Error(`Active element not found. Current active element is '${n.join(" > ")}'. Looking for ${e}`)}return!0}async getElements(e,t){let n=_e.document.querySelectorAll(e),i=[];for(let r=0;r<n.length;r++){let s=n.item(r);i.push(this.serializeElement(s,t))}return i}serializeElement(e,t){let n=Object.create(null);for(let a=0;a<e.attributes.length;a++){let l=e.attributes.item(a);l&&(n[l.name]=l.value)}let i=[];if(t)for(let a=0;a<e.children.length;a++){let l=e.children.item(a);l&&i.push(this.serializeElement(l,!0))}let{left:r,top:s}=sb(e);return{tagName:e.tagName,className:e.className,textContent:e.textContent||"",attributes:n,children:i,left:r,top:s}}async getElementXY(e,t,n){let i=typeof t=="number"&&typeof n=="number"?{x:t,y:n}:void 0;return this._getElementXY(e,i)}async typeInEditor(e,t){let n=_e.document.querySelector(e);if(!n)throw new Error(`Editor not found: ${e}`);let i=n,r=i.selectionStart,s=r+t.length,a=i.value,l=a.substr(0,r)+t+a.substr(r);i.value=l,i.setSelectionRange(s,s);let d=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(d)}async getTerminalBuffer(e){let t=_e.document.querySelector(e);if(!t)throw new Error(`Terminal not found: ${e}`);let n=t.xterm;if(!n)throw new Error(`Xterm not found: ${e}`);let i=[];for(let r=0;r<n.buffer.active.length;r++)i.push(n.buffer.active.getLine(r).translateToString(!0));return i}async writeInTerminal(e,t){let n=_e.document.querySelector(e);if(!n)throw new Error(`Element not found: ${e}`);let i=n.xterm;if(!i)throw new Error(`Xterm not found: ${e}`);i.input(t)}getLocaleInfo(){return Promise.resolve({language:$s,locale:zM})}getLocalizedStrings(){return Promise.resolve({open:xS.open,close:xS.close,find:xS.find})}async _getElementXY(e,t){let n=_e.document.querySelector(e);if(!n)return Promise.reject(new Error(`Element not found: ${e}`));let{left:i,top:r}=sb(n),{width:s,height:a}=tu(n),l,d;return t?(l=i+t.x,d=r+t.y):(l=i+s/2,d=r+a/2),l=Math.round(l),d=Math.round(d),{x:l,y:d}}async exitApplication(){}};Ib=k([E(0,dn),E(1,Ro),E(2,jd),E(3,Fn)],Ib);function Q2(o){Object.assign(_e,{driver:o.createInstance(Ib)})}var Br=class extends B{constructor(t,n={getWindowsCount:zC,getWindows:ob},i,r){super();this.hostService=i;this.environmentService=r;this.enableWindowFocusOnElementFocus(t),this.enableMultiWindowAwareTimeout(t,n),this.registerFullScreenListeners(t.vscodeWindowId)}static TIMEOUT_HANDLES=Number.MIN_SAFE_INTEGER;static TIMEOUT_DISPOSABLES=new Map;enableWindowFocusOnElementFocus(t){let n=t.HTMLElement.prototype.focus,i=this;t.HTMLElement.prototype.focus=function(r){i.onElementFocus(Ce(this)),n.apply(this,[r])}}onElementFocus(t){let n=Hd();n!==t&&n.document.hasFocus()&&(t.focus(),!this.environmentService.extensionTestsLocationURI&&!t.document.hasFocus()&&this.hostService.focus(t))}enableMultiWindowAwareTimeout(t,n={getWindowsCount:zC,getWindows:ob}){let i=t.setTimeout;Object.defineProperty(t,"vscodeOriginalSetTimeout",{get:()=>i});let r=t.clearTimeout;Object.defineProperty(t,"vscodeOriginalClearTimeout",{get:()=>r}),t.setTimeout=function(s,a=0,...l){if(n.getWindowsCount()===1||typeof s=="string"||a===0)return i.apply(this,[s,a,...l]);let d=new Set,c=Br.TIMEOUT_HANDLES++;Br.TIMEOUT_DISPOSABLES.set(c,d);let u=ds(s,()=>{Nt(d),Br.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:h,disposables:m}of n.getWindows()){if(L1(h)&&h.document.visibilityState==="hidden")continue;let g=!1,f=h.vscodeOriginalSetTimeout.apply(this,[(...y)=>{g||u(...y)},a,...l]),b=pe(()=>{g=!0,h.vscodeOriginalClearTimeout(f),d.delete(b)});m.add(b),d.add(b)}return c},t.clearTimeout=function(s){let a=typeof s=="number"?Br.TIMEOUT_DISPOSABLES.get(s):void 0;a?(Nt(a),Br.TIMEOUT_DISPOSABLES.delete(s)):r.apply(this,[s])}}registerFullScreenListeners(t){this._register(this.hostService.onDidChangeFullScreen(({windowId:n,fullscreen:i})=>{if(n===t){let r=Jc(t);r&&fB(i,r.window)}}))}static async confirmOnShutdown(t,n){let i=t.get(xa),r=t.get(rt),s=n===2?Fe?p("quitMessageMac","Are you sure you want to quit?"):p("quitMessage","Are you sure you want to exit?"):p("closeWindowMessage","Are you sure you want to close the window?"),a=n===2?Fe?p({key:"quitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Quit"):p({key:"exitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Exit"):p({key:"closeWindowButtonLabel",comment:["&& denotes a mnemonic"]},"&&Close Window"),l=await i.confirm({message:s,primaryButton:a,checkbox:{label:p("doNotAskAgain","Do not ask me again")}});return l.confirmed&&l.checkboxChecked&&await r.updateValue("window.confirmBeforeClose","never"),l.confirmed}};Br=k([E(2,Tp),E(3,bb)],Br);var wS=class extends Br{constructor(t,n,i,r,s,a,l,d,c){super(_e,void 0,c,a);this.openerService=t;this.lifecycleService=n;this.dialogService=i;this.labelService=r;this.productService=s;this.browserEnvironmentService=a;this.layoutService=l;this.instantiationService=d;this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let t=Zl&&_e.visualViewport?_e.visualViewport:_e;this._register(z(t,me.RESIZE,()=>{this.layoutService.layout(),Zl&&_e.scrollTo(0,0)})),this._register(z(this.layoutService.mainContainer,me.WHEEL,n=>n.preventDefault(),{passive:!1})),this._register(z(this.layoutService.mainContainer,me.CONTEXT_MENU,n=>Qe.stop(n,!0))),this._register(z(this.layoutService.mainContainer,me.DROP,n=>Qe.stop(n,!0)))}onWillShutdown(){Y.toPromise(Y.any(Y.once(new Oe(_e.document.body,me.KEY_DOWN,!0).event),Y.once(new Oe(_e.document.body,me.MOUSE_DOWN,!0).event))).then(async()=>{await nr(3e3),await this.dialogService.prompt({type:On.Error,message:p("shutdownError","An unexpected error occurred that requires a reload of this page."),detail:p("shutdownErrorDetail","The workbench was unexpectedly disposed while running."),buttons:[{label:p({key:"reload",comment:["&& denotes a mnemonic"]},"&&Reload"),run:()=>_e.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&Q2(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async t=>{let n=!1;if(this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes){for(let i of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(t.startsWith(i)){n=!0;break}}if(fh(t,Ae.http)||fh(t,Ae.https))Bo?QB(t,!n)||await this.dialogService.prompt({type:On.Warning,message:p("unableToOpenExternal","The browser interrupted the opening of a new tab or window. Press 'Open' to open it anyway."),detail:t,buttons:[{label:p({key:"open",comment:["&& denotes a mnemonic"]},"&&Open"),run:()=>n?j1(t):G1(t)},{label:p({key:"learnMore",comment:["&& denotes a mnemonic"]},"&&Learn More"),run:()=>this.openerService.open(ne.parse("https://aka.ms/allow-vscode-popup"))}],cancelButton:!0}):n?j1(t):G1(t);else{let i=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>_e.location.href=t)};i();let r=async()=>{let{downloadUrl:s}=this.productService,a,l=[{label:p({key:"openExternalDialogButtonRetry.v2",comment:["&& denotes a mnemonic"]},"&&Try Again"),run:()=>i()}];s!==void 0?(a=p("openExternalDialogDetail.v2",`We launched {0} on your computer.

If {1} did not launch, try again or install it below.`,this.productService.nameLong,this.productService.nameLong),l.push({label:p({key:"openExternalDialogButtonInstall.v3",comment:["&& denotes a mnemonic"]},"&&Install"),run:async()=>{await this.openerService.open(ne.parse(s)),r()}})):a=p("openExternalDialogDetailNoInstall",`We launched {0} on your computer.

If {1} did not launch, try again below.`,this.productService.nameLong,this.productService.nameLong),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:On.Info,message:p("openExternalDialogTitle","All done. You can close this tab now."),detail:a,buttons:l,cancelButton:!0}))};fh(t,this.productService.urlProtocol)&&await r()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:Ae.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){$i.registerCommand("workbench.experimental.requestUsbDevice",async(t,n)=>B2(n)),$i.registerCommand("workbench.experimental.requestSerialPort",async(t,n)=>V2(n)),$i.registerCommand("workbench.experimental.requestHidDevice",async(t,n)=>W2(n))}};wS=k([E(0,IS),E(1,jd),E(2,xa),E(3,Mr),E(4,ZF),E(5,U2),E(6,SS),E(7,nt),E(8,Tp)],wS);var d9=Z("auxiliaryWindowService");var Cb=class extends Br{constructor(t,n,i,r,s,a){super(t,void 0,s,a);this.window=t;this.container=n;this.configurationService=r;this.whenStylesHaveLoaded=i.wait().then(()=>{}),this.registerListeners()}_onWillLayout=this._register(new T);onWillLayout=this._onWillLayout.event;_onDidLayout=this._register(new T);onDidLayout=this._onDidLayout.event;_onBeforeUnload=this._register(new T);onBeforeUnload=this._onBeforeUnload.event;_onUnload=this._register(new T);onUnload=this._onUnload.event;_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;whenStylesHaveLoaded;registerListeners(){this._register(z(this.window,me.BEFORE_UNLOAD,t=>this.handleBeforeUnload(t))),this._register(z(this.window,me.UNLOAD,()=>this.handleUnload())),this._register(z(this.window,"unhandledrejection",t=>{Ne(t.reason),t.preventDefault()})),this._register(z(this.window,me.RESIZE,()=>this.layout())),this._register(z(this.container,me.SCROLL,()=>this.container.scrollTop=0)),wo?(this._register(z(this.container,me.DROP,t=>Qe.stop(t,!0))),this._register(z(this.container,me.WHEEL,t=>t.preventDefault(),{passive:!1})),this._register(z(this.container,me.CONTEXT_MENU,t=>Qe.stop(t,!0)))):(this._register(z(this.window.document.body,me.DRAG_OVER,t=>Qe.stop(t))),this._register(z(this.window.document.body,me.DROP,t=>Qe.stop(t))))}handleBeforeUnload(t){let n;if(this._onBeforeUnload.fire({veto(s){s&&(n=s)}}),n){this.handleVetoBeforeClose(t,n);return}let i=this.configurationService.getValue("window.confirmBeforeClose");(i==="always"||i==="keyboardOnly"&&Ip.getInstance().isModifierPressed)&&this.confirmBeforeClose(t)}handleVetoBeforeClose(t,n){this.preventUnload(t)}preventUnload(t){t.preventDefault(),t.returnValue=p("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(t){this.preventUnload(t)}handleUnload(){this._onUnload.fire()}layout(){let t=tu(this.window.document.body,this.container);this._onWillLayout.fire(t),this._onDidLayout.fire(t)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:mB(this.window)}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};Cb=k([E(3,rt),E(4,Tp),E(5,bb)],Cb);var _l=class extends B{constructor(t,n,i,r,s,a){super();this.layoutService=t;this.dialogService=n;this.configurationService=i;this.telemetryService=r;this.hostService=s;this.environmentService=a}static DEFAULT_SIZE={width:800,height:600};static WINDOW_IDS=Wd(_e)+1;_onDidOpenAuxiliaryWindow=this._register(new T);onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event;windows=new Map;async open(t){Zn("code/auxiliaryWindow/willOpen");let n=await this.openWindow(t);if(!n)throw new Error(p("unableToOpenWindowError","Unable to open a new window."));let i=await this.resolveWindowId(n);kC(n,i);let r=new oe,{container:s,stylesLoaded:a}=this.createContainer(n,r,t),l=this.createAuxiliaryWindow(n,s,a),d=new oe;this.windows.set(n.vscodeWindowId,l),d.add(pe(()=>this.windows.delete(n.vscodeWindowId)));let c=new oe;return Y.once(l.onWillDispose)(()=>{n.close(),r.dispose(),d.dispose(),c.dispose()}),d.add(PB(n)),this._onDidOpenAuxiliaryWindow.fire({window:l,disposables:c}),Zn("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!!t?.bounds}),l}createAuxiliaryWindow(t,n,i){return new Cb(t,n,i,this.configurationService,this.hostService,this.environmentService)}async openWindow(t){let n=Hd(),i={x:n.screenX,y:n.screenY,width:n.outerWidth,height:n.outerHeight},r=Math.max(t?.bounds?.width??_l.DEFAULT_SIZE.width,g1.WIDTH),s=Math.max(t?.bounds?.height??_l.DEFAULT_SIZE.height,g1.HEIGHT),a={x:t?.bounds?.x??Math.max(i.x+i.width/2-r/2,0),y:t?.bounds?.y??Math.max(i.y+i.height/2-s/2,0),width:r,height:s};!t?.bounds&&a.x===i.x&&a.y===i.y&&(a={...a,x:a.x+30,y:a.y+30});let l=vr(["popup=yes",`left=${a.x}`,`top=${a.y}`,`width=${a.width}`,`height=${a.height}`,t?.nativeTitlebar?"window-native-titlebar=yes":void 0,t?.disableFullscreen?"window-disable-fullscreen=yes":void 0,t?.mode===0?"window-maximized=yes":void 0,t?.mode===2?"window-fullscreen=yes":void 0]),d=_e.open(wv?"":"about:blank",void 0,l.join(","));return!d&&wo?(await this.dialogService.prompt({type:On.Warning,message:p("unableToOpenWindow","The browser interrupted the opening of a new window. Press 'Retry' to try again."),detail:p("unableToOpenWindowDetail","To avoid this problem in the future, please ensure to allow popups for this website."),buttons:[{label:p({key:"retry",comment:["&& denotes a mnemonic"]},"&&Retry"),run:()=>this.openWindow(t)}],cancelButton:!0})).result:d?.window}async resolveWindowId(t){return _l.WINDOW_IDS++}createContainer(t,n,i){t.document.createElement=function(){throw new Error('Not allowed to create elements in child window JavaScript context. Always use the main window so that "xyz instanceof HTMLElement" continues to work.')},this.applyMeta(t);let{stylesLoaded:r}=this.applyCSS(t,n),s=this.applyHTML(t,n);return{stylesLoaded:r,container:s}}applyMeta(t){for(let i of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let r=_e.document.querySelector(i);if(r){let s=GB(t.document.head);if(YC(r,s),i==='meta[http-equiv="Content-Security-Policy"]'){let a=s.getAttribute("content");a&&s.setAttribute("content",a.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let n=_e.document.querySelector('link[rel="icon"]');if(n){let i=jB(t.document.head);YC(n,i)}}applyCSS(t,n){Zn("code/auxiliaryWindow/willApplyCSS");let i=new Map,r=new Rh;r.wait().then(()=>Zn("code/auxiliaryWindow/didLoadCSSStyles"));let s=n.add(new oe),a=0;function l(){--a===0&&(s.dispose(),r.open())}function d(c){if(UB(c))return;let u=t.document.head.appendChild(c.cloneNode(!0));c.tagName.toLowerCase()==="link"&&(a++,s.add(z(u,"load",l)),s.add(z(u,"error",l))),i.set(c,u)}a++;try{for(let c of _e.document.head.querySelectorAll('link[rel="stylesheet"], style'))d(c)}finally{l()}return n.add(zB(t)),n.add($C.observe(_e.document.head,n,{childList:!0,subtree:!0})(c=>{for(let u of c)if(!(u.type!=="childList"||u.target.nodeName.toLowerCase()==="title"||u.target.nodeName.toLowerCase()==="script"||u.target.nodeName.toLowerCase()==="meta")){for(let h of u.addedNodes)if(ai(h)&&(h.tagName.toLowerCase()==="style"||h.tagName.toLowerCase()==="link"))d(h);else if(h.nodeType===Node.TEXT_NODE&&h.parentNode){let m=i.get(h.parentNode);m&&(m.textContent=h.textContent)}for(let h of u.removedNodes){let m=i.get(h);m&&(m.parentNode?.removeChild(m),i.delete(h))}}})),Zn("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:r}}applyHTML(t,n){Zn("code/auxiliaryWindow/willApplyHTML");let i=document.createElement("div");return i.setAttribute("role","application"),VB(i,0,0,0,0,"relative"),i.style.display="flex",i.style.height="100%",i.style.flexDirection="column",t.document.body.append(i),n.add(ZC(_e.document.documentElement,t.document.documentElement)),n.add(ZC(_e.document.body,t.document.body)),n.add(ZC(this.layoutService.mainContainer,i,["class"])),Zn("code/auxiliaryWindow/didApplyHTML"),i}getWindow(t){return this.windows.get(t)}};_l=k([E(0,SS),E(1,xa),E(2,rt),E(3,Ao),E(4,Tp),E(5,bb)],_l);Pn(d9,_l,1);var Dp=new Or(220,70),Rp=new Or(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);var _S=class o extends fS{constructor(t,n,i,r,s){super(t,i,r,s);this.group=n}onDidChangeSizeConstraints=Y.None;_onDidChangeControl=this._register(new T);onDidChangeControl=this._onDidChangeControl.event;static EDITOR_MEMENTOS=new Map;get minimumWidth(){return Dp.width}get maximumWidth(){return Rp.width}get minimumHeight(){return Dp.height}get maximumHeight(){return Rp.height}_input;get input(){return this._input}_options;get options(){return this._options}get window(){return Jc(this.group.windowId,!0).window}get scopedContextKeyService(){}create(t){super.create(t),this.createEditor(t)}async setInput(t,n,i,r){this._input=t,this._options=n}clearInput(){this._input=void 0,this._options=void 0}setOptions(t){this._options=t}setVisible(t){super.setVisible(t),this.setEditorVisible(t)}setEditorVisible(t){}setBoundarySashes(t){}getEditorMemento(t,n,i,r=10){let s=`${this.getId()}${i}`,a=o.EDITOR_MEMENTOS.get(s);return a||(a=this._register(new T0(this.getId(),i,this.getMemento(1,1),r,t,n)),o.EDITOR_MEMENTOS.set(s,a)),a}getViewState(){}saveState(){for(let[,t]of o.EDITOR_MEMENTOS)t.id===this.getId()&&t.saveState();super.saveState()}dispose(){this._input=void 0,this._options=void 0,super.dispose()}},T0=class o extends B{constructor(t,n,i,r,s,a){super();this.id=t;this.key=n;this.memento=i;this.limit=r;this.editorGroupService=s;this.configurationService=a;this.updateConfiguration(void 0),this.registerListeners()}static SHARED_EDITOR_STATE=-1;cache;cleanedUp=!1;editorDisposables;shareEditorState=!1;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.updateConfiguration(t)))}updateConfiguration(t){(!t||t.affectsConfiguration(void 0,"workbench.editor.sharedViewState"))&&(this.shareEditorState=this.configurationService.getValue(void 0,"workbench.editor.sharedViewState")===!0)}saveEditorState(t,n,i){let r=this.doGetResource(n);if(!r||!t)return;let s=this.doLoad(),a=s.get(r.toString());a||(a=Object.create(null),s.set(r.toString(),a)),a[t.id]=i,this.shareEditorState&&(a[o.SHARED_EDITOR_STATE]=i),Pi(n)&&this.clearEditorStateOnDispose(r,n)}loadEditorState(t,n){let i=this.doGetResource(n);if(!i||!t)return;let s=this.doLoad().get(i.toString());if(s){let a=s[t.id];if(a)return a;if(this.shareEditorState)return s[o.SHARED_EDITOR_STATE]}}clearEditorState(t,n){Pi(t)&&this.editorDisposables?.delete(t);let i=this.doGetResource(t);if(i){let r=this.doLoad();if(n){let s=r.get(i.toString());s&&(delete s[n.id],bc(s)&&r.delete(i.toString()))}else r.delete(i.toString())}}clearEditorStateOnDispose(t,n){this.editorDisposables||(this.editorDisposables=new Map),this.editorDisposables.has(n)||this.editorDisposables.set(n,Y.once(n.onWillDispose)(()=>{this.clearEditorState(t),this.editorDisposables?.delete(n)}))}moveEditorState(t,n,i){let r=this.doLoad(),s=[...r.keys()];for(let a of s){let l=ne.parse(a);if(!i.isEqualOrParent(l,t))continue;let d;if(_n(t,l))d=n;else{let u=$N(l.path,t.path);d=mt(n,l.path.substr(u+t.path.length+1))}let c=r.get(a,0);c&&(r.delete(a),r.set(d.toString(),c))}}doGetResource(t){return Pi(t)?t.resource:t}doLoad(){if(!this.cache){this.cache=new Ri(this.limit);let t=this.memento[this.key];Array.isArray(t)&&this.cache.fromJSON(t)}return this.cache}saveState(){let t=this.doLoad();this.cleanedUp||(this.cleanUp(),this.cleanedUp=!0),this.memento[this.key]=t.toJSON()}cleanUp(){let t=this.doLoad(),n=[...t.entries()];for(let[i,r]of n)for(let s of Object.keys(r)){let a=Number(s);a===o.SHARED_EDITOR_STATE&&this.shareEditorState||this.editorGroupService.getGroup(a)||(delete r[a],bc(r)&&t.delete(i))}}};var TS=class o{constructor(e,t,n){this.ctor=e;this.typeId=t;this.name=n}static instantiatedEditorPanes=new Set;static didInstantiateEditorPane(e){return o.instantiatedEditorPanes.has(e)}static _onWillInstantiateEditorPane=new T;static onWillInstantiateEditorPane=o._onWillInstantiateEditorPane.event;static create(e,t,n){return new o(e,t,n)}instantiate(e,t){o._onWillInstantiateEditorPane.fire({typeId:this.typeId});let n=e.createInstance(this.ctor,t);return o.instantiatedEditorPanes.add(this.typeId),n}describes(e){return e.getId()===this.typeId}},L0=class{mapEditorPanesToEditors=new Map;registerEditorPane(e,t){return this.mapEditorPanesToEditors.set(e,t),pe(()=>{this.mapEditorPanesToEditors.delete(e)})}getEditorPane(e){let t=this.findEditorPaneDescriptors(e);if(t.length!==0)return t.length===1?t[0]:e.prefersEditorPane(t)}findEditorPaneDescriptors(e,t){let n=[];for(let i of this.mapEditorPanesToEditors.keys()){let r=this.mapEditorPanesToEditors.get(i)||[];for(let s of r){let a=s.ctor;if(!t&&e.constructor===a){n.push(i);break}else if(t&&e instanceof a){n.push(i);break}}}return!t&&n.length===0?this.findEditorPaneDescriptors(e,!0):n}getEditorPaneByType(e){return Yo.find(this.mapEditorPanesToEditors.keys(),t=>t.typeId===e)}getEditorPanes(){return Array.from(this.mapEditorPanesToEditors.keys())}getEditors(){let e=[];for(let t of this.mapEditorPanesToEditors.keys()){let n=this.mapEditorPanesToEditors.get(t);n&&e.push(...n.map(i=>i.ctor))}return e}};Je.add(wa.EditorPane,new L0);function J2(o,e,t,n){let i=o.getAriaLabel();return t&&!t.isPinned(o)&&(i=p("preview","{0}, preview",i)),t?.isSticky(e??o)&&(i=p("pinned","{0}, pinned",i)),t&&typeof n=="number"&&n>1&&(i=`${i}, ${t.ariaLabel}`),i}var Pa=class extends B{constructor(t,n){super();this.configurationService=t;this.workspaceContextService=n;this.storeEnablementState(),this.storeCustomPatterns(),this.registerListeners()}_serviceBrand;static SETTING_ID_PATTERNS="workbench.editor.customLabels.patterns";static SETTING_ID_ENABLED="workbench.editor.customLabels.enabled";_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;patterns=[];enabled=!0;cache=new Mv(1e3);registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration(Pa.SETTING_ID_ENABLED)){let n=this.enabled;this.storeEnablementState(),n!==this.enabled&&this.patterns.length>0&&this._onDidChange.fire()}else t.affectsConfiguration(Pa.SETTING_ID_PATTERNS)&&(this.cache.clear(),this.storeCustomPatterns(),this._onDidChange.fire())}))}storeEnablementState(){this.enabled=this.configurationService.getValue(Pa.SETTING_ID_ENABLED)}_templateRegexValidation=/[a-zA-Z0-9]/;storeCustomPatterns(){this.patterns=[];let t=this.configurationService.getValue(Pa.SETTING_ID_PATTERNS);for(let n in t){let i=t[n];if(!this._templateRegexValidation.test(i))continue;let r=dg(n),s=nf(n);this.patterns.push({pattern:n,template:i,isAbsolutePath:r,parsedPattern:s})}this.patterns.sort((n,i)=>this.patternWeight(i.pattern)-this.patternWeight(n.pattern))}patternWeight(t){let n=0;for(let i of t.split("/"))i==="**"?n+=1:i==="*"?n+=10:i.includes("*")||i.includes("?")?n+=50:i!==""&&(n+=100);return n}getName(t){if(!this.enabled||this.patterns.length===0)return;let n=t.toString(),i=this.cache.get(n);if(i!==void 0)return i??void 0;let r=this.applyPatterns(t);return this.cache.set(n,r??null),r}applyPatterns(t){let n=this.workspaceContextService.getWorkspaceFolder(t),i;for(let r of this.patterns){let s;if(n&&!r.isAbsolutePath?(i||(i=bh(hd(n.uri),t)??t.path),s=i):s=t.path,r.parsedPattern(s))return this.applyTemplate(r.template,t,s)}}_parsedTemplateExpression=/\$\{(dirname|filename|extname|extname\((?<extnameN>[-+]?\d+)\)|dirname\((?<dirnameN>[-+]?\d+)\))\}/g;_filenameCaptureExpression=/(?<filename>^\.*[^.]*)/;applyTemplate(t,n,i){let r;return t.replace(this._parsedTemplateExpression,(s,a,...l)=>{r=r??XM(n.path);let{dirnameN:d="0",extnameN:c="0"}=l.pop();if(a==="filename"){let{filename:u}=this._filenameCaptureExpression.exec(r.base)?.groups??{};if(u)return u}else if(a==="extname"){let u=this.getExtnames(r.base);if(u)return u}else if(a.startsWith("extname")){let u=parseInt(c),h=this.getNthExtname(r.base,u);if(h)return h}else if(a.startsWith("dirname")){let u=parseInt(d),h=this.getNthDirname(eh(i),u);if(h)return h}return s})}removeLeadingDot(t){let n=t;for(;n.startsWith(".");)n=n.slice(1);return n}getNthDirname(t,n){t=t.startsWith("/")?t.slice(1):t;let i=t.split("/");return this.getNthFragment(i,n)}getExtnames(t){return this.removeLeadingDot(t).split(".").slice(1).join(".")}getNthExtname(t,n){let i=this.removeLeadingDot(t).split(".");return i.shift(),this.getNthFragment(i,n)}getNthFragment(t,n){let i=t.length,r;n<0?r=Math.abs(n)-1:r=i-n-1;let s=t[r];if(!(s===void 0||s===""))return s}};Pa=k([E(0,rt),E(1,pd)],Pa);var $d=Z("ICustomEditorLabelService");Pn($d,Pa,1);var kp=class extends _s{constructor(t,n,i,r,s,a,l){super();this.resource=t;this.labelService=i;this.fileService=r;this.filesConfigurationService=s;this.textResourceConfigurationService=a;this.customEditorLabelService=l;this._preferredResource=n||t,this.registerListeners()}get capabilities(){let t=32;return this.fileService.hasProvider(this.resource)?this.filesConfigurationService.isReadonly(this.resource)&&(t|=2):t|=4,t&2||(t|=128),t}_preferredResource;get preferredResource(){return this._preferredResource}registerListeners(){this._register(this.labelService.onDidChangeFormatters(t=>this.onLabelEvent(t.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(t=>this.onLabelEvent(t.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(t=>this.onLabelEvent(t.scheme))),this._register(this.customEditorLabelService.onDidChange(()=>this.updateLabel()))}onLabelEvent(t){t===this._preferredResource.scheme&&this.updateLabel()}updateLabel(){this._name=void 0,this._shortDescription=void 0,this._mediumDescription=void 0,this._longDescription=void 0,this._shortTitle=void 0,this._mediumTitle=void 0,this._longTitle=void 0,this._onDidChangeLabel.fire()}setPreferredResource(t){_n(t,this._preferredResource)||(this._preferredResource=t,this.updateLabel())}_name=void 0;getName(){return typeof this._name!="string"&&(this._name=this.customEditorLabelService.getName(this._preferredResource)??this.labelService.getUriBasenameLabel(this._preferredResource)),this._name}getDescription(t=1){switch(t){case 0:return this.shortDescription;case 2:return this.longDescription;case 1:default:return this.mediumDescription}}_shortDescription=void 0;get shortDescription(){return typeof this._shortDescription!="string"&&(this._shortDescription=this.labelService.getUriBasenameLabel(hd(this._preferredResource))),this._shortDescription}_mediumDescription=void 0;get mediumDescription(){return typeof this._mediumDescription!="string"&&(this._mediumDescription=this.labelService.getUriLabel(hd(this._preferredResource),{relative:!0})),this._mediumDescription}_longDescription=void 0;get longDescription(){return typeof this._longDescription!="string"&&(this._longDescription=this.labelService.getUriLabel(hd(this._preferredResource))),this._longDescription}_shortTitle=void 0;get shortTitle(){return typeof this._shortTitle!="string"&&(this._shortTitle=this.getName()),this._shortTitle}_mediumTitle=void 0;get mediumTitle(){return typeof this._mediumTitle!="string"&&(this._mediumTitle=this.labelService.getUriLabel(this._preferredResource,{relative:!0})),this._mediumTitle}_longTitle=void 0;get longTitle(){return typeof this._longTitle!="string"&&(this._longTitle=this.labelService.getUriLabel(this._preferredResource)),this._longTitle}getTitle(t){switch(t){case 0:return this.shortTitle;case 2:return this.longTitle;default:case 1:return this.mediumTitle}}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource)}ensureLimits(t){if(t?.limits)return t.limits;let n=dO(this.resource),i,r=this.textResourceConfigurationService.inspect(this.resource,null,"workbench.editorLargeFileConfirmation");return QN(r)&&(i=r.value*Td.MB),{size:i??n}}};kp=k([E(2,Mr),E(3,dn),E(4,La),E(5,Xi),E(6,$d)],kp);var Mp=class extends ma{constructor(e,t,n,i,r){super(n,t,i,r,e)}dispose(){this.textEditorModelHandle&&this.modelService.destroyModel(this.textEditorModelHandle),super.dispose()}};Mp=k([E(1,ho),E(2,kr),E(3,Uh),E(4,Jo)],Mp);var cu=class extends kp{constructor(t,n,i,r,s,a,l,d,c){super(t,n,s,a,l,d,c);this.editorService=i;this.textFileService=r}save(t,n){return this.resource.scheme!==Ae.untitled&&!this.fileService.hasProvider(this.resource)?this.saveAs(t,n):this.doSave(n,!1,t)}saveAs(t,n){return this.doSave(n,!0,t)}async doSave(t,n,i){let r;if(n?r=await this.textFileService.saveAs(this.resource,void 0,{...t,suggestedTarget:this.preferredResource}):r=await this.textFileService.save(this.resource,t),!!r)return{resource:r}}async revert(t,n){await this.textFileService.revert(this.resource,n)}};cu=k([E(2,st),E(3,Ta),E(4,Mr),E(5,dn),E(6,La),E(7,Xi),E(8,$d)],cu);var uu=class extends cu{constructor(t,n,i,r,s,a,l,d,c,u,h,m,g){super(t,void 0,d,l,u,c,h,m,g);this.name=n;this.description=i;this.preferredLanguageId=r;this.preferredContents=s;this.textModelService=a}static ID="workbench.editors.resourceEditorInput";get typeId(){return uu.ID}get editorId(){return Cl.id}cachedModel=void 0;modelReference=void 0;getName(){return this.name||super.getName()}setName(t){this.name!==t&&(this.name=t,this._onDidChangeLabel.fire())}getDescription(){return this.description}setDescription(t){this.description!==t&&(this.description=t,this._onDidChangeLabel.fire())}setLanguageId(t,n){this.setPreferredLanguageId(t),this.cachedModel?.setLanguageId(t,n)}setPreferredLanguageId(t){this.preferredLanguageId=t}setPreferredContents(t){this.preferredContents=t}async resolve(){let t=this.preferredContents,n=this.preferredLanguageId;this.preferredContents=void 0,this.preferredLanguageId=void 0,this.modelReference||(this.modelReference=this.textModelService.createModelReference(this.resource));let i=await this.modelReference,r=i.object;if(!(r instanceof Mp))throw i.dispose(),this.modelReference=void 0,new Error(`Unexpected model for TextResourceEditorInput: ${this.resource}`);return this.cachedModel=r,(typeof t=="string"||typeof n=="string")&&r.updateTextEditorModel(typeof t=="string"?Kf(t):void 0,n),r}matches(t){return this===t?!0:t instanceof uu?_n(t.resource,this.resource):yC(t)?super.matches(t):!1}dispose(){this.modelReference&&(this.modelReference.then(t=>t.dispose()),this.modelReference=void 0),this.cachedModel=void 0,super.dispose()}};uu=k([E(5,Hh),E(6,Ta),E(7,st),E(8,dn),E(9,Mr),E(10,La),E(11,Xi),E(12,$d)],uu);var LS=class extends B{_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(e,t){super(),this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null,t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()},n=!1,i=!1,r=()=>{if(n&&!i)try{n=!1,i=!0,t()}finally{Ii(Ce(this._referenceDomElement),()=>{i=!1,r()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?e={width:s[0].contentRect.width,height:s[0].contentRect.height}:e=null,n=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let n=0,i=0;t?(n=t.width,i=t.height):this._referenceDomElement&&(n=this._referenceDomElement.clientWidth,i=this._referenceDomElement.clientHeight),n=Math.max(5,n),i=Math.max(5,i),(this._width!==n||this._height!==i)&&(this._width=n,this._height=i,e&&this._onDidChange.fire())}};var D0=class extends B{_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(e){super(),this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}},R0=class extends B{_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(e){super(),this._value=this._getPixelRatio(e);let t=this._register(new D0(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){let t=document.createElement("canvas").getContext("2d"),n=e.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i}},k0=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(e){let t=Wd(e),n=this.mapWindowIdToPixelRatioMonitor.get(t);return n||(n=id(new R0(e)),this.mapWindowIdToPixelRatioMonitor.set(t,n),id(Y.once(FB)(({vscodeWindowId:i})=>{i===t&&(n?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))}))),n}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}},Np=new k0;function Cn(o,e){o instanceof iu?(o.setFontFamily(e.getMassagedFontFamily()),o.setFontWeight(e.fontWeight),o.setFontSize(e.fontSize),o.setFontFeatureSettings(e.fontFeatureSettings),o.setFontVariationSettings(e.fontVariationSettings),o.setLineHeight(e.lineHeight),o.setLetterSpacing(e.letterSpacing)):(o.style.fontFamily=e.getMassagedFontFamily(),o.style.fontWeight=e.fontWeight,o.style.fontSize=e.fontSize+"px",o.style.fontFeatureSettings=e.fontFeatureSettings,o.style.fontVariationSettings=e.fontVariationSettings,o.style.lineHeight=e.lineHeight+"px",o.style.letterSpacing=e.letterSpacing+"px")}var DS=class{chr;type;width;constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}},M0=class o{_bareFontInfo;_requests;_container;_testElements;constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";let t=document.createElement("div");Cn(t,this._bareFontInfo),e.appendChild(t);let n=document.createElement("div");Cn(n,this._bareFontInfo),n.style.fontWeight="bold",e.appendChild(n);let i=document.createElement("div");Cn(i,this._bareFontInfo),i.style.fontStyle="italic",e.appendChild(i);let r=[];for(let s of this._requests){let a;s.type===0&&(a=t),s.type===2&&(a=n),s.type===1&&(a=i),a.appendChild(document.createElement("br"));let l=document.createElement("span");o._render(l,s),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let n="\xA0";for(let i=0;i<8;i++)n+=n;e.innerText=n}else{let n=t.chr;for(let i=0;i<8;i++)n+=n;e.textContent=n}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){let n=this._requests[e],i=this._testElements[e];n.fulfill(i.offsetWidth/256)}}};function eV(o,e,t){new M0(e,t).read(o)}var N0=class extends B{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){let t=Wd(e),n=this._cache.get(t);return n||(n=new A0,this._cache.set(t,n)),n}_writeToCache(e,t,n){this._ensureCache(e).put(t,n),!n.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){let t=this._ensureCache(e),n=t.getValues(),i=!1;for(let r of n)r.isTrusted||(i=!0,t.remove(r));i&&this._onDidChange.fire()}serializeFontInfo(e){return this._ensureCache(e).getValues().filter(n=>n.isTrusted)}restoreFontInfo(e,t){for(let n of t){if(n.version!==DT)continue;let i=new Ch(n,!1);this._writeToCache(e,i,i)}}readFontInfo(e,t){let n=this._ensureCache(e);if(!n.has(t)){let i=this._actualReadFontInfo(e,t);(i.typicalHalfwidthCharacterWidth<=2||i.typicalFullwidthCharacterWidth<=2||i.spaceWidth<=2||i.maxDigitWidth<=2)&&(i=new Ch({pixelRatio:Np.getInstance(e).value,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFeatureSettings:i.fontFeatureSettings,fontVariationSettings:i.fontVariationSettings,lineHeight:i.lineHeight,letterSpacing:i.letterSpacing,isMonospace:i.isMonospace,typicalHalfwidthCharacterWidth:Math.max(i.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(i.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:i.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(i.spaceWidth,5),middotWidth:Math.max(i.middotWidth,5),wsmiddotWidth:Math.max(i.wsmiddotWidth,5),maxDigitWidth:Math.max(i.maxDigitWidth,5)},!1)),this._writeToCache(e,t,i)}return n.get(t)}_createRequest(e,t,n,i){let r=new DS(e,t);return n.push(r),i?.push(r),r}_actualReadFontInfo(e,t){let n=[],i=[],r=this._createRequest("n",0,n,i),s=this._createRequest("\uFF4D",0,n,null),a=this._createRequest(" ",0,n,i),l=this._createRequest("0",0,n,i),d=this._createRequest("1",0,n,i),c=this._createRequest("2",0,n,i),u=this._createRequest("3",0,n,i),h=this._createRequest("4",0,n,i),m=this._createRequest("5",0,n,i),g=this._createRequest("6",0,n,i),f=this._createRequest("7",0,n,i),b=this._createRequest("8",0,n,i),y=this._createRequest("9",0,n,i),C=this._createRequest("\u2192",0,n,i),S=this._createRequest("\uFFEB",0,n,null),w=this._createRequest("\xB7",0,n,i),R=this._createRequest("\u2E31",0,n,null),M="|/-_ilm%";for(let j=0,X=M.length;j<X;j++)this._createRequest(M.charAt(j),0,n,i),this._createRequest(M.charAt(j),1,n,i),this._createRequest(M.charAt(j),2,n,i);eV(e,t,n);let N=Math.max(l.width,d.width,c.width,u.width,h.width,m.width,g.width,f.width,b.width,y.width),A=t.fontFeatureSettings===Nc.OFF,P=i[0].width;for(let j=1,X=i.length;A&&j<X;j++){let le=P-i[j].width;if(le<-.001||le>.001){A=!1;break}}let K=!0;return A&&S.width!==P&&(K=!1),S.width>C.width&&(K=!1),new Ch({pixelRatio:Np.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:A,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:K,spaceWidth:a.width,middotWidth:w.width,wsmiddotWidth:R.width,maxDigitWidth:N},!0)}},A0=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId();return!!this._values[t]}get(e){let t=e.getId();return this._values[t]}put(e,t){let n=e.getId();this._keys[n]=e,this._values[n]=t}remove(e){let t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}},O0=new N0;var Sb=class o{constructor(e,t){this.key=e;this.migrate=t}static items=[];apply(e){let t=o._read(e,this.key),n=r=>o._read(e,r),i=(r,s)=>o._write(e,r,s);this.migrate(t,n,i)}static _read(e,t){if(typeof e>"u")return;let n=t.indexOf(".");if(n>=0){let i=t.substring(0,n);return this._read(e[i],t.substring(n+1))}return e[t]}static _write(e,t,n){let i=t.indexOf(".");if(i>=0){let r=t.substring(0,i);e[r]=e[r]||{},this._write(e[r],t.substring(i+1),n);return}e[t]=n}};function As(o,e){Sb.items.push(new Sb(o,e))}function zo(o,e){As(o,(t,n,i)=>{if(typeof t<"u"){for(let[r,s]of e)if(t===r){i(o,s);return}}})}function tV(o){Sb.items.forEach(e=>e.apply(o))}zo("wordWrap",[[!0,"on"],[!1,"off"]]);zo("lineNumbers",[[!0,"on"],[!1,"off"]]);zo("cursorBlinking",[["visible","solid"]]);zo("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);zo("renderLineHighlight",[[!0,"line"],[!1,"none"]]);zo("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);zo("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);zo("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);zo("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);zo("autoIndent",[[!1,"advanced"],[!0,"full"]]);zo("matchBrackets",[[!0,"always"],[!1,"never"]]);zo("renderFinalNewline",[[!0,"on"],[!1,"off"]]);zo("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);zo("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);zo("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);As("autoClosingBrackets",(o,e,t)=>{o===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});As("renderIndentGuides",(o,e,t)=>{typeof o<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!o))});As("highlightActiveIndentGuide",(o,e,t)=>{typeof o<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!o))});var c9={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};As("suggest.filteredTypes",(o,e,t)=>{if(o&&typeof o=="object"){for(let n of Object.entries(c9))o[n[0]]===!1&&typeof e(`suggest.${n[1]}`)>"u"&&t(`suggest.${n[1]}`,!1);t("suggest.filteredTypes",void 0)}});As("quickSuggestions",(o,e,t)=>{if(typeof o=="boolean"){let n=o?"on":"off";t("quickSuggestions",{comments:n,strings:n,other:n})}});As("experimental.stickyScroll.enabled",(o,e,t)=>{typeof o=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",o))});As("experimental.stickyScroll.maxLineCount",(o,e,t)=>{typeof o=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",o))});As("codeActionsOnSave",(o,e,t)=>{if(o&&typeof o=="object"){let n=!1,i={};for(let r of Object.entries(o))typeof r[1]=="boolean"?(n=!0,i[r[0]]=r[1]?"explicit":"never"):i[r[0]]=r[1];n&&t("codeActionsOnSave",i)}});As("codeActionWidget.includeNearbyQuickfixes",(o,e,t)=>{typeof o=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",o))});As("lightbulb.enabled",(o,e,t)=>{typeof o=="boolean"&&t("lightbulb.enabled",o?void 0:"off")});var P0=class{_tabFocus=!1;_onDidChangeTabFocus=new T;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}},Ap=new P0;var Op=class extends B{constructor(t,n,i,r,s){super();this._accessibilityService=s;this.isSimpleWidget=t,this.contextMenuId=n,this._containerObserver=this._register(new LS(r,i.dimension)),this._targetWindowId=Ce(r).vscodeWindowId,this._rawOptions=nV(i),this._validatedOptions=hu.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(oa.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(Ap.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(O0.onDidChange(()=>this._recomputeOptions())),this._register(Np.getInstance(Ce(r)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new T);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new Xg;_rawOptions;_validatedOptions;options;_recomputeOptions(){let t=this._computeOptions(),n=hu.checkEquals(this.options,t);n!==null&&(this.options=t,this._onDidChangeFast.fire(n),this._onDidChange.fire(n))}_computeOptions(){let t=this._readEnvConfiguration(),n=qg.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(n),r={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:Ap.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return hu.computeOptions(this._validatedOptions,r)}_readEnvConfiguration(){return{extraEditorClassName:h9(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Ls||Bn,pixelRatio:Np.getInstance(Jc(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return O0.readFontInfo(Jc(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){let n=nV(t);hu.applyUpdate(this._rawOptions,n)&&(this._validatedOptions=hu.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){let n=u9(t);this._lineNumbersDigitCount!==n&&(this._lineNumbersDigitCount=n,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};Op=k([E(4,Jo)],Op);function u9(o){let e=0;for(;o;)o=Math.floor(o/10),e++;return e||1}function h9(){let o="";return!Bo&&!bB&&(o+="no-user-select "),Bo&&(o+="no-minimap-shadow ",o+="enable-user-select "),Fe&&(o+="mac "),o}var F0=class{_values=[];_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}},B0=class{_values=[];_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}},hu=class o{static validateOptions(e){let t=new F0;for(let n of _h){let i=n.name==="_never_"?void 0:e[n.name];t._write(n.id,n.validate(i))}return t}static computeOptions(e,t){let n=new B0;for(let i of _h)n._write(i.id,i.compute(t,n,e._read(i.id)));return n}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?Lt(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!o._deepEquals(e[n],t[n]))return!1;return!0}static checkEquals(e,t){let n=[],i=!1;for(let r of _h){let s=!o._deepEquals(e._read(r.id),t._read(r.id));n[r.id]=s,s&&(i=!0)}return i?new _y(n):null}static applyUpdate(e,t){let n=!1;for(let i of _h)if(t.hasOwnProperty(i.name)){let r=i.applyUpdate(e[i.name],t[i.name]);e[i.name]=r.newValue,n=n||r.didChange}return n}};function nV(o){let e=Ih(o);return tV(e),e}var Tl=class{constructor(e,t,n,i,r){this.injectionOffsets=e;this.injectionOptions=t;this.breakOffsets=n;this.breakOffsetsVisibleColumn=i;this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){let t=e>0?this.breakOffsets[e-1]:0,i=this.breakOffsets[e]-t;return e>0&&(i+=this.wrappedTextIndentLength),i}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let i=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&i>this.injectionOffsets[r];r++)i<this.injectionOffsets[r]+this.injectionOptions[r].content.length?i=this.injectionOffsets[r]:i-=this.injectionOptions[r].content.length;return i}translateToOutputPosition(e,t=2){let n=e;if(this.injectionOffsets!==null)for(let i=0;i<this.injectionOffsets.length&&!(e<this.injectionOffsets[i]||t!==1&&e===this.injectionOffsets[i]);i++)n+=this.injectionOptions[i].content.length;return this.offsetInInputWithInjectionsToOutputPosition(n,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let n=0,i=this.breakOffsets.length-1,r=0,s=0;for(;n<=i;){r=n+(i-n)/2|0;let l=this.breakOffsets[r];if(s=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=s)i=r-1;else if(e>l)n=r+1;else break;else if(e<s)i=r-1;else if(e>=l)n=r+1;else break}let a=e-s;return r>0&&(a+=this.wrappedTextIndentLength),new Pp(r,a)}normalizeOutputPosition(e,t,n){if(this.injectionOffsets!==null){let i=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(i,n);if(r!==i)return this.offsetInInputWithInjectionsToOutputPosition(r,n)}if(n===0){if(e>0&&t===this.getMinOutputOffset(e))return new Pp(e-1,this.getMaxOutputOffset(e-1))}else if(n===1){let i=this.getOutputLineCount()-1;if(e<i&&t===this.getMaxOutputOffset(e))return new Pp(e+1,this.getMinOutputOffset(e+1))}return new Pp(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){let n=this.getInjectedTextAtOffset(e);if(!n)return e;if(t===2){if(e===n.offsetInInputWithInjections+n.length&&iV(this.injectionOptions[n.injectedTextIndex].cursorStops))return n.offsetInInputWithInjections+n.length;{let i=n.offsetInInputWithInjections;if(oV(this.injectionOptions[n.injectedTextIndex].cursorStops))return i;let r=n.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[n.injectedTextIndex]&&!(iV(this.injectionOptions[r].cursorStops)||(i-=this.injectionOptions[r].content.length,oV(this.injectionOptions[r].cursorStops)));)r--;return i}}else if(t===1||t===4){let i=n.offsetInInputWithInjections+n.length,r=n.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)i+=this.injectionOptions[r+1].content.length,r++;return i}else if(t===0||t===3){let i=n.offsetInInputWithInjections,r=n.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)i-=this.injectionOptions[r-1].content.length,r--;return i}hg(t)}getInjectedText(e,t){let n=this.outputPositionToOffsetInInputWithInjections(e,t),i=this.getInjectedTextAtOffset(n);return i?{options:this.injectionOptions[i.injectedTextIndex]}:null}getInjectedTextAtOffset(e){let t=this.injectionOffsets,n=this.injectionOptions;if(t!==null){let i=0;for(let r=0;r<t.length;r++){let s=n[r].content.length,a=t[r]+i,l=t[r]+i+s;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:s};i+=s}}}};function iV(o){return o==null?!0:o===1||o===0}function oV(o){return o==null?!0:o===2||o===0}var Pp=class{outputLineIndex;outputOffset;constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new V(e+this.outputLineIndex,this.outputOffset+1)}};var m9=()=>!0,g9=()=>!1,f9=o=>o===" "||o==="	",Ll=class{constructor(e,t,n,i){this.languageConfigurationService=i;this._languageId=e;let r=n.options,s=r.get(147),a=r.get(51);this.readOnly=r.get(93),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=r.get(130),this.wordSeparators=r.get(133),this.emptySelectionClipboard=r.get(38),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(78),this.multiCursorPaste=r.get(80),this.multiCursorLimit=r.get(81),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.wordSegmenterLocales=r.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(e){return e.hasChanged(147)||e.hasChanged(133)||e.hasChanged(38)||e.hasChanged(78)||e.hasChanged(80)||e.hasChanged(81)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(130)||e.hasChanged(51)||e.hasChanged(93)||e.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(let t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,n){let i=ha(t,n-1),r=this.languageConfigurationService.getLanguageConfiguration(i.languageId).electricCharacter;return r?r.onElectricCharacter(e,i,n-i.firstCharOffset):null}normalizeIndentation(e){return xI(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,n){switch(t){case"beforeWhitespace":return f9;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,n);case"always":return m9;case"never":return g9}}_getLanguageDefinedShouldAutoClose(e,t){let n=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return i=>n.indexOf(i)!==-1}visibleColumnFromColumn(e,t){return Rt.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,n){let i=Rt.columnFromVisibleColumn(e.getLineContent(t),n,this.tabSize),r=e.getLineMinColumn(t);if(i<r)return r;let s=e.getLineMaxColumn(t);return i>s?s:i}},Ke=class o{_cursorStateBrand=void 0;static fromModelState(e){return new V0(e)}static fromViewState(e){return new W0(e)}static fromModelSelection(e){let t=Ue.liftSelection(e),n=new Sn(L.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return o.fromModelState(n)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}modelState;viewState;constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}},V0=class{modelState;viewState;constructor(e){this.modelState=e,this.viewState=null}},W0=class{modelState;viewState;constructor(e){this.modelState=null,this.viewState=e}};var Sn=class o{constructor(e,t,n,i,r){this.selectionStart=e;this.selectionStartKind=t;this.selectionStartLeftoverVisibleColumns=n;this.position=i;this.leftoverVisibleColumns=r;this.selection=o._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new o(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new V(t,n),i):new o(new L(t,n,t,n),0,i,new V(t,n),i)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?Ue.fromPositions(e.getStartPosition(),t):Ue.fromPositions(e.getEndPosition(),t)}},Wn=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(e,t,n){this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}};function Os(o){return o==="'"||o==='"'||o==="`"}var RS=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}};var kS=class{type=0;constructor(){}},MS=class{type=1;constructor(){}},NS=class{type=2;_source;constructor(e){this._source=e}hasChanged(e){return this._source.hasChanged(e)}},AS=class{constructor(e,t,n){this.selections=e;this.modelSelections=t;this.reason=n}type=3},Fa=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(e){e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},mu=class{type=5;constructor(){}},OS=class{type=6;isFocused;constructor(e){this.isFocused=e}},PS=class{type=7},gu=class{type=8;constructor(){}},xb=class{constructor(e,t){this.fromLineNumber=e;this.count=t}type=9},Fp=class{type=10;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},Bp=class{type=11;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}};var Dl=class{constructor(e,t,n,i,r,s,a){this.source=e;this.minimalReveal=t;this.range=n;this.selections=i;this.verticalType=r;this.revealHorizontal=s;this.scrollType=a}type=12},FS=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e){this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}},BS=class{constructor(e){this.theme=e}type=14},VS=class{type=15;ranges;constructor(e){this.ranges=e}},WS=class{type=16;constructor(){}},HS=class{type=17;constructor(){}};var ts=class extends B{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let n=0,i=e.length;n<i;n++){let r=e[n];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}};var Eb=class{_viewportBrand=void 0;top;left;width;height;constructor(e,t,n,i){this.top=e|0,this.left=t|0,this.width=n|0,this.height=i|0}},US=class{tabSize;data;constructor(e,t){this.tabSize=e,this.data=t}},fu=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(e,t,n,i,r,s,a){this.content=e,this.continuesWithWrappedLine=t,this.minColumn=n,this.maxColumn=i,this.startVisibleColumn=r,this.tokens=s,this.inlineDecorations=a}},zS=class o{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(e,t,n,i,r,s,a,l,d,c){this.minColumn=e,this.maxColumn=t,this.content=n,this.continuesWithWrappedLine=i,this.isBasicASCII=o.isBasicASCII(n,s),this.containsRTL=o.containsRTL(n,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(e,t){return t?_g(e):!0}static containsRTL(e,t,n){return!t&&n?nl(e):!1}};var bu=class{constructor(e,t,n){this.range=e;this.inlineClassName=t;this.type=n}},KS=class{constructor(e,t,n,i){this.startOffset=e;this.endOffset=t;this.inlineClassName=n;this.inlineClassNameAffectsLetterSpacing=i}toInlineDecoration(e){return new bu(new L(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},Wp=class{_viewModelDecorationBrand=void 0;range;options;constructor(e,t){this.range=e,this.options=t}},vu=class o{constructor(e,t,n){this.color=e;this.zIndex=t;this.data=n}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&Lt(e.data,t.data)}static equalsArr(e,t){return Lt(e,t,o.equals)}};var GS=class{_colorZoneBrand=void 0;from;to;colorId;constructor(e,t,n){this.from=e|0,this.to=t|0,this.colorId=n|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}},H0=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(e,t,n,i){this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=n,this.color=i,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}},jS=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(H0.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),n=Math.floor(this.getCanvasHeight()),i=Math.floor(this._outerHeight),r=n/i,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!e){let w=c.getColorZones();if(w){a.push(w);continue}}let u=this._getVerticalOffsetForLine(c.startLineNumber),h=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+t:u+c.heightInLines*t,m=Math.floor(r*u),g=Math.floor(r*h),f=Math.floor((m+g)/2),b=g-f;b<s&&(b=s),f-b<0&&(f=b),f+b>n&&(f=n-b);let y=c.color,C=this._color2Id[y];C||(C=++this._lastAssignedId,this._color2Id[y]=C,this._id2Color[C]=y);let S=new GS(f-b,f+b,C);c.setColorZone(S),a.push(S)}return this._colorZonesInvalid=!1,a.sort(GS.compare),a}};var en=class o{constructor(e,t){this.startLineNumber=e;this.lineCount=t;if(t<0)throw new Te}static compareByStart=ui(e=>e.startLineNumber,Ya);static join(e){if(e.length===0)return;let t=Number.MAX_SAFE_INTEGER,n=0;for(let i of e)t=Math.min(t,i.startLineNumber),n=Math.max(n,i.startLineNumber+i.lineCount);return new o(t,n-t)}static fromLineNumbers(e,t){return new o(e,t-e)}join(e){return new o(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive)-this.startLineNumber)}get endLineNumberExclusive(){return this.startLineNumber+this.lineCount}get isEmpty(){return this.lineCount===0}touches(e){return this.endLineNumberExclusive>=e.startLineNumber&&e.endLineNumberExclusive>=this.startLineNumber}isAfter(e){return this.startLineNumber>=e.endLineNumberExclusive}isBefore(e){return e.startLineNumber>=this.endLineNumberExclusive}delta(e){return new o(this.startLineNumber+e,this.lineCount)}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}equals(e){return this.startLineNumber===e.startLineNumber&&this.lineCount===e.lineCount}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}deltaEnd(e){return new o(this.startLineNumber,this.lineCount+e)}deltaStart(e){return new o(this.startLineNumber+e,this.lineCount-e)}getLines(e){let t=new Array(this.lineCount);for(let n=0;n<this.lineCount;n++)t[n]=e.getLineContent(this.startLineNumber+n);return t}containsRange(e){return this.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=this.endLineNumberExclusive}toRange(){return new L(this.startLineNumber,1,this.endLineNumberExclusive,1)}toInclusiveRange(){if(!this.isEmpty)return new L(this.startLineNumber,1,this.endLineNumberExclusive-1,1073741824)}toInclusiveRangeOrEmpty(){return this.isEmpty?new L(this.startLineNumber,1,this.startLineNumber,1):new L(this.startLineNumber,1,this.endLineNumberExclusive-1,1073741824)}intersects(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}};var snt=new RegExp("\\bMARK:\\s*(.*)$","d");var rV=Z("editorWorkerService");var sV=Z("markerDecorationsService");var yo=Z("codeEditorService");var yu=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let t of e){let n=t.kbExpr;this.precondition&&(n?n=ht.and(n,this.precondition):n=this.precondition);let i={id:this.id,weight:t.weight,args:t.args,when:n,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};dd.registerKeybindingRule(i)}}$i.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){Qo.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}},wb=class extends yu{_implementations=[];addImplementation(e,t,n,i){return this._implementations.push({priority:e,name:t,implementation:n,when:i}),this._implementations.sort((r,s)=>s.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===n){this._implementations.splice(r,1);return}}}}runCommand(e,t){let n=e.get(Fn),i=e.get(Qt);n.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let r of this._implementations){if(r.when){let a=i.getContext(Wo());if(!r.when.evaluate(a))continue}let s=r.implementation(e,t);if(s)return n.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof s=="boolean"?void 0:s}n.trace(`The Command '${this.id}' was not handled by any implementation.`)}},$S=class extends yu{constructor(t,n){super(n);this.command=t}runCommand(t,n){return this.command.runCommand(t,n)}},Hp=class o extends yu{static bindToContribution(e){return class extends o{_callback;constructor(n){super(n),this._callback=n.handler}runEditorCommand(n,i,r){let s=e(i);s&&this._callback(s,r)}}}static runEditorCommand(e,t,n,i){let r=e.get(yo),s=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(Qt).contextMatchesRules(n??void 0))return i(a,s,t)})}runCommand(e,t){return o.runEditorCommand(e,t,this.precondition,(n,i,r)=>this.runEditorCommand(n,i,r))}},qd=class o extends Hp{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function n(i){return i.menuId||(i.menuId=ot.EditorContext),i.title||(i.title=e.label),i.when=ht.and(e.precondition,i.when),i}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(n)):e.contextMenuOpts&&t.push(n(e.contextMenuOpts)),e.menuOpts=t,e}label;alias;constructor(e){super(o.convertOptions(e)),this.label=e.label,this.alias=e.alias}runEditorCommand(e,t,n){return this.reportTelemetry(e,t),this.run(e,t,n||{})}reportTelemetry(e,t){e.get(Ao).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}};function He(o){return Vr.INSTANCE.registerEditorCommand(o),o}function kn(o){let e=new o;return Vr.INSTANCE.registerEditorAction(e),e}function aV(o){Vr.INSTANCE.registerEditorAction(o)}function Yd(o,e,t){Vr.INSTANCE.registerEditorContribution(o,e,t)}function lV(o,e){Vr.INSTANCE.registerDiffEditorContribution(o,e)}var Iu;(r=>{function o(s){return Vr.INSTANCE.getEditorCommand(s)}r.getEditorCommand=o;function e(){return Vr.INSTANCE.getEditorActions()}r.getEditorActions=e;function t(){return Vr.INSTANCE.getEditorContributions()}r.getEditorContributions=t;function n(s){return Vr.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}r.getSomeEditorContributions=n;function i(){return Vr.INSTANCE.getDiffEditorContributions()}r.getDiffEditorContributions=i})(Iu||={});var b9={EditorCommonContributions:"editor.contributions"},Vr=class o{static INSTANCE=new o;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(e,t,n){this.editorContributions.push({id:e,ctor:t,instantiation:n})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(e,t){this.diffEditorContributions.push({id:e,ctor:t})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};Je.add(b9.EditorCommonContributions,Vr.INSTANCE);function _b(o){return o.register(),o}var z0=_b(new wb({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:ot.MenubarEditMenu,group:"1_do",title:p({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:ot.CommandPalette,group:"",title:p("undo","Undo"),order:1}]}));_b(new $S(z0,{id:"default:undo",precondition:void 0}));var K0=_b(new wb({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:ot.MenubarEditMenu,group:"1_do",title:p({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:ot.CommandPalette,group:"",title:p("redo","Redo"),order:1}]}));_b(new $S(K0,{id:"default:redo",precondition:void 0}));var dV=_b(new wb({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:ot.MenubarSelectionMenu,group:"1_basic",title:p({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:ot.CommandPalette,group:"",title:p("selectAll","Select All"),order:1}]}));var Up=class{static ID="editor.contrib.markerDecorations";constructor(e,t){}dispose(){}};Up=k([E(1,sV)],Up);Yd(Up.ID,Up,0);var Rl;(N=>{let o={total:0,min:Number.MAX_VALUE,max:0},e={...o},t={...o},n={...o},i=0,r;(j=>(j[j.Before=0]="Before",j[j.InProgress=1]="InProgress",j[j.Finished=2]="Finished"))(r||={});let s={keydown:0,input:0,render:0};function a(){y(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}N.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,b()}N.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(u)}N.onInput=c;function u(){s.input===1&&(performance.mark("input/end"),s.input=2)}function h(){y()}N.onKeyUp=h;function m(){y()}N.onSelectionChange=m;function g(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(f),b())}N.onRenderStart=g;function f(){s.render===1&&(performance.mark("render/end"),s.render=2)}function b(){setTimeout(y)}function y(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),C("keydown",o),C("input",e),C("render",t),C("inputlatency",n),i++,S())}function C(A,P){let K=performance.getEntriesByName(A)[0].duration;P.total+=K,P.min=Math.min(P.min,K),P.max=Math.max(P.max,K)}function S(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function w(){if(i===0)return;let A={keydown:R(o),input:R(e),render:R(t),total:R(n),sampleCount:i};return M(o),M(e),M(t),M(n),i=0,A}N.getAndClearMeasurements=w;function R(A){return{average:A.total/i,max:A.max,min:A.min}}function M(A){A.total=0,A.min=Number.MAX_VALUE,A.max=0}})(Rl||={});var Zd=class{constructor(e,t){this.x=e;this.y=t}_pageCoordinatesBrand=void 0;toClientCoordinates(e){return new Tb(this.x-e.scrollX,this.y-e.scrollY)}},Tb=class{constructor(e,t){this.clientX=e;this.clientY=t}_clientCoordinatesBrand=void 0;toPageCoordinates(e){return new Zd(this.clientX+e.scrollX,this.clientY+e.scrollY)}},G0=class{constructor(e,t,n,i){this.x=e;this.y=t;this.width=n;this.height=i}_editorPagePositionBrand=void 0},j0=class{constructor(e,t){this.x=e;this.y=t}_positionRelativeToEditorBrand=void 0};function QS(o){let e=cr(o);return new G0(e.left,e.top,e.width,e.height)}function JS(o,e,t){let n=e.width/o.offsetWidth,i=e.height/o.offsetHeight,r=(t.x-e.x)/n,s=(t.y-e.y)/i;return new j0(r,s)}var ns=class extends Fi{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(e,t,n){super(Ce(n),e),this.isFromPointerCapture=t,this.pos=new Zd(this.posx,this.posy),this.editorPos=QS(n),this.relativePos=JS(n,this.editorPos,this.pos)}},YS=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new ns(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return z(e,"contextmenu",n=>{t(this._create(n))})}onMouseUp(e,t){return z(e,"mouseup",n=>{t(this._create(n))})}onMouseDown(e,t){return z(e,me.MOUSE_DOWN,n=>{t(this._create(n))})}onPointerDown(e,t){return z(e,me.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onMouseLeave(e,t){return z(e,me.MOUSE_LEAVE,n=>{t(this._create(n))})}onMouseMove(e,t){return z(e,"mousemove",n=>t(this._create(n)))}},ZS=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new ns(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return z(e,"pointerup",n=>{t(this._create(n))})}onPointerDown(e,t){return z(e,me.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onPointerLeave(e,t){return z(e,me.POINTER_LEAVE,n=>{t(this._create(n))})}onPointerMove(e,t){return z(e,"pointermove",n=>t(this._create(n)))}},XS=class extends B{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new ka),this._keydownListener=null}startMonitoring(e,t,n,i,r){this._keydownListener=Bi(e.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,n,s=>{i(new ns(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),r(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var ex=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(e,t,n,i){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=n,this._model=i,this.visibleRange=new L(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var $0=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let n=this._viewLayout.getCurrentViewport();this.scrollTop=n.top,this.scrollLeft=n.left,this.viewportWidth=n.width,this.viewportHeight=n.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},tx=class extends $0{_renderingContextBrand=void 0;_viewLines;constructor(e,t,n){super(e,t),this._viewLines=n}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}},nx=class{constructor(e,t,n,i){this.outsideRenderedLine=e;this.lineNumber=t;this.ranges=n;this.continuesOnNextLine=i}static firstLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber<t.lineNumber)&&(t=n);return t}static lastLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber>t.lineNumber)&&(t=n);return t}},zp=class o{_horizontalRangeBrand=void 0;left;width;static from(e){let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=new o(r.left,r.width)}return t}constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}},Ps=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}},ix=class{outsideRenderedLine;left;originalLeft;constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}},Lb=class{constructor(e,t){this.outsideRenderedLine=e;this.ranges=t}};var ox=class{configuration;viewModel;viewLayout;theme;constructor(e,t,n){this.configuration=e,this.theme=new RS(t),this.viewModel=n,this.viewLayout=n.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}};var Bt=class extends ts{_context;constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var Xn=class{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let n=[],i=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(n[i++]=this.read(e)),e=e.parentElement;let r=new Uint8Array(i);for(let s=0;s<i;s++)r[s]=n[i-s-1];return r}};function rx(o,e){let t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(o,e)}catch(n){Ne(n);return}try{return globalThis.trustedTypes?.createPolicy(o,e)}catch(n){Ne(n);return}}var Db=class{constructor(e){this._lineFactory=e;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Te("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;let n=this.getStartLineNumber(),i=this.getEndLineNumber();if(t<n){let l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>i)return null;let r=0,s=0;for(let l=n;l<=i;l++){let d=l-this._rendLineNumberStart;e<=l&&l<=t&&(s===0?(r=d,s=1):s++)}if(e<n){let l=0;t<n?l=t-e+1:l=n-e,this._rendLineNumberStart-=l}return this._lines.splice(r,s)}onLinesChanged(e,t){let n=e+t-1;if(this.getCount()===0)return!1;let i=this.getStartLineNumber(),r=this.getEndLineNumber(),s=!1;for(let a=e;a<=n;a++)a>=i&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;let n=t-e+1,i=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=i)return this._rendLineNumberStart+=n,null;if(e>r)return null;if(n+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);let s=[];for(let u=0;u<n;u++)s[u]=this._lineFactory.createLine();let a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-n),c=this._lines.slice(this._lines.length-n,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(e){if(this.getCount()===0)return!1;let t=this.getStartLineNumber(),n=this.getEndLineNumber(),i=!1;for(let r=0,s=e.length;r<s;r++){let a=e[r];if(a.toLineNumber<t||a.fromLineNumber>n)continue;let l=Math.max(t,a.fromLineNumber),d=Math.min(n,a.toLineNumber);for(let c=l;c<=d;c++){let u=c-this._rendLineNumberStart;this._lines[u].onTokensChanged(),i=!0}}return i}},Kp=class{constructor(e){this._lineFactory=e}domNode=this._createDomNode();_linesCollection=new Db(this._lineFactory);_createDomNode(){let e=Be(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(147)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),n=new q0(this.domNode.domNode,this._lineFactory,e),i={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=n.render(i,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}},q0=class o{constructor(e,t,n){this._domNode=e;this._lineFactory=t;this._viewportData=n}static _ttPolicy=rx("editorViewLayer",{createHTML:e=>e});render(e,t,n,i){let r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||n<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=n-t+1,r.lines=[];for(let s=t;s<=n;s++)r.lines[s-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,i),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(n-r.rendLineNumberStart,r.linesLength-1),i,t),r.rendLineNumberStart>t){let s=t,a=Math.min(n,r.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart<t){let s=Math.min(r.linesLength,t-r.rendLineNumberStart);s>0&&(this._removeLinesBefore(r,s),r.linesLength-=s)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<n){let s=r.rendLineNumberStart+r.linesLength,a=n;s<=a&&(this._insertLinesAfter(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart+r.linesLength-1>n){let s=Math.max(0,n-r.rendLineNumberStart+1),l=r.linesLength-1-s+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,i),r}_renderUntouchedLines(e,t,n,i,r){let s=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=n;l++){let d=s+l;a[l].layoutLine(d,i[d-r],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let n=0;n<t;n++)e.lines[n].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){let n=e.linesLength-t;for(let i=0;i<t;i++)e.lines[n+i].getDomNode()?.remove();e.lines.splice(n,t)}_finishRenderingNewLines(e,t,n,i){o._ttPolicy&&(n=o._ttPolicy.createHTML(n));let r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=n:r.insertAdjacentHTML("afterend",n);let s=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){let l=e.lines[a];i[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,n){let i=document.createElement("div");o._ttPolicy&&(t=o._ttPolicy.createHTML(t)),i.innerHTML=t;for(let r=0;r<e.linesLength;r++){let s=e.lines[r];if(n[r]){let a=i.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new Oc(1e5);_finishRendering(e,t,n){let i=o._sb,r=e.linesLength,s=e.lines,a=e.rendLineNumberStart,l=[];{i.reset();let d=!1;for(let c=0;c<r;c++){let u=s[c];l[c]=!1,!(u.getDomNode()||!u.renderLine(c+a,n[c],this._viewportData.lineHeight,this._viewportData,i))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,i.build(),l)}{i.reset();let d=!1,c=[];for(let u=0;u<r;u++){let h=s[u];c[u]=!1,!(l[u]||!h.renderLine(u+a,n[u],this._viewportData.lineHeight,this._viewportData,i))&&(c[u]=!0,d=!0)}d&&this._finishRenderingInvalidLines(e,i.build(),c)}}};var Gp=class{constructor(e,t){this._domNode=e;this.endNode=t}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var Cu=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,n,i,r){let s=this._createRange();try{return s.setStart(e,t),s.setEnd(n,i),s.getClientRects()}catch{return null}finally{this._detachRange(s,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Ps.compare);let t=[],n=0,i=e[0];for(let r=1,s=e.length;r<s;r++){let a=e[r];i.left+i.width+.9>=a.left?i.width=Math.max(i.width,a.left+a.width-i.left):(t[n++]=i,i=a)}return t[n++]=i,t}static _createHorizontalRangesFromClientRects(e,t,n){if(!e||e.length===0)return null;let i=[];for(let r=0,s=e.length;r<s;r++){let a=e[r];i[r]=new Ps(Math.max(0,(a.left-t)/n),a.width/n)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,n,i,r,s){let l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),i=Math.min(l,Math.max(0,i)),t===i&&n===r&&n===0&&!e.children[t].firstChild){let h=e.children[t].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,s.clientRectDeltaLeft,s.clientRectScale)}t!==i&&i>0&&r===0&&(i--,r=1073741824);let d=e.children[t].firstChild,c=e.children[i].firstChild;if((!d||!c)&&(!d&&n===0&&t>0&&(d=e.children[t-1].firstChild,n=1073741824),!c&&r===0&&i>0&&(c=e.children[i-1].firstChild,r=1073741824)),!d||!c)return null;n=Math.min(d.textContent.length,Math.max(0,n)),r=Math.min(c.textContent.length,Math.max(0,r));let u=this._readClientRects(d,n,c,r,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,s.clientRectDeltaLeft,s.clientRectScale)}};var mn=class{constructor(e,t,n,i){this.endIndex=e;this.type=t;this.metadata=n;this.containsRTL=i}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var kl=class o{constructor(e,t,n,i){this.startColumn=e;this.endColumn=t;this.className=n;this.type=i}_lineDecorationBrand=void 0;static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!o._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,n){if(e.length===0)return e;let i=t+1,r=n+1,s=n-t,a=[],l=0;for(let d of e)d.endColumn<=i||d.startColumn>=r||(a[l++]=new o(Math.max(1,d.startColumn-i+1),Math.min(s+1,d.endColumn-i+1),d.className,d.type));return a}static filter(e,t,n,i){if(e.length===0)return[];let r=[],s=0;for(let a=0,l=e.length;a<l;a++){let d=e[a],c=d.range;if(c.endLineNumber<t||c.startLineNumber>t||c.isEmpty()&&(d.type===0||d.type===3))continue;let u=c.startLineNumber===t?c.startColumn:n,h=c.endLineNumber===t?c.endColumn:i;r[s++]=new o(u,h,d.inlineClassName,d.type)}return r}static _typeCompare(e,t){let n=[2,0,1,3];return n[e]-n[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;let n=o._typeCompare(e.type,t.type);return n!==0?n:e.className!==t.className?e.className<t.className?-1:1:0}},sx=class{startOffset;endOffset;className;metadata;constructor(e,t,n,i){this.startOffset=e,this.endOffset=t,this.className=n,this.metadata=i}},Y0=class o{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let n=0,i=e.length;n<i;n++)t|=e[n];return t}consumeLowerThan(e,t,n){for(;this.count>0&&this.stopOffsets[0]<e;){let i=0;for(;i+1<this.count&&this.stopOffsets[i]===this.stopOffsets[i+1];)i++;n.push(new sx(t,this.stopOffsets[i],this.classNames.join(" "),o._metadata(this.metadata))),t=this.stopOffsets[i]+1,this.stopOffsets.splice(0,i+1),this.classNames.splice(0,i+1),this.metadata.splice(0,i+1),this.count-=i+1}return this.count>0&&t<e&&(n.push(new sx(t,e-1,this.classNames.join(" "),o._metadata(this.metadata))),t=e),t}insert(e,t,n){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(n);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t),this.metadata.splice(i,0,n);break}this.count++}},ax=class{static normalize(e,t){if(t.length===0)return[];let n=[],i=new Y0,r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.startColumn,c=l.endColumn,u=l.className,h=l.type===1?2:l.type===2?4:0;if(d>1){let f=e.charCodeAt(d-2);qt(f)&&d--}if(c>1){let f=e.charCodeAt(c-2);qt(f)&&c--}let m=d-1,g=c-2;r=i.consumeLowerThan(m,r,n),i.count===0&&(r=m),i.insert(g,u,h)}return i.consumeLowerThan(1073741824,r,n),n}};var jp=class{startOffset;endOffset;constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}},lx=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(e,t,n,i,r,s,a,l,d,c,u,h,m,g,f,b,y,C,S){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.continuesWithWrappedLine=i,this.isBasicASCII=r,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(kl.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=h,this.stopRenderingLineAfter=f,this.renderWhitespace=b==="all"?4:b==="boundary"?1:b==="selection"?2:b==="trailing"?3:0,this.renderControlCharacters=y,this.fontLigatures=C,this.selectionsOnLine=S&&S.sort((M,N)=>M.startOffset<N.startOffset?-1:1);let w=Math.abs(g-h),R=Math.abs(m-h);w<R?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=m,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&kl.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}};var Rb=class{constructor(e,t){this.partIndex=e;this.charIndex=t}},kb=class o{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}length;_data;_horizontalOffset;constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,n,i){let r=(t<<16|n<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=i}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){let t=this.charOffsetToPartData(e-1),n=o.getPartIndex(t),i=o.getCharIndex(t);return new Rb(n,i)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,n){if(this.length===0)return 0;let i=(e<<16|n<<0)>>>0,r=0,s=this.length-1;for(;r+1<s;){let f=r+s>>>1,b=this._data[f];if(b===i)return f;b>i?s=f:r=f}if(r===s)return r;let a=this._data[r],l=this._data[s];if(a===i)return r;if(l===i)return s;let d=o.getPartIndex(a),c=o.getCharIndex(a),u=o.getPartIndex(l),h;d!==u?h=t:h=o.getCharIndex(l);let m=n-c,g=h-n;return m<=g?r:s}inflate(){let e=[];for(let t=0;t<this.length;t++){let n=this._data[t],i=o.getPartIndex(n),r=o.getCharIndex(n),s=this._horizontalOffset[t];e.push([i,r,s])}return e}};var Mb=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(e,t,n){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=n}};function cV(o,e){if(o.lineContent.length===0){if(o.lineDecorations.length>0){e.appendString("<span>");let t=0,n=0,i=0;for(let s of o.lineDecorations)(s.type===1||s.type===2)&&(e.appendString('<span class="'),e.appendString(s.className),e.appendString('"></span>'),s.type===1&&(i|=1,t++),s.type===2&&(i|=2,n++));e.appendString("</span>");let r=new kb(1,t+n);return r.setColumnInfo(1,t,0,0),new Mb(r,!1,i)}return e.appendString("<span><span></span></span>"),new Mb(new kb(0,0),!1,0)}return w9(y9(o),e)}var X0=class{constructor(e,t,n,i,r,s,a,l,d,c,u,h,m,g,f,b){this.fontIsMonospace=e;this.canUseHalfwidthRightwardsArrow=t;this.lineContent=n;this.len=i;this.isOverflowing=r;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=u;this.containsRTL=h;this.spaceWidth=m;this.renderSpaceCharCode=g;this.renderWhitespace=f;this.renderControlCharacters=b}};function y9(o){let e=o.lineContent,t,n,i;o.stopRenderingLineAfter!==-1&&o.stopRenderingLineAfter<e.length?(t=!0,n=e.length-o.stopRenderingLineAfter,i=o.stopRenderingLineAfter):(t=!1,n=0,i=e.length);let r=I9(e,o.containsRTL,o.lineTokens,o.fauxIndentLength,i);o.renderControlCharacters&&!o.isBasicASCII&&(r=S9(e,r)),(o.renderWhitespace===4||o.renderWhitespace===1||o.renderWhitespace===2&&o.selectionsOnLine||o.renderWhitespace===3&&!o.continuesWithWrappedLine)&&(r=x9(o,e,i,r));let s=0;if(o.lineDecorations.length>0){for(let a=0,l=o.lineDecorations.length;a<l;a++){let d=o.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}r=E9(e,i,r,o.lineDecorations)}return o.containsRTL||(r=C9(e,r,!o.isBasicASCII||o.fontLigatures)),new X0(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,e,i,t,n,r,s,o.fauxIndentLength,o.tabSize,o.startVisibleColumn,o.containsRTL,o.spaceWidth,o.renderSpaceCharCode,o.renderWhitespace,o.renderControlCharacters)}function I9(o,e,t,n,i){let r=[],s=0;n>0&&(r[s++]=new mn(n,"",0,!1));let a=n;for(let l=0,d=t.getCount();l<d;l++){let c=t.getEndOffset(l);if(c<=n)continue;let u=t.getClassName(l);if(c>=i){let m=e?nl(o.substring(a,i)):!1;r[s++]=new mn(i,u,0,m);break}let h=e?nl(o.substring(a,c)):!1;r[s++]=new mn(c,u,0,h),a=c}return r}function C9(o,e,t){let n=0,i=[],r=0;if(t)for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex;if(n+50<d){let c=l.type,u=l.metadata,h=l.containsRTL,m=-1,g=n;for(let f=n;f<d;f++)o.charCodeAt(f)===32&&(m=f),m!==-1&&f-g>=50&&(i[r++]=new mn(m+1,c,u,h),g=m+1,m=-1);g!==d&&(i[r++]=new mn(d,c,u,h))}else i[r++]=l;n=d}else for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex,c=d-n;if(c>50){let u=l.type,h=l.metadata,m=l.containsRTL,g=Math.ceil(c/50);for(let f=1;f<g;f++){let b=n+f*50;i[r++]=new mn(b,u,h,m)}i[r++]=new mn(d,u,h,m)}else i[r++]=l;n=d}return i}function uV(o){return o<32?o!==9:o===127||o>=8234&&o<=8238||o>=8294&&o<=8297||o>=8206&&o<=8207||o===1564}function S9(o,e){let t=[],n=new mn(0,"",0,!1),i=0;for(let r of e){let s=r.endIndex;for(;i<s;i++){let a=o.charCodeAt(i);uV(a)&&(i>n.endIndex&&(n=new mn(i,r.type,r.metadata,r.containsRTL),t.push(n)),n=new mn(i+1,"mtkcontrol",r.metadata,!1),t.push(n))}i>n.endIndex&&(n=new mn(s,r.type,r.metadata,r.containsRTL),t.push(n))}return t}function x9(o,e,t,n){let i=o.continuesWithWrappedLine,r=o.fauxIndentLength,s=o.tabSize,a=o.startVisibleColumn,l=o.useMonospaceOptimizations,d=o.selectionsOnLine,c=o.renderWhitespace===1,u=o.renderWhitespace===3,h=o.renderSpaceWidth!==o.spaceWidth,m=[],g=0,f=0,b=n[f].type,y=n[f].containsRTL,C=n[f].endIndex,S=n.length,w=!1,R=ln(e),M;R===-1?(w=!0,R=t,M=t):M=_r(e);let N=!1,A=0,P=d&&d[A],K=a%s;for(let X=r;X<t;X++){let le=e.charCodeAt(X);P&&X>=P.endOffset&&(A++,P=d&&d[A]);let ye;if(X<R||X>M)ye=!0;else if(le===9)ye=!0;else if(le===32)if(c)if(N)ye=!0;else{let q=X+1<t?e.charCodeAt(X+1):0;ye=q===32||q===9}else ye=!0;else ye=!1;if(ye&&d&&(ye=!!P&&P.startOffset<=X&&P.endOffset>X),ye&&u&&(ye=w||X>M),ye&&y&&X>=R&&X<=M&&(ye=!1),N){if(!ye||!l&&K>=s){if(h){let q=g>0?m[g-1].endIndex:r;for(let Q=q+1;Q<=X;Q++)m[g++]=new mn(Q,"mtkw",1,!1)}else m[g++]=new mn(X,"mtkw",1,!1);K=K%s}}else(X===C||ye&&X>r)&&(m[g++]=new mn(X,b,0,y),K=K%s);for(le===9?K=s:Tr(le)?K+=2:K++,N=ye;X===C&&(f++,f<S);)b=n[f].type,y=n[f].containsRTL,C=n[f].endIndex}let j=!1;if(N)if(i&&c){let X=t>0?e.charCodeAt(t-1):0,le=t>1?e.charCodeAt(t-2):0;X===32&&le!==32&&le!==9||(j=!0)}else j=!0;if(j)if(h){let X=g>0?m[g-1].endIndex:r;for(let le=X+1;le<=t;le++)m[g++]=new mn(le,"mtkw",1,!1)}else m[g++]=new mn(t,"mtkw",1,!1);else m[g++]=new mn(t,b,0,y);return m}function E9(o,e,t,n){n.sort(kl.compare);let i=ax.normalize(o,n),r=i.length,s=0,a=[],l=0,d=0;for(let u=0,h=t.length;u<h;u++){let m=t[u],g=m.endIndex,f=m.type,b=m.metadata,y=m.containsRTL;for(;s<r&&i[s].startOffset<g;){let C=i[s];if(C.startOffset>d&&(d=C.startOffset,a[l++]=new mn(d,f,b,y)),C.endOffset+1<=g)d=C.endOffset+1,a[l++]=new mn(d,f+" "+C.className,b|C.metadata,y),s++;else{d=g,a[l++]=new mn(d,f+" "+C.className,b|C.metadata,y);break}}g>d&&(d=g,a[l++]=new mn(d,f,b,y))}let c=t[t.length-1].endIndex;if(s<r&&i[s].startOffset===c)for(;s<r&&i[s].startOffset===c;){let u=i[s];a[l++]=new mn(d,u.className,u.metadata,!1),s++}return a}function w9(o,e){let t=o.fontIsMonospace,n=o.canUseHalfwidthRightwardsArrow,i=o.containsForeignElements,r=o.lineContent,s=o.len,a=o.isOverflowing,l=o.overflowingCharCount,d=o.parts,c=o.fauxIndentLength,u=o.tabSize,h=o.startVisibleColumn,m=o.containsRTL,g=o.spaceWidth,f=o.renderSpaceCharCode,b=o.renderWhitespace,y=o.renderControlCharacters,C=new kb(s+1,d.length),S=!1,w=0,R=h,M=0,N=0,A=0;m?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let P=0,K=d.length;P<K;P++){let j=d[P],X=j.endIndex,le=j.type,ye=j.containsRTL,q=b!==0&&j.isWhitespace(),Q=q&&!t&&(le==="mtkw"||!i),ce=w===X&&j.isPseudoAfter();if(M=0,e.appendString("<span "),ye&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(Q?"mtkz":le),e.appendASCIICharCode(34),q){let ie=0;{let J=w,Se=R;for(;J<X;J++){let lt=(r.charCodeAt(J)===9?u-Se%u:1)|0;ie+=lt,J>=c&&(Se+=lt)}}for(Q&&(e.appendString(' style="width:'),e.appendString(String(g*ie)),e.appendString('px"')),e.appendASCIICharCode(62);w<X;w++){C.setColumnInfo(w+1,P-A,M,N),A=0;let J=r.charCodeAt(w),Se,xe;if(J===9){Se=u-R%u|0,xe=Se,!n||xe>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let lt=2;lt<=xe;lt++)e.appendCharCode(160)}else Se=2,xe=1,e.appendCharCode(f),e.appendCharCode(8204);M+=Se,N+=xe,w>=c&&(R+=xe)}}else for(e.appendASCIICharCode(62);w<X;w++){C.setColumnInfo(w+1,P-A,M,N),A=0;let ie=r.charCodeAt(w),J=1,Se=1;switch(ie){case 9:J=u-R%u,Se=J;for(let xe=1;xe<=J;xe++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:y?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Tr(ie)&&Se++,y&&ie<32?e.appendCharCode(9216+ie):y&&ie===127?e.appendCharCode(9249):y&&uV(ie)?(e.appendString("[U+"),e.appendString(_9(ie)),e.appendString("]"),J=8,Se=J):e.appendCharCode(ie)}M+=J,N+=Se,w>=c&&(R+=Se)}ce?A++:A=0,w>=s&&!S&&j.isPseudoAfter()&&(S=!0,C.setColumnInfo(w+1,P,M,N)),e.appendString("</span>")}return S||C.setColumnInfo(s+1,d.length-1,M,N),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(p("showMore","Show more ({0})",T9(l))),e.appendString("</span>")),e.appendString("</span>"),new Mb(C,m,i)}function _9(o){return o.toString(16).toUpperCase().padStart(4,"0")}function T9(o){return o<1024?p("overflow.chars","{0} chars",o):o<1024*1024?`${(o/1024).toFixed(1)} KB`:`${(o/1024/1024).toFixed(1)} MB`}var L9=function(){return Ys?!0:!(Zt||Bn||Bo)}(),qp=!0,Nb=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(e,t){this.themeType=t;let n=e.options,i=n.get(51);n.get(39)==="off"?this.renderWhitespace=n.get(101):this.renderWhitespace="none",this.renderControlCharacters=n.get(96),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.useMonospaceOptimizations=i.isMonospace&&!n.get(33),this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=n.get(68),this.stopRenderingLineAfter=n.get(119),this.fontLigatures=n.get(52)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}},Fs=class o{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=Be(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return Dd(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,n,i,r){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=i.getViewLineRenderingData(e),a=this._options,l=kl.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn),d=null;if(Dd(a.themeType)||this._options.renderWhitespace==="selection"){let m=i.selections;for(let g of m){if(g.endLineNumber<e||g.startLineNumber>e)continue;let f=g.startLineNumber===e?g.startColumn:s.minColumn,b=g.endLineNumber===e?g.endColumn:s.maxColumn;f<b&&(Dd(a.themeType)&&l.push(new kl(f,b,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new jp(f-1,b-1))))}}let c=new lx(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==Nc.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;" class="'),r.appendString(o.CLASS_NAME),r.appendString('">');let u=cV(c,r);r.appendString("</div>");let h=null;return qp&&L9&&s.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(h=new $p(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),h||(h=hV(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=h,!0}layoutLine(e,t,n){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(n))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof $p:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof $p?this._renderedViewLine.monospaceAssumptionsAreValid():qp}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof $p&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,n,i){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),n=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,n));let r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&n>r+1)return new Lb(!0,[new Ps(this.getWidth(i),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&n>r+1&&(n=r+1);let s=this._renderedViewLine.getVisibleRangesForRange(e,t,n,i);return s&&s.length>0?new Lb(!1,s):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};var $p=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(e,t,n){this.domNode=e,this.input=t;let i=Math.floor(t.lineContent.length/300);if(i>0){this._keyColumnPixelOffsetCache=new Float32Array(i);for(let r=0;r<i;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=n,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){let t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return qp;if(this.input.lineContent.length<300){let e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),qp=!1)}return qp}toSlowRenderedLine(){return hV(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,n,i){let r=this._getColumnPixelOffset(e,t,i),s=this._getColumnPixelOffset(e,n,i);return[new Ps(r,s-r)]}_getColumnPixelOffset(e,t,n){if(t<=300){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let i=Math.floor((t-1)/300)-1,r=(i+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[i],s===-1&&(s=this._actualReadPixelOffset(e,r,n),this._keyColumnPixelOffsetCache[i]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return s+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,n){if(!this.domNode)return-1;let i=this._characterMapping.getDomPosition(t),r=Cu.readHorizontalRanges(this._getReadingTarget(this.domNode),i.partIndex,i.charIndex,i.partIndex,i.charIndex,n);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return pV(this._characterMapping,e,t)}},dx=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(e,t,n,i,r){if(this.domNode=e,this.input=t,this._characterMapping=n,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!i||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,n,i){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let r=this._readPixelOffset(this.domNode,e,t,i);if(r===-1)return null;let s=this._readPixelOffset(this.domNode,e,n,i);return s===-1?null:[new Ps(r,s-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,n,i)}_readVisibleRangesForRange(e,t,n,i,r){if(n===i){let s=this._readPixelOffset(e,t,n,r);return s===-1?null:[new Ps(s,0)]}else return this._readRawVisibleRangesForRange(e,n,i,r)}_readPixelOffset(e,t,n,i){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(i);let r=this._getReadingTarget(e);return r.firstChild?(i.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let r=this._pixelOffsetCache[n];if(r!==-1)return r;let s=this._actualReadPixelOffset(e,t,n,i);return this._pixelOffsetCache[n]=s,s}return this._actualReadPixelOffset(e,t,n,i)}_actualReadPixelOffset(e,t,n,i){if(this._characterMapping.length===0){let l=Cu.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,i);return!l||l.length===0?-1:l[0].left}if(n===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(i);let r=this._characterMapping.getDomPosition(n),s=Cu.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,i);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(n),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(e,t,n,i){if(t===1&&n===this._characterMapping.length)return[new Ps(0,this.getWidth(i))];let r=this._characterMapping.getDomPosition(t),s=this._characterMapping.getDomPosition(n);return Cu.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,s.partIndex,s.charIndex,i)}getColumnOfNodeOffset(e,t){return pV(this._characterMapping,e,t)}},Q0=class extends dx{_readVisibleRangesForRange(e,t,n,i,r){let s=super._readVisibleRangesForRange(e,t,n,i,r);if(!s||s.length===0||n===i||n===1&&i===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(e,t,i,r);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},hV=function(){return Ls?D9:R9}();function D9(o,e,t,n,i){return new Q0(o,e,t,n,i)}function R9(o,e,t,n,i){return new dx(o,e,t,n,i)}function pV(o,e,t){let n=e.textContent.length,i=-1;for(;e;)e=e.previousSibling,i++;return o.getColumn(new Rb(i,t),n)}var Ml="monaco-mouse-cursor-text";var cx=class{constructor(e,t,n,i,r,s,a){this.top=e;this.left=t;this.paddingLeft=n;this.width=i;this.height=r;this.textContent=s;this.textContentClassName=a}};var Ab=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(e,t){this._context=e;let n=this._context.configuration.options,i=n.get(51);this._cursorStyle=n.get(28),this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(n.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=Be(document.createElement("div")),this._domNode.setClassName(`cursor ${Ml}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),Cn(this._domNode,i),this._domNode.setDisplay("none"),this._position=new V(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(51);return this._cursorStyle=t.get(28),this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),Cn(this._domNode,n),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){let{lineNumber:e,column:t}=this._position,n=this._context.viewModel.getLineContent(e),[i,r]=Xv(n,t-1);return[new V(e,i+1),n.substring(i,r)]}_prepareRender(e){let t="",n="",[i,r]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let h=e.visibleRangeForPosition(i);if(!h||h.outsideRenderedLine)return null;let m=Ce(this._domNode.domNode),g;this._cursorStyle===1?(g=K1(m,this._lineCursorWidth>0?this._lineCursorWidth:2),g>2&&(t=r,n=this._getTokenClassName(i))):g=K1(m,1);let f=h.left,b=0;g>=2&&f>=1&&(b=1,f-=b);let y=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta;return new cx(y,f,b,g,this._lineHeight,t,n)}let s=e.linesVisibleRangesForRange(new L(i.lineNumber,i.column,i.lineNumber,i.column+r.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=r==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(t=r,n=this._getTokenClassName(i));let c=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,u=2),new cx(c,l.left,0,d,u,t,n)}_getTokenClassName(e){let t=this._context.viewModel.getViewLineData(e.lineNumber),n=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(n)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${Ml} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var Su=class o{static whitespaceVisibleColumn(e,t,n){let i=e.length,r=0,s=-1,a=-1;for(let l=0;l<i;l++){if(l===t)return[s,a,r];switch(r%n===0&&(s=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=Rt.nextRenderTabStop(r,n);break;default:return[-1,-1,-1]}}return t===i?[s,a,r]:[-1,-1,-1]}static atomicPosition(e,t,n,i){let r=e.length,[s,a,l]=o.whitespaceVisibleColumn(e,t,n);if(l===-1)return-1;let d;switch(i){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%n===0)return t;d=l%n<=n/2;break}if(d){if(s===-1)return-1;let h=a;for(let m=s;m<r;++m){if(h===a+n)return s;switch(e.charCodeAt(m)){case 32:h+=1;break;case 9:h=Rt.nextRenderTabStop(h,n);break;default:return-1}}return h===a+n?s:-1}let c=Rt.nextRenderTabStop(l,n),u=l;for(let h=t;h<r;h++){if(u===c)return h;switch(e.charCodeAt(h)){case 32:u+=1;break;case 9:u=Rt.nextRenderTabStop(u,n);break;default:return-1}}return u===c?r:-1}};var Ba=class{constructor(e=null){this.hitTarget=e}type=0},ux=class{constructor(e,t,n){this.position=e;this.spanNode=t;this.injectedText=n}type=1;get hitTarget(){return this.spanNode}},Yp;(e=>{function o(t,n,i){let r=t.getPositionFromDOMInfo(n,i);return r?new ux(r,n,null):new Ba(n)}e.createFromDOMInfo=o})(Yp||={});var hx=class{constructor(e,t){this.lastViewCursorsRenderData=e;this.lastTextareaPosition=t}},Qn=class{static _deduceRage(e,t=null){return!t&&e?new L(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,n){return{type:0,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,n,i,r,s){return{type:e,element:t,mouseColumn:n,position:i,range:r,detail:s}}static createViewZone(e,t,n,i,r){return{type:e,element:t,mouseColumn:n,position:i,range:this._deduceRage(i),detail:r}}static createContentText(e,t,n,i,r){return{type:6,element:e,mouseColumn:t,position:n,range:this._deduceRage(n,i),detail:r}}static createContentEmpty(e,t,n,i){return{type:7,element:e,mouseColumn:t,position:n,range:this._deduceRage(n),detail:i}}static createContentWidget(e,t,n){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createScrollbar(e,t,n){return{type:11,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createOverlayWidget(e,t,n){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createOutsideEditor(e,t,n,i){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:n,outsideDistance:i}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}},Si=class{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}},Zp=class o{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(e,t,n){this.viewModel=e.viewModel;let i=e.configuration.options;this.layoutInfo=i.get(147),this.viewDomNode=t.viewDomNode,this.lineHeight=i.get(68),this.stickyTabStops=i.get(118),this.typicalHalfwidthCharacterWidth=i.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=n,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return o.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){let n=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(n){let i=n.verticalOffset+n.height/2,r=e.viewModel.getLineCount(),s=null,a,l=null;return n.afterLineNumber!==r&&(l=new V(n.afterLineNumber+1,1)),n.afterLineNumber>0&&(s=new V(n.afterLineNumber,e.viewModel.getLineMaxColumn(n.afterLineNumber))),l===null?a=s:s===null?a=l:t<i?a=s:a=l,{viewZoneId:n.id,afterLineNumber:n.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let i=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(i);return{range:new L(i,r,i,r),isAfterLines:!0}}let t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.viewModel.getLineMaxColumn(t);return{range:new L(t,1,t,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return o._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,n){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===n)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},eR=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(e,t,n,i){this.editorPos=t,this.pos=n,this.relativePos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Xp._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}},tR=class extends eR{_ctx;_eventTarget;hitTestResult=new $n(()=>Xp.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Xn.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,n,i,r){super(e,t,n,i),this._ctx=e,this._eventTarget=r;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?Rt.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Qn.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Qn.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,n,i){return Qn.createMargin(e,this.target,this._getMouseColumn(t),t,n,i)}fulfillViewZone(e,t,n){return Qn.createViewZone(e,this.target,this._getMouseColumn(t),t,n)}fulfillContentText(e,t,n){return Qn.createContentText(this.target,this._getMouseColumn(e),e,t,n)}fulfillContentEmpty(e,t){return Qn.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Qn.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Qn.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Qn.createOverlayWidget(this.target,this._getMouseColumn(),e)}},mV={isAfterLines:!0};function J0(o){return{isAfterLines:!1,horizontalDistanceToText:o}}var Xp=class o{_context;_viewHelper;constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,n=Xn.collect(t,this._viewHelper.viewDomNode);return!!(Si.isChildOfContentWidgets(n)||Si.isChildOfOverflowingContentWidgets(n)||Si.isChildOfOverlayWidgets(n)||Si.isChildOfOverflowingOverlayWidgets(n))}createMouseTarget(e,t,n,i,r){let s=new Zp(this._context,this._viewHelper,e),a=new tR(s,t,n,i,r);try{let l=o._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=o._snapToSoftTabBoundary(l.position,s.viewModel),c=L.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();let n=t,i=null;return!Si.isChildOfOverflowGuard(t.targetPath)&&!Si.isChildOfOverflowingContentWidgets(t.targetPath)&&!Si.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(i=i||t.fulfillUnknown()),i=i||o._hitTestContentWidget(e,n),i=i||o._hitTestOverlayWidget(e,n),i=i||o._hitTestMinimap(e,n),i=i||o._hitTestScrollbarSlider(e,n),i=i||o._hitTestViewZone(e,n),i=i||o._hitTestMargin(e,n),i=i||o._hitTestViewCursor(e,n),i=i||o._hitTestTextArea(e,n),i=i||o._hitTestViewLines(e,n),i=i||o._hitTestScrollbar(e,n),i||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(Si.isChildOfContentWidgets(t.targetPath)||Si.isChildOfOverflowingContentWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillContentWidget(n):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(Si.isChildOfOverlayWidgets(t.targetPath)||Si.isChildOfOverflowingOverlayWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillOverlayWidget(n):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){let n=e.lastRenderData.lastViewCursorsRenderData;for(let i of n)if(t.target===i.domNode)return t.fulfillContentText(i.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){let n=e.lastRenderData.lastViewCursorsRenderData,i=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(let s of n){if(i<s.contentLeft||i>s.contentLeft+s.width)continue;let a=e.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=r&&r<=a+s.height)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){let n=e.getZoneAtCoord(t.mouseVerticalOffset);if(n){let i=t.isInContentArea?8:5;return t.fulfillViewZone(i,n.position,n)}return null}static _hitTestTextArea(e,t){return Si.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){let n=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),i=n.range.getStartPosition(),r=Math.abs(t.relativePos.x),s={isAfterLines:n.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){let a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(n.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,i,n.range,s)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,i,n.range,s):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,i,n.range,s))}return null}static _hitTestViewLines(e,t){if(!Si.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new V(1,1),mV);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){let i=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(i);return t.fulfillContentEmpty(new V(i,r),mV)}if(Si.isStrictChildOfViewLines(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(i)===0){let s=e.getLineWidth(i),a=J0(t.mouseContentHorizontalOffset-s);return t.fulfillContentEmpty(new V(i,1),a)}let r=e.getLineWidth(i);if(t.mouseContentHorizontalOffset>=r){let s=J0(t.mouseContentHorizontalOffset-r),a=new V(i,e.viewModel.getLineMaxColumn(i));return t.fulfillContentEmpty(a,s)}}let n=t.hitTestResult.value;return n.type===1?o.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(Si.isChildOfMinimap(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new V(n,i))}return null}static _hitTestScrollbarSlider(e,t){if(Si.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){let n=t.target.className;if(n&&/\b(slider|scrollbar)\b/.test(n)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new V(i,r))}}return null}static _hitTestScrollbar(e,t){if(Si.isChildOfScrollableElement(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new V(n,i))}return null}getMouseColumn(e){let t=this._context.configuration.options,n=t.get(147),i=this._context.viewLayout.getCurrentScrollLeft()+e.x-n.contentLeft;return o._getMouseColumn(i,t.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,n,i,r){let s=i.lineNumber,a=i.column,l=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>l){let y=J0(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(i,y)}let d=e.visibleRangeForPosition(s,a);if(!d)return t.fulfillUnknown(i);let c=d.left;if(Math.abs(t.mouseContentHorizontalOffset-c)<1)return t.fulfillContentText(i,null,{mightBeForeignElement:!!r,injectedText:r});let u=[];if(u.push({offset:d.left,column:a}),a>1){let y=e.visibleRangeForPosition(s,a-1);y&&u.push({offset:y.left,column:a-1})}let h=e.viewModel.getLineMaxColumn(s);if(a<h){let y=e.visibleRangeForPosition(s,a+1);y&&u.push({offset:y.left,column:a+1})}u.sort((y,C)=>y.offset-C.offset);let m=t.pos.toClientCoordinates(Ce(e.viewDomNode)),g=n.getBoundingClientRect(),f=g.left<=m.clientX&&m.clientX<=g.right,b=null;for(let y=1;y<u.length;y++){let C=u[y-1],S=u[y];if(C.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=S.offset){b=new L(s,C.column,s,S.column);let w=Math.abs(C.offset-t.mouseContentHorizontalOffset),R=Math.abs(S.offset-t.mouseContentHorizontalOffset);i=w<R?new V(s,C.column):new V(s,S.column);break}}return t.fulfillContentText(i,b,{mightBeForeignElement:!f||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.getVerticalOffsetForLineNumber(n),r=i+e.lineHeight;if(!(n===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){let a=Math.floor((i+r)/2),l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);let d=new Zd(t.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(e,d.toClientCoordinates(Ce(e.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(Ce(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let n=xl(e.viewDomNode),i;if(n?typeof n.caretRangeFromPoint>"u"?i=N9(n,t.clientX,t.clientY):i=n.caretRangeFromPoint(t.clientX,t.clientY):i=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!i||!i.startContainer)return new Ba;let r=i.startContainer;if(r.nodeType===r.TEXT_NODE){let s=r.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Fs.CLASS_NAME?Yp.createFromDOMInfo(e,s,i.startOffset):new Ba(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){let s=r.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Fs.CLASS_NAME?Yp.createFromDOMInfo(e,r,r.textContent.length):new Ba(r)}return new Ba}static _doHitTestWithCaretPositionFromPoint(e,t){let n=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(n.offsetNode.nodeType===n.offsetNode.TEXT_NODE){let i=n.offsetNode.parentNode,r=i?i.parentNode:null,s=r?r.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===Fs.CLASS_NAME?Yp.createFromDOMInfo(e,n.offsetNode.parentNode,n.offset):new Ba(n.offsetNode.parentNode)}if(n.offsetNode.nodeType===n.offsetNode.ELEMENT_NODE){let i=n.offsetNode.parentNode,r=i&&i.nodeType===i.ELEMENT_NODE?i.className:null,s=i?i.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(r===Fs.CLASS_NAME){let l=n.offsetNode.childNodes[Math.min(n.offset,n.offsetNode.childNodes.length-1)];if(l)return Yp.createFromDOMInfo(e,l,0)}else if(a===Fs.CLASS_NAME)return Yp.createFromDOMInfo(e,n.offsetNode,0)}return new Ba(n.offsetNode)}static _snapToSoftTabBoundary(e,t){let n=t.getLineContent(e.lineNumber),{tabSize:i}=t.model.getOptions(),r=Su.atomicPosition(n,e.column-1,i,2);return r!==-1?new V(e.lineNumber,r+1):e}static doHitTest(e,t){let n=new Ba;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?n=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(n=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(Ce(e.viewDomNode)))),n.type===1){let i=e.viewModel.getInjectedTextAt(n.position),r=e.viewModel.normalizePosition(n.position,2);(i||!r.equals(n.position))&&(n=new ux(r,n.spanNode,i))}return n}};function N9(o,e,t){let n=document.createRange(),i=o.elementFromPoint(e,t);if(i!==null){for(;i&&i.firstChild&&i.firstChild.nodeType!==i.firstChild.TEXT_NODE&&i.lastChild&&i.lastChild.firstChild;)i=i.lastChild;let r=i.getBoundingClientRect(),s=Ce(i),a=s.getComputedStyle(i,null).getPropertyValue("font-style"),l=s.getComputedStyle(i,null).getPropertyValue("font-variant"),d=s.getComputedStyle(i,null).getPropertyValue("font-weight"),c=s.getComputedStyle(i,null).getPropertyValue("font-size"),u=s.getComputedStyle(i,null).getPropertyValue("line-height"),h=s.getComputedStyle(i,null).getPropertyValue("font-family"),m=`${a} ${l} ${d} ${c}/${u} ${h}`,g=i.innerText,f=r.left,b=0,y;if(e>r.left+r.width)b=g.length;else{let C=nR.getInstance();for(let S=0;S<g.length+1;S++){if(y=C.getCharWidth(g.charAt(S),m)/2,f+=y,e<f){b=S;break}f+=y}}n.setStart(i.firstChild,b),n.setEnd(i.firstChild,b)}return n}var nR=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){let n=e+t;if(this._cache[n])return this._cache[n];let i=this._canvas.getContext("2d");i.font=t;let s=i.measureText(e).width;return this._cache[n]=s,s}};var Xd=class o{static columnSelect(e,t,n,i,r,s){let a=Math.abs(r-n)+1,l=n>r,d=i>s,c=i<s,u=[];for(let h=0;h<a;h++){let m=n+(l?-h:h),g=e.columnFromVisibleColumn(t,m,i),f=e.columnFromVisibleColumn(t,m,s),b=e.visibleColumnFromColumn(t,new V(m,g)),y=e.visibleColumnFromColumn(t,new V(m,f));c&&(b>s||y<i)||d&&(y>i||b<s)||u.push(new Sn(new L(m,g,m,g),0,0,new V(m,f),0))}if(u.length===0)for(let h=0;h<a;h++){let m=n+(l?-h:h),g=t.getLineMaxColumn(m);u.push(new Sn(new L(m,g,m,g),0,0,new V(m,g),0))}return{viewStates:u,reversed:l,fromLineNumber:n,fromVisualColumn:i,toLineNumber:r,toVisualColumn:s}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,o.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let i=0,r=Math.min(n.fromViewLineNumber,n.toViewLineNumber),s=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let l=r;l<=s;l++){let d=t.getLineMaxColumn(l),c=e.visibleColumnFromColumn(t,new V(l,d));i=Math.max(i,c)}let a=n.toViewVisualColumn;return a<i&&a++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,a)}static columnSelectUp(e,t,n,i){let r=i?e.pageSize:1,s=Math.max(1,n.toViewLineNumber-r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){let r=i?e.pageSize:1,s=Math.min(t.getLineCount(),n.toViewLineNumber+r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}};var xi=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return Ue.fromPositions(i.getEndPosition())}};var Eu=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return Ue.fromPositions(i.getStartPosition())}},wu=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(e,t,n,i,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=i,this._lineNumberDeltaOffset=n,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return Ue.fromPositions(i.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},mx=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(e,t,n,i=!1){this._range=e,this._text=t,this._initialSelection=n,this._forceMoveMarkers=i,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};var Pb=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(e,t,n){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}},tn=class o{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-Z_(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){let n=t.lineNumber-1;return new V(n,e.getLineMaxColumn(n))}else return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){let i=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),s=Su.atomicPosition(r,t.column-1,n,0);if(s!==-1&&s+1>=i)return new V(t.lineNumber,s+1)}return this.leftPosition(e,t)}static left(e,t,n){let i=e.stickyTabStops?o.leftPositionAtomicSoftTabs(t,n,e.tabSize):o.leftPosition(t,n);return new Pb(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.startLineNumber,a=n.selection.startColumn;else{let l=n.position.delta(void 0,-(r-1)),d=t.normalizePosition(o.clipPositionColumn(l,t),0),c=o.left(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static clipPositionColumn(e,t){return new V(e.lineNumber,o.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n=n+wg(e.getLineContent(t),n-1):t<e.getLineCount()&&(t=t+1,n=e.getLineMinColumn(t)),new V(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,r){if(n<e.getLineIndentColumn(t)){let s=e.getLineContent(t),a=Su.atomicPosition(s,n-1,i,1);if(a!==-1)return new V(t,a+1)}return this.rightPosition(e,t,n)}static right(e,t,n){let i=e.stickyTabStops?o.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):o.rightPosition(t,n.lineNumber,n.column);return new Pb(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.endLineNumber,a=n.selection.endColumn;else{let l=n.position.delta(void 0,r-1),d=t.normalizePosition(o.clipPositionColumn(l,t),1),c=o.right(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static vertical(e,t,n,i,r,s,a,l){let d=Rt.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+r,c=t.getLineCount(),u=n===1&&i===1,h=n===c&&i===t.getLineMaxColumn(n),m=s<n?u:h;if(n=s,n<1?(n=1,a?i=t.getLineMinColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):n>c?(n=c,a?i=t.getLineMaxColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):i=e.columnFromVisibleColumn(t,n,d),m?r=0:r=d-Rt.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),l!==void 0){let g=new V(n,i),f=t.normalizePosition(g,l);r=r+(i-f.column),n=f.lineNumber,i=f.column}return new Pb(n,i,r)}static down(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n+s,a,4)}static moveDown(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.endLineNumber,a=n.selection.endColumn):(s=n.position.lineNumber,a=n.position.column);let l=0,d;do if(d=o.down(e,t,s+l,a,n.leftoverVisibleColumns,r,!0),t.normalizePosition(new V(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<t.getLineCount());return n.move(i,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(e,t,n){let i=n.selection,r=o.down(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.down(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new Sn(new L(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new V(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n-s,a,3)}static moveUp(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.startLineNumber,a=n.selection.startColumn):(s=n.position.lineNumber,a=n.position.column);let l=o.up(e,t,s,a,n.leftoverVisibleColumns,r,!0);return n.move(i,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,n){let i=n.selection,r=o.up(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.up(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new Sn(new L(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new V(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,n,i){let r=n.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return n.move(i,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,n,i){let r=t.getLineCount(),s=n.position.lineNumber;for(;s<r&&this._isBlankLine(t,s);)s++;for(;s<r&&!this._isBlankLine(t,s);)s++;return n.move(i,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,n,i){let r=n.position.lineNumber,s=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||s,l;return n.position.column===a?l=s:l=a,n.move(i,r,l,0)}static moveToEndOfLine(e,t,n,i,r){let s=n.position.lineNumber,a=t.getLineMaxColumn(s);return n.move(i,s,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let r=t.getLineCount(),s=t.getLineMaxColumn(r);return n.move(i,r,s,0)}};var Nl=class o{static deleteRight(e,t,n,i){let r=[],s=e!==3;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d;if(c.isEmpty()){let u=d.getPosition(),h=tn.right(t,n,u);c=new L(h.lineNumber,h.column,u.lineNumber,u.column)}if(c.isEmpty()){r[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),r[a]=new xi(c,"")}return[s,r]}static isAutoClosingPairDelete(e,t,n,i,r,s,a){if(t==="never"&&n==="never"||e==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],u=c.getPosition();if(!c.isEmpty())return!1;let h=r.getLineContent(u.lineNumber);if(u.column<2||u.column>=h.length+1)return!1;let m=h.charAt(u.column-2),g=i.get(m);if(!g)return!1;if(Os(m)){if(n==="never")return!1}else if(t==="never")return!1;let f=h.charAt(u.column-1),b=!1;for(let y of g)y.open===m&&y.close===f&&(b=!0);if(!b)return!1;if(e==="auto"){let y=!1;for(let C=0,S=a.length;C<S;C++){let w=a[C];if(u.lineNumber===w.startLineNumber&&u.column===w.startColumn){y=!0;break}}if(!y)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].getPosition(),l=new L(a.lineNumber,a.column-1,a.lineNumber,a.column+1);i[r]=new xi(l,"")}return[!0,i]}static deleteLeft(e,t,n,i,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,r))return this._runAutoClosingPairDelete(t,n,i);let s=[],a=e!==2;for(let l=0,d=i.length;l<d;l++){let c=o.getDeleteRange(i[l],n,t);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new xi(c,"")}return[a,s]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;let i=e.getPosition();if(n.useTabStops&&i.column>1){let r=t.getLineContent(i.lineNumber),s=ln(r),a=s===-1?r.length+1:s+1;if(i.column<=a){let l=n.visibleColumnFromColumn(t,i),d=Rt.prevIndentTabStop(l,n.indentSize),c=n.columnFromVisibleColumn(t,i.lineNumber,d);return new L(i.lineNumber,c,i.lineNumber,i.column)}}return L.fromPositions(o.getPositionAfterDeleteLeft(i,t),i)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){let n=MN(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}else if(e.lineNumber>1){let n=e.lineNumber-1;return new V(n,t.getLineMaxColumn(n))}else return e}static cut(e,t,n){let i=[],r=null;n.sort((s,a)=>V.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=n.length;s<a;s++){let l=n[s];if(l.isEmpty())if(e.emptySelectionClipboard){let d=l.getPosition(),c,u,h,m;d.lineNumber<t.getLineCount()?(c=d.lineNumber,u=1,h=d.lineNumber+1,m=1):d.lineNumber>1&&r?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,u=t.getLineMaxColumn(d.lineNumber-1),h=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,u=1,h=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber));let g=new L(c,u,h,m);r=g,g.isEmpty()?i[s]=null:i[s]=new xi(g,"")}else i[s]=null;else i[s]=new xi(l,"")}return new Wn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var Qp=class o{static _createWord(e,t,n,i,r){return{start:i,end:r,wordType:t,nextCharClass:n}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0,r=t.findPrevIntlWordBeforeOrAtOffset(e,n.column-2);for(let s=n.column-2;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return this._createIntlWord(r,l);if(l===0){if(i===2)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=1}else if(l===2){if(i===1)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=2}else if(l===1&&i!==0)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1))}return i!==0?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let r=t.findNextIntlWordAtOrAfterOffset(e,i),s=e.length;for(let a=i;a<s;a++){let l=e.charCodeAt(a),d=t.get(l);if(r&&a===r.index+r.segment.length||d===1||n===1&&d===2||n===2&&d===0)return a}return s}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,r=e.length,s=t.findNextIntlWordAtOrAfterOffset(e,n.column-1);for(let a=n.column-1;a<r;a++){let l=e.charCodeAt(a),d=t.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(i===2)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=1}else if(d===2){if(i===1)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=2}else if(d===1&&i!==0)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a)}return i!==0?this._createWord(e,i,1,this._findStartOfWord(e,t,i,r-1),r):null}static _findStartOfWord(e,t,n,i){let r=t.findPrevIntlWordBeforeOrAtOffset(e,i);for(let s=i;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return s;if(l===1||n===1&&l===2||n===2&&l===0)return s+1}return 0}static moveWordLeft(e,t,n,i,r){let s=n.lineNumber,a=n.column;a===1&&s>1&&(s=s-1,a=t.getLineMaxColumn(s));let l=o._findPreviousWordOnLine(e,t,new V(s,a));if(i===0)return new V(s,l?l.start+1:1);if(i===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findPreviousWordOnLine(e,t,new V(s,l.start+1))),new V(s,l?l.start+1:1);if(i===3){for(;l&&l.wordType===2;)l=o._findPreviousWordOnLine(e,t,new V(s,l.start+1));return new V(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=o._findPreviousWordOnLine(e,t,new V(s,l.start+1))),new V(s,l?l.end+1:1)}static _moveWordPartLeft(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===1)return n>1?new V(n-1,e.getLineMaxColumn(n-1)):t;let r=e.getLineContent(n);for(let s=t.column-1;s>1;s--){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a===95&&l!==95)return new V(n,s);if(a===45&&l!==45)return new V(n,s);if((yc(a)||Sg(a))&&na(l))return new V(n,s);if(na(a)&&na(l)&&s+1<i){let d=r.charCodeAt(s);if(yc(d)||Sg(d))return new V(n,s)}}return new V(n,1)}static moveWordRight(e,t,n,i){let r=n.lineNumber,s=n.column,a=!1;s===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,s=1);let l=o._findNextWordOnLine(e,t,new V(r,s));if(i===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findNextWordOnLine(e,t,new V(r,l.end+1))),l?s=l.end+1:s=t.getLineMaxColumn(r);else if(i===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=o._findNextWordOnLine(e,t,new V(r,l.end+1));l?s=l.start+1:s=t.getLineMaxColumn(r)}else l&&!a&&s>=l.start+1&&(l=o._findNextWordOnLine(e,t,new V(r,l.end+1))),l?s=l.start+1:s=t.getLineMaxColumn(r);return new V(r,s)}static _moveWordPartRight(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===i)return n<e.getLineCount()?new V(n+1,1):t;let r=e.getLineContent(n);for(let s=t.column+1;s<i;s++){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a!==95&&l===95)return new V(n,s);if(a!==45&&l===45)return new V(n,s);if((yc(a)||Sg(a))&&na(l))return new V(n,s);if(na(a)&&na(l)&&s+1<i){let d=r.charCodeAt(s);if(yc(d)||Sg(d))return new V(n,s)}}return new V(n,i)}static _deleteWordLeftWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-2,r=_r(n,i);return r+1<i?new L(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(Nl.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){let u=e.selection.getPosition();return new L(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}let a=new V(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let u=this._deleteWordLeftWhitespace(i,a);if(u)return u}let c=o._findPreviousWordOnLine(n,i,a);return t===0?c?d=c.start+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=o._findPreviousWordOnLine(n,i,new V(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l))),new L(l,d,a.lineNumber,a.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;let i=new V(n.positionLineNumber,n.positionColumn),r=this._deleteInsideWordWhitespace(t,i);return r||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){let n=e.charCodeAt(t);return n===32||n===9}static _deleteInsideWordWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=n.length;if(i===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,r))return null;let s=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,s))return null;for(;r>0&&this._charAtIsWhitespace(n,r-1);)r--;for(;s+1<i&&this._charAtIsWhitespace(n,s+1);)s++;return new L(t.lineNumber,r+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){let i=t.getLineContent(n.lineNumber),r=i.length;if(r===0)return n.lineNumber>1?new L(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new L(n.lineNumber,1,n.lineNumber+1,1):new L(n.lineNumber,1,n.lineNumber,1);let s=u=>u.start+1<=n.column&&n.column<=u.end+1,a=(u,h)=>(u=Math.min(u,n.column),h=Math.max(h,n.column),new L(n.lineNumber,u,n.lineNumber,h)),l=u=>{let h=u.start+1,m=u.end+1,g=!1;for(;m-1<r&&this._charAtIsWhitespace(i,m-1);)g=!0,m++;if(!g)for(;h>1&&this._charAtIsWhitespace(i,h-2);)h--;return a(h,m)},d=o._findPreviousWordOnLine(e,t,n);if(d&&s(d))return l(d);let c=o._findNextWordOnLine(e,t,n);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartLeft(e,n);return new L(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let r=e.charAt(i);if(r!==" "&&r!=="	")return i}return n}static _deleteWordRightWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-1,r=this._findFirstNonWhitespaceChar(n,i);return i+1<r?new L(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;let a=new V(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column,c=i.getLineCount(),u=i.getLineMaxColumn(l);if(l===c&&d===u)return null;if(s){let m=this._deleteWordRightWhitespace(i,a);if(m)return m}let h=o._findNextWordOnLine(n,i,a);return t===2?h?d=h.end+1:d<u||l===c?d=u:(l++,h=o._findNextWordOnLine(n,i,new V(l,1)),h?d=h.start+1:d=i.getLineMaxColumn(l)):(h&&d>=h.start+1&&(h=o._findNextWordOnLine(n,i,new V(l,h.end+1))),h?d=h.start+1:d<u||l===c?d=u:(l++,h=o._findNextWordOnLine(n,i,new V(l,1)),h?d=h.start+1:d=i.getLineMaxColumn(l))),new L(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartRight(e,n);return new L(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){let i=new L(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n,i){let r=aa(t,n),s=o._findPreviousWordOnLine(r,e,i);if(s&&s.wordType===1&&s.start<=i.column-1&&i.column-1<=s.end)return o._createWordAtPosition(e,i.lineNumber,s);let a=o._findNextWordOnLine(r,e,i);return a&&a.wordType===1&&a.start<=i.column-1&&i.column-1<=a.end?o._createWordAtPosition(e,i.lineNumber,a):null}static word(e,t,n,i,r){let s=aa(e.wordSeparators,e.wordSegmenterLocales),a=o._findPreviousWordOnLine(s,t,r),l=o._findNextWordOnLine(s,t,r);if(!i){let m,g;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end?(m=a.start+1,g=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end?(m=l.start+1,g=l.end+1):(a?m=a.end+1:m=1,l?g=l.start+1:g=t.getLineMaxColumn(r.lineNumber)),new Sn(new L(r.lineNumber,m,r.lineNumber,g),1,0,new V(r.lineNumber,g),0)}let d,c;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(d=l.start+1,c=l.end+1):(d=r.column,c=r.column);let u=r.lineNumber,h;if(n.selectionStart.containsPosition(r))h=n.selectionStart.endColumn;else if(r.isBeforeOrEqual(n.selectionStart.getStartPosition())){h=d;let m=new V(u,h);n.selectionStart.containsPosition(m)&&(h=n.selectionStart.endColumn)}else{h=c;let m=new V(u,h);n.selectionStart.containsPosition(m)&&(h=n.selectionStart.startColumn)}return n.move(!0,u,h,0)}};var Jn=class{static addCursorDown(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ke(l.modelState,l.viewState),n?i[r++]=Ke.fromModelState(tn.translateDown(e.cursorConfig,e.model,l.modelState)):i[r++]=Ke.fromViewState(tn.translateDown(e.cursorConfig,e,l.viewState))}return i}static addCursorUp(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ke(l.modelState,l.viewState),n?i[r++]=Ke.fromModelState(tn.translateUp(e.cursorConfig,e.model,l.modelState)):i[r++]=Ke.fromViewState(tn.translateUp(e.cursorConfig,e,l.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=this._moveToLineStart(e,a,n)}return i}static _moveToLineStart(e,t,n){let i=t.viewState.position.column,r=t.modelState.position.column,s=i===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!s&&!(i===l)?this._moveToLineStartByView(e,t,n):this._moveToLineStartByModel(e,t,n)}static _moveToLineStartByView(e,t,n){return Ke.fromViewState(tn.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return Ke.fromModelState(tn.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=this._moveToLineEnd(e,l,n,i)}return r}static _moveToLineEnd(e,t,n,i){let r=t.viewState.position,s=e.getLineMaxColumn(r.lineNumber),a=r.column===s,l=t.modelState.position,d=e.model.getLineMaxColumn(l.lineNumber),c=s-r.column===d-l.column;return a||c?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return Ke.fromViewState(tn.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return Ke.fromModelState(tn.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=s.modelState.selection.startLineNumber,l=e.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=e.model.getLineMaxColumn(l):(d++,c=1),n[i]=Ke.fromModelState(new Sn(new L(a,1,a,1),0,0,new V(d,c),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ke.fromModelState(tn.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ke.fromModelState(tn.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static selectAll(e,t){let n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return Ke.fromModelState(new Sn(new L(1,1,1,1),0,0,new V(n,i),0))}static line(e,t,n,i,r){let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new V(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);if(!n){let d=e.model.getLineCount(),c=s.lineNumber+1,u=1;return c>d&&(c=d,u=e.model.getLineMaxColumn(c)),Ke.fromModelState(new Sn(new L(s.lineNumber,1,c,u),2,0,new V(c,u),0))}let l=t.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return Ke.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=e.getLineCount(),c=a.lineNumber+1,u=1;return c>d&&(c=d,u=e.getLineMaxColumn(c)),Ke.fromViewState(t.viewState.move(!0,c,u,0))}else{let d=t.modelState.selectionStart.getEndPosition();return Ke.fromModelState(t.modelState.move(!0,d.lineNumber,d.column,0))}}static word(e,t,n,i){let r=e.model.validatePosition(i);return Ke.fromModelState(Qp.word(e.cursorConfig,e.model,t.modelState,n,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new Ke(t.modelState,t.viewState);let n=t.viewState.position.lineNumber,i=t.viewState.position.column;return Ke.fromViewState(new Sn(new L(n,i,n,i),0,0,new V(n,i),0))}static moveTo(e,t,n,i,r){if(n){if(t.modelState.selectionStartKind===1)return this.word(e,t,n,i);if(t.modelState.selectionStartKind===2)return this.line(e,t,n,i,r)}let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new V(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);return Ke.fromViewState(t.viewState.move(n,a.lineNumber,a.column,0))}static simpleMove(e,t,n,i,r,s){switch(n){case Ve.Direction.Left:return s===Ve.Unit.HalfLine?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,r);case Ve.Direction.Right:return s===Ve.Unit.HalfLine?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,r);case Ve.Direction.Up:return s===Ve.Unit.WrappedLine?this._moveUpByViewLines(e,t,i,r):this._moveUpByModelLines(e,t,i,r);case Ve.Direction.Down:return s===Ve.Unit.WrappedLine?this._moveDownByViewLines(e,t,i,r):this._moveDownByModelLines(e,t,i,r);case Ve.Direction.PrevBlankLine:return s===Ve.Unit.WrappedLine?t.map(a=>Ke.fromViewState(tn.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ke.fromModelState(tn.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Ve.Direction.NextBlankLine:return s===Ve.Unit.WrappedLine?t.map(a=>Ke.fromViewState(tn.moveToNextBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ke.fromModelState(tn.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Ve.Direction.WrappedLineStart:return this._moveToViewMinColumn(e,t,i);case Ve.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case Ve.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(e,t,i);case Ve.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(e,t,i);case Ve.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,r){let s=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(n){case Ve.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ve.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ve.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Ve.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=t.length;d<c;d++){let u=t[d];l[d]=this.findPositionInViewportIfOutside(e,u,s,i)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let r=t.viewState.position.lineNumber;if(n.startLineNumber<=r&&r<=n.endLineNumber-1)return new Ke(t.modelState,t.viewState);{let s;r>n.endLineNumber-1?s=n.endLineNumber-1:r<n.startLineNumber?s=n.startLineNumber:s=r;let a=tn.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,s,!1);return Ke.fromViewState(t.viewState.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map(r=>Ke.fromViewState(tn.moveLeft(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineLeft(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ke.fromViewState(tn.moveLeft(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveRight(e,t,n,i){return t.map(r=>Ke.fromViewState(tn.moveRight(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineRight(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ke.fromViewState(tn.moveRight(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveDownByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ke.fromViewState(tn.moveDown(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveDownByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ke.fromModelState(tn.moveDown(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveUpByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ke.fromViewState(tn.moveUp(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveUpByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ke.fromModelState(tn.moveUp(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveToViewPosition(e,t,n,i,r){return Ke.fromViewState(t.viewState.move(n,i,r,0))}static _moveToModelPosition(e,t,n,i,r){return Ke.fromModelState(t.modelState.move(n,i,r,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMinColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineFirstNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMaxColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineLastNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}},Ve;(a=>{let o=function(l){if(!hn(l))return!1;let d=l;return!(!sn(d.to)||!an(d.select)&&!Gv(d.select)||!an(d.by)&&!sn(d.by)||!an(d.value)&&!mi(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function i(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=i;let r;(N=>(N[N.Left=0]="Left",N[N.Right=1]="Right",N[N.Up=2]="Up",N[N.Down=3]="Down",N[N.PrevBlankLine=4]="PrevBlankLine",N[N.NextBlankLine=5]="NextBlankLine",N[N.WrappedLineStart=6]="WrappedLineStart",N[N.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",N[N.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",N[N.WrappedLineEnd=9]="WrappedLineEnd",N[N.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",N[N.ViewPortTop=11]="ViewPortTop",N[N.ViewPortCenter=12]="ViewPortCenter",N[N.ViewPortBottom=13]="ViewPortBottom",N[N.ViewPortIfOutside=14]="ViewPortIfOutside"))(r=a.Direction||={});let s;(m=>(m[m.None=0]="None",m[m.Line=1]="Line",m[m.WrappedLine=2]="WrappedLine",m[m.Character=3]="Character",m[m.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(Ve||={});function A9(o,e,t){let n=o.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let i,r=-1;for(i=e-1;i>=1;i--){if(o.tokenization.getLanguageIdAtPosition(i,0)!==n)return r;let s=o.getLineContent(i);if(t.shouldIgnore(i)||/^\s+$/.test(s)||s===""){r=i;continue}return i}}return-1}function Fb(o,e,t,n=!0,i){if(o<4)return null;let r=i.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;let s=new fx(e,r,i);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=A9(e,t,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=e.getLineContent(a);return{indentation:qn(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=e.getLineContent(a);return{indentation:qn(l),action:null,line:a}}else{if(a===1)return{indentation:qn(e.getLineContent(a)),action:null,line:a};let l=a-1,d=r.getIndentMetadata(e.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(u)){c=u;break}return{indentation:qn(e.getLineContent(c+1)),action:null,line:c+1}}if(n)return{indentation:qn(e.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:qn(e.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let u=0;for(let h=c-1;h>0;h--)if(!s.shouldIndentNextLine(c)){u=h;break}return{indentation:qn(e.getLineContent(u+1)),action:null,line:u+1}}else if(s.shouldDecrease(c))return{indentation:qn(e.getLineContent(c)),action:null,line:c}}return{indentation:qn(e.getLineContent(1)),action:null,line:1}}}function fV(o,e,t,n,i){if(o<4)return null;let r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=i.getLanguageConfiguration(r).indentRulesSupport;if(!s)return null;e.tokenization.forceTokenization(t.startLineNumber);let l=new _u(e,i).getProcessedTokenContextAroundRange(t),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,u=qn(c.getLineContent()),h=O9(e,t.startLineNumber,c),m=bx(e,t.getStartPosition()),g=e.getLineContent(t.startLineNumber),f=qn(g),b=Fb(o,h,t.startLineNumber+1,void 0,i);if(!b){let C=m?f:u;return{beforeEnter:C,afterEnter:C}}let y=m?f:b.indentation;return b.action===1&&(y=n.shiftIndent(y)),s.shouldDecrease(d.getLineContent())&&(y=n.unshiftIndent(y)),{beforeEnter:m?f:u,afterEnter:y}}function bV(o,e,t,n,i,r){let s=o.autoIndent;if(s<4||bx(e,t.getStartPosition()))return null;let l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),d=r.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let u=new _u(e,r).getProcessedTokenContextAroundRange(t),h=u.beforeRangeProcessedTokens.getLineContent(),m=u.afterRangeProcessedTokens.getLineContent(),g=h+m,f=h+n+m;if(!d.shouldDecrease(g)&&d.shouldDecrease(f)){let y=Fb(s,e,t.startLineNumber,!1,r);if(!y)return null;let C=y.indentation;return y.action!==1&&(C=i.unshiftIndent(C)),C}let b=t.startLineNumber-1;if(b>0){let y=e.getLineContent(b);if(d.shouldIndentNextLine(y)&&d.shouldIncrease(f)){let S=Fb(s,e,t.startLineNumber,!1,r)?.indentation;if(S!==void 0){let w=e.getLineContent(t.startLineNumber),R=qn(w),N=i.shiftIndent(S)===R,A=/^\s*$/.test(g),P=o.autoClosingPairs.autoClosingPairsOpenByEnd.get(n),j=P&&P.length>0&&A;if(N&&j)return S}}}return null}function O9(o,e,t){return{tokenization:{getLineTokens:i=>i===e?t:o.tokenization.getLineTokens(i),getLanguageId:()=>o.getLanguageId(),getLanguageIdAtPosition:(i,r)=>o.getLanguageIdAtPosition(i,r)},getLineContent:i=>i===e?t.getLineContent():o.getLineContent(i)}}var fx=class{_indentRulesSupport;_indentationLineProcessor;constructor(e,t,n){this._indentRulesSupport=t,this._indentationLineProcessor=new vx(e,n)}shouldIncrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(n)}shouldDecrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(n)}shouldIgnore(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(n)}shouldIndentNextLine(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(n)}},_u=class{model;indentationLineProcessor;constructor(e,t){this.model=e,this.indentationLineProcessor=new vx(e,t)}getProcessedTokenContextAroundRange(e){let t=this._getProcessedTokensBeforeRange(e),n=this._getProcessedTokensAfterRange(e),i=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:n,previousLineProcessedTokens:i}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);let t=this.model.tokenization.getLineTokens(e.startLineNumber),n=ha(t,e.startColumn-1),i;if(bx(this.model,e.getStartPosition())){let s=e.startColumn-1-n.firstCharOffset,a=n.firstCharOffset,l=a+s;i=t.sliceAndInflate(a,l,0)}else{let s=e.startColumn-1;i=t.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(i)}_getProcessedTokensAfterRange(e){let t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);let n=this.model.tokenization.getLineTokens(t.lineNumber),i=ha(n,t.column-1),r=t.column-1-i.firstCharOffset,s=i.firstCharOffset+r,a=i.firstCharOffset+i.getLineLength(),l=n.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){let t=m=>{this.model.tokenization.forceTokenization(m);let g=this.model.tokenization.getLineTokens(m),f=this.model.getLineMaxColumn(m)-1;return ha(g,f)};this.model.tokenization.forceTokenization(e.startLineNumber);let n=this.model.tokenization.getLineTokens(e.startLineNumber),i=ha(n,e.startColumn-1),r=yn.createEmpty("",i.languageIdCodec),s=e.startLineNumber-1;if(s===0||!(i.firstCharOffset===0))return r;let d=t(s);if(!(i.languageId===d.languageId))return r;let u=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}},vx=class{constructor(e,t){this.model=e;this.languageConfigurationService=t}getProcessedLine(e,t){let n=(s,a)=>{let l=qn(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(e);let i=this.model.tokenization.getLineTokens(e),r=this.getProcessedTokens(i).getLineContent();return t!==void 0&&(r=n(r,t)),r}getProcessedTokens(e){let t=l=>l===2||l===3||l===1,n=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew.getBracketRegExp({global:!0}),s=[];return e.forEach(l=>{let d=e.getStandardTokenType(l),c=e.getTokenText(l);t(d)&&(c=c.replace(r,""));let u=e.getMetadata(l);s.push({text:c,metadata:u})}),yn.createFromTextAndMetadata(s,e.languageIdCodec)}};function bx(o,e){o.tokenization.forceTokenization(e.lineNumber);let t=o.tokenization.getLineTokens(e.lineNumber),n=ha(t,e.column-1),i=n.firstCharOffset===0,r=t.getLanguageId(0)===n.languageId;return!i&&!r}function Bb(o,e,t,n){e.tokenization.forceTokenization(t.startLineNumber);let i=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(i);if(!r)return null;let a=new _u(e,n).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),u=r.onEnter(o,l,d,c);if(!u)return null;let h=u.indentAction,m=u.appendText,g=u.removeText||0;m?h===1&&(m="	"+m):h===1||h===2?m="	":m="";let f=rI(e,t.startLineNumber,t.startColumn);return g&&(f=f.substring(0,f.length-g)),{indentAction:h,appendText:m,removeText:g,indentation:f}}var iR=Object.create(null);function Tu(o,e){if(e<=0)return"";iR[o]||(iR[o]=["",o]);let t=iR[o];for(let n=t.length;n<=e;n++)t[n]=t[n-1]+o;return t[e]}var mr=class{constructor(e,t,n){this._languageConfigurationService=n;this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,n,i,r){let s=Rt.visibleColumnFromColumn(e,t,n);if(r){let a=Tu(" ",i),d=Rt.prevIndentTabStop(s,i)/i;return Tu(a,d)}else{let a="	",d=Rt.prevRenderTabStop(s,n)/n;return Tu(a,d)}}static shiftIndent(e,t,n,i,r){let s=Rt.visibleColumnFromColumn(e,t,n);if(r){let a=Tu(" ",i),d=Rt.nextIndentTabStop(s,i)/i;return Tu(a,d)}else{let a="	",d=Rt.nextRenderTabStop(s,n)/n;return Tu(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(e,t,n){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,n):e.addEditOperation(t,n)}getEditOperations(e,t){let n=this._selection.startLineNumber,i=this._selection.endLineNumber;this._selection.endColumn===1&&n!==i&&(i=i-1);let{tabSize:r,indentSize:s,insertSpaces:a}=this._opts,l=n===i;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let u=n;u<=i;u++,d=c){c=0;let h=e.getLineContent(u),m=ln(h);if(this._opts.isUnshift&&(h.length===0||m===0)||!l&&!this._opts.isUnshift&&h.length===0)continue;if(m===-1&&(m=h.length),u>1&&Rt.visibleColumnFromColumn(h,m+1,r)%s!==0&&e.tokenization.isCheapToTokenize(u-1)){let b=Bb(this._opts.autoIndent,e,new L(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(b){if(c=d,b.appendText)for(let y=0,C=b.appendText.length;y<C&&c<s&&b.appendText.charCodeAt(y)===32;y++)c++;b.removeText&&(c=Math.max(0,c-b.removeText));for(let y=0;y<c&&!(m===0||h.charCodeAt(m-1)!==32);y++)m--}}if(this._opts.isUnshift&&m===0)continue;let g;this._opts.isUnshift?g=mr.unshiftIndent(h,m+1,r,s,a):g=mr.shiftIndent(h,m+1,r,s,a),this._addEditOperation(t,new L(u,1,u,m+1),g),u===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=m+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(n)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?Tu(" ",s):"	";for(let c=n;c<=i;c++){let u=e.getLineContent(c),h=ln(u);if(!(this._opts.isUnshift&&(u.length===0||h===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(h===-1&&(h=u.length),!(this._opts.isUnshift&&h===0)))if(this._opts.isUnshift){h=Math.min(h,s);for(let m=0;m<h;m++)if(u.charCodeAt(m)===9){h=m+1;break}this._addEditOperation(t,new L(c,1,c,h+1),"")}else this._addEditOperation(t,new L(c,1,c,1),d),c===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let i=t.getInverseEditOperations()[0];return new Ue(i.range.endLineNumber,i.range.endColumn,i.range.endLineNumber,i.range.endColumn)}let n=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let i=this._selection.startColumn;return n.startColumn<=i?n:n.getDirection()===0?new Ue(n.startLineNumber,i,n.endLineNumber,n.endColumn):new Ue(n.endLineNumber,n.endColumn,n.startLineNumber,i)}return n}};mr=k([E(2,Rr)],mr);var yx=class{_range;_charBeforeSelection;_charAfterSelection;constructor(e,t,n){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=n}getEditOperations(e,t){t.addTrackedEditOperation(new L(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new L(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let n=t.getInverseEditOperations(),i=n[0].range,r=n[1].range;return new Ue(i.endLineNumber,i.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}},Ix=class{constructor(e,t,n){this._position=e;this._text=t;this._charAfter=n}getEditOperations(e,t){t.addTrackedEditOperation(new L(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return new Ue(i.endLineNumber,i.startColumn,i.endLineNumber,i.endColumn-this._charAfter.length)}};var Cx=class{static getEdits(e,t,n,i,r){if(!r&&this._isAutoIndentType(e,t,n)){let s=[];for(let l of n){let d=this._findActualIndentationForSelection(e,t,l,i);if(d===null)return;s.push({selection:l,indentation:d})}let a=Jp.getAutoClosingPairClose(e,t,n,i,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,s,i,a)}}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let i=0,r=n.length;i<r;i++)if(!t.tokenization.isCheapToTokenize(n[i].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,n,i){let r=bV(e,t,n,i,{shiftIndent:a=>Vb(e,a),unshiftIndent:a=>nm(e,a)},e.languageConfigurationService);if(r===null)return null;let s=rI(t,n.startLineNumber,n.startColumn);return r===e.normalizeIndentation(s)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,n,i,r){let s=n.map(({selection:l,indentation:d})=>{if(r!==null){let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!1);return new rR(c,l,i,r)}else{let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!0);return Lu(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new Wn(4,s,a)}static _getEditFromIndentationAndSelection(e,t,n,i,r,s=!0){let a=i.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a),d=e.normalizeIndentation(n);if(l!==0){let u=t.getLineContent(a);d+=u.substring(l-1,i.startColumn-1)}return d+=s?r:"",{range:new L(a,1,i.endLineNumber,i.endColumn),text:d}}},Sx=class{static getEdits(e,t,n,i,r,s){if(IV(t,n,i,r,s))return this._runAutoClosingOvertype(e,i,s)}static _runAutoClosingOvertype(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let l=t[r].getPosition(),d=new L(l.lineNumber,l.column,l.lineNumber,l.column+1);i[r]=new xi(d,n)}return new Wn(4,i,{shouldPushStackElementBefore:kx(e,4),shouldPushStackElementAfter:!1})}},xx=class{static getEdits(e,t,n,i,r){if(IV(e,t,n,i,r)){let s=n.map(a=>new xi(new L(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new Wn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},Jp=class{static getEdits(e,t,n,i,r,s){if(!s){let a=this.getAutoClosingPairClose(e,t,n,i,r);if(a!==null)return this._runAutoClosingOpenCharType(n,i,r,a)}}static _runAutoClosingOpenCharType(e,t,n,i){let r=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];r[s]=new oR(l,t,!n,i)}return new Wn(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,n,i,r){for(let g of n)if(!g.isEmpty())return null;let s=n.map(g=>{let f=g.getPosition();return r?{lineNumber:f.lineNumber,beforeColumn:f.column-i.length,afterColumn:f.column}:{lineNumber:f.lineNumber,beforeColumn:f.column,afterColumn:f.column}}),a=this._findAutoClosingPairOpen(e,t,s.map(g=>new V(g.lineNumber,g.beforeColumn)),i);if(!a)return null;let l,d;if(Os(i)?(l=e.autoClosingQuotes,d=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,d=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,d=e.shouldAutoCloseBefore.bracket),l==="never")return null;let u=this._findContainedAutoClosingPair(e,a),h=u?u.close:"",m=!0;for(let g of s){let{lineNumber:f,beforeColumn:b,afterColumn:y}=g,C=t.getLineContent(f),S=C.substring(0,b-1),w=C.substring(y-1);if(w.startsWith(h)||(m=!1),w.length>0){let A=w.charAt(0);if(!this._isBeforeClosingBrace(e,w)&&!d(A))return null}if(a.open.length===1&&(i==="'"||i==='"')&&l!=="always"){let A=aa(e.wordSeparators,[]);if(S.length>0){let P=S.charCodeAt(S.length-1);if(A.get(P)===0)return null}}if(!t.tokenization.isCheapToTokenize(f))return null;t.tokenization.forceTokenization(f);let R=t.tokenization.getLineTokens(f),M=ha(R,b-1);if(!a.shouldAutoClose(M,b-M.firstCharOffset))return null;let N=a.findNeutralCharacter();if(N){let A=t.tokenization.getTokenTypeIfInsertingCharacter(f,b,N);if(!a.isOK(A))return null}}return m?a.close.substring(0,a.close.length-h.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;let n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[],r=null;for(let s of i)s.open!==t.open&&t.open.includes(s.open)&&t.close.endsWith(s.close)&&(!r||s.open.length>r.open.length)&&(r=s);return r}static _findAutoClosingPairOpen(e,t,n,i){let r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!r)return null;let s=null;for(let a of r)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of n)if(t.getValueInRange(new L(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+i!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(e,t){let n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],s=i.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!s&&a}},Ex=class{static getEdits(e,t,n,i,r){if(!r&&this._isSurroundSelectionType(e,t,n,i))return this._runSurroundSelectionType(e,n,i)}static _runSurroundSelectionType(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=e.surroundingPairs[n];i[r]=new yx(a,n,l)}return new Wn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,n,i){if(!aR(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;let r=Os(i);for(let s of n){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=t.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,u=l===s.endLineNumber?s.endColumn-1:d.length,h=d.substring(c,u);if(/[^ \t]/.test(h)){a=!1;break}}if(a)return!1;if(r&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=t.getValueInRange(s);if(Os(l))return!1}}return!0}},wx=class{static getEdits(e,t,n,i,r,s){if(!s&&this._isTypeInterceptorElectricChar(t,n,i)){let a=this._typeInterceptorElectricChar(e,t,n,i[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,n){return!!(n.length===1&&t.tokenization.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,i,r){if(!t.electricChars.hasOwnProperty(r)||!i.isEmpty())return null;let s=i.getPosition();n.tokenization.forceTokenization(s.lineNumber);let a=n.tokenization.getLineTokens(s.lineNumber),l;try{l=t.onElectricCharacter(r,a,s.column)}catch(d){return Ne(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,c=n.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let u=n.getLineContent(c.startLineNumber),h=qn(u),m=t.normalizeIndentation(h),g=n.getLineContent(s.lineNumber),f=n.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,b=g.substring(f-1,s.column-1),y=m+b+r,C=new L(s.lineNumber,1,s.lineNumber,s.column),S=new xi(C,y);return new Wn(sR(y,e),[S],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},_x=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new xi(t[s],n);let r=sR(n,e);return new Wn(r,i,{shouldPushStackElementBefore:kx(e,r),shouldPushStackElementAfter:!1})}},em=class{static getEdits(e,t,n,i,r){if(!r&&i===`
`){let s=[];for(let a=0,l=n.length;a<l;a++)s[a]=this._enter(e,t,!1,n[a]);return new Wn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,n,i){if(e.autoIndent===0)return Lu(i,`
`,n);if(!t.tokenization.isCheapToTokenize(i.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(i.startLineNumber),d=qn(l).substring(0,i.startColumn-1);return Lu(i,`
`+e.normalizeIndentation(d),n)}let r=Bb(e.autoIndent,t,i,e.languageConfigurationService);if(r){if(r.indentAction===0)return Lu(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===1)return Lu(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===2){let l=e.normalizeIndentation(r.indentation),d=e.normalizeIndentation(r.indentation+r.appendText),c=`
`+d+`
`+l;return n?new Eu(i,c,!0):new wu(i,c,-1,d.length-l.length,!0)}else if(r.indentAction===3){let l=nm(e,r.indentation);return Lu(i,`
`+e.normalizeIndentation(l+r.appendText),n)}}let s=t.getLineContent(i.startLineNumber),a=qn(s).substring(0,i.startColumn-1);if(e.autoIndent>=4){let l=fV(e.autoIndent,t,i,{unshiftIndent:d=>nm(e,d),shiftIndent:d=>Vb(e,d),normalizeIndentation:d=>e.normalizeIndentation(d)},e.languageConfigurationService);if(l){let d=e.visibleColumnFromColumn(t,i.getEndPosition()),c=i.endColumn,u=t.getLineContent(i.endLineNumber),h=ln(u);if(h>=0?i=i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,h+1)):i=i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new Eu(i,`
`+e.normalizeIndentation(l.afterEnter),!0);{let m=0;return c<=h+1&&(e.insertSpaces||(d=Math.ceil(d/e.indentSize)),m=Math.min(d+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new wu(i,`
`+e.normalizeIndentation(l.afterEnter),0,m,!0)}}}return Lu(i,`
`+e.normalizeIndentation(a),n)}static lineInsertBefore(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber;if(a===1)i[r]=new Eu(new L(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new L(a,l,a,l))}}return i}static lineInsertAfter(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber,l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new L(a,l,a,l))}return i}static lineBreakInsert(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=this._enter(e,t,!0,n[r]);return i}},Tx=class{static getEdits(e,t,n,i,r,s){let a=this._distributePasteToCursors(e,n,i,r,s);return a?(n=n.sort(L.compareRangesUsingStarts),this._distributedPaste(e,t,n,a)):this._simplePaste(e,t,n,i,r)}static _distributePasteToCursors(e,t,n,i,r){if(i||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){n.charCodeAt(n.length-1)===10&&(n=n.substring(0,n.length-1)),n.charCodeAt(n.length-1)===13&&(n=n.substring(0,n.length-1));let s=Sc(n);if(s.length===t.length)return s}return null}static _distributedPaste(e,t,n,i){let r=[];for(let s=0,a=n.length;s<a;s++)r[s]=new xi(n[s],i[s]);return new Wn(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,r){let s=[];for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.getPosition();if(r&&!d.isEmpty()&&(r=!1),r&&i.indexOf(`
`)!==i.length-1&&(r=!1),r){let u=new L(c.lineNumber,1,c.lineNumber,1);s[a]=new mx(u,i,d,!0)}else s[a]=new xi(d,i)}return new Wn(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},Lx=class{static getEdits(e,t,n,i,r,s,a,l){let d=i.map(c=>this._compositionType(n,c,r,s,a,l));return new Wn(4,d,{shouldPushStackElementBefore:kx(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,r,s){if(!t.isEmpty())return null;let a=t.getPosition(),l=Math.max(1,a.column-i),d=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),c=new L(a.lineNumber,l,a.lineNumber,d);return e.getValueInRange(c)===n&&s===0?null:new wu(c,n,0,s)}},Dx=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new xi(t[s],n);let r=sR(n,e);return new Wn(r,i,{shouldPushStackElementBefore:kx(e,r),shouldPushStackElementAfter:!1})}},Rx=class{static getCommands(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(e,t,a.startLineNumber);d=d||"	";let c=e.normalizeIndentation(d);if(!l.startsWith(c)){i[r]=new xi(new L(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}i[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){i[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}i[r]=new mr(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return i}static _goodIndentForLine(e,t,n){let i=null,r="",s=Fb(e.autoIndent,t,n,!1,e.languageConfigurationService);if(s)i=s.action,r=s.indentation;else if(n>1){let a;for(a=n-1;a>=1;a--){let c=t.getLineContent(a);if(_r(c)>=0)break}if(a<1)return null;let l=t.getLineMaxColumn(a),d=Bb(e.autoIndent,t,new L(a,l,a,l),e.languageConfigurationService);d&&(r=d.indentation+d.appendText)}return i&&(i===1&&(r=Vb(e,r)),i===3&&(r=nm(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,n,i){let r="",s=n.getStartPosition();if(e.insertSpaces){let a=e.visibleColumnFromColumn(t,s),l=e.indentSize,d=l-a%l;for(let c=0;c<d;c++)r+=" "}else r="	";return new xi(n,r,i)}},tm=class extends wu{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(e,t,n,i,r,s){super(e,t,n,i),this._openCharacter=r,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,n){return this.closeCharacterRange=new L(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new L(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,n)}},oR=class extends tm{constructor(e,t,n,i){let r=(n?t:"")+i,s=0,a=-i.length;super(e,r,s,a,t,i)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,i,t)}},rR=class extends tm{_autoIndentationEdit;_autoClosingEdit;constructor(e,t,n,i){let r=n+i,s=0,a=n.length;super(t,r,s,a,n,i),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){let n=t.getInverseEditOperations();if(n.length!==2)throw new Error("There should be two inverse edit operations!");let i=n[0].range,r=n[1].range,s=i.plusRange(r);return this._computeCursorStateWithRange(e,s,t)}};function sR(o,e){return o===" "?e===5||e===6?6:5:4}function kx(o,e){return yV(o)&&!yV(e)?!0:o===5?!1:vV(o)!==vV(e)}function vV(o){return o===6||o===5?"space":o}function yV(o){return o===4||o===5||o===6}function IV(o,e,t,n,i){if(o.autoClosingOvertype==="never"||!o.autoClosingPairs.autoClosingPairsCloseSingleChar.has(i))return!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(!a.isEmpty())return!1;let l=a.getPosition(),d=e.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==i)return!1;let u=Os(i);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&u)return!1;if(o.autoClosingOvertype==="auto"){let m=!1;for(let g=0,f=n.length;g<f;g++){let b=n[g];if(l.lineNumber===b.startLineNumber&&l.column===b.startColumn){m=!0;break}}if(!m)return!1}}return!0}function Lu(o,e,t){return t?new Eu(o,e,!0):new xi(o,e,!0)}function Vb(o,e,t){return t=t||1,mr.shiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function nm(o,e,t){return t=t||1,mr.unshiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function aR(o,e){return Os(e)?o.autoSurround==="quotes"||o.autoSurround==="languageDefined":o.autoSurround==="brackets"||o.autoSurround==="languageDefined"}var Bs=class{static indent(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new mr(n[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static outdent(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new mr(n[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static shiftIndent(e,t,n){return Vb(e,t,n)}static unshiftIndent(e,t,n){return nm(e,t,n)}static paste(e,t,n,i,r,s){return Tx.getEdits(e,t,n,i,r,s)}static tab(e,t,n){return Rx.getCommands(e,t,n)}static compositionType(e,t,n,i,r,s,a,l){return Lx.getEdits(e,t,n,i,r,s,a,l)}static compositionEndWithInterceptors(e,t,n,i,r,s){if(!i)return null;let a=null;for(let h of i)if(a===null)a=h.insertedText;else if(a!==h.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let h of i)if(h.deletedText.length!==0){d=!0;break}if(d){if(!aR(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;let h=Os(l);for(let f of i)if(f.deletedSelectionStart!==0||f.deletedSelectionEnd!==f.deletedText.length||/^[ \t]+$/.test(f.deletedText)||h&&Os(f.deletedText))return null;let m=[];for(let f of r){if(!f.isEmpty())return null;m.push(f.getPosition())}if(m.length!==i.length)return null;let g=[];for(let f=0,b=m.length;f<b;f++)g.push(new Ix(m[f],i[f].deletedText,t.surroundingPairs[l]));return new Wn(4,g,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=xx.getEdits(t,n,r,s,l);if(c!==void 0)return c;let u=Jp.getEdits(t,n,r,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(e,t,n,i,r,s,a){let l=em.getEdits(n,i,r,a,e);if(l!==void 0)return l;let d=Cx.getEdits(n,i,r,a,e);if(d!==void 0)return d;let c=Sx.getEdits(t,n,i,r,s,a);if(c!==void 0)return c;let u=Jp.getEdits(n,i,r,a,!1,e);if(u!==void 0)return u;let h=Ex.getEdits(n,i,r,a,e);if(h!==void 0)return h;let m=wx.getEdits(t,n,i,r,a,e);return m!==void 0?m:_x.getEdits(t,r,a)}static typeWithoutInterceptors(e,t,n,i,r){return Dx.getEdits(e,i,r)}},Mx=class{constructor(e,t,n,i,r,s){this.deletedText=e;this.deletedSelectionStart=t;this.deletedSelectionEnd=n;this.insertedText=i;this.insertedSelectionStart=r;this.insertedSelectionEnd=s}};var ae;(Pe=>(Pe.editorSimpleInput=new De("editorSimpleInput",!1,!0),Pe.editorTextFocus=new De("editorTextFocus",!1,p("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),Pe.focus=new De("editorFocus",!1,p("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),Pe.textInputFocus=new De("textInputFocus",!1,p("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),Pe.readOnly=new De("editorReadonly",!1,p("editorReadonly","Whether the editor is read-only")),Pe.inDiffEditor=new De("inDiffEditor",!1,p("inDiffEditor","Whether the context is a diff editor")),Pe.isEmbeddedDiffEditor=new De("isEmbeddedDiffEditor",!1,p("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),Pe.multiDiffEditorAllCollapsed=new De("multiDiffEditorAllCollapsed",void 0,p("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),Pe.hasChanges=new De("diffEditorHasChanges",!1,p("diffEditorHasChanges","Whether the diff editor has changes")),Pe.comparingMovedCode=new De("comparingMovedCode",!1,p("comparingMovedCode","Whether a moved code block is selected for comparison")),Pe.accessibleDiffViewerVisible=new De("accessibleDiffViewerVisible",!1,p("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),Pe.diffEditorRenderSideBySideInlineBreakpointReached=new De("diffEditorRenderSideBySideInlineBreakpointReached",!1,p("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),Pe.diffEditorInlineMode=new De("diffEditorInlineMode",!1,p("diffEditorInlineMode","Whether inline mode is active")),Pe.diffEditorOriginalWritable=new De("diffEditorOriginalWritable",!1,p("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),Pe.diffEditorModifiedWritable=new De("diffEditorModifiedWritable",!1,p("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),Pe.diffEditorOriginalUri=new De("diffEditorOriginalUri","",p("diffEditorOriginalUri","The uri of the original document")),Pe.diffEditorModifiedUri=new De("diffEditorModifiedUri","",p("diffEditorModifiedUri","The uri of the modified document")),Pe.columnSelection=new De("editorColumnSelection",!1,p("editorColumnSelection","Whether `editor.columnSelection` is enabled")),Pe.writable=Pe.readOnly.toNegated(),Pe.hasNonEmptySelection=new De("editorHasSelection",!1,p("editorHasSelection","Whether the editor has text selected")),Pe.hasOnlyEmptySelection=Pe.hasNonEmptySelection.toNegated(),Pe.hasMultipleSelections=new De("editorHasMultipleSelections",!1,p("editorHasMultipleSelections","Whether the editor has multiple selections")),Pe.hasSingleSelection=Pe.hasMultipleSelections.toNegated(),Pe.tabMovesFocus=new De("editorTabMovesFocus",!1,p("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),Pe.tabDoesNotMoveFocus=Pe.tabMovesFocus.toNegated(),Pe.isInEmbeddedEditor=new De("isInEmbeddedEditor",!1,!0),Pe.canUndo=new De("canUndo",!1,!0),Pe.canRedo=new De("canRedo",!1,!0),Pe.hoverVisible=new De("editorHoverVisible",!1,p("editorHoverVisible","Whether the editor hover is visible")),Pe.hoverFocused=new De("editorHoverFocused",!1,p("editorHoverFocused","Whether the editor hover is focused")),Pe.stickyScrollFocused=new De("stickyScrollFocused",!1,p("stickyScrollFocused","Whether the sticky scroll is focused")),Pe.stickyScrollVisible=new De("stickyScrollVisible",!1,p("stickyScrollVisible","Whether the sticky scroll is visible")),Pe.standaloneColorPickerVisible=new De("standaloneColorPickerVisible",!1,p("standaloneColorPickerVisible","Whether the standalone color picker is visible")),Pe.standaloneColorPickerFocused=new De("standaloneColorPickerFocused",!1,p("standaloneColorPickerFocused","Whether the standalone color picker is focused")),Pe.inCompositeEditor=new De("inCompositeEditor",void 0,p("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),Pe.notInCompositeEditor=Pe.inCompositeEditor.toNegated(),Pe.languageId=new De("editorLangId","",p("editorLangId","The language identifier of the editor")),Pe.hasCompletionItemProvider=new De("editorHasCompletionItemProvider",!1,p("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),Pe.hasCodeActionsProvider=new De("editorHasCodeActionsProvider",!1,p("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),Pe.hasCodeLensProvider=new De("editorHasCodeLensProvider",!1,p("editorHasCodeLensProvider","Whether the editor has a code lens provider")),Pe.hasDefinitionProvider=new De("editorHasDefinitionProvider",!1,p("editorHasDefinitionProvider","Whether the editor has a definition provider")),Pe.hasDeclarationProvider=new De("editorHasDeclarationProvider",!1,p("editorHasDeclarationProvider","Whether the editor has a declaration provider")),Pe.hasImplementationProvider=new De("editorHasImplementationProvider",!1,p("editorHasImplementationProvider","Whether the editor has an implementation provider")),Pe.hasTypeDefinitionProvider=new De("editorHasTypeDefinitionProvider",!1,p("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),Pe.hasHoverProvider=new De("editorHasHoverProvider",!1,p("editorHasHoverProvider","Whether the editor has a hover provider")),Pe.hasDocumentHighlightProvider=new De("editorHasDocumentHighlightProvider",!1,p("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),Pe.hasDocumentSymbolProvider=new De("editorHasDocumentSymbolProvider",!1,p("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),Pe.hasReferenceProvider=new De("editorHasReferenceProvider",!1,p("editorHasReferenceProvider","Whether the editor has a reference provider")),Pe.hasRenameProvider=new De("editorHasRenameProvider",!1,p("editorHasRenameProvider","Whether the editor has a rename provider")),Pe.hasSignatureHelpProvider=new De("editorHasSignatureHelpProvider",!1,p("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),Pe.hasInlayHintsProvider=new De("editorHasInlayHintsProvider",!1,p("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),Pe.hasDocumentFormattingProvider=new De("editorHasDocumentFormattingProvider",!1,p("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),Pe.hasDocumentSelectionFormattingProvider=new De("editorHasDocumentSelectionFormattingProvider",!1,p("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),Pe.hasMultipleDocumentFormattingProvider=new De("editorHasMultipleDocumentFormattingProvider",!1,p("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),Pe.hasMultipleDocumentSelectionFormattingProvider=new De("editorHasMultipleDocumentSelectionFormattingProvider",!1,p("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(ae||={});var tt=0,Kt=class extends Hp{runEditorCommand(e,t,n){let i=t._getViewModel();i&&this.runCoreEditorCommand(i,n||{})}},Ei;(a=>{let o=function(l){if(!hn(l))return!1;let d=l;return!(!sn(d.to)||!an(d.by)&&!sn(d.by)||!an(d.value)&&!mi(d.value)||!an(d.revealCursor)&&!Gv(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function i(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let u=Math.floor(l.value||1),h=!!l.revealCursor;return{direction:d,unit:c,value:u,revealCursor:h,select:!!l.select}}a.parse=i;let r;(h=>(h[h.Up=1]="Up",h[h.Right=2]="Right",h[h.Down=3]="Down",h[h.Left=4]="Left"))(r=a.Direction||={});let s;(g=>(g[g.Line=1]="Line",g[g.WrappedLine=2]="WrappedLine",g[g.Page=3]="Page",g[g.HalfPage=4]="HalfPage",g[g.Editor=5]="Editor",g[g.Column=6]="Column"))(s=a.Unit||={})})(Ei||={});var Wb;(n=>{let o=function(i){if(!hn(i))return!1;let r=i;return!(!mi(r.lineNumber)&&!sn(r.lineNumber)||!an(r.at)&&!sn(r.at))};n.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:o,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(Wb||={});var Hb=class{constructor(e){e.addImplementation(1e4,"code-editor",(t,n)=>{let i=t.get(yo).getFocusedCodeEditor();return i&&i.hasTextFocus()?this._runEditorCommand(t,i,n):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,n)=>{let i=Wo();return i&&Ra(i)?(this.runDOMCommand(i),!0):!1}),e.addImplementation(0,"generic-dom",(t,n)=>{let i=t.get(yo).getActiveCodeEditor();return i?(i.focus(),this._runEditorCommand(t,i,n)):!1})}_runEditorCommand(e,t,n){let i=this.runEditorCommand(e,t,n);return i||!0}};var Hn;(fe=>{class o extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){if(!te.position)return;O.model.pushStackElement(),O.setCursorStates(te.source,3,[Jn.moveTo(O,O.getPrimaryCursorState(),this._inSelectionMode,te.position,te.viewPosition)])&&te.revealType!==2&&O.revealAllCursors(te.source,!0,!0)}}fe.MoveTo=He(new o({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),fe.MoveToSelect=He(new o({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class n extends Kt{runCoreEditorCommand(O,te){O.model.pushStackElement();let ge=this._getColumnSelectResult(O,O.getPrimaryCursorState(),O.getCursorColumnSelectData(),te);ge!==null&&(O.setCursorStates(te.source,3,ge.viewStates.map($e=>Ke.fromViewState($e))),O.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:ge.fromLineNumber,fromViewVisualColumn:ge.fromVisualColumn,toViewLineNumber:ge.toLineNumber,toViewVisualColumn:ge.toVisualColumn}),ge.reversed?O.revealTopMostCursor(te.source):O.revealBottomMostCursor(te.source))}}fe.ColumnSelect=He(new class extends n{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(re,O,te,ge){if(typeof ge.position>"u"||typeof ge.viewPosition>"u"||typeof ge.mouseColumn>"u")return null;let $e=re.model.validatePosition(ge.position),xt=re.coordinatesConverter.validateViewPosition(new V(ge.viewPosition.lineNumber,ge.viewPosition.column),$e),ni=ge.doColumnSelect?te.fromViewLineNumber:xt.lineNumber,Ti=ge.doColumnSelect?te.fromViewVisualColumn:ge.mouseColumn-1;return Xd.columnSelect(re.cursorConfig,re,ni,Ti,xt.lineNumber,ge.mouseColumn-1)}}),fe.CursorColumnSelectLeft=He(new class extends n{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(re,O,te,ge){return Xd.columnSelectLeft(re.cursorConfig,re,te)}}),fe.CursorColumnSelectRight=He(new class extends n{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(re,O,te,ge){return Xd.columnSelectRight(re.cursorConfig,re,te)}});class a extends n{_isPaged;constructor(O){super(O),this._isPaged=O.isPaged}_getColumnSelectResult(O,te,ge,$e){return Xd.columnSelectUp(O.cursorConfig,O,ge,this._isPaged)}}fe.CursorColumnSelectUp=He(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:3600,linux:{primary:0}}})),fe.CursorColumnSelectPageUp=He(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends n{_isPaged;constructor(O){super(O),this._isPaged=O.isPaged}_getColumnSelectResult(O,te,ge,$e){return Xd.columnSelectDown(O.cursorConfig,O,ge,this._isPaged)}}fe.CursorColumnSelectDown=He(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:3602,linux:{primary:0}}})),fe.CursorColumnSelectPageDown=He(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:3596,linux:{primary:0}}}));class m extends Kt{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Ve.metadata})}runCoreEditorCommand(O,te){let ge=Ve.parse(te);ge&&this._runCursorMove(O,te.source,ge)}_runCursorMove(O,te,ge){O.model.pushStackElement(),O.setCursorStates(te,3,m._move(O,O.getCursorStates(),ge)),O.revealAllCursors(te,!0)}static _move(O,te,ge){let $e=ge.select,xt=ge.value;switch(ge.direction){case Ve.Direction.Left:case Ve.Direction.Right:case Ve.Direction.Up:case Ve.Direction.Down:case Ve.Direction.PrevBlankLine:case Ve.Direction.NextBlankLine:case Ve.Direction.WrappedLineStart:case Ve.Direction.WrappedLineFirstNonWhitespaceCharacter:case Ve.Direction.WrappedLineColumnCenter:case Ve.Direction.WrappedLineEnd:case Ve.Direction.WrappedLineLastNonWhitespaceCharacter:return Jn.simpleMove(O,te,ge.direction,$e,xt,ge.unit);case Ve.Direction.ViewPortTop:case Ve.Direction.ViewPortBottom:case Ve.Direction.ViewPortCenter:case Ve.Direction.ViewPortIfOutside:return Jn.viewportMove(O,te,ge.direction,$e,xt);default:return null}}}fe.CursorMoveImpl=m,fe.CursorMove=He(new m);let f;(O=>O[O.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(f||={});class b extends Kt{_staticArgs;constructor(O){super(O),this._staticArgs=O.args}runCoreEditorCommand(O,te){let ge=this._staticArgs;this._staticArgs.value===-1&&(ge={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:te.pageSize||O.cursorConfig.pageSize}),O.model.pushStackElement(),O.setCursorStates(te.source,3,Jn.simpleMove(O,O.getCursorStates(),ge.direction,ge.select,ge.value,ge.unit)),O.revealAllCursors(te.source,!0)}}fe.CursorLeft=He(new b({args:{direction:Ve.Direction.Left,unit:Ve.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),fe.CursorLeftSelect=He(new b({args:{direction:Ve.Direction.Left,unit:Ve.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:1039}})),fe.CursorRight=He(new b({args:{direction:Ve.Direction.Right,unit:Ve.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),fe.CursorRightSelect=He(new b({args:{direction:Ve.Direction.Right,unit:Ve.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:1041}})),fe.CursorUp=He(new b({args:{direction:Ve.Direction.Up,unit:Ve.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),fe.CursorUpSelect=He(new b({args:{direction:Ve.Direction.Up,unit:Ve.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),fe.CursorPageUp=He(new b({args:{direction:Ve.Direction.Up,unit:Ve.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:11}})),fe.CursorPageUpSelect=He(new b({args:{direction:Ve.Direction.Up,unit:Ve.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:1035}})),fe.CursorDown=He(new b({args:{direction:Ve.Direction.Down,unit:Ve.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),fe.CursorDownSelect=He(new b({args:{direction:Ve.Direction.Down,unit:Ve.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),fe.CursorPageDown=He(new b({args:{direction:Ve.Direction.Down,unit:Ve.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:12}})),fe.CursorPageDownSelect=He(new b({args:{direction:Ve.Direction.Down,unit:Ve.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:1036}})),fe.CreateCursor=He(new class extends Kt{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(re,O){if(!O.position)return;let te;O.wholeLine?te=Jn.line(re,re.getPrimaryCursorState(),!1,O.position,O.viewPosition):te=Jn.moveTo(re,re.getPrimaryCursorState(),!1,O.position,O.viewPosition);let ge=re.getCursorStates();if(ge.length>1){let $e=te.modelState?te.modelState.position:null,xt=te.viewState?te.viewState.position:null;for(let ni=0,Ti=ge.length;ni<Ti;ni++){let We=ge[ni];if(!($e&&!We.modelState.selection.containsPosition($e))&&!(xt&&!We.viewState.selection.containsPosition(xt))){ge.splice(ni,1),re.model.pushStackElement(),re.setCursorStates(O.source,3,ge);return}}}ge.push(te),re.model.pushStackElement(),re.setCursorStates(O.source,3,ge)}}),fe.LastCursorMoveToSelect=He(new class extends Kt{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(re,O){if(!O.position)return;let te=re.getLastAddedCursorIndex(),ge=re.getCursorStates(),$e=ge.slice(0);$e[te]=Jn.moveTo(re,ge[te],!0,O.position,O.viewPosition),re.model.pushStackElement(),re.setCursorStates(O.source,3,$e)}});class q extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){O.model.pushStackElement(),O.setCursorStates(te.source,3,Jn.moveToBeginningOfLine(O,O.getCursorStates(),this._inSelectionMode)),O.revealAllCursors(te.source,!0)}}fe.CursorHome=He(new q({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),fe.CursorHomeSelect=He(new q({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class ie extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){O.model.pushStackElement(),O.setCursorStates(te.source,3,this._exec(O.getCursorStates())),O.revealAllCursors(te.source,!0)}_exec(O){let te=[];for(let ge=0,$e=O.length;ge<$e;ge++){let xt=O[ge],ni=xt.modelState.position.lineNumber;te[ge]=Ke.fromModelState(xt.modelState.move(this._inSelectionMode,ni,1,0))}return te}}fe.CursorLineStart=He(new ie({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:0,mac:{primary:287}}})),fe.CursorLineStartSelect=He(new ie({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:0,mac:{primary:1311}}}));class xe extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){O.model.pushStackElement(),O.setCursorStates(te.source,3,Jn.moveToEndOfLine(O,O.getCursorStates(),this._inSelectionMode,te.sticky||!1)),O.revealAllCursors(te.source,!0)}}fe.CursorEnd=He(new xe({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:tt,kbExpr:ae.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:p("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),fe.CursorEndSelect=He(new xe({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:tt,kbExpr:ae.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:p("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class Re extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){O.model.pushStackElement(),O.setCursorStates(te.source,3,this._exec(O,O.getCursorStates())),O.revealAllCursors(te.source,!0)}_exec(O,te){let ge=[];for(let $e=0,xt=te.length;$e<xt;$e++){let ni=te[$e],Ti=ni.modelState.position.lineNumber,We=O.model.getLineMaxColumn(Ti);ge[$e]=Ke.fromModelState(ni.modelState.move(this._inSelectionMode,Ti,We,0))}return ge}}fe.CursorLineEnd=He(new Re({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:0,mac:{primary:291}}})),fe.CursorLineEndSelect=He(new Re({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:0,mac:{primary:1315}}}));class So extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){O.model.pushStackElement(),O.setCursorStates(te.source,3,Jn.moveToBeginningOfBuffer(O,O.getCursorStates(),this._inSelectionMode)),O.revealAllCursors(te.source,!0)}}fe.CursorTop=He(new So({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:2062,mac:{primary:2064}}})),fe.CursorTopSelect=He(new So({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:3086,mac:{primary:3088}}}));class wi extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){O.model.pushStackElement(),O.setCursorStates(te.source,3,Jn.moveToEndOfBuffer(O,O.getCursorStates(),this._inSelectionMode)),O.revealAllCursors(te.source,!0)}}fe.CursorBottom=He(new wi({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:2061,mac:{primary:2066}}})),fe.CursorBottomSelect=He(new wi({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:3085,mac:{primary:3090}}}));class Kl extends Kt{constructor(){super({id:"editorScroll",precondition:void 0,metadata:Ei.metadata})}determineScrollMethod(O){let te=[6],ge=[1,2,3,4,5,6],$e=[4,2],xt=[1,3];return te.includes(O.unit)&&$e.includes(O.direction)?this._runHorizontalEditorScroll.bind(this):ge.includes(O.unit)&&xt.includes(O.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(O,te){let ge=Ei.parse(te);if(!ge)return;let $e=this.determineScrollMethod(ge);$e&&$e(O,te.source,ge)}_runVerticalEditorScroll(O,te,ge){let $e=this._computeDesiredScrollTop(O,ge);if(ge.revealCursor){let xt=O.getCompletelyVisibleViewRangeAtScrollTop($e);O.setCursorStates(te,3,[Jn.findPositionInViewportIfOutside(O,O.getPrimaryCursorState(),xt,ge.select)])}O.viewLayout.setScrollPosition({scrollTop:$e},0)}_computeDesiredScrollTop(O,te){if(te.unit===1){let xt=O.viewLayout.getFutureViewport(),ni=O.getCompletelyVisibleViewRangeAtScrollTop(xt.top),Ti=O.coordinatesConverter.convertViewRangeToModelRange(ni),We;te.direction===1?We=Math.max(1,Ti.startLineNumber-te.value):We=Math.min(O.model.getLineCount(),Ti.startLineNumber+te.value);let x=O.coordinatesConverter.convertModelPositionToViewPosition(new V(We,1));return O.viewLayout.getVerticalOffsetForLineNumber(x.lineNumber)}if(te.unit===5){let xt=0;return te.direction===3&&(xt=O.model.getLineCount()-O.cursorConfig.pageSize),O.viewLayout.getVerticalOffsetForLineNumber(xt)}let ge;te.unit===3?ge=O.cursorConfig.pageSize*te.value:te.unit===4?ge=Math.round(O.cursorConfig.pageSize/2)*te.value:ge=te.value;let $e=(te.direction===1?-1:1)*ge;return O.viewLayout.getCurrentScrollTop()+$e*O.cursorConfig.lineHeight}_runHorizontalEditorScroll(O,te,ge){let $e=this._computeDesiredScrollLeft(O,ge);O.viewLayout.setScrollPosition({scrollLeft:$e},0)}_computeDesiredScrollLeft(O,te){let ge=(te.direction===4?-1:1)*te.value;return O.viewLayout.getCurrentScrollLeft()+ge*O.cursorConfig.typicalHalfwidthCharacterWidth}}fe.EditorScrollImpl=Kl,fe.EditorScroll=He(new Kl),fe.ScrollLineUp=He(new class extends Kt{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(re,O){fe.EditorScroll.runCoreEditorCommand(re,{to:Ei.RawDirection.Up,by:Ei.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:O.source})}}),fe.ScrollPageUp=He(new class extends Kt{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(re,O){fe.EditorScroll.runCoreEditorCommand(re,{to:Ei.RawDirection.Up,by:Ei.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:O.source})}}),fe.ScrollEditorTop=He(new class extends Kt{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus}})}runCoreEditorCommand(re,O){fe.EditorScroll.runCoreEditorCommand(re,{to:Ei.RawDirection.Up,by:Ei.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:O.source})}}),fe.ScrollLineDown=He(new class extends Kt{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(re,O){fe.EditorScroll.runCoreEditorCommand(re,{to:Ei.RawDirection.Down,by:Ei.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:O.source})}}),fe.ScrollPageDown=He(new class extends Kt{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(re,O){fe.EditorScroll.runCoreEditorCommand(re,{to:Ei.RawDirection.Down,by:Ei.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:O.source})}}),fe.ScrollEditorBottom=He(new class extends Kt{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus}})}runCoreEditorCommand(re,O){fe.EditorScroll.runCoreEditorCommand(re,{to:Ei.RawDirection.Down,by:Ei.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:O.source})}}),fe.ScrollLeft=He(new class extends Kt{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus}})}runCoreEditorCommand(re,O){fe.EditorScroll.runCoreEditorCommand(re,{to:Ei.RawDirection.Left,by:Ei.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:O.source})}}),fe.ScrollRight=He(new class extends Kt{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus}})}runCoreEditorCommand(re,O){fe.EditorScroll.runCoreEditorCommand(re,{to:Ei.RawDirection.Right,by:Ei.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:O.source})}});class Kr extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){te.position&&(O.model.pushStackElement(),O.setCursorStates(te.source,3,[Jn.word(O,O.getPrimaryCursorState(),this._inSelectionMode,te.position)]),te.revealType!==2&&O.revealAllCursors(te.source,!0,!0))}}fe.WordSelect=He(new Kr({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),fe.WordSelectDrag=He(new Kr({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),fe.LastCursorWordSelect=He(new class extends Kt{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(re,O){if(!O.position)return;let te=re.getLastAddedCursorIndex(),ge=re.getCursorStates(),$e=ge.slice(0),xt=ge[te];$e[te]=Jn.word(re,xt,xt.modelState.hasSelection(),O.position),re.model.pushStackElement(),re.setCursorStates(O.source,3,$e)}});class Us extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){te.position&&(O.model.pushStackElement(),O.setCursorStates(te.source,3,[Jn.line(O,O.getPrimaryCursorState(),this._inSelectionMode,te.position,te.viewPosition)]),te.revealType!==2&&O.revealAllCursors(te.source,!1,!0))}}fe.LineSelect=He(new Us({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),fe.LineSelectDrag=He(new Us({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class fr extends Kt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,te){if(!te.position)return;let ge=O.getLastAddedCursorIndex(),$e=O.getCursorStates(),xt=$e.slice(0);xt[ge]=Jn.line(O,$e[ge],this._inSelectionMode,te.position,te.viewPosition),O.model.pushStackElement(),O.setCursorStates(te.source,3,xt)}}fe.LastCursorLineSelect=He(new fr({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),fe.LastCursorLineSelectDrag=He(new fr({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),fe.CancelSelection=He(new class extends Kt{constructor(){super({id:"cancelSelection",precondition:ae.hasNonEmptySelection,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(re,O){re.model.pushStackElement(),re.setCursorStates(O.source,3,[Jn.cancelSelection(re,re.getPrimaryCursorState())]),re.revealAllCursors(O.source,!0)}}),fe.RemoveSecondaryCursors=He(new class extends Kt{constructor(){super({id:"removeSecondaryCursors",precondition:ae.hasMultipleSelections,kbOpts:{weight:tt+1,kbExpr:ae.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(re,O){re.model.pushStackElement(),re.setCursorStates(O.source,3,[re.getPrimaryCursorState()]),re.revealAllCursors(O.source,!0),Q1(p("removedCursor","Removed secondary cursors"))}}),fe.RevealLine=He(new class extends Kt{constructor(){super({id:"revealLine",precondition:void 0,metadata:Wb.metadata})}runCoreEditorCommand(re,O){let te=O,ge=te.lineNumber||0,$e=typeof ge=="number"?ge+1:parseInt(ge)+1;$e<1&&($e=1);let xt=re.model.getLineCount();$e>xt&&($e=xt);let ni=new L($e,1,$e,re.model.getLineMaxColumn($e)),Ti=0;if(te.at)switch(te.at){case Wb.RawAtArgument.Top:Ti=3;break;case Wb.RawAtArgument.Center:Ti=1;break;case Wb.RawAtArgument.Bottom:Ti=4;break;default:break}let We=re.coordinatesConverter.convertModelRangeToViewRange(ni);re.revealRange(O.source,!1,We,Ti,0)}}),fe.SelectAll=new class extends Hb{constructor(){super(dV)}runDOMCommand(re){Bn&&(re.focus(),re.select()),re.ownerDocument.execCommand("selectAll")}runEditorCommand(re,O,te){let ge=O._getViewModel();ge&&this.runCoreEditorCommand(ge,te)}runCoreEditorCommand(re,O){re.model.pushStackElement(),re.setCursorStates("keyboard",3,[Jn.selectAll(re,re.getPrimaryCursorState())])}},fe.SetSelection=He(new class extends Kt{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(re,O){O.selection&&(re.model.pushStackElement(),re.setCursorStates(O.source,3,[Ke.fromModelSelection(O.selection)]))}})})(Hn||={});var F9=ht.and(ae.textInputFocus,ae.columnSelection);function om(o,e){dd.registerKeybindingRule({id:o,primary:e,when:F9,weight:tt+1})}om(Hn.CursorColumnSelectLeft.id,1039);om(Hn.CursorColumnSelectRight.id,1041);om(Hn.CursorColumnSelectUp.id,1040);om(Hn.CursorColumnSelectPageUp.id,1035);om(Hn.CursorColumnSelectDown.id,1042);om(Hn.CursorColumnSelectPageDown.id,1036);function CV(o){return o.register(),o}var B9;(l=>{class o extends Hp{runEditorCommand(c,u,h){let m=u._getViewModel();m&&this.runCoreEditingCommand(u,m,h||{})}}l.CoreEditingCommand=o,l.LineBreakInsert=He(new class extends o{constructor(){super({id:"lineBreakInsert",precondition:ae.writable,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,em.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection)))}}),l.Outdent=He(new class extends o{constructor(){super({id:"outdent",precondition:ae.writable,kbOpts:{weight:tt,kbExpr:ht.and(ae.editorTextFocus,ae.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Bs.outdent(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection))),d.pushUndoStop()}}),l.Tab=He(new class extends o{constructor(){super({id:"tab",precondition:ae.writable,kbOpts:{weight:tt,kbExpr:ht.and(ae.editorTextFocus,ae.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Bs.tab(c.cursorConfig,c.model,c.getCursorStates().map(h=>h.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=He(new class extends o{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,u){let[h,m]=Nl.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(g=>g.modelState.selection),c.getCursorAutoClosedCharacters());h&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(2)}}),l.DeleteRight=He(new class extends o{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:tt,kbExpr:ae.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,u){let[h,m]=Nl.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(g=>g.modelState.selection));h&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(3)}}),l.Undo=new class extends Hb{constructor(){super(z0)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends Hb{constructor(){super(K0)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})(B9||={});var Nx=class extends yu{_handlerId;constructor(e,t,n){super({id:e,precondition:void 0,metadata:n}),this._handlerId=t}runCommand(e,t){let n=e.get(yo).getFocusedCodeEditor();n&&n.trigger("keyboard",this._handlerId,t)}};function Du(o,e){CV(new Nx("default:"+o,o)),CV(new Nx(o,o,e))}Du("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Du("replacePreviousChar");Du("compositionType");Du("compositionStart");Du("compositionEnd");Du("paste");Du("cut");var rm=class o{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(e){this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return o.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){let n={...e};return n.position&&(n.position=t.convertViewPositionToModelPosition(n.position)),n.range&&(n.range=t.convertViewRangeToModelRange(n.range)),(n.type===5||n.type===8)&&(n.detail=this.convertViewToModelViewZoneData(n.detail,t)),n}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new V(e.afterLineNumber,1)).lineNumber}}};var Ax=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(e,t,n,i){this.configuration=e,this.viewModel=t,this.userInputEvents=n,this.commandDelegate=i}paste(e,t,n,i){this.commandDelegate.paste(e,t,n,i)}type(e){this.commandDelegate.type(e)}compositionType(e,t,n,i){this.commandDelegate.compositionType(e,t,n,i)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Hn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){let t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new V(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){let t=this.configuration.options,n=Zt&&t.get(109),i=t.get(22);e.middleButton&&!n?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):i?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Hn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Hn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,n){e=this._validateViewColumn(e),Hn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:n})}_createCursor(e,t){e=this._validateViewColumn(e),Hn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Hn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Hn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Hn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Hn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Hn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Hn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Hn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Hn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Hn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}};var sm=class extends ts{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(e,t,n){super(),this._context=e,this.viewController=t,this.viewHelper=n,this.mouseTargetFactory=new Xp(this._context,n),this._mouseDownOperation=this._register(new lR(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let i=new YS(this.viewHelper.viewDomNode);this._register(i.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(i.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=z(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new ns(a,!1,this.viewHelper.viewDomNode))}))})),this._register(i.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(i.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let r=0;this._register(i.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{r=a})),this._register(z(this.viewHelper.viewDomNode,me.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(i.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let e=lb.INSTANCE,t=0,n=oa.getZoomLevel(),i=!1,r=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Nr(l);if(e.acceptStandardWheelEvent(d),e.isPhysicalMouseWheel()){if(a(l)){let c=oa.getZoomLevel(),u=d.deltaY>0?1:-1;oa.setZoomLevel(c+u),d.preventDefault(),d.stopPropagation()}}else Date.now()-t>50&&(n=oa.getZoomLevel(),i=a(l),r=0),t=Date.now(),r+=d.deltaY,i&&(oa.setZoomLevel(n+r/5),d.preventDefault(),d.stopPropagation())};this._register(z(this.viewHelper.viewDomNode,me.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return Fe?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(147)){let t=this._context.configuration.options.get(147).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){let i=new Tb(e,t).toPageCoordinates(Ce(this.viewHelper.viewDomNode)),r=QS(this.viewHelper.viewDomNode);if(i.y<r.y||i.y>r.y+r.height||i.x<r.x||i.x>r.x+r.width)return null;let s=JS(this.viewHelper.viewDomNode,r,i);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,i,s,null)}_createMouseTarget(e,t){let n=e.target;if(!this.viewHelper.viewDomNode.contains(n)){let i=xl(this.viewHelper.viewDomNode);i&&(n=i.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?n:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){let n=this._createMouseTarget(e,!0),i=n.type===6||n.type===7,r=n.type===2||n.type===3||n.type===4,s=n.type===3,a=this._context.configuration.options.get(111),l=n.type===8||n.type===5,d=n.type===9,c=e.leftButton||e.middleButton;Fe&&e.leftButton&&e.ctrlKey&&(c=!1);let u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(i||s&&a))u(),this._mouseDownOperation.start(n.type,e,t);else if(r)e.preventDefault();else if(l){let h=n.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(h.viewZoneId)&&(u(),this._mouseDownOperation.start(n.type,e,t),e.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(n.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:n})}_onMouseWheel(e){this.viewController.emitMouseWheel(e)}},lR=class extends B{constructor(t,n,i,r,s,a){super();this._context=t;this._viewController=n;this._viewHelper=i;this._mouseTargetFactory=r;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new XS(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new dR(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new uR,this._currentSelection=new Ue(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);let n=this._findMousePosition(t,!1);n&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:n}):n.type===13&&(n.outsidePosition==="above"||n.outsidePosition==="below")?this._topBottomDragScrolling.start(n,t):(this._topBottomDragScrolling.stop(),this._dispatchMouse(n,!0,1)))}start(t,n,i){this._lastMouseEvent=n,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(n),this._mouseState.setModifiers(n);let r=this._findMousePosition(n,!0);if(!r||!r.position)return;this._mouseState.trySetCount(n.detail,r.position),n.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&n.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&r.type===6&&r.position&&this._currentSelection.containsPosition(r.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);U1(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(r,n.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){let n=t.editorPos,i=this._context.viewModel,r=this._context.viewLayout,s=this._getMouseColumn(t);if(t.posy<n.y){let l=n.y-t.posy,d=Math.max(r.getCurrentScrollTop()-l,0),c=Zp.getZoneAtCoord(this._context,d);if(c){let h=this._helpPositionJumpOverViewZone(c);if(h)return Qn.createOutsideEditor(s,h,"above",l)}let u=r.getLineNumberAtVerticalOffset(d);return Qn.createOutsideEditor(s,new V(u,1),"above",l)}if(t.posy>n.y+n.height){let l=t.posy-n.y-n.height,d=r.getCurrentScrollTop()+t.relativePos.y,c=Zp.getZoneAtCoord(this._context,d);if(c){let h=this._helpPositionJumpOverViewZone(c);if(h)return Qn.createOutsideEditor(s,h,"below",l)}let u=r.getLineNumberAtVerticalOffset(d);return Qn.createOutsideEditor(s,new V(u,i.getLineMaxColumn(u)),"below",l)}let a=r.getLineNumberAtVerticalOffset(r.getCurrentScrollTop()+t.relativePos.y);if(t.posx<n.x){let l=n.x-t.posx;return Qn.createOutsideEditor(s,new V(a,1),"left",l)}if(t.posx>n.x+n.width){let l=t.posx-n.x-n.width;return Qn.createOutsideEditor(s,new V(a,i.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(t,n){let i=this._getPositionOutsideEditor(t);if(i)return i;let r=this._createMouseTarget(t,n);if(!r.position)return null;if(r.type===8||r.type===5){let a=this._helpPositionJumpOverViewZone(r.detail);if(a)return Qn.createViewZone(r.type,r.element,r.mouseColumn,a,r.detail)}return r}_helpPositionJumpOverViewZone(t){let n=new V(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=t.positionBefore,r=t.positionAfter;return i&&r?i.isBefore(n)?i:r:null}_dispatchMouse(t,n,i){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:n,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}},dR=class extends B{constructor(t,n,i,r){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(t,n){this._operation?this._operation.setPosition(t,n):this._operation=new cR(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,n)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},cR=class extends B{constructor(t,n,i,r,s,a){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=Ii(Ce(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,n){this._position=t,this._mouseEvent=n}_tick(){let t=Date.now(),n=t-this._lastTime;return this._lastTime=t,n}_getScrollSpeed(){let t=this._context.configuration.options.get(68),n=this._context.configuration.options.get(147).height/t,i=this._position.outsideDistance/t;return i<=1.5?Math.max(30,n*(1+i)):i<=3?Math.max(60,n*(2+i)):Math.max(200,n*(7+i))}_execute(){let t=this._context.configuration.options.get(68),n=this._getScrollSpeed(),i=this._tick(),r=n*(i/1e3)*t,s=this._position.outsidePosition==="above"?-r:r;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=QS(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(147).horizontalScrollbarHeight,h=new Zd(this._mouseEvent.pos.x,c.y+c.height-u-.1),m=JS(this._viewHelper.viewDomNode,c,h);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,h,m,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=Qn.createOutsideEditor(this._position.mouseColumn,new V(l,1),"above",this._position.outsideDistance):d=Qn.createOutsideEditor(this._position.mouseColumn,new V(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=Ii(Ce(d.element),()=>this._execute())}},uR=class o{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let n=new Date().getTime();n-this._lastSetMouseDownCountTime>o.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=n,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};function Ox(o,e,t,n){let i=o.getPlainTextToCopy(e,t,ft),r=o.model.getEOL(),s=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(i)?i:null,l=Array.isArray(i)?i.join(r):i,d,c=null;if(W9.forceCopyWithSyntaxHighlighting||n&&l.length<65536){let h=o.getRichTextToCopy(e,t);h&&(d=h.html,c=h.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var Ru=class o{static INSTANCE=new o;_lastState;constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}},W9={forceCopyWithSyntaxHighlighting:!1};var am=class o{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){let n=e*t,i=n+1,r=n+t;return new L(i,1,r+1,1)}static fromEditorSelection(e,t,n,i){let s=o._getPageOfLine(t.startLineNumber,n),a=o._getRangeForPage(s,n),l=o._getPageOfLine(t.endLineNumber,n),d=o._getRangeForPage(l,n),c=a.intersectRanges(new L(1,1,t.startLineNumber,t.startColumn));if(i&&e.getValueLengthInRange(c,1)>500){let y=e.modifyPosition(c.getEndPosition(),-500);c=L.fromPositions(y,c.getEndPosition())}let u=e.getValueInRange(c,1),h=e.getLineCount(),m=e.getLineMaxColumn(h),g=d.intersectRanges(new L(t.endLineNumber,t.endColumn,h,m));if(i&&e.getValueLengthInRange(g,1)>500){let y=e.modifyPosition(g.getStartPosition(),500);g=L.fromPositions(g.getStartPosition(),y)}let f=e.getValueInRange(g,1),b;if(s===l||s+1===l)b=e.getValueInRange(t,1);else{let y=a.intersectRanges(t),C=d.intersectRanges(t);b=e.getValueInRange(y,1)+"\u2026"+e.getValueInRange(C,1)}return i&&b.length>2*500&&(b=b.substring(0,500)+"\u2026"+b.substring(b.length-500,b.length)),{value:u+b+f,selection:t,selectionStart:u.length,selectionEnd:u.length+b.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function zb(o,e){if(o.get(2)===1){let n=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),i=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),r=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=p("accessibilityModeOff","The editor is not accessible at this time.");return n?p("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,n):i?p("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,i):r?p("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,r):s}return o.get(4)}function Kb(o){let e=0,t=-1;do{if(t=o.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var Ko=!1,ei=class o{constructor(e,t,n,i,r){this.value=e;this.selectionStart=t;this.selectionEnd=n;this.selection=i;this.newlineCountBeforeSelection=r}static EMPTY=new o("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){let n=e.getValue(),i=e.getSelectionStart(),r=e.getSelectionEnd(),s;if(t){let a=n.substring(0,i),l=t.value.substring(0,t.selectionStart);a===l&&(s=t.newlineCountBeforeSelection)}return new o(n,i,r,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new o(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,n){Ko&&console.log(`writeToTextArea ${e}: ${this.toString()}`),t.setValue(e,this.value),n&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){let i=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,i,-1)}if(e>=this.selectionEnd){let i=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,1)}let t=this.value.substring(this.selectionStart,e);if(t.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);let n=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,-1)}_finishDeduceEditorPosition(e,t,n){let i=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)i++;return[e,n*t.length,i]}static deduceInput(e,t,n){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};Ko&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`));let i=Math.min(xg(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(Eg(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd),s=e.value.substring(i,e.value.length-r),a=t.value.substring(i,t.value.length-r),l=e.selectionStart-i,d=e.selectionEnd-i,c=t.selectionStart-i,u=t.selectionEnd-i;if(Ko&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${u}`)),c===u){let m=e.selectionStart-i;return Ko&&console.log(`REMOVE PREVIOUS: ${m} chars`),{text:a,replacePrevCharCnt:m,replaceNextCharCnt:0,positionDelta:0}}let h=d-l;return{text:a,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(Ko&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`)),e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};let n=Math.min(xg(e.value,t.value),e.selectionEnd),i=Math.min(Eg(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(n,e.value.length-i),s=t.value.substring(n,t.value.length-i),a=e.selectionStart-n,l=e.selectionEnd-n,d=t.selectionStart-n,c=t.selectionEnd-n;return Ko&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${r}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:r.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(e){return new o(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};var Fx;(e=>e.Tap="-monaco-textarea-synthetic-tap")(Fx||={});var hR=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";let t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}},lm=class extends B{constructor(t,n,i,r,s,a){super();this._host=t;this._textArea=n;this._OS=i;this._browser=r;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new Yt(()=>this._onCut.fire(),0)),this._textAreaState=ei.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(Y.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new Yt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new vt(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new vt(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{Ko&&console.log("[compositionstart]",d);let c=new hR;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){Ko&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{Ko&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let h=ei.readFromTextArea(this._textArea,this._textAreaState),m=ei.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(m),this._onCompositionUpdate.fire(d);return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=ei.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{Ko&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let h=ei.readFromTextArea(this._textArea,this._textAreaState),m=ei.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(m),this._onCompositionEnd.fire();return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=ei.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(Ko&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=ei.readFromTextArea(this._textArea,this._textAreaState),u=ei.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(qt(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&this._onType.fire(u))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,u]=SV.getTextData(d.clipboardData);c&&(u=u||Ru.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new Yt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new T);onFocus=this._onFocus.event;_onBlur=this._register(new T);onBlur=this._onBlur.event;_onKeyDown=this._register(new T);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new T);onKeyUp=this._onKeyUp.event;_onCut=this._register(new T);onCut=this._onCut.event;_onPaste=this._register(new T);onPaste=this._onPaste.event;_onType=this._register(new T);onType=this._onType.event;_onCompositionStart=this._register(new T);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new T);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new T);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new T);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new rn);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=ei.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let t=0;return z(this._textArea.ownerDocument,"selectionchange",n=>{if(Rl.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let i=Date.now(),r=i-t;if(t=i,r<5)return;let s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(c[0],c[1],c[2]),h=this._textAreaState.deduceEditorPosition(d),m=this._host.deduceModelPosition(h[0],h[1],h[2]),g=new Ue(u.lineNumber,u.column,m.lineNumber,m.column);this._onSelectionChangeRequest.fire(g)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,n){this._hasFocus||(n=n.collapseSelection()),n.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=n}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){let n=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:n.isFromEmptySelection,multicursorText:n.multicursorText,mode:n.mode};Ru.INSTANCE.set(this._browser.isFirefox?n.text.replace(/\r\n/g,`
`):n.text,i),t.preventDefault(),t.clipboardData&&SV.setTextData(t.clipboardData,n.text,n.html,i)}};lm=k([E(4,Jo),E(5,Fn)],lm);var SV={getTextData(o){let e=o.getData(Vc.text),t=null,n=o.getData("vscode-editor-data");if(typeof n=="string")try{t=JSON.parse(n),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&o.files.length>0?[Array.prototype.slice.call(o.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(o,e,t,n){o.setData(Vc.text,e),typeof t=="string"&&o.setData("text/html",t),o.setData("vscode-editor-data",JSON.stringify(n))}},Px=class extends B{constructor(t){super();this._actual=t;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>Rl.onKeyDown())),this._register(this.onBeforeInput(()=>Rl.onBeforeInput())),this._register(this.onInput(()=>Rl.onInput())),this._register(this.onKeyUp(()=>Rl.onKeyUp())),this._register(z(this._actual,Fx.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new Oe(this._actual,"keydown")).event;onKeyPress=this._register(new Oe(this._actual,"keypress")).event;onKeyUp=this._register(new Oe(this._actual,"keyup")).event;onCompositionStart=this._register(new Oe(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new Oe(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new Oe(this._actual,"compositionend")).event;onBeforeInput=this._register(new Oe(this._actual,"beforeinput")).event;onInput=this._register(new Oe(this._actual,"input")).event;onCut=this._register(new Oe(this._actual,"cut")).event;onCopy=this._register(new Oe(this._actual,"copy")).event;onPaste=this._register(new Oe(this._actual,"paste")).event;onFocus=this._register(new Oe(this._actual,"focus")).event;onBlur=this._register(new Oe(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new T);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let t=xl(this._actual);return t?t.activeElement===this._actual:this._actual.isConnected?Wo()===this._actual:!1}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,n){let i=this._actual;i.value!==n&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=n)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,n,i){let r=this._actual,s=null,a=xl(r);a?s=a.activeElement:s=Wo();let l=Ce(s),d=s===r,c=r.selectionStart,u=r.selectionEnd;if(d&&c===n&&u===i){Bn&&l.parent!==l&&r.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),r.setSelectionRange(n,i),Bn&&l.parent!==l&&r.focus();return}try{let h=YB(r);this.setIgnoreSelectionChangeTime("setSelectionRange"),r.focus(),r.setSelectionRange(n,i),ZB(r,h)}catch{}}};var pR=class extends sm{_lastPointerType;constructor(e,t,n){super(e,t,n),this._register(Ln.addTarget(this.viewHelper.linesContentDomNode)),this._register(z(this.viewHelper.linesContentDomNode,yt.Tap,r=>this.onTap(r))),this._register(z(this.viewHelper.linesContentDomNode,yt.Change,r=>this.onChange(r))),this._register(z(this.viewHelper.linesContentDomNode,yt.Contextmenu,r=>this._onContextMenu(new ns(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(z(this.viewHelper.linesContentDomNode,"pointerdown",r=>{let s=r.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let i=new ZS(this.viewHelper.viewDomNode);this._register(i.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(i.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(i.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(i.onPointerDown(this.viewHelper.viewDomNode,(r,s)=>this._onMouseDown(r,s)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){let n=this._createMouseTarget(new ns(e,!1,this.viewHelper.viewDomNode),!1);n.position&&this.viewController.dispatchMouse({position:n.position,mouseColumn:n.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:n.type===6&&n.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}},mR=class extends sm{constructor(e,t,n){super(e,t,n),this._register(Ln.addTarget(this.viewHelper.linesContentDomNode)),this._register(z(this.viewHelper.linesContentDomNode,yt.Tap,i=>this.onTap(i))),this._register(z(this.viewHelper.linesContentDomNode,yt.Change,i=>this.onChange(i))),this._register(z(this.viewHelper.linesContentDomNode,yt.Contextmenu,i=>this._onContextMenu(new ns(i,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();let t=this._createMouseTarget(new ns(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){let n=document.createEvent("CustomEvent");n.initEvent(Fx.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(n),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}},Bx=class extends B{handler;constructor(e,t,n){super(),(Zl||$M&&UM)&&NC.pointerEvents?this.handler=this._register(new pR(e,t,n)):_e.TouchEvent?this.handler=this._register(new mR(e,t,n)):this.handler=this._register(new sm(e,t,n))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}};var Io=class extends ts{};var Vx=class extends Bt{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(e){super(e),this._visibleLines=new Kp({createLine:()=>new gR(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let n=this._context.configuration.options.get(51);Cn(this.domNode,n),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);let n=this._context.configuration.options.get(51);return Cn(this.domNode,n),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(n=>n.shouldRender());for(let n=0,i=t.length;n<i;n++){let r=t[n];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}},gR=class{_dynamicOverlays;_domNode;_renderedContent;constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=Be(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,n,i,r){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(i.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;">'),r.appendString(s),r.appendString("</div>"),!0)}layoutLine(e,t,n){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(n))}},Wx=class extends Vx{_contentWidth;constructor(e){super(e);let n=this._context.configuration.options.get(147);this._contentWidth=n.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._contentWidth=n.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}},Hx=class extends Vx{_contentLeft;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._contentLeft=n.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),Cn(this.domNode,t.get(51))}onConfigurationChanged(e){let t=this._context.configuration.options;Cn(this.domNode,t.get(51));let n=t.get(147);return this._contentLeft=n.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);let t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}};var Ux=class extends Bt{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(e){super(e),this.domNode=Be(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1,n=this._context.configuration.options.get(147),i=n.contentWidth-n.verticalScrollbarWidth;this.contentWidth!==i&&(this.contentWidth=i,e=!0);let r=n.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0,n=e.getDecorationsInViewport();for(let i of n){if(!i.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=Be(document.createElement("div")),this.domNode.appendChild(r));let s,a;i.options.blockIsAfterEnd?(s=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0)):(s=e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!0),a=i.range.isEmpty()&&!i.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0));let[l,d,c,u]=i.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+i.options.blockClassName),r.setLeft(this.contentLeft-u),r.setWidth(this.contentWidth+u+d),r.setTop(s-e.scrollTop-l),r.setHeight(a-s+l+c),t++}for(let i=t;i<this.blocks.length;i++)this.blocks[i].domNode.remove();this.blocks.length=t}};var zx=class extends Bt{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=Be(document.createElement("div")),Xn.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Be(document.createElement("div")),Xn.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){let e=Object.keys(this._widgets);for(let t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){let t=new bR(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,n,i,r){this._widgets[e.getId()].setPosition(t,n,i,r),this.setShouldRender()}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let n=this._widgets[t];delete this._widgets[t];let i=n.domNode.domNode;i.remove(),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onBeforeRender(e)}prepareRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].prepareRender(e)}render(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].render(e)}},bR=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new ku(null,null);_secondaryAnchor=new ku(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(e,t,n){this._context=e,this._viewDomNode=t,this._actual=n,this.domNode=Be(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let i=this._context.configuration.options,r=i.get(147);this._fixedOverflowWidgets=i.get(43),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=i.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){let t=this._context.configuration.options;if(this._lineHeight=t.get(68),e.hasChanged(147)){let n=t.get(147);this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,n){this._affinity=e,this._primaryAnchor=i(t,this._context.viewModel,this._affinity),this._secondaryAnchor=i(n,this._context.viewModel,this._affinity);function i(r,s,a){if(!r)return new ku(null,null);let l=s.model.validatePosition(r);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new ku(r,d)}return new ku(r,null)}}_getMaxWidth(){let e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,n,i){this._setPosition(i,e,t),this._preference=n,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,n,i){let r=e.top,s=r,a=e.top+e.height,l=i.viewportHeight-a,d=r-n,c=s>=n,u=a,h=l>=n,m=e.left;return m+t>i.scrollLeft+i.viewportWidth&&(m=i.scrollLeft+i.viewportWidth-t),m<i.scrollLeft&&(m=i.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:h,belowTop:u,left:m}}_layoutHorizontalSegmentInPage(e,t,n,i){let a=Math.max(15,t.left-i),l=Math.min(t.left+t.width+i,e.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,u=t.left+n-(c?.scrollX??0);if(u+i>l){let h=u-(l-i);u-=h,n-=h}if(u<a){let h=u-a;u-=h,n-=h}return[n,u]}_layoutBoxInPage(e,t,n,i){let r=e.top-n,s=e.top+e.height,a=cr(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+r-(d?.scrollY??0),u=a.top+s-(d?.scrollY??0),h=tu(l.body),[m,g]=this._layoutHorizontalSegmentInPage(h,a,e.left-i.scrollLeft+this._contentLeft,t),f=22,b=22,y=c>=f,C=u+n<=h.height-b;return this._fixedOverflowWidgets?{fitsAbove:y,aboveTop:Math.max(c,f),fitsBelow:C,belowTop:u,left:g}:{fitsAbove:y,aboveTop:r,fitsBelow:C,belowTop:s,left:m}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new Mu(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){let t=r(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),n=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,i=r(n,this._affinity,this._lineHeight);return{primary:t,secondary:i};function r(s,a,l){if(!s)return null;let d=e.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,u=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.scrollTop;return new Kx(u,c,l)}}_reduceAnchorCoordinates(e,t,n){if(!t)return e;let i=this._context.configuration.options.get(51),r=t.left;return r<e.left?r=Math.max(r,e.left-n+i.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+n-i.typicalFullwidthCharacterWidth),new Kx(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;let{primary:t,secondary:n}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=fR(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let i=this._reduceAnchorCoordinates(t,n,this._cachedDomNodeOffsetWidth),r;this.allowEditorOverflow?r=this._layoutBoxInPage(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!r)return null;if(s===2||r.fitsAbove)return{kind:"inViewport",coordinate:new Mu(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(s===2||r.fitsBelow)return{kind:"inViewport",coordinate:new Mu(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new Mu(i.top,i.left)),position:0}:{kind:"inViewport",coordinate:new Mu(i.top,i.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&fR(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&fR(this._actual.afterRender,this._actual,this._renderData.position)}},ku=class{constructor(e,t){this.modelPosition=e;this.viewPosition=t}},Mu=class{constructor(e,t){this.top=e;this.left=t}_coordinateBrand=void 0},Kx=class{constructor(e,t,n){this.top=e;this.left=t;this.height=n}_anchorCoordinateBrand=void 0};function fR(o,e,...t){try{return o.call(e,...t)}catch{return null}}var Gx=class extends Io{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(e){super(),this._context=e;let t=this._context.configuration.options,n=t.get(147);this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Ue(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1,t=new Set;for(let r of this._selections)t.add(r.positionLineNumber);let n=Array.from(t);n.sort((r,s)=>r-s),Lt(this._cursorLineNumbers,n)||(this._cursorLineNumbers=n,e=!0);let i=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=[];for(let s=t;s<=n;s++){let a=s-t;i[a]=""}if(this._wordWrap){let s=this._renderOne(e,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new V(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new V(d,1)).lineNumber,u=l.convertModelPositionToViewPosition(new V(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,h=Math.max(c,t),m=Math.min(u,n);for(let g=h;g<=m;g++){let f=g-t;i[f]=s}}}let r=this._renderOne(e,!0);for(let s of this._cursorLineNumbers){if(s<t||s>n)continue;let a=s-t;i[a]=r}this._renderData=i}render(e,t){if(!this._renderData)return"";let n=t-e;return n>=this._renderData.length?"":this._renderData[n]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},jx=class extends Gx{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},$x=class extends Gx{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};mo((o,e)=>{let t=o.getColor(TD);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||o.defines(LD)){let n=o.getColor(LD);n&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${n}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${n}; }`),Dd(o.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var qx=class extends Io{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let l=0,d=t.length;l<d;l++){let c=t[l];c.options.className&&(n[i++]=c)}n=n.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,u=d.options.className;return c<u?-1:c>u?1:L.compareRangesUsingStarts(l.range,d.range)});let r=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=s;l++){let d=l-r;a[d]=""}this._renderWholeLineDecorations(e,n,a),this._renderNormalDecorations(e,n,a),this._renderResult=a}_renderWholeLineDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){let l=t[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,i),u=Math.min(l.range.endLineNumber,r);for(let h=c;h<=u;h++){let m=h-i;n[m]+=d}}}_renderNormalDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=null,s=!1,a=null,l=!1;for(let d=0,c=t.length;d<c;d++){let u=t[d];if(u.options.isWholeLine)continue;let h=u.options.className,m=!!u.options.showIfCollapsed,g=u.range;if(m&&g.endColumn===1&&g.endLineNumber!==g.startLineNumber&&(g=new L(g.startLineNumber,g.startColumn,g.endLineNumber-1,this._context.viewModel.getLineMaxColumn(g.endLineNumber-1))),r===h&&s===m&&L.areIntersectingOrTouching(a,g)){a=L.plusRange(a,g);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n),r=h,s=m,a=g,l=u.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n)}_renderNormalDecoration(e,t,n,i,r,s,a){let l=e.linesVisibleRangesForRange(t,n==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let u=l[d];if(u.outsideRenderedLine)continue;let h=u.lineNumber-s;if(r&&u.ranges.length===1){let m=u.ranges[0];if(m.width<this._typicalHalfwidthCharacterWidth){let g=Math.round(m.left+m.width/2),f=Math.max(0,Math.round(g-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new zp(f,this._typicalHalfwidthCharacterWidth)}}for(let m=0,g=u.ranges.length;m<g;m++){let f=i&&u.continuesOnNextLine&&g===1,b=u.ranges[m],y='<div class="cdr '+n+'" style="left:'+String(b.left)+"px;width:"+(f?"100%;":String(b.width)+"px;")+'"></div>';a[h]+=y}}}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};var Yx=class extends Bt{scrollbar;scrollbarDomNode;constructor(e,t,n,i){super(e);let r=this._context.configuration.options,s=r.get(105),a=r.get(76),l=r.get(41),d=r.get(108),c={listenOnDomNode:n.domNode,className:"editor-scrollable "+xf(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new zd(t.domNode,c,this._context.viewLayout.getScrollable())),Xn.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=Be(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let u=(h,m,g)=>{let f={};if(m){let b=h.scrollTop;b&&(f.scrollTop=this._context.viewLayout.getCurrentScrollTop()+b,h.scrollTop=0)}if(g){let b=h.scrollLeft;b&&(f.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+b,h.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(f,1)};this._register(z(n.domNode,"scroll",h=>u(n.domNode,!0,!0))),this._register(z(t.domNode,"scroll",h=>u(t.domNode,!0,!1))),this._register(z(i.domNode,"scroll",h=>u(i.domNode,!0,!1))),this._register(z(this.scrollbarDomNode.domNode,"scroll",h=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let e=this._context.configuration.options,t=e.get(147);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(74).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(105)||e.hasChanged(76)||e.hasChanged(41)){let t=this._context.configuration.options,n=t.get(105),i=t.get(76),r=t.get(41),s=t.get(108),a={vertical:n.vertical,horizontal:n.horizontal,verticalScrollbarSize:n.verticalScrollbarSize,horizontalScrollbarSize:n.horizontalScrollbarSize,scrollByPage:n.scrollByPage,handleMouseWheel:n.handleMouseWheel,mouseWheelScrollSensitivity:i,fastScrollSensitivity:r,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return e.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+xf(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}};var Nu=class{constructor(e,t,n,i,r){this.startLineNumber=e;this.endLineNumber=t;this.className=n;this.tooltip=i;this.zIndex=r??0}_decorationToRenderBrand=void 0;zIndex},vR=class{constructor(e,t,n){this.className=e;this.zIndex=t;this.tooltip=n}},yR=class{decorations=[];add(e){this.decorations.push(e)}getDecorations(){return this.decorations}},dm=class extends Io{_render(e,t,n){let i=[];for(let a=e;a<=t;a++){let l=a-e;i[l]=new yR}if(n.length===0)return i;n.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,s=0;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.className,u=d.zIndex,h=Math.max(d.startLineNumber,e)-e,m=Math.min(d.endLineNumber,t)-e;r===c?(h=Math.max(s+1,h),s=Math.max(s,m)):(r=c,s=m);for(let g=h;g<=s;g++)i[g].add(new vR(c,u,d.tooltip))}return i}},Zx=class extends Bt{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(e){super(e),this._context=e;let t=this._context.configuration.options,n=t.get(147);this.domNode=Be(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){let t=Be(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let n=this._widgets[e.getId()];return n.preference.lane===t.lane&&n.preference.zIndex===t.zIndex&&L.equalsRange(n.preference.range,t.range)?!1:(n.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId();if(this._widgets[t]){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(let s of r){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,n),d=Math.min(s.range.endLineNumber,i),c=s.options.glyphMargin?.position??2,u=s.options.zIndex??0;for(let h=l;h<=d;h++){let m=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new V(h,0)),g=this._context.viewModel.glyphLanes.getLanesAtLine(m.lineNumber).indexOf(c);t.push(new IR(h,g,u,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let r of Object.values(this._widgets)){let s=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(L.lift(s));if(!a||!l||l<n||a>i)continue;let d=Math.max(a,n),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new V(d,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(r.preference.lane);t.push(new CR(d,u,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){let t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((n,i)=>n.lineNumber===i.lineNumber?n.laneIndex===i.laneIndex?n.zIndex===i.zIndex?i.type===n.type?n.type===0&&i.type===0?n.className<i.className?-1:1:0:i.type-n.type:i.zIndex-n.zIndex:n.laneIndex-i.laneIndex:n.lineNumber-i.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let i of Object.values(this._widgets))i.renderInfo=null;let t=new Li(this._collectSortedGlyphRenderRequests(e)),n=[];for(;t.length>0;){let i=t.peek();if(!i)break;let r=t.takeWhile(a=>a.lineNumber===i.lineNumber&&a.laneIndex===i.laneIndex);if(!r||r.length===0)break;let s=r[0];if(s.type===0){let a=[];for(let l of r){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}n.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=n}render(e){if(!this._glyphMargin){for(let n of Object.values(this._widgets))n.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let n of Object.values(this._widgets))if(!n.renderInfo)n.domNode.setDisplay("none");else{let i=e.viewportData.relativeVerticalOffset[n.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+n.renderInfo.laneIndex*this._lineHeight;n.domNode.setDisplay("block"),n.domNode.setTop(i),n.domNode.setLeft(r),n.domNode.setWidth(t),n.domNode.setHeight(this._lineHeight)}for(let n=0;n<this._decorationGlyphsToRender.length;n++){let i=this._decorationGlyphsToRender[n],r=e.viewportData.relativeVerticalOffset[i.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+i.laneIndex*this._lineHeight,a;n<this._managedDomNodes.length?a=this._managedDomNodes[n]:(a=Be(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+i.combinedClassName),a.setPosition("absolute"),a.setTop(r),a.setLeft(s),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var IR=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.className=i}type=0;accept(e){return new SR(this.lineNumber,this.laneIndex,e)}},CR=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.widget=i}type=1},SR=class{constructor(e,t,n){this.lineNumber=e;this.laneIndex=t;this.combinedClassName=n}};var Xx=class extends Io{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(e){super(),this._context=e,this._primaryPosition=null;let t=this._context.configuration.options,n=t.get(148),i=t.get(51);this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(148),i=t.get(51);return this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){let n=e.selections[0].getPosition();return this._primaryPosition?.equals(n)?!1:(this._primaryPosition=n,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=e.scrollWidth,r=this._primaryPosition,s=this.getGuidesByLine(t,Math.min(n+1,this._context.viewModel.getLineCount()),r),a=[];for(let l=t;l<=n;l++){let d=l-t,c=s[d],u="",h=e.visibleRangeForPosition(new V(l,1))?.left??0;for(let m of c){let g=m.column===-1?h+(m.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new V(l,m.column)).left;if(g>i||this._maxIndentLeft>0&&g>this._maxIndentLeft)break;let f=m.horizontalLine?m.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=m.horizontalLine?(e.visibleRangeForPosition(new V(l,m.horizontalLine.endColumn))?.left??g+this._spaceWidth)-g:this._spaceWidth;u+=`<div class="core-guide ${m.className} ${f}" style="left:${g}px;width:${b}px"></div>`}a[d]=u}this._renderResult=a}getGuidesByLine(e,t,n){let i=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,n,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&n){let u=this._context.viewModel.getActiveIndentGuide(n.lineNumber,e,t);s=u.startLineNumber,a=u.endLineNumber,l=u.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let u=e;u<=t;u++){let h=new Array;c.push(h);let m=i?i[u-e]:[],g=new Li(m),f=r?r[u-e]:0;for(let b=1;b<=f;b++){let y=(b-1)*d+1,C=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||m.length===0)&&s<=u&&u<=a&&b===l;h.push(...g.takeWhile(w=>w.visibleColumn<y)||[]);let S=g.peek();(!S||S.visibleColumn!==y||S.horizontalLine)&&h.push(new Zr(y,-1,`core-guide-indent lvl-${(b-1)%30}`+(C?" indent-active":""),null,-1,-1))}h.push(...g.takeWhile(b=>!0)||[])}return c}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};function cm(o){if(!(o&&o.isTransparent()))return o}mo((o,e)=>{let t=[{bracketColor:GI,guideColor:yF,guideColorActive:wF},{bracketColor:jI,guideColor:IF,guideColorActive:_F},{bracketColor:$I,guideColor:CF,guideColorActive:TF},{bracketColor:qI,guideColor:SF,guideColorActive:LF},{bracketColor:YI,guideColor:xF,guideColorActive:DF},{bracketColor:ZI,guideColor:EF,guideColorActive:RF}],n=new Mf,i=[{indentColor:nF,indentColorActive:lF},{indentColor:iF,indentColorActive:dF},{indentColor:oF,indentColorActive:cF},{indentColor:rF,indentColorActive:uF},{indentColor:sF,indentColorActive:hF},{indentColor:aF,indentColorActive:pF}],r=t.map(a=>{let l=o.getColor(a.bracketColor),d=o.getColor(a.guideColor),c=o.getColor(a.guideColorActive),u=cm(cm(d)??l?.transparent(.3)),h=cm(cm(c)??l);if(!(!u||!h))return{guideColor:u,guideColorActive:h}}).filter(ao),s=i.map(a=>{let l=o.getColor(a.indentColor),d=o.getColor(a.indentColorActive),c=cm(l),u=cm(d);if(!(!c||!u))return{indentColor:c,indentColorActive:u}}).filter(ao);if(r.length>0){for(let a=0;a<30;a++){let l=r[a%r.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${n.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${n.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${n.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var um=class o extends Io{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new V(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let e=this._context.configuration.options;this._lineHeight=e.get(68);let t=e.get(69);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(97);let n=e.get(147);this._lineNumbersLeft=n.lineNumbersLeft,this._lineNumbersWidth=n.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){let t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let n=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,n=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(n=!0),n}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){let t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new V(e,1));if(t.column!==1)return"";let n=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n);if(this._renderLineNumbers===2){let i=Math.abs(this._lastCursorModelPosition.lineNumber-n);return i===0?'<span class="relative-current-line-number">'+n+"</span>":String(i)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===n||n%10===0)return String(n);let i=this._context.viewModel.getLineCount();return n===i?String(n):""}return String(n)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}let t=Zt?this._lineHeight%2===0?" lh-even":" lh-odd":"",n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(d=>!!d.options.lineNumberClassName);r.sort((d,c)=>L.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=n;d<=i;d++){let c=d-n,u=this._getLineRenderLineNumber(d),h="";for(;s<r.length&&r[s].range.endLineNumber<d;)s++;for(let m=s;m<r.length;m++){let{range:g,options:f}=r[m];g.startLineNumber<=d&&(h+=" "+f.lineNumberClassName)}if(!u&&!h){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(h+=" dimmed-line-number")),d===this._activeLineNumber&&(h+=" active-line-number"),l[c]=`<div class="${o.CLASS_NAME}${t}${h}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};mo((o,e)=>{let t=o.getColor(tF),n=o.getColor(mF);n?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${n}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});var xR=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new L(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}},ER=class{constructor(e,t,n,i,r,s,a){this.minimalReveal=e;this.lineNumber=t;this.startColumn=n;this.endColumn=i;this.startScrollTop=r;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=t,this.maxLineNumber=t}type="range";minLineNumber;maxLineNumber},wR=class{constructor(e,t,n,i,r){this.minimalReveal=e;this.selections=t;this.startScrollTop=n;this.stopScrollTop=i;this.scrollType=r;let s=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,d=t.length;l<d;l++){let c=t[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},Qx=class o extends Bt{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(e,t){super(e);let n=this._context.configuration,i=this._context.configuration.options,r=i.get(51),s=i.get(148);this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=i.get(102),this._cursorSurroundingLines=i.get(29),this._cursorSurroundingLinesStyle=i.get(30),this._canUseLayerHinting=!i.get(32),this._viewLineOptions=new Nb(n,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Kp({createLine:()=>new Fs(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Xn.write(this.domNode,8),this.domNode.setClassName(`view-lines ${Ml}`),Cn(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Yt(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Yt(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new xR,this._horizontalRevealRequest=null,this._stickyScrollEnabled=i.get(117).enabled,this._maxNumberStickyLines=i.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(148)&&(this._maxLineWidth=0);let t=this._context.configuration.options,n=t.get(51),i=t.get(148);return this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.isViewportWrapping,this._revealHorizontalRightPadding=t.get(102),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(117).enabled,this._maxNumberStickyLines=t.get(117).maxLineCount,Cn(this.domNode,n),this._onOptionsMaybeChanged(),e.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let e=this._context.configuration,t=new Nb(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=!1;for(let r=t;r<=n;r++)i=this._visibleLines.getVisibleLine(r).onSelectionChanged()||i;return i}onDecorationsChanged(e){{let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){let t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let n=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?n={scrollTop:n.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new ER(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new wR(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;let r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-n.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(n,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){let t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),n=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>n)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){let n=this._getViewLineDomNode(e);if(n===null)return null;let i=this._getLineNumberFor(n);if(i===-1||i<1||i>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(i)===1)return new V(i,1);let r=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(i<r||i>s)return null;let a=this._visibleLines.getVisibleLine(i).getColumnOfNodeOffset(e,t),l=this._context.viewModel.getLineMinColumn(i);return a<l&&(a=l),new V(i,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Fs.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){let r=this._visibleLines.getVisibleLine(i);if(e===r.getDomNode())return i}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();if(e<t||e>n)return-1;let i=new Gp(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;let n=e.endLineNumber,i=L.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!i)return null;let r=[],s=0,a=new Gp(this.domNode.domNode,this._textRangeRestingSpot),l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new V(i.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=i.startLineNumber;u<=i.endLineNumber;u++){if(u<d||u>c)continue;let h=u===i.startLineNumber?i.startColumn:1,m=u!==i.endLineNumber,g=m?this._context.viewModel.getLineMaxColumn(u):i.endColumn,f=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,h,g,a);if(f){if(t&&u<n){let b=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new V(u+1,1)).lineNumber,b!==l&&(f.ranges[f.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[s++]=new nx(f.outsideRenderedLine,u,zp.from(f.ranges),m)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:r}_visibleRangesForLineRange(e,t,n){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;let i=new Gp(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,n,i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}visibleRangeForPosition(e){let t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new ix(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=1,r=!0;for(let s=t;s<=n;s++){let a=this._visibleLines.getVisibleLine(s);if(e&&!a.getWidthIsFast()){r=!1;continue}i=Math.max(i,a.getWidth(null))}return r&&t===1&&n===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(i),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1,n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++){let s=this._visibleLines.getVisibleLine(r);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let n=this._horizontalRevealRequest;if(e.startLineNumber<=n.minLineNumber&&n.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let i=this._computeScrollLeftToReveal(n);i&&(this._isViewportWrapping||this._ensureMaxLineWidth(i.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:i.scrollLeft},n.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Zt&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,n,i,r,s){let a=e.top,l=e.height,d=a+l,c,u,h;if(r&&r.length>0){let y=r[0].startLineNumber,C=r[0].endLineNumber;for(let S=1,w=r.length;S<w;S++){let R=r[S];y=Math.min(y,R.startLineNumber),C=Math.max(C,R.endLineNumber)}c=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(y),h=this._context.viewLayout.getVerticalOffsetForLineNumber(C)+this._lineHeight}else if(i)c=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),h=this._context.viewLayout.getVerticalOffsetForLineNumber(i.endLineNumber)+this._lineHeight;else return-1;let m=(t==="mouse"||n)&&this._cursorSurroundingLinesStyle==="default",g=0,f=0;if(m)n||(g=this._lineHeight);else{let y=l/this._lineHeight,C=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),S=Math.min(y/2,C);g=S*this._lineHeight,f=Math.max(0,S-1)*this._lineHeight}n||(s===0||s===4)&&(f+=this._lineHeight),u-=g,h+=f;let b;if(h-u>l){if(!c)return-1;b=u}else if(s===5||s===6)if(s===6&&a<=u&&h<=d)b=a;else{let y=Math.max(5*this._lineHeight,l*.2),C=u-y,S=h-l;b=Math.max(S,C)}else if(s===1||s===2)if(s===2&&a<=u&&h<=d)b=a;else{let y=(u+h)/2;b=Math.max(0,y-l/2)}else b=this._computeMinimumScrolling(a,d,u,h,s===3,s===4);return b}_computeScrollLeftToReveal(e){let t=this._context.viewLayout.getCurrentViewport(),n=this._context.configuration.options.get(147),i=t.left,r=i+t.width-n.verticalScrollbarWidth,s=1073741824,a=0;if(e.type==="range"){let d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let u of c.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(s=Math.max(0,s-o.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(i,r,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,n,i,r,s){e=e|0,t=t|0,n=n|0,i=i|0,r=!!r,s=!!s;let a=t-e;if(i-n<a){if(r)return n;if(s)return Math.max(0,i-a);if(n<e)return n;if(i>t)return Math.max(0,i-a)}else return n;return e}};var Jx=class extends dm{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(e){super(),this._context=e;let n=this._context.configuration.options.get(147);this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(n[i++]=new Nu(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(n[i++]=new Nu(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+s+'px;"></div>',l=[];for(let d=t;d<=n;d++){let c=d-t,u=i[c].getDecorations(),h="";for(let m of u){let g='<div class="cldr '+m.className;m.tooltip!==null&&(g+='" title="'+m.tooltip),g+=a,h+=g}l[c]=h}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var hm=class o extends Bt{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._domNode=Be(document.createElement("div")),this._domNode.setClassName(o.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Be(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(o.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);let n=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(n),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(n)}};var eE=class extends dm{_context;_renderResult;constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.marginClassName,d=a.options.zIndex;l&&(n[i++]=new Nu(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=[];for(let s=t;s<=n;s++){let a=s-t,l=i[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';r[a]=d}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Vs=class o{_rgba8Brand=void 0;static Empty=new o(0,0,0,0);r;g;b;a;constructor(e,t,n,i){this.r=o._clamp(e),this.g=o._clamp(t),this.b=o._clamp(n),this.a=o._clamp(i)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};var xV=(()=>{let o=[];for(let e=32;e<=126;e++)o.push(e);return o.push(65533),o})(),EV=(o,e)=>(o-=32,o<0||o>96?e<=2?(o+96)%96:95:o);var Gb=class o{constructor(e,t){this.scale=t;this.charDataNormal=o.soften(e,12/15),this.charDataLight=o.soften(e,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(e,t){let n=new Uint8ClampedArray(e.length);for(let i=0,r=e.length;i<r;i++)n[i]=vc(e[i]*t);return n}renderChar(e,t,n,i,r,s,a,l,d,c,u){let h=1*this.scale,m=2*this.scale,g=u?1:m;if(t+h>e.width||n+g>e.height){console.warn("bad render request outside image data");return}let f=c?this.charDataLight:this.charDataNormal,b=EV(i,d),y=e.width*4,C=a.r,S=a.g,w=a.b,R=r.r-C,M=r.g-S,N=r.b-w,A=Math.max(s,l),P=e.data,K=b*h*m,j=n*y+t*4;for(let X=0;X<g;X++){let le=j;for(let ye=0;ye<h;ye++){let q=f[K++]/255*(s/255);P[le++]=C+R*q,P[le++]=S+M*q,P[le++]=w+N*q,P[le++]=A}j+=y}}blockRenderChar(e,t,n,i,r,s,a,l){let d=1*this.scale,c=2*this.scale,u=l?1:c;if(t+d>e.width||n+u>e.height){console.warn("bad render request outside image data");return}let h=e.width*4,m=.5*(r/255),g=s.r,f=s.g,b=s.b,y=i.r-g,C=i.g-f,S=i.b-b,w=g+y*m,R=f+C*m,M=b+S*m,N=Math.max(r,a),A=e.data,P=n*h+t*4;for(let K=0;K<u;K++){let j=P;for(let X=0;X<d;X++)A[j++]=w,A[j++]=R,A[j++]=M,A[j++]=N;P+=h}}};var pm=class o extends B{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=id(new o)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new T;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(ir.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let e=ir.getColorMap();if(!e){this._colors=[Vs.Empty],this._backgroundIsLight=!0;return}this._colors=[Vs.Empty];for(let n=1;n<e.length;n++){let i=e[n].rgba;this._colors[n]=new Vs(i.r,i.g,i.b,Math.round(i.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};var _V={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},TV=o=>{let e=new Uint8ClampedArray(o.length/2);for(let t=0;t<o.length;t+=2)e[t>>1]=_V[o[t]]<<4|_V[o[t+1]]&15;return e},_R={1:ds(()=>TV("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:ds(()=>TV("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var tE=class o{static lastCreated;static lastFontFamily;static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let n;return _R[e]?n=new Gb(_R[e](),e):n=o.createFromSampleData(o.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=n,n}static createSampleData(e){let t=document.createElement("canvas"),n=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",n.fillStyle="#ffffff",n.font=`bold 16px ${e}`,n.textBaseline="middle";let i=0;for(let r of xV)n.fillText(String.fromCharCode(r),i,16/2),i+=10;return n.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){let n=16*10*4*96;if(e.length!==n)throw new Error("Unexpected source in MinimapCharRenderer");let i=o._downsample(e,t);return new Gb(i,t)}static _downsampleChar(e,t,n,i,r){let s=1*r,a=2*r,l=i,d=0;for(let c=0;c<a;c++){let u=c/a*16,h=(c+1)/a*16;for(let m=0;m<s;m++){let g=m/s*10,f=(m+1)/s*10,b=0,y=0;for(let S=u;S<h;S++){let w=t+Math.floor(S)*3840,R=1-(S-Math.floor(S));for(let M=g;M<f;M++){let N=1-(M-Math.floor(M)),A=w+Math.floor(M)*4,P=N*R;y+=P,b+=e[A]*e[A+3]/255*P}}let C=b/y;d=Math.max(d,C),n[l++]=vc(C)}}return d}static _downsample(e,t){let n=2*t*1*t,i=n*96,r=new Uint8ClampedArray(i),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(e,a,r,s,t)),s+=n,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<i;c++)r[c]*=d}return r}};var LV=ft?'"Segoe WPC", "Segoe UI", sans-serif':Fe?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var z9=140,K9=2,nE=class o{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(e,t,n){let i=e.options,r=i.get(145),s=i.get(147),a=s.minimap,l=i.get(51),d=i.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=i.get(107),this.paddingTop=i.get(85).top,this.paddingBottom=i.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=i.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=LV,this.sectionHeaderFontSize=d.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=o._getSectionHeaderColor(t,n.getColor(1)),this.charRenderer=ds(()=>tE.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=n.getColor(2),this.backgroundColor=o._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=o._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){let n=e.getColor(ZO);return n?new Vs(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}static _getMinimapForegroundOpacity(e){let t=e.getColor(XO);return t?Vs._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){let n=e.getColor(ga);return n?new Vs(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}},TR=class o{constructor(e,t,n,i,r,s,a,l,d){this.scrollTop=e;this.scrollHeight=t;this.sliderNeeded=n;this._computedSliderRatio=i;this.sliderTop=r;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumber,e.endLineNumber);return t>n?null:[t,n]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,n,i,r,s,a,l,d,c,u){let h=e.pixelRatio,m=e.minimapLineHeight,g=Math.floor(e.canvasInnerHeight/m),f=e.lineHeight;if(e.minimapHeightIsEditorHeight){let M=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(M+=Math.max(0,r-e.lineHeight-e.paddingBottom));let N=Math.max(1,Math.floor(r*r/M)),A=Math.max(0,e.minimapHeight-N),P=A/(c-r),K=d*P,j=A>0,X=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),le=Math.floor(e.paddingTop/e.lineHeight);return new o(d,c,j,P,K,N,le,1,Math.min(a,X))}let b;if(s&&n!==a){let M=n-t+1;b=Math.floor(M*m/h)}else{let M=r/f;b=Math.floor(M*m/h)}let y=Math.floor(e.paddingTop/f),C=Math.floor(e.paddingBottom/f);if(e.scrollBeyondLastLine){let M=r/f;C=Math.max(C,M-1)}let S;if(C>0){let M=r/f;S=(y+a+C-M-1)*m/h}else S=Math.max(0,(y+a)*m/h-b);S=Math.min(e.minimapHeight-b,S);let w=S/(c-r),R=d*w;if(g>=y+a+C){let M=S>0;return new o(d,c,M,w,R,b,y,1,a)}else{let M;t>1?M=t+y:M=Math.max(1,d/f);let N,A=Math.max(1,Math.floor(M-R*h/m));A<y?(N=y-A+1,A=1):(N=0,A=Math.max(1,A-y)),u&&u.scrollHeight===c&&(u.scrollTop>d&&(A=Math.min(A,u.startLineNumber),N=Math.max(N,u.topPaddingLineCount)),u.scrollTop<d&&(A=Math.max(A,u.startLineNumber),N=Math.min(N,u.topPaddingLineCount)));let P=Math.min(a,A-N+g-1),K=(d-i)/f,j;return d>=e.paddingTop?j=(t-A+N+K)*m/h:j=d/e.paddingTop*(N+K)*m/h,new o(d,c,!0,w,j,b,N,A,P)}}},iE=class o{static INVALID=new o(-1);dy;constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},oE=class{renderedLayout;_imageData;_renderedLines;constructor(e,t,n){this.renderedLayout=e,this._imageData=t,this._renderedLines=new Db({createLine:()=>iE.INVALID}),this._renderedLines._set(e.startLineNumber,n)}linesEquals(e){if(!this.scrollEquals(e))return!1;let n=this._renderedLines._get().lines;for(let i=0,r=n.length;i<r;i++)if(n[i].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){let e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}},LR=class o{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(e,t,n,i){this._backgroundFillData=o._createBackgroundFillData(t,n,i),this._buffers=[e.createImageData(t,n),e.createImageData(t,n)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,n){let i=n.r,r=n.g,s=n.b,a=n.a,l=new Uint8ClampedArray(e*t*4),d=0;for(let c=0;c<t;c++)for(let u=0;u<e;u++)l[d]=i,l[d+1]=r,l[d+2]=s,l[d+3]=a,d+=4;return l}},rE=class o{constructor(e,t){this.samplingRatio=e;this.minimapLines=t}static compute(e,t,n){if(e.renderMinimap===0||!e.isSampling)return[null,[]];let{minimapLineCount:i}=Qg.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/i,s=r/2;if(!n||n.minimapLines.length===0){let b=[];if(b[0]=1,i>1){for(let y=0,C=i-1;y<C;y++)b[y]=Math.round(y*r+s);b[i-1]=t}return[new o(r,b),[]]}let a=n.minimapLines,l=a.length,d=[],c=0,u=0,h=1,m=10,g=[],f=null;for(let b=0;b<i;b++){let y=Math.max(h,Math.round(b*r)),C=Math.max(y,Math.round((b+1)*r));for(;c<l&&a[c]<y;){if(g.length<m){let w=c+1+u;f&&f.type==="deleted"&&f._oldIndex===c-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:c,deleteFromLineNumber:w,deleteToLineNumber:w},g.push(f)),u--}c++}let S;if(c<l&&a[c]<=C)S=a[c],c++;else if(b===0?S=1:b+1===i?S=t:S=Math.round(b*r+s),g.length<m){let w=c+1+u;f&&f.type==="inserted"&&f._i===b-1?f.insertToLineNumber++:(f={type:"inserted",_i:b,insertFromLineNumber:w,insertToLineNumber:w},g.push(f)),u++}d[b]=S,h=S}if(g.length<m)for(;c<l;){let b=c+1+u;f&&f.type==="deleted"&&f._oldIndex===c-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:c,deleteFromLineNumber:b,deleteToLineNumber:b},g.push(f)),u--,c++}else g=[{type:"flush"}];return[new o(r,d),g]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e)-1;for(;n>0&&this.minimapLines[n-1]>=e;)n--;let i=this.modelLineToMinimapLine(t)-1;for(;i+1<this.minimapLines.length&&this.minimapLines[i+1]<=t;)i++;if(n===i){let r=this.minimapLines[n];if(r<e||r>t)return null}return[n+1,i+1]}decorationLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e),i=this.modelLineToMinimapLine(t);return e!==t&&i===n&&(i===this.minimapLines.length?n>1&&n--:i++),[n,i]}onLinesDeleted(e){let t=e.toLineNumber-e.fromLineNumber+1,n=this.minimapLines.length,i=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),n=Math.min(n,r),i=Math.max(i,r)):this.minimapLines[r]-=t;return[n,i]}onLinesInserted(e){let t=e.toLineNumber-e.fromLineNumber+1;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<e.fromLineNumber);n--)this.minimapLines[n]+=t}},sE=class extends Bt{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new Ri(10,1.5);_actual;constructor(e){super(e),this.tokensColorTracker=pm.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new nE(this._context.configuration,this._context.theme,this.tokensColorTracker);let[t]=rE.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new DR(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let e=new nE(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){let t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){let[t,n]=this._samplingState.onLinesDeleted(e);return t<=n&&this._actual.onLinesChanged(t+1,n-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(let n of e.ranges){let i=this._samplingState.modelLineRangeToMinimapLineRange(n.fromLineNumber,n.toLineNumber);i&&t.push({fromLineNumber:i[0],toLineNumber:i[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),n=this._samplingState.modelLineToMinimapLine(n));let i={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:n,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(i)}_recreateLineSampling(){this._minimapSelections=null;let e=!!this._samplingState,[t,n]=rE.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(let i of n)switch(i.type){case"deleted":this._actual.onLinesDeleted(i.deleteFromLineNumber,i.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(i.insertFromLineNumber,i.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,n){if(this._samplingState){let i=[];for(let r=0,s=t-e+1;r<s;r++)n[r]?i[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):i[r]=null;return i}return this._context.viewModel.getMinimapLinesRenderingData(e,t,n).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let e of this._selections){let[t,n]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new Ue(t,e.startColumn,n,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let n=this._getMinimapDecorationsInViewport(e,t).filter(i=>!i.options.minimap?.sectionHeaderStyle);if(this._samplingState){let i=[];for(let r of n){if(!r.options.minimap)continue;let s=r.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);i.push(new Wp(new L(a,s.startColumn,l,s.endColumn),r.options))}return i}return n}getSectionHeaderDecorationsInViewport(e,t){let n=this.options.minimapLineHeight,r=this.options.sectionHeaderFontSize/n;return e=Math.floor(Math.max(1,e-r)),this._getMinimapDecorationsInViewport(e,t).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let n;if(this._samplingState){let i=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];n=new L(i,1,r,this._context.viewModel.getLineMaxColumn(r))}else n=new L(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(n)}getSectionHeaderText(e,t){let n=e.options.minimap?.sectionHeaderText;if(!n)return null;let i=this._sectionHeaderCache.get(n);if(i)return i;let r=t(n);return this._sectionHeaderCache.set(n,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new L(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}},DR=class o extends B{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(e,t){super(),this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(CD),this._domNode=Be(document.createElement("div")),Xn.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Be(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Be(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Be(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Be(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Be(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=Bi(this._domNode.domNode,me.POINTER_DOWN,n=>{if(n.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(n.button===0&&this._lastRenderData){let d=cr(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(n,c,this._lastRenderData.renderedLayout)}return}let r=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*n.offsetY,l=Math.floor(s/r)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new ka,this._sliderPointerDownListener=Bi(this._slider.domNode,me.POINTER_DOWN,n=>{n.preventDefault(),n.stopPropagation(),n.button===0&&this._lastRenderData&&this._startSliderDragging(n,n.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Ln.addTarget(this._domNode.domNode),this._sliderTouchStartListener=z(this._domNode.domNode,yt.Start,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(n))},{passive:!1}),this._sliderTouchMoveListener=z(this._domNode.domNode,yt.Change,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(n)},{passive:!1}),this._sliderTouchEndListener=Bi(this._domNode.domNode,yt.End,n=>{n.preventDefault(),n.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,n){if(!e.target||!(e.target instanceof Element))return;let i=e.pageX;this._slider.toggleClassName("active",!0);let r=(s,a)=>{let l=cr(this._domNode.domNode),d=Math.min(Math.abs(a-i),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(ft&&d>z9){this._model.setScrollTop(n.scrollTop);return}let c=s-t;this._model.setScrollTop(n.getDesiredScrollTopFromDelta(c))};e.pageY!==t&&r(e.pageY,i),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>r(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){let t=this._domNode.domNode.getBoundingClientRect().top,n=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(n)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new LR(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(CD),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let n=TR.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(n.sliderNeeded?"block":"none"),this._slider.setTop(n.sliderTop),this._slider.setHeight(n.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(n.sliderHeight),this.renderDecorations(n),this._lastRenderData=this.renderLines(n)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;let t=this._model.getSelections();t.sort(L.compareRangesUsingStarts);let n=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);n.sort((h,m)=>(h.options.zIndex||0)-(m.options.zIndex||0));let{canvasInnerWidth:i,canvasInnerHeight:r}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,i,r);let c=new aE(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(d,t,c,e,s),this._renderDecorationsLineHighlights(d,n,c,e,s);let u=new aE(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(d,t,u,e,s,l,a,i),this._renderDecorationsHighlights(d,n,u,e,s,l,a,i),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,n,i,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of t){let d=i.intersectWithViewport(l);if(!d)continue;let[c,u]=d;for(let g=c;g<=u;g++)n.set(g,!0);let h=i.getYForLineNumber(c,r),m=i.getYForLineNumber(u,r);a>=h||(a>s&&e.fillRect(gs,s,e.canvas.width,a-s),s=h),a=m}a>s&&e.fillRect(gs,s,e.canvas.width,a-s)}_renderDecorationsLineHighlights(e,t,n,i,r){let s=new Map;for(let a=t.length-1;a>=0;a--){let l=t[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=i.intersectWithViewport(l.range);if(!c)continue;let[u,h]=c,m=d.getColor(this._theme.value);if(!m||m.isTransparent())continue;let g=s.get(m.toString());g||(g=m.transparent(.5).toString(),s.set(m.toString(),g)),e.fillStyle=g;for(let f=u;f<=h;f++){if(n.has(f))continue;n.set(f,!0);let b=i.getYForLineNumber(u,r);e.fillRect(gs,b,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,n,i,r,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of t){let c=i.intersectWithViewport(d);if(!c)continue;let[u,h]=c;for(let m=u;m<=h;m++)this.renderDecorationOnLine(e,n,d,this._selectionColor,i,m,r,r,s,a,l)}}_renderDecorationsHighlights(e,t,n,i,r,s,a,l){for(let d of t){let c=d.options.minimap;if(!c)continue;let u=i.intersectWithViewport(d.range);if(!u)continue;let[h,m]=u,g=c.getColor(this._theme.value);if(!(!g||g.isTransparent()))for(let f=h;f<=m;f++)switch(c.position){case 1:this.renderDecorationOnLine(e,n,d.range,g,i,f,r,r,s,a,l);continue;case 2:{let b=i.getYForLineNumber(f,r);this.renderDecoration(e,g,2,b,K9,r);continue}}}}renderDecorationOnLine(e,t,n,i,r,s,a,l,d,c,u){let h=r.getYForLineNumber(s,l);if(h+a<0||h>this._model.options.canvasInnerHeight)return;let{startLineNumber:m,endLineNumber:g}=n,f=m===s?n.startColumn:1,b=g===s?n.endColumn:this._model.getLineMaxColumn(s),y=this.getXOffsetForPosition(t,s,f,d,c,u),C=this.getXOffsetForPosition(t,s,b,d,c,u);this.renderDecoration(e,i,y,h,C-y,a)}getXOffsetForPosition(e,t,n,i,r,s){if(n===1)return gs;if((n-1)*r>=s)return s;let l=e.get(t);if(!l){let d=this._model.getLineContent(t);l=[gs];let c=gs;for(let u=1;u<d.length+1;u++){let h=d.charCodeAt(u-1),m=h===9?i*r:Tr(h)?2*r:r,g=c+m;if(g>=s){l[u]=s;break}l[u]=g,c=g}e.set(t,l)}return n-1<l.length?l[n-1]:s}renderDecoration(e,t,n,i,r,s){e.fillStyle=t&&t.toString()||"",e.fillRect(n,i,r,s)}_renderSectionHeaders(e){let t=this._model.options.minimapLineHeight,n=this._model.options.sectionHeaderFontSize,i=this._model.options.sectionHeaderLetterSpacing,r=n*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,u=c,h=this._decorationsCanvas.domNode.getContext("2d");h.letterSpacing=i+"px",h.font="500 "+n+"px "+this._model.options.sectionHeaderFontFamily,h.strokeStyle=u,h.lineWidth=.2;let m=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);m.sort((f,b)=>f.range.startLineNumber-b.range.startLineNumber);let g=o._fitSectionHeader.bind(null,h,s-gs);for(let f of m){let b=e.getYForLineNumber(f.range.startLineNumber,t)+n,y=b-n,C=y+2,S=this._model.getSectionHeaderText(f,g);o._renderSectionLabel(h,S,f.options.minimap?.sectionHeaderStyle===2,l,c,s,y,r,b,C)}}static _fitSectionHeader(e,t,n){if(!n)return n;let i="\u2026",r=e.measureText(n).width,s=e.measureText(i).width;if(r<=t||r<=s)return n;let a=n.length,l=r/n.length,d=Math.floor((t-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(n[c-1]);)--c;return n.substring(0,c)+i+n.substring(a-(d-c))}static _renderSectionLabel(e,t,n,i,r,s,a,l,d,c){t&&(e.fillStyle=i,e.fillRect(0,a,s,l),e.fillStyle=r,e.fillText(t,gs,d)),n&&(e.beginPath(),e.moveTo(0,c),e.lineTo(s,c),e.closePath(),e.stroke())}renderLines(e){let t=e.startLineNumber,n=e.endLineNumber,i=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){let q=this._lastRenderData._get();return new oE(e,q.imageData,q.lines)}let r=this._getBuffer();if(!r)return null;let[s,a,l]=o._renderUntouchedLines(r,e.topPaddingLineCount,t,n,i,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(t,n,l),c=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,h=this._model.options.backgroundColor,m=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,f=g.backgroundIsLight(),b=this._model.options.renderMinimap,y=this._model.options.charRenderer(),C=this._model.options.fontScale,S=this._model.options.minimapCharWidth,R=(b===1?2:3)*C,M=i>R?Math.floor((i-R)/2):0,N=h.a/255,A=new Vs(Math.round((h.r-u.r)*N+u.r),Math.round((h.g-u.g)*N+u.g),Math.round((h.b-u.b)*N+u.b),255),P=e.topPaddingLineCount*i,K=[];for(let q=0,Q=n-t+1;q<Q;q++)l[q]&&o._renderLine(r,A,h.a,f,b,S,g,m,y,P,M,c,d[q],C,i),K[q]=new iE(P),P+=i;let j=s===-1?0:s,le=(a===-1?r.height:a)-j;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,j,r.width,le),new oE(e,r,K)}static _renderUntouchedLines(e,t,n,i,r,s){let a=[];if(!s){for(let P=0,K=i-n+1;P<K;P++)a[P]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,u=l.lines,h=u.length,m=e.width,g=e.data,f=(i-n+1)*r*m*4,b=-1,y=-1,C=-1,S=-1,w=-1,R=-1,M=t*r;for(let P=n;P<=i;P++){let K=P-n,j=P-c,X=j>=0&&j<h?u[j].dy:-1;if(X===-1){a[K]=!0,M+=r;continue}let le=X*m*4,ye=(X+r)*m*4,q=M*m*4,Q=(M+r)*m*4;S===le&&R===q?(S=ye,R=Q):(C!==-1&&(g.set(d.subarray(C,S),w),b===-1&&C===0&&C===w&&(b=S),y===-1&&S===f&&C===w&&(y=C)),C=le,S=ye,w=q,R=Q),a[K]=!1,M+=r}C!==-1&&(g.set(d.subarray(C,S),w),b===-1&&C===0&&C===w&&(b=S),y===-1&&S===f&&C===w&&(y=C));let N=b===-1?-1:b/(m*4),A=y===-1?-1:y/(m*4);return[N,A,a]}static _renderLine(e,t,n,i,r,s,a,l,d,c,u,h,m,g,f){let b=m.content,y=m.tokens,C=e.width-s,S=f===1,w=gs,R=0,M=0;for(let N=0,A=y.getCount();N<A;N++){let P=y.getEndOffset(N),K=y.getForeground(N),j=a.getColor(K);for(;R<P;R++){if(w>C)return;let X=b.charCodeAt(R);if(X===9){let le=h-(R+M)%h;M+=le-1,w+=le*s}else if(X===32)w+=s;else{let le=Tr(X)?2:1;for(let ye=0;ye<le;ye++)if(r===2?d.blockRenderChar(e,w,c+u,j,l,t,n,S):d.renderChar(e,w,c+u,X,j,l,t,n,g,i,S),w+=s,w>C)return}}}}},aE=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(e,t,n){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=n,this._values=[];for(let i=0,r=this._endLineNumber-this._startLineNumber+1;i<r;i++)this._values[i]=n}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}};var dE=class extends Bt{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(e,t){super(e),this._viewDomNode=t;let i=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=Be(document.createElement("div")),Xn.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=Be(document.createElement("div")),Xn.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,!0}addWidget(e){let t=Be(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){let n=this._widgets[e.getId()],i=t?t.preference:null,r=t?.stackOridinal;return n.preference===i&&n.stack===r?(this._updateMaxMinWidth(),!1):(n.preference=i,n.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0,t=Object.keys(this._widgets);for(let n=0,i=t.length;n<i;n++){let r=t[n],a=this._widgets[r].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){let n=e.domNode;if(e.preference===null){n.setTop("");return}let i=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){let r=n.domNode.clientHeight;n.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else n.setTop(0);e.stack!==void 0?(n.setTop(t[e.preference]),t[e.preference]+=n.domNode.clientWidth):n.setRight(i)}else if(e.preference===2)n.domNode.style.right="50%",e.stack!==void 0?(n.setTop(t[2]),t[2]+=n.domNode.clientHeight):n.setTop(0);else{let{top:r,left:s}=e.preference;if(this._context.configuration.options.get(43)&&e.widget.allowEditorOverflow){let l=this._viewDomNodeRect;n.setTop(r+l.top),n.setLeft(s+l.left),n.setPosition("fixed")}else n.setTop(r),n.setLeft(s),n.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=cr(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);let t=Object.keys(this._widgets),n=Array.from({length:3},()=>0);t.sort((i,r)=>(this._widgets[i].stack||0)-(this._widgets[r].stack||0));for(let i=0,r=t.length;i<r;i++){let s=t[i];this._renderWidget(this._widgets[s],n)}}};var RR=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(e,t){let n=e.options;this.lineHeight=n.get(68),this.pixelRatio=n.get(145),this.overviewRulerLanes=n.get(84),this.renderBorder=n.get(83);let i=t.getColor(gF);this.borderColor=i?i.toString():null,this.hideCursor=n.get(60);let r=t.getColor(Jh);this.cursorColorSingle=r?r.transparent(.7).toString():null;let s=t.getColor(UI);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=t.getColor(zI);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;let l=n.get(74),d=l.enabled,c=l.side,u=t.getColor(fF),h=ir.getDefaultBackground();u?this.backgroundColor=u:d&&c==="right"?this.backgroundColor=h:this.backgroundColor=null;let g=n.get(147).overviewRuler;this.top=g.top,this.right=g.right,this.domWidth=g.width,this.domHeight=g.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[f,b]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=f,this.w=b}_initLanes(e,t,n){let i=t-e;if(n>=3){let r=Math.floor(i/3),s=Math.floor(i/3),a=i-r-s,l=e,d=l+r,c=l+r+a;return[[0,l,d,l,c,l,d,l],[0,r,a,r+a,s,r+a+s,a+s,r+a+s]]}else if(n===2){let r=Math.floor(i/2),s=i-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,s,r+s,r+s,r+s]]}else{let r=e,s=i;return[[0,r,r,r,r,r,r,r],[0,s,s,s,s,s,s,s]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&W.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}};var cE=class extends Bt{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(e){super(e),this._domNode=Be(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=ir.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new V(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){let t=new RR(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,n=e.selections.length;t<n;t++){let i=this._settings.cursorColorSingle;n>1&&(i=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:i})}return this._cursorPositions.sort((t,n)=>V.compare(t.position,n.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){let e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?W.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}let t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(vu.compareByRenderingProps),this._actualShouldRender===1&&!vu.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!Lt(this._renderedCursorPositions,this._cursorPositions,(g,f)=>g.position.lineNumber===f.position.lineNumber&&g.color===f.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let n=this._settings.canvasWidth,i=this._settings.canvasHeight,r=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=i/a,d=6*this._settings.pixelRatio|0,c=d/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=W.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):(u.clearRect(0,0,n,i),u.fillStyle=W.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):u.clearRect(0,0,n,i);let h=this._settings.x,m=this._settings.w;for(let g of t){let f=g.color,b=g.data;u.fillStyle=f;let y=0,C=0,S=0;for(let w=0,R=b.length/3;w<R;w++){let M=b[3*w],N=b[3*w+1],A=b[3*w+2],P=s.getVerticalOffsetForLineNumber(N)*l|0,K=(s.getVerticalOffsetForLineNumber(A)+r)*l|0;if(K-P<d){let X=(P+K)/2|0;X<c?X=c:X+c>i&&(X=i-c),P=X-c,K=X+c}P>S+1||M!==y?(w!==0&&u.fillRect(h[y],C,m[y],S-C),y=M,C=P,S=K):K>S&&(S=K)}u.fillRect(h[y],C,m[y],S-C)}if(!this._settings.hideCursor){let g=2*this._settings.pixelRatio|0,f=g/2|0,b=this._settings.x[7],y=this._settings.w[7],C=-100,S=-100,w=null;for(let R=0,M=this._cursorPositions.length;R<M;R++){let N=this._cursorPositions[R].color;if(!N)continue;let A=this._cursorPositions[R].position,P=s.getVerticalOffsetForLineNumber(A.lineNumber)*l|0;P<f?P=f:P+f>i&&(P=i-f);let K=P-f,j=K+g;K>S+1||N!==w?(R!==0&&w&&u.fillRect(b,C,y,S-C),C=K,S=j):j>S&&(S=j),w=N,u.fillStyle=N}w&&u.fillRect(b,C,y,S-C)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,i),u.moveTo(1,0),u.lineTo(n,0),u.stroke())}};var uE=class extends ts{_context;_domNode;_zoneManager;constructor(e,t){super(),this._context=e;let n=this._context.configuration.options;this._domNode=Be(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new jS(i=>this._context.viewLayout.getVerticalOffsetForLineNumber(i)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(n.get(68)),this._zoneManager.setPixelRatio(n.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return e.hasChanged(68)&&(this._zoneManager.setLineHeight(t.get(68)),this._render()),e.hasChanged(145)&&(this._zoneManager.setPixelRatio(t.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),n=this._zoneManager.resolveColorZones(),i=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),n.length>0&&this._renderOneLane(r,n,i,e),!0}_renderOneLane(e,t,n,i){let r=0,s=0,a=0;for(let l of t){let d=l.colorId,c=l.from,u=l.to;d!==r?(e.fillRect(0,s,i,a-s),r=d,e.fillStyle=n[r],s=c,a=u):a>=c?a=Math.max(a,u):(e.fillRect(0,s,i,a-s),s=c,a=u)}e.fillRect(0,s,i,a-s)}};var hE=class extends Bt{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(e){super(e),this.domNode=Be(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let t=this._context.configuration.options;this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){let e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){let{tabSize:i}=this._context.viewModel.model.getOptions(),r=i,s=t-e;for(;s>0;){let a=Be(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let n=e-t;for(;n>0;){let i=this._renderedRulers.pop();this.domNode.removeChild(i),n--}}render(e){this._ensureRulersCount();for(let t=0,n=this._rulers.length;t<n;t++){let i=this._renderedRulers[t],r=this._rulers[t];i.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}};var pE=class extends Bt{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let n=this._context.configuration.options.get(105);this._useShadows=n.useShadows,this._domNode=Be(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let t=this._context.configuration.options.get(147);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){let n=this._context.configuration.options.get(105);return this._useShadows=n.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var kR=class{left;width;startStyle;endStyle;constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}},MR=class{lineNumber;ranges;constructor(e,t){this.lineNumber=e,this.ranges=t}};function G9(o){return new kR(o)}function j9(o){return new MR(o.lineNumber,o.ranges.map(G9))}var gE=class o extends Io{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,n=e.length;t<n;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,n){let i=this._typicalHalfwidthCharacterWidth/4,r=null,s=null;if(n&&n.length>0&&t.length>0){let a=t[0].lineNumber;if(a===e.startLineNumber)for(let d=0;!r&&d<n.length;d++)n[d].lineNumber===a&&(r=n[d].ranges[0]);let l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let d=n.length-1;!s&&d>=0;d--)n[d].lineNumber===l&&(s=n[d].ranges[0]);r&&!r.startStyle&&(r=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=t.length;a<l;a++){let d=t[a].ranges[0],c=d.left,u=d.left+d.width,h={top:0,bottom:0},m={top:0,bottom:0};if(a>0){let g=t[a-1].ranges[0].left,f=t[a-1].ranges[0].left+t[a-1].ranges[0].width;mE(c-g)<i?h.top=2:c>g&&(h.top=1),mE(u-f)<i?m.top=2:g<u&&u<f&&(m.top=1)}else r&&(h.top=r.startStyle.top,m.top=r.endStyle.top);if(a+1<l){let g=t[a+1].ranges[0].left,f=t[a+1].ranges[0].left+t[a+1].ranges[0].width;mE(c-g)<i?h.bottom=2:g<c&&c<f&&(h.bottom=1),mE(u-f)<i?m.bottom=2:u<f&&(m.bottom=1)}else s&&(h.bottom=s.startStyle.bottom,m.bottom=s.endStyle.bottom);d.startStyle=h,d.endStyle=m}}_getVisibleRangesWithStyle(e,t,n){let r=(t.linesVisibleRangesForRange(e,!0)||[]).map(j9);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,n),r}_createSelectionPiece(e,t,n,i,r){return'<div class="cslr '+n+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+i.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,n,i){if(i.length===0)return;let r=!!i[0].ranges[0].startStyle,s=i[0].lineNumber,a=i[i.length-1].lineNumber;for(let l=0,d=i.length;l<d;l++){let c=i[l],u=c.lineNumber,h=u-t,m=n&&u===s?1:0,g=n&&u!==s&&u===a?1:0,f="",b="";for(let y=0,C=c.ranges.length;y<C;y++){let S=c.ranges[y];if(r){let R=S.startStyle,M=S.endStyle;if(R.top===1||R.bottom===1){f+=this._createSelectionPiece(m,g,o.SELECTION_CLASS_NAME,S.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH);let N=o.EDITOR_BACKGROUND_CLASS_NAME;R.top===1&&(N+=" "+o.SELECTION_TOP_RIGHT),R.bottom===1&&(N+=" "+o.SELECTION_BOTTOM_RIGHT),f+=this._createSelectionPiece(m,g,N,S.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH)}if(M.top===1||M.bottom===1){f+=this._createSelectionPiece(m,g,o.SELECTION_CLASS_NAME,S.left+S.width,o.ROUNDED_PIECE_WIDTH);let N=o.EDITOR_BACKGROUND_CLASS_NAME;M.top===1&&(N+=" "+o.SELECTION_TOP_LEFT),M.bottom===1&&(N+=" "+o.SELECTION_BOTTOM_LEFT),f+=this._createSelectionPiece(m,g,N,S.left+S.width,o.ROUNDED_PIECE_WIDTH)}}let w=o.SELECTION_CLASS_NAME;if(r){let R=S.startStyle,M=S.endStyle;R.top===0&&(w+=" "+o.SELECTION_TOP_LEFT),R.bottom===0&&(w+=" "+o.SELECTION_BOTTOM_LEFT),M.top===0&&(w+=" "+o.SELECTION_TOP_RIGHT),M.bottom===0&&(w+=" "+o.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(m,g,w,S.left,S.width)}e[h][0]+=f,e[h][1]+=b}}_previousFrameVisibleRangesWithStyle=[];prepareRender(e){let t=[],n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let s=n;s<=i;s++){let a=s-n;t[a]=["",""]}let r=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){r[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[s]);r[s]=d,this._actualRenderOneSelection(t,n,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([s,a])=>s+a)}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};mo((o,e)=>{let t=o.getColor(VO);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function mE(o){return o<0?-o:o}var fE=class o extends Bt{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(e){super(e);let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new Ab(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=Be(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new bs,this._cursorFlatBlinkInterval=new yp,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let n=0,i=this._secondaryCursors.length;n<i;n++)this._secondaryCursors[n].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,n){let i=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&n!==3;if(this._primaryCursor.setPlurality(t.length?1:0),this._primaryCursor.onCursorPositionChanged(e,i),this._updateBlinking(),this._secondaryCursors.length<t.length){let r=t.length-this._secondaryCursors.length;for(let s=0;s<r;s++){let a=new Ab(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){let r=this._secondaryCursors.length-t.length;for(let s=0;s<r;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],i)}onCursorStateChanged(e){let t=[];for(let i=0,r=e.selections.length;i<r;i++)t[i]=e.selections[i].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);let n=e.selections[0].isEmpty();return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=n=>{for(let i=0,r=e.ranges.length;i<r;i++)if(e.ranges[i].fromLineNumber<=n.lineNumber&&n.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(let n of this._secondaryCursors)if(t(n.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let e=this._getCursorBlinking(),t=e===0,n=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!n&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},o.BLINK_INTERVAL,Ce(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},o.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case 1:e+=" cursor-line-style";break;case 2:e+=" cursor-block-style";break;case 3:e+=" cursor-underline-style";break;case 4:e+=" cursor-line-thin-style";break;case 5:e+=" cursor-block-outline-style";break;case 6:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,n=this._secondaryCursors.length;t<n;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],n=0,i=this._primaryCursor.render(e);i&&(t[n++]=i);for(let r=0,s=this._secondaryCursors.length;r<s;r++){let a=this._secondaryCursors[r].render(e);a&&(t[n++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};mo((o,e)=>{let t=[{class:".cursor",foreground:Jh,background:HI},{class:".cursor-primary",foreground:UI,background:JP},{class:".cursor-secondary",foreground:zI,background:eF}];for(let n of t){let i=o.getColor(n.foreground);if(i){let r=o.getColor(n.background);r||(r=i.opposite()),e.addRule(`.monaco-editor .cursors-layer ${n.class} { background-color: ${i}; border-color: ${i}; color: ${r}; }`),Dd(o.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${n.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});var NR=()=>{throw new Error("Invalid change accessor")},bE=class extends Bt{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this.domNode=Be(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Be(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=this._context.viewLayout.getWhitespaces(),t=new Map;for(let i of e)t.set(i.id,i);let n=!1;return this._context.viewModel.changeWhitespace(i=>{let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let u=t.get(l);u&&(u.afterLineNumber!==c.afterViewLineNumber||u.height!==c.heightInPx)&&(i.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),n=!0)}}),n}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,e.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new V(s,this._context.viewModel.model.getLineMaxColumn(s))}let n;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});let i=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(n);return{isInHiddenArea:!r,afterViewLineNumber:i.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(n=>{let i={addZone:r=>(t=!0,this._addZone(n,r)),removeZone:r=>{r&&(t=this._removeZone(n,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(n,r)||t)}};$9(e,i),i.addZone=NR,i.removeZone=NR,i.layoutZone=NR}),t}_addZone(e,t){let n=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(n.afterViewLineNumber,this._getZoneOrdinal(t),n.heightInPx,n.minWidthInPx),delegate:t,isInHiddenArea:n.isInHiddenArea,isVisible:!1,domNode:Be(t.domNode),marginDomNode:t.marginDomNode?Be(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,n.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t];return delete this._zones[t],e.removeWhitespace(n.whitespaceId),n.domNode.removeAttribute("monaco-visible-view-zone"),n.domNode.removeAttribute("monaco-view-zone"),n.domNode.domNode.remove(),n.marginDomNode&&(n.marginDomNode.removeAttribute("monaco-visible-view-zone"),n.marginDomNode.removeAttribute("monaco-view-zone"),n.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t],i=this._computeWhitespaceProps(n.delegate);return n.isInHiddenArea=i.isInHiddenArea,e.changeOneWhitespace(n.whitespaceId,i.afterViewLineNumber,i.heightInPx),this._safeCallOnComputedHeight(n.delegate,i.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(n){Ne(n)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(n){Ne(n)}}prepareRender(e){}render(e){let t=e.viewportData.whitespaceViewportData,n={},i=!1;for(let s of t)this._zones[s.id].isInHiddenArea||(n[s.id]=s,i=!0);let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=0,u=0,h="none";n.hasOwnProperty(l)?(c=n[l].verticalOffset-e.bigNumbersDelta,u=n[l].height,h="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(n[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(u),d.domNode.setDisplay(h),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(u),d.marginDomNode.setDisplay(h))}i&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function $9(o,e){try{return o(e)}catch(t){Ne(t)}}var vE=class extends Io{_context;_options;_selection;_renderResult;constructor(e){super(),this._context=e,this._options=new yE(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=new yE(this._context.configuration);return this._options.equals(t)?e.hasChanged(147):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber-t+1,r=new Array(i);for(let a=0;a<i;a++)r[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,r);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){let l=a-e.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let u=this._selection;for(let h of u){if(h.endLineNumber<a||h.startLineNumber>a)continue;let m=h.startLineNumber===a?h.startColumn:d.minColumn,g=h.endLineNumber===a?h.endColumn:d.maxColumn;m<g&&(c||(c=[]),c.push(new jp(m-1,g-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,c,d)}}_applyRenderWhitespace(e,t,n,i){if(this._options.renderWhitespace==="selection"&&!n||this._options.renderWhitespace==="trailing"&&i.continuesWithWrappedLine)return"";let r=this._context.theme.getColor(KI),s=this._options.renderWithSVG,a=i.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=i.continuesWithWrappedLine,c=i.minColumn-1,u=this._options.renderWhitespace==="boundary",h=this._options.renderWhitespace==="trailing",m=this._options.lineHeight,g=this._options.middotWidth,f=this._options.wsmiddotWidth,b=this._options.spaceWidth,y=Math.abs(f-b),C=Math.abs(g-b),S=y<C?11825:183,w=this._options.canUseHalfwidthRightwardsArrow,R="",M=!1,N=ln(a),A;N===-1?(M=!0,N=l,A=l):A=_r(a);let P=0,K=n&&n[P],j=0;for(let X=c;X<l;X++){let le=a.charCodeAt(X);if(K&&X>=K.endOffset&&(P++,K=n&&n[P]),le!==9&&le!==32||h&&!M&&X<=A)continue;if(u&&X>=N&&X<=A&&le===32){let q=X-1>=0?a.charCodeAt(X-1):0,Q=X+1<l?a.charCodeAt(X+1):0;if(q!==32&&Q!==32)continue}if(u&&d&&X===l-1){let q=X-1>=0?a.charCodeAt(X-1):0;if(le===32&&q!==32&&q!==9)continue}if(n&&(!K||K.startOffset>X||K.endOffset<=X))continue;let ye=e.visibleRangeForPosition(new V(t,X+1));ye&&(s?(j=Math.max(j,ye.left),le===9?R+=this._renderArrow(m,b,ye.left):R+=`<circle cx="${(ye.left+b/2).toFixed(2)}" cy="${(m/2).toFixed(2)}" r="${(b/7).toFixed(2)}" />`):le===9?R+=`<div class="mwh" style="left:${ye.left}px;height:${m}px;">${w?"\uFFEB":"\u2192"}</div>`:R+=`<div class="mwh" style="left:${ye.left}px;height:${m}px;">${String.fromCharCode(S)}</div>`)}return s?(j=Math.round(j+b),`<svg style="bottom:0;position:absolute;width:${j}px;height:${m}px" viewBox="0 0 ${j} ${m}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+R+"</svg>"):R}_renderArrow(e,t,n){let i=t/7,r=t,s=e/2,a=n,l={x:0,y:i/2},d={x:100/125*r,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},u={x:c.x+.1*d.x,y:c.y+.1*d.x},h={x:u.x+.35*d.x,y:u.y-.35*d.x},m={x:h.x,y:-h.y},g={x:u.x,y:-u.y},f={x:c.x,y:-c.y},b={x:d.x,y:-d.y},y={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,u,h,m,g,f,b,y].map(w=>`${(a+w.x).toFixed(2)} ${(s+w.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}},yE=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(e){let t=e.options,n=t.get(51),i=t.get(39);i==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):i==="svg"?(this.renderWhitespace=t.get(101),this.renderWithSVG=!0):(this.renderWhitespace=t.get(101),this.renderWithSVG=!1),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(68),this.stopRenderingLineAfter=t.get(119)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}};var mm=class extends Bt{};var AR=class{_onDidChange=new T;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},OR=new AR;var FR=class{constructor(e,t,n,i,r){this._context=e;this.modelLineNumber=t;this.distanceToModelLineStart=n;this.widthOfHiddenLineTextBefore=i;this.distanceToModelLineEnd=r}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(e){let t=new V(this.modelLineNumber,this.distanceToModelLineStart+1),n=new V(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},PR=Bn,gm=class extends mm{constructor(t,n,i,r,s){super(t);this._keybindingService=r;this._instantiationService=s;this._viewController=n,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new Ue(1,1,1,1)],this._modelSelections=[new Ue(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Be(document.createElement("textarea")),Xn.write(this.textArea,7),this.textArea.setClassName(`inputarea ${Ml}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",zb(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",p("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Be(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:m=>this._context.viewModel.getLineMaxColumn(m),getValueInRange:(m,g)=>this._context.viewModel.getValueInRange(m,g),getValueLengthInRange:(m,g)=>this._context.viewModel.getValueLengthInRange(m,g),modifyPosition:(m,g)=>this._context.viewModel.modifyPosition(m,g)},u={getDataToCopy:()=>Ox(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let g=this._selections[0];if(Fe&&g.isEmpty()){let b=g.getStartPosition(),y=this._getWordBeforePosition(b);if(y.length===0&&(y=this._getCharacterBeforePosition(b)),y.length>0)return new ei(y,y.length,y.length,L.fromPositions(b),0)}if(Fe&&!g.isEmpty()&&c.getValueLengthInRange(g,0)<500){let b=c.getValueInRange(g,0);return new ei(b,0,b.length,g,0)}if(Bo&&!g.isEmpty()){let b="vscode-placeholder";return new ei(b,0,b.length,null,void 0)}return ei.EMPTY}if(D1){let g=this._selections[0];if(g.isEmpty()){let f=g.getStartPosition(),[b,y]=this._getAndroidWordAtPosition(f);if(b.length>0)return new ei(b,y,y,L.fromPositions(f),0)}return ei.EMPTY}let m=am.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return ei.fromScreenReaderContentState(m)},deduceModelPosition:(m,g,f)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(m,g,f)},h=this._register(new Px(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(lm,u,h,Zs,{isAndroid:D1,isChrome:Bd,isFirefox:Bn,isSafari:Bo})),this._register(this._textAreaInput.onKeyDown(m=>{this._viewController.emitKeyDown(m)})),this._register(this._textAreaInput.onKeyUp(m=>{this._viewController.emitKeyUp(m)})),this._register(this._textAreaInput.onPaste(m=>{let g=!1,f=null,b=null;m.metadata&&(g=this._emptySelectionClipboard&&!!m.metadata.isFromEmptySelection,f=typeof m.metadata.multicursorText<"u"?m.metadata.multicursorText:null,b=m.metadata.mode),this._viewController.paste(m.text,g,f,b)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(m=>{m.replacePrevCharCnt||m.replaceNextCharCnt||m.positionDelta?(Ko&&console.log(` => compositionType: <<${m.text}>>, ${m.replacePrevCharCnt}, ${m.replaceNextCharCnt}, ${m.positionDelta}`),this._viewController.compositionType(m.text,m.replacePrevCharCnt,m.replaceNextCharCnt,m.positionDelta)):(Ko&&console.log(` => type: <<${m.text}>>`),this._viewController.type(m.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(m=>{this._viewController.setSelection(m)})),this._register(this._textAreaInput.onCompositionStart(m=>{let g=this.textArea.domNode,f=this._modelSelections[0],{distanceToModelLineStart:b,widthOfHiddenTextBefore:y}=(()=>{let S=g.value.substring(0,Math.min(g.selectionStart,g.selectionEnd)),w=S.lastIndexOf(`
`),R=S.substring(w+1),M=R.lastIndexOf("	"),N=R.length-M-1,A=f.getStartPosition(),P=Math.min(A.column-1,N),K=A.column-1-P,j=R.substring(0,R.length-P),{tabSize:X}=this._context.viewModel.model.getOptions(),le=q9(this.textArea.domNode.ownerDocument,j,this._fontInfo,X);return{distanceToModelLineStart:K,widthOfHiddenTextBefore:le}})(),{distanceToModelLineEnd:C}=(()=>{let S=g.value.substring(Math.max(g.selectionStart,g.selectionEnd)),w=S.indexOf(`
`),R=w===-1?S:S.substring(0,w),M=R.indexOf("	"),N=M===-1?R.length:R.length-M-1,A=f.getEndPosition(),P=Math.min(this._context.viewModel.model.getLineMaxColumn(A.lineNumber)-A.column,N);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(A.lineNumber)-A.column-P}})();this._context.viewModel.revealRange("keyboard",!0,L.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new FR(this._context,f.startLineNumber,b,y,C),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${Ml} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(m=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${Ml}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(OR.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(t){t.appendChild(this.textArea),t.appendChild(this.textAreaCover)}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(t){let n='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(t.lineNumber),r=aa(n,[]),s=!0,a=t.column,l=!0,d=t.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let u=i.charCodeAt(a-2);r.get(u)!==0?s=!1:a--}if(l&&d>i.length&&(l=!1),l){let u=i.charCodeAt(d-1);r.get(u)!==0?l=!1:d++}c++}return[i.substring(a-1,d-1),t.column-a]}_getWordBeforePosition(t){let n=this._context.viewModel.getLineContent(t.lineNumber),i=aa(this._context.configuration.options.get(133),[]),r=t.column,s=0;for(;r>1;){let a=n.charCodeAt(r-2);if(i.get(a)!==0||s>50)return n.substring(r-1,t.column-1);s++,r--}return n.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){let i=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!qt(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);let n=t.get(3);this._accessibilitySupport===2&&n===ra.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=n;let r=t.get(147).wrappingColumn;if(r!==-1&&this._accessibilitySupport!==1){let s=t.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(r*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=PR?0:1}onConfigurationChanged(t){let n=this._context.configuration.options,i=n.get(147);this._setAccessibilityOptions(n),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=n.get(51),this._lineHeight=n.get(68),this._emptySelectionClipboard=n.get(38),this._copyWithSyntaxHighlighting=n.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:r}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${r*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",zb(n,this._keybindingService)),this.textArea.setAttribute("aria-required",n.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(n.get(126))),(t.hasChanged(34)||t.hasChanged(93))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){let t=this._context.configuration.options;!OR.enabled||t.get(34)&&t.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new V(1,1);_primaryCursorVisibleRange=null;prepareRender(t){this._primaryCursorPosition=new V(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let i=this._visibleTextArea.visibleTextareaStart,r=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&i&&r&&r.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=Kb(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+i.left-this._scrollLeft,h=r.left-i.left+1;if(u<this._contentLeft){let C=this._contentLeft-u;u+=C,c+=C,h-=C}h>this._contentWidth&&(h=this._contentWidth);let m=this._context.viewModel.getViewLineData(s.lineNumber),g=m.tokens.findTokenIndexAtOffset(s.column-1),f=m.tokens.findTokenIndexAtOffset(a.column-1),b=g===f,y=this._visibleTextArea.definePresentation(b?m.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:u,width:h,height:this._lineHeight,useCover:!1,color:(ir.getColorMap()||[])[y.foreground],italic:y.italic,bold:y.bold,underline:y.underline,strikethrough:y.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let n=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(n<0||n>this._contentHeight){this._renderAtTopLeft();return}if(Fe||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??Kb(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:PR?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:PR?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;let n=this.textArea,i=this.textAreaCover;Cn(n,this._fontInfo),n.setTop(t.top),n.setLeft(t.left),n.setWidth(t.width),n.setHeight(t.height),n.setColor(t.color?W.Format.CSS.formatHex(t.color):""),n.setFontStyle(t.italic?"italic":""),t.bold&&n.setFontWeight("bold"),n.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),i.setTop(t.useCover?t.top:0),i.setLeft(t.useCover?t.left:0),i.setWidth(t.useCover?t.width:0),i.setHeight(t.useCover?t.height:0);let r=this._context.configuration.options;r.get(58)?i.setClassName("monaco-editor-background textAreaCover "+hm.OUTER_CLASS_NAME):r.get(69).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+um.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};gm=k([E(3,to),E(4,nt)],gm);function q9(o,e,t,n){if(e.length===0)return 0;let i=o.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";let r=o.createElement("span");Cn(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${n*t.spaceWidth}px`,r.append(e),i.appendChild(r),o.body.appendChild(i);let s=r.offsetWidth;return i.remove(),s}var IE=Z("clipboardService");var CE=class extends B{constructor(t,n){super();this._domNode=t;this._onFocusChange=n;this._register(z(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(z(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(t){this._isFocused!==t&&(this._isFocused=t,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function fm(o,e,t,n){return o.addEventListener(e,t,n),{dispose(){o.removeEventListener(e,t)}}}var bm=class{constructor(e,t,n){this._domNode=e;this._context=t;this._keybindingService=n;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new Ue(1,1,1,1);_screenReaderContentState;onConfigurationChanged(e){this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let e=this._context.configuration.options,t=e.get(147);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._fontInfo=e.get(51),this._lineHeight=e.get(68),this._accessibilitySupport=e.get(2),this._accessibilityPageSize=e.get(3)}_updateDomAttributes(){let e=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",zb(e,this._keybindingService));let t=this._context.viewModel.model.getOptions().tabSize,n=e.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${t*n}px`}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new Ue(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent()}render(e){if(!this._screenReaderContentState)return;Cn(this._domNode,this._fontInfo);let t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),n=this._context.viewLayout.getCurrentScrollTop(),i=t-n;this._domNode.setTop(i),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let r=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=Kb(r);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let e=this._accessibilitySupport===1?1:this._accessibilityPageSize,t={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:n=>this._context.viewModel.getLineMaxColumn(n),getValueInRange:(n,i)=>this._context.viewModel.getValueInRange(n,i),getValueLengthInRange:(n,i)=>this._context.viewModel.getValueLengthInRange(n,i),modifyPosition:(n,i)=>this._context.viewModel.modifyPosition(n,i)};return am.fromEditorSelection(t,this._primarySelection,e,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(e,t){let i=Hd().document.getSelection();if(!i)return;let r=this._domNode.domNode.firstChild;if(!r)return;let s=Hd().document.activeElement,a=new globalThis.Range;a.setStart(r,e),a.setEnd(r,t),i.removeAllRanges(),i.addRange(a),ai(s)&&s.focus()}};bm=k([E(2,to)],bm);var vm=class extends mm{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new Ue(1,1,1,1);_textStartPositionWithinEditor=new V(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(e,t,n,i){super(e),this.domNode=new iu(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new CE(this.domNode.domNode,r=>this._context.viewModel.setHasFocus(r))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=n.createInstance(bm,this.domNode,e),this._register(z(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(i))),this._register(z(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(i),t.cut()})),this._register(z(this.domNode.domNode,"keyup",r=>t.emitKeyUp(new vt(r)))),this._register(z(this.domNode.domNode,"keydown",async r=>{let s=new vt(r);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(t,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),t.emitKeyDown(s)})),this._register(fm(this._editContext,"textformatupdate",r=>this._handleTextFormatUpdate(r))),this._register(fm(this._editContext,"characterboundsupdate",r=>this._updateCharacterBounds())),this._register(fm(this._editContext,"textupdate",r=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=L.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(t,r),this._screenReaderSupport.writeScreenReaderContent()})),this._register(fm(this._editContext,"compositionstart",r=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=L.fromPositions(s,s);this._compositionRangeWithinEditor=a,t.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(fm(this._editContext,"compositionend",r=>{this._compositionRangeWithinEditor=void 0,t.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(e){e.appendChild(this.domNode),this._parent=e.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._renderingContext=e,this._screenReaderSupport.prepareRender(e),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new Ue(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(126)))}_updateEditContext(){let e=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._textStartPositionWithinEditor=e.textStartPositionWithinEditor}_emitTypeEvent(e,t){if(!this._editContext)return;let n=this._context.viewModel.model,i=n.getOffsetAt(this._textStartPositionWithinEditor),r=n.getOffsetAt(this._primarySelection.getEndPosition()),s=n.getOffsetAt(this._primarySelection.getStartPosition()),a=r-i,l=s-i,d=0,c=0;t.updateRangeEnd>a&&(d=t.updateRangeEnd-a),t.updateRangeStart<l&&(c=l-t.updateRangeStart);let u="";l<t.updateRangeStart&&(u+=this._editContext.text.substring(l,t.updateRangeStart)),u+=t.text,a>t.updateRangeEnd&&(u+=this._editContext.text.substring(t.updateRangeEnd,a));let h={text:u,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(e,h);let m=l-c+u.length;this._updateCursorStatesAfterType(m,t.selectionStart,t.selectionEnd)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_updateCursorStatesAfterType(e,t,n){let i=t-e,r=n-e,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,u=d.column;return new Ue(c,u+i,c,u+r)}).map(d=>Ke.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let e=this._primarySelection.startColumn-1,t=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?t+=this._primarySelection.endColumn-1:t+=this._context.viewModel.model.getLineMaxColumn(a);let n=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),i=new L(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,n),r=this._context.viewModel.model.getValueInRange(i,0),s=i.getStartPosition();return{text:r,selectionStartOffset:e,selectionEndOffset:t,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(e){if(!this._editContext)return;let t=e.getTextFormats(),n=this._textStartPositionWithinEditor,i=[];t.forEach(r=>{let s=this._context.viewModel.model,a=s.getOffsetAt(n),l=s.getPositionAt(a+r.rangeStart),d=s.getPositionAt(a+r.rangeEnd),c=L.fromPositions(l,d),u=["edit-context-format-decoration",`underline-style-${r.underlineStyle.toLowerCase()}`,`underline-thickness-${r.underlineThickness.toLowerCase()}`];i.push({range:c,options:{description:"textFormatDecoration",inlineClassName:u.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,i)}_updateSelectionAndControlBounds(){if(!this._parent)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=i.top+r-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*t,d=i.left+n,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let m=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];m.length>0&&(d+=Math.min(...m.map(g=>Math.min(...g.ranges.map(f=>f.left)))))}c=e.get(51).typicalHalfwidthCharacterWidth/2}else c=i.width-n;let u=new DOMRect(d,a,c,l),h=u;this._editContext.updateControlBounds(h),this._editContext.updateSelectionBounds(u)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(r.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=i.top+s-a,d=[];if(this._renderingContext){let g=this._renderingContext.linesVisibleRangesForRange(r,!0)??[];for(let f of g)for(let b of f.ranges)d.push(new DOMRect(i.left+n+b.left,l,b.width,t))}let c=this._context.viewModel.model,u=c.getOffsetAt(this._textStartPositionWithinEditor),m=c.getOffsetAt(r.getStartPosition())-u;this._editContext.updateCharacterBounds(m,d)}_ensureClipboardGetsEditorSelection(e){let t=this._context.configuration.options,n=t.get(38),i=t.get(25),r=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=Ox(this._context.viewModel,r,n,i),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};Ru.INSTANCE.set(Bn?s.text.replace(/\r\n/g,`
`):s.text,a),e.writeText(s.text)}};vm=k([E(2,nt),E(3,IE)],vm);var ym=class extends ts{constructor(t,n,i,r,s,a,l){super();this._instantiationService=l;this._selections=[new Ue(1,1,1,1)],this._renderAnimationFrame=null;let d=new Ax(n,r,s,t);this._context=new ox(n,i,r),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(vm,this._context,d):this._instantiationService.createInstance(gm,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=Be(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Be(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=Be(document.createElement("div")),Xn.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new Yx(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new Qx(this._context,this._linesContent),this._viewZones=new bE(this._context),this._viewParts.push(this._viewZones);let u=new cE(this._context);this._viewParts.push(u);let h=new pE(this._context);this._viewParts.push(h);let m=new Wx(this._context);this._viewParts.push(m),m.addDynamicOverlay(new jx(this._context)),m.addDynamicOverlay(new gE(this._context)),m.addDynamicOverlay(new Xx(this._context)),m.addDynamicOverlay(new qx(this._context)),m.addDynamicOverlay(new vE(this._context));let g=new Hx(this._context);this._viewParts.push(g),g.addDynamicOverlay(new $x(this._context)),g.addDynamicOverlay(new eE(this._context)),g.addDynamicOverlay(new Jx(this._context)),g.addDynamicOverlay(new um(this._context)),this._glyphMarginWidgets=new Zx(this._context),this._viewParts.push(this._glyphMarginWidgets);let f=new hm(this._context);f.getDomNode().appendChild(this._viewZones.marginDomNode),f.getDomNode().appendChild(g.getDomNode()),f.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(f),this._contentWidgets=new zx(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new fE(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new dE(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let b=new hE(this._context);this._viewParts.push(b);let y=new Ux(this._context);this._viewParts.push(y);let C=new sE(this._context);if(this._viewParts.push(C),u){let S=this._scrollbar.getOverviewRulerLayoutInfo();S.parent.insertBefore(u.getDomNode(),S.insertBefore)}this._linesContent.appendChild(m.getDomNode()),this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(f.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(h.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(C.getDomNode()),this._overflowGuardContainer.appendChild(y.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new Bx(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let t=this._context.viewModel.model,n=this._context.viewModel.glyphLanes,i=[],r=0;i=i.concat(t.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return r=Math.max(r,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=t.validateRange(s.preference.range);return r=Math.max(r,a.endLineNumber),{range:a,lane:s.preference.lane}})),i.sort((s,a)=>L.compareRangesUsingStarts(s.range,a.range)),n.reset(r);for(let s of i)n.push(s.lane,s.range,s.persist);return n}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._editContext.domNode.domNode.dispatchEvent(t)},getLastRenderData:()=>{let t=this._viewCursors.getLastRenderData()||[],n=this._editContext.getLastRenderData();return new hx(t,n)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,n)),visibleRangeForPosition:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new V(t,n))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){let n=this._context.configuration.options.get(147);this.domNode.setWidth(n.width),this.domNode.setHeight(n.height),this._overflowGuardContainer.setWidth(n.width),this._overflowGuardContainer.setHeight(n.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let t=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+xf(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new Te;if(this._renderAnimationFrame===null){let t=this._createCoordinatedRendering();this._renderAnimationFrame=BR.INSTANCE.scheduleCoordinatedRendering({window:Ce(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new Te;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new Te;return t.renderText()},prepareRender:(n,i)=>{if(this._store.isDisposed)throw new Te;return t.prepareRender(n,i)},render:(n,i)=>{if(this._store.isDisposed)throw new Te;return t.render(n,i)}})}}_flushAccumulatedAndRenderNow(){let t=this._createCoordinatedRendering();Qd(()=>t.prepareRenderText());let n=Qd(()=>t.renderText());if(n){let[i,r]=n;Qd(()=>t.prepareRender(i,r)),Qd(()=>t.render(i,r))}}_getViewPartsToRender(){let t=[],n=0;for(let i of this._viewParts)i.shouldRender()&&(t[n++]=i);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}Rl.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;let n=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(n.startLineNumber,n.endLineNumber,n.centeredLineNumber);let i=new ex(this._selections,n,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new tx(this._context.viewLayout,i,this._viewLines)]},prepareRender:(t,n)=>{for(let i of t)i.prepareRender(n)},render:(t,n)=>{for(let i of t)i.render(n),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,n){let i=this._context.viewModel.model.validatePosition({lineNumber:t,column:n}),r=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new V(r.lineNumber,r.column));return s?s.left:-1}getTargetAtClientPoint(t,n){let i=this._pointerHandler.getTargetAtClientPoint(t,n);return i?rm.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new uE(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,n){if(n){this._viewLines.forceShouldRender();for(let i of this._viewParts)i.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._editContext.writeScreenReaderContent(t)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(t){this._editContext.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){this._contentWidgets.setWidgetPosition(t.widget,t.position?.position??null,t.position?.secondaryPosition??null,t.position?.preference??null,t.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){this._overlayWidgets.setWidgetPosition(t.widget,t.position)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){let n=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,n)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};ym=k([E(6,nt)],ym);function Qd(o){try{return o()}catch(e){return Ne(e),null}}var BR=class o{static INSTANCE=new o;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{let t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(let[n,i]of this._animationFrameRunners)i.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){let t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,V1(e,t,100))}}_onRenderScheduled(){let e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let n of e)Qd(()=>n.prepareRenderText());let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=Qd(()=>r.renderText())}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;Qd(()=>r.prepareRender(a,l))}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;Qd(()=>r.render(a,l))}}};var Z9=rx("domLineBreaksComputer",{createHTML:o=>o}),SE=class o{constructor(e){this.targetWindow=e}static create(e){return new o(new WeakRef(e))}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>X9(To(this.targetWindow.deref()),s,e,t,n,i,r,a)}}};function X9(o,e,t,n,i,r,s,a){function l(P){let K=a[P];if(K){let j=ko.applyInjectedText(e[P],K),X=K.map(ye=>ye.options),le=K.map(ye=>ye.column-1);return new Tl(le,X,[j.length],[],0)}else return null}if(i===-1){let P=[];for(let K=0,j=e.length;K<j;K++)P[K]=l(K);return P}let d=Math.round(i*t.typicalHalfwidthCharacterWidth),c=r===3?2:r===2?1:0,u=Math.round(n*c),h=Math.ceil(t.spaceWidth*u),m=document.createElement("div");Cn(m,t);let g=new Oc(1e4),f=[],b=[],y=[],C=[],S=[];for(let P=0;P<e.length;P++){let K=ko.applyInjectedText(e[P],a[P]),j=0,X=0,le=d;if(r!==0)if(j=ln(K),j===-1)j=0;else{for(let ce=0;ce<j;ce++){let ie=K.charCodeAt(ce)===9?n-X%n:1;X+=ie}let Q=Math.ceil(t.spaceWidth*X);Q+t.typicalFullwidthCharacterWidth>d?(j=0,X=0):le=d-Q}let ye=K.substr(j),q=Q9(ye,X,n,le,g,h);f[P]=j,b[P]=X,y[P]=ye,C[P]=q[0],S[P]=q[1]}let w=g.build(),R=Z9?.createHTML(w)??w;m.innerHTML=R,m.style.position="absolute",m.style.top="10000",s==="keepAll"?(m.style.wordBreak="keep-all",m.style.overflowWrap="anywhere"):(m.style.wordBreak="inherit",m.style.overflowWrap="break-word"),o.document.body.appendChild(m);let M=document.createRange(),N=Array.prototype.slice.call(m.children,0),A=[];for(let P=0;P<e.length;P++){let K=N[P],j=J9(M,K,y[P],C[P]);if(j===null){A[P]=l(P);continue}let X=f[P],le=b[P]+u,ye=S[P],q=[];for(let J=0,Se=j.length;J<Se;J++)q[J]=ye[j[J]];if(X!==0)for(let J=0,Se=j.length;J<Se;J++)j[J]+=X;let Q,ce,ie=a[P];ie?(Q=ie.map(J=>J.options),ce=ie.map(J=>J.column-1)):(Q=null,ce=null),A[P]=new Tl(ce,Q,j,q,le)}return m.remove(),A}function Q9(o,e,t,n,i,r){if(r!==0){let h=String(r);i.appendString('<div style="text-indent: -'),i.appendString(h),i.appendString("px; padding-left: "),i.appendString(h),i.appendString("px; box-sizing: border-box; width:")}else i.appendString('<div style="width:');i.appendString(String(n)),i.appendString('px;">');let s=o.length,a=e,l=0,d=[],c=[],u=0<s?o.charCodeAt(0):0;i.appendString("<span>");for(let h=0;h<s;h++){h!==0&&h%16384===0&&i.appendString("</span><span>"),d[h]=l,c[h]=a;let m=u;u=h+1<s?o.charCodeAt(h+1):0;let g=1,f=1;switch(m){case 9:g=t-a%t,f=g;for(let b=1;b<=g;b++)b<g?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 32:u===32?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 60:i.appendString("&lt;");break;case 62:i.appendString("&gt;");break;case 38:i.appendString("&amp;");break;case 0:i.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:i.appendCharCode(65533);break;default:Tr(m)&&f++,m<32?i.appendCharCode(9216+m):i.appendCharCode(m)}l+=g,a+=f}return i.appendString("</span>"),d[o.length]=l,c[o.length]=a,i.appendString("</div>"),[d,c]}function J9(o,e,t,n){if(t.length<=1)return null;let i=Array.prototype.slice.call(e.children,0),r=[];try{WR(o,i,n,0,null,t.length-1,null,r)}catch(s){return console.log(s),null}return r.length===0?null:(r.push(t.length),r)}function WR(o,e,t,n,i,r,s,a){if(n===r||(i=i||VR(o,e,t[n],t[n+1]),s=s||VR(o,e,t[r],t[r+1]),Math.abs(i[0].top-s[0].top)<=.1))return;if(n+1===r){a.push(r);return}let l=n+(r-n)/2|0,d=VR(o,e,t[l],t[l+1]);WR(o,e,t,n,i,l,d,a),WR(o,e,t,l,d,r,s,a)}function VR(o,e,t,n){return o.setStart(e[t/16384|0].firstChild,t%16384),o.setEnd(e[n/16384|0].firstChild,n%16384),o.getClientRects()}var xE=class extends B{_editor=null;_instantiationService=null;_instances=this._register(new Sr);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,n){this._editor=e,this._instantiationService=n;for(let i of t){if(this._pending.has(i.id)){Ne(new Error(`Cannot have two contributions with the same id ${i.id}`));continue}this._pending.set(i.id,i)}this._instantiateSome(0),this._register(eu(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(eu(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(eu(Ce(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let e={};for(let[t,n]of this._instances)typeof n.saveViewState=="function"&&(e[t]=n.saveViewState());return e}restoreViewState(e){for(let[t,n]of this._instances)typeof n.restoreViewState=="function"&&n.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}set(e,t){this._instances.set(e,t)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return eu(Ce(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;let t=this._findPendingContributionsByInstantiation(e);for(let n of t)this._instantiateById(n.id)}_findPendingContributionsByInstantiation(e){let t=[];for(let[,n]of this._pending)n.instantiation===e&&t.push(n);return t}_instantiateById(e){let t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let n=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,n),typeof n.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(n){Ne(n)}}}};var EE=class{constructor(e,t,n,i,r,s,a){this.id=e;this.label=t;this.alias=n;this.metadata=i;this._precondition=r;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}};var Al=Z("ILanguageFeaturesService");var wE=class o{static create(e){return new o(e.get(136),e.get(135))}classifier;constructor(e,t){this.classifier=new HR(e,t)}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[],l=[];return{addRequest:(d,c,u)=>{s.push(d),a.push(c),l.push(u)},finalize:()=>{let d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,c=[];for(let u=0,h=s.length;u<h;u++){let m=a[u],g=l[u];g&&!g.injectionOptions&&!m?c[u]=e8(this.classifier,g,s[u],t,n,d,i,r):c[u]=t8(this.classifier,s[u],m,t,n,d,i,r)}return UR.length=0,zR.length=0,c}}}};var HR=class extends Th{constructor(e,t){super(0);for(let n=0;n<e.length;n++)this.set(e.charCodeAt(n),1);for(let n=0;n<t.length;n++)this.set(t.charCodeAt(n),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}},UR=[],zR=[];function e8(o,e,t,n,i,r,s,a){if(i===-1)return null;let l=t.length;if(l<=1)return null;let d=a==="keepAll",c=e.breakOffsets,u=e.breakOffsetsVisibleColumn,h=RV(t,n,i,r,s),m=i-h,g=UR,f=zR,b=0,y=0,C=0,S=i,w=c.length,R=0;if(R>=0){let M=Math.abs(u[R]-S);for(;R+1<w;){let N=Math.abs(u[R+1]-S);if(N>=M)break;M=N,R++}}for(;R<w;){let M=R<0?0:c[R],N=R<0?0:u[R];y>M&&(M=y,N=C);let A=0,P=0,K=0,j=0;if(N<=S){let le=N,ye=M===0?0:t.charCodeAt(M-1),q=M===0?0:o.get(ye),Q=!0;for(let ce=M;ce<l;ce++){let ie=ce,J=t.charCodeAt(ce),Se,xe;if(qt(J)?(ce++,Se=0,xe=2):(Se=o.get(J),xe=jb(J,le,n,r)),ie>y&&KR(ye,q,J,Se,d)&&(A=ie,P=le),le+=xe,le>S){ie>y?(K=ie,j=le-xe):(K=ce+1,j=le),le-P>m&&(A=0),Q=!1;break}ye=J,q=Se}if(Q){b>0&&(g[b]=c[c.length-1],f[b]=u[c.length-1],b++);break}}if(A===0){let le=N,ye=t.charCodeAt(M),q=o.get(ye),Q=!1;for(let ce=M-1;ce>=y;ce--){let ie=ce+1,J=t.charCodeAt(ce);if(J===9){Q=!0;break}let Se,xe;if(sd(J)?(ce--,Se=0,xe=2):(Se=o.get(J),xe=Tr(J)?r:1),le<=S){if(K===0&&(K=ie,j=le),le<=S-m)break;if(KR(J,Se,ye,q,d)){A=ie,P=le;break}}le-=xe,ye=J,q=Se}if(A!==0){let ce=m-(j-P);if(ce<=n){let ie=t.charCodeAt(K),J;qt(ie)?J=2:J=jb(ie,j,n,r),ce-J<0&&(A=0)}}if(Q){R--;continue}}if(A===0&&(A=K,P=j),A<=y){let le=t.charCodeAt(y);qt(le)?(A=y+2,P=C+2):(A=y+1,P=C+jb(le,C,n,r))}for(y=A,g[b]=A,C=P,f[b]=P,b++,S=P+m;R<0||R<w&&u[R]<P;)R++;let X=Math.abs(u[R]-S);for(;R+1<w;){let le=Math.abs(u[R+1]-S);if(le>=X)break;X=le,R++}}return b===0?null:(g.length=b,f.length=b,UR=e.breakOffsets,zR=e.breakOffsetsVisibleColumn,e.breakOffsets=g,e.breakOffsetsVisibleColumn=f,e.wrappedTextIndentLength=h,e)}function t8(o,e,t,n,i,r,s,a){let l=ko.applyInjectedText(e,t),d,c;if(t&&t.length>0?(d=t.map(P=>P.options),c=t.map(P=>P.column-1)):(d=null,c=null),i===-1)return d?new Tl(c,d,[l.length],[],0):null;let u=l.length;if(u<=1)return d?new Tl(c,d,[l.length],[],0):null;let h=a==="keepAll",m=RV(l,n,i,r,s),g=i-m,f=[],b=[],y=0,C=0,S=0,w=i,R=l.charCodeAt(0),M=o.get(R),N=jb(R,0,n,r),A=1;qt(R)&&(N+=1,R=l.charCodeAt(1),M=o.get(R),A++);for(let P=A;P<u;P++){let K=P,j=l.charCodeAt(P),X,le;qt(j)?(P++,X=0,le=2):(X=o.get(j),le=jb(j,N,n,r)),KR(R,M,j,X,h)&&(C=K,S=N),N+=le,N>w&&((C===0||N-S>g)&&(C=K,S=N-le),f[y]=C,b[y]=S,y++,w=S+g,C=0),R=j,M=X}return y===0&&(!t||t.length===0)?null:(f[y]=u,b[y]=N,new Tl(c,d,f,b,m))}function jb(o,e,t,n){return o===9?t-e%t:Tr(o)||o<32?n:1}function DV(o,e){return e-o%e}function KR(o,e,t,n,i){return t!==32&&(e===2&&n!==2||e!==1&&n===1||!i&&e===3&&n!==2||!i&&n===3&&e!==1)}function RV(o,e,t,n,i){let r=0;if(i!==0){let s=ln(o);if(s!==-1){for(let l=0;l<s;l++){let d=o.charCodeAt(l)===9?DV(r,e):1;r+=d}let a=i===3?2:i===2?1:0;for(let l=0;l<a;l++){let d=DV(r,e);r+=d}r+n>t&&(r=0)}}return r}var $b=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(e,t,n,i){this.model=e,this.viewModel=t,this.coordinatesConverter=n,this.cursorConfig=i}};var qb=class o{modelState;viewState;_selTrackedRange;_trackSelection;constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new Sn(new L(1,1,1,1),0,0,new V(1,1),0),new Sn(new L(1,1,1,1),0,0,new V(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new Ke(this.modelState,this.viewState)}readSelectionFromMarkers(e){let t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?Ue.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):Ue.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}static _validatePositionWithCache(e,t,n,i){return t.equals(n)?i:e.normalizePosition(t,2)}static _validateViewState(e,t){let n=t.position,i=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),s=e.normalizePosition(n,2),a=this._validatePositionWithCache(e,i,n,s),l=this._validatePositionWithCache(e,r,i,a);return n.equals(s)&&i.equals(a)&&r.equals(l)?t:new Sn(L.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+i.column-a.column,s,t.leftoverVisibleColumns+n.column-s.column)}_setState(e,t,n){if(n&&(n=o._validateViewState(e.viewModel,n)),t){let i=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(i)?t.selectionStartLeftoverVisibleColumns:0,s=e.model.validatePosition(t.position),a=t.position.equals(s)?t.leftoverVisibleColumns:0;t=new Sn(i,t.selectionStartKind,r,s,a)}else{if(!n)return;let i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new Sn(i,n.selectionStartKind,n.selectionStartLeftoverVisibleColumns,r,n.leftoverVisibleColumns)}if(n){let i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new Sn(i,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{let i=e.coordinatesConverter.convertModelPositionToViewPosition(new V(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new V(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),s=new L(i.lineNumber,i.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new Sn(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}};var Yb=class{context;cursors;lastAddedCursorIndex;constructor(e){this.context=e,this.cursors=[new qb(e)],this.lastAddedCursorIndex=0}dispose(){for(let e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(let e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(let e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(let e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return DM(this.cursors,ui(e=>e.viewState.position,V.compare)).viewState.position}getBottomMostViewPosition(){return LM(this.cursors,ui(e=>e.viewState.position,V.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(Ke.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){let t=this.cursors.length-1,n=e.length;if(t<n){let i=n-t;for(let r=0;r<i;r++)this._addSecondaryCursor()}else if(t>n){let i=t-n;for(let r=0;r<i;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<n;i++)this.cursors[i+1].setState(this.context,e[i].modelState,e[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new qb(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;let e=this.cursors.slice(0),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort(ui(n=>n.selection,L.compareRangesUsingStarts));for(let n=0;n<t.length-1;n++){let i=t[n],r=t[n+1],s=i.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=i.index<r.index?n:n+1,c=i.index<r.index?n+1:n,u=t[c].index,h=t[d].index,m=t[c].selection,g=t[d].selection;if(!m.equalsSelection(g)){let f=m.plusRange(g),b=m.selectionStartLineNumber===m.startLineNumber&&m.selectionStartColumn===m.startColumn,y=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn,C;u===this.lastAddedCursorIndex?(C=b,this.lastAddedCursorIndex=h):C=y;let S;C?S=new Ue(f.startLineNumber,f.startColumn,f.endLineNumber,f.endColumn):S=new Ue(f.endLineNumber,f.endColumn,f.startLineNumber,f.startColumn),t[d].selection=S;let w=Ke.fromModelSelection(S);e[h].setState(this.context,w.modelState,w.viewState)}for(let f of t)f.index>u&&f.index--;e.splice(u,1),t.splice(c,1),this._removeSecondaryCursor(u-1),n--}}}};var _E=class extends B{_onEvent=this._register(new T);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,n=this._outgoingEvents.length;t<n;t++){let i=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(i){this._outgoingEvents[t]=i;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,n=this._eventHandlers.length;t<n;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new GR),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(let n of e)this._addOutgoingEvent(n);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let e=this._viewEventQueue;this._viewEventQueue=null;let t=this._eventHandlers.slice(0);for(let n of t)n.handleEvents(e)}}},GR=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}};var TE=class o{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(e,t,n,i){this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=n,this.contentHeight=i,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}},LE=class o{kind=1;oldHasFocus;hasFocus;constructor(e,t){this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldHasFocus,e.hasFocus)}},DE=class o{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e,t,n,i,r,s,a,l){this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=n,this._oldScrollTop=i,this.scrollWidth=r,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}},RE=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},kE=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},ME=class o{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(e,t,n,i,r,s,a){this.oldSelections=e,this.selections=t,this.oldModelVersionId=n,this.modelVersionId=i,this.source=r,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return o._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}},NE=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},AE=class{constructor(e){this.event=e}kind=7;isNoOp(){return!1}attemptToMerge(e){return null}},OE=class{constructor(e){this.event=e}kind=8;isNoOp(){return!1}attemptToMerge(e){return null}},PE=class{constructor(e){this.event=e}kind=9;isNoOp(){return!1}attemptToMerge(e){return null}},FE=class{constructor(e){this.event=e}kind=10;isNoOp(){return!1}attemptToMerge(e){return null}},BE=class{constructor(e){this.event=e}kind=11;isNoOp(){return!1}attemptToMerge(e){return null}},VE=class{constructor(e){this.event=e}kind=12;isNoOp(){return!1}attemptToMerge(e){return null}};var WE=class extends B{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new $b(this._model,this._viewModel,this._coordinatesConverter,i),this._cursors=new Yb(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=Nt(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new $b(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){let n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let r=!1,s=this.context.cursorConfig.multiCursorLimit;i!==null&&i.length>s&&(i=i.slice(0,s),r=!0);let a=Zb.from(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,n,i,r,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=L.fromPositions(a[0],a[0]),e.emitViewEvent(new Dl(t,n,l,d,i,r,s))}revealPrimary(e,t,n,i,r,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new Dl(t,n,null,l,i,r,s))}saveState(){let e=[],t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){let r=t[n];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),n.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,Ke.fromModelSelections(n)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof Fh){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let n=t.rawContentChangedEvent;if(this._knownModelVersionId=n.versionId,this._isHandling)return;let i=n.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new Yb(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&n.resultingSelection&&n.resultingSelection.length>0){let r=Ke.fromModelSelections(n.resultingSelection);this.setStates(e,"modelChange",n.isUndoing?5:n.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{let r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,Ke.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t,n,i){this.setStates(e,t,i,Ke.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let a=0,l=e.length;a<l;a++)n.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});let r=this._model.deltaDecorations([],n),s=this._model.deltaDecorations([],i);this._autoClosedActions.push(new HE(this._model,r,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();let t=jR.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let r=0;r<e.commands.length;r++){let s=e.commands[r];s instanceof tm&&s.enclosingRange&&s.closeCharacterRange&&(n.push(s.closeCharacterRange),i.push(s.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,r){let s=Zb.from(this._model,this);if(s.equals(i))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new AS(l,a,n)),!i||i.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(i.cursorState[c].modelState))){let d=i?i.cursorState.map(u=>u.modelState.selection):null,c=i?i.modelVersionId:0;e.emitOutgoingEvent(new ME(d,a,c,s.modelVersionId,t||"keyboard",n,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];if(!r.text||r.text.indexOf(`
`)>=0)return null;let s=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=r.text.length-s[2].length-1,u=r.text.lastIndexOf(d,c-1);if(u===-1)return null;t.push([u,c])}return t}executeEdits(e,t,n,i){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(n)),r&&(n[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),n,d=>{if(r)for(let u=0,h=r.length;u<h;u++){let[m,g]=r[u],f=d[u],b=f.range.startLineNumber,y=f.range.startColumn-1+m,C=f.range.startColumn-1+g;s.push(new L(b,C+1,b,C+2)),a.push(new L(b,y+1,b,C+2))}let c=i(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(e,t,n,i=0){if(this.context.cursorConfig.readOnly)return;let r=Zb.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(s){Ne(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,i,r,!1)&&this.revealAll(t,n,!1,0,!0,0)}getAutoClosedCharacters(){return HE.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new qR(this._model,this.getSelections())}endComposition(e,t){let n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Bs.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,n){this._executeEdit(()=>{if(n==="keyboard"){let i=t.length,r=0;for(;r<i;){let s=wg(t,r),a=t.substr(r,s);this._executeEditOperation(Bs.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),r+=s}}else this._executeEditOperation(Bs.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,n)}compositionType(e,t,n,i,r,s){if(t.length===0&&n===0&&i===0){if(r!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new Ue(d.lineNumber,d.column+r,d.lineNumber,d.column+r)});this.setSelections(e,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Bs.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,r))},e,s)}paste(e,t,n,i,r){this._executeEdit(()=>{this._executeEditOperation(Bs.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(Nl.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,n){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new Wn(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}executeCommands(e,t,n){this._executeEdit(()=>{this._executeEditOperation(new Wn(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}},Zb=class o{constructor(e,t){this.modelVersionId=e;this.cursorState=t}static from(e,t){return new o(e.getVersionId(),t.getCursorStates())}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}},HE=class{static getAllAutoClosedCharacters(e){let t=[];for(let n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){let n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let n=0;n<this._autoClosedEnclosingDecorations.length;n++){let i=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[n]);if(i&&(t.push(i),i.startLineNumber!==i.endLineNumber))return!1}t.sort(L.compareRangesUsingStarts),e.sort(L.compareRangesUsingStarts);for(let n=0;n<e.length;n++)if(n>=t.length||!t[n].strictContainsRange(e[n]))return!1;return!0}},jR=class{static executeCommands(e,t,n){let i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(i,n);for(let s=0,a=i.trackedRanges.length;s<a;s++)i.model._setTrackedRange(i.trackedRanges[s],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;let n=this._getEditOperations(e,t);if(n.operations.length===0)return null;let i=n.operations,r=this._getLoserCursorMap(i);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=i.length;d<c;d++)r.hasOwnProperty(i[d].identifier.major.toString())||s.push(i[d]);n.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,s,d=>{let c=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m]=[];for(let m of d)m.identifier&&c[m.identifier.major].push(m);let u=(m,g)=>m.identifier.minor-g.identifier.minor,h=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m].length>0?(c[m].sort(u),h[m]=t[m].computeCursorState(e.model,{getInverseEditOperations:()=>c[m],getTrackedSelection:g=>{let f=parseInt(g,10),b=e.model._getTrackedRange(e.trackedRanges[f]);return e.trackedRangesDirection[f]===0?new Ue(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):new Ue(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn)}})):h[m]=e.selectionsBefore[m];return h});a||(a=e.selectionsBefore);let l=[];for(let d in r)r.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(a){let l=this._getEditOperationsFromCommand(e,r,a);n=n.concat(l.operations),i=i||l.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let i=[],r=0,s=(u,h,m=!1)=>{L.isEmpty(u)&&h===""||i.push({identifier:{major:t,minor:r++},range:u,text:h,forceMoveMarkers:m,isAutoWhitespaceEdit:n.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(u,h,m)=>{a=!0,s(u,h,m)},trackSelection:(u,h)=>{let m=Ue.liftSelection(u),g;if(m.isEmpty())if(typeof h=="boolean")h?g=2:g=3;else{let y=e.model.getLineMaxColumn(m.startLineNumber);m.startColumn===y?g=2:g=3}else g=1;let f=e.trackedRanges.length,b=e.model._setTrackedRange(null,m,g);return e.trackedRanges[f]=b,e.trackedRangesDirection[f]=m.getDirection(),f.toString()}};try{n.getEditOperations(e.model,c)}catch(u){return Ne(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:i,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((n,i)=>-L.compareRangesUsingEnds(n.range,i.range));let t={};for(let n=1;n<e.length;n++){let i=e[n-1],r=e[n];if(L.getStartPosition(i.range).isBefore(L.getEndPosition(r.range))){let s;i.identifier.major>r.identifier.major?s=i.identifier.major:s=r.identifier.major,t[s.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===s&&(e.splice(a,1),a<n&&n--,a--);n>0&&n--}}return t}},$R=class{constructor(e,t,n){this.text=e;this.startSelection=t;this.endSelection=n}},qR=class o{_original;static _capture(e,t){let n=[];for(let i of t){if(i.startLineNumber!==i.endLineNumber)return null;n.push(new $R(e.getLineContent(i.startLineNumber),i.startColumn-1,i.endColumn-1))}return n}constructor(e,t){this._original=o._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;let n=o._capture(e,t);if(!n||this._original.length!==n.length)return null;let i=[];for(let r=0,s=this._original.length;r<s;r++)i.push(o._deduceOutcome(this._original[r],n[r]));return i}static _deduceOutcome(e,t){let n=Math.min(e.startSelection,t.startSelection,xg(e.text,t.text)),i=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,Eg(e.text,t.text)),r=e.text.substring(n,e.text.length-i),s=t.text.substring(n,t.text.length-i);return new Mx(r,e.startSelection-n,e.endSelection-n,s,t.startSelection-n,t.endSelection-n)}};function kV(o,e,t,n,i,r,s){let a="<div>",l=n,d=0,c=!0;for(let u=0,h=e.getCount();u<h;u++){let m=e.getEndOffset(u);if(m<=n)continue;let g="";for(;l<m&&l<i;l++){let f=o.charCodeAt(l);switch(f){case 9:{let b=r-(l+d)%r;for(d+=b-1;b>0;)s&&c?(g+="&#160;",c=!1):(g+=" ",c=!0),b--;break}case 60:g+="&lt;",c=!1;break;case 62:g+="&gt;",c=!1;break;case 38:g+="&amp;",c=!1;break;case 0:g+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:g+="\uFFFD",c=!1;break;case 13:g+="&#8203",c=!1;break;case 32:s&&c?(g+="&#160;",c=!1):(g+=" ",c=!0);break;default:g+=String.fromCharCode(f),c=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${g}</span>`,m>i||l>=i)break}return a+="</div>",a}var YR=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;let t=this._inserts,n=this._changes,i=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,n,i)}},ZR=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(e,t,n,i,r){this.id=e,this.afterLineNumber=t,this.ordinal=n,this.height=i,this.minWidth=r,this.prefixSum=0}},UE=class o{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(e,t,n,i){this._instanceId=Jv(++o.INSTANCE_COUNT),this._pendingChanges=new YR,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=n,this._paddingBottom=i}static findInsertionIndex(e,t,n){let i=0,r=e.length;for(;i<r;){let s=i+r>>>1;t===e[s].afterLineNumber?n<e[s].ordinal?r=s:i=s+1:t<e[s].afterLineNumber?r=s:i=s+1}return i}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(i,r,s,a)=>{t=!0,i=i|0,r=r|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new ZR(l,i,r,s,a)),l},changeOneWhitespace:(i,r,s)=>{t=!0,r=r|0,s=s|0,this._pendingChanges.change({id:i,newAfterLineNumber:r,newHeight:s})},removeWhitespace:i=>{t=!0,this._pendingChanges.remove({id:i})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,n){if((e.length>0||n.length>0)&&(this._minWidth=-1),e.length+t.length+n.length<=1){for(let l of e)this._insertWhitespace(l);for(let l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of n){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let i=new Set;for(let l of n)i.add(l.id);let r=new Map;for(let l of t)r.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!i.has(c.id)){if(r.has(c.id)){let u=r.get(c.id);c.afterLineNumber=u.newAfterLineNumber,c.height=u.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(e));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){let t=o.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){let t=this._arr;for(let n=0,i=t.length;n<i;n++)if(t[n].id===e)return n;return-1}_changeOneWhitespace(e,t,n){let i=this._findWhitespaceIndex(e);if(i!==-1&&(this._arr[i].height!==n&&(this._arr[i].height=n,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,i-1)),this._arr[i].afterLineNumber!==t)){let r=this._arr[i];this._removeWhitespace(i),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&r<=t?this._arr[n].afterLineNumber=e-1:r>t&&(this._arr[n].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&(this._arr[n].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let n=t;n<=e;n++)this._arr[n].prefixSum=this._arr[n-1].prefixSum+this._arr[n].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;let t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;let t=this._arr,n=0,i=t.length-1;for(;n<=i;){let s=(i-n|0)/2|0,a=n+s|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;n=a+1|0}else i=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;let n=this._findLastWhitespaceBeforeLineNumber(e)+1;return n<this._arr.length?n:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n;e>1?n=this._lineHeight*(e-1):n=0;let i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return n+i+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n=this._lineHeight*e,i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return n+i+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,n=this._arr.length;t<n;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;let t=this._lineCount|0,n=this._lineHeight,i=1,r=t;for(;i<r;){let s=(i+r)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(e>=a+n)i=s+1;else{if(e>=a)return s;r=s}}return i>t?t:i}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this._lineHeight,i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,r=this.getVerticalOffsetForLineNumber(i)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(i)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let u=r,h=u,m=5e5,g=0;r>=m&&(g=Math.floor(r/m)*m,g=Math.floor(g/n)*n,h-=g);let f=[],b=e+(t-e)/2,y=-1;for(let R=i;R<=s;R++){if(y===-1){let M=u,N=u+n;(M<=b&&b<N||M>b)&&(y=R)}for(u+=n,f[R-i]=h,h+=n;c===R;)h+=d,u+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){s=R;break}}y===-1&&(y=s);let C=this.getVerticalOffsetForLineNumber(s)|0,S=i,w=s;return S<w&&r<e&&S++,S<w&&C+n>t&&w--,{bigNumbersDelta:g,startLineNumber:i,endLineNumber:s,relativeVerticalOffset:f,centeredLineNumber:y,completelyVisibleStartLineNumber:S,completelyVisibleEndLineNumber:w,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;let t=this.getAfterLineNumberForWhitespaceIndex(e),n;t>=1?n=this._lineHeight*t:n=0;let i;return e>0?i=this.getWhitespacesAccumulatedHeight(e-1):i=0,n+i+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,n=this.getWhitespacesCount()-1;if(n<0)return-1;let i=this.getVerticalOffsetForWhitespaceIndex(n),r=this.getHeightForWhitespaceIndex(n);if(e>=i+r)return-1;for(;t<n;){let s=Math.floor((t+n)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(e>=a+l)t=s+1;else{if(e>=a)return s;n=s}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;let n=this.getVerticalOffsetForWhitespaceIndex(t);if(n>e)return null;let i=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),s=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:s,verticalOffset:n,height:i}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),i=this.getWhitespacesCount()-1;if(n<0)return[];let r=[];for(let s=n;s<=i;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};var i8=125,Au=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(e,t,n,i){e=e|0,t=t|0,n=n|0,i=i|0,e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),i<0&&(i=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=n,this.contentHeight=i,this.scrollHeight=Math.max(n,i)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}},XR=class extends B{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new T);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(e,t){super(),this._dimensions=new Au(0,0,0,0),this._scrollable=this._register(new rl({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;let t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);let n=t.contentWidth!==e.contentWidth,i=t.contentHeight!==e.contentHeight;(n||i)&&this._onDidContentSizeChange.fire(new TE(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},zE=class extends B{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(e,t,n){super(),this._configuration=e;let i=this._configuration.options,r=i.get(147),s=i.get(85);this._linesLayout=new UE(t,i.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new XR(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new Au(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?i8:0)}onConfigurationChanged(e){let t=this._configuration.options;if(e.hasChanged(68)&&this._linesLayout.setLineHeight(t.get(68)),e.hasChanged(85)){let n=t.get(85);this._linesLayout.setPadding(n.top,n.bottom)}if(e.hasChanged(147)){let n=t.get(147),i=n.contentWidth,r=n.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new Au(i,s.contentWidth,r,this._getContentHeight(i,r,a)))}else this._updateHeight();e.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){let i=this._configuration.options.get(105);return i.horizontal===2||e>=t?0:i.horizontalScrollbarSize}_getContentHeight(e,t,n){let i=this._configuration.options,r=this._linesLayout.getLinesTotalHeight();return i.get(107)?r+=Math.max(0,t-i.get(68)-i.get(85).bottom):i.get(105).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,n)),r}_updateHeight(){let e=this._scrollable.getScrollDimensions(),t=e.width,n=e.height,i=e.contentWidth;this._scrollable.setScrollDimensions(new Au(t,e.contentWidth,n,this._getContentHeight(t,n,i)))}getCurrentViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new Eb(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new Eb(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){let e=this._configuration.options,t=this._maxLineWidth,n=e.get(148),i=e.get(51),r=e.get(147);if(n.isViewportWrapping){let s=e.get(74);return t>r.contentWidth+i.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?t+r.verticalScrollbarWidth:t}else{let s=e.get(106)*i.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+s+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){let e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new Au(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){let e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,n=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),i=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(n);return{scrollTop:t,scrollTopWithoutViewZones:t-i,scrollLeft:e.scrollLeft}}changeWhitespace(e){let t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){let t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){let n=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:n.scrollLeft+e,scrollTop:n.scrollTop+t})}};function jE(o,e){return o===null?e?KE.INSTANCE:GE.INSTANCE:new JR(o,e)}var JR=class{_projectionData;_isVisible;constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,n){this._assertVisible();let i=n>0?this._projectionData.breakOffsets[n-1]:0,r=this._projectionData.breakOffsets[n],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new ko(0,0,d+1,this._projectionData.injectionOptions[c],0));s=ko.applyInjectedText(e.getLineContent(t),a).substring(i,r)}else s=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:r+1});return n>0&&(s=MV(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(e,t,n){return this._assertVisible(),this._projectionData.getLineLength(n)}getViewLineMinColumn(e,t,n){return this._assertVisible(),this._projectionData.getMinOutputOffset(n)+1}getViewLineMaxColumn(e,t,n){return this._assertVisible(),this._projectionData.getMaxOutputOffset(n)+1}getViewLineData(e,t,n){let i=new Array;return this.getViewLinesData(e,t,n,1,0,[!0],i),i[0]}getViewLinesData(e,t,n,i,r,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,u=null;if(d){u=[];let m=0,g=0;for(let f=0;f<l.getOutputLineCount();f++){let b=new Array;u[f]=b;let y=f>0?l.breakOffsets[f-1]:0,C=l.breakOffsets[f];for(;g<d.length;){let S=c[g].content.length,w=d[g]+m,R=w+S;if(w>C)break;if(y<R){let M=c[g];if(M.inlineClassName){let N=f>0?l.wrappedTextIndentLength:0,A=N+Math.max(w-y,0),P=N+Math.min(R-y,C-y);A!==P&&b.push(new KS(A,P,M.inlineClassName,M.inlineClassNameAffectsLetterSpacing))}}if(R<=C)m+=S,g++;else break}}}let h;if(d){let m=[];for(let g=0;g<d.length;g++){let f=d[g],b=c[g].tokens;b?b.forEach((y,C)=>{m.push({offset:f,text:y.substring(c[g].content),tokenMetadata:C.metadata})}):m.push({offset:f,text:c[g].content,tokenMetadata:yn.defaultTokenMetadata})}h=e.tokenization.getLineTokens(t).withInserted(m)}else h=e.tokenization.getLineTokens(t);for(let m=n;m<n+i;m++){let g=r+m-n;if(!s[g]){a[g]=null;continue}a[g]=this._getViewLineData(h,u?u[m]:null,m)}}_getViewLineData(e,t,n){this._assertVisible();let i=this._projectionData,r=n>0?i.wrappedTextIndentLength:0,s=n>0?i.breakOffsets[n-1]:0,a=i.breakOffsets[n],l=e.sliceAndInflate(s,a,r),d=l.getLineContent();n>0&&(d=MV(i.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(n)+1,u=d.length+1,h=n+1<this.getViewLineCount(),m=n===0?0:i.breakOffsetsVisibleColumn[n-1];return new fu(d,h,c,u,m,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,n=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,n).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();let n=this._projectionData.translateToOutputPosition(t-1);return e+n.outputLineIndex}normalizePosition(e,t,n){let i=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,n).toPosition(i)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},KE=class o{static INSTANCE=new o;constructor(){}isVisible(){return!0}setVisible(e){return e?this:GE.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,n){return e.getLineContent(t)}getViewLineLength(e,t,n){return e.getLineLength(t)}getViewLineMinColumn(e,t,n){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,n){return e.getLineMaxColumn(t)}getViewLineData(e,t,n){let i=e.tokenization.getLineTokens(t),r=i.getLineContent();return new fu(r,!1,1,r.length+1,0,i.inflate(),null)}getViewLinesData(e,t,n,i,r,s,a){if(!s[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new V(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,n){return t}getInjectedTextAt(e,t){return null}},GE=class o{static INSTANCE=new o;constructor(){}isVisible(){return!1}setVisible(e){return e?KE.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,n){throw new Error("Not supported")}getViewLineLength(e,t,n){throw new Error("Not supported")}getViewLineMinColumn(e,t,n){throw new Error("Not supported")}getViewLineMaxColumn(e,t,n){throw new Error("Not supported")}getViewLineData(e,t,n){throw new Error("Not supported")}getViewLinesData(e,t,n,i,r,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,n){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}},QR=[""];function MV(o){if(o>=QR.length)for(let e=1;e<=o;e++)QR[e]=o8(e);return QR[o]}function o8(o){return new Array(o+1).join(" ")}var $E=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();let t=this._indexBySum[e],n=t>0?this._prefixSum[t-1]:0;return new ek(t,e-n)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=js(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){let n=this._values[e],i=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=i+n;for(let r=0;r<n;r++)this._indexBySum[i+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}},ek=class{constructor(e,t){this.index=e;this.remainder=t;this.index=e,this.remainder=t}_prefixSumIndexOfResultBrand=void 0};var qE=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(e,t,n,i,r,s,a,l,d,c){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=n,this._monospaceLineBreaksComputerFactory=i,this.fontInfo=r,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new tk(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let n=this.model.getLinesContent(),i=this.model.getInjectedTextDecorations(this._editorId),r=n.length,s=this.createLineBreaksComputer(),a=new Li(ko.fromDecorations(i));for(let f=0;f<r;f++){let b=a.takeWhile(y=>y.lineNumber===f+1);s.addRequest(n[f],b,t?t[f]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(f=>this.model.getDecorationRange(f)).sort(L.compareRangesUsingStarts),u=1,h=0,m=-1,g=m+1<c.length?h+1:r+2;for(let f=0;f<r;f++){let b=f+1;b===g&&(m++,u=c[m].startLineNumber,h=c[m].endLineNumber,g=m+1<c.length?h+1:r+2);let y=b>=u&&b<=h,C=jE(l[f],!y);d[f]=C.getViewLineCount(),this.modelLineProjections[f]=C}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new $E(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){let t=e.map(h=>this.model.validateRange(h)),n=r8(t),i=this.hiddenAreasDecorationIds.map(h=>this.model.getDecorationRange(h)).sort(L.compareRangesUsingStarts);if(n.length===i.length){let h=!1;for(let m=0;m<n.length;m++)if(!n[m].equalsRange(i[m])){h=!0;break}if(!h)return!1}let r=n.map(h=>({range:h,options:Gt.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);let s=n,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,u=!1;for(let h=0;h<this.modelLineProjections.length;h++){let m=h+1;m===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let g=!1;if(m>=a&&m<=l?this.modelLineProjections[h].isVisible()&&(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!1),g=!0):(u=!0,this.modelLineProjections[h].isVisible()||(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!0),g=!0)),g){let f=this.modelLineProjections[h].getViewLineCount();this.projectedModelLineLineCounts.setValue(h,f)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,n,i,r){let s=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===n,d=this.wrappingIndent===i,c=this.wordBreak===r;if(s&&a&&l&&d&&c)return!1;let u=s&&a&&!l&&d&&c;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=n,this.wrappingIndent=i,this.wordBreak=r;let h=null;if(u){h=[];for(let m=0,g=this.modelLineProjections.length;m<g;m++)h[m]=this.modelLineProjections[m].getProjectionData()}return this._constructLines(!1,h),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,n){if(!e||e<=this._validModelVersionId)return null;let i=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections.splice(t-1,n-t+1),this.projectedModelLineLineCounts.removeValues(t-1,n-t+1),new Fp(i,r)}onModelLinesInserted(e,t,n,i){if(!e||e<=this._validModelVersionId)return null;let r=t>2&&!this.modelLineProjections[t-2].isVisible(),s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,a=0,l=[],d=[];for(let c=0,u=i.length;c<u;c++){let h=jE(i[c],!r);l.push(h);let m=h.getViewLineCount();a+=m,d[c]=m}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,d),new Bp(s,s+a-1)}onModelLineChanged(e,t,n){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let i=t-1,r=this.modelLineProjections[i].getViewLineCount(),s=this.modelLineProjections[i].isVisible(),a=jE(n,s);this.modelLineProjections[i]=a;let l=this.modelLineProjections[i].getViewLineCount(),d=!1,c=0,u=-1,h=0,m=-1,g=0,f=-1;r>l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1,g=u+1,f=g+(r-l)-1,d=!0):r<l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+r-1,h=u+1,m=h+(l-r)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1),this.projectedModelLineLineCounts.setValue(i,l);let b=c<=u?new xb(c,u-c+1):null,y=h<=m?new Bp(h,m):null,C=g<=f?new Fp(g,f):null;return[d,b,y,C]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;let t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),n=this._toValidViewLineNumber(n);let i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(n,this.getViewLineMinColumn(n)),a=this.model.guides.getActiveIndentGuide(i.lineNumber,r.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.projectedModelLineLineCounts.getIndexOf(e-1),n=t.index,i=t.remainder;return new YE(n+1,i)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new V(e.modelLineNumber,i)}getModelEndPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new V(e.modelLineNumber,i)}getViewLineInfosGroupedByModelRanges(e,t){let n=this.getViewLineInfo(e),i=this.getViewLineInfo(t),r=new Array,s=this.getModelStartPositionOfViewLine(n),a=new Array;for(let l=n.modelLineNumber;l<=i.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===n.modelLineNumber?n.modelLineWrappedLineIdx:0,u=l===i.modelLineNumber?i.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let h=c;h<u;h++)a.push(new YE(l,h))}if(!d.isVisible()&&s){let c=new V(l-1,this.model.getLineMaxColumn(l-1)+1),u=L.fromPositions(s,c);r.push(new ZE(u,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new V(l,1))}if(s){let l=L.fromPositions(s,this.getModelEndPositionOfViewLine(i));r.push(new ZE(l,a))}return r}getViewLinesBracketGuides(e,t,n,i){let r=n?this.convertViewPositionToModelPosition(n.lineNumber,n.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(e,t)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,i);for(let c of a.viewLines){let h=d[c.modelLineNumber-l].map(m=>{if(m.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||m.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!m.horizontalLine)return m;let g=-1;if(m.column!==-1){let y=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.column);if(y.lineNumber===c.modelLineWrappedLineIdx)g=y.column;else if(y.lineNumber<c.modelLineWrappedLineIdx)g=this.getMinColumnOfViewLine(c);else if(y.lineNumber>c.modelLineWrappedLineIdx)return}let f=this.convertModelPositionToViewPosition(c.modelLineNumber,m.horizontalLine.endColumn),b=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.horizontalLine.endColumn);return b.lineNumber===c.modelLineWrappedLineIdx?new Zr(m.visibleColumn,g,m.className,new dl(m.horizontalLine.top,f.column),-1,-1):b.lineNumber<c.modelLineWrappedLineIdx||m.visibleColumn!==-1?void 0:new Zr(m.visibleColumn,g,m.className,new dl(m.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(h.filter(m=>!!m))}}return s}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),i=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t)),r=[],s=[],a=[],l=n.lineNumber-1,d=i.lineNumber-1,c=null;for(let g=l;g<=d;g++){let f=this.modelLineProjections[g];if(f.isVisible()){let b=f.getViewLineNumberOfModelPosition(0,g===l?n.column:1),y=f.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),C=y-b+1,S=0;C>1&&f.getViewLineMinColumn(this.model,g+1,y)===1&&(S=b===0?1:2),s.push(C),a.push(S),c===null&&(c=new V(g+1,0))}else c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,g)),c=null)}c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,i.lineNumber)),c=null);let u=t-e+1,h=new Array(u),m=0;for(let g=0,f=r.length;g<f;g++){let b=r[g],y=Math.min(u-m,s[g]),C=a[g],S;C===2?S=0:C===1?S=1:S=y;for(let w=0;w<y;w++)w===S&&(b=0),h[m++]=b}return h}getViewLineContent(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=e,s=i.index,a=i.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let u=this.modelLineProjections[d];if(!u.isVisible())continue;let h=d===s?a:0,m=u.getViewLineCount()-h,g=!1;if(r+m>t&&(g=!0,m=t-r+1),u.getViewLinesData(this.model,d+1,h,m,r-e,n,l),r+=m,g)break}return l}validateViewPosition(e,t,n){e=this._toValidViewLineNumber(e);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=i.index,s=i.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,s),d=a.getViewLineMaxColumn(this.model,r+1,s);t<l&&(t=l),t>d&&(t=d);let c=a.getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new V(r+1,c)).equals(n)?new V(e,t):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}validateViewRange(e,t){let n=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),i=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new L(n.lineNumber,n.column,i.lineNumber,i.column)}convertViewPositionToModelPosition(e,t){let n=this.getViewLineInfo(e),i=this.modelLineProjections[n.modelLineNumber-1].getModelColumnOfViewPosition(n.modelLineWrappedLineIdx,t);return this.model.validatePosition(new V(n.modelLineNumber,i))}convertViewRangeToModelRange(e){let t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new L(t.lineNumber,t.column,n.lineNumber,n.column)}convertModelPositionToViewPosition(e,t,n=2,i=!1,r=!1){let s=this.model.validatePosition(new V(e,t)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(r)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new V(i?0:1,1);let u=1+this.projectedModelLineLineCounts.getPrefixSum(d),h;return c?r?h=this.modelLineProjections[d].getViewPositionOfModelPosition(u,1,n):h=this.modelLineProjections[d].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(d+1),n):h=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,n),h}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return L.fromPositions(n)}else{let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),i=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new L(n.lineNumber,n.column,i.lineNumber,i.column)}}getViewLineNumberOfModelPosition(e,t){let n=e-1;if(this.modelLineProjections[n].isVisible()){let r=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(r,t)}for(;n>0&&!this.modelLineProjections[n].isVisible();)n--;if(n===0&&!this.modelLineProjections[n].isVisible())return 1;let i=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(i,this.model.getLineMaxColumn(n+1))}getDecorationsInRange(e,t,n,i,r){let s=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-s.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new L(s.lineNumber,1,a.lineNumber,a.column),t,n,i,r);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,u=null;for(let f=d;f<=c;f++)if(this.modelLineProjections[f].isVisible())u===null&&(u=new V(f+1,f===d?s.column:1));else if(u!==null){let y=this.model.getLineMaxColumn(f);l=l.concat(this.model.getDecorationsInRange(new L(u.lineNumber,u.column,f,y),t,n,i)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new L(u.lineNumber,u.column,a.lineNumber,a.column),t,n,i)),u=null),l.sort((f,b)=>{let y=L.compareRangesUsingStarts(f.range,b.range);return y===0?f.id<b.id?-1:f.id>b.id?1:0:y});let h=[],m=0,g=null;for(let f of l){let b=f.id;g!==b&&(g=b,h[m++]=f)}return h}getInjectedTextAt(e){let t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){let n=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[n.modelLineNumber-1].normalizePosition(n.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){let t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}};function r8(o){if(o.length===0)return[];let e=o.slice();e.sort(L.compareRangesUsingStarts);let t=[],n=e[0].startLineNumber,i=e[0].endLineNumber;for(let r=1,s=e.length;r<s;r++){let a=e[r];a.startLineNumber>i+1?(t.push(new L(n,1,i,1)),n=a.startLineNumber,i=a.endLineNumber):a.endLineNumber>i&&(i=a.endLineNumber)}return t.push(new L(n,1,i,1)),t}var YE=class{constructor(e,t){this.modelLineNumber=e;this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},ZE=class{constructor(e,t){this.modelRange=e;this.viewLines=t}},tk=class{_lines;constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,n,i){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,n,i)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}};var XE=class{model;constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new nk(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,n,i){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,n,i)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,n){return new Fp(t,n)}onModelLinesInserted(e,t,n,i){return new Bp(t,n)}onModelLineChanged(e,t,n){return[!1,new xb(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,n){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,n){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){let n=t-e+1,i=new Array(n);for(let r=0;r<n;r++)i[r]=0;return i}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.tokenization.getLineTokens(e),n=t.getLineContent();return new fu(n,!1,1,n.length+1,0,t.inflate(),null)}getViewLinesData(e,t,n){let i=this.model.getLineCount();e=Math.min(Math.max(1,e),i),t=Math.min(Math.max(1,t),i);let r=[];for(let s=e;s<=t;s++){let a=s-e;r[a]=n[a]?this.getViewLineData(s):null}return r}getDecorationsInRange(e,t,n,i,r){return this.model.getDecorationsInRange(e,t,n,i,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}},nk=class{_lines;constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){let t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}modelRangeIsVisible(e){let t=this._lines.model.getLineCount();return!(e.startLineNumber<1||e.startLineNumber>t||e.endLineNumber<1||e.endLineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}};var QE=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(e,t,n,i,r){this.editorId=e,this.model=t,this.configuration=n,this._linesCollection=i,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){let t=e.id,n=this._decorationsCache[t];if(!n){let i=e.range,r=e.options,s;if(r.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new V(i.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new V(i.endLineNumber,this.model.getLineMaxColumn(i.endLineNumber)),1);s=new L(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(i,1);n=new Wp(s,r),this._decorationsCache[t]=n}return n}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,n=!1){let i=new L(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(i,t,n).inlineDecorations[0]}_getDecorationsInRange(e,t,n){let i=this._linesCollection.getDecorationsInRange(e,this.editorId,Ac(this.configuration.options),t,n),r=e.startLineNumber,s=e.endLineNumber,a=[],l=0,d=[];for(let c=r;c<=s;c++)d[c-r]=[];for(let c=0,u=i.length;c<u;c++){let h=i[c],m=h.options;if(!s8(this.model,h))continue;let g=this._getOrCreateViewModelDecoration(h),f=g.range;if(a[l++]=g,m.inlineClassName){let b=new bu(f,m.inlineClassName,m.inlineClassNameAffectsLetterSpacing?3:0),y=Math.max(r,f.startLineNumber),C=Math.min(s,f.endLineNumber);for(let S=y;S<=C;S++)d[S-r].push(b)}if(m.beforeContentClassName&&r<=f.startLineNumber&&f.startLineNumber<=s){let b=new bu(new L(f.startLineNumber,f.startColumn,f.startLineNumber,f.startColumn),m.beforeContentClassName,1);d[f.startLineNumber-r].push(b)}if(m.afterContentClassName&&r<=f.endLineNumber&&f.endLineNumber<=s){let b=new bu(new L(f.endLineNumber,f.endColumn,f.endLineNumber,f.endColumn),m.afterContentClassName,2);d[f.endLineNumber-r].push(b)}}return{decorations:a,inlineDecorations:d}}};function s8(o,e){return!(e.options.hideInCommentTokens&&a8(o,e)||e.options.hideInStringTokens&&l8(o,e))}function a8(o,e){return NV(o,e.range,t=>t===1)}function l8(o,e){return NV(o,e.range,t=>t===2)}function NV(o,e,t){for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let i=o.tokenization.getLineTokens(n),r=n===e.startLineNumber,s=n===e.endLineNumber,a=r?i.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<i.getCount()&&!(s&&i.getStartOffset(a)>e.endColumn-1);){if(!t(i.getStandardTokenType(a)))return!1;a++}}return!0}var Ou=3,JE=class{lanes;persist=0;_requiredLanes=1;constructor(e){this.lanes=new Uint8Array(Math.ceil((e+1)*Ou/8))}reset(e){let t=Math.ceil((e+1)*Ou/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,n){n&&(this.persist|=1<<e-1);for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let r=Ou*i+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(i))}}getLanesAtLine(e){let t=[],n=Ou*e;for(let i=0;i<Ou;i++)(this.persist&1<<i||this.lanes[n>>>3]&1<<n%8)&&t.push(i+1),n++;return t.length?t:[2]}countAtLine(e){let t=Ou*e,n=0;for(let i=0;i<Ou;i++)(this.persist&1<<i||this.lanes[t>>>3]&1<<t%8)&&n++,t++;return n}};var d8=!0,ew=class extends B{constructor(t,n,i,r,s,a,l,d,c,u){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=u;if(this._editorId=t,this._configuration=n,this.model=i,this._eventDispatcher=new _E,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Ll(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Yt(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=ik.create(this.model),this.glyphLanes=new JE(0),d8&&this.model.isTooLargeForTokenization())this._lines=new XE(this.model);else{let h=this._configuration.options,m=h.get(51),g=h.get(141),f=h.get(148),b=h.get(140),y=h.get(131);this._lines=new qE(this._editorId,this.model,r,s,m,this.model.getOptions().tabSize,g,f.wrappingColumn,b,y)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new WE(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new zE(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(h=>{h.scrollTopChanged&&this._handleVisibleLinesChanged(),h.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new FS(h)),this._eventDispatcher.emitOutgoingEvent(new DE(h.oldScrollWidth,h.oldScrollLeft,h.oldScrollHeight,h.oldScrollTop,h.scrollWidth,h.scrollLeft,h.scrollHeight,h.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(h=>{this._eventDispatcher.emitOutgoingEvent(h)})),this._decorations=new QE(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(h=>{try{let m=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(m,h)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(pm.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new WS)})),this._register(this._themeService.onDidColorThemeChange(h=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new BS(h))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let t=this.viewLayout.getLinesViewportData(),n=new L(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(n)}visibleLinesStabilized(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new OS(t)),this._eventDispatcher.emitOutgoingEvent(new LE(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new kS)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new MS)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let t=new V(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),n=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new tw(n,this._viewportStart.startLineDelta)}return new tw(null,0)}_onConfigurationChanged(t,n){let i=this._captureStableViewport(),r=this._configuration.options,s=r.get(51),a=r.get(141),l=r.get(148),d=r.get(140),c=r.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(t.emitViewEvent(new mu),t.emitViewEvent(new gu),t.emitViewEvent(new Fa(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),n.hasChanged(93)&&(this._decorations.reset(),t.emitViewEvent(new Fa(null))),n.hasChanged(100)&&(this._decorations.reset(),t.emitViewEvent(new Fa(null))),t.emitViewEvent(new NS(n)),this.viewLayout.onConfigurationChanged(n),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Ll.shouldRecreate(n)&&(this.cursorConfig=new Ll(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(t=>{try{let i=this._eventDispatcher.beginEmitViewEvents(),r=!1,s=!1,a=t instanceof wd?t.rawContentChangedEvent.changes:t.changes,l=t instanceof wd?t.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let h of a)switch(h.changeType){case 4:{for(let m=0;m<h.detail.length;m++){let g=h.detail[m],f=h.injectedTexts[m];f&&(f=f.filter(b=>!b.ownerId||b.ownerId===this._editorId)),d.addRequest(g,f,null)}break}case 2:{let m=null;h.injectedText&&(m=h.injectedText.filter(g=>!g.ownerId||g.ownerId===this._editorId)),d.addRequest(h.detail,m,null);break}}let c=d.finalize(),u=new Li(c);for(let h of a)switch(h.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new mu),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),r=!0;break}case 3:{let m=this._lines.onModelLinesDeleted(l,h.fromLineNumber,h.toLineNumber);m!==null&&(i.emitViewEvent(m),this.viewLayout.onLinesDeleted(m.fromLineNumber,m.toLineNumber)),r=!0;break}case 4:{let m=u.takeCount(h.detail.length),g=this._lines.onModelLinesInserted(l,h.fromLineNumber,h.toLineNumber,m);g!==null&&(i.emitViewEvent(g),this.viewLayout.onLinesInserted(g.fromLineNumber,g.toLineNumber)),r=!0;break}case 2:{let m=u.dequeue(),[g,f,b,y]=this._lines.onModelLineChanged(l,h.lineNumber,m);s=g,f&&i.emitViewEvent(f),b&&(i.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),y&&(i.emitViewEvent(y),this.viewLayout.onLinesDeleted(y.fromLineNumber,y.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!r&&s&&(i.emitViewEvent(new gu),i.emitViewEvent(new Fa(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){let i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){let r=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let i=this._eventDispatcher.beginEmitViewEvents();t instanceof wd&&i.emitOutgoingEvent(new FE(t.contentChangedEvent)),this._cursor.onModelContentChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(t=>{let n=[];for(let i=0,r=t.ranges.length;i<r;i++){let s=t.ranges[i],a=this.coordinatesConverter.convertModelPositionToViewPosition(new V(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new V(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;n[i]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new VS(n)),this._eventDispatcher.emitOutgoingEvent(new VE(t))})),this._register(this.model.onDidChangeLanguageConfiguration(t=>{this._eventDispatcher.emitSingleViewEvent(new PS),this.cursorConfig=new Ll(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new PE(t))})),this._register(this.model.onDidChangeLanguage(t=>{this.cursorConfig=new Ll(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new OE(t))})),this._register(this.model.onDidChangeOptions(t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new mu),n.emitViewEvent(new gu),n.emitViewEvent(new Fa(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Ll(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new BE(t))})),this._register(this.model.onDidChangeDecorations(t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Fa(t)),this._eventDispatcher.emitOutgoingEvent(new AE(t))}))}hiddenAreasModel=new rk;previousHiddenAreas=[];setHiddenAreas(t,n){this.hiddenAreasModel.setHiddenAreas(n,t);let i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;let r=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(i),s&&(a.emitViewEvent(new mu),a.emitViewEvent(new gu),a.emitViewEvent(new Fa(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=r.viewportStartModelPosition?.lineNumber;l&&i.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||r.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new kE)}getVisibleRangesPlusViewportAboveBelow(){let t=this._configuration.options.get(147),n=this._configuration.options.get(68),i=Math.max(20,Math.round(t.height/n)),r=this.viewLayout.getLinesViewportData(),s=Math.max(1,r.completelyVisibleStartLineNumber-i),a=Math.min(this.getLineCount(),r.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new L(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){let n=this.coordinatesConverter.convertViewRangeToModelRange(t),i=this._lines.getHiddenAreas();if(i.length===0)return[n];let r=[],s=0,a=n.startLineNumber,l=n.startColumn,d=n.endLineNumber,c=n.endColumn;for(let u=0,h=i.length;u<h;u++){let m=i[u].startLineNumber,g=i[u].endLineNumber;g<a||m>d||(a<m&&(r[s++]=new L(a,l,m-1,this.model.getLineMaxColumn(m-1))),a=g+1,l=1)}return(a<d||a===d&&l<c)&&(r[s++]=new L(a,l,d,c)),r}getCompletelyVisibleViewRange(){let t=this.viewLayout.getLinesViewportData(),n=t.completelyVisibleStartLineNumber,i=t.completelyVisibleEndLineNumber;return new L(n,this.getLineMinColumn(n),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(t){let n=this.viewLayout.getLinesViewportDataAtScrollTop(t),i=n.completelyVisibleStartLineNumber,r=n.completelyVisibleEndLineNumber;return new L(i,this.getLineMinColumn(i),r,this.getLineMaxColumn(r))}saveState(){let t=this.viewLayout.saveState(),n=t.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(n),r=this.coordinatesConverter.convertViewPositionToModelPosition(new V(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-n;return{scrollLeft:t.scrollLeft,firstPosition:r,firstPositionDeltaTop:s}}reduceRestoreState(t){if(typeof t.firstPosition>"u")return this._reduceRestoreStateCompatibility(t);let n=this.model.validatePosition(t.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(n),r=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:r}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,n,i){this._viewportStart.update(this,t)}getActiveIndentGuide(t,n,i){return this._lines.getActiveIndentGuide(t,n,i)}getLinesIndentGuides(t,n){return this._lines.getViewLinesIndentGuides(t,n)}getBracketGuidesInRangeByLine(t,n,i,r){return this._lines.getViewLinesBracketGuides(t,n,i,r)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){let n=ln(this.getLineContent(t));return n===-1?0:n+1}getLineLastNonWhitespaceColumn(t){let n=_r(this.getLineContent(t));return n===-1?0:n+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,n){let r=this._decorations.getDecorationsViewportData(t).inlineDecorations[n-t.startLineNumber];return this._getViewLineRenderingData(n,r)}getViewLineRenderingData(t){let n=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,n)}_getViewLineRenderingData(t,n){let i=this.model.mightContainRTL(),r=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(t);return a.inlineDecorations&&(n=[...n,...a.inlineDecorations.map(l=>l.toInlineDecoration(t))]),new zS(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,i,r,a.tokens,n,s,a.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,n,i){let r=this._lines.getViewLinesData(t,n,i);return new US(this.getTabSize(),r)}getAllOverviewRulerDecorations(t){let n=this.model.getOverviewRulerDecorations(this._editorId,Ac(this._configuration.options)),i=new ok;for(let r of n){let s=r.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(t.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.startLineNumber,r.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.endLineNumber,r.range.endColumn);i.accept(d,s.zIndex,c,u,l)}return i.asArray}_invalidateDecorationsColorCache(){let t=this.model.getOverviewRulerDecorations();for(let n of t)n.options.overviewRuler?.invalidateCachedColor(),n.options.minimap?.invalidateCachedColor()}getValueInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(i,n)}getValueLengthInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(i,n)}modifyPosition(t,n){let i=this.coordinatesConverter.convertViewPositionToModelPosition(t),r=this.model.modifyPosition(i,n);return this.coordinatesConverter.convertModelPositionToViewPosition(r)}deduceModelPositionRelativeToViewPosition(t,n,i){let r=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(n<0?n-=i:n+=i);let a=this.model.getOffsetAt(r)+n;return this.model.getPositionAt(a)}getPlainTextToCopy(t,n,i){let r=i?`\r
`:this.model.getEOL();t=t.slice(0),t.sort(L.compareRangesUsingStarts);let s=!1,a=!1;for(let d of t)d.isEmpty()?s=!0:a=!0;if(!a){if(!n)return"";let d=t.map(u=>u.startLineNumber),c="";for(let u=0;u<d.length;u++)u>0&&d[u-1]===d[u]||(c+=this.model.getLineContent(d[u])+r);return c}if(s&&n){let d=[],c=0;for(let u of t){let h=u.startLineNumber;u.isEmpty()?h!==c&&d.push(this.model.getLineContent(h)):d.push(this.model.getValueInRange(u,i?2:0)),c=h}return d.length===1?d[0]:d}let l=[];for(let d of t)d.isEmpty()||l.push(this.model.getValueInRange(d,i?2:0));return l.length===1?l[0]:l}getRichTextToCopy(t,n){let i=this.model.getLanguageId();if(i===ll||t.length!==1)return null;let r=t[0];if(r.isEmpty()){if(!n)return null;let u=r.startLineNumber;r=new L(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===fi.fontFamily,c;return d?c=fi.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${fi.fontFamily}`),{mode:i,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(r,a)+"</div>"}}_getHTMLToCopy(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn,l=this.getTabSize(),d="";for(let c=i;c<=s;c++){let u=this.model.tokenization.getLineTokens(c),h=u.getLineContent(),m=c===i?r-1:0,g=c===s?a-1:h.length;h===""?d+="<br>":d+=kV(h,u.inflate(),n,m,g,l,ft)}return d}_getColorMap(){let t=ir.getColorMap(),n=["#000000"];if(t)for(let i=1,r=t.length;i<r;i++)n[i]=W.Format.CSS.formatHex(t[i]);return n}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,n,i){return this._withViewEventsCollector(r=>this._cursor.setStates(r,t,n,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,n,i=0){this._withViewEventsCollector(r=>this._cursor.setSelections(r,t,n,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector(n=>this._cursor.restoreState(n,t))}_executeCursorEdit(t){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new NE);return}this._withViewEventsCollector(t)}executeEdits(t,n,i){this._executeCursorEdit(r=>this._cursor.executeEdits(r,t,n,i))}startComposition(){this._executeCursorEdit(t=>this._cursor.startComposition(t))}endComposition(t){this._executeCursorEdit(n=>this._cursor.endComposition(n,t))}type(t,n){this._executeCursorEdit(i=>this._cursor.type(i,t,n))}compositionType(t,n,i,r,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,t,n,i,r,s))}paste(t,n,i,r){this._executeCursorEdit(s=>this._cursor.paste(s,t,n,i,r))}cut(t){this._executeCursorEdit(n=>this._cursor.cut(n,t))}executeCommand(t,n){this._executeCursorEdit(i=>this._cursor.executeCommand(i,t,n))}executeCommands(t,n){this._executeCursorEdit(i=>this._cursor.executeCommands(i,t,n))}revealAllCursors(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealAll(r,t,i,0,n,0))}revealPrimaryCursor(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealPrimary(r,t,i,0,n,0))}revealTopMostCursor(t){let n=this._cursor.getTopMostViewPosition(),i=new L(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new Dl(t,!1,i,null,0,!0,0)))}revealBottomMostCursor(t){let n=this._cursor.getBottomMostViewPosition(),i=new L(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new Dl(t,!1,i,null,0,!0,0)))}revealRange(t,n,i,r,s){this._withViewEventsCollector(a=>a.emitViewEvent(new Dl(t,!1,i,null,r,n,s)))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new HS),this._eventDispatcher.emitOutgoingEvent(new RE))}_withViewEventsCollector(t){return this._transactionalTarget.batchChanges(()=>{try{let n=this._eventDispatcher.beginEmitViewEvents();return t(n)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(t){this._withViewEventsCollector(()=>{t()})}normalizePosition(t,n){return this._lines.normalizePosition(t,n)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}},ik=class o{constructor(e,t,n,i,r){this._model=e;this._viewLineNumber=t;this._isValid=n;this._modelTrackedRange=i;this._startLineDelta=r}static create(e){let t=e._setTrackedRange(null,new L(1,1,1,1),1);return new o(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){let n=e.coordinatesConverter.convertViewPositionToModelPosition(new V(t,e.getLineMinColumn(t))),i=e.model._setTrackedRange(this._modelTrackedRange,new L(n.lineNumber,n.column,n.lineNumber,n.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),s=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=i,this._startLineDelta=s-r}invalidate(){this._isValid=!1}},ok=class{_asMap=Object.create(null);asArray=[];accept(e,t,n,i,r){let s=this._asMap[e];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===r&&d+1>=n){i>d&&(a[a.length-1]=i);return}a.push(r,n,i)}else{let a=new vu(e,t,[r,n,i]);this._asMap[e]=a,this.asArray.push(a)}}},rk=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(e,t){let n=this.hiddenAreas.get(e);n&&AV(n,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let e=Array.from(this.hiddenAreas.values()).reduce((t,n)=>c8(t,n),[]);return AV(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}};function c8(o,e){let t=[],n=0,i=0;for(;n<o.length&&i<e.length;){let r=o[n],s=e[i];if(r.endLineNumber<s.startLineNumber-1)t.push(o[n++]);else if(s.endLineNumber<r.startLineNumber-1)t.push(e[i++]);else{let a=Math.min(r.startLineNumber,s.startLineNumber),l=Math.max(r.endLineNumber,s.endLineNumber);t.push(new L(a,1,l,1)),n++,i++}}for(;n<o.length;)t.push(o[n++]);for(;i<e.length;)t.push(e[i++]);return t}function AV(o,e){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].equalsRange(e[t]))return!1;return!0}var tw=class{constructor(e,t){this.viewportStartModelPosition=e;this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;let n=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),i=t.getVerticalOffsetForLineNumber(n.lineNumber);t.setScrollPosition({scrollTop:i+this.startLineDelta},1)}};var is=class extends B{constructor(t,n,i,r,s,a,l,d,c,u,h,m){super();this.languageConfigurationService=h;s.willCreateCodeEditor();let g={...n};this._domElement=t,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++u8,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?ot.SimpleEditorContext:ot.EditorContext),g,u)),this._register(this._configuration.onDidChange(y=>{this._onDidChangeConfiguration.fire(y);let C=this._configuration.options;if(y.hasChanged(147)){let S=C.get(147);this._onDidLayoutChange.fire(S)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new lk(this,this._contextKeyService)),this._register(new dk(this,this._contextKeyService,m)),this._instantiationService=this._register(r.createChild(new ey([Qt,this._contextKeyService]))),this._modelData=null,this._focusTracker=new ck(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let f;Array.isArray(i.contributions)?f=i.contributions:f=Iu.getEditorContributions(),this._contributions.initialize(this,f,this._instantiationService);for(let y of Iu.getEditorActions()){if(this._actions.has(y.id)){Ne(new Error(`Cannot have two actions with the same id ${y.id}`));continue}let C=new EE(y.id,y.label,y.alias,y.metadata,y.precondition??void 0,S=>this._instantiationService.invokeFunction(w=>Promise.resolve(y.runEditorCommand(w,this,S))),this._contextKeyService);this._actions.set(C.id,C)}let b=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new UC(this._domElement,{onDragOver:y=>{if(!b())return;let C=this.getTargetAtClientPoint(y.clientX,y.clientY);C?.position&&this.showDropIndicatorAt(C.position)},onDrop:async y=>{if(!b()||(this.removeDropIndicator(),!y.dataTransfer))return;let C=this.getTargetAtClientPoint(y.clientX,y.clientY);C?.position&&this._onDropIntoEditor.fire({position:C.position,event:y})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=Gt.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=CN();_contributions=this._register(new xE);_onDidDispose=this._register(new T);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new T({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new li(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new nw({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new nw({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new li(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new li(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new li(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new li(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new li(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new li(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new li(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new li(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new li(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new li(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new li(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new li(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new li(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new li(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new li(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new li(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new li(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new T);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new T);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(t){this._modelData?.view.writeScreenReaderContent(t)}_createConfiguration(t,n,i,r){return new Op(t,n,i,this._domElement,r)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return ZL.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?Qp.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),t):null}getValue(t=null){if(!this._modelData)return"";let n=!!(t&&t.preserveBOM),i=0;return t&&t.lineEnding&&t.lineEnding===`
`?i=1:t&&t.lineEnding&&t.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,n)}setValue(t){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(t)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){try{this._beginUpdate();let n=t;if(this._modelData===null&&n===null||this._modelData&&this._modelData.model===n)return;let i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:n?.uri||null};this._onWillChangeModel.fire(i);let r=this.hasTextFocus(),s=this._detachModel();this._attachModel(n),r&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let t in this._decorationTypeSubtypes){let n=this._decorationTypeSubtypes[t];for(let i in n)this._removeDecorationType(t+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,n,i,r){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,r)}getTopForLineNumber(t,n=!1){return this._modelData?is._getVerticalOffsetForPosition(this._modelData,t,1,n):-1}getTopForPosition(t,n){return this._modelData?is._getVerticalOffsetForPosition(this._modelData,t,n,!1):-1}static _getVerticalOffsetForPosition(t,n,i,r=!1){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,r)}getBottomForLineNumber(t,n=!1){if(!this._modelData)return-1;let i=this._modelData.model.getLineMaxColumn(t);return is._getVerticalOffsetAfterPosition(this._modelData,t,i,n)}setHiddenAreas(t,n){this._modelData?.viewModel.setHiddenAreas(t.map(i=>L.lift(i)),n)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Rt.visibleColumnFromColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)+1}getStatusbarColumn(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Rt.toStatusbarColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,n="api"){if(this._modelData){if(!V.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,n,i,r){if(!this._modelData)return;if(!L.isIRange(t))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(t),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,a,n,r)}revealLine(t,n=0){this._revealLine(t,0,n)}revealLineInCenter(t,n=0){this._revealLine(t,1,n)}revealLineInCenterIfOutsideViewport(t,n=0){this._revealLine(t,2,n)}revealLineNearTop(t,n=0){this._revealLine(t,5,n)}_revealLine(t,n,i){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new L(t,1,t,1),n,!1,i)}revealPosition(t,n=0){this._revealPosition(t,0,!0,n)}revealPositionInCenter(t,n=0){this._revealPosition(t,1,!0,n)}revealPositionInCenterIfOutsideViewport(t,n=0){this._revealPosition(t,2,!0,n)}revealPositionNearTop(t,n=0){this._revealPosition(t,5,!0,n)}_revealPosition(t,n,i,r){if(!V.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new L(t.lineNumber,t.column,t.lineNumber,t.column),n,i,r)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,n="api"){let i=Ue.isISelection(t),r=L.isIRange(t);if(!i&&!r)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(t,n);else if(r){let s={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(s,n)}}_setSelectionImpl(t,n){if(!this._modelData)return;let i=new Ue(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(n,[i])}revealLines(t,n,i=0){this._revealLines(t,n,0,i)}revealLinesInCenter(t,n,i=0){this._revealLines(t,n,1,i)}revealLinesInCenterIfOutsideViewport(t,n,i=0){this._revealLines(t,n,2,i)}revealLinesNearTop(t,n,i=0){this._revealLines(t,n,5,i)}_revealLines(t,n,i,r){if(typeof t!="number"||typeof n!="number")throw new Error("Invalid arguments");this._sendRevealRange(new L(t,1,n,1),i,!1,r)}revealRange(t,n=0,i=!1,r=!0){this._revealRange(t,i?1:0,r,n)}revealRangeInCenter(t,n=0){this._revealRange(t,1,!0,n)}revealRangeInCenterIfOutsideViewport(t,n=0){this._revealRange(t,2,!0,n)}revealRangeNearTop(t,n=0){this._revealRange(t,5,!0,n)}revealRangeNearTopIfOutsideViewport(t,n=0){this._revealRange(t,6,!0,n)}revealRangeAtTop(t,n=0){this._revealRange(t,3,!0,n)}_revealRange(t,n,i,r){if(!L.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(L.lift(t),n,i,r)}setSelections(t,n="api",i=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let r=0,s=t.length;r<s;r++)if(!Ue.isISelection(t[r]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,t,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},n)}}setScrollTop(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},n)}}setScrollPosition(t,n=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,n)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let t=this._contributions.saveViewState(),n=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:n,viewState:i,contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;let n=t;if(n&&n.cursorState&&n.viewState){let i=n.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(n.contributionsState||{});let r=this._modelData.viewModel.reduceRestoreState(n.viewState);this._modelData.view.restoreState(r)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter(n=>n.isSupported()),t}getAction(t){return this._actions.get(t)||null}trigger(t,n,i){i=i||{};try{switch(this._beginUpdate(),n){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(t);return;case"type":{let s=i;this._type(t,s.text||"");return}case"replacePreviousChar":{let s=i;this._compositionType(t,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=i;this._compositionType(t,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=i;this._paste(t,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(t);return}let r=this.getAction(n);if(r){Promise.resolve(r.run(i)).then(void 0,Ne);return}if(!this._modelData||this._triggerEditorCommand(t,n,i))return;this._triggerCommand(n,i)}finally{this._endUpdate()}}_triggerCommand(t,n){this._commandService.executeCommand(t,n)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,n){!this._modelData||n.length===0||(t==="keyboard"&&this._onWillType.fire(n),this._modelData.viewModel.type(n,t),t==="keyboard"&&this._onDidType.fire(n))}_compositionType(t,n,i,r,s){this._modelData&&this._modelData.viewModel.compositionType(n,i,r,s,t)}_paste(t,n,i,r,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(n,i,r,t);let c=l.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new L(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,n,i){let r=Iu.getEditorCommand(n);return r?(i=i||{},i.source=t,this._instantiationService.invokeFunction(s=>{Promise.resolve(r.runEditorCommand(s,this,i)).then(void 0,Ne)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(t,n,i){if(!this._modelData||this._configuration.options.get(93))return!1;let r;return i?Array.isArray(i)?r=()=>i:r=i:r=()=>null,this._modelData.viewModel.executeEdits(t,n,r),!0}executeCommand(t,n){this._modelData&&this._modelData.viewModel.executeCommand(n,t)}executeCommands(t,n){this._modelData&&this._modelData.viewModel.executeCommands(n,t)}createDecorationsCollection(t){return new uk(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,Ac(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,Ac(this._configuration.options)):null}deltaDecorations(t,n){return this._modelData?t.length===0&&n.length===0?t:this._modelData.model.deltaDecorations(t,n,this._id):[]}removeDecorations(t){!this._modelData||t.length===0||this._modelData.model.changeDecorations(n=>{n.deltaDecorations(t,[])})}setDecorationsByType(t,n,i){let r={},s=this._decorationTypeSubtypes[n]||{};this._decorationTypeSubtypes[n]=r;let a=[];for(let d of i){let c=n;if(d.renderOptions){let h=Oo(d.renderOptions).toString(16);c=n+"-"+h,!s[h]&&!r[h]&&this._registerDecorationType(t,c,d.renderOptions,n),r[h]=!0}let u=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(u.hoverMessage=d.hoverMessage),a.push({range:d.range,options:u})}for(let d in s)r[d]||this._removeDecorationType(n+"-"+d);let l=this._decorationTypeKeysToIds[n]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[n]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(t,n){let i=this._decorationTypeSubtypes[t]||{};for(let l in i)this._removeDecorationType(t+"-"+l);this._decorationTypeSubtypes[t]={};let r=Gt.createDynamic(this._resolveDecorationOptions(t,!1)),s=new Array(n.length);for(let l=0,d=n.length;l<d;l++)s[l]={range:n[l],options:r};let a=this._decorationTypeKeysToIds[t]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[t]=l.deltaDecorations(a,s))}removeDecorationsByType(t){let n=this._decorationTypeKeysToIds[t];n&&this.changeDecorations(i=>i.deltaDecorations(n,[])),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(t)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,n=!1){this._configuration.observeContainer(t),n||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){let n={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(n)}layoutContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];delete this._contentWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(t){let n={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(n)}layoutOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];delete this._overlayWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(t){let n={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(n)}layoutGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];delete this._glyphMarginWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(t)}getTargetAtClientPoint(t,n){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(t,n)}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;let n=this._modelData.model.validatePosition(t),i=this._configuration.options,r=i.get(147),s=is._getVerticalOffsetForPosition(this._modelData,n.lineNumber,n.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(n.lineNumber,n.column)+r.glyphMarginWidth+r.lineNumbersWidth+r.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:i.get(68)}}getOffsetForColumn(t,n){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(t,n)}render(t=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,t)})}setAriaOptions(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(t)}applyFontInfo(t){Cn(t,this._configuration.options.get(51))}setBanner(t,n){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=t,this._configuration.setReservedHeight(t?n:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t){this._modelData=null;return}let n=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());let i=t.onBeforeAttached(),r=new ew(this._id,this._configuration,t,SE.create(Ce(this._domElement)),wE.create(this._configuration.options),l=>Ii(Ce(this._domElement),l),this.languageConfigurationService,this._themeService,i,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});n.push(t.onWillDispose(()=>this.setModel(null))),n.push(r.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let h=this.getOption(81),m=p("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",h);this._notificationService.prompt(EC.Warning,m,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:p("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let h=0,m=l.selections.length;h<m;h++)d[h]=l.selections[h].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let u={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(r);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addContentWidget(this._contentWidgets[u])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addOverlayWidget(this._overlayWidgets[u])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[u])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new ak(t,r,s,a,n,i)}_createView(t){let n;this.isSimpleWidget?n={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:n={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let i=new rm(t.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new ym(n,this._configuration,this._themeService.getColorTheme(),t,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let t=this._modelData.model,n=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),n&&this._domElement.contains(n)&&n.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),t}_registerDecorationType(t,n,i,r){this._codeEditorService.registerDecorationType(t,n,i,r,this)}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}_resolveDecorationOptions(t,n){return this._codeEditorService.resolveDecorationOptions(t,n)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){let n=[{range:new L(t.lineNumber,t.column,t.lineNumber,t.column),options:is.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(n),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,n){this._contextKeyService.createKey(t,n)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};is=k([E(3,nt),E(4,yo),E(5,Lo),E(6,Qt),E(7,xs),E(8,eo),E(9,Jo),E(10,Rr),E(11,Al)],is);var u8=0,ak=class{constructor(e,t,n,i,r,s){this.model=e;this.viewModel=t;this.view=n;this.hasRealView=i;this.listenersToRemove=r;this.attachedView=s}dispose(){Nt(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var nw=class extends B{constructor(t){super();this._emitterOptions=t;this._value=0}_onDidChangeToTrue=this._register(new T(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new T(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(t){let n=t?2:1;this._value!==n&&(this._value=n,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},li=class extends T{constructor(t,n){super({deliveryQueue:n});this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}},lk=class extends B{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=ae.editorSimpleInput.bindTo(t),this._editorFocus=ae.focus.bindTo(t),this._textInputFocus=ae.textInputFocus.bindTo(t),this._editorTextFocus=ae.editorTextFocus.bindTo(t),this._tabMovesFocus=ae.tabMovesFocus.bindTo(t),this._editorReadonly=ae.readOnly.bindTo(t),this._inDiffEditor=ae.inDiffEditor.bindTo(t),this._editorColumnSelection=ae.columnSelection.bindTo(t),this._hasMultipleSelections=ae.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=ae.hasNonEmptySelection.bindTo(t),this._canUndo=ae.canUndo.bindTo(t),this._canRedo=ae.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(Ap.onDidChangeTabFocus(n=>this._tabMovesFocus.set(n))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let e=this._editor.getOptions();this._tabMovesFocus.set(Ap.getTabFocusMode()),this._editorReadonly.set(e.get(93)),this._inDiffEditor.set(e.get(62)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){let e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}},dk=class extends B{constructor(t,n,i){super();this._editor=t;this._contextKeyService=n;this._languageFeaturesService=i;this._langId=ae.languageId.bindTo(n),this._hasCompletionItemProvider=ae.hasCompletionItemProvider.bindTo(n),this._hasCodeActionsProvider=ae.hasCodeActionsProvider.bindTo(n),this._hasCodeLensProvider=ae.hasCodeLensProvider.bindTo(n),this._hasDefinitionProvider=ae.hasDefinitionProvider.bindTo(n),this._hasDeclarationProvider=ae.hasDeclarationProvider.bindTo(n),this._hasImplementationProvider=ae.hasImplementationProvider.bindTo(n),this._hasTypeDefinitionProvider=ae.hasTypeDefinitionProvider.bindTo(n),this._hasHoverProvider=ae.hasHoverProvider.bindTo(n),this._hasDocumentHighlightProvider=ae.hasDocumentHighlightProvider.bindTo(n),this._hasDocumentSymbolProvider=ae.hasDocumentSymbolProvider.bindTo(n),this._hasReferenceProvider=ae.hasReferenceProvider.bindTo(n),this._hasRenameProvider=ae.hasRenameProvider.bindTo(n),this._hasSignatureHelpProvider=ae.hasSignatureHelpProvider.bindTo(n),this._hasInlayHintsProvider=ae.hasInlayHintsProvider.bindTo(n),this._hasDocumentFormattingProvider=ae.hasDocumentFormattingProvider.bindTo(n),this._hasDocumentSelectionFormattingProvider=ae.hasDocumentSelectionFormattingProvider.bindTo(n),this._hasMultipleDocumentFormattingProvider=ae.hasMultipleDocumentFormattingProvider.bindTo(n),this._hasMultipleDocumentSelectionFormattingProvider=ae.hasMultipleDocumentSelectionFormattingProvider.bindTo(n),this._isInEmbeddedEditor=ae.isInEmbeddedEditor.bindTo(n);let r=()=>this._update();this._register(t.onDidChangeModel(r)),this._register(t.onDidChangeModelLanguage(r)),this._register(i.completionProvider.onDidChange(r)),this._register(i.codeActionProvider.onDidChange(r)),this._register(i.codeLensProvider.onDidChange(r)),this._register(i.definitionProvider.onDidChange(r)),this._register(i.declarationProvider.onDidChange(r)),this._register(i.implementationProvider.onDidChange(r)),this._register(i.typeDefinitionProvider.onDidChange(r)),this._register(i.hoverProvider.onDidChange(r)),this._register(i.documentHighlightProvider.onDidChange(r)),this._register(i.documentSymbolProvider.onDidChange(r)),this._register(i.referenceProvider.onDidChange(r)),this._register(i.renameProvider.onDidChange(r)),this._register(i.documentFormattingEditProvider.onDidChange(r)),this._register(i.documentRangeFormattingEditProvider.onDidChange(r)),this._register(i.signatureHelpProvider.onDidChange(r)),this._register(i.inlayHintsProvider.onDidChange(r)),r()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let t=this._editor.getModel();if(!t){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===Ae.walkThroughSnippet||t.uri.scheme===Ae.vscodeChatCodeBlock)})}},ck=class extends B{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new T);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(e,t){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(El(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(El(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},uk=class{constructor(e,t){this._editor=e;Array.isArray(t)&&t.length>0&&this.set(t)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(e,t,n){return this._editor.onDidChangeModelDecorations(i=>{this._isChangingDecorations||e.call(t,i)},n)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];let e=this._editor.getModel(),t=[];for(let n of this._decorationIds){let i=e.getDecorationRange(n);i&&t.push(i)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(n=>{t=n.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}},h8=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),p8=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function sk(o){return h8+encodeURIComponent(o.toString())+p8}var m8=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),g8=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function f8(o){return m8+encodeURIComponent(o.toString())+g8}mo((o,e)=>{let t=o.getColor(zc);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${sk(t)}") repeat-x bottom left; }`);let n=o.getColor(fo);n&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${sk(n)}") repeat-x bottom left; }`);let i=o.getColor(sr);i&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${sk(i)}") repeat-x bottom left; }`);let r=o.getColor(BO);r&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${f8(r)}") no-repeat bottom left; }`);let s=o.getColor(bF);s&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});function OV(o,e){Object.entries(e).forEach(([t,n])=>{o.style.setProperty(t,b8(n))})}function b8(o){return typeof o=="number"?`${o}px`:o}function Cm(o,e){let t=new oe,n=[];return t.add(od({debugName:()=>`Apply decorations from ${e.debugName}`},i=>{let r=e.read(i);o.changeDecorations(s=>{n=s.deltaDecorations(n,r)})})),t.add({dispose:()=>{o.changeDecorations(i=>{n=i.deltaDecorations(n,[])})}}),t}function*PV(o,e,t){let n=new Li(e);for(let i of o){n.takeWhile(s=>xo.isGreaterThan(t(i,s)));let r=n.takeWhile(s=>xo.isNeitherLessOrGreaterThan(t(i,s)));yield{left:i,rights:r||[]}}}function*iw(o,e,t){let n=new Li(e);for(let i of o){let r=n.takeWhile(a=>xo.isGreaterThan(t(i,a)));r&&(yield{rights:r});let s=n.takeWhile(a=>xo.isNeitherLessOrGreaterThan(t(i,a)));yield{left:i,rights:s||[]}}}function ow(...o){return[].concat(...o)}function FV(o,e){let t=!1;return o.then(()=>{t||e()}),pe(()=>{t=!0})}function rw(o,e){return Object.assign(o,e)}function hk(o,e){let t={};for(let n in o)t[n]=o[n];for(let n in e){let i=e[n];typeof t[n]=="object"&&i&&typeof i=="object"?t[n]=hk(t[n],i):t[n]=i}return t}var Im=class{constructor(e,t){this.key=e;this.storageService=t}hasValue=!1;value=void 0;get(){if(!this.hasValue){let e=this.storageService.get(this.key,0);if(e!==void 0)try{this.value=JSON.parse(e)}catch(t){Ne(t)}this.hasValue=!0}return this.value}set(e){this.value=e,this.storageService.store(this.key,JSON.stringify(this.value),0,0)}};Im=k([E(1,In)],Im);var Va=class{constructor(e,t){this.range=e;this.newLines=t}equals(e){return this.range.equals(e.range)&&Lt(this.newLines,e.newLines)}toEdits(e){return new pk([this]).toEdits(e)}},sw=class{constructor(e,t){this.range=e;this.newText=t}equals(e){return L.equalsRange(this.range,e.range)&&this.newText===e.newText}},pk=class{constructor(e){this.edits=e}toEdits(e){return this.edits.map(t=>t.range.endLineNumberExclusive<=e?{range:new L(t.range.startLineNumber,1,t.range.endLineNumberExclusive,1),text:t.newLines.map(n=>n+`
`).join("")}:t.range.startLineNumber===1?{range:new L(1,1,e,Number.MAX_SAFE_INTEGER),text:t.newLines.join(`
`)}:{range:new L(t.range.startLineNumber-1,Number.MAX_SAFE_INTEGER,e,Number.MAX_SAFE_INTEGER),text:t.newLines.map(n=>`
`+n).join("")})}};function BV(o,e){return!(e.lineNumber<o.startLineNumber||e.lineNumber>o.endLineNumber||e.lineNumber===o.startLineNumber&&e.column<o.startColumn||e.lineNumber===o.endLineNumber&&e.column>=o.endColumn)}function Xb(o){return o.startLineNumber===o.endLineNumber?new Dr(0,o.endColumn-o.startColumn):new Dr(o.endLineNumber-o.startLineNumber,o.endColumn-1)}function aw(o,e){return o.lineNumber===e.lineNumber?new Dr(0,e.column-o.column):new Dr(e.lineNumber-o.lineNumber,e.column-1)}function Qb(o,e){return e.lineCount===0?new V(o.lineNumber,o.column+e.columnCount):new V(o.lineNumber+e.lineCount,e.columnCount+1)}function mk(o,e){return o.endLineNumber<e.startLineNumber||o.endLineNumber===e.startLineNumber&&o.endColumn<=e.startColumn}var Wr=class o{constructor(e,t){this.inputRange=e;this.outputRange=t}static join(e){return e.reduce((t,n)=>t?t.join(n):n,void 0)}extendInputRange(e){if(!e.containsRange(this.inputRange))throw new Te;let t=e.startLineNumber-this.inputRange.startLineNumber,n=e.endLineNumberExclusive-this.inputRange.endLineNumberExclusive;return new o(e,new en(this.outputRange.startLineNumber+t,this.outputRange.lineCount-t+n))}join(e){return new o(this.inputRange.join(e.inputRange),this.outputRange.join(e.outputRange))}get resultingDeltaFromOriginalToModified(){return this.outputRange.endLineNumberExclusive-this.inputRange.endLineNumberExclusive}toString(){return`${this.inputRange.toString()} -> ${this.outputRange.toString()}`}addOutputLineDelta(e){return new o(this.inputRange,this.outputRange.delta(e))}addInputLineDelta(e){return new o(this.inputRange.delta(e),this.outputRange)}reverse(){return new o(this.outputRange,this.inputRange)}},os=class o{constructor(e,t){this.lineRangeMappings=e;this.inputLineCount=t;pi(()=>us(e,(n,i)=>n.inputRange.isBefore(i.inputRange)&&n.outputRange.isBefore(i.outputRange)&&i.inputRange.startLineNumber-n.inputRange.endLineNumberExclusive===i.outputRange.startLineNumber-n.outputRange.endLineNumberExclusive))}static betweenOutputs(e,t,n){let r=Jb.compute(e,t).map(s=>new Wr(s.output1Range,s.output2Range));return new o(r,n)}project(e){let t=Yl(this.lineRangeMappings,r=>r.inputRange.startLineNumber<=e);if(!t)return new Wr(new en(e,1),new en(e,1));if(t.inputRange.contains(e))return t;let n=new en(e,1),i=new en(e+t.outputRange.endLineNumberExclusive-t.inputRange.endLineNumberExclusive,1);return new Wr(n,i)}get outputLineCount(){let e=this.lineRangeMappings.at(-1),t=e?e.outputRange.endLineNumberExclusive-e.inputRange.endLineNumberExclusive:0;return this.inputLineCount+t}reverse(){return new o(this.lineRangeMappings.map(e=>e.reverse()),this.outputLineCount)}},Jb=class o{constructor(e,t,n,i,r){this.inputRange=e;this.output1Range=t;this.output1LineMappings=n;this.output2Range=i;this.output2LineMappings=r}static compute(e,t){let n=ui(c=>c.inputRange.startLineNumber,Ya),i=ow(e.map(c=>({source:0,diff:c})),t.map(c=>({source:1,diff:c}))).sort(ui(c=>c.diff,n)),r=[new Array,new Array],s=[0,0],a=new Array;function l(c){let u=Wr.join(r[0])||new Wr(c,c.delta(s[0])),h=Wr.join(r[1])||new Wr(c,c.delta(s[1]));a.push(new o(d,u.extendInputRange(d).outputRange,r[0],h.extendInputRange(d).outputRange,r[1])),r[0]=[],r[1]=[]}let d;for(let c of i){let u=c.diff.inputRange;d&&!d.touches(u)&&(l(d),d=void 0),s[c.source]=c.diff.resultingDeltaFromOriginalToModified,d=d?d.join(u):u,r[c.source].push(c.diff)}return d&&l(d),a}toString(){return`${this.output1Range} <- ${this.inputRange} -> ${this.output2Range}`}},Ol=class o extends Wr{constructor(t,n,i,r,s){super(t,i);this.inputTextModel=n;this.outputTextModel=r;this.rangeMappings=s||[new Ws(this.inputRange.toRange(),this.outputRange.toRange())]}static join(t){return t.reduce((n,i)=>n?n.join(i):i,void 0)}rangeMappings;addOutputLineDelta(t){return new o(this.inputRange,this.inputTextModel,this.outputRange.delta(t),this.outputTextModel,this.rangeMappings.map(n=>n.addOutputLineDelta(t)))}addInputLineDelta(t){return new o(this.inputRange.delta(t),this.inputTextModel,this.outputRange,this.outputTextModel,this.rangeMappings.map(n=>n.addInputLineDelta(t)))}join(t){return new o(this.inputRange.join(t.inputRange),this.inputTextModel,this.outputRange.join(t.outputRange),this.outputTextModel)}getLineEdit(){return new Va(this.inputRange,this.getOutputLines())}getReverseLineEdit(){return new Va(this.outputRange,this.getInputLines())}getOutputLines(){return this.outputRange.getLines(this.outputTextModel)}getInputLines(){return this.inputRange.getLines(this.inputTextModel)}},Ws=class o{constructor(e,t){this.inputRange=e;this.outputRange=t}toString(){function e(t){return`[${t.startLineNumber}:${t.startColumn}, ${t.endLineNumber}:${t.endColumn})`}return`${e(this.inputRange)} -> ${e(this.outputRange)}`}addOutputLineDelta(e){return new o(this.inputRange,new L(this.outputRange.startLineNumber+e,this.outputRange.startColumn,this.outputRange.endLineNumber+e,this.outputRange.endColumn))}addInputLineDelta(e){return new o(new L(this.inputRange.startLineNumber+e,this.inputRange.startColumn,this.inputRange.endLineNumber+e,this.inputRange.endColumn),this.outputRange)}reverse(){return new o(this.outputRange,this.inputRange)}},Pu=class o{constructor(e,t){this.rangeMappings=e;this.inputLineCount=t;pi(()=>us(e,(n,i)=>mk(n.inputRange,i.inputRange)&&mk(n.outputRange,i.outputRange)))}project(e){let t=Yl(this.rangeMappings,r=>r.inputRange.getStartPosition().isBeforeOrEqual(e));if(!t)return new Ws(L.fromPositions(e,e),L.fromPositions(e,e));if(BV(t.inputRange,e))return t;let n=aw(t.inputRange.getEndPosition(),e),i=Qb(t.outputRange.getEndPosition(),n);return new Ws(L.fromPositions(e),L.fromPositions(i))}projectRange(e){let t=this.project(e.getStartPosition()),n=this.project(e.getEndPosition());return new Ws(t.inputRange.plusRange(n.inputRange),t.outputRange.plusRange(n.outputRange))}get outputLineCount(){let e=this.rangeMappings.at(-1),t=e?e.outputRange.endLineNumber-e.inputRange.endLineNumber:0;return this.inputLineCount+t}reverse(){return new o(this.rangeMappings.map(e=>e.reverse()),this.outputLineCount)}};function Wa(o,e,t){return cN({debugName:()=>`Configuration Key "${o}"`},n=>t.onDidChangeConfiguration(i=>{i.affectsConfiguration(o)&&n(i)}),()=>t.getValue(o)??e)}var Fu=class{constructor(e,t){this.editorWorkerService=e;this.configurationService=t}mergeAlgorithm=Wa("mergeEditor.diffAlgorithm","advanced",this.configurationService).map(e=>e==="smart"?"legacy":e==="experimental"?"advanced":e);async computeDiff(e,t,n){let i=this.mergeAlgorithm.read(n),r=e.getVersionId(),s=t.getVersionId(),a=await this.editorWorkerService.computeDiff(e.uri,t.uri,{ignoreTrimWhitespace:!1,maxComputationTimeMs:0,computeMoves:!1},i);if(!a)throw new Error("Diff computation failed");if(e.isDisposed()||t.isDisposed())return{diffs:null};let l=a.changes.map(u=>new Ol(VV(u.original),e,VV(u.modified),t,u.innerChanges?.map(h=>v8(h)))),d=e.getVersionId(),c=t.getVersionId();return r!==d||s!==c?{diffs:null}:(pi(()=>{for(let u of l){let h=u.inputRange,m=u.outputRange,g=u.inputTextModel,f=u.outputTextModel;for(let b of u.rangeMappings){let y=h.startLineNumber-1<=b.inputRange.startLineNumber&&b.inputRange.endLineNumber<=h.endLineNumberExclusive;y&&b.inputRange.startLineNumber===h.startLineNumber-1&&(y=b.inputRange.endColumn>=g.getLineMaxColumn(b.inputRange.startLineNumber)),y&&b.inputRange.endLineNumber===h.endLineNumberExclusive&&(y=b.inputRange.endColumn===1);let C=m.startLineNumber-1<=b.outputRange.startLineNumber&&b.outputRange.endLineNumber<=m.endLineNumberExclusive;if(C&&b.outputRange.startLineNumber===m.startLineNumber-1&&(C=b.outputRange.endColumn>=f.getLineMaxColumn(b.outputRange.endLineNumber)),C&&b.outputRange.endLineNumber===m.endLineNumberExclusive&&(C=b.outputRange.endColumn===1),!y||!C)return!1}}return l.length===0||l[0].inputRange.startLineNumber===l[0].outputRange.startLineNumber&&us(l,(u,h)=>h.inputRange.startLineNumber-u.inputRange.endLineNumberExclusive===h.outputRange.startLineNumber-u.outputRange.endLineNumberExclusive&&u.inputRange.endLineNumberExclusive<h.inputRange.startLineNumber&&u.outputRange.endLineNumberExclusive<h.outputRange.startLineNumber)}),{diffs:l})}};Fu=k([E(0,rV),E(1,rt)],Fu);function VV(o){return new en(o.startLineNumber,o.length)}function v8(o){return new Ws(o.originalRange,o.modifiedRange)}var Sm=class{_isOccupied=!1;runExclusivelyOrSkip(e){if(!this._isOccupied){this._isOccupied=!0;try{e()}finally{this._isOccupied=!1}}}runExclusivelyOrThrow(e){if(this._isOccupied)throw new Te("ReentrancyBarrier: reentrant call detected!");this._isOccupied=!0;try{e()}finally{this._isOccupied=!1}}get isOccupied(){return this._isOccupied}makeExclusiveOrSkip(e){return(...t)=>{if(!this._isOccupied){this._isOccupied=!0;try{return e(...t)}finally{this._isOccupied=!1}}}}};var xm=class extends B{constructor(t,n,i){super();this.baseTextModel=t;this.textModel=n;this.diffComputer=i;let r=rh("recompute");this._register(Wt(s=>{r.read(s),this._recompute(s)})),this._register(t.onDidChangeContent(this._barrier.makeExclusiveOrSkip(()=>{r.trigger(void 0)}))),this._register(n.onDidChangeContent(this._barrier.makeExclusiveOrSkip(()=>{r.trigger(void 0)}))),this._register(pe(()=>{this._isDisposed=!0}))}_recomputeCount=0;_state=fn(this,1);_diffs=fn(this,[]);_barrier=new Sm;_isDisposed=!1;get isApplyingChange(){return this._barrier.isOccupied}get state(){return this._state}get diffs(){return this._diffs}_isInitializing=!0;_recompute(t){this._recomputeCount++;let n=this._recomputeCount;this._state.get()===1&&(this._isInitializing=!0),et(r=>{this._state.set(this._isInitializing?1:3,r,0)}),this.diffComputer.computeDiff(this.baseTextModel,this.textModel,t).then(r=>{this._isDisposed||n===this._recomputeCount&&et(s=>{r.diffs?(this._state.set(2,s,1),this._diffs.set(r.diffs,s,1)):this._state.set(4,s,1),this._isInitializing=!1})})}ensureUpToDate(){if(this.state.get()!==2)throw new Te("Cannot remove diffs when the model is not up to date")}removeDiffs(t,n,i){this.ensureUpToDate(),t.sort(ui(s=>s.inputRange.startLineNumber,Ya)),t.reverse();let r=this._diffs.get();for(let s of t){let a=r.length;if(r=r.filter(l=>l!==s),a===r.length)throw new Te;this._barrier.runExclusivelyOrThrow(()=>{let l=s.getReverseLineEdit().toEdits(this.textModel.getLineCount());this.textModel.pushEditOperations(null,l,()=>null,i)}),r=r.map(l=>l.outputRange.isAfter(s.outputRange)?l.addOutputLineDelta(s.inputRange.lineCount-s.outputRange.lineCount):l)}this._diffs.set(r,n,0)}applyEditRelativeToOriginal(t,n,i){this.ensureUpToDate();let r=new Ol(t.range,this.baseTextModel,new en(t.range.startLineNumber,t.newLines.length),this.textModel),s=!1,a=0,l=new Array;for(let d of this.diffs.get()){if(d.inputRange.touches(t.range))throw new Te("Edit must be conflict free.");d.inputRange.isAfter(t.range)?(s||(s=!0,l.push(r.addOutputLineDelta(a))),l.push(d.addOutputLineDelta(t.newLines.length-t.range.lineCount))):l.push(d),s||(a+=d.outputRange.lineCount-d.inputRange.lineCount)}s||(s=!0,l.push(r.addOutputLineDelta(a))),this._barrier.runExclusivelyOrThrow(()=>{let d=new Va(t.range.delta(a),t.newLines).toEdits(this.textModel.getLineCount());this.textModel.pushEditOperations(null,d,()=>null,i)}),this._diffs.set(l,n,0)}findTouchingDiffs(t){return this.diffs.get().filter(n=>n.inputRange.touches(t))}getResultLine(t,n){let i=0,r=n?this.diffs.read(n):this.diffs.get();for(let s of r){if(s.inputRange.contains(t)||s.inputRange.endLineNumberExclusive===t)return s;if(s.inputRange.endLineNumberExclusive<t)i=s.resultingDeltaFromOriginalToModified;else break}return t+i}getResultLineRange(t,n){let i=this.getResultLine(t.startLineNumber,n);typeof i!="number"&&(i=i.outputRange.startLineNumber);let r=this.getResultLine(t.endLineNumberExclusive,n);return typeof r!="number"&&(r=r.outputRange.endLineNumberExclusive),en.fromLineNumbers(i,r)}};var lw=class o{constructor(e,t,n,i,r,s,a,l){this.baseRange=e;this.baseTextModel=t;this.input1Range=n;this.input1TextModel=i;this.input1Diffs=r;this.input2Range=s;this.input2TextModel=a;this.input2Diffs=l;if(this.input1Diffs.length===0&&this.input2Diffs.length===0)throw new Te("must have at least one diff")}static fromDiffs(e,t,n,i,r){return Jb.compute(e,t).map(a=>new o(a.inputRange,n,a.output1Range,i,a.output1LineMappings,a.output2Range,r,a.output2LineMappings))}input1CombinedDiff=Ol.join(this.input1Diffs);input2CombinedDiff=Ol.join(this.input2Diffs);isEqualChange=Lt(this.input1Diffs,this.input2Diffs,(e,t)=>e.getLineEdit().equals(t.getLineEdit()));getInputRange(e){return e===1?this.input1Range:this.input2Range}getInputCombinedDiff(e){return e===1?this.input1CombinedDiff:this.input2CombinedDiff}getInputDiffs(e){return e===1?this.input1Diffs:this.input2Diffs}get isConflicting(){return this.input1Diffs.length>0&&this.input2Diffs.length>0}get canBeCombined(){return this.smartCombineInputs(1)!==void 0}get isOrderRelevant(){let e=this.smartCombineInputs(1),t=this.smartCombineInputs(2);return!e||!t?!1:!e.equals(t)}getEditForBase(e){let t=[];if(e.includesInput1&&this.input1CombinedDiff&&t.push({diff:this.input1CombinedDiff,inputNumber:1}),e.includesInput2&&this.input2CombinedDiff&&t.push({diff:this.input2CombinedDiff,inputNumber:2}),t.length===0)return{edit:void 0,effectiveState:Un.base};if(t.length===1)return{edit:t[0].diff.getLineEdit(),effectiveState:Un.base.withInputValue(t[0].inputNumber,!0,!1)};if(e.kind!==3)throw new Te;let n=e.smartCombination?this.smartCombineInputs(e.firstInput):this.dumbCombineInputs(e.firstInput);return n?{edit:n,effectiveState:e}:{edit:t[gk(e.firstInput)-1].diff.getLineEdit(),effectiveState:Un.base.withInputValue(gk(e.firstInput),!0,!1)}}smartInput1LineRangeEdit=null;smartInput2LineRangeEdit=null;smartCombineInputs(e){if(e===1&&this.smartInput1LineRangeEdit!==null)return this.smartInput1LineRangeEdit;if(e===2&&this.smartInput2LineRangeEdit!==null)return this.smartInput2LineRangeEdit;let n=ow(this.input1Diffs.flatMap(r=>r.rangeMappings.map(s=>({diff:s,input:1}))),this.input2Diffs.flatMap(r=>r.rangeMappings.map(s=>({diff:s,input:2})))).sort(NM(ui(r=>r.diff.inputRange,L.compareRangesUsingStarts),ui(r=>r.input===e?1:2,Ya))).map(r=>{let s=r.input===1?this.input1TextModel:this.input2TextModel;return new sw(r.diff.inputRange,s.getValueInRange(r.diff.outputRange))}),i=y8(this.baseRange,n,this.baseTextModel);return e===1?this.smartInput1LineRangeEdit=i:this.smartInput2LineRangeEdit=i,i}dumbInput1LineRangeEdit=null;dumbInput2LineRangeEdit=null;dumbCombineInputs(e){if(e===1&&this.dumbInput1LineRangeEdit!==null)return this.dumbInput1LineRangeEdit;if(e===2&&this.dumbInput2LineRangeEdit!==null)return this.dumbInput2LineRangeEdit;let t=this.input1Range.getLines(this.input1TextModel),n=this.input2Range.getLines(this.input2TextModel);e===2&&([t,n]=[n,t]);let i=new Va(this.baseRange,t.concat(n));return e===1?this.dumbInput1LineRangeEdit=i:this.dumbInput2LineRangeEdit=i,i}};function y8(o,e,t){let n="",i=o.startLineNumber>1,r=i?new V(o.startLineNumber-1,t.getLineMaxColumn(o.startLineNumber-1)):new V(o.startLineNumber,1);for(let c of e){let u=c.range.getStartPosition();if(!r.isBeforeOrEqual(u))return;let h=t.getValueInRange(L.fromPositions(r,u));u.lineNumber>t.getLineCount()&&(h+=`
`),n+=h,n+=c.newText,r=c.range.getEndPosition()}let s=o.endLineNumberExclusive<=t.getLineCount(),a=s?new V(o.endLineNumberExclusive,1):new V(o.endLineNumberExclusive-1,1073741824),l=t.getValueInRange(L.fromPositions(r,a));n+=l;let d=Sc(n);if(i){if(d[0]!=="")return;d.shift()}if(s){if(d[d.length-1]!=="")return;d.pop()}return new Va(o,d)}function gk(o){return o===1?2:1}var Bu=class{constructor(){}get includesInput1(){return!1}get includesInput2(){return!1}includesInput(e){return e===1?this.includesInput1:this.includesInput2}isInputIncluded(e){return e===1?this.includesInput1:this.includesInput2}toggle(e){return this.withInputValue(e,!this.includesInput(e),!0)}getInput(e){return this.isInputIncluded(e)?1:0}},ev=class extends Bu{get kind(){return 0}toString(){return"base"}swap(){return this}withInputValue(e,t,n=!1){return e===1?t?new Em:this:t?new Vu:this}equals(e){return e.kind===0}},Em=class extends Bu{get kind(){return 1}get includesInput1(){return!0}toString(){return"1\u2713"}swap(){return new Vu}withInputValue(e,t,n=!1){return e===1?t?this:new ev:t?new dw(1,n):new Vu}equals(e){return e.kind===1}},Vu=class o extends Bu{get kind(){return 2}get includesInput2(){return!0}toString(){return"2\u2713"}swap(){return new Em}withInputValue(e,t,n=!1){return e===2?t?this:new ev:t?new dw(2,n):new o}equals(e){return e.kind===2}},dw=class o extends Bu{constructor(t,n){super();this.firstInput=t;this.smartCombination=n}get kind(){return 3}get includesInput1(){return!0}get includesInput2(){return!0}toString(){return"2\u2713"}swap(){return new o(gk(this.firstInput),this.smartCombination)}withInputValue(t,n,i=!1){return n?this:t===1?new Vu:new Em}equals(t){return t.kind===3&&this.firstInput===t.firstInput&&this.smartCombination===t.smartCombination}getInput(t){return t===this.firstInput?1:2}},fk=class extends Bu{get kind(){return 4}toString(){return"unrecognized"}swap(){return this}withInputValue(e,t,n=!1){return t?e===1?new Em:new Vu:this}equals(e){return e.kind===4}},Un;(t=>(t.base=new ev,t.unrecognized=new fk))(Un||={});var wm=class{constructor(e){this.telemetryService=e}reportMergeEditorOpened(e){this.telemetryService.publicLog2("mergeEditor.opened",{conflictCount:e.conflictCount,combinableConflictCount:e.combinableConflictCount,baseVisible:e.baseVisible,isColumnView:e.isColumnView,baseTop:e.baseTop})}reportLayoutChange(e){this.telemetryService.publicLog2("mergeEditor.layoutChanged",{baseVisible:e.baseVisible,isColumnView:e.isColumnView,baseTop:e.baseTop})}reportMergeEditorClosed(e){this.telemetryService.publicLog2("mergeEditor.closed",{conflictCount:e.conflictCount,combinableConflictCount:e.combinableConflictCount,durationOpenedSecs:e.durationOpenedSecs,remainingConflictCount:e.remainingConflictCount,accepted:e.accepted,conflictsResolvedWithBase:e.conflictsResolvedWithBase,conflictsResolvedWithInput1:e.conflictsResolvedWithInput1,conflictsResolvedWithInput2:e.conflictsResolvedWithInput2,conflictsResolvedWithSmartCombination:e.conflictsResolvedWithSmartCombination,manuallySolvedConflictCountThatEqualNone:e.manuallySolvedConflictCountThatEqualNone,manuallySolvedConflictCountThatEqualSmartCombine:e.manuallySolvedConflictCountThatEqualSmartCombine,manuallySolvedConflictCountThatEqualInput1:e.manuallySolvedConflictCountThatEqualInput1,manuallySolvedConflictCountThatEqualInput2:e.manuallySolvedConflictCountThatEqualInput2,manuallySolvedConflictCountThatEqualNoneAndStartedWithBase:e.manuallySolvedConflictCountThatEqualNoneAndStartedWithBase,manuallySolvedConflictCountThatEqualNoneAndStartedWithInput1:e.manuallySolvedConflictCountThatEqualNoneAndStartedWithInput1,manuallySolvedConflictCountThatEqualNoneAndStartedWithInput2:e.manuallySolvedConflictCountThatEqualNoneAndStartedWithInput2,manuallySolvedConflictCountThatEqualNoneAndStartedWithBothNonSmart:e.manuallySolvedConflictCountThatEqualNoneAndStartedWithBothNonSmart,manuallySolvedConflictCountThatEqualNoneAndStartedWithBothSmart:e.manuallySolvedConflictCountThatEqualNoneAndStartedWithBothSmart})}reportAcceptInvoked(e,t){this.telemetryService.publicLog2("mergeEditor.action.accept",{otherAccepted:t,isInput1:e===1})}reportSmartCombinationInvoked(e){this.telemetryService.publicLog2("mergeEditor.action.smartCombination",{otherAccepted:e})}reportRemoveInvoked(e,t){this.telemetryService.publicLog2("mergeEditor.action.remove",{otherAccepted:t,isInput1:e===1})}reportResetToBaseInvoked(){this.telemetryService.publicLog2("mergeEditor.action.resetToBase",{})}reportNavigationToNextConflict(){this.telemetryService.publicLog2("mergeEditor.action.goToNextConflict",{})}reportNavigationToPreviousConflict(){this.telemetryService.publicLog2("mergeEditor.action.goToPreviousConflict",{})}reportConflictCounterClicked(){this.telemetryService.publicLog2("mergeEditor.action.conflictCounterClicked",{})}};wm=k([E(0,Ao)],wm);var Wu=class extends Ss{constructor(t,n,i,r,s,a,l,d,c){super();this.base=t;this.input1=n;this.input2=i;this.resultTextModel=r;this.diffComputer=s;this.options=a;this.telemetry=l;this.languageService=d;this.undoRedoService=c;this._register(sh(this.modifiedBaseRangeResultStates)),this._register(sh(this.input1ResultMapping)),this._register(sh(this.input2ResultMapping));let u=this.initialize();this.onInitialized=this.onInitialized.then(async()=>{await u}),u.then(()=>{let h=!0;this._register(N_({handleChange:m=>(m.didChange(this.modifiedBaseRangeResultStates)&&(h=!0),m.didChange(this.resultTextModelDiffs.diffs)?m.change===1:!0)},m=>{let g=this.modifiedBaseRangeResultStates.read(m);if(!this.isUpToDate.read(m))return;let f=this.resultTextModelDiffs.diffs.read(m);et(b=>{if(this.updateBaseRangeAcceptedState(f,g,b),h){h=!1;for(let[y,C]of g){let S=C.accepted.get(),w=!(S.kind===0||S.kind===4);C.handledInput1.set(w,b),C.handledInput2.set(w,b)}}})}))})}input1TextModelDiffs=this._register(new xm(this.base,this.input1.textModel,this.diffComputer));input2TextModelDiffs=this._register(new xm(this.base,this.input2.textModel,this.diffComputer));resultTextModelDiffs=this._register(new xm(this.base,this.resultTextModel,this.diffComputer));modifiedBaseRanges=Ct(this,t=>{let n=this.input1TextModelDiffs.diffs.read(t),i=this.input2TextModelDiffs.diffs.read(t);return lw.fromDiffs(n,i,this.base,this.input1.textModel,this.input2.textModel)});modifiedBaseRangeResultStates=Ct(this,t=>new Map(this.modifiedBaseRanges.read(t).map(i=>[i,new cw(i)])));resultSnapshot=this.resultTextModel.createSnapshot();async initialize(){this.options.resetResult&&await this.reset()}async reset(){await bg(this.inputDiffComputingState,n=>n===2);let t=this.modifiedBaseRangeResultStates.get();et(n=>{for(let[i,r]of t){let s,a=!1;i.input1Diffs.length===0?(s=Un.base.withInputValue(2,!0),a=!0):i.input2Diffs.length===0?(s=Un.base.withInputValue(1,!0),a=!0):i.isEqualChange?(s=Un.base.withInputValue(1,!0),a=!0):(s=Un.base,a=!1),r.accepted.set(s,n),r.computedFromDiffing=!1,r.previousNonDiffingState=void 0,r.handledInput1.set(a,n),r.handledInput2.set(a,n)}this.resultTextModel.pushEditOperations(null,[{range:new L(1,1,Number.MAX_SAFE_INTEGER,1),text:this.computeAutoMergedResult()}],()=>null)})}computeAutoMergedResult(){let t=this.modifiedBaseRanges.get(),n=this.base.getLinesContent(),i=this.input1.textModel.getLinesContent(),r=this.input2.textModel.getLinesContent(),s=[];function a(d,c){for(let u=c.startLineNumber;u<c.endLineNumberExclusive;u++)s.push(d[u-1])}let l=1;for(let d of t)a(n,en.fromLineNumbers(l,d.baseRange.startLineNumber)),l=d.baseRange.endLineNumberExclusive,d.input1Diffs.length===0?a(r,d.input2Range):d.input2Diffs.length===0||d.isEqualChange?a(i,d.input1Range):a(n,d.baseRange);return a(n,en.fromLineNumbers(l,n.length+1)),s.join(this.resultTextModel.getEOL())}hasBaseRange(t){return this.modifiedBaseRangeResultStates.get().has(t)}baseInput1Diffs=this.input1TextModelDiffs.diffs;baseInput2Diffs=this.input2TextModelDiffs.diffs;baseResultDiffs=this.resultTextModelDiffs.diffs;get isApplyingEditInResult(){return this.resultTextModelDiffs.isApplyingChange}input1ResultMapping=Ct(this,t=>this.getInputResultMapping(this.baseInput1Diffs.read(t),this.baseResultDiffs.read(t),this.input1.textModel.getLineCount()));resultInput1Mapping=Ct(this,t=>this.input1ResultMapping.read(t).reverse());input2ResultMapping=Ct(this,t=>this.getInputResultMapping(this.baseInput2Diffs.read(t),this.baseResultDiffs.read(t),this.input2.textModel.getLineCount()));resultInput2Mapping=Ct(this,t=>this.input2ResultMapping.read(t).reverse());getInputResultMapping(t,n,i){let r=os.betweenOutputs(t,n,i);return new os(r.lineRangeMappings.map(s=>s.inputRange.isEmpty||s.outputRange.isEmpty?new Wr(s.inputRange.deltaStart(-1),s.outputRange.deltaStart(-1)):s),r.inputLineCount)}baseResultMapping=Ct(this,t=>{let n=new os(this.baseResultDiffs.read(t),-1);return new os(n.lineRangeMappings.map(i=>i.inputRange.isEmpty||i.outputRange.isEmpty?new Wr(i.inputRange.deltaStart(-1),i.outputRange.deltaStart(-1)):i),n.inputLineCount)});resultBaseMapping=Ct(this,t=>this.baseResultMapping.read(t).reverse());translateInputRangeToBase(t,n){let i=t===1?this.baseInput1Diffs.get():this.baseInput2Diffs.get();return new Pu(i.flatMap(s=>s.rangeMappings),0).reverse().projectRange(n).outputRange}translateBaseRangeToInput(t,n){let i=t===1?this.baseInput1Diffs.get():this.baseInput2Diffs.get();return new Pu(i.flatMap(s=>s.rangeMappings),0).projectRange(n).outputRange}getLineRangeInResult(t,n){return this.resultTextModelDiffs.getResultLineRange(t,n)}translateResultRangeToBase(t){return new Pu(this.baseResultDiffs.get().flatMap(i=>i.rangeMappings),0).reverse().projectRange(t).outputRange}translateBaseRangeToResult(t){return new Pu(this.baseResultDiffs.get().flatMap(i=>i.rangeMappings),0).projectRange(t).outputRange}findModifiedBaseRangesInRange(t){return this.modifiedBaseRanges.get().filter(n=>n.baseRange.intersects(t))}diffComputingState=Ct(this,t=>{let n=[this.input1TextModelDiffs,this.input2TextModelDiffs,this.resultTextModelDiffs].map(i=>i.state.read(t));return n.some(i=>i===1)?1:n.some(i=>i===3)?3:2});inputDiffComputingState=Ct(this,t=>{let n=[this.input1TextModelDiffs,this.input2TextModelDiffs].map(i=>i.state.read(t));return n.some(i=>i===1)?1:n.some(i=>i===3)?3:2});isUpToDate=Ct(this,t=>this.diffComputingState.read(t)===2);onInitialized=bg(this.diffComputingState,t=>t===2).then(()=>{});firstRun=!0;updateBaseRangeAcceptedState(t,n,i){let r=PV(n,t,(s,a)=>s[0].baseRange.touches(a.inputRange)?xo.neitherLessOrGreaterThan:en.compareByStart(s[0].baseRange,a.inputRange));for(let s of r){let a=this.computeState(s.left[0],s.rights),l=s.left[1],d=l.accepted.get();d.equals(a)||(!this.firstRun&&!l.computedFromDiffing&&(l.computedFromDiffing=!0,l.previousNonDiffingState=d),l.accepted.set(a,i))}this.firstRun&&(this.firstRun=!1)}computeState(t,n){if(n.length===0)return Un.base;let i=n.map(a=>a.getLineEdit());function r(a){return Lt(i,a.map(l=>l.getLineEdit()),(l,d)=>l.equals(d))}if(r(t.input1Diffs))return Un.base.withInputValue(1,!0);if(r(t.input2Diffs))return Un.base.withInputValue(2,!0);let s=[Un.base.withInputValue(1,!0).withInputValue(2,!0,!0),Un.base.withInputValue(2,!0).withInputValue(1,!0,!0),Un.base.withInputValue(1,!0).withInputValue(2,!0,!1),Un.base.withInputValue(2,!0).withInputValue(1,!0,!1)];for(let a of s){let{edit:l}=t.getEditForBase(a);if(l){let c=this.resultTextModelDiffs.getResultLineRange(t.baseRange).getLines(this.resultTextModel);if(Lt(l.newLines,c,(u,h)=>u===h))return a}}return Un.unrecognized}getState(t){let n=this.modifiedBaseRangeResultStates.get().get(t);if(!n)throw new Te("object must be from this instance");return n.accepted}setState(t,n,i,r,s=!1){if(!this.isUpToDate.get())throw new Te("Cannot set state while updating");let a=this.modifiedBaseRangeResultStates.get().get(t);if(!a)throw new Te("object must be from this instance");let l=this.resultTextModelDiffs.findTouchingDiffs(t.baseRange),d=new bI;l&&this.resultTextModelDiffs.removeDiffs(l,r,d);let{edit:c,effectiveState:u}=t.getEditForBase(n);a.accepted.set(u,r),a.previousNonDiffingState=void 0,a.computedFromDiffing=!1;let h=a.handledInput1.get(),m=a.handledInput2.get();(!h||!m)&&this.undoRedoService.pushElement(new bk(this.resultTextModel.uri,new WeakRef(this),new WeakRef(a),h,m),d),c&&(this.resultTextModel.pushStackElement(),this.resultTextModelDiffs.applyEditRelativeToOriginal(c,r,d),this.resultTextModel.pushStackElement()),a.handledInput1.set(!0,r),a.handledInput2.set(!0,r)}resetDirtyConflictsToBase(){et(t=>{this.resultTextModel.pushStackElement();for(let n of this.modifiedBaseRanges.get())this.getState(n).get().kind===4&&this.setState(n,Un.base,!1,t,!1);this.resultTextModel.pushStackElement()})}isHandled(t){return this.modifiedBaseRangeResultStates.get().get(t).handled}isInputHandled(t,n){let i=this.modifiedBaseRangeResultStates.get().get(t);return n===1?i.handledInput1:i.handledInput2}setInputHandled(t,n,i,r){let s=this.modifiedBaseRangeResultStates.get().get(t);if(s.handled.get()===i)return;let a=new WeakRef(cw),l=new WeakRef(this);this.undoRedoService.pushElement({type:0,resource:this.resultTextModel.uri,code:"setInputHandled",label:p("setInputHandled","Set Input Handled"),redo(){let d=l.deref(),c=a.deref();d&&!d.isDisposed()&&c&&et(u=>{n===1?s.handledInput1.set(i,u):s.handledInput2.set(i,u)})},undo(){let d=l.deref(),c=a.deref();d&&!d.isDisposed()&&c&&et(u=>{n===1?s.handledInput1.set(!i,u):s.handledInput2.set(!i,u)})}}),n===1?s.handledInput1.set(i,r):s.handledInput2.set(i,r)}setHandled(t,n,i){let r=this.modifiedBaseRangeResultStates.get().get(t);r.handled.get()!==n&&(r.handledInput1.set(n,i),r.handledInput2.set(n,i))}unhandledConflictsCount=Ct(this,t=>{let n=this.modifiedBaseRangeResultStates.read(t),i=0;for(let[r,s]of n)s.handled.read(t)||i++;return i});hasUnhandledConflicts=this.unhandledConflictsCount.map(t=>t>0);setLanguageId(t,n){let i=this.languageService.createById(t);this.base.setLanguage(i,n),this.input1.textModel.setLanguage(i,n),this.input2.textModel.setLanguage(i,n),this.resultTextModel.setLanguage(i,n)}getInitialResultValue(){let t=[];for(;;){let n=this.resultSnapshot.read();if(n===null)break;t.push(n)}return t.join()}async getResultValueWithConflictMarkers(){if(await bg(this.diffComputingState,d=>d===2),this.unhandledConflictsCount.get()===0)return this.resultTextModel.getValue();let t=this.resultTextModel.getLinesContent(),n=this.input1.textModel.getLinesContent(),i=this.input2.textModel.getLinesContent(),r=this.modifiedBaseRangeResultStates.get(),s=[];function a(d,c){for(let u=c.startLineNumber;u<c.endLineNumberExclusive;u++)s.push(d[u-1])}let l=1;for(let[d,c]of r){if(c.handled.get())continue;let u=this.resultTextModelDiffs.getResultLineRange(d.baseRange);a(t,en.fromLineNumbers(l,Math.max(l,u.startLineNumber))),l=u.endLineNumberExclusive,s.push("<<<<<<<"),c.accepted.get().kind===4?a(t,u):a(n,d.input1Range),s.push("======="),a(i,d.input2Range),s.push(">>>>>>>")}return a(t,en.fromLineNumbers(l,t.length+1)),s.join(`
`)}get conflictCount(){return Go(this.modifiedBaseRanges.get(),t=>t.isConflicting)}get combinableConflictCount(){return Go(this.modifiedBaseRanges.get(),t=>t.isConflicting&&t.canBeCombined)}get conflictsResolvedWithBase(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>t.isConflicting&&n.accepted.get().kind===0)}get conflictsResolvedWithInput1(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>t.isConflicting&&n.accepted.get().kind===1)}get conflictsResolvedWithInput2(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>t.isConflicting&&n.accepted.get().kind===2)}get conflictsResolvedWithSmartCombination(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&i.kind===3&&i.smartCombination})}get manuallySolvedConflictCountThatEqualNone(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>t.isConflicting&&n.accepted.get().kind===4)}get manuallySolvedConflictCountThatEqualSmartCombine(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&n.computedFromDiffing&&i.kind===3&&i.smartCombination})}get manuallySolvedConflictCountThatEqualInput1(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&n.computedFromDiffing&&i.kind===1})}get manuallySolvedConflictCountThatEqualInput2(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&n.computedFromDiffing&&i.kind===2})}get manuallySolvedConflictCountThatEqualNoneAndStartedWithBase(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&i.kind===4&&n.previousNonDiffingState?.kind===0})}get manuallySolvedConflictCountThatEqualNoneAndStartedWithInput1(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&i.kind===4&&n.previousNonDiffingState?.kind===1})}get manuallySolvedConflictCountThatEqualNoneAndStartedWithInput2(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&i.kind===4&&n.previousNonDiffingState?.kind===2})}get manuallySolvedConflictCountThatEqualNoneAndStartedWithBothNonSmart(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&i.kind===4&&n.previousNonDiffingState?.kind===3&&!n.previousNonDiffingState?.smartCombination})}get manuallySolvedConflictCountThatEqualNoneAndStartedWithBothSmart(){return Go(this.modifiedBaseRangeResultStates.get().entries(),([t,n])=>{let i=n.accepted.get();return t.isConflicting&&i.kind===4&&n.previousNonDiffingState?.kind===3&&n.previousNonDiffingState?.smartCombination})}};Wu=k([E(7,ho),E(8,vI)],Wu);function Go(o,e){let t=0;for(let n of o)e(n)&&t++;return t}var cw=class{constructor(e){this.baseRange=e}accepted=fn(`BaseRangeState${this.baseRange.baseRange}`,Un.base);handledInput1=fn(`BaseRangeHandledState${this.baseRange.baseRange}.Input1`,!1);handledInput2=fn(`BaseRangeHandledState${this.baseRange.baseRange}.Input2`,!1);computedFromDiffing=!1;previousNonDiffingState=void 0;handled=Ct(this,e=>this.handledInput1.read(e)&&this.handledInput2.read(e))};var bk=class{constructor(e,t,n,i,r){this.resource=e;this.mergeEditorModelRef=t;this.stateRef=n;this.input1Handled=i;this.input2Handled=r}code="undoMarkAsHandled";label=p("undoMarkAsHandled","Undo Mark As Handled");type=0;redo(){let e=this.mergeEditorModelRef.deref();if(!e||e.isDisposed())return;let t=this.stateRef.deref();t&&et(n=>{t.handledInput1.set(!0,n),t.handledInput2.set(!0,n)})}undo(){let e=this.mergeEditorModelRef.deref();if(!e||e.isDisposed())return;let t=this.stateRef.deref();t&&et(n=>{t.handledInput1.set(this.input1Handled,n),t.handledInput2.set(this.input2Handled,n)})}};var wPt=I("mergeEditor.change.background","#9bb95533",p("mergeEditor.change.background","The background color for changes.")),_Pt=I("mergeEditor.change.word.background",{dark:"#9ccc2c33",light:"#9ccc2c66",hcDark:"#9ccc2c33",hcLight:"#9ccc2c66"},p("mergeEditor.change.word.background","The background color for word changes.")),TPt=I("mergeEditor.changeBase.background",{dark:"#4B1818FF",light:"#FFCCCCFF",hcDark:"#4B1818FF",hcLight:"#FFCCCCFF"},p("mergeEditor.changeBase.background","The background color for changes in base.")),LPt=I("mergeEditor.changeBase.word.background",{dark:"#6F1313FF",light:"#FFA3A3FF",hcDark:"#6F1313FF",hcLight:"#FFA3A3FF"},p("mergeEditor.changeBase.word.background","The background color for word changes in base.")),DPt=I("mergeEditor.conflict.unhandledUnfocused.border",{dark:"#ffa6007a",light:"#ffa600FF",hcDark:"#ffa6007a",hcLight:"#ffa6007a"},p("mergeEditor.conflict.unhandledUnfocused.border","The border color of unhandled unfocused conflicts.")),RPt=I("mergeEditor.conflict.unhandledFocused.border","#ffa600",p("mergeEditor.conflict.unhandledFocused.border","The border color of unhandled focused conflicts.")),kPt=I("mergeEditor.conflict.handledUnfocused.border","#86868649",p("mergeEditor.conflict.handledUnfocused.border","The border color of handled unfocused conflicts.")),MPt=I("mergeEditor.conflict.handledFocused.border","#c1c1c1cc",p("mergeEditor.conflict.handledFocused.border","The border color of handled focused conflicts.")),Pl=I("mergeEditor.conflict.handled.minimapOverViewRuler","#adaca8ee",p("mergeEditor.conflict.handled.minimapOverViewRuler","The foreground color for changes in input 1.")),Fl=I("mergeEditor.conflict.unhandled.minimapOverViewRuler","#fcba03FF",p("mergeEditor.conflict.unhandled.minimapOverViewRuler","The foreground color for changes in input 1.")),NPt=I("mergeEditor.conflictingLines.background","#ffea0047",p("mergeEditor.conflictingLines.background",'The background of the "Conflicting Lines" text.')),WV=.4,APt=I("mergeEditor.conflict.input1.background",de(wf,WV),p("mergeEditor.conflict.input1.background","The background color of decorations in input 1.")),OPt=I("mergeEditor.conflict.input2.background",de(_f,WV),p("mergeEditor.conflict.input2.background","The background color of decorations in input 2."));var Jd=class extends B{constructor(t,n,i){super();this._editor=t;this._domNode=n;this.itemProvider=i;this._domNode.className="gutter monaco-editor";let r=this._domNode.appendChild(pn("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{et(a=>{this.domNodeSizeChanged.trigger(a)})});s.observe(this._domNode),this._register(pe(()=>s.disconnect())),this._register(Wt(a=>{r.className=this.isScrollTopZero.read(a)?"":"scroll-decoration"})),this._register(Wt(a=>this.render(a)))}scrollTop=xr(this,this._editor.onDidScrollChange,t=>this._editor.getScrollTop());isScrollTopZero=this.scrollTop.map(t=>t===0);modelAttached=xr(this,this._editor.onDidChangeModel,t=>this._editor.hasModel());editorOnDidChangeViewZones=Bv("onDidChangeViewZones",this._editor.onDidChangeViewZones);editorOnDidContentSizeChange=Bv("onDidContentSizeChange",this._editor.onDidContentSizeChange);domNodeSizeChanged=rh("domNodeSizeChanged");dispose(){super.dispose(),Tn(this._domNode)}views=new Map;render(t){if(!this.modelAttached.read(t))return;this.domNodeSizeChanged.read(t),this.editorOnDidChangeViewZones.read(t),this.editorOnDidContentSizeChange.read(t);let n=this.scrollTop.read(t),i=this._editor.getVisibleRanges(),r=new Set(this.views.keys());if(i.length>0){let s=i[0],a=new en(s.startLineNumber,s.endLineNumber-s.startLineNumber).deltaEnd(1),l=this.itemProvider.getIntersectingGutterItems(a,t);for(let d of l){if(!d.range.touches(a))continue;r.delete(d.id);let c=this.views.get(d.id);if(c)c.gutterItemView.update(d);else{let g=document.createElement("div");this._domNode.appendChild(g);let f=this.itemProvider.createView(d,g);c=new vk(f,g),this.views.set(d.id,c)}let u=d.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(d.range.startLineNumber,!0)-n:this._editor.getBottomForLineNumber(d.range.startLineNumber-1,!1)-n,m=this._editor.getBottomForLineNumber(d.range.endLineNumberExclusive-1,!0)-n-u;c.domNode.style.top=`${u}px`,c.domNode.style.height=`${m}px`,c.gutterItemView.layout(u,m,0,this._domNode.clientHeight)}}for(let s of r){let a=this.views.get(s);a.gutterItemView.dispose(),a.domNode.remove(),this.views.delete(s)}}},vk=class{constructor(e,t){this.gutterItemView=e;this.domNode=t}};var Hu=class o{constructor(e,t,n,i,r){this._initialScrollTop=e;this._initialContentHeight=t;this._visiblePosition=n;this._visiblePositionScrollDelta=i;this._cursorPosition=r}static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new o(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,n=0,i=e.getVisibleRanges();if(i.length>0){t=i[0].getStartPosition();let r=e.getTopForPosition(t.lineNumber,t.column);n=e.getScrollTop()-r}return new o(e.getScrollTop(),e.getContentHeight(),t,n,e.getPosition())}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){let t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;let t=e.getPosition();if(!this._cursorPosition||!t)return;let n=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+n,1)}};var _m=class{lenses=[];_disposables=new oe;dispose(){this._disposables.dispose()}get isDisposed(){return this._disposables.isDisposed}add(e,t){this._disposables.add(e);for(let n of e.lenses)this.lenses.push({symbol:n,provider:t})}};async function yk(o,e,t){let n=o.ordered(e),i=new Map,r=new _m,s=n.map(async(a,l)=>{i.set(a,l);try{let d=await Promise.resolve(a.provideCodeLenses(e,t));d&&r.add(d,a)}catch(d){Xu(d)}});return await Promise.all(s),r.lenses=r.lenses.sort((a,l)=>a.symbol.range.startLineNumber<l.symbol.range.startLineNumber?-1:a.symbol.range.startLineNumber>l.symbol.range.startLineNumber?1:i.get(a.provider)<i.get(l.provider)?-1:i.get(a.provider)>i.get(l.provider)?1:a.symbol.range.startColumn<l.symbol.range.startColumn?-1:a.symbol.range.startColumn>l.symbol.range.startColumn?1:0),r}$i.registerCommand("_executeCodeLensProvider",function(o,...e){let[t,n]=e;tl(ne.isUri(t)),tl(typeof n=="number"||!n);let{codeLensProvider:i}=o.get(Al),r=o.get(kr).getModel(t);if(!r)throw as();let s=[],a=new oe;return yk(i,r,Xt.None).then(l=>{a.add(l);let d=[];for(let c of l.lenses)n==null||c.symbol.command?s.push(c.symbol):n-- >0&&c.provider.resolveCodeLens&&d.push(Promise.resolve(c.provider.resolveCodeLens(r,c.symbol,Xt.None)).then(u=>s.push(u||c.symbol)));return Promise.all(d)}).then(()=>s).finally(()=>{setTimeout(()=>a.dispose(),100)})});var Ik=Z("ICodeLensCache"),uw=class{constructor(e,t){this.lineCount=e;this.data=t}},tv=class{_fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}};_cache=new Ri(20,.75);constructor(e){let t="codelens/cache";eu(_e,()=>e.remove(t,1));let n="codelens/cache2",i=e.get(n,1,"{}");this._deserialize(i);let r=Y.filter(e.onWillSaveState,s=>s.reason===1);Y.once(r)(s=>{e.store(n,this._serialize(),1,1)})}put(e,t){let n=t.lenses.map(s=>({range:s.symbol.range,command:s.symbol.command&&{id:"",title:s.symbol.command?.title}})),i=new _m;i.add({lenses:n,dispose:()=>{}},this._fakeProvider);let r=new uw(e.getLineCount(),i);this._cache.set(e.uri.toString(),r)}get(e){let t=this._cache.get(e.uri.toString());return t&&t.lineCount===e.getLineCount()?t.data:void 0}delete(e){this._cache.delete(e.uri.toString())}_serialize(){let e=Object.create(null);for(let[t,n]of this._cache){let i=new Set;for(let r of n.data.lenses)i.add(r.symbol.range.startLineNumber);e[t]={lineCount:n.lineCount,lines:[...i.values()]}}return JSON.stringify(e)}_deserialize(e){try{let t=JSON.parse(e);for(let n in t){let i=t[n],r=[];for(let a of i.lines)r.push({range:new L(a,1,a,11)});let s=new _m;s.add({lenses:r,dispose(){}},this._fakeProvider),this._cache.set(n,new uw(i.lineCount,s))}}catch{}}};tv=k([E(0,In)],tv);Pn(Ik,tv,1);var Ck=class{suppressMouseDown;domNode;afterLineNumber;afterColumn=1073741824;heightInPx;_lastHeight;_onHeight;constructor(e,t,n){this.afterLineNumber=e,this.heightInPx=t,this._onHeight=n,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(e){this._lastHeight===void 0?this._lastHeight=e:this._lastHeight!==e&&(this._lastHeight=e,this._onHeight())}isVisible(){return this._lastHeight!==0&&this.domNode.hasAttribute("monaco-visible-view-zone")}},Sk=class o{static _idPool=0;allowEditorOverflow=!1;suppressMouseDown=!0;_id;_domNode;_editor;_commands=new Map;_widgetPosition;_isEmpty=!0;constructor(e,t){this._editor=e,this._id=`codelens.widget-${o._idPool++}`,this.updatePosition(t),this._domNode=document.createElement("span"),this._domNode.className="codelens-decoration"}withCommands(e,t){this._commands.clear();let n=[],i=!1;for(let r=0;r<e.length;r++){let s=e[r];if(s&&(i=!0,s.command)){let a=vo(s.command.title.trim());if(s.command.id){let l=`c${o._idPool++}`;n.push(je("a",{id:l,title:s.command.tooltip,role:"button"},...a)),this._commands.set(l,s.command)}else n.push(je("span",{title:s.command.tooltip},...a));r+1<e.length&&n.push(je("span",void 0,"\xA0|\xA0"))}}i?(Tn(this._domNode,...n),this._isEmpty&&t&&this._domNode.classList.add("fadein"),this._isEmpty=!1):Tn(this._domNode,je("span",void 0,"no commands"))}getCommand(e){return e.parentElement===this._domNode?this._commands.get(e.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(e){let t=this._editor.getModel().getLineFirstNonWhitespaceColumn(e);this._widgetPosition={position:{lineNumber:e,column:t},preference:[1]}}getPosition(){return this._widgetPosition||null}},Tm=class{_removeDecorations;_addDecorations;_addDecorationsCallbacks;constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(e,t){this._addDecorations.push(e),this._addDecorationsCallbacks.push(t)}removeDecoration(e){this._removeDecorations.push(e)}commit(e){let t=e.deltaDecorations(this._removeDecorations,this._addDecorations);for(let n=0,i=t.length;n<i;n++)this._addDecorationsCallbacks[n](t[n])}},HV=Gt.register({collapseOnReplaceEdit:!0,description:"codelens"}),nv=class{_editor;_viewZone;_viewZoneId;_contentWidget;_decorationIds;_data;_isDisposed=!1;constructor(e,t,n,i,r,s){this._editor=t,this._data=e,this._decorationIds=[];let a,l=[];this._data.forEach((d,c)=>{d.symbol.command&&l.push(d.symbol),n.addDecoration({range:d.symbol.range,options:HV},u=>this._decorationIds[c]=u),a?a=L.plusRange(a,d.symbol.range):a=L.lift(d.symbol.range)}),this._viewZone=new Ck(a.startLineNumber-1,r,s),this._viewZoneId=i.addZone(this._viewZone),l.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(l,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new Sk(this._editor,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(e,t){this._decorationIds.forEach(e.removeDecoration,e),this._decorationIds=[],t?.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some((e,t)=>{let n=this._editor.getModel().getDecorationRange(e),i=this._data[t].symbol;return!!(n&&L.isEmpty(i.range)===n.isEmpty())})}updateCodeLensSymbols(e,t){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],this._data=e,this._data.forEach((n,i)=>{t.addDecoration({range:n.symbol.range,options:HV},r=>this._decorationIds[i]=r)})}updateHeight(e,t){this._viewZone.heightInPx=e,t.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(e){if(!this._viewZone.isVisible())return null;for(let t=0;t<this._decorationIds.length;t++){let n=e.getDecorationRange(this._decorationIds[t]);n&&(this._data[t].symbol.range=n)}return this._data}updateCommands(e){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(e,!0);for(let t=0;t<this._data.length;t++){let n=e[t];if(n){let{symbol:i}=this._data[t];i.command=n.command||i.command}}}getCommand(e){return this._contentWidget?.getCommand(e)}getLineNumber(){let e=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return e?e.startLineNumber:-1}update(e){if(this.isValid()){let t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);t&&(this._viewZone.afterLineNumber=t.startLineNumber-1,e.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(t.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}getItems(){return this._data}};var C8={Quickaccess:"workbench.contributions.quickaccess"},xk=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,n)=>n.prefix.length-t.prefix.length),pe(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return vr([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(n=>e.startsWith(n.prefix))||void 0||this.defaultProvider}clear(){let e=[...this.providers],t=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=e,this.defaultProvider=t}}};Je.add(C8.Quickaccess,new xk);var bBt=new $n(()=>{let o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:o,collatorIsNumeric:o.resolvedOptions().numeric}}),vBt=new $n(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),yBt=new $n(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));var kBt=Object.freeze({score:0}),MBt=1<<18,NBt=1<<17;var Ek=class{constructor(e){this.options=e}getItemLabel(e){return e.label}getItemDescription(e){if(!this.options?.skipDescription)return e.description}getItemPath(e){if(!this.options?.skipPath)return e.resource?.scheme===Ae.file?e.resource.fsPath:e.resource?.path}},i2t=new Ek,hw=Z("quickInputService");var ov=Z("ILanguageFeatureDebounceService"),Tk;(n=>{let o=new WeakMap,e=0;function t(i){let r=o.get(i);return r===void 0&&(r=++e,o.set(i,r)),r}n.of=t})(Tk||={});var wk=class{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}},_k=class{constructor(e,t,n,i,r,s){this._logService=e;this._name=t;this._registry=n;this._default=i;this._min=r;this._max=s}_cache=new Ri(50,.7);_key(e){return e.id+this._registry.all(e).reduce((t,n)=>qf(Tk.of(n),t),0)}get(e){let t=this._key(e),n=this._cache.get(t);return n?Vn(n.value,this._min,this._max):this.default()}update(e,t){let n=this._key(e),i=this._cache.get(n);i||(i=new HC(6),this._cache.set(n,i));let r=Vn(i.update(t),this._min,this._max);return fh(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${r}ms`),r}_overall(){let e=new nb;for(let[,t]of this._cache)e.update(t.value);return e.value}default(){let e=this._overall()|0||this._default;return Vn(e,this._min,this._max)}},iv=class{constructor(e,t){this._logService=e;this._isDev=t.isExtensionDevelopment||!t.isBuilt}_data=new Map;_isDev;for(e,t,n){let i=n?.min??50,r=n?.max??i**2,s=n?.key??void 0,a=`${Tk.of(e)},${i}${s?","+s:""}`,l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new wk(i*1.5)):l=new _k(this._logService,t,e,this._overallAverage()|0||i*1.5,i,r),this._data.set(a,l)),l}_overallAverage(){let e=new nb;for(let t of this._data.values())e.update(t.default());return e.value}};iv=k([E(0,Fn),E(1,Ro)],iv);Pn(ov,iv,1);var Bl=class{constructor(e,t,n,i,r,s){this._editor=e;this._languageFeaturesService=t;this._commandService=i;this._notificationService=r;this._codeLensCache=s;this._provideCodeLensDebounce=n.for(t.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=n.for(t.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new Yt(()=>this._resolveCodeLensesInViewport(),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{(a.hasChanged(51)||a.hasChanged(19)||a.hasChanged(18))&&this._updateLensStyle(),a.hasChanged(17)&&this._onModelChange()})),this._disposables.add(t.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._updateLensStyle()}static ID="css.editor.codeLens";_disposables=new oe;_localToDispose=new oe;_lenses=[];_provideCodeLensDebounce;_resolveCodeLensesDebounce;_resolveCodeLensesScheduler;_getCodeLensModelPromise;_oldCodeLensModels=new oe;_currentCodeLensModel;_resolveCodeLensesPromise;dispose(){this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),this._currentCodeLensModel?.dispose()}_getLayoutInfo(){let e=Math.max(1.3,this._editor.getOption(68)/this._editor.getOption(53)),t=this._editor.getOption(19);return(!t||t<5)&&(t=this._editor.getOption(53)*.9|0),{fontSize:t,codeLensHeight:t*e|0}}_updateLensStyle(){let{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),n=this._editor.getOption(18),i=this._editor.getOption(51),{style:r}=this._editor.getContainerDomNode();r.setProperty("--vscode-editorCodeLens-lineHeight",`${e}px`),r.setProperty("--vscode-editorCodeLens-fontSize",`${t}px`),r.setProperty("--vscode-editorCodeLens-fontFeatureSettings",i.fontFeatureSettings),n&&(r.setProperty("--vscode-editorCodeLens-fontFamily",n),r.setProperty("--vscode-editorCodeLens-fontFamilyDefault",fi.fontFamily)),this._editor.changeViewZones(s=>{for(let a of this._lenses)a.updateHeight(e,s)})}_localDispose(){this._getCodeLensModelPromise?.cancel(),this._getCodeLensModelPromise=void 0,this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),this._currentCodeLensModel?.dispose()}_onModelChange(){this._localDispose();let e=this._editor.getModel();if(!e||!this._editor.getOption(17)||e.isTooLargeForTokenization())return;let t=this._codeLensCache.get(e);if(t&&this._renderCodeLensSymbols(t),!this._languageFeaturesService.codeLensProvider.has(e)){t&&kh(()=>{let i=this._codeLensCache.get(e);t===i&&(this._codeLensCache.delete(e),this._onModelChange())},30*1e3,this._localToDispose);return}for(let i of this._languageFeaturesService.codeLensProvider.all(e))if(typeof i.onDidChange=="function"){let r=i.onDidChange(()=>n.schedule());this._localToDispose.add(r)}let n=new Yt(()=>{let i=Date.now();this._getCodeLensModelPromise?.cancel(),this._getCodeLensModelPromise=la(r=>yk(this._languageFeaturesService.codeLensProvider,e,r)),this._getCodeLensModelPromise.then(r=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=r,this._codeLensCache.put(e,r);let s=this._provideCodeLensDebounce.update(e,Date.now()-i);n.delay=s,this._renderCodeLensSymbols(r),this._resolveCodeLensesInViewportSoon()},Ne)},this._provideCodeLensDebounce.get(e));this._localToDispose.add(n),this._localToDispose.add(pe(()=>this._resolveCodeLensesScheduler.cancel())),this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._editor.changeDecorations(i=>{this._editor.changeViewZones(r=>{let s=[],a=-1;this._lenses.forEach(d=>{!d.isValid()||a===d.getLineNumber()?s.push(d):(d.update(r),a=d.getLineNumber())});let l=new Tm;s.forEach(d=>{d.dispose(l,r),this._lenses.splice(this._lenses.indexOf(d),1)}),l.commit(i)})}),n.schedule(),this._resolveCodeLensesScheduler.cancel(),this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0})),this._localToDispose.add(this._editor.onDidFocusEditorText(()=>{n.schedule()})),this._localToDispose.add(this._editor.onDidBlurEditorText(()=>{n.cancel()})),this._localToDispose.add(this._editor.onDidScrollChange(i=>{i.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(this._editor.onDidLayoutChange(()=>{this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(pe(()=>{if(this._editor.getModel()){let i=Hu.capture(this._editor);this._editor.changeDecorations(r=>{this._editor.changeViewZones(s=>{this._disposeAllLenses(r,s)})}),i.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)})),this._localToDispose.add(this._editor.onMouseDown(i=>{if(i.target.type!==9)return;let r=i.target.element;if(r?.tagName==="SPAN"&&(r=r.parentElement),r?.tagName==="A")for(let s of this._lenses){let a=s.getCommand(r);if(a){this._commandService.executeCommand(a.id,...a.arguments||[]).catch(l=>this._notificationService.error(l));break}}})),n.schedule()}_disposeAllLenses(e,t){let n=new Tm;for(let i of this._lenses)i.dispose(n,t);e&&n.commit(e),this._lenses.length=0}_renderCodeLensSymbols(e){if(!this._editor.hasModel())return;let t=this._editor.getModel().getLineCount(),n=[],i;for(let a of e.lenses){let l=a.symbol.range.startLineNumber;l<1||l>t||(i&&i[i.length-1].symbol.range.startLineNumber===l?i.push(a):(i=[a],n.push(i)))}if(!n.length&&!this._lenses.length)return;let r=Hu.capture(this._editor),s=this._getLayoutInfo();this._editor.changeDecorations(a=>{this._editor.changeViewZones(l=>{let d=new Tm,c=0,u=0;for(;u<n.length&&c<this._lenses.length;){let h=n[u][0].symbol.range.startLineNumber,m=this._lenses[c].getLineNumber();m<h?(this._lenses[c].dispose(d,l),this._lenses.splice(c,1)):m===h?(this._lenses[c].updateCodeLensSymbols(n[u],d),u++,c++):(this._lenses.splice(c,0,new nv(n[u],this._editor,d,l,s.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),c++,u++)}for(;c<this._lenses.length;)this._lenses[c].dispose(d,l),this._lenses.splice(c,1);for(;u<n.length;)this._lenses.push(new nv(n[u],this._editor,d,l,s.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),u++;d.commit(a)})}),r.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0;let e=this._editor.getModel();if(!e)return;let t=[],n=[];if(this._lenses.forEach(s=>{let a=s.computeIfNecessary(e);a&&(t.push(a),n.push(s))}),t.length===0)return;let i=Date.now(),r=la(s=>{let a=t.map((l,d)=>{let c=new Array(l.length),u=l.map((h,m)=>!h.symbol.command&&typeof h.provider.resolveCodeLens=="function"?Promise.resolve(h.provider.resolveCodeLens(e,h.symbol,s)).then(g=>{c[m]=g},Xu):(c[m]=h.symbol,Promise.resolve(void 0)));return Promise.all(u).then(()=>{!s.isCancellationRequested&&!n[d].isDisposed()&&n[d].updateCommands(c)})});return Promise.all(a)});this._resolveCodeLensesPromise=r,this._resolveCodeLensesPromise.then(()=>{let s=this._resolveCodeLensesDebounce.update(e,Date.now()-i);this._resolveCodeLensesScheduler.delay=s,this._currentCodeLensModel&&this._codeLensCache.put(e,this._currentCodeLensModel),this._oldCodeLensModels.clear(),r===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)},s=>{Ne(s),r===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)})}async getModel(){return await this._getCodeLensModelPromise,await this._resolveCodeLensesPromise,this._currentCodeLensModel?.isDisposed?void 0:this._currentCodeLensModel}};Bl=k([E(1,Al),E(2,ov),E(3,Lo),E(4,eo),E(5,Ik)],Bl);Yd(Bl.ID,Bl,1);kn(class extends qd{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:ae.hasCodeLensProvider,label:p("showLensOnLine","Show CodeLens Commands For Current Line"),alias:"Show CodeLens Commands For Current Line"})}async run(e,t){if(!t.hasModel())return;let n=e.get(hw),i=e.get(Lo),r=e.get(eo),s=t.getSelection().positionLineNumber,a=t.getContribution(Bl.ID);if(!a)return;let l=await a.getModel();if(!l)return;let d=[];for(let h of l.lenses)h.symbol.command&&h.symbol.range.startLineNumber===s&&d.push({label:h.symbol.command.title,command:h.symbol.command});if(d.length===0)return;let c=await n.pick(d,{canPickMany:!1,placeHolder:p("placeHolder","Select a command")});if(!c)return;let u=c.command;if(l.isDisposed){let m=(await a.getModel())?.lenses.find(g=>g.symbol.range.startLineNumber===s&&g.symbol.command?.title===u.title);if(!m||!m.symbol.command)return;u=m.symbol.command}try{await i.executeCommand(u.id,...u.arguments||[])}catch(h){r.error(h)}}});var S8={0:" ",1:"u",2:"r"},UV=65535,Hr=16777215,zV=4278190080,rv=class{_states;constructor(e){let t=Math.ceil(e/32);this._states=new Uint32Array(t)}get(e){let t=e/32|0,n=e%32;return(this._states[t]&1<<n)!==0}set(e,t){let n=e/32|0,i=e%32,r=this._states[n];t?this._states[n]=r|1<<i:this._states[n]=r&~(1<<i)}},Wi=class o{_startIndexes;_endIndexes;_collapseStates;_userDefinedStates;_recoveredStates;_parentsComputed;_types;constructor(e,t,n){if(e.length!==t.length||e.length>UV)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new rv(e.length),this._userDefinedStates=new rv(e.length),this._recoveredStates=new rv(e.length),this._types=n,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],t=(n,i)=>{let r=e[e.length-1];return this.getStartLineNumber(r)<=n&&this.getEndLineNumber(r)>=i};for(let n=0,i=this._startIndexes.length;n<i;n++){let r=this._startIndexes[n],s=this._endIndexes[n];if(r>Hr||s>Hr)throw new Error("startLineNumber or endLineNumber must not exceed "+Hr);for(;e.length>0&&!t(r,s);)e.pop();let a=e.length>0?e[e.length-1]:-1;e.push(n),this._startIndexes[n]=r+((a&255)<<24),this._endIndexes[n]=s+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&Hr}getEndLineNumber(e){return this._endIndexes[e]&Hr}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){return this._collapseStates.get(e)}setCollapsed(e,t){this._collapseStates.set(e,t)}isUserDefined(e){return this._userDefinedStates.get(e)}setUserDefined(e,t){return this._userDefinedStates.set(e,t)}isRecovered(e){return this._recoveredStates.get(e)}setRecovered(e,t){return this._recoveredStates.set(e,t)}getSource(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}setSource(e,t){t===1?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):t===2?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}setCollapsedAllOfType(e,t){let n=!1;if(this._types)for(let i=0;i<this._types.length;i++)this._types[i]===e&&(this.setCollapsed(i,t),n=!0);return n}toRegion(e){return new Lk(this,e)}getParentIndex(e){this.ensureParentIndices();let t=((this._startIndexes[e]&zV)>>>24)+((this._endIndexes[e]&zV)>>>16);return t===UV?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,n=this._startIndexes.length;if(n===0)return-1;for(;t<n;){let i=Math.floor((t+n)/2);e<this.getStartLineNumber(i)?n=i:t=i+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){let e=[];for(let t=0;t<this.length;t++)e[t]=`[${S8[this.getSource(t)]}${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}toFoldRange(e){return{startLineNumber:this._startIndexes[e]&Hr,endLineNumber:this._endIndexes[e]&Hr,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}static fromFoldRanges(e){let t=e.length,n=new Uint32Array(t),i=new Uint32Array(t),r=[],s=!1;for(let l=0;l<t;l++){let d=e[l];n[l]=d.startLineNumber,i[l]=d.endLineNumber,r.push(d.type),d.type&&(s=!0)}s||(r=void 0);let a=new o(n,i,r);for(let l=0;l<t;l++)e[l].isCollapsed&&a.setCollapsed(l,!0),a.setSource(l,e[l].source);return a}static sanitizeAndMerge(e,t,n,i){n=n??Number.MAX_VALUE;let r=(b,y)=>Array.isArray(b)?C=>C<y?b[C]:void 0:C=>C<y?b.toFoldRange(C):void 0,s=r(e,e.length),a=r(t,t.length),l=0,d=0,c=s(0),u=a(0),h=[],m,g=0,f=[];for(;c||u;){let b;if(u&&(!c||c.startLineNumber>=u.startLineNumber))c&&c.startLineNumber===u.startLineNumber?(u.source===1?b=u:(b=c,b.isCollapsed=u.isCollapsed&&(c.endLineNumber===u.endLineNumber||!i?.startsInside(c.startLineNumber+1,c.endLineNumber+1)),b.source=0),c=s(++l)):(b=u,u.isCollapsed&&u.source===0&&(b.source=2)),u=a(++d);else{let y=d,C=u;for(;;){if(!C||C.startLineNumber>c.endLineNumber){b=c;break}if(C.source===1&&C.endLineNumber>c.endLineNumber)break;C=a(++y)}c=s(++l)}if(b){for(;m&&m.endLineNumber<b.startLineNumber;)m=h.pop();b.endLineNumber>b.startLineNumber&&b.startLineNumber>g&&b.endLineNumber<=n&&(!m||m.endLineNumber>=b.endLineNumber)&&(f.push(b),g=b.startLineNumber,m&&h.push(m),m=b)}}return f}},Lk=class{constructor(e,t){this.ranges=e;this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}hidesLine(e){return this.startLineNumber<e&&e<=this.endLineNumber}};var pw=class{_textModel;_decorationProvider;_regions;_editorDecorationIds;_updateEventEmitter=new T;onDidChange=this._updateEventEmitter.event;get regions(){return this._regions}get textModel(){return this._textModel}get decorationProvider(){return this._decorationProvider}constructor(e,t){this._textModel=e,this._decorationProvider=t,this._regions=new Wi(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(e){if(!e.length)return;e=e.sort((n,i)=>n.regionIndex-i.regionIndex);let t={};this._decorationProvider.changeDecorations(n=>{let i=0,r=-1,s=-1,a=l=>{for(;i<l;){let d=this._regions.getEndLineNumber(i),c=this._regions.isCollapsed(i);if(d<=r){let u=this.regions.getSource(i)!==0;n.changeDecorationOptions(this._editorDecorationIds[i],this._decorationProvider.getDecorationOption(c,d<=s,u))}c&&d>s&&(s=d),i++}};for(let l of e){let d=l.regionIndex,c=this._editorDecorationIds[d];if(c&&!t[c]){t[c]=!0,a(d);let u=!this._regions.isCollapsed(d);this._regions.setCollapsed(d,u),r=Math.max(r,this._regions.getEndLineNumber(d))}}a(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}removeManualRanges(e){let t=new Array,n=i=>{for(let r of e)if(!(r.startLineNumber>i.endLineNumber||i.startLineNumber>r.endLineNumber))return!0;return!1};for(let i=0;i<this._regions.length;i++){let r=this._regions.toFoldRange(i);(r.source===0||!n(r))&&t.push(r)}this.updatePost(Wi.fromFoldRanges(t))}update(e,t){let n=this._currentFoldedOrManualRanges(t),i=Wi.sanitizeAndMerge(e,n,this._textModel.getLineCount(),t);this.updatePost(Wi.fromFoldRanges(i))}updatePost(e){let t=[],n=-1;for(let i=0,r=e.length;i<r;i++){let s=e.getStartLineNumber(i),a=e.getEndLineNumber(i),l=e.isCollapsed(i),d=e.getSource(i)!==0,c={startLineNumber:s,startColumn:this._textModel.getLineMaxColumn(s),endLineNumber:a,endColumn:this._textModel.getLineMaxColumn(a)+1};t.push({range:c,options:this._decorationProvider.getDecorationOption(l,a<=n,d)}),l&&a>n&&(n=a)}this._decorationProvider.changeDecorations(i=>this._editorDecorationIds=i.deltaDecorations(this._editorDecorationIds,t)),this._regions=e,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(e){let t=[];for(let n=0,i=this._regions.length;n<i;n++){let r=this.regions.isCollapsed(n),s=this.regions.getSource(n);if(r||s!==0){let a=this._regions.toFoldRange(n),l=this._textModel.getDecorationRange(this._editorDecorationIds[n]);l&&(r&&e?.startsInside(l.startLineNumber+1,l.endLineNumber)&&(r=!1),t.push({startLineNumber:l.startLineNumber,endLineNumber:l.endLineNumber,type:a.type,isCollapsed:r,source:s}))}}return t}getMemento(){let e=this._currentFoldedOrManualRanges(),t=[],n=this._textModel.getLineCount();for(let i=0,r=e.length;i<r;i++){let s=e[i];if(s.startLineNumber>=s.endLineNumber||s.startLineNumber<1||s.endLineNumber>n)continue;let a=this._getLinesChecksum(s.startLineNumber+1,s.endLineNumber);t.push({startLineNumber:s.startLineNumber,endLineNumber:s.endLineNumber,isCollapsed:s.isCollapsed,source:s.source,checksum:a})}return t.length>0?t:void 0}applyMemento(e){if(!Array.isArray(e))return;let t=[],n=this._textModel.getLineCount();for(let r of e){if(r.startLineNumber>=r.endLineNumber||r.startLineNumber<1||r.endLineNumber>n)continue;let s=this._getLinesChecksum(r.startLineNumber+1,r.endLineNumber);(!r.checksum||s===r.checksum)&&t.push({startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,type:void 0,isCollapsed:r.isCollapsed??!0,source:r.source??0})}let i=Wi.sanitizeAndMerge(this._regions,t,n);this.updatePost(Wi.fromFoldRanges(i))}_getLinesChecksum(e,t){return Oo(this._textModel.getLineContent(e)+this._textModel.getLineContent(t))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(e,t){let n=[];if(this._regions){let i=this._regions.findRange(e),r=1;for(;i>=0;){let s=this._regions.toRegion(i);(!t||t(s,r))&&n.push(s),r++,i=s.parentIndex}}return n}getRegionAtLine(e){if(this._regions){let t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){let n=[],i=e?e.regionIndex+1:0,r=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){let s=[];for(let a=i,l=this._regions.length;a<l;a++){let d=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<r){for(;s.length>0&&!d.containedBy(s[s.length-1]);)s.pop();s.push(d),t(d,s.length)&&n.push(d)}else break}}else for(let s=i,a=this._regions.length;s<a;s++){let l=this._regions.toRegion(s);if(this._regions.getStartLineNumber(s)<r)(!t||t(l))&&n.push(l);else break}return n}};function Dk(o,e,t){let n=[];for(let i of t){let r=o.getRegionAtLine(i);if(r){let s=!r.isCollapsed;if(n.push(r),e>1){let a=o.getRegionsInside(r,(l,d)=>l.isCollapsed!==s&&d<e);n.push(...a)}}}o.toggleCollapseState(n)}function Uu(o,e,t=Number.MAX_VALUE,n){let i=[];if(n&&n.length>0)for(let r of n){let s=o.getRegionAtLine(r);if(s&&(s.isCollapsed!==e&&i.push(s),t>1)){let a=o.getRegionsInside(s,(l,d)=>l.isCollapsed!==e&&d<t);i.push(...a)}}else{let r=o.getRegionsInside(null,(s,a)=>s.isCollapsed!==e&&a<t);i.push(...r)}o.toggleCollapseState(i)}function Rk(o,e,t,n){let i=[];for(let r of n){let s=o.getAllRegionsAtLine(r,(a,l)=>a.isCollapsed!==e&&l<=t);i.push(...s)}o.toggleCollapseState(i)}function KV(o,e,t){let n=[];for(let i of t){let r=o.getAllRegionsAtLine(i,s=>s.isCollapsed!==e);r.length>0&&n.push(r[0])}o.toggleCollapseState(n)}function GV(o,e,t,n){let i=(s,a)=>a===e&&s.isCollapsed!==t&&!n.some(l=>s.containsLine(l)),r=o.getRegionsInside(null,i);o.toggleCollapseState(r)}function kk(o,e,t){let n=[];for(let s of t){let a=o.getAllRegionsAtLine(s,void 0);a.length>0&&n.push(a[0])}let i=s=>n.every(a=>!a.containedBy(s)&&!s.containedBy(a))&&s.isCollapsed!==e,r=o.getRegionsInside(null,i);o.toggleCollapseState(r)}function mw(o,e,t){let n=o.textModel,i=o.regions,r=[];for(let s=i.length-1;s>=0;s--)if(t!==i.isCollapsed(s)){let a=i.getStartLineNumber(s);e.test(n.getLineContent(a))&&r.push(i.toRegion(s))}o.toggleCollapseState(r)}function gw(o,e,t){let n=o.regions,i=[];for(let r=n.length-1;r>=0;r--)t!==n.isCollapsed(r)&&e===n.getType(r)&&i.push(n.toRegion(r));o.toggleCollapseState(i)}function jV(o,e){let t=null,n=e.getRegionAtLine(o);if(n!==null&&(t=n.startLineNumber,o===t)){let i=n.parentIndex;i!==-1?t=e.regions.getStartLineNumber(i):t=null}return t}function $V(o,e){let t=e.getRegionAtLine(o);if(t!==null&&t.startLineNumber===o){if(o!==t.startLineNumber)return t.startLineNumber;{let n=t.parentIndex,i=0;for(n!==-1&&(i=e.regions.getStartLineNumber(t.parentIndex));t!==null;)if(t.regionIndex>0){if(t=e.regions.toRegion(t.regionIndex-1),t.startLineNumber<=i)return null;if(t.parentIndex===n)return t.startLineNumber}else return null}}else if(e.regions.length>0)for(t=e.regions.toRegion(e.regions.length-1);t!==null;){if(t.startLineNumber<o)return t.startLineNumber;t.regionIndex>0?t=e.regions.toRegion(t.regionIndex-1):t=null}return null}function qV(o,e){let t=e.getRegionAtLine(o);if(t!==null&&t.startLineNumber===o){let n=t.parentIndex,i=0;if(n!==-1)i=e.regions.getEndLineNumber(t.parentIndex);else{if(e.regions.length===0)return null;i=e.regions.getEndLineNumber(e.regions.length-1)}for(;t!==null;)if(t.regionIndex<e.regions.length){if(t=e.regions.toRegion(t.regionIndex+1),t.startLineNumber>=i)return null;if(t.parentIndex===n)return t.startLineNumber}else return null}else if(e.regions.length>0)for(t=e.regions.toRegion(0);t!==null;){if(t.startLineNumber>o)return t.startLineNumber;t.regionIndex<e.regions.length?t=e.regions.toRegion(t.regionIndex+1):t=null}return null}var fw=class{_foldingModel;_hiddenRanges;_foldingModelListener;_updateEventEmitter=new T;_hasLineChanges=!1;get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(e){this._foldingModel=e,this._foldingModelListener=e.onDidChange(t=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some(t=>t.range.endLineNumber!==t.range.startLineNumber||qi(t.text)[0]!==0))}updateHiddenRanges(){let e=!1,t=[],n=0,i=0,r=Number.MAX_VALUE,s=-1,a=this._foldingModel.regions;for(;n<a.length;n++){if(!a.isCollapsed(n))continue;let l=a.getStartLineNumber(n)+1,d=a.getEndLineNumber(n);r<=l&&d<=s||(!e&&i<this._hiddenRanges.length&&this._hiddenRanges[i].startLineNumber===l&&this._hiddenRanges[i].endLineNumber===d?(t.push(this._hiddenRanges[i]),i++):(e=!0,t.push(new L(l,1,d,1))),r=l,s=d)}(this._hasLineChanges||e||i<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return YV(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1,n=this._foldingModel.textModel,i=null,r=s=>((!i||!E8(s,i))&&(i=YV(this._hiddenRanges,s)),i?i.startLineNumber-1:null);for(let s=0,a=e.length;s<a;s++){let l=e[s],d=r(l.startLineNumber);d&&(l=l.setStartPosition(d,n.getLineMaxColumn(d)),t=!0);let c=r(l.endLineNumber);c&&(l=l.setEndPosition(c,n.getLineMaxColumn(c)),t=!0),e[s]=l}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}};function E8(o,e){return o>=e.startLineNumber&&o<=e.endLineNumber}function YV(o,e){let t=Yu(o,n=>e<n.startLineNumber)-1;return t>=0&&o[t].endLineNumber>=e?o[t]:null}var w8=5e3,_8="indent",sv=class{constructor(e,t,n){this.editorModel=e;this.languageConfigurationService=t;this.foldingRangesLimit=n}id=_8;dispose(){}compute(e){let t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,n=t&&!!t.offSide,i=t&&t.markers;return Promise.resolve(L8(this.editorModel,n,i,this.foldingRangesLimit))}},Mk=class{_startIndexes;_endIndexes;_indentOccurrences;_length;_foldingRangesLimit;constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,n){if(e>Hr||t>Hr)return;let i=this._length;this._startIndexes[i]=e,this._endIndexes[i]=t,this._length++,n<1e3&&(this._indentOccurrences[n]=(this._indentOccurrences[n]||0)+1)}toIndentRanges(e){let t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);let n=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let r=this._length-1,s=0;r>=0;r--,s++)n[s]=this._startIndexes[r],i[s]=this._endIndexes[r];return new Wi(n,i)}else{this._foldingRangesLimit.update(this._length,t);let n=0,i=this._indentOccurrences.length;for(let l=0;l<this._indentOccurrences.length;l++){let d=this._indentOccurrences[l];if(d){if(d+n>t){i=l;break}n+=d}}let r=e.getOptions().tabSize,s=new Uint32Array(t),a=new Uint32Array(t);for(let l=this._length-1,d=0;l>=0;l--){let c=this._startIndexes[l],u=e.getLineContent(c),h=kf(u,r);(h<i||h===i&&n++<t)&&(s[d]=c,a[d]=this._endIndexes[l],d++)}return new Wi(s,a)}}},T8={limit:w8,update:()=>{}};function L8(o,e,t,n=T8){let i=o.getOptions().tabSize,r=new Mk(n),s;t&&(s=new RegExp(`(${t.start.source})|(?:${t.end.source})`));let a=[],l=o.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let d=o.getLineCount();d>0;d--){let c=o.getLineContent(d),u=kf(c,i),h=a[a.length-1];if(u===-1){e&&(h.endAbove=d);continue}let m;if(s&&(m=c.match(s)))if(m[1]){let g=a.length-1;for(;g>0&&a[g].indent!==-2;)g--;if(g>0){a.length=g+1,h=a[g],r.insertFirst(d,h.line,u),h.line=d,h.indent=u,h.endAbove=d;continue}}else{a.push({indent:-2,endAbove:d,line:d});continue}if(h.indent>u){do a.pop(),h=a[a.length-1];while(h.indent>u);let g=h.endAbove-1;g-d>=1&&r.insertFirst(d,g,u)}h.indent===u?h.endAbove=d:a.push({indent:u,endAbove:d,line:d})}return r.toIndentRanges(o)}var D8=I("editor.foldBackground",{light:de(ul,.3),dark:de(ul,.3),hcDark:null,hcLight:null},p("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);I("editor.foldPlaceholderForeground",{light:"#808080",dark:"#808080",hcDark:null,hcLight:null},p("collapsedTextColor","Color of the collapsed text after the first line of a folded range."));I("editorGutter.foldingControlForeground",Uc,p("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));var Ak=Ld("folding-expanded",ue.chevronDown,p("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),Ok=Ld("folding-collapsed",ue.chevronRight,p("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),ZV=Ld("folding-manual-collapsed",Ok,p("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),XV=Ld("folding-manual-expanded",Ak,p("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),Nk={color:CO(D8),position:1},Lm=p("linesCollapsed","Click to expand the range."),bw=p("linesExpanded","Click to collapse the range."),vw=class o{constructor(e){this.editor=e}static COLLAPSED_VISUAL_DECORATION=Gt.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:Lm,firstLineDecorationClassName:Xe.asClassName(Ok)});static COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=Gt.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:Nk,isWholeLine:!0,linesDecorationsTooltip:Lm,firstLineDecorationClassName:Xe.asClassName(Ok)});static MANUALLY_COLLAPSED_VISUAL_DECORATION=Gt.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:Lm,firstLineDecorationClassName:Xe.asClassName(ZV)});static MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=Gt.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:Nk,isWholeLine:!0,linesDecorationsTooltip:Lm,firstLineDecorationClassName:Xe.asClassName(ZV)});static NO_CONTROLS_COLLAPSED_RANGE_DECORATION=Gt.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:Lm});static NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=Gt.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:Nk,isWholeLine:!0,linesDecorationsTooltip:Lm});static EXPANDED_VISUAL_DECORATION=Gt.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Xe.asClassName(Ak),linesDecorationsTooltip:bw});static EXPANDED_AUTO_HIDE_VISUAL_DECORATION=Gt.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:Xe.asClassName(Ak),linesDecorationsTooltip:bw});static MANUALLY_EXPANDED_VISUAL_DECORATION=Gt.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Xe.asClassName(XV),linesDecorationsTooltip:bw});static MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=Gt.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:Xe.asClassName(XV),linesDecorationsTooltip:bw});static NO_CONTROLS_EXPANDED_RANGE_DECORATION=Gt.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0});static HIDDEN_RANGE_DECORATION=Gt.register({description:"folding-hidden-range-decoration",stickiness:1});showFoldingControls="mouseover";showFoldingHighlights=!0;getDecorationOption(e,t,n){return t?o.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?e?this.showFoldingHighlights?o.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:o.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:o.NO_CONTROLS_EXPANDED_RANGE_DECORATION:e?n?this.showFoldingHighlights?o.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:o.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?o.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:o.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?n?o.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:o.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:n?o.MANUALLY_EXPANDED_VISUAL_DECORATION:o.EXPANDED_VISUAL_DECORATION}changeDecorations(e){return this.editor.changeDecorations(e)}removeDecorations(e){this.editor.removeDecorations(e)}};var R8={},k8="syntax",av=class{constructor(e,t,n,i,r){this.editorModel=e;this.providers=t;this.handleFoldingRangesChange=n;this.foldingRangesLimit=i;this.fallbackRangeProvider=r;this.disposables=new oe,r&&this.disposables.add(r);for(let s of t)typeof s.onDidChange=="function"&&this.disposables.add(s.onDidChange(n))}id=k8;disposables;compute(e){return M8(this.providers,this.editorModel,e).then(t=>t?N8(t,this.foldingRangesLimit):this.fallbackRangeProvider?.compute(e)??null)}dispose(){this.disposables.dispose()}};function M8(o,e,t){let n=null,i=o.map((r,s)=>Promise.resolve(r.provideFoldingRanges(e,R8,t)).then(a=>{if(!t.isCancellationRequested&&Array.isArray(a)){Array.isArray(n)||(n=[]);let l=e.getLineCount();for(let d of a)d.start>0&&d.end>d.start&&d.end<=l&&n.push({start:d.start,end:d.end,rank:s,kind:d.kind})}},Xu));return Promise.all(i).then(r=>n)}var Pk=class{_startIndexes;_endIndexes;_nestingLevels;_nestingLevelCounts;_types;_length;_foldingRangesLimit;constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,n,i){if(e>Hr||t>Hr)return;let r=this._length;this._startIndexes[r]=e,this._endIndexes[r]=t,this._nestingLevels[r]=i,this._types[r]=n,this._length++,i<30&&(this._nestingLevelCounts[i]=(this._nestingLevelCounts[i]||0)+1)}toIndentRanges(){let e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);let t=new Uint32Array(this._length),n=new Uint32Array(this._length);for(let i=0;i<this._length;i++)t[i]=this._startIndexes[i],n[i]=this._endIndexes[i];return new Wi(t,n,this._types)}else{this._foldingRangesLimit.update(this._length,e);let t=0,n=this._nestingLevelCounts.length;for(let a=0;a<this._nestingLevelCounts.length;a++){let l=this._nestingLevelCounts[a];if(l){if(l+t>e){n=a;break}t+=l}}let i=new Uint32Array(e),r=new Uint32Array(e),s=[];for(let a=0,l=0;a<this._length;a++){let d=this._nestingLevels[a];(d<n||d===n&&t++<e)&&(i[l]=this._startIndexes[a],r[l]=this._endIndexes[a],s[l]=this._types[a],l++)}return new Wi(i,r,s)}}};function N8(o,e){let t=o.sort((s,a)=>{let l=s.start-a.start;return l===0&&(l=s.rank-a.rank),l}),n=new Pk(e),i,r=[];for(let s of t)if(!i)i=s,n.add(s.start,s.end,s.kind&&s.kind.value,r.length);else if(s.start>i.start)if(s.end<=i.end)r.push(i),i=s,n.add(s.start,s.end,s.kind&&s.kind.value,r.length);else{if(s.start>i.end){do i=r.pop();while(i&&s.start>i.end);i&&r.push(i),i=s}n.add(s.start,s.end,s.kind&&s.kind.value,r.length)}return n.toIndentRanges()}var di=new De("foldingEnabled",!1),Co=class extends B{constructor(t,n,i,r,s,a){super();this.contextKeyService=n;this.languageConfigurationService=i;this.languageFeaturesService=a;this.editor=t,this._foldingLimitReporter=new Fk(t);let l=this.editor.getOptions();this._isEnabled=l.get(44),this._useFoldingProviders=l.get(45)!=="indentation",this._unfoldOnClickAfterEndOfLine=l.get(49),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=l.get(47),this.updateDebounceInfo=s.for(a.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new vw(t),this.foldingDecorationProvider.showFoldingControls=l.get(112),this.foldingDecorationProvider.showFoldingHighlights=l.get(46),this.foldingEnabled=di.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(d=>{if(d.hasChanged(44)&&(this._isEnabled=this.editor.getOptions().get(44),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),d.hasChanged(48)&&this.onModelChanged(),d.hasChanged(112)||d.hasChanged(46)){let c=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=c.get(112),this.foldingDecorationProvider.showFoldingHighlights=c.get(46),this.triggerFoldingModelChanged()}d.hasChanged(45)&&(this._useFoldingProviders=this.editor.getOptions().get(45)!=="indentation",this.onFoldingStrategyChanged()),d.hasChanged(49)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(49)),d.hasChanged(47)&&(this._foldingImportsByDefault=this.editor.getOptions().get(47))})),this.onModelChanged()}static ID="editor.contrib.folding";static get(t){return t.getContribution(Co.ID)}static _foldingRangeSelector;static getFoldingRangeProviders(t,n){let i=t.foldingRangeProvider.ordered(n);return Co._foldingRangeSelector?.(i,n)??i}static setFoldingRangeProviderSelector(t){return Co._foldingRangeSelector=t,{dispose:()=>{Co._foldingRangeSelector=void 0}}}editor;_isEnabled;_useFoldingProviders;_unfoldOnClickAfterEndOfLine;_restoringViewState;_foldingImportsByDefault;_currentModelHasFoldedImports;foldingDecorationProvider;foldingModel;hiddenRangeModel;rangeProvider;foldingRegionPromise;foldingModelPromise;updateScheduler;updateDebounceInfo;foldingEnabled;cursorChangedScheduler;localToDispose=this._register(new oe);mouseDownInfo;_foldingLimitReporter;get limitReporter(){return this._foldingLimitReporter}saveViewState(){let t=this.editor.getModel();if(!t||!this._isEnabled||t.isTooLargeForTokenization())return{};if(this.foldingModel){let n=this.foldingModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:n,lineCount:t.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(t){let n=this.editor.getModel();if(!(!n||!this._isEnabled||n.isTooLargeForTokenization()||!this.hiddenRangeModel)&&t&&(this._currentModelHasFoldedImports=!!t.foldedImports,t.collapsedRegions&&t.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(t.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();let t=this.editor.getModel();!this._isEnabled||!t||t.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new pw(t,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new fw(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(n=>this.onHiddenRangesChanges(n))),this.updateScheduler=new fs(this.updateDebounceInfo.get(t)),this.cursorChangedScheduler=new Yt(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(n=>this.onDidChangeModelContent(n))),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(n=>this.onEditorMouseDown(n))),this.localToDispose.add(this.editor.onMouseUp(n=>this.onEditorMouseUp(n))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.updateScheduler?.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.rangeProvider?.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){this.rangeProvider?.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(t){if(this.rangeProvider)return this.rangeProvider;let n=new sv(t,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=n,this._useFoldingProviders&&this.foldingModel){let i=Co.getFoldingRangeProviders(this.languageFeaturesService,t);i.length>0&&(this.rangeProvider=new av(t,i,()=>this.triggerFoldingModelChanged(),this._foldingLimitReporter,n))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(t){this.hiddenRangeModel?.notifyChangeModelContent(t),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{let t=this.foldingModel;if(!t)return null;let n=new Ja,i=this.getRangeProvider(t.textModel),r=this.foldingRegionPromise=la(s=>i.compute(s));return r.then(s=>{if(s&&r===this.foldingRegionPromise){let a;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){let c=s.setCollapsedAllOfType(Cd.Imports.value,!0);c&&(a=Hu.capture(this.editor),this._currentModelHasFoldedImports=c)}let l=this.editor.getSelections();t.update(s,A8(l)),a?.restore(this.editor);let d=this.updateDebounceInfo.update(t.textModel,n.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=d)}return t})}).then(void 0,t=>(Ne(t),null)))}onHiddenRangesChanges(t){if(this.hiddenRangeModel&&t.length&&!this._restoringViewState){let n=this.editor.getSelections();n&&this.hiddenRangeModel.adjustSelections(n)&&this.editor.setSelections(n)}this.editor.setHiddenAreas(t,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){let t=this.getFoldingModel();t&&t.then(n=>{if(n){let i=this.editor.getSelections();if(i&&i.length>0){let r=[];for(let s of i){let a=s.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(a)&&r.push(...n.getAllRegionsAtLine(a,l=>l.isCollapsed&&a>l.startLineNumber))}r.length&&(n.toggleCollapseState(r),this.reveal(i[0].getPosition()))}}}).then(void 0,Ne)}onEditorMouseDown(t){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!t.target||!t.target.range||!t.event.leftButton&&!t.event.middleButton)return;let n=t.target.range,i=!1;switch(t.target.type){case 4:{let r=t.target.detail,s=t.target.element.offsetLeft;if(r.offsetX-s<4)return;i=!0;break}case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!t.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){let r=this.editor.getModel();if(r&&n.startColumn===r.getLineMaxColumn(n.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:n.startLineNumber,iconClicked:i}}onEditorMouseUp(t){let n=this.foldingModel;if(!n||!this.mouseDownInfo||!t.target)return;let i=this.mouseDownInfo.lineNumber,r=this.mouseDownInfo.iconClicked,s=t.target.range;if(!s||s.startLineNumber!==i)return;if(r){if(t.target.type!==4)return}else{let l=this.editor.getModel();if(!l||s.startColumn!==l.getLineMaxColumn(i))return}let a=n.getRegionAtLine(i);if(a&&a.startLineNumber===i){let l=a.isCollapsed;if(r||l){let d=t.event.altKey,c=[];if(d){let u=m=>!m.containedBy(a)&&!a.containedBy(m),h=n.getRegionsInside(null,u);for(let m of h)m.isCollapsed&&c.push(m);c.length===0&&(c=h)}else{let u=t.event.middleButton||t.event.shiftKey;if(u)for(let h of n.getRegionsInside(a))h.isCollapsed===l&&c.push(h);(l||!u||c.length===0)&&c.push(a)}n.toggleCollapseState(c),this.reveal({lineNumber:i,column:1})}}}reveal(t){this.editor.revealPositionInCenterIfOutsideViewport(t,0)}};Co=k([E(1,Qt),E(2,Rr),E(3,eo),E(4,ov),E(5,Al)],Co);var Fk=class{constructor(e){this.editor=e}get limit(){return this.editor.getOptions().get(48)}_onDidChange=new T;onDidChange=this._onDidChange.event;_computed=0;_limited=!1;get computed(){return this._computed}get limited(){return this._limited}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}},ti=class extends qd{runEditorCommand(e,t,n){let i=e.get(Rr),r=Co.get(t);if(!r)return;let s=r.getFoldingModel();if(s)return this.reportTelemetry(e,t),s.then(a=>{if(a){this.invoke(r,a,t,n,i);let l=t.getSelection();l&&r.reveal(l.getStartPosition())}})}getSelectedLines(e){let t=e.getSelections();return t?t.map(n=>n.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(n=>n+1):this.getSelectedLines(t)}run(e,t){}};function A8(o){return!o||o.length===0?{startsInside:()=>!1}:{startsInside(e,t){for(let n of o){let i=n.startLineNumber;if(i>=e&&i<=t)return!0}return!1}}}function QV(o){if(!an(o)){if(!hn(o))return!1;let e=o;if(!an(e.levels)&&!mi(e.levels)||!an(e.direction)&&!sn(e.direction)||!an(e.selectionLines)&&(!Array.isArray(e.selectionLines)||!e.selectionLines.every(mi)))return!1}return!0}var Bk=class extends ti{constructor(){super({id:"editor.unfold",label:p("unfoldAction.label","Unfold"),alias:"Unfold",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},metadata:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:QV,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,n,i){let r=i&&i.levels||1,s=this.getLineNumbers(i,n);i&&i.direction==="up"?Rk(t,!1,r,s):Uu(t,!1,r,s)}},Vk=class extends ti{constructor(){super({id:"editor.unfoldRecursively",label:p("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2142),weight:100}})}invoke(e,t,n,i){Uu(t,!1,Number.MAX_VALUE,this.getSelectedLines(n))}},Wk=class extends ti{constructor(){super({id:"editor.fold",label:p("foldAction.label","Fold"),alias:"Fold",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},metadata:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:QV,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,n,i){let r=this.getLineNumbers(i,n),s=i&&i.levels,a=i&&i.direction;typeof s!="number"&&typeof a!="string"?KV(t,!0,r):a==="up"?Rk(t,!0,s||1,r):Uu(t,!0,s||1,r)}},Hk=class extends ti{constructor(){super({id:"editor.toggleFold",label:p("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2090),weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);Dk(t,1,i)}},Uk=class extends ti{constructor(){super({id:"editor.foldRecursively",label:p("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2140),weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);Uu(t,!0,Number.MAX_VALUE,i)}},zk=class extends ti{constructor(){super({id:"editor.toggleFoldRecursively",label:p("toggleFoldRecursivelyAction.label","Toggle Fold Recursively"),alias:"Toggle Fold Recursively",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,3114),weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);Dk(t,Number.MAX_VALUE,i)}},Kk=class extends ti{constructor(){super({id:"editor.foldAllBlockComments",label:p("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2138),weight:100}})}invoke(e,t,n,i,r){if(t.regions.hasTypes())gw(t,Cd.Comment.value,!0);else{let s=n.getModel();if(!s)return;let a=r.getLanguageConfiguration(s.getLanguageId()).comments;if(a&&a.blockCommentStartToken){let l=new RegExp("^\\s*"+Gi(a.blockCommentStartToken));mw(t,l,!0)}}}},Gk=class extends ti{constructor(){super({id:"editor.foldAllMarkerRegions",label:p("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2077),weight:100}})}invoke(e,t,n,i,r){if(t.regions.hasTypes())gw(t,Cd.Region.value,!0);else{let s=n.getModel();if(!s)return;let a=r.getLanguageConfiguration(s.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){let l=new RegExp(a.markers.start);mw(t,l,!0)}}}},jk=class extends ti{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:p("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2078),weight:100}})}invoke(e,t,n,i,r){if(t.regions.hasTypes())gw(t,Cd.Region.value,!1);else{let s=n.getModel();if(!s)return;let a=r.getLanguageConfiguration(s.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){let l=new RegExp(a.markers.start);mw(t,l,!1)}}}},$k=class extends ti{constructor(){super({id:"editor.foldAllExcept",label:p("foldAllExcept.label","Fold All Except Selected"),alias:"Fold All Except Selected",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2136),weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);kk(t,!0,i)}},qk=class extends ti{constructor(){super({id:"editor.unfoldAllExcept",label:p("unfoldAllExcept.label","Unfold All Except Selected"),alias:"Unfold All Except Selected",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2134),weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);kk(t,!1,i)}},Yk=class extends ti{constructor(){super({id:"editor.foldAll",label:p("foldAllAction.label","Fold All"),alias:"Fold All",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2069),weight:100}})}invoke(e,t,n){Uu(t,!0)}},Zk=class extends ti{constructor(){super({id:"editor.unfoldAll",label:p("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2088),weight:100}})}invoke(e,t,n){Uu(t,!1)}},yw=class o extends ti{static ID_PREFIX="editor.foldLevel";static ID=e=>o.ID_PREFIX+e;getFoldingLevel(){return parseInt(this.id.substr(o.ID_PREFIX.length))}invoke(e,t,n){GV(t,this.getFoldingLevel(),!0,this.getSelectedLines(n))}},Xk=class extends ti{constructor(){super({id:"editor.gotoParentFold",label:p("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);if(i.length>0){let r=jV(i[0],t);r!==null&&n.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}},Qk=class extends ti{constructor(){super({id:"editor.gotoPreviousFold",label:p("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);if(i.length>0){let r=$V(i[0],t);r!==null&&n.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}},Jk=class extends ti{constructor(){super({id:"editor.gotoNextFold",label:p("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);if(i.length>0){let r=qV(i[0],t);r!==null&&n.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}},eM=class extends ti{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:p("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2135),weight:100}})}invoke(e,t,n){let i=[],r=n.getSelections();if(r){for(let s of r){let a=s.endLineNumber;s.endColumn===1&&--a,a>s.startLineNumber&&(i.push({startLineNumber:s.startLineNumber,endLineNumber:a,type:void 0,isCollapsed:!0,source:1}),n.setSelection({startLineNumber:s.startLineNumber,startColumn:1,endLineNumber:s.startLineNumber,endColumn:1}))}if(i.length>0){i.sort((a,l)=>a.startLineNumber-l.startLineNumber);let s=Wi.sanitizeAndMerge(t.regions,i,n.getModel()?.getLineCount());t.updatePost(Wi.fromFoldRanges(s))}}}},tM=class extends ti{constructor(){super({id:"editor.removeManualFoldingRanges",label:p("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2137),weight:100}})}invoke(e,t,n){let i=n.getSelections();if(i){let r=[];for(let s of i){let{startLineNumber:a,endLineNumber:l}=s;r.push(l>=a?{startLineNumber:a,endLineNumber:l}:{endLineNumber:l,startLineNumber:a})}t.removeManualRanges(r),e.triggerFoldingModelChanged()}}};Yd(Co.ID,Co,0);kn(Bk);kn(Vk);kn(Wk);kn(Uk);kn(zk);kn(Yk);kn(Zk);kn(Kk);kn(Gk);kn(jk);kn($k);kn(qk);kn(Hk);kn(Xk);kn(Qk);kn(Jk);kn(eM);kn(tM);for(let o=1;o<=7;o++)aV(new yw({id:yw.ID(o),label:p("foldLevelAction.label","Fold Level {0}",o),alias:`Fold Level ${o}`,precondition:di,kbOpts:{kbExpr:ae.editorTextFocus,primary:Do(2089,2048|21+o),weight:100}}));$i.registerCommand("_executeFoldingRangeProvider",async function(o,...e){let[t]=e;if(!(t instanceof ne))throw as();let n=o.get(Al),i=o.get(kr).getModel(t);if(!i)throw as();let r=o.get(rt);if(!r.getValue("editor.folding",{resource:t}))return[];let s=o.get(Rr),a=r.getValue("editor.foldingStrategy",{resource:t}),l={get limit(){return r.getValue("editor.foldingMaximumRegions",{resource:t})},update:(m,g)=>{}},d=new sv(i,s,l),c=d;if(a!=="indentation"){let m=Co.getFoldingRangeProviders(n,i);m.length&&(c=new av(i,m,()=>{},l,d))}let u=await c.compute(Xt.None),h=[];try{if(u)for(let m=0;m<u.length;m++){let g=u.getType(m);h.push({start:u.getStartLineNumber(m),end:u.getEndLineNumber(m),kind:g?Cd.fromValue(g):void 0})}return h}finally{c.dispose()}});var nM=class extends wr{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(e,t){super(),this._element=zt(e,je(".monaco-dropdown")),this._label=zt(this._element,je(".dropdown-label"));let n=t.labelRenderer;n||(n=r=>(r.textContent=t.label||"",null));for(let r of[me.CLICK,me.MOUSE_DOWN,yt.Tap])this._register(z(this.element,r,s=>Qe.stop(s,!0)));for(let r of[me.MOUSE_DOWN,yt.Tap])this._register(z(this._label,r,s=>{qC(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(z(this._label,me.KEY_UP,r=>{let s=new vt(r);(s.equals(3)||s.equals(10))&&(Qe.stop(r,!0),this.visible?this.hide():this.show())}));let i=n(this._label);i&&this._register(i),this._register(Ln.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(e){this._label&&(!this.hover&&e!==""?this.hover=this._register(Fr().setupManagedHover(Uo("mouse"),this._label,e)):this.hover&&this.hover.update(e))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(e,t){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},Iw=class extends nM{constructor(t,n){super(t,n);this._options=n;this.actions=n.actions||[]}_menuOptions;_actions=[];set menuOptions(t){this._menuOptions=t}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(t){this._actions=t}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(t,n)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(t,n):void 0,getKeyBinding:t=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(t):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var ec=class extends io{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(e,t,n,i=Object.create(null)){super(null,e,i),this.menuActionsOrProvider=t,this.contextMenuProvider=n,this.options=i,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;let t=r=>{this.element=zt(r,je("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(Fr().setupManagedHover(this.options.hoverDelegate??Uo("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},n=Array.isArray(this.menuActionsOrProvider),i={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:n?this.menuActionsOrProvider:void 0,actionProvider:n?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new Iw(e,i)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{this.element?.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){let e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}};var Cw=class extends B{options;actionBar;toggleMenuAction;toggleMenuActionViewItem;submenuActionViewItems=[];hasSecondaryActions=!1;element;_onDidChangeDropdownVisibility=this._register(new yg);onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event;disposables=this._register(new oe);constructor(e,t,n={orientation:0}){super(),n.hoverDelegate=n.hoverDelegate??this._register(ou()),this.options=n,this.toggleMenuAction=this._register(new Dm(()=>this.toggleMenuActionViewItem?.show(),n.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new Aa(this.element,{orientation:n.orientation,ariaLabel:n.ariaLabel,actionRunner:n.actionRunner,allowContextMenu:n.allowContextMenu,highlightToggledItems:n.highlightToggledItems,hoverDelegate:n.hoverDelegate,actionViewItemProvider:(i,r)=>{if(i.id===Dm.ID)return this.toggleMenuActionViewItem=new ec(i,i.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Xe.asClassNameArray(n.moreIcon??ue.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(n.actionViewItemProvider){let s=n.actionViewItemProvider(i,r);if(s)return s}if(i instanceof el){let s=new ec(i,i.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:i.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return s.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(s),this.disposables.add(this._onDidChangeDropdownVisibility.add(s.onDidChangeVisibility)),s}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){this.actionBar.context=e,this.toggleMenuActionViewItem?.setActionContext(e);for(let t of this.submenuActionViewItems)t.setActionContext(e)}getElement(){return this.element}focus(){this.actionBar.focus()}getItemsWidth(){let e=0;for(let t=0;t<this.actionBar.length();t++)e+=this.actionBar.getWidth(t);return e}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}getItemsLength(){return this.actionBar.length()}setAriaLabel(e){this.actionBar.setAriaLabel(e)}setActions(e,t){this.clear();let n=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),n.push(this.toggleMenuAction)),n.forEach(i=>{this.actionBar.push(i,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(i)})})}isEmpty(){return this.actionBar.isEmpty()}getKeybindingLabel(e){return this.options.getKeyBinding?.(e)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}},Dm=class o extends Er{static ID="toolbar.toggle.more";_menuActions;toggleDropdownMenu;constructor(e,t){t=t||p("moreActions","More Actions..."),super(o.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};var Rm=class{modifierLabels;constructor(e,t,n=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=n}toLabel(e,t,n){if(t.length===0)return null;let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=n(a);if(l===null)return null;i[r]=F8(a,l,this.modifierLabels[e])}return i.join(" ")}},iM=new Rm({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:p({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:p({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:p({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:p({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),Q5t=new Rm({ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:p({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),J5t=new Rm({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),eUt=new Rm({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function F8(o,e,t){if(e===null)return"";let n=[];return o.ctrlKey&&n.push(t.ctrlKey),o.shiftKey&&n.push(t.shiftKey),o.altKey&&n.push(t.altKey),o.metaKey&&n.push(t.metaKey),e!==""&&n.push(e),n.join(t.separator)}var JV=Z("contextViewService"),Vl=Z("contextMenuService");var azt={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:W.white.toString(),buttonForeground:W.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0};var Y7t=p("caseDescription","Match Case"),Z7t=p("wordsDescription","Match Whole Word"),X7t=p("regexDescription","Use Regular Expression");var _9t=p("defaultLabel","input");var J6t={keybindingLabelBackground:se(yP),keybindingLabelForeground:se(IP),keybindingLabelBorder:se(CP),keybindingLabelBottomBorder:se(SP),keybindingLabelShadow:se(Yh)};var eKt={buttonForeground:se(wD),buttonSeparator:se(lP),buttonBackground:se(Zh),buttonHoverBackground:se(dP),buttonSecondaryForeground:se(uP),buttonSecondaryBackground:se(OI),buttonSecondaryHoverBackground:se(hP),buttonBorder:se(cP)};var tKt={progressBarBackground:se(RO)};var oM={inputActiveOptionBorder:se(SD),inputActiveOptionForeground:se(ED),inputActiveOptionBackground:se(xD)},nKt={activeForeground:se(Xh),activeBackground:se(pP),activeBorder:se(mP),inactiveForeground:se(gP),inactiveBackground:se(fP),inactiveBorder:se(bP),inactiveHoverBackground:se(vP)};var iKt={checkboxBackground:se(PI),checkboxBorder:se(BI),checkboxForeground:se(FI)};var oKt={dialogBackground:se(yi),dialogForeground:se(fa),dialogShadow:se(Yh),dialogBorder:se(ve),errorIconForeground:se(jO),warningIconForeground:se($O),infoIconForeground:se(qO),textLinkForeground:se(kI)};var W8={inputBackground:se(Df),inputForeground:se(Rf),inputBorder:se(hl),inputValidationInfoBorder:se(eP),inputValidationInfoBackground:se(QO),inputValidationInfoForeground:se(JO),inputValidationWarningBorder:se(iP),inputValidationWarningBackground:se(tP),inputValidationWarningForeground:se(nP),inputValidationErrorBorder:se(sP),inputValidationErrorBackground:se(oP),inputValidationErrorForeground:se(rP)};var rKt={listFilterWidgetBackground:se(AP),listFilterWidgetOutline:se(OP),listFilterWidgetNoMatchesOutline:se(PP),listFilterWidgetShadow:se(FP),inputBoxStyles:W8,toggleStyles:oM},sKt={badgeBackground:se(Kh),badgeForeground:se(DO),badgeBorder:se(ve)};var aKt={breadcrumbsBackground:se(zO),breadcrumbsForeground:se(UO),breadcrumbsHoverForeground:se(yD),breadcrumbsFocusForeground:se(yD),breadcrumbsFocusAndSelectionForeground:se(KO)};var lKt={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:se(xP),listFocusForeground:se(EP),listFocusOutline:se(wP),listActiveSelectionBackground:se(Mo),listActiveSelectionForeground:se(ba),listActiveSelectionIconForeground:se(WI),listFocusAndSelectionOutline:se(_P),listFocusAndSelectionBackground:se(Mo),listFocusAndSelectionForeground:se(ba),listInactiveSelectionBackground:se(TP),listInactiveSelectionIconForeground:se(DP),listInactiveSelectionForeground:se(LP),listInactiveFocusBackground:se(RP),listInactiveFocusOutline:se(kP),listHoverBackground:se(Nd),listHoverForeground:se(_D),listDropOverBackground:se(MP),listDropBetweenBackground:se(NP),listSelectionOutline:se(wt),listHoverOutline:se(wt),treeIndentGuidesStroke:se(Qh),treeInactiveIndentGuidesStroke:se(BP),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:se(Rd),tableColumnsBorder:se(VP),tableOddRowsBackgroundColor:se(WP)};var eW={selectBackground:se(Md),selectListBackground:se(aP),selectForeground:se(Kc),decoratorRightForeground:se(YP),selectBorder:se(Gc),focusBorder:se(vi),listFocusBackground:se(QP),listInactiveSelectionIconForeground:se(XP),listFocusForeground:se(ZP),listFocusOutline:wO(wt,W.transparent.toString()),listHoverBackground:se(Nd),listHoverForeground:se(_D),listHoverOutline:se(wt),selectListBorder:se(Tf),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var dKt={shadowColor:se(Yh),borderColor:se(HP),foregroundColor:se(UP),backgroundColor:se(zP),selectionForegroundColor:se(KP),selectionBackgroundColor:se(GP),selectionBorderColor:se(jP),separatorColor:se($P),scrollbarShadow:se(Rd),scrollbarSliderBackground:se(MI),scrollbarSliderHoverBackground:se(NI),scrollbarSliderActiveBackground:se(AI)};function tW(o,e,t,n,i,r){let s,a,l,d,c;if(Array.isArray(o))c=o,s=e,a=t,l=n,d=i;else{let h=e;c=o.getActions(h),s=t,a=n,l=i,d=r}H8(c,s,!1,typeof a=="string"?h=>h===a:a,l,d)}function H8(o,e,t,n=s=>s==="navigation",i=()=>!1,r=!1){let s,a;Array.isArray(e)?(s=e,a=e):(s=e.primary,a=e.secondary);let l=new Set;for(let[d,c]of o){let u;n(d)?(u=s,u.length>0&&r&&u.push(new jn)):(u=a,u.length>0&&u.push(new jn));for(let h of c){t&&(h=h instanceof co&&h.alt?h.alt:h);let m=u.push(h);h instanceof el&&l.add({group:d,action:h,index:m-1})}}for(let{group:d,action:c,index:u}of l){let h=n(d)?s:a,m=c.actions;i(c,d,h.length)&&h.splice(u,1,...m)}}var km=class extends Gd{constructor(t,n,i,r,s,a,l,d){super(void 0,t,{icon:!!(t.class||t.item.icon),label:!t.class&&!t.item.icon,draggable:n?.draggable,keybinding:n?.keybinding,hoverDelegate:n?.hoverDelegate});this._options=n;this._keybindingService=i;this._notificationService=r;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=Ip.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new rn);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(t){t.preventDefault(),t.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(n){this._notificationService.error(n)}}render(t){if(super.render(t),t.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let n=!1,i=()=>{let r=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||n)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&n);r!==this._wantsAltCommand&&(this._wantsAltCommand=r,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(z(t,"mouseleave",r=>{n=!1,i()})),this._register(z(t,"mouseenter",r=>{n=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),n=t&&t.getLabel(),i=this._commandAction.tooltip||this._commandAction.label,r=n?p("titleAndKb","{0} ({1})",i,n):i;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?p("titleAndKb","{0} ({1})",s,l):s;r=p("titleAndKbAndAlt",`{0}
[{1}] {2}`,r,iM.modifierLabels[Zs].altKey,d)}return r}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(t){this._itemClassDispose.value=void 0;let{element:n,label:i}=this;if(!n||!i)return;let r=this._commandAction.checked&&VN(t.toggled)&&t.toggled.icon?t.toggled.icon:t.icon;if(r)if(Xe.isThemeIcon(r)){let s=Xe.asClassNameArray(r);i.classList.add(...s),this._itemClassDispose.value=pe(()=>{i.classList.remove(...s)})}else i.style.backgroundImage=hD(this._themeService.getColorTheme().type)?ab(r.dark):ab(r.light),i.classList.add("icon"),this._itemClassDispose.value=Zo(pe(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};km=k([E(2,to),E(3,eo),E(4,Qt),E(5,xs),E(6,Vl),E(7,Jo)],km);var Sw=class extends ec{constructor(t,n,i,r,s){let a={...n,menuAsChild:n?.menuAsChild??!1,classNames:n?.classNames??(Xe.isThemeIcon(t.item.icon)?Xe.asClassName(t.item.icon):void 0),keybindingProvider:n?.keybindingProvider??(l=>i.lookupKeybinding(l.id))};super(t,{getActions:()=>t.actions},r,a);this._keybindingService=i;this._contextMenuService=r;this._themeService=s}render(t){super.render(t),tl(this.element),t.classList.add("menu-entry");let n=this._action,{icon:i}=n.item;if(i&&!Xe.isThemeIcon(i)){this.element.classList.add("icon");let r=()=>{this.element&&(this.element.style.backgroundImage=hD(this._themeService.getColorTheme().type)?ab(i.dark):ab(i.light))};r(),this._register(this._themeService.onDidColorThemeChange(()=>{r()}))}}};Sw=k([E(2,to),E(3,Vl),E(4,xs)],Sw);var xw=class extends io{constructor(t,n,i,r,s,a,l,d){super(null,t);this._keybindingService=i;this._notificationService=r;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=n,this._storageKey=`${t.item.submenu.id}_lastActionId`;let c,u=n?.persistLastActionId?d.get(this._storageKey,1):void 0;u&&(c=t.actions.find(m=>u===m.id)),c||(c=t.actions[0]),this._defaultAction=this._instaService.createInstance(km,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let h={keybindingProvider:m=>this._keybindingService.lookupKeybinding(m.id),...n,menuAsChild:n?.menuAsChild??!0,classNames:n?.classNames??["codicon","codicon-chevron-down"],actionRunner:n?.actionRunner??new wr};this._dropdown=new ec(t,t.actions,this._contextMenuService,h),this._register(this._dropdown.actionRunner.onDidRun(m=>{m.action instanceof co&&this.update(m.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(t){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,t.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(km,t,{keybinding:this._getDefaultActionKeybindingLabel(t)}),this._defaultAction.actionRunner=new class extends wr{async runAction(n,i){await n.run(void 0)}},this._container&&this._defaultAction.render(z1(this._container,je(".action-container")))}_getDefaultActionKeybindingLabel(t){let n;if(this._options?.renderKeybindingWithDefaultActionLabel){let i=this._keybindingService.lookupKeybinding(t.id);i&&(n=`(${i.getLabel()})`)}return n}setActionContext(t){super.setActionContext(t),this._defaultAction.setActionContext(t),this._dropdown.setActionContext(t)}render(t){this._container=t,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let n=je(".action-container");this._defaultAction.render(zt(this._container,n)),this._register(z(n,me.KEY_DOWN,r=>{let s=new vt(r);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let i=je(".dropdown-action-container");this._dropdown.render(zt(this._container,i)),this._register(z(i,me.KEY_DOWN,r=>{let s=new vt(r);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(t){t?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(t){t?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};xw=k([E(2,to),E(3,eo),E(4,Vl),E(5,Hg),E(6,nt),E(7,In)],xw);var Ew=class extends gS{constructor(e,t){super(null,e,e.actions.map(n=>({text:n.id===jn.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":n.label,isDisabled:!n.enabled})),0,t,eW,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=se(Gc)}runAction(e,t){let n=this.action.actions[t];n&&this.actionRunner.run(n)}};Ew=k([E(1,JV)],Ew);var ww=class{constructor(e,t,n){this._commandService=e;this._keybindingService=t;this._hiddenStates=new Ha(n)}_hiddenStates;createMenu(e,t,n){return new Mm(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t)}getMenuActions(e,t,n){let i=new Mm(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...n},this._commandService,this._keybindingService,t),r=i.getActions(n);return i.dispose(),r}getMenuContexts(e){let t=new _w(e,!1);return new Set([...t.structureContextKeys,...t.preconditionContextKeys,...t.toggledContextKeys])}resetHiddenStates(e){this._hiddenStates.reset(e)}};ww=k([E(0,Lo),E(1,to),E(2,In)],ww);var Ha=class{constructor(e){this._storageService=e;try{let t=e.get(Ha._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,Ha._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{let t=e.get(Ha._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}static _key="menu.hiddenCommands";_disposables=new oe;_onDidChange=new T;onDidChange=this._onDidChange.event;_ignoreChangeEvent=!1;_data;_hiddenByDefaultCache=new Map;dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,n){this._hiddenByDefaultCache.set(`${e.id}/${t}`,n)}isHidden(e,t){let n=this._isHiddenByDefault(e,t),i=this._data[e.id]?.includes(t)??!1;return n?!i:i}updateHidden(e,t,n){this._isHiddenByDefault(e,t)&&(n=!n);let r=this._data[e.id];if(n)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){let s=r.indexOf(t);s>=0&&kM(r,s),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(let{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;let e=JSON.stringify(this._data);this._storageService.store(Ha._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};Ha=k([E(0,In)],Ha);var _w=class o{constructor(e,t){this._id=e;this._collectContextKeysForSubmenus=t;this.refresh()}_menuGroups=[];_allMenuIds=new Set;_structureContextKeys=new Set;_preconditionContextKeys=new Set;_toggledContextKeys=new Set;get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();let e=this._sort(Qo.getMenuItems(this._id)),t;for(let n of e){let i=n.group||"";(!t||t[0]!==i)&&(t=[i,[]],this._menuGroups.push(t)),t[1].push(n),this._collectContextKeysAndSubmenuIds(n)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(o._fillInKbExprKeys(e.when,this._structureContextKeys),gh(e)){if(e.command.precondition&&o._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){let t=e.command.toggled.condition||e.command.toggled;o._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(Qo.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(let n of e.keys())t.add(n)}},Wl=class extends _w{constructor(t,n,i,r,s,a){super(t,i);this._hiddenStates=n;this._commandService=r;this._keybindingService=s;this._contextKeyService=a;this.refresh()}createActionGroups(t){let n=[];for(let i of this._menuGroups){let[r,s]=i,a;for(let l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let d=gh(l);d&&this._hiddenStates.setDefaultState(this._id,l.command.id,!!l.isHiddenByDefault);let c=U8(this._id,d?l.command:l,this._hiddenStates);if(d){let u=rM(this._commandService,this._keybindingService,l.command.id,l.when);(a??=[]).push(new co(l.command,l.alt,t,c,u,this._contextKeyService,this._commandService))}else{let u=new Wl(l.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(t),h=jn.join(...u.map(m=>m[1]));h.length>0&&(a??=[]).push(new il(l,c,h))}}a&&a.length>0&&n.push([r,a])}return n}_sort(t){return t.sort(Wl._compareMenuItems)}static _compareMenuItems(t,n){let i=t.group,r=n.group;if(i!==r){if(i){if(!r)return-1}else return 1;if(i==="navigation")return-1;if(r==="navigation")return 1;let l=i.localeCompare(r);if(l!==0)return l}let s=t.order||0,a=n.order||0;return s<a?-1:s>a?1:Wl._compareTitles(gh(t)?t.command.title:t.title,gh(n)?n.command.title:n.title)}static _compareTitles(t,n){let i=typeof t=="string"?t:t.original,r=typeof n=="string"?n:n.original;return i.localeCompare(r)}};Wl=k([E(3,Lo),E(4,to),E(5,Qt)],Wl);var Mm=class{_menuInfo;_disposables=new oe;_onDidChange;onDidChange;constructor(e,t,n,i,r,s){this._menuInfo=new Wl(e,t,n.emitEventsForSubmenuChanges,i,r,s);let a=new Yt(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},n.eventDebounceDelay);this._disposables.add(a),this._disposables.add(Qo.onDidChangeMenu(u=>{for(let h of this._menuInfo.allMenuIds)if(u.has(h)){a.schedule();break}}));let l=this._disposables.add(new oe),d=u=>{let h=!1,m=!1,g=!1;for(let f of u)if(h=h||f.isStructuralChange,m=m||f.isEnablementChange,g=g||f.isToggleChange,h&&m&&g)break;return{menu:this,isStructuralChange:h,isEnablementChange:m,isToggleChange:g}},c=()=>{l.add(s.onDidChangeContext(u=>{let h=u.affectsSome(this._menuInfo.structureContextKeys),m=u.affectsSome(this._menuInfo.preconditionContextKeys),g=u.affectsSome(this._menuInfo.toggledContextKeys);(h||m||g)&&this._onDidChange.fire({menu:this,isStructuralChange:h,isEnablementChange:m,isToggleChange:g})})),l.add(t.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new zv({onWillAddFirstListener:c,onDidRemoveLastListener:l.clear.bind(l),delay:n.eventDebounceDelay,merge:d}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};Mm=k([E(3,Lo),E(4,to),E(5,Qt)],Mm);function U8(o,e,t){let n=HN(e)?e.submenu.id:e.id,i=typeof e.title=="string"?e.title:e.title.value,r=Ki({id:`hide/${o.id}/${n}`,label:p("hide.label","Hide '{0}'",i),run(){t.updateHidden(o,n,!0)}}),s=Ki({id:`toggle/${o.id}/${n}`,label:i,get checked(){return!t.isHidden(o,n)},run(){t.updateHidden(o,n,!!this.checked)}});return{hide:r,toggle:s,get isHidden(){return!s.checked}}}function rM(o,e,t,n=void 0,i=!0){return Ki({id:`configureKeybinding/${t}`,label:p("configure keybinding","Configure Keybinding"),enabled:i,run(){let s=!!!e.lookupKeybinding(t)&&n?n.serialize():void 0;o.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(s?` +when:${s}`:""))}})}var lv=class extends Cw{constructor(t,n,i,r,s,a,l,d){super(t,s,{getKeyBinding:u=>a.lookupKeybinding(u.id)??void 0,...n,allowContextMenu:!0,skipTelemetry:typeof n?.telemetrySource=="string"});this._options=n;this._menuService=i;this._contextKeyService=r;this._contextMenuService=s;this._keybindingService=a;this._commandService=l;let c=n?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(u=>d.publicLog2("workbenchActionExecuted",{id:u.action.id,from:c})))}_sessionDisposables=this._store.add(new oe);setActions(t,n=[],i){this._sessionDisposables.clear();let r=t.slice(),s=n.slice(),a=[],l=0,d=[],c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let u=0;u<r.length;u++){let h=r[u];!(h instanceof co)&&!(h instanceof il)||h.hideActions&&(a.push(h.hideActions.toggle),h.hideActions.toggle.checked&&l++,h.hideActions.isHidden&&(c=!0,r[u]=void 0,this._options?.hiddenItemStrategy!==0&&(d[u]=h)))}if(this._options?.overflowBehavior!==void 0){let u=AM(new Set(this._options.overflowBehavior.exempted),Yo.map(r,g=>g?.id)),h=this._options.overflowBehavior.maxItems-u.size,m=0;for(let g=0;g<r.length;g++){let f=r[g];f&&(m++,!u.has(f.id)&&m>=h&&(r[g]=void 0,d[g]=f))}}v_(r),v_(d),super.setActions(r,jn.join(d,s)),(a.length>0||r.length>0)&&this._sessionDisposables.add(z(this.getElement(),"contextmenu",u=>{let h=new Fi(Ce(this.getElement()),u),m=this.getItemAction(h.target);if(!m)return;h.preventDefault(),h.stopPropagation();let g=[];if(m instanceof co&&m.menuKeybinding)g.push(m.menuKeybinding);else if(!(m instanceof il||m instanceof Dm)){let b=!!this._keybindingService.lookupKeybinding(m.id);g.push(rM(this._commandService,this._keybindingService,m.id,void 0,b))}if(a.length>0){let b=!1;if(l===1&&this._options?.hiddenItemStrategy===0){b=!0;for(let y=0;y<a.length;y++)if(a[y].checked){a[y]=Ki({id:m.id,label:m.label,checked:!0,enabled:!1,run(){}});break}}if(!b&&(m instanceof co||m instanceof il)){if(!m.hideActions)return;g.push(m.hideActions.hide)}else g.push(Ki({id:"label",label:p("hide","Hide"),enabled:!1,run(){}}))}let f=jn.join(g,a);this._options?.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(f.push(new jn),f.push(Ki({id:"resetThisMenu",label:p("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),f.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>h,getActions:()=>f,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};lv=k([E(2,Hg),E(3,Qt),E(4,Vl),E(5,to),E(6,Lo),E(7,Ao)],lv);var Nm=class extends lv{_onDidChangeMenuItems=this._store.add(new T);onDidChangeMenuItems=this._onDidChangeMenuItems.event;constructor(e,t,n,i,r,s,a,l,d){super(e,{resetMenu:t,...n},i,r,s,a,l,d);let c=this._store.add(i.createMenu(t,r,{emitEventsForSubmenuChanges:!0})),u=()=>{let h=[],m=[];tW(c,n?.menuOptions,{primary:h,secondary:m},n?.toolbarOptions?.primaryGroup,n?.toolbarOptions?.shouldInlineSubmenu,n?.toolbarOptions?.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",h.length===0&&m.length===0),super.setActions(h,m)};this._store.add(c.onDidChange(()=>{u(),this._onDidChangeMenuItems.fire(this)})),u()}setActions(){throw new Te("This toolbar is populated from a menu.")}};Nm=k([E(3,Hg),E(4,Qt),E(5,Vl),E(6,to),E(7,Lo),E(8,Ao)],Nm);var tc=class extends B{constructor(t,n,i){super();this.instantiationService=t;this.viewModel=n;this.configurationService=i}model=this.viewModel.map(t=>t?.model);htmlElements=pn("div.code-view",[pn("div.header@header",[pn("span.title@title"),pn("span.description@description"),pn("span.detail@detail"),pn("span.toolbar@toolbar")]),pn("div.container",[pn("div.gutter@gutterDiv"),pn("div@editor")])]);_onDidViewChange=new T;view={element:this.htmlElements.root,minimumWidth:Dp.width,maximumWidth:Rp.width,minimumHeight:Dp.height,maximumHeight:Rp.height,onDidChange:this._onDidViewChange.event,layout:(t,n,i,r)=>{OV(this.htmlElements.root,{width:t,height:n,top:i,left:r}),this.editor.layout({width:t-this.htmlElements.gutterDiv.clientWidth,height:n-this.htmlElements.header.clientHeight})}};checkboxesVisible=Wa("mergeEditor.showCheckboxes",!1,this.configurationService);showDeletionMarkers=Wa("mergeEditor.showDeletionMarkers",!0,this.configurationService);useSimplifiedDecorations=Wa("mergeEditor.useSimplifiedDecorations",!1,this.configurationService);editor=this.instantiationService.createInstance(is,this.htmlElements.editor,{},{contributions:this.getEditorContributions()});updateOptions(t){this.editor.updateOptions(t)}isFocused=xr(this,Y.any(this.editor.onDidBlurEditorWidget,this.editor.onDidFocusEditorWidget),()=>this.editor.hasWidgetFocus());cursorPosition=xr(this,this.editor.onDidChangeCursorPosition,()=>this.editor.getPosition());selection=xr(this,this.editor.onDidChangeCursorSelection,()=>this.editor.getSelections());cursorLineNumber=this.cursorPosition.map(t=>t?.lineNumber);getEditorContributions(){return Iu.getEditorContributions().filter(t=>t.id!==Co.ID&&t.id!==Bl.ID)}};function Am(o,e){let t=Ct(n=>{let i=o.viewModel.read(n);if(!i)return[];let r=i.selectionInBase.read(n);return!r||r.sourceEditor===o?[]:r.rangesInBase.map(s=>e(s,i))});return Wt(n=>{let i=t.read(n);i.length!==0&&o.editor.setSelections(i.map(r=>new Ue(r.startLineNumber,r.startColumn,r.endLineNumber,r.endColumn)))})}var Ua=class extends B{constructor(e,t,n){super();let i=n.createInstance(Nm,t,e,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:r=>r==="primary"}});this._store.add(i)}};Ua=k([E(2,nt)],Ua);var Om=class extends tc{constructor(e,t,n){super(t,e,n),this._register(Am(this,(i,r)=>i)),this._register(t.createInstance(Ua,ot.MergeBaseToolbar,this.htmlElements.title)),this._register(Qa((i,r)=>{this.checkboxesVisible.read(i)&&r.add(new Jd(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(s,a)=>[],createView:(s,a)=>{throw new Te}}))})),this._register(Wt(i=>{let r=this.viewModel.read(i);if(!r)return;this.editor.setModel(r.model.base),Tn(this.htmlElements.title,...vo(p("base","Base")));let s=r.baseShowDiffAgainst.read(i),a;if(s){let l=p("compareWith","Comparing with {0}",s===1?r.model.input1.title:r.model.input2.title),d=p("compareWithTooltip","Differences are highlighted with a background color.");a=pn("span",{title:d},[l]).root}Tn(this.htmlElements.description,...a?[a]:[])})),this._register(Cm(this.editor,this.decorations))}decorations=Ct(this,e=>{let t=this.viewModel.read(e);if(!t)return[];let n=t.model,i=n.base,r=t.activeModifiedBaseRange.read(e),s=t.showNonConflictingChanges.read(e),a=this.showDeletionMarkers.read(e),l=[];for(let d of n.modifiedBaseRanges.read(e)){let c=d.baseRange;if(!c)continue;let u=n.isHandled(d).read(e);if(!d.isConflicting&&u&&!s)continue;let h=["merge-editor-block"],m=[0,0,0,0];u&&h.push("handled"),d===r&&(h.push("focused"),m=[0,2,0,2]),h.push("base");let g=t.baseShowDiffAgainst.read(e);if(g)for(let f of d.getInputDiffs(g)){let b=f.inputRange.toInclusiveRange();b&&l.push({range:b,options:{className:"merge-editor-diff base",description:"Merge Editor",isWholeLine:!0}});for(let y of f.rangeMappings)(a||!y.inputRange.isEmpty())&&l.push({range:y.inputRange,options:{className:y.inputRange.isEmpty()?"merge-editor-diff-empty-word base":"merge-editor-diff-word base",description:"Merge Editor",showIfCollapsed:!0}})}l.push({range:c.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:h.join(" "),blockPadding:m,blockIsAfterEnd:c.startLineNumber>i.getLineCount(),description:"Merge Editor",minimap:{position:2,color:{id:u?Pl:Fl}},overviewRuler:d.isConflicting?{position:2,color:{id:u?Pl:Fl}}:void 0}})}return l})};Om=k([E(1,nt),E(2,rt)],Om);var zu=class extends tc{constructor(t,n,i,r,s){super(i,n,s);this.inputNumber=t;this.htmlElements.root.classList.add("input"),this._register(new Jd(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(a,l)=>this.checkboxesVisible.read(l)?this.modifiedBaseRangeGutterItemInfos.read(l):[],createView:(a,l)=>new aM(a,l,r)})),this._register(Am(this,(a,l)=>l.model.translateBaseRangeToInput(this.inputNumber,a))),this._register(i.createInstance(Ua,t===1?ot.MergeInput1Toolbar:ot.MergeInput2Toolbar,this.htmlElements.toolbar)),this._register(od({debugName:`input${this.inputNumber}: update labels & text model`},a=>{let l=this.viewModel.read(a);if(!l)return;this.editor.setModel(this.inputNumber===1?l.model.input1.textModel:l.model.input2.textModel);let d=this.inputNumber===1?l.model.input1.title||p("input1","Input 1"):l.model.input2.title||p("input2","Input 2"),c=this.inputNumber===1?l.model.input1.description:l.model.input2.description,u=this.inputNumber===1?l.model.input1.detail:l.model.input2.detail;Tn(this.htmlElements.title,...vo(d)),Tn(this.htmlElements.description,...c?vo(c):[]),Tn(this.htmlElements.detail,...u?vo(u):[])})),this._register(Cm(this.editor,this.decorations))}otherInputNumber=this.inputNumber===1?2:1;modifiedBaseRangeGutterItemInfos=oh({debugName:`input${this.inputNumber}.modifiedBaseRangeGutterItemInfos`},t=>{let n=this.viewModel.read(t);if(!n)return[];let i=n.model,r=this.inputNumber,s=n.showNonConflictingChanges.read(t);return i.modifiedBaseRanges.read(t).filter(a=>a.getInputDiffs(this.inputNumber).length>0&&(s||a.isConflicting||!i.isHandled(a).read(t))).map((a,l)=>new sM(l.toString(),a,r,n))});decorations=oh({debugName:`input${this.inputNumber}.decorations`},t=>{let n=this.viewModel.read(t);if(!n)return[];let i=n.model,r=(this.inputNumber===1?i.input1:i.input2).textModel,s=n.activeModifiedBaseRange.read(t),a=new Array,l=n.showNonConflictingChanges.read(t),d=this.showDeletionMarkers.read(t),u=!(n.baseCodeEditorView.read(t)!==void 0&&n.baseShowDiffAgainst.read(t)===this.inputNumber)&&this.useSimplifiedDecorations.read(t);for(let h of i.modifiedBaseRanges.read(t)){let m=h.getInputRange(this.inputNumber);if(!m)continue;let g=["merge-editor-block"],f=[0,0,0,0],b=i.isInputHandled(h,this.inputNumber).read(t);b&&g.push("handled"),h===s&&(g.push("focused"),f=[0,2,0,2]),h.isConflicting&&g.push("conflicting");let y=this.inputNumber===1?"input i1":"input i2";if(g.push(y),!(!h.isConflicting&&!l&&b)&&(u&&!b&&g.push("use-simplified-decorations"),a.push({range:m.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:g.join(" "),blockPadding:f,blockIsAfterEnd:m.startLineNumber>r.getLineCount(),description:"Merge Editor",minimap:{position:2,color:{id:b?Pl:Fl}},overviewRuler:h.isConflicting?{position:2,color:{id:b?Pl:Fl}}:void 0}}),!u&&(h.isConflicting||!i.isHandled(h).read(t)))){let C=h.getInputDiffs(this.inputNumber);for(let S of C){let w=S.outputRange.toInclusiveRange();if(w&&a.push({range:w,options:{className:`merge-editor-diff ${y}`,description:"Merge Editor",isWholeLine:!0}}),S.rangeMappings)for(let R of S.rangeMappings)(d||!R.outputRange.isEmpty())&&a.push({range:R.outputRange,options:{className:R.outputRange.isEmpty()?`merge-editor-diff-empty-word ${y}`:`merge-editor-diff-word ${y}`,description:"Merge Editor",showIfCollapsed:!0}})}}}return a})};zu=k([E(2,nt),E(3,Vl),E(4,rt)],zu);var sM=class{constructor(e,t,n,i){this.id=e;this.baseRange=t;this.inputNumber=n;this.viewModel=i}model=this.viewModel.model;range=this.baseRange.getInputRange(this.inputNumber);enabled=this.model.isUpToDate;toggleState=Ct(this,e=>{let t=this.model.getState(this.baseRange).read(e).getInput(this.inputNumber);return t===2&&!this.baseRange.isOrderRelevant?1:t});state=Ct(this,e=>{let t=this.viewModel.activeModifiedBaseRange.read(e);return this.model.hasBaseRange(this.baseRange)?{handled:this.model.isHandled(this.baseRange).read(e),focused:this.baseRange===t}:{handled:!1,focused:!1}});setState(e,t){this.viewModel.setState(this.baseRange,this.model.getState(this.baseRange).get().withInputValue(this.inputNumber,e),t,this.inputNumber)}toggleBothSides(){et(e=>{let t=this.model.getState(this.baseRange).get();this.model.setState(this.baseRange,t.toggle(this.inputNumber).toggle(this.inputNumber===1?2:1),!0,e)})}getContextMenuActions(){let e=this.model.getState(this.baseRange).get(),t=this.model.isHandled(this.baseRange).get(),n=s=>{et(a=>this.viewModel.setState(this.baseRange,s,a,this.inputNumber))};function i(s,a,l,d){let c=new Er(s,a,void 0,!0,()=>{n(l)});return c.checked=d,c}let r=e.includesInput1&&e.includesInput2;return[this.baseRange.input1Diffs.length>0?i("mergeEditor.acceptInput1",p("mergeEditor.accept","Accept {0}",this.model.input1.title),e.toggle(1),e.includesInput1):void 0,this.baseRange.input2Diffs.length>0?i("mergeEditor.acceptInput2",p("mergeEditor.accept","Accept {0}",this.model.input2.title),e.toggle(2),e.includesInput2):void 0,this.baseRange.isConflicting?rw(i("mergeEditor.acceptBoth",p("mergeEditor.acceptBoth","Accept Both"),e.withInputValue(1,!r).withInputValue(2,!r),r),{enabled:this.baseRange.canBeCombined}):void 0,new jn,this.baseRange.isConflicting?rw(i("mergeEditor.swap",p("mergeEditor.swap","Swap"),e.swap(),!1),{enabled:!e.kind&&(!r||this.baseRange.isOrderRelevant)}):void 0,rw(new Er("mergeEditor.markAsHandled",p("mergeEditor.markAsHandled","Mark as Handled"),void 0,!0,()=>{et(s=>{this.model.setHandled(this.baseRange,!t,s)})}),{checked:t})].filter(ao)}},aM=class extends B{item;checkboxDiv;isMultiLine=fn(this,!1);constructor(e,t,n){super(),this.item=fn(this,e);let i=new Ep({isChecked:!1,title:"",icon:ue.check,...oM});i.domNode.classList.add("accept-conflict-group"),this._register(z(i.domNode,me.MOUSE_DOWN,r=>{let s=this.item.get();s&&(r.button===2?(r.stopPropagation(),r.preventDefault(),n.showContextMenu({getAnchor:()=>i.domNode,getActions:()=>s.getContextMenuActions()})):r.button===1&&(r.stopPropagation(),r.preventDefault(),s.toggleBothSides()))})),this._register(Wt(r=>{let s=this.item.read(r),a=s.toggleState.read(r),d={0:{icon:void 0,checked:!1,title:p("accept.excluded","Accept")},3:{icon:ue.circleFilled,checked:!1,title:p("accept.conflicting","Accept (result is dirty)")},1:{icon:ue.check,checked:!0,title:p("accept.first","Undo accept")},2:{icon:ue.checkAll,checked:!0,title:p("accept.second","Undo accept (currently second)")}}[a];i.setIcon(d.icon),i.checked=d.checked,i.setTitle(d.title),s.enabled.read(r)?i.enable():i.disable()})),this._register(Wt(r=>{let s=this.item.read(r).state.read(r),a=["merge-accept-gutter-marker",s.handled&&"handled",s.focused&&"focused",this.isMultiLine.read(r)?"multi-line":"single-line"];t.className=a.filter(l=>typeof l=="string").join(" ")})),this._register(i.onChange(()=>{et(r=>{this.item.get().setState(i.checked,r)})})),t.appendChild(pn("div.background",[NN]).root),t.appendChild(this.checkboxDiv=pn("div.checkbox",[pn("div.checkbox-background",[i.domNode])]).root)}layout(e,t,n,i){let r=this.checkboxDiv.clientHeight,s=t/2-r/2,a=r,l=e+s,d=[a,n+i-a-r],c=[e+a,e+t-r-a];c[0]<c[1]&&(l=Vn(l,d[0],d[1]),l=Vn(l,c[0],c[1])),this.checkboxDiv.style.top=`${l-e}px`,et(u=>{this.isMultiLine.set(t>30,u)})}update(e){et(t=>{this.item.set(e,t)})}};var jt=new De("isMergeEditor",!1,{type:"boolean",description:p("is","The editor is a merge editor")}),nW=new De("isMergeResultEditor",!1,{type:"boolean",description:p("isr","The editor is a the result editor of a merge editor.")}),nc=new De("mergeEditorLayout","mixed",{type:"string",description:p("editorLayout","The layout mode of a merge editor")}),Pm=new De("mergeEditorShowBase",!1,{type:"boolean",description:p("showBase","If the merge editor shows the base version")}),dv=new De("mergeEditorShowBaseAtTop",!1,{type:"boolean",description:p("showBaseAtTop","If base should be shown at the top")}),Tw=new De("mergeEditorShowNonConflictingChanges",!1,{type:"boolean",description:p("showNonConflictingChanges","If the merge editor shows non-conflicting changes")}),iW=new De("mergeEditorBaseUri","",{type:"string",description:p("baseUri","The uri of the baser of a merge editor")}),oW=new De("mergeEditorResultUri","",{type:"string",description:p("resultUri","The uri of the result of a merge editor")}),cv="mergeEditorCloseWithConflicts";var Fm=class extends tc{constructor(t,n,i,r){super(n,t,r);this._labelService=i;this.editor.invokeWithinContext(a=>{let l=a.get(Qt),d=nW.bindTo(l);d.set(!0),this._register(pe(()=>d.reset()))}),this.htmlElements.gutterDiv.style.width="5px",this.htmlElements.root.classList.add("result"),this._register(Qa((a,l)=>{this.checkboxesVisible.read(a)&&l.add(new Jd(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(d,c)=>[],createView:(d,c)=>{throw new Te}}))})),this._register(Wt(a=>{let l=this.viewModel.read(a);l&&(this.editor.setModel(l.model.resultTextModel),Tn(this.htmlElements.title,...vo(p("result","Result"))),Tn(this.htmlElements.description,...vo(this._labelService.getUriLabel(l.model.resultTextModel.uri,{relative:!0}))))}));let s=this._register(new Aa(this.htmlElements.detail));this._register(Wt(a=>{let l=this.viewModel.read(a);if(!l)return;let d=l.model;if(!d)return;let c=d.unhandledConflictsCount.read(a),u=c===1?p("mergeEditor.remainingConflicts","{0} Conflict Remaining",c):p("mergeEditor.remainingConflict","{0} Conflicts Remaining ",c);s.clear(),s.push({class:void 0,enabled:c>0,id:"nextConflict",label:u,run(){l.model.telemetry.reportConflictCounterClicked(),l.goToNextModifiedBaseRange(h=>!d.isHandled(h).get())},tooltip:c>0?p("goToNextConflict","Go to next conflict"):p("allConflictHandled","All conflicts handled, the merge can be completed now.")})})),this._register(Cm(this.editor,this.decorations)),this._register(Am(this,(a,l)=>l.model.translateBaseRangeToResult(a))),this._register(n.createInstance(Ua,ot.MergeInputResultToolbar,this.htmlElements.toolbar))}decorations=Ct(this,t=>{let n=this.viewModel.read(t);if(!n)return[];let i=n.model,r=i.resultTextModel,s=new Array,a=iw(i.modifiedBaseRanges.read(t),i.baseResultDiffs.read(t),(c,u)=>c.baseRange.touches(u.inputRange)?xo.neitherLessOrGreaterThan:en.compareByStart(c.baseRange,u.inputRange)),l=n.activeModifiedBaseRange.read(t),d=n.showNonConflictingChanges.read(t);for(let c of a){let u=c.left;if(u){let h=["merge-editor-block"],m=[0,0,0,0],g=i.isHandled(u).read(t);if(g&&h.push("handled"),u===l&&(h.push("focused"),m=[0,2,0,2]),u.isConflicting&&h.push("conflicting"),h.push("result"),!u.isConflicting&&!d&&g)continue;let f=i.getLineRangeInResult(u.baseRange,t);s.push({range:f.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:h.join(" "),blockPadding:m,blockIsAfterEnd:f.startLineNumber>r.getLineCount(),description:"Result Diff",minimap:{position:2,color:{id:g?Pl:Fl}},overviewRuler:u.isConflicting?{position:2,color:{id:g?Pl:Fl}}:void 0}})}if(!u||u.isConflicting)for(let h of c.rights){let m=h.outputRange.toInclusiveRange();if(m&&s.push({range:m,options:{className:"merge-editor-diff result",description:"Merge Editor",isWholeLine:!0}}),h.rangeMappings)for(let g of h.rangeMappings)s.push({range:g.outputRange,options:{className:"merge-editor-diff-word result",description:"Merge Editor"}})}}return s})};Fm=k([E(1,nt),E(2,Mr),E(3,rt)],Fm);var Bm=class extends B{constructor(t,n,i,r,s,a,l,d){super();this.model=t;this.inputCodeEditorView1=n;this.inputCodeEditorView2=i;this.resultCodeEditorView=r;this.baseCodeEditorView=s;this.showNonConflictingChanges=a;this.configurationService=l;this.notificationService=d;this._register(r.editor.onDidChangeModelContent(c=>{if(this.model.isApplyingEditInResult||c.isRedoing||c.isUndoing)return;let u=[];for(let m of c.changes){let g=this.model.translateResultRangeToBase(L.lift(m.range)),f=this.model.findModifiedBaseRangesInRange(new en(g.startLineNumber,g.endLineNumber-g.startLineNumber));f.length===1&&(this.model.isHandled(f[0]).get()||u.push(f[0]))}if(u.length===0)return;let h={model:this.model,redo(){et(m=>{for(let g of u)this.model.setHandled(g,!0,m)})},undo(){et(m=>{for(let g of u)this.model.setHandled(g,!1,m)})}};this.attachedHistory.pushAttachedHistoryElement(h),h.redo()}))}manuallySetActiveModifiedBaseRange=fn(this,{range:void 0,counter:0});attachedHistory=this._register(new lM(this.model.resultTextModel));shouldUseAppendInsteadOfAccept=Wa("mergeEditor.shouldUseAppendInsteadOfAccept",!1,this.configurationService);counter=0;lastFocusedEditor=P_(this,(t,n)=>{let r=[this.inputCodeEditorView1,this.inputCodeEditorView2,this.resultCodeEditorView,this.baseCodeEditorView.read(t)].find(s=>s&&s.isFocused.read(t));return r?{view:r,counter:this.counter++}:n||{view:void 0,counter:this.counter++}});baseShowDiffAgainst=Ct(this,t=>{let n=this.lastFocusedEditor.read(t);if(n.view===this.inputCodeEditorView1)return 1;if(n.view===this.inputCodeEditorView2)return 2});selectionInBase=Ct(this,t=>{let n=this.lastFocusedEditor.read(t).view;return n?{rangesInBase:(n.selection.read(t)||[]).map(s=>n===this.inputCodeEditorView1?this.model.translateInputRangeToBase(1,s):n===this.inputCodeEditorView2?this.model.translateInputRangeToBase(2,s):n===this.resultCodeEditorView?this.model.translateResultRangeToBase(s):(n===this.baseCodeEditorView.read(t),s)),sourceEditor:n}:void 0});getRangeOfModifiedBaseRange(t,n,i){if(t===this.resultCodeEditorView)return this.model.getLineRangeInResult(n.baseRange,i);if(t===this.baseCodeEditorView.get())return n.baseRange;{let r=t===this.inputCodeEditorView1?1:2;return n.getInputRange(r)}}activeModifiedBaseRange=Ct(this,t=>{let n=this.lastFocusedEditor.read(t),i=this.manuallySetActiveModifiedBaseRange.read(t);if(i.counter>n.counter)return i.range;if(!n.view)return;let r=n.view.cursorLineNumber.read(t);return r?this.model.modifiedBaseRanges.read(t).find(a=>{let l=this.getRangeOfModifiedBaseRange(n.view,a,t);return l.isEmpty?l.startLineNumber===r:l.contains(r)}):void 0});setActiveModifiedBaseRange(t,n){this.manuallySetActiveModifiedBaseRange.set({range:t,counter:this.counter++},n)}setState(t,n,i,r){this.manuallySetActiveModifiedBaseRange.set({range:t,counter:this.counter++},i),this.model.setState(t,n,r,i),this.lastFocusedEditor.clearCache(i)}goToConflict(t){let n=this.lastFocusedEditor.get().view;n||(n=this.resultCodeEditorView);let i=n.editor.getPosition()?.lineNumber;if(i===void 0)return;let r=t(n,i);if(r){let s=this.getRangeOfModifiedBaseRange(n,r,void 0);n.editor.focus();let a=s.startLineNumber,l=s.endLineNumberExclusive;s.startLineNumber>n.editor.getModel().getLineCount()&&(et(d=>{this.setActiveModifiedBaseRange(r,d)}),a=l=n.editor.getModel().getLineCount()),n.editor.setPosition({lineNumber:a,column:n.editor.getModel().getLineFirstNonWhitespaceColumn(a)}),n.editor.revealLinesNearTop(a,l,0)}}goToNextModifiedBaseRange(t){this.goToConflict((n,i)=>this.model.modifiedBaseRanges.get().find(r=>t(r)&&this.getRangeOfModifiedBaseRange(n,r,void 0).startLineNumber>i)||this.model.modifiedBaseRanges.get().find(r=>t(r)))}goToPreviousModifiedBaseRange(t){this.goToConflict((n,i)=>Yl(this.model.modifiedBaseRanges.get(),r=>t(r)&&this.getRangeOfModifiedBaseRange(n,r,void 0).endLineNumberExclusive<i)||Yl(this.model.modifiedBaseRanges.get(),r=>t(r)))}toggleActiveConflict(t){let n=this.activeModifiedBaseRange.get();if(!n){this.notificationService.error(p("noConflictMessage","There is currently no conflict focused that can be toggled."));return}et(i=>{this.setState(n,this.model.getState(n).get().toggle(t),i,t)})}acceptAll(t){et(n=>{for(let i of this.model.modifiedBaseRanges.get())this.setState(i,this.model.getState(i).get().withInputValue(t,!0),n,t)})}};Bm=k([E(6,rt),E(7,eo)],Bm);var lM=class extends B{constructor(t){super();this.model=t;this._register(t.onDidChangeContent(n=>{let i=t.getAlternativeVersionId();if(n.isRedoing)for(let r of this.attachedHistory)this.previousAltId<r.altId&&r.altId<=i&&r.element.redo();else if(n.isUndoing)for(let r=this.attachedHistory.length-1;r>=0;r--){let s=this.attachedHistory[r];i<s.altId&&s.altId<=this.previousAltId&&s.element.undo()}else for(;this.attachedHistory.length>0&&this.attachedHistory[this.attachedHistory.length-1].altId>this.previousAltId;)this.attachedHistory.pop();this.previousAltId=i}))}attachedHistory=[];previousAltId=this.model.getAlternativeVersionId();pushAttachedHistoryElement(t){this.attachedHistory.push({altId:this.model.getAlternativeVersionId(),element:t})}};var rW={start:"<<<<<<<",end:">>>>>>>"};var Vm=class{constructor(e,t,n,i){this._mergeEditorTelemetry=e;this._instantiationService=t;this._textModelService=n;this._modelService=i}async createInputModel(e){let t=new oe,[n,i,r,s]=await Promise.all([this._textModelService.createModelReference(e.base),this._textModelService.createModelReference(e.result),Lw(e.input1,this._textModelService,t),Lw(e.input2,this._textModelService,t)]);t.add(n),t.add(i);let a=i.object.textEditorModel.uri.with({scheme:"merge-result"}),l=this._modelService.createModel("",{languageId:i.object.textEditorModel.getLanguageId(),onDidChange:Y.None},a);t.add(l);let d=this._instantiationService.createInstance(Fu),c=this._instantiationService.createInstance(Wu,n.object.textEditorModel,r,s,l,d,{resetResult:!0},this._mergeEditorTelemetry);return t.add(c),await c.onInitialized,this._instantiationService.createInstance(uv,c,t,i.object,e.result)}};Vm=k([E(1,nt),E(2,Hh),E(3,kr)],Vm);var uv=class extends Ss{constructor(t,n,i,r,s,a,l){super();this.model=t;this.disposable=n;this.result=i;this.resultUri=r;this.textFileService=s;this.dialogService=a;this.editorService=l}savedAltVersionId=fn(this,this.model.resultTextModel.getAlternativeVersionId());altVersionId=xr(this,t=>this.model.resultTextModel.onDidChangeContent(t),()=>this.model.resultTextModel.getAlternativeVersionId());isDirty=Ct(this,t=>this.altVersionId.read(t)!==this.savedAltVersionId.read(t));finished=!1;dispose(){this.disposable.dispose(),super.dispose()}async accept(){let t=await this.model.resultTextModel.getValue();this.result.textEditorModel.setValue(t),this.savedAltVersionId.set(this.model.resultTextModel.getAlternativeVersionId(),void 0),await this.textFileService.save(this.result.textEditorModel.uri),this.finished=!0}async _discard(){await this.textFileService.revert(this.model.resultTextModel.uri),this.savedAltVersionId.set(this.model.resultTextModel.getAlternativeVersionId(),void 0),this.finished=!0}shouldConfirmClose(){return!0}async confirmClose(t){pi(()=>t.some(r=>r===this));let n=t.some(r=>r.isDirty.get()),i;if(n){let r=t.length>1,s=r?p("messageN","Do you want keep the merge result of {0} files?",t.length):p("message1","Do you want keep the merge result of {0}?",uo(t[0].model.resultTextModel.uri)),a=t.some(d=>d.model.hasUnhandledConflicts.get()),l=[{label:a?p({key:"saveWithConflict",comment:["&& denotes a mnemonic"]},"&&Save With Conflicts"):p({key:"save",comment:["&& denotes a mnemonic"]},"&&Save"),run:()=>0},{label:p({key:"discard",comment:["&& denotes a mnemonic"]},"Do&&n't Save"),run:()=>1}];i=(await this.dialogService.prompt({type:On.Info,message:s,detail:a?r?p("detailNConflicts","The files contain unhandled conflicts. The merge results will be lost if you don't save them."):p("detail1Conflicts","The file contains unhandled conflicts. The merge result will be lost if you don't save it."):r?p("detailN","The merge results will be lost if you don't save them."):p("detail1","The merge result will be lost if you don't save it."),buttons:l,cancelButton:{run:()=>2}})).result}else i=1;return i===0?await Promise.all(t.map(r=>r.accept())):i===1&&await Promise.all(t.map(r=>r._discard())),i}async save(t){this.finished||(async()=>{let{confirmed:n}=await this.dialogService.confirm({message:p("saveTempFile.message","Do you want to accept the merge result?"),detail:p("saveTempFile.detail","This will write the merge result to the original file and close the merge editor."),primaryButton:p({key:"acceptMerge",comment:["&& denotes a mnemonic"]},"&&Accept Merge")});if(n){await this.accept();let i=this.editorService.findEditors(this.resultUri).filter(r=>r.editor.typeId==="mergeEditor.Input");await this.editorService.closeEditors(i)}})()}async revert(t){}};uv=k([E(4,Ta),E(5,xa),E(6,st)],uv);var ic=class{constructor(e,t,n,i){this._mergeEditorTelemetry=e;this._instantiationService=t;this._textModelService=n;this.textFileService=i}static FILE_SAVED_SOURCE=uB.registerSource("merge-editor.source",p("merge-editor.source","Before Resolving Conflicts In Merge Editor"));async createInputModel(e){let t=new oe,n,i=t.add(new oe),r=f=>{_n(e.result,f.resource)&&(i.clear(),n=f)};i.add(this.textFileService.files.onDidCreate(r)),this.textFileService.files.models.forEach(r);let[s,a,l,d]=await Promise.all([this._textModelService.createModelReference(e.base),this._textModelService.createModelReference(e.result),Lw(e.input1,this._textModelService,t),Lw(e.input2,this._textModelService,t)]);if(t.add(s),t.add(a),!n)throw new Te;await n.save({source:ic.FILE_SAVED_SOURCE});let h=n.textEditorModel.getLinesContent().some(f=>f.startsWith(rW.start)),m=this._instantiationService.createInstance(Fu),g=this._instantiationService.createInstance(Wu,s.object.textEditorModel,l,d,a.object.textEditorModel,m,{resetResult:h},this._mergeEditorTelemetry);return t.add(g),await g.onInitialized,this._instantiationService.createInstance(hv,g,t,n,this._mergeEditorTelemetry)}};ic=k([E(1,nt),E(2,Hh),E(3,Ta)],ic);var hv=class extends Ss{constructor(t,n,i,r,s,a){super();this.model=t;this.disposableStore=n;this.resultTextFileModel=i;this.telemetry=r;this._dialogService=s;this._storageService=a}isDirty=xr(this,Y.any(this.resultTextFileModel.onDidChangeDirty,this.resultTextFileModel.onDidSaveError),()=>this.resultTextFileModel.isDirty());reported=!1;dateTimeOpened=new Date;dispose(){this.disposableStore.dispose(),super.dispose(),this.reportClose(!1)}reportClose(t){if(!this.reported){let n=this.model.unhandledConflictsCount.get(),i=new Date().getTime()-this.dateTimeOpened.getTime();this.telemetry.reportMergeEditorClosed({durationOpenedSecs:i/1e3,remainingConflictCount:n,accepted:t,conflictCount:this.model.conflictCount,combinableConflictCount:this.model.combinableConflictCount,conflictsResolvedWithBase:this.model.conflictsResolvedWithBase,conflictsResolvedWithInput1:this.model.conflictsResolvedWithInput1,conflictsResolvedWithInput2:this.model.conflictsResolvedWithInput2,conflictsResolvedWithSmartCombination:this.model.conflictsResolvedWithSmartCombination,manuallySolvedConflictCountThatEqualNone:this.model.manuallySolvedConflictCountThatEqualNone,manuallySolvedConflictCountThatEqualSmartCombine:this.model.manuallySolvedConflictCountThatEqualSmartCombine,manuallySolvedConflictCountThatEqualInput1:this.model.manuallySolvedConflictCountThatEqualInput1,manuallySolvedConflictCountThatEqualInput2:this.model.manuallySolvedConflictCountThatEqualInput2,manuallySolvedConflictCountThatEqualNoneAndStartedWithBase:this.model.manuallySolvedConflictCountThatEqualNoneAndStartedWithBase,manuallySolvedConflictCountThatEqualNoneAndStartedWithInput1:this.model.manuallySolvedConflictCountThatEqualNoneAndStartedWithInput1,manuallySolvedConflictCountThatEqualNoneAndStartedWithInput2:this.model.manuallySolvedConflictCountThatEqualNoneAndStartedWithInput2,manuallySolvedConflictCountThatEqualNoneAndStartedWithBothNonSmart:this.model.manuallySolvedConflictCountThatEqualNoneAndStartedWithBothNonSmart,manuallySolvedConflictCountThatEqualNoneAndStartedWithBothSmart:this.model.manuallySolvedConflictCountThatEqualNoneAndStartedWithBothSmart}),this.reported=!0}}async accept(){this.reportClose(!0),await this.resultTextFileModel.save()}get resultUri(){return this.resultTextFileModel.resource}async save(t){await this.resultTextFileModel.save(t)}async revert(t){await this.resultTextFileModel.revert(t)}shouldConfirmClose(){return!0}async confirmClose(t){let n=t.length>1,i=t.some(s=>s.isDirty.get()),r=t.some(s=>s.model.hasUnhandledConflicts.get());if(i){let s=n?p("workspace.messageN","Do you want to save the changes you made to {0} files?",t.length):p("workspace.message1","Do you want to save the changes you made to {0}?",uo(t[0].resultUri)),{result:a}=await this._dialogService.prompt({type:On.Info,message:s,detail:r?n?p("workspace.detailN.unhandled","The files contain unhandled conflicts. Your changes will be lost if you don't save them."):p("workspace.detail1.unhandled","The file contains unhandled conflicts. Your changes will be lost if you don't save them."):n?p("workspace.detailN.handled","Your changes will be lost if you don't save them."):p("workspace.detail1.handled","Your changes will be lost if you don't save them."),buttons:[{label:r?p({key:"workspace.saveWithConflict",comment:["&& denotes a mnemonic"]},"&&Save with Conflicts"):p({key:"workspace.save",comment:["&& denotes a mnemonic"]},"&&Save"),run:()=>0},{label:p({key:"workspace.doNotSave",comment:["&& denotes a mnemonic"]},"Do&&n't Save"),run:()=>1}],cancelButton:{run:()=>2}});return a}else if(r&&!this._storageService.getBoolean(cv,0,!1)){let{confirmed:s,checkboxChecked:a}=await this._dialogService.confirm({message:n?p("workspace.messageN.nonDirty","Do you want to close {0} merge editors?",t.length):p("workspace.message1.nonDirty","Do you want to close the merge editor for {0}?",uo(t[0].resultUri)),detail:r?n?p("workspace.detailN.unhandled.nonDirty","The files contain unhandled conflicts."):p("workspace.detail1.unhandled.nonDirty","The file contains unhandled conflicts."):void 0,primaryButton:r?p({key:"workspace.closeWithConflicts",comment:["&& denotes a mnemonic"]},"&&Close with Conflicts"):p({key:"workspace.close",comment:["&& denotes a mnemonic"]},"&&Close"),checkbox:{label:p("noMoreWarn","Do not ask me again")}});return a&&this._storageService.store(cv,!0,0,0),s?0:2}else return 0}};hv=k([E(4,xa),E(5,In)],hv);async function Lw(o,e,t){let n=await e.createModelReference(o.uri);return t.add(n),{textModel:n.object.textEditorModel,title:o.title,description:o.description,detail:o.detail}}var Hl=class{constructor(e,t,n,i){this.uri=e;this.title=t;this.detail=n;this.description=i}},Hi=class extends cu{constructor(t,n,i,r,s,a,l,d,c,u,h,m,g){super(r,void 0,a,l,d,c,h,m,g);this.base=t;this.input1=n;this.input2=i;this.result=r;this._instaService=s;this.configurationService=u}static ID="mergeEditor.Input";_inputModel;closeHandler={showConfirm:()=>this._inputModel?.shouldConfirmClose()??!1,confirm:async t=>{pi(()=>t.every(i=>i.editor instanceof Hi));let n=t.map(i=>i.editor._inputModel).filter(ao);return await this._inputModel.confirmClose(n)}};get useWorkingCopy(){return this.configurationService.getValue("mergeEditor.useWorkingCopy")??!1}dispose(){super.dispose()}get typeId(){return Hi.ID}get editorId(){return Cl.id}get capabilities(){let t=super.capabilities|256;return this.useWorkingCopy&&(t|=4),t}getName(){return p("name","Merging: {0}",super.getName())}mergeEditorModeFactory=this._instaService.createInstance(this.useWorkingCopy?Vm:ic,this._instaService.createInstance(wm));async resolve(){if(!this._inputModel){let t=this._register(await this.mergeEditorModeFactory.createInputModel({base:this.base,input1:this.input1,input2:this.input2,result:this.result}));this._inputModel=t,this._register(Wt(n=>{t.isDirty.read(n),this._onDidChangeDirty.fire()})),await this._inputModel.model.onInitialized}return this._inputModel}async accept(){await this._inputModel?.accept()}async save(t,n){await this._inputModel?.save(n)}toUntyped(){return{input1:{resource:this.input1.uri,label:this.input1.title,description:this.input1.description,detail:this.input1.detail},input2:{resource:this.input2.uri,label:this.input2.title,description:this.input2.description,detail:this.input2.detail},base:{resource:this.base},result:{resource:this.result},options:{override:this.typeId}}}matches(t){return this===t?!0:t instanceof Hi?_n(this.base,t.base)&&_n(this.input1.uri,t.input1.uri)&&_n(this.input2.uri,t.input2.uri)&&_n(this.result,t.result):Ea(t)?(this.editorId===t.options?.override||t.options?.override===void 0)&&_n(this.base,t.base.resource)&&_n(this.input1.uri,t.input1.resource)&&_n(this.input2.uri,t.input2.resource)&&_n(this.result,t.result.resource):!1}async revert(t,n){return this._inputModel?.revert(n)}isDirty(){return this._inputModel?.isDirty.get()??!1}setLanguageId(t,n){this._inputModel?.model.setLanguageId(t,n)}};Hi=k([E(4,nt),E(5,st),E(6,Ta),E(7,Mr),E(8,dn),E(9,rt),E(10,La),E(11,Xi),E(12,$d)],Hi);var Wm=class extends _S{constructor(t,n,i,r,s,a,l,d,c,u){super(t,n,r,d,a);this.instantiationService=s;this.textResourceConfigurationService=l;this.editorService=c;this.editorGroupService=u;this.viewState=this.getEditorMemento(u,l,i,100)}viewState;groupListener=this._register(new rn);editorViewStateDisposables;setEditorVisible(t){this.groupListener.value=this.group.onWillCloseEditor(n=>this.onWillCloseEditor(n)),super.setEditorVisible(t)}onWillCloseEditor(t){let n=t.editor;n===this.input&&this.updateEditorViewState(n)}clearInput(){this.updateEditorViewState(this.input),super.clearInput()}saveState(){this.updateEditorViewState(this.input),super.saveState()}updateEditorViewState(t){if(!t||!this.tracksEditorViewState(t))return;let n=this.toEditorViewStateResource(t);n&&(this.tracksDisposedEditorViewState()||(this.editorViewStateDisposables||(this.editorViewStateDisposables=new Map),this.editorViewStateDisposables.has(t)||this.editorViewStateDisposables.set(t,Y.once(t.onWillDispose)(()=>{this.clearEditorViewState(n,this.group),this.editorViewStateDisposables?.delete(t)}))),t.isDisposed()&&!this.tracksDisposedEditorViewState()||!this.shouldRestoreEditorViewState(t)&&!this.group.contains(t)?this.clearEditorViewState(n,this.group):t.isDisposed()||this.saveEditorViewState(n))}shouldRestoreEditorViewState(t,n){return n?.newInGroup?this.textResourceConfigurationService.getValue(vl.getOriginalUri(t,{supportSideBySide:1}),"workbench.editor.restoreViewState")!==!1:!0}getViewState(){let t=this.input;if(!t||!this.tracksEditorViewState(t))return;let n=this.toEditorViewStateResource(t);if(n)return this.computeEditorViewState(n)}saveEditorViewState(t){let n=this.computeEditorViewState(t);n&&this.viewState.saveEditorState(this.group,t,n)}loadEditorViewState(t,n){if(!t||!this.tracksEditorViewState(t)||!this.shouldRestoreEditorViewState(t,n))return;let i=this.toEditorViewStateResource(t);if(i)return this.viewState.loadEditorState(this.group,i)}moveEditorViewState(t,n,i){return this.viewState.moveEditorState(t,n,i)}clearEditorViewState(t,n){this.viewState.clearEditorState(t,n)}dispose(){if(super.dispose(),this.editorViewStateDisposables){for(let[,t]of this.editorViewStateDisposables)t.dispose();this.editorViewStateDisposables=void 0}}tracksDisposedEditorViewState(){return!1}};Wm=k([E(3,Ao),E(4,nt),E(5,In),E(6,Xi),E(7,xs),E(8,st),E(9,up)],Wm);var oc=class extends Wm{constructor(t,n,i,r,s,a,l,d,c,u){super(t,n,oc.VIEW_STATE_PREFERENCE_KEY,i,r,s,a,l,d,c);this.fileService=u;this._register(this.textResourceConfigurationService.onDidChangeConfiguration(h=>this.handleConfigurationChangeEvent(h))),this._register(Y.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{let h=this.computeAriaLabel();this.editorContainer?.setAttribute("aria-label",h),this.updateEditorControlOptions({ariaLabel:h})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(h=>this.onDidChangeFileSystemProvider(h.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(h=>this.onDidChangeFileSystemProvider(h.scheme)))}static VIEW_STATE_PREFERENCE_KEY="textEditorViewState";_onDidChangeSelection=this._register(new T);onDidChangeSelection=this._onDidChangeSelection.event;_onDidChangeScroll=this._register(new T);onDidChangeScroll=this._onDidChangeScroll.event;editorContainer;hasPendingConfigurationChange;lastAppliedEditorOptions;inputListener=this._register(new rn);handleConfigurationChangeEvent(t){let n=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(t,n)&&(this.isVisible()?this.updateEditorConfiguration(n):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(t,n){return t.affectsConfiguration(n,"editor")||t.affectsConfiguration(n,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.updateEditorConfiguration(),this.hasPendingConfigurationChange=!1)}computeConfiguration(t){let n=hn(t.editor)?Ih(t.editor):Object.create(null);return Object.assign(n,this.getConfigurationOverrides(t)),n.ariaLabel=this.computeAriaLabel(),n}computeAriaLabel(){return this.input?J2(this.input,void 0,this.group,this.editorGroupService.count):p("editor","Editor")}onDidChangeFileSystemProvider(t){this.input&&this.getActiveResource()?.scheme===t&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(t){this.input===t&&this.updateReadonly(t)}updateReadonly(t){this.updateEditorControlOptions({...this.getReadonlyConfiguration(t.isReadonly())})}getReadonlyConfiguration(t){return{readOnly:!!t,readOnlyMessage:typeof t!="boolean"?t:void 0}}getConfigurationOverrides(t){return{overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0,...this.getReadonlyConfiguration(this.input?.isReadonly()),renderValidationDecorations:t.problems?.visibility!==!1?"on":"off"}}createEditor(t){this.editorContainer=t,this.createEditorControl(t,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let t=this.getMainControl();t&&(this._register(t.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(t.onDidChangeCursorPosition(n=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(n)}))),this._register(t.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:3}))),this._register(t.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(t){switch(t.source){case"api":return 1;case"code.navigation":return 4;case"code.jump":return 5;default:return 2}}getSelection(){let t=this.getMainControl();if(t){let n=t.getSelection();if(n)return new dM(n)}}async setInput(t,n,i,r){await super.setInput(t,n,i,r),this.inputListener.value=t.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(t)),this.updateEditorConfiguration(),To(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let t=this.getMainControl();if(!t)throw new Error("Control has not yet been initialized");return{scrollTop:t.getScrollTop()-t.getTopForLineNumber(1),scrollLeft:t.getScrollLeft()}}setScrollPosition(t){let n=this.getMainControl();if(!n)throw new Error("Control has not yet been initialized");n.setScrollTop(t.scrollTop),t.scrollLeft&&n.setScrollLeft(t.scrollLeft)}setEditorVisible(t){t&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(t)}toEditorViewStateResource(t){return t.resource}updateEditorConfiguration(t=this.getActiveResource()){let n;if(t&&(n=this.textResourceConfigurationService.getValue(t)),!n)return;let i=this.computeConfiguration(n),r=i;this.lastAppliedEditorOptions&&(r=bA(this.lastAppliedEditorOptions,r)),Object.keys(r).length>0&&(this.lastAppliedEditorOptions=i,this.updateEditorControlOptions(r))}getActiveResource(){let t=this.getMainControl();if(t){let n=t.getModel();if(n)return n.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}};oc=k([E(2,Ao),E(3,nt),E(4,In),E(5,Xi),E(6,xs),E(7,st),E(8,up),E(9,dn)],oc);var dM=class o{constructor(e){this.textSelection=e}static TEXT_EDITOR_SELECTION_THRESHOLD=10;compare(e){if(!(e instanceof o))return 3;let t=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),n=Math.min(e.textSelection.selectionStartLineNumber,e.textSelection.positionLineNumber);return t===n?1:Math.abs(t-n)<o.TEXT_EDITOR_SELECTION_THRESHOLD?2:3}restore(e){return{...e,selection:this.textSelection,selectionRevealType:1}}log(){return`line: ${this.textSelection.startLineNumber}-${this.textSelection.endLineNumber}, col:  ${this.textSelection.startColumn}-${this.textSelection.endColumn}`}};function cM(o,e,t){let n=!1,i=G8(o);if(T1(i)&&(e.restoreViewState(i),n=!0),o.selection){let r={startLineNumber:o.selection.startLineNumber,startColumn:o.selection.startColumn,endLineNumber:o.selection.endLineNumber??o.selection.startLineNumber,endColumn:o.selection.endColumn??o.selection.startColumn};e.setSelection(r,o.selectionSource??"code.navigation"),o.selectionRevealType===2?e.revealRangeNearTop(r,t):o.selectionRevealType===3?e.revealRangeNearTopIfOutsideViewport(r,t):o.selectionRevealType===1?e.revealRangeInCenterIfOutsideViewport(r,t):e.revealRangeInCenter(r,t),n=!0}return n}function G8(o){if(!o.selection||!o.viewState)return o.viewState;let e=o.viewState;if(e.modified)return e.modified.cursorState=[],e;let t=o.viewState;return t.cursorState&&(t.cursorState=[]),t}var sW="transientWordWrapState",hM="isWordWrapMinified",pM="isDominatedByLongLines",aW=new De("canToggleWordWrap",!1,!0),lW=new De("editorWordWrap",!1,p("editorWordWrap","Whether the editor is currently using word wrapping."));function Ul(o,e,t){t.setTransientModelProperty(o,sW,e)}function Km(o,e){return e.getTransientModelProperty(o,sW)}var Dw="editor.action.toggleWordWrap",uM=class extends qd{constructor(){super({id:Dw,label:p("toggle.wordwrap","View: Toggle Word Wrap"),alias:"View: Toggle Word Wrap",precondition:void 0,kbOpts:{kbExpr:null,primary:568,weight:100}})}run(e,t){let n=e.get(yo);if(!Gm(n,t))return;let i=t.getModel(),r=Km(i,n),s;r?s=null:s={wordWrapOverride:t.getOption(148).wrappingColumn===-1?"on":"off"},Ul(i,s,n);let a=j8(t,n);if(a){let l=a.getOriginalEditor(),d=a.getModifiedEditor(),c=l===t?d:l;Gm(n,c)&&(Ul(c.getModel(),s,n),a.updateOptions({}))}}};function j8(o,e){if(!o.getOption(62))return null;for(let t of e.listDiffEditors()){let n=t.getOriginalEditor(),i=t.getModifiedEditor();if(n===o||i===o)return t}return null}var Hm=class extends B{constructor(t,n,i){super();this._editor=t;this._contextKeyService=n;this._codeEditorService=i;let s=this._editor.getOptions().get(148),a=this._contextKeyService.createKey(hM,s.isWordWrapMinified),l=this._contextKeyService.createKey(pM,s.isDominatedByLongLines),d=!1;this._register(t.onDidChangeConfiguration(u=>{if(!u.hasChanged(148))return;let m=this._editor.getOptions().get(148);a.set(m.isWordWrapMinified),l.set(m.isDominatedByLongLines),d||c()})),this._register(t.onDidChangeModel(u=>{c()})),this._register(i.onDidChangeTransientModelProperty(()=>{c()}));let c=()=>{if(!Gm(this._codeEditorService,this._editor))return;let u=Km(this._editor.getModel(),this._codeEditorService);try{d=!0,this._applyWordWrapState(u)}finally{d=!1}}}static ID="editor.contrib.toggleWordWrapController";_applyWordWrapState(t){let n=t?t.wordWrapOverride:"inherit";this._editor.updateOptions({wordWrapOverride2:n})}};Hm=k([E(1,Qt),E(2,yo)],Hm);var Um=class extends B{constructor(t,n){super();this._diffEditor=t;this._codeEditorService=n;this._register(this._diffEditor.onDidChangeModel(()=>{this._ensureSyncedWordWrapToggle()}))}static ID="diffeditor.contrib.toggleWordWrapController";_ensureSyncedWordWrapToggle(){let t=this._diffEditor.getOriginalEditor(),n=this._diffEditor.getModifiedEditor();if(!t.hasModel()||!n.hasModel())return;let i=Km(t.getModel(),this._codeEditorService),r=Km(n.getModel(),this._codeEditorService);i&&!r&&Gm(this._codeEditorService,t)&&(Ul(n.getModel(),i,this._codeEditorService),this._diffEditor.updateOptions({})),!i&&r&&Gm(this._codeEditorService,n)&&(Ul(t.getModel(),r,this._codeEditorService),this._diffEditor.updateOptions({}))}};Um=k([E(1,yo)],Um);function Gm(o,e){if(!e||e.isSimpleWidget||!e.getModel())return!1;if(e.getOption(62)){for(let n of o.listDiffEditors())if(n.getOriginalEditor()===e&&!n.renderSideBySide)return!1}return!0}var zm=class extends B{constructor(t,n,i){super();this._editorService=t;this._codeEditorService=n;this._contextService=i;this._register(Y.runAndSubscribe(rb,({window:r,disposables:s})=>{s.add(z(r,"focus",()=>this._update(),!0)),s.add(z(r,"blur",()=>this._update(),!0))},{window:_e,disposables:this._store})),this._register(this._editorService.onDidActiveEditorChange(()=>this._update())),this._canToggleWordWrap=aW.bindTo(this._contextService),this._editorWordWrap=lW.bindTo(this._contextService),this._activeEditor=null,this._activeEditorListener=new oe,this._update()}static ID="workbench.contrib.editorWordWrapContextKeyTracker";_canToggleWordWrap;_editorWordWrap;_activeEditor;_activeEditorListener;_update(){let t=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();this._activeEditor!==t&&(this._activeEditorListener.clear(),this._activeEditor=t,t&&(this._activeEditorListener.add(t.onDidChangeModel(()=>this._updateFromCodeEditor())),this._activeEditorListener.add(t.onDidChangeConfiguration(n=>{n.hasChanged(148)&&this._updateFromCodeEditor()})),this._updateFromCodeEditor()))}_updateFromCodeEditor(){if(Gm(this._codeEditorService,this._activeEditor)){let t=this._activeEditor.getOption(148);this._setValues(!0,t.wrappingColumn!==-1)}else return this._setValues(!1,!1)}_setValues(t,n){this._canToggleWordWrap.set(t),this._editorWordWrap.set(n)}};zm=k([E(0,st),E(1,yo),E(2,Qt)],zm);ES(zm.ID,zm,Ns.AfterRestored);Yd(Hm.ID,Hm,0);lV(Um.ID,Um);kn(uM);Qo.appendMenuItem(ot.EditorTitle,{command:{id:Dw,title:p("unwrapMinified","Disable wrapping for this file"),icon:ue.wordWrap},group:"navigation",order:1,when:ht.and(ht.has(pM),ht.has(hM))});Qo.appendMenuItem(ot.EditorTitle,{command:{id:Dw,title:p("wrapMinified","Enable wrapping for this file"),icon:ue.wordWrap},group:"navigation",order:1,when:ht.and(ae.inDiffEditor.negate(),ht.has(pM),ht.not(hM))});Qo.appendMenuItem(ot.MenubarViewMenu,{command:{id:Dw,title:p({key:"miToggleWordWrap",comment:["&& denotes a mnemonic"]},"&&Word Wrap"),toggled:lW,precondition:aW},order:1,group:"5_editor"});var Rw=class extends B{constructor(t,n,i,r,s,a){super();this.viewModel=t;this.input1View=n;this.input2View=i;this.baseView=r;this.inputResultView=s;this.layout=a;let l=this.updateScrolling=()=>{if(!this.model)return;if(this.input2View.editor.setScrollTop(this.input1View.editor.getScrollTop(),1),this.shouldAlignResult)this.inputResultView.editor.setScrollTop(this.input1View.editor.getScrollTop(),1);else{let c=this.model.input1ResultMapping.get();this.synchronizeScrolling(this.input1View.editor,this.inputResultView.editor,c)}let d=this.baseView.get();if(d)if(this.shouldAlignBase)this.baseView.get()?.editor.setScrollTop(this.input1View.editor.getScrollTop(),1);else{let c=new os(this.model.baseInput1Diffs.get(),-1).reverse();this.synchronizeScrolling(this.input1View.editor,d.editor,c)}};this._store.add(this.input1View.editor.onDidScrollChange(this.reentrancyBarrier.makeExclusiveOrSkip(d=>{d.scrollTopChanged&&l(),d.scrollLeftChanged&&(this.baseView.get()?.editor.setScrollLeft(d.scrollLeft,1),this.input2View.editor.setScrollLeft(d.scrollLeft,1),this.inputResultView.editor.setScrollLeft(d.scrollLeft,1))}))),this._store.add(this.input2View.editor.onDidScrollChange(this.reentrancyBarrier.makeExclusiveOrSkip(d=>{if(this.model){if(d.scrollTopChanged){if(this.input1View.editor.setScrollTop(d.scrollTop,1),this.shouldAlignResult)this.inputResultView.editor.setScrollTop(this.input2View.editor.getScrollTop(),1);else{let u=this.model.input2ResultMapping.get();this.synchronizeScrolling(this.input2View.editor,this.inputResultView.editor,u)}let c=this.baseView.get();if(c&&this.model)if(this.shouldAlignBase)this.baseView.get()?.editor.setScrollTop(d.scrollTop,1);else{let u=new os(this.model.baseInput2Diffs.get(),-1).reverse();this.synchronizeScrolling(this.input2View.editor,c.editor,u)}}d.scrollLeftChanged&&(this.baseView.get()?.editor.setScrollLeft(d.scrollLeft,1),this.input1View.editor.setScrollLeft(d.scrollLeft,1),this.inputResultView.editor.setScrollLeft(d.scrollLeft,1))}}))),this._store.add(this.inputResultView.editor.onDidScrollChange(this.reentrancyBarrier.makeExclusiveOrSkip(d=>{if(d.scrollTopChanged){if(this.shouldAlignResult)this.input1View.editor.setScrollTop(d.scrollTop,1),this.input2View.editor.setScrollTop(d.scrollTop,1);else{let h=this.model?.resultInput1Mapping.get();this.synchronizeScrolling(this.inputResultView.editor,this.input1View.editor,h);let m=this.model?.resultInput2Mapping.get();this.synchronizeScrolling(this.inputResultView.editor,this.input2View.editor,m)}let c=this.model?.resultBaseMapping.get(),u=this.baseView.get();u&&this.model&&this.synchronizeScrolling(this.inputResultView.editor,u.editor,c)}d.scrollLeftChanged&&(this.baseView.get()?.editor?.setScrollLeft(d.scrollLeft,1),this.input1View.editor.setScrollLeft(d.scrollLeft,1),this.input2View.editor.setScrollLeft(d.scrollLeft,1))}))),this._store.add(Qa((d,c)=>{let u=this.baseView.read(d);u&&c.add(u.editor.onDidScrollChange(this.reentrancyBarrier.makeExclusiveOrSkip(h=>{if(h.scrollTopChanged){if(!this.model)return;if(this.shouldAlignBase)this.input1View.editor.setScrollTop(h.scrollTop,1),this.input2View.editor.setScrollTop(h.scrollTop,1);else{let g=new os(this.model.baseInput1Diffs.get(),-1);this.synchronizeScrolling(u.editor,this.input1View.editor,g);let f=new os(this.model.baseInput2Diffs.get(),-1);this.synchronizeScrolling(u.editor,this.input2View.editor,f)}let m=this.model?.baseResultMapping.get();this.synchronizeScrolling(u.editor,this.inputResultView.editor,m)}h.scrollLeftChanged&&(this.inputResultView.editor.setScrollLeft(h.scrollLeft,1),this.input1View.editor.setScrollLeft(h.scrollLeft,1),this.input2View.editor.setScrollLeft(h.scrollLeft,1))})))}))}get model(){return this.viewModel.get()?.model}reentrancyBarrier=new Sm;updateScrolling;get shouldAlignResult(){return this.layout.get().kind==="columns"}get shouldAlignBase(){return this.layout.get().kind==="mixed"&&!this.layout.get().showBaseAtTop}synchronizeScrolling(t,n,i){if(!i)return;let r=t.getVisibleRanges();if(r.length===0)return;let s=r[0].startLineNumber-1,a=i.project(s),l=a.inputRange,d=a.outputRange,c=n.getTopForLineNumber(d.startLineNumber),u=n.getTopForLineNumber(d.endLineNumberExclusive),h=t.getTopForLineNumber(l.startLineNumber),m=t.getTopForLineNumber(l.endLineNumberExclusive),g=Math.min((t.getScrollTop()-h)/(m-h),1),f=c+(u-c)*g;n.setScrollTop(f,1)}};var kw=class o extends B{constructor(t,n,i,r,s){super();this.editor=t;this.viewZoneId=n.addZone({domNode:document.createElement("div"),afterLineNumber:i,heightInPx:r,ordinal:50001,onComputedHeight:a=>{this.widgetDomNode.style.height=`${a}px`},onDomNodeTop:a=>{this.widgetDomNode.style.top=`${a}px`}}),s.push(this.viewZoneId),this._register(Y.runAndSubscribe(this.editor.onDidLayoutChange,()=>{this.widgetDomNode.style.left=this.editor.getLayoutInfo().contentLeft+"px"})),this.editor.addOverlayWidget(this.overlayWidget),this._register({dispose:()=>{this.editor.removeOverlayWidget(this.overlayWidget)}})}static counter=0;overlayWidgetId=`fixedZoneWidget-${o.counter++}`;viewZoneId;widgetDomNode=pn("div.fixed-zone-widget").root;overlayWidget={getId:()=>this.overlayWidgetId,getDomNode:()=>this.widgetDomNode,getPosition:()=>null}};var jm=class extends B{constructor(t){super();this._editor=t;this._register(this._editor.onDidChangeConfiguration(n=>{(n.hasChanged(51)||n.hasChanged(19)||n.hasChanged(18))&&this._updateLensStyle()})),this._styleClassName="_conflictActionsFactory_"+Oo(this._editor.getId()).toString(16),this._styleElement=es(jC(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,void 0,this._store),this._updateLensStyle()}_styleClassName;_styleElement;_updateLensStyle(){let{codeLensHeight:t,fontSize:n}=this._getLayoutInfo(),i=this._editor.getOption(18),r=this._editor.getOption(51),s=`--codelens-font-family${this._styleClassName}`,a=`--codelens-font-features${this._styleClassName}`,l=`
		.${this._styleClassName} { line-height: ${t}px; font-size: ${n}px; padding-right: ${Math.round(n*.5)}px; font-feature-settings: var(${a}) }
		.monaco-workbench .${this._styleClassName} span.codicon { line-height: ${t}px; font-size: ${n}px; }
		`;i&&(l+=`${this._styleClassName} { font-family: var(${s}), ${fi.fontFamily}}`),this._styleElement.textContent=l,this._editor.getContainerDomNode().style?.setProperty(s,i??"inherit"),this._editor.getContainerDomNode().style?.setProperty(a,r.fontFeatureSettings)}_getLayoutInfo(){let t=Math.max(1.3,this._editor.getOption(68)/this._editor.getOption(53)),n=this._editor.getOption(19);return(!n||n<5)&&(n=this._editor.getOption(53)*.9|0),{fontSize:n,codeLensHeight:n*t|0}}createWidget(t,n,i,r){let s=this._getLayoutInfo();return new mM(this._editor,t,n,s.codeLensHeight+2,this._styleClassName,i,r)}},Mw=class{constructor(e,t){this.viewModel=e;this.modifiedBaseRange=t}getItemsInput(e){return Ct(t=>{let n=this.viewModel,i=this.modifiedBaseRange;if(!n.model.hasBaseRange(i))return[];let r=n.model.getState(i).read(t),s=n.model.isHandled(i).read(t),a=n.model,l=[],d=e===1?n.model.input1:n.model.input2,c=n.showNonConflictingChanges.read(t);if(!i.isConflicting&&s&&!c)return[];let u=e===1?2:1;if(r.kind!==4&&!r.isInputIncluded(e)){if(!r.isInputIncluded(u)||!this.viewModel.shouldUseAppendInsteadOfAccept.read(t)){if(l.push(rc(p("accept","Accept {0}",d.title),async()=>{et(h=>{a.setState(i,r.withInputValue(e,!0,!1),e,h),a.telemetry.reportAcceptInvoked(e,r.includesInput(u))})},p("acceptTooltip","Accept {0} in the result document.",d.title))),i.canBeCombined){let h=i.isOrderRelevant?p("acceptBoth0First","Accept Combination ({0} First)",d.title):p("acceptBoth","Accept Combination");l.push(rc(h,async()=>{et(m=>{a.setState(i,Un.base.withInputValue(e,!0).withInputValue(u,!0,!0),!0,m),a.telemetry.reportSmartCombinationInvoked(r.includesInput(u))})},p("acceptBothTooltip","Accept an automatic combination of both sides in the result document.")))}}else l.push(rc(p("append","Append {0}",d.title),async()=>{et(h=>{a.setState(i,r.withInputValue(e,!0,!1),e,h),a.telemetry.reportAcceptInvoked(e,r.includesInput(u))})},p("appendTooltip","Append {0} to the result document.",d.title))),i.canBeCombined&&l.push(rc(p("combine","Accept Combination",d.title),async()=>{et(h=>{a.setState(i,r.withInputValue(e,!0,!0),e,h),a.telemetry.reportSmartCombinationInvoked(r.includesInput(u))})},p("acceptBothTooltip","Accept an automatic combination of both sides in the result document.")));a.isInputHandled(i,e).read(t)||l.push(rc(p("ignore","Ignore"),async()=>{et(h=>{a.setInputHandled(i,e,!0,h)})},p("markAsHandledTooltip","Don't take this side of the conflict.")))}return l})}itemsInput1=this.getItemsInput(1);itemsInput2=this.getItemsInput(2);resultItems=Ct(this,e=>{let t=this.viewModel,n=this.modifiedBaseRange,i=t.model.getState(n).read(e),r=t.model,s=[];if(i.kind===4)s.push({text:p("manualResolution","Manual Resolution"),tooltip:p("manualResolutionTooltip","This conflict has been resolved manually.")});else if(i.kind===0)s.push({text:p("noChangesAccepted","No Changes Accepted"),tooltip:p("noChangesAcceptedTooltip","The current resolution of this conflict equals the common ancestor of both the right and left changes.")});else{let l=[];i.includesInput1&&l.push(r.input1.title),i.includesInput2&&l.push(r.input2.title),i.kind===3&&i.firstInput===2&&l.reverse(),s.push({text:`${l.join(" + ")}`})}let a=[];return i.includesInput1&&a.push(rc(p("remove","Remove {0}",r.input1.title),async()=>{et(l=>{r.setState(n,i.withInputValue(1,!1),!0,l),r.telemetry.reportRemoveInvoked(1,i.includesInput(2))})},p("removeTooltip","Remove {0} from the result document.",r.input1.title))),i.includesInput2&&a.push(rc(p("remove","Remove {0}",r.input2.title),async()=>{et(l=>{r.setState(n,i.withInputValue(2,!1),!0,l),r.telemetry.reportRemoveInvoked(2,i.includesInput(1))})},p("removeTooltip","Remove {0} from the result document.",r.input2.title))),i.kind===3&&i.firstInput===2&&a.reverse(),s.push(...a),i.kind===4&&s.push(rc(p("resetToBase","Reset to base"),async()=>{et(l=>{r.setState(n,Un.base,!0,l),r.telemetry.reportResetToBaseInvoked()})},p("resetToBaseTooltip","Reset this conflict to the common ancestor of both the right and left changes."))),s});isEmpty=Ct(this,e=>this.itemsInput1.read(e).length+this.itemsInput2.read(e).length+this.resultItems.read(e).length===0);inputIsEmpty=Ct(this,e=>this.itemsInput1.read(e).length+this.itemsInput2.read(e).length===0)};function rc(o,e,t){return{text:o,action:e,tooltip:t}}var mM=class extends kw{_domNode=pn("div.merge-editor-conflict-actions").root;constructor(e,t,n,i,r,s,a){super(e,t,n,i,a),this.widgetDomNode.appendChild(this._domNode),this._domNode.classList.add(r),this._register(Wt(l=>{let d=s.read(l);this.setState(d)}))}setState(e){let t=[],n=!0;for(let i of e){n?n=!1:t.push(je("span",void 0,"\xA0|\xA0"));let r=vo(i.text);i.action?t.push(je("a",{title:i.tooltip,role:"button",onclick:()=>i.action()},...r)):t.push(je("span",{title:i.tooltip},...r))}Tn(this._domNode,...t)}};function cW(o){let e=dW(o.input1Diffs.flatMap(a=>a.rangeMappings),o.baseRange.toRange(),o.input1Range.toRange()),t=dW(o.input2Diffs.flatMap(a=>a.rangeMappings),o.baseRange.toRange(),o.input2Range.toRange()),n=$8(e,t),i=[];i.push([o.input1Range.startLineNumber-1,o.baseRange.startLineNumber-1,o.input2Range.startLineNumber-1]);function r(a){return a.every(l=>l!==void 0)}for(let a of n){let l=[a.output1Pos?.lineNumber,a.inputPos.lineNumber,a.output2Pos?.lineNumber],d=r(l),c=!0;if(d){let u=!i.some(h=>r(h)&&h.some((m,g)=>m!==void 0&&m===l[g]));u&&(i=i.filter(h=>!h.some((m,g)=>m!==void 0&&m===l[g]))),c=u}else c=!i.some(h=>h.some((m,g)=>m!==void 0&&m===l[g]));c?i.push(l):a.length.isGreaterThan(new Dr(1,0))&&i.push([a.output1Pos?a.output1Pos.lineNumber+1:void 0,a.inputPos.lineNumber+1,a.output2Pos?a.output2Pos.lineNumber+1:void 0])}let s=[o.input1Range.endLineNumberExclusive,o.baseRange.endLineNumberExclusive,o.input2Range.endLineNumberExclusive];return i=i.filter(a=>a.every((l,d)=>l!==s[d])),i.push(s),pi(()=>us(i.map(a=>a[0]).filter(ao),(a,l)=>a<l)&&us(i.map(a=>a[1]).filter(ao),(a,l)=>a<=l)&&us(i.map(a=>a[2]).filter(ao),(a,l)=>a<l)&&i.every(a=>a.filter(ao).length>=2)),i}function dW(o,e,t){let n=[],i=e.getStartPosition(),r=t.getStartPosition();for(let a of o){let l=new Ws(L.fromPositions(i,a.inputRange.getStartPosition()),L.fromPositions(r,a.outputRange.getStartPosition()));pi(()=>Xb(l.inputRange).equals(Xb(l.outputRange))),l.inputRange.isEmpty()||n.push(l),i=a.inputRange.getEndPosition(),r=a.outputRange.getEndPosition()}let s=new Ws(L.fromPositions(i,e.getEndPosition()),L.fromPositions(r,t.getEndPosition()));return pi(()=>Xb(s.inputRange).equals(Xb(s.outputRange))),s.inputRange.isEmpty()||n.push(s),n}function $8(o,e){let t=[],n=[];for(let[s,a]of[[0,o],[1,e]])for(let l of a)n.push({input:s,start:!0,inputPos:l.inputRange.getStartPosition(),outputPos:l.outputRange.getStartPosition()}),n.push({input:s,start:!1,inputPos:l.inputRange.getEndPosition(),outputPos:l.outputRange.getEndPosition()});n.sort(ui(s=>s.inputPos,V.compare));let i=[void 0,void 0],r;for(let s of n){if(r&&i.some(a=>!!a)){let a=aw(r,s.inputPos);a.isZero()||(t.push({inputPos:r,length:a,output1Pos:i[0],output2Pos:i[1]}),i[0]&&(i[0]=Qb(i[0],a)),i[1]&&(i[1]=Qb(i[1],a)))}i[s.input]=s.start?s.outputPos:void 0,r=s.inputPos}return t}var Nw=class{constructor(e,t,n){this.input1Editor=e;this.input2Editor=t;this.resultEditor=n}conflictActionsFactoryInput1=new jm(this.input1Editor);conflictActionsFactoryInput2=new jm(this.input2Editor);conflictActionsFactoryResult=new jm(this.resultEditor);computeViewZones(e,t,n){let i=0,r=0,s=0,a=0,l=[],d=[],c=[],u=[],h=t.model,m=h.baseResultDiffs.read(e),g=iw(h.modifiedBaseRanges.read(e),m,(S,w)=>S.baseRange.touches(w.inputRange)?xo.neitherLessOrGreaterThan:en.compareByStart(S.baseRange,w.inputRange)),f=n.codeLensesVisible,b=n.showNonConflictingChanges,y,C;for(let S of g){if(f&&S.left&&(S.left.isConflicting||b||!h.isHandled(S.left).read(e))){let M=new Mw(t,S.left);(n.shouldAlignResult||!M.inputIsEmpty.read(e))&&(l.push(new pv(this.conflictActionsFactoryInput1,S.left.input1Range.startLineNumber-1,M.itemsInput1)),d.push(new pv(this.conflictActionsFactoryInput2,S.left.input2Range.startLineNumber-1,M.itemsInput2)),n.shouldAlignBase&&c.push(new fM(S.left.baseRange.startLineNumber-1,16)));let N=S.left.baseRange.startLineNumber+(C?.resultingDeltaFromOriginalToModified??0)-1;u.push(new pv(this.conflictActionsFactoryResult,N,M.resultItems))}let w=S.rights.at(-1);w&&(C=w);let R;S.left?(R=cW(S.left).map(M=>({input1Line:M[0],baseLine:M[1],input2Line:M[2],resultLine:void 0})),y=S.left,R[R.length-1].resultLine=S.left.baseRange.endLineNumberExclusive+(C?C.resultingDeltaFromOriginalToModified:0)):R=[{baseLine:w.inputRange.endLineNumberExclusive,input1Line:w.inputRange.endLineNumberExclusive+(y?y.input1Range.endLineNumberExclusive-y.baseRange.endLineNumberExclusive:0),input2Line:w.inputRange.endLineNumberExclusive+(y?y.input2Range.endLineNumberExclusive-y.baseRange.endLineNumberExclusive:0),resultLine:w.outputRange.endLineNumberExclusive}];for(let{input1Line:M,baseLine:N,input2Line:A,resultLine:P}of R){if(!n.shouldAlignBase&&(M===void 0||A===void 0))continue;let K=M!==void 0?M+i:-1,j=A!==void 0?A+r:-1,X=N+s,le=P!==void 0?P+a:-1,ye=Math.max(n.shouldAlignBase?X:0,K,j,n.shouldAlignResult?le:0);if(M!==void 0){let q=ye-K;q>0&&(l.push(new $m(M-1,q)),i+=q)}if(A!==void 0){let q=ye-j;q>0&&(d.push(new $m(A-1,q)),r+=q)}if(n.shouldAlignBase){let q=ye-X;q>0&&(c.push(new $m(N-1,q)),s+=q)}if(n.shouldAlignResult&&P!==void 0){let q=ye-le;q>0&&(u.push(new $m(P-1,q)),a+=q)}}}return new gM(l,d,c,u)}},gM=class{constructor(e,t,n,i){this.input1ViewZones=e;this.input2ViewZones=t;this.baseViewZones=n;this.resultViewZones=i}},mv=class{},$m=class extends mv{constructor(t,n){super();this.afterLineNumber=t;this.heightInLines=n}create(t,n,i){n.push(t.addZone({afterLineNumber:this.afterLineNumber,heightInLines:this.heightInLines,domNode:je("div.diagonal-fill")}))}},fM=class extends mv{constructor(t,n){super();this.afterLineNumber=t;this.heightPx=n}create(t,n,i){n.push(t.addZone({afterLineNumber:this.afterLineNumber,heightInPx:this.heightPx,domNode:je("div.conflict-actions-placeholder")}))}},pv=class extends mv{constructor(t,n,i){super();this.conflictActionsFactory=t;this.lineNumber=n;this.items=i}create(t,n,i){i.add(this.conflictActionsFactory.createWidget(t,this.lineNumber,this.items,n))}};var yW=I("tab.activeBackground",Xr,p("tabActiveBackground","Active tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),QJt=I("tab.unfocusedActiveBackground",yW,p("tabUnfocusedActiveBackground","Active tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),q8=I("tab.inactiveBackground",{dark:"#2D2D2D",light:"#ECECEC",hcDark:null,hcLight:null},p("tabInactiveBackground","Inactive tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),JJt=I("tab.unfocusedInactiveBackground",q8,p("tabUnfocusedInactiveBackground","Inactive tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Ku=I("tab.activeForeground",{dark:W.white,light:"#333333",hcDark:W.white,hcLight:"#292929"},p("tabActiveForeground","Active tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),uW=I("tab.inactiveForeground",{dark:de(Ku,.5),light:de(Ku,.7),hcDark:W.white,hcLight:"#292929"},p("tabInactiveForeground","Inactive tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),een=I("tab.unfocusedActiveForeground",{dark:de(Ku,.5),light:de(Ku,.7),hcDark:W.white,hcLight:"#292929"},p("tabUnfocusedActiveForeground","Active tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ten=I("tab.unfocusedInactiveForeground",{dark:de(uW,.5),light:de(uW,.5),hcDark:W.white,hcLight:"#292929"},p("tabUnfocusedInactiveForeground","Inactive tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),hW=I("tab.hoverBackground",null,p("tabHoverBackground","Tab background color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),nen=I("tab.unfocusedHoverBackground",{dark:de(hW,.5),light:de(hW,.7),hcDark:null,hcLight:null},p("tabUnfocusedHoverBackground","Tab background color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),pW=I("tab.hoverForeground",null,p("tabHoverForeground","Tab foreground color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ien=I("tab.unfocusedHoverForeground",{dark:de(pW,.5),light:de(pW,.5),hcDark:null,hcLight:null},p("tabUnfocusedHoverForeground","Tab foreground color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),oen=I("tab.border",{dark:"#252526",light:"#F3F3F3",hcDark:ve,hcLight:ve},p("tabBorder","Border to separate tabs from each other. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),ren=I("tab.lastPinnedBorder",{dark:Qh,light:Qh,hcDark:ve,hcLight:ve},p("lastPinnedTabBorder","Border to separate pinned tabs from other tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),mW=I("tab.activeBorder",null,p("tabActiveBorder","Border on the bottom of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),sen=I("tab.unfocusedActiveBorder",{dark:de(mW,.5),light:de(mW,.7),hcDark:null,hcLight:null},p("tabActiveUnfocusedBorder","Border on the bottom of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),bM=I("tab.activeBorderTop",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},p("tabActiveBorderTop","Border to the top of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),aen=I("tab.unfocusedActiveBorderTop",{dark:de(bM,.5),light:de(bM,.7),hcDark:null,hcLight:"#B5200D"},p("tabActiveUnfocusedBorderTop","Border to the top of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),len=I("tab.selectedBorderTop",bM,p("tabSelectedBorderTop","Border to the top of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),den=I("tab.selectedBackground",yW,p("tabSelectedBackground","Background of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),cen=I("tab.selectedForeground",Ku,p("tabSelectedForeground","Foreground of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),gW=I("tab.hoverBorder",null,p("tabHoverBorder","Border to highlight tabs when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),uen=I("tab.unfocusedHoverBorder",{dark:de(gW,.5),light:de(gW,.7),hcDark:null,hcLight:ve},p("tabUnfocusedHoverBorder","Border to highlight tabs in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),hen=I("tab.dragAndDropBorder",{dark:Ku,light:Ku,hcDark:wt,hcLight:wt},p("tabDragAndDropBorder","Border between tabs to indicate that a tab can be inserted between two tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Ow=I("tab.activeModifiedBorder",{dark:"#3399CC",light:"#33AAEE",hcDark:null,hcLight:ve},p("tabActiveModifiedBorder","Border on the top of modified active tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),fW=I("tab.inactiveModifiedBorder",{dark:de(Ow,.5),light:de(Ow,.5),hcDark:W.white,hcLight:ve},p("tabInactiveModifiedBorder","Border on the top of modified inactive tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),pen=I("tab.unfocusedActiveModifiedBorder",{dark:de(Ow,.5),light:de(Ow,.7),hcDark:W.white,hcLight:ve},p("unfocusedActiveModifiedBorder","Border on the top of modified active tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),men=I("tab.unfocusedInactiveModifiedBorder",{dark:de(fW,.5),light:de(fW,.5),hcDark:W.white,hcLight:ve},p("unfocusedINactiveModifiedBorder","Border on the top of modified inactive tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),gen=I("editorPane.background",Xr,p("editorPaneBackground","Background color of the editor pane visible on the left and right side of the centered editor layout.")),fen=I("editorGroup.emptyBackground",null,p("editorGroupEmptyBackground","Background color of an empty editor group. Editor groups are the containers of editors.")),ben=I("editorGroup.focusedEmptyBorder",{dark:null,light:null,hcDark:vi,hcLight:vi},p("editorGroupFocusedEmptyBorder","Border color of an empty editor group that is focused. Editor groups are the containers of editors.")),ven=I("editorGroupHeader.tabsBackground",{dark:"#252526",light:"#F3F3F3",hcDark:null,hcLight:null},p("tabsContainerBackground","Background color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),yen=I("editorGroupHeader.tabsBorder",null,p("tabsContainerBorder","Border color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),Ien=I("editorGroupHeader.noTabsBackground",Xr,p("editorGroupHeaderBackground",'Background color of the editor group title header when (`"workbench.editor.showTabs": "single"`). Editor groups are the containers of editors.')),Cen=I("editorGroupHeader.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("editorTitleContainerBorder","Border color of the editor group title header. Editor groups are the containers of editors.")),IW=I("editorGroup.border",{dark:"#444444",light:"#E7E7E7",hcDark:ve,hcLight:ve},p("editorGroupBorder","Color to separate multiple editor groups from each other. Editor groups are the containers of editors.")),CW=I("editorGroup.dropBackground",{dark:W.fromHex("#53595D").transparent(.5),light:W.fromHex("#2677CB").transparent(.18),hcDark:null,hcLight:W.fromHex("#0F4A85").transparent(.5)},p("editorDragAndDropBackground","Background color when dragging editors around. The color should have transparency so that the editor contents can still shine through.")),Sen=I("editorGroup.dropIntoPromptForeground",fa,p("editorDropIntoPromptForeground","Foreground color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),xen=I("editorGroup.dropIntoPromptBackground",yi,p("editorDropIntoPromptBackground","Background color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),Een=I("editorGroup.dropIntoPromptBorder",{dark:null,light:null,hcDark:ve,hcLight:ve},p("editorDropIntoPromptBorder","Border color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),wen=I("sideBySideEditor.horizontalBorder",IW,p("sideBySideEditor.horizontalBorder","Color to separate two editors from each other when shown side by side in an editor group from top to bottom.")),_en=I("sideBySideEditor.verticalBorder",IW,p("sideBySideEditor.verticalBorder","Color to separate two editors from each other when shown side by side in an editor group from left to right.")),Y8=I("panel.background",Xr,p("panelBackground","Panel background color. Panels are shown below the editor area and contain views like output and integrated terminal.")),Pw=I("panel.border",{dark:W.fromHex("#808080").transparent(.35),light:W.fromHex("#808080").transparent(.35),hcDark:ve,hcLight:ve},p("panelBorder","Panel border color to separate the panel from the editor. Panels are shown below the editor area and contain views like output and integrated terminal.")),gv=I("panelTitle.activeForeground",{dark:"#E7E7E7",light:"#424242",hcDark:W.white,hcLight:ga},p("panelActiveTitleForeground","Title color for the active panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),Ten=I("panelTitle.inactiveForeground",{dark:de(gv,.6),light:de(gv,.75),hcDark:W.white,hcLight:ga},p("panelInactiveTitleForeground","Title color for the inactive panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),Len=I("panelTitle.activeBorder",{dark:gv,light:gv,hcDark:ve,hcLight:"#B5200D"},p("panelActiveTitleBorder","Border color for the active panel title. Panels are shown below the editor area and contain views like output and integrated terminal.")),Den=I("panelInput.border",{dark:hl,light:W.fromHex("#ddd"),hcDark:hl,hcLight:hl},p("panelInputBorder","Input box border for inputs in the panel.")),Ren=I("panel.dropBorder",gv,p("panelDragAndDropBorder","Drag and drop feedback color for the panel titles. Panels are shown below the editor area and contain views like output and integrated terminal.")),ken=I("panelSection.dropBackground",CW,p("panelSectionDragAndDropBackground","Drag and drop feedback color for the panel sections. The color should have transparency so that the panel sections can still shine through. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Men=I("panelSectionHeader.background",{dark:W.fromHex("#808080").transparent(.2),light:W.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},p("panelSectionHeaderBackground","Panel section header background color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Nen=I("panelSectionHeader.foreground",null,p("panelSectionHeaderForeground","Panel section header foreground color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Aen=I("panelSectionHeader.border",ve,p("panelSectionHeaderBorder","Panel section header border color used when multiple views are stacked vertically in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Oen=I("panelSection.border",Pw,p("panelSectionBorder","Panel section border color used when multiple views are stacked horizontally in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Pen=I("panelStickyScroll.background",Y8,p("panelStickyScrollBackground","Background color of sticky scroll in the panel.")),Fen=I("panelStickyScroll.border",null,p("panelStickyScrollBorder","Border color of sticky scroll in the panel.")),Ben=I("panelStickyScroll.shadow",Rd,p("panelStickyScrollShadow","Shadow color of sticky scroll in the panel.")),Z8=I("outputView.background",null,p("outputViewBackground","Output view background color."));I("outputViewStickyScroll.background",Z8,p("outputViewStickyScrollBackground","Output view sticky scroll background color."));var Ven=I("banner.background",{dark:Mo,light:Qi(Mo,.3),hcDark:Mo,hcLight:Mo},p("banner.background","Banner background color. The banner is shown under the title bar of the window.")),Wen=I("banner.foreground",ba,p("banner.foreground","Banner foreground color. The banner is shown under the title bar of the window.")),Hen=I("banner.iconForeground",sr,p("banner.iconForeground","Banner icon color. The banner is shown under the title bar of the window.")),sc=I("statusBar.foreground",{dark:"#FFFFFF",light:"#FFFFFF",hcDark:"#FFFFFF",hcLight:ga},p("statusBarForeground","Status bar foreground color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),Uen=I("statusBar.noFolderForeground",sc,p("statusBarNoFolderForeground","Status bar foreground color when no folder is opened. The status bar is shown in the bottom of the window.")),zen=I("statusBar.background",{dark:"#007ACC",light:"#007ACC",hcDark:null,hcLight:null},p("statusBarBackground","Status bar background color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),Ken=I("statusBar.noFolderBackground",{dark:"#68217A",light:"#68217A",hcDark:null,hcLight:null},p("statusBarNoFolderBackground","Status bar background color when no folder is opened. The status bar is shown in the bottom of the window.")),X8=I("statusBar.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("statusBarBorder","Status bar border color separating to the sidebar and editor. The status bar is shown in the bottom of the window.")),Gen=I("statusBar.focusBorder",{dark:sc,light:sc,hcDark:null,hcLight:sc},p("statusBarFocusBorder","Status bar border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),jen=I("statusBar.noFolderBorder",X8,p("statusBarNoFolderBorder","Status bar border color separating to the sidebar and editor when no folder is opened. The status bar is shown in the bottom of the window.")),$en=I("statusBarItem.activeBackground",{dark:W.white.transparent(.18),light:W.white.transparent(.18),hcDark:W.white.transparent(.18),hcLight:W.black.transparent(.18)},p("statusBarItemActiveBackground","Status bar item background color when clicking. The status bar is shown in the bottom of the window.")),qen=I("statusBarItem.focusBorder",{dark:sc,light:sc,hcDark:null,hcLight:wt},p("statusBarItemFocusBorder","Status bar item border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),ac=I("statusBarItem.hoverBackground",{dark:W.white.transparent(.12),light:W.white.transparent(.12),hcDark:W.white.transparent(.12),hcLight:W.black.transparent(.12)},p("statusBarItemHoverBackground","Status bar item background color when hovering. The status bar is shown in the bottom of the window.")),bv=I("statusBarItem.hoverForeground",sc,p("statusBarItemHoverForeground","Status bar item foreground color when hovering. The status bar is shown in the bottom of the window.")),Yen=I("statusBarItem.compactHoverBackground",{dark:W.white.transparent(.2),light:W.white.transparent(.2),hcDark:W.white.transparent(.2),hcLight:W.black.transparent(.2)},p("statusBarItemCompactHoverBackground","Status bar item background color when hovering an item that contains two hovers. The status bar is shown in the bottom of the window.")),Zen=I("statusBarItem.prominentForeground",sc,p("statusBarProminentItemForeground","Status bar prominent items foreground color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),Xen=I("statusBarItem.prominentBackground",W.black.transparent(.5),p("statusBarProminentItemBackground","Status bar prominent items background color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),Qen=I("statusBarItem.prominentHoverForeground",bv,p("statusBarProminentItemHoverForeground","Status bar prominent items foreground color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),Jen=I("statusBarItem.prominentHoverBackground",{dark:W.black.transparent(.3),light:W.black.transparent(.3),hcDark:W.black.transparent(.3),hcLight:null},p("statusBarProminentItemHoverBackground","Status bar prominent items background color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),etn=I("statusBarItem.errorBackground",{dark:Qi(bD,.4),light:Qi(bD,.4),hcDark:null,hcLight:"#B5200D"},p("statusBarErrorItemBackground","Status bar error items background color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),ttn=I("statusBarItem.errorForeground",W.white,p("statusBarErrorItemForeground","Status bar error items foreground color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),ntn=I("statusBarItem.errorHoverForeground",bv,p("statusBarErrorItemHoverForeground","Status bar error items foreground color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),itn=I("statusBarItem.errorHoverBackground",ac,p("statusBarErrorItemHoverBackground","Status bar error items background color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),otn=I("statusBarItem.warningBackground",{dark:Qi(fo,.4),light:Qi(fo,.4),hcDark:null,hcLight:"#895503"},p("statusBarWarningItemBackground","Status bar warning items background color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),rtn=I("statusBarItem.warningForeground",W.white,p("statusBarWarningItemForeground","Status bar warning items foreground color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),stn=I("statusBarItem.warningHoverForeground",bv,p("statusBarWarningItemHoverForeground","Status bar warning items foreground color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),atn=I("statusBarItem.warningHoverBackground",ac,p("statusBarWarningItemHoverBackground","Status bar warning items background color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),ltn=I("activityBar.background",{dark:"#333333",light:"#2C2C2C",hcDark:"#000000",hcLight:"#FFFFFF"},p("activityBarBackground","Activity bar background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),qm=I("activityBar.foreground",{dark:W.white,light:W.white,hcDark:W.white,hcLight:ga},p("activityBarForeground","Activity bar item foreground color when it is active. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),dtn=I("activityBar.inactiveForeground",{dark:de(qm,.4),light:de(qm,.4),hcDark:W.white,hcLight:ga},p("activityBarInActiveForeground","Activity bar item foreground color when it is inactive. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ctn=I("activityBar.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("activityBarBorder","Activity bar border color separating to the side bar. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),utn=I("activityBar.activeBorder",{dark:qm,light:qm,hcDark:ve,hcLight:ve},p("activityBarActiveBorder","Activity bar border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),htn=I("activityBar.activeFocusBorder",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},p("activityBarActiveFocusBorder","Activity bar focus border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ptn=I("activityBar.activeBackground",null,p("activityBarActiveBackground","Activity bar background color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),mtn=I("activityBar.dropBorder",{dark:qm,light:qm,hcDark:null,hcLight:null},p("activityBarDragAndDropBorder","Drag and drop feedback color for the activity bar items. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),SW=I("activityBarBadge.background",{dark:"#007ACC",light:"#007ACC",hcDark:"#000000",hcLight:"#0F4A85"},p("activityBarBadgeBackground","Activity notification badge background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),xW=I("activityBarBadge.foreground",W.white,p("activityBarBadgeForeground","Activity notification badge foreground color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),fv=I("activityBarTop.foreground",{dark:"#E7E7E7",light:"#424242",hcDark:W.white,hcLight:ga},p("activityBarTop","Active foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),gtn=I("activityBarTop.activeBorder",{dark:fv,light:fv,hcDark:ve,hcLight:"#B5200D"},p("activityBarTopActiveFocusBorder","Focus border color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),ftn=I("activityBarTop.activeBackground",null,p("activityBarTopActiveBackground","Background color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),btn=I("activityBarTop.inactiveForeground",{dark:de(fv,.6),light:de(fv,.75),hcDark:W.white,hcLight:ga},p("activityBarTopInActiveForeground","Inactive foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),vtn=I("activityBarTop.dropBorder",fv,p("activityBarTopDragAndDropBorder","Drag and drop feedback color for the items in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),ytn=I("activityBarTop.background",null,p("activityBarTopBackground","Background color of the activity bar when set to top / bottom.")),Itn=I("profileBadge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:W.white,hcLight:W.black},p("profileBadgeBackground","Profile badge background color. The profile badge shows on top of the settings gear icon in the activity bar.")),Ctn=I("profileBadge.foreground",{dark:W.white,light:"#333333",hcDark:W.black,hcLight:W.white},p("profileBadgeForeground","Profile badge foreground color. The profile badge shows on top of the settings gear icon in the activity bar.")),Stn=I("statusBarItem.remoteBackground",SW,p("statusBarItemHostBackground","Background color for the remote indicator on the status bar.")),Q8=I("statusBarItem.remoteForeground",xW,p("statusBarItemHostForeground","Foreground color for the remote indicator on the status bar.")),xtn=I("statusBarItem.remoteHoverForeground",bv,p("statusBarRemoteItemHoverForeground","Foreground color for the remote indicator on the status bar when hovering.")),Etn=I("statusBarItem.remoteHoverBackground",{dark:ac,light:ac,hcDark:ac,hcLight:null},p("statusBarRemoteItemHoverBackground","Background color for the remote indicator on the status bar when hovering.")),wtn=I("statusBarItem.offlineBackground","#6c1717",p("statusBarItemOfflineBackground","Status bar item background color when the workbench is offline.")),_tn=I("statusBarItem.offlineForeground",Q8,p("statusBarItemOfflineForeground","Status bar item foreground color when the workbench is offline.")),Ttn=I("statusBarItem.offlineHoverForeground",bv,p("statusBarOfflineItemHoverForeground","Status bar item foreground hover color when the workbench is offline.")),Ltn=I("statusBarItem.offlineHoverBackground",{dark:ac,light:ac,hcDark:ac,hcLight:null},p("statusBarOfflineItemHoverBackground","Status bar item background hover color when the workbench is offline.")),Dtn=I("extensionBadge.remoteBackground",SW,p("extensionBadge.remoteBackground","Background color for the remote badge in the extensions view.")),Rtn=I("extensionBadge.remoteForeground",xW,p("extensionBadge.remoteForeground","Foreground color for the remote badge in the extensions view.")),EW=I("sideBar.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},p("sideBarBackground","Side bar background color. The side bar is the container for views like explorer and search.")),wW=I("sideBar.foreground",null,p("sideBarForeground","Side bar foreground color. The side bar is the container for views like explorer and search.")),ktn=I("sideBar.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("sideBarBorder","Side bar border color on the side separating to the editor. The side bar is the container for views like explorer and search.")),Mtn=I("sideBarTitle.background",EW,p("sideBarTitleBackground","Side bar title background color. The side bar is the container for views like explorer and search.")),Ntn=I("sideBarTitle.foreground",wW,p("sideBarTitleForeground","Side bar title foreground color. The side bar is the container for views like explorer and search.")),Atn=I("sideBar.dropBackground",CW,p("sideBarDragAndDropBackground","Drag and drop feedback color for the side bar sections. The color should have transparency so that the side bar sections can still shine through. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),Otn=I("sideBarSectionHeader.background",{dark:W.fromHex("#808080").transparent(.2),light:W.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},p("sideBarSectionHeaderBackground","Side bar section header background color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),Ptn=I("sideBarSectionHeader.foreground",wW,p("sideBarSectionHeaderForeground","Side bar section header foreground color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),J8=I("sideBarSectionHeader.border",ve,p("sideBarSectionHeaderBorder","Side bar section header border color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),Ftn=I("sideBarActivityBarTop.border",J8,p("sideBarActivityBarTopBorder","Border color between the activity bar at the top/bottom and the views.")),Btn=I("sideBarStickyScroll.background",EW,p("sideBarStickyScrollBackground","Background color of sticky scroll in the side bar.")),Vtn=I("sideBarStickyScroll.border",null,p("sideBarStickyScrollBorder","Border color of sticky scroll in the side bar.")),Wtn=I("sideBarStickyScroll.shadow",Rd,p("sideBarStickyScrollShadow","Shadow color of sticky scroll in the side bar.")),za=I("titleBar.activeForeground",{dark:"#CCCCCC",light:"#333333",hcDark:"#FFFFFF",hcLight:"#292929"},p("titleBarActiveForeground","Title bar foreground when the window is active.")),_W=I("titleBar.inactiveForeground",{dark:de(za,.6),light:de(za,.6),hcDark:null,hcLight:"#292929"},p("titleBarInactiveForeground","Title bar foreground when the window is inactive.")),bW=I("titleBar.activeBackground",{dark:"#3C3C3C",light:"#DDDDDD",hcDark:"#000000",hcLight:"#FFFFFF"},p("titleBarActiveBackground","Title bar background when the window is active.")),Htn=I("titleBar.inactiveBackground",{dark:de(bW,.6),light:de(bW,.6),hcDark:null,hcLight:null},p("titleBarInactiveBackground","Title bar background when the window is inactive.")),Utn=I("titleBar.border",{dark:null,light:null,hcDark:ve,hcLight:ve},p("titleBarBorder","Title bar border color.")),e3=I("menubar.selectionForeground",za,p("menubarSelectionForeground","Foreground color of the selected menu item in the menubar.")),vW=I("menubar.selectionBackground",{dark:Ef,light:Ef,hcDark:null,hcLight:null},p("menubarSelectionBackground","Background color of the selected menu item in the menubar.")),ztn=I("menubar.selectionBorder",{dark:null,light:null,hcDark:wt,hcLight:wt},p("menubarSelectionBorder","Border color of the selected menu item in the menubar.")),Ktn=I("commandCenter.foreground",za,p("commandCenter-foreground","Foreground color of the command center"),!1),Gtn=I("commandCenter.activeForeground",e3,p("commandCenter-activeForeground","Active foreground color of the command center"),!1),jtn=I("commandCenter.inactiveForeground",_W,p("commandCenter-inactiveForeground","Foreground color of the command center when the window is inactive"),!1),$tn=I("commandCenter.background",{dark:W.white.transparent(.05),hcDark:null,light:W.black.transparent(.05),hcLight:null},p("commandCenter-background","Background color of the command center"),!1),qtn=I("commandCenter.activeBackground",{dark:W.white.transparent(.08),hcDark:vW,light:W.black.transparent(.08),hcLight:vW},p("commandCenter-activeBackground","Active background color of the command center"),!1),Ytn=I("commandCenter.border",{dark:de(za,.2),hcDark:ve,light:de(za,.2),hcLight:ve},p("commandCenter-border","Border color of the command center"),!1),Ztn=I("commandCenter.activeBorder",{dark:de(za,.3),hcDark:za,light:de(za,.3),hcLight:za},p("commandCenter-activeBorder","Active border color of the command center"),!1),Xtn=I("commandCenter.inactiveBorder",de(_W,.25),p("commandCenter-inactiveBorder","Border color of the command center when the window is inactive"),!1),Qtn=I("notificationCenter.border",{dark:Lf,light:Lf,hcDark:ve,hcLight:ve},p("notificationCenterBorder","Notifications center border color. Notifications slide in from the bottom right of the window.")),Jtn=I("notificationToast.border",{dark:Lf,light:Lf,hcDark:ve,hcLight:ve},p("notificationToastBorder","Notification toast border color. Notifications slide in from the bottom right of the window.")),enn=I("notifications.foreground",fa,p("notificationsForeground","Notifications foreground color. Notifications slide in from the bottom right of the window.")),Aw=I("notifications.background",yi,p("notificationsBackground","Notifications background color. Notifications slide in from the bottom right of the window.")),tnn=I("notificationLink.foreground",kI,p("notificationsLink","Notification links foreground color. Notifications slide in from the bottom right of the window.")),nnn=I("notificationCenterHeader.foreground",null,p("notificationCenterHeaderForeground","Notifications center header foreground color. Notifications slide in from the bottom right of the window.")),t3=I("notificationCenterHeader.background",{dark:go(Aw,.3),light:Qi(Aw,.05),hcDark:Aw,hcLight:Aw},p("notificationCenterHeaderBackground","Notifications center header background color. Notifications slide in from the bottom right of the window.")),inn=I("notifications.border",t3,p("notificationsBorder","Notifications border color separating from other notifications in the notifications center. Notifications slide in from the bottom right of the window.")),onn=I("notificationsErrorIcon.foreground",zc,p("notificationsErrorIconForeground","The color used for the icon of error notifications. Notifications slide in from the bottom right of the window.")),rnn=I("notificationsWarningIcon.foreground",fo,p("notificationsWarningIconForeground","The color used for the icon of warning notifications. Notifications slide in from the bottom right of the window.")),snn=I("notificationsInfoIcon.foreground",sr,p("notificationsInfoIconForeground","The color used for the icon of info notifications. Notifications slide in from the bottom right of the window.")),ann=I("window.activeBorder",{dark:null,light:null,hcDark:ve,hcLight:ve},p("windowActiveBorder","The color used for the border of the window when it is active. Only supported in the macOS and Linux desktop client when using the custom title bar.")),lnn=I("window.inactiveBorder",{dark:null,light:null,hcDark:ve,hcLight:ve},p("windowInactiveBorder","The color used for the border of the window when it is inactive. Only supported in the macOS and Linux desktop client when using the custom title bar."));var n3=I("settings.headerForeground",{light:"#444444",dark:"#e7e7e7",hcDark:"#ffffff",hcLight:"#292929"},p("headerForeground","The foreground color for a section header or active title.")),mnn=I("settings.settingsHeaderHoverForeground",de(n3,.7),p("settingsHeaderHoverForeground","The foreground color for a section header or hovered title.")),gnn=I("settings.modifiedItemIndicator",{light:new W(new ze(102,175,224)),dark:new W(new ze(12,125,157)),hcDark:new W(new ze(0,73,122)),hcLight:new W(new ze(102,175,224))},p("modifiedItemForeground","The color of the modified setting indicator.")),fnn=I("settings.headerBorder",Pw,p("settingsHeaderBorder","The color of the header container border.")),TW=I("settings.sashBorder",Pw,p("settingsSashBorder","The color of the Settings editor splitview sash border.")),bnn=I("settings.dropdownBackground",Md,p("settingsDropdownBackground","Settings editor dropdown background.")),vnn=I("settings.dropdownForeground",Kc,p("settingsDropdownForeground","Settings editor dropdown foreground.")),ynn=I("settings.dropdownBorder",Gc,p("settingsDropdownBorder","Settings editor dropdown border.")),Inn=I("settings.dropdownListBorder",Tf,p("settingsDropdownListBorder","Settings editor dropdown list border. This surrounds the options and separates the options from the description.")),Cnn=I("settings.checkboxBackground",PI,p("settingsCheckboxBackground","Settings editor checkbox background.")),Snn=I("settings.checkboxForeground",FI,p("settingsCheckboxForeground","Settings editor checkbox foreground.")),xnn=I("settings.checkboxBorder",BI,p("settingsCheckboxBorder","Settings editor checkbox border.")),Enn=I("settings.textInputBackground",Df,p("textInputBoxBackground","Settings editor text input box background.")),wnn=I("settings.textInputForeground",Rf,p("textInputBoxForeground","Settings editor text input box foreground.")),_nn=I("settings.textInputBorder",hl,p("textInputBoxBorder","Settings editor text input box border.")),Tnn=I("settings.numberInputBackground",Df,p("numberInputBoxBackground","Settings editor number input box background.")),Lnn=I("settings.numberInputForeground",Rf,p("numberInputBoxForeground","Settings editor number input box foreground.")),Dnn=I("settings.numberInputBorder",hl,p("numberInputBoxBorder","Settings editor number input box border.")),Rnn=I("settings.focusedRowBackground",{dark:de(Nd,.6),light:de(Nd,.6),hcDark:null,hcLight:null},p("focusedRowBackground","The background color of a settings row when focused.")),knn=I("settings.rowHoverBackground",{dark:de(Nd,.3),light:de(Nd,.3),hcDark:null,hcLight:null},p("settings.rowHoverBackground","The background color of a settings row when hovered.")),Mnn=I("settings.focusedRowBorder",vi,p("settings.focusedRowBorder","The color of the row's top and bottom border when the row is focused."));function LW(o){switch(o){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function DW(o){switch(o){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function Ym(o){let e=0;for(let t=0;;t+=7){let n=o.read(1);if(e|=(n.buffer[0]&127)<<t,!(n.buffer[0]&128))return e}}var i3=lc(0);function Zm(o,e){if(e===0){o.write(i3);return}let t=0;for(let i=e;i!==0;i=i>>>7)t++;let n=vn.alloc(t);for(let i=0;e!==0;i++)n.buffer[i]=e&127,e=e>>>7,e>0&&(n.buffer[i]|=128);o.write(n)}var yM=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},IM=class{buffers=[];get buffer(){return vn.concat(this.buffers)}write(e){this.buffers.push(e)}};function lc(o){let e=vn.alloc(1);return e.writeUInt8(o,0),e}var Gu={Undefined:lc(0),String:lc(1),Buffer:lc(2),VSBuffer:lc(3),Array:lc(4),Object:lc(5),Uint:lc(6)},o3=typeof Buffer<"u";function CM(o,e){if(typeof e>"u")o.write(Gu.Undefined);else if(typeof e=="string"){let t=vn.fromString(e);o.write(Gu.String),Zm(o,t.byteLength),o.write(t)}else if(o3&&Buffer.isBuffer(e)){let t=vn.wrap(e);o.write(Gu.Buffer),Zm(o,t.byteLength),o.write(t)}else if(e instanceof vn)o.write(Gu.VSBuffer),Zm(o,e.byteLength),o.write(e);else if(Array.isArray(e)){o.write(Gu.Array),Zm(o,e.length);for(let t of e)CM(o,t)}else if(typeof e=="number"&&(e|0)===e)o.write(Gu.Uint),Zm(o,e);else{let t=vn.fromString(JSON.stringify(e));o.write(Gu.Object),Zm(o,t.byteLength),o.write(t)}}function SM(o){switch(o.read(1).readUInt8(0)){case 0:return;case 1:return o.read(Ym(o)).toString();case 2:return o.read(Ym(o)).buffer;case 3:return o.read(Ym(o));case 4:{let t=Ym(o),n=[];for(let i=0;i<t;i++)n.push(SM(o));return n}case 5:return JSON.parse(o.read(Ym(o)).toString());case 6:return Ym(o)}}var vM=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(n=>this.onBuffer(n)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new T;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(n,i,r){return t.isDisposed?Promise.reject(new Ui):t.requestPromise(e,n,i,r)},listen(n,i){return t.isDisposed?Y.None:t.requestEvent(e,n,i)}}}requestPromise(e,t,n,i=Xt.None){let r=this.lastRequestId++,a={id:r,type:100,channelName:e,name:t,arg:n};if(i.isCancellationRequested)return Promise.reject(new Ui);let l;return new Promise((c,u)=>{if(i.isCancellationRequested)return u(new Ui);let h=()=>{let b=y=>{switch(y.type){case 201:this.handlers.delete(r),c(y.data);break;case 202:{this.handlers.delete(r);let C=new Error(y.data.message);C.stack=Array.isArray(y.data.stack)?y.data.stack.join(`
`):y.data.stack,C.name=y.data.name,u(C);break}case 203:this.handlers.delete(r),u(y.data);break}};this.handlers.set(r,b),this.sendRequest(a)},m=null;this.state===1?h():(m=la(b=>this.whenInitialized()),m.then(()=>{m=null,h()}));let g=()=>{m?(m.cancel(),m=null):this.sendRequest({id:r,type:101}),u(new Ui)},f=i.onCancellationRequested(g);l=Zo(pe(g),f),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(e,t,n){let i=this.lastRequestId++,s={id:i,type:102,channelName:e,name:t,arg:n},a=null,l=new T({onWillAddFirstListener:()=>{a=la(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:i,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(i,d),l.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${LW(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,LW(e.type));return}}}send(e,t=void 0){let n=new IM;return CM(n,e),CM(n,t),this.sendBuffer(n.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new yM(e),n=SM(t),i=SM(t),r=n[0];switch(r){case 200:return this.logger?.logIncoming(e.byteLength,0,0,DW(r)),this.onResponse({type:n[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,n[1],0,DW(r),i),this.onResponse({type:n[0],id:n[1],data:i})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return Y.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),Nt(this.activeRequests.values()),this.activeRequests.clear()}};k([he],vM.prototype,"onDidInitializePromise",1);var r3;(i=>{function o(r,s,a){let l=r,d=a&&a.disableMarshalling,c=new Map;for(let u in l)t(u)&&c.set(u,Y.buffer(l[u],!0,void 0,s));return new class{listen(u,h,m){let g=c.get(h);if(g)return g;let f=l[h];if(typeof f=="function"){if(n(h))return f.call(l,m);if(t(h))return c.set(h,Y.buffer(l[h],!0,void 0,s)),c.get(h)}throw new ja(`Event not found: ${h}`)}call(u,h,m){let g=l[h];if(typeof g=="function"){if(!d&&Array.isArray(m))for(let b=0;b<m.length;b++)m[b]=gp(m[b]);let f=g.apply(l,m);return f instanceof Promise||(f=Promise.resolve(f)),f}throw new ja(`Method not found: ${h}`)}}}i.fromService=o;function e(r,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):n(d)?function(c){return r.listen(d,c)}:t(d)?r.listen(d):async function(...c){let u;s&&!Mi(s.context)?u=[s.context,...c]:u=c;let h=await r.call(d,u);return a?h:gp(h)};throw new ja(`Property not found: ${String(d)}`)}})}i.toService=e;function t(r){return r[0]==="o"&&r[1]==="n"&&na(r.charCodeAt(2))}function n(r){return/^onDynamic/.test(r)&&na(r.charCodeAt(9))}})(r3||={});var s3="diagnosticsService",gin=Z(s3);var a3;(s=>{s.enableDiagnostics=!1,s.records=[];let t=new WeakMap,n=0;function i(a,l){if(!t.has(a)){let d=String(++n);t.set(a,d)}return t.get(a)}function r(a,l,d,c){}s.traceSocketEvent=r})(a3||={});var Nin=Z("remoteAuthorityResolverService");var Kin=Z("remoteSocketFactoryService");var l3="signService",$in=Z(l3);var Eon=30*1e3;var RW=Z("remoteAgentService"),Kon=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(o){let e=1/0;for(let n=0;n<this.maxSampleCount;n++){let i=await o.getRoundTripTime();if(i===void 0)return;e=Math.min(e,i/2),await nr(this.sampleDelay)}this.average.push(e),this.average.length>this.maxAverageCount&&this.average.shift();let t;return this.initial.length<this.maxInitialCount?this.initial.push(e):t=this.initial.reduce((n,i)=>n+i,0)/this.initial.length,this.lastMeasurement={initial:t,current:e,average:this.average.reduce((n,i)=>n+i,0)/this.average.length,high:typeof t>"u"?!1:e>this.highLatencyMaxThreshold||e>this.highLatencyMinThreshold&&e>t*this.highLatencyMultiple},this.lastMeasurement}};var frn=Object.freeze({id:"application",order:100,title:p("applicationConfigurationTitle","Application"),type:"object"}),kW=Object.freeze({id:"workbench",order:7,title:p("workbenchConfigurationTitle","Workbench"),type:"object"}),d3=Object.freeze({id:"security",scope:1,title:p("securityConfigurationTitle","Security"),type:"object",order:7}),brn=Object.freeze({id:"problems",title:p("problemsConfigurationTitle","Problems"),type:"object",order:101}),c3=Object.freeze({id:"window",order:8,title:p("windowConfigurationTitle","Window"),type:"object"}),u3={ConfigurationMigration:"base.contributions.configuration.migration"},xM=class{migrations=[];_onDidRegisterConfigurationMigrations=new T;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(e){this.migrations.push(...e)}},Ww=new xM;Je.add(u3.ConfigurationMigration,Ww);var Fw=class extends B{constructor(t,n){super();this.configurationService=t;this.workspaceService=n;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(let r of i.added)await this.migrateConfigurationsForFolder(r,Ww.migrations)})),this.migrateConfigurations(Ww.migrations),this._register(Ww.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(t){await this.migrateConfigurationsForFolder(void 0,t);for(let n of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(n,t)}async migrateConfigurationsForFolder(t,n){await Promise.all([n.map(i=>this.migrateConfigurationsForFolderAndOverride(i,t?.uri))])}async migrateConfigurationsForFolderAndOverride(t,n){let i=this.configurationService.inspect(t.key,{resource:n}),r=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of r){let l=i[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(t,s,l.value,n,void 0);for(let u of c??[])d.push([u,[]])}for(let{identifiers:c,value:u}of l.overrides??[])if(u!==void 0){let h=await this.runMigration(t,s,u,n,c);for(let m of h??[])d.push([m,c])}d.length&&await Promise.allSettled(d.map(async([[c,u],h])=>this.configurationService.updateValue(c,u.value,{resource:n,overrideIdentifiers:h},a)))}}async runMigration(t,n,i,r,s){let a=d=>{let u=this.configurationService.inspect(d,{resource:r})[n];if(u)return s?u.overrides?.find(({identifiers:h})=>Ai(h,s))?.value:u.value},l=await t.migrateFn(i,a);return Array.isArray(l)?l:[[t.key,l]]}};Fw=k([E(0,rt),E(1,pd)],Fw);var Bw=class extends B{constructor(t){super();this.remoteAgentService=t;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new yd;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!ft&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;Je.as($r.Configuration).registerConfiguration({...d3,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:p("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:p("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:p("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};Bw=k([E(0,RW)],Bw);var vv="window.newWindowProfile",Vw=class extends B{constructor(t,n){super();this.userDataProfilesService=t;this.configurationService=n;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(i=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(n.onDidChangeConfiguration(i=>{i.source!==7&&i.affectsConfiguration(vv)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let t=Je.as($r.Configuration),n={...c3,properties:{[vv]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(i=>i.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(i=>""),p("active window","Active Window")],description:p("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?t.updateConfigurations({add:[n],remove:[this.configurationNode]}):t.registerConfiguration(n),this.configurationNode=n}setNewWindowProfile(){let t=this.configurationService.getValue(vv);this.newWindowProfile=t?this.userDataProfilesService.profiles.find(n=>n.name===t):void 0}checkAndResetNewWindowProfileConfig(){let t=this.configurationService.getValue(vv);if(!t)return;let n=this.newWindowProfile?this.userDataProfilesService.profiles.find(i=>i.id===this.newWindowProfile.id):void 0;t!==n?.name&&this.configurationService.updateValue(vv,n?.name)}};Vw=k([E(0,iB),E(1,rt)],Vw);var MW=Z("editorResolverService");var h3=Je.as($r.Configuration),p3={...kW,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:p("editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};h3.registerConfiguration(p3);var zn=class extends oc{constructor(t,n,i,r,s,a,l,d,c,u,h,m,g){super(zn.ID,t,r,n,s,l,a,c,u,h);this.contextKeyService=i;this._configurationService=d;this._codeEditorService=m;this.configurationService=g}static ID="mergeEditor";_sessionDisposables=new oe;_viewModel=fn(this,void 0);get viewModel(){return this._viewModel}rootHtmlElement;_grid=this._register(new rn);input1View=this._register(this.instantiationService.createInstance(zu,1,this._viewModel));baseView=fn(this,void 0);baseViewOptions=fn(this,void 0);input2View=this._register(this.instantiationService.createInstance(zu,2,this._viewModel));inputResultView=this._register(this.instantiationService.createInstance(Fm,this._viewModel));_layoutMode=this.instantiationService.createInstance(dc);_layoutModeObs=fn(this,this._layoutMode.value);_ctxIsMergeEditor=jt.bindTo(this.contextKeyService);_ctxUsesColumnLayout=nc.bindTo(this.contextKeyService);_ctxShowBase=Pm.bindTo(this.contextKeyService);_ctxShowBaseAtTop=dv.bindTo(this.contextKeyService);_ctxResultUri=oW.bindTo(this.contextKeyService);_ctxBaseUri=iW.bindTo(this.contextKeyService);_ctxShowNonConflictingChanges=Tw.bindTo(this.contextKeyService);_inputModel=fn(this,void 0);get inputModel(){return this._inputModel}get model(){return this.inputModel.get()?.model}get inputsWritable(){return!!this._configurationService.getValue("mergeEditor.writableInputs")}viewZoneComputer=new Nw(this.input1View.editor,this.input2View.editor,this.inputResultView.editor);codeLensesVisible=Wa("mergeEditor.showCodeLenses",!0,this.configurationService);scrollSynchronizer=this._register(new Rw(this._viewModel,this.input1View,this.input2View,this.baseView,this.inputResultView,this._layoutModeObs));dispose(){this._sessionDisposables.dispose(),this._ctxIsMergeEditor.reset(),this._ctxUsesColumnLayout.reset(),this._ctxShowNonConflictingChanges.reset(),super.dispose()}_onDidChangeSizeConstraints=new T;onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event;get minimumWidth(){return this._layoutMode.value.kind==="mixed"?this.input1View.view.minimumWidth+this.input2View.view.minimumWidth:this.input1View.view.minimumWidth+this.input2View.view.minimumWidth+this.inputResultView.view.minimumWidth}getTitle(){return this.input?this.input.getName():p("mergeEditor","Text Merge Editor")}createEditorControl(t,n){this.rootHtmlElement=t,t.classList.add("merge-editor"),this.applyLayout(this._layoutMode.value),this.applyOptions(n)}updateEditorControlOptions(t){this.applyOptions(t)}applyOptions(t){let n=hk(t,{minimap:{enabled:!1},glyphMargin:!1,lineNumbersMinChars:2,readOnly:!this.inputsWritable});this.input1View.updateOptions(n),this.input2View.updateOptions(n),this.baseViewOptions.set({...this.input2View.editor.getRawOptions()},void 0),this.inputResultView.updateOptions(t)}getMainControl(){return this.inputResultView.editor}layout(t){this._grid.value?.layout(t.width,t.height)}async setInput(t,n,i,r){if(!(t instanceof Hi))throw new Te("ONLY MergeEditorInput is supported");await super.setInput(t,n,i,r),this._sessionDisposables.clear(),et(h=>{this._viewModel.set(void 0,h),this._inputModel.set(void 0,h)});let s=await t.resolve(),a=s.model,l=this.instantiationService.createInstance(Bm,a,this.input1View,this.input2View,this.inputResultView,this.baseView,this.showNonConflictingChanges);a.telemetry.reportMergeEditorOpened({combinableConflictCount:a.combinableConflictCount,conflictCount:a.conflictCount,baseTop:this._layoutModeObs.get().showBaseAtTop,baseVisible:this._layoutModeObs.get().showBase,isColumnView:this._layoutModeObs.get().kind==="columns"}),et(h=>{this._viewModel.set(l,h),this._inputModel.set(s,h)}),this._sessionDisposables.add(l),this._ctxResultUri.set(s.resultUri.toString()),this._ctxBaseUri.set(a.base.uri.toString()),this._sessionDisposables.add(pe(()=>{this._ctxBaseUri.reset(),this._ctxResultUri.reset()})),this._sessionDisposables.add(Qa((h,m)=>{let g=this.baseView.read(h);this.inputResultView.editor.changeViewZones(f=>{let b=this._layoutModeObs.read(h),y=b.kind==="columns",C=b.kind==="mixed"&&!b.showBaseAtTop;this.input1View.editor.changeViewZones(S=>{this.input2View.editor.changeViewZones(w=>{g?g.editor.changeViewZones(R=>{m.add(this.setViewZones(h,l,this.input1View.editor,S,this.input2View.editor,w,g.editor,R,C,this.inputResultView.editor,f,y))}):m.add(this.setViewZones(h,l,this.input1View.editor,S,this.input2View.editor,w,void 0,void 0,!1,this.inputResultView.editor,f,y))})})}),this.scrollSynchronizer.updateScrolling()}));let d=this.loadEditorViewState(t,i);d?this._applyViewState(d):this._sessionDisposables.add(FV(a.onInitialized,()=>{let h=a.modifiedBaseRanges.get().find(m=>m.isConflicting);h&&(this.input1View.editor.revealLineInCenter(h.input1Range.startLineNumber),et(m=>{l.setActiveModifiedBaseRange(h,m)}))}));let c=h=>{let m=Km(h,this._codeEditorService);Ul(a.input2.textModel,m,this._codeEditorService),Ul(a.input1.textModel,m,this._codeEditorService),Ul(a.resultTextModel,m,this._codeEditorService);let g=this.baseView.get()?.editor.getModel();g&&Ul(g,m,this._codeEditorService)};this._sessionDisposables.add(this._codeEditorService.onDidChangeTransientModelProperty(h=>{c(h)})),c(this.inputResultView.editor.getModel());let u=this;this._sessionDisposables.add(new class{_disposable=new oe;constructor(){for(let h of this.baseInput1Input2())this._disposable.add(h.onDidChangeContent(()=>this._checkBaseInput1Input2AllEmpty()))}dispose(){this._disposable.dispose()}*baseInput1Input2(){yield a.base,yield a.input1.textModel,yield a.input2.textModel}_checkBaseInput1Input2AllEmpty(){for(let h of this.baseInput1Input2())if(h.getValueLength()>0)return;u.editorService.replaceEditors([{editor:t,replacement:{resource:t.result,options:{preserveFocus:!0}},forceReplaceDirty:!0}],u.group)}})}setViewZones(t,n,i,r,s,a,l,d,c,u,h,m){let g=[],f=[],b=[],y=[],C=this.viewZoneComputer.computeViewZones(t,n,{codeLensesVisible:this.codeLensesVisible.read(t),showNonConflictingChanges:this.showNonConflictingChanges.read(t),shouldAlignBase:c,shouldAlignResult:m}),S=new oe;if(d)for(let w of C.baseViewZones)w.create(d,b,S);for(let w of C.resultViewZones)w.create(h,y,S);for(let w of C.input1ViewZones)w.create(r,g,S);for(let w of C.input2ViewZones)w.create(a,f,S);return S.add({dispose:()=>{i.changeViewZones(w=>{for(let R of g)w.removeZone(R)}),s.changeViewZones(w=>{for(let R of f)w.removeZone(R)}),l?.changeViewZones(w=>{for(let R of b)w.removeZone(R)}),u.changeViewZones(w=>{for(let R of y)w.removeZone(R)})}}),S}setOptions(t){super.setOptions(t),t&&cM(t,this.inputResultView.editor,0)}clearInput(){super.clearInput(),this._sessionDisposables.clear();for(let{editor:t}of[this.input1View,this.input2View,this.inputResultView])t.setModel(null)}focus(){super.focus(),(this.getControl()??this.inputResultView.editor).focus()}hasFocus(){for(let{editor:t}of[this.input1View,this.input2View,this.inputResultView])if(t.hasTextFocus())return!0;return super.hasFocus()}setEditorVisible(t){super.setEditorVisible(t);for(let{editor:n}of[this.input1View,this.input2View,this.inputResultView])t?n.onVisible():n.onHide();this._ctxIsMergeEditor.set(t)}getControl(){return this.inputResultView.editor}get scopedContextKeyService(){return this.getControl()?.invokeWithinContext(n=>n.get(Qt))}toggleBase(){this.setLayout({...this._layoutMode.value,showBase:!this._layoutMode.value.showBase})}toggleShowBaseTop(){let t=this._layoutMode.value.showBase&&this._layoutMode.value.showBaseAtTop;this.setLayout({...this._layoutMode.value,showBaseAtTop:!0,showBase:!t})}toggleShowBaseCenter(){let t=this._layoutMode.value.showBase&&!this._layoutMode.value.showBaseAtTop;this.setLayout({...this._layoutMode.value,showBaseAtTop:!1,showBase:!t})}setLayoutKind(t){this.setLayout({...this._layoutMode.value,kind:t})}setLayout(t){let n=this._layoutMode.value;JSON.stringify(n)!==JSON.stringify(t)&&(this.model?.telemetry.reportLayoutChange({baseTop:t.showBaseAtTop,baseVisible:t.showBase,isColumnView:t.kind==="columns"}),this.applyLayout(t))}baseViewDisposables=this._register(new oe);applyLayout(t){et(n=>{if(t.showBase&&!this.baseView.get()){this.baseViewDisposables.clear();let i=this.baseViewDisposables.add(this.instantiationService.createInstance(Om,this.viewModel));this.baseViewDisposables.add(Wt(r=>{let s=this.baseViewOptions.read(r);s&&i.updateOptions(s)})),this.baseView.set(i,n)}else!t.showBase&&this.baseView.get()&&(this.baseView.set(void 0,n),this.baseViewDisposables.clear());t.kind==="mixed"?this.setGrid([t.showBaseAtTop&&t.showBase?{size:38,data:this.baseView.get().view}:void 0,{size:38,groups:[{data:this.input1View.view},!t.showBaseAtTop&&t.showBase?{data:this.baseView.get().view}:void 0,{data:this.input2View.view}].filter(ao)},{size:62,data:this.inputResultView.view}].filter(ao)):t.kind==="columns"&&this.setGrid([t.showBase?{size:40,data:this.baseView.get().view}:void 0,{size:60,groups:[{data:this.input1View.view},{data:this.inputResultView.view},{data:this.input2View.view}]}].filter(ao)),this._layoutMode.value=t,this._ctxUsesColumnLayout.set(t.kind),this._ctxShowBase.set(t.showBase),this._ctxShowBaseAtTop.set(t.showBaseAtTop),this._onDidChangeSizeConstraints.fire(),this._layoutModeObs.set(t,n)})}setGrid(t){let n=-1,i=-1;this._grid.value&&(n=this._grid.value.width,i=this._grid.value.height),this._grid.value=vS.from({orientation:0,size:100,groups:t},{styles:{separatorBorder:this.theme.getColor(TW)??W.transparent},proportionalLayout:!0}),Tn(this.rootHtmlElement,this._grid.value.element),n!==-1&&this._grid.value.layout(n,i)}_applyViewState(t){t&&(this.inputResultView.editor.restoreViewState(t),t.input1State&&this.input1View.editor.restoreViewState(t.input1State),t.input2State&&this.input2View.editor.restoreViewState(t.input2State),t.focusIndex>=0&&[this.input1View.editor,this.input2View.editor,this.inputResultView.editor][t.focusIndex].focus())}computeEditorViewState(t){if(!_n(this.inputModel.get()?.resultUri,t))return;let n=this.inputResultView.editor.saveViewState();if(!n)return;let i=this.input1View.editor.saveViewState()??void 0,r=this.input2View.editor.saveViewState()??void 0,s=[this.input1View.editor,this.input2View.editor,this.inputResultView.editor].findIndex(a=>a.hasWidgetFocus());return{...n,input1State:i,input2State:r,focusIndex:s}}tracksEditorViewState(t){return t instanceof Hi}showNonConflictingChangesStore=this.instantiationService.createInstance(Im,"mergeEditor/showNonConflictingChanges");showNonConflictingChanges=fn(this,this.showNonConflictingChangesStore.get()??!1);toggleShowNonConflictingChanges(){this.showNonConflictingChanges.set(!this.showNonConflictingChanges.get(),void 0),this.showNonConflictingChangesStore.set(this.showNonConflictingChanges.get()),this._ctxShowNonConflictingChanges.set(this.showNonConflictingChanges.get())}};zn=k([E(1,nt),E(2,Qt),E(3,Ao),E(4,In),E(5,xs),E(6,Xi),E(7,rt),E(8,st),E(9,up),E(10,dn),E(11,yo),E(12,rt)],zn);var dc=class{constructor(e){this._storageService=e;let t=e.get(dc._key,0,"mixed");if(t==="mixed"||t==="columns")this._value={kind:t,showBase:!1,showBaseAtTop:!0};else if(t)try{this._value=JSON.parse(t)}catch(n){Ne(n)}}static _key="mergeEditor/layout";_value={kind:"mixed",showBase:!1,showBaseAtTop:!0};get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._storageService.store(dc._key,JSON.stringify(this._value),0,0))}};dc=k([E(0,In)],dc);var Xm=class extends B{constructor(t,n){super();this._editorService=t;this._store.add(n.registerCodeEditorOpenHandler(this.openCodeEditorFromMergeEditor.bind(this)))}async openCodeEditorFromMergeEditor(t,n,i){let r=this._editorService.activeEditorPane;if(!i&&t.options&&r instanceof zn&&r.getControl()&&r.input instanceof Hi&&_n(t.resource,r.input.result)){let s=r.getControl();return cM(t.options,s,0),s}return null}};Xm=k([E(0,st),E(1,yo)],Xm);var ju=class extends B{static ID="workbench.contrib.mergeEditorResolver";constructor(e,t){super();let n=i=>({editor:t.createInstance(Hi,i.base.resource,{uri:i.input1.resource,title:i.input1.label??uo(i.input1.resource),description:i.input1.description??"",detail:i.input1.detail},{uri:i.input2.resource,title:i.input2.label??uo(i.input2.resource),description:i.input2.description??"",detail:i.input2.detail},i.result.resource)});this._register(e.registerEditor("*",{id:Cl.id,label:Cl.displayName,detail:Cl.providerDisplayName,priority:"builtin"},{},{createMergeEditorInput:n}))}};ju=k([E(0,MW),E(1,nt)],ju);var Ur=class extends Ni{constructor(e){super(e)}run(e){let{activeEditorPane:t}=e.get(st);if(t instanceof zn){let n=t.viewModel.get();if(!n)return;this.runWithViewModel(n,e)}}},EM=class extends Ni{constructor(e){super(e)}run(e,...t){let{activeEditorPane:n}=e.get(st);if(n instanceof zn){let i=n.viewModel.get();return i?this.runWithMergeEditor({viewModel:i,inputModel:n.inputModel.get(),input:n.input,editorIdentifier:{editor:n.input,groupId:n.group.id}},e,...t):void 0}}},Hw=class extends Ni{constructor(){super({id:"_open.mergeEditor",title:Tt("title","Open Merge Editor")})}run(e,...t){let n=NW.validate(t[0]),i={base:{resource:n.base},input1:{resource:n.input1.uri,label:n.input1.title,description:n.input1.description,detail:n.input1.detail},input2:{resource:n.input2.uri,label:n.input2.title,description:n.input2.description,detail:n.input2.detail},result:{resource:n.output},options:{preserveFocus:!0}};e.get(st).openEditor(i)}},NW;(i=>{function o(r){if(!r||typeof r!="object")throw new TypeError("invalid argument");let s=r,a=t(s.base),l=t(s.output),d=e(s.input1),c=e(s.input2);return{base:a,input1:d,input2:c,output:l}}i.validate=o;function e(r){if(typeof r=="string")return new Hl(ne.parse(r,!0),void 0,void 0,void 0);if(!r||typeof r!="object")throw new TypeError("invalid argument");if(n(r))return new Hl(ne.revive(r),void 0,void 0,void 0);let s=r,a=s.title,l=t(s.uri),d=s.detail,c=s.description;return new Hl(l,a,d,c)}function t(r){if(typeof r=="string")return ne.parse(r,!0);if(r&&typeof r=="object")return ne.revive(r);throw new TypeError("invalid argument")}function n(r){if(!r||typeof r!="object")return!1;let s=r;return typeof s.scheme=="string"&&typeof s.authority=="string"&&typeof s.path=="string"&&typeof s.query=="string"&&typeof s.fragment=="string"}})(NW||={});var Uw=class extends Ni{constructor(){super({id:"merge.mixedLayout",title:Tt("layout.mixed","Mixed Layout"),toggled:nc.isEqualTo("mixed"),menu:[{id:ot.EditorTitle,when:jt,group:"1_merge",order:9}],precondition:jt})}run(e){let{activeEditorPane:t}=e.get(st);t instanceof zn&&t.setLayoutKind("mixed")}},zw=class extends Ni{constructor(){super({id:"merge.columnLayout",title:Tt("layout.column","Column Layout"),toggled:nc.isEqualTo("columns"),menu:[{id:ot.EditorTitle,when:jt,group:"1_merge",order:10}],precondition:jt})}run(e){let{activeEditorPane:t}=e.get(st);t instanceof zn&&t.setLayoutKind("columns")}},Kw=class extends Ni{constructor(){super({id:"merge.showNonConflictingChanges",title:Tt("showNonConflictingChanges","Show Non-Conflicting Changes"),toggled:Tw.isEqualTo(!0),menu:[{id:ot.EditorTitle,when:jt,group:"3_merge",order:9}],precondition:jt})}run(e){let{activeEditorPane:t}=e.get(st);t instanceof zn&&t.toggleShowNonConflictingChanges()}},Gw=class extends Ni{constructor(){super({id:"merge.showBase",title:Tt("layout.showBase","Show Base"),toggled:Pm.isEqualTo(!0),menu:[{id:ot.EditorTitle,when:ht.and(jt,nc.isEqualTo("columns")),group:"2_merge",order:9}]})}run(e){let{activeEditorPane:t}=e.get(st);t instanceof zn&&t.toggleBase()}},jw=class extends Ni{constructor(){super({id:"merge.showBaseTop",title:Tt("layout.showBaseTop","Show Base Top"),toggled:ht.and(Pm,dv),menu:[{id:ot.EditorTitle,when:ht.and(jt,nc.isEqualTo("mixed")),group:"2_merge",order:10}]})}run(e){let{activeEditorPane:t}=e.get(st);t instanceof zn&&t.toggleShowBaseTop()}},$w=class extends Ni{constructor(){super({id:"merge.showBaseCenter",title:Tt("layout.showBaseCenter","Show Base Center"),toggled:ht.and(Pm,dv.negate()),menu:[{id:ot.EditorTitle,when:ht.and(jt,nc.isEqualTo("mixed")),group:"2_merge",order:11}]})}run(e){let{activeEditorPane:t}=e.get(st);t instanceof zn&&t.toggleShowBaseCenter()}},zr=Tt("mergeEditor","Merge Editor"),qw=class extends Ur{constructor(){super({id:"merge.openResult",icon:ue.goToFile,title:Tt("openfile","Open File"),category:zr,menu:[{id:ot.EditorTitle,when:jt,group:"navigation",order:1}],precondition:jt})}runWithViewModel(e,t){t.get(st).openEditor({resource:e.model.resultTextModel.uri})}},Yw=class extends Ur{constructor(){super({id:"merge.goToNextUnhandledConflict",category:zr,title:Tt("merge.goToNextUnhandledConflict","Go to Next Unhandled Conflict"),icon:ue.arrowDown,menu:[{id:ot.EditorTitle,when:jt,group:"navigation",order:3}],f1:!0,precondition:jt})}runWithViewModel(e){e.model.telemetry.reportNavigationToNextConflict(),e.goToNextModifiedBaseRange(t=>!e.model.isHandled(t).get())}},Zw=class extends Ur{constructor(){super({id:"merge.goToPreviousUnhandledConflict",category:zr,title:Tt("merge.goToPreviousUnhandledConflict","Go to Previous Unhandled Conflict"),icon:ue.arrowUp,menu:[{id:ot.EditorTitle,when:jt,group:"navigation",order:2}],f1:!0,precondition:jt})}runWithViewModel(e){e.model.telemetry.reportNavigationToPreviousConflict(),e.goToPreviousModifiedBaseRange(t=>!e.model.isHandled(t).get())}},Xw=class extends Ur{constructor(){super({id:"merge.toggleActiveConflictInput1",category:zr,title:Tt("merge.toggleCurrentConflictFromLeft","Toggle Current Conflict from Left"),f1:!0,precondition:jt})}runWithViewModel(e){e.toggleActiveConflict(1)}},Qw=class extends Ur{constructor(){super({id:"merge.toggleActiveConflictInput2",category:zr,title:Tt("merge.toggleCurrentConflictFromRight","Toggle Current Conflict from Right"),f1:!0,precondition:jt})}runWithViewModel(e){e.toggleActiveConflict(2)}},Jw=class extends Ur{constructor(){super({id:"mergeEditor.compareInput1WithBase",category:zr,title:Tt("mergeEditor.compareInput1WithBase","Compare Input 1 With Base"),shortTitle:p("mergeEditor.compareWithBase","Compare With Base"),f1:!0,precondition:jt,menu:{id:ot.MergeInput1Toolbar,group:"primary"},icon:ue.compareChanges})}runWithViewModel(e,t){let n=t.get(st);AW(e,n,1)}},e_=class extends Ur{constructor(){super({id:"mergeEditor.compareInput2WithBase",category:zr,title:Tt("mergeEditor.compareInput2WithBase","Compare Input 2 With Base"),shortTitle:p("mergeEditor.compareWithBase","Compare With Base"),f1:!0,precondition:jt,menu:{id:ot.MergeInput2Toolbar,group:"primary"},icon:ue.compareChanges})}runWithViewModel(e,t){let n=t.get(st);AW(e,n,2)}};async function AW(o,e,t){e.openEditor(e.activeEditor,{pinned:!0});let i=o.model.base,r=t===1?o.inputCodeEditorView1.editor:o.inputCodeEditorView2.editor,s=r.getPosition().lineNumber;await e.openEditor({original:{resource:i.uri},modified:{resource:r.getModel().uri},options:{selection:{startLineNumber:s,startColumn:1},revealIfOpened:!0,revealIfVisible:!0}})}var t_=class extends Ur{constructor(){super({id:"merge.openBaseEditor",category:zr,title:Tt("merge.openBaseEditor","Open Base File"),f1:!0,precondition:jt})}runWithViewModel(e,t){t.get(IS).open(e.model.base.uri)}},n_=class extends Ur{constructor(){super({id:"merge.acceptAllInput1",category:zr,title:Tt("merge.acceptAllInput1","Accept All Changes from Left"),f1:!0,precondition:jt,menu:{id:ot.MergeInput1Toolbar,group:"primary"},icon:ue.checkAll})}runWithViewModel(e){e.acceptAll(1)}},i_=class extends Ur{constructor(){super({id:"merge.acceptAllInput2",category:zr,title:Tt("merge.acceptAllInput2","Accept All Changes from Right"),f1:!0,precondition:jt,menu:{id:ot.MergeInput2Toolbar,group:"primary"},icon:ue.checkAll})}runWithViewModel(e){e.acceptAll(2)}},o_=class extends Ur{constructor(){super({id:"mergeEditor.resetResultToBaseAndAutoMerge",category:zr,title:Tt("mergeEditor.resetResultToBaseAndAutoMerge","Reset Result"),shortTitle:p("mergeEditor.resetResultToBaseAndAutoMerge.short","Reset"),f1:!0,precondition:jt,menu:{id:ot.MergeInputResultToolbar,group:"primary"},icon:ue.discard})}runWithViewModel(e,t){e.model.reset()}},r_=class extends Ni{constructor(){super({id:"mergeEditor.resetCloseWithConflictsChoice",category:zr,title:Tt("mergeEditor.resetChoice","Reset Choice for 'Close with Conflicts'"),f1:!0})}run(e){e.get(In).remove(cv,0)}},s_=class extends EM{constructor(){super({id:"mergeEditor.acceptMerge",category:zr,title:Tt("mergeEditor.acceptMerge","Complete Merge"),f1:!1,precondition:jt})}async runWithMergeEditor({inputModel:e,editorIdentifier:t,viewModel:n},i){let r=i.get(xa),s=i.get(st);if(n.model.unhandledConflictsCount.get()>0){let{confirmed:a}=await r.confirm({message:p("mergeEditor.acceptMerge.unhandledConflicts.message","Do you want to complete the merge of {0}?",uo(e.resultUri)),detail:p("mergeEditor.acceptMerge.unhandledConflicts.detail","The file contains unhandled conflicts."),primaryButton:p({key:"mergeEditor.acceptMerge.unhandledConflicts.accept",comment:["&& denotes a mnemonic"]},"&&Complete with Conflicts")});if(!a)return{successful:!1}}return await e.accept(),await s.closeEditor(t),{successful:!0}}};var wM=Tt("mergeEditor","Merge Editor (Dev)"),a_=class extends Ni{constructor(){super({id:"merge.dev.copyContentsJson",category:wM,title:Tt("merge.dev.copyState","Copy Merge Editor State as JSON"),icon:ue.layoutCentered,f1:!0,precondition:jt})}run(e){let{activeEditorPane:t}=e.get(st),n=e.get(IE),i=e.get(eo);if(!(t instanceof zn)){i.info({name:p("mergeEditor.name","Merge Editor"),message:p("mergeEditor.noActiveMergeEditor","No active merge editor")});return}let r=t.model;if(!r)return;let s={languageId:r.resultTextModel.getLanguageId(),base:r.base.getValue(),input1:r.input1.textModel.getValue(),input2:r.input2.textModel.getValue(),result:r.resultTextModel.getValue(),initialResult:r.getInitialResultValue()},a=JSON.stringify(s,void 0,4);n.writeText(a),i.info({name:p("mergeEditor.name","Merge Editor"),message:p("mergeEditor.successfullyCopiedMergeEditorContents","Successfully copied merge editor state")})}},l_=class extends Ni{constructor(){super({id:"merge.dev.saveContentsToFolder",category:wM,title:Tt("merge.dev.saveContentsToFolder","Save Merge Editor State to Folder"),icon:ue.layoutCentered,f1:!0,precondition:jt})}async run(e){let{activeEditorPane:t}=e.get(st),n=e.get(eo),i=e.get(s1),r=e.get(dn),s=e.get(ho);if(!(t instanceof zn)){n.info({name:p("mergeEditor.name","Merge Editor"),message:p("mergeEditor.noActiveMergeEditor","No active merge editor")});return}let a=t.model;if(!a)return;let l=await i.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:p("mergeEditor.selectFolderToSaveTo","Select folder to save to")});if(!l)return;let d=l[0],c=s.getExtensions(a.resultTextModel.getLanguageId())[0]||"";async function u(h,m){await r.writeFile(ne.joinPath(d,h+c),vn.fromString(m),{})}await Promise.all([u("base",a.base.getValue()),u("input1",a.input1.textModel.getValue()),u("input2",a.input2.textModel.getValue()),u("result",a.resultTextModel.getValue()),u("initialResult",a.getInitialResultValue())]),n.info({name:p("mergeEditor.name","Merge Editor"),message:p("mergeEditor.successfullySavedMergeEditorContentsToFolder","Successfully saved merge editor state to folder")})}},d_=class extends Ni{constructor(){super({id:"merge.dev.loadContentsFromFolder",category:wM,title:Tt("merge.dev.loadContentsFromFolder","Load Merge Editor State from Folder"),icon:ue.layoutCentered,f1:!0})}async run(e,t){let n=e.get(s1),i=e.get(st),r=e.get(dn),s=e.get(hw);t||(t={});let a;if(t.folderUri)a=t.folderUri;else{let b=await n.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:p("mergeEditor.selectFolderToSaveTo","Select folder to save to")});if(!b)return;a=b[0]}let l=await r.resolve(a);function d(b){return l.children.find(y=>y.name.startsWith(b))?.resource}let c=await m3(s,t.resultState),u=d("base"),h=d("input1"),m=d("input2"),g=d(c?"initialResult":"result"),f={base:{resource:u},input1:{resource:h,label:"Input 1",description:"Input 1",detail:"(from file)"},input2:{resource:m,label:"Input 2",description:"Input 2",detail:"(from file)"},result:{resource:g}};i.openEditor(f)}};async function m3(o,e){return e?e==="initial":(await o.pick([{label:"result",result:!1},{label:"initial result",result:!0}],{canPickMany:!1}))?.result}var c_=class{canSerialize(){return!0}serialize(e){return JSON.stringify(this.toJSON(e))}toJSON(e){return{base:e.base,input1:e.input1,input2:e.input2,result:e.result}}deserialize(e,t){try{let n=Xf(t);return e.createInstance(Hi,n.base,new Hl(n.input1.uri,n.input1.title,n.input1.detail,n.input1.description),new Hl(n.input2.uri,n.input2.title,n.input2.detail,n.input2.description),n.result)}catch(n){Ne(n);return}}};Je.as(wa.EditorPane).registerEditorPane(TS.create(zn,zn.ID,p("name","Merge Editor")),[new xc(Hi)]);Je.as(wa.EditorFactory).registerEditorSerializer(Hi.ID,c_);Je.as($r.Configuration).registerConfiguration({properties:{"mergeEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:"advanced",markdownEnumDescriptions:[p("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),p("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")]},"mergeEditor.showDeletionMarkers":{type:"boolean",default:!0,description:"Controls if deletions in base or one of the inputs should be indicated by a vertical bar."}}});bn(qw);bn(Uw);bn(zw);bn(Hw);bn(t_);bn(Kw);bn(Gw);bn(jw);bn($w);bn(Yw);bn(Zw);bn(Xw);bn(Qw);bn(Jw);bn(e_);bn(n_);bn(i_);bn(o_);bn(s_);bn(r_);bn(a_);bn(l_);bn(d_);Je.as(Lp.Workbench).registerWorkbenchContribution(Xm,3);ES(ju.ID,ju,Ns.BlockStartup);
