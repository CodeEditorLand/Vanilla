var h=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var f=(r,e,t,o)=>{for(var i=o>1?void 0:o?g(e,t):e,s=r.length-1,n;s>=0;s--)(n=r[s])&&(i=(o?n(e,t,i):n(i))||i);return o&&i&&h(e,t,i),i},u=(r,e)=>(t,o)=>e(t,o,r);import{ArrayQueue as c,CompareResult as a}from"../../../../base/common/arrays.js";import{onUnexpectedError as T}from"../../../../base/common/errors.js";import{DisposableStore as y,toDisposable as m}from"../../../../base/common/lifecycle.js";import{autorunOpts as b}from"../../../../base/common/observable.js";import{IStorageService as v,StorageScope as p,StorageTarget as I}from"../../../../platform/storage/common/storage.js";function j(r,e){Object.entries(e).forEach(([t,o])=>{r.style.setProperty(t,R(o))})}function R(r){return typeof r=="number"?`${r}px`:r}function A(r,e){const t=new y;let o=[];return t.add(b({debugName:()=>`Apply decorations from ${e.debugName}`},i=>{const s=e.read(i);r.changeDecorations(n=>{o=n.deltaDecorations(o,s)})})),t.add({dispose:()=>{r.changeDecorations(i=>{o=i.deltaDecorations(o,[])})}}),t}function*N(r,e,t){const o=new c(e);for(const i of r){o.takeWhile(n=>a.isGreaterThan(t(i,n)));const s=o.takeWhile(n=>a.isNeitherLessOrGreaterThan(t(i,n)));yield{left:i,rights:s||[]}}}function*W(r,e,t){const o=new c(e);for(const i of r){const s=o.takeWhile(d=>a.isGreaterThan(t(i,d)));s&&(yield{rights:s});const n=o.takeWhile(d=>a.isNeitherLessOrGreaterThan(t(i,d)));yield{left:i,rights:n||[]}}}function w(...r){return[].concat(...r)}function C(r,e){return r[e]}function G(r,e){let t=!1;return r.then(()=>{t||e()}),m(()=>{t=!0})}function M(r,e){return Object.assign(r,e)}function x(r,e){const t={};for(const o in r)t[o]=r[o];for(const o in e){const i=e[o];typeof t[o]=="object"&&i&&typeof i=="object"?t[o]=x(t[o],i):t[o]=i}return t}let l=class{constructor(e,t){this.key=e;this.storageService=t}hasValue=!1;value=void 0;get(){if(!this.hasValue){const e=this.storageService.get(this.key,p.PROFILE);if(e!==void 0)try{this.value=JSON.parse(e)}catch(t){T(t)}this.hasValue=!0}return this.value}set(e){this.value=e,this.storageService.store(this.key,JSON.stringify(this.value),p.PROFILE,I.USER)}};l=f([u(1,v)],l);export{l as PersistentStore,A as applyObservableDecorations,w as concatArrays,x as deepMerge,C as elementAtOrUndefined,W as join,N as leftJoin,M as setFields,j as setStyle,G as thenIfNotDisposed};
