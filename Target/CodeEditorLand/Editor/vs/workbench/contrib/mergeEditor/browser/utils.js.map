{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/mergeEditor/browser/utils.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ArrayQueue, CompareResult } from \"../../../../base/common/arrays.js\";\nimport { onUnexpectedError } from \"../../../../base/common/errors.js\";\nimport {\n\tDisposableStore,\n\ttype IDisposable,\n\ttoDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport {\n\ttype IObservable,\n\tautorunOpts,\n} from \"../../../../base/common/observable.js\";\nimport type { CodeEditorWidget } from \"../../../../editor/browser/widget/codeEditor/codeEditorWidget.js\";\nimport type { IModelDeltaDecoration } from \"../../../../editor/common/model.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n} from \"../../../../platform/storage/common/storage.js\";\n\nexport function setStyle(\n\telement: HTMLElement,\n\tstyle: {\n\t\twidth?: number | string;\n\t\theight?: number | string;\n\t\tleft?: number | string;\n\t\ttop?: number | string;\n\t},\n): void {\n\tObject.entries(style).forEach(([key, value]) => {\n\t\telement.style.setProperty(key, toSize(value));\n\t});\n}\n\nfunction toSize(value: number | string): string {\n\treturn typeof value === \"number\" ? `${value}px` : value;\n}\n\nexport function applyObservableDecorations(\n\teditor: CodeEditorWidget,\n\tdecorations: IObservable<IModelDeltaDecoration[]>,\n): IDisposable {\n\tconst d = new DisposableStore();\n\tlet decorationIds: string[] = [];\n\td.add(\n\t\tautorunOpts(\n\t\t\t{\n\t\t\t\tdebugName: () =>\n\t\t\t\t\t`Apply decorations from ${decorations.debugName}`,\n\t\t\t},\n\t\t\t(reader) => {\n\t\t\t\tconst d = decorations.read(reader);\n\t\t\t\teditor.changeDecorations((a) => {\n\t\t\t\t\tdecorationIds = a.deltaDecorations(decorationIds, d);\n\t\t\t\t});\n\t\t\t},\n\t\t),\n\t);\n\td.add({\n\t\tdispose: () => {\n\t\t\teditor.changeDecorations((a) => {\n\t\t\t\tdecorationIds = a.deltaDecorations(decorationIds, []);\n\t\t\t});\n\t\t},\n\t});\n\treturn d;\n}\n\nexport function* leftJoin<TLeft, TRight>(\n\tleft: Iterable<TLeft>,\n\tright: readonly TRight[],\n\tcompare: (left: TLeft, right: TRight) => CompareResult,\n): IterableIterator<{ left: TLeft; rights: TRight[] }> {\n\tconst rightQueue = new ArrayQueue(right);\n\tfor (const leftElement of left) {\n\t\trightQueue.takeWhile((rightElement) =>\n\t\t\tCompareResult.isGreaterThan(compare(leftElement, rightElement)),\n\t\t);\n\t\tconst equals = rightQueue.takeWhile((rightElement) =>\n\t\t\tCompareResult.isNeitherLessOrGreaterThan(\n\t\t\t\tcompare(leftElement, rightElement),\n\t\t\t),\n\t\t);\n\t\tyield { left: leftElement, rights: equals || [] };\n\t}\n}\n\nexport function* join<TLeft, TRight>(\n\tleft: Iterable<TLeft>,\n\tright: readonly TRight[],\n\tcompare: (left: TLeft, right: TRight) => CompareResult,\n): IterableIterator<{ left?: TLeft; rights: TRight[] }> {\n\tconst rightQueue = new ArrayQueue(right);\n\tfor (const leftElement of left) {\n\t\tconst skipped = rightQueue.takeWhile((rightElement) =>\n\t\t\tCompareResult.isGreaterThan(compare(leftElement, rightElement)),\n\t\t);\n\t\tif (skipped) {\n\t\t\tyield { rights: skipped };\n\t\t}\n\t\tconst equals = rightQueue.takeWhile((rightElement) =>\n\t\t\tCompareResult.isNeitherLessOrGreaterThan(\n\t\t\t\tcompare(leftElement, rightElement),\n\t\t\t),\n\t\t);\n\t\tyield { left: leftElement, rights: equals || [] };\n\t}\n}\n\nexport function concatArrays<TArr extends any[]>(\n\t...arrays: TArr\n): TArr[number][number][] {\n\treturn ([] as any[]).concat(...arrays);\n}\n\nexport function elementAtOrUndefined<T>(\n\tarr: T[],\n\tindex: number,\n): T | undefined {\n\treturn arr[index];\n}\n\nexport function thenIfNotDisposed<T>(\n\tpromise: Promise<T>,\n\tthen: () => void,\n): IDisposable {\n\tlet disposed = false;\n\tpromise.then(() => {\n\t\tif (disposed) {\n\t\t\treturn;\n\t\t}\n\t\tthen();\n\t});\n\treturn toDisposable(() => {\n\t\tdisposed = true;\n\t});\n}\n\nexport function setFields<T extends {}>(obj: T, fields: Partial<T>): T {\n\treturn Object.assign(obj, fields);\n}\n\nexport function deepMerge<T extends {}>(source1: T, source2: Partial<T>): T {\n\tconst result = {} as any as T;\n\tfor (const key in source1) {\n\t\tresult[key] = source1[key];\n\t}\n\tfor (const key in source2) {\n\t\tconst source2Value = source2[key];\n\t\tif (\n\t\t\ttypeof result[key] === \"object\" &&\n\t\t\tsource2Value &&\n\t\t\ttypeof source2Value === \"object\"\n\t\t) {\n\t\t\tresult[key] = deepMerge<any>(result[key], source2Value);\n\t\t} else {\n\t\t\tresult[key] = source2Value as any;\n\t\t}\n\t}\n\treturn result;\n}\n\nexport class PersistentStore<T> {\n\tprivate hasValue = false;\n\tprivate value: Readonly<T> | undefined = undefined;\n\n\tconstructor(\n\t\tprivate readonly key: string,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) { }\n\n\tpublic get(): Readonly<T> | undefined {\n\t\tif (!this.hasValue) {\n\t\t\tconst value = this.storageService.get(\n\t\t\t\tthis.key,\n\t\t\t\tStorageScope.PROFILE,\n\t\t\t);\n\t\t\tif (value !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.value = JSON.parse(value) as any;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tonUnexpectedError(e);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.hasValue = true;\n\t\t}\n\n\t\treturn this.value;\n\t}\n\n\tpublic set(newValue: T | undefined): void {\n\t\tthis.value = newValue;\n\n\t\tthis.storageService.store(\n\t\t\tthis.key,\n\t\t\tJSON.stringify(this.value),\n\t\t\tStorageScope.PROFILE,\n\t\t\tStorageTarget.USER,\n\t\t);\n\t}\n}\n"],
  "mappings": "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",
  "names": ["d"]
}
