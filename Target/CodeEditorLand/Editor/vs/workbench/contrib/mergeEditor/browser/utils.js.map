{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/mergeEditor/browser/utils.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ArrayQueue, CompareResult } from '../../../../base/common/arrays.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { IObservable, autorunOpts } from '../../../../base/common/observable.js';\nimport { CodeEditorWidget } from '../../../../editor/browser/widget/codeEditor/codeEditorWidget.js';\nimport { IModelDeltaDecoration } from '../../../../editor/common/model.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\n\nexport function setStyle(\n\telement: HTMLElement,\n\tstyle: {\n\t\twidth?: number | string;\n\t\theight?: number | string;\n\t\tleft?: number | string;\n\t\ttop?: number | string;\n\t}\n): void {\n\tObject.entries(style).forEach(([key, value]) => {\n\t\telement.style.setProperty(key, toSize(value));\n\t});\n}\n\nfunction toSize(value: number | string): string {\n\treturn typeof value === 'number' ? `${value}px` : value;\n}\n\nexport function applyObservableDecorations(editor: CodeEditorWidget, decorations: IObservable<IModelDeltaDecoration[]>): IDisposable {\n\tconst d = new DisposableStore();\n\tlet decorationIds: string[] = [];\n\td.add(autorunOpts({ debugName: () => `Apply decorations from ${decorations.debugName}` }, reader => {\n\t\tconst d = decorations.read(reader);\n\t\teditor.changeDecorations(a => {\n\t\t\tdecorationIds = a.deltaDecorations(decorationIds, d);\n\t\t});\n\t}));\n\td.add({\n\t\tdispose: () => {\n\t\t\teditor.changeDecorations(a => {\n\t\t\t\tdecorationIds = a.deltaDecorations(decorationIds, []);\n\t\t\t});\n\t\t}\n\t});\n\treturn d;\n}\n\nexport function* leftJoin<TLeft, TRight>(\n\tleft: Iterable<TLeft>,\n\tright: readonly TRight[],\n\tcompare: (left: TLeft, right: TRight) => CompareResult,\n): IterableIterator<{ left: TLeft; rights: TRight[] }> {\n\tconst rightQueue = new ArrayQueue(right);\n\tfor (const leftElement of left) {\n\t\trightQueue.takeWhile(rightElement => CompareResult.isGreaterThan(compare(leftElement, rightElement)));\n\t\tconst equals = rightQueue.takeWhile(rightElement => CompareResult.isNeitherLessOrGreaterThan(compare(leftElement, rightElement)));\n\t\tyield { left: leftElement, rights: equals || [] };\n\t}\n}\n\nexport function* join<TLeft, TRight>(\n\tleft: Iterable<TLeft>,\n\tright: readonly TRight[],\n\tcompare: (left: TLeft, right: TRight) => CompareResult,\n): IterableIterator<{ left?: TLeft; rights: TRight[] }> {\n\tconst rightQueue = new ArrayQueue(right);\n\tfor (const leftElement of left) {\n\t\tconst skipped = rightQueue.takeWhile(rightElement => CompareResult.isGreaterThan(compare(leftElement, rightElement)));\n\t\tif (skipped) {\n\t\t\tyield { rights: skipped };\n\t\t}\n\t\tconst equals = rightQueue.takeWhile(rightElement => CompareResult.isNeitherLessOrGreaterThan(compare(leftElement, rightElement)));\n\t\tyield { left: leftElement, rights: equals || [] };\n\t}\n}\n\nexport function concatArrays<TArr extends any[]>(...arrays: TArr): TArr[number][number][] {\n\treturn ([] as any[]).concat(...arrays);\n}\n\nexport function elementAtOrUndefined<T>(arr: T[], index: number): T | undefined {\n\treturn arr[index];\n}\n\nexport function thenIfNotDisposed<T>(promise: Promise<T>, then: () => void): IDisposable {\n\tlet disposed = false;\n\tpromise.then(() => {\n\t\tif (disposed) {\n\t\t\treturn;\n\t\t}\n\t\tthen();\n\t});\n\treturn toDisposable(() => {\n\t\tdisposed = true;\n\t});\n}\n\nexport function setFields<T extends {}>(obj: T, fields: Partial<T>): T {\n\treturn Object.assign(obj, fields);\n}\n\nexport function deepMerge<T extends {}>(source1: T, source2: Partial<T>): T {\n\tconst result = {} as any as T;\n\tfor (const key in source1) {\n\t\tresult[key] = source1[key];\n\t}\n\tfor (const key in source2) {\n\t\tconst source2Value = source2[key];\n\t\tif (typeof result[key] === 'object' && source2Value && typeof source2Value === 'object') {\n\t\t\tresult[key] = deepMerge<any>(result[key], source2Value);\n\t\t} else {\n\t\t\tresult[key] = source2Value as any;\n\t\t}\n\t}\n\treturn result;\n}\n\nexport class PersistentStore<T> {\n\tprivate hasValue = false;\n\tprivate value: Readonly<T> | undefined = undefined;\n\n\tconstructor(\n\t\tprivate readonly key: string,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) { }\n\n\tpublic get(): Readonly<T> | undefined {\n\t\tif (!this.hasValue) {\n\t\t\tconst value = this.storageService.get(this.key, StorageScope.PROFILE);\n\t\t\tif (value !== undefined) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.value = JSON.parse(value) as any;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tonUnexpectedError(e);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.hasValue = true;\n\t\t}\n\n\t\treturn this.value;\n\t}\n\n\tpublic set(newValue: T | undefined): void {\n\t\tthis.value = newValue;\n\n\t\tthis.storageService.store(\n\t\t\tthis.key,\n\t\t\tJSON.stringify(this.value),\n\t\t\tStorageScope.PROFILE,\n\t\t\tStorageTarget.USER\n\t\t);\n\t}\n}\n\n"],
  "mappings": "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",
  "names": ["d"]
}
