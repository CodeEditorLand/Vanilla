{
  "version": 3,
  "sources": ["../../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/mergeEditor/browser/view/editors/codeEditorView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { h } from \"../../../../../../base/browser/dom.js\";\nimport type {\n\tIView,\n\tIViewSize,\n} from \"../../../../../../base/browser/ui/grid/grid.js\";\nimport { Emitter, Event } from \"../../../../../../base/common/event.js\";\nimport {\n\tDisposable,\n\ttype IDisposable,\n} from \"../../../../../../base/common/lifecycle.js\";\nimport {\n\ttype IObservable,\n\tautorun,\n\tderived,\n\tobservableFromEvent,\n} from \"../../../../../../base/common/observable.js\";\nimport {\n\tEditorExtensionsRegistry,\n\ttype IEditorContributionDescription,\n} from \"../../../../../../editor/browser/editorExtensions.js\";\nimport { CodeEditorWidget } from \"../../../../../../editor/browser/widget/codeEditor/codeEditorWidget.js\";\nimport type { IEditorOptions } from \"../../../../../../editor/common/config/editorOptions.js\";\nimport type { Range } from \"../../../../../../editor/common/core/range.js\";\nimport { Selection } from \"../../../../../../editor/common/core/selection.js\";\nimport { CodeLensContribution } from \"../../../../../../editor/contrib/codelens/browser/codelensController.js\";\nimport { FoldingController } from \"../../../../../../editor/contrib/folding/browser/folding.js\";\nimport { MenuWorkbenchToolBar } from \"../../../../../../platform/actions/browser/toolbar.js\";\nimport type { MenuId } from \"../../../../../../platform/actions/common/actions.js\";\nimport type { IConfigurationService } from \"../../../../../../platform/configuration/common/configuration.js\";\nimport { IInstantiationService } from \"../../../../../../platform/instantiation/common/instantiation.js\";\nimport { observableConfigValue } from \"../../../../../../platform/observable/common/platformObservableUtils.js\";\nimport {\n\tDEFAULT_EDITOR_MAX_DIMENSIONS,\n\tDEFAULT_EDITOR_MIN_DIMENSIONS,\n} from \"../../../../../browser/parts/editor/editor.js\";\nimport { setStyle } from \"../../utils.js\";\nimport type { MergeEditorViewModel } from \"../viewModel.js\";\n\nexport abstract class CodeEditorView extends Disposable {\n\treadonly model = this.viewModel.map(\n\t\t(m) => /** @description model */ m?.model,\n\t);\n\n\tprotected readonly htmlElements = h(\"div.code-view\", [\n\t\th(\"div.header@header\", [\n\t\t\th(\"span.title@title\"),\n\t\t\th(\"span.description@description\"),\n\t\t\th(\"span.detail@detail\"),\n\t\t\th(\"span.toolbar@toolbar\"),\n\t\t]),\n\t\th(\"div.container\", [h(\"div.gutter@gutterDiv\"), h(\"div@editor\")]),\n\t]);\n\n\tprivate readonly _onDidViewChange = new Emitter<IViewSize | undefined>();\n\n\tpublic readonly view: IView = {\n\t\telement: this.htmlElements.root,\n\t\tminimumWidth: DEFAULT_EDITOR_MIN_DIMENSIONS.width,\n\t\tmaximumWidth: DEFAULT_EDITOR_MAX_DIMENSIONS.width,\n\t\tminimumHeight: DEFAULT_EDITOR_MIN_DIMENSIONS.height,\n\t\tmaximumHeight: DEFAULT_EDITOR_MAX_DIMENSIONS.height,\n\t\tonDidChange: this._onDidViewChange.event,\n\t\tlayout: (width: number, height: number, top: number, left: number) => {\n\t\t\tsetStyle(this.htmlElements.root, { width, height, top, left });\n\t\t\tthis.editor.layout({\n\t\t\t\twidth: width - this.htmlElements.gutterDiv.clientWidth,\n\t\t\t\theight: height - this.htmlElements.header.clientHeight,\n\t\t\t});\n\t\t},\n\t\t// preferredWidth?: number | undefined;\n\t\t// preferredHeight?: number | undefined;\n\t\t// priority?: LayoutPriority | undefined;\n\t\t// snap?: boolean | undefined;\n\t};\n\n\tprotected readonly checkboxesVisible = observableConfigValue<boolean>(\n\t\t\"mergeEditor.showCheckboxes\",\n\t\tfalse,\n\t\tthis.configurationService,\n\t);\n\tprotected readonly showDeletionMarkers = observableConfigValue<boolean>(\n\t\t\"mergeEditor.showDeletionMarkers\",\n\t\ttrue,\n\t\tthis.configurationService,\n\t);\n\tprotected readonly useSimplifiedDecorations =\n\t\tobservableConfigValue<boolean>(\n\t\t\t\"mergeEditor.useSimplifiedDecorations\",\n\t\t\tfalse,\n\t\t\tthis.configurationService,\n\t\t);\n\n\tpublic readonly editor = this.instantiationService.createInstance(\n\t\tCodeEditorWidget,\n\t\tthis.htmlElements.editor,\n\t\t{},\n\t\t{\n\t\t\tcontributions: this.getEditorContributions(),\n\t\t},\n\t);\n\n\tpublic updateOptions(newOptions: Readonly<IEditorOptions>): void {\n\t\tthis.editor.updateOptions(newOptions);\n\t}\n\n\tpublic readonly isFocused = observableFromEvent(\n\t\tthis,\n\t\tEvent.any(\n\t\t\tthis.editor.onDidBlurEditorWidget,\n\t\t\tthis.editor.onDidFocusEditorWidget,\n\t\t),\n\t\t() =>\n\t\t\t/** @description editor.hasWidgetFocus */ this.editor.hasWidgetFocus(),\n\t);\n\n\tpublic readonly cursorPosition = observableFromEvent(\n\t\tthis,\n\t\tthis.editor.onDidChangeCursorPosition,\n\t\t() => /** @description editor.getPosition */ this.editor.getPosition(),\n\t);\n\n\tpublic readonly selection = observableFromEvent(\n\t\tthis,\n\t\tthis.editor.onDidChangeCursorSelection,\n\t\t() =>\n\t\t\t/** @description editor.getSelections */ this.editor.getSelections(),\n\t);\n\n\tpublic readonly cursorLineNumber = this.cursorPosition.map(\n\t\t(p) => /** @description cursorPosition.lineNumber */ p?.lineNumber,\n\t);\n\n\tconstructor(\n\t\tprivate readonly instantiationService: IInstantiationService,\n\t\tpublic readonly viewModel: IObservable<\n\t\t\tundefined | MergeEditorViewModel\n\t\t>,\n\t\tprivate readonly configurationService: IConfigurationService,\n\t) {\n\t\tsuper();\n\t}\n\n\tprotected getEditorContributions(): IEditorContributionDescription[] {\n\t\treturn EditorExtensionsRegistry.getEditorContributions().filter(\n\t\t\t(c) =>\n\t\t\t\tc.id !== FoldingController.ID &&\n\t\t\t\tc.id !== CodeLensContribution.ID,\n\t\t);\n\t}\n}\n\nexport function createSelectionsAutorun(\n\tcodeEditorView: CodeEditorView,\n\ttranslateRange: (\n\t\tbaseRange: Range,\n\t\tviewModel: MergeEditorViewModel,\n\t) => Range,\n): IDisposable {\n\tconst selections = derived((reader) => {\n\t\t/** @description selections */\n\t\tconst viewModel = codeEditorView.viewModel.read(reader);\n\t\tif (!viewModel) {\n\t\t\treturn [];\n\t\t}\n\t\tconst baseRange = viewModel.selectionInBase.read(reader);\n\t\tif (!baseRange || baseRange.sourceEditor === codeEditorView) {\n\t\t\treturn [];\n\t\t}\n\t\treturn baseRange.rangesInBase.map((r) => translateRange(r, viewModel));\n\t});\n\n\treturn autorun((reader) => {\n\t\t/** @description set selections */\n\t\tconst ranges = selections.read(reader);\n\t\tif (ranges.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tcodeEditorView.editor.setSelections(\n\t\t\tranges.map(\n\t\t\t\t(r) =>\n\t\t\t\t\tnew Selection(\n\t\t\t\t\t\tr.startLineNumber,\n\t\t\t\t\t\tr.startColumn,\n\t\t\t\t\t\tr.endLineNumber,\n\t\t\t\t\t\tr.endColumn,\n\t\t\t\t\t),\n\t\t\t),\n\t\t);\n\t});\n}\n\nexport class TitleMenu extends Disposable {\n\tconstructor(\n\t\tmenuId: MenuId,\n\t\ttargetHtmlElement: HTMLElement,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\n\t\tconst toolbar = instantiationService.createInstance(\n\t\t\tMenuWorkbenchToolBar,\n\t\t\ttargetHtmlElement,\n\t\t\tmenuId,\n\t\t\t{\n\t\t\t\tmenuOptions: { renderShortTitle: true },\n\t\t\t\ttoolbarOptions: { primaryGroup: (g) => g === \"primary\" },\n\t\t\t},\n\t\t);\n\t\tthis._store.add(toolbar);\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
