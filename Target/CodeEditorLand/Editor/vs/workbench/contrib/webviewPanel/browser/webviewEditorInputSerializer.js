var l=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var c=(n,e,t,i)=>{for(var o=i>1?void 0:i?u(e,t):e,d=n.length-1,a;d>=0;d--)(a=n[d])&&(o=(i?a(e,t,o):a(o))||o);return i&&o&&l(e,t,o),o},p=(n,e)=>(t,i)=>e(t,i,n);import{URI as v}from"../../../../base/common/uri.js";import{ExtensionIdentifier as f}from"../../../../platform/extensions/common/extensions.js";import"../../../../platform/instantiation/common/instantiation.js";import"../../../common/editor.js";import"../../webview/browser/webview.js";import"./webviewIconManager.js";import{WebviewInput as w}from"./webviewEditorInput.js";import{IWebviewWorkbenchService as b}from"./webviewWorkbenchService.js";let r=class{constructor(e){this._webviewWorkbenchService=e}static ID=w.typeId;canSerialize(e){return this._webviewWorkbenchService.shouldPersist(e)}serialize(e){if(!this.canSerialize(e))return;const t=this.toJson(e);try{return JSON.stringify(t)}catch{return}}deserialize(e,t){const i=this.fromJson(JSON.parse(t));return this._webviewWorkbenchService.openRevivedWebview({webviewInitInfo:{providedViewType:i.providedId,origin:i.origin,title:i.title,options:i.webviewOptions,contentOptions:i.contentOptions,extension:i.extension},viewType:i.viewType,title:i.title,iconPath:i.iconPath,state:i.state,group:i.group})}fromJson(e){return{...e,extension:g(e.extensionId,e.extensionLocation),iconPath:y(e.iconPath),state:W(e.state),webviewOptions:e.options,contentOptions:m(e.options)}}toJson(e){return{origin:e.webview.origin,viewType:e.viewType,providedId:e.providedId,title:e.getName(),options:{...e.webview.options,...e.webview.contentOptions},extensionLocation:e.extension?.location,extensionId:e.extension?.id.value,state:e.webview.state,iconPath:e.iconPath?{light:e.iconPath.light,dark:e.iconPath.dark}:void 0,group:e.group}}};r=c([p(0,b)],r);function g(n,e){if(!n)return;const t=s(e);if(t)return{id:new f(n),location:t}}function y(n){if(!n)return;const e=s(n.light),t=s(n.dark);return e&&t?{light:e,dark:t}:void 0}function s(n){if(n)try{return typeof n=="string"?v.parse(n):v.from(n)}catch{return}}function W(n){return typeof n=="string"?n:void 0}function L(n){return n}function m(n){return{...n,localResourceRoots:n.localResourceRoots?.map(e=>s(e))}}export{r as WebviewEditorInputSerializer,m as restoreWebviewContentOptions,L as restoreWebviewOptions,g as reviveWebviewExtensionDescription};
