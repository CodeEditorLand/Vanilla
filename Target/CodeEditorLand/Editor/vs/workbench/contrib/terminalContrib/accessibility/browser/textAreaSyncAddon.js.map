{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/terminalContrib/accessibility/browser/textAreaSyncAddon.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { ITerminalAddon, Terminal } from '@xterm/xterm';\nimport { debounce } from '../../../../../base/common/decorators.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../../base/common/lifecycle.js';\nimport { IAccessibilityService } from '../../../../../platform/accessibility/common/accessibility.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ITerminalCapabilityStore, TerminalCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { ITerminalLogService, TerminalSettingId } from '../../../../../platform/terminal/common/terminal.js';\n\nexport class TextAreaSyncAddon extends Disposable implements ITerminalAddon {\n\tprivate _terminal: Terminal | undefined;\n\tprivate readonly _listeners = this._register(new MutableDisposable());\n\n\tactivate(terminal: Terminal): void {\n\t\tthis._terminal = terminal;\n\t\tthis._refreshListeners();\n\t}\n\n\tconstructor(\n\t\tprivate readonly _capabilities: ITerminalCapabilityStore,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@ITerminalLogService private readonly _logService: ITerminalLogService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(Event.runAndSubscribe(Event.any(\n\t\t\tthis._capabilities.onDidAddCapability,\n\t\t\tthis._capabilities.onDidRemoveCapability,\n\t\t\tthis._accessibilityService.onDidChangeScreenReaderOptimized,\n\t\t), () => {\n\t\t\tthis._refreshListeners();\n\t\t}));\n\t}\n\n\tprivate _refreshListeners(): void {\n\t\tconst commandDetection = this._capabilities.get(TerminalCapability.CommandDetection);\n\t\tif (this._shouldBeActive() && commandDetection) {\n\t\t\tif (!this._listeners.value) {\n\t\t\t\tconst textarea = this._terminal?.textarea;\n\t\t\t\tif (textarea) {\n\t\t\t\t\tthis._listeners.value = Event.runAndSubscribe(commandDetection.promptInputModel.onDidChangeInput, () => this._sync(textarea));\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis._listeners.clear();\n\t\t}\n\t}\n\n\tprivate _shouldBeActive(): boolean {\n\t\treturn this._accessibilityService.isScreenReaderOptimized() || this._configurationService.getValue(TerminalSettingId.DevMode);\n\t}\n\n\t@debounce(50)\n\tprivate _sync(textArea: HTMLTextAreaElement): void {\n\t\tconst commandCapability = this._capabilities.get(TerminalCapability.CommandDetection);\n\t\tif (!commandCapability) {\n\t\t\treturn;\n\t\t}\n\n\t\ttextArea.value = commandCapability.promptInputModel.value;\n\t\ttextArea.selectionStart = commandCapability.promptInputModel.cursorIndex;\n\t\ttextArea.selectionEnd = commandCapability.promptInputModel.cursorIndex;\n\n\t\tthis._logService.debug(`TextAreaSyncAddon#sync: text changed to \"${textArea.value}\"`);\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAMA,SAAS,gBAAgB;AACzB,SAAS,aAAa;AACtB,SAAS,YAAY,yBAAyB;AAC9C,SAAS,6BAA6B;AACtC,SAAS,6BAA6B;AACtC,SAAS,0BAA0B,0BAA0B;AAC7D,SAAS,qBAAqB,yBAAyB;AAEhD,IAAM,oBAAN,cAAgC,WAAqC;AAAA,EAS3E,YACkB,eACuB,uBACA,uBACF,aACrC;AACD,UAAM;AALW;AACuB;AACA;AACF;AAItC,SAAK,UAAU,MAAM,gBAAgB,MAAM;AAAA,MAC1C,KAAK,cAAc;AAAA,MACnB,KAAK,cAAc;AAAA,MACnB,KAAK,sBAAsB;AAAA,IAC5B,GAAG,MAAM;AACR,WAAK,kBAAkB;AAAA,IACxB,CAAC,CAAC;AAAA,EACH;AAAA,EAtCD,OAc4E;AAAA;AAAA;AAAA,EACnE;AAAA,EACS,aAAa,KAAK,UAAU,IAAI,kBAAkB,CAAC;AAAA,EAEpE,SAAS,UAA0B;AAClC,SAAK,YAAY;AACjB,SAAK,kBAAkB;AAAA,EACxB;AAAA,EAmBQ,oBAA0B;AACjC,UAAM,mBAAmB,KAAK,cAAc,IAAI,mBAAmB,gBAAgB;AACnF,QAAI,KAAK,gBAAgB,KAAK,kBAAkB;AAC/C,UAAI,CAAC,KAAK,WAAW,OAAO;AAC3B,cAAM,WAAW,KAAK,WAAW;AACjC,YAAI,UAAU;AACb,eAAK,WAAW,QAAQ,MAAM,gBAAgB,iBAAiB,iBAAiB,kBAAkB,MAAM,KAAK,MAAM,QAAQ,CAAC;AAAA,QAC7H;AAAA,MACD;AAAA,IACD,OAAO;AACN,WAAK,WAAW,MAAM;AAAA,IACvB;AAAA,EACD;AAAA,EAEQ,kBAA2B;AAClC,WAAO,KAAK,sBAAsB,wBAAwB,KAAK,KAAK,sBAAsB,SAAS,kBAAkB,OAAO;AAAA,EAC7H;AAAA,EAGQ,MAAM,UAAqC;AAClD,UAAM,oBAAoB,KAAK,cAAc,IAAI,mBAAmB,gBAAgB;AACpF,QAAI,CAAC,mBAAmB;AACvB;AAAA,IACD;AAEA,aAAS,QAAQ,kBAAkB,iBAAiB;AACpD,aAAS,iBAAiB,kBAAkB,iBAAiB;AAC7D,aAAS,eAAe,kBAAkB,iBAAiB;AAE3D,SAAK,YAAY,MAAM,4CAA4C,SAAS,KAAK,GAAG;AAAA,EACrF;AACD;AAZS;AAAA,EADP,SAAS,EAAE;AAAA,GA5CA,kBA6CJ;AA7CI,oBAAN;AAAA,EAWJ;AAAA,EACA;AAAA,EACA;AAAA,GAbU;",
  "names": []
}
