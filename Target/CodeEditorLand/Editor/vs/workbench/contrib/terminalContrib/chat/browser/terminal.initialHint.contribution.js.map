{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/terminalContrib/chat/browser/terminal.initialHint.contribution.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../../../base/common/lifecycle.js';\nimport { IDetachedTerminalInstance, ITerminalContribution, ITerminalEditorService, ITerminalGroupService, ITerminalInstance, ITerminalService, IXtermTerminal } from '../../../terminal/browser/terminal.js';\nimport { registerTerminalContribution } from '../../../terminal/browser/terminalExtensions.js';\nimport type { Terminal as RawXtermTerminal, IDecoration, ITerminalAddon } from '@xterm/xterm';\nimport { TerminalWidgetManager } from '../../../terminal/browser/widgets/widgetManager.js';\nimport { ITerminalProcessManager, ITerminalProcessInfo } from '../../../terminal/common/terminal.js';\nimport { ITerminalCapabilityStore, TerminalCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { localize } from '../../../../../nls.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { OS } from '../../../../../base/common/platform.js';\nimport { KeybindingLabel } from '../../../../../base/browser/ui/keybindingLabel/keybindingLabel.js';\nimport { IContentActionHandler, renderFormattedText } from '../../../../../base/browser/formattedTextRenderer.js';\nimport { WorkbenchActionExecutedClassification, WorkbenchActionExecutedEvent } from '../../../../../base/common/actions.js';\nimport { AccessibilityVerbositySettingId } from '../../../accessibility/browser/accessibilityConfiguration.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IProductService } from '../../../../../platform/product/common/productService.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nimport { status } from '../../../../../base/browser/ui/aria/aria.js';\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { TerminalChatCommandId } from './terminalChat.js';\nimport { TerminalInstance } from '../../../terminal/browser/terminalInstance.js';\nimport './media/terminalInitialHint.css';\nimport { TerminalInitialHintSettingId } from '../common/terminalInitialHintConfiguration.js';\nimport { ChatAgentLocation, IChatAgent, IChatAgentService } from '../../../chat/common/chatAgents.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../../platform/storage/common/storage.js';\nimport { IContextMenuService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { StandardMouseEvent } from '../../../../../base/browser/mouseEvent.js';\n\nconst $ = dom.$;\n\nconst enum Constants {\n\tInitialHintHideStorageKey = 'terminal.initialHint.hide'\n}\n\nexport class InitialHintAddon extends Disposable implements ITerminalAddon {\n\tprivate readonly _onDidRequestCreateHint = this._register(new Emitter<void>());\n\tget onDidRequestCreateHint(): Event<void> { return this._onDidRequestCreateHint.event; }\n\tprivate readonly _disposables = this._register(new MutableDisposable<DisposableStore>());\n\n\tconstructor(private readonly _capabilities: ITerminalCapabilityStore,\n\t\tprivate readonly _onDidChangeAgents: Event<IChatAgent | undefined>) {\n\t\tsuper();\n\t}\n\tactivate(terminal: RawXtermTerminal): void {\n\t\tconst store = this._register(new DisposableStore());\n\t\tthis._disposables.value = store;\n\t\tconst capability = this._capabilities.get(TerminalCapability.CommandDetection);\n\t\tif (capability) {\n\t\t\tstore.add(Event.once(capability.promptInputModel.onDidStartInput)(() => this._onDidRequestCreateHint.fire()));\n\t\t} else {\n\t\t\tthis._register(this._capabilities.onDidAddCapability(e => {\n\t\t\t\tif (e.id === TerminalCapability.CommandDetection) {\n\t\t\t\t\tconst capability = e.capability;\n\t\t\t\t\tstore.add(Event.once(capability.promptInputModel.onDidStartInput)(() => this._onDidRequestCreateHint.fire()));\n\t\t\t\t\tif (!capability.promptInputModel.value) {\n\t\t\t\t\t\tthis._onDidRequestCreateHint.fire();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tconst agentListener = this._onDidChangeAgents((e) => {\n\t\t\tif (e?.locations.includes(ChatAgentLocation.Terminal)) {\n\t\t\t\tthis._onDidRequestCreateHint.fire();\n\t\t\t\tagentListener.dispose();\n\t\t\t}\n\t\t});\n\t\tthis._disposables.value?.add(agentListener);\n\t}\n}\n\nexport class TerminalInitialHintContribution extends Disposable implements ITerminalContribution {\n\tstatic readonly ID = 'terminal.initialHint';\n\n\tprivate _addon: InitialHintAddon | undefined;\n\n\tprivate _hintWidget: HTMLElement | undefined;\n\n\tstatic get(instance: ITerminalInstance | IDetachedTerminalInstance): TerminalInitialHintContribution | null {\n\t\treturn instance.getContribution<TerminalInitialHintContribution>(TerminalInitialHintContribution.ID);\n\t}\n\tprivate _decoration: IDecoration | undefined;\n\tprivate _xterm: IXtermTerminal & { raw: RawXtermTerminal } | undefined;\n\n\tconstructor(\n\t\tprivate readonly _instance: Pick<ITerminalInstance, 'capabilities' | 'shellLaunchConfig'> | IDetachedTerminalInstance,\n\t\tprocessManager: ITerminalProcessManager | ITerminalProcessInfo | undefined,\n\t\twidgetManager: TerminalWidgetManager | undefined,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@ITerminalEditorService private readonly _terminalEditorService: ITerminalEditorService,\n\t\t@IChatAgentService private readonly _chatAgentService: IChatAgentService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t) {\n\t\tsuper();\n\n\t\t// Reset hint state when config changes\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TerminalInitialHintSettingId.Enabled)) {\n\t\t\t\tthis._storageService.remove(Constants.InitialHintHideStorageKey, StorageScope.APPLICATION);\n\t\t\t}\n\t\t}));\n\t}\n\n\txtermOpen(xterm: IXtermTerminal & { raw: RawXtermTerminal }): void {\n\t\t// Don't show is the terminal was launched by an extension or a feature like debug\n\t\tif ('shellLaunchConfig' in this._instance && (this._instance.shellLaunchConfig.isExtensionOwnedTerminal || this._instance.shellLaunchConfig.isFeatureTerminal)) {\n\t\t\treturn;\n\t\t}\n\t\t// Don't show if disabled\n\t\tif (this._storageService.getBoolean(Constants.InitialHintHideStorageKey, StorageScope.APPLICATION, false)) {\n\t\t\treturn;\n\t\t}\n\t\t// Only show for the first terminal\n\t\tif (this._terminalGroupService.instances.length + this._terminalEditorService.instances.length !== 1) {\n\t\t\treturn;\n\t\t}\n\t\tthis._xterm = xterm;\n\t\tthis._addon = this._register(this._instantiationService.createInstance(InitialHintAddon, this._instance.capabilities, this._chatAgentService.onDidChangeAgents));\n\t\tthis._xterm.raw.loadAddon(this._addon);\n\t\tthis._register(this._addon.onDidRequestCreateHint(() => this._createHint()));\n\t}\n\n\tprivate _createHint(): void {\n\t\tconst instance = this._instance instanceof TerminalInstance ? this._instance : undefined;\n\t\tconst commandDetectionCapability = instance?.capabilities.get(TerminalCapability.CommandDetection);\n\t\tif (!instance || !this._xterm || this._hintWidget || !commandDetectionCapability || commandDetectionCapability.promptInputModel.value || !!instance.shellLaunchConfig.attachPersistentProcess) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._configurationService.getValue(TerminalInitialHintSettingId.Enabled)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._decoration) {\n\t\t\tconst marker = this._xterm.raw.registerMarker();\n\t\t\tif (!marker) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._xterm.raw.buffer.active.cursorX === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._register(marker);\n\t\t\tthis._decoration = this._xterm.raw.registerDecoration({\n\t\t\t\tmarker,\n\t\t\t\tx: this._xterm.raw.buffer.active.cursorX + 1,\n\t\t\t});\n\t\t\tif (this._decoration) {\n\t\t\t\tthis._register(this._decoration);\n\t\t\t}\n\t\t}\n\n\t\tthis._register(this._xterm.raw.onKey(() => this.dispose()));\n\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TerminalInitialHintSettingId.Enabled) && !this._configurationService.getValue(TerminalInitialHintSettingId.Enabled)) {\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t}));\n\n\t\tconst inputModel = commandDetectionCapability.promptInputModel;\n\t\tif (inputModel) {\n\t\t\tthis._register(inputModel.onDidChangeInput(() => {\n\t\t\t\tif (inputModel.value) {\n\t\t\t\t\tthis.dispose();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tif (!this._decoration) {\n\t\t\treturn;\n\t\t}\n\t\tthis._register(this._decoration);\n\t\tthis._register(this._decoration.onRender((e) => {\n\t\t\tif (!this._hintWidget && this._xterm?.isFocused && this._terminalGroupService.instances.length + this._terminalEditorService.instances.length === 1) {\n\t\t\t\tconst terminalAgents = this._chatAgentService.getActivatedAgents().filter(candidate => candidate.locations.includes(ChatAgentLocation.Terminal));\n\t\t\t\tif (terminalAgents?.length) {\n\t\t\t\t\tconst widget = this._register(this._instantiationService.createInstance(TerminalInitialHintWidget, instance));\n\t\t\t\t\tthis._addon?.dispose();\n\t\t\t\t\tthis._hintWidget = widget.getDomNode(terminalAgents);\n\t\t\t\t\tif (!this._hintWidget) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\te.appendChild(this._hintWidget);\n\t\t\t\t\te.classList.add('terminal-initial-hint');\n\t\t\t\t\tconst font = this._xterm.getFont();\n\t\t\t\t\tif (font) {\n\t\t\t\t\t\te.style.fontFamily = font.fontFamily;\n\t\t\t\t\t\te.style.fontSize = font.fontSize + 'px';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._hintWidget && this._xterm) {\n\t\t\t\tconst decoration = this._hintWidget.parentElement;\n\t\t\t\tif (decoration) {\n\t\t\t\t\tdecoration.style.width = (this._xterm.raw.cols - this._xterm.raw.buffer.active.cursorX) / this._xterm!.raw.cols * 100 + '%';\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n}\nregisterTerminalContribution(TerminalInitialHintContribution.ID, TerminalInitialHintContribution, false);\n\nclass TerminalInitialHintWidget extends Disposable {\n\n\n\tprivate domNode: HTMLElement | undefined;\n\tprivate readonly toDispose: DisposableStore = this._register(new DisposableStore());\n\tprivate isVisible = false;\n\tprivate ariaLabel: string = '';\n\n\tconstructor(\n\t\tprivate readonly _instance: ITerminalInstance,\n\t\t@IChatAgentService private readonly _chatAgentService: IChatAgentService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@ITerminalService private readonly terminalService: ITerminalService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService\n\t) {\n\t\tsuper();\n\t\tthis.toDispose.add(_instance.onDidFocus(() => {\n\t\t\tif (this._instance.hasFocus && this.isVisible && this.ariaLabel && this.configurationService.getValue(AccessibilityVerbositySettingId.TerminalChat)) {\n\t\t\t\tstatus(this.ariaLabel);\n\t\t\t}\n\t\t}));\n\t\tthis.toDispose.add(terminalService.onDidChangeInstances(() => {\n\t\t\tif (this.terminalService.instances.length !== 1) {\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t}));\n\t\tthis.toDispose.add(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TerminalInitialHintSettingId.Enabled) && !this.configurationService.getValue(TerminalInitialHintSettingId.Enabled)) {\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _getHintInlineChat(agents: IChatAgent[]) {\n\t\tlet providerName = (agents.length === 1 ? agents[0].fullName : undefined) ?? this.productService.nameShort;\n\t\tconst defaultAgent = this._chatAgentService.getDefaultAgent(ChatAgentLocation.Panel);\n\t\tif (defaultAgent?.extensionId.value === agents[0].extensionId.value) {\n\t\t\tproviderName = defaultAgent.fullName ?? providerName;\n\t\t}\n\n\t\tlet ariaLabel = `Ask ${providerName} something or start typing to dismiss.`;\n\n\t\tconst handleClick = () => {\n\t\t\tthis._storageService.store(Constants.InitialHintHideStorageKey, true, StorageScope.APPLICATION, StorageTarget.USER);\n\t\t\tthis.telemetryService.publicLog2<WorkbenchActionExecutedEvent, WorkbenchActionExecutedClassification>('workbenchActionExecuted', {\n\t\t\t\tid: 'terminalInlineChat.hintAction',\n\t\t\t\tfrom: 'hint'\n\t\t\t});\n\t\t\tthis.commandService.executeCommand(TerminalChatCommandId.Start, { from: 'hint' });\n\t\t};\n\t\tthis.toDispose.add(this.commandService.onDidExecuteCommand(e => {\n\t\t\tif (e.commandId === TerminalChatCommandId.Start) {\n\t\t\t\tthis._storageService.store(Constants.InitialHintHideStorageKey, true, StorageScope.APPLICATION, StorageTarget.USER);\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t}));\n\n\t\tconst hintHandler: IContentActionHandler = {\n\t\t\tdisposables: this.toDispose,\n\t\t\tcallback: (index, _event) => {\n\t\t\t\tswitch (index) {\n\t\t\t\t\tcase '0':\n\t\t\t\t\t\thandleClick();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tconst hintElement = $('div.terminal-initial-hint');\n\t\thintElement.style.display = 'block';\n\n\t\tconst keybindingHint = this.keybindingService.lookupKeybinding(TerminalChatCommandId.Start);\n\t\tconst keybindingHintLabel = keybindingHint?.getLabel();\n\n\t\tif (keybindingHint && keybindingHintLabel) {\n\t\t\tconst actionPart = localize('emptyHintText', 'Press {0} to ask {1} to do something. ', keybindingHintLabel, providerName);\n\n\t\t\tconst [before, after] = actionPart.split(keybindingHintLabel).map((fragment) => {\n\t\t\t\tconst hintPart = $('a', undefined, fragment);\n\t\t\t\tthis.toDispose.add(dom.addDisposableListener(hintPart, dom.EventType.CLICK, handleClick));\n\t\t\t\treturn hintPart;\n\t\t\t});\n\n\t\t\thintElement.appendChild(before);\n\n\t\t\tconst label = hintHandler.disposables.add(new KeybindingLabel(hintElement, OS));\n\t\t\tlabel.set(keybindingHint);\n\t\t\tlabel.element.style.width = 'min-content';\n\t\t\tlabel.element.style.display = 'inline';\n\n\t\t\tlabel.element.style.cursor = 'pointer';\n\t\t\tthis.toDispose.add(dom.addDisposableListener(label.element, dom.EventType.CLICK, handleClick));\n\n\t\t\thintElement.appendChild(after);\n\n\t\t\tconst typeToDismiss = localize('hintTextDismiss', 'Start typing to dismiss.');\n\t\t\tconst textHint2 = $('span.detail', undefined, typeToDismiss);\n\t\t\thintElement.appendChild(textHint2);\n\n\t\t\tariaLabel = actionPart.concat(typeToDismiss);\n\t\t} else {\n\t\t\tconst hintMsg = localize({\n\t\t\t\tkey: 'inlineChatHint',\n\t\t\t\tcomment: [\n\t\t\t\t\t'Preserve double-square brackets and their order',\n\t\t\t\t]\n\t\t\t}, '[[Ask {0} to do something]] or start typing to dismiss.', providerName);\n\t\t\tconst rendered = renderFormattedText(hintMsg, { actionHandler: hintHandler });\n\t\t\thintElement.appendChild(rendered);\n\t\t}\n\n\t\treturn { ariaLabel, hintHandler, hintElement };\n\t}\n\n\tgetDomNode(agents: IChatAgent[]): HTMLElement {\n\t\tif (!this.domNode) {\n\t\t\tthis.domNode = $('.terminal-initial-hint');\n\t\t\tthis.domNode!.style.paddingLeft = '4px';\n\n\t\t\tconst { hintElement, ariaLabel } = this._getHintInlineChat(agents);\n\t\t\tthis.domNode.append(hintElement);\n\t\t\tthis.ariaLabel = ariaLabel.concat(localize('disableHint', ' Toggle {0} in settings to disable this hint.', AccessibilityVerbositySettingId.TerminalChat));\n\n\t\t\tthis.toDispose.add(dom.addDisposableListener(this.domNode, 'click', () => {\n\t\t\t\tthis.domNode?.remove();\n\t\t\t\tthis.domNode = undefined;\n\t\t\t}));\n\n\t\t\tthis.toDispose.add(dom.addDisposableListener(this.domNode, dom.EventType.CONTEXT_MENU, (e) => {\n\t\t\t\tthis.contextMenuService.showContextMenu({\n\t\t\t\t\tgetAnchor: () => { return new StandardMouseEvent(dom.getActiveWindow(), e); },\n\t\t\t\t\tgetActions: () => {\n\t\t\t\t\t\treturn [{\n\t\t\t\t\t\t\tid: 'workench.action.disableTerminalInitialHint',\n\t\t\t\t\t\t\tlabel: localize('disableInitialHint', \"Disable Initial Hint\"),\n\t\t\t\t\t\t\ttooltip: localize('disableInitialHint', \"Disable Initial Hint\"),\n\t\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\t\tclass: undefined,\n\t\t\t\t\t\t\trun: () => this.configurationService.updateValue(TerminalInitialHintSettingId.Enabled, false)\n\t\t\t\t\t\t}\n\t\t\t\t\t\t];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}));\n\t\t}\n\t\treturn this.domNode;\n\t}\n\n\toverride dispose(): void {\n\t\tthis.domNode?.remove();\n\t\tsuper.dispose();\n\t}\n}\n"],
  "mappings": "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",
  "names": ["Constants", "capability"]
}
