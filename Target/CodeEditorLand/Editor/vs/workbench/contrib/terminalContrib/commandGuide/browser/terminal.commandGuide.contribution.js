var g=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var c=(m,o,e,r)=>{for(var t=r>1?void 0:r?p(o,e):o,i=m.length-1,n;i>=0;i--)(n=m[i])&&(t=(r?n(o,e,t):n(t))||t);return r&&t&&g(o,e,t),t},d=(m,o)=>(e,r)=>o(e,r,m);import{addDisposableListener as l}from"../../../../../../vs/base/browser/dom.js";import{combinedDisposable as I,Disposable as C,MutableDisposable as v}from"../../../../../../vs/base/common/lifecycle.js";import{localize as T}from"../../../../../../vs/nls.js";import{IConfigurationService as w}from"../../../../../../vs/platform/configuration/common/configuration.js";import{TerminalCapability as _}from"../../../../../../vs/platform/terminal/common/capabilities/capabilities.js";import{listInactiveSelectionBackground as u}from"../../../../../../vs/platform/theme/common/colorRegistry.js";import{registerColor as D,transparent as f}from"../../../../../../vs/platform/theme/common/colorUtils.js";import{PANEL_BORDER as h}from"../../../../../../vs/workbench/common/theme.js";import"../../../../../../vs/workbench/contrib/terminal/browser/terminal.js";import{registerTerminalContribution as S}from"../../../../../../vs/workbench/contrib/terminal/browser/terminalExtensions.js";import"../../../../../../vs/workbench/contrib/terminal/browser/widgets/widgetManager.js";import"../../../../../../vs/workbench/contrib/terminal/common/terminal.js";import{terminalCommandGuideConfigSection as G,TerminalCommandGuideSettingId as M}from"../../../../../../vs/workbench/contrib/terminalContrib/commandGuide/common/terminalCommandGuideConfiguration.js";let a=class extends C{constructor(e,r,t,i){super();this._instance=e;this._configurationService=i}static ID="terminal.highlight";static get(e){return e.getContribution(a.ID)}_xterm;_activeCommandGuide=this._register(new v);xtermOpen(e){this._xterm=e,this._refreshActivatedState(),this._configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration(M.ShowCommandGuide)&&this._refreshActivatedState()})}_refreshActivatedState(){const e=this._xterm;if(!e)return;const r=this._configurationService.getValue(G).showCommandGuide;if(!!this._activeCommandGuide.value!==r)if(!r)this._activeCommandGuide.clear();else{const t=e.raw.element.querySelector(".xterm-screen"),i=e.raw.element.querySelector(".xterm-viewport");this._activeCommandGuide.value=I(l(t,"mousemove",n=>this._tryShowHighlight(t,e,n)),l(i,"mousemove",n=>this._tryShowHighlight(t,e,n)),l(e.raw.element,"mouseout",()=>e.markTracker.showCommandGuide(void 0)),e.raw.onData(()=>e.markTracker.showCommandGuide(void 0)))}}_tryShowHighlight(e,r,t){const i=e.getBoundingClientRect();if(!i)return;const n=Math.floor(t.offsetY/(i.height/r.raw.rows)),s=this._instance.capabilities.get(_.CommandDetection)?.getCommandForLine(r.raw.buffer.active.viewportY+n);s&&"getOutput"in s?r.markTracker.showCommandGuide(s):r.markTracker.showCommandGuide(void 0)}};a=c([d(3,w)],a),S(a.ID,a,!1);const j=D("terminalCommandGuide.foreground",{dark:f(u,1),light:f(u,1),hcDark:h,hcLight:h},T("terminalCommandGuide.foreground","The foreground color of the terminal command guide that appears to the left of a command and its output on hover."));export{j as TERMINAL_COMMAND_GUIDE_COLOR};
