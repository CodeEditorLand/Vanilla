var l=Object.defineProperty;var c=Object.getOwnPropertyDescriptor;var m=(n,t,i,e)=>{for(var a=e>1?void 0:e?c(t,i):t,o=n.length-1,d;o>=0;o--)(d=n[o])&&(a=(e?d(t,i,a):d(a))||a);return e&&a&&l(t,i,a),a},s=(n,t)=>(i,e)=>t(i,e,n);import{DisposableStore as p,toDisposable as g}from"../../../../../base/common/lifecycle.js";import{IConfigurationService as f}from"../../../../../platform/configuration/common/configuration.js";import{IInstantiationService as h}from"../../../../../platform/instantiation/common/instantiation.js";import{registerTerminalContribution as I}from"../../../terminal/browser/terminalExtensions.js";import{TERMINAL_CONFIG_SECTION as T}from"../../../terminal/common/terminal.js";import{TerminalTypeAheadSettingId as u}from"../common/terminalTypeAheadConfiguration.js";import{TypeAheadAddon as _}from"./terminalTypeAheadAddon.js";let r=class extends p{constructor(i,e,a,o,d){super();this._processManager=e;this._configurationService=o;this._instantiationService=d;this.add(g(()=>this._addon?.dispose()))}static ID="terminal.typeAhead";static get(i){return i.getContribution(r.ID)}_addon;xtermReady(i){this._loadTypeAheadAddon(i.raw),this.add(this._configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(u.LocalEchoEnabled)&&this._loadTypeAheadAddon(i.raw)})),this.add(this._processManager.onProcessReady(()=>{this._addon?.reset()}))}_loadTypeAheadAddon(i){const e=this._configurationService.getValue(T).localEchoEnabled,a=!!this._processManager.remoteAuthority;if(e==="off"||e==="auto"&&!a){this._addon?.dispose(),this._addon=void 0;return}this._addon||(e==="on"||e==="auto"&&a)&&(this._addon=this._instantiationService.createInstance(_,this._processManager),i.loadAddon(this._addon))}};r=m([s(3,f),s(4,h)],r),I(r.ID,r);
