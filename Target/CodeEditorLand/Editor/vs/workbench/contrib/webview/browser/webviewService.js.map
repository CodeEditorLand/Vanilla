{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/webview/browser/webviewService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from \"../../../../base/common/event.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n} from \"../../../../base/common/lifecycle.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { OverlayWebview } from \"./overlayWebview.js\";\nimport { WebviewThemeDataProvider } from \"./themeing.js\";\nimport type {\n\tIOverlayWebview,\n\tIWebview,\n\tIWebviewElement,\n\tIWebviewService,\n\tWebviewInitInfo,\n} from \"./webview.js\";\nimport { WebviewElement } from \"./webviewElement.js\";\n\nexport class WebviewService extends Disposable implements IWebviewService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprotected readonly _webviewThemeDataProvider: WebviewThemeDataProvider;\n\n\tconstructor(\n\t\t@IInstantiationService protected readonly _instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t\tthis._webviewThemeDataProvider = this._instantiationService.createInstance(WebviewThemeDataProvider);\n\t}\n\n\tprivate _activeWebview?: IWebview;\n\n\tpublic get activeWebview() {\n\t\treturn this._activeWebview;\n\t}\n\n\tprivate _updateActiveWebview(value: IWebview | undefined) {\n\t\tif (value !== this._activeWebview) {\n\t\t\tthis._activeWebview = value;\n\t\t\tthis._onDidChangeActiveWebview.fire(value);\n\t\t}\n\t}\n\n\tprivate _webviews = new Set<IWebview>();\n\n\tpublic get webviews(): Iterable<IWebview> {\n\t\treturn this._webviews.values();\n\t}\n\n\tprivate readonly _onDidChangeActiveWebview = this._register(\n\t\tnew Emitter<IWebview | undefined>(),\n\t);\n\tpublic readonly onDidChangeActiveWebview =\n\t\tthis._onDidChangeActiveWebview.event;\n\n\tcreateWebviewElement(initInfo: WebviewInitInfo): IWebviewElement {\n\t\tconst webview = this._instantiationService.createInstance(\n\t\t\tWebviewElement,\n\t\t\tinitInfo,\n\t\t\tthis._webviewThemeDataProvider,\n\t\t);\n\t\tthis.registerNewWebview(webview);\n\t\treturn webview;\n\t}\n\n\tcreateWebviewOverlay(initInfo: WebviewInitInfo): IOverlayWebview {\n\t\tconst webview = this._instantiationService.createInstance(\n\t\t\tOverlayWebview,\n\t\t\tinitInfo,\n\t\t);\n\t\tthis.registerNewWebview(webview);\n\t\treturn webview;\n\t}\n\n\tprotected registerNewWebview(webview: IWebview) {\n\t\tthis._webviews.add(webview);\n\n\t\tconst store = new DisposableStore();\n\n\t\tstore.add(\n\t\t\twebview.onDidFocus(() => {\n\t\t\t\tthis._updateActiveWebview(webview);\n\t\t\t}),\n\t\t);\n\n\t\tconst onBlur = () => {\n\t\t\tif (this._activeWebview === webview) {\n\t\t\t\tthis._updateActiveWebview(undefined);\n\t\t\t}\n\t\t};\n\n\t\tstore.add(webview.onDidBlur(onBlur));\n\t\tstore.add(\n\t\t\twebview.onDidDispose(() => {\n\t\t\t\tonBlur();\n\t\t\t\tstore.dispose();\n\t\t\t\tthis._webviews.delete(webview);\n\t\t\t}),\n\t\t);\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,eAAe;AACxB;AAAA,EACC;AAAA,EACA;AAAA,OACM;AACP,SAAS,6BAA6B;AACtC,SAAS,sBAAsB;AAC/B,SAAS,gCAAgC;AAQzC,SAAS,sBAAsB;AAExB,IAAM,iBAAN,cAA6B,WAAsC;AAAA,EAKzE,YAC2C,uBACzC;AACD,UAAM;AAFoC;AAG1C,SAAK,4BAA4B,KAAK,sBAAsB,eAAe,wBAAwB;AAAA,EACpG;AAAA,EAhCD,OAsB0E;AAAA;AAAA;AAAA,EAGtD;AAAA,EASX;AAAA,EAER,IAAW,gBAAgB;AAC1B,WAAO,KAAK;AAAA,EACb;AAAA,EAEQ,qBAAqB,OAA6B;AACzD,QAAI,UAAU,KAAK,gBAAgB;AAClC,WAAK,iBAAiB;AACtB,WAAK,0BAA0B,KAAK,KAAK;AAAA,IAC1C;AAAA,EACD;AAAA,EAEQ,YAAY,oBAAI,IAAc;AAAA,EAEtC,IAAW,WAA+B;AACzC,WAAO,KAAK,UAAU,OAAO;AAAA,EAC9B;AAAA,EAEiB,4BAA4B,KAAK;AAAA,IACjD,IAAI,QAA8B;AAAA,EACnC;AAAA,EACgB,2BACf,KAAK,0BAA0B;AAAA,EAEhC,qBAAqB,UAA4C;AAChE,UAAM,UAAU,KAAK,sBAAsB;AAAA,MAC1C;AAAA,MACA;AAAA,MACA,KAAK;AAAA,IACN;AACA,SAAK,mBAAmB,OAAO;AAC/B,WAAO;AAAA,EACR;AAAA,EAEA,qBAAqB,UAA4C;AAChE,UAAM,UAAU,KAAK,sBAAsB;AAAA,MAC1C;AAAA,MACA;AAAA,IACD;AACA,SAAK,mBAAmB,OAAO;AAC/B,WAAO;AAAA,EACR;AAAA,EAEU,mBAAmB,SAAmB;AAC/C,SAAK,UAAU,IAAI,OAAO;AAE1B,UAAM,QAAQ,IAAI,gBAAgB;AAElC,UAAM;AAAA,MACL,QAAQ,WAAW,MAAM;AACxB,aAAK,qBAAqB,OAAO;AAAA,MAClC,CAAC;AAAA,IACF;AAEA,UAAM,SAAS,6BAAM;AACpB,UAAI,KAAK,mBAAmB,SAAS;AACpC,aAAK,qBAAqB,MAAS;AAAA,MACpC;AAAA,IACD,GAJe;AAMf,UAAM,IAAI,QAAQ,UAAU,MAAM,CAAC;AACnC,UAAM;AAAA,MACL,QAAQ,aAAa,MAAM;AAC1B,eAAO;AACP,cAAM,QAAQ;AACd,aAAK,UAAU,OAAO,OAAO;AAAA,MAC9B,CAAC;AAAA,IACF;AAAA,EACD;AACD;AAlFa,iBAAN;AAAA,EAMJ;AAAA,GANU;",
  "names": []
}
