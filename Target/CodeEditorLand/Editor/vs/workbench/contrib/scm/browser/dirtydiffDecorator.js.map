{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/scm/browser/dirtydiffDecorator.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from \"../../../../nls.js\";\n\nimport \"./media/dirtydiffDecorator.css\";\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport type { IActionBarOptions } from \"../../../../base/browser/ui/actionbar/actionbar.js\";\nimport {\n\tAction,\n\tActionRunner,\n\ttype IAction,\n} from \"../../../../base/common/actions.js\";\nimport { equals, sortedDiff } from \"../../../../base/common/arrays.js\";\nimport { ThrottledDelayer } from \"../../../../base/common/async.js\";\nimport { Codicon } from \"../../../../base/common/codicons.js\";\nimport { Color } from \"../../../../base/common/color.js\";\nimport { onUnexpectedError } from \"../../../../base/common/errors.js\";\nimport { Emitter, Event } from \"../../../../base/common/event.js\";\nimport { KeyCode, KeyMod } from \"../../../../base/common/keyCodes.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n\ttype IDisposable,\n\tdispose,\n\ttoDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport { ResourceMap } from \"../../../../base/common/map.js\";\nimport { rot } from \"../../../../base/common/numbers.js\";\nimport { basename } from \"../../../../base/common/resources.js\";\nimport type { ISplice } from \"../../../../base/common/sequence.js\";\nimport { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport {\n\ttype ICodeEditor,\n\ttype IEditorMouseEvent,\n\tMouseTargetType,\n\tisCodeEditor,\n} from \"../../../../editor/browser/editorBrowser.js\";\nimport {\n\tEditorAction,\n\tEditorContributionInstantiation,\n\ttype ServicesAccessor,\n\tregisterEditorAction,\n\tregisterEditorContribution,\n} from \"../../../../editor/browser/editorExtensions.js\";\nimport { ICodeEditorService } from \"../../../../editor/browser/services/codeEditorService.js\";\nimport { EmbeddedDiffEditorWidget } from \"../../../../editor/browser/widget/diffEditor/embeddedDiffEditorWidget.js\";\nimport {\n\tEditorOption,\n\ttype IDiffEditorOptions,\n} from \"../../../../editor/common/config/editorOptions.js\";\nimport { Position } from \"../../../../editor/common/core/position.js\";\nimport type { Range } from \"../../../../editor/common/core/range.js\";\nimport type { IChange } from \"../../../../editor/common/diff/legacyLinesDiffComputer.js\";\nimport {\n\ttype IDiffEditorModel,\n\ttype IEditorContribution,\n\ttype IEditorDecorationsCollection,\n\ttype IEditorModel,\n\tScrollType,\n} from \"../../../../editor/common/editorCommon.js\";\nimport { EditorContextKeys } from \"../../../../editor/common/editorContextKeys.js\";\nimport {\n\ttype IModelDecorationOptions,\n\ttype ITextModel,\n\tMinimapPosition,\n\tOverviewRulerLane,\n\tshouldSynchronizeModel,\n} from \"../../../../editor/common/model.js\";\nimport { ModelDecorationOptions } from \"../../../../editor/common/model/textModel.js\";\nimport { IEditorWorkerService } from \"../../../../editor/common/services/editorWorker.js\";\nimport {\n\ttype IResolvedTextEditorModel,\n\tITextModelService,\n} from \"../../../../editor/common/services/resolverService.js\";\nimport {\n\tPeekViewWidget,\n\tgetOuterEditor,\n\tpeekViewBorder,\n\tpeekViewTitleBackground,\n\tpeekViewTitleForeground,\n\tpeekViewTitleInfoForeground,\n} from \"../../../../editor/contrib/peekView/browser/peekView.js\";\nimport { IAccessibilityService } from \"../../../../platform/accessibility/common/accessibility.js\";\nimport {\n\tAccessibilitySignal,\n\tIAccessibilitySignalService,\n} from \"../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js\";\nimport { createAndFillInActionBarActions } from \"../../../../platform/actions/browser/menuEntryActionViewItem.js\";\nimport {\n\ttype IMenu,\n\tIMenuService,\n\tMenuId,\n\tMenuItemAction,\n\tMenuRegistry,\n} from \"../../../../platform/actions/common/actions.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport {\n\tContextKeyExpr,\n\ttype IContextKey,\n\tIContextKeyService,\n\tRawContextKey,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { IKeybindingService } from \"../../../../platform/keybinding/common/keybinding.js\";\nimport {\n\tKeybindingWeight,\n\tKeybindingsRegistry,\n} from \"../../../../platform/keybinding/common/keybindingsRegistry.js\";\nimport {\n\tIProgressService,\n\tProgressLocation,\n} from \"../../../../platform/progress/common/progress.js\";\nimport {\n\teditorErrorForeground,\n\tregisterColor,\n\ttransparent,\n} from \"../../../../platform/theme/common/colorRegistry.js\";\nimport {\n\tgotoNextLocation,\n\tgotoPreviousLocation,\n} from \"../../../../platform/theme/common/iconRegistry.js\";\nimport {\n\ttype IColorTheme,\n\tIThemeService,\n\tthemeColorFromId,\n} from \"../../../../platform/theme/common/themeService.js\";\nimport { TextCompareEditorActiveContext } from \"../../../common/contextkeys.js\";\nimport type * as ext from \"../../../common/contributions.js\";\nimport { IEditorService } from \"../../../services/editor/common/editorService.js\";\nimport {\n\tEncodingMode,\n\ttype IResolvedTextFileEditorModel,\n\ttype ITextFileEditorModel,\n\tITextFileService,\n\tisTextFileEditorModel,\n} from \"../../../services/textfile/common/textfiles.js\";\nimport { IQuickDiffService, type QuickDiff } from \"../common/quickDiff.js\";\nimport { type ISCMRepository, ISCMService } from \"../common/scm.js\";\nimport {\n\ttype IQuickDiffSelectItem,\n\tSwitchQuickDiffBaseAction,\n\tSwitchQuickDiffViewItem,\n} from \"./dirtyDiffSwitcher.js\";\n\nclass DiffActionRunner extends ActionRunner {\n\tprotected override runAction(action: IAction, context: any): Promise<any> {\n\t\tif (action instanceof MenuItemAction) {\n\t\t\treturn action.run(...context);\n\t\t}\n\n\t\treturn super.runAction(action, context);\n\t}\n}\n\nexport interface IModelRegistry {\n\tgetModel(\n\t\teditorModel: IEditorModel,\n\t\tcodeEditor: ICodeEditor,\n\t): DirtyDiffModel | undefined;\n}\n\nexport interface DirtyDiffContribution extends IEditorContribution {\n\tgetChanges(): IChange[];\n}\n\nexport const isDirtyDiffVisible = new RawContextKey<boolean>(\n\t\"dirtyDiffVisible\",\n\tfalse,\n);\n\nfunction getChangeHeight(change: IChange): number {\n\tconst modified =\n\t\tchange.modifiedEndLineNumber - change.modifiedStartLineNumber + 1;\n\tconst original =\n\t\tchange.originalEndLineNumber - change.originalStartLineNumber + 1;\n\n\tif (change.originalEndLineNumber === 0) {\n\t\treturn modified;\n\t} else if (change.modifiedEndLineNumber === 0) {\n\t\treturn original;\n\t} else {\n\t\treturn modified + original;\n\t}\n}\n\nfunction getModifiedEndLineNumber(change: IChange): number {\n\tif (change.modifiedEndLineNumber === 0) {\n\t\treturn change.modifiedStartLineNumber === 0\n\t\t\t? 1\n\t\t\t: change.modifiedStartLineNumber;\n\t} else {\n\t\treturn change.modifiedEndLineNumber;\n\t}\n}\n\nfunction lineIntersectsChange(lineNumber: number, change: IChange): boolean {\n\t// deletion at the beginning of the file\n\tif (\n\t\tlineNumber === 1 &&\n\t\tchange.modifiedStartLineNumber === 0 &&\n\t\tchange.modifiedEndLineNumber === 0\n\t) {\n\t\treturn true;\n\t}\n\n\treturn (\n\t\tlineNumber >= change.modifiedStartLineNumber &&\n\t\tlineNumber <=\n\t\t\t(change.modifiedEndLineNumber || change.modifiedStartLineNumber)\n\t);\n}\n\nclass UIEditorAction extends Action {\n\tprivate editor: ICodeEditor;\n\tprivate action: EditorAction;\n\tprivate instantiationService: IInstantiationService;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\taction: EditorAction,\n\t\tcssClass: string,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tconst keybinding = keybindingService.lookupKeybinding(action.id);\n\t\tconst label =\n\t\t\taction.label + (keybinding ? ` (${keybinding.getLabel()})` : \"\");\n\n\t\tsuper(action.id, label, cssClass);\n\n\t\tthis.instantiationService = instantiationService;\n\t\tthis.action = action;\n\t\tthis.editor = editor;\n\t}\n\n\toverride run(): Promise<any> {\n\t\treturn Promise.resolve(\n\t\t\tthis.instantiationService.invokeFunction((accessor) =>\n\t\t\t\tthis.action.run(accessor, this.editor, null),\n\t\t\t),\n\t\t);\n\t}\n}\n\nenum ChangeType {\n\tModify = 0,\n\tAdd = 1,\n\tDelete = 2,\n}\n\nfunction getChangeType(change: IChange): ChangeType {\n\tif (change.originalEndLineNumber === 0) {\n\t\treturn ChangeType.Add;\n\t} else if (change.modifiedEndLineNumber === 0) {\n\t\treturn ChangeType.Delete;\n\t} else {\n\t\treturn ChangeType.Modify;\n\t}\n}\n\nfunction getChangeTypeColor(\n\ttheme: IColorTheme,\n\tchangeType: ChangeType,\n): Color | undefined {\n\tswitch (changeType) {\n\t\tcase ChangeType.Modify:\n\t\t\treturn theme.getColor(editorGutterModifiedBackground);\n\t\tcase ChangeType.Add:\n\t\t\treturn theme.getColor(editorGutterAddedBackground);\n\t\tcase ChangeType.Delete:\n\t\t\treturn theme.getColor(editorGutterDeletedBackground);\n\t}\n}\n\nfunction getOuterEditorFromDiffEditor(\n\taccessor: ServicesAccessor,\n): ICodeEditor | null {\n\tconst diffEditors = accessor.get(ICodeEditorService).listDiffEditors();\n\n\tfor (const diffEditor of diffEditors) {\n\t\tif (\n\t\t\tdiffEditor.hasTextFocus() &&\n\t\t\tdiffEditor instanceof EmbeddedDiffEditorWidget\n\t\t) {\n\t\t\treturn diffEditor.getParentEditor();\n\t\t}\n\t}\n\n\treturn getOuterEditor(accessor);\n}\n\nclass DirtyDiffWidget extends PeekViewWidget {\n\tprivate diffEditor!: EmbeddedDiffEditorWidget;\n\tprivate title: string;\n\tprivate menu: IMenu | undefined;\n\tprivate _index = 0;\n\tprivate _provider = \"\";\n\tprivate change: IChange | undefined;\n\tprivate height: number | undefined = undefined;\n\tprivate dropdown: SwitchQuickDiffViewItem | undefined;\n\tprivate dropdownContainer: HTMLElement | undefined;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tprivate model: DirtyDiffModel,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IContextKeyService private contextKeyService: IContextKeyService\n\t) {\n\t\tsuper(editor, { isResizeable: true, frameWidth: 1, keepEditorSelection: true, className: 'dirty-diff' }, instantiationService);\n\n\t\tthis._disposables.add(themeService.onDidColorThemeChange(this._applyTheme, this));\n\t\tthis._applyTheme(themeService.getColorTheme());\n\n\t\tif (this.model.original.length > 0) {\n\t\t\tcontextKeyService = contextKeyService.createOverlay([['originalResourceScheme', this.model.original[0].uri.scheme], ['originalResourceSchemes', this.model.original.map(original => original.uri.scheme)]]);\n\t\t}\n\n\t\tthis.create();\n\t\tif (editor.hasModel()) {\n\t\t\tthis.title = basename(editor.getModel().uri);\n\t\t} else {\n\t\t\tthis.title = '';\n\t\t}\n\t\tthis.setTitle(this.title);\n\t}\n\n\tget provider(): string {\n\t\treturn this._provider;\n\t}\n\n\tget index(): number {\n\t\treturn this._index;\n\t}\n\n\tget visibleRange(): Range | undefined {\n\t\tconst visibleRanges = this.diffEditor\n\t\t\t.getModifiedEditor()\n\t\t\t.getVisibleRanges();\n\t\treturn visibleRanges.length >= 0 ? visibleRanges[0] : undefined;\n\t}\n\n\tshowChange(index: number, usePosition = true): void {\n\t\tconst labeledChange = this.model.changes[index];\n\t\tconst change = labeledChange.change;\n\t\tthis._index = index;\n\t\tthis.contextKeyService.createKey(\n\t\t\t\"originalResourceScheme\",\n\t\t\tthis.model.changes[index].uri.scheme,\n\t\t);\n\t\tthis.updateActions();\n\n\t\tthis._provider = labeledChange.label;\n\t\tthis.change = change;\n\n\t\tconst originalModel = this.model.original;\n\n\t\tif (!originalModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst onFirstDiffUpdate = Event.once(this.diffEditor.onDidUpdateDiff);\n\n\t\t// TODO@joao TODO@alex need this setTimeout probably because the\n\t\t// non-side-by-side diff still hasn't created the view zones\n\t\tonFirstDiffUpdate(() => setTimeout(() => this.revealChange(change), 0));\n\n\t\tconst diffEditorModel = this.model.getDiffEditorModel(\n\t\t\tlabeledChange.uri.toString(),\n\t\t);\n\t\tif (!diffEditorModel) {\n\t\t\treturn;\n\t\t}\n\t\tthis.diffEditor.setModel(diffEditorModel);\n\t\tthis.dropdown?.setSelection(labeledChange.label);\n\n\t\tconst position = new Position(getModifiedEndLineNumber(change), 1);\n\n\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\tconst editorHeight = this.editor.getLayoutInfo().height;\n\t\tconst editorHeightInLines = Math.floor(editorHeight / lineHeight);\n\t\tconst height = Math.min(\n\t\t\tgetChangeHeight(change) + /* padding */ 8,\n\t\t\tMath.floor(editorHeightInLines / 3),\n\t\t);\n\n\t\tthis.renderTitle(labeledChange.label);\n\n\t\tconst changeType = getChangeType(change);\n\t\tconst changeTypeColor = getChangeTypeColor(\n\t\t\tthis.themeService.getColorTheme(),\n\t\t\tchangeType,\n\t\t);\n\t\tthis.style({\n\t\t\tframeColor: changeTypeColor,\n\t\t\tarrowColor: changeTypeColor,\n\t\t});\n\n\t\tconst providerSpecificChanges: IChange[] = [];\n\t\tlet contextIndex = index;\n\t\tfor (const change of this.model.changes) {\n\t\t\tif (change.label === this.model.changes[this._index].label) {\n\t\t\t\tproviderSpecificChanges.push(change.change);\n\t\t\t\tif (labeledChange === change) {\n\t\t\t\t\tcontextIndex = providerSpecificChanges.length - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._actionbarWidget!.context = [\n\t\t\tdiffEditorModel.modified.uri,\n\t\t\tproviderSpecificChanges,\n\t\t\tcontextIndex,\n\t\t];\n\t\tif (usePosition) {\n\t\t\tthis.show(position, height);\n\t\t\tthis.editor.setPosition(position);\n\t\t\tthis.editor.focus();\n\t\t}\n\t}\n\n\tprivate renderTitle(label: string): void {\n\t\tconst providerChanges = this.model.mapChanges.get(label)!;\n\t\tconst providerIndex = providerChanges.indexOf(this._index);\n\n\t\tlet detail: string;\n\t\tif (this.shouldUseDropdown()) {\n\t\t\tdetail =\n\t\t\t\tthis.model.changes.length > 1\n\t\t\t\t\t? nls.localize(\n\t\t\t\t\t\t\t\"multiChanges\",\n\t\t\t\t\t\t\t\"{0} of {1} changes\",\n\t\t\t\t\t\t\tproviderIndex + 1,\n\t\t\t\t\t\t\tproviderChanges.length,\n\t\t\t\t\t\t)\n\t\t\t\t\t: nls.localize(\n\t\t\t\t\t\t\t\"multiChange\",\n\t\t\t\t\t\t\t\"{0} of {1} change\",\n\t\t\t\t\t\t\tproviderIndex + 1,\n\t\t\t\t\t\t\tproviderChanges.length,\n\t\t\t\t\t\t);\n\t\t\tthis.dropdownContainer!.style.display = \"inherit\";\n\t\t} else {\n\t\t\tdetail =\n\t\t\t\tthis.model.changes.length > 1\n\t\t\t\t\t? nls.localize(\n\t\t\t\t\t\t\t\"changes\",\n\t\t\t\t\t\t\t\"{0} - {1} of {2} changes\",\n\t\t\t\t\t\t\tlabel,\n\t\t\t\t\t\t\tproviderIndex + 1,\n\t\t\t\t\t\t\tproviderChanges.length,\n\t\t\t\t\t\t)\n\t\t\t\t\t: nls.localize(\n\t\t\t\t\t\t\t\"change\",\n\t\t\t\t\t\t\t\"{0} - {1} of {2} change\",\n\t\t\t\t\t\t\tlabel,\n\t\t\t\t\t\t\tproviderIndex + 1,\n\t\t\t\t\t\t\tproviderChanges.length,\n\t\t\t\t\t\t);\n\t\t\tthis.dropdownContainer!.style.display = \"none\";\n\t\t}\n\n\t\tthis.setTitle(this.title, detail);\n\t}\n\n\tprivate switchQuickDiff(event?: IQuickDiffSelectItem) {\n\t\tconst newProvider = event?.provider;\n\t\tif (newProvider === this.model.changes[this._index].label) {\n\t\t\treturn;\n\t\t}\n\t\tlet closestGreaterIndex =\n\t\t\tthis._index < this.model.changes.length - 1 ? this._index + 1 : 0;\n\t\tfor (\n\t\t\tlet i = closestGreaterIndex;\n\t\t\ti !== this._index;\n\t\t\ti < this.model.changes.length - 1 ? i++ : (i = 0)\n\t\t) {\n\t\t\tif (this.model.changes[i].label === newProvider) {\n\t\t\t\tclosestGreaterIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tlet closestLesserIndex =\n\t\t\tthis._index > 0 ? this._index - 1 : this.model.changes.length - 1;\n\t\tfor (\n\t\t\tlet i = closestLesserIndex;\n\t\t\ti !== this._index;\n\t\t\ti >= 0 ? i-- : (i = this.model.changes.length - 1)\n\t\t) {\n\t\t\tif (this.model.changes[i].label === newProvider) {\n\t\t\t\tclosestLesserIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst closestIndex =\n\t\t\tMath.abs(\n\t\t\t\tthis.model.changes[closestGreaterIndex].change\n\t\t\t\t\t.modifiedEndLineNumber -\n\t\t\t\t\tthis.model.changes[this._index].change\n\t\t\t\t\t\t.modifiedEndLineNumber,\n\t\t\t) <\n\t\t\tMath.abs(\n\t\t\t\tthis.model.changes[closestLesserIndex].change\n\t\t\t\t\t.modifiedEndLineNumber -\n\t\t\t\t\tthis.model.changes[this._index].change\n\t\t\t\t\t\t.modifiedEndLineNumber,\n\t\t\t)\n\t\t\t\t? closestGreaterIndex\n\t\t\t\t: closestLesserIndex;\n\t\tthis.showChange(closestIndex, false);\n\t}\n\n\tprivate shouldUseDropdown(): boolean {\n\t\tlet providersWithChangesCount = 0;\n\t\tif (this.model.mapChanges.size > 1) {\n\t\t\tconst keys = Array.from(this.model.mapChanges.keys());\n\t\t\tfor (\n\t\t\t\tlet i = 0;\n\t\t\t\ti < keys.length && providersWithChangesCount <= 1;\n\t\t\t\ti++\n\t\t\t) {\n\t\t\t\tif (this.model.mapChanges.get(keys[i])!.length > 0) {\n\t\t\t\t\tprovidersWithChangesCount++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn providersWithChangesCount >= 2;\n\t}\n\n\tprivate updateActions(): void {\n\t\tif (!this._actionbarWidget) {\n\t\t\treturn;\n\t\t}\n\t\tconst previous = this.instantiationService.createInstance(\n\t\t\tUIEditorAction,\n\t\t\tthis.editor,\n\t\t\tnew ShowPreviousChangeAction(this.editor),\n\t\t\tThemeIcon.asClassName(gotoPreviousLocation),\n\t\t);\n\t\tconst next = this.instantiationService.createInstance(\n\t\t\tUIEditorAction,\n\t\t\tthis.editor,\n\t\t\tnew ShowNextChangeAction(this.editor),\n\t\t\tThemeIcon.asClassName(gotoNextLocation),\n\t\t);\n\n\t\tthis._disposables.add(previous);\n\t\tthis._disposables.add(next);\n\n\t\tconst actions: IAction[] = [];\n\t\tif (this.menu) {\n\t\t\tthis.menu.dispose();\n\t\t}\n\t\tthis.menu = this.menuService.createMenu(\n\t\t\tMenuId.SCMChangeContext,\n\t\t\tthis.contextKeyService,\n\t\t);\n\t\tcreateAndFillInActionBarActions(\n\t\t\tthis.menu,\n\t\t\t{ shouldForwardArgs: true },\n\t\t\tactions,\n\t\t);\n\t\tthis._actionbarWidget.clear();\n\t\tthis._actionbarWidget.push(actions.reverse(), {\n\t\t\tlabel: false,\n\t\t\ticon: true,\n\t\t});\n\t\tthis._actionbarWidget.push([next, previous], {\n\t\t\tlabel: false,\n\t\t\ticon: true,\n\t\t});\n\t\tthis._actionbarWidget.push(\n\t\t\tnew Action(\n\t\t\t\t\"peekview.close\",\n\t\t\t\tnls.localize(\"label.close\", \"Close\"),\n\t\t\t\tThemeIcon.asClassName(Codicon.close),\n\t\t\t\ttrue,\n\t\t\t\t() => this.dispose(),\n\t\t\t),\n\t\t\t{ label: false, icon: true },\n\t\t);\n\t}\n\n\tprotected override _fillHead(container: HTMLElement): void {\n\t\tsuper._fillHead(container, true);\n\n\t\tthis.dropdownContainer = dom.prepend(\n\t\t\tthis._titleElement!,\n\t\t\tdom.$(\".dropdown\"),\n\t\t);\n\t\tthis.dropdown = this.instantiationService.createInstance(\n\t\t\tSwitchQuickDiffViewItem,\n\t\t\tnew SwitchQuickDiffBaseAction((event?: IQuickDiffSelectItem) =>\n\t\t\t\tthis.switchQuickDiff(event),\n\t\t\t),\n\t\t\tthis.model.quickDiffs.map((quickDiffer) => quickDiffer.label),\n\t\t\tthis.model.changes[this._index].label,\n\t\t);\n\t\tthis.dropdown.render(this.dropdownContainer);\n\t\tthis.updateActions();\n\t}\n\n\tprotected override _getActionBarOptions(): IActionBarOptions {\n\t\tconst actionRunner = new DiffActionRunner();\n\n\t\t// close widget on successful action\n\t\tactionRunner.onDidRun((e) => {\n\t\t\tif (!(e.action instanceof UIEditorAction) && !e.error) {\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\t...super._getActionBarOptions(),\n\t\t\tactionRunner,\n\t\t};\n\t}\n\n\tprotected _fillBody(container: HTMLElement): void {\n\t\tconst options: IDiffEditorOptions = {\n\t\t\tscrollBeyondLastLine: true,\n\t\t\tscrollbar: {\n\t\t\t\tverticalScrollbarSize: 14,\n\t\t\t\thorizontal: \"auto\",\n\t\t\t\tuseShadows: true,\n\t\t\t\tverticalHasArrows: false,\n\t\t\t\thorizontalHasArrows: false,\n\t\t\t},\n\t\t\toverviewRulerLanes: 2,\n\t\t\tfixedOverflowWidgets: true,\n\t\t\tminimap: { enabled: false },\n\t\t\trenderSideBySide: false,\n\t\t\treadOnly: false,\n\t\t\trenderIndicators: false,\n\t\t\tdiffAlgorithm: \"advanced\",\n\t\t\tignoreTrimWhitespace: false,\n\t\t\tstickyScroll: { enabled: false },\n\t\t};\n\n\t\tthis.diffEditor = this.instantiationService.createInstance(\n\t\t\tEmbeddedDiffEditorWidget,\n\t\t\tcontainer,\n\t\t\toptions,\n\t\t\t{},\n\t\t\tthis.editor,\n\t\t);\n\t\tthis._disposables.add(this.diffEditor);\n\t}\n\n\tprotected override _onWidth(width: number): void {\n\t\tif (typeof this.height === \"undefined\") {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.diffEditor.layout({ height: this.height, width });\n\t}\n\n\tprotected override _doLayoutBody(height: number, width: number): void {\n\t\tsuper._doLayoutBody(height, width);\n\t\tthis.diffEditor.layout({ height, width });\n\n\t\tif (typeof this.height === \"undefined\" && this.change) {\n\t\t\tthis.revealChange(this.change);\n\t\t}\n\n\t\tthis.height = height;\n\t}\n\n\tprivate revealChange(change: IChange): void {\n\t\tlet start: number, end: number;\n\n\t\tif (change.modifiedEndLineNumber === 0) {\n\t\t\t// deletion\n\t\t\tstart = change.modifiedStartLineNumber;\n\t\t\tend = change.modifiedStartLineNumber + 1;\n\t\t} else if (change.originalEndLineNumber > 0) {\n\t\t\t// modification\n\t\t\tstart = change.modifiedStartLineNumber - 1;\n\t\t\tend = change.modifiedEndLineNumber + 1;\n\t\t} else {\n\t\t\t// insertion\n\t\t\tstart = change.modifiedStartLineNumber;\n\t\t\tend = change.modifiedEndLineNumber;\n\t\t}\n\n\t\tthis.diffEditor.revealLinesInCenter(start, end, ScrollType.Immediate);\n\t}\n\n\tprivate _applyTheme(theme: IColorTheme) {\n\t\tconst borderColor = theme.getColor(peekViewBorder) || Color.transparent;\n\t\tthis.style({\n\t\t\tarrowColor: borderColor,\n\t\t\tframeColor: borderColor,\n\t\t\theaderBackgroundColor:\n\t\t\t\ttheme.getColor(peekViewTitleBackground) || Color.transparent,\n\t\t\tprimaryHeadingColor: theme.getColor(peekViewTitleForeground),\n\t\t\tsecondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground),\n\t\t});\n\t}\n\n\tprotected override revealRange(range: Range) {\n\t\tthis.editor.revealLineInCenterIfOutsideViewport(\n\t\t\trange.endLineNumber,\n\t\t\tScrollType.Smooth,\n\t\t);\n\t}\n\n\toverride hasFocus(): boolean {\n\t\treturn this.diffEditor.hasTextFocus();\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis.menu?.dispose();\n\t}\n}\n\nexport class ShowPreviousChangeAction extends EditorAction {\n\tconstructor(private readonly outerEditor?: ICodeEditor) {\n\t\tsuper({\n\t\t\tid: \"editor.action.dirtydiff.previous\",\n\t\t\tlabel: nls.localize(\"show previous change\", \"Show Previous Change\"),\n\t\t\talias: \"Show Previous Change\",\n\t\t\tprecondition: TextCompareEditorActiveContext.toNegated(),\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyMod.Shift | KeyMod.Alt | KeyCode.F3,\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor): void {\n\t\tconst outerEditor =\n\t\t\tthis.outerEditor ?? getOuterEditorFromDiffEditor(accessor);\n\n\t\tif (!outerEditor) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!controller.canNavigate()) {\n\t\t\treturn;\n\t\t}\n\n\t\tcontroller.previous();\n\t}\n}\nregisterEditorAction(ShowPreviousChangeAction);\n\nexport class ShowNextChangeAction extends EditorAction {\n\tconstructor(private readonly outerEditor?: ICodeEditor) {\n\t\tsuper({\n\t\t\tid: \"editor.action.dirtydiff.next\",\n\t\t\tlabel: nls.localize(\"show next change\", \"Show Next Change\"),\n\t\t\talias: \"Show Next Change\",\n\t\t\tprecondition: TextCompareEditorActiveContext.toNegated(),\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyMod.Alt | KeyCode.F3,\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor): void {\n\t\tconst outerEditor =\n\t\t\tthis.outerEditor ?? getOuterEditorFromDiffEditor(accessor);\n\n\t\tif (!outerEditor) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!controller.canNavigate()) {\n\t\t\treturn;\n\t\t}\n\n\t\tcontroller.next();\n\t}\n}\nregisterEditorAction(ShowNextChangeAction);\n\n// Go to menu\nMenuRegistry.appendMenuItem(MenuId.MenubarGoMenu, {\n\tgroup: \"7_change_nav\",\n\tcommand: {\n\t\tid: \"editor.action.dirtydiff.next\",\n\t\ttitle: nls.localize(\n\t\t\t{ key: \"miGotoNextChange\", comment: [\"&& denotes a mnemonic\"] },\n\t\t\t\"Next &&Change\",\n\t\t),\n\t},\n\torder: 1,\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarGoMenu, {\n\tgroup: \"7_change_nav\",\n\tcommand: {\n\t\tid: \"editor.action.dirtydiff.previous\",\n\t\ttitle: nls.localize(\n\t\t\t{ key: \"miGotoPreviousChange\", comment: [\"&& denotes a mnemonic\"] },\n\t\t\t\"Previous &&Change\",\n\t\t),\n\t},\n\torder: 2,\n});\n\nexport class GotoPreviousChangeAction extends EditorAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"workbench.action.editor.previousChange\",\n\t\t\tlabel: nls.localize(\n\t\t\t\t\"move to previous change\",\n\t\t\t\t\"Go to Previous Change\",\n\t\t\t),\n\t\t\talias: \"Go to Previous Change\",\n\t\t\tprecondition: TextCompareEditorActiveContext.toNegated(),\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyMod.Shift | KeyMod.Alt | KeyCode.F5,\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor): Promise<void> {\n\t\tconst outerEditor = getOuterEditorFromDiffEditor(accessor);\n\t\tconst accessibilitySignalService = accessor.get(\n\t\t\tIAccessibilitySignalService,\n\t\t);\n\t\tconst accessibilityService = accessor.get(IAccessibilityService);\n\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\n\t\tif (!outerEditor || !outerEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller || !controller.modelRegistry) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lineNumber = outerEditor.getPosition().lineNumber;\n\t\tconst model = controller.modelRegistry.getModel(\n\t\t\touterEditor.getModel(),\n\t\t\touterEditor,\n\t\t);\n\t\tif (!model || model.changes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst index = model.findPreviousClosestChange(lineNumber, false);\n\t\tconst change = model.changes[index];\n\t\tawait playAccessibilitySymbolForChange(\n\t\t\tchange.change,\n\t\t\taccessibilitySignalService,\n\t\t);\n\t\tsetPositionAndSelection(\n\t\t\tchange.change,\n\t\t\touterEditor,\n\t\t\taccessibilityService,\n\t\t\tcodeEditorService,\n\t\t);\n\t}\n}\nregisterEditorAction(GotoPreviousChangeAction);\n\nexport class GotoNextChangeAction extends EditorAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: \"workbench.action.editor.nextChange\",\n\t\t\tlabel: nls.localize(\"move to next change\", \"Go to Next Change\"),\n\t\t\talias: \"Go to Next Change\",\n\t\t\tprecondition: TextCompareEditorActiveContext.toNegated(),\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyMod.Alt | KeyCode.F5,\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor): Promise<void> {\n\t\tconst accessibilitySignalService = accessor.get(\n\t\t\tIAccessibilitySignalService,\n\t\t);\n\t\tconst outerEditor = getOuterEditorFromDiffEditor(accessor);\n\t\tconst accessibilityService = accessor.get(IAccessibilityService);\n\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\n\t\tif (!outerEditor || !outerEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller || !controller.modelRegistry) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lineNumber = outerEditor.getPosition().lineNumber;\n\t\tconst model = controller.modelRegistry.getModel(\n\t\t\touterEditor.getModel(),\n\t\t\touterEditor,\n\t\t);\n\n\t\tif (!model || model.changes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst index = model.findNextClosestChange(lineNumber, false);\n\t\tconst change = model.changes[index].change;\n\t\tawait playAccessibilitySymbolForChange(\n\t\t\tchange,\n\t\t\taccessibilitySignalService,\n\t\t);\n\t\tsetPositionAndSelection(\n\t\t\tchange,\n\t\t\touterEditor,\n\t\t\taccessibilityService,\n\t\t\tcodeEditorService,\n\t\t);\n\t}\n}\n\nfunction setPositionAndSelection(\n\tchange: IChange,\n\teditor: ICodeEditor,\n\taccessibilityService: IAccessibilityService,\n\tcodeEditorService: ICodeEditorService,\n) {\n\tconst position = new Position(change.modifiedStartLineNumber, 1);\n\teditor.setPosition(position);\n\teditor.revealPositionInCenter(position);\n\tif (accessibilityService.isScreenReaderOptimized()) {\n\t\teditor.setSelection({\n\t\t\tstartLineNumber: change.modifiedStartLineNumber,\n\t\t\tstartColumn: 0,\n\t\t\tendLineNumber: change.modifiedStartLineNumber,\n\t\t\tendColumn: Number.MAX_VALUE,\n\t\t});\n\t\tcodeEditorService\n\t\t\t.getActiveCodeEditor()\n\t\t\t?.writeScreenReaderContent(\"diff-navigation\");\n\t}\n}\n\nasync function playAccessibilitySymbolForChange(\n\tchange: IChange,\n\taccessibilitySignalService: IAccessibilitySignalService,\n) {\n\tconst changeType = getChangeType(change);\n\tswitch (changeType) {\n\t\tcase ChangeType.Add:\n\t\t\taccessibilitySignalService.playSignal(\n\t\t\t\tAccessibilitySignal.diffLineInserted,\n\t\t\t\t{ allowManyInParallel: true, source: \"dirtyDiffDecoration\" },\n\t\t\t);\n\t\t\tbreak;\n\t\tcase ChangeType.Delete:\n\t\t\taccessibilitySignalService.playSignal(\n\t\t\t\tAccessibilitySignal.diffLineDeleted,\n\t\t\t\t{ allowManyInParallel: true, source: \"dirtyDiffDecoration\" },\n\t\t\t);\n\t\t\tbreak;\n\t\tcase ChangeType.Modify:\n\t\t\taccessibilitySignalService.playSignal(\n\t\t\t\tAccessibilitySignal.diffLineModified,\n\t\t\t\t{ allowManyInParallel: true, source: \"dirtyDiffDecoration\" },\n\t\t\t);\n\t\t\tbreak;\n\t}\n}\n\nregisterEditorAction(GotoNextChangeAction);\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: \"closeDirtyDiff\",\n\tweight: KeybindingWeight.EditorContrib + 50,\n\tprimary: KeyCode.Escape,\n\tsecondary: [KeyMod.Shift | KeyCode.Escape],\n\twhen: ContextKeyExpr.and(isDirtyDiffVisible),\n\thandler: (accessor: ServicesAccessor) => {\n\t\tconst outerEditor = getOuterEditorFromDiffEditor(accessor);\n\n\t\tif (!outerEditor) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller) {\n\t\t\treturn;\n\t\t}\n\n\t\tcontroller.close();\n\t},\n});\n\nexport class DirtyDiffController\n\textends Disposable\n\timplements DirtyDiffContribution\n{\n\tpublic static readonly ID = \"editor.contrib.dirtydiff\";\n\n\tstatic get(editor: ICodeEditor): DirtyDiffController | null {\n\t\treturn editor.getContribution<DirtyDiffController>(\n\t\t\tDirtyDiffController.ID,\n\t\t);\n\t}\n\n\tmodelRegistry: IModelRegistry | null = null;\n\n\tprivate model: DirtyDiffModel | null = null;\n\tprivate widget: DirtyDiffWidget | null = null;\n\tprivate readonly isDirtyDiffVisible!: IContextKey<boolean>;\n\tprivate session: IDisposable = Disposable.None;\n\tprivate mouseDownInfo: { lineNumber: number } | null = null;\n\tprivate enabled = false;\n\tprivate readonly gutterActionDisposables = new DisposableStore();\n\tprivate stylesheet: HTMLStyleElement;\n\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t\tthis.enabled = !contextKeyService.getContextKeyValue('isInDiffEditor');\n\t\tthis.stylesheet = dom.createStyleSheet(undefined, undefined, this._store);\n\n\t\tif (this.enabled) {\n\t\t\tthis.isDirtyDiffVisible = isDirtyDiffVisible.bindTo(contextKeyService);\n\t\t\tthis._register(editor.onDidChangeModel(() => this.close()));\n\n\t\t\tconst onDidChangeGutterAction = Event.filter(configurationService.onDidChangeConfiguration, e => e.affectsConfiguration('scm.diffDecorationsGutterAction'));\n\t\t\tthis._register(onDidChangeGutterAction(this.onDidChangeGutterAction, this));\n\t\t\tthis.onDidChangeGutterAction();\n\t\t}\n\t}\n\n\tprivate onDidChangeGutterAction(): void {\n\t\tconst gutterAction = this.configurationService.getValue<\n\t\t\t\"diff\" | \"none\"\n\t\t>(\"scm.diffDecorationsGutterAction\");\n\n\t\tthis.gutterActionDisposables.clear();\n\n\t\tif (gutterAction === \"diff\") {\n\t\t\tthis.gutterActionDisposables.add(\n\t\t\t\tthis.editor.onMouseDown((e) => this.onEditorMouseDown(e)),\n\t\t\t);\n\t\t\tthis.gutterActionDisposables.add(\n\t\t\t\tthis.editor.onMouseUp((e) => this.onEditorMouseUp(e)),\n\t\t\t);\n\t\t\tthis.stylesheet.textContent = `\n\t\t\t\t.monaco-editor .dirty-diff-glyph {\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t}\n\n\t\t\t\t.monaco-editor .margin-view-overlays .dirty-diff-glyph:hover::before {\n\t\t\t\t\theight: 100%;\n\t\t\t\t\twidth: 6px;\n\t\t\t\t\tleft: -6px;\n\t\t\t\t}\n\n\t\t\t\t.monaco-editor .margin-view-overlays .dirty-diff-deleted:hover::after {\n\t\t\t\t\tbottom: 0;\n\t\t\t\t\tborder-top-width: 0;\n\t\t\t\t\tborder-bottom-width: 0;\n\t\t\t\t}\n\t\t\t`;\n\t\t} else {\n\t\t\tthis.stylesheet.textContent = ``;\n\t\t}\n\t}\n\n\tcanNavigate(): boolean {\n\t\treturn (\n\t\t\t!this.widget ||\n\t\t\tthis.widget?.index === -1 ||\n\t\t\t(!!this.model && this.model.changes.length > 1)\n\t\t);\n\t}\n\n\trefresh(): void {\n\t\tthis.widget?.showChange(this.widget.index, false);\n\t}\n\n\tnext(lineNumber?: number): void {\n\t\tif (!this.assertWidget()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.widget || !this.model) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet index: number;\n\t\tif (\n\t\t\tthis.editor.hasModel() &&\n\t\t\t(typeof lineNumber === \"number\" || !this.widget.provider)\n\t\t) {\n\t\t\tindex = this.model.findNextClosestChange(\n\t\t\t\ttypeof lineNumber === \"number\"\n\t\t\t\t\t? lineNumber\n\t\t\t\t\t: this.editor.getPosition().lineNumber,\n\t\t\t\ttrue,\n\t\t\t\tthis.widget.provider,\n\t\t\t);\n\t\t} else {\n\t\t\tconst providerChanges: number[] =\n\t\t\t\tthis.model.mapChanges.get(this.widget.provider) ??\n\t\t\t\tthis.model.mapChanges.values().next().value!;\n\t\t\tconst mapIndex = providerChanges.findIndex(\n\t\t\t\t(value) => value === this.widget!.index,\n\t\t\t);\n\t\t\tindex = providerChanges[rot(mapIndex + 1, providerChanges.length)];\n\t\t}\n\n\t\tthis.widget.showChange(index);\n\t}\n\n\tprevious(lineNumber?: number): void {\n\t\tif (!this.assertWidget()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.widget || !this.model) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet index: number;\n\t\tif (this.editor.hasModel() && typeof lineNumber === \"number\") {\n\t\t\tindex = this.model.findPreviousClosestChange(\n\t\t\t\ttypeof lineNumber === \"number\"\n\t\t\t\t\t? lineNumber\n\t\t\t\t\t: this.editor.getPosition().lineNumber,\n\t\t\t\ttrue,\n\t\t\t\tthis.widget.provider,\n\t\t\t);\n\t\t} else {\n\t\t\tconst providerChanges: number[] =\n\t\t\t\tthis.model.mapChanges.get(this.widget.provider) ??\n\t\t\t\tthis.model.mapChanges.values().next().value!;\n\t\t\tconst mapIndex = providerChanges.findIndex(\n\t\t\t\t(value) => value === this.widget!.index,\n\t\t\t);\n\t\t\tindex = providerChanges[rot(mapIndex - 1, providerChanges.length)];\n\t\t}\n\n\t\tthis.widget.showChange(index);\n\t}\n\n\tclose(): void {\n\t\tthis.session.dispose();\n\t\tthis.session = Disposable.None;\n\t}\n\n\tprivate assertWidget(): boolean {\n\t\tif (!this.enabled) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.widget) {\n\t\t\tif (!this.model || this.model.changes.length === 0) {\n\t\t\t\tthis.close();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!this.modelRegistry) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst editorModel = this.editor.getModel();\n\n\t\tif (!editorModel) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst model = this.modelRegistry.getModel(editorModel, this.editor);\n\n\t\tif (!model) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (model.changes.length === 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.model = model;\n\t\tthis.widget = this.instantiationService.createInstance(\n\t\t\tDirtyDiffWidget,\n\t\t\tthis.editor,\n\t\t\tmodel,\n\t\t);\n\t\tthis.isDirtyDiffVisible.set(true);\n\n\t\tconst disposables = new DisposableStore();\n\t\tdisposables.add(Event.once(this.widget.onDidClose)(this.close, this));\n\t\tconst onDidModelChange = Event.chain(model.onDidChange, ($) =>\n\t\t\t$.filter((e) => e.diff.length > 0).map((e) => e.diff),\n\t\t);\n\n\t\tonDidModelChange(this.onDidModelChange, this, disposables);\n\n\t\tdisposables.add(this.widget);\n\t\tdisposables.add(\n\t\t\ttoDisposable(() => {\n\t\t\t\tthis.model = null;\n\t\t\t\tthis.widget = null;\n\t\t\t\tthis.isDirtyDiffVisible.set(false);\n\t\t\t\tthis.editor.focus();\n\t\t\t}),\n\t\t);\n\n\t\tthis.session = disposables;\n\t\treturn true;\n\t}\n\n\tprivate onDidModelChange(splices: ISplice<LabeledChange>[]): void {\n\t\tif (!this.model || !this.widget || this.widget.hasFocus()) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const splice of splices) {\n\t\t\tif (splice.start <= this.widget.index) {\n\t\t\t\tthis.next();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.refresh();\n\t}\n\n\tprivate onEditorMouseDown(e: IEditorMouseEvent): void {\n\t\tthis.mouseDownInfo = null;\n\n\t\tconst range = e.target.range;\n\n\t\tif (!range) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!e.event.leftButton) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\t\treturn;\n\t\t}\n\t\tif (!e.target.element) {\n\t\t\treturn;\n\t\t}\n\t\tif (e.target.element.className.indexOf(\"dirty-diff-glyph\") < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = e.target.detail;\n\t\tconst offsetLeftInGutter = e.target.element.offsetLeft;\n\t\tconst gutterOffsetX = data.offsetX - offsetLeftInGutter;\n\n\t\t// TODO@joao TODO@alex TODO@martin this is such that we don't collide with folding\n\t\tif (gutterOffsetX < -3 || gutterOffsetX > 3) {\n\t\t\t// dirty diff decoration on hover is 6px wide\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mouseDownInfo = { lineNumber: range.startLineNumber };\n\t}\n\n\tprivate onEditorMouseUp(e: IEditorMouseEvent): void {\n\t\tif (!this.mouseDownInfo) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { lineNumber } = this.mouseDownInfo;\n\t\tthis.mouseDownInfo = null;\n\n\t\tconst range = e.target.range;\n\n\t\tif (!range || range.startLineNumber !== lineNumber) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.modelRegistry) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editorModel = this.editor.getModel();\n\n\t\tif (!editorModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst model = this.modelRegistry.getModel(editorModel, this.editor);\n\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst index = model.changes.findIndex((change) =>\n\t\t\tlineIntersectsChange(lineNumber, change.change),\n\t\t);\n\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (index === this.widget?.index) {\n\t\t\tthis.close();\n\t\t} else {\n\t\t\tthis.next(lineNumber);\n\t\t}\n\t}\n\n\tgetChanges(): IChange[] {\n\t\tif (!this.modelRegistry) {\n\t\t\treturn [];\n\t\t}\n\t\tif (!this.editor.hasModel()) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst model = this.modelRegistry.getModel(\n\t\t\tthis.editor.getModel(),\n\t\t\tthis.editor,\n\t\t);\n\n\t\tif (!model) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn model.changes.map((change) => change.change);\n\t}\n\n\toverride dispose(): void {\n\t\tthis.gutterActionDisposables.dispose();\n\t\tsuper.dispose();\n\t}\n}\n\nconst editorGutterModifiedBackground = registerColor(\n\t\"editorGutter.modifiedBackground\",\n\t{\n\t\tdark: \"#1B81A8\",\n\t\tlight: \"#2090D3\",\n\t\thcDark: \"#1B81A8\",\n\t\thcLight: \"#2090D3\",\n\t},\n\tnls.localize(\n\t\t\"editorGutterModifiedBackground\",\n\t\t\"Editor gutter background color for lines that are modified.\",\n\t),\n);\n\nconst editorGutterAddedBackground = registerColor(\n\t\"editorGutter.addedBackground\",\n\t{\n\t\tdark: \"#487E02\",\n\t\tlight: \"#48985D\",\n\t\thcDark: \"#487E02\",\n\t\thcLight: \"#48985D\",\n\t},\n\tnls.localize(\n\t\t\"editorGutterAddedBackground\",\n\t\t\"Editor gutter background color for lines that are added.\",\n\t),\n);\n\nconst editorGutterDeletedBackground = registerColor(\n\t\"editorGutter.deletedBackground\",\n\teditorErrorForeground,\n\tnls.localize(\n\t\t\"editorGutterDeletedBackground\",\n\t\t\"Editor gutter background color for lines that are deleted.\",\n\t),\n);\n\nconst minimapGutterModifiedBackground = registerColor(\n\t\"minimapGutter.modifiedBackground\",\n\teditorGutterModifiedBackground,\n\tnls.localize(\n\t\t\"minimapGutterModifiedBackground\",\n\t\t\"Minimap gutter background color for lines that are modified.\",\n\t),\n);\n\nconst minimapGutterAddedBackground = registerColor(\n\t\"minimapGutter.addedBackground\",\n\teditorGutterAddedBackground,\n\tnls.localize(\n\t\t\"minimapGutterAddedBackground\",\n\t\t\"Minimap gutter background color for lines that are added.\",\n\t),\n);\n\nconst minimapGutterDeletedBackground = registerColor(\n\t\"minimapGutter.deletedBackground\",\n\teditorGutterDeletedBackground,\n\tnls.localize(\n\t\t\"minimapGutterDeletedBackground\",\n\t\t\"Minimap gutter background color for lines that are deleted.\",\n\t),\n);\n\nconst overviewRulerModifiedForeground = registerColor(\n\t\"editorOverviewRuler.modifiedForeground\",\n\ttransparent(editorGutterModifiedBackground, 0.6),\n\tnls.localize(\n\t\t\"overviewRulerModifiedForeground\",\n\t\t\"Overview ruler marker color for modified content.\",\n\t),\n);\nconst overviewRulerAddedForeground = registerColor(\n\t\"editorOverviewRuler.addedForeground\",\n\ttransparent(editorGutterAddedBackground, 0.6),\n\tnls.localize(\n\t\t\"overviewRulerAddedForeground\",\n\t\t\"Overview ruler marker color for added content.\",\n\t),\n);\nconst overviewRulerDeletedForeground = registerColor(\n\t\"editorOverviewRuler.deletedForeground\",\n\ttransparent(editorGutterDeletedBackground, 0.6),\n\tnls.localize(\n\t\t\"overviewRulerDeletedForeground\",\n\t\t\"Overview ruler marker color for deleted content.\",\n\t),\n);\n\nclass DirtyDiffDecorator extends Disposable {\n\tstatic createDecoration(\n\t\tclassName: string,\n\t\ttooltip: string | null,\n\t\toptions: {\n\t\t\tgutter: boolean;\n\t\t\toverview: { active: boolean; color: string };\n\t\t\tminimap: { active: boolean; color: string };\n\t\t\tisWholeLine: boolean;\n\t\t},\n\t): ModelDecorationOptions {\n\t\tconst decorationOptions: IModelDecorationOptions = {\n\t\t\tdescription: \"dirty-diff-decoration\",\n\t\t\tisWholeLine: options.isWholeLine,\n\t\t};\n\n\t\tif (options.gutter) {\n\t\t\tdecorationOptions.linesDecorationsClassName = `dirty-diff-glyph ${className}`;\n\t\t\tdecorationOptions.linesDecorationsTooltip = tooltip;\n\t\t}\n\n\t\tif (options.overview.active) {\n\t\t\tdecorationOptions.overviewRuler = {\n\t\t\t\tcolor: themeColorFromId(options.overview.color),\n\t\t\t\tposition: OverviewRulerLane.Left,\n\t\t\t};\n\t\t}\n\n\t\tif (options.minimap.active) {\n\t\t\tdecorationOptions.minimap = {\n\t\t\t\tcolor: themeColorFromId(options.minimap.color),\n\t\t\t\tposition: MinimapPosition.Gutter,\n\t\t\t};\n\t\t}\n\n\t\treturn ModelDecorationOptions.createDynamic(decorationOptions);\n\t}\n\n\tprivate addedOptions: ModelDecorationOptions;\n\tprivate addedPatternOptions: ModelDecorationOptions;\n\tprivate modifiedOptions: ModelDecorationOptions;\n\tprivate modifiedPatternOptions: ModelDecorationOptions;\n\tprivate deletedOptions: ModelDecorationOptions;\n\tprivate decorationsCollection: IEditorDecorationsCollection | undefined;\n\tprivate editorModel: ITextModel | null;\n\n\tconstructor(\n\t\teditorModel: ITextModel,\n\t\tprivate readonly codeEditor: ICodeEditor,\n\t\tprivate model: DirtyDiffModel,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\t\tthis.editorModel = editorModel;\n\n\t\tconst decorations = configurationService.getValue<string>('scm.diffDecorations');\n\t\tconst gutter = decorations === 'all' || decorations === 'gutter';\n\t\tconst overview = decorations === 'all' || decorations === 'overview';\n\t\tconst minimap = decorations === 'all' || decorations === 'minimap';\n\n\t\tconst diffAdded = nls.localize('diffAdded', 'Added lines');\n\t\tthis.addedOptions = DirtyDiffDecorator.createDecoration('dirty-diff-added', diffAdded, {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerAddedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterAddedBackground },\n\t\t\tisWholeLine: true\n\t\t});\n\t\tthis.addedPatternOptions = DirtyDiffDecorator.createDecoration('dirty-diff-added-pattern', diffAdded, {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerAddedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterAddedBackground },\n\t\t\tisWholeLine: true\n\t\t});\n\t\tconst diffModified = nls.localize('diffModified', 'Changed lines');\n\t\tthis.modifiedOptions = DirtyDiffDecorator.createDecoration('dirty-diff-modified', diffModified, {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerModifiedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterModifiedBackground },\n\t\t\tisWholeLine: true\n\t\t});\n\t\tthis.modifiedPatternOptions = DirtyDiffDecorator.createDecoration('dirty-diff-modified-pattern', diffModified, {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerModifiedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterModifiedBackground },\n\t\t\tisWholeLine: true\n\t\t});\n\t\tthis.deletedOptions = DirtyDiffDecorator.createDecoration('dirty-diff-deleted', nls.localize('diffDeleted', 'Removed lines'), {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerDeletedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterDeletedBackground },\n\t\t\tisWholeLine: false\n\t\t});\n\n\t\tthis._register(configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('scm.diffDecorationsGutterPattern')) {\n\t\t\t\tthis.onDidChange();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(model.onDidChange(this.onDidChange, this));\n\t}\n\n\tprivate onDidChange(): void {\n\t\tif (!this.editorModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst pattern = this.configurationService.getValue<{\n\t\t\tadded: boolean;\n\t\t\tmodified: boolean;\n\t\t}>(\"scm.diffDecorationsGutterPattern\");\n\t\tconst decorations = this.model.changes.map((labeledChange) => {\n\t\t\tconst change = labeledChange.change;\n\t\t\tconst changeType = getChangeType(change);\n\t\t\tconst startLineNumber = change.modifiedStartLineNumber;\n\t\t\tconst endLineNumber =\n\t\t\t\tchange.modifiedEndLineNumber || startLineNumber;\n\n\t\t\tswitch (changeType) {\n\t\t\t\tcase ChangeType.Add:\n\t\t\t\t\treturn {\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tstartLineNumber: startLineNumber,\n\t\t\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\t\t\tendLineNumber: endLineNumber,\n\t\t\t\t\t\t\tendColumn: 1,\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions: pattern.added\n\t\t\t\t\t\t\t? this.addedPatternOptions\n\t\t\t\t\t\t\t: this.addedOptions,\n\t\t\t\t\t};\n\t\t\t\tcase ChangeType.Delete:\n\t\t\t\t\treturn {\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tstartLineNumber: startLineNumber,\n\t\t\t\t\t\t\tstartColumn: Number.MAX_VALUE,\n\t\t\t\t\t\t\tendLineNumber: startLineNumber,\n\t\t\t\t\t\t\tendColumn: Number.MAX_VALUE,\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions: this.deletedOptions,\n\t\t\t\t\t};\n\t\t\t\tcase ChangeType.Modify:\n\t\t\t\t\treturn {\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tstartLineNumber: startLineNumber,\n\t\t\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\t\t\tendLineNumber: endLineNumber,\n\t\t\t\t\t\t\tendColumn: 1,\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions: pattern.modified\n\t\t\t\t\t\t\t? this.modifiedPatternOptions\n\t\t\t\t\t\t\t: this.modifiedOptions,\n\t\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tif (this.decorationsCollection) {\n\t\t\tthis.decorationsCollection.set(decorations);\n\t\t} else {\n\t\t\tthis.decorationsCollection =\n\t\t\t\tthis.codeEditor.createDecorationsCollection(decorations);\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tif (this.decorationsCollection) {\n\t\t\tthis.decorationsCollection?.clear();\n\t\t}\n\n\t\tthis.editorModel = null;\n\t\tthis.decorationsCollection = undefined;\n\t}\n}\n\nfunction compareChanges(a: IChange, b: IChange): number {\n\tlet result = a.modifiedStartLineNumber - b.modifiedStartLineNumber;\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tresult = a.modifiedEndLineNumber - b.modifiedEndLineNumber;\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tresult = a.originalStartLineNumber - b.originalStartLineNumber;\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\treturn a.originalEndLineNumber - b.originalEndLineNumber;\n}\n\nexport async function getOriginalResource(\n\tquickDiffService: IQuickDiffService,\n\turi: URI,\n\tlanguage: string | undefined,\n\tisSynchronized: boolean | undefined,\n): Promise<URI | null> {\n\tconst quickDiffs = await quickDiffService.getQuickDiffs(\n\t\turi,\n\t\tlanguage,\n\t\tisSynchronized,\n\t);\n\treturn quickDiffs.length > 0 ? quickDiffs[0].originalResource : null;\n}\n\ntype LabeledChange = { change: IChange; label: string; uri: URI };\n\nexport class DirtyDiffModel extends Disposable {\n\tprivate _quickDiffs: QuickDiff[] = [];\n\tprivate _originalModels: Map<string, IResolvedTextEditorModel> = new Map(); // key is uri.toString()\n\tprivate _originalTextModels: ITextModel[] = [];\n\tprivate _model: ITextFileEditorModel;\n\tget original(): ITextModel[] {\n\t\treturn this._originalTextModels;\n\t}\n\n\tprivate diffDelayer = new ThrottledDelayer<{\n\t\tchanges: LabeledChange[];\n\t\tmapChanges: Map<string, number[]>;\n\t} | null>(200);\n\tprivate _quickDiffsPromise?: Promise<QuickDiff[]>;\n\tprivate repositoryDisposables = new Set<IDisposable>();\n\tprivate readonly originalModelDisposables = this._register(\n\t\tnew DisposableStore(),\n\t);\n\tprivate _disposed = false;\n\n\tprivate readonly _onDidChange = new Emitter<{\n\t\tchanges: LabeledChange[];\n\t\tdiff: ISplice<LabeledChange>[];\n\t}>();\n\treadonly onDidChange: Event<{\n\t\tchanges: LabeledChange[];\n\t\tdiff: ISplice<LabeledChange>[];\n\t}> = this._onDidChange.event;\n\n\tprivate _changes: LabeledChange[] = [];\n\tget changes(): LabeledChange[] {\n\t\treturn this._changes;\n\t}\n\tprivate _mapChanges: Map<string, number[]> = new Map(); // key is the quick diff name, value is the index of the change in this._changes\n\tget mapChanges(): Map<string, number[]> {\n\t\treturn this._mapChanges;\n\t}\n\n\tconstructor(\n\t\ttextFileModel: IResolvedTextFileEditorModel,\n\t\t@ISCMService private readonly scmService: ISCMService,\n\t\t@IQuickDiffService private readonly quickDiffService: IQuickDiffService,\n\t\t@IEditorWorkerService private readonly editorWorkerService: IEditorWorkerService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITextModelService private readonly textModelResolverService: ITextModelService,\n\t\t@IProgressService private readonly progressService: IProgressService,\n\t) {\n\t\tsuper();\n\t\tthis._model = textFileModel;\n\n\t\tthis._register(textFileModel.textEditorModel.onDidChangeContent(() => this.triggerDiff()));\n\t\tthis._register(\n\t\t\tEvent.filter(configurationService.onDidChangeConfiguration,\n\t\t\t\te => e.affectsConfiguration('scm.diffDecorationsIgnoreTrimWhitespace') || e.affectsConfiguration('diffEditor.ignoreTrimWhitespace')\n\t\t\t)(this.triggerDiff, this)\n\t\t);\n\t\tthis._register(scmService.onDidAddRepository(this.onDidAddRepository, this));\n\t\tfor (const r of scmService.repositories) {\n\t\t\tthis.onDidAddRepository(r);\n\t\t}\n\n\t\tthis._register(this._model.onDidChangeEncoding(() => {\n\t\t\tthis.diffDelayer.cancel();\n\t\t\tthis._quickDiffs = [];\n\t\t\tthis._originalModels.clear();\n\t\t\tthis._originalTextModels = [];\n\t\t\tthis._quickDiffsPromise = undefined;\n\t\t\tthis.setChanges([], new Map());\n\t\t\tthis.triggerDiff();\n\t\t}));\n\n\t\tthis._register(this.quickDiffService.onDidChangeQuickDiffProviders(() => this.triggerDiff()));\n\t\tthis.triggerDiff();\n\t}\n\n\tget quickDiffs(): readonly QuickDiff[] {\n\t\treturn this._quickDiffs;\n\t}\n\n\tpublic getDiffEditorModel(\n\t\toriginalUri: string,\n\t): IDiffEditorModel | undefined {\n\t\tif (!this._originalModels.has(originalUri)) {\n\t\t\treturn;\n\t\t}\n\t\tconst original = this._originalModels.get(originalUri)!;\n\n\t\treturn {\n\t\t\tmodified: this._model.textEditorModel!,\n\t\t\toriginal: original.textEditorModel,\n\t\t};\n\t}\n\n\tprivate onDidAddRepository(repository: ISCMRepository): void {\n\t\tconst disposables = new DisposableStore();\n\n\t\tthis.repositoryDisposables.add(disposables);\n\t\tdisposables.add(\n\t\t\ttoDisposable(() => this.repositoryDisposables.delete(disposables)),\n\t\t);\n\n\t\tconst onDidChange = Event.any(\n\t\t\trepository.provider.onDidChange,\n\t\t\trepository.provider.onDidChangeResources,\n\t\t);\n\t\tdisposables.add(onDidChange(this.triggerDiff, this));\n\n\t\tconst onDidRemoveThis = Event.filter(\n\t\t\tthis.scmService.onDidRemoveRepository,\n\t\t\t(r) => r === repository,\n\t\t);\n\t\tdisposables.add(onDidRemoveThis(() => dispose(disposables), null));\n\n\t\tthis.triggerDiff();\n\t}\n\n\tprivate triggerDiff(): Promise<any> {\n\t\tif (!this.diffDelayer) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn this.diffDelayer\n\t\t\t.trigger(() => this.diff())\n\t\t\t.then(\n\t\t\t\t(\n\t\t\t\t\tresult: {\n\t\t\t\t\t\tchanges: LabeledChange[];\n\t\t\t\t\t\tmapChanges: Map<string, number[]>;\n\t\t\t\t\t} | null,\n\t\t\t\t) => {\n\t\t\t\t\tconst originalModels = Array.from(\n\t\t\t\t\t\tthis._originalModels.values(),\n\t\t\t\t\t);\n\t\t\t\t\tif (\n\t\t\t\t\t\t!result ||\n\t\t\t\t\t\tthis._disposed ||\n\t\t\t\t\t\tthis._model.isDisposed() ||\n\t\t\t\t\t\toriginalModels.some((originalModel) =>\n\t\t\t\t\t\t\toriginalModel.isDisposed(),\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn; // disposed\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\toriginalModels.every(\n\t\t\t\t\t\t\t(originalModel) =>\n\t\t\t\t\t\t\t\toriginalModel.textEditorModel.getValueLength() ===\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tresult.changes = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!result.changes) {\n\t\t\t\t\t\tresult.changes = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setChanges(result.changes, result.mapChanges);\n\t\t\t\t},\n\t\t\t\t(err) => onUnexpectedError(err),\n\t\t\t);\n\t}\n\n\tprivate setChanges(\n\t\tchanges: LabeledChange[],\n\t\tmapChanges: Map<string, number[]>,\n\t): void {\n\t\tconst diff = sortedDiff(this._changes, changes, (a, b) =>\n\t\t\tcompareChanges(a.change, b.change),\n\t\t);\n\t\tthis._changes = changes;\n\t\tthis._mapChanges = mapChanges;\n\t\tthis._onDidChange.fire({ changes, diff });\n\t}\n\n\tprivate diff(): Promise<{\n\t\tchanges: LabeledChange[];\n\t\tmapChanges: Map<string, number[]>;\n\t} | null> {\n\t\treturn this.progressService.withProgress(\n\t\t\t{ location: ProgressLocation.Scm, delay: 250 },\n\t\t\tasync () => {\n\t\t\t\tconst originalURIs = await this.getQuickDiffsPromise();\n\t\t\t\tif (\n\t\t\t\t\tthis._disposed ||\n\t\t\t\t\tthis._model.isDisposed() ||\n\t\t\t\t\toriginalURIs.length === 0\n\t\t\t\t) {\n\t\t\t\t\treturn Promise.resolve({\n\t\t\t\t\t\tchanges: [],\n\t\t\t\t\t\tmapChanges: new Map(),\n\t\t\t\t\t}); // disposed\n\t\t\t\t}\n\n\t\t\t\tconst filteredToDiffable = originalURIs.filter((quickDiff) =>\n\t\t\t\t\tthis.editorWorkerService.canComputeDirtyDiff(\n\t\t\t\t\t\tquickDiff.originalResource,\n\t\t\t\t\t\tthis._model.resource,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tif (filteredToDiffable.length === 0) {\n\t\t\t\t\treturn Promise.resolve({\n\t\t\t\t\t\tchanges: [],\n\t\t\t\t\t\tmapChanges: new Map(),\n\t\t\t\t\t}); // All files are too large\n\t\t\t\t}\n\n\t\t\t\tconst ignoreTrimWhitespaceSetting =\n\t\t\t\t\tthis.configurationService.getValue<\n\t\t\t\t\t\t\"true\" | \"false\" | \"inherit\"\n\t\t\t\t\t>(\"scm.diffDecorationsIgnoreTrimWhitespace\");\n\t\t\t\tconst ignoreTrimWhitespace =\n\t\t\t\t\tignoreTrimWhitespaceSetting === \"inherit\"\n\t\t\t\t\t\t? this.configurationService.getValue<boolean>(\n\t\t\t\t\t\t\t\t\"diffEditor.ignoreTrimWhitespace\",\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: ignoreTrimWhitespaceSetting !== \"false\";\n\n\t\t\t\tconst allDiffs: LabeledChange[] = [];\n\t\t\t\tfor (const quickDiff of filteredToDiffable) {\n\t\t\t\t\tconst dirtyDiff =\n\t\t\t\t\t\tawait this.editorWorkerService.computeDirtyDiff(\n\t\t\t\t\t\t\tquickDiff.originalResource,\n\t\t\t\t\t\t\tthis._model.resource,\n\t\t\t\t\t\t\tignoreTrimWhitespace,\n\t\t\t\t\t\t);\n\t\t\t\t\tif (dirtyDiff) {\n\t\t\t\t\t\tfor (const diff of dirtyDiff) {\n\t\t\t\t\t\t\tif (diff) {\n\t\t\t\t\t\t\t\tallDiffs.push({\n\t\t\t\t\t\t\t\t\tchange: diff,\n\t\t\t\t\t\t\t\t\tlabel: quickDiff.label,\n\t\t\t\t\t\t\t\t\turi: quickDiff.originalResource,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst sorted = allDiffs.sort((a, b) =>\n\t\t\t\t\tcompareChanges(a.change, b.change),\n\t\t\t\t);\n\t\t\t\tconst map: Map<string, number[]> = new Map();\n\t\t\t\tfor (let i = 0; i < sorted.length; i++) {\n\t\t\t\t\tconst label = sorted[i].label;\n\t\t\t\t\tif (!map.has(label)) {\n\t\t\t\t\t\tmap.set(label, []);\n\t\t\t\t\t}\n\t\t\t\t\tmap.get(label)!.push(i);\n\t\t\t\t}\n\t\t\t\treturn { changes: sorted, mapChanges: map };\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate getQuickDiffsPromise(): Promise<QuickDiff[]> {\n\t\tif (this._quickDiffsPromise) {\n\t\t\treturn this._quickDiffsPromise;\n\t\t}\n\n\t\tthis._quickDiffsPromise = this.getOriginalResource().then(\n\t\t\tasync (quickDiffs) => {\n\t\t\t\tif (this._disposed) {\n\t\t\t\t\t// disposed\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tif (quickDiffs.length === 0) {\n\t\t\t\t\tthis._quickDiffs = [];\n\t\t\t\t\tthis._originalModels.clear();\n\t\t\t\t\tthis._originalTextModels = [];\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tequals(\n\t\t\t\t\t\tthis._quickDiffs,\n\t\t\t\t\t\tquickDiffs,\n\t\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t\ta.originalResource.toString() ===\n\t\t\t\t\t\t\t\tb.originalResource.toString() &&\n\t\t\t\t\t\t\ta.label === b.label,\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\treturn quickDiffs;\n\t\t\t\t}\n\n\t\t\t\tthis.originalModelDisposables.clear();\n\t\t\t\tthis._originalModels.clear();\n\t\t\t\tthis._originalTextModels = [];\n\t\t\t\tthis._quickDiffs = quickDiffs;\n\t\t\t\treturn (\n\t\t\t\t\tawait Promise.all(\n\t\t\t\t\t\tquickDiffs.map(async (quickDiff) => {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst ref =\n\t\t\t\t\t\t\t\t\tawait this.textModelResolverService.createModelReference(\n\t\t\t\t\t\t\t\t\t\tquickDiff.originalResource,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (this._disposed) {\n\t\t\t\t\t\t\t\t\t// disposed\n\t\t\t\t\t\t\t\t\tref.dispose();\n\t\t\t\t\t\t\t\t\treturn [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthis._originalModels.set(\n\t\t\t\t\t\t\t\t\tquickDiff.originalResource.toString(),\n\t\t\t\t\t\t\t\t\tref.object,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis._originalTextModels.push(\n\t\t\t\t\t\t\t\t\tref.object.textEditorModel,\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (isTextFileEditorModel(ref.object)) {\n\t\t\t\t\t\t\t\t\tconst encoding = this._model.getEncoding();\n\n\t\t\t\t\t\t\t\t\tif (encoding) {\n\t\t\t\t\t\t\t\t\t\tref.object.setEncoding(\n\t\t\t\t\t\t\t\t\t\t\tencoding,\n\t\t\t\t\t\t\t\t\t\t\tEncodingMode.Decode,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthis.originalModelDisposables.add(ref);\n\t\t\t\t\t\t\t\tthis.originalModelDisposables.add(\n\t\t\t\t\t\t\t\t\tref.object.textEditorModel.onDidChangeContent(\n\t\t\t\t\t\t\t\t\t\t() => this.triggerDiff(),\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\treturn quickDiff;\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\treturn []; // possibly invalid reference\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t)\n\t\t\t\t).flat();\n\t\t\t},\n\t\t);\n\n\t\treturn this._quickDiffsPromise.finally(() => {\n\t\t\tthis._quickDiffsPromise = undefined;\n\t\t});\n\t}\n\n\tprivate async getOriginalResource(): Promise<QuickDiff[]> {\n\t\tif (this._disposed) {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\n\t\tconst uri = this._model.resource;\n\t\treturn this.quickDiffService.getQuickDiffs(\n\t\t\turi,\n\t\t\tthis._model.getLanguageId(),\n\t\t\tthis._model.textEditorModel\n\t\t\t\t? shouldSynchronizeModel(this._model.textEditorModel)\n\t\t\t\t: undefined,\n\t\t);\n\t}\n\n\tfindNextClosestChange(\n\t\tlineNumber: number,\n\t\tinclusive = true,\n\t\tprovider?: string,\n\t): number {\n\t\tlet preferredProvider: string | undefined;\n\t\tif (!provider && inclusive) {\n\t\t\tpreferredProvider = this.quickDiffs.find(\n\t\t\t\t(value) => value.isSCM,\n\t\t\t)?.label;\n\t\t}\n\n\t\tconst possibleChanges: number[] = [];\n\t\tfor (let i = 0; i < this.changes.length; i++) {\n\t\t\tif (provider && this.changes[i].label !== provider) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst change = this.changes[i];\n\t\t\tconst possibleChangesLength = possibleChanges.length;\n\n\t\t\tif (inclusive) {\n\t\t\t\tif (getModifiedEndLineNumber(change.change) >= lineNumber) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tpreferredProvider &&\n\t\t\t\t\t\tchange.label !== preferredProvider\n\t\t\t\t\t) {\n\t\t\t\t\t\tpossibleChanges.push(i);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (change.change.modifiedStartLineNumber > lineNumber) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tpossibleChanges.length > 0 &&\n\t\t\t\tpossibleChanges.length === possibleChangesLength\n\t\t\t) {\n\t\t\t\treturn possibleChanges[0];\n\t\t\t}\n\t\t}\n\n\t\treturn possibleChanges.length > 0 ? possibleChanges[0] : 0;\n\t}\n\n\tfindPreviousClosestChange(\n\t\tlineNumber: number,\n\t\tinclusive = true,\n\t\tprovider?: string,\n\t): number {\n\t\tfor (let i = this.changes.length - 1; i >= 0; i--) {\n\t\t\tif (provider && this.changes[i].label !== provider) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst change = this.changes[i].change;\n\n\t\t\tif (inclusive) {\n\t\t\t\tif (change.modifiedStartLineNumber <= lineNumber) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t} else if (getModifiedEndLineNumber(change) < lineNumber) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn this.changes.length - 1;\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis._disposed = true;\n\t\tthis._quickDiffs = [];\n\t\tthis._originalModels.clear();\n\t\tthis._originalTextModels = [];\n\t\tthis.diffDelayer.cancel();\n\t\tthis.repositoryDisposables.forEach((d) => dispose(d));\n\t\tthis.repositoryDisposables.clear();\n\t}\n}\n\nclass DirtyDiffItem {\n\tconstructor(\n\t\treadonly model: DirtyDiffModel,\n\t\treadonly decorator: DirtyDiffDecorator,\n\t) {}\n\n\tdispose(): void {\n\t\tthis.decorator.dispose();\n\t\tthis.model.dispose();\n\t}\n}\n\ninterface IViewState {\n\treadonly width: number;\n\treadonly visibility: \"always\" | \"hover\";\n}\n\nexport class DirtyDiffWorkbenchController\n\textends Disposable\n\timplements ext.IWorkbenchContribution, IModelRegistry\n{\n\tprivate enabled = false;\n\tprivate viewState: IViewState = { width: 3, visibility: \"always\" };\n\tprivate items = new ResourceMap<Map<string, DirtyDiffItem>>(); // resource -> editor id -> DirtyDiffItem\n\tprivate readonly transientDisposables = this._register(\n\t\tnew DisposableStore(),\n\t);\n\tprivate stylesheet: HTMLStyleElement;\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService\n\t) {\n\t\tsuper();\n\t\tthis.stylesheet = dom.createStyleSheet(undefined, undefined, this._store);\n\n\t\tconst onDidChangeConfiguration = Event.filter(configurationService.onDidChangeConfiguration, e => e.affectsConfiguration('scm.diffDecorations'));\n\t\tthis._register(onDidChangeConfiguration(this.onDidChangeConfiguration, this));\n\t\tthis.onDidChangeConfiguration();\n\n\t\tconst onDidChangeDiffWidthConfiguration = Event.filter(configurationService.onDidChangeConfiguration, e => e.affectsConfiguration('scm.diffDecorationsGutterWidth'));\n\t\tthis._register(onDidChangeDiffWidthConfiguration(this.onDidChangeDiffWidthConfiguration, this));\n\t\tthis.onDidChangeDiffWidthConfiguration();\n\n\t\tconst onDidChangeDiffVisibilityConfiguration = Event.filter(configurationService.onDidChangeConfiguration, e => e.affectsConfiguration('scm.diffDecorationsGutterVisibility'));\n\t\tthis._register(onDidChangeDiffVisibilityConfiguration(this.onDidChangeDiffVisibilityConfiguration, this));\n\t\tthis.onDidChangeDiffVisibilityConfiguration();\n\t}\n\n\tprivate onDidChangeConfiguration(): void {\n\t\tconst enabled =\n\t\t\tthis.configurationService.getValue<string>(\n\t\t\t\t\"scm.diffDecorations\",\n\t\t\t) !== \"none\";\n\n\t\tif (enabled) {\n\t\t\tthis.enable();\n\t\t} else {\n\t\t\tthis.disable();\n\t\t}\n\t}\n\n\tprivate onDidChangeDiffWidthConfiguration(): void {\n\t\tlet width = this.configurationService.getValue<number>(\n\t\t\t\"scm.diffDecorationsGutterWidth\",\n\t\t);\n\n\t\tif (isNaN(width) || width <= 0 || width > 5) {\n\t\t\twidth = 3;\n\t\t}\n\n\t\tthis.setViewState({ ...this.viewState, width });\n\t}\n\n\tprivate onDidChangeDiffVisibilityConfiguration(): void {\n\t\tconst visibility = this.configurationService.getValue<\n\t\t\t\"always\" | \"hover\"\n\t\t>(\"scm.diffDecorationsGutterVisibility\");\n\t\tthis.setViewState({ ...this.viewState, visibility });\n\t}\n\n\tprivate setViewState(state: IViewState): void {\n\t\tthis.viewState = state;\n\t\tthis.stylesheet.textContent = `\n\t\t\t.monaco-editor .dirty-diff-added,\n\t\t\t.monaco-editor .dirty-diff-modified {\n\t\t\t\tborder-left-width:${state.width}px;\n\t\t\t}\n\t\t\t.monaco-editor .dirty-diff-added-pattern,\n\t\t\t.monaco-editor .dirty-diff-added-pattern:before,\n\t\t\t.monaco-editor .dirty-diff-modified-pattern,\n\t\t\t.monaco-editor .dirty-diff-modified-pattern:before {\n\t\t\t\tbackground-size: ${state.width}px ${state.width}px;\n\t\t\t}\n\t\t\t.monaco-editor .dirty-diff-added,\n\t\t\t.monaco-editor .dirty-diff-added-pattern,\n\t\t\t.monaco-editor .dirty-diff-modified,\n\t\t\t.monaco-editor .dirty-diff-modified-pattern,\n\t\t\t.monaco-editor .dirty-diff-deleted {\n\t\t\t\topacity: ${state.visibility === \"always\" ? 1 : 0};\n\t\t\t}\n\t\t`;\n\t}\n\n\tprivate enable(): void {\n\t\tif (this.enabled) {\n\t\t\tthis.disable();\n\t\t}\n\n\t\tthis.transientDisposables.add(\n\t\t\tEvent.any(\n\t\t\t\tthis.editorService.onDidCloseEditor,\n\t\t\t\tthis.editorService.onDidVisibleEditorsChange,\n\t\t\t)(() => this.onEditorsChanged()),\n\t\t);\n\t\tthis.onEditorsChanged();\n\t\tthis.enabled = true;\n\t}\n\n\tprivate disable(): void {\n\t\tif (!this.enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.transientDisposables.clear();\n\n\t\tfor (const [, dirtyDiff] of this.items) {\n\t\t\tdispose(dirtyDiff.values());\n\t\t}\n\n\t\tthis.items.clear();\n\t\tthis.enabled = false;\n\t}\n\n\tprivate onEditorsChanged(): void {\n\t\tfor (const editor of this.editorService.visibleTextEditorControls) {\n\t\t\tif (isCodeEditor(editor)) {\n\t\t\t\tconst textModel = editor.getModel();\n\t\t\t\tconst controller = DirtyDiffController.get(editor);\n\n\t\t\t\tif (controller) {\n\t\t\t\t\tcontroller.modelRegistry = this;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\ttextModel &&\n\t\t\t\t\t(!this.items.has(textModel.uri) ||\n\t\t\t\t\t\t!this.items.get(textModel.uri)!.has(editor.getId()))\n\t\t\t\t) {\n\t\t\t\t\tconst textFileModel = this.textFileService.files.get(\n\t\t\t\t\t\ttextModel.uri,\n\t\t\t\t\t);\n\n\t\t\t\t\tif (textFileModel?.isResolved()) {\n\t\t\t\t\t\tconst dirtyDiffModel =\n\t\t\t\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\t\t\t\tDirtyDiffModel,\n\t\t\t\t\t\t\t\ttextFileModel,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\tconst decorator = new DirtyDiffDecorator(\n\t\t\t\t\t\t\ttextFileModel.textEditorModel,\n\t\t\t\t\t\t\teditor,\n\t\t\t\t\t\t\tdirtyDiffModel,\n\t\t\t\t\t\t\tthis.configurationService,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (!this.items.has(textModel.uri)) {\n\t\t\t\t\t\t\tthis.items.set(textModel.uri, new Map());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.items\n\t\t\t\t\t\t\t.get(textModel.uri)\n\t\t\t\t\t\t\t?.set(\n\t\t\t\t\t\t\t\teditor.getId(),\n\t\t\t\t\t\t\t\tnew DirtyDiffItem(dirtyDiffModel, decorator),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const [uri, item] of this.items) {\n\t\t\tfor (const editorId of item.keys()) {\n\t\t\t\tif (\n\t\t\t\t\t!this.editorService.visibleTextEditorControls.find(\n\t\t\t\t\t\t(editor) =>\n\t\t\t\t\t\t\tisCodeEditor(editor) &&\n\t\t\t\t\t\t\teditor.getModel()?.uri.toString() ===\n\t\t\t\t\t\t\t\turi.toString() &&\n\t\t\t\t\t\t\teditor.getId() === editorId,\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tif (item.has(editorId)) {\n\t\t\t\t\t\tconst dirtyDiffItem = item.get(editorId);\n\t\t\t\t\t\tdirtyDiffItem?.dispose();\n\t\t\t\t\t\titem.delete(editorId);\n\t\t\t\t\t\tif (item.size === 0) {\n\t\t\t\t\t\t\tthis.items.delete(uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetModel(\n\t\teditorModel: ITextModel,\n\t\tcodeEditor: ICodeEditor,\n\t): DirtyDiffModel | undefined {\n\t\treturn this.items.get(editorModel.uri)?.get(codeEditor.getId())?.model;\n\t}\n\n\toverride dispose(): void {\n\t\tthis.disable();\n\t\tsuper.dispose();\n\t}\n}\n\nregisterEditorContribution(\n\tDirtyDiffController.ID,\n\tDirtyDiffController,\n\tEditorContributionInstantiation.AfterFirstRender,\n);\n"],
  "mappings": "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",
  "names": ["ChangeType", "change"]
}
