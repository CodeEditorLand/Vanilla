{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/scm/browser/util.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { reset } from \"../../../../base/browser/dom.js\";\nimport {\n\tActionViewItem,\n\ttype IBaseActionViewItemOptions,\n} from \"../../../../base/browser/ui/actionbar/actionViewItems.js\";\nimport type {\n\tActionBar,\n\tIActionViewItemProvider,\n} from \"../../../../base/browser/ui/actionbar/actionbar.js\";\nimport { renderLabelWithIcons } from \"../../../../base/browser/ui/iconLabel/iconLabels.js\";\nimport { Action, type IAction } from \"../../../../base/common/actions.js\";\nimport { equals } from \"../../../../base/common/arrays.js\";\nimport type { IDisposable } from \"../../../../base/common/lifecycle.js\";\nimport {\n\ttype IResourceNode,\n\tResourceTree,\n} from \"../../../../base/common/resourceTree.js\";\nimport type { Command } from \"../../../../editor/common/languages.js\";\nimport {\n\tcreateActionViewItem,\n\tcreateAndFillInActionBarActions,\n\tcreateAndFillInContextMenuActions,\n} from \"../../../../platform/actions/browser/menuEntryActionViewItem.js\";\nimport {\n\ttype IMenu,\n\tMenuItemAction,\n} from \"../../../../platform/actions/common/actions.js\";\nimport type { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport type { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport type {\n\tSCMHistoryItemLoadMoreTreeElement,\n\tSCMHistoryItemViewModelTreeElement,\n} from \"../common/history.js\";\nimport type {\n\tISCMActionButton,\n\tISCMInput,\n\tISCMProvider,\n\tISCMRepository,\n\tISCMResource,\n\tISCMResourceGroup,\n\tISCMViewService,\n} from \"../common/scm.js\";\n\nexport function isSCMViewService(element: any): element is ISCMViewService {\n\treturn (\n\t\tArray.isArray((element as ISCMViewService).repositories) &&\n\t\tArray.isArray((element as ISCMViewService).visibleRepositories)\n\t);\n}\n\nexport function isSCMRepository(element: any): element is ISCMRepository {\n\treturn (\n\t\t!!(element as ISCMRepository).provider &&\n\t\t!!(element as ISCMRepository).input\n\t);\n}\n\nexport function isSCMInput(element: any): element is ISCMInput {\n\treturn (\n\t\t!!(element as ISCMInput).validateInput &&\n\t\ttypeof (element as ISCMInput).value === \"string\"\n\t);\n}\n\nexport function isSCMActionButton(element: any): element is ISCMActionButton {\n\treturn (element as ISCMActionButton).type === \"actionButton\";\n}\n\nexport function isSCMResourceGroup(element: any): element is ISCMResourceGroup {\n\treturn (\n\t\t!!(element as ISCMResourceGroup).provider &&\n\t\t!!(element as ISCMResourceGroup).resources\n\t);\n}\n\nexport function isSCMResource(element: any): element is ISCMResource {\n\treturn (\n\t\t!!(element as ISCMResource).sourceUri &&\n\t\tisSCMResourceGroup((element as ISCMResource).resourceGroup)\n\t);\n}\n\nexport function isSCMResourceNode(\n\telement: any,\n): element is IResourceNode<ISCMResource, ISCMResourceGroup> {\n\treturn (\n\t\tResourceTree.isResourceNode(element) &&\n\t\tisSCMResourceGroup(element.context)\n\t);\n}\n\nexport function isSCMHistoryItemViewModelTreeElement(\n\telement: any,\n): element is SCMHistoryItemViewModelTreeElement {\n\treturn (\n\t\t(element as SCMHistoryItemViewModelTreeElement).type ===\n\t\t\"historyItemViewModel\"\n\t);\n}\n\nexport function isSCMHistoryItemLoadMoreTreeElement(\n\telement: any,\n): element is SCMHistoryItemLoadMoreTreeElement {\n\treturn (\n\t\t(element as SCMHistoryItemLoadMoreTreeElement).type ===\n\t\t\"historyItemLoadMore\"\n\t);\n}\n\nconst compareActions = (a: IAction, b: IAction) => {\n\tif (a instanceof MenuItemAction && b instanceof MenuItemAction) {\n\t\treturn (\n\t\t\ta.id === b.id &&\n\t\t\ta.enabled === b.enabled &&\n\t\t\ta.hideActions?.isHidden === b.hideActions?.isHidden\n\t\t);\n\t}\n\n\treturn a.id === b.id && a.enabled === b.enabled;\n};\n\nexport function connectPrimaryMenu(\n\tmenu: IMenu,\n\tcallback: (primary: IAction[], secondary: IAction[]) => void,\n\tprimaryGroup?: string,\n): IDisposable {\n\tlet cachedPrimary: IAction[] = [];\n\tlet cachedSecondary: IAction[] = [];\n\n\tconst updateActions = () => {\n\t\tconst primary: IAction[] = [];\n\t\tconst secondary: IAction[] = [];\n\n\t\tcreateAndFillInActionBarActions(\n\t\t\tmenu,\n\t\t\t{ shouldForwardArgs: true },\n\t\t\t{ primary, secondary },\n\t\t\tprimaryGroup,\n\t\t);\n\n\t\tif (\n\t\t\tequals(cachedPrimary, primary, compareActions) &&\n\t\t\tequals(cachedSecondary, secondary, compareActions)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tcachedPrimary = primary;\n\t\tcachedSecondary = secondary;\n\n\t\tcallback(primary, secondary);\n\t};\n\n\tupdateActions();\n\n\treturn menu.onDidChange(updateActions);\n}\n\nexport function connectPrimaryMenuToInlineActionBar(\n\tmenu: IMenu,\n\tactionBar: ActionBar,\n): IDisposable {\n\treturn connectPrimaryMenu(\n\t\tmenu,\n\t\t(primary) => {\n\t\t\tactionBar.clear();\n\t\t\tactionBar.push(primary, { icon: true, label: false });\n\t\t},\n\t\t\"inline\",\n\t);\n}\n\nexport function collectContextMenuActions(menu: IMenu): IAction[] {\n\tconst primary: IAction[] = [];\n\tconst actions: IAction[] = [];\n\tcreateAndFillInContextMenuActions(\n\t\tmenu,\n\t\t{ shouldForwardArgs: true },\n\t\t{ primary, secondary: actions },\n\t\t\"inline\",\n\t);\n\treturn actions;\n}\n\nexport class StatusBarAction extends Action {\n\tconstructor(\n\t\tprivate command: Command,\n\t\tprivate commandService: ICommandService,\n\t) {\n\t\tsuper(`statusbaraction{${command.id}}`, command.title, \"\", true);\n\t\tthis.tooltip = command.tooltip || \"\";\n\t}\n\n\toverride run(): Promise<void> {\n\t\treturn this.commandService.executeCommand(\n\t\t\tthis.command.id,\n\t\t\t...(this.command.arguments || []),\n\t\t);\n\t}\n}\n\nclass StatusBarActionViewItem extends ActionViewItem {\n\tconstructor(action: StatusBarAction, options: IBaseActionViewItemOptions) {\n\t\tsuper(null, action, { ...options, icon: false, label: true });\n\t}\n\n\tprotected override updateLabel(): void {\n\t\tif (this.options.label && this.label) {\n\t\t\treset(this.label, ...renderLabelWithIcons(this.action.label));\n\t\t}\n\t}\n}\n\nexport function getActionViewItemProvider(\n\tinstaService: IInstantiationService,\n): IActionViewItemProvider {\n\treturn (action, options) => {\n\t\tif (action instanceof StatusBarAction) {\n\t\t\treturn new StatusBarActionViewItem(action, options);\n\t\t}\n\n\t\treturn createActionViewItem(instaService, action, options);\n\t};\n}\n\nexport function getProviderKey(provider: ISCMProvider): string {\n\treturn `${provider.contextValue}:${provider.label}${provider.rootUri ? `:${provider.rootUri.toString()}` : \"\"}`;\n}\n\nexport function getRepositoryResourceCount(provider: ISCMProvider): number {\n\treturn provider.groups.reduce<number>((r, g) => r + g.resources.length, 0);\n}\n"],
  "mappings": "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",
  "names": []
}
