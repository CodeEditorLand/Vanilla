{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/scm/browser/util.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { SCMHistoryItemLoadMoreTreeElement, SCMHistoryItemViewModelTreeElement } from '../common/history.js';\nimport { ISCMResource, ISCMRepository, ISCMResourceGroup, ISCMInput, ISCMActionButton, ISCMViewService, ISCMProvider } from '../common/scm.js';\nimport { IMenu, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { ActionBar, IActionViewItemProvider } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { IDisposable } from '../../../../base/common/lifecycle.js';\nimport { Action, IAction } from '../../../../base/common/actions.js';\nimport { createActionViewItem, createAndFillInActionBarActions, createAndFillInContextMenuActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { ActionViewItem, IBaseActionViewItemOptions } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { renderLabelWithIcons } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { Command } from '../../../../editor/common/languages.js';\nimport { reset } from '../../../../base/browser/dom.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IResourceNode, ResourceTree } from '../../../../base/common/resourceTree.js';\n\nexport function isSCMViewService(element: any): element is ISCMViewService {\n\treturn Array.isArray((element as ISCMViewService).repositories) && Array.isArray((element as ISCMViewService).visibleRepositories);\n}\n\nexport function isSCMRepository(element: any): element is ISCMRepository {\n\treturn !!(element as ISCMRepository).provider && !!(element as ISCMRepository).input;\n}\n\nexport function isSCMInput(element: any): element is ISCMInput {\n\treturn !!(element as ISCMInput).validateInput && typeof (element as ISCMInput).value === 'string';\n}\n\nexport function isSCMActionButton(element: any): element is ISCMActionButton {\n\treturn (element as ISCMActionButton).type === 'actionButton';\n}\n\nexport function isSCMResourceGroup(element: any): element is ISCMResourceGroup {\n\treturn !!(element as ISCMResourceGroup).provider && !!(element as ISCMResourceGroup).resources;\n}\n\nexport function isSCMResource(element: any): element is ISCMResource {\n\treturn !!(element as ISCMResource).sourceUri && isSCMResourceGroup((element as ISCMResource).resourceGroup);\n}\n\nexport function isSCMResourceNode(element: any): element is IResourceNode<ISCMResource, ISCMResourceGroup> {\n\treturn ResourceTree.isResourceNode(element) && isSCMResourceGroup(element.context);\n}\n\nexport function isSCMHistoryItemViewModelTreeElement(element: any): element is SCMHistoryItemViewModelTreeElement {\n\treturn (element as SCMHistoryItemViewModelTreeElement).type === 'historyItemViewModel';\n}\n\nexport function isSCMHistoryItemLoadMoreTreeElement(element: any): element is SCMHistoryItemLoadMoreTreeElement {\n\treturn (element as SCMHistoryItemLoadMoreTreeElement).type === 'historyItemLoadMore';\n}\n\nconst compareActions = (a: IAction, b: IAction) => {\n\tif (a instanceof MenuItemAction && b instanceof MenuItemAction) {\n\t\treturn a.id === b.id && a.enabled === b.enabled && a.hideActions?.isHidden === b.hideActions?.isHidden;\n\t}\n\n\treturn a.id === b.id && a.enabled === b.enabled;\n};\n\nexport function connectPrimaryMenu(menu: IMenu, callback: (primary: IAction[], secondary: IAction[]) => void, primaryGroup?: string): IDisposable {\n\tlet cachedPrimary: IAction[] = [];\n\tlet cachedSecondary: IAction[] = [];\n\n\tconst updateActions = () => {\n\t\tconst primary: IAction[] = [];\n\t\tconst secondary: IAction[] = [];\n\n\t\tcreateAndFillInActionBarActions(menu, { shouldForwardArgs: true }, { primary, secondary }, primaryGroup);\n\n\t\tif (equals(cachedPrimary, primary, compareActions) && equals(cachedSecondary, secondary, compareActions)) {\n\t\t\treturn;\n\t\t}\n\n\t\tcachedPrimary = primary;\n\t\tcachedSecondary = secondary;\n\n\t\tcallback(primary, secondary);\n\t};\n\n\tupdateActions();\n\n\treturn menu.onDidChange(updateActions);\n}\n\nexport function connectPrimaryMenuToInlineActionBar(menu: IMenu, actionBar: ActionBar): IDisposable {\n\treturn connectPrimaryMenu(menu, (primary) => {\n\t\tactionBar.clear();\n\t\tactionBar.push(primary, { icon: true, label: false });\n\t}, 'inline');\n}\n\nexport function collectContextMenuActions(menu: IMenu): IAction[] {\n\tconst primary: IAction[] = [];\n\tconst actions: IAction[] = [];\n\tcreateAndFillInContextMenuActions(menu, { shouldForwardArgs: true }, { primary, secondary: actions }, 'inline');\n\treturn actions;\n}\n\nexport class StatusBarAction extends Action {\n\n\tconstructor(\n\t\tprivate command: Command,\n\t\tprivate commandService: ICommandService\n\t) {\n\t\tsuper(`statusbaraction{${command.id}}`, command.title, '', true);\n\t\tthis.tooltip = command.tooltip || '';\n\t}\n\n\toverride run(): Promise<void> {\n\t\treturn this.commandService.executeCommand(this.command.id, ...(this.command.arguments || []));\n\t}\n}\n\nclass StatusBarActionViewItem extends ActionViewItem {\n\n\tconstructor(action: StatusBarAction, options: IBaseActionViewItemOptions) {\n\t\tsuper(null, action, { ...options, icon: false, label: true });\n\t}\n\n\tprotected override updateLabel(): void {\n\t\tif (this.options.label && this.label) {\n\t\t\treset(this.label, ...renderLabelWithIcons(this.action.label));\n\t\t}\n\t}\n}\n\nexport function getActionViewItemProvider(instaService: IInstantiationService): IActionViewItemProvider {\n\treturn (action, options) => {\n\t\tif (action instanceof StatusBarAction) {\n\t\t\treturn new StatusBarActionViewItem(action, options);\n\t\t}\n\n\t\treturn createActionViewItem(instaService, action, options);\n\t};\n}\n\nexport function getProviderKey(provider: ISCMProvider): string {\n\treturn `${provider.contextValue}:${provider.label}${provider.rootUri ? `:${provider.rootUri.toString()}` : ''}`;\n}\n\nexport function getRepositoryResourceCount(provider: ISCMProvider): number {\n\treturn provider.groups.reduce<number>((r, g) => r + g.resources.length, 0);\n}\n"],
  "mappings": "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",
  "names": []
}
