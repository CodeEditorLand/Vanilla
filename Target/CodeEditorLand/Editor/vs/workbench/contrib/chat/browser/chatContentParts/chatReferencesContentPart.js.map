{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/chatContentParts/chatReferencesContentPart.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../../base/browser/dom.js\";\nimport { Button } from \"../../../../../base/browser/ui/button/button.js\";\nimport type {\n\tIListRenderer,\n\tIListVirtualDelegate,\n} from \"../../../../../base/browser/ui/list/list.js\";\nimport { coalesce } from \"../../../../../base/common/arrays.js\";\nimport { Codicon } from \"../../../../../base/common/codicons.js\";\nimport { Emitter, type Event } from \"../../../../../base/common/event.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n\ttype IDisposable,\n} from \"../../../../../base/common/lifecycle.js\";\nimport {\n\tSchemas,\n\tmatchesSomeScheme,\n} from \"../../../../../base/common/network.js\";\nimport { basename } from \"../../../../../base/common/path.js\";\nimport {\n\tbasenameOrAuthority,\n\tisEqualAuthority,\n} from \"../../../../../base/common/resources.js\";\nimport { ThemeIcon } from \"../../../../../base/common/themables.js\";\nimport { URI } from \"../../../../../base/common/uri.js\";\nimport { localize } from \"../../../../../nls.js\";\nimport { IClipboardService } from \"../../../../../platform/clipboard/common/clipboardService.js\";\nimport { IContextMenuService } from \"../../../../../platform/contextview/browser/contextView.js\";\nimport { FileKind } from \"../../../../../platform/files/common/files.js\";\nimport { IInstantiationService } from \"../../../../../platform/instantiation/common/instantiation.js\";\nimport { ILabelService } from \"../../../../../platform/label/common/label.js\";\nimport { WorkbenchList } from \"../../../../../platform/list/browser/listService.js\";\nimport { IOpenerService } from \"../../../../../platform/opener/common/opener.js\";\nimport { IProductService } from \"../../../../../platform/product/common/productService.js\";\nimport { IThemeService } from \"../../../../../platform/theme/common/themeService.js\";\nimport { fillEditorsDragData } from \"../../../../browser/dnd.js\";\nimport {\n\ttype IResourceLabel,\n\tResourceLabels,\n} from \"../../../../browser/labels.js\";\nimport { ColorScheme } from \"../../../../browser/web.api.js\";\nimport { SETTINGS_AUTHORITY } from \"../../../../services/preferences/common/preferences.js\";\nimport { createFileIconThemableTreeContainerScope } from \"../../../files/browser/views/explorerView.js\";\nimport {\n\tChatResponseReferencePartStatusKind,\n\ttype IChatContentReference,\n\ttype IChatWarningMessage,\n} from \"../../common/chatService.js\";\nimport { IChatVariablesService } from \"../../common/chatVariables.js\";\nimport type {\n\tIChatRendererContent,\n\tIChatResponseViewModel,\n} from \"../../common/chatViewModel.js\";\nimport type { ChatTreeItem } from \"../chat.js\";\nimport { type IDisposableReference, ResourcePool } from \"./chatCollections.js\";\nimport type { IChatContentPart } from \"./chatContentParts.js\";\n\nconst $ = dom.$;\n\nexport interface IChatReferenceListItem extends IChatContentReference {\n\ttitle?: string;\n}\n\nexport type IChatCollapsibleListItem =\n\t| IChatReferenceListItem\n\t| IChatWarningMessage;\n\nexport class ChatCollapsibleListContentPart\n\textends Disposable\n\timplements IChatContentPart\n{\n\tpublic readonly domNode: HTMLElement;\n\n\tprivate readonly _onDidChangeHeight = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeHeight = this._onDidChangeHeight.event;\n\n\tconstructor(\n\t\tprivate readonly data: ReadonlyArray<IChatCollapsibleListItem>,\n\t\tlabelOverride: string | undefined,\n\t\telement: IChatResponseViewModel,\n\t\tcontentReferencesListPool: CollapsibleListPool,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IClipboardService private readonly clipboardService: IClipboardService,\n\t) {\n\t\tsuper();\n\n\t\tconst referencesLabel = labelOverride ?? (data.length > 1 ?\n\t\t\tlocalize('usedReferencesPlural', \"Used {0} references\", data.length) :\n\t\t\tlocalize('usedReferencesSingular', \"Used {0} reference\", 1));\n\t\tconst iconElement = $('.chat-used-context-icon');\n\t\tconst icon = (element: IChatResponseViewModel) => element.usedReferencesExpanded ? Codicon.chevronDown : Codicon.chevronRight;\n\t\ticonElement.classList.add(...ThemeIcon.asClassNameArray(icon(element)));\n\t\tconst buttonElement = $('.chat-used-context-label', undefined);\n\n\t\tconst collapseButton = this._register(new Button(buttonElement, {\n\t\t\tbuttonBackground: undefined,\n\t\t\tbuttonBorder: undefined,\n\t\t\tbuttonForeground: undefined,\n\t\t\tbuttonHoverBackground: undefined,\n\t\t\tbuttonSecondaryBackground: undefined,\n\t\t\tbuttonSecondaryForeground: undefined,\n\t\t\tbuttonSecondaryHoverBackground: undefined,\n\t\t\tbuttonSeparator: undefined\n\t\t}));\n\t\tthis.domNode = $('.chat-used-context', undefined, buttonElement);\n\t\tcollapseButton.label = referencesLabel;\n\t\tcollapseButton.element.prepend(iconElement);\n\t\tthis.updateAriaLabel(collapseButton.element, referencesLabel, element.usedReferencesExpanded);\n\t\tthis.domNode.classList.toggle('chat-used-context-collapsed', !element.usedReferencesExpanded);\n\t\tthis._register(collapseButton.onDidClick(() => {\n\t\t\ticonElement.classList.remove(...ThemeIcon.asClassNameArray(icon(element)));\n\t\t\telement.usedReferencesExpanded = !element.usedReferencesExpanded;\n\t\t\ticonElement.classList.add(...ThemeIcon.asClassNameArray(icon(element)));\n\t\t\tthis.domNode.classList.toggle('chat-used-context-collapsed', !element.usedReferencesExpanded);\n\t\t\tthis._onDidChangeHeight.fire();\n\t\t\tthis.updateAriaLabel(collapseButton.element, referencesLabel, element.usedReferencesExpanded);\n\t\t}));\n\n\t\tconst ref = this._register(contentReferencesListPool.get());\n\t\tconst list = ref.object;\n\t\tthis.domNode.appendChild(list.getHTMLElement().parentElement!);\n\n\t\tthis._register(list.onDidOpen((e) => {\n\t\t\tif (e.element && 'reference' in e.element && typeof e.element.reference === 'object') {\n\t\t\t\tconst uriOrLocation = 'variableName' in e.element.reference ? e.element.reference.value : e.element.reference;\n\t\t\t\tconst uri = URI.isUri(uriOrLocation) ? uriOrLocation :\n\t\t\t\t\turiOrLocation?.uri;\n\t\t\t\tif (uri) {\n\t\t\t\t\topenerService.open(\n\t\t\t\t\t\turi,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfromUserGesture: true,\n\t\t\t\t\t\t\teditorOptions: {\n\t\t\t\t\t\t\t\t...e.editorOptions,\n\t\t\t\t\t\t\t\t...{\n\t\t\t\t\t\t\t\t\tselection: uriOrLocation && 'range' in uriOrLocation ? uriOrLocation.range : undefined\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(list.onContextMenu((e) => {\n\t\t\te.browserEvent.preventDefault();\n\t\t\te.browserEvent.stopPropagation();\n\n\t\t\tif (e.element && 'reference' in e.element && typeof e.element.reference === 'object') {\n\t\t\t\tconst uriOrLocation = 'variableName' in e.element.reference ? e.element.reference.value : e.element.reference;\n\t\t\t\tconst uri = URI.isUri(uriOrLocation) ? uriOrLocation :\n\t\t\t\t\turiOrLocation?.uri;\n\t\t\t\tif (uri) {\n\t\t\t\t\tthis.contextMenuService.showContextMenu({\n\t\t\t\t\t\tgetAnchor: () => e.anchor,\n\t\t\t\t\t\tgetActions: () => {\n\t\t\t\t\t\t\treturn [{\n\t\t\t\t\t\t\t\tid: 'workbench.action.chat.copyReference',\n\t\t\t\t\t\t\t\ttitle: localize('copyReference', \"Copy\"),\n\t\t\t\t\t\t\t\tlabel: localize('copyReference', \"Copy\"),\n\t\t\t\t\t\t\t\ttooltip: localize('copyReference', \"Copy\"),\n\t\t\t\t\t\t\t\tenabled: e.element?.kind === 'reference',\n\t\t\t\t\t\t\t\tclass: undefined,\n\t\t\t\t\t\t\t\trun: () => {\n\t\t\t\t\t\t\t\t\tvoid this.clipboardService.writeResources([uri]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t}));\n\n\t\tconst maxItemsShown = 6;\n\t\tconst itemsShown = Math.min(data.length, maxItemsShown);\n\t\tconst height = itemsShown * 22;\n\t\tlist.layout(height);\n\t\tlist.getHTMLElement().style.height = `${height}px`;\n\t\tlist.splice(0, list.length, data);\n\t}\n\n\thasSameContent(\n\t\tother: IChatRendererContent,\n\t\tfollowingContent: IChatRendererContent[],\n\t\telement: ChatTreeItem,\n\t): boolean {\n\t\treturn (\n\t\t\t(other.kind === \"references\" &&\n\t\t\t\tother.references.length === this.data.length) ||\n\t\t\t(other.kind === \"codeCitations\" &&\n\t\t\t\tother.citations.length === this.data.length)\n\t\t);\n\t}\n\n\tprivate updateAriaLabel(\n\t\telement: HTMLElement,\n\t\tlabel: string,\n\t\texpanded?: boolean,\n\t): void {\n\t\telement.ariaLabel = expanded\n\t\t\t? localize(\"usedReferencesExpanded\", \"{0}, expanded\", label)\n\t\t\t: localize(\"usedReferencesCollapsed\", \"{0}, collapsed\", label);\n\t}\n\n\taddDisposable(disposable: IDisposable): void {\n\t\tthis._register(disposable);\n\t}\n}\n\nexport class CollapsibleListPool extends Disposable {\n\tprivate _pool: ResourcePool<WorkbenchList<IChatCollapsibleListItem>>;\n\n\tpublic get inUse(): ReadonlySet<WorkbenchList<IChatCollapsibleListItem>> {\n\t\treturn this._pool.inUse;\n\t}\n\n\tconstructor(\n\t\tprivate _onDidChangeVisibility: Event<boolean>,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t) {\n\t\tsuper();\n\t\tthis._pool = this._register(new ResourcePool(() => this.listFactory()));\n\t}\n\n\tprivate listFactory(): WorkbenchList<IChatCollapsibleListItem> {\n\t\tconst resourceLabels = this._register(\n\t\t\tthis.instantiationService.createInstance(ResourceLabels, {\n\t\t\t\tonDidChangeVisibility: this._onDidChangeVisibility,\n\t\t\t}),\n\t\t);\n\n\t\tconst container = $(\".chat-used-context-list\");\n\t\tthis._register(\n\t\t\tcreateFileIconThemableTreeContainerScope(\n\t\t\t\tcontainer,\n\t\t\t\tthis.themeService,\n\t\t\t),\n\t\t);\n\n\t\tconst getDragURI = (element: IChatCollapsibleListItem): URI | null => {\n\t\t\tif (element.kind === \"warning\") {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst { reference } = element;\n\t\t\tif (typeof reference === \"string\" || \"variableName\" in reference) {\n\t\t\t\treturn null;\n\t\t\t} else if (URI.isUri(reference)) {\n\t\t\t\treturn reference;\n\t\t\t} else {\n\t\t\t\treturn reference.uri;\n\t\t\t}\n\t\t};\n\n\t\tconst list = this.instantiationService.createInstance(\n\t\t\tWorkbenchList<IChatCollapsibleListItem>,\n\t\t\t\"ChatListRenderer\",\n\t\t\tcontainer,\n\t\t\tnew CollapsibleListDelegate(),\n\t\t\t[\n\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\tCollapsibleListRenderer,\n\t\t\t\t\tresourceLabels,\n\t\t\t\t),\n\t\t\t],\n\t\t\t{\n\t\t\t\talwaysConsumeMouseWheel: false,\n\t\t\t\taccessibilityProvider: {\n\t\t\t\t\tgetAriaLabel: (element: IChatCollapsibleListItem) => {\n\t\t\t\t\t\tif (element.kind === \"warning\") {\n\t\t\t\t\t\t\treturn element.content.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst reference = element.reference;\n\t\t\t\t\t\tif (typeof reference === \"string\") {\n\t\t\t\t\t\t\treturn reference;\n\t\t\t\t\t\t} else if (\"variableName\" in reference) {\n\t\t\t\t\t\t\treturn reference.variableName;\n\t\t\t\t\t\t} else if (URI.isUri(reference)) {\n\t\t\t\t\t\t\treturn basename(reference.path);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn basename(reference.uri.path);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\n\t\t\t\t\tgetWidgetAriaLabel: () =>\n\t\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\t\"chatCollapsibleList\",\n\t\t\t\t\t\t\t\"Collapsible Chat List\",\n\t\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t\tdnd: {\n\t\t\t\t\tgetDragURI: (element: IChatCollapsibleListItem) =>\n\t\t\t\t\t\tgetDragURI(element)?.toString() ?? null,\n\t\t\t\t\tgetDragLabel: (elements, originalEvent) => {\n\t\t\t\t\t\tconst uris: URI[] = coalesce(elements.map(getDragURI));\n\t\t\t\t\t\tif (!uris.length) {\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t} else if (uris.length === 1) {\n\t\t\t\t\t\t\treturn this.labelService.getUriLabel(uris[0], {\n\t\t\t\t\t\t\t\trelative: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn `${uris.length}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tdispose: () => {},\n\t\t\t\t\tonDragOver: () => false,\n\t\t\t\t\tdrop: () => {},\n\t\t\t\t\tonDragStart: (data, originalEvent) => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst elements =\n\t\t\t\t\t\t\t\tdata.getData() as IChatCollapsibleListItem[];\n\t\t\t\t\t\t\tconst uris: URI[] = coalesce(\n\t\t\t\t\t\t\t\telements.map(getDragURI),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.instantiationService.invokeFunction(\n\t\t\t\t\t\t\t\t(accessor) =>\n\t\t\t\t\t\t\t\t\tfillEditorsDragData(\n\t\t\t\t\t\t\t\t\t\taccessor,\n\t\t\t\t\t\t\t\t\t\turis,\n\t\t\t\t\t\t\t\t\t\toriginalEvent,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\t// noop\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\n\t\treturn list;\n\t}\n\n\tget(): IDisposableReference<WorkbenchList<IChatCollapsibleListItem>> {\n\t\tconst object = this._pool.get();\n\t\tlet stale = false;\n\t\treturn {\n\t\t\tobject,\n\t\t\tisStale: () => stale,\n\t\t\tdispose: () => {\n\t\t\t\tstale = true;\n\t\t\t\tthis._pool.release(object);\n\t\t\t},\n\t\t};\n\t}\n}\n\nclass CollapsibleListDelegate\n\timplements IListVirtualDelegate<IChatCollapsibleListItem>\n{\n\tgetHeight(element: IChatCollapsibleListItem): number {\n\t\treturn 22;\n\t}\n\n\tgetTemplateId(element: IChatCollapsibleListItem): string {\n\t\treturn CollapsibleListRenderer.TEMPLATE_ID;\n\t}\n}\n\ninterface ICollapsibleListTemplate {\n\tlabel: IResourceLabel;\n\ttemplateDisposables: IDisposable;\n}\n\nclass CollapsibleListRenderer\n\timplements IListRenderer<IChatCollapsibleListItem, ICollapsibleListTemplate>\n{\n\tstatic TEMPLATE_ID = \"chatCollapsibleListRenderer\";\n\treadonly templateId: string = CollapsibleListRenderer.TEMPLATE_ID;\n\n\tconstructor(\n\t\tprivate labels: ResourceLabels,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@IChatVariablesService private readonly chatVariablesService: IChatVariablesService,\n\t\t@IProductService private readonly productService: IProductService,\n\t) { }\n\n\trenderTemplate(container: HTMLElement): ICollapsibleListTemplate {\n\t\tconst templateDisposables = new DisposableStore();\n\t\tconst label = templateDisposables.add(\n\t\t\tthis.labels.create(container, {\n\t\t\t\tsupportHighlights: true,\n\t\t\t\tsupportIcons: true,\n\t\t\t}),\n\t\t);\n\t\treturn { templateDisposables, label };\n\t}\n\n\tprivate getReferenceIcon(\n\t\tdata: IChatContentReference,\n\t): URI | ThemeIcon | undefined {\n\t\tif (ThemeIcon.isThemeIcon(data.iconPath)) {\n\t\t\treturn data.iconPath;\n\t\t} else {\n\t\t\treturn this.themeService.getColorTheme().type ===\n\t\t\t\tColorScheme.DARK && data.iconPath?.dark\n\t\t\t\t? data.iconPath?.dark\n\t\t\t\t: data.iconPath?.light;\n\t\t}\n\t}\n\n\trenderElement(\n\t\tdata: IChatCollapsibleListItem,\n\t\tindex: number,\n\t\ttemplateData: ICollapsibleListTemplate,\n\t\theight: number | undefined,\n\t): void {\n\t\tif (data.kind === \"warning\") {\n\t\t\ttemplateData.label.setResource(\n\t\t\t\t{ name: data.content.value },\n\t\t\t\t{ icon: Codicon.warning },\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst reference = data.reference;\n\t\tconst icon = this.getReferenceIcon(data);\n\t\ttemplateData.label.element.style.display = \"flex\";\n\t\tif (typeof reference === \"object\" && \"variableName\" in reference) {\n\t\t\tif (reference.value) {\n\t\t\t\tconst uri = URI.isUri(reference.value)\n\t\t\t\t\t? reference.value\n\t\t\t\t\t: reference.value.uri;\n\t\t\t\ttemplateData.label.setResource(\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: uri,\n\t\t\t\t\t\tname: basenameOrAuthority(uri),\n\t\t\t\t\t\tdescription: `#${reference.variableName}`,\n\t\t\t\t\t\trange:\n\t\t\t\t\t\t\t\"range\" in reference.value\n\t\t\t\t\t\t\t\t? reference.value.range\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ticon,\n\t\t\t\t\t\ttitle: data.options?.status?.description ?? data.title,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst variable = this.chatVariablesService.getVariable(\n\t\t\t\t\treference.variableName,\n\t\t\t\t);\n\t\t\t\t// This is a hack to get chat attachment ThemeIcons to render for resource labels\n\t\t\t\tconst asThemeIcon = variable?.icon\n\t\t\t\t\t? `$(${variable.icon.id}) `\n\t\t\t\t\t: \"\";\n\t\t\t\tconst asVariableName = `#${reference.variableName}`; // Fallback, shouldn't really happen\n\t\t\t\tconst label = `${asThemeIcon}${variable?.fullName ?? asVariableName}`;\n\t\t\t\ttemplateData.label.setLabel(label, asVariableName, {\n\t\t\t\t\ttitle:\n\t\t\t\t\t\tdata.options?.status?.description ??\n\t\t\t\t\t\tvariable?.description,\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (typeof reference === \"string\") {\n\t\t\ttemplateData.label.setLabel(reference, undefined, {\n\t\t\t\ticonPath: URI.isUri(icon) ? icon : undefined,\n\t\t\t\ttitle: data.options?.status?.description ?? data.title,\n\t\t\t});\n\t\t} else {\n\t\t\tconst uri = \"uri\" in reference ? reference.uri : reference;\n\t\t\tif (\n\t\t\t\turi.scheme === \"https\" &&\n\t\t\t\tisEqualAuthority(uri.authority, \"github.com\") &&\n\t\t\t\turi.path.includes(\"/tree/\")\n\t\t\t) {\n\t\t\t\t// Parse a nicer label for GitHub URIs that point at a particular commit + file\n\t\t\t\tconst label = uri.path.split(\"/\").slice(1, 3).join(\"/\");\n\t\t\t\tconst description = uri.path.split(\"/\").slice(5).join(\"/\");\n\t\t\t\ttemplateData.label.setResource(\n\t\t\t\t\t{ resource: uri, name: label, description },\n\t\t\t\t\t{ icon: Codicon.github, title: data.title },\n\t\t\t\t);\n\t\t\t} else if (\n\t\t\t\turi.scheme === this.productService.urlProtocol &&\n\t\t\t\tisEqualAuthority(uri.authority, SETTINGS_AUTHORITY)\n\t\t\t) {\n\t\t\t\t// a nicer label for settings URIs\n\t\t\t\tconst settingId = uri.path.substring(1);\n\t\t\t\ttemplateData.label.setResource(\n\t\t\t\t\t{ resource: uri, name: settingId },\n\t\t\t\t\t{\n\t\t\t\t\t\ticon: Codicon.settingsGear,\n\t\t\t\t\t\ttitle: localize(\n\t\t\t\t\t\t\t\"setting.hover\",\n\t\t\t\t\t\t\t\"Open setting '{0}'\",\n\t\t\t\t\t\t\tsettingId,\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t} else if (\n\t\t\t\tmatchesSomeScheme(\n\t\t\t\t\turi,\n\t\t\t\t\tSchemas.mailto,\n\t\t\t\t\tSchemas.http,\n\t\t\t\t\tSchemas.https,\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\ttemplateData.label.setResource(\n\t\t\t\t\t{ resource: uri, name: uri.toString() },\n\t\t\t\t\t{\n\t\t\t\t\t\ticon: icon ?? Codicon.globe,\n\t\t\t\t\t\ttitle:\n\t\t\t\t\t\t\tdata.options?.status?.description ??\n\t\t\t\t\t\t\tdata.title ??\n\t\t\t\t\t\t\turi.toString(),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttemplateData.label.setFile(uri, {\n\t\t\t\t\tfileKind: FileKind.FILE,\n\t\t\t\t\t// Should not have this live-updating data on a historical reference\n\t\t\t\t\tfileDecorations: { badges: false, colors: false },\n\t\t\t\t\trange: \"range\" in reference ? reference.range : undefined,\n\t\t\t\t\ttitle: data.options?.status?.description ?? data.title,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfor (const selector of [\n\t\t\t\".monaco-icon-suffix-container\",\n\t\t\t\".monaco-icon-name-container\",\n\t\t]) {\n\t\t\tconst element = templateData.label.element.querySelector(selector);\n\t\t\tif (element) {\n\t\t\t\tif (\n\t\t\t\t\tdata.options?.status?.kind ===\n\t\t\t\t\t\tChatResponseReferencePartStatusKind.Omitted ||\n\t\t\t\t\tdata.options?.status?.kind ===\n\t\t\t\t\t\tChatResponseReferencePartStatusKind.Partial\n\t\t\t\t) {\n\t\t\t\t\telement.classList.add(\"warning\");\n\t\t\t\t} else {\n\t\t\t\t\telement.classList.remove(\"warning\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdisposeTemplate(templateData: ICollapsibleListTemplate): void {\n\t\ttemplateData.templateDisposables.dispose();\n\t}\n}\n"],
  "mappings": "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",
  "names": ["element"]
}
