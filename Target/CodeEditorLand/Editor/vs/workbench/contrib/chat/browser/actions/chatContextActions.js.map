{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { KeyCode, KeyMod } from '../../../../../base/common/keyCodes.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { compare } from '../../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { IRange } from '../../../../../editor/common/core/range.js';\nimport { EditorType } from '../../../../../editor/common/editorCommon.js';\nimport { Command } from '../../../../../editor/common/languages.js';\nimport { AbstractGotoSymbolQuickAccessProvider, IGotoSymbolQuickPickItem } from '../../../../../editor/contrib/quickAccess/browser/gotoSymbolQuickAccess.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2, MenuId, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { KeybindingWeight } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { AnythingQuickAccessProviderRunOptions } from '../../../../../platform/quickinput/common/quickAccess.js';\nimport { IQuickInputService, IQuickPickItem, QuickPickItem } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { CHAT_CATEGORY } from './chatActions.js';\nimport { IChatWidget, IChatWidgetService, IQuickChatService } from '../chat.js';\nimport { isQuickChat } from '../chatWidget.js';\nimport { ChatContextAttachments } from '../contrib/chatContextAttachments.js';\nimport { ChatAgentLocation, IChatAgentService } from '../../common/chatAgents.js';\nimport { CONTEXT_CHAT_LOCATION, CONTEXT_IN_CHAT_INPUT } from '../../common/chatContextKeys.js';\nimport { IChatRequestVariableEntry } from '../../common/chatModel.js';\nimport { ChatRequestAgentPart } from '../../common/chatParserTypes.js';\nimport { IChatVariablesService } from '../../common/chatVariables.js';\nimport { ILanguageModelToolsService } from '../../common/languageModelToolsService.js';\nimport { AnythingQuickAccessProvider } from '../../../search/browser/anythingQuickAccess.js';\nimport { ISymbolQuickPickItem, SymbolsQuickAccessProvider } from '../../../search/browser/symbolsQuickAccess.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\n\nexport function registerChatContextActions() {\n\tregisterAction2(AttachContextAction);\n\tregisterAction2(AttachFileAction);\n\tregisterAction2(AttachSelectionAction);\n}\n\nexport type IChatContextQuickPickItem = IFileQuickPickItem | IDynamicVariableQuickPickItem | IStaticVariableQuickPickItem | IGotoSymbolQuickPickItem | ISymbolQuickPickItem | IQuickAccessQuickPickItem | IToolQuickPickItem;\n\nexport interface IFileQuickPickItem extends IQuickPickItem {\n\tkind: 'file';\n\tid: string;\n\tname: string;\n\tvalue: URI;\n\tisDynamic: true;\n\n\tresource: URI;\n}\n\nexport interface IDynamicVariableQuickPickItem extends IQuickPickItem {\n\tkind: 'dynamic';\n\tid: string;\n\tname?: string;\n\tvalue: unknown;\n\tisDynamic: true;\n\n\ticon?: ThemeIcon;\n\tcommand?: Command;\n}\n\nexport interface IToolQuickPickItem extends IQuickPickItem {\n\tkind: 'tool';\n\tid: string;\n\tname?: string;\n\ticon?: ThemeIcon;\n}\n\nexport interface IStaticVariableQuickPickItem extends IQuickPickItem {\n\tkind: 'static';\n\tid: string;\n\tname: string;\n\tvalue: unknown;\n\tisDynamic?: false;\n\n\ticon?: ThemeIcon;\n}\n\nexport interface IQuickAccessQuickPickItem extends IQuickPickItem {\n\tkind: 'quickaccess';\n\tid: string;\n\tname: string;\n\tvalue: string;\n\n\tprefix: string;\n}\n\nclass AttachFileAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.attachFile';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: AttachFileAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.attachFile.label', \"Attach File\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tf1: false\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, ...args: any[]): Promise<void> {\n\t\tconst variablesService = accessor.get(IChatVariablesService);\n\t\tconst textEditorService = accessor.get(IEditorService);\n\n\t\tconst activeUri = textEditorService.activeEditor?.resource;\n\t\tif (textEditorService.activeTextEditorControl?.getEditorType() === EditorType.ICodeEditor && activeUri && [Schemas.file, Schemas.vscodeRemote, Schemas.untitled].includes(activeUri.scheme)) {\n\t\t\tvariablesService.attachContext('file', activeUri, ChatAgentLocation.Panel);\n\t\t}\n\t}\n}\n\nclass AttachSelectionAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.attachSelection';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: AttachSelectionAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.attachSelection.label', \"Add Selection to Chat\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tf1: false\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, ...args: any[]): Promise<void> {\n\t\tconst variablesService = accessor.get(IChatVariablesService);\n\t\tconst textEditorService = accessor.get(IEditorService);\n\n\t\tconst activeEditor = textEditorService.activeTextEditorControl;\n\t\tconst activeUri = textEditorService.activeEditor?.resource;\n\t\tif (textEditorService.activeTextEditorControl?.getEditorType() === EditorType.ICodeEditor && activeUri && [Schemas.file, Schemas.vscodeRemote, Schemas.untitled].includes(activeUri.scheme)) {\n\t\t\tconst selection = activeEditor?.getSelection();\n\t\t\tif (selection) {\n\t\t\t\tvariablesService.attachContext('file', { uri: activeUri, range: selection }, ChatAgentLocation.Panel);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass AttachContextAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.attachContext';\n\n\t// used to enable/disable the keybinding and defined menu containment\n\tprivate static _cdt = ContextKeyExpr.or(\n\t\tContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Panel)),\n\t\tContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Editor), ContextKeyExpr.equals('config.chat.experimental.variables.editor', true)),\n\t\tContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Notebook), ContextKeyExpr.equals('config.chat.experimental.variables.notebook', true)),\n\t\tContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Terminal), ContextKeyExpr.equals('config.chat.experimental.variables.terminal', true)),\n\t);\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: AttachContextAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.attachContext.label', \"Attach Context\"),\n\t\t\ticon: Codicon.attach,\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tprecondition: AttachContextAction._cdt,\n\t\t\tkeybinding: {\n\t\t\t\twhen: CONTEXT_IN_CHAT_INPUT,\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Slash,\n\t\t\t\tweight: KeybindingWeight.EditorContrib\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\twhen: AttachContextAction._cdt,\n\t\t\t\t\tid: MenuId.ChatExecute,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t},\n\t\t\t]\n\t\t});\n\t}\n\n\tprivate _getFileContextId(item: { resource: URI } | { uri: URI; range: IRange }) {\n\t\tif ('resource' in item) {\n\t\t\treturn item.resource.toString();\n\t\t}\n\n\t\treturn item.uri.toString() + (item.range.startLineNumber !== item.range.endLineNumber ?\n\t\t\t`:${item.range.startLineNumber}-${item.range.endLineNumber}` :\n\t\t\t`:${item.range.startLineNumber}`);\n\t}\n\n\tprivate async _attachContext(widget: IChatWidget, commandService: ICommandService, ...picks: IChatContextQuickPickItem[]) {\n\t\tconst toAttach: IChatRequestVariableEntry[] = [];\n\t\tfor (const pick of picks) {\n\t\t\tif (pick && typeof pick === 'object' && 'command' in pick && pick.command) {\n\t\t\t\t// Dynamic variable with a followup command\n\t\t\t\tconst selection = await commandService.executeCommand(pick.command.id, ...(pick.command.arguments ?? []));\n\t\t\t\tif (!selection) {\n\t\t\t\t\t// User made no selection, skip this variable\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\ttoAttach.push({\n\t\t\t\t\t...pick,\n\t\t\t\t\tisDynamic: pick.isDynamic,\n\t\t\t\t\tvalue: pick.value,\n\t\t\t\t\tname: `${typeof pick.value === 'string' && pick.value.startsWith('#') ? pick.value.slice(1) : ''}${selection}`,\n\t\t\t\t\t// Apply the original icon with the new name\n\t\t\t\t\tfullName: selection\n\t\t\t\t});\n\t\t\t} else if ('symbol' in pick && pick.symbol) {\n\t\t\t\t// Symbol\n\t\t\t\ttoAttach.push({\n\t\t\t\t\t...pick,\n\t\t\t\t\tid: this._getFileContextId(pick.symbol.location),\n\t\t\t\t\tvalue: pick.symbol.location,\n\t\t\t\t\tfullName: pick.label,\n\t\t\t\t\tname: pick.symbol.name,\n\t\t\t\t\tisDynamic: true\n\t\t\t\t});\n\t\t\t} else if (pick && typeof pick === 'object' && 'resource' in pick && pick.resource) {\n\t\t\t\t// #file variable\n\t\t\t\ttoAttach.push({\n\t\t\t\t\t...pick,\n\t\t\t\t\tid: this._getFileContextId({ resource: pick.resource }),\n\t\t\t\t\tvalue: pick.resource,\n\t\t\t\t\tname: pick.label,\n\t\t\t\t\tisFile: true,\n\t\t\t\t\tisDynamic: true\n\t\t\t\t});\n\t\t\t} else if ('symbolName' in pick && pick.uri && pick.range) {\n\t\t\t\t// Symbol\n\t\t\t\ttoAttach.push({\n\t\t\t\t\t...pick,\n\t\t\t\t\trange: undefined,\n\t\t\t\t\tid: this._getFileContextId({ uri: pick.uri, range: pick.range.decoration }),\n\t\t\t\t\tvalue: { uri: pick.uri, range: pick.range.decoration },\n\t\t\t\t\tfullName: pick.label,\n\t\t\t\t\tname: pick.symbolName!,\n\t\t\t\t\tisDynamic: true\n\t\t\t\t});\n\t\t\t} else if ('kind' in pick && pick.kind === 'tool') {\n\t\t\t\ttoAttach.push({\n\t\t\t\t\tid: pick.id,\n\t\t\t\t\tname: pick.label,\n\t\t\t\t\tfullName: pick.label,\n\t\t\t\t\tvalue: undefined,\n\t\t\t\t\ticon: pick.icon,\n\t\t\t\t\tisTool: true\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// All other dynamic variables and static variables\n\t\t\t\ttoAttach.push({\n\t\t\t\t\t...pick,\n\t\t\t\t\trange: undefined,\n\t\t\t\t\tid: pick.id ?? '',\n\t\t\t\t\tvalue: 'value' in pick ? pick.value : undefined,\n\t\t\t\t\tfullName: pick.label,\n\t\t\t\t\tname: 'name' in pick && typeof pick.name === 'string' ? pick.name : pick.label,\n\t\t\t\t\ticon: 'icon' in pick && ThemeIcon.isThemeIcon(pick.icon) ? pick.icon : undefined\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\twidget.getContrib<ChatContextAttachments>(ChatContextAttachments.ID)?.setContext(false, ...toAttach);\n\t}\n\n\toverride async run(accessor: ServicesAccessor, ...args: any[]): Promise<void> {\n\t\tconst quickInputService = accessor.get(IQuickInputService);\n\t\tconst chatAgentService = accessor.get(IChatAgentService);\n\t\tconst chatVariablesService = accessor.get(IChatVariablesService);\n\t\tconst commandService = accessor.get(ICommandService);\n\t\tconst widgetService = accessor.get(IChatWidgetService);\n\t\tconst languageModelToolsService = accessor.get(ILanguageModelToolsService);\n\t\tconst quickChatService = accessor.get(IQuickChatService);\n\t\tconst context: { widget?: IChatWidget } | undefined = args[0];\n\t\tconst widget = context?.widget ?? widgetService.lastFocusedWidget;\n\t\tif (!widget) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst usedAgent = widget.parsedInput.parts.find(p => p instanceof ChatRequestAgentPart);\n\t\tconst slowSupported = usedAgent ? usedAgent.agent.metadata.supportsSlowVariables : true;\n\t\tconst quickPickItems: (IChatContextQuickPickItem | QuickPickItem)[] = [];\n\t\tfor (const variable of chatVariablesService.getVariables(widget.location)) {\n\t\t\tif (variable.fullName && (!variable.isSlow || slowSupported)) {\n\t\t\t\tquickPickItems.push({\n\t\t\t\t\tlabel: variable.fullName,\n\t\t\t\t\tname: variable.name,\n\t\t\t\t\tid: variable.id,\n\t\t\t\t\ticonClass: variable.icon ? ThemeIcon.asClassName(variable.icon) : undefined,\n\t\t\t\t\ticon: variable.icon\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (widget.viewModel?.sessionId) {\n\t\t\tconst agentPart = widget.parsedInput.parts.find((part): part is ChatRequestAgentPart => part instanceof ChatRequestAgentPart);\n\t\t\tif (agentPart) {\n\t\t\t\tconst completions = await chatAgentService.getAgentCompletionItems(agentPart.agent.id, '', CancellationToken.None);\n\t\t\t\tfor (const variable of completions) {\n\t\t\t\t\tif (variable.fullName) {\n\t\t\t\t\t\tquickPickItems.push({\n\t\t\t\t\t\t\tlabel: variable.fullName,\n\t\t\t\t\t\t\tid: variable.id,\n\t\t\t\t\t\t\tcommand: variable.command,\n\t\t\t\t\t\t\ticon: variable.icon,\n\t\t\t\t\t\t\ticonClass: variable.icon ? ThemeIcon.asClassName(variable.icon) : undefined,\n\t\t\t\t\t\t\tvalue: variable.value,\n\t\t\t\t\t\t\tisDynamic: true,\n\t\t\t\t\t\t\tname: variable.name\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!usedAgent || usedAgent.agent.supportsToolReferences) {\n\t\t\tfor (const tool of languageModelToolsService.getTools()) {\n\t\t\t\tif (tool.canBeInvokedManually) {\n\t\t\t\t\tconst item: IToolQuickPickItem = {\n\t\t\t\t\t\tkind: 'tool',\n\t\t\t\t\t\tlabel: tool.displayName ?? tool.name ?? '',\n\t\t\t\t\t\tid: tool.id,\n\t\t\t\t\t\ticon: ThemeIcon.isThemeIcon(tool.icon) ? tool.icon : undefined // TODO need to support icon path?\n\t\t\t\t\t};\n\t\t\t\t\tif (ThemeIcon.isThemeIcon(tool.icon)) {\n\t\t\t\t\t\titem.iconClass = ThemeIcon.asClassName(tool.icon);\n\t\t\t\t\t} else if (tool.icon) {\n\t\t\t\t\t\titem.iconPath = tool.icon;\n\t\t\t\t\t}\n\n\t\t\t\t\tquickPickItems.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tquickPickItems.push({\n\t\t\tlabel: localize('chatContext.symbol', 'Symbol...'),\n\t\t\ticon: ThemeIcon.fromId(Codicon.symbolField.id),\n\t\t\ticonClass: ThemeIcon.asClassName(Codicon.symbolField),\n\t\t\tprefix: SymbolsQuickAccessProvider.PREFIX\n\t\t});\n\n\t\tfunction extractTextFromIconLabel(label: string | undefined): string {\n\t\t\tif (!label) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tconst match = label.match(/\\$\\([^\\)]+\\)\\s*(.+)/);\n\t\t\treturn match ? match[1] : label;\n\t\t}\n\n\t\tthis._show(quickInputService, commandService, widget, quickChatService, quickPickItems.sort(function (a, b) {\n\n\t\t\tconst first = extractTextFromIconLabel(a.label).toUpperCase();\n\t\t\tconst second = extractTextFromIconLabel(b.label).toUpperCase();\n\n\t\t\treturn compare(first, second);\n\t\t}));\n\t}\n\n\tprivate _show(quickInputService: IQuickInputService, commandService: ICommandService, widget: IChatWidget, quickChatService: IQuickChatService, quickPickItems: (IChatContextQuickPickItem | QuickPickItem)[], query: string = '') {\n\n\t\tquickInputService.quickAccess.show(query, {\n\t\t\tenabledProviderPrefixes: [\n\t\t\t\tAnythingQuickAccessProvider.PREFIX,\n\t\t\t\tSymbolsQuickAccessProvider.PREFIX,\n\t\t\t\tAbstractGotoSymbolQuickAccessProvider.PREFIX\n\t\t\t],\n\t\t\tplaceholder: localize('chatContext.attach.placeholder', 'Search attachments'),\n\t\t\tproviderOptions: <AnythingQuickAccessProviderRunOptions>{\n\t\t\t\thandleAccept: (item: IChatContextQuickPickItem) => {\n\t\t\t\t\tif ('prefix' in item) {\n\t\t\t\t\t\tthis._show(quickInputService, commandService, widget, quickChatService, quickPickItems, item.prefix);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._attachContext(widget, commandService, item);\n\t\t\t\t\t\tif (isQuickChat(widget)) {\n\t\t\t\t\t\t\tquickChatService.open();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tadditionPicks: quickPickItems,\n\t\t\t\tfilter: (item: IChatContextQuickPickItem) => {\n\t\t\t\t\t// Avoid attaching the same context twice\n\t\t\t\t\tconst attachedContext = widget.getContrib<ChatContextAttachments>(ChatContextAttachments.ID)?.getContext() ?? new Set();\n\n\t\t\t\t\tif ('symbol' in item && item.symbol) {\n\t\t\t\t\t\treturn !attachedContext.has(this._getFileContextId(item.symbol.location));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item && typeof item === 'object' && 'resource' in item && URI.isUri(item.resource)) {\n\t\t\t\t\t\treturn [Schemas.file, Schemas.vscodeRemote].includes(item.resource.scheme)\n\t\t\t\t\t\t\t&& !attachedContext.has(this._getFileContextId({ resource: item.resource })); // Hack because Typescript doesn't narrow this type correctly\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item && typeof item === 'object' && 'uri' in item && item.uri && item.range) {\n\t\t\t\t\t\treturn !attachedContext.has(this._getFileContextId({ uri: item.uri, range: item.range.decoration }));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!('command' in item) && item.id) {\n\t\t\t\t\t\treturn !attachedContext.has(item.id);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Don't filter out dynamic variables which show secondary data (temporary)\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
