var g=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var c=(s,r,e,t)=>{for(var i=t>1?void 0:t?d(r,e):r,n=s.length-1,a;n>=0;n--)(a=s[n])&&(i=(t?a(r,e,i):a(i))||i);return t&&i&&g(r,e,i),i},o=(s,r)=>(e,t)=>r(e,t,s);import{renderStringAsPlaintext as m}from"../../../../base/browser/markdownRenderer.js";import{status as u}from"../../../../base/browser/ui/aria/aria.js";import{MarkdownString as f}from"../../../../base/common/htmlContent.js";import{Disposable as I,DisposableMap as v}from"../../../../base/common/lifecycle.js";import{AccessibilitySignal as p,IAccessibilitySignalService as _}from"../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js";import{AccessibilityProgressSignalScheduler as y}from"../../../../platform/accessibilitySignal/browser/progressAccessibilitySignalScheduler.js";import{IConfigurationService as h}from"../../../../platform/configuration/common/configuration.js";import{IInstantiationService as b}from"../../../../platform/instantiation/common/instantiation.js";import{AccessibilityVoiceSettingId as A}from"../../accessibility/browser/accessibilityConfiguration.js";import"../common/chatViewModel.js";import"./chat.js";const M=4e3;let l=class extends I{constructor(e,t,i){super();this._accessibilitySignalService=e;this._instantiationService=t;this._configurationService=i}_pendingSignalMap=this._register(new v);_requestId=0;acceptRequest(){return this._requestId++,this._accessibilitySignalService.playSignal(p.chatRequestSent,{allowManyInParallel:!0}),this._pendingSignalMap.set(this._requestId,this._instantiationService.createInstance(y,M,void 0)),this._requestId}acceptResponse(e,t){this._pendingSignalMap.deleteAndDispose(t);const i=typeof e!="string",n=typeof e=="string"?e:e?.response.toString();if(this._accessibilitySignalService.playSignal(p.chatResponseReceived,{allowManyInParallel:!0}),!e||!n)return;const a=i&&e.errorDetails?` ${e.errorDetails.message}`:"",S=m(new f(n));this._configurationService.getValue(A.AutoSynthesize)!=="on"&&u(S+a)}};l=c([o(0,_),o(1,b),o(2,h)],l);export{l as ChatAccessibilityService};
