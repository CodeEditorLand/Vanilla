{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/chatInputPart.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport { DEFAULT_FONT_FAMILY } from \"../../../../base/browser/fonts.js\";\nimport type { IHistoryNavigationWidget } from \"../../../../base/browser/history.js\";\nimport { StandardKeyboardEvent } from \"../../../../base/browser/keyboardEvent.js\";\nimport * as aria from \"../../../../base/browser/ui/aria/aria.js\";\nimport { Button } from \"../../../../base/browser/ui/button/button.js\";\nimport type { IAction } from \"../../../../base/common/actions.js\";\nimport { Codicon } from \"../../../../base/common/codicons.js\";\nimport { Emitter } from \"../../../../base/common/event.js\";\nimport { HistoryNavigator2 } from \"../../../../base/common/history.js\";\nimport { KeyCode } from \"../../../../base/common/keyCodes.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n} from \"../../../../base/common/lifecycle.js\";\nimport { basename, dirname } from \"../../../../base/common/path.js\";\nimport { isMacintosh } from \"../../../../base/common/platform.js\";\nimport { URI } from \"../../../../base/common/uri.js\";\nimport type { IEditorConstructionOptions } from \"../../../../editor/browser/config/editorConfiguration.js\";\nimport { EditorExtensionsRegistry } from \"../../../../editor/browser/editorExtensions.js\";\nimport { CodeEditorWidget } from \"../../../../editor/browser/widget/codeEditor/codeEditorWidget.js\";\nimport type { IDimension } from \"../../../../editor/common/core/dimension.js\";\nimport type { IPosition } from \"../../../../editor/common/core/position.js\";\nimport { Range } from \"../../../../editor/common/core/range.js\";\nimport type { ITextModel } from \"../../../../editor/common/model.js\";\nimport { IModelService } from \"../../../../editor/common/services/model.js\";\nimport { ContentHoverController } from \"../../../../editor/contrib/hover/browser/contentHoverController.js\";\nimport { GlyphHoverController } from \"../../../../editor/contrib/hover/browser/glyphHoverController.js\";\nimport { localize } from \"../../../../nls.js\";\nimport { IAccessibilityService } from \"../../../../platform/accessibility/common/accessibility.js\";\nimport { DropdownWithPrimaryActionViewItem } from \"../../../../platform/actions/browser/dropdownWithPrimaryActionViewItem.js\";\nimport { createAndFillInActionBarActions } from \"../../../../platform/actions/browser/menuEntryActionViewItem.js\";\nimport {\n\tHiddenItemStrategy,\n\tMenuWorkbenchToolBar,\n} from \"../../../../platform/actions/browser/toolbar.js\";\nimport {\n\tIMenuService,\n\tMenuId,\n\tMenuItemAction,\n} from \"../../../../platform/actions/common/actions.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport {\n\ttype IContextKey,\n\tIContextKeyService,\n} from \"../../../../platform/contextkey/common/contextkey.js\";\nimport { IContextMenuService } from \"../../../../platform/contextview/browser/contextView.js\";\nimport { FileKind } from \"../../../../platform/files/common/files.js\";\nimport { registerAndCreateHistoryNavigationContext } from \"../../../../platform/history/browser/contextScopedHistoryWidget.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { ServiceCollection } from \"../../../../platform/instantiation/common/serviceCollection.js\";\nimport { IKeybindingService } from \"../../../../platform/keybinding/common/keybinding.js\";\nimport { ILogService } from \"../../../../platform/log/common/log.js\";\nimport { INotificationService } from \"../../../../platform/notification/common/notification.js\";\nimport { IThemeService } from \"../../../../platform/theme/common/themeService.js\";\nimport { ResourceLabels } from \"../../../browser/labels.js\";\nimport { AccessibilityVerbositySettingId } from \"../../accessibility/browser/accessibilityConfiguration.js\";\nimport { AccessibilityCommandId } from \"../../accessibility/common/accessibilityCommands.js\";\nimport {\n\tgetSimpleCodeEditorWidgetOptions,\n\tgetSimpleEditorOptions,\n\tsetupSimpleEditorSelectionStyling,\n} from \"../../codeEditor/browser/simpleEditorOptions.js\";\nimport { ChatAgentLocation, IChatAgentService } from \"../common/chatAgents.js\";\nimport {\n\tCONTEXT_CHAT_INPUT_CURSOR_AT_TOP,\n\tCONTEXT_CHAT_INPUT_HAS_FOCUS,\n\tCONTEXT_CHAT_INPUT_HAS_TEXT,\n\tCONTEXT_IN_CHAT_INPUT,\n} from \"../common/chatContextKeys.js\";\nimport type { IChatRequestVariableEntry } from \"../common/chatModel.js\";\nimport type { IChatFollowup } from \"../common/chatService.js\";\nimport type { IChatResponseViewModel } from \"../common/chatViewModel.js\";\nimport {\n\ttype IChatHistoryEntry,\n\tIChatWidgetHistoryService,\n} from \"../common/chatWidgetHistoryService.js\";\nimport {\n\tCancelAction,\n\tChatSubmitSecondaryAgentAction,\n\ttype IChatExecuteActionContext,\n\tSubmitAction,\n} from \"./actions/chatExecuteActions.js\";\nimport type { IChatWidget } from \"./chat.js\";\nimport { ChatFollowups } from \"./chatFollowups.js\";\n\nconst $ = dom.$;\n\nconst INPUT_EDITOR_MAX_HEIGHT = 250;\n\ninterface IChatInputPartOptions {\n\trenderFollowups: boolean;\n\trenderStyle?: \"default\" | \"compact\";\n\tmenus: {\n\t\texecuteToolbar: MenuId;\n\t\tinputSideToolbar?: MenuId;\n\t\ttelemetrySource?: string;\n\t};\n\teditorOverflowWidgetsDomNode?: HTMLElement;\n}\n\nexport class ChatInputPart\n\textends Disposable\n\timplements IHistoryNavigationWidget\n{\n\tstatic readonly INPUT_SCHEME = \"chatSessionInput\";\n\tprivate static _counter = 0;\n\n\tprivate _onDidLoadInputState = this._register(new Emitter<any>());\n\treadonly onDidLoadInputState = this._onDidLoadInputState.event;\n\n\tprivate _onDidChangeHeight = this._register(new Emitter<void>());\n\treadonly onDidChangeHeight = this._onDidChangeHeight.event;\n\n\tprivate _onDidFocus = this._register(new Emitter<void>());\n\treadonly onDidFocus = this._onDidFocus.event;\n\n\tprivate _onDidBlur = this._register(new Emitter<void>());\n\treadonly onDidBlur = this._onDidBlur.event;\n\n\tprivate _onDidChangeContext = this._register(\n\t\tnew Emitter<{\n\t\t\tremoved?: IChatRequestVariableEntry[];\n\t\t\tadded?: IChatRequestVariableEntry[];\n\t\t}>(),\n\t);\n\treadonly onDidChangeContext = this._onDidChangeContext.event;\n\n\tprivate _onDidAcceptFollowup = this._register(\n\t\tnew Emitter<{\n\t\t\tfollowup: IChatFollowup;\n\t\t\tresponse: IChatResponseViewModel | undefined;\n\t\t}>(),\n\t);\n\treadonly onDidAcceptFollowup = this._onDidAcceptFollowup.event;\n\n\tpublic get attachedContext(): ReadonlySet<IChatRequestVariableEntry> {\n\t\treturn this._attachedContext;\n\t}\n\n\tprivate _indexOfLastAttachedContextDeletedWithKeyboard = -1;\n\tprivate readonly _attachedContext = new Set<IChatRequestVariableEntry>();\n\n\tprivate readonly _onDidChangeVisibility = this._register(\n\t\tnew Emitter<boolean>(),\n\t);\n\tprivate readonly _contextResourceLabels =\n\t\tthis.instantiationService.createInstance(ResourceLabels, {\n\t\t\tonDidChangeVisibility: this._onDidChangeVisibility.event,\n\t\t});\n\n\tprivate readonly inputEditorMaxHeight: number;\n\tprivate inputEditorHeight = 0;\n\tprivate container!: HTMLElement;\n\n\tprivate inputSideToolbarContainer?: HTMLElement;\n\n\tprivate followupsContainer!: HTMLElement;\n\tprivate readonly followupsDisposables = this._register(\n\t\tnew DisposableStore(),\n\t);\n\n\tprivate attachedContextContainer!: HTMLElement;\n\tprivate readonly attachedContextDisposables = this._register(\n\t\tnew DisposableStore(),\n\t);\n\n\tprivate _inputPartHeight = 0;\n\tget inputPartHeight() {\n\t\treturn this._inputPartHeight;\n\t}\n\n\tprivate _inputEditor!: CodeEditorWidget;\n\tprivate _inputEditorElement!: HTMLElement;\n\n\tprivate toolbar!: MenuWorkbenchToolBar;\n\n\tget inputEditor() {\n\t\treturn this._inputEditor;\n\t}\n\n\tprivate history: HistoryNavigator2<IChatHistoryEntry>;\n\tprivate historyNavigationBackwardsEnablement!: IContextKey<boolean>;\n\tprivate historyNavigationForewardsEnablement!: IContextKey<boolean>;\n\tprivate inHistoryNavigation = false;\n\tprivate inputModel: ITextModel | undefined;\n\tprivate inputEditorHasText: IContextKey<boolean>;\n\tprivate chatCursorAtTop: IContextKey<boolean>;\n\tprivate inputEditorHasFocus: IContextKey<boolean>;\n\n\tprivate cachedDimensions: dom.Dimension | undefined;\n\tprivate cachedToolbarWidth: number | undefined;\n\n\treadonly inputUri = URI.parse(\n\t\t`${ChatInputPart.INPUT_SCHEME}:input-${ChatInputPart._counter++}`,\n\t);\n\n\tconstructor(\n\t\t// private readonly editorOptions: ChatEditorOptions, // TODO this should be used\n\t\tprivate readonly location: ChatAgentLocation,\n\t\tprivate readonly options: IChatInputPartOptions,\n\t\tprivate readonly getInputState: () => any,\n\t\t@IChatWidgetHistoryService\n\t\tprivate readonly historyService: IChatWidgetHistoryService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@IInstantiationService\n\t\tprivate readonly instantiationService: IInstantiationService,\n\t\t@IContextKeyService\n\t\tprivate readonly contextKeyService: IContextKeyService,\n\t\t@IConfigurationService\n\t\tprivate readonly configurationService: IConfigurationService,\n\t\t@IKeybindingService\n\t\tprivate readonly keybindingService: IKeybindingService,\n\t\t@IAccessibilityService\n\t\tprivate readonly accessibilityService: IAccessibilityService,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper();\n\n\t\tthis.inputEditorMaxHeight =\n\t\t\tthis.options.renderStyle === \"compact\"\n\t\t\t\t? INPUT_EDITOR_MAX_HEIGHT / 3\n\t\t\t\t: INPUT_EDITOR_MAX_HEIGHT;\n\n\t\tthis.inputEditorHasText =\n\t\t\tCONTEXT_CHAT_INPUT_HAS_TEXT.bindTo(contextKeyService);\n\t\tthis.chatCursorAtTop =\n\t\t\tCONTEXT_CHAT_INPUT_CURSOR_AT_TOP.bindTo(contextKeyService);\n\t\tthis.inputEditorHasFocus =\n\t\t\tCONTEXT_CHAT_INPUT_HAS_FOCUS.bindTo(contextKeyService);\n\n\t\tthis.history = this.loadHistory();\n\t\tthis._register(\n\t\t\tthis.historyService.onDidClearHistory(\n\t\t\t\t() =>\n\t\t\t\t\t(this.history = new HistoryNavigator2(\n\t\t\t\t\t\t[{ text: \"\" }],\n\t\t\t\t\t\t50,\n\t\t\t\t\t\thistoryKeyFn,\n\t\t\t\t\t)),\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis.configurationService.onDidChangeConfiguration((e) => {\n\t\t\t\tif (\n\t\t\t\t\te.affectsConfiguration(AccessibilityVerbositySettingId.Chat)\n\t\t\t\t) {\n\t\t\t\t\tthis.inputEditor.updateOptions({\n\t\t\t\t\t\tariaLabel: this._getAriaLabel(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t}\n\n\tprivate loadHistory(): HistoryNavigator2<IChatHistoryEntry> {\n\t\tconst history = this.historyService.getHistory(this.location);\n\t\tif (history.length === 0) {\n\t\t\thistory.push({ text: \"\" });\n\t\t}\n\n\t\treturn new HistoryNavigator2(history, 50, historyKeyFn);\n\t}\n\n\tprivate _getAriaLabel(): string {\n\t\tconst verbose = this.configurationService.getValue<boolean>(\n\t\t\tAccessibilityVerbositySettingId.Chat,\n\t\t);\n\t\tif (verbose) {\n\t\t\tconst kbLabel = this.keybindingService\n\t\t\t\t.lookupKeybinding(AccessibilityCommandId.OpenAccessibilityHelp)\n\t\t\t\t?.getLabel();\n\t\t\treturn kbLabel\n\t\t\t\t? localize(\n\t\t\t\t\t\t\"actions.chat.accessibiltyHelp\",\n\t\t\t\t\t\t\"Chat Input,  Type to ask questions or type / for topics, press enter to send out the request. Use {0} for Chat Accessibility Help.\",\n\t\t\t\t\t\tkbLabel,\n\t\t\t\t\t)\n\t\t\t\t: localize(\n\t\t\t\t\t\t\"chatInput.accessibilityHelpNoKb\",\n\t\t\t\t\t\t\"Chat Input,  Type code here and press Enter to run. Use the Chat Accessibility Help command for more information.\",\n\t\t\t\t\t);\n\t\t}\n\t\treturn localize(\"chatInput\", \"Chat Input\");\n\t}\n\n\tupdateState(inputState: Object): void {\n\t\tif (this.inHistoryNavigation) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst newEntry = {\n\t\t\ttext: this._inputEditor.getValue(),\n\t\t\tstate: inputState,\n\t\t};\n\n\t\tif (this.history.isAtEnd()) {\n\t\t\t// The last history entry should always be the current input value\n\t\t\tthis.history.replaceLast(newEntry);\n\t\t} else {\n\t\t\t// Added a reference while in the middle of history navigation, it's a new entry\n\t\t\tthis.history.replaceLast(newEntry);\n\t\t\tthis.history.resetCursor();\n\t\t}\n\t}\n\n\tinitForNewChatModel(\n\t\tinputValue: string | undefined,\n\t\tinputState: Object,\n\t): void {\n\t\tthis.history = this.loadHistory();\n\t\tthis.history.add({\n\t\t\ttext: inputValue ?? this.history.current().text,\n\t\t\tstate: inputState,\n\t\t});\n\n\t\tif (inputValue) {\n\t\t\tthis.setValue(inputValue, false);\n\t\t}\n\t}\n\n\tlogInputHistory(): void {\n\t\tconst historyStr = [...this.history]\n\t\t\t.map((entry) => JSON.stringify(entry))\n\t\t\t.join(\"\\n\");\n\t\tthis.logService.info(\n\t\t\t`[${this.location}] Chat input history:`,\n\t\t\thistoryStr,\n\t\t);\n\t}\n\n\tsetVisible(visible: boolean): void {\n\t\tthis._onDidChangeVisibility.fire(visible);\n\t}\n\n\tget element(): HTMLElement {\n\t\treturn this.container;\n\t}\n\n\tshowPreviousValue(): void {\n\t\tconst inputState = this.getInputState();\n\t\tif (this.history.isAtEnd()) {\n\t\t\tthis.saveCurrentValue(inputState);\n\t\t} else if (\n\t\t\t!this.history.has({\n\t\t\t\ttext: this._inputEditor.getValue(),\n\t\t\t\tstate: inputState,\n\t\t\t})\n\t\t) {\n\t\t\tthis.saveCurrentValue(inputState);\n\t\t\tthis.history.resetCursor();\n\t\t}\n\n\t\tthis.navigateHistory(true);\n\t}\n\n\tshowNextValue(): void {\n\t\tconst inputState = this.getInputState();\n\t\tif (this.history.isAtEnd()) {\n\t\t\treturn;\n\t\t} else if (\n\t\t\t!this.history.has({\n\t\t\t\ttext: this._inputEditor.getValue(),\n\t\t\t\tstate: inputState,\n\t\t\t})\n\t\t) {\n\t\t\tthis.saveCurrentValue(inputState);\n\t\t\tthis.history.resetCursor();\n\t\t}\n\n\t\tthis.navigateHistory(false);\n\t}\n\n\tprivate navigateHistory(previous: boolean): void {\n\t\tconst historyEntry = previous\n\t\t\t? this.history.previous()\n\t\t\t: this.history.next();\n\n\t\taria.status(historyEntry.text);\n\n\t\tthis.inHistoryNavigation = true;\n\t\tthis.setValue(historyEntry.text, true);\n\t\tthis.inHistoryNavigation = false;\n\n\t\tthis._onDidLoadInputState.fire(historyEntry.state);\n\t\tif (previous) {\n\t\t\tthis._inputEditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t} else {\n\t\t\tconst model = this._inputEditor.getModel();\n\t\t\tif (!model) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._inputEditor.setPosition(getLastPosition(model));\n\t\t}\n\t}\n\n\tsetValue(value: string, transient: boolean): void {\n\t\tthis.inputEditor.setValue(value);\n\t\t// always leave cursor at the end\n\t\tthis.inputEditor.setPosition({\n\t\t\tlineNumber: 1,\n\t\t\tcolumn: value.length + 1,\n\t\t});\n\n\t\tif (!transient) {\n\t\t\tthis.saveCurrentValue(this.getInputState());\n\t\t}\n\t}\n\n\tprivate saveCurrentValue(inputState: any): void {\n\t\tconst newEntry = {\n\t\t\ttext: this._inputEditor.getValue(),\n\t\t\tstate: inputState,\n\t\t};\n\t\tthis.history.replaceLast(newEntry);\n\t}\n\n\tfocus() {\n\t\tthis._inputEditor.focus();\n\t}\n\n\thasFocus(): boolean {\n\t\treturn this._inputEditor.hasWidgetFocus();\n\t}\n\n\t/**\n\t * Reset the input and update history.\n\t * @param userQuery If provided, this will be added to the history. Followups and programmatic queries should not be passed.\n\t */\n\tasync acceptInput(isUserQuery?: boolean): Promise<void> {\n\t\tif (isUserQuery) {\n\t\t\tconst userQuery = this._inputEditor.getValue();\n\t\t\tconst entry: IChatHistoryEntry = {\n\t\t\t\ttext: userQuery,\n\t\t\t\tstate: this.getInputState(),\n\t\t\t};\n\t\t\tthis.history.replaceLast(entry);\n\t\t\tthis.history.add({ text: \"\" });\n\t\t}\n\n\t\t// Clear attached context, fire event to clear input state, and clear the input editor\n\t\tthis._attachedContext.clear();\n\t\tthis._onDidLoadInputState.fire({});\n\t\tif (\n\t\t\tthis.accessibilityService.isScreenReaderOptimized() &&\n\t\t\tisMacintosh\n\t\t) {\n\t\t\tthis._acceptInputForVoiceover();\n\t\t} else {\n\t\t\tthis._inputEditor.focus();\n\t\t\tthis._inputEditor.setValue(\"\");\n\t\t}\n\t}\n\n\tprivate _acceptInputForVoiceover(): void {\n\t\tconst domNode = this._inputEditor.getDomNode();\n\t\tif (!domNode) {\n\t\t\treturn;\n\t\t}\n\t\t// Remove the input editor from the DOM temporarily to prevent VoiceOver\n\t\t// from reading the cleared text (the request) to the user.\n\t\tdomNode.remove();\n\t\tthis._inputEditor.setValue(\"\");\n\t\tthis._inputEditorElement.appendChild(domNode);\n\t\tthis._inputEditor.focus();\n\t}\n\n\tattachContext(\n\t\toverwrite: boolean,\n\t\t...contentReferences: IChatRequestVariableEntry[]\n\t): void {\n\t\tconst removed = [];\n\t\tif (overwrite) {\n\t\t\tremoved.push(...Array.from(this._attachedContext));\n\t\t\tthis._attachedContext.clear();\n\t\t}\n\n\t\tif (contentReferences.length > 0) {\n\t\t\tfor (const reference of contentReferences) {\n\t\t\t\tthis._attachedContext.add(reference);\n\t\t\t}\n\t\t}\n\n\t\tif (removed.length > 0 || contentReferences.length > 0) {\n\t\t\tthis.initAttachedContext(this.attachedContextContainer);\n\n\t\t\tif (!overwrite) {\n\t\t\t\tthis._onDidChangeContext.fire({\n\t\t\t\t\tremoved,\n\t\t\t\t\tadded: contentReferences,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\trender(container: HTMLElement, initialValue: string, widget: IChatWidget) {\n\t\tthis.container = dom.append(container, $(\".interactive-input-part\"));\n\t\tthis.container.classList.toggle(\n\t\t\t\"compact\",\n\t\t\tthis.options.renderStyle === \"compact\",\n\t\t);\n\n\t\tlet inputContainer: HTMLElement;\n\t\tlet inputAndSideToolbar: HTMLElement;\n\t\tif (this.options.renderStyle === \"compact\") {\n\t\t\tinputAndSideToolbar = dom.append(\n\t\t\t\tthis.container,\n\t\t\t\t$(\".interactive-input-and-side-toolbar\"),\n\t\t\t);\n\t\t\tthis.followupsContainer = dom.append(\n\t\t\t\tthis.container,\n\t\t\t\t$(\".interactive-input-followups\"),\n\t\t\t);\n\t\t\tinputContainer = dom.append(\n\t\t\t\tinputAndSideToolbar,\n\t\t\t\t$(\".interactive-input-and-execute-toolbar\"),\n\t\t\t);\n\t\t\tthis.attachedContextContainer = dom.append(\n\t\t\t\tthis.container,\n\t\t\t\t$(\".chat-attached-context\"),\n\t\t\t);\n\t\t} else {\n\t\t\tthis.followupsContainer = dom.append(\n\t\t\t\tthis.container,\n\t\t\t\t$(\".interactive-input-followups\"),\n\t\t\t);\n\t\t\tthis.attachedContextContainer = dom.append(\n\t\t\t\tthis.container,\n\t\t\t\t$(\".chat-attached-context\"),\n\t\t\t);\n\t\t\tinputAndSideToolbar = dom.append(\n\t\t\t\tthis.container,\n\t\t\t\t$(\".interactive-input-and-side-toolbar\"),\n\t\t\t);\n\t\t\tinputContainer = dom.append(\n\t\t\t\tinputAndSideToolbar,\n\t\t\t\t$(\".interactive-input-and-execute-toolbar\"),\n\t\t\t);\n\t\t}\n\t\tthis.initAttachedContext(this.attachedContextContainer);\n\n\t\tconst inputScopedContextKeyService = this._register(\n\t\t\tthis.contextKeyService.createScoped(inputContainer),\n\t\t);\n\t\tCONTEXT_IN_CHAT_INPUT.bindTo(inputScopedContextKeyService).set(true);\n\t\tconst scopedInstantiationService = this._register(\n\t\t\tthis.instantiationService.createChild(\n\t\t\t\tnew ServiceCollection([\n\t\t\t\t\tIContextKeyService,\n\t\t\t\t\tinputScopedContextKeyService,\n\t\t\t\t]),\n\t\t\t),\n\t\t);\n\n\t\tconst {\n\t\t\thistoryNavigationBackwardsEnablement,\n\t\t\thistoryNavigationForwardsEnablement,\n\t\t} = this._register(\n\t\t\tregisterAndCreateHistoryNavigationContext(\n\t\t\t\tinputScopedContextKeyService,\n\t\t\t\tthis,\n\t\t\t),\n\t\t);\n\t\tthis.historyNavigationBackwardsEnablement =\n\t\t\thistoryNavigationBackwardsEnablement;\n\t\tthis.historyNavigationForewardsEnablement =\n\t\t\thistoryNavigationForwardsEnablement;\n\n\t\tconst options: IEditorConstructionOptions = getSimpleEditorOptions(\n\t\t\tthis.configurationService,\n\t\t);\n\t\toptions.overflowWidgetsDomNode =\n\t\t\tthis.options.editorOverflowWidgetsDomNode;\n\t\toptions.readOnly = false;\n\t\toptions.ariaLabel = this._getAriaLabel();\n\t\toptions.fontFamily = DEFAULT_FONT_FAMILY;\n\t\toptions.fontSize = 13;\n\t\toptions.lineHeight = 20;\n\t\toptions.padding =\n\t\t\tthis.options.renderStyle === \"compact\"\n\t\t\t\t? { top: 2, bottom: 2 }\n\t\t\t\t: { top: 8, bottom: 8 };\n\t\toptions.cursorWidth = 1;\n\t\toptions.wrappingStrategy = \"advanced\";\n\t\toptions.bracketPairColorization = { enabled: false };\n\t\toptions.suggest = {\n\t\t\tshowIcons: false,\n\t\t\tshowSnippets: false,\n\t\t\tshowWords: true,\n\t\t\tshowStatusBar: false,\n\t\t\tinsertMode: \"replace\",\n\t\t};\n\t\toptions.scrollbar = {\n\t\t\t...(options.scrollbar ?? {}),\n\t\t\tvertical: \"hidden\",\n\t\t};\n\t\toptions.stickyScroll = { enabled: false };\n\n\t\tthis._inputEditorElement = dom.append(\n\t\t\tinputContainer,\n\t\t\t$(chatInputEditorContainerSelector),\n\t\t);\n\t\tconst editorOptions = getSimpleCodeEditorWidgetOptions();\n\t\teditorOptions.contributions?.push(\n\t\t\t...EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tContentHoverController.ID,\n\t\t\t\tGlyphHoverController.ID,\n\t\t\t]),\n\t\t);\n\t\tthis._inputEditor = this._register(\n\t\t\tscopedInstantiationService.createInstance(\n\t\t\t\tCodeEditorWidget,\n\t\t\t\tthis._inputEditorElement,\n\t\t\t\toptions,\n\t\t\t\teditorOptions,\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\tthis._inputEditor.onDidChangeModelContent(() => {\n\t\t\t\tconst currentHeight = Math.min(\n\t\t\t\t\tthis._inputEditor.getContentHeight(),\n\t\t\t\t\tthis.inputEditorMaxHeight,\n\t\t\t\t);\n\t\t\t\tif (currentHeight !== this.inputEditorHeight) {\n\t\t\t\t\tthis.inputEditorHeight = currentHeight;\n\t\t\t\t\tthis._onDidChangeHeight.fire();\n\t\t\t\t}\n\n\t\t\t\tconst model = this._inputEditor.getModel();\n\t\t\t\tconst inputHasText =\n\t\t\t\t\t!!model && model.getValue().trim().length > 0;\n\t\t\t\tthis.inputEditorHasText.set(inputHasText);\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tthis._inputEditor.onDidFocusEditorText(() => {\n\t\t\t\tthis.inputEditorHasFocus.set(true);\n\t\t\t\tthis._onDidFocus.fire();\n\t\t\t\tinputContainer.classList.toggle(\"focused\", true);\n\t\t\t}),\n\t\t);\n\t\tthis._register(\n\t\t\tthis._inputEditor.onDidBlurEditorText(() => {\n\t\t\t\tthis.inputEditorHasFocus.set(false);\n\t\t\t\tinputContainer.classList.toggle(\"focused\", false);\n\n\t\t\t\tthis._onDidBlur.fire();\n\t\t\t}),\n\t\t);\n\n\t\tthis.toolbar = this._register(\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tMenuWorkbenchToolBar,\n\t\t\t\tinputContainer,\n\t\t\t\tthis.options.menus.executeToolbar,\n\t\t\t\t{\n\t\t\t\t\ttelemetrySource: this.options.menus.telemetrySource,\n\t\t\t\t\tmenuOptions: {\n\t\t\t\t\t\tshouldForwardArgs: true,\n\t\t\t\t\t},\n\t\t\t\t\thiddenItemStrategy: HiddenItemStrategy.Ignore, // keep it lean when hiding items and avoid a \"...\" overflow menu\n\t\t\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\t\t\tif (this.location === ChatAgentLocation.Panel) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t(action.id === SubmitAction.ID ||\n\t\t\t\t\t\t\t\t\taction.id === CancelAction.ID) &&\n\t\t\t\t\t\t\t\taction instanceof MenuItemAction\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tconst dropdownAction =\n\t\t\t\t\t\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\t\t\t\t\t\tMenuItemAction,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tid: \"chat.moreExecuteActions\",\n\t\t\t\t\t\t\t\t\t\t\ttitle: localize(\n\t\t\t\t\t\t\t\t\t\t\t\t\"notebook.moreExecuteActionsLabel\",\n\t\t\t\t\t\t\t\t\t\t\t\t\"More...\",\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\ticon: Codicon.chevronDown,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\treturn this.instantiationService.createInstance(\n\t\t\t\t\t\t\t\t\tChatSubmitDropdownActionItem,\n\t\t\t\t\t\t\t\t\taction,\n\t\t\t\t\t\t\t\t\tdropdownAction,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\t\tthis.toolbar.getElement().classList.add(\"interactive-execute-toolbar\");\n\t\tthis.toolbar.context = { widget } satisfies IChatExecuteActionContext;\n\t\tthis._register(\n\t\t\tthis.toolbar.onDidChangeMenuItems(() => {\n\t\t\t\tif (\n\t\t\t\t\tthis.cachedDimensions &&\n\t\t\t\t\ttypeof this.cachedToolbarWidth === \"number\" &&\n\t\t\t\t\tthis.cachedToolbarWidth !== this.toolbar.getItemsWidth()\n\t\t\t\t) {\n\t\t\t\t\tthis.layout(\n\t\t\t\t\t\tthis.cachedDimensions.height,\n\t\t\t\t\t\tthis.cachedDimensions.width,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tif (this.options.menus.inputSideToolbar) {\n\t\t\tconst toolbarSide = this._register(\n\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\tMenuWorkbenchToolBar,\n\t\t\t\t\tinputAndSideToolbar,\n\t\t\t\t\tthis.options.menus.inputSideToolbar,\n\t\t\t\t\t{\n\t\t\t\t\t\ttelemetrySource: this.options.menus.telemetrySource,\n\t\t\t\t\t\tmenuOptions: {\n\t\t\t\t\t\t\tshouldForwardArgs: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis.inputSideToolbarContainer = toolbarSide.getElement();\n\t\t\ttoolbarSide.getElement().classList.add(\"chat-side-toolbar\");\n\t\t\ttoolbarSide.context = {\n\t\t\t\twidget,\n\t\t\t} satisfies IChatExecuteActionContext;\n\t\t}\n\n\t\tlet inputModel = this.modelService.getModel(this.inputUri);\n\t\tif (!inputModel) {\n\t\t\tinputModel = this.modelService.createModel(\n\t\t\t\t\"\",\n\t\t\t\tnull,\n\t\t\t\tthis.inputUri,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\tthis._register(inputModel);\n\t\t}\n\n\t\tthis.inputModel = inputModel;\n\t\tthis.inputModel.updateOptions({\n\t\t\tbracketColorizationOptions: {\n\t\t\t\tenabled: false,\n\t\t\t\tindependentColorPoolPerBracketType: false,\n\t\t\t},\n\t\t});\n\t\tthis._inputEditor.setModel(this.inputModel);\n\t\tif (initialValue) {\n\t\t\tthis.inputModel.setValue(initialValue);\n\t\t\tconst lineNumber = this.inputModel.getLineCount();\n\t\t\tthis._inputEditor.setPosition({\n\t\t\t\tlineNumber,\n\t\t\t\tcolumn: this.inputModel.getLineMaxColumn(lineNumber),\n\t\t\t});\n\t\t}\n\n\t\tconst onDidChangeCursorPosition = () => {\n\t\t\tconst model = this._inputEditor.getModel();\n\t\t\tif (!model) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst position = this._inputEditor.getPosition();\n\t\t\tif (!position) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst atTop = position.column === 1 && position.lineNumber === 1;\n\t\t\tthis.chatCursorAtTop.set(atTop);\n\n\t\t\tthis.historyNavigationBackwardsEnablement.set(atTop);\n\t\t\tthis.historyNavigationForewardsEnablement.set(\n\t\t\t\tposition.equals(getLastPosition(model)),\n\t\t\t);\n\t\t};\n\t\tthis._register(\n\t\t\tthis._inputEditor.onDidChangeCursorPosition((e) =>\n\t\t\t\tonDidChangeCursorPosition(),\n\t\t\t),\n\t\t);\n\t\tonDidChangeCursorPosition();\n\t}\n\n\tprivate initAttachedContext(container: HTMLElement, isLayout = false) {\n\t\tconst oldHeight = container.offsetHeight;\n\t\tdom.clearNode(container);\n\t\tthis.attachedContextDisposables.clear();\n\t\tdom.setVisibility(\n\t\t\tBoolean(this.attachedContext.size),\n\t\t\tthis.attachedContextContainer,\n\t\t);\n\t\tif (!this.attachedContext.size) {\n\t\t\tthis._indexOfLastAttachedContextDeletedWithKeyboard = -1;\n\t\t}\n\t\t[...this.attachedContext.values()].forEach((attachment, index) => {\n\t\t\tconst widget = dom.append(\n\t\t\t\tcontainer,\n\t\t\t\t$(\".chat-attached-context-attachment.show-file-icons\"),\n\t\t\t);\n\t\t\tconst label = this._contextResourceLabels.create(widget, {\n\t\t\t\tsupportIcons: true,\n\t\t\t});\n\t\t\tconst file = URI.isUri(attachment.value)\n\t\t\t\t? attachment.value\n\t\t\t\t: attachment.value &&\n\t\t\t\t\t\ttypeof attachment.value === \"object\" &&\n\t\t\t\t\t\t\"uri\" in attachment.value &&\n\t\t\t\t\t\tURI.isUri(attachment.value.uri)\n\t\t\t\t\t? attachment.value.uri\n\t\t\t\t\t: undefined;\n\t\t\tconst range =\n\t\t\t\tattachment.value &&\n\t\t\t\ttypeof attachment.value === \"object\" &&\n\t\t\t\t\"range\" in attachment.value &&\n\t\t\t\tRange.isIRange(attachment.value.range)\n\t\t\t\t\t? attachment.value.range\n\t\t\t\t\t: undefined;\n\t\t\tif (file && attachment.isFile) {\n\t\t\t\tconst fileBasename = basename(file.path);\n\t\t\t\tconst fileDirname = dirname(file.path);\n\t\t\t\tconst friendlyName = `${fileBasename} ${fileDirname}`;\n\t\t\t\tconst ariaLabel = range\n\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t\"chat.fileAttachmentWithRange\",\n\t\t\t\t\t\t\t\"Attached file, {0}, line {1} to line {2}\",\n\t\t\t\t\t\t\tfriendlyName,\n\t\t\t\t\t\t\trange.startLineNumber,\n\t\t\t\t\t\t\trange.endLineNumber,\n\t\t\t\t\t\t)\n\t\t\t\t\t: localize(\n\t\t\t\t\t\t\t\"chat.fileAttachment\",\n\t\t\t\t\t\t\t\"Attached file, {0}\",\n\t\t\t\t\t\t\tfriendlyName,\n\t\t\t\t\t\t);\n\n\t\t\t\tlabel.setFile(file, {\n\t\t\t\t\tfileKind: FileKind.FILE,\n\t\t\t\t\thidePath: true,\n\t\t\t\t\trange,\n\t\t\t\t});\n\t\t\t\twidget.ariaLabel = ariaLabel;\n\t\t\t\twidget.tabIndex = 0;\n\t\t\t} else {\n\t\t\t\tconst attachmentLabel = attachment.fullName ?? attachment.name;\n\t\t\t\tconst withIcon = attachment.icon?.id\n\t\t\t\t\t? `$(${attachment.icon.id}) ${attachmentLabel}`\n\t\t\t\t\t: attachmentLabel;\n\t\t\t\tlabel.setLabel(withIcon, undefined);\n\n\t\t\t\twidget.ariaLabel = localize(\n\t\t\t\t\t\"chat.attachment\",\n\t\t\t\t\t\"Attached context, {0}\",\n\t\t\t\t\tattachment.name,\n\t\t\t\t);\n\t\t\t\twidget.tabIndex = 0;\n\t\t\t}\n\n\t\t\tconst clearButton = new Button(widget, { supportIcons: true });\n\n\t\t\t// If this item is rendering in place of the last attached context item, focus the clear button so the user can continue deleting attached context items with the keyboard\n\t\t\tif (\n\t\t\t\tindex ===\n\t\t\t\tMath.min(\n\t\t\t\t\tthis._indexOfLastAttachedContextDeletedWithKeyboard,\n\t\t\t\t\tthis.attachedContext.size - 1,\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tclearButton.focus();\n\t\t\t}\n\n\t\t\tthis.attachedContextDisposables.add(clearButton);\n\t\t\tclearButton.icon = Codicon.close;\n\t\t\tconst disp = clearButton.onDidClick((e) => {\n\t\t\t\tthis._attachedContext.delete(attachment);\n\t\t\t\tdisp.dispose();\n\n\t\t\t\t// Set focus to the next attached context item if deletion was triggered by a keystroke (vs a mouse click)\n\t\t\t\tif (dom.isKeyboardEvent(e)) {\n\t\t\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\t\t\tif (\n\t\t\t\t\t\tevent.equals(KeyCode.Enter) ||\n\t\t\t\t\t\tevent.equals(KeyCode.Space)\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis._indexOfLastAttachedContextDeletedWithKeyboard =\n\t\t\t\t\t\t\tindex;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._onDidChangeHeight.fire();\n\t\t\t\tthis._onDidChangeContext.fire({ removed: [attachment] });\n\t\t\t});\n\t\t\tthis.attachedContextDisposables.add(disp);\n\t\t});\n\n\t\tif (oldHeight !== container.offsetHeight && !isLayout) {\n\t\t\tthis._onDidChangeHeight.fire();\n\t\t}\n\t}\n\n\tasync renderFollowups(\n\t\titems: IChatFollowup[] | undefined,\n\t\tresponse: IChatResponseViewModel | undefined,\n\t): Promise<void> {\n\t\tif (!this.options.renderFollowups) {\n\t\t\treturn;\n\t\t}\n\t\tthis.followupsDisposables.clear();\n\t\tdom.clearNode(this.followupsContainer);\n\n\t\tif (items && items.length > 0) {\n\t\t\tthis.followupsDisposables.add(\n\t\t\t\tthis.instantiationService.createInstance<\n\t\t\t\t\ttypeof ChatFollowups<IChatFollowup>,\n\t\t\t\t\tChatFollowups<IChatFollowup>\n\t\t\t\t>(\n\t\t\t\t\tChatFollowups,\n\t\t\t\t\tthis.followupsContainer,\n\t\t\t\t\titems,\n\t\t\t\t\tthis.location,\n\t\t\t\t\tundefined,\n\t\t\t\t\t(followup) =>\n\t\t\t\t\t\tthis._onDidAcceptFollowup.fire({ followup, response }),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\tthis._onDidChangeHeight.fire();\n\t}\n\n\tget contentHeight(): number {\n\t\tconst data = this.getLayoutData();\n\t\treturn (\n\t\t\tdata.followupsHeight +\n\t\t\tdata.inputPartEditorHeight +\n\t\t\tdata.inputPartVerticalPadding +\n\t\t\tdata.inputEditorBorder +\n\t\t\tdata.implicitContextHeight +\n\t\t\tdata.executeToolbarHeight\n\t\t);\n\t}\n\n\tlayout(height: number, width: number) {\n\t\tthis.cachedDimensions = new dom.Dimension(width, height);\n\n\t\treturn this._layout(height, width);\n\t}\n\n\tprivate previousInputEditorDimension: IDimension | undefined;\n\tprivate _layout(height: number, width: number, allowRecurse = true): void {\n\t\tthis.initAttachedContext(this.attachedContextContainer, true);\n\n\t\tconst data = this.getLayoutData();\n\n\t\tconst inputEditorHeight = Math.min(\n\t\t\tdata.inputPartEditorHeight,\n\t\t\theight - data.followupsHeight - data.inputPartVerticalPadding,\n\t\t);\n\n\t\tconst followupsWidth = width - data.inputPartHorizontalPadding;\n\t\tthis.followupsContainer.style.width = `${followupsWidth}px`;\n\n\t\tthis._inputPartHeight =\n\t\t\tdata.followupsHeight +\n\t\t\tinputEditorHeight +\n\t\t\tdata.inputPartVerticalPadding +\n\t\t\tdata.inputEditorBorder +\n\t\t\tdata.implicitContextHeight +\n\t\t\tdata.executeToolbarHeight;\n\n\t\tconst initialEditorScrollWidth = this._inputEditor.getScrollWidth();\n\t\tconst newEditorWidth =\n\t\t\twidth -\n\t\t\tdata.inputPartHorizontalPadding -\n\t\t\tdata.editorBorder -\n\t\t\tdata.editorPadding -\n\t\t\tdata.executeToolbarWidth -\n\t\t\tdata.sideToolbarWidth;\n\t\tconst newDimension = {\n\t\t\twidth: newEditorWidth,\n\t\t\theight: inputEditorHeight,\n\t\t};\n\t\tif (\n\t\t\t!this.previousInputEditorDimension ||\n\t\t\tthis.previousInputEditorDimension.width !== newDimension.width ||\n\t\t\tthis.previousInputEditorDimension.height !== newDimension.height\n\t\t) {\n\t\t\t// This layout call has side-effects that are hard to understand. eg if we are calling this inside a onDidChangeContent handler, this can trigger the next onDidChangeContent handler\n\t\t\t// to be invoked, and we have a lot of these on this editor. Only doing a layout this when the editor size has actually changed makes it much easier to follow.\n\t\t\tthis._inputEditor.layout(newDimension);\n\t\t\tthis.previousInputEditorDimension = newDimension;\n\t\t}\n\n\t\tif (allowRecurse && initialEditorScrollWidth < 10) {\n\t\t\t// This is probably the initial layout. Now that the editor is layed out with its correct width, it should report the correct contentHeight\n\t\t\treturn this._layout(height, width, false);\n\t\t}\n\t}\n\n\tprivate getLayoutData() {\n\t\tconst executeToolbarWidth = (this.cachedToolbarWidth =\n\t\t\tthis.toolbar.getItemsWidth());\n\t\tconst executeToolbarPadding = (this.toolbar.getItemsLength() - 1) * 4;\n\t\treturn {\n\t\t\tinputEditorBorder: 2,\n\t\t\tfollowupsHeight: this.followupsContainer.offsetHeight,\n\t\t\tinputPartEditorHeight: Math.min(\n\t\t\t\tthis._inputEditor.getContentHeight(),\n\t\t\t\tthis.inputEditorMaxHeight,\n\t\t\t),\n\t\t\tinputPartHorizontalPadding:\n\t\t\t\tthis.options.renderStyle === \"compact\" ? 12 : 32,\n\t\t\tinputPartVerticalPadding:\n\t\t\t\tthis.options.renderStyle === \"compact\" ? 12 : 24,\n\t\t\timplicitContextHeight: this.attachedContextContainer.offsetHeight,\n\t\t\teditorBorder: 2,\n\t\t\teditorPadding: 12,\n\t\t\texecuteToolbarWidth:\n\t\t\t\tthis.options.renderStyle === \"compact\"\n\t\t\t\t\t? executeToolbarWidth + executeToolbarPadding\n\t\t\t\t\t: 0,\n\t\t\texecuteToolbarHeight:\n\t\t\t\tthis.options.renderStyle === \"compact\" ? 0 : 22,\n\t\t\tsideToolbarWidth: this.inputSideToolbarContainer\n\t\t\t\t? dom.getTotalWidth(this.inputSideToolbarContainer) + 4 /*gap*/\n\t\t\t\t: 0,\n\t\t};\n\t}\n\n\tsaveState(): void {\n\t\tthis.saveCurrentValue(this.getInputState());\n\t\tconst inputHistory = [...this.history];\n\t\tthis.historyService.saveHistory(this.location, inputHistory);\n\t}\n}\n\nconst historyKeyFn = (entry: IChatHistoryEntry) => JSON.stringify(entry);\n\nfunction getLastPosition(model: ITextModel): IPosition {\n\treturn {\n\t\tlineNumber: model.getLineCount(),\n\t\tcolumn: model.getLineLength(model.getLineCount()) + 1,\n\t};\n}\n\n// This does seems like a lot just to customize an item with dropdown. This whole class exists just because we need an\n// onDidChange listener on the submenu, which is apparently not needed in other cases.\nclass ChatSubmitDropdownActionItem extends DropdownWithPrimaryActionViewItem {\n\tconstructor(\n\t\taction: MenuItemAction,\n\t\tdropdownAction: IAction,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IChatAgentService chatAgentService: IChatAgentService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IAccessibilityService accessibilityService: IAccessibilityService,\n\t) {\n\t\tsuper(\n\t\t\taction,\n\t\t\tdropdownAction,\n\t\t\t[],\n\t\t\t\"\",\n\t\t\tcontextMenuService,\n\t\t\t{\n\t\t\t\tgetKeyBinding: (action: IAction) =>\n\t\t\t\t\tkeybindingService.lookupKeybinding(\n\t\t\t\t\t\taction.id,\n\t\t\t\t\t\tcontextKeyService,\n\t\t\t\t\t),\n\t\t\t},\n\t\t\tkeybindingService,\n\t\t\tnotificationService,\n\t\t\tcontextKeyService,\n\t\t\tthemeService,\n\t\t\taccessibilityService,\n\t\t);\n\t\tconst menu = menuService.createMenu(\n\t\t\tMenuId.ChatExecuteSecondary,\n\t\t\tcontextKeyService,\n\t\t);\n\t\tconst setActions = () => {\n\t\t\tconst secondary: IAction[] = [];\n\t\t\tcreateAndFillInActionBarActions(\n\t\t\t\tmenu,\n\t\t\t\t{ shouldForwardArgs: true },\n\t\t\t\tsecondary,\n\t\t\t);\n\t\t\tconst secondaryAgent = chatAgentService.getSecondaryAgent();\n\t\t\tif (secondaryAgent) {\n\t\t\t\tsecondary.forEach((a) => {\n\t\t\t\t\tif (a.id === ChatSubmitSecondaryAgentAction.ID) {\n\t\t\t\t\t\ta.label = localize(\n\t\t\t\t\t\t\t\"chat.submitToSecondaryAgent\",\n\t\t\t\t\t\t\t\"Send to @{0}\",\n\t\t\t\t\t\t\tsecondaryAgent.name,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn a;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.update(dropdownAction, secondary);\n\t\t};\n\t\tsetActions();\n\t\tthis._register(menu.onDidChange(() => setActions()));\n\t}\n}\n\nconst chatInputEditorContainerSelector = \".interactive-input-editor\";\nsetupSimpleEditorSelectionStyling(chatInputEditorContainerSelector);\n"],
  "mappings": "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",
  "names": ["options", "action"]
}
