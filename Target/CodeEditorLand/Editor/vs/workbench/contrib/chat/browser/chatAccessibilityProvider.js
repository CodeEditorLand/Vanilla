var u=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var g=(l,e,t,i)=>{for(var r=i>1?void 0:i?d(e,t):e,o=l.length-1,n;o>=0;o--)(n=l[o])&&(r=(i?n(e,t,r):n(r))||r);return i&&r&&u(e,t,r),r},p=(l,e)=>(t,i)=>e(t,i,l);import"../../../../base/browser/ui/aria/aria.js";import"../../../../base/browser/ui/list/listWidget.js";import{marked as b}from"../../../../base/common/marked/marked.js";import{localize as s}from"../../../../nls.js";import{IAccessibleViewService as m}from"../../../../platform/accessibility/browser/accessibleView.js";import{AccessibilityVerbositySettingId as f}from"../../accessibility/browser/accessibilityConfiguration.js";import{isRequestVM as k,isResponseVM as C,isWelcomeVM as h}from"../common/chatViewModel.js";import"./chat.js";let c=class{constructor(e){this._accessibleViewService=e}getWidgetRole(){return"list"}getRole(e){return"listitem"}getWidgetAriaLabel(){return s("chat","Chat")}getAriaLabel(e){return k(e)?e.messageText:C(e)?this._getLabelWithCodeBlockCount(e):h(e)?e.content.map(t=>"value"in t?t.value:t.map(i=>i.message).join(`
`)).join(`
`):""}_getLabelWithCodeBlockCount(e){const t=this._accessibleViewService.getOpenAriaHint(f.Chat);let i="";const r=e.response.value.filter(a=>!("value"in a))?.length??0;let o="";switch(r){case 0:break;case 1:o=s("singleFileTreeHint","1 file tree");break;default:o=s("multiFileTreeHint","{0} file trees",r);break}const n=b.lexer(e.response.toString()).filter(a=>a.type==="code")?.length??0;switch(n){case 0:i=t?s("noCodeBlocksHint","{0} {1} {2}",o,e.response.toString(),t):s("noCodeBlocks","{0} {1}",o,e.response.toString());break;case 1:i=t?s("singleCodeBlockHint","{0} 1 code block: {1} {2}",o,e.response.toString(),t):s("singleCodeBlock","{0} 1 code block: {1}",o,e.response.toString());break;default:i=t?s("multiCodeBlockHint","{0} {1} code blocks: {2}",o,n,e.response.toString(),t):s("multiCodeBlock","{0} {1} code blocks",o,n,e.response.toString());break}return i}};c=g([p(0,m)],c);export{c as ChatAccessibilityProvider};
