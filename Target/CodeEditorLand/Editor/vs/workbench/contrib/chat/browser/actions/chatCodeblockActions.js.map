{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/actions/chatCodeblockActions.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from \"../../../../../base/common/codicons.js\";\nimport { KeyCode, KeyMod } from \"../../../../../base/common/keyCodes.js\";\nimport type { ICodeEditor } from \"../../../../../editor/browser/editorBrowser.js\";\nimport type { ServicesAccessor } from \"../../../../../editor/browser/editorExtensions.js\";\nimport { ICodeEditorService } from \"../../../../../editor/browser/services/codeEditorService.js\";\nimport { EditorContextKeys } from \"../../../../../editor/common/editorContextKeys.js\";\nimport { CopyAction } from \"../../../../../editor/contrib/clipboard/browser/clipboard.js\";\nimport { localize2 } from \"../../../../../nls.js\";\nimport {\n\tAction2,\n\tMenuId,\n\tregisterAction2,\n} from \"../../../../../platform/actions/common/actions.js\";\nimport { IClipboardService } from \"../../../../../platform/clipboard/common/clipboardService.js\";\nimport { ContextKeyExpr } from \"../../../../../platform/contextkey/common/contextkey.js\";\nimport { IInstantiationService } from \"../../../../../platform/instantiation/common/instantiation.js\";\nimport { KeybindingWeight } from \"../../../../../platform/keybinding/common/keybindingsRegistry.js\";\nimport { TerminalLocation } from \"../../../../../platform/terminal/common/terminal.js\";\nimport type { IUntitledTextResourceEditorInput } from \"../../../../common/editor.js\";\nimport { IEditorService } from \"../../../../services/editor/common/editorService.js\";\nimport { accessibleViewInCodeBlock } from \"../../../accessibility/browser/accessibilityConfiguration.js\";\nimport {\n\tITerminalEditorService,\n\tITerminalGroupService,\n\tITerminalService,\n} from \"../../../terminal/browser/terminal.js\";\nimport {\n\tCONTEXT_CHAT_EDIT_APPLIED,\n\tCONTEXT_CHAT_ENABLED,\n\tCONTEXT_IN_CHAT_INPUT,\n\tCONTEXT_IN_CHAT_SESSION,\n} from \"../../common/chatContextKeys.js\";\nimport { ChatCopyKind, IChatService } from \"../../common/chatService.js\";\nimport {\n\ttype IChatResponseViewModel,\n\tisResponseVM,\n} from \"../../common/chatViewModel.js\";\nimport {\n\tIChatCodeBlockContextProviderService,\n\tIChatWidgetService,\n} from \"../chat.js\";\nimport {\n\tDefaultChatTextEditor,\n\ttype ICodeBlockActionContext,\n\ttype ICodeCompareBlockActionContext,\n} from \"../codeBlockPart.js\";\nimport { CHAT_CATEGORY } from \"./chatActions.js\";\nimport {\n\tApplyCodeBlockOperation,\n\tInsertCodeBlockOperation,\n} from \"./codeBlockOperations.js\";\n\nconst shellLangIds = [\n\t\"fish\",\n\t\"ps1\",\n\t\"pwsh\",\n\t\"powershell\",\n\t\"sh\",\n\t\"shellscript\",\n\t\"zsh\",\n];\n\nexport interface IChatCodeBlockActionContext extends ICodeBlockActionContext {\n\telement: IChatResponseViewModel;\n}\n\nexport function isCodeBlockActionContext(\n\tthing: unknown,\n): thing is ICodeBlockActionContext {\n\treturn (\n\t\ttypeof thing === \"object\" &&\n\t\tthing !== null &&\n\t\t\"code\" in thing &&\n\t\t\"element\" in thing\n\t);\n}\n\nexport function isCodeCompareBlockActionContext(\n\tthing: unknown,\n): thing is ICodeCompareBlockActionContext {\n\treturn typeof thing === \"object\" && thing !== null && \"element\" in thing;\n}\n\nfunction isResponseFiltered(context: ICodeBlockActionContext) {\n\treturn (\n\t\tisResponseVM(context.element) &&\n\t\tcontext.element.errorDetails?.responseIsFiltered\n\t);\n}\n\nabstract class ChatCodeBlockAction extends Action2 {\n\trun(accessor: ServicesAccessor, ...args: any[]) {\n\t\tlet context = args[0];\n\t\tif (!isCodeBlockActionContext(context)) {\n\t\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\t\t\tconst editor =\n\t\t\t\tcodeEditorService.getFocusedCodeEditor() ||\n\t\t\t\tcodeEditorService.getActiveCodeEditor();\n\t\t\tif (!editor) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcontext = getContextFromEditor(editor, accessor);\n\t\t\tif (!isCodeBlockActionContext(context)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\treturn this.runWithContext(accessor, context);\n\t}\n\n\tabstract runWithContext(\n\t\taccessor: ServicesAccessor,\n\t\tcontext: ICodeBlockActionContext,\n\t): any;\n}\n\nexport function registerChatCodeBlockActions() {\n\tregisterAction2(\n\t\tclass CopyCodeBlockAction extends Action2 {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.copyCodeBlock\",\n\t\t\t\t\ttitle: localize2(\"interactive.copyCodeBlock.label\", \"Copy\"),\n\t\t\t\t\tf1: false,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t\ticon: Codicon.copy,\n\t\t\t\t\tmenu: {\n\t\t\t\t\t\tid: MenuId.ChatCodeBlock,\n\t\t\t\t\t\tgroup: \"navigation\",\n\t\t\t\t\t\torder: 30,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\trun(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\t\tconst context = args[0];\n\t\t\t\tif (\n\t\t\t\t\t!isCodeBlockActionContext(context) ||\n\t\t\t\t\tisResponseFiltered(context)\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst clipboardService = accessor.get(IClipboardService);\n\t\t\t\tclipboardService.writeText(context.code);\n\n\t\t\t\tif (isResponseVM(context.element)) {\n\t\t\t\t\tconst chatService = accessor.get(IChatService);\n\t\t\t\t\tchatService.notifyUserAction({\n\t\t\t\t\t\tagentId: context.element.agent?.id,\n\t\t\t\t\t\tcommand: context.element.slashCommand?.name,\n\t\t\t\t\t\tsessionId: context.element.sessionId,\n\t\t\t\t\t\trequestId: context.element.requestId,\n\t\t\t\t\t\tresult: context.element.result,\n\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\tkind: \"copy\",\n\t\t\t\t\t\t\tcodeBlockIndex: context.codeBlockIndex,\n\t\t\t\t\t\t\tcopyKind: ChatCopyKind.Toolbar,\n\t\t\t\t\t\t\tcopiedCharacters: context.code.length,\n\t\t\t\t\t\t\ttotalCharacters: context.code.length,\n\t\t\t\t\t\t\tcopiedText: context.code,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t);\n\n\tCopyAction?.addImplementation(50000, \"chat-codeblock\", (accessor) => {\n\t\t// get active code editor\n\t\tconst editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n\t\tif (!editor) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst editorModel = editor.getModel();\n\t\tif (!editorModel) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst context = getContextFromEditor(editor, accessor);\n\t\tif (!context) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst noSelection =\n\t\t\teditor.getSelections()?.length === 1 &&\n\t\t\teditor.getSelection()?.isEmpty();\n\t\tconst copiedText = noSelection\n\t\t\t? editorModel.getValue()\n\t\t\t: (editor\n\t\t\t\t\t.getSelections()\n\t\t\t\t\t?.reduce(\n\t\t\t\t\t\t(acc, selection) =>\n\t\t\t\t\t\t\tacc + editorModel.getValueInRange(selection),\n\t\t\t\t\t\t\"\",\n\t\t\t\t\t) ?? \"\");\n\t\tconst totalCharacters = editorModel.getValueLength();\n\n\t\t// Report copy to extensions\n\t\tconst chatService = accessor.get(IChatService);\n\t\tconst element = context.element as IChatResponseViewModel | undefined;\n\t\tif (element) {\n\t\t\tchatService.notifyUserAction({\n\t\t\t\tagentId: element.agent?.id,\n\t\t\t\tcommand: element.slashCommand?.name,\n\t\t\t\tsessionId: element.sessionId,\n\t\t\t\trequestId: element.requestId,\n\t\t\t\tresult: element.result,\n\t\t\t\taction: {\n\t\t\t\t\tkind: \"copy\",\n\t\t\t\t\tcodeBlockIndex: context.codeBlockIndex,\n\t\t\t\t\tcopyKind: ChatCopyKind.Action,\n\t\t\t\t\tcopiedText,\n\t\t\t\t\tcopiedCharacters: copiedText.length,\n\t\t\t\t\ttotalCharacters,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\t// Copy full cell if no selection, otherwise fall back on normal editor implementation\n\t\tif (noSelection) {\n\t\t\taccessor.get(IClipboardService).writeText(context.code);\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t});\n\n\tregisterAction2(\n\t\tclass SmartApplyInEditorAction extends ChatCodeBlockAction {\n\t\t\tprivate operation: ApplyCodeBlockOperation | undefined;\n\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.applyInEditor\",\n\t\t\t\t\ttitle: localize2(\n\t\t\t\t\t\t\"interactive.applyInEditor.label\",\n\t\t\t\t\t\t\"Apply in Editor\",\n\t\t\t\t\t),\n\t\t\t\t\tprecondition: CONTEXT_CHAT_ENABLED,\n\t\t\t\t\tf1: true,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t\ticon: Codicon.gitPullRequestGoToChanges,\n\n\t\t\t\t\tmenu: {\n\t\t\t\t\t\tid: MenuId.ChatCodeBlock,\n\t\t\t\t\t\tgroup: \"navigation\",\n\t\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\t\tCONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t\t\t...shellLangIds.map((e) =>\n\t\t\t\t\t\t\t\tContextKeyExpr.notEquals(\n\t\t\t\t\t\t\t\t\tEditorContextKeys.languageId.key,\n\t\t\t\t\t\t\t\t\te,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t),\n\t\t\t\t\t\torder: 10,\n\t\t\t\t\t},\n\t\t\t\t\tkeybinding: {\n\t\t\t\t\t\twhen: ContextKeyExpr.or(\n\t\t\t\t\t\t\tContextKeyExpr.and(\n\t\t\t\t\t\t\t\tCONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t\t\t\tCONTEXT_IN_CHAT_INPUT.negate(),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\taccessibleViewInCodeBlock,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Enter,\n\t\t\t\t\t\tmac: { primary: KeyMod.WinCtrl | KeyCode.Enter },\n\t\t\t\t\t\tweight: KeybindingWeight.ExternalExtension + 1,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\toverride runWithContext(\n\t\t\t\taccessor: ServicesAccessor,\n\t\t\t\tcontext: ICodeBlockActionContext,\n\t\t\t) {\n\t\t\t\tif (!this.operation) {\n\t\t\t\t\tthis.operation = accessor\n\t\t\t\t\t\t.get(IInstantiationService)\n\t\t\t\t\t\t.createInstance(ApplyCodeBlockOperation);\n\t\t\t\t}\n\t\t\t\treturn this.operation.run(context);\n\t\t\t}\n\t\t},\n\t);\n\n\tregisterAction2(\n\t\tclass SmartApplyInEditorAction extends ChatCodeBlockAction {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.insertCodeBlock\",\n\t\t\t\t\ttitle: localize2(\n\t\t\t\t\t\t\"interactive.insertCodeBlock.label\",\n\t\t\t\t\t\t\"Insert At Cursor\",\n\t\t\t\t\t),\n\t\t\t\t\tprecondition: CONTEXT_CHAT_ENABLED,\n\t\t\t\t\tf1: true,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t\ticon: Codicon.insert,\n\t\t\t\t\tmenu: {\n\t\t\t\t\t\tid: MenuId.ChatCodeBlock,\n\t\t\t\t\t\tgroup: \"navigation\",\n\t\t\t\t\t\twhen: CONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t\torder: 20,\n\t\t\t\t\t},\n\t\t\t\t\tkeybinding: {\n\t\t\t\t\t\twhen: ContextKeyExpr.or(\n\t\t\t\t\t\t\tContextKeyExpr.and(\n\t\t\t\t\t\t\t\tCONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t\t\t\tCONTEXT_IN_CHAT_INPUT.negate(),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\taccessibleViewInCodeBlock,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Enter,\n\t\t\t\t\t\tmac: { primary: KeyMod.WinCtrl | KeyCode.Enter },\n\t\t\t\t\t\tweight: KeybindingWeight.ExternalExtension + 1,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\toverride runWithContext(\n\t\t\t\taccessor: ServicesAccessor,\n\t\t\t\tcontext: ICodeBlockActionContext,\n\t\t\t) {\n\t\t\t\tconst operation = accessor\n\t\t\t\t\t.get(IInstantiationService)\n\t\t\t\t\t.createInstance(InsertCodeBlockOperation);\n\t\t\t\treturn operation.run(context);\n\t\t\t}\n\t\t},\n\t);\n\n\tregisterAction2(\n\t\tclass InsertIntoNewFileAction extends ChatCodeBlockAction {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.insertIntoNewFile\",\n\t\t\t\t\ttitle: localize2(\n\t\t\t\t\t\t\"interactive.insertIntoNewFile.label\",\n\t\t\t\t\t\t\"Insert into New File\",\n\t\t\t\t\t),\n\t\t\t\t\tprecondition: CONTEXT_CHAT_ENABLED,\n\t\t\t\t\tf1: true,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t\ticon: Codicon.newFile,\n\t\t\t\t\tmenu: {\n\t\t\t\t\t\tid: MenuId.ChatCodeBlock,\n\t\t\t\t\t\tgroup: \"navigation\",\n\t\t\t\t\t\tisHiddenByDefault: true,\n\t\t\t\t\t\torder: 40,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\toverride async runWithContext(\n\t\t\t\taccessor: ServicesAccessor,\n\t\t\t\tcontext: ICodeBlockActionContext,\n\t\t\t) {\n\t\t\t\tif (isResponseFiltered(context)) {\n\t\t\t\t\t// When run from command palette\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst editorService = accessor.get(IEditorService);\n\t\t\t\tconst chatService = accessor.get(IChatService);\n\n\t\t\t\teditorService.openEditor({\n\t\t\t\t\tcontents: context.code,\n\t\t\t\t\tlanguageId: context.languageId,\n\t\t\t\t\tresource: undefined,\n\t\t\t\t} satisfies IUntitledTextResourceEditorInput);\n\n\t\t\t\tif (isResponseVM(context.element)) {\n\t\t\t\t\tchatService.notifyUserAction({\n\t\t\t\t\t\tagentId: context.element.agent?.id,\n\t\t\t\t\t\tcommand: context.element.slashCommand?.name,\n\t\t\t\t\t\tsessionId: context.element.sessionId,\n\t\t\t\t\t\trequestId: context.element.requestId,\n\t\t\t\t\t\tresult: context.element.result,\n\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\tkind: \"insert\",\n\t\t\t\t\t\t\tcodeBlockIndex: context.codeBlockIndex,\n\t\t\t\t\t\t\ttotalCharacters: context.code.length,\n\t\t\t\t\t\t\tnewFile: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t);\n\n\tregisterAction2(\n\t\tclass RunInTerminalAction extends ChatCodeBlockAction {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.runInTerminal\",\n\t\t\t\t\ttitle: localize2(\n\t\t\t\t\t\t\"interactive.runInTerminal.label\",\n\t\t\t\t\t\t\"Insert into Terminal\",\n\t\t\t\t\t),\n\t\t\t\t\tprecondition: CONTEXT_CHAT_ENABLED,\n\t\t\t\t\tf1: true,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t\ticon: Codicon.terminal,\n\t\t\t\t\tmenu: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: MenuId.ChatCodeBlock,\n\t\t\t\t\t\t\tgroup: \"navigation\",\n\t\t\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\t\t\tCONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t\t\t\tContextKeyExpr.or(\n\t\t\t\t\t\t\t\t\t...shellLangIds.map((e) =>\n\t\t\t\t\t\t\t\t\t\tContextKeyExpr.equals(\n\t\t\t\t\t\t\t\t\t\t\tEditorContextKeys.languageId.key,\n\t\t\t\t\t\t\t\t\t\t\te,\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: MenuId.ChatCodeBlock,\n\t\t\t\t\t\t\tgroup: \"navigation\",\n\t\t\t\t\t\t\tisHiddenByDefault: true,\n\t\t\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\t\t\tCONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t\t\t\t...shellLangIds.map((e) =>\n\t\t\t\t\t\t\t\t\tContextKeyExpr.notEquals(\n\t\t\t\t\t\t\t\t\t\tEditorContextKeys.languageId.key,\n\t\t\t\t\t\t\t\t\t\te,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tkeybinding: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprimary:\n\t\t\t\t\t\t\t\tKeyMod.CtrlCmd | KeyMod.Alt | KeyCode.Enter,\n\t\t\t\t\t\t\tmac: {\n\t\t\t\t\t\t\t\tprimary:\n\t\t\t\t\t\t\t\t\tKeyMod.WinCtrl | KeyMod.Alt | KeyCode.Enter,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t\t\t\t\twhen: ContextKeyExpr.or(\n\t\t\t\t\t\t\t\tCONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t\t\t\taccessibleViewInCodeBlock,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t}\n\n\t\t\toverride async runWithContext(\n\t\t\t\taccessor: ServicesAccessor,\n\t\t\t\tcontext: ICodeBlockActionContext,\n\t\t\t) {\n\t\t\t\tif (isResponseFiltered(context)) {\n\t\t\t\t\t// When run from command palette\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatService = accessor.get(IChatService);\n\t\t\t\tconst terminalService = accessor.get(ITerminalService);\n\t\t\t\tconst editorService = accessor.get(IEditorService);\n\t\t\t\tconst terminalEditorService = accessor.get(\n\t\t\t\t\tITerminalEditorService,\n\t\t\t\t);\n\t\t\t\tconst terminalGroupService = accessor.get(\n\t\t\t\t\tITerminalGroupService,\n\t\t\t\t);\n\n\t\t\t\tlet terminal =\n\t\t\t\t\tawait terminalService.getActiveOrCreateInstance();\n\n\t\t\t\t// isFeatureTerminal = debug terminal or task terminal\n\t\t\t\tconst unusableTerminal =\n\t\t\t\t\tterminal.xterm?.isStdinDisabled ||\n\t\t\t\t\tterminal.shellLaunchConfig.isFeatureTerminal;\n\t\t\t\tterminal = unusableTerminal\n\t\t\t\t\t? await terminalService.createTerminal()\n\t\t\t\t\t: terminal;\n\n\t\t\t\tterminalService.setActiveInstance(terminal);\n\t\t\t\tawait terminal.focusWhenReady(true);\n\t\t\t\tif (terminal.target === TerminalLocation.Editor) {\n\t\t\t\t\tconst existingEditors = editorService.findEditors(\n\t\t\t\t\t\tterminal.resource,\n\t\t\t\t\t);\n\t\t\t\t\tterminalEditorService.openEditor(terminal, {\n\t\t\t\t\t\tviewColumn: existingEditors?.[0].groupId,\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tterminalGroupService.showPanel(true);\n\t\t\t\t}\n\n\t\t\t\tterminal.runCommand(context.code, false);\n\n\t\t\t\tif (isResponseVM(context.element)) {\n\t\t\t\t\tchatService.notifyUserAction({\n\t\t\t\t\t\tagentId: context.element.agent?.id,\n\t\t\t\t\t\tcommand: context.element.slashCommand?.name,\n\t\t\t\t\t\tsessionId: context.element.sessionId,\n\t\t\t\t\t\trequestId: context.element.requestId,\n\t\t\t\t\t\tresult: context.element.result,\n\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\tkind: \"runInTerminal\",\n\t\t\t\t\t\t\tcodeBlockIndex: context.codeBlockIndex,\n\t\t\t\t\t\t\tlanguageId: context.languageId,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t);\n\n\tfunction navigateCodeBlocks(\n\t\taccessor: ServicesAccessor,\n\t\treverse?: boolean,\n\t): void {\n\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\t\tconst widget = chatWidgetService.lastFocusedWidget;\n\t\tif (!widget) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editor = codeEditorService.getFocusedCodeEditor();\n\t\tconst editorUri = editor?.getModel()?.uri;\n\t\tconst curCodeBlockInfo = editorUri\n\t\t\t? widget.getCodeBlockInfoForEditor(editorUri)\n\t\t\t: undefined;\n\t\tconst focused =\n\t\t\t!widget.inputEditor.hasWidgetFocus() && widget.getFocus();\n\t\tconst focusedResponse = isResponseVM(focused) ? focused : undefined;\n\n\t\tconst currentResponse = curCodeBlockInfo\n\t\t\t? curCodeBlockInfo.element\n\t\t\t: (focusedResponse ??\n\t\t\t\twidget.viewModel\n\t\t\t\t\t?.getItems()\n\t\t\t\t\t.reverse()\n\t\t\t\t\t.find((item): item is IChatResponseViewModel =>\n\t\t\t\t\t\tisResponseVM(item),\n\t\t\t\t\t));\n\t\tif (!currentResponse || !isResponseVM(currentResponse)) {\n\t\t\treturn;\n\t\t}\n\n\t\twidget.reveal(currentResponse);\n\t\tconst responseCodeblocks =\n\t\t\twidget.getCodeBlockInfosForResponse(currentResponse);\n\t\tconst focusIdx = curCodeBlockInfo\n\t\t\t? (curCodeBlockInfo.codeBlockIndex +\n\t\t\t\t\t(reverse ? -1 : 1) +\n\t\t\t\t\tresponseCodeblocks.length) %\n\t\t\t\tresponseCodeblocks.length\n\t\t\t: reverse\n\t\t\t\t? responseCodeblocks.length - 1\n\t\t\t\t: 0;\n\n\t\tresponseCodeblocks[focusIdx]?.focus();\n\t}\n\n\tregisterAction2(\n\t\tclass NextCodeBlockAction extends Action2 {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.nextCodeBlock\",\n\t\t\t\t\ttitle: localize2(\n\t\t\t\t\t\t\"interactive.nextCodeBlock.label\",\n\t\t\t\t\t\t\"Next Code Block\",\n\t\t\t\t\t),\n\t\t\t\t\tkeybinding: {\n\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Alt | KeyCode.PageDown,\n\t\t\t\t\t\tmac: {\n\t\t\t\t\t\t\tprimary:\n\t\t\t\t\t\t\t\tKeyMod.CtrlCmd | KeyMod.Alt | KeyCode.PageDown,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\t\twhen: CONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t},\n\t\t\t\t\tprecondition: CONTEXT_CHAT_ENABLED,\n\t\t\t\t\tf1: true,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\trun(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\t\tnavigateCodeBlocks(accessor);\n\t\t\t}\n\t\t},\n\t);\n\n\tregisterAction2(\n\t\tclass PreviousCodeBlockAction extends Action2 {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.previousCodeBlock\",\n\t\t\t\t\ttitle: localize2(\n\t\t\t\t\t\t\"interactive.previousCodeBlock.label\",\n\t\t\t\t\t\t\"Previous Code Block\",\n\t\t\t\t\t),\n\t\t\t\t\tkeybinding: {\n\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Alt | KeyCode.PageUp,\n\t\t\t\t\t\tmac: {\n\t\t\t\t\t\t\tprimary:\n\t\t\t\t\t\t\t\tKeyMod.CtrlCmd | KeyMod.Alt | KeyCode.PageUp,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\t\twhen: CONTEXT_IN_CHAT_SESSION,\n\t\t\t\t\t},\n\t\t\t\t\tprecondition: CONTEXT_CHAT_ENABLED,\n\t\t\t\t\tf1: true,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\trun(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\t\tnavigateCodeBlocks(accessor, true);\n\t\t\t}\n\t\t},\n\t);\n}\n\nfunction getContextFromEditor(\n\teditor: ICodeEditor,\n\taccessor: ServicesAccessor,\n): ICodeBlockActionContext | undefined {\n\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\tconst chatCodeBlockContextProviderService = accessor.get(\n\t\tIChatCodeBlockContextProviderService,\n\t);\n\tconst model = editor.getModel();\n\tif (!model) {\n\t\treturn;\n\t}\n\n\tconst widget = chatWidgetService.lastFocusedWidget;\n\tconst codeBlockInfo = widget?.getCodeBlockInfoForEditor(model.uri);\n\tif (!codeBlockInfo) {\n\t\tfor (const provider of chatCodeBlockContextProviderService.providers) {\n\t\t\tconst context = provider.getCodeBlockContext(editor);\n\t\t\tif (context) {\n\t\t\t\treturn context;\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\n\treturn {\n\t\telement: codeBlockInfo.element,\n\t\tcodeBlockIndex: codeBlockInfo.codeBlockIndex,\n\t\tcode: editor.getValue(),\n\t\tlanguageId: editor.getModel()!.getLanguageId(),\n\t\tcodemapperUri: codeBlockInfo.codemapperUri,\n\t};\n}\n\nexport function registerChatCodeCompareBlockActions() {\n\tabstract class ChatCompareCodeBlockAction extends Action2 {\n\t\trun(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\tconst context = args[0];\n\t\t\tif (!isCodeCompareBlockActionContext(context)) {\n\t\t\t\treturn;\n\t\t\t\t// TODO@jrieken derive context\n\t\t\t}\n\n\t\t\treturn this.runWithContext(accessor, context);\n\t\t}\n\n\t\tabstract runWithContext(\n\t\t\taccessor: ServicesAccessor,\n\t\t\tcontext: ICodeCompareBlockActionContext,\n\t\t): any;\n\t}\n\n\tregisterAction2(\n\t\tclass ApplyEditsCompareBlockAction extends ChatCompareCodeBlockAction {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.applyCompareEdits\",\n\t\t\t\t\ttitle: localize2(\n\t\t\t\t\t\t\"interactive.compare.apply\",\n\t\t\t\t\t\t\"Apply Edits\",\n\t\t\t\t\t),\n\t\t\t\t\tf1: false,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t\ticon: Codicon.check,\n\t\t\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\t\t\tEditorContextKeys.hasChanges,\n\t\t\t\t\t\tCONTEXT_CHAT_EDIT_APPLIED.negate(),\n\t\t\t\t\t),\n\t\t\t\t\tmenu: {\n\t\t\t\t\t\tid: MenuId.ChatCompareBlock,\n\t\t\t\t\t\tgroup: \"navigation\",\n\t\t\t\t\t\torder: 1,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tasync runWithContext(\n\t\t\t\taccessor: ServicesAccessor,\n\t\t\t\tcontext: ICodeCompareBlockActionContext,\n\t\t\t): Promise<any> {\n\t\t\t\tconst editorService = accessor.get(IEditorService);\n\t\t\t\tconst instaService = accessor.get(IInstantiationService);\n\n\t\t\t\tconst editor = instaService.createInstance(\n\t\t\t\t\tDefaultChatTextEditor,\n\t\t\t\t);\n\t\t\t\tawait editor.apply(\n\t\t\t\t\tcontext.element,\n\t\t\t\t\tcontext.edit,\n\t\t\t\t\tcontext.diffEditor,\n\t\t\t\t);\n\n\t\t\t\tawait editorService.openEditor({\n\t\t\t\t\tresource: context.edit.uri,\n\t\t\t\t\toptions: { revealIfVisible: true },\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t);\n\n\tregisterAction2(\n\t\tclass DiscardEditsCompareBlockAction extends ChatCompareCodeBlockAction {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: \"workbench.action.chat.discardCompareEdits\",\n\t\t\t\t\ttitle: localize2(\n\t\t\t\t\t\t\"interactive.compare.discard\",\n\t\t\t\t\t\t\"Discard Edits\",\n\t\t\t\t\t),\n\t\t\t\t\tf1: false,\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t\ticon: Codicon.trash,\n\t\t\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\t\t\tEditorContextKeys.hasChanges,\n\t\t\t\t\t\tCONTEXT_CHAT_EDIT_APPLIED.negate(),\n\t\t\t\t\t),\n\t\t\t\t\tmenu: {\n\t\t\t\t\t\tid: MenuId.ChatCompareBlock,\n\t\t\t\t\t\tgroup: \"navigation\",\n\t\t\t\t\t\torder: 2,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tasync runWithContext(\n\t\t\t\taccessor: ServicesAccessor,\n\t\t\t\tcontext: ICodeCompareBlockActionContext,\n\t\t\t): Promise<any> {\n\t\t\t\tconst instaService = accessor.get(IInstantiationService);\n\t\t\t\tconst editor = instaService.createInstance(\n\t\t\t\t\tDefaultChatTextEditor,\n\t\t\t\t);\n\t\t\t\teditor.discard(context.element, context.edit);\n\t\t\t}\n\t\t},\n\t);\n}\n"],
  "mappings": "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",
  "names": []
}
