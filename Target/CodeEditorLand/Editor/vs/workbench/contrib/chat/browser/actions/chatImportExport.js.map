{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/actions/chatImportExport.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from '../../../../../base/common/buffer.js';\nimport { joinPath } from '../../../../../base/common/resources.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { IFileDialogService } from '../../../../../platform/dialogs/common/dialogs.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { CHAT_CATEGORY } from './chatActions.js';\nimport { IChatWidgetService } from '../chat.js';\nimport { IChatEditorOptions } from '../chatEditor.js';\nimport { ChatEditorInput } from '../chatEditorInput.js';\nimport { CONTEXT_CHAT_ENABLED } from '../../common/chatContextKeys.js';\nimport { isExportableSessionData } from '../../common/chatModel.js';\nimport { IChatService } from '../../common/chatService.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\n\nconst defaultFileName = 'chat.json';\nconst filters = [{ name: localize('chat.file.label', \"Chat Session\"), extensions: ['json'] }];\n\nexport function registerChatExportActions() {\n\tregisterAction2(class ExportChatAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.export',\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\ttitle: localize2('chat.export.label', \"Export Chat...\"),\n\t\t\t\tprecondition: CONTEXT_CHAT_ENABLED,\n\t\t\t\tf1: true,\n\t\t\t});\n\t\t}\n\t\tasync run(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\tconst widgetService = accessor.get(IChatWidgetService);\n\t\t\tconst fileDialogService = accessor.get(IFileDialogService);\n\t\t\tconst fileService = accessor.get(IFileService);\n\t\t\tconst chatService = accessor.get(IChatService);\n\n\t\t\tconst widget = widgetService.lastFocusedWidget;\n\t\t\tif (!widget || !widget.viewModel) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst defaultUri = joinPath(await fileDialogService.defaultFilePath(), defaultFileName);\n\t\t\tconst result = await fileDialogService.showSaveDialog({\n\t\t\t\tdefaultUri,\n\t\t\t\tfilters\n\t\t\t});\n\t\t\tif (!result) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst model = chatService.getSession(widget.viewModel.sessionId);\n\t\t\tif (!model) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Using toJSON on the model\n\t\t\tconst content = VSBuffer.fromString(JSON.stringify(model.toExport(), undefined, 2));\n\t\t\tawait fileService.writeFile(result, content);\n\t\t}\n\t});\n\n\tregisterAction2(class ImportChatAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.import',\n\t\t\t\ttitle: localize2('chat.import.label', \"Import Chat...\"),\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\tprecondition: CONTEXT_CHAT_ENABLED,\n\t\t\t\tf1: true,\n\t\t\t});\n\t\t}\n\t\tasync run(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\tconst fileDialogService = accessor.get(IFileDialogService);\n\t\t\tconst fileService = accessor.get(IFileService);\n\t\t\tconst editorService = accessor.get(IEditorService);\n\n\t\t\tconst defaultUri = joinPath(await fileDialogService.defaultFilePath(), defaultFileName);\n\t\t\tconst result = await fileDialogService.showOpenDialog({\n\t\t\t\tdefaultUri,\n\t\t\t\tcanSelectFiles: true,\n\t\t\t\tfilters\n\t\t\t});\n\t\t\tif (!result) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst content = await fileService.readFile(result[0]);\n\t\t\ttry {\n\t\t\t\tconst data = JSON.parse(content.value.toString());\n\t\t\t\tif (!isExportableSessionData(data)) {\n\t\t\t\t\tthrow new Error('Invalid chat session data');\n\t\t\t\t}\n\n\t\t\t\tconst options: IChatEditorOptions = { target: { data }, pinned: true };\n\t\t\t\tawait editorService.openEditor({ resource: ChatEditorInput.getNewEditorUri(), options });\n\t\t\t} catch (err) {\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t}\n\t});\n}\n"],
  "mappings": "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",
  "names": []
}
