var g=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var c=(s,r,o,e)=>{for(var a=e>1?void 0:e?f(r,o):r,n=s.length-1,i;n>=0;n--)(i=s[n])&&(a=(e?i(r,o,a):i(a))||a);return e&&a&&g(r,o,a),a},h=(s,r)=>(o,e)=>r(o,e,s);import*as t from"../../../../../vs/base/browser/dom.js";import"../../../../../vs/base/browser/ui/hover/hover.js";import{renderIcon as d}from"../../../../../vs/base/browser/ui/iconLabel/iconLabels.js";import{CancellationTokenSource as u}from"../../../../../vs/base/common/cancellation.js";import{Codicon as x}from"../../../../../vs/base/common/codicons.js";import{Emitter as C}from"../../../../../vs/base/common/event.js";import{Disposable as I}from"../../../../../vs/base/common/lifecycle.js";import{FileAccess as N}from"../../../../../vs/base/common/network.js";import{ThemeIcon as b}from"../../../../../vs/base/common/themables.js";import{URI as S}from"../../../../../vs/base/common/uri.js";import{localize as l}from"../../../../../vs/nls.js";import"../../../../../vs/platform/commands/common/commands.js";import{getFullyQualifiedId as E,IChatAgentNameService as y,IChatAgentService as w}from"../../../../../vs/workbench/contrib/chat/common/chatAgents.js";import{showExtensionsWithIdsCommandId as p}from"../../../../../vs/workbench/contrib/extensions/browser/extensionsActions.js";import{verifiedPublisherIcon as A}from"../../../../../vs/workbench/contrib/extensions/browser/extensionsIcons.js";import{IExtensionsWorkbenchService as D}from"../../../../../vs/workbench/contrib/extensions/common/extensions.js";let m=class extends I{constructor(o,e,a){super();this.chatAgentService=o;this.extensionService=e;this.chatAgentNameService=a;const n=t.h(".chat-agent-hover@root",[t.h(".chat-agent-hover-header",[t.h(".chat-agent-hover-icon@icon"),t.h(".chat-agent-hover-details",[t.h(".chat-agent-hover-name@name"),t.h(".chat-agent-hover-extension",[t.h(".chat-agent-hover-extension-name@extensionName"),t.h(".chat-agent-hover-separator@separator"),t.h(".chat-agent-hover-publisher@publisher")])])]),t.h(".chat-agent-hover-warning@warning"),t.h("span.chat-agent-hover-description@description")]);this.domNode=n.root,this.icon=n.icon,this.name=n.name,this.extensionName=n.extensionName,this.description=n.description,n.separator.textContent="|";const i=t.$("span.extension-verified-publisher",void 0,d(A));this.publisherName=t.$("span.chat-agent-hover-publisher-name"),t.append(n.publisher,i,this.publisherName),n.warning.appendChild(d(x.warning)),n.warning.appendChild(t.$("span",void 0,l("reservedName","This chat extension is using a reserved name.")))}domNode;icon;name;extensionName;publisherName;description;_onDidChangeContents=this._register(new C);onDidChangeContents=this._onDidChangeContents.event;setAgent(o){const e=this.chatAgentService.getAgent(o);if(e.metadata.icon instanceof S){const i=t.$("img.icon");i.src=N.uriToBrowserUri(e.metadata.icon).toString(!0),this.icon.replaceChildren(t.$(".avatar",void 0,i))}else if(e.metadata.themeIcon){const i=t.$(b.asCSSSelector(e.metadata.themeIcon));this.icon.replaceChildren(t.$(".avatar.codicon-avatar",void 0,i))}this.domNode.classList.toggle("noExtensionName",!!e.isDynamic);const a=this.chatAgentNameService.getAgentNameRestriction(e);this.name.textContent=a?`@${e.name}`:E(e),this.extensionName.textContent=e.extensionDisplayName,this.publisherName.textContent=e.publisherDisplayName??e.extensionPublisherId;let n=e.description??"";if(n&&(n.match(/[\.\?\!] *$/)||(n+=".")),this.description.textContent=n,this.domNode.classList.toggle("allowedName",a),this.domNode.classList.toggle("verifiedPublisher",!1),!e.isDynamic){const i=this._register(new u);this.extensionService.getExtensions([{id:e.extensionId.value}],i.token).then(v=>{i.dispose(),v[0]?.publisherDomain?.verified&&(this.domNode.classList.toggle("verifiedPublisher",!0),this._onDidChangeContents.fire())})}}};m=c([h(0,w),h(1,D),h(2,y)],m);function K(s,r){return{actions:[{commandId:p,label:l("viewExtensionLabel","View Extension"),run:()=>{const o=s();o&&r.executeCommand(p,[o.extensionId.value])}}]}}export{m as ChatAgentHover,K as getChatAgentHoverOptions};
