{
  "version": 3,
  "sources": ["../../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/contrib/chatInputEditorHover.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditor } from '../../../../../editor/browser/editorBrowser.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { IModelDecoration } from '../../../../../editor/common/model.js';\nimport { HoverAnchor, HoverAnchorType, HoverParticipantRegistry, IEditorHoverParticipant, IEditorHoverRenderContext, IHoverPart, IRenderedHoverPart, IRenderedHoverParts, RenderedHoverParts } from '../../../../../editor/contrib/hover/browser/hoverTypes.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IChatWidgetService } from '../chat.js';\nimport { ChatAgentHover, getChatAgentHoverOptions } from '../chatAgentHover.js';\nimport { ChatEditorHoverWrapper } from './editorHoverWrapper.js';\nimport { IChatAgentData } from '../../common/chatAgents.js';\nimport { extractAgentAndCommand } from '../../common/chatParserTypes.js';\nimport * as nls from '../../../../../nls.js';\n\nexport class ChatAgentHoverParticipant implements IEditorHoverParticipant<ChatAgentHoverPart> {\n\n\tpublic readonly hoverOrdinal: number = 1;\n\n\tconstructor(\n\t\tprivate readonly editor: ICodeEditor,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IChatWidgetService private readonly chatWidgetService: IChatWidgetService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t) { }\n\n\tpublic computeSync(anchor: HoverAnchor, _lineDecorations: IModelDecoration[]): ChatAgentHoverPart[] {\n\t\tif (!this.editor.hasModel()) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst widget = this.chatWidgetService.getWidgetByInputUri(this.editor.getModel().uri);\n\t\tif (!widget) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst { agentPart } = extractAgentAndCommand(widget.parsedInput);\n\t\tif (!agentPart) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (Range.containsPosition(agentPart.editorRange, anchor.range.getStartPosition())) {\n\t\t\treturn [new ChatAgentHoverPart(this, Range.lift(agentPart.editorRange), agentPart.agent)];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tpublic renderHoverParts(context: IEditorHoverRenderContext, hoverParts: ChatAgentHoverPart[]): IRenderedHoverParts<ChatAgentHoverPart> {\n\t\tif (!hoverParts.length) {\n\t\t\treturn new RenderedHoverParts([]);\n\t\t}\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst hover = disposables.add(this.instantiationService.createInstance(ChatAgentHover));\n\t\tdisposables.add(hover.onDidChangeContents(() => context.onContentsChanged()));\n\t\tconst hoverPart = hoverParts[0];\n\t\tconst agent = hoverPart.agent;\n\t\thover.setAgent(agent.id);\n\n\t\tconst actions = getChatAgentHoverOptions(() => agent, this.commandService).actions;\n\t\tconst wrapper = this.instantiationService.createInstance(ChatEditorHoverWrapper, hover.domNode, actions);\n\t\tconst wrapperNode = wrapper.domNode;\n\t\tcontext.fragment.appendChild(wrapperNode);\n\t\tconst renderedHoverPart: IRenderedHoverPart<ChatAgentHoverPart> = {\n\t\t\thoverPart,\n\t\t\thoverElement: wrapperNode,\n\t\t\tdispose() { disposables.dispose(); }\n\t\t};\n\t\treturn new RenderedHoverParts([renderedHoverPart]);\n\t}\n\n\tpublic getAccessibleContent(hoverPart: ChatAgentHoverPart): string {\n\t\treturn nls.localize('hoverAccessibilityChatAgent', 'There is a chat agent hover part here.');\n\n\t}\n}\n\nexport class ChatAgentHoverPart implements IHoverPart {\n\n\tconstructor(\n\t\tpublic readonly owner: IEditorHoverParticipant<ChatAgentHoverPart>,\n\t\tpublic readonly range: Range,\n\t\tpublic readonly agent: IChatAgentData\n\t) { }\n\n\tpublic isValidForHoverAnchor(anchor: HoverAnchor): boolean {\n\t\treturn (\n\t\t\tanchor.type === HoverAnchorType.Range\n\t\t\t&& this.range.startColumn <= anchor.range.startColumn\n\t\t\t&& this.range.endColumn >= anchor.range.endColumn\n\t\t);\n\t}\n}\n\nHoverParticipantRegistry.register(ChatAgentHoverParticipant);\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,uBAAuB;AAChC,SAAS,mBAAmB;AAC5B,SAAS,aAAa;AACtB,SAAS,wBAAwB;AACjC,SAAS,aAAa,iBAAiB,0BAA0B,yBAAyB,2BAA2B,YAAY,oBAAoB,qBAAqB,0BAA0B;AACpM,SAAS,uBAAuB;AAChC,SAAS,6BAA6B;AACtC,SAAS,0BAA0B;AACnC,SAAS,gBAAgB,gCAAgC;AACzD,SAAS,8BAA8B;AACvC,SAAS,sBAAsB;AAC/B,SAAS,8BAA8B;AACvC,YAAY,SAAS;AAEd,IAAM,4BAAN,MAAuF;AAAA,EAI7F,YACkB,QACuB,sBACH,mBACH,gBACjC;AAJgB;AACuB;AACH;AACH;AAAA,EAC/B;AAAA,EA5BL,OAmB8F;AAAA;AAAA;AAAA,EAE7E,eAAuB;AAAA,EAShC,YAAY,QAAqB,kBAA4D;AACnG,QAAI,CAAC,KAAK,OAAO,SAAS,GAAG;AAC5B,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,SAAS,KAAK,kBAAkB,oBAAoB,KAAK,OAAO,SAAS,EAAE,GAAG;AACpF,QAAI,CAAC,QAAQ;AACZ,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,EAAE,UAAU,IAAI,uBAAuB,OAAO,WAAW;AAC/D,QAAI,CAAC,WAAW;AACf,aAAO,CAAC;AAAA,IACT;AAEA,QAAI,MAAM,iBAAiB,UAAU,aAAa,OAAO,MAAM,iBAAiB,CAAC,GAAG;AACnF,aAAO,CAAC,IAAI,mBAAmB,MAAM,MAAM,KAAK,UAAU,WAAW,GAAG,UAAU,KAAK,CAAC;AAAA,IACzF;AAEA,WAAO,CAAC;AAAA,EACT;AAAA,EAEO,iBAAiB,SAAoC,YAA2E;AACtI,QAAI,CAAC,WAAW,QAAQ;AACvB,aAAO,IAAI,mBAAmB,CAAC,CAAC;AAAA,IACjC;AAEA,UAAM,cAAc,IAAI,gBAAgB;AACxC,UAAM,QAAQ,YAAY,IAAI,KAAK,qBAAqB,eAAe,cAAc,CAAC;AACtF,gBAAY,IAAI,MAAM,oBAAoB,MAAM,QAAQ,kBAAkB,CAAC,CAAC;AAC5E,UAAM,YAAY,WAAW,CAAC;AAC9B,UAAM,QAAQ,UAAU;AACxB,UAAM,SAAS,MAAM,EAAE;AAEvB,UAAM,UAAU,yBAAyB,MAAM,OAAO,KAAK,cAAc,EAAE;AAC3E,UAAM,UAAU,KAAK,qBAAqB,eAAe,wBAAwB,MAAM,SAAS,OAAO;AACvG,UAAM,cAAc,QAAQ;AAC5B,YAAQ,SAAS,YAAY,WAAW;AACxC,UAAM,oBAA4D;AAAA,MACjE;AAAA,MACA,cAAc;AAAA,MACd,UAAU;AAAE,oBAAY,QAAQ;AAAA,MAAG;AAAA,IACpC;AACA,WAAO,IAAI,mBAAmB,CAAC,iBAAiB,CAAC;AAAA,EAClD;AAAA,EAEO,qBAAqB,WAAuC;AAClE,WAAO,IAAI,SAAS,+BAA+B,wCAAwC;AAAA,EAE5F;AACD;AA7Da,4BAAN;AAAA,EAMJ;AAAA,EACA;AAAA,EACA;AAAA,GARU;AA+DN,MAAM,mBAAyC;AAAA,EAErD,YACiB,OACA,OACA,OACf;AAHe;AACA;AACA;AAAA,EACb;AAAA,EAxFL,OAkFsD;AAAA;AAAA;AAAA,EAQ9C,sBAAsB,QAA8B;AAC1D,WACC,OAAO,SAAS,gBAAgB,SAC7B,KAAK,MAAM,eAAe,OAAO,MAAM,eACvC,KAAK,MAAM,aAAa,OAAO,MAAM;AAAA,EAE1C;AACD;AAEA,yBAAyB,SAAS,yBAAyB;",
  "names": []
}
