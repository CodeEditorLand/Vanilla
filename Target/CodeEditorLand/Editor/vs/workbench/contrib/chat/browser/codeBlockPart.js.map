{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/codeBlockPart.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './codeBlockPart.css';\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { renderFormattedText } from '../../../../base/browser/formattedTextRenderer.js';\nimport { Button } from '../../../../base/browser/ui/button/button.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { combinedDisposable, Disposable, DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { IEditorConstructionOptions } from '../../../../editor/browser/config/editorConfiguration.js';\nimport { TabFocus } from '../../../../editor/browser/config/tabFocus.js';\nimport { IDiffEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { EditorExtensionsRegistry } from '../../../../editor/browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { CodeEditorWidget, ICodeEditorWidgetOptions } from '../../../../editor/browser/widget/codeEditor/codeEditorWidget.js';\nimport { DiffEditorWidget } from '../../../../editor/browser/widget/diffEditor/diffEditorWidget.js';\nimport { EDITOR_FONT_DEFAULTS, EditorOption, IEditorOptions } from '../../../../editor/common/config/editorOptions.js';\nimport { IRange, Range } from '../../../../editor/common/core/range.js';\nimport { ScrollType } from '../../../../editor/common/editorCommon.js';\nimport { TextEdit } from '../../../../editor/common/languages.js';\nimport { EndOfLinePreference, ITextModel } from '../../../../editor/common/model.js';\nimport { TextModelText } from '../../../../editor/common/model/textModelText.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { DefaultModelSHA1Computer } from '../../../../editor/common/services/modelService.js';\nimport { IResolvedTextEditorModel, ITextModelContentProvider, ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { BracketMatchingController } from '../../../../editor/contrib/bracketMatching/browser/bracketMatching.js';\nimport { ColorDetector } from '../../../../editor/contrib/colorPicker/browser/colorDetector.js';\nimport { ContextMenuController } from '../../../../editor/contrib/contextmenu/browser/contextmenu.js';\nimport { GotoDefinitionAtPositionEditorContribution } from '../../../../editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js';\nimport { ContentHoverController } from '../../../../editor/contrib/hover/browser/contentHoverController.js';\nimport { GlyphHoverController } from '../../../../editor/contrib/hover/browser/glyphHoverController.js';\nimport { LinkDetector } from '../../../../editor/contrib/links/browser/links.js';\nimport { MessageController } from '../../../../editor/contrib/message/browser/messageController.js';\nimport { ViewportSemanticTokensContribution } from '../../../../editor/contrib/semanticTokens/browser/viewportSemanticTokens.js';\nimport { SmartSelectController } from '../../../../editor/contrib/smartSelect/browser/smartSelect.js';\nimport { WordHighlighterContribution } from '../../../../editor/contrib/wordHighlighter/browser/wordHighlighter.js';\nimport { localize } from '../../../../nls.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { MenuWorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { FileKind } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ResourceLabel } from '../../../browser/labels.js';\nimport { ResourceContextKey } from '../../../common/contextkeys.js';\nimport { AccessibilityVerbositySettingId } from '../../accessibility/browser/accessibilityConfiguration.js';\nimport { InspectEditorTokensController } from '../../codeEditor/browser/inspectEditorTokens/inspectEditorTokens.js';\nimport { MenuPreventer } from '../../codeEditor/browser/menuPreventer.js';\nimport { SelectionClipboardContributionID } from '../../codeEditor/browser/selectionClipboard.js';\nimport { getSimpleEditorOptions } from '../../codeEditor/browser/simpleEditorOptions.js';\nimport { IMarkdownVulnerability } from '../common/annotations.js';\nimport { CONTEXT_CHAT_EDIT_APPLIED } from '../common/chatContextKeys.js';\nimport { IChatResponseModel, IChatTextEditGroup } from '../common/chatModel.js';\nimport { IChatResponseViewModel, isResponseVM } from '../common/chatViewModel.js';\nimport { ChatTreeItem } from './chat.js';\nimport { IChatRendererDelegate } from './chatListRenderer.js';\nimport { ChatEditorOptions } from './chatOptions.js';\n\nconst $ = dom.$;\n\nexport interface ICodeBlockData {\n\treadonly codeBlockIndex: number;\n\treadonly element: unknown;\n\n\treadonly textModel: Promise<IResolvedTextEditorModel>;\n\treadonly languageId: string;\n\n\treadonly vulns?: readonly IMarkdownVulnerability[];\n\treadonly range?: Range;\n\n\treadonly parentContextKeyService?: IContextKeyService;\n\treadonly hideToolbar?: boolean;\n}\n\n/**\n * Special markdown code block language id used to render a local file.\n *\n * The text of the code path should be a {@link LocalFileCodeBlockData} json object.\n */\nexport const localFileLanguageId = 'vscode-local-file';\n\n\nexport function parseLocalFileData(text: string) {\n\n\tinterface RawLocalFileCodeBlockData {\n\t\treadonly uri: UriComponents;\n\t\treadonly range?: IRange;\n\t}\n\n\tlet data: RawLocalFileCodeBlockData;\n\ttry {\n\t\tdata = JSON.parse(text);\n\t} catch (e) {\n\t\tthrow new Error('Could not parse code block local file data');\n\t}\n\n\tlet uri: URI;\n\ttry {\n\t\turi = URI.revive(data?.uri);\n\t} catch (e) {\n\t\tthrow new Error('Invalid code block local file data URI');\n\t}\n\n\tlet range: IRange | undefined;\n\tif (data.range) {\n\t\t// Note that since this is coming from extensions, position are actually zero based and must be converted.\n\t\trange = new Range(data.range.startLineNumber + 1, data.range.startColumn + 1, data.range.endLineNumber + 1, data.range.endColumn + 1);\n\t}\n\n\treturn { uri, range };\n}\n\nexport interface ICodeBlockActionContext {\n\tcode: string;\n\tlanguageId?: string;\n\tcodeBlockIndex: number;\n\telement: unknown;\n}\n\nconst defaultCodeblockPadding = 10;\nexport class CodeBlockPart extends Disposable {\n\tprotected readonly _onDidChangeContentHeight = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeContentHeight = this._onDidChangeContentHeight.event;\n\n\tpublic readonly editor: CodeEditorWidget;\n\tprotected readonly toolbar: MenuWorkbenchToolBar;\n\tprivate readonly contextKeyService: IContextKeyService;\n\n\tpublic readonly element: HTMLElement;\n\n\tprivate readonly vulnsButton: Button;\n\tprivate readonly vulnsListElement: HTMLElement;\n\n\tprivate currentCodeBlockData: ICodeBlockData | undefined;\n\tprivate currentScrollWidth = 0;\n\n\tprivate readonly disposableStore = this._register(new DisposableStore());\n\tprivate isDisposed = false;\n\n\tprivate resourceContextKey: ResourceContextKey;\n\n\tconstructor(\n\t\tprivate readonly options: ChatEditorOptions,\n\t\treadonly menuId: MenuId,\n\t\tdelegate: IChatRendererDelegate,\n\t\toverflowWidgetsDomNode: HTMLElement | undefined,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IModelService protected readonly modelService: IModelService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IAccessibilityService private readonly accessibilityService: IAccessibilityService,\n\t) {\n\t\tsuper();\n\t\tthis.element = $('.interactive-result-code-block');\n\n\t\tthis.resourceContextKey = this._register(instantiationService.createInstance(ResourceContextKey));\n\t\tthis.contextKeyService = this._register(contextKeyService.createScoped(this.element));\n\t\tconst scopedInstantiationService = this._register(instantiationService.createChild(new ServiceCollection([IContextKeyService, this.contextKeyService])));\n\t\tconst editorElement = dom.append(this.element, $('.interactive-result-editor'));\n\t\tthis.editor = this.createEditor(scopedInstantiationService, editorElement, {\n\t\t\t...getSimpleEditorOptions(this.configurationService),\n\t\t\treadOnly: true,\n\t\t\tlineNumbers: 'off',\n\t\t\tselectOnLineNumbers: true,\n\t\t\tscrollBeyondLastLine: false,\n\t\t\tlineDecorationsWidth: 8,\n\t\t\tdragAndDrop: false,\n\t\t\tpadding: { top: defaultCodeblockPadding, bottom: defaultCodeblockPadding },\n\t\t\tmouseWheelZoom: false,\n\t\t\tscrollbar: {\n\t\t\t\tvertical: 'hidden',\n\t\t\t\talwaysConsumeMouseWheel: false\n\t\t\t},\n\t\t\tdefinitionLinkOpensInPeek: false,\n\t\t\tgotoLocation: {\n\t\t\t\tmultiple: 'goto',\n\t\t\t\tmultipleDeclarations: 'goto',\n\t\t\t\tmultipleDefinitions: 'goto',\n\t\t\t\tmultipleImplementations: 'goto',\n\t\t\t},\n\t\t\tariaLabel: localize('chat.codeBlockHelp', 'Code block'),\n\t\t\toverflowWidgetsDomNode,\n\t\t\t...this.getEditorOptionsFromConfig(),\n\t\t});\n\n\t\tconst toolbarElement = dom.append(this.element, $('.interactive-result-code-block-toolbar'));\n\t\tconst editorScopedService = this.editor.contextKeyService.createScoped(toolbarElement);\n\t\tconst editorScopedInstantiationService = this._register(scopedInstantiationService.createChild(new ServiceCollection([IContextKeyService, editorScopedService])));\n\t\tthis.toolbar = this._register(editorScopedInstantiationService.createInstance(MenuWorkbenchToolBar, toolbarElement, menuId, {\n\t\t\tmenuOptions: {\n\t\t\t\tshouldForwardArgs: true\n\t\t\t}\n\t\t}));\n\n\t\tconst vulnsContainer = dom.append(this.element, $('.interactive-result-vulns'));\n\t\tconst vulnsHeaderElement = dom.append(vulnsContainer, $('.interactive-result-vulns-header', undefined));\n\t\tthis.vulnsButton = this._register(new Button(vulnsHeaderElement, {\n\t\t\tbuttonBackground: undefined,\n\t\t\tbuttonBorder: undefined,\n\t\t\tbuttonForeground: undefined,\n\t\t\tbuttonHoverBackground: undefined,\n\t\t\tbuttonSecondaryBackground: undefined,\n\t\t\tbuttonSecondaryForeground: undefined,\n\t\t\tbuttonSecondaryHoverBackground: undefined,\n\t\t\tbuttonSeparator: undefined,\n\t\t\tsupportIcons: true\n\t\t}));\n\n\t\tthis.vulnsListElement = dom.append(vulnsContainer, $('ul.interactive-result-vulns-list'));\n\n\t\tthis._register(this.vulnsButton.onDidClick(() => {\n\t\t\tconst element = this.currentCodeBlockData!.element as IChatResponseViewModel;\n\t\t\telement.vulnerabilitiesListExpanded = !element.vulnerabilitiesListExpanded;\n\t\t\tthis.vulnsButton.label = this.getVulnerabilitiesLabel();\n\t\t\tthis.element.classList.toggle('chat-vulnerabilities-collapsed', !element.vulnerabilitiesListExpanded);\n\t\t\tthis._onDidChangeContentHeight.fire();\n\t\t\t// this.updateAriaLabel(collapseButton.element, referencesLabel, element.usedReferencesExpanded);\n\t\t}));\n\n\t\tthis._register(this.toolbar.onDidChangeDropdownVisibility(e => {\n\t\t\ttoolbarElement.classList.toggle('force-visibility', e);\n\t\t}));\n\n\t\tthis._configureForScreenReader();\n\t\tthis._register(this.accessibilityService.onDidChangeScreenReaderOptimized(() => this._configureForScreenReader()));\n\t\tthis._register(this.configurationService.onDidChangeConfiguration((e) => {\n\t\t\tif (e.affectedKeys.has(AccessibilityVerbositySettingId.Chat)) {\n\t\t\t\tthis._configureForScreenReader();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.options.onDidChange(() => {\n\t\t\tthis.editor.updateOptions(this.getEditorOptionsFromConfig());\n\t\t}));\n\n\t\tthis._register(this.editor.onDidScrollChange(e => {\n\t\t\tthis.currentScrollWidth = e.scrollWidth;\n\t\t}));\n\t\tthis._register(this.editor.onDidContentSizeChange(e => {\n\t\t\tif (e.contentHeightChanged) {\n\t\t\t\tthis._onDidChangeContentHeight.fire();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this.editor.onDidBlurEditorWidget(() => {\n\t\t\tthis.element.classList.remove('focused');\n\t\t\tWordHighlighterContribution.get(this.editor)?.stopHighlighting();\n\t\t\tthis.clearWidgets();\n\t\t}));\n\t\tthis._register(this.editor.onDidFocusEditorWidget(() => {\n\t\t\tthis.element.classList.add('focused');\n\t\t\tWordHighlighterContribution.get(this.editor)?.restoreViewState(true);\n\t\t}));\n\n\t\t// Parent list scrolled\n\t\tif (delegate.onDidScroll) {\n\t\t\tthis._register(delegate.onDidScroll(e => {\n\t\t\t\tthis.clearWidgets();\n\t\t\t}));\n\t\t}\n\t}\n\n\toverride dispose() {\n\t\tthis.isDisposed = true;\n\t\tsuper.dispose();\n\t}\n\n\tget uri(): URI | undefined {\n\t\treturn this.editor.getModel()?.uri;\n\t}\n\n\tprivate createEditor(instantiationService: IInstantiationService, parent: HTMLElement, options: Readonly<IEditorConstructionOptions>): CodeEditorWidget {\n\t\treturn this._register(instantiationService.createInstance(CodeEditorWidget, parent, options, {\n\t\t\tisSimpleWidget: false,\n\t\t\tcontributions: EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tMenuPreventer.ID,\n\t\t\t\tSelectionClipboardContributionID,\n\t\t\t\tContextMenuController.ID,\n\n\t\t\t\tWordHighlighterContribution.ID,\n\t\t\t\tViewportSemanticTokensContribution.ID,\n\t\t\t\tBracketMatchingController.ID,\n\t\t\t\tSmartSelectController.ID,\n\t\t\t\tContentHoverController.ID,\n\t\t\t\tGlyphHoverController.ID,\n\t\t\t\tMessageController.ID,\n\t\t\t\tGotoDefinitionAtPositionEditorContribution.ID,\n\t\t\t\tColorDetector.ID,\n\t\t\t\tLinkDetector.ID,\n\n\t\t\t\tInspectEditorTokensController.ID,\n\t\t\t])\n\t\t}));\n\t}\n\n\tfocus(): void {\n\t\tthis.editor.focus();\n\t}\n\n\tprivate updatePaddingForLayout() {\n\t\t// scrollWidth = \"the width of the content that needs to be scrolled\"\n\t\t// contentWidth = \"the width of the area where content is displayed\"\n\t\tconst horizontalScrollbarVisible = this.currentScrollWidth > this.editor.getLayoutInfo().contentWidth;\n\t\tconst scrollbarHeight = this.editor.getLayoutInfo().horizontalScrollbarHeight;\n\t\tconst bottomPadding = horizontalScrollbarVisible ?\n\t\t\tMath.max(defaultCodeblockPadding - scrollbarHeight, 2) :\n\t\t\tdefaultCodeblockPadding;\n\t\tthis.editor.updateOptions({ padding: { top: defaultCodeblockPadding, bottom: bottomPadding } });\n\t}\n\n\tprivate _configureForScreenReader(): void {\n\t\tconst toolbarElt = this.toolbar.getElement();\n\t\tif (this.accessibilityService.isScreenReaderOptimized()) {\n\t\t\ttoolbarElt.style.display = 'block';\n\t\t\ttoolbarElt.ariaLabel = this.configurationService.getValue(AccessibilityVerbositySettingId.Chat) ? localize('chat.codeBlock.toolbarVerbose', 'Toolbar for code block which can be reached via tab') : localize('chat.codeBlock.toolbar', 'Code block toolbar');\n\t\t} else {\n\t\t\ttoolbarElt.style.display = '';\n\t\t}\n\t}\n\n\tprivate getEditorOptionsFromConfig(): IEditorOptions {\n\t\treturn {\n\t\t\twordWrap: this.options.configuration.resultEditor.wordWrap,\n\t\t\tfontLigatures: this.options.configuration.resultEditor.fontLigatures,\n\t\t\tbracketPairColorization: this.options.configuration.resultEditor.bracketPairColorization,\n\t\t\tfontFamily: this.options.configuration.resultEditor.fontFamily === 'default' ?\n\t\t\t\tEDITOR_FONT_DEFAULTS.fontFamily :\n\t\t\t\tthis.options.configuration.resultEditor.fontFamily,\n\t\t\tfontSize: this.options.configuration.resultEditor.fontSize,\n\t\t\tfontWeight: this.options.configuration.resultEditor.fontWeight,\n\t\t\tlineHeight: this.options.configuration.resultEditor.lineHeight,\n\t\t};\n\t}\n\n\tlayout(width: number): void {\n\t\tconst contentHeight = this.getContentHeight();\n\t\tconst editorBorder = 2;\n\t\tthis.editor.layout({ width: width - editorBorder, height: contentHeight });\n\t\tthis.updatePaddingForLayout();\n\t}\n\n\tprivate getContentHeight() {\n\t\tif (this.currentCodeBlockData?.range) {\n\t\t\tconst lineCount = this.currentCodeBlockData.range.endLineNumber - this.currentCodeBlockData.range.startLineNumber + 1;\n\t\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\t\treturn lineCount * lineHeight;\n\t\t}\n\t\treturn this.editor.getContentHeight();\n\t}\n\n\tasync render(data: ICodeBlockData, width: number, editable: boolean | undefined) {\n\t\tthis.currentCodeBlockData = data;\n\t\tif (data.parentContextKeyService) {\n\t\t\tthis.contextKeyService.updateParent(data.parentContextKeyService);\n\t\t}\n\n\t\tif (this.options.configuration.resultEditor.wordWrap === 'on') {\n\t\t\t// Initialize the editor with the new proper width so that getContentHeight\n\t\t\t// will be computed correctly in the next call to layout()\n\t\t\tthis.layout(width);\n\t\t}\n\n\t\tawait this.updateEditor(data);\n\t\tif (this.isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.layout(width);\n\t\tif (editable) {\n\t\t\tthis.disposableStore.clear();\n\t\t\tthis.disposableStore.add(this.editor.onDidFocusEditorWidget(() => TabFocus.setTabFocusMode(true)));\n\t\t\tthis.disposableStore.add(this.editor.onDidBlurEditorWidget(() => TabFocus.setTabFocusMode(false)));\n\t\t}\n\t\tthis.editor.updateOptions({ ariaLabel: localize('chat.codeBlockLabel', \"Code block {0}\", data.codeBlockIndex + 1), readOnly: !editable });\n\n\t\tif (data.hideToolbar) {\n\t\t\tdom.hide(this.toolbar.getElement());\n\t\t} else {\n\t\t\tdom.show(this.toolbar.getElement());\n\t\t}\n\n\t\tif (data.vulns?.length && isResponseVM(data.element)) {\n\t\t\tdom.clearNode(this.vulnsListElement);\n\t\t\tthis.element.classList.remove('no-vulns');\n\t\t\tthis.element.classList.toggle('chat-vulnerabilities-collapsed', !data.element.vulnerabilitiesListExpanded);\n\t\t\tdom.append(this.vulnsListElement, ...data.vulns.map(v => $('li', undefined, $('span.chat-vuln-title', undefined, v.title), ' ' + v.description)));\n\t\t\tthis.vulnsButton.label = this.getVulnerabilitiesLabel();\n\t\t} else {\n\t\t\tthis.element.classList.add('no-vulns');\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.clearWidgets();\n\t}\n\n\tprivate clearWidgets() {\n\t\tContentHoverController.get(this.editor)?.hideContentHover();\n\t\tGlyphHoverController.get(this.editor)?.hideContentHover();\n\t}\n\n\tprivate async updateEditor(data: ICodeBlockData): Promise<void> {\n\t\tconst textModel = (await data.textModel).textEditorModel;\n\t\tthis.editor.setModel(textModel);\n\t\tif (data.range) {\n\t\t\tthis.editor.setSelection(data.range);\n\t\t\tthis.editor.revealRangeInCenter(data.range, ScrollType.Immediate);\n\t\t}\n\n\t\tthis.toolbar.context = {\n\t\t\tcode: textModel.getTextBuffer().getValueInRange(data.range ?? textModel.getFullModelRange(), EndOfLinePreference.TextDefined),\n\t\t\tcodeBlockIndex: data.codeBlockIndex,\n\t\t\telement: data.element,\n\t\t\tlanguageId: textModel.getLanguageId()\n\t\t} satisfies ICodeBlockActionContext;\n\t\tthis.resourceContextKey.set(textModel.uri);\n\t}\n\n\tprivate getVulnerabilitiesLabel(): string {\n\t\tif (!this.currentCodeBlockData || !this.currentCodeBlockData.vulns) {\n\t\t\treturn '';\n\t\t}\n\n\t\tconst referencesLabel = this.currentCodeBlockData.vulns.length > 1 ?\n\t\t\tlocalize('vulnerabilitiesPlural', \"{0} vulnerabilities\", this.currentCodeBlockData.vulns.length) :\n\t\t\tlocalize('vulnerabilitiesSingular', \"{0} vulnerability\", 1);\n\t\tconst icon = (element: IChatResponseViewModel) => element.vulnerabilitiesListExpanded ? Codicon.chevronDown : Codicon.chevronRight;\n\t\treturn `${referencesLabel} $(${icon(this.currentCodeBlockData.element as IChatResponseViewModel).id})`;\n\t}\n}\n\nexport class ChatCodeBlockContentProvider extends Disposable implements ITextModelContentProvider {\n\n\tconstructor(\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t) {\n\t\tsuper();\n\t\tthis._register(textModelService.registerTextModelContentProvider(Schemas.vscodeChatCodeBlock, this));\n\t}\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this._modelService.getModel(resource);\n\t\tif (existing) {\n\t\t\treturn existing;\n\t\t}\n\t\treturn this._modelService.createModel('', null, resource);\n\t}\n}\n\n//\n\nexport interface ICodeCompareBlockActionContext {\n\treadonly element: IChatResponseViewModel;\n\treadonly diffEditor: IDiffEditor;\n\treadonly edit: IChatTextEditGroup;\n}\n\nexport interface ICodeCompareBlockDiffData {\n\tmodified: ITextModel;\n\toriginal: ITextModel;\n\toriginalSha1: string;\n}\n\nexport interface ICodeCompareBlockData {\n\treadonly element: ChatTreeItem;\n\n\treadonly edit: IChatTextEditGroup;\n\n\treadonly diffData: Promise<ICodeCompareBlockDiffData | undefined>;\n\n\treadonly parentContextKeyService?: IContextKeyService;\n\t// readonly hideToolbar?: boolean;\n}\n\n\n// long-lived object that sits in the DiffPool and that gets reused\nexport class CodeCompareBlockPart extends Disposable {\n\tprotected readonly _onDidChangeContentHeight = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeContentHeight = this._onDidChangeContentHeight.event;\n\n\tprivate readonly contextKeyService: IContextKeyService;\n\tprivate readonly diffEditor: DiffEditorWidget;\n\tprivate readonly resourceLabel: ResourceLabel;\n\tprivate readonly toolbar: MenuWorkbenchToolBar;\n\treadonly element: HTMLElement;\n\tprivate readonly messageElement: HTMLElement;\n\n\tprivate readonly _lastDiffEditorViewModel = this._store.add(new MutableDisposable());\n\tprivate currentScrollWidth = 0;\n\n\tconstructor(\n\t\tprivate readonly options: ChatEditorOptions,\n\t\treadonly menuId: MenuId,\n\t\tdelegate: IChatRendererDelegate,\n\t\toverflowWidgetsDomNode: HTMLElement | undefined,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IModelService protected readonly modelService: IModelService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IAccessibilityService private readonly accessibilityService: IAccessibilityService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t) {\n\t\tsuper();\n\t\tthis.element = $('.interactive-result-code-block');\n\t\tthis.element.classList.add('compare');\n\n\t\tthis.messageElement = dom.append(this.element, $('.message'));\n\t\tthis.messageElement.setAttribute('role', 'status');\n\t\tthis.messageElement.tabIndex = 0;\n\n\t\tthis.contextKeyService = this._register(contextKeyService.createScoped(this.element));\n\t\tconst scopedInstantiationService = this._register(instantiationService.createChild(new ServiceCollection([IContextKeyService, this.contextKeyService])));\n\t\tconst editorHeader = dom.append(this.element, $('.interactive-result-header.show-file-icons'));\n\t\tconst editorElement = dom.append(this.element, $('.interactive-result-editor'));\n\t\tthis.diffEditor = this.createDiffEditor(scopedInstantiationService, editorElement, {\n\t\t\t...getSimpleEditorOptions(this.configurationService),\n\t\t\tlineNumbers: 'on',\n\t\t\tselectOnLineNumbers: true,\n\t\t\tscrollBeyondLastLine: false,\n\t\t\tlineDecorationsWidth: 12,\n\t\t\tdragAndDrop: false,\n\t\t\tpadding: { top: defaultCodeblockPadding, bottom: defaultCodeblockPadding },\n\t\t\tmouseWheelZoom: false,\n\t\t\tscrollbar: {\n\t\t\t\tvertical: 'hidden',\n\t\t\t\talwaysConsumeMouseWheel: false\n\t\t\t},\n\t\t\tdefinitionLinkOpensInPeek: false,\n\t\t\tgotoLocation: {\n\t\t\t\tmultiple: 'goto',\n\t\t\t\tmultipleDeclarations: 'goto',\n\t\t\t\tmultipleDefinitions: 'goto',\n\t\t\t\tmultipleImplementations: 'goto',\n\t\t\t},\n\t\t\tariaLabel: localize('chat.codeBlockHelp', 'Code block'),\n\t\t\toverflowWidgetsDomNode,\n\t\t\t...this.getEditorOptionsFromConfig(),\n\t\t});\n\n\t\tthis.resourceLabel = this._register(scopedInstantiationService.createInstance(ResourceLabel, editorHeader, { supportIcons: true }));\n\n\t\tconst editorScopedService = this.diffEditor.getModifiedEditor().contextKeyService.createScoped(editorHeader);\n\t\tconst editorScopedInstantiationService = this._register(scopedInstantiationService.createChild(new ServiceCollection([IContextKeyService, editorScopedService])));\n\t\tthis.toolbar = this._register(editorScopedInstantiationService.createInstance(MenuWorkbenchToolBar, editorHeader, menuId, {\n\t\t\tmenuOptions: {\n\t\t\t\tshouldForwardArgs: true\n\t\t\t}\n\t\t}));\n\n\t\tthis._configureForScreenReader();\n\t\tthis._register(this.accessibilityService.onDidChangeScreenReaderOptimized(() => this._configureForScreenReader()));\n\t\tthis._register(this.configurationService.onDidChangeConfiguration((e) => {\n\t\t\tif (e.affectedKeys.has(AccessibilityVerbositySettingId.Chat)) {\n\t\t\t\tthis._configureForScreenReader();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.options.onDidChange(() => {\n\t\t\tthis.diffEditor.updateOptions(this.getEditorOptionsFromConfig());\n\t\t}));\n\n\t\tthis._register(this.diffEditor.getModifiedEditor().onDidScrollChange(e => {\n\t\t\tthis.currentScrollWidth = e.scrollWidth;\n\t\t}));\n\t\tthis._register(this.diffEditor.onDidContentSizeChange(e => {\n\t\t\tif (e.contentHeightChanged) {\n\t\t\t\tthis._onDidChangeContentHeight.fire();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this.diffEditor.getModifiedEditor().onDidBlurEditorWidget(() => {\n\t\t\tthis.element.classList.remove('focused');\n\t\t\tWordHighlighterContribution.get(this.diffEditor.getModifiedEditor())?.stopHighlighting();\n\t\t\tthis.clearWidgets();\n\t\t}));\n\t\tthis._register(this.diffEditor.getModifiedEditor().onDidFocusEditorWidget(() => {\n\t\t\tthis.element.classList.add('focused');\n\t\t\tWordHighlighterContribution.get(this.diffEditor.getModifiedEditor())?.restoreViewState(true);\n\t\t}));\n\n\n\t\t// Parent list scrolled\n\t\tif (delegate.onDidScroll) {\n\t\t\tthis._register(delegate.onDidScroll(e => {\n\t\t\t\tthis.clearWidgets();\n\t\t\t}));\n\t\t}\n\t}\n\n\tget uri(): URI | undefined {\n\t\treturn this.diffEditor.getModifiedEditor().getModel()?.uri;\n\t}\n\n\tprivate createDiffEditor(instantiationService: IInstantiationService, parent: HTMLElement, options: Readonly<IEditorConstructionOptions>): DiffEditorWidget {\n\t\tconst widgetOptions: ICodeEditorWidgetOptions = {\n\t\t\tisSimpleWidget: false,\n\t\t\tcontributions: EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tMenuPreventer.ID,\n\t\t\t\tSelectionClipboardContributionID,\n\t\t\t\tContextMenuController.ID,\n\n\t\t\t\tWordHighlighterContribution.ID,\n\t\t\t\tViewportSemanticTokensContribution.ID,\n\t\t\t\tBracketMatchingController.ID,\n\t\t\t\tSmartSelectController.ID,\n\t\t\t\tContentHoverController.ID,\n\t\t\t\tGlyphHoverController.ID,\n\t\t\t\tGotoDefinitionAtPositionEditorContribution.ID,\n\t\t\t])\n\t\t};\n\n\t\treturn this._register(instantiationService.createInstance(DiffEditorWidget, parent, {\n\t\t\tscrollbar: { useShadows: false, alwaysConsumeMouseWheel: false, ignoreHorizontalScrollbarInContentHeight: true, },\n\t\t\trenderMarginRevertIcon: false,\n\t\t\tdiffCodeLens: false,\n\t\t\tscrollBeyondLastLine: false,\n\t\t\tstickyScroll: { enabled: false },\n\t\t\toriginalAriaLabel: localize('original', 'Original'),\n\t\t\tmodifiedAriaLabel: localize('modified', 'Modified'),\n\t\t\tdiffAlgorithm: 'advanced',\n\t\t\treadOnly: false,\n\t\t\tisInEmbeddedEditor: true,\n\t\t\tuseInlineViewWhenSpaceIsLimited: true,\n\t\t\texperimental: {\n\t\t\t\tuseTrueInlineView: true,\n\t\t\t},\n\t\t\trenderSideBySideInlineBreakpoint: 300,\n\t\t\trenderOverviewRuler: false,\n\t\t\tcompactMode: true,\n\t\t\thideUnchangedRegions: { enabled: true, contextLineCount: 1 },\n\t\t\trenderGutterMenu: false,\n\t\t\tlineNumbersMinChars: 1,\n\t\t\t...options\n\t\t}, { originalEditor: widgetOptions, modifiedEditor: widgetOptions }));\n\t}\n\n\tfocus(): void {\n\t\tthis.diffEditor.focus();\n\t}\n\n\tprivate updatePaddingForLayout() {\n\t\t// scrollWidth = \"the width of the content that needs to be scrolled\"\n\t\t// contentWidth = \"the width of the area where content is displayed\"\n\t\tconst horizontalScrollbarVisible = this.currentScrollWidth > this.diffEditor.getModifiedEditor().getLayoutInfo().contentWidth;\n\t\tconst scrollbarHeight = this.diffEditor.getModifiedEditor().getLayoutInfo().horizontalScrollbarHeight;\n\t\tconst bottomPadding = horizontalScrollbarVisible ?\n\t\t\tMath.max(defaultCodeblockPadding - scrollbarHeight, 2) :\n\t\t\tdefaultCodeblockPadding;\n\t\tthis.diffEditor.updateOptions({ padding: { top: defaultCodeblockPadding, bottom: bottomPadding } });\n\t}\n\n\tprivate _configureForScreenReader(): void {\n\t\tconst toolbarElt = this.toolbar.getElement();\n\t\tif (this.accessibilityService.isScreenReaderOptimized()) {\n\t\t\ttoolbarElt.style.display = 'block';\n\t\t\ttoolbarElt.ariaLabel = this.configurationService.getValue(AccessibilityVerbositySettingId.Chat) ? localize('chat.codeBlock.toolbarVerbose', 'Toolbar for code block which can be reached via tab') : localize('chat.codeBlock.toolbar', 'Code block toolbar');\n\t\t} else {\n\t\t\ttoolbarElt.style.display = '';\n\t\t}\n\t}\n\n\tprivate getEditorOptionsFromConfig(): IEditorOptions {\n\t\treturn {\n\t\t\twordWrap: this.options.configuration.resultEditor.wordWrap,\n\t\t\tfontLigatures: this.options.configuration.resultEditor.fontLigatures,\n\t\t\tbracketPairColorization: this.options.configuration.resultEditor.bracketPairColorization,\n\t\t\tfontFamily: this.options.configuration.resultEditor.fontFamily === 'default' ?\n\t\t\t\tEDITOR_FONT_DEFAULTS.fontFamily :\n\t\t\t\tthis.options.configuration.resultEditor.fontFamily,\n\t\t\tfontSize: this.options.configuration.resultEditor.fontSize,\n\t\t\tfontWeight: this.options.configuration.resultEditor.fontWeight,\n\t\t\tlineHeight: this.options.configuration.resultEditor.lineHeight,\n\t\t};\n\t}\n\n\tlayout(width: number): void {\n\t\tconst contentHeight = this.getContentHeight();\n\t\tconst editorBorder = 2;\n\t\tconst dimension = { width: width - editorBorder, height: contentHeight };\n\t\tthis.element.style.height = `${dimension.height}px`;\n\t\tthis.element.style.width = `${dimension.width}px`;\n\t\tthis.diffEditor.layout(dimension);\n\t\tthis.updatePaddingForLayout();\n\t}\n\n\tprivate getContentHeight() {\n\t\treturn this.diffEditor.getModel()\n\t\t\t? this.diffEditor.getContentHeight()\n\t\t\t: dom.getTotalHeight(this.messageElement);\n\t}\n\n\tasync render(data: ICodeCompareBlockData, width: number, token: CancellationToken) {\n\t\tif (data.parentContextKeyService) {\n\t\t\tthis.contextKeyService.updateParent(data.parentContextKeyService);\n\t\t}\n\n\t\tif (this.options.configuration.resultEditor.wordWrap === 'on') {\n\t\t\t// Initialize the editor with the new proper width so that getContentHeight\n\t\t\t// will be computed correctly in the next call to layout()\n\t\t\tthis.layout(width);\n\t\t}\n\n\t\tawait this.updateEditor(data, token);\n\n\t\tthis.layout(width);\n\t\tthis.diffEditor.updateOptions({ ariaLabel: localize('chat.compareCodeBlockLabel', \"Code Edits\") });\n\n\t\tthis.resourceLabel.element.setFile(data.edit.uri, {\n\t\t\tfileKind: FileKind.FILE,\n\t\t\tfileDecorations: { colors: true, badges: false }\n\t\t});\n\t}\n\n\treset() {\n\t\tthis.clearWidgets();\n\t}\n\n\tprivate clearWidgets() {\n\t\tContentHoverController.get(this.diffEditor.getOriginalEditor())?.hideContentHover();\n\t\tContentHoverController.get(this.diffEditor.getModifiedEditor())?.hideContentHover();\n\t\tGlyphHoverController.get(this.diffEditor.getOriginalEditor())?.hideContentHover();\n\t\tGlyphHoverController.get(this.diffEditor.getModifiedEditor())?.hideContentHover();\n\t}\n\n\tprivate async updateEditor(data: ICodeCompareBlockData, token: CancellationToken): Promise<void> {\n\n\t\tif (!isResponseVM(data.element)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isEditApplied = Boolean(data.edit.state?.applied ?? 0);\n\n\t\tCONTEXT_CHAT_EDIT_APPLIED.bindTo(this.contextKeyService).set(isEditApplied);\n\n\t\tthis.element.classList.toggle('no-diff', isEditApplied);\n\n\t\tif (isEditApplied) {\n\t\t\tassertType(data.edit.state?.applied);\n\n\t\t\tconst uriLabel = this.labelService.getUriLabel(data.edit.uri, { relative: true, noPrefix: true });\n\n\t\t\tlet template: string;\n\t\t\tif (data.edit.state.applied === 1) {\n\t\t\t\ttemplate = localize('chat.edits.1', \"Made 1 change in [[``{0}``]]\", uriLabel);\n\t\t\t} else if (data.edit.state.applied < 0) {\n\t\t\t\ttemplate = localize('chat.edits.rejected', \"Edits in [[``{0}``]] have been rejected\", uriLabel);\n\t\t\t} else {\n\t\t\t\ttemplate = localize('chat.edits.N', \"Made {0} changes in [[``{1}``]]\", data.edit.state.applied, uriLabel);\n\t\t\t}\n\n\t\t\tconst message = renderFormattedText(template, {\n\t\t\t\trenderCodeSegments: true,\n\t\t\t\tactionHandler: {\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.openerService.open(data.edit.uri, { fromUserGesture: true, allowCommands: false });\n\t\t\t\t\t},\n\t\t\t\t\tdisposables: this._store,\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdom.reset(this.messageElement, message);\n\t\t}\n\n\t\tconst diffData = await data.diffData;\n\n\t\tif (!isEditApplied && diffData) {\n\t\t\tconst viewModel = this.diffEditor.createViewModel({\n\t\t\t\toriginal: diffData.original,\n\t\t\t\tmodified: diffData.modified\n\t\t\t});\n\n\t\t\tawait viewModel.waitForDiff();\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst listener = Event.any(diffData.original.onWillDispose, diffData.modified.onWillDispose)(() => {\n\t\t\t\t// this a bit weird and basically duplicates https://github.com/microsoft/vscode/blob/7cbcafcbcc88298cfdcd0238018fbbba8eb6853e/src/vs/editor/browser/widget/diffEditor/diffEditorWidget.ts#L328\n\t\t\t\t// which cannot call `setModel(null)` without first complaining\n\t\t\t\tthis.diffEditor.setModel(null);\n\t\t\t});\n\t\t\tthis.diffEditor.setModel(viewModel);\n\t\t\tthis._lastDiffEditorViewModel.value = combinedDisposable(listener, viewModel);\n\n\t\t} else {\n\t\t\tthis.diffEditor.setModel(null);\n\t\t\tthis._lastDiffEditorViewModel.value = undefined;\n\t\t\tthis._onDidChangeContentHeight.fire();\n\t\t}\n\n\t\tthis.toolbar.context = {\n\t\t\tedit: data.edit,\n\t\t\telement: data.element,\n\t\t\tdiffEditor: this.diffEditor,\n\t\t} satisfies ICodeCompareBlockActionContext;\n\t}\n}\n\nexport class DefaultChatTextEditor {\n\n\tprivate readonly _sha1 = new DefaultModelSHA1Computer();\n\n\tconstructor(\n\t\t@ITextModelService private readonly modelService: ITextModelService,\n\t\t@ICodeEditorService private readonly editorService: ICodeEditorService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t) { }\n\n\tasync apply(response: IChatResponseModel | IChatResponseViewModel, item: IChatTextEditGroup, diffEditor: IDiffEditor | undefined): Promise<void> {\n\n\t\tif (!response.response.value.includes(item)) {\n\t\t\t// bogous item\n\t\t\treturn;\n\t\t}\n\n\t\tif (item.state?.applied) {\n\t\t\t// already applied\n\t\t\treturn;\n\t\t}\n\n\t\tif (!diffEditor) {\n\t\t\tfor (const candidate of this.editorService.listDiffEditors()) {\n\t\t\t\tif (!candidate.getContainerDomNode().isConnected) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst model = candidate.getModel();\n\t\t\t\tif (!model || !isEqual(model.original.uri, item.uri) || model.modified.uri.scheme !== Schemas.vscodeChatCodeCompareBlock) {\n\t\t\t\t\tdiffEditor = candidate;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst edits = diffEditor\n\t\t\t? await this._applyWithDiffEditor(diffEditor, item)\n\t\t\t: await this._apply(item);\n\n\t\tresponse.setEditApplied(item, edits);\n\t}\n\n\tprivate async _applyWithDiffEditor(diffEditor: IDiffEditor, item: IChatTextEditGroup) {\n\t\tconst model = diffEditor.getModel();\n\t\tif (!model) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst diff = diffEditor.getDiffComputationResult();\n\t\tif (!diff || diff.identical) {\n\t\t\treturn 0;\n\t\t}\n\n\n\t\tif (!await this._checkSha1(model.original, item)) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst modified = new TextModelText(model.modified);\n\t\tconst edits = diff.changes2.map(i => i.toRangeMapping().toTextEdit(modified).toSingleEditOperation());\n\n\t\tmodel.original.pushStackElement();\n\t\tmodel.original.pushEditOperations(null, edits, () => null);\n\t\tmodel.original.pushStackElement();\n\n\t\treturn edits.length;\n\t}\n\n\tprivate async _apply(item: IChatTextEditGroup) {\n\t\tconst ref = await this.modelService.createModelReference(item.uri);\n\t\ttry {\n\n\t\t\tif (!await this._checkSha1(ref.object.textEditorModel, item)) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tref.object.textEditorModel.pushStackElement();\n\t\t\tlet total = 0;\n\t\t\tfor (const group of item.edits) {\n\t\t\t\tconst edits = group.map(TextEdit.asEditOperation);\n\t\t\t\tref.object.textEditorModel.pushEditOperations(null, edits, () => null);\n\t\t\t\ttotal += edits.length;\n\t\t\t}\n\t\t\tref.object.textEditorModel.pushStackElement();\n\t\t\treturn total;\n\n\t\t} finally {\n\t\t\tref.dispose();\n\t\t}\n\t}\n\n\tprivate async _checkSha1(model: ITextModel, item: IChatTextEditGroup) {\n\t\tif (item.state?.sha1 && this._sha1.computeSHA1(model) && this._sha1.computeSHA1(model) !== item.state.sha1) {\n\t\t\tconst result = await this.dialogService.confirm({\n\t\t\t\tmessage: localize('interactive.compare.apply.confirm', \"The original file has been modified.\"),\n\t\t\t\tdetail: localize('interactive.compare.apply.confirm.detail', \"Do you want to apply the changes anyway?\"),\n\t\t\t});\n\n\t\t\tif (!result.confirmed) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tdiscard(response: IChatResponseModel | IChatResponseViewModel, item: IChatTextEditGroup) {\n\t\tif (!response.response.value.includes(item)) {\n\t\t\t// bogous item\n\t\t\treturn;\n\t\t}\n\n\t\tif (item.state?.applied) {\n\t\t\t// already applied\n\t\t\treturn;\n\t\t}\n\n\t\tresponse.setEditApplied(item, -1);\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA,OAAO;AAEP,YAAY,SAAS;AACrB,SAAS,2BAA2B;AACpC,SAAS,cAAc;AACvB,SAAS,yBAAyB;AAClC,SAAS,eAAe;AACxB,SAAS,SAAS,aAAa;AAC/B,SAAS,oBAAoB,YAAY,iBAAiB,yBAAyB;AACnF,SAAS,eAAe;AACxB,SAAS,eAAe;AACxB,SAAS,kBAAkB;AAC3B,SAAS,KAAK,qBAAqB;AACnC,SAAS,kCAAkC;AAC3C,SAAS,gBAAgB;AACzB,SAAS,mBAAmB;AAC5B,SAAS,gCAAgC;AACzC,SAAS,0BAA0B;AACnC,SAAS,kBAAkB,gCAAgC;AAC3D,SAAS,wBAAwB;AACjC,SAAS,sBAAsB,cAAc,sBAAsB;AACnE,SAAS,QAAQ,aAAa;AAC9B,SAAS,kBAAkB;AAC3B,SAAS,gBAAgB;AACzB,SAAS,qBAAqB,kBAAkB;AAChD,SAAS,qBAAqB;AAC9B,SAAS,qBAAqB;AAC9B,SAAS,gCAAgC;AACzC,SAAS,0BAA0B,2BAA2B,yBAAyB;AACvF,SAAS,iCAAiC;AAC1C,SAAS,qBAAqB;AAC9B,SAAS,6BAA6B;AACtC,SAAS,kDAAkD;AAC3D,SAAS,8BAA8B;AACvC,SAAS,4BAA4B;AACrC,SAAS,oBAAoB;AAC7B,SAAS,yBAAyB;AAClC,SAAS,0CAA0C;AACnD,SAAS,6BAA6B;AACtC,SAAS,mCAAmC;AAC5C,SAAS,gBAAgB;AACzB,SAAS,6BAA6B;AACtC,SAAS,4BAA4B;AACrC,SAAS,cAAc;AACvB,SAAS,6BAA6B;AACtC,SAAS,0BAA0B;AACnC,SAAS,sBAAsB;AAC/B,SAAS,gBAAgB;AACzB,SAAS,6BAA6B;AACtC,SAAS,yBAAyB;AAClC,SAAS,qBAAqB;AAC9B,SAAS,sBAAsB;AAC/B,SAAS,qBAAqB;AAC9B,SAAS,0BAA0B;AACnC,SAAS,uCAAuC;AAChD,SAAS,qCAAqC;AAC9C,SAAS,qBAAqB;AAC9B,SAAS,wCAAwC;AACjD,SAAS,8BAA8B;AACvC,SAAS,8BAA8B;AACvC,SAAS,iCAAiC;AAC1C,SAAS,oBAAoB,0BAA0B;AACvD,SAAS,wBAAwB,oBAAoB;AACrD,SAAS,oBAAoB;AAC7B,SAAS,6BAA6B;AACtC,SAAS,yBAAyB;AAElC,MAAM,IAAI,IAAI;AAqBP,MAAM,sBAAsB;AAG5B,SAAS,mBAAmB,MAAc;AAOhD,MAAI;AACJ,MAAI;AACH,WAAO,KAAK,MAAM,IAAI;AAAA,EACvB,SAAS,GAAG;AACX,UAAM,IAAI,MAAM,4CAA4C;AAAA,EAC7D;AAEA,MAAI;AACJ,MAAI;AACH,UAAM,IAAI,OAAO,MAAM,GAAG;AAAA,EAC3B,SAAS,GAAG;AACX,UAAM,IAAI,MAAM,wCAAwC;AAAA,EACzD;AAEA,MAAI;AACJ,MAAI,KAAK,OAAO;AAEf,YAAQ,IAAI,MAAM,KAAK,MAAM,kBAAkB,GAAG,KAAK,MAAM,cAAc,GAAG,KAAK,MAAM,gBAAgB,GAAG,KAAK,MAAM,YAAY,CAAC;AAAA,EACrI;AAEA,SAAO,EAAE,KAAK,MAAM;AACrB;AA5BgB;AAqChB,MAAM,0BAA0B;AACzB,IAAM,gBAAN,cAA4B,WAAW;AAAA,EAqB7C,YACkB,SACR,QACT,UACA,wBACuB,sBACH,mBACc,cACM,sBACA,sBACvC;AACD,UAAM;AAVW;AACR;AAKyB;AACM;AACA;AAGxC,SAAK,UAAU,EAAE,gCAAgC;AAEjD,SAAK,qBAAqB,KAAK,UAAU,qBAAqB,eAAe,kBAAkB,CAAC;AAChG,SAAK,oBAAoB,KAAK,UAAU,kBAAkB,aAAa,KAAK,OAAO,CAAC;AACpF,UAAM,6BAA6B,KAAK,UAAU,qBAAqB,YAAY,IAAI,kBAAkB,CAAC,oBAAoB,KAAK,iBAAiB,CAAC,CAAC,CAAC;AACvJ,UAAM,gBAAgB,IAAI,OAAO,KAAK,SAAS,EAAE,4BAA4B,CAAC;AAC9E,SAAK,SAAS,KAAK,aAAa,4BAA4B,eAAe;AAAA,MAC1E,GAAG,uBAAuB,KAAK,oBAAoB;AAAA,MACnD,UAAU;AAAA,MACV,aAAa;AAAA,MACb,qBAAqB;AAAA,MACrB,sBAAsB;AAAA,MACtB,sBAAsB;AAAA,MACtB,aAAa;AAAA,MACb,SAAS,EAAE,KAAK,yBAAyB,QAAQ,wBAAwB;AAAA,MACzE,gBAAgB;AAAA,MAChB,WAAW;AAAA,QACV,UAAU;AAAA,QACV,yBAAyB;AAAA,MAC1B;AAAA,MACA,2BAA2B;AAAA,MAC3B,cAAc;AAAA,QACb,UAAU;AAAA,QACV,sBAAsB;AAAA,QACtB,qBAAqB;AAAA,QACrB,yBAAyB;AAAA,MAC1B;AAAA,MACA,WAAW,SAAS,sBAAsB,YAAY;AAAA,MACtD;AAAA,MACA,GAAG,KAAK,2BAA2B;AAAA,IACpC,CAAC;AAED,UAAM,iBAAiB,IAAI,OAAO,KAAK,SAAS,EAAE,wCAAwC,CAAC;AAC3F,UAAM,sBAAsB,KAAK,OAAO,kBAAkB,aAAa,cAAc;AACrF,UAAM,mCAAmC,KAAK,UAAU,2BAA2B,YAAY,IAAI,kBAAkB,CAAC,oBAAoB,mBAAmB,CAAC,CAAC,CAAC;AAChK,SAAK,UAAU,KAAK,UAAU,iCAAiC,eAAe,sBAAsB,gBAAgB,QAAQ;AAAA,MAC3H,aAAa;AAAA,QACZ,mBAAmB;AAAA,MACpB;AAAA,IACD,CAAC,CAAC;AAEF,UAAM,iBAAiB,IAAI,OAAO,KAAK,SAAS,EAAE,2BAA2B,CAAC;AAC9E,UAAM,qBAAqB,IAAI,OAAO,gBAAgB,EAAE,oCAAoC,MAAS,CAAC;AACtG,SAAK,cAAc,KAAK,UAAU,IAAI,OAAO,oBAAoB;AAAA,MAChE,kBAAkB;AAAA,MAClB,cAAc;AAAA,MACd,kBAAkB;AAAA,MAClB,uBAAuB;AAAA,MACvB,2BAA2B;AAAA,MAC3B,2BAA2B;AAAA,MAC3B,gCAAgC;AAAA,MAChC,iBAAiB;AAAA,MACjB,cAAc;AAAA,IACf,CAAC,CAAC;AAEF,SAAK,mBAAmB,IAAI,OAAO,gBAAgB,EAAE,kCAAkC,CAAC;AAExF,SAAK,UAAU,KAAK,YAAY,WAAW,MAAM;AAChD,YAAM,UAAU,KAAK,qBAAsB;AAC3C,cAAQ,8BAA8B,CAAC,QAAQ;AAC/C,WAAK,YAAY,QAAQ,KAAK,wBAAwB;AACtD,WAAK,QAAQ,UAAU,OAAO,kCAAkC,CAAC,QAAQ,2BAA2B;AACpG,WAAK,0BAA0B,KAAK;AAAA,IAErC,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,QAAQ,8BAA8B,OAAK;AAC9D,qBAAe,UAAU,OAAO,oBAAoB,CAAC;AAAA,IACtD,CAAC,CAAC;AAEF,SAAK,0BAA0B;AAC/B,SAAK,UAAU,KAAK,qBAAqB,iCAAiC,MAAM,KAAK,0BAA0B,CAAC,CAAC;AACjH,SAAK,UAAU,KAAK,qBAAqB,yBAAyB,CAAC,MAAM;AACxE,UAAI,EAAE,aAAa,IAAI,gCAAgC,IAAI,GAAG;AAC7D,aAAK,0BAA0B;AAAA,MAChC;AAAA,IACD,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,QAAQ,YAAY,MAAM;AAC7C,WAAK,OAAO,cAAc,KAAK,2BAA2B,CAAC;AAAA,IAC5D,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,OAAO,kBAAkB,OAAK;AACjD,WAAK,qBAAqB,EAAE;AAAA,IAC7B,CAAC,CAAC;AACF,SAAK,UAAU,KAAK,OAAO,uBAAuB,OAAK;AACtD,UAAI,EAAE,sBAAsB;AAC3B,aAAK,0BAA0B,KAAK;AAAA,MACrC;AAAA,IACD,CAAC,CAAC;AACF,SAAK,UAAU,KAAK,OAAO,sBAAsB,MAAM;AACtD,WAAK,QAAQ,UAAU,OAAO,SAAS;AACvC,kCAA4B,IAAI,KAAK,MAAM,GAAG,iBAAiB;AAC/D,WAAK,aAAa;AAAA,IACnB,CAAC,CAAC;AACF,SAAK,UAAU,KAAK,OAAO,uBAAuB,MAAM;AACvD,WAAK,QAAQ,UAAU,IAAI,SAAS;AACpC,kCAA4B,IAAI,KAAK,MAAM,GAAG,iBAAiB,IAAI;AAAA,IACpE,CAAC,CAAC;AAGF,QAAI,SAAS,aAAa;AACzB,WAAK,UAAU,SAAS,YAAY,OAAK;AACxC,aAAK,aAAa;AAAA,MACnB,CAAC,CAAC;AAAA,IACH;AAAA,EACD;AAAA,EAjRD,OAsI8C;AAAA;AAAA;AAAA,EAC1B,4BAA4B,KAAK,UAAU,IAAI,QAAc,CAAC;AAAA,EACjE,2BAA2B,KAAK,0BAA0B;AAAA,EAE1D;AAAA,EACG;AAAA,EACF;AAAA,EAED;AAAA,EAEC;AAAA,EACA;AAAA,EAET;AAAA,EACA,qBAAqB;AAAA,EAEZ,kBAAkB,KAAK,UAAU,IAAI,gBAAgB,CAAC;AAAA,EAC/D,aAAa;AAAA,EAEb;AAAA,EA0HC,UAAU;AAClB,SAAK,aAAa;AAClB,UAAM,QAAQ;AAAA,EACf;AAAA,EAEA,IAAI,MAAuB;AAC1B,WAAO,KAAK,OAAO,SAAS,GAAG;AAAA,EAChC;AAAA,EAEQ,aAAa,sBAA6C,QAAqB,SAAiE;AACvJ,WAAO,KAAK,UAAU,qBAAqB,eAAe,kBAAkB,QAAQ,SAAS;AAAA,MAC5F,gBAAgB;AAAA,MAChB,eAAe,yBAAyB,2BAA2B;AAAA,QAClE,cAAc;AAAA,QACd;AAAA,QACA,sBAAsB;AAAA,QAEtB,4BAA4B;AAAA,QAC5B,mCAAmC;AAAA,QACnC,0BAA0B;AAAA,QAC1B,sBAAsB;AAAA,QACtB,uBAAuB;AAAA,QACvB,qBAAqB;AAAA,QACrB,kBAAkB;AAAA,QAClB,2CAA2C;AAAA,QAC3C,cAAc;AAAA,QACd,aAAa;AAAA,QAEb,8BAA8B;AAAA,MAC/B,CAAC;AAAA,IACF,CAAC,CAAC;AAAA,EACH;AAAA,EAEA,QAAc;AACb,SAAK,OAAO,MAAM;AAAA,EACnB;AAAA,EAEQ,yBAAyB;AAGhC,UAAM,6BAA6B,KAAK,qBAAqB,KAAK,OAAO,cAAc,EAAE;AACzF,UAAM,kBAAkB,KAAK,OAAO,cAAc,EAAE;AACpD,UAAM,gBAAgB,6BACrB,KAAK,IAAI,0BAA0B,iBAAiB,CAAC,IACrD;AACD,SAAK,OAAO,cAAc,EAAE,SAAS,EAAE,KAAK,yBAAyB,QAAQ,cAAc,EAAE,CAAC;AAAA,EAC/F;AAAA,EAEQ,4BAAkC;AACzC,UAAM,aAAa,KAAK,QAAQ,WAAW;AAC3C,QAAI,KAAK,qBAAqB,wBAAwB,GAAG;AACxD,iBAAW,MAAM,UAAU;AAC3B,iBAAW,YAAY,KAAK,qBAAqB,SAAS,gCAAgC,IAAI,IAAI,SAAS,iCAAiC,qDAAqD,IAAI,SAAS,0BAA0B,oBAAoB;AAAA,IAC7P,OAAO;AACN,iBAAW,MAAM,UAAU;AAAA,IAC5B;AAAA,EACD;AAAA,EAEQ,6BAA6C;AACpD,WAAO;AAAA,MACN,UAAU,KAAK,QAAQ,cAAc,aAAa;AAAA,MAClD,eAAe,KAAK,QAAQ,cAAc,aAAa;AAAA,MACvD,yBAAyB,KAAK,QAAQ,cAAc,aAAa;AAAA,MACjE,YAAY,KAAK,QAAQ,cAAc,aAAa,eAAe,YAClE,qBAAqB,aACrB,KAAK,QAAQ,cAAc,aAAa;AAAA,MACzC,UAAU,KAAK,QAAQ,cAAc,aAAa;AAAA,MAClD,YAAY,KAAK,QAAQ,cAAc,aAAa;AAAA,MACpD,YAAY,KAAK,QAAQ,cAAc,aAAa;AAAA,IACrD;AAAA,EACD;AAAA,EAEA,OAAO,OAAqB;AAC3B,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,UAAM,eAAe;AACrB,SAAK,OAAO,OAAO,EAAE,OAAO,QAAQ,cAAc,QAAQ,cAAc,CAAC;AACzE,SAAK,uBAAuB;AAAA,EAC7B;AAAA,EAEQ,mBAAmB;AAC1B,QAAI,KAAK,sBAAsB,OAAO;AACrC,YAAM,YAAY,KAAK,qBAAqB,MAAM,gBAAgB,KAAK,qBAAqB,MAAM,kBAAkB;AACpH,YAAM,aAAa,KAAK,OAAO,UAAU,aAAa,UAAU;AAChE,aAAO,YAAY;AAAA,IACpB;AACA,WAAO,KAAK,OAAO,iBAAiB;AAAA,EACrC;AAAA,EAEA,MAAM,OAAO,MAAsB,OAAe,UAA+B;AAChF,SAAK,uBAAuB;AAC5B,QAAI,KAAK,yBAAyB;AACjC,WAAK,kBAAkB,aAAa,KAAK,uBAAuB;AAAA,IACjE;AAEA,QAAI,KAAK,QAAQ,cAAc,aAAa,aAAa,MAAM;AAG9D,WAAK,OAAO,KAAK;AAAA,IAClB;AAEA,UAAM,KAAK,aAAa,IAAI;AAC5B,QAAI,KAAK,YAAY;AACpB;AAAA,IACD;AAEA,SAAK,OAAO,KAAK;AACjB,QAAI,UAAU;AACb,WAAK,gBAAgB,MAAM;AAC3B,WAAK,gBAAgB,IAAI,KAAK,OAAO,uBAAuB,MAAM,SAAS,gBAAgB,IAAI,CAAC,CAAC;AACjG,WAAK,gBAAgB,IAAI,KAAK,OAAO,sBAAsB,MAAM,SAAS,gBAAgB,KAAK,CAAC,CAAC;AAAA,IAClG;AACA,SAAK,OAAO,cAAc,EAAE,WAAW,SAAS,uBAAuB,kBAAkB,KAAK,iBAAiB,CAAC,GAAG,UAAU,CAAC,SAAS,CAAC;AAExI,QAAI,KAAK,aAAa;AACrB,UAAI,KAAK,KAAK,QAAQ,WAAW,CAAC;AAAA,IACnC,OAAO;AACN,UAAI,KAAK,KAAK,QAAQ,WAAW,CAAC;AAAA,IACnC;AAEA,QAAI,KAAK,OAAO,UAAU,aAAa,KAAK,OAAO,GAAG;AACrD,UAAI,UAAU,KAAK,gBAAgB;AACnC,WAAK,QAAQ,UAAU,OAAO,UAAU;AACxC,WAAK,QAAQ,UAAU,OAAO,kCAAkC,CAAC,KAAK,QAAQ,2BAA2B;AACzG,UAAI,OAAO,KAAK,kBAAkB,GAAG,KAAK,MAAM,IAAI,OAAK,EAAE,MAAM,QAAW,EAAE,wBAAwB,QAAW,EAAE,KAAK,GAAG,MAAM,EAAE,WAAW,CAAC,CAAC;AAChJ,WAAK,YAAY,QAAQ,KAAK,wBAAwB;AAAA,IACvD,OAAO;AACN,WAAK,QAAQ,UAAU,IAAI,UAAU;AAAA,IACtC;AAAA,EACD;AAAA,EAEA,QAAQ;AACP,SAAK,aAAa;AAAA,EACnB;AAAA,EAEQ,eAAe;AACtB,2BAAuB,IAAI,KAAK,MAAM,GAAG,iBAAiB;AAC1D,yBAAqB,IAAI,KAAK,MAAM,GAAG,iBAAiB;AAAA,EACzD;AAAA,EAEA,MAAc,aAAa,MAAqC;AAC/D,UAAM,aAAa,MAAM,KAAK,WAAW;AACzC,SAAK,OAAO,SAAS,SAAS;AAC9B,QAAI,KAAK,OAAO;AACf,WAAK,OAAO,aAAa,KAAK,KAAK;AACnC,WAAK,OAAO,oBAAoB,KAAK,OAAO,WAAW,SAAS;AAAA,IACjE;AAEA,SAAK,QAAQ,UAAU;AAAA,MACtB,MAAM,UAAU,cAAc,EAAE,gBAAgB,KAAK,SAAS,UAAU,kBAAkB,GAAG,oBAAoB,WAAW;AAAA,MAC5H,gBAAgB,KAAK;AAAA,MACrB,SAAS,KAAK;AAAA,MACd,YAAY,UAAU,cAAc;AAAA,IACrC;AACA,SAAK,mBAAmB,IAAI,UAAU,GAAG;AAAA,EAC1C;AAAA,EAEQ,0BAAkC;AACzC,QAAI,CAAC,KAAK,wBAAwB,CAAC,KAAK,qBAAqB,OAAO;AACnE,aAAO;AAAA,IACR;AAEA,UAAM,kBAAkB,KAAK,qBAAqB,MAAM,SAAS,IAChE,SAAS,yBAAyB,uBAAuB,KAAK,qBAAqB,MAAM,MAAM,IAC/F,SAAS,2BAA2B,qBAAqB,CAAC;AAC3D,UAAM,OAAO,wBAAC,YAAoC,QAAQ,8BAA8B,QAAQ,cAAc,QAAQ,cAAzG;AACb,WAAO,GAAG,eAAe,MAAM,KAAK,KAAK,qBAAqB,OAAiC,EAAE,EAAE;AAAA,EACpG;AACD;AApTa,gBAAN;AAAA,EA0BJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GA9BU;AAsTN,IAAM,+BAAN,cAA2C,WAAgD;AAAA,EAEjG,YACoB,kBACa,eAC/B;AACD,UAAM;AAF0B;AAGhC,SAAK,UAAU,iBAAiB,iCAAiC,QAAQ,qBAAqB,IAAI,CAAC;AAAA,EACpG;AAAA,EApcD,OA4bkG;AAAA;AAAA;AAAA,EAUjG,MAAM,mBAAmB,UAA2C;AACnE,UAAM,WAAW,KAAK,cAAc,SAAS,QAAQ;AACrD,QAAI,UAAU;AACb,aAAO;AAAA,IACR;AACA,WAAO,KAAK,cAAc,YAAY,IAAI,MAAM,QAAQ;AAAA,EACzD;AACD;AAjBa,+BAAN;AAAA,EAGJ;AAAA,EACA;AAAA,GAJU;AA8CN,IAAM,uBAAN,cAAmC,WAAW;AAAA,EAcpD,YACkB,SACR,QACT,UACA,wBACuB,sBACH,mBACc,cACM,sBACA,sBACR,cACC,eAChC;AACD,UAAM;AAZW;AACR;AAKyB;AACM;AACA;AACR;AACC;AAGjC,SAAK,UAAU,EAAE,gCAAgC;AACjD,SAAK,QAAQ,UAAU,IAAI,SAAS;AAEpC,SAAK,iBAAiB,IAAI,OAAO,KAAK,SAAS,EAAE,UAAU,CAAC;AAC5D,SAAK,eAAe,aAAa,QAAQ,QAAQ;AACjD,SAAK,eAAe,WAAW;AAE/B,SAAK,oBAAoB,KAAK,UAAU,kBAAkB,aAAa,KAAK,OAAO,CAAC;AACpF,UAAM,6BAA6B,KAAK,UAAU,qBAAqB,YAAY,IAAI,kBAAkB,CAAC,oBAAoB,KAAK,iBAAiB,CAAC,CAAC,CAAC;AACvJ,UAAM,eAAe,IAAI,OAAO,KAAK,SAAS,EAAE,4CAA4C,CAAC;AAC7F,UAAM,gBAAgB,IAAI,OAAO,KAAK,SAAS,EAAE,4BAA4B,CAAC;AAC9E,SAAK,aAAa,KAAK,iBAAiB,4BAA4B,eAAe;AAAA,MAClF,GAAG,uBAAuB,KAAK,oBAAoB;AAAA,MACnD,aAAa;AAAA,MACb,qBAAqB;AAAA,MACrB,sBAAsB;AAAA,MACtB,sBAAsB;AAAA,MACtB,aAAa;AAAA,MACb,SAAS,EAAE,KAAK,yBAAyB,QAAQ,wBAAwB;AAAA,MACzE,gBAAgB;AAAA,MAChB,WAAW;AAAA,QACV,UAAU;AAAA,QACV,yBAAyB;AAAA,MAC1B;AAAA,MACA,2BAA2B;AAAA,MAC3B,cAAc;AAAA,QACb,UAAU;AAAA,QACV,sBAAsB;AAAA,QACtB,qBAAqB;AAAA,QACrB,yBAAyB;AAAA,MAC1B;AAAA,MACA,WAAW,SAAS,sBAAsB,YAAY;AAAA,MACtD;AAAA,MACA,GAAG,KAAK,2BAA2B;AAAA,IACpC,CAAC;AAED,SAAK,gBAAgB,KAAK,UAAU,2BAA2B,eAAe,eAAe,cAAc,EAAE,cAAc,KAAK,CAAC,CAAC;AAElI,UAAM,sBAAsB,KAAK,WAAW,kBAAkB,EAAE,kBAAkB,aAAa,YAAY;AAC3G,UAAM,mCAAmC,KAAK,UAAU,2BAA2B,YAAY,IAAI,kBAAkB,CAAC,oBAAoB,mBAAmB,CAAC,CAAC,CAAC;AAChK,SAAK,UAAU,KAAK,UAAU,iCAAiC,eAAe,sBAAsB,cAAc,QAAQ;AAAA,MACzH,aAAa;AAAA,QACZ,mBAAmB;AAAA,MACpB;AAAA,IACD,CAAC,CAAC;AAEF,SAAK,0BAA0B;AAC/B,SAAK,UAAU,KAAK,qBAAqB,iCAAiC,MAAM,KAAK,0BAA0B,CAAC,CAAC;AACjH,SAAK,UAAU,KAAK,qBAAqB,yBAAyB,CAAC,MAAM;AACxE,UAAI,EAAE,aAAa,IAAI,gCAAgC,IAAI,GAAG;AAC7D,aAAK,0BAA0B;AAAA,MAChC;AAAA,IACD,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,QAAQ,YAAY,MAAM;AAC7C,WAAK,WAAW,cAAc,KAAK,2BAA2B,CAAC;AAAA,IAChE,CAAC,CAAC;AAEF,SAAK,UAAU,KAAK,WAAW,kBAAkB,EAAE,kBAAkB,OAAK;AACzE,WAAK,qBAAqB,EAAE;AAAA,IAC7B,CAAC,CAAC;AACF,SAAK,UAAU,KAAK,WAAW,uBAAuB,OAAK;AAC1D,UAAI,EAAE,sBAAsB;AAC3B,aAAK,0BAA0B,KAAK;AAAA,MACrC;AAAA,IACD,CAAC,CAAC;AACF,SAAK,UAAU,KAAK,WAAW,kBAAkB,EAAE,sBAAsB,MAAM;AAC9E,WAAK,QAAQ,UAAU,OAAO,SAAS;AACvC,kCAA4B,IAAI,KAAK,WAAW,kBAAkB,CAAC,GAAG,iBAAiB;AACvF,WAAK,aAAa;AAAA,IACnB,CAAC,CAAC;AACF,SAAK,UAAU,KAAK,WAAW,kBAAkB,EAAE,uBAAuB,MAAM;AAC/E,WAAK,QAAQ,UAAU,IAAI,SAAS;AACpC,kCAA4B,IAAI,KAAK,WAAW,kBAAkB,CAAC,GAAG,iBAAiB,IAAI;AAAA,IAC5F,CAAC,CAAC;AAIF,QAAI,SAAS,aAAa;AACzB,WAAK,UAAU,SAAS,YAAY,OAAK;AACxC,aAAK,aAAa;AAAA,MACnB,CAAC,CAAC;AAAA,IACH;AAAA,EACD;AAAA,EAzlBD,OA0eqD;AAAA;AAAA;AAAA,EACjC,4BAA4B,KAAK,UAAU,IAAI,QAAc,CAAC;AAAA,EACjE,2BAA2B,KAAK,0BAA0B;AAAA,EAEzD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACR;AAAA,EACQ;AAAA,EAEA,2BAA2B,KAAK,OAAO,IAAI,IAAI,kBAAkB,CAAC;AAAA,EAC3E,qBAAqB;AAAA,EAqG7B,IAAI,MAAuB;AAC1B,WAAO,KAAK,WAAW,kBAAkB,EAAE,SAAS,GAAG;AAAA,EACxD;AAAA,EAEQ,iBAAiB,sBAA6C,QAAqB,SAAiE;AAC3J,UAAM,gBAA0C;AAAA,MAC/C,gBAAgB;AAAA,MAChB,eAAe,yBAAyB,2BAA2B;AAAA,QAClE,cAAc;AAAA,QACd;AAAA,QACA,sBAAsB;AAAA,QAEtB,4BAA4B;AAAA,QAC5B,mCAAmC;AAAA,QACnC,0BAA0B;AAAA,QAC1B,sBAAsB;AAAA,QACtB,uBAAuB;AAAA,QACvB,qBAAqB;AAAA,QACrB,2CAA2C;AAAA,MAC5C,CAAC;AAAA,IACF;AAEA,WAAO,KAAK,UAAU,qBAAqB,eAAe,kBAAkB,QAAQ;AAAA,MACnF,WAAW,EAAE,YAAY,OAAO,yBAAyB,OAAO,0CAA0C,KAAM;AAAA,MAChH,wBAAwB;AAAA,MACxB,cAAc;AAAA,MACd,sBAAsB;AAAA,MACtB,cAAc,EAAE,SAAS,MAAM;AAAA,MAC/B,mBAAmB,SAAS,YAAY,UAAU;AAAA,MAClD,mBAAmB,SAAS,YAAY,UAAU;AAAA,MAClD,eAAe;AAAA,MACf,UAAU;AAAA,MACV,oBAAoB;AAAA,MACpB,iCAAiC;AAAA,MACjC,cAAc;AAAA,QACb,mBAAmB;AAAA,MACpB;AAAA,MACA,kCAAkC;AAAA,MAClC,qBAAqB;AAAA,MACrB,aAAa;AAAA,MACb,sBAAsB,EAAE,SAAS,MAAM,kBAAkB,EAAE;AAAA,MAC3D,kBAAkB;AAAA,MAClB,qBAAqB;AAAA,MACrB,GAAG;AAAA,IACJ,GAAG,EAAE,gBAAgB,eAAe,gBAAgB,cAAc,CAAC,CAAC;AAAA,EACrE;AAAA,EAEA,QAAc;AACb,SAAK,WAAW,MAAM;AAAA,EACvB;AAAA,EAEQ,yBAAyB;AAGhC,UAAM,6BAA6B,KAAK,qBAAqB,KAAK,WAAW,kBAAkB,EAAE,cAAc,EAAE;AACjH,UAAM,kBAAkB,KAAK,WAAW,kBAAkB,EAAE,cAAc,EAAE;AAC5E,UAAM,gBAAgB,6BACrB,KAAK,IAAI,0BAA0B,iBAAiB,CAAC,IACrD;AACD,SAAK,WAAW,cAAc,EAAE,SAAS,EAAE,KAAK,yBAAyB,QAAQ,cAAc,EAAE,CAAC;AAAA,EACnG;AAAA,EAEQ,4BAAkC;AACzC,UAAM,aAAa,KAAK,QAAQ,WAAW;AAC3C,QAAI,KAAK,qBAAqB,wBAAwB,GAAG;AACxD,iBAAW,MAAM,UAAU;AAC3B,iBAAW,YAAY,KAAK,qBAAqB,SAAS,gCAAgC,IAAI,IAAI,SAAS,iCAAiC,qDAAqD,IAAI,SAAS,0BAA0B,oBAAoB;AAAA,IAC7P,OAAO;AACN,iBAAW,MAAM,UAAU;AAAA,IAC5B;AAAA,EACD;AAAA,EAEQ,6BAA6C;AACpD,WAAO;AAAA,MACN,UAAU,KAAK,QAAQ,cAAc,aAAa;AAAA,MAClD,eAAe,KAAK,QAAQ,cAAc,aAAa;AAAA,MACvD,yBAAyB,KAAK,QAAQ,cAAc,aAAa;AAAA,MACjE,YAAY,KAAK,QAAQ,cAAc,aAAa,eAAe,YAClE,qBAAqB,aACrB,KAAK,QAAQ,cAAc,aAAa;AAAA,MACzC,UAAU,KAAK,QAAQ,cAAc,aAAa;AAAA,MAClD,YAAY,KAAK,QAAQ,cAAc,aAAa;AAAA,MACpD,YAAY,KAAK,QAAQ,cAAc,aAAa;AAAA,IACrD;AAAA,EACD;AAAA,EAEA,OAAO,OAAqB;AAC3B,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,UAAM,eAAe;AACrB,UAAM,YAAY,EAAE,OAAO,QAAQ,cAAc,QAAQ,cAAc;AACvE,SAAK,QAAQ,MAAM,SAAS,GAAG,UAAU,MAAM;AAC/C,SAAK,QAAQ,MAAM,QAAQ,GAAG,UAAU,KAAK;AAC7C,SAAK,WAAW,OAAO,SAAS;AAChC,SAAK,uBAAuB;AAAA,EAC7B;AAAA,EAEQ,mBAAmB;AAC1B,WAAO,KAAK,WAAW,SAAS,IAC7B,KAAK,WAAW,iBAAiB,IACjC,IAAI,eAAe,KAAK,cAAc;AAAA,EAC1C;AAAA,EAEA,MAAM,OAAO,MAA6B,OAAe,OAA0B;AAClF,QAAI,KAAK,yBAAyB;AACjC,WAAK,kBAAkB,aAAa,KAAK,uBAAuB;AAAA,IACjE;AAEA,QAAI,KAAK,QAAQ,cAAc,aAAa,aAAa,MAAM;AAG9D,WAAK,OAAO,KAAK;AAAA,IAClB;AAEA,UAAM,KAAK,aAAa,MAAM,KAAK;AAEnC,SAAK,OAAO,KAAK;AACjB,SAAK,WAAW,cAAc,EAAE,WAAW,SAAS,8BAA8B,YAAY,EAAE,CAAC;AAEjG,SAAK,cAAc,QAAQ,QAAQ,KAAK,KAAK,KAAK;AAAA,MACjD,UAAU,SAAS;AAAA,MACnB,iBAAiB,EAAE,QAAQ,MAAM,QAAQ,MAAM;AAAA,IAChD,CAAC;AAAA,EACF;AAAA,EAEA,QAAQ;AACP,SAAK,aAAa;AAAA,EACnB;AAAA,EAEQ,eAAe;AACtB,2BAAuB,IAAI,KAAK,WAAW,kBAAkB,CAAC,GAAG,iBAAiB;AAClF,2BAAuB,IAAI,KAAK,WAAW,kBAAkB,CAAC,GAAG,iBAAiB;AAClF,yBAAqB,IAAI,KAAK,WAAW,kBAAkB,CAAC,GAAG,iBAAiB;AAChF,yBAAqB,IAAI,KAAK,WAAW,kBAAkB,CAAC,GAAG,iBAAiB;AAAA,EACjF;AAAA,EAEA,MAAc,aAAa,MAA6B,OAAyC;AAEhG,QAAI,CAAC,aAAa,KAAK,OAAO,GAAG;AAChC;AAAA,IACD;AAEA,UAAM,gBAAgB,QAAQ,KAAK,KAAK,OAAO,WAAW,CAAC;AAE3D,8BAA0B,OAAO,KAAK,iBAAiB,EAAE,IAAI,aAAa;AAE1E,SAAK,QAAQ,UAAU,OAAO,WAAW,aAAa;AAEtD,QAAI,eAAe;AAClB,iBAAW,KAAK,KAAK,OAAO,OAAO;AAEnC,YAAM,WAAW,KAAK,aAAa,YAAY,KAAK,KAAK,KAAK,EAAE,UAAU,MAAM,UAAU,KAAK,CAAC;AAEhG,UAAI;AACJ,UAAI,KAAK,KAAK,MAAM,YAAY,GAAG;AAClC,mBAAW,SAAS,gBAAgB,gCAAgC,QAAQ;AAAA,MAC7E,WAAW,KAAK,KAAK,MAAM,UAAU,GAAG;AACvC,mBAAW,SAAS,uBAAuB,2CAA2C,QAAQ;AAAA,MAC/F,OAAO;AACN,mBAAW,SAAS,gBAAgB,mCAAmC,KAAK,KAAK,MAAM,SAAS,QAAQ;AAAA,MACzG;AAEA,YAAM,UAAU,oBAAoB,UAAU;AAAA,QAC7C,oBAAoB;AAAA,QACpB,eAAe;AAAA,UACd,UAAU,6BAAM;AACf,iBAAK,cAAc,KAAK,KAAK,KAAK,KAAK,EAAE,iBAAiB,MAAM,eAAe,MAAM,CAAC;AAAA,UACvF,GAFU;AAAA,UAGV,aAAa,KAAK;AAAA,QACnB;AAAA,MACD,CAAC;AAED,UAAI,MAAM,KAAK,gBAAgB,OAAO;AAAA,IACvC;AAEA,UAAM,WAAW,MAAM,KAAK;AAE5B,QAAI,CAAC,iBAAiB,UAAU;AAC/B,YAAM,YAAY,KAAK,WAAW,gBAAgB;AAAA,QACjD,UAAU,SAAS;AAAA,QACnB,UAAU,SAAS;AAAA,MACpB,CAAC;AAED,YAAM,UAAU,YAAY;AAE5B,UAAI,MAAM,yBAAyB;AAClC;AAAA,MACD;AAEA,YAAM,WAAW,MAAM,IAAI,SAAS,SAAS,eAAe,SAAS,SAAS,aAAa,EAAE,MAAM;AAGlG,aAAK,WAAW,SAAS,IAAI;AAAA,MAC9B,CAAC;AACD,WAAK,WAAW,SAAS,SAAS;AAClC,WAAK,yBAAyB,QAAQ,mBAAmB,UAAU,SAAS;AAAA,IAE7E,OAAO;AACN,WAAK,WAAW,SAAS,IAAI;AAC7B,WAAK,yBAAyB,QAAQ;AACtC,WAAK,0BAA0B,KAAK;AAAA,IACrC;AAEA,SAAK,QAAQ,UAAU;AAAA,MACtB,MAAM,KAAK;AAAA,MACX,SAAS,KAAK;AAAA,MACd,YAAY,KAAK;AAAA,IAClB;AAAA,EACD;AACD;AAjUa,uBAAN;AAAA,EAmBJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GAzBU;AAmUN,IAAM,wBAAN,MAA4B;AAAA,EAIlC,YACqC,cACC,eACJ,eAChC;AAHmC;AACC;AACJ;AAAA,EAC9B;AAAA,EArzBL,OA6yBmC;AAAA;AAAA;AAAA,EAEjB,QAAQ,IAAI,yBAAyB;AAAA,EAQtD,MAAM,MAAM,UAAuD,MAA0B,YAAoD;AAEhJ,QAAI,CAAC,SAAS,SAAS,MAAM,SAAS,IAAI,GAAG;AAE5C;AAAA,IACD;AAEA,QAAI,KAAK,OAAO,SAAS;AAExB;AAAA,IACD;AAEA,QAAI,CAAC,YAAY;AAChB,iBAAW,aAAa,KAAK,cAAc,gBAAgB,GAAG;AAC7D,YAAI,CAAC,UAAU,oBAAoB,EAAE,aAAa;AACjD;AAAA,QACD;AACA,cAAM,QAAQ,UAAU,SAAS;AACjC,YAAI,CAAC,SAAS,CAAC,QAAQ,MAAM,SAAS,KAAK,KAAK,GAAG,KAAK,MAAM,SAAS,IAAI,WAAW,QAAQ,4BAA4B;AACzH,uBAAa;AACb;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAEA,UAAM,QAAQ,aACX,MAAM,KAAK,qBAAqB,YAAY,IAAI,IAChD,MAAM,KAAK,OAAO,IAAI;AAEzB,aAAS,eAAe,MAAM,KAAK;AAAA,EACpC;AAAA,EAEA,MAAc,qBAAqB,YAAyB,MAA0B;AACrF,UAAM,QAAQ,WAAW,SAAS;AAClC,QAAI,CAAC,OAAO;AACX,aAAO;AAAA,IACR;AAEA,UAAM,OAAO,WAAW,yBAAyB;AACjD,QAAI,CAAC,QAAQ,KAAK,WAAW;AAC5B,aAAO;AAAA,IACR;AAGA,QAAI,CAAC,MAAM,KAAK,WAAW,MAAM,UAAU,IAAI,GAAG;AACjD,aAAO;AAAA,IACR;AAEA,UAAM,WAAW,IAAI,cAAc,MAAM,QAAQ;AACjD,UAAM,QAAQ,KAAK,SAAS,IAAI,OAAK,EAAE,eAAe,EAAE,WAAW,QAAQ,EAAE,sBAAsB,CAAC;AAEpG,UAAM,SAAS,iBAAiB;AAChC,UAAM,SAAS,mBAAmB,MAAM,OAAO,MAAM,IAAI;AACzD,UAAM,SAAS,iBAAiB;AAEhC,WAAO,MAAM;AAAA,EACd;AAAA,EAEA,MAAc,OAAO,MAA0B;AAC9C,UAAM,MAAM,MAAM,KAAK,aAAa,qBAAqB,KAAK,GAAG;AACjE,QAAI;AAEH,UAAI,CAAC,MAAM,KAAK,WAAW,IAAI,OAAO,iBAAiB,IAAI,GAAG;AAC7D,eAAO;AAAA,MACR;AAEA,UAAI,OAAO,gBAAgB,iBAAiB;AAC5C,UAAI,QAAQ;AACZ,iBAAW,SAAS,KAAK,OAAO;AAC/B,cAAM,QAAQ,MAAM,IAAI,SAAS,eAAe;AAChD,YAAI,OAAO,gBAAgB,mBAAmB,MAAM,OAAO,MAAM,IAAI;AACrE,iBAAS,MAAM;AAAA,MAChB;AACA,UAAI,OAAO,gBAAgB,iBAAiB;AAC5C,aAAO;AAAA,IAER,UAAE;AACD,UAAI,QAAQ;AAAA,IACb;AAAA,EACD;AAAA,EAEA,MAAc,WAAW,OAAmB,MAA0B;AACrE,QAAI,KAAK,OAAO,QAAQ,KAAK,MAAM,YAAY,KAAK,KAAK,KAAK,MAAM,YAAY,KAAK,MAAM,KAAK,MAAM,MAAM;AAC3G,YAAM,SAAS,MAAM,KAAK,cAAc,QAAQ;AAAA,QAC/C,SAAS,SAAS,qCAAqC,sCAAsC;AAAA,QAC7F,QAAQ,SAAS,4CAA4C,0CAA0C;AAAA,MACxG,CAAC;AAED,UAAI,CAAC,OAAO,WAAW;AACtB,eAAO;AAAA,MACR;AAAA,IACD;AACA,WAAO;AAAA,EACR;AAAA,EAEA,QAAQ,UAAuD,MAA0B;AACxF,QAAI,CAAC,SAAS,SAAS,MAAM,SAAS,IAAI,GAAG;AAE5C;AAAA,IACD;AAEA,QAAI,KAAK,OAAO,SAAS;AAExB;AAAA,IACD;AAEA,aAAS,eAAe,MAAM,EAAE;AAAA,EACjC;AACD;AAtHa,wBAAN;AAAA,EAKJ;AAAA,EACA;AAAA,EACA;AAAA,GAPU;",
  "names": []
}
