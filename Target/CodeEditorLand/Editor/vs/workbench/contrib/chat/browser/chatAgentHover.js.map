{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/chatAgentHover.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from \"../../../../base/browser/dom.js\";\nimport type { IManagedHoverOptions } from \"../../../../base/browser/ui/hover/hover.js\";\nimport { renderIcon } from \"../../../../base/browser/ui/iconLabel/iconLabels.js\";\nimport { CancellationTokenSource } from \"../../../../base/common/cancellation.js\";\nimport { Codicon } from \"../../../../base/common/codicons.js\";\nimport { Emitter, type Event } from \"../../../../base/common/event.js\";\nimport { Disposable } from \"../../../../base/common/lifecycle.js\";\nimport { FileAccess } from \"../../../../base/common/network.js\";\nimport { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport { URI } from \"../../../../base/common/uri.js\";\nimport { localize } from \"../../../../nls.js\";\nimport type { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport { showExtensionsWithIdsCommandId } from \"../../extensions/browser/extensionsActions.js\";\nimport { verifiedPublisherIcon } from \"../../extensions/browser/extensionsIcons.js\";\nimport { IExtensionsWorkbenchService } from \"../../extensions/common/extensions.js\";\nimport {\n\ttype IChatAgentData,\n\tIChatAgentNameService,\n\tIChatAgentService,\n\tgetFullyQualifiedId,\n} from \"../common/chatAgents.js\";\n\nexport class ChatAgentHover extends Disposable {\n\tpublic readonly domNode: HTMLElement;\n\n\tprivate readonly icon: HTMLElement;\n\tprivate readonly name: HTMLElement;\n\tprivate readonly extensionName: HTMLElement;\n\tprivate readonly publisherName: HTMLElement;\n\tprivate readonly description: HTMLElement;\n\n\tprivate readonly _onDidChangeContents = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeContents: Event<void> =\n\t\tthis._onDidChangeContents.event;\n\n\tconstructor(\n\t\t@IChatAgentService private readonly chatAgentService: IChatAgentService,\n\t\t@IExtensionsWorkbenchService\n\t\tprivate readonly extensionService: IExtensionsWorkbenchService,\n\t\t@IChatAgentNameService\n\t\tprivate readonly chatAgentNameService: IChatAgentNameService,\n\t) {\n\t\tsuper();\n\n\t\tconst hoverElement = dom.h(\".chat-agent-hover@root\", [\n\t\t\tdom.h(\".chat-agent-hover-header\", [\n\t\t\t\tdom.h(\".chat-agent-hover-icon@icon\"),\n\t\t\t\tdom.h(\".chat-agent-hover-details\", [\n\t\t\t\t\tdom.h(\".chat-agent-hover-name@name\"),\n\t\t\t\t\tdom.h(\".chat-agent-hover-extension\", [\n\t\t\t\t\t\tdom.h(\".chat-agent-hover-extension-name@extensionName\"),\n\t\t\t\t\t\tdom.h(\".chat-agent-hover-separator@separator\"),\n\t\t\t\t\t\tdom.h(\".chat-agent-hover-publisher@publisher\"),\n\t\t\t\t\t]),\n\t\t\t\t]),\n\t\t\t]),\n\t\t\tdom.h(\".chat-agent-hover-warning@warning\"),\n\t\t\tdom.h(\"span.chat-agent-hover-description@description\"),\n\t\t]);\n\t\tthis.domNode = hoverElement.root;\n\n\t\tthis.icon = hoverElement.icon;\n\t\tthis.name = hoverElement.name;\n\t\tthis.extensionName = hoverElement.extensionName;\n\t\tthis.description = hoverElement.description;\n\n\t\thoverElement.separator.textContent = \"|\";\n\n\t\tconst verifiedBadge = dom.$(\n\t\t\t\"span.extension-verified-publisher\",\n\t\t\tundefined,\n\t\t\trenderIcon(verifiedPublisherIcon),\n\t\t);\n\n\t\tthis.publisherName = dom.$(\"span.chat-agent-hover-publisher-name\");\n\t\tdom.append(hoverElement.publisher, verifiedBadge, this.publisherName);\n\n\t\thoverElement.warning.appendChild(renderIcon(Codicon.warning));\n\t\thoverElement.warning.appendChild(\n\t\t\tdom.$(\n\t\t\t\t\"span\",\n\t\t\t\tundefined,\n\t\t\t\tlocalize(\n\t\t\t\t\t\"reservedName\",\n\t\t\t\t\t\"This chat extension is using a reserved name.\",\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\t}\n\n\tsetAgent(id: string): void {\n\t\tconst agent = this.chatAgentService.getAgent(id)!;\n\t\tif (agent.metadata.icon instanceof URI) {\n\t\t\tconst avatarIcon = dom.$<HTMLImageElement>(\"img.icon\");\n\t\t\tavatarIcon.src = FileAccess.uriToBrowserUri(\n\t\t\t\tagent.metadata.icon,\n\t\t\t).toString(true);\n\t\t\tthis.icon.replaceChildren(dom.$(\".avatar\", undefined, avatarIcon));\n\t\t} else if (agent.metadata.themeIcon) {\n\t\t\tconst avatarIcon = dom.$(\n\t\t\t\tThemeIcon.asCSSSelector(agent.metadata.themeIcon),\n\t\t\t);\n\t\t\tthis.icon.replaceChildren(\n\t\t\t\tdom.$(\".avatar.codicon-avatar\", undefined, avatarIcon),\n\t\t\t);\n\t\t}\n\n\t\tthis.domNode.classList.toggle(\"noExtensionName\", !!agent.isDynamic);\n\n\t\tconst isAllowed =\n\t\t\tthis.chatAgentNameService.getAgentNameRestriction(agent);\n\t\tthis.name.textContent = isAllowed\n\t\t\t? `@${agent.name}`\n\t\t\t: getFullyQualifiedId(agent);\n\t\tthis.extensionName.textContent = agent.extensionDisplayName;\n\t\tthis.publisherName.textContent =\n\t\t\tagent.publisherDisplayName ?? agent.extensionPublisherId;\n\n\t\tlet description = agent.description ?? \"\";\n\t\tif (description) {\n\t\t\tif (!description.match(/[.?!] *$/)) {\n\t\t\t\tdescription += \".\";\n\t\t\t}\n\t\t}\n\n\t\tthis.description.textContent = description;\n\t\tthis.domNode.classList.toggle(\"allowedName\", isAllowed);\n\n\t\tthis.domNode.classList.toggle(\"verifiedPublisher\", false);\n\t\tif (!agent.isDynamic) {\n\t\t\tconst cancel = this._register(new CancellationTokenSource());\n\t\t\tthis.extensionService\n\t\t\t\t.getExtensions([{ id: agent.extensionId.value }], cancel.token)\n\t\t\t\t.then((extensions) => {\n\t\t\t\t\tcancel.dispose();\n\t\t\t\t\tconst extension = extensions[0];\n\t\t\t\t\tif (extension?.publisherDomain?.verified) {\n\t\t\t\t\t\tthis.domNode.classList.toggle(\n\t\t\t\t\t\t\t\"verifiedPublisher\",\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis._onDidChangeContents.fire();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t}\n}\n\nexport function getChatAgentHoverOptions(\n\tgetAgent: () => IChatAgentData | undefined,\n\tcommandService: ICommandService,\n): IManagedHoverOptions {\n\treturn {\n\t\tactions: [\n\t\t\t{\n\t\t\t\tcommandId: showExtensionsWithIdsCommandId,\n\t\t\t\tlabel: localize(\"viewExtensionLabel\", \"View Extension\"),\n\t\t\t\trun: () => {\n\t\t\t\t\tconst agent = getAgent();\n\t\t\t\t\tif (agent) {\n\t\t\t\t\t\tcommandService.executeCommand(\n\t\t\t\t\t\t\tshowExtensionsWithIdsCommandId,\n\t\t\t\t\t\t\t[agent.extensionId.value],\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t};\n}\n"],
  "mappings": "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",
  "names": []
}
