{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/browser/chatAgentHover.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IManagedHoverOptions } from '../../../../base/browser/ui/hover/hover.js';\nimport { renderIcon } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { FileAccess } from '../../../../base/common/network.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { localize } from '../../../../nls.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { getFullyQualifiedId, IChatAgentData, IChatAgentNameService, IChatAgentService } from '../common/chatAgents.js';\nimport { showExtensionsWithIdsCommandId } from '../../extensions/browser/extensionsActions.js';\nimport { verifiedPublisherIcon } from '../../extensions/browser/extensionsIcons.js';\nimport { IExtensionsWorkbenchService } from '../../extensions/common/extensions.js';\n\nexport class ChatAgentHover extends Disposable {\n\tpublic readonly domNode: HTMLElement;\n\n\tprivate readonly icon: HTMLElement;\n\tprivate readonly name: HTMLElement;\n\tprivate readonly extensionName: HTMLElement;\n\tprivate readonly publisherName: HTMLElement;\n\tprivate readonly description: HTMLElement;\n\n\tprivate readonly _onDidChangeContents = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeContents: Event<void> = this._onDidChangeContents.event;\n\n\tconstructor(\n\t\t@IChatAgentService private readonly chatAgentService: IChatAgentService,\n\t\t@IExtensionsWorkbenchService private readonly extensionService: IExtensionsWorkbenchService,\n\t\t@IChatAgentNameService private readonly chatAgentNameService: IChatAgentNameService,\n\t) {\n\t\tsuper();\n\n\t\tconst hoverElement = dom.h(\n\t\t\t'.chat-agent-hover@root',\n\t\t\t[\n\t\t\t\tdom.h('.chat-agent-hover-header', [\n\t\t\t\t\tdom.h('.chat-agent-hover-icon@icon'),\n\t\t\t\t\tdom.h('.chat-agent-hover-details', [\n\t\t\t\t\t\tdom.h('.chat-agent-hover-name@name'),\n\t\t\t\t\t\tdom.h('.chat-agent-hover-extension', [\n\t\t\t\t\t\t\tdom.h('.chat-agent-hover-extension-name@extensionName'),\n\t\t\t\t\t\t\tdom.h('.chat-agent-hover-separator@separator'),\n\t\t\t\t\t\t\tdom.h('.chat-agent-hover-publisher@publisher'),\n\t\t\t\t\t\t]),\n\t\t\t\t\t]),\n\t\t\t\t]),\n\t\t\t\tdom.h('.chat-agent-hover-warning@warning'),\n\t\t\t\tdom.h('span.chat-agent-hover-description@description'),\n\t\t\t]);\n\t\tthis.domNode = hoverElement.root;\n\n\t\tthis.icon = hoverElement.icon;\n\t\tthis.name = hoverElement.name;\n\t\tthis.extensionName = hoverElement.extensionName;\n\t\tthis.description = hoverElement.description;\n\n\t\thoverElement.separator.textContent = '|';\n\n\t\tconst verifiedBadge = dom.$('span.extension-verified-publisher', undefined, renderIcon(verifiedPublisherIcon));\n\n\t\tthis.publisherName = dom.$('span.chat-agent-hover-publisher-name');\n\t\tdom.append(\n\t\t\thoverElement.publisher,\n\t\t\tverifiedBadge,\n\t\t\tthis.publisherName);\n\n\t\thoverElement.warning.appendChild(renderIcon(Codicon.warning));\n\t\thoverElement.warning.appendChild(dom.$('span', undefined, localize('reservedName', \"This chat extension is using a reserved name.\")));\n\t}\n\n\tsetAgent(id: string): void {\n\t\tconst agent = this.chatAgentService.getAgent(id)!;\n\t\tif (agent.metadata.icon instanceof URI) {\n\t\t\tconst avatarIcon = dom.$<HTMLImageElement>('img.icon');\n\t\t\tavatarIcon.src = FileAccess.uriToBrowserUri(agent.metadata.icon).toString(true);\n\t\t\tthis.icon.replaceChildren(dom.$('.avatar', undefined, avatarIcon));\n\t\t} else if (agent.metadata.themeIcon) {\n\t\t\tconst avatarIcon = dom.$(ThemeIcon.asCSSSelector(agent.metadata.themeIcon));\n\t\t\tthis.icon.replaceChildren(dom.$('.avatar.codicon-avatar', undefined, avatarIcon));\n\t\t}\n\n\t\tthis.domNode.classList.toggle('noExtensionName', !!agent.isDynamic);\n\n\t\tconst isAllowed = this.chatAgentNameService.getAgentNameRestriction(agent);\n\t\tthis.name.textContent = isAllowed ? `@${agent.name}` : getFullyQualifiedId(agent);\n\t\tthis.extensionName.textContent = agent.extensionDisplayName;\n\t\tthis.publisherName.textContent = agent.publisherDisplayName ?? agent.extensionPublisherId;\n\n\t\tlet description = agent.description ?? '';\n\t\tif (description) {\n\t\t\tif (!description.match(/[\\.\\?\\!] *$/)) {\n\t\t\t\tdescription += '.';\n\t\t\t}\n\t\t}\n\n\t\tthis.description.textContent = description;\n\t\tthis.domNode.classList.toggle('allowedName', isAllowed);\n\n\t\tthis.domNode.classList.toggle('verifiedPublisher', false);\n\t\tif (!agent.isDynamic) {\n\t\t\tconst cancel = this._register(new CancellationTokenSource());\n\t\t\tthis.extensionService.getExtensions([{ id: agent.extensionId.value }], cancel.token).then(extensions => {\n\t\t\t\tcancel.dispose();\n\t\t\t\tconst extension = extensions[0];\n\t\t\t\tif (extension?.publisherDomain?.verified) {\n\t\t\t\t\tthis.domNode.classList.toggle('verifiedPublisher', true);\n\t\t\t\t\tthis._onDidChangeContents.fire();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function getChatAgentHoverOptions(getAgent: () => IChatAgentData | undefined, commandService: ICommandService): IManagedHoverOptions {\n\treturn {\n\t\tactions: [\n\t\t\t{\n\t\t\t\tcommandId: showExtensionsWithIdsCommandId,\n\t\t\t\tlabel: localize('viewExtensionLabel', \"View Extension\"),\n\t\t\t\trun: () => {\n\t\t\t\t\tconst agent = getAgent();\n\t\t\t\t\tif (agent) {\n\t\t\t\t\t\tcommandService.executeCommand(showExtensionsWithIdsCommandId, [agent.extensionId.value]);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t]\n\t};\n}\n"],
  "mappings": "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",
  "names": []
}
