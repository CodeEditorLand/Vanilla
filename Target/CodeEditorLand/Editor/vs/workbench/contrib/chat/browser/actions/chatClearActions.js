import{Codicon as s}from"../../../../../base/common/codicons.js";import{KeyCode as l,KeyMod as m}from"../../../../../base/common/keyCodes.js";import{localize2 as C}from"../../../../../nls.js";import{AccessibilitySignal as A,IAccessibilitySignalService as d}from"../../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js";import{Action2 as p,MenuId as r,registerAction2 as h}from"../../../../../platform/actions/common/actions.js";import{ContextKeyExpr as y}from"../../../../../platform/contextkey/common/contextkey.js";import{KeybindingWeight as S}from"../../../../../platform/keybinding/common/keybindingsRegistry.js";import{ActiveEditorContext as E}from"../../../../common/contextkeys.js";import{CHAT_CATEGORY as v,isChatViewTitleActionContext as I}from"./chatActions.js";import{clearChatEditor as T}from"./chatClear.js";import{CHAT_VIEW_ID as w,IChatWidgetService as b}from"../chat.js";import{ChatEditorInput as _}from"../chatEditorInput.js";import{CONTEXT_IN_CHAT_SESSION as N,CONTEXT_CHAT_ENABLED as g}from"../../common/chatContextKeys.js";import{IViewsService as V}from"../../../../services/views/common/viewsService.js";const x="workbench.action.chat.newChat";function Z(){h(class extends p{constructor(){super({id:"workbench.action.chatEditor.newChat",title:C("chat.newChat.label","New Chat"),icon:s.plus,f1:!1,precondition:g,menu:[{id:r.EditorTitle,group:"navigation",order:0,when:E.isEqualTo(_.EditorID)}]})}async run(t,...c){n(t.get(d)),await T(t)}}),h(class extends p{constructor(){super({id:x,title:C("chat.newChat.label","New Chat"),category:v,icon:s.plus,precondition:g,f1:!0,keybinding:{weight:S.WorkbenchContrib,primary:m.CtrlCmd|l.KeyL,mac:{primary:m.WinCtrl|l.KeyL},when:N},menu:[{id:r.ChatContext,group:"z_clear"},{id:r.ViewTitle,when:y.equals("view",w),group:"navigation",order:-1}]})}async run(t,...c){const o=c[0],a=t.get(d);if(I(o))n(a),o.chatView.widget.clear(),o.chatView.widget.focusInput();else{const u=t.get(b),f=t.get(V);let e=u.lastFocusedWidget;e||(e=(await f.openView(w)).widget),n(a),e.clear(),e.focusInput()}}})}function n(i){i.playSignal(A.clear)}export{x as ACTION_ID_NEW_CHAT,Z as registerNewChatActions};
