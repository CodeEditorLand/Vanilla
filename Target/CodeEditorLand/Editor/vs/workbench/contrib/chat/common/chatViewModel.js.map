{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/contrib/chat/common/chatViewModel.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, type Event } from \"../../../../base/common/event.js\";\nimport { hash } from \"../../../../base/common/hash.js\";\nimport type { IMarkdownString } from \"../../../../base/common/htmlContent.js\";\nimport { Disposable } from \"../../../../base/common/lifecycle.js\";\nimport * as marked from \"../../../../base/common/marked/marked.js\";\nimport type { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { ILogService } from \"../../../../platform/log/common/log.js\";\nimport { annotateVulnerabilitiesInText } from \"./annotations.js\";\nimport {\n\ttype IChatAgentCommand,\n\ttype IChatAgentData,\n\tIChatAgentNameService,\n\ttype IChatAgentResult,\n\tgetFullyQualifiedId,\n} from \"./chatAgents.js\";\nimport {\n\tChatModelInitState,\n\ttype IChatModel,\n\ttype IChatProgressRenderableResponseContent,\n\ttype IChatRequestModel,\n\ttype IChatRequestVariableEntry,\n\ttype IChatResponseModel,\n\ttype IChatTextEditGroup,\n\ttype IChatWelcomeMessageContent,\n\ttype IResponse,\n} from \"./chatModel.js\";\nimport type { IParsedChatRequest } from \"./chatParserTypes.js\";\nimport type {\n\tChatAgentVoteDirection,\n\tChatAgentVoteDownReason,\n\tIChatCodeCitation,\n\tIChatContentReference,\n\tIChatFollowup,\n\tIChatProgressMessage,\n\tIChatResponseErrorDetails,\n\tIChatTask,\n\tIChatUsedContext,\n} from \"./chatService.js\";\nimport { countWords } from \"./chatWordCounter.js\";\nimport type { CodeBlockModelCollection } from \"./codeBlockModelCollection.js\";\n\nexport function isRequestVM(item: unknown): item is IChatRequestViewModel {\n\treturn !!item && typeof item === \"object\" && \"message\" in item;\n}\n\nexport function isResponseVM(item: unknown): item is IChatResponseViewModel {\n\treturn (\n\t\t!!item &&\n\t\ttypeof (item as IChatResponseViewModel).setVote !== \"undefined\"\n\t);\n}\n\nexport function isWelcomeVM(\n\titem: unknown,\n): item is IChatWelcomeMessageViewModel {\n\treturn !!item && typeof item === \"object\" && \"content\" in item;\n}\n\nexport type IChatViewModelChangeEvent =\n\t| IChatAddRequestEvent\n\t| IChangePlaceholderEvent\n\t| IChatSessionInitEvent\n\t| null;\n\nexport interface IChatAddRequestEvent {\n\tkind: \"addRequest\";\n}\n\nexport interface IChangePlaceholderEvent {\n\tkind: \"changePlaceholder\";\n}\n\nexport interface IChatSessionInitEvent {\n\tkind: \"initialize\";\n}\n\nexport interface IChatViewModel {\n\treadonly model: IChatModel;\n\treadonly initState: ChatModelInitState;\n\treadonly sessionId: string;\n\treadonly onDidDisposeModel: Event<void>;\n\treadonly onDidChange: Event<IChatViewModelChangeEvent>;\n\treadonly requestInProgress: boolean;\n\treadonly inputPlaceholder?: string;\n\tgetItems(): (\n\t\t| IChatRequestViewModel\n\t\t| IChatResponseViewModel\n\t\t| IChatWelcomeMessageViewModel\n\t)[];\n\tsetInputPlaceholder(text: string): void;\n\tresetInputPlaceholder(): void;\n}\n\nexport interface IChatRequestViewModel {\n\treadonly id: string;\n\treadonly sessionId: string;\n\t/** This ID updates every time the underlying data changes */\n\treadonly dataId: string;\n\treadonly username: string;\n\treadonly avatarIcon?: URI | ThemeIcon;\n\treadonly message: IParsedChatRequest | IChatFollowup;\n\treadonly messageText: string;\n\treadonly attempt: number;\n\treadonly variables: IChatRequestVariableEntry[];\n\tcurrentRenderedHeight: number | undefined;\n\treadonly contentReferences?: ReadonlyArray<IChatContentReference>;\n\treadonly confirmation?: string;\n}\n\nexport interface IChatResponseMarkdownRenderData {\n\trenderedWordCount: number;\n\tlastRenderTime: number;\n\tisFullyRendered: boolean;\n\toriginalMarkdown: IMarkdownString;\n}\n\nexport interface IChatResponseMarkdownRenderData2 {\n\trenderedWordCount: number;\n\tlastRenderTime: number;\n\tisFullyRendered: boolean;\n\toriginalMarkdown: IMarkdownString;\n}\n\nexport interface IChatProgressMessageRenderData {\n\tprogressMessage: IChatProgressMessage;\n\n\t/**\n\t * Indicates whether this is part of a group of progress messages that are at the end of the response.\n\t * (Not whether this particular item is the very last one in the response).\n\t * Need to re-render and add to partsToRender when this changes.\n\t */\n\tisAtEndOfResponse: boolean;\n\n\t/**\n\t * Whether this progress message the very last item in the response.\n\t * Need to re-render to update spinner vs check when this changes.\n\t */\n\tisLast: boolean;\n}\n\nexport interface IChatTaskRenderData {\n\ttask: IChatTask;\n\tisSettled: boolean;\n\tprogressLength: number;\n}\n\nexport interface IChatResponseRenderData {\n\trenderedParts: IChatRendererContent[];\n\n\trenderedWordCount: number;\n\tlastRenderTime: number;\n}\n\n/**\n * Content type for references used during rendering, not in the model\n */\nexport interface IChatReferences {\n\treferences: ReadonlyArray<IChatContentReference>;\n\tkind: \"references\";\n}\n\n/**\n * Content type for citations used during rendering, not in the model\n */\nexport interface IChatCodeCitations {\n\tcitations: ReadonlyArray<IChatCodeCitation>;\n\tkind: \"codeCitations\";\n}\n\n/**\n * Type for content parts rendered by IChatListRenderer\n */\nexport type IChatRendererContent =\n\t| IChatProgressRenderableResponseContent\n\t| IChatReferences\n\t| IChatCodeCitations;\n\nexport interface IChatLiveUpdateData {\n\tfirstWordTime: number;\n\tlastUpdateTime: number;\n\timpliedWordLoadRate: number;\n\tlastWordCount: number;\n}\n\nexport interface IChatResponseViewModel {\n\treadonly model: IChatResponseModel;\n\treadonly id: string;\n\treadonly sessionId: string;\n\t/** This ID updates every time the underlying data changes */\n\treadonly dataId: string;\n\t/** The ID of the associated IChatRequestViewModel */\n\treadonly requestId: string;\n\treadonly username: string;\n\treadonly avatarIcon?: URI | ThemeIcon;\n\treadonly agent?: IChatAgentData;\n\treadonly slashCommand?: IChatAgentCommand;\n\treadonly agentOrSlashCommandDetected: boolean;\n\treadonly response: IResponse;\n\treadonly usedContext: IChatUsedContext | undefined;\n\treadonly contentReferences: ReadonlyArray<IChatContentReference>;\n\treadonly codeCitations: ReadonlyArray<IChatCodeCitation>;\n\treadonly progressMessages: ReadonlyArray<IChatProgressMessage>;\n\treadonly isComplete: boolean;\n\treadonly isCanceled: boolean;\n\treadonly isStale: boolean;\n\treadonly vote: ChatAgentVoteDirection | undefined;\n\treadonly voteDownReason: ChatAgentVoteDownReason | undefined;\n\treadonly replyFollowups?: IChatFollowup[];\n\treadonly errorDetails?: IChatResponseErrorDetails;\n\treadonly result?: IChatAgentResult;\n\treadonly contentUpdateTimings?: IChatLiveUpdateData;\n\trenderData?: IChatResponseRenderData;\n\tcurrentRenderedHeight: number | undefined;\n\tsetVote(vote: ChatAgentVoteDirection): void;\n\tsetVoteDownReason(reason: ChatAgentVoteDownReason | undefined): void;\n\tusedReferencesExpanded?: boolean;\n\tvulnerabilitiesListExpanded: boolean;\n\tsetEditApplied(edit: IChatTextEditGroup, editCount: number): void;\n}\n\nexport class ChatViewModel extends Disposable implements IChatViewModel {\n\tprivate readonly _onDidDisposeModel = this._register(new Emitter<void>());\n\treadonly onDidDisposeModel = this._onDidDisposeModel.event;\n\n\tprivate readonly _onDidChange = this._register(\n\t\tnew Emitter<IChatViewModelChangeEvent>(),\n\t);\n\treadonly onDidChange = this._onDidChange.event;\n\n\tprivate readonly _items: (ChatRequestViewModel | ChatResponseViewModel)[] =\n\t\t[];\n\n\tprivate _inputPlaceholder: string | undefined = undefined;\n\tget inputPlaceholder(): string | undefined {\n\t\treturn this._inputPlaceholder;\n\t}\n\n\tget model(): IChatModel {\n\t\treturn this._model;\n\t}\n\n\tsetInputPlaceholder(text: string): void {\n\t\tthis._inputPlaceholder = text;\n\t\tthis._onDidChange.fire({ kind: \"changePlaceholder\" });\n\t}\n\n\tresetInputPlaceholder(): void {\n\t\tthis._inputPlaceholder = undefined;\n\t\tthis._onDidChange.fire({ kind: \"changePlaceholder\" });\n\t}\n\n\tget sessionId() {\n\t\treturn this._model.sessionId;\n\t}\n\n\tget requestInProgress(): boolean {\n\t\treturn this._model.requestInProgress;\n\t}\n\n\tget initState() {\n\t\treturn this._model.initState;\n\t}\n\n\tconstructor(\n\t\tprivate readonly _model: IChatModel,\n\t\tpublic readonly codeBlockModelCollection: CodeBlockModelCollection,\n\t\t@IInstantiationService\n\t\tprivate readonly instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\n\t\t_model.getRequests().forEach((request, i) => {\n\t\t\tconst requestModel = this.instantiationService.createInstance(\n\t\t\t\tChatRequestViewModel,\n\t\t\t\trequest,\n\t\t\t);\n\t\t\tthis._items.push(requestModel);\n\t\t\tthis.updateCodeBlockTextModels(requestModel);\n\n\t\t\tif (request.response) {\n\t\t\t\tthis.onAddResponse(request.response);\n\t\t\t}\n\t\t});\n\n\t\tthis._register(\n\t\t\t_model.onDidDispose(() => this._onDidDisposeModel.fire()),\n\t\t);\n\t\tthis._register(\n\t\t\t_model.onDidChange((e) => {\n\t\t\t\tif (e.kind === \"addRequest\") {\n\t\t\t\t\tconst requestModel =\n\t\t\t\t\t\tthis.instantiationService.createInstance(\n\t\t\t\t\t\t\tChatRequestViewModel,\n\t\t\t\t\t\t\te.request,\n\t\t\t\t\t\t);\n\t\t\t\t\tthis._items.push(requestModel);\n\t\t\t\t\tthis.updateCodeBlockTextModels(requestModel);\n\n\t\t\t\t\tif (e.request.response) {\n\t\t\t\t\t\tthis.onAddResponse(e.request.response);\n\t\t\t\t\t}\n\t\t\t\t} else if (e.kind === \"addResponse\") {\n\t\t\t\t\tthis.onAddResponse(e.response);\n\t\t\t\t} else if (e.kind === \"removeRequest\") {\n\t\t\t\t\tconst requestIdx = this._items.findIndex(\n\t\t\t\t\t\t(item) => isRequestVM(item) && item.id === e.requestId,\n\t\t\t\t\t);\n\t\t\t\t\tif (requestIdx >= 0) {\n\t\t\t\t\t\tthis._items.splice(requestIdx, 1);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst responseIdx =\n\t\t\t\t\t\te.responseId &&\n\t\t\t\t\t\tthis._items.findIndex(\n\t\t\t\t\t\t\t(item) =>\n\t\t\t\t\t\t\t\tisResponseVM(item) && item.id === e.responseId,\n\t\t\t\t\t\t);\n\t\t\t\t\tif (typeof responseIdx === \"number\" && responseIdx >= 0) {\n\t\t\t\t\t\tconst items = this._items.splice(responseIdx, 1);\n\t\t\t\t\t\tconst item = items[0];\n\t\t\t\t\t\tif (item instanceof ChatResponseViewModel) {\n\t\t\t\t\t\t\titem.dispose();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst modelEventToVmEvent: IChatViewModelChangeEvent =\n\t\t\t\t\te.kind === \"addRequest\"\n\t\t\t\t\t\t? { kind: \"addRequest\" }\n\t\t\t\t\t\t: e.kind === \"initialize\"\n\t\t\t\t\t\t\t? { kind: \"initialize\" }\n\t\t\t\t\t\t\t: null;\n\t\t\t\tthis._onDidChange.fire(modelEventToVmEvent);\n\t\t\t}),\n\t\t);\n\t}\n\n\tprivate onAddResponse(responseModel: IChatResponseModel) {\n\t\tconst response = this.instantiationService.createInstance(\n\t\t\tChatResponseViewModel,\n\t\t\tresponseModel,\n\t\t);\n\t\tthis._register(\n\t\t\tresponse.onDidChange(() => {\n\t\t\t\tif (response.isComplete) {\n\t\t\t\t\tthis.updateCodeBlockTextModels(response);\n\t\t\t\t}\n\t\t\t\treturn this._onDidChange.fire(null);\n\t\t\t}),\n\t\t);\n\t\tthis._items.push(response);\n\t\tthis.updateCodeBlockTextModels(response);\n\t}\n\n\tgetItems(): (\n\t\t| IChatRequestViewModel\n\t\t| IChatResponseViewModel\n\t\t| IChatWelcomeMessageViewModel\n\t)[] {\n\t\treturn [\n\t\t\t...(this._model.welcomeMessage ? [this._model.welcomeMessage] : []),\n\t\t\t...this._items,\n\t\t];\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis._items\n\t\t\t.filter(\n\t\t\t\t(item): item is ChatResponseViewModel =>\n\t\t\t\t\titem instanceof ChatResponseViewModel,\n\t\t\t)\n\t\t\t.forEach((item: ChatResponseViewModel) => item.dispose());\n\t}\n\n\tupdateCodeBlockTextModels(\n\t\tmodel: IChatRequestViewModel | IChatResponseViewModel,\n\t) {\n\t\tlet content: string;\n\t\tif (isRequestVM(model)) {\n\t\t\tcontent = model.messageText;\n\t\t} else {\n\t\t\tcontent = annotateVulnerabilitiesInText(model.response.value)\n\t\t\t\t.map((x) => x.content.value)\n\t\t\t\t.join(\"\");\n\t\t}\n\n\t\tlet codeBlockIndex = 0;\n\t\tmarked.walkTokens(marked.lexer(content), (token) => {\n\t\t\tif (token.type === \"code\") {\n\t\t\t\tconst lang = token.lang || \"\";\n\t\t\t\tconst text = token.text;\n\t\t\t\tthis.codeBlockModelCollection.update(\n\t\t\t\t\tthis._model.sessionId,\n\t\t\t\t\tmodel,\n\t\t\t\t\tcodeBlockIndex++,\n\t\t\t\t\t{ text, languageId: lang },\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport class ChatRequestViewModel implements IChatRequestViewModel {\n\tget id() {\n\t\treturn this._model.id;\n\t}\n\n\tget dataId() {\n\t\treturn (\n\t\t\tthis.id +\n\t\t\t`_${ChatModelInitState[this._model.session.initState]}_${hash(this.variables)}`\n\t\t);\n\t}\n\n\tget sessionId() {\n\t\treturn this._model.session.sessionId;\n\t}\n\n\tget username() {\n\t\treturn this._model.username;\n\t}\n\n\tget avatarIcon() {\n\t\treturn this._model.avatarIconUri;\n\t}\n\n\tget message() {\n\t\treturn this._model.message;\n\t}\n\n\tget messageText() {\n\t\treturn this.message.text;\n\t}\n\n\tget attempt() {\n\t\treturn this._model.attempt;\n\t}\n\n\tget variables() {\n\t\treturn this._model.variableData.variables;\n\t}\n\n\tget contentReferences() {\n\t\treturn this._model.response?.contentReferences;\n\t}\n\n\tget confirmation() {\n\t\treturn this._model.confirmation;\n\t}\n\n\tcurrentRenderedHeight: number | undefined;\n\n\tconstructor(private readonly _model: IChatRequestModel) {}\n}\n\nexport class ChatResponseViewModel\n\textends Disposable\n\timplements IChatResponseViewModel\n{\n\tprivate _modelChangeCount = 0;\n\n\tprivate readonly _onDidChange = this._register(new Emitter<void>());\n\treadonly onDidChange = this._onDidChange.event;\n\n\tget model() {\n\t\treturn this._model;\n\t}\n\n\tget id() {\n\t\treturn this._model.id;\n\t}\n\n\tget dataId() {\n\t\treturn (\n\t\t\tthis._model.id +\n\t\t\t`_${this._modelChangeCount}` +\n\t\t\t`_${ChatModelInitState[this._model.session.initState]}`\n\t\t);\n\t}\n\n\tget sessionId() {\n\t\treturn this._model.session.sessionId;\n\t}\n\n\tget username() {\n\t\tif (this.agent) {\n\t\t\tconst isAllowed = this.chatAgentNameService.getAgentNameRestriction(\n\t\t\t\tthis.agent,\n\t\t\t);\n\t\t\tif (isAllowed) {\n\t\t\t\treturn this.agent.fullName || this.agent.name;\n\t\t\t} else {\n\t\t\t\treturn getFullyQualifiedId(this.agent);\n\t\t\t}\n\t\t}\n\n\t\treturn this._model.username;\n\t}\n\n\tget avatarIcon() {\n\t\treturn this._model.avatarIcon;\n\t}\n\n\tget agent() {\n\t\treturn this._model.agent;\n\t}\n\n\tget slashCommand() {\n\t\treturn this._model.slashCommand;\n\t}\n\n\tget agentOrSlashCommandDetected() {\n\t\treturn this._model.agentOrSlashCommandDetected;\n\t}\n\n\tget response(): IResponse {\n\t\treturn this._model.response;\n\t}\n\n\tget usedContext(): IChatUsedContext | undefined {\n\t\treturn this._model.usedContext;\n\t}\n\n\tget contentReferences(): ReadonlyArray<IChatContentReference> {\n\t\treturn this._model.contentReferences;\n\t}\n\n\tget codeCitations(): ReadonlyArray<IChatCodeCitation> {\n\t\treturn this._model.codeCitations;\n\t}\n\n\tget progressMessages(): ReadonlyArray<IChatProgressMessage> {\n\t\treturn this._model.progressMessages;\n\t}\n\n\tget isComplete() {\n\t\treturn this._model.isComplete;\n\t}\n\n\tget isCanceled() {\n\t\treturn this._model.isCanceled;\n\t}\n\n\tget replyFollowups() {\n\t\treturn this._model.followups?.filter(\n\t\t\t(f): f is IChatFollowup => f.kind === \"reply\",\n\t\t);\n\t}\n\n\tget result() {\n\t\treturn this._model.result;\n\t}\n\n\tget errorDetails(): IChatResponseErrorDetails | undefined {\n\t\treturn this.result?.errorDetails;\n\t}\n\n\tget vote() {\n\t\treturn this._model.vote;\n\t}\n\n\tget voteDownReason() {\n\t\treturn this._model.voteDownReason;\n\t}\n\n\tget requestId() {\n\t\treturn this._model.requestId;\n\t}\n\n\tget isStale() {\n\t\treturn this._model.isStale;\n\t}\n\n\trenderData: IChatResponseRenderData | undefined = undefined;\n\tcurrentRenderedHeight: number | undefined;\n\n\tprivate _usedReferencesExpanded: boolean | undefined;\n\tget usedReferencesExpanded(): boolean | undefined {\n\t\tif (typeof this._usedReferencesExpanded === \"boolean\") {\n\t\t\treturn this._usedReferencesExpanded;\n\t\t}\n\n\t\treturn this.response.value.length === 0;\n\t}\n\n\tset usedReferencesExpanded(v: boolean) {\n\t\tthis._usedReferencesExpanded = v;\n\t}\n\n\tprivate _vulnerabilitiesListExpanded = false;\n\tget vulnerabilitiesListExpanded(): boolean {\n\t\treturn this._vulnerabilitiesListExpanded;\n\t}\n\n\tset vulnerabilitiesListExpanded(v: boolean) {\n\t\tthis._vulnerabilitiesListExpanded = v;\n\t}\n\n\tprivate _contentUpdateTimings: IChatLiveUpdateData | undefined = undefined;\n\tget contentUpdateTimings(): IChatLiveUpdateData | undefined {\n\t\treturn this._contentUpdateTimings;\n\t}\n\n\tconstructor(\n\t\tprivate readonly _model: IChatResponseModel,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IChatAgentNameService\n\t\tprivate readonly chatAgentNameService: IChatAgentNameService,\n\t) {\n\t\tsuper();\n\n\t\tif (!_model.isComplete) {\n\t\t\tthis._contentUpdateTimings = {\n\t\t\t\tfirstWordTime: 0,\n\t\t\t\tlastUpdateTime: Date.now(),\n\t\t\t\timpliedWordLoadRate: 0,\n\t\t\t\tlastWordCount: 0,\n\t\t\t};\n\t\t}\n\n\t\tthis._register(\n\t\t\t_model.onDidChange(() => {\n\t\t\t\t// This should be true, if the model is changing\n\t\t\t\tif (this._contentUpdateTimings) {\n\t\t\t\t\tconst now = Date.now();\n\t\t\t\t\tconst wordCount = countWords(_model.response.toString());\n\n\t\t\t\t\t// Apply a min time difference, or the rate is typically too high for first few words\n\t\t\t\t\tconst timeDiff = Math.max(\n\t\t\t\t\t\tnow - this._contentUpdateTimings.firstWordTime,\n\t\t\t\t\t\t250,\n\t\t\t\t\t);\n\t\t\t\t\tconst impliedWordLoadRate =\n\t\t\t\t\t\tthis._contentUpdateTimings.lastWordCount /\n\t\t\t\t\t\t(timeDiff / 1000);\n\t\t\t\t\tthis.trace(\n\t\t\t\t\t\t\"onDidChange\",\n\t\t\t\t\t\t`Update- got ${this._contentUpdateTimings.lastWordCount} words over last ${timeDiff}ms = ${impliedWordLoadRate} words/s. ${wordCount} words are now available.`,\n\t\t\t\t\t);\n\t\t\t\t\tthis._contentUpdateTimings = {\n\t\t\t\t\t\tfirstWordTime:\n\t\t\t\t\t\t\tthis._contentUpdateTimings.firstWordTime === 0 &&\n\t\t\t\t\t\t\tthis.response.value.some(\n\t\t\t\t\t\t\t\t(v) => v.kind === \"markdownContent\",\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t? now\n\t\t\t\t\t\t\t\t: this._contentUpdateTimings.firstWordTime,\n\t\t\t\t\t\tlastUpdateTime: now,\n\t\t\t\t\t\timpliedWordLoadRate,\n\t\t\t\t\t\tlastWordCount: wordCount,\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tthis.logService.warn(\n\t\t\t\t\t\t\"ChatResponseViewModel#onDidChange: got model update but contentUpdateTimings is not initialized\",\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// new data -> new id, new content to render\n\t\t\t\tthis._modelChangeCount++;\n\n\t\t\t\tthis._onDidChange.fire();\n\t\t\t}),\n\t\t);\n\t}\n\n\tprivate trace(tag: string, message: string) {\n\t\tthis.logService.trace(`ChatResponseViewModel#${tag}: ${message}`);\n\t}\n\n\tsetVote(vote: ChatAgentVoteDirection): void {\n\t\tthis._modelChangeCount++;\n\t\tthis._model.setVote(vote);\n\t}\n\n\tsetVoteDownReason(reason: ChatAgentVoteDownReason | undefined): void {\n\t\tthis._modelChangeCount++;\n\t\tthis._model.setVoteDownReason(reason);\n\t}\n\n\tsetEditApplied(edit: IChatTextEditGroup, editCount: number) {\n\t\tthis._modelChangeCount++;\n\t\tthis._model.setEditApplied(edit, editCount);\n\t}\n}\n\nexport interface IChatWelcomeMessageViewModel {\n\treadonly id: string;\n\treadonly username: string;\n\treadonly avatarIcon?: URI | ThemeIcon;\n\treadonly content: IChatWelcomeMessageContent[];\n\treadonly sampleQuestions: IChatFollowup[];\n\tcurrentRenderedHeight?: number;\n}\n"],
  "mappings": "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",
  "names": []
}
