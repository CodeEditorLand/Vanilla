import"../../editor/common/languages.js";import"../../base/common/uri.js";import{Emitter as a}from"../../base/common/event.js";import"../../platform/contextkey/common/contextkey.js";import{localize as d}from"../../nls.js";import{createDecorator as C}from"../../platform/instantiation/common/instantiation.js";import{Disposable as w,toDisposable as c}from"../../base/common/lifecycle.js";import"../../base/common/themables.js";import{getOrSet as p,SetMap as g}from"../../base/common/map.js";import{Registry as V}from"../../platform/registry/common/platform.js";import"../../platform/keybinding/common/keybindingsRegistry.js";import"../../platform/extensions/common/extensions.js";import"../../platform/instantiation/common/descriptors.js";import"../../platform/progress/common/progress.js";import"../../base/common/severity.js";import"../../platform/accessibility/common/accessibility.js";import"../../base/common/htmlContent.js";import{mixin as m}from"../../base/common/objects.js";import{Codicon as v}from"../../base/common/codicons.js";import{registerIcon as I}from"../../platform/theme/common/iconRegistry.js";import"../../base/common/cancellation.js";import"../../base/common/dataTransfer.js";import"../../platform/action/common/action.js";const Ce="views",pe=d("views log","Views"),ge=I("default-view-icon",v.window,d("defaultViewIcon","Default view icon."));var l;(e=>(e.ViewContainersRegistry="workbench.registry.view.containers",e.ViewsRegistry="workbench.registry.view"))(l||={});var y=(n=>(n[n.Sidebar=0]="Sidebar",n[n.Panel=1]="Panel",n[n.AuxiliaryBar=2]="AuxiliaryBar",n))(y||{});const me=[0,1,2];function ve(r){switch(r){case 0:return"sidebar";case 1:return"panel";case 2:return"auxiliarybar"}}class D extends w{_onDidRegister=this._register(new a);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new a);onDidDeregister=this._onDidDeregister.event;viewContainers=new Map;defaultViewContainers=[];get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(i,e,n){const o=this.get(i.id);if(o)return o;const t=i;return t.openCommandActionDescriptor=n?.doNotRegisterOpenCommand?void 0:t.openCommandActionDescriptor??{id:t.id},p(this.viewContainers,e,[]).push(t),n?.isDefault&&this.defaultViewContainers.push(t),this._onDidRegister.fire({viewContainer:t,viewContainerLocation:e}),t}deregisterViewContainer(i){for(const e of this.viewContainers.keys()){const n=this.viewContainers.get(e),o=n?.indexOf(i);if(o!==-1){n?.splice(o,1),n.length===0&&this.viewContainers.delete(e),this._onDidDeregister.fire({viewContainer:i,viewContainerLocation:e});return}}}get(i){return this.all.filter(e=>e.id===i)[0]}getViewContainers(i){return[...this.viewContainers.get(i)||[]]}getViewContainerLocation(i){return[...this.viewContainers.keys()].filter(e=>this.getViewContainers(e).filter(n=>n?.id===i.id).length>0)[0]}getDefaultViewContainer(i){return this.defaultViewContainers.find(e=>this.getViewContainerLocation(e)===i)}}V.add(l.ViewContainersRegistry,new D);var f=(o=>(o.Open="2_open",o.Debug="4_debug",o.SCM="5_scm",o.More="9_more",o))(f||{});function h(r,i){const e=r.group??"9_more",n=i.group??"9_more";return e!==n?e.localeCompare(n):(r.order??5)-(i.order??5)}class u extends w{_onViewsRegistered=this._register(new a);onViewsRegistered=this._onViewsRegistered.event;_onViewsDeregistered=this._register(new a);onViewsDeregistered=this._onViewsDeregistered.event;_onDidChangeContainer=this._register(new a);onDidChangeContainer=this._onDidChangeContainer.event;_onDidChangeViewWelcomeContent=this._register(new a);onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;_viewContainers=[];_views=new Map;_viewWelcomeContents=new g;registerViews(i,e){this.registerViews2([{views:i,viewContainer:e}])}registerViews2(i){i.forEach(({views:e,viewContainer:n})=>this.addViews(e,n)),this._onViewsRegistered.fire(i)}deregisterViews(i,e){const n=this.removeViews(i,e);n.length&&this._onViewsDeregistered.fire({views:n,viewContainer:e})}moveViews(i,e){for(const n of this._views.keys())if(n!==e){const o=this.removeViews(i,n);o.length&&(this.addViews(o,e),this._onDidChangeContainer.fire({views:o,from:n,to:e}))}}getViews(i){return this._views.get(i)||[]}getView(i){for(const e of this._viewContainers){const n=(this._views.get(e)||[]).filter(o=>o.id===i)[0];if(n)return n}return null}getViewContainer(i){for(const e of this._viewContainers)if((this._views.get(e)||[]).filter(o=>o.id===i)[0])return e;return null}registerViewWelcomeContent(i,e){return this._viewWelcomeContents.add(i,e),this._onDidChangeViewWelcomeContent.fire(i),c(()=>{this._viewWelcomeContents.delete(i,e),this._onDidChangeViewWelcomeContent.fire(i)})}registerViewWelcomeContent2(i,e){const n=new Map;for(const[o,t]of e)this._viewWelcomeContents.add(i,t),n.set(o,c(()=>{this._viewWelcomeContents.delete(i,t),this._onDidChangeViewWelcomeContent.fire(i)}));return this._onDidChangeViewWelcomeContent.fire(i),n}getViewWelcomeContent(i){const e=[];return this._viewWelcomeContents.forEach(i,n=>e.push(n)),e.sort(h)}addViews(i,e){let n=this._views.get(e);n||(n=[],this._views.set(e,n),this._viewContainers.push(e));for(const o of i){if(this.getView(o.id)!==null)throw new Error(d("duplicateId","A view with id '{0}' is already registered",o.id));n.push(o)}}removeViews(i,e){const n=this._views.get(e);if(!n)return[];const o=[],t=[];for(const s of n)i.includes(s)?o.push(s):t.push(s);return o.length&&(t.length?this._views.set(e,t):(this._views.delete(e),this._viewContainers.splice(this._viewContainers.indexOf(e),1))),o}}V.add(l.ViewsRegistry,new u);const Ie=C("viewDescriptorService");var b=(e=>(e[e.Default=0]="Default",e[e.Expand=1]="Expand",e))(b||{}),x=(n=>(n[n.None=0]="None",n[n.Collapsed=1]="Collapsed",n[n.Expanded=2]="Expanded",n))(x||{});class ye{handle;parentHandle;collapsibleState;label;description;icon;iconDark;themeIcon;resourceUri;tooltip;contextValue;command;children;accessibilityInformation;resolve;resolved=!1;_hasResolve=!1;constructor(i,e){m(this,i),this._hasResolve=!!e,this.resolve=async n=>{if(e&&!this.resolved){const o=await e(n);o&&(this.tooltip=this.tooltip??o.tooltip,this.command=this.command??o.command)}n.isCancellationRequested||(this.resolved=!0)}}get hasResolve(){return this._hasResolve}resetResolve(){this.resolved=!1}asTreeItem(){return{handle:this.handle,parentHandle:this.parentHandle,collapsibleState:this.collapsibleState,label:this.label,description:this.description,icon:this.icon,iconDark:this.iconDark,themeIcon:this.themeIcon,resourceUri:this.resourceUri,tooltip:this.tooltip,contextValue:this.contextValue,command:this.command,children:this.children,accessibilityInformation:this.accessibilityInformation}}}class De extends Error{name="NoTreeViewError";constructor(i){super(d("treeView.notRegistered","No tree view with id '{0}' registered.",i))}static is(i){return!!i&&i.name==="NoTreeViewError"}}export{l as Extensions,Ie as IViewDescriptorService,De as NoTreeViewError,ye as ResolvableTreeItem,x as TreeItemCollapsibleState,Ce as VIEWS_LOG_ID,pe as VIEWS_LOG_NAME,y as ViewContainerLocation,ve as ViewContainerLocationToString,me as ViewContainerLocations,f as ViewContentGroups,b as ViewVisibilityState,ge as defaultViewIcon};
