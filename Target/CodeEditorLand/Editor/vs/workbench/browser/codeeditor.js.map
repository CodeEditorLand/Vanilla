{
  "version": 3,
  "sources": ["../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/browser/codeeditor.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { IAction } from \"../../base/common/actions.js\";\nimport { Emitter } from \"../../base/common/event.js\";\nimport { Disposable, DisposableStore } from \"../../base/common/lifecycle.js\";\nimport { isEqual } from \"../../base/common/resources.js\";\nimport type { URI } from \"../../base/common/uri.js\";\nimport {\n\ttype ICodeEditor,\n\ttype IOverlayWidget,\n\ttype IOverlayWidgetPosition,\n\tOverlayWidgetPositionPreference,\n\tisCodeEditor,\n\tisCompositeEditor,\n} from \"../../editor/browser/editorBrowser.js\";\nimport { EmbeddedCodeEditorWidget } from \"../../editor/browser/widget/codeEditor/embeddedCodeEditorWidget.js\";\nimport { EditorOption } from \"../../editor/common/config/editorOptions.js\";\nimport type { IRange } from \"../../editor/common/core/range.js\";\nimport {\n\tCursorChangeReason,\n\ttype ICursorPositionChangedEvent,\n} from \"../../editor/common/cursorEvents.js\";\nimport type { IEditorContribution } from \"../../editor/common/editorCommon.js\";\nimport {\n\ttype IModelDecorationsChangeAccessor,\n\tTrackedRangeStickiness,\n} from \"../../editor/common/model.js\";\nimport { ModelDecorationOptions } from \"../../editor/common/model/textModel.js\";\nimport {\n\tAbstractFloatingClickMenu,\n\tFloatingClickWidget,\n} from \"../../platform/actions/browser/floatingMenu.js\";\nimport { IMenuService, MenuId } from \"../../platform/actions/common/actions.js\";\nimport { IContextKeyService } from \"../../platform/contextkey/common/contextkey.js\";\nimport { IInstantiationService } from \"../../platform/instantiation/common/instantiation.js\";\nimport { IKeybindingService } from \"../../platform/keybinding/common/keybinding.js\";\nimport { IEditorService } from \"../services/editor/common/editorService.js\";\n\nexport interface IRangeHighlightDecoration {\n\tresource: URI;\n\trange: IRange;\n\tisWholeLine?: boolean;\n}\n\nexport class RangeHighlightDecorations extends Disposable {\n\tprivate readonly _onHighlightRemoved = this._register(new Emitter<void>());\n\treadonly onHighlightRemoved = this._onHighlightRemoved.event;\n\n\tprivate rangeHighlightDecorationId: string | null = null;\n\tprivate editor: ICodeEditor | null = null;\n\tprivate readonly editorDisposables = this._register(new DisposableStore());\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t) {\n\t\tsuper();\n\t}\n\n\tremoveHighlightRange() {\n\t\tif (this.editor && this.rangeHighlightDecorationId) {\n\t\t\tconst decorationId = this.rangeHighlightDecorationId;\n\t\t\tthis.editor.changeDecorations((accessor) => {\n\t\t\t\taccessor.removeDecoration(decorationId);\n\t\t\t});\n\t\t\tthis._onHighlightRemoved.fire();\n\t\t}\n\n\t\tthis.rangeHighlightDecorationId = null;\n\t}\n\n\thighlightRange(range: IRangeHighlightDecoration, editor?: any) {\n\t\teditor = editor ?? this.getEditor(range);\n\t\tif (isCodeEditor(editor)) {\n\t\t\tthis.doHighlightRange(editor, range);\n\t\t} else if (\n\t\t\tisCompositeEditor(editor) &&\n\t\t\tisCodeEditor(editor.activeCodeEditor)\n\t\t) {\n\t\t\tthis.doHighlightRange(editor.activeCodeEditor, range);\n\t\t}\n\t}\n\n\tprivate doHighlightRange(\n\t\teditor: ICodeEditor,\n\t\tselectionRange: IRangeHighlightDecoration,\n\t) {\n\t\tthis.removeHighlightRange();\n\n\t\teditor.changeDecorations(\n\t\t\t(changeAccessor: IModelDecorationsChangeAccessor) => {\n\t\t\t\tthis.rangeHighlightDecorationId = changeAccessor.addDecoration(\n\t\t\t\t\tselectionRange.range,\n\t\t\t\t\tthis.createRangeHighlightDecoration(\n\t\t\t\t\t\tselectionRange.isWholeLine,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\tthis.setEditor(editor);\n\t}\n\n\tprivate getEditor(\n\t\tresourceRange: IRangeHighlightDecoration,\n\t): ICodeEditor | undefined {\n\t\tconst resource = this.editorService.activeEditor?.resource;\n\t\tif (\n\t\t\tresource &&\n\t\t\tisEqual(resource, resourceRange.resource) &&\n\t\t\tisCodeEditor(this.editorService.activeTextEditorControl)\n\t\t) {\n\t\t\treturn this.editorService.activeTextEditorControl;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate setEditor(editor: ICodeEditor) {\n\t\tif (this.editor !== editor) {\n\t\t\tthis.editorDisposables.clear();\n\t\t\tthis.editor = editor;\n\t\t\tthis.editorDisposables.add(\n\t\t\t\tthis.editor.onDidChangeCursorPosition(\n\t\t\t\t\t(e: ICursorPositionChangedEvent) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\te.reason === CursorChangeReason.NotSet ||\n\t\t\t\t\t\t\te.reason === CursorChangeReason.Explicit ||\n\t\t\t\t\t\t\te.reason === CursorChangeReason.Undo ||\n\t\t\t\t\t\t\te.reason === CursorChangeReason.Redo\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthis.removeHighlightRange();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis.editorDisposables.add(\n\t\t\t\tthis.editor.onDidChangeModel(() => {\n\t\t\t\t\tthis.removeHighlightRange();\n\t\t\t\t}),\n\t\t\t);\n\t\t\tthis.editorDisposables.add(\n\t\t\t\tthis.editor.onDidDispose(() => {\n\t\t\t\t\tthis.removeHighlightRange();\n\t\t\t\t\tthis.editor = null;\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate static readonly _WHOLE_LINE_RANGE_HIGHLIGHT =\n\t\tModelDecorationOptions.register({\n\t\t\tdescription: \"codeeditor-range-highlight-whole\",\n\t\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\t\tclassName: \"rangeHighlight\",\n\t\t\tisWholeLine: true,\n\t\t});\n\n\tprivate static readonly _RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tdescription: \"codeeditor-range-highlight\",\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: \"rangeHighlight\",\n\t});\n\n\tprivate createRangeHighlightDecoration(\n\t\tisWholeLine = true,\n\t): ModelDecorationOptions {\n\t\treturn isWholeLine\n\t\t\t? RangeHighlightDecorations._WHOLE_LINE_RANGE_HIGHLIGHT\n\t\t\t: RangeHighlightDecorations._RANGE_HIGHLIGHT;\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tif (this.editor?.getModel()) {\n\t\t\tthis.removeHighlightRange();\n\t\t\tthis.editor = null;\n\t\t}\n\t}\n}\n\nexport class FloatingEditorClickWidget\n\textends FloatingClickWidget\n\timplements IOverlayWidget\n{\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\tlabel: string,\n\t\tkeyBindingAction: string | null,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t) {\n\t\tsuper(\n\t\t\tkeyBindingAction &&\n\t\t\t\tkeybindingService.lookupKeybinding(keyBindingAction)\n\t\t\t\t? `${label} (${keybindingService.lookupKeybinding(keyBindingAction)!.getLabel()})`\n\t\t\t\t: label,\n\t\t);\n\t}\n\n\tgetId(): string {\n\t\treturn \"editor.overlayWidget.floatingClickWidget\";\n\t}\n\n\tgetPosition(): IOverlayWidgetPosition {\n\t\treturn {\n\t\t\tpreference: OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER,\n\t\t};\n\t}\n\n\toverride render() {\n\t\tsuper.render();\n\t\tthis.editor.addOverlayWidget(this);\n\t}\n\n\toverride dispose(): void {\n\t\tthis.editor.removeOverlayWidget(this);\n\t\tsuper.dispose();\n\t}\n}\n\nexport class FloatingEditorClickMenu\n\textends AbstractFloatingClickMenu\n\timplements IEditorContribution\n{\n\tstatic readonly ID = \"editor.contrib.floatingClickMenu\";\n\n\tconstructor(\n\t\tprivate readonly editor: ICodeEditor,\n\t\t@IInstantiationService\n\t\tprivate readonly instantiationService: IInstantiationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t) {\n\t\tsuper(MenuId.EditorContent, menuService, contextKeyService);\n\t\tthis.render();\n\t}\n\n\tprotected override createWidget(action: IAction): FloatingClickWidget {\n\t\treturn this.instantiationService.createInstance(\n\t\t\tFloatingEditorClickWidget,\n\t\t\tthis.editor,\n\t\t\taction.label,\n\t\t\taction.id,\n\t\t);\n\t}\n\n\tprotected override isVisible() {\n\t\treturn (\n\t\t\t!(this.editor instanceof EmbeddedCodeEditorWidget) &&\n\t\t\tthis.editor?.hasModel() &&\n\t\t\t!this.editor.getOption(EditorOption.inDiffEditor)\n\t\t);\n\t}\n\n\tprotected override getActionArg(): unknown {\n\t\treturn this.editor.getModel()?.uri;\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
