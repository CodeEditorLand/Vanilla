var P=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var g=(E,r,t,e)=>{for(var o=e>1?void 0:e?R(r,t):r,n=E.length-1,i;n>=0;n--)(i=E[n])&&(o=(e?i(r,t,o):i(o))||o);return e&&o&&P(r,t,o),o},s=(E,r)=>(t,e)=>r(t,e,E);import"vs/css!./media/editorplaceholder";import{$ as S,clearNode as A,EventHelper as G,size as W}from"../../../../../vs/base/browser/dom.js";import{ButtonBar as _}from"../../../../../vs/base/browser/ui/button/button.js";import{SimpleIconLabel as $}from"../../../../../vs/base/browser/ui/iconLabel/simpleIconLabel.js";import{DomScrollableElement as z}from"../../../../../vs/base/browser/ui/scrollbar/scrollableElement.js";import"../../../../../vs/base/common/cancellation.js";import{toErrorMessage as w}from"../../../../../vs/base/common/errorMessage.js";import{DisposableStore as U,MutableDisposable as X}from"../../../../../vs/base/common/lifecycle.js";import{ScrollbarVisibility as O}from"../../../../../vs/base/common/scrollable.js";import k from"../../../../../vs/base/common/severity.js";import{truncate as V,truncateMiddle as j}from"../../../../../vs/base/common/strings.js";import{assertAllDefined as F}from"../../../../../vs/base/common/types.js";import{localize as c}from"../../../../../vs/nls.js";import{ICommandService as q}from"../../../../../vs/platform/commands/common/commands.js";import{IDialogService as J}from"../../../../../vs/platform/dialogs/common/dialogs.js";import{EditorOpenSource as K}from"../../../../../vs/platform/editor/common/editor.js";import{FileChangeType as B,FileOperationResult as Q,IFileService as Y}from"../../../../../vs/platform/files/common/files.js";import{IStorageService as D}from"../../../../../vs/platform/storage/common/storage.js";import{ITelemetryService as C}from"../../../../../vs/platform/telemetry/common/telemetry.js";import{defaultButtonStyles as Z}from"../../../../../vs/platform/theme/browser/defaultStyles.js";import{IThemeService as y}from"../../../../../vs/platform/theme/common/themeService.js";import{isSingleFolderWorkspaceIdentifier as ee,IWorkspaceContextService as te,toWorkspaceIdentifier as re}from"../../../../../vs/platform/workspace/common/workspace.js";import{computeEditorAriaLabel as oe,EditorPaneDescriptor as N}from"../../../../../vs/workbench/browser/editor.js";import{EditorPane as ie}from"../../../../../vs/workbench/browser/parts/editor/editorPane.js";import{isEditorOpenError as L}from"../../../../../vs/workbench/common/editor.js";import"../../../../../vs/workbench/common/editor/editorInput.js";import"../../../../../vs/workbench/services/editor/common/editorGroupsService.js";let l=class extends ie{static PLACEHOLDER_LABEL_MAX_LENGTH=1024;container;scrollbar;inputDisposable=this._register(new X);constructor(r,t,e,o,n){super(r,t,e,o,n)}createEditor(r){this.container=document.createElement("div"),this.container.className="monaco-editor-pane-placeholder",this.container.style.outline="none",this.container.tabIndex=0,this.scrollbar=this._register(new z(this.container,{horizontal:O.Auto,vertical:O.Auto})),r.appendChild(this.scrollbar.getDomNode())}async setInput(r,t,e,o){await super.setInput(r,t,e,o),!o.isCancellationRequested&&(this.inputDisposable.value=await this.renderInput(r,t))}async renderInput(r,t){const[e,o]=F(this.container,this.scrollbar);A(e);const n=new U,{icon:i,label:p,actions:a}=await this.getContents(r,t,n),m=V(p,l.PLACEHOLDER_LABEL_MAX_LENGTH),h=e.appendChild(S(".editor-placeholder-icon-container")),f=n.add(new $(h));f.text=i;const v=e.appendChild(S(".editor-placeholder-label-container")),b=document.createElement("span");if(b.textContent=m,v.appendChild(b),e.setAttribute("aria-label",`${oe(r,void 0,this.group,void 0)}, ${m}`),a.length){const M=e.appendChild(S(".editor-placeholder-buttons-container")),H=n.add(new _(M));for(let I=0;I<a.length;I++){const T=n.add(H.addButton({...Z,secondary:I!==0}));T.label=a[I].label,n.add(T.onDidClick(x=>{x&&G.stop(x,!0),a[I].run()}))}}return o.scanDomNode(),n}clearInput(){this.container&&A(this.container),this.inputDisposable.clear(),super.clearInput()}layout(r){const[t,e]=F(this.container,this.scrollbar);W(t,r.width,r.height),e.scanDomNode(),t.classList.toggle("max-height-200px",r.height<=200)}focus(){super.focus(),this.container?.focus()}dispose(){this.container?.remove(),super.dispose()}};l=g([s(2,C),s(3,y),s(4,D)],l);let d=class extends l{constructor(t,e,o,n,i,p){super(d.ID,t,e,o,p);this.commandService=n;this.workspaceService=i}static ID="workbench.editors.workspaceTrustRequiredEditor";static LABEL=c("trustRequiredEditor","Workspace Trust Required");static DESCRIPTOR=N.create(d,this.ID,this.LABEL);getTitle(){return d.LABEL}async getContents(){return{icon:"$(workspace-untrusted)",label:ee(re(this.workspaceService.getWorkspace()))?c("requiresFolderTrustText","The file is not displayed in the editor because trust has not been granted to the folder."):c("requiresWorkspaceTrustText","The file is not displayed in the editor because trust has not been granted to the workspace."),actions:[{label:c("manageTrust","Manage Workspace Trust"),run:()=>this.commandService.executeCommand("workbench.trust.manage")}]}}};d=g([s(1,C),s(2,y),s(3,q),s(4,te),s(5,D)],d);let u=class extends l{constructor(t,e,o,n,i,p){super(u.ID,t,e,o,n);this.fileService=i;this.dialogService=p}static ID="workbench.editors.errorEditor";static LABEL=c("errorEditor","Error Editor");static DESCRIPTOR=N.create(u,this.ID,this.LABEL);async getContents(t,e,o){const n=t.resource,i=e.error,p=i?.fileOperationResult===Q.FILE_NOT_FOUND;let a;p?a=c("unavailableResourceErrorEditorText","The editor could not be opened because the file was not found."):L(i)&&i.forceMessage?a=i.message:i?a=c("unknownErrorEditorTextWithError","The editor could not be opened due to an unexpected error: {0}",j(w(i),l.PLACEHOLDER_LABEL_MAX_LENGTH/2)):a=c("unknownErrorEditorTextWithoutError","The editor could not be opened due to an unexpected error.");let m="$(error)";L(i)&&(i.forceSeverity===k.Info?m="$(info)":i.forceSeverity===k.Warning&&(m="$(warning)"));let h;return L(i)&&i.actions.length>0?h=i.actions.map(f=>({label:f.label,run:()=>{const v=f.run();v instanceof Promise&&v.catch(b=>this.dialogService.error(w(b)))}})):h=[{label:c("retry","Try Again"),run:()=>this.group.openEditor(t,{...e,source:K.USER})}],p&&n&&this.fileService.hasProvider(n)&&o.add(this.fileService.onDidFilesChange(f=>{f.contains(n,B.ADDED,B.UPDATED)&&this.group.openEditor(t,e)})),{icon:m,label:a,actions:h??[]}}};u=g([s(1,C),s(2,y),s(3,D),s(4,Y),s(5,J)],u);export{l as EditorPlaceholder,u as ErrorPlaceholderEditor,d as WorkspaceTrustRequiredPlaceholderEditor};
