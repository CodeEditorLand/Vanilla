var P=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var g=(E,r,t,e)=>{for(var o=e>1?void 0:e?R(r,t):r,n=E.length-1,i;n>=0;n--)(i=E[n])&&(o=(e?i(r,t,o):i(o))||o);return e&&o&&P(r,t,o),o},s=(E,r)=>(t,e)=>r(t,e,E);import"./media/editorplaceholder.css";import{$ as S,EventHelper as G,clearNode as A,size as W}from"../../../../base/browser/dom.js";import{ButtonBar as _}from"../../../../base/browser/ui/button/button.js";import{SimpleIconLabel as $}from"../../../../base/browser/ui/iconLabel/simpleIconLabel.js";import{DomScrollableElement as j}from"../../../../base/browser/ui/scrollbar/scrollableElement.js";import{toErrorMessage as w}from"../../../../base/common/errorMessage.js";import{DisposableStore as z,MutableDisposable as U}from"../../../../base/common/lifecycle.js";import{ScrollbarVisibility as O}from"../../../../base/common/scrollable.js";import k from"../../../../base/common/severity.js";import{truncate as X,truncateMiddle as V}from"../../../../base/common/strings.js";import{assertAllDefined as F}from"../../../../base/common/types.js";import{localize as c}from"../../../../nls.js";import{ICommandService as q}from"../../../../platform/commands/common/commands.js";import{IDialogService as J}from"../../../../platform/dialogs/common/dialogs.js";import{EditorOpenSource as K}from"../../../../platform/editor/common/editor.js";import{FileChangeType as B,FileOperationResult as Q,IFileService as Y}from"../../../../platform/files/common/files.js";import{IStorageService as y}from"../../../../platform/storage/common/storage.js";import{ITelemetryService as D}from"../../../../platform/telemetry/common/telemetry.js";import{defaultButtonStyles as Z}from"../../../../platform/theme/browser/defaultStyles.js";import{IThemeService as C}from"../../../../platform/theme/common/themeService.js";import{IWorkspaceContextService as ee,isSingleFolderWorkspaceIdentifier as te,toWorkspaceIdentifier as re}from"../../../../platform/workspace/common/workspace.js";import{isEditorOpenError as L}from"../../../common/editor.js";import{EditorPaneDescriptor as N,computeEditorAriaLabel as oe}from"../../editor.js";import{EditorPane as ie}from"./editorPane.js";let l=class extends ie{static PLACEHOLDER_LABEL_MAX_LENGTH=1024;container;scrollbar;inputDisposable=this._register(new U);constructor(r,t,e,o,n){super(r,t,e,o,n)}createEditor(r){this.container=document.createElement("div"),this.container.className="monaco-editor-pane-placeholder",this.container.style.outline="none",this.container.tabIndex=0,this.scrollbar=this._register(new j(this.container,{horizontal:O.Auto,vertical:O.Auto})),r.appendChild(this.scrollbar.getDomNode())}async setInput(r,t,e,o){await super.setInput(r,t,e,o),!o.isCancellationRequested&&(this.inputDisposable.value=await this.renderInput(r,t))}async renderInput(r,t){const[e,o]=F(this.container,this.scrollbar);A(e);const n=new z,{icon:i,label:p,actions:a}=await this.getContents(r,t,n),m=X(p,l.PLACEHOLDER_LABEL_MAX_LENGTH),h=e.appendChild(S(".editor-placeholder-icon-container")),f=n.add(new $(h));f.text=i;const v=e.appendChild(S(".editor-placeholder-label-container")),b=document.createElement("span");if(b.textContent=m,v.appendChild(b),e.setAttribute("aria-label",`${oe(r,void 0,this.group,void 0)}, ${m}`),a.length){const M=e.appendChild(S(".editor-placeholder-buttons-container")),H=n.add(new _(M));for(let I=0;I<a.length;I++){const T=n.add(H.addButton({...Z,secondary:I!==0}));T.label=a[I].label,n.add(T.onDidClick(x=>{x&&G.stop(x,!0),a[I].run()}))}}return o.scanDomNode(),n}clearInput(){this.container&&A(this.container),this.inputDisposable.clear(),super.clearInput()}layout(r){const[t,e]=F(this.container,this.scrollbar);W(t,r.width,r.height),e.scanDomNode(),t.classList.toggle("max-height-200px",r.height<=200)}focus(){super.focus(),this.container?.focus()}dispose(){this.container?.remove(),super.dispose()}};l=g([s(2,D),s(3,C),s(4,y)],l);let d=class extends l{constructor(t,e,o,n,i,p){super(d.ID,t,e,o,p);this.commandService=n;this.workspaceService=i}static ID="workbench.editors.workspaceTrustRequiredEditor";static LABEL=c("trustRequiredEditor","Workspace Trust Required");static DESCRIPTOR=N.create(d,this.ID,this.LABEL);getTitle(){return d.LABEL}async getContents(){return{icon:"$(workspace-untrusted)",label:te(re(this.workspaceService.getWorkspace()))?c("requiresFolderTrustText","The file is not displayed in the editor because trust has not been granted to the folder."):c("requiresWorkspaceTrustText","The file is not displayed in the editor because trust has not been granted to the workspace."),actions:[{label:c("manageTrust","Manage Workspace Trust"),run:()=>this.commandService.executeCommand("workbench.trust.manage")}]}}};d=g([s(1,D),s(2,C),s(3,q),s(4,ee),s(5,y)],d);let u=class extends l{constructor(t,e,o,n,i,p){super(u.ID,t,e,o,n);this.fileService=i;this.dialogService=p}static ID="workbench.editors.errorEditor";static LABEL=c("errorEditor","Error Editor");static DESCRIPTOR=N.create(u,this.ID,this.LABEL);async getContents(t,e,o){const n=t.resource,i=e.error,p=i?.fileOperationResult===Q.FILE_NOT_FOUND;let a;p?a=c("unavailableResourceErrorEditorText","The editor could not be opened because the file was not found."):L(i)&&i.forceMessage?a=i.message:i?a=c("unknownErrorEditorTextWithError","The editor could not be opened due to an unexpected error: {0}",V(w(i),l.PLACEHOLDER_LABEL_MAX_LENGTH/2)):a=c("unknownErrorEditorTextWithoutError","The editor could not be opened due to an unexpected error.");let m="$(error)";L(i)&&(i.forceSeverity===k.Info?m="$(info)":i.forceSeverity===k.Warning&&(m="$(warning)"));let h;return L(i)&&i.actions.length>0?h=i.actions.map(f=>({label:f.label,run:()=>{const v=f.run();v instanceof Promise&&v.catch(b=>this.dialogService.error(w(b)))}})):h=[{label:c("retry","Try Again"),run:()=>this.group.openEditor(t,{...e,source:K.USER})}],p&&n&&this.fileService.hasProvider(n)&&o.add(this.fileService.onDidFilesChange(f=>{f.contains(n,B.ADDED,B.UPDATED)&&this.group.openEditor(t,e)})),{icon:m,label:a,actions:h??[]}}};u=g([s(1,D),s(2,C),s(3,y),s(4,Y),s(5,J)],u);export{l as EditorPlaceholder,u as ErrorPlaceholderEditor,d as WorkspaceTrustRequiredPlaceholderEditor};
