{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/browser/parts/notifications/notificationAccessibleView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { IAction } from \"../../../../base/common/actions.js\";\nimport { Codicon } from \"../../../../base/common/codicons.js\";\nimport { ThemeIcon } from \"../../../../base/common/themables.js\";\nimport { localize } from \"../../../../nls.js\";\nimport {\n\tAccessibleContentProvider,\n\tAccessibleViewProviderId,\n\tAccessibleViewType,\n\tIAccessibleViewService,\n} from \"../../../../platform/accessibility/browser/accessibleView.js\";\nimport type { IAccessibleViewImplentation } from \"../../../../platform/accessibility/browser/accessibleViewRegistry.js\";\nimport {\n\tAccessibilitySignal,\n\tIAccessibilitySignalService,\n} from \"../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js\";\nimport { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport type { ServicesAccessor } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport {\n\tIListService,\n\tWorkbenchList,\n} from \"../../../../platform/list/browser/listService.js\";\nimport { NotificationFocusedContext } from \"../../../common/contextkeys.js\";\nimport type { INotificationViewItem } from \"../../../common/notifications.js\";\nimport { getNotificationFromContext } from \"./notificationsCommands.js\";\n\nexport class NotificationAccessibleView implements IAccessibleViewImplentation {\n\treadonly priority = 90;\n\treadonly name = \"notifications\";\n\treadonly when = NotificationFocusedContext;\n\treadonly type = AccessibleViewType.View;\n\tgetProvider(accessor: ServicesAccessor) {\n\t\tconst accessibleViewService = accessor.get(IAccessibleViewService);\n\t\tconst listService = accessor.get(IListService);\n\t\tconst commandService = accessor.get(ICommandService);\n\t\tconst accessibilitySignalService = accessor.get(\n\t\t\tIAccessibilitySignalService,\n\t\t);\n\n\t\tfunction getProvider() {\n\t\t\tconst notification = getNotificationFromContext(listService);\n\t\t\tif (!notification) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcommandService.executeCommand(\"notifications.showList\");\n\t\t\tlet notificationIndex: number | undefined;\n\t\t\tconst list = listService.lastFocusedList;\n\t\t\tif (list instanceof WorkbenchList) {\n\t\t\t\tnotificationIndex = list.indexOf(notification);\n\t\t\t}\n\t\t\tif (notificationIndex === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfunction focusList(): void {\n\t\t\t\tcommandService.executeCommand(\"notifications.showList\");\n\t\t\t\tif (list && notificationIndex !== undefined) {\n\t\t\t\t\tlist.domFocus();\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlist.setFocus([notificationIndex]);\n\t\t\t\t\t} catch {}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction getContentForNotification(): string | undefined {\n\t\t\t\tconst notification = getNotificationFromContext(listService);\n\t\t\t\tconst message = notification?.message.original.toString();\n\t\t\t\tif (!notification) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn notification.source\n\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t\"notification.accessibleViewSrc\",\n\t\t\t\t\t\t\t\"{0} Source: {1}\",\n\t\t\t\t\t\t\tmessage,\n\t\t\t\t\t\t\tnotification.source,\n\t\t\t\t\t\t)\n\t\t\t\t\t: localize(\"notification.accessibleView\", \"{0}\", message);\n\t\t\t}\n\t\t\tconst content = getContentForNotification();\n\t\t\tif (!content) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnotification.onDidClose(() => accessibleViewService.next());\n\t\t\treturn new AccessibleContentProvider(\n\t\t\t\tAccessibleViewProviderId.Notification,\n\t\t\t\t{ type: AccessibleViewType.View },\n\t\t\t\t() => content,\n\t\t\t\t() => focusList(),\n\t\t\t\t\"accessibility.verbosity.notification\",\n\t\t\t\tundefined,\n\t\t\t\tgetActionsFromNotification(\n\t\t\t\t\tnotification,\n\t\t\t\t\taccessibilitySignalService,\n\t\t\t\t),\n\t\t\t\t() => {\n\t\t\t\t\tif (!list) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfocusList();\n\t\t\t\t\tlist.focusNext();\n\t\t\t\t\treturn getContentForNotification();\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tif (!list) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfocusList();\n\t\t\t\t\tlist.focusPrevious();\n\t\t\t\t\treturn getContentForNotification();\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\treturn getProvider();\n\t}\n}\n\nfunction getActionsFromNotification(\n\tnotification: INotificationViewItem,\n\taccessibilitySignalService: IAccessibilitySignalService,\n): IAction[] | undefined {\n\tlet actions;\n\tif (notification.actions) {\n\t\tactions = [];\n\t\tif (notification.actions.primary) {\n\t\t\tactions.push(...notification.actions.primary);\n\t\t}\n\t\tif (notification.actions.secondary) {\n\t\t\tactions.push(...notification.actions.secondary);\n\t\t}\n\t}\n\tif (actions) {\n\t\tfor (const action of actions) {\n\t\t\taction.class = ThemeIcon.asClassName(Codicon.bell);\n\t\t\tconst initialAction = action.run;\n\t\t\taction.run = () => {\n\t\t\t\tinitialAction();\n\t\t\t\tnotification.close();\n\t\t\t};\n\t\t}\n\t}\n\tconst manageExtension = actions?.find((a) =>\n\t\ta.label.includes(\"Manage Extension\"),\n\t);\n\tif (manageExtension) {\n\t\tmanageExtension.class = ThemeIcon.asClassName(Codicon.gear);\n\t}\n\tif (actions) {\n\t\tactions.push({\n\t\t\tid: \"clearNotification\",\n\t\t\tlabel: localize(\"clearNotification\", \"Clear Notification\"),\n\t\t\ttooltip: localize(\"clearNotification\", \"Clear Notification\"),\n\t\t\trun: () => {\n\t\t\t\tnotification.close();\n\t\t\t\taccessibilitySignalService.playSignal(\n\t\t\t\t\tAccessibilitySignal.clear,\n\t\t\t\t);\n\t\t\t},\n\t\t\tenabled: true,\n\t\t\tclass: ThemeIcon.asClassName(Codicon.clearAll),\n\t\t});\n\t}\n\treturn actions;\n}\n"],
  "mappings": "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",
  "names": ["notification"]
}
