{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/browser/parts/notifications/notificationAccessibleView.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from '../../../../base/common/actions.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { localize } from '../../../../nls.js';\nimport { IAccessibleViewService, AccessibleViewProviderId, AccessibleViewType, AccessibleContentProvider } from '../../../../platform/accessibility/browser/accessibleView.js';\nimport { IAccessibleViewImplentation } from '../../../../platform/accessibility/browser/accessibleViewRegistry.js';\nimport { IAccessibilitySignalService, AccessibilitySignal } from '../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IListService, WorkbenchList } from '../../../../platform/list/browser/listService.js';\nimport { getNotificationFromContext } from './notificationsCommands.js';\nimport { NotificationFocusedContext } from '../../../common/contextkeys.js';\nimport { INotificationViewItem } from '../../../common/notifications.js';\n\nexport class NotificationAccessibleView implements IAccessibleViewImplentation {\n\treadonly priority = 90;\n\treadonly name = 'notifications';\n\treadonly when = NotificationFocusedContext;\n\treadonly type = AccessibleViewType.View;\n\tgetProvider(accessor: ServicesAccessor) {\n\t\tconst accessibleViewService = accessor.get(IAccessibleViewService);\n\t\tconst listService = accessor.get(IListService);\n\t\tconst commandService = accessor.get(ICommandService);\n\t\tconst accessibilitySignalService = accessor.get(IAccessibilitySignalService);\n\n\t\tfunction getProvider() {\n\t\t\tconst notification = getNotificationFromContext(listService);\n\t\t\tif (!notification) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcommandService.executeCommand('notifications.showList');\n\t\t\tlet notificationIndex: number | undefined;\n\t\t\tconst list = listService.lastFocusedList;\n\t\t\tif (list instanceof WorkbenchList) {\n\t\t\t\tnotificationIndex = list.indexOf(notification);\n\t\t\t}\n\t\t\tif (notificationIndex === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfunction focusList(): void {\n\t\t\t\tcommandService.executeCommand('notifications.showList');\n\t\t\t\tif (list && notificationIndex !== undefined) {\n\t\t\t\t\tlist.domFocus();\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlist.setFocus([notificationIndex]);\n\t\t\t\t\t} catch { }\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction getContentForNotification(): string | undefined {\n\t\t\t\tconst notification = getNotificationFromContext(listService);\n\t\t\t\tconst message = notification?.message.original.toString();\n\t\t\t\tif (!notification) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn notification.source ? localize('notification.accessibleViewSrc', '{0} Source: {1}', message, notification.source) : localize('notification.accessibleView', '{0}', message);\n\t\t\t}\n\t\t\tconst content = getContentForNotification();\n\t\t\tif (!content) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnotification.onDidClose(() => accessibleViewService.next());\n\t\t\treturn new AccessibleContentProvider(\n\t\t\t\tAccessibleViewProviderId.Notification,\n\t\t\t\t{ type: AccessibleViewType.View },\n\t\t\t\t() => content,\n\t\t\t\t() => focusList(),\n\t\t\t\t'accessibility.verbosity.notification',\n\t\t\t\tundefined,\n\t\t\t\tgetActionsFromNotification(notification, accessibilitySignalService),\n\t\t\t\t() => {\n\t\t\t\t\tif (!list) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfocusList();\n\t\t\t\t\tlist.focusNext();\n\t\t\t\t\treturn getContentForNotification();\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tif (!list) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfocusList();\n\t\t\t\t\tlist.focusPrevious();\n\t\t\t\t\treturn getContentForNotification();\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\treturn getProvider();\n\t}\n}\n\n\nfunction getActionsFromNotification(notification: INotificationViewItem, accessibilitySignalService: IAccessibilitySignalService): IAction[] | undefined {\n\tlet actions = undefined;\n\tif (notification.actions) {\n\t\tactions = [];\n\t\tif (notification.actions.primary) {\n\t\t\tactions.push(...notification.actions.primary);\n\t\t}\n\t\tif (notification.actions.secondary) {\n\t\t\tactions.push(...notification.actions.secondary);\n\t\t}\n\t}\n\tif (actions) {\n\t\tfor (const action of actions) {\n\t\t\taction.class = ThemeIcon.asClassName(Codicon.bell);\n\t\t\tconst initialAction = action.run;\n\t\t\taction.run = () => {\n\t\t\t\tinitialAction();\n\t\t\t\tnotification.close();\n\t\t\t};\n\t\t}\n\t}\n\tconst manageExtension = actions?.find(a => a.label.includes('Manage Extension'));\n\tif (manageExtension) {\n\t\tmanageExtension.class = ThemeIcon.asClassName(Codicon.gear);\n\t}\n\tif (actions) {\n\t\tactions.push({\n\t\t\tid: 'clearNotification', label: localize('clearNotification', \"Clear Notification\"), tooltip: localize('clearNotification', \"Clear Notification\"), run: () => {\n\t\t\t\tnotification.close();\n\t\t\t\taccessibilitySignalService.playSignal(AccessibilitySignal.clear);\n\t\t\t}, enabled: true, class: ThemeIcon.asClassName(Codicon.clearAll)\n\t\t});\n\t}\n\treturn actions;\n}\n\n"],
  "mappings": "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",
  "names": ["notification"]
}
