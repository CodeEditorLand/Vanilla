var D=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var p=(I,n,i,t)=>{for(var e=t>1?void 0:t?E(n,i):n,a=I.length-1,m;a>=0;a--)(m=I[a])&&(e=(t?m(n,i,e):m(e))||e);return t&&e&&D(n,i,e),e},r=(I,n)=>(i,t)=>n(i,t,I);import"vs/css!./media/sidebarpart";import"../../../../../vs/workbench/browser/parts/sidebar/sidebarActions.js";import{ActionsOrientation as N}from"../../../../../vs/base/browser/ui/actionbar/actionbar.js";import{AnchorAlignment as C}from"../../../../../vs/base/browser/ui/contextview/contextview.js";import{LayoutPriority as L}from"../../../../../vs/base/browser/ui/grid/grid.js";import{HoverPosition as g}from"../../../../../vs/base/browser/ui/hover/hoverWidget.js";import{Separator as w}from"../../../../../vs/base/common/actions.js";import{assertIsDefined as Y}from"../../../../../vs/base/common/types.js";import{localize2 as F}from"../../../../../vs/nls.js";import{Action2 as x,IMenuService as H,registerAction2 as G}from"../../../../../vs/platform/actions/common/actions.js";import{IConfigurationService as K}from"../../../../../vs/platform/configuration/common/configuration.js";import{IContextKeyService as M}from"../../../../../vs/platform/contextkey/common/contextkey.js";import{IContextMenuService as U}from"../../../../../vs/platform/contextview/browser/contextView.js";import{IHoverService as W}from"../../../../../vs/platform/hover/browser/hover.js";import{IInstantiationService as k}from"../../../../../vs/platform/instantiation/common/instantiation.js";import{IKeybindingService as z}from"../../../../../vs/platform/keybinding/common/keybinding.js";import{INotificationService as j}from"../../../../../vs/platform/notification/common/notification.js";import{IStorageService as J,StorageScope as B,StorageTarget as Z}from"../../../../../vs/platform/storage/common/storage.js";import{contrastBorder as T}from"../../../../../vs/platform/theme/common/colorRegistry.js";import{IThemeService as q}from"../../../../../vs/platform/theme/common/themeService.js";import{ToggleActivityBarVisibilityActionId as Q}from"../../../../../vs/workbench/browser/actions/layoutActions.js";import{ActivityBarCompositeBar as X,ActivitybarPart as u}from"../../../../../vs/workbench/browser/parts/activitybar/activitybarPart.js";import"../../../../../vs/workbench/browser/parts/paneCompositeBar.js";import{AbstractPaneCompositePart as $,CompositeBarPosition as A}from"../../../../../vs/workbench/browser/parts/paneCompositePart.js";import{ActiveViewletContext as ii,SidebarFocusContext as ti}from"../../../../../vs/workbench/common/contextkeys.js";import{ACTIVITY_BAR_BADGE_BACKGROUND as ei,ACTIVITY_BAR_BADGE_FOREGROUND as oi,ACTIVITY_BAR_TOP_ACTIVE_BORDER as ri,ACTIVITY_BAR_TOP_DRAG_AND_DROP_BORDER as si,ACTIVITY_BAR_TOP_FOREGROUND as ni,ACTIVITY_BAR_TOP_INACTIVE_FOREGROUND as ai,SIDE_BAR_BACKGROUND as d,SIDE_BAR_BORDER as h,SIDE_BAR_DRAG_AND_DROP_BACKGROUND as ci,SIDE_BAR_FOREGROUND as mi,SIDE_BAR_TITLE_FOREGROUND as li}from"../../../../../vs/workbench/common/theme.js";import{IViewDescriptorService as Ii}from"../../../../../vs/workbench/common/views.js";import{IExtensionService as ui}from"../../../../../vs/workbench/services/extensions/common/extensions.js";import{ActivityBarPosition as o,IWorkbenchLayoutService as Ai,LayoutSettings as s,Parts as l,Position as y}from"../../../../../vs/workbench/services/layout/browser/layoutService.js";let c=class extends ${constructor(i,t,e,a,m,S,O,f,P,v,_,R,b){super(l.SIDEBAR_PART,{hasTitle:!0,borderWidth:()=>this.getColor(h)||this.getColor(T)?1:0},c.activeViewletSettingsKey,ii.bindTo(v),ti.bindTo(v),"sideBar","viewlet",li,i,t,e,a,m,S,O,f,P,v,_,b);this.configurationService=R;this.rememberActivityBarVisiblePosition(),this._register(R.onDidChangeConfiguration(V=>{V.affectsConfiguration(s.ACTIVITY_BAR_LOCATION)&&this.onDidChangeActivityBarLocation()})),this.registerActions()}static activeViewletSettingsKey="workbench.sidebar.activeviewletid";minimumWidth=170;maximumWidth=Number.POSITIVE_INFINITY;minimumHeight=0;maximumHeight=Number.POSITIVE_INFINITY;get snap(){return!0}priority=L.Low;get preferredWidth(){const i=this.getActivePaneComposite();if(!i)return;const t=i.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}activityBarPart=this._register(this.instantiationService.createInstance(u,this));onDidChangeActivityBarLocation(){this.activityBarPart.hide(),this.updateCompositeBar();const i=this.getActiveComposite()?.getId();i&&this.onTitleAreaUpdate(i),this.shouldShowActivityBar()&&this.activityBarPart.show(),this.rememberActivityBarVisiblePosition()}updateStyles(){super.updateStyles();const i=Y(this.getContainer());i.style.backgroundColor=this.getColor(d)||"",i.style.color=this.getColor(mi)||"";const t=this.getColor(h)||this.getColor(T),e=this.layoutService.getSideBarPosition()===y.LEFT;i.style.borderRightWidth=t&&e?"1px":"",i.style.borderRightStyle=t&&e?"solid":"",i.style.borderRightColor=e&&t||"",i.style.borderLeftWidth=t&&!e?"1px":"",i.style.borderLeftStyle=t&&!e?"solid":"",i.style.borderLeftColor=e?"":t||"",i.style.outlineColor=this.getColor(ci)??""}layout(i,t,e,a){this.layoutService.isVisible(l.SIDEBAR_PART)&&super.layout(i,t,e,a)}getTitleAreaDropDownAnchorAlignment(){return this.layoutService.getSideBarPosition()===y.LEFT?C.LEFT:C.RIGHT}createCompositeBar(){return this.instantiationService.createInstance(X,this.getCompositeBarOptions(),this.partId,this,!1)}getCompositeBarOptions(){return{partContainerClass:"sidebar",pinnedViewContainersKey:u.pinnedViewContainersKey,placeholderViewContainersKey:u.placeholderViewContainersKey,viewContainersWorkspaceStateKey:u.viewContainersWorkspaceStateKey,icon:!0,orientation:N.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===A.BOTTOM?g.ABOVE:g.BELOW},fillExtraContextMenuActions:i=>{const t=this.getViewsSubmenuAction();t&&(i.push(new w),i.push(t))},compositeSize:0,iconSize:16,overflowActionSize:30,colors:i=>({activeBackgroundColor:i.getColor(d),inactiveBackgroundColor:i.getColor(d),activeBorderBottomColor:i.getColor(ri),activeForegroundColor:i.getColor(ni),inactiveForegroundColor:i.getColor(ai),badgeBackground:i.getColor(ei),badgeForeground:i.getColor(oi),dragAndDropBorder:i.getColor(si)}),compact:!0}}shouldShowCompositeBar(){const i=this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION);return i===o.TOP||i===o.BOTTOM}shouldShowActivityBar(){return this.shouldShowCompositeBar()?!1:this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION)!==o.HIDDEN}getCompositeBarPosition(){switch(this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION)){case o.TOP:return A.TOP;case o.BOTTOM:return A.BOTTOM;case o.HIDDEN:case o.DEFAULT:default:return A.TITLE}}rememberActivityBarVisiblePosition(){const i=this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION);i!==o.HIDDEN&&this.storageService.store(s.ACTIVITY_BAR_LOCATION,i,B.PROFILE,Z.USER)}getRememberedActivityBarVisiblePosition(){switch(this.storageService.get(s.ACTIVITY_BAR_LOCATION,B.PROFILE)){case o.TOP:return o.TOP;case o.BOTTOM:return o.BOTTOM;default:return o.DEFAULT}}getPinnedPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPinnedPaneCompositeIds():this.activityBarPart.getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(){return this.shouldShowCompositeBar()?super.getVisiblePaneCompositeIds():this.activityBarPart.getVisiblePaneCompositeIds()}async focusActivityBar(){this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION)===o.HIDDEN&&(await this.configurationService.updateValue(s.ACTIVITY_BAR_LOCATION,this.getRememberedActivityBarVisiblePosition()),this.onDidChangeActivityBarLocation()),this.shouldShowCompositeBar()?this.focusCompositeBar():(this.layoutService.isVisible(l.ACTIVITYBAR_PART)||this.layoutService.setPartHidden(!1,l.ACTIVITYBAR_PART),this.activityBarPart.show(!0))}registerActions(){const i=this;this._register(G(class extends x{constructor(){super({id:Q,title:F("toggleActivityBar","Toggle Activity Bar Visibility")})}run(){const t=i.configurationService.getValue(s.ACTIVITY_BAR_LOCATION)===o.HIDDEN?i.getRememberedActivityBarVisiblePosition():o.HIDDEN;return i.configurationService.updateValue(s.ACTIVITY_BAR_LOCATION,t)}}))}toJSON(){return{type:l.SIDEBAR_PART}}};c=p([r(0,j),r(1,J),r(2,U),r(3,Ai),r(4,z),r(5,W),r(6,k),r(7,q),r(8,Ii),r(9,M),r(10,ui),r(11,K),r(12,H)],c);export{c as SidebarPart};
