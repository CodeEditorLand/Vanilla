var D=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var p=(I,n,i,t)=>{for(var e=t>1?void 0:t?E(n,i):n,a=I.length-1,m;a>=0;a--)(m=I[a])&&(e=(t?m(n,i,e):m(e))||e);return t&&e&&D(n,i,e),e},r=(I,n)=>(i,t)=>n(i,t,I);import"./media/sidebarpart.css";import"./sidebarActions.js";import{ActivityBarPosition as o,IWorkbenchLayoutService as N,LayoutSettings as s,Parts as l,Position as C}from"../../../services/layout/browser/layoutService.js";import{SidebarFocusContext as L,ActiveViewletContext as w}from"../../../common/contextkeys.js";import{IStorageService as Y,StorageScope as g,StorageTarget as F}from"../../../../platform/storage/common/storage.js";import{IContextMenuService as x}from"../../../../platform/contextview/browser/contextView.js";import{IKeybindingService as H}from"../../../../platform/keybinding/common/keybinding.js";import{IInstantiationService as G}from"../../../../platform/instantiation/common/instantiation.js";import{IThemeService as K}from"../../../../platform/theme/common/themeService.js";import{contrastBorder as B}from"../../../../platform/theme/common/colorRegistry.js";import{SIDE_BAR_TITLE_FOREGROUND as M,SIDE_BAR_BACKGROUND as d,SIDE_BAR_FOREGROUND as U,SIDE_BAR_BORDER as T,SIDE_BAR_DRAG_AND_DROP_BACKGROUND as W,ACTIVITY_BAR_BADGE_BACKGROUND as k,ACTIVITY_BAR_BADGE_FOREGROUND as z,ACTIVITY_BAR_TOP_FOREGROUND as j,ACTIVITY_BAR_TOP_ACTIVE_BORDER as J,ACTIVITY_BAR_TOP_INACTIVE_FOREGROUND as Z,ACTIVITY_BAR_TOP_DRAG_AND_DROP_BORDER as q}from"../../../common/theme.js";import{INotificationService as Q}from"../../../../platform/notification/common/notification.js";import{IContextKeyService as X}from"../../../../platform/contextkey/common/contextkey.js";import{AnchorAlignment as h}from"../../../../base/browser/ui/contextview/contextview.js";import{IExtensionService as $}from"../../../services/extensions/common/extensions.js";import{LayoutPriority as ii}from"../../../../base/browser/ui/grid/grid.js";import{assertIsDefined as ti}from"../../../../base/common/types.js";import{IViewDescriptorService as ei}from"../../../common/views.js";import{AbstractPaneCompositePart as oi,CompositeBarPosition as u}from"../paneCompositePart.js";import{ActivityBarCompositeBar as ri,ActivitybarPart as A}from"../activitybar/activitybarPart.js";import{ActionsOrientation as si}from"../../../../base/browser/ui/actionbar/actionbar.js";import{HoverPosition as y}from"../../../../base/browser/ui/hover/hoverWidget.js";import{IConfigurationService as ni}from"../../../../platform/configuration/common/configuration.js";import{Action2 as ai,IMenuService as ci,registerAction2 as mi}from"../../../../platform/actions/common/actions.js";import{Separator as li}from"../../../../base/common/actions.js";import{ToggleActivityBarVisibilityActionId as Ii}from"../../actions/layoutActions.js";import{localize2 as ui}from"../../../../nls.js";import{IHoverService as Ai}from"../../../../platform/hover/browser/hover.js";let c=class extends oi{constructor(i,t,e,a,m,S,O,f,P,v,_,R,b){super(l.SIDEBAR_PART,{hasTitle:!0,borderWidth:()=>this.getColor(T)||this.getColor(B)?1:0},c.activeViewletSettingsKey,w.bindTo(v),L.bindTo(v),"sideBar","viewlet",M,i,t,e,a,m,S,O,f,P,v,_,b);this.configurationService=R;this.rememberActivityBarVisiblePosition(),this._register(R.onDidChangeConfiguration(V=>{V.affectsConfiguration(s.ACTIVITY_BAR_LOCATION)&&this.onDidChangeActivityBarLocation()})),this.registerActions()}static activeViewletSettingsKey="workbench.sidebar.activeviewletid";minimumWidth=170;maximumWidth=Number.POSITIVE_INFINITY;minimumHeight=0;maximumHeight=Number.POSITIVE_INFINITY;get snap(){return!0}priority=ii.Low;get preferredWidth(){const i=this.getActivePaneComposite();if(!i)return;const t=i.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}activityBarPart=this._register(this.instantiationService.createInstance(A,this));onDidChangeActivityBarLocation(){this.activityBarPart.hide(),this.updateCompositeBar();const i=this.getActiveComposite()?.getId();i&&this.onTitleAreaUpdate(i),this.shouldShowActivityBar()&&this.activityBarPart.show(),this.rememberActivityBarVisiblePosition()}updateStyles(){super.updateStyles();const i=ti(this.getContainer());i.style.backgroundColor=this.getColor(d)||"",i.style.color=this.getColor(U)||"";const t=this.getColor(T)||this.getColor(B),e=this.layoutService.getSideBarPosition()===C.LEFT;i.style.borderRightWidth=t&&e?"1px":"",i.style.borderRightStyle=t&&e?"solid":"",i.style.borderRightColor=e&&t||"",i.style.borderLeftWidth=t&&!e?"1px":"",i.style.borderLeftStyle=t&&!e?"solid":"",i.style.borderLeftColor=e?"":t||"",i.style.outlineColor=this.getColor(W)??""}layout(i,t,e,a){this.layoutService.isVisible(l.SIDEBAR_PART)&&super.layout(i,t,e,a)}getTitleAreaDropDownAnchorAlignment(){return this.layoutService.getSideBarPosition()===C.LEFT?h.LEFT:h.RIGHT}createCompositeBar(){return this.instantiationService.createInstance(ri,this.getCompositeBarOptions(),this.partId,this,!1)}getCompositeBarOptions(){return{partContainerClass:"sidebar",pinnedViewContainersKey:A.pinnedViewContainersKey,placeholderViewContainersKey:A.placeholderViewContainersKey,viewContainersWorkspaceStateKey:A.viewContainersWorkspaceStateKey,icon:!0,orientation:si.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===u.BOTTOM?y.ABOVE:y.BELOW},fillExtraContextMenuActions:i=>{const t=this.getViewsSubmenuAction();t&&(i.push(new li),i.push(t))},compositeSize:0,iconSize:16,overflowActionSize:30,colors:i=>({activeBackgroundColor:i.getColor(d),inactiveBackgroundColor:i.getColor(d),activeBorderBottomColor:i.getColor(J),activeForegroundColor:i.getColor(j),inactiveForegroundColor:i.getColor(Z),badgeBackground:i.getColor(k),badgeForeground:i.getColor(z),dragAndDropBorder:i.getColor(q)}),compact:!0}}shouldShowCompositeBar(){const i=this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION);return i===o.TOP||i===o.BOTTOM}shouldShowActivityBar(){return this.shouldShowCompositeBar()?!1:this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION)!==o.HIDDEN}getCompositeBarPosition(){switch(this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION)){case o.TOP:return u.TOP;case o.BOTTOM:return u.BOTTOM;case o.HIDDEN:case o.DEFAULT:default:return u.TITLE}}rememberActivityBarVisiblePosition(){const i=this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION);i!==o.HIDDEN&&this.storageService.store(s.ACTIVITY_BAR_LOCATION,i,g.PROFILE,F.USER)}getRememberedActivityBarVisiblePosition(){switch(this.storageService.get(s.ACTIVITY_BAR_LOCATION,g.PROFILE)){case o.TOP:return o.TOP;case o.BOTTOM:return o.BOTTOM;default:return o.DEFAULT}}getPinnedPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPinnedPaneCompositeIds():this.activityBarPart.getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(){return this.shouldShowCompositeBar()?super.getVisiblePaneCompositeIds():this.activityBarPart.getVisiblePaneCompositeIds()}async focusActivityBar(){this.configurationService.getValue(s.ACTIVITY_BAR_LOCATION)===o.HIDDEN&&(await this.configurationService.updateValue(s.ACTIVITY_BAR_LOCATION,this.getRememberedActivityBarVisiblePosition()),this.onDidChangeActivityBarLocation()),this.shouldShowCompositeBar()?this.focusCompositeBar():(this.layoutService.isVisible(l.ACTIVITYBAR_PART)||this.layoutService.setPartHidden(!1,l.ACTIVITYBAR_PART),this.activityBarPart.show(!0))}registerActions(){const i=this;this._register(mi(class extends ai{constructor(){super({id:Ii,title:ui("toggleActivityBar","Toggle Activity Bar Visibility")})}run(){const t=i.configurationService.getValue(s.ACTIVITY_BAR_LOCATION)===o.HIDDEN?i.getRememberedActivityBarVisiblePosition():o.HIDDEN;return i.configurationService.updateValue(s.ACTIVITY_BAR_LOCATION,t)}}))}toJSON(){return{type:l.SIDEBAR_PART}}};c=p([r(0,Q),r(1,Y),r(2,x),r(3,N),r(4,H),r(5,Ai),r(6,G),r(7,K),r(8,ei),r(9,X),r(10,$),r(11,ni),r(12,ci)],c);export{c as SidebarPart};
