{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/browser/parts/views/viewFilter.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Delayer } from '../../../../base/common/async.js';\nimport * as DOM from '../../../../base/browser/dom.js';\nimport { IAction } from '../../../../base/common/actions.js';\nimport { HistoryInputBox } from '../../../../base/browser/ui/inputbox/inputBox.js';\nimport { KeyCode } from '../../../../base/common/keyCodes.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport { IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { toDisposable } from '../../../../base/common/lifecycle.js';\nimport { badgeBackground, badgeForeground, contrastBorder, asCssVariable } from '../../../../platform/theme/common/colorRegistry.js';\nimport { localize } from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ContextScopedHistoryInputBox } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nimport { IContextKey, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { showHistoryKeybindingHint } from '../../../../platform/history/browser/historyWidgetKeybindingHint.js';\nimport { MenuId, MenuRegistry, SubmenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { HiddenItemStrategy, MenuWorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { SubmenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultInputBoxStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { IActionViewItemOptions } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\n\nconst viewFilterMenu = new MenuId('menu.view.filter');\nexport const viewFilterSubmenu = new MenuId('submenu.view.filter');\nMenuRegistry.appendMenuItem(viewFilterMenu, {\n\tsubmenu: viewFilterSubmenu,\n\ttitle: localize('more filters', \"More Filters...\"),\n\tgroup: 'navigation',\n\ticon: Codicon.filter,\n});\n\nclass MoreFiltersActionViewItem extends SubmenuEntryActionViewItem {\n\n\tprivate _checked: boolean = false;\n\tset checked(checked: boolean) {\n\t\tif (this._checked !== checked) {\n\t\t\tthis._checked = checked;\n\t\t\tthis.updateChecked();\n\t\t}\n\t}\n\n\tprotected override updateChecked(): void {\n\t\tif (this.element) {\n\t\t\tthis.element.classList.toggle('checked', this._checked);\n\t\t}\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\t\tthis.updateChecked();\n\t}\n\n}\n\nexport interface IFilterWidgetOptions {\n\treadonly text?: string;\n\treadonly placeholder?: string;\n\treadonly ariaLabel?: string;\n\treadonly history?: string[];\n\treadonly focusContextKey?: string;\n}\n\nexport class FilterWidget extends Widget {\n\n\treadonly element: HTMLElement;\n\tprivate readonly delayedFilterUpdate: Delayer<void>;\n\tprivate readonly filterInputBox: HistoryInputBox;\n\tprivate readonly filterBadge: HTMLElement;\n\tprivate readonly toolbar: MenuWorkbenchToolBar;\n\tprivate readonly focusContextKey: IContextKey<boolean> | undefined;\n\n\tprivate readonly _onDidChangeFilterText = this._register(new Emitter<string>());\n\treadonly onDidChangeFilterText = this._onDidChangeFilterText.event;\n\n\tprivate moreFiltersActionViewItem: MoreFiltersActionViewItem | undefined;\n\tprivate isMoreFiltersChecked: boolean = false;\n\tprivate lastWidth?: number;\n\n\tprivate focusTracker: DOM.IFocusTracker;\n\tpublic get onDidFocus() { return this.focusTracker.onDidFocus; }\n\tpublic get onDidBlur() { return this.focusTracker.onDidBlur; }\n\n\tconstructor(\n\t\tprivate readonly options: IFilterWidgetOptions,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IContextViewService private readonly contextViewService: IContextViewService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService\n\t) {\n\t\tsuper();\n\t\tthis.delayedFilterUpdate = new Delayer<void>(400);\n\t\tthis._register(toDisposable(() => this.delayedFilterUpdate.cancel()));\n\n\t\tif (options.focusContextKey) {\n\t\t\tthis.focusContextKey = new RawContextKey(options.focusContextKey, false).bindTo(contextKeyService);\n\t\t}\n\n\t\tthis.element = DOM.$('.viewpane-filter');\n\t\t[this.filterInputBox, this.focusTracker] = this.createInput(this.element);\n\t\tthis._register(this.filterInputBox);\n\t\tthis._register(this.focusTracker);\n\n\t\tconst controlsContainer = DOM.append(this.element, DOM.$('.viewpane-filter-controls'));\n\t\tthis.filterBadge = this.createBadge(controlsContainer);\n\t\tthis.toolbar = this._register(this.createToolBar(controlsContainer));\n\n\t\tthis.adjustInputBox();\n\t}\n\n\thasFocus(): boolean {\n\t\treturn this.filterInputBox.hasFocus();\n\t}\n\n\tfocus(): void {\n\t\tthis.filterInputBox.focus();\n\t}\n\n\tblur(): void {\n\t\tthis.filterInputBox.blur();\n\t}\n\n\tupdateBadge(message: string | undefined): void {\n\t\tthis.filterBadge.classList.toggle('hidden', !message);\n\t\tthis.filterBadge.textContent = message || '';\n\t\tthis.adjustInputBox();\n\t}\n\n\tsetFilterText(filterText: string): void {\n\t\tthis.filterInputBox.value = filterText;\n\t}\n\n\tgetFilterText(): string {\n\t\treturn this.filterInputBox.value;\n\t}\n\n\tgetHistory(): string[] {\n\t\treturn this.filterInputBox.getHistory();\n\t}\n\n\tlayout(width: number): void {\n\t\tthis.element.parentElement?.classList.toggle('grow', width > 700);\n\t\tthis.element.classList.toggle('small', width < 400);\n\t\tthis.adjustInputBox();\n\t\tthis.lastWidth = width;\n\t}\n\n\trelayout() {\n\t\tif (this.lastWidth) {\n\t\t\tthis.layout(this.lastWidth);\n\t\t}\n\t}\n\n\tcheckMoreFilters(checked: boolean): void {\n\t\tthis.isMoreFiltersChecked = checked;\n\t\tif (this.moreFiltersActionViewItem) {\n\t\t\tthis.moreFiltersActionViewItem.checked = checked;\n\t\t}\n\t}\n\n\tprivate createInput(container: HTMLElement): [ContextScopedHistoryInputBox, DOM.IFocusTracker] {\n\t\tconst inputBox = this._register(this.instantiationService.createInstance(ContextScopedHistoryInputBox, container, this.contextViewService, {\n\t\t\tplaceholder: this.options.placeholder,\n\t\t\tariaLabel: this.options.ariaLabel,\n\t\t\thistory: this.options.history || [],\n\t\t\tshowHistoryHint: () => showHistoryKeybindingHint(this.keybindingService),\n\t\t\tinputBoxStyles: defaultInputBoxStyles\n\t\t}));\n\t\tif (this.options.text) {\n\t\t\tinputBox.value = this.options.text;\n\t\t}\n\t\tthis._register(inputBox.onDidChange(filter => this.delayedFilterUpdate.trigger(() => this.onDidInputChange(inputBox))));\n\t\tthis._register(DOM.addStandardDisposableListener(inputBox.inputElement, DOM.EventType.KEY_DOWN, (e: any) => this.onInputKeyDown(e, inputBox)));\n\t\tthis._register(DOM.addStandardDisposableListener(container, DOM.EventType.KEY_DOWN, this.handleKeyboardEvent));\n\t\tthis._register(DOM.addStandardDisposableListener(container, DOM.EventType.KEY_UP, this.handleKeyboardEvent));\n\t\tthis._register(DOM.addStandardDisposableListener(inputBox.inputElement, DOM.EventType.CLICK, (e) => {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t}));\n\n\t\tconst focusTracker = this._register(DOM.trackFocus(inputBox.inputElement));\n\t\tif (this.focusContextKey) {\n\t\t\tthis._register(focusTracker.onDidFocus(() => this.focusContextKey!.set(true)));\n\t\t\tthis._register(focusTracker.onDidBlur(() => this.focusContextKey!.set(false)));\n\t\t\tthis._register(toDisposable(() => this.focusContextKey!.reset()));\n\t\t}\n\t\treturn [inputBox, focusTracker];\n\t}\n\n\tprivate createBadge(container: HTMLElement): HTMLElement {\n\t\tconst filterBadge = DOM.append(container, DOM.$('.viewpane-filter-badge.hidden'));\n\t\tfilterBadge.style.backgroundColor = asCssVariable(badgeBackground);\n\t\tfilterBadge.style.color = asCssVariable(badgeForeground);\n\t\tfilterBadge.style.border = `1px solid ${asCssVariable(contrastBorder)}`;\n\t\treturn filterBadge;\n\t}\n\n\tprivate createToolBar(container: HTMLElement): MenuWorkbenchToolBar {\n\t\treturn this.instantiationService.createInstance(MenuWorkbenchToolBar, container, viewFilterMenu,\n\t\t\t{\n\t\t\t\thiddenItemStrategy: HiddenItemStrategy.NoHide,\n\t\t\t\tactionViewItemProvider: (action: IAction, options: IActionViewItemOptions) => {\n\t\t\t\t\tif (action instanceof SubmenuItemAction && action.item.submenu.id === viewFilterSubmenu.id) {\n\t\t\t\t\t\tthis.moreFiltersActionViewItem = this.instantiationService.createInstance(MoreFiltersActionViewItem, action, options);\n\t\t\t\t\t\tthis.moreFiltersActionViewItem.checked = this.isMoreFiltersChecked;\n\t\t\t\t\t\treturn this.moreFiltersActionViewItem;\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tprivate onDidInputChange(inputbox: HistoryInputBox) {\n\t\tinputbox.addToHistory();\n\t\tthis._onDidChangeFilterText.fire(inputbox.value);\n\t}\n\n\tprivate adjustInputBox(): void {\n\t\tthis.filterInputBox.inputElement.style.paddingRight = this.element.classList.contains('small') || this.filterBadge.classList.contains('hidden') ? '25px' : '150px';\n\t}\n\n\t// Action toolbar is swallowing some keys for action items which should not be for an input box\n\tprivate handleKeyboardEvent(event: StandardKeyboardEvent) {\n\t\tif (event.equals(KeyCode.Space)\n\t\t\t|| event.equals(KeyCode.LeftArrow)\n\t\t\t|| event.equals(KeyCode.RightArrow)\n\t\t\t|| event.equals(KeyCode.Home)\n\t\t\t|| event.equals(KeyCode.End)\n\t\t) {\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\tprivate onInputKeyDown(event: StandardKeyboardEvent, filterInputBox: HistoryInputBox) {\n\t\tlet handled = false;\n\t\tif (event.equals(KeyCode.Tab) && !this.toolbar.isEmpty()) {\n\t\t\tthis.toolbar.focus();\n\t\t\thandled = true;\n\t\t}\n\t\tif (handled) {\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n}\n"],
  "mappings": "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",
  "names": []
}
