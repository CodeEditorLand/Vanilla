var J=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var S=(i,n,e,t)=>{for(var o=t>1?void 0:t?Q(n,e):n,r=i.length-1,c;r>=0;r--)(c=i[r])&&(o=(t?c(n,e,o):c(o))||o);return t&&o&&J(n,e,o),o},s=(i,n)=>(e,t)=>n(e,t,i);import"vs/css!./media/activitybarpart";import"vs/css!./media/activityaction";import{$ as X,addDisposableListener as V,append as Z,clearNode as ee,EventType as _,isAncestor as te}from"../../../../../vs/base/browser/dom.js";import{StandardKeyboardEvent as k}from"../../../../../vs/base/browser/keyboardEvent.js";import"../../../../../vs/base/browser/touch.js";import{ActionsOrientation as R}from"../../../../../vs/base/browser/ui/actionbar/actionbar.js";import{HoverPosition as N}from"../../../../../vs/base/browser/ui/hover/hoverWidget.js";import{Separator as w,SubmenuAction as oe,toAction as O}from"../../../../../vs/base/common/actions.js";import{KeyCode as v}from"../../../../../vs/base/common/keyCodes.js";import{DisposableStore as ie,MutableDisposable as ne}from"../../../../../vs/base/common/lifecycle.js";import{assertIsDefined as x}from"../../../../../vs/base/common/types.js";import{localize as u,localize2 as h}from"../../../../../vs/nls.js";import{Categories as C}from"../../../../../vs/platform/action/common/actionCommonCategories.js";import{createAndFillInContextMenuActions as re}from"../../../../../vs/platform/actions/browser/menuEntryActionViewItem.js";import{Action2 as b,IMenuService as ae,MenuId as a,MenuRegistry as E,registerAction2 as A}from"../../../../../vs/platform/actions/common/actions.js";import{IConfigurationService as g}from"../../../../../vs/platform/configuration/common/configuration.js";import{ContextKeyExpr as d,IContextKeyService as ce}from"../../../../../vs/platform/contextkey/common/contextkey.js";import{IInstantiationService as Y}from"../../../../../vs/platform/instantiation/common/instantiation.js";import{IStorageService as H}from"../../../../../vs/platform/storage/common/storage.js";import{activeContrastBorder as se,contrastBorder as ue,focusBorder as me}from"../../../../../vs/platform/theme/common/colorRegistry.js";import{IThemeService as le,registerThemingParticipant as de}from"../../../../../vs/platform/theme/common/themeService.js";import{getMenuBarVisibility as P}from"../../../../../vs/platform/window/common/window.js";import{ToggleSidebarPositionAction as M}from"../../../../../vs/workbench/browser/actions/layoutActions.js";import{Part as pe}from"../../../../../vs/workbench/browser/part.js";import{GlobalCompositeBar as ve}from"../../../../../vs/workbench/browser/parts/globalCompositeBar.js";import{PaneCompositeBar as he}from"../../../../../vs/workbench/browser/parts/paneCompositeBar.js";import"../../../../../vs/workbench/browser/parts/paneCompositePart.js";import{CustomMenubarControl as Ce}from"../../../../../vs/workbench/browser/parts/titlebar/menubarControl.js";import{ACTIVITY_BAR_ACTIVE_BACKGROUND as K,ACTIVITY_BAR_ACTIVE_BORDER as F,ACTIVITY_BAR_ACTIVE_FOCUS_BORDER as Ae,ACTIVITY_BAR_BACKGROUND as Be,ACTIVITY_BAR_BADGE_BACKGROUND as fe,ACTIVITY_BAR_BADGE_FOREGROUND as be,ACTIVITY_BAR_BORDER as ge,ACTIVITY_BAR_DRAG_AND_DROP_BORDER as Ie,ACTIVITY_BAR_FOREGROUND as ye,ACTIVITY_BAR_INACTIVE_FOREGROUND as Te}from"../../../../../vs/workbench/common/theme.js";import{IViewDescriptorService as we,ViewContainerLocation as I,ViewContainerLocationToString as q}from"../../../../../vs/workbench/common/views.js";import{IWorkbenchEnvironmentService as Se}from"../../../../../vs/workbench/services/environment/common/environmentService.js";import{IExtensionService as Ve}from"../../../../../vs/workbench/services/extensions/common/extensions.js";import{ActivityBarPosition as m,IWorkbenchLayoutService as L,LayoutSettings as l,Parts as y,Position as _e}from"../../../../../vs/workbench/services/layout/browser/layoutService.js";import{IPaneCompositePartService as ke}from"../../../../../vs/workbench/services/panecomposite/browser/panecomposite.js";let p=class extends pe{constructor(e,t,o,r,c){super(y.ACTIVITYBAR_PART,{hasTitle:!1},r,c,o);this.paneCompositePart=e;this.instantiationService=t}static ACTION_HEIGHT=48;static pinnedViewContainersKey="workbench.activity.pinnedViewlets2";static placeholderViewContainersKey="workbench.activity.placeholderViewlets";static viewContainersWorkspaceStateKey="workbench.activity.viewletsWorkspaceState";minimumWidth=48;maximumWidth=48;minimumHeight=0;maximumHeight=Number.POSITIVE_INFINITY;compositeBar=this._register(new ne);content;createCompositeBar(){return this.instantiationService.createInstance(T,{partContainerClass:"activitybar",pinnedViewContainersKey:p.pinnedViewContainersKey,placeholderViewContainersKey:p.placeholderViewContainersKey,viewContainersWorkspaceStateKey:p.viewContainersWorkspaceStateKey,orientation:R.VERTICAL,icon:!0,iconSize:24,activityHoverOptions:{position:()=>this.layoutService.getSideBarPosition()===_e.LEFT?N.RIGHT:N.LEFT},preventLoopNavigation:!0,recomputeSizes:!1,fillExtraContextMenuActions:(e,t)=>{},compositeSize:52,colors:e=>({activeForegroundColor:e.getColor(ye),inactiveForegroundColor:e.getColor(Te),activeBorderColor:e.getColor(F),activeBackground:e.getColor(K),badgeBackground:e.getColor(fe),badgeForeground:e.getColor(be),dragAndDropBorder:e.getColor(Ie),activeBackgroundColor:void 0,inactiveBackgroundColor:void 0,activeBorderBottomColor:void 0}),overflowActionSize:p.ACTION_HEIGHT},y.ACTIVITYBAR_PART,this.paneCompositePart,!0)}createContentArea(e){return this.element=e,this.content=Z(this.element,X(".content")),this.layoutService.isVisible(y.ACTIVITYBAR_PART)&&this.show(),this.content}getPinnedPaneCompositeIds(){return this.compositeBar.value?.getPinnedPaneCompositeIds()??[]}getVisiblePaneCompositeIds(){return this.compositeBar.value?.getVisiblePaneCompositeIds()??[]}focus(){this.compositeBar.value?.focus()}updateStyles(){super.updateStyles();const e=x(this.getContainer()),t=this.getColor(Be)||"";e.style.backgroundColor=t;const o=this.getColor(ge)||this.getColor(ue)||"";e.classList.toggle("bordered",!!o),e.style.borderColor=o||""}show(e){this.content&&(this.compositeBar.value||(this.compositeBar.value=this.createCompositeBar(),this.compositeBar.value.create(this.content),this.dimension&&this.layout(this.dimension.width,this.dimension.height)),e&&this.focus())}hide(){this.compositeBar.value&&(this.compositeBar.clear(),this.content&&ee(this.content))}layout(e,t){if(super.layout(e,t,0,0),!this.compositeBar.value)return;const o=super.layoutContents(e,t).contentSize;this.compositeBar.value.layout(e,o.height)}toJSON(){return{type:y.ACTIVITYBAR_PART}}};p=S([s(1,Y),s(2,L),s(3,le),s(4,H)],p);let T=class extends he{constructor(e,t,o,r,c,B,W,$,U,z,Re,Oe,j){super({...e,fillExtraContextMenuActions:(f,D)=>{e.fillExtraContextMenuActions(f,D),this.fillContextMenuActions(f,D)}},t,o,c,B,W,$,U,z,j);this.configurationService=Re;this.menuService=Oe;r&&(this.globalCompositeBar=this._register(c.createInstance(ve,()=>this.getContextMenuActions(),f=>this.options.colors(f),this.options.activityHoverOptions))),this._register(this.configurationService.onDidChangeConfiguration(f=>{f.affectsConfiguration("window.menuBarVisibility")&&(P(this.configurationService)==="compact"?this.installMenubar():this.uninstallMenubar())}))}element;menuBar;menuBarContainer;compositeBarContainer;globalCompositeBar;keyboardNavigationDisposables=this._register(new ie);fillContextMenuActions(e,t){const o=P(this.configurationService);(o==="compact"||o==="hidden"||o==="toggle")&&e.unshift(O({id:"toggleMenuVisibility",label:u("menu","Menu"),checked:o==="compact",run:()=>this.configurationService.updateValue("window.menuBarVisibility",o==="compact"?"toggle":"compact")}),new w),o==="compact"&&this.menuBarContainer&&t?.target&&te(t.target,this.menuBarContainer)&&e.unshift(O({id:"hideCompactMenu",label:u("hideMenu","Hide Menu"),run:()=>this.configurationService.updateValue("window.menuBarVisibility","toggle")}),new w),this.globalCompositeBar&&(e.push(new w),e.push(...this.globalCompositeBar.getContextMenuActions())),e.push(new w),e.push(...this.getActivityBarContextMenuActions())}uninstallMenubar(){this.menuBar&&(this.menuBar.dispose(),this.menuBar=void 0),this.menuBarContainer&&(this.menuBarContainer.remove(),this.menuBarContainer=void 0)}installMenubar(){if(this.menuBar)return;this.menuBarContainer=document.createElement("div"),this.menuBarContainer.classList.add("menubar"),x(this.element).prepend(this.menuBarContainer),this.menuBar=this._register(this.instantiationService.createInstance(Ce)),this.menuBar.create(this.menuBarContainer)}registerKeyboardNavigationListeners(){this.keyboardNavigationDisposables.clear(),this.menuBarContainer&&this.keyboardNavigationDisposables.add(V(this.menuBarContainer,_.KEY_DOWN,e=>{const t=new k(e);(t.equals(v.DownArrow)||t.equals(v.RightArrow))&&this.focus()})),this.compositeBarContainer&&this.keyboardNavigationDisposables.add(V(this.compositeBarContainer,_.KEY_DOWN,e=>{const t=new k(e);t.equals(v.DownArrow)||t.equals(v.RightArrow)?this.globalCompositeBar?.focus():(t.equals(v.UpArrow)||t.equals(v.LeftArrow))&&this.menuBar?.toggleFocus()})),this.globalCompositeBar&&this.keyboardNavigationDisposables.add(V(this.globalCompositeBar.element,_.KEY_DOWN,e=>{const t=new k(e);(t.equals(v.UpArrow)||t.equals(v.LeftArrow))&&this.focus(this.getVisiblePaneCompositeIds().length-1)}))}create(e){return this.element=e,P(this.configurationService)==="compact"&&this.installMenubar(),this.compositeBarContainer=super.create(this.element),this.globalCompositeBar&&this.globalCompositeBar.create(this.element),this.registerKeyboardNavigationListeners(),this.compositeBarContainer}layout(e,t){this.menuBarContainer&&(this.options.orientation===R.VERTICAL?t-=this.menuBarContainer.clientHeight:e-=this.menuBarContainer.clientWidth),this.globalCompositeBar&&(this.options.orientation===R.VERTICAL?t-=this.globalCompositeBar.size()*p.ACTION_HEIGHT:e-=this.globalCompositeBar.element.clientWidth),super.layout(e,t)}getActivityBarContextMenuActions(){const e=this.menuService.getMenuActions(a.ActivityBarPositionMenu,this.contextKeyService,{shouldForwardArgs:!0,renderShortTitle:!0}),t=[];return re(e,{primary:[],secondary:t}),[new oe("workbench.action.panel.position",u("activity bar position","Activity Bar Position"),t),O({id:M.ID,label:M.getLabel(this.layoutService),run:()=>this.instantiationService.invokeFunction(o=>new M().run(o))})]}};T=S([s(4,Y),s(5,H),s(6,Ve),s(7,we),s(8,ce),s(9,Se),s(10,g),s(11,ae),s(12,L)],T),A(class extends b{constructor(){super({id:"workbench.action.activityBarLocation.default",title:{...h("positionActivityBarDefault","Move Activity Bar to Side"),mnemonicTitle:u({key:"miDefaultActivityBar",comment:["&& denotes a mnemonic"]},"&&Default")},shortTitle:u("default","Default"),category:C.View,toggled:d.equals(`config.${l.ACTIVITY_BAR_LOCATION}`,m.DEFAULT),menu:[{id:a.ActivityBarPositionMenu,order:1},{id:a.CommandPalette,when:d.notEquals(`config.${l.ACTIVITY_BAR_LOCATION}`,m.DEFAULT)}]})}run(i){i.get(g).updateValue(l.ACTIVITY_BAR_LOCATION,m.DEFAULT)}}),A(class extends b{constructor(){super({id:"workbench.action.activityBarLocation.top",title:{...h("positionActivityBarTop","Move Activity Bar to Top"),mnemonicTitle:u({key:"miTopActivityBar",comment:["&& denotes a mnemonic"]},"&&Top")},shortTitle:u("top","Top"),category:C.View,toggled:d.equals(`config.${l.ACTIVITY_BAR_LOCATION}`,m.TOP),menu:[{id:a.ActivityBarPositionMenu,order:2},{id:a.CommandPalette,when:d.notEquals(`config.${l.ACTIVITY_BAR_LOCATION}`,m.TOP)}]})}run(i){i.get(g).updateValue(l.ACTIVITY_BAR_LOCATION,m.TOP)}}),A(class extends b{constructor(){super({id:"workbench.action.activityBarLocation.bottom",title:{...h("positionActivityBarBottom","Move Activity Bar to Bottom"),mnemonicTitle:u({key:"miBottomActivityBar",comment:["&& denotes a mnemonic"]},"&&Bottom")},shortTitle:u("bottom","Bottom"),category:C.View,toggled:d.equals(`config.${l.ACTIVITY_BAR_LOCATION}`,m.BOTTOM),menu:[{id:a.ActivityBarPositionMenu,order:3},{id:a.CommandPalette,when:d.notEquals(`config.${l.ACTIVITY_BAR_LOCATION}`,m.BOTTOM)}]})}run(i){i.get(g).updateValue(l.ACTIVITY_BAR_LOCATION,m.BOTTOM)}}),A(class extends b{constructor(){super({id:"workbench.action.activityBarLocation.hide",title:{...h("hideActivityBar","Hide Activity Bar"),mnemonicTitle:u({key:"miHideActivityBar",comment:["&& denotes a mnemonic"]},"&&Hidden")},shortTitle:u("hide","Hidden"),category:C.View,toggled:d.equals(`config.${l.ACTIVITY_BAR_LOCATION}`,m.HIDDEN),menu:[{id:a.ActivityBarPositionMenu,order:4},{id:a.CommandPalette,when:d.notEquals(`config.${l.ACTIVITY_BAR_LOCATION}`,m.HIDDEN)}]})}run(i){i.get(g).updateValue(l.ACTIVITY_BAR_LOCATION,m.HIDDEN)}}),E.appendMenuItem(a.MenubarAppearanceMenu,{submenu:a.ActivityBarPositionMenu,title:u("positionActivituBar","Activity Bar Position"),group:"3_workbench_layout_move",order:2}),E.appendMenuItem(a.ViewContainerTitleContext,{submenu:a.ActivityBarPositionMenu,title:u("positionActivituBar","Activity Bar Position"),when:d.equals("viewContainerLocation",q(I.Sidebar)),group:"3_workbench_layout_move",order:1}),E.appendMenuItem(a.ViewTitleContext,{submenu:a.ActivityBarPositionMenu,title:u("positionActivituBar","Activity Bar Position"),when:d.equals("viewLocation",q(I.Sidebar)),group:"3_workbench_layout_move",order:1});class G extends b{constructor(e,t){super(e);this.offset=t}async run(e){const t=e.get(ke),o=t.getVisiblePaneCompositeIds(I.Sidebar),r=t.getActivePaneComposite(I.Sidebar);if(!r)return;let c;for(let B=0;B<o.length;B++)if(o[B]===r.getId()){c=o[(B+o.length+this.offset)%o.length];break}await t.openPaneComposite(c,I.Sidebar,!0)}}A(class extends G{constructor(){super({id:"workbench.action.previousSideBarView",title:h("previousSideBarView","Previous Primary Side Bar View"),category:C.View,f1:!0},-1)}}),A(class extends G{constructor(){super({id:"workbench.action.nextSideBarView",title:h("nextSideBarView","Next Primary Side Bar View"),category:C.View,f1:!0},1)}}),A(class extends b{constructor(){super({id:"workbench.action.focusActivityBar",title:h("focusActivityBar","Focus Activity Bar"),category:C.View,f1:!0})}async run(n){n.get(L).focusPart(y.ACTIVITYBAR_PART)}}),de((i,n)=>{const e=i.getColor(F);e&&n.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator:before {
				border-left-color: ${e};
			}
		`);const t=i.getColor(Ae);t&&n.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus::before {
				visibility: hidden;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus .active-item-indicator:before {
				visibility: visible;
				border-left-color: ${t};
			}
		`);const o=i.getColor(K);o&&n.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator {
				z-index: 0;
				background-color: ${o};
			}
		`);const r=i.getColor(se);if(r)n.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item .action-label::before{
				padding: 6px;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active .action-label::before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:hover .action-label::before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .action-label::before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:hover .action-label::before {
				outline: 1px solid ${r};
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:hover .action-label::before {
				outline: 1px dashed ${r};
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator:before {
				border-left-color: ${r};
			}
		`);else{const c=i.getColor(me);c&&n.addRule(`
				.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator::before {
						border-left-color: ${c};
					}
				`)}});export{T as ActivityBarCompositeBar,p as ActivitybarPart};
