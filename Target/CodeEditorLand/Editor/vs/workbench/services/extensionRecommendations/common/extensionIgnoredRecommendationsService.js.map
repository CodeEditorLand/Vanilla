{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/extensionRecommendations/common/extensionIgnoredRecommendationsService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { distinct } from \"../../../../base/common/arrays.js\";\nimport { Emitter } from \"../../../../base/common/event.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n} from \"../../../../base/common/lifecycle.js\";\nimport {\n\tInstantiationType,\n\tregisterSingleton,\n} from \"../../../../platform/instantiation/common/extensions.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n} from \"../../../../platform/storage/common/storage.js\";\nimport {\n\tIExtensionIgnoredRecommendationsService,\n\ttype IgnoredRecommendationChangeNotification,\n} from \"./extensionRecommendations.js\";\nimport { IWorkspaceExtensionsConfigService } from \"./workspaceExtensionsConfig.js\";\n\nconst ignoredRecommendationsStorageKey =\n\t\"extensionsAssistant/ignored_recommendations\";\n\nexport class ExtensionIgnoredRecommendationsService\n\textends Disposable\n\timplements IExtensionIgnoredRecommendationsService\n{\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _onDidChangeIgnoredRecommendations = this._register(\n\t\tnew Emitter<void>(),\n\t);\n\treadonly onDidChangeIgnoredRecommendations =\n\t\tthis._onDidChangeIgnoredRecommendations.event;\n\n\t// Global Ignored Recommendations\n\tprivate _globalIgnoredRecommendations: string[] = [];\n\tget globalIgnoredRecommendations(): string[] {\n\t\treturn [...this._globalIgnoredRecommendations];\n\t}\n\tprivate _onDidChangeGlobalIgnoredRecommendation = this._register(\n\t\tnew Emitter<IgnoredRecommendationChangeNotification>(),\n\t);\n\treadonly onDidChangeGlobalIgnoredRecommendation =\n\t\tthis._onDidChangeGlobalIgnoredRecommendation.event;\n\n\t// Ignored Workspace Recommendations\n\tprivate ignoredWorkspaceRecommendations: string[] = [];\n\n\tget ignoredRecommendations(): string[] {\n\t\treturn distinct([\n\t\t\t...this.globalIgnoredRecommendations,\n\t\t\t...this.ignoredWorkspaceRecommendations,\n\t\t]);\n\t}\n\n\tconstructor(\n\t\t@IWorkspaceExtensionsConfigService\n\t\tprivate readonly workspaceExtensionsConfigService: IWorkspaceExtensionsConfigService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t) {\n\t\tsuper();\n\t\tthis._globalIgnoredRecommendations =\n\t\t\tthis.getCachedIgnoredRecommendations();\n\t\tthis._register(\n\t\t\tthis.storageService.onDidChangeValue(\n\t\t\t\tStorageScope.PROFILE,\n\t\t\t\tignoredRecommendationsStorageKey,\n\t\t\t\tthis._register(new DisposableStore()),\n\t\t\t)((e) => this.onDidStorageChange()),\n\t\t);\n\n\t\tthis.initIgnoredWorkspaceRecommendations();\n\t}\n\n\tprivate async initIgnoredWorkspaceRecommendations(): Promise<void> {\n\t\tthis.ignoredWorkspaceRecommendations =\n\t\t\tawait this.workspaceExtensionsConfigService.getUnwantedRecommendations();\n\t\tthis._onDidChangeIgnoredRecommendations.fire();\n\t\tthis._register(\n\t\t\tthis.workspaceExtensionsConfigService.onDidChangeExtensionsConfigs(\n\t\t\t\tasync () => {\n\t\t\t\t\tthis.ignoredWorkspaceRecommendations =\n\t\t\t\t\t\tawait this.workspaceExtensionsConfigService.getUnwantedRecommendations();\n\t\t\t\t\tthis._onDidChangeIgnoredRecommendations.fire();\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\t}\n\n\ttoggleGlobalIgnoredRecommendation(\n\t\textensionId: string,\n\t\tshouldIgnore: boolean,\n\t): void {\n\t\textensionId = extensionId.toLowerCase();\n\t\tconst ignored =\n\t\t\tthis._globalIgnoredRecommendations.indexOf(extensionId) !== -1;\n\t\tif (ignored === shouldIgnore) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._globalIgnoredRecommendations = shouldIgnore\n\t\t\t? [...this._globalIgnoredRecommendations, extensionId]\n\t\t\t: this._globalIgnoredRecommendations.filter(\n\t\t\t\t\t(id) => id !== extensionId,\n\t\t\t\t);\n\t\tthis.storeCachedIgnoredRecommendations(\n\t\t\tthis._globalIgnoredRecommendations,\n\t\t);\n\t\tthis._onDidChangeGlobalIgnoredRecommendation.fire({\n\t\t\textensionId,\n\t\t\tisRecommended: !shouldIgnore,\n\t\t});\n\t\tthis._onDidChangeIgnoredRecommendations.fire();\n\t}\n\n\tprivate getCachedIgnoredRecommendations(): string[] {\n\t\tconst ignoredRecommendations: string[] = JSON.parse(\n\t\t\tthis.ignoredRecommendationsValue,\n\t\t);\n\t\treturn ignoredRecommendations.map((e) => e.toLowerCase());\n\t}\n\n\tprivate onDidStorageChange(): void {\n\t\tif (\n\t\t\tthis.ignoredRecommendationsValue !==\n\t\t\tthis.getStoredIgnoredRecommendationsValue()\n\t\t) {\n\t\t\tthis._ignoredRecommendationsValue = undefined;\n\t\t\tthis._globalIgnoredRecommendations =\n\t\t\t\tthis.getCachedIgnoredRecommendations();\n\t\t\tthis._onDidChangeIgnoredRecommendations.fire();\n\t\t}\n\t}\n\n\tprivate storeCachedIgnoredRecommendations(\n\t\tignoredRecommendations: string[],\n\t): void {\n\t\tthis.ignoredRecommendationsValue = JSON.stringify(\n\t\t\tignoredRecommendations,\n\t\t);\n\t}\n\n\tprivate _ignoredRecommendationsValue: string | undefined;\n\tprivate get ignoredRecommendationsValue(): string {\n\t\tif (!this._ignoredRecommendationsValue) {\n\t\t\tthis._ignoredRecommendationsValue =\n\t\t\t\tthis.getStoredIgnoredRecommendationsValue();\n\t\t}\n\n\t\treturn this._ignoredRecommendationsValue;\n\t}\n\n\tprivate set ignoredRecommendationsValue(\n\t\tignoredRecommendationsValue: string,\n\t) {\n\t\tif (this.ignoredRecommendationsValue !== ignoredRecommendationsValue) {\n\t\t\tthis._ignoredRecommendationsValue = ignoredRecommendationsValue;\n\t\t\tthis.setStoredIgnoredRecommendationsValue(\n\t\t\t\tignoredRecommendationsValue,\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate getStoredIgnoredRecommendationsValue(): string {\n\t\treturn this.storageService.get(\n\t\t\tignoredRecommendationsStorageKey,\n\t\t\tStorageScope.PROFILE,\n\t\t\t\"[]\",\n\t\t);\n\t}\n\n\tprivate setStoredIgnoredRecommendationsValue(value: string): void {\n\t\tthis.storageService.store(\n\t\t\tignoredRecommendationsStorageKey,\n\t\t\tvalue,\n\t\t\tStorageScope.PROFILE,\n\t\t\tStorageTarget.USER,\n\t\t);\n\t}\n}\n\nregisterSingleton(\n\tIExtensionIgnoredRecommendationsService,\n\tExtensionIgnoredRecommendationsService,\n\tInstantiationType.Delayed,\n);\n"],
  "mappings": "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",
  "names": []
}
