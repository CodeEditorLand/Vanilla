{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/userData/browser/userDataInit.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { mark } from \"../../../../base/common/performance.js\";\nimport { isWeb } from \"../../../../base/common/platform.js\";\nimport {\n\tIInstantiationService,\n\tcreateDecorator,\n} from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { Registry } from \"../../../../platform/registry/common/platform.js\";\nimport {\n\tExtensions,\n\ttype IWorkbenchContribution,\n\ttype IWorkbenchContributionsRegistry,\n} from \"../../../common/contributions.js\";\nimport { IExtensionService } from \"../../extensions/common/extensions.js\";\nimport { LifecyclePhase } from \"../../lifecycle/common/lifecycle.js\";\n\nexport interface IUserDataInitializer {\n\trequiresInitialization(): Promise<boolean>;\n\twhenInitializationFinished(): Promise<void>;\n\tinitializeRequiredResources(): Promise<void>;\n\tinitializeInstalledExtensions(\n\t\tinstantiationService: IInstantiationService,\n\t): Promise<void>;\n\tinitializeOtherResources(\n\t\tinstantiationService: IInstantiationService,\n\t): Promise<void>;\n}\n\nexport const IUserDataInitializationService =\n\tcreateDecorator<IUserDataInitializationService>(\n\t\t\"IUserDataInitializationService\",\n\t);\nexport interface IUserDataInitializationService extends IUserDataInitializer {\n\t_serviceBrand: any;\n}\n\nexport class UserDataInitializationService\n\timplements IUserDataInitializationService\n{\n\t_serviceBrand: any;\n\n\tconstructor(private readonly initializers: IUserDataInitializer[] = []) {}\n\n\tasync whenInitializationFinished(): Promise<void> {\n\t\tif (await this.requiresInitialization()) {\n\t\t\tawait Promise.all(\n\t\t\t\tthis.initializers.map((initializer) =>\n\t\t\t\t\tinitializer.whenInitializationFinished(),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n\n\tasync requiresInitialization(): Promise<boolean> {\n\t\treturn (\n\t\t\tawait Promise.all(\n\t\t\t\tthis.initializers.map((initializer) =>\n\t\t\t\t\tinitializer.requiresInitialization(),\n\t\t\t\t),\n\t\t\t)\n\t\t).some((result) => result);\n\t}\n\n\tasync initializeRequiredResources(): Promise<void> {\n\t\tif (await this.requiresInitialization()) {\n\t\t\tawait Promise.all(\n\t\t\t\tthis.initializers.map((initializer) =>\n\t\t\t\t\tinitializer.initializeRequiredResources(),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n\n\tasync initializeOtherResources(\n\t\tinstantiationService: IInstantiationService,\n\t): Promise<void> {\n\t\tif (await this.requiresInitialization()) {\n\t\t\tawait Promise.all(\n\t\t\t\tthis.initializers.map((initializer) =>\n\t\t\t\t\tinitializer.initializeOtherResources(instantiationService),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n\n\tasync initializeInstalledExtensions(\n\t\tinstantiationService: IInstantiationService,\n\t): Promise<void> {\n\t\tif (await this.requiresInitialization()) {\n\t\t\tawait Promise.all(\n\t\t\t\tthis.initializers.map((initializer) =>\n\t\t\t\t\tinitializer.initializeInstalledExtensions(\n\t\t\t\t\t\tinstantiationService,\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n}\n\nclass InitializeOtherResourcesContribution implements IWorkbenchContribution {\n\tconstructor(\n\t\t@IUserDataInitializationService userDataInitializeService: IUserDataInitializationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IExtensionService extensionService: IExtensionService,\n\t) {\n\t\textensionService\n\t\t\t.whenInstalledExtensionsRegistered()\n\t\t\t.then(() =>\n\t\t\t\tthis.initializeOtherResource(\n\t\t\t\t\tuserDataInitializeService,\n\t\t\t\t\tinstantiationService,\n\t\t\t\t),\n\t\t\t);\n\t}\n\n\tprivate async initializeOtherResource(\n\t\tuserDataInitializeService: IUserDataInitializationService,\n\t\tinstantiationService: IInstantiationService,\n\t): Promise<void> {\n\t\tif (await userDataInitializeService.requiresInitialization()) {\n\t\t\tmark(\"code/willInitOtherUserData\");\n\t\t\tawait userDataInitializeService.initializeOtherResources(\n\t\t\t\tinstantiationService,\n\t\t\t);\n\t\t\tmark(\"code/didInitOtherUserData\");\n\t\t}\n\t}\n}\n\nif (isWeb) {\n\tconst workbenchRegistry = Registry.as<IWorkbenchContributionsRegistry>(\n\t\tExtensions.Workbench,\n\t);\n\tworkbenchRegistry.registerWorkbenchContribution(\n\t\tInitializeOtherResourcesContribution,\n\t\tLifecyclePhase.Restored,\n\t);\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,YAAY;AACrB,SAAS,aAAa;AACtB;AAAA,EACC;AAAA,EACA;AAAA,OACM;AACP,SAAS,gBAAgB;AACzB;AAAA,EACC;AAAA,OAGM;AACP,SAAS,yBAAyB;AAClC,SAAS,sBAAsB;AAcxB,MAAM,iCACZ;AAAA,EACC;AACD;AAKM,MAAM,8BAEb;AAAA,EAGC,YAA6B,eAAuC,CAAC,GAAG;AAA3C;AAAA,EAA4C;AAAA,EA7C1E,OA0CA;AAAA;AAAA;AAAA,EACC;AAAA,EAIA,MAAM,6BAA4C;AACjD,QAAI,MAAM,KAAK,uBAAuB,GAAG;AACxC,YAAM,QAAQ;AAAA,QACb,KAAK,aAAa;AAAA,UAAI,CAAC,gBACtB,YAAY,2BAA2B;AAAA,QACxC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAM,yBAA2C;AAChD,YACC,MAAM,QAAQ;AAAA,MACb,KAAK,aAAa;AAAA,QAAI,CAAC,gBACtB,YAAY,uBAAuB;AAAA,MACpC;AAAA,IACD,GACC,KAAK,CAAC,WAAW,MAAM;AAAA,EAC1B;AAAA,EAEA,MAAM,8BAA6C;AAClD,QAAI,MAAM,KAAK,uBAAuB,GAAG;AACxC,YAAM,QAAQ;AAAA,QACb,KAAK,aAAa;AAAA,UAAI,CAAC,gBACtB,YAAY,4BAA4B;AAAA,QACzC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAM,yBACL,sBACgB;AAChB,QAAI,MAAM,KAAK,uBAAuB,GAAG;AACxC,YAAM,QAAQ;AAAA,QACb,KAAK,aAAa;AAAA,UAAI,CAAC,gBACtB,YAAY,yBAAyB,oBAAoB;AAAA,QAC1D;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAM,8BACL,sBACgB;AAChB,QAAI,MAAM,KAAK,uBAAuB,GAAG;AACxC,YAAM,QAAQ;AAAA,QACb,KAAK,aAAa;AAAA,UAAI,CAAC,gBACtB,YAAY;AAAA,YACX;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAAA,EACD;AACD;AAEA,IAAM,uCAAN,MAA6E;AAAA,EAxG7E,OAwG6E;AAAA;AAAA;AAAA,EAC5E,YACiC,2BACT,sBACJ,kBAClB;AACD,qBACE,kCAAkC,EAClC;AAAA,MAAK,MACL,KAAK;AAAA,QACJ;AAAA,QACA;AAAA,MACD;AAAA,IACD;AAAA,EACF;AAAA,EAEA,MAAc,wBACb,2BACA,sBACgB;AAChB,QAAI,MAAM,0BAA0B,uBAAuB,GAAG;AAC7D,WAAK,4BAA4B;AACjC,YAAM,0BAA0B;AAAA,QAC/B;AAAA,MACD;AACA,WAAK,2BAA2B;AAAA,IACjC;AAAA,EACD;AACD;AA5BM,uCAAN;AAAA,EAEG;AAAA,EACA;AAAA,EACA;AAAA,GAJG;AA8BN,IAAI,OAAO;AACV,QAAM,oBAAoB,SAAS;AAAA,IAClC,WAAW;AAAA,EACZ;AACA,oBAAkB;AAAA,IACjB;AAAA,IACA,eAAe;AAAA,EAChB;AACD;",
  "names": []
}
