var S=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var v=(c,e,i,t)=>{for(var r=t>1?void 0:t?I(e,i):e,m=c.length-1,s;m>=0;m--)(s=c[m])&&(r=(t?s(e,i,r):s(r))||r);return t&&r&&S(e,i,r),r},o=(c,e)=>(i,t)=>e(i,t,c);import*as l from"../../../../../vs/nls.js";import{IDialogService as d}from"../../../../../vs/platform/dialogs/common/dialogs.js";import{ILogService as h}from"../../../../../vs/platform/log/common/log.js";import{Severity as f}from"../../../../../vs/platform/notification/common/notification.js";import{IProductService as g}from"../../../../../vs/platform/product/common/productService.js";import{IRemoteAuthorityResolverService as b,RemoteAuthorityResolverError as y}from"../../../../../vs/platform/remote/common/remoteAuthorityResolver.js";import{IRemoteSocketFactoryService as k}from"../../../../../vs/platform/remote/common/remoteSocketFactoryService.js";import{ISignService as u}from"../../../../../vs/platform/sign/common/sign.js";import{registerWorkbenchContribution2 as E,WorkbenchPhase as R}from"../../../../../vs/workbench/common/contributions.js";import{IWorkbenchEnvironmentService as D}from"../../../../../vs/workbench/services/environment/common/environmentService.js";import{IHostService as A}from"../../../../../vs/workbench/services/host/browser/host.js";import{AbstractRemoteAgentService as P}from"../../../../../vs/workbench/services/remote/common/abstractRemoteAgentService.js";import{IRemoteAgentService as W}from"../../../../../vs/workbench/services/remote/common/remoteAgentService.js";import{IUserDataProfileService as _}from"../../../../../vs/workbench/services/userDataProfile/common/userDataProfile.js";let a=class extends P{constructor(e,i,t,r,m,s,p){super(e,i,t,r,m,s,p)}};a=v([o(0,k),o(1,_),o(2,D),o(3,g),o(4,b),o(5,u),o(6,h)],a);let n=class{constructor(e,i,t){this._dialogService=i;this._hostService=t;e.getRawEnvironment().then(void 0,r=>{y.isHandled(r)||this._presentConnectionError(r)})}static ID="workbench.contrib.browserRemoteConnectionFailureNotification";async _presentConnectionError(e){await this._dialogService.prompt({type:f.Error,message:l.localize("connectionError","An unexpected error occurred that requires a reload of this page."),detail:l.localize("connectionErrorDetail","The workbench failed to connect to the server (Error: {0})",e?e.message:""),buttons:[{label:l.localize({key:"reload",comment:["&& denotes a mnemonic"]},"&&Reload"),run:()=>this._hostService.reload()}]})}};n=v([o(0,W),o(1,d),o(2,A)],n),E(n.ID,n,R.BlockRestore);export{a as RemoteAgentService};
