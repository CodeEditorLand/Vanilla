{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/dialogs/electron-sandbox/fileDialogService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getActiveWindow } from \"../../../../base/browser/dom.js\";\nimport { Schemas } from \"../../../../base/common/network.js\";\nimport { URI } from \"../../../../base/common/uri.js\";\nimport type {\n\tOpenDialogOptions,\n\tSaveDialogOptions,\n} from \"../../../../base/parts/sandbox/common/electronTypes.js\";\nimport { ICodeEditorService } from \"../../../../editor/browser/services/codeEditorService.js\";\nimport { ILanguageService } from \"../../../../editor/common/languages/language.js\";\nimport { ICommandService } from \"../../../../platform/commands/common/commands.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport {\n\tIDialogService,\n\tIFileDialogService,\n\ttype INativeOpenDialogOptions,\n\ttype IOpenDialogOptions,\n\ttype IPickAndOpenOptions,\n\ttype ISaveDialogOptions,\n} from \"../../../../platform/dialogs/common/dialogs.js\";\nimport { IFileService } from \"../../../../platform/files/common/files.js\";\nimport {\n\tInstantiationType,\n\tregisterSingleton,\n} from \"../../../../platform/instantiation/common/extensions.js\";\nimport { IInstantiationService } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { ILabelService } from \"../../../../platform/label/common/label.js\";\nimport { ILogService } from \"../../../../platform/log/common/log.js\";\nimport {\n\ttype INativeHostOptions,\n\tINativeHostService,\n} from \"../../../../platform/native/common/native.js\";\nimport { IOpenerService } from \"../../../../platform/opener/common/opener.js\";\nimport { IWorkspaceContextService } from \"../../../../platform/workspace/common/workspace.js\";\nimport { IWorkspacesService } from \"../../../../platform/workspaces/common/workspaces.js\";\nimport { IEditorService } from \"../../editor/common/editorService.js\";\nimport { IWorkbenchEnvironmentService } from \"../../environment/common/environmentService.js\";\nimport { IHistoryService } from \"../../history/common/history.js\";\nimport { IHostService } from \"../../host/browser/host.js\";\nimport { IPathService } from \"../../path/common/pathService.js\";\nimport { AbstractFileDialogService } from \"../browser/abstractFileDialogService.js\";\n\nexport class FileDialogService\n\textends AbstractFileDialogService\n\timplements IFileDialogService\n{\n\tconstructor(\n\t\t@IHostService hostService: IHostService,\n\t\t@IWorkspaceContextService contextService: IWorkspaceContextService,\n\t\t@IHistoryService historyService: IHistoryService,\n\t\t@IWorkbenchEnvironmentService\n\t\tenvironmentService: IWorkbenchEnvironmentService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@INativeHostService\n\t\tprivate readonly nativeHostService: INativeHostService,\n\t\t@IDialogService dialogService: IDialogService,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IWorkspacesService workspacesService: IWorkspacesService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IPathService pathService: IPathService,\n\t\t@ICommandService commandService: ICommandService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@ICodeEditorService codeEditorService: ICodeEditorService,\n\t\t@ILogService logService: ILogService,\n\t) {\n\t\tsuper(\n\t\t\thostService,\n\t\t\tcontextService,\n\t\t\thistoryService,\n\t\t\tenvironmentService,\n\t\t\tinstantiationService,\n\t\t\tconfigurationService,\n\t\t\tfileService,\n\t\t\topenerService,\n\t\t\tdialogService,\n\t\t\tlanguageService,\n\t\t\tworkspacesService,\n\t\t\tlabelService,\n\t\t\tpathService,\n\t\t\tcommandService,\n\t\t\teditorService,\n\t\t\tcodeEditorService,\n\t\t\tlogService,\n\t\t);\n\t}\n\n\tprivate toNativeOpenDialogOptions(\n\t\toptions: IPickAndOpenOptions,\n\t): INativeOpenDialogOptions {\n\t\treturn {\n\t\t\tforceNewWindow: options.forceNewWindow,\n\t\t\ttelemetryExtraData: options.telemetryExtraData,\n\t\t\tdefaultPath: options.defaultUri?.fsPath,\n\t\t};\n\t}\n\n\tprivate shouldUseSimplified(schema: string): {\n\t\tuseSimplified: boolean;\n\t\tisSetting: boolean;\n\t} {\n\t\tconst setting =\n\t\t\tthis.configurationService.getValue(\"files.simpleDialog.enable\") ===\n\t\t\ttrue;\n\t\tconst newWindowSetting =\n\t\t\tthis.configurationService.getValue(\n\t\t\t\t\"window.openFilesInNewWindow\",\n\t\t\t) === \"on\";\n\t\treturn {\n\t\t\tuseSimplified:\n\t\t\t\t(schema !== Schemas.file &&\n\t\t\t\t\tschema !== Schemas.vscodeUserData) ||\n\t\t\t\tsetting,\n\t\t\tisSetting: newWindowSetting,\n\t\t};\n\t}\n\n\tasync pickFileFolderAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFilePath(schema);\n\t\t}\n\n\t\tconst shouldUseSimplified = this.shouldUseSimplified(schema);\n\t\tif (shouldUseSimplified.useSimplified) {\n\t\t\treturn this.pickFileFolderAndOpenSimplified(\n\t\t\t\tschema,\n\t\t\t\toptions,\n\t\t\t\tshouldUseSimplified.isSetting,\n\t\t\t);\n\t\t}\n\t\treturn this.nativeHostService.pickFileFolderAndOpen(\n\t\t\tthis.toNativeOpenDialogOptions(options),\n\t\t);\n\t}\n\n\tasync pickFileAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFilePath(schema);\n\t\t}\n\n\t\tconst shouldUseSimplified = this.shouldUseSimplified(schema);\n\t\tif (shouldUseSimplified.useSimplified) {\n\t\t\treturn this.pickFileAndOpenSimplified(\n\t\t\t\tschema,\n\t\t\t\toptions,\n\t\t\t\tshouldUseSimplified.isSetting,\n\t\t\t);\n\t\t}\n\t\treturn this.nativeHostService.pickFileAndOpen(\n\t\t\tthis.toNativeOpenDialogOptions(options),\n\t\t);\n\t}\n\n\tasync pickFolderAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFolderPath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema).useSimplified) {\n\t\t\treturn this.pickFolderAndOpenSimplified(schema, options);\n\t\t}\n\t\treturn this.nativeHostService.pickFolderAndOpen(\n\t\t\tthis.toNativeOpenDialogOptions(options),\n\t\t);\n\t}\n\n\tasync pickWorkspaceAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\toptions.availableFileSystems =\n\t\t\tthis.getWorkspaceAvailableFileSystems(options);\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultWorkspacePath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema).useSimplified) {\n\t\t\treturn this.pickWorkspaceAndOpenSimplified(schema, options);\n\t\t}\n\t\treturn this.nativeHostService.pickWorkspaceAndOpen(\n\t\t\tthis.toNativeOpenDialogOptions(options),\n\t\t);\n\t}\n\n\tasync pickFileToSave(\n\t\tdefaultUri: URI,\n\t\tavailableFileSystems?: string[],\n\t): Promise<URI | undefined> {\n\t\tconst schema = this.getFileSystemSchema({\n\t\t\tdefaultUri,\n\t\t\tavailableFileSystems,\n\t\t});\n\t\tconst options = this.getPickFileToSaveDialogOptions(\n\t\t\tdefaultUri,\n\t\t\tavailableFileSystems,\n\t\t);\n\t\tif (this.shouldUseSimplified(schema).useSimplified) {\n\t\t\treturn this.pickFileToSaveSimplified(schema, options);\n\t\t} else {\n\t\t\tconst result = await this.nativeHostService.showSaveDialog(\n\t\t\t\tthis.toNativeSaveDialogOptions(options),\n\t\t\t);\n\t\t\tif (result && !result.canceled && result.filePath) {\n\t\t\t\tconst uri = URI.file(result.filePath);\n\n\t\t\t\tthis.addFileToRecentlyOpened(uri);\n\n\t\t\t\treturn uri;\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\n\tprivate toNativeSaveDialogOptions(\n\t\toptions: ISaveDialogOptions,\n\t): SaveDialogOptions & INativeHostOptions {\n\t\toptions.defaultUri = options.defaultUri\n\t\t\t? URI.file(options.defaultUri.path)\n\t\t\t: undefined;\n\t\treturn {\n\t\t\tdefaultPath: options.defaultUri?.fsPath,\n\t\t\tbuttonLabel: options.saveLabel,\n\t\t\tfilters: options.filters,\n\t\t\ttitle: options.title,\n\t\t\ttargetWindowId: getActiveWindow().vscodeWindowId,\n\t\t};\n\t}\n\n\tasync showSaveDialog(\n\t\toptions: ISaveDialogOptions,\n\t): Promise<URI | undefined> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\t\tif (this.shouldUseSimplified(schema).useSimplified) {\n\t\t\treturn this.showSaveDialogSimplified(schema, options);\n\t\t}\n\n\t\tconst result = await this.nativeHostService.showSaveDialog(\n\t\t\tthis.toNativeSaveDialogOptions(options),\n\t\t);\n\t\tif (result && !result.canceled && result.filePath) {\n\t\t\treturn URI.file(result.filePath);\n\t\t}\n\n\t\treturn;\n\t}\n\n\tasync showOpenDialog(\n\t\toptions: IOpenDialogOptions,\n\t): Promise<URI[] | undefined> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\t\tif (this.shouldUseSimplified(schema).useSimplified) {\n\t\t\treturn this.showOpenDialogSimplified(schema, options);\n\t\t}\n\n\t\tconst newOptions: OpenDialogOptions & {\n\t\t\tproperties: string[];\n\t\t} & INativeHostOptions = {\n\t\t\ttitle: options.title,\n\t\t\tdefaultPath: options.defaultUri?.fsPath,\n\t\t\tbuttonLabel: options.openLabel,\n\t\t\tfilters: options.filters,\n\t\t\tproperties: [],\n\t\t\ttargetWindowId: getActiveWindow().vscodeWindowId,\n\t\t};\n\n\t\tnewOptions.properties.push(\"createDirectory\");\n\n\t\tif (options.canSelectFiles) {\n\t\t\tnewOptions.properties.push(\"openFile\");\n\t\t}\n\n\t\tif (options.canSelectFolders) {\n\t\t\tnewOptions.properties.push(\"openDirectory\");\n\t\t}\n\n\t\tif (options.canSelectMany) {\n\t\t\tnewOptions.properties.push(\"multiSelections\");\n\t\t}\n\n\t\tconst result = await this.nativeHostService.showOpenDialog(newOptions);\n\t\treturn result &&\n\t\t\tArray.isArray(result.filePaths) &&\n\t\t\tresult.filePaths.length > 0\n\t\t\t? result.filePaths.map(URI.file)\n\t\t\t: undefined;\n\t}\n}\n\nregisterSingleton(\n\tIFileDialogService,\n\tFileDialogService,\n\tInstantiationType.Delayed,\n);\n"],
  "mappings": "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",
  "names": []
}
